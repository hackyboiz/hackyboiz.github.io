

<!DOCTYPE html>
<html lang="ko-KR" data-default-color-scheme="&#34;auto&#34;">



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" type="image/png" href="/img/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694; L0ch&amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;! &amp;#xC9C0;&amp;#xB09C;&amp;#xBC88; Windows Patch Diffing&amp;#xC5D0; &amp;#xC774;&amp;#xC5B4; &amp;#xC774;&amp;#xBC88;&amp;#xC5D4; &amp;#xBC88;&amp;#xC5ED;&amp;#xAE00;&amp;#xB85C; &amp;#xB3CC;&amp;#xC544;&amp;#xC654;&amp;#xC2B5;&amp;#xB2C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC624;&amp;#xB298; &amp;#xBC88;&amp;#xC5ED;&amp;#xAE00;&amp;#xC758; &amp;#xC8FC;&amp;#xC81C;&amp;#xB294; &amp;#xC778;&amp;#xD154;&amp;#xC774; &amp;#xB3C4;&amp;#xC785;&amp;#xD55C; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xBBF8;&amp;#xD2F0;&amp;#xAC8C;&amp;#xC774;&amp;#xC158;&amp;#xC778; CET&amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. CET&amp;#xB294; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &amp;#xC6B0;&amp;#xB9AC; &amp;#xB9C9;&amp;#xB0B4;&amp;#xC778; Fabu1ous&amp;#xC758; &lt;a href=&#34;https://hackyboiz.github.io/2020/12/06/fabu1ous/x64-stack-alignment/&#34;&gt;x64 stack alignment&lt;/a&gt; &amp;#xAE00;&amp;#xC758; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC5D0; &amp;#xC7A0;&amp;#xAE50; &amp;#xC5B8;&amp;#xAE09;&amp;#xB418;&amp;#xAE30;&amp;#xB3C4; &amp;#xD588;&amp;#xC5C8;&amp;#xC8E0;? &amp;#xC778;&amp;#xD154;&amp;#xC5D0;&amp;#xC120; &amp;#xC774;&amp;#xBBF8; &amp;#xCC28;&amp;#xC138;&amp;#xB300; &amp;#xBAA8;&amp;#xBC14;&amp;#xC77C; &amp;#xD50C;&amp;#xB7AB;&amp;#xD3FC;&amp;#xC778; Tiger Lake&amp;#xC5D0; &amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xB0B4;&amp;#xC7A5;&amp;#xD588;&amp;#xC73C;&amp;#xB2C8; &amp;#xACE7; &amp;#xC0C1;&amp;#xC6A9;&amp;#xD654;&amp;#xAC00; &amp;#xBA38;&amp;#xC9C0;&amp;#xC54A;&amp;#xC558;&amp;#xB124;&amp;#xC694;.&lt;/p&gt;
&lt;p&gt;&amp;#xCCAB; &amp;#xBC88;&amp;#xC5ED;&amp;#xAE00;&amp;#xC774;&amp;#xB77C; &amp;#xC624;&amp;#xC5ED;&amp;#xACFC; &amp;#xC624;&amp;#xD0C0;&amp;#xAC00; &amp;#xB09C;&amp;#xBB34;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC2B5;&amp;#xB2C8;&amp;#xB2E4;.. &amp;#x3160;&amp;#x3160; &amp;#xBC1C;&amp;#xACAC;&amp;#xD558;&amp;#xC2E0;&amp;#xB2E4;&amp;#xBA74; &amp;#xAC00;&amp;#xCC28; &amp;#xC5C6;&amp;#xC774; &amp;#xC9C0;&amp;#xC801;&amp;#xD574;&amp;#xC8FC;&amp;#xC2DC;&amp;#xBA74; &amp;#xAC10;&amp;#xC0AC;&amp;#xD558;&amp;#xACA0;&amp;#xC2B5;&amp;#xB2C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; &amp;#xC6D0;&amp;#xBB38; &amp;#xAE00; : &lt;a href=&#34;https://windows-internals.com/cet-on-windows/&#34;&gt;R.I.P ROP: CET Internals in Windows 20H1&lt;/a&gt; &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;&amp;#xB4E4;&amp;#xC5B4;&amp;#xAC00;&amp;#xBA70;&#34;&gt;&lt;a href=&#34;#&amp;#xB4E4;&amp;#xC5B4;&amp;#xAC00;&amp;#xBA70;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xB4E4;&amp;#xC5B4;&amp;#xAC00;&amp;#xBA70;&#34;&gt;&lt;/a&gt;&amp;#xB4E4;&amp;#xC5B4;&amp;#xAC00;&amp;#xBA70;&lt;/h2&gt;&lt;p&gt;&amp;#xCD5C;&amp;#xADFC; Windows 10&amp;#xC758; 19H1(Version 1903) &amp;#xB9B4;&amp;#xB9AC;&amp;#xC988; &amp;#xBC84;&amp;#xC804;&amp;#xC5D0; &amp;#xB9E4;&amp;#xC6B0; &amp;#xD765;&amp;#xBBF8;&amp;#xB85C;&amp;#xC6B4; &amp;#xC77C;&amp;#xC774; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD588;&amp;#xB2E4;. &amp;#xC778;&amp;#xD154; &lt;a href=&#34;https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf&#34;&gt;CET(Control-flow Enforcement Technology)&lt;/a&gt; &amp;#xAD6C;&amp;#xD604;&amp;#xC774; &amp;#xC218;&amp;#xB144;&amp;#xAC04;&amp;#xC758; &amp;#xB17C;&amp;#xC758; &amp;#xB05D;&amp;#xC5D0; &amp;#xC2DC;&amp;#xC791;&amp;#xB41C; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; CET &amp;#xC801;&amp;#xC6A9;&amp;#xC740; &amp;#xBAA8;&amp;#xB4E0; &amp;#xBC84;&amp;#xC804;&amp;#xC758; Windows &amp;#xB9B4;&amp;#xB9AC;&amp;#xC988;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xACE0; &amp;#xC788;&amp;#xC73C;&amp;#xBA70;, &amp;#xC791;&amp;#xB144;(2020) &amp;#xB9B4;&amp;#xB9AC;&amp;#xC2A4;&amp;#xC778; 20H1 (&amp;#xBC84;&amp;#xC804; 2004)&amp;#xC740; Intel Tiger Lake CPU&amp;#xC5D0;&amp;#xC11C; &amp;#xB9B4;&amp;#xB9AC;&amp;#xC988; &amp;#xB420; CET&amp;#xC758; user mode shadow stack &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xC644;&amp;#xB8CC;&amp;#xD588;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC778;&amp;#xD154; CET&amp;#xB294; &amp;#xC775;&amp;#xC2A4;&amp;#xD50C;&amp;#xB85C;&amp;#xC787;&amp;#xC5D0;&amp;#xC11C; &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &amp;#xB450; &amp;#xAC00;&amp;#xC9C0; &amp;#xC720;&amp;#xD615;&amp;#xC758; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xBB34;&amp;#xACB0;&amp;#xC131; &amp;#xC704;&amp;#xBC18;&amp;#xC778; forward-edge &amp;#xC704;&amp;#xBC18; (indirect CALL &amp;#xBC0F; JMP)&amp;#xACFC; backward-edge &amp;#xC704;&amp;#xBC18; (RET)&amp;#xC744; &amp;#xD574;&amp;#xACB0;&amp;#xD558;&amp;#xB294; &amp;#xD558;&amp;#xB4DC;&amp;#xC6E8;&amp;#xC5B4; &amp;#xAE30;&amp;#xBC18; mitigation&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;forward-edge &amp;#xAD6C;&amp;#xD604;&amp;#xC740; &amp;#xC0C8;&amp;#xB86D;&amp;#xC9C0; &amp;#xC54A;&amp;#xC9C0;&amp;#xB9CC; (&amp;#xAE30;&amp;#xBCF8;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; Microsoft&amp;#xC758; &lt;a href=&#34;https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard&#34;&gt;Control Flow Guard&lt;/a&gt;&amp;#xC640; &amp;#xC720;&amp;#xC0AC;&amp;#xD55C; &amp;#xD615;&amp;#xD0DC;&amp;#xC758; &lt;a href=&#34;https://clang.llvm.org/docs/ControlFlowIntegrity.html&#34;&gt;clang-cfi&lt;/a&gt;&amp;#xC774;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC774;&amp;#xB2E4;.) backward-edge &amp;#xAD6C;&amp;#xD604;&amp;#xC740; ISA&amp;#xC758; &amp;#xADFC;&amp;#xBCF8;&amp;#xC801;&amp;#xC778; &amp;#xBCC0;&amp;#xD654;&amp;#xC5D0; &amp;#xC758;&amp;#xC874;&amp;#xD55C;&amp;#xB2E4;. Shadow Stack &amp;#xC740; CALL &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC5D0; &amp;#xD478;&amp;#xC2DC;&amp;#xB41C; &amp;#xBC18;&amp;#xD658; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xBCF5;&amp;#xC81C;&amp;#xD558;&amp;#xBA70;, RET &amp;#xBA85;&amp;#xB839;&amp;#xC5B4; &amp;#xC2E4;&amp;#xD589; &amp;#xC2DC; &amp;#xC2A4;&amp;#xD0DD; &amp;#xBC0F; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xAC12;&amp;#xC744; &amp;#xBAA8;&amp;#xB450; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xACE0; &amp;#xBD88;&amp;#xC77C;&amp;#xCE58; &amp;#xC2DC; INT #21 (&amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xBCF4;&amp;#xD638; &amp;#xC624;&amp;#xB958;)&amp;#xB97C; &amp;#xC0DD;&amp;#xC131;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C; &amp;#xBC0F; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC;&amp;#xB294; CALL&amp;#xACFC; RET &amp;#xC774;&amp;#xC678;&amp;#xC758; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xC2DC;&amp;#xD000;&amp;#xC2A4;(&amp;#xC608; : &amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xBC0F; &lt;a href=&#34;https://en.cppreference.com/w/cpp/utility/program/longjmp&#34;&gt;longjmp&lt;/a&gt;)&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C; &amp;#xC218;&amp;#xC900;&amp;#xC5D0;&amp;#xC11C; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xB3D9;&amp;#xC791;&amp;#xACFC; &amp;#xC77C;&amp;#xCE58;&amp;#xD558;&amp;#xB3C4;&amp;#xB85D; &lt;code&gt;Shadow Stack Pointer(SSP)&lt;/code&gt; &amp;#xB97C; &amp;#xC870;&amp;#xC791;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xBA70;, &amp;#xC774; &amp;#xC870;&amp;#xC791; &amp;#xC790;&amp;#xCCB4;&amp;#xAC00; &amp;#xC7A0;&amp;#xC7AC;&amp;#xC801;&amp;#xC778; &amp;#xC6B0;&amp;#xD68C;&amp;#xAC00; &amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xB3C4;&amp;#xB85D; &amp;#xAC80;&amp;#xC99D;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAC8C;&amp;#xC2DC;&amp;#xBB3C;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; Windows&amp;#xAC00; &amp;#xC774;&amp;#xB97C; &amp;#xB2EC;&amp;#xC131;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC124;&amp;#xBA85;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;Windows&amp;#xAC00; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; shadow stack&amp;#xC744; &amp;#xC870;&amp;#xC791;&amp;#xD558;&amp;#xACE0; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC790;&amp;#xC138;&amp;#xD788; &amp;#xC54C;&amp;#xC544;&amp;#xBCF4;&amp;#xAE30; &amp;#xC804;&amp;#xC5D0; &amp;#xBA3C;&amp;#xC800; &amp;#xB450; &amp;#xAC00;&amp;#xC9C0;&amp;#xB97C; &amp;#xC774;&amp;#xD574;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xCCAB; &amp;#xBC88;&amp;#xC9F8;&amp;#xB294; SSP&amp;#xC758; &amp;#xC2E4;&amp;#xC81C; &amp;#xC704;&amp;#xCE58; &amp;#xBC0F; &amp;#xAD8C;&amp;#xD55C;&amp;#xC774;&amp;#xACE0; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8;&amp;#xB294; SSP&amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xAC04; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC804;&amp;#xD658; &amp;#xC2DC; &amp;#xC800;&amp;#xC7A5;/&amp;#xBCF5;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xACFC; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xACBD;&amp;#xC6B0; (&amp;#xC608; : &amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xC911;)  SSP &amp;#xC218;&amp;#xC815;&amp;#xC774; &amp;#xC218;&amp;#xD589;&amp;#xB418;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xC744; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xB824;&amp;#xBA74; &lt;a href=&#34;https://en.wikipedia.org/wiki/Advanced_Vector_Extensions&#34;&gt;AVX(Advanced Vector eXtensions)&lt;/a&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; Intel&amp;#xC5D0;&amp;#xC11C; &amp;#xB3C4;&amp;#xC785;&amp;#xD558;&amp;#xACE0; Windows 7&amp;#xBD80;&amp;#xD130; Microsoft&amp;#xAC00; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD55C; Intel CPU &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC54C;&amp;#xC544;&amp;#xBD10;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; &amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xAE30;&amp;#xC874; CONTEXT&amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; CONTEXT_EX&amp;#xAD6C;&amp;#xC870;&amp;#xB85C; &amp;#xC7AC;&amp;#xAD6C;&amp;#xC131;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xB97C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; native API&amp;#xB97C; &amp;#xCD94;&amp;#xAC00;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC5D0; &amp;#xB300;&amp;#xD574;&amp;#xC11C;&amp;#xB3C4; &amp;#xC774;&amp;#xC57C;&amp;#xAE30;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;!&lt;/p&gt;
&lt;p&gt;&amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C; Windows&amp;#xC758; CET &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xCD94;&amp;#xAC00;&amp;#xC801;&amp;#xC778; &amp;#xC694;&amp;#xAD6C;&amp;#xC0AC;&amp;#xD56D;&amp;#xC744; &amp;#xB2E4;&amp;#xB8E8;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC77C;&amp;#xBD80; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC; &amp;#xBC0F; PE &amp;#xD30C;&amp;#xC77C; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC758; &amp;#xB0B4;&amp;#xBD80;&amp;#xC640; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xC815;&amp;#xBCF4; &amp;#xD074;&amp;#xB798;&amp;#xC2A4;&amp;#xB97C; &amp;#xC0B4;&amp;#xD3B4;&amp;#xBD10;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAE00;&amp;#xC758; &amp;#xBAA9;&amp;#xCC28;&amp;#xAC00; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC804;&amp;#xCCB4;&amp;#xC801;&amp;#xC778; &amp;#xB0B4;&amp;#xC6A9;&amp;#xC744; &amp;#xD0D0;&amp;#xC0C9;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xB3C4;&amp;#xC6C0;&amp;#xC774;&amp;#xB418;&amp;#xAE30;&amp;#xB97C; &amp;#xBC14;&amp;#xB780;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; &lt;a href=&#34;https://github.com/yardenshafir/cet-research&#34;&gt;&amp;#xAD00;&amp;#xB828; GitHub &amp;#xC800;&amp;#xC7A5;&amp;#xC18C;&lt;/a&gt;&amp;#xB97C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xD568;&amp;#xC218; &amp;#xC774;&amp;#xB984;&amp;#xC744; &amp;#xD074;&amp;#xB9AD;&amp;#xD558;&amp;#xBA74; &amp;#xC0C8;&amp;#xB85C; &amp;#xB3C4;&amp;#xC785;&amp;#xB41C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xD568;&amp;#xC218;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC8FC;&amp;#xC11D;&amp;#xC774; &amp;#xB2EC;&amp;#xB9B0; &amp;#xC18C;&amp;#xC2A4; &amp;#xCF54;&amp;#xB4DC;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;h1 id=&#34;XState-&amp;#xB0B4;&amp;#xBD80;&#34;&gt;&lt;a href=&#34;#XState-&amp;#xB0B4;&amp;#xBD80;&#34; class=&#34;headerlink&#34; title=&#34;XState &amp;#xB0B4;&amp;#xBD80;&#34;&gt;&lt;/a&gt;XState &amp;#xB0B4;&amp;#xBD80;&lt;/h1&gt;&lt;p&gt;x86-x64 &amp;#xC544;&amp;#xD0A4;&amp;#xD14D;&amp;#xCC98; &amp;#xD074;&amp;#xB798;&amp;#xC2A4; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xB294; &amp;#xBC94;&amp;#xC6A9; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;(RAX, RCX), &amp;#xC81C;&amp;#xC5B4; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; (RIP, RSP&amp;#x2026;), &amp;#xBD80;&amp;#xB3D9; &amp;#xC18C;&amp;#xC218;&amp;#xC810; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; (XMM, YMM, ZMM)&amp;#xC640; &amp;#xC77C;&amp;#xBD80; &amp;#xC81C;&amp;#xC5B4;, &amp;#xB514;&amp;#xBC84;&amp;#xADF8; &amp;#xBC0F; &amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xB4F1; &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; &amp;#xBCF4;&amp;#xC548; &amp;#xC5F0;&amp;#xAD6C;&amp;#xC790;&amp;#xB4E4;&amp;#xC5D0;&amp;#xAC8C; &amp;#xC775;&amp;#xC219;&amp;#xD55C; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xC138;&amp;#xD2B8;&amp;#xB85C; &amp;#xAD6C;&amp;#xC131;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xB354; &amp;#xB9CE;&amp;#xC740; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB428;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xC0C8; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xBC0F; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xACFC; &amp;#xAD00;&amp;#xB828;&amp;#xB41C; &amp;#xD2B9;&amp;#xC815; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD574;&amp;#xC57C; &amp;#xD588;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB9AC;&amp;#xACE0; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5; &amp;#xC911; &amp;#xB9CE;&amp;#xC740; &amp;#xBD80;&amp;#xBD84;&amp;#xC774; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xB0B4;&amp;#xBD80;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC804;&amp;#xD658; &amp;#xC911;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xACE0; &amp;#xBCF5;&amp;#xC6D0;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD574;&amp;#xACB0;&amp;#xCC45;&amp;#xC73C;&amp;#xB85C; &amp;#xC778;&amp;#xD154;&amp;#xC740; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &lt;code&gt;&amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&lt;/code&gt;&amp;#xC758; &amp;#xBE44;&amp;#xD2B8;&amp;#xC640; &amp;#xC5F0;&amp;#xACB0;&amp;#xD558;&amp;#xACE0; &lt;code&gt;XSAVE&lt;/code&gt; &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0;&amp;#xC11C; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC77D;&amp;#xACE0; &amp;#xC4F0;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &lt;code&gt;XSAVE&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;XRSTOR&lt;/code&gt;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xB97C; &amp;#xB3C4;&amp;#xC785;&amp;#xD558;&amp;#xB294; &lt;code&gt;XState(eXtended State)&lt;/code&gt; &lt;a href=&#34;https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developers-manual.pdf&#34;&gt;&amp;#xD45C;&amp;#xC900;&lt;/a&gt;&amp;#xC744; &amp;#xC815;&amp;#xC758;&amp;#xD588;&amp;#xB2E4;. &amp;#xC774; &amp;#xC601;&amp;#xC5ED;&amp;#xC740; &amp;#xAC01; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; CET &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xC800;&amp;#xC7A5;&amp;#xC18C;&amp;#xC758; &amp;#xC911;&amp;#xC694;&amp;#xD55C; &amp;#xBD80;&amp;#xBD84;&amp;#xC774;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; &amp;#xC0AC;&amp;#xB78C;&amp;#xB4E4;&amp;#xC740; &amp;#xAE30;&amp;#xC874; &amp;#xBD80;&amp;#xB3D9; &amp;#xC18C;&amp;#xC218;&amp;#xC810;, AVX &amp;#xBC0F; &lt;a href=&#34;https://software.intel.com/en-us/articles/introduction-to-intel-memory-protection-extensions&#34;&gt;&amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC; &amp;#xBCF4;&amp;#xD638; &amp;#xD655;&amp;#xC7A5;(Memory Protection eXtensions, MPX)&lt;/a&gt; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xCD08;&amp;#xC810;&amp;#xC744; &amp;#xB450;&amp;#xC5C8;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; XSAVE &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xB300;&amp;#xBD80;&amp;#xBD84; &amp;#xBB34;&amp;#xC2DC;&amp;#xD558;&amp;#xACE0; &amp;#xC788;&amp;#xB2E4;. &amp;#xAE30;&amp;#xB2A5; &amp;#xBC0F; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xAC1C;&amp;#xC694;&amp;#xB294; &amp;#xB3C5;&amp;#xC790;&amp;#xC5D0;&amp;#xAC8C; &amp;#xB3C4;&amp;#xC6C0;&amp;#xC774; &amp;#xB420; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;XSAVE-&amp;#xC601;&amp;#xC5ED;&#34;&gt;&lt;a href=&#34;#XSAVE-&amp;#xC601;&amp;#xC5ED;&#34; class=&#34;headerlink&#34; title=&#34;XSAVE &amp;#xC601;&amp;#xC5ED;&#34;&gt;&lt;/a&gt;XSAVE &amp;#xC601;&amp;#xC5ED;&lt;/h2&gt;&lt;p&gt;&amp;#xC55E;&amp;#xC11C; &amp;#xC5B8;&amp;#xAE09;&amp;#xD588;&amp;#xB4EF;&amp;#xC774; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC740; &amp;#xC6D0;&amp;#xB798; Intel&amp;#xC5D0;&amp;#xC11C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00; &amp;#xD55C; AVX&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xBD80;&amp;#xB3D9; &amp;#xC18C;&amp;#xC218;&amp;#xC810; &amp;#xAE30;&amp;#xB2A5; &amp;#xC911; &amp;#xC77C;&amp;#xBD80;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &lt;code&gt;FXSTOR&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;FXRSTR&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC800;&amp;#xC7A5;&amp;#xB418;&amp;#xB294; &amp;#xAE30;&amp;#xC874; x86 FPU &amp;#xBC0F; SSE &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xD1B5;&amp;#xD569;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC774; &amp;#xCC98;&amp;#xC74C; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB294; &lt;code&gt;&amp;#xB808;&amp;#xAC70;&amp;#xC2DC; XSAVE &amp;#xC601;&amp;#xC5ED;&lt;/code&gt;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC815;&amp;#xC758;&amp;#xB418;&amp;#xC5C8;&amp;#xC73C;&amp;#xBA70; &amp;#xCD94;&amp;#xAC00; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; (&amp;#xC608; : AVX)&amp;#xB294; &lt;code&gt;&amp;#xD655;&amp;#xC7A5;&amp;#xB41C; XSAVE &amp;#xC601;&amp;#xC5ED;&lt;/code&gt;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xADF8; &amp;#xC0AC;&amp;#xC774;&amp;#xC5D0; &lt;code&gt;XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xD5E4;&amp;#xB354;&lt;/code&gt; &amp;#xB294; &lt;code&gt;XSTATE_BV&lt;/code&gt;&amp;#xB77C;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC5B4;&amp;#xB5A4; &amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB3D9;&amp;#xC2DC;&amp;#xC5D0; XSAVE &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC6B4;&amp;#xC601;&amp;#xCCB4;&amp;#xC81C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD558;&amp;#xB294; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;code&gt;XCR0(eXtended Control Register)&lt;/code&gt;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xC73C;&amp;#xBA70; XCR0&amp;#xC744; &amp;#xAD6C;&amp;#xC131;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;XGETBV&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;XSETBV&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. (&amp;#xC774;&amp;#xD6C4;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB420; &lt;code&gt;XCR&lt;/code&gt;&amp;#xB3C4; &amp;#xB9C8;&amp;#xCC2C;&amp;#xAC00;&amp;#xC9C0;&amp;#xC774;&amp;#xB2E4;.) &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4; &amp;#xC6B4;&amp;#xC601;&amp;#xCCB4;&amp;#xC81C;&amp;#xB294; x87 FPU &amp;#xBC0F; SSE&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB3C4;&amp;#xB85D;, &amp;#xC989; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &lt;code&gt;FXSTOR&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xC218;&amp;#xB3D9;&amp;#xC73C;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xACE0; &amp;#xD655;&amp;#xC7A5;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB9CC; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB3C4;&amp;#xB85D; XCR0&amp;#xC744; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB798;&amp;#xBC0D;&amp;#xD574; &amp;#xC120;&amp;#xD0DD;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PKRU(Protection Key Register User State)&lt;/code&gt;&amp;#xB97C; &amp;#xCD94;&amp;#xAC00;&amp;#xD55C;  &lt;a href=&#34;https://www.kernel.org/doc/html/latest/core-api/protection-keys.html&#34;&gt;MPK(Memory Protection Key)&lt;/a&gt;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xACE0;&amp;#xAE09; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xC138;&amp;#xD2B8; &amp;#xBC0F; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC218;&amp;#xAC00; &amp;#xC99D;&amp;#xAC00;&amp;#xD568;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xCD5C;&amp;#xC2E0; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xB294; &lt;code&gt;XSAVES&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;XRSRTORS&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; CPL0 &amp;#xCF54;&amp;#xB4DC;&amp;#xB85C;&amp;#xB9CC; &amp;#xC218;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xC288;&amp;#xD37C;&amp;#xBC14;&amp;#xC774;&amp;#xC800; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC640; &amp;#xC555;&amp;#xCD95; &amp;#xBC0F; &amp;#xCD5C;&amp;#xC801;&amp;#xD654; &amp;#xBC84;&amp;#xC804; (&lt;code&gt;XSAVEC&lt;/code&gt; / &lt;code&gt;XSAVEOPT&lt;/code&gt;)&amp;#xC73C;&amp;#xB85C; &amp;#xAD6C;&amp;#xBD84;&amp;#xD574; &amp;#xC778;&amp;#xD154;&amp;#xB9CC;&amp;#xC758; &amp;#xBC29;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD558;&amp;#xAC8C; &amp;#xB9CC;&amp;#xB4E4;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC288;&amp;#xD37C;&amp;#xBC14;&amp;#xC774;&amp;#xC800; &amp;#xC804;&amp;#xC6A9; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;IA32_XSS&lt;/code&gt;&amp;#xB77C;&amp;#xB294; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;code&gt;MSR(Model Specific Register)&lt;/code&gt;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/1.png&#34; alt&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;optimized XSAVE &amp;#xC601;&amp;#xC5ED; vs not optimized XSAVE &amp;#xC601;&amp;#xC5ED;&lt;br&gt;(VX &amp;#xBC0F; CET_U&amp;#xAC00; &amp;#xB178;&amp;#xD2B8; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xACE0; IPT &amp;#xBC0F; PKRU&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5C8;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC804;&amp;#xD658; &amp;#xC774;&amp;#xD6C4;&amp;#xC5D0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;Optimized XSAVE&lt;/code&gt; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xC740; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC2A4;&amp;#xC704;&amp;#xCE58; (&amp;#xC788;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;) &amp;#xC774;&amp;#xD6C4; &amp;#xB2E4;&amp;#xB978; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC218;&amp;#xC815;&amp;#xB41C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB9CC; XSAVE&amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xAE30;&amp;#xB85D;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xAC8C; &amp;#xD574; &amp;#xC8FC;&amp;#xBA70; &amp;#xB0B4;&amp;#xBD80; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB294; &lt;code&gt;XINUSE&lt;/code&gt;&amp;#xC774; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xCD94;&amp;#xC801;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xAC8C; &amp;#xD574; &amp;#xC900;&amp;#xB2E4;. &lt;code&gt;XSAVEOPT&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xB54C; &lt;code&gt;XSTATE_BV&lt;/code&gt; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB294; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xBAA8;&amp;#xB4E0; &amp;#xC0C1;&amp;#xD0DC;&amp;#xAC00; &amp;#xC544;&amp;#xB2C8;&amp;#xB77C; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;&amp;#xD558;&amp;#xB294; &amp;#xBE44;&amp;#xD2B8;&amp;#xB9CC; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xBC18;&amp;#xBA74; &lt;code&gt;Compacted XSAVE&lt;/code&gt; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xC740; &amp;#xAE30;&amp;#xC874; XState &amp;#xB514;&amp;#xC790;&amp;#xC778;&amp;#xC758; &amp;#xACB0;&amp;#xD568;&amp;#xC744; &amp;#xC218;&amp;#xC815;&amp;#xD588;&amp;#xB2E4;. &lt;code&gt;AVX512&lt;/code&gt; &amp;#xBC0F; &lt;a href=&#34;https://software.intel.com/content/www/us/en/develop/blogs/processor-tracing.html&#34;&gt;IPT(Intel Processor Trace)&lt;/a&gt;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xB354; &amp;#xB9CE;&amp;#xC740; &amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB428;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA74; &amp;#xD070; XSAVE&amp;#xC601;&amp;#xC5ED;&amp;#xC744; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0; 0&amp;#xC73C;&amp;#xB85C; &amp;#xAE30;&amp;#xB85D;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &lt;code&gt;Optimized XSAVE&lt;/code&gt;&amp;#xB294; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xB0AD;&amp;#xBE44;&amp;#xB97C; &amp;#xD53C;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC5EC;&amp;#xC804;&amp;#xD788; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xB294; &amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5;&amp;#xC740; &amp;#xAE30;&amp;#xBCF8; XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xBC84;&amp;#xD37C;&amp;#xB85C;&amp;#xBD80;&amp;#xD130; &amp;#xD070; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0; &amp;#xC788;&amp;#xC74C;&amp;#xC744; &amp;#xC758;&amp;#xBBF8;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;XSAVEC&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBA74; &amp;#xD604;&amp;#xC7AC; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xACF5;&amp;#xAC04;&amp;#xB9CC; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xACE0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xAC01; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC21C;&amp;#xCC28;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xC5D0; &amp;#xBC30;&amp;#xCE58;&amp;#xD568;&amp;#xC73C;&amp;#xB85C;&amp;#xC368; &amp;#xBB38;&amp;#xC81C;&amp;#xB97C; &amp;#xD574;&amp;#xACB0;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. (CPUID&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &lt;code&gt;&amp;#xC815;&amp;#xB82C; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&lt;/code&gt;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC81C;&amp;#xACF5;&amp;#xB418;&amp;#xB294; &amp;#xACE0;&amp;#xC815; 64-byte &amp;#xC815;&amp;#xB82C;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.)&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xC804;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xD5E4;&amp;#xB354;&amp;#xB294; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xC778; &lt;code&gt;XCOMP_BV&lt;/code&gt;&amp;#xB85C; &amp;#xD655;&amp;#xC7A5;&amp;#xB418;&amp;#xC5B4; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8; &amp;#xC911; &amp;#xC5B4;&amp;#xB290; &amp;#xAC83;&amp;#xC774; &amp;#xBE44;&amp;#xAD50; &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xC788;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xB098;&amp;#xD0C0;&amp;#xB0B8;&amp;#xB2E4;. &lt;code&gt;XSTATE_BV&lt;/code&gt;&amp;#xC640; &amp;#xB2EC;&amp;#xB9AC; &amp;#xC774; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB294; &lt;code&gt;XINUSE&lt;/code&gt;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xAC00; &amp;#xC544;&amp;#xB2CC; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC0DD;&amp;#xB7B5;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC544; &amp;#xC555;&amp;#xCD95;&amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &lt;code&gt;XSTATE_BV&lt;/code&gt;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC5B4;&amp;#xB5A4; &amp;#xC0C1;&amp;#xD0DC; &amp;#xC601;&amp;#xC5ED;&amp;#xC774; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C;, &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB420; &amp;#xB54C; &amp;#xBE44;&amp;#xD2B8; 63&amp;#xC740; &amp;#xD56D;&amp;#xC0C1; &lt;code&gt;XCOMP_BV&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC9C0;&amp;#xC2DC;&amp;#xC790;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC778;&amp;#xC9C0;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xB0B4;&amp;#xBD80; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xACFC; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xACB0;&amp;#xC815;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC740; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD574;&amp;#xC11C;&amp;#xB9CC; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xB97C; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0;, &amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC740; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xAC00; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xB97C; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xAE30;&amp;#xB2A5;&amp;#xB9CC; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC544;&amp;#xB798; &amp;#xB2E4;&amp;#xC774;&amp;#xC5B4;&amp;#xADF8;&amp;#xB7A8;&amp;#xC740; &amp;#xB3D9;&amp;#xC77C;&amp;#xD55C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC774; &amp;#xC5B4;&amp;#xB5BB;&amp;#xAC8C; &amp;#xBCF4;&amp;#xC774;&amp;#xB294;&amp;#xC9C0;, &amp;#xAC01;&amp;#xAC01;&amp;#xC758; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xB54C;&amp;#xC758; &amp;#xC608;&amp;#xB97C; &amp;#xBCF4;&amp;#xC5EC;&amp;#xC900;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/2.png&#34; alt&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Compacted XSAVE vs not Compacted XSAVE AVX &amp;#xBC0F; CET_U&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;, &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC2E4;&amp;#xD589;&amp;#xB428;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;#xC694;&amp;#xC57D;&amp;#xD558;&amp;#xC790;&amp;#xBA74;,  &lt;code&gt;XSAVE&lt;/code&gt;&amp;#xC640; &lt;code&gt;XRSTOR&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4; &amp;#xC9D1;&amp;#xD569;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xC740; &amp;#xC870;&amp;#xD569;&amp;#xACFC; &amp;#xD568;&amp;#xAED8; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;OS&amp;#xAC00; XCR0&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD560; &amp;#xB54C; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8; (&lt;code&gt;XSETBV&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xC124;&amp;#xC815;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XSAVE&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xB54C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; EDX : EAX&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8; (&amp;#xC778;&amp;#xD154;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xC774;&amp;#xB97C; &lt;code&gt;instruction mask&lt;/code&gt;&amp;#xB77C;&amp;#xACE0; &amp;#xD568;)&lt;/li&gt;
&lt;li&gt;&amp;#xAD8C;&amp;#xD55C;&amp;#xC774; &amp;#xC5C6;&amp;#xB294; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;IA32_XSS&lt;/code&gt;&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XINUSE&lt;/code&gt;&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xC778; &lt;code&gt;&amp;#xCD5C;&amp;#xC801;&amp;#xD654;&amp;#xB41C; XSAVE&lt;/code&gt;&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0;&amp;#xC11C; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xC804;&amp;#xD658; &amp;#xC774;&amp;#xD6C4; &amp;#xD604;&amp;#xC7AC; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C; &amp;#xC2E4;&amp;#xC81C; XState &amp;#xAD00;&amp;#xB828; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB97C; &amp;#xCD94;&amp;#xC801;&amp;#xD558;&amp;#xB294; &amp;#xB0B4;&amp;#xBD80; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xD568;&amp;#xAED8; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD0B9;&amp;#xB418;&amp;#xBA74; &lt;code&gt;XSAVE&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &lt;code&gt;XSTATE_BV&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC758; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xD5E4;&amp;#xB354;&amp;#xC5D0; &amp;#xCD5C;&amp;#xC885; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xAE30;&amp;#xB85D;&amp;#xB41C;&amp;#xB2E4;. &lt;code&gt;Compacted XSAVE&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;XINUSE&lt;/code&gt;&amp;#xB97C; &amp;#xC0DD;&amp;#xB7B5;&amp;#xD55C; &amp;#xACB0;&amp;#xACFC; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00;  &lt;code&gt;XCOMP_BV&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xD5E4;&amp;#xB354;&amp;#xC5D0; &amp;#xAE30;&amp;#xB85D;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC544;&amp;#xB798; &amp;#xB2E4;&amp;#xC774;&amp;#xC5B4;&amp;#xADF8;&amp;#xB7A8;&amp;#xC740; &amp;#xACB0;&amp;#xACFC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xBCF4;&amp;#xC5EC;&amp;#xC900;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/3.png&#34; alt&gt;&lt;/p&gt;
&lt;h2 id=&#34;XState-&amp;#xAD6C;&amp;#xC131;&#34;&gt;&lt;a href=&#34;#XState-&amp;#xAD6C;&amp;#xC131;&#34; class=&#34;headerlink&#34; title=&#34;XState &amp;#xAD6C;&amp;#xC131;&#34;&gt;&lt;/a&gt;XState &amp;#xAD6C;&amp;#xC131;&lt;/h2&gt;&lt;p&gt;&amp;#xAC01; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0;&amp;#xB294; &amp;#xC790;&amp;#xCCB4;&amp;#xC801;&amp;#xC778; XState &amp;#xD65C;&amp;#xC131;&amp;#xD654; &amp;#xAE30;&amp;#xB2A5;, &amp;#xC608;&amp;#xC0C1;&amp;#xB418;&amp;#xB294; &amp;#xD06C;&amp;#xAE30;, &amp;#xAE30;&amp;#xB2A5; &amp;#xBC0F; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998; &amp;#xC138;&amp;#xD2B8;&amp;#xB97C; &amp;#xAC00;&amp;#xC9C0;&amp;#xACE0; &amp;#xC788;&amp;#xC5B4; Intel&amp;#xC740; &amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C;&amp;#xAC00; XState&amp;#xB97C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD560; &amp;#xB54C; &amp;#xCFFC;&amp;#xB9AC; &amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; CPUID &amp;#xD074;&amp;#xB798;&amp;#xC2A4;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xB178;&amp;#xCD9C;&amp;#xD55C;&amp;#xB2E4;. Windows&amp;#xB294; &amp;#xBD80;&amp;#xD305; &amp;#xC2DC; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xCFFC;&amp;#xB9AC;&amp;#xB97C; &amp;#xC218;&amp;#xD589;&amp;#xD558;&amp;#xACE0; &lt;code&gt;XSTATE_CONFIGURATION&lt;/code&gt; &amp;#xC544;&amp;#xB798;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD55C;&amp;#xB2E4;. (Winnt.h&amp;#xC5D0; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB428;)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;XSTATE_CONFIGURATION&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    ULONG64 EnabledFeatures;
    ULONG64 EnabledVolatileFeatures;
    ULONG Size;
    &lt;span class=&#34;hljs-keyword&#34;&gt;union&lt;/span&gt;
    {
        ULONG ControlFlags;
        &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;        {&lt;/span&gt;
            ULONG OptimizedSave:&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;
            ULONG CompactionEnabled:&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;
        };
    };
    XSTATE_FEATURE Features[MAXIMUM_XSTATE_FEATURES];
    ULONG64 EnabledSupervisorFeatures;
    ULONG64 AlignedFeatures;
    ULONG AllFeatureSize;
    ULONG AllFeatures[MAXIMUM_XSTATE_FEATURES];
    ULONG64 EnabledUserVisibleSupervisorFeatures;
} XSTATE_CONFIGURATION, *PXSTATE_CONFIGURATION;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB4E4;&amp;#xC744; &amp;#xBCF4;&amp;#xAD00;&amp;#xD55C; &amp;#xD6C4; &amp;#xCEE4;&amp;#xB110;&amp;#xC740; &lt;code&gt;KUSER_SHARED_DATA&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xB294; &lt;code&gt;SharedUserData&lt;/code&gt; &amp;#xBCC0;&amp;#xC218;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC561;&amp;#xC138;&amp;#xC2A4; &amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; &amp;#xBAA8;&amp;#xB4E0; Windows &amp;#xD50C;&amp;#xB7AB;&amp;#xD3FC;&amp;#xC758; &lt;code&gt;0x7FFE0000&lt;/code&gt; &amp;#xC8FC;&amp;#xC18C;&amp;#xC5D0; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;Optimized, Compacted XSAVE&amp;#xB97C; &amp;#xBAA8;&amp;#xB450; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xACE0; x87 FPU(0), SSE(1), AVX(2) &amp;#xBC0F; MPX(3, 4) &amp;#xAE30;&amp;#xB2A5; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &lt;code&gt;19H1&lt;/code&gt; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC758; &amp;#xCD9C;&amp;#xB825;&amp;#xC744; &amp;#xC608;&amp;#xB85C; &amp;#xB4E4; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx ((nt!_KUSER_SHARED_DATA*)&lt;span class=&#34;hljs-number&#34;&gt;0x7ffe0000&lt;/span&gt;)-&amp;gt;XState
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] EnabledFeatures  : &lt;span class=&#34;hljs-number&#34;&gt;0x1f&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] EnabledVolatileFeatures : &lt;span class=&#34;hljs-number&#34;&gt;0xf&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x010&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x3c0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x014&lt;/span&gt;] ControlFlags     : &lt;span class=&#34;hljs-number&#34;&gt;0x3&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x014&lt;/span&gt; ( &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;: &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;)] OptimizedSave    : &lt;span class=&#34;hljs-number&#34;&gt;0x1&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x014&lt;/span&gt; ( &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;: &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)] CompactionEnabled : &lt;span class=&#34;hljs-number&#34;&gt;0x1&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x018&lt;/span&gt;] Features         [Type: _XSTATE_FEATURE [&lt;span class=&#34;hljs-number&#34;&gt;64&lt;/span&gt;]]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x218&lt;/span&gt;] EnabledSupervisorFeatures : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x220&lt;/span&gt;] AlignedFeatures  : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x228&lt;/span&gt;] AllFeatureSize   : &lt;span class=&#34;hljs-number&#34;&gt;0x3c0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x22c&lt;/span&gt;] AllFeatures      [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt; [&lt;span class=&#34;hljs-number&#34;&gt;64&lt;/span&gt;]]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x330&lt;/span&gt;] EnabledUserVisibleSupervisorFeatures : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Features &amp;#xBC30;&amp;#xC5F4;&amp;#xC5D0;&amp;#xC11C; &amp;#xB2E4;&amp;#xC74C; 5&amp;#xAC00;&amp;#xC9C0; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx -r2 (((nt!_KUSER_SHARED_DATA*)&lt;span class=&#34;hljs-number&#34;&gt;0x7ffe0000&lt;/span&gt;)-&amp;gt;XState)-&amp;gt;Features.Take(&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;)
    [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0xa0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0xa0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x100&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0x240&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x100&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0x340&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x40&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0x380&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x40&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xD569;&amp;#xD558;&amp;#xBA74; &amp;#xC704;&amp;#xC758; &lt;code&gt;FeatureSize&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xAC12;&amp;#xC778; &lt;code&gt;0x3C0&lt;/code&gt;&amp;#xC774; &amp;#xB41C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC774; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC740; &lt;code&gt;Compacted XSAVE&lt;/code&gt; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &amp;#xC5EC;&amp;#xAE30;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC740; &amp;#xAD00;&amp;#xB828;&amp;#xC774; &amp;#xC5C6;&amp;#xC73C;&amp;#xBA70; &amp;#xBAA8;&amp;#xB4E0; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC740; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB294; &amp;#xCEE4;&amp;#xB110;&amp;#xC5D0;&amp;#xB9CC; &amp;#xC720;&amp;#xC6A9;&amp;#xD558;&amp;#xAC8C; &amp;#xC0AC;&amp;#xC6A9; &amp;#xAC00;&amp;#xB2A5;&amp;#xD558;&amp;#xB2E4;.(&lt;code&gt;XCOMP_BV&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &amp;#xC555;&amp;#xCD95; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xACB0;&amp;#xC815;&amp;#xB418;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;)&lt;/p&gt;
&lt;h2 id=&#34;XState-&amp;#xC815;&amp;#xCC45;&#34;&gt;&lt;a href=&#34;#XState-&amp;#xC815;&amp;#xCC45;&#34; class=&#34;headerlink&#34; title=&#34;XState &amp;#xC815;&amp;#xCC45;&#34;&gt;&lt;/a&gt;XState &amp;#xC815;&amp;#xCC45;&lt;/h2&gt;&lt;p&gt;&amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xAC00; XState&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xD558;&amp;#xB4DC;&amp;#xC6E8;&amp;#xC5B4; &amp;#xC624;&amp;#xB958; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xD2B9;&amp;#xC815; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xAC00; &amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC81C;&amp;#xB300;&amp;#xB85C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xC9C0; &amp;#xBABB;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xAC00; &amp;#xC885;&amp;#xC885; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xBB38;&amp;#xC81C;&amp;#xB97C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; Windows&amp;#xB294; &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC73C;&amp;#xB85C;  &amp;#xB77C;&amp;#xACE0; &amp;#xD558;&amp;#xB294; &amp;#xD558;&amp;#xB4DC;&amp;#xC6E8;&amp;#xC5B4; &amp;#xC815;&amp;#xCC45; &amp;#xB4DC;&amp;#xB77C;&amp;#xC774;&amp;#xBC84;&amp;#xC778; &lt;code&gt;HwPolicy.sys&lt;/code&gt; &amp;#xC758; &amp;#xB9AC;&amp;#xC18C;&amp;#xC2A4; &amp;#xC139;&amp;#xC158;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; XState &amp;#xC815;&amp;#xCC45;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;Intel x86 &amp;#xC544;&amp;#xD0A4;&amp;#xD14D;&amp;#xCC98;&amp;#xB294; &amp;#xC5EC;&amp;#xB7EC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xBCA4;&amp;#xB354; &amp;#xC911; &amp;#xD558;&amp;#xB098;&amp;#xC774;&amp;#xBBC0;&amp;#xB85C; &amp;#xCEE4;&amp;#xB110;&amp;#xC740; XState &amp;#xC815;&amp;#xCC45;&amp;#xC744; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xD558;&amp;#xACE0; &amp;#xD604;&amp;#xC7AC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC758; &amp;#xBCA4;&amp;#xB354; &amp;#xBB38;&amp;#xC790;&amp;#xC5F4; &amp;#xBC0F; &amp;#xB9C8;&amp;#xC774;&amp;#xD06C;&amp;#xB85C;&amp;#xCF54;&amp;#xB4DC; &amp;#xBC84;&amp;#xC804;&amp;#xBFD0;&amp;#xB9CC; &amp;#xC544;&amp;#xB2C8;&amp;#xB77C; &amp;#xC2DC;&amp;#xADF8;&amp;#xB2C8;&amp;#xCC98;, &amp;#xAE30;&amp;#xB2A5; &amp;#xBC0F; &amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xBE44;&amp;#xAD50;&amp;#xD558;&amp;#xACE0; (&amp;#xC989;, CPUID 01h &amp;#xCFFC;&amp;#xB9AC;&amp;#xC758; RAX, RDX &amp;#xBC0F; RCX), &amp;#xC815;&amp;#xCC45;&amp;#xC5D0;&amp;#xC11C; &amp;#xC77C;&amp;#xCE58;&amp;#xD558;&amp;#xB294; &amp;#xD56D;&amp;#xBAA9;&amp;#xC744; &amp;#xCC3E;&amp;#xB294;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xC791;&amp;#xC5C5;&amp;#xC740; &amp;#xBD80;&amp;#xD305; &amp;#xC2DC;&amp;#xC5D0; &lt;code&gt;KiInitializeXSave&lt;/code&gt;&amp;#xAC00; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xB294; &lt;code&gt;KiIntersectFeaturesWithPolicy&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xC5D0;&amp;#xC11C; &amp;#xC218;&amp;#xD589;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xB294; &lt;code&gt;KiLoadPolicyFromImage&lt;/code&gt; &amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xC801;&amp;#xC808;&amp;#xD55C; XState &amp;#xC815;&amp;#xCC45;&amp;#xC744; &amp;#xB85C;&amp;#xB4DC;&amp;#xD558;&amp;#xACE0; &lt;code&gt;KiGetProcessorInformation&lt;/code&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; CPU&amp;#xC758; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC628; &amp;#xB2E4;&amp;#xC74C; XState &amp;#xAD6C;&amp;#xC131;&amp;#xC5D0;&amp;#xC11C; &amp;#xD604;&amp;#xC7AC; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xAC01; &amp;#xAE30;&amp;#xB2A5; &amp;#xBE44;&amp;#xD2B8;&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &lt;code&gt;KiIsXSaveFeatureAllowed&lt;/code&gt; &amp;#xD638;&amp;#xCD9C;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC740; &lt;code&gt;HwPolicy.sys&lt;/code&gt; &amp;#xB4DC;&amp;#xB77C;&amp;#xC774;&amp;#xBC84;&amp;#xC758; &amp;#xB9AC;&amp;#xC18C;&amp;#xC2A4; 101&amp;#xC5D0;&amp;#xC11C; &amp;#xC791;&amp;#xB3D9;&amp;#xD558;&amp;#xBA70; &amp;#xAD6C;&amp;#xC870;&amp;#xB294; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;XSAVE_POLICY&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    ULONG Version;
    ULONG Size;
    ULONG Flags;
    ULONG MaxSaveAreaLength;
    ULONGLONG FeatureBitmask;
    ULONG NumberOfFeatures;
    XSAVE_FEATURE Features[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;];
} XSAVE_POLICY, *PXSAVE_POLICY;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4;,  &lt;code&gt;19H1&lt;/code&gt; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xC11C; &amp;#xB9AC;&amp;#xC18C;&amp;#xC2A4; &amp;#xD574;&amp;#xCEE4;&amp;#xB85C; &amp;#xCD94;&amp;#xCD9C;&amp;#xD55C; &amp;#xB0B4;&amp;#xC6A9;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx @$policy = (_XSAVE_POLICY*)&lt;span class=&#34;hljs-number&#34;&gt;0x253d0e90000&lt;/span&gt;
[+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Version       : &lt;span class=&#34;hljs-number&#34;&gt;0x3&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size          : &lt;span class=&#34;hljs-number&#34;&gt;0x2fd8&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] Flags         : &lt;span class=&#34;hljs-number&#34;&gt;0x9&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x00c&lt;/span&gt;] MaxSaveAreaLength : &lt;span class=&#34;hljs-number&#34;&gt;0x2000&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x010&lt;/span&gt;] FeatureBitmask   : &lt;span class=&#34;hljs-number&#34;&gt;0x7fffffffffffffff&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x018&lt;/span&gt;] NumberOfFeatures : &lt;span class=&#34;hljs-number&#34;&gt;0x3f&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x020&lt;/span&gt;] Features      [Type: _XSAVE_FEATURE [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xAC01; &lt;code&gt;XSAVE_FEATURE&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xAC01;&amp;#xAC01; CPU &amp;#xACF5;&amp;#xAE09; &amp;#xC5C5;&amp;#xCCB4; &amp;#xBB38;&amp;#xC790;&amp;#xC5F4;&amp;#xC774; &amp;#xC788;&amp;#xB294; &lt;code&gt;XSAVE_VENDOR&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xBC30;&amp;#xC5F4;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &lt;code&gt;XSAVE_VENDORS&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xACFC; (&amp;#xC9C0;&amp;#xAE08;&amp;#xC740; &amp;#xAC01;&amp;#xAC01; &amp;#x201C;GenuineIntel&amp;#x201D;, &amp;#x201C;AuthenticAMD&amp;#x201D; &amp;#xB610;&amp;#xB294; &amp;#x201C;CentaurHauls&amp;#x201D;) &lt;code&gt;XSAVE_CPU_ERRATA&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4;, &lt;code&gt;19H1&lt;/code&gt; &amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xB294; &amp;#xAE30;&amp;#xB2A5; 0&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB2E4;&amp;#xC74C; &amp;#xC815;&amp;#xBCF4;&amp;#xAC00; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx -r4 @$vendor = (XSAVE_VENDORS*)((&lt;span class=&#34;hljs-keyword&#34;&gt;int&lt;/span&gt;)@$policy-&amp;gt;Features[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;].Vendors + &lt;span class=&#34;hljs-number&#34;&gt;0x253d0e90000&lt;/span&gt;)
[+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] NumberOfVendors  : &lt;span class=&#34;hljs-number&#34;&gt;0x3&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] Vendor        [Type: _XSAVE_VENDOR [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]]
    [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]           [Type: _XSAVE_VENDOR]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] VendorId      [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt; [&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;]]
            [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]           : &lt;span class=&#34;hljs-number&#34;&gt;0x756e6547&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
            [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]           : &lt;span class=&#34;hljs-number&#34;&gt;0x49656e69&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
            [&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;]           : &lt;span class=&#34;hljs-number&#34;&gt;0x6c65746e&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x010&lt;/span&gt;] SupportedCpu  [Type: _XSAVE_SUPPORTED_CPU]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] CpuInfo       [Type: XSAVE_CPU_INFO]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x020&lt;/span&gt;] CpuErrata     : &lt;span class=&#34;hljs-number&#34;&gt;0x4c0&lt;/span&gt; [Type: XSAVE_CPU_ERRATA *]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x020&lt;/span&gt;] Unused        : &lt;span class=&#34;hljs-number&#34;&gt;0x4c0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C;, &amp;#xAC01; &lt;code&gt;XSAVE_CPU_ERRATA&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xB294; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; XState &amp;#xC9C0;&amp;#xC6D0;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC624;&amp;#xB958; &amp;#xC815;&amp;#xBCF4;&amp;#xC640; &amp;#xC77C;&amp;#xCE58;&amp;#xD558;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC815;&amp;#xBCF4; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4;, &amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC704;&amp;#xC758; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0;&amp;#xC11C; &amp;#xCCAB; &amp;#xBC88;&amp;#xC9F8; &amp;#xC5D0;&amp;#xB77C;&amp;#xD0C0;&amp;#xB294; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx -r3 @$errata = (XSAVE_CPU_ERRATA*)((&lt;span class=&#34;hljs-keyword&#34;&gt;int&lt;/span&gt;)@$vendor-&amp;gt;Vendor[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;].SupportedCpu.CpuErrata + &lt;span class=&#34;hljs-number&#34;&gt;0x253d0e90000&lt;/span&gt;)
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] NumberOfErrata   : &lt;span class=&#34;hljs-number&#34;&gt;0x1&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] Errata           [Type: XSAVE_CPU_INFO [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]]
        [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]              [Type: XSAVE_CPU_INFO]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Processor        : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x002&lt;/span&gt;] Family           : &lt;span class=&#34;hljs-number&#34;&gt;0x6&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;short&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Model            : &lt;span class=&#34;hljs-number&#34;&gt;0xf&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;short&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x006&lt;/span&gt;] Stepping         : &lt;span class=&#34;hljs-number&#34;&gt;0xb&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;short&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] ExtendedModel    : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;short&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x00c&lt;/span&gt;] ExtendedFamily   : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x010&lt;/span&gt;] MicrocodeVersion : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x018&lt;/span&gt;] Reserved         : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xBAA8;&amp;#xB4E0; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC758; &amp;#xD558;&amp;#xB4DC;&amp;#xC6E8;&amp;#xC5B4; &amp;#xC815;&amp;#xCC45; &amp;#xB364;&amp;#xD504; &amp;#xD234;&amp;#xC740; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/tree/master/Xpolicy&#34;&gt;&amp;#xC5EC;&amp;#xAE30;&lt;/a&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC9C0;&amp;#xAE08;&amp;#xC740; &amp;#xC804;&amp;#xCCB4; &amp;#xC815;&amp;#xCC45;(&amp;#xC704;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xAC83;)&amp;#xC5D0; &amp;#xD558;&amp;#xB098;&amp;#xC758; &amp;#xC5D0;&amp;#xB77C;&amp;#xD0C0;&amp;#xB9CC; &amp;#xB098;&amp;#xD0C0;&amp;#xB09C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C; &amp;#xB2E4;&amp;#xC74C; &amp;#xC635;&amp;#xC158; &amp;#xB85C;&amp;#xB354; &amp;#xBA85;&amp;#xB839;&amp;#xC904; &amp;#xC635;&amp;#xC158;(&amp;#xBC0F; &amp;#xAC01; BCD &amp;#xC124;&amp;#xC815;)&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xCD94;&amp;#xAC00;&amp;#xB85C; &amp;#xCEE4;&amp;#xC2A4;&amp;#xD130;&amp;#xB9C8;&amp;#xC774;&amp;#xC9D5;&amp;#xC774; &amp;#xAC00;&amp;#xB2A5;&amp;#xD558;&amp;#xB2E4;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;XSAVEPOLICY = n&lt;/code&gt; &amp;#xB85C;&amp;#xB4DC; &amp;#xC635;&amp;#xC158;&amp;#xC740; &lt;code&gt;xsavepolicy&lt;/code&gt; BCD &amp;#xC635;&amp;#xC158;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xBA70; &lt;code&gt;KeXSavePolicyId&lt;/code&gt;&amp;#xB97C; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xC5EC; &amp;#xB85C;&amp;#xB4DC;&amp;#xD560; XState &amp;#xC815;&amp;#xCC45;&amp;#xC744; &amp;#xB098;&amp;#xD0C0;&amp;#xB0B8;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XSAVEREMOVEFEATURE = n&lt;/code&gt;&amp;#xB85C;&amp;#xB4DC; &amp;#xC635;&amp;#xC158;&amp;#xC740; &lt;code&gt;xsaveremovefeature&lt;/code&gt; BCD&amp;#xC635;&amp;#xC158;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xBA70; &lt;code&gt;KeTestRemovedFeatureMask&lt;/code&gt; &amp;#xB97C; &amp;#xC124;&amp;#xC815;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xB294; &amp;#xB098;&amp;#xC911;&amp;#xC5D0; &lt;code&gt;KiInitializeXSave&lt;/code&gt;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xB418;&amp;#xACE0; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC81C;&amp;#xAC70;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC0C1;&amp;#xD0DC; 0 (x87 FPU) &amp;#xBC0F; &amp;#xC0C1;&amp;#xD0DC; 1 (SSE)&amp;#xC740; &amp;#xC774; &amp;#xBC29;&amp;#xBC95;&amp;#xC73C;&amp;#xB85C; &amp;#xC81C;&amp;#xAC70;&amp;#xD560; &amp;#xC218; &amp;#xC5C6;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XSAVEDISABLE&lt;/code&gt; &amp;#xB85C;&amp;#xB4DC; &amp;#xC635;&amp;#xC158;&amp;#xC740; &lt;code&gt;xsavedisable&lt;/code&gt; BCD &amp;#xC635;&amp;#xC158;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xC5B4; &lt;code&gt;KeTestDisableXsave&lt;/code&gt;&amp;#xB97C; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xACE0; &lt;code&gt;KiInitializeXSave&lt;/code&gt;&amp;#xAC00; &amp;#xBAA8;&amp;#xB4E0; XState &amp;#xAD6C;&amp;#xC131; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; 0&amp;#xC73C;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xC5EC; &amp;#xC804;&amp;#xCCB4; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xBE44;&amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;CET-XSAVE-&amp;#xC601;&amp;#xC5ED;-&amp;#xD3EC;&amp;#xB9F7;&#34;&gt;&lt;a href=&#34;#CET-XSAVE-&amp;#xC601;&amp;#xC5ED;-&amp;#xD3EC;&amp;#xB9F7;&#34; class=&#34;headerlink&#34; title=&#34;CET XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xD3EC;&amp;#xB9F7;&#34;&gt;&lt;/a&gt;CET XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xD3EC;&amp;#xB9F7;&lt;/h2&gt;&lt;p&gt;CET &amp;#xAD6C;&amp;#xD604;&amp;#xC758; &amp;#xC77C;&amp;#xD658;&amp;#xC73C;&amp;#xB85C; Intel&amp;#xC740; &lt;code&gt;XSTATE_CET_U(11)&lt;/code&gt;&amp;#xC640; &lt;code&gt;XSTATE_CET_S(12)&lt;/code&gt;&amp;#xB77C;&amp;#xACE0; &amp;#xD558;&amp;#xB294; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBC0F; &amp;#xC288;&amp;#xD37C;&amp;#xBC14;&amp;#xC774;&amp;#xC800; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC5D0; &amp;#xAC01;&amp;#xAC01; &amp;#xB300;&amp;#xC751;&amp;#xD558;&amp;#xB3C4;&amp;#xB85D; &amp;#xC815;&amp;#xC758;&amp;#xD588;&amp;#xB2E4;. &amp;#xCCAB; &amp;#xBC88;&amp;#xC9F8; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB294; &lt;code&gt;XSAVE_CET_U_FORMAT&lt;/code&gt;&amp;#xC73C;&amp;#xB85C; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB41C; 16&amp;#xBC14;&amp;#xC774;&amp;#xD2B8; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xB85C;, &lt;code&gt;IA32_U_CET&lt;/code&gt; MSR(&lt;code&gt;Shadow Stack Enable&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xAD6C;&amp;#xC131;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0;) &amp;#xBC0F; &lt;code&gt;IA32_PL3_SSPMSR&lt;/code&gt; (Privile 3 &amp;#xC218;&amp;#xC900;)&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC544;&amp;#xC9C1; MSDN &amp;#xC815;&amp;#xC758;&amp;#xAC00; &amp;#xC5C6;&amp;#xB294; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8; &amp;#xBC29;&amp;#xBC95;&amp;#xC740; &lt;code&gt;IA32_PL0/1/2_SSP&lt;/code&gt; MSR&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;XSAVE_CET_U_FORMAT&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    ULONG64 Ia32CetUMsr;
    ULONG64 Ia32Pl3SspMsr;
} XSAVE_CET_U_FORMAT, *PXSAVE_CET_U_FORMAT;

&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;XSAVE_CET_S_FORMAT&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    ULONG64 Ia32Pl0SspMsr;
    ULONG64 Ia32Pl1SspMsr;
    ULONG64 Ia32Pl2SspMsr;
} XSAVE_CET_S_FORMAT, *PXSAVE_CET_S_FORMAT;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xD544;&amp;#xB4DC; &amp;#xC774;&amp;#xB984;&amp;#xC5D0;&amp;#xC11C; &amp;#xC54C; &amp;#xC218; &amp;#xC788;&amp;#xB4EF;&amp;#xC774; CET &amp;#xAD00;&amp;#xB828; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB294; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xAC01; MSR&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xAC12;&amp;#xC774;&amp;#xBA70;, &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; Ring 0&amp;#xC758; RDMSR &amp;#xBC0F; WRMSR &amp;#xAD8C;&amp;#xD55C;&amp;#xC774; &amp;#xC788;&amp;#xB294; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xD1B5;&amp;#xD574;&amp;#xC11C;&amp;#xB9CC; &amp;#xC561;&amp;#xC138;&amp;#xC2A4; &amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC804;&amp;#xC5ED; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; MSR&amp;#xACFC; &amp;#xB2EC;&amp;#xB9AC; CET&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xB2E8;&amp;#xC704;&amp;#xB85C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; Shadow stack pointer&amp;#xB3C4; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xB2E8;&amp;#xC704;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC774;&amp;#xC720;&amp;#xB85C; CET &amp;#xAD00;&amp;#xB828; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB294; &amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C;&amp;#xAC00; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xC2A4;&amp;#xC704;&amp;#xCE58;&amp;#xB97C; &amp;#xC62C;&amp;#xBC14;&amp;#xB974;&amp;#xAC8C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB3C4;&amp;#xB85D; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xAD6C;&amp;#xD604;&amp;#xB418;&amp;#xC5B4;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CET &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB294; &amp;#xAE30;&amp;#xBCF8;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xCEE4;&amp;#xB110; &amp;#xCF54;&amp;#xB4DC;&amp;#xB85C;&amp;#xB9CC; &amp;#xC218;&amp;#xC815; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; MSR&amp;#xC774;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &lt;code&gt;CPL3 XSAVE/XRSTOR&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC811;&amp;#xADFC;&amp;#xD560; &amp;#xC218; &amp;#xC5C6;&amp;#xC73C;&amp;#xBA70; &amp;#xAC01;&amp;#xAC01;&amp;#xC758; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB294; &lt;code&gt;IA32_XSS&lt;/code&gt; MSR&amp;#xC5D0;&amp;#xC11C; &amp;#xD56D;&amp;#xC0C1; 1&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB41C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC6B4;&amp;#xC601;&amp;#xCCB4;&amp;#xC81C;&amp;#xAC00; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC;&amp;#xC758; &amp;#xCF54;&amp;#xB4DC;&amp;#xAC00; SSP&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC744; &amp;#xC644;&amp;#xC804;&amp;#xD788; &amp;#xCC28;&amp;#xB2E8;&amp;#xD560; &amp;#xC218;&amp;#xB294; &amp;#xC5C6;&amp;#xB2E4;. &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC;&amp;#xC758; &amp;#xCF54;&amp;#xB4DC;&amp;#xB294; &amp;#xC608;&amp;#xC678; &amp;#xCC98;&amp;#xB9AC;, unwinding, jmp/longjmp &amp;#xB610;&amp;#xB294; Windows&amp;#xC758; &lt;code&gt;Fiber&lt;/code&gt; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xACFC; &amp;#xAC19;&amp;#xC740; &amp;#xD2B9;&amp;#xC815; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD574; SSP&amp;#xB97C; &amp;#xC5C5;&amp;#xB370;&amp;#xC774;&amp;#xD2B8;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB530;&amp;#xB77C;&amp;#xC11C; Windows&amp;#xAC00; CS &amp;#xBC0F; DR7&amp;#xACFC; &amp;#xAC19;&amp;#xC740; &amp;#xD2B9;&amp;#xC815; &amp;#xBCF4;&amp;#xD638;&amp;#xB41C; CPU &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB97C; &amp;#xC5C5;&amp;#xB370;&amp;#xC774;&amp;#xD2B8;&amp;#xD558;&amp;#xB294; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xC73C;&amp;#xB85C; &lt;a href=&#34;https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadcontext&#34;&gt;SetThreadContext&lt;/a&gt;&amp;#xB97C; &amp;#xC81C;&amp;#xACF5;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xCC98;&amp;#xB7FC; &amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C;&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xAC00; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C; &amp;#xD638;&amp;#xCD9C;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; XSate&amp;#xC5D0;&amp;#xC11C; CET &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC744; &amp;#xC81C;&amp;#xACF5;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xB2E4;&amp;#xC74C; &amp;#xC139;&amp;#xC158;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; XState &amp;#xAD00;&amp;#xB828; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xD604;&amp;#xB300;&amp;#xC758; Windows &amp;#xBC84;&amp;#xC804;&amp;#xC5D0;&amp;#xC11C; &lt;a href=&#34;https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-wow64_context&#34;&gt;CONTEXT&lt;/a&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xAC00; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xB85C; &amp;#xC5B4;&amp;#xB5BB;&amp;#xAC8C; &amp;#xBC1C;&amp;#xC804;&amp;#xD588;&amp;#xB294;&amp;#xC9C0;, &amp;#xADF8;&amp;#xB9AC;&amp;#xACE0; &amp;#xC608;&amp;#xC678; &amp;#xAD00;&amp;#xB828; &amp;#xC2DC;&amp;#xB098;&amp;#xB9AC;&amp;#xC624;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; CET &amp;#xAD00;&amp;#xB828; &amp;#xCC98;&amp;#xB9AC;&amp;#xB97C; &amp;#xCD94;&amp;#xAC00;&amp;#xD558;&amp;#xB294; &amp;#xB3D9;&amp;#xC2DC;&amp;#xC5D0; &amp;#xC190;&amp;#xC0C1;&amp;#xB41C; CONTEXT&amp;#xB97C; &amp;#xD1B5;&amp;#xD55C; &amp;#xC545;&amp;#xC758;&amp;#xC801;&amp;#xC778; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xACF5;&amp;#xACA9;&amp;#xC744; &amp;#xBC29;&amp;#xC9C0;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC5D0; &amp;#xB300;&amp;#xD574;&amp;#xC11C; &amp;#xC54C;&amp;#xC544;&amp;#xBCF8;&amp;#xB2E4;.&lt;/p&gt;
&lt;h1 id=&#34;CONTEXT-EX-&amp;#xB0B4;&amp;#xBD80;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX-&amp;#xB0B4;&amp;#xBD80;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX &amp;#xB0B4;&amp;#xBD80;&#34;&gt;&lt;/a&gt;CONTEXT_EX &amp;#xB0B4;&amp;#xBD80;&lt;/h1&gt;&lt;p&gt;&amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC2A4;&amp;#xC704;&amp;#xCE58;&amp;#xB97C; &amp;#xD560; &amp;#xB54C; &amp;#xC800;&amp;#xC7A5;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xC758; &amp;#xC218;&amp;#xAC00; &amp;#xC810;&amp;#xC810; &amp;#xB298;&amp;#xC5B4;&amp;#xB098;&amp;#xACE0;, &amp;#xC774;&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xBC84;&amp;#xC804;&amp;#xC758; Windows&amp;#xB294; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT &amp;#xAD6C;&amp;#xC870; &amp;#xC678;&amp;#xC5D0;&amp;#xB3C4; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xB3C4;&amp;#xC785;&amp;#xD588;&amp;#xB2E4;. CONTEXT_EX&amp;#xB294; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT&amp;#xAC00; &amp;#xACE0;&amp;#xC815; &amp;#xD06C;&amp;#xAE30;&amp;#xC778; &amp;#xBC18;&amp;#xBA74; XSAVE&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;, &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xBC0F; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C; &amp;#xAD6C;&amp;#xC131; &amp;#xC815;&amp;#xCC45;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xB3D9;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xC870;&amp;#xC815;&amp;#xB418;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xAD6C;&amp;#xC870;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xB3C4;&amp;#xC785;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;CONTEXT-EX-&amp;#xAD6C;&amp;#xC870;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX-&amp;#xAD6C;&amp;#xC870;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&#34;&gt;&lt;/a&gt;CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&lt;/h2&gt;&lt;p&gt;CONTEXT_EX&amp;#xB294; &amp;#xD604;&amp;#xC7AC; &amp;#xCEE4;&amp;#xB110; &amp;#xBC0F; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678; &amp;#xCC98;&amp;#xB9AC; &amp;#xAE30;&amp;#xB2A5; &amp;#xC804;&amp;#xCCB4;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0;&amp;#xB9CC; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC740; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC558;&amp;#xB2E4;. Windows 7 &amp;#xD5E4;&amp;#xB354; &amp;#xD30C;&amp;#xC77C; &amp;#xBC0F; &amp;#xC77C;&amp;#xBD80; intel&amp;#xC758; reference code&amp;#xC5D0; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xB294; &amp;#xC77C;&amp;#xBD80; &amp;#xC815;&amp;#xBCF4;&amp;#xAC00; &amp;#xC2E4;&amp;#xC218;&amp;#xB85C; &amp;#xACF5;&amp;#xAC1C;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xB3C4;&amp;#xB85D; &amp;#xD588;&amp;#xC74C;&amp;#xC744; &amp;#xC54C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xB2E4;&amp;#xC74C; &amp;#xCF54;&amp;#xB4DC;&amp;#xC758; &amp;#xC8FC;&amp;#xC11D;&amp;#xC744; &amp;#xBCF4;&amp;#xACE0; &amp;#xC774;&amp;#xD574;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xAC83;&amp;#xC774; &amp;#xC788;&amp;#xC73C;&amp;#xBA74; &amp;#xC54C;&amp;#xB824;&amp;#xC8FC;&amp;#xC5C8;&amp;#xC73C;&amp;#xBA74; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xC774; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xB294; CONTEXT_EX&amp;#xC758; &amp;#xB2E8;&amp;#xC77C; &amp;#xCCAD;&amp;#xD06C; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xC624;&amp;#xD504;&amp;#xC14B;(CONTEXT_EX &amp;#xAD6C;&amp;#xC870; &amp;#xC2DC;&amp;#xC791;&amp;#xBD80;&amp;#xD130;)&amp;#xC744; &amp;#xC9C0;&amp;#xC815;&amp;#xD55C;&amp;#xB2E4;.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// N.B. &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC740; &amp;#xC74C;&amp;#xC218;&amp;#xC77C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;CONTEXT_CHUNK&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    LONG Offset;
    DWORD Length;
} CONTEXT_CHUNK, *PCONTEXT_CHUNK;

&lt;span class=&#34;hljs-comment&#34;&gt;// CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xB294; &amp;#xB294; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xC758; &amp;#xD655;&amp;#xC7A5;&amp;#xC774;&amp;#xB2E4;. &lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xB808;&amp;#xCF54;&amp;#xB4DC;&amp;#xB97C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &amp;#xBD84;&amp;#xB9AC;&amp;#xB41C; &amp;#xAC00;&amp;#xBCC0;&amp;#xD06C;&amp;#xAE30; &amp;#xBC84;&amp;#xD37C;(&amp;#xCCAD;&amp;#xD06C;) &amp;#xC138;&amp;#xD2B8;&amp;#xB85C; &lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xC815;&amp;#xC758;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD604;&amp;#xC7AC; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xBC84;&amp;#xD37C;(&amp;#xCCAD;&amp;#xD06C;)&amp;#xB9CC; &amp;#xC815;&amp;#xC758;&amp;#xB41C;&amp;#xB2E4;:&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// - &amp;#xAE30;&amp;#xC874; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// - XSAVE &amp;#xC800;&amp;#xC7A5; &amp;#xC601;&amp;#xC5ED; &amp;#xBC84;&amp;#xD37C;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; XState&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// XSAVE_AREA_HEADER, i.e. without the first 512 bytes.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// PCONTEXT &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; PCONTEXT_EX &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB85C; &amp;#xBCC0;&amp;#xD658;&amp;#xD558;&amp;#xB294; &amp;#xBA87; &amp;#xAC00;&amp;#xC9C0; &amp;#xAC00;&amp;#xC815;&amp;#xC774; &amp;#xC788;&amp;#xB2E4;.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// 1. PCONTEXT &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xC791;&amp;#xB3D9;&amp;#xD558;&amp;#xB294; API&amp;#xB294; CONTEXT_EX&amp;#xAC00; CONTEXT &amp;#xAD6C;&amp;#xC870; &amp;#xBC14;&amp;#xB85C; &amp;#xB4A4;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C;&amp;#xB2E4;&amp;#xACE0; &amp;#xAC00;&amp;#xC815;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//    &amp;#xB610;&amp;#xD55C; CONTEXT_EX&amp;#xB294; &amp;#xD574;&amp;#xB2F9; CONTEXT_XXX &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; CONTEXT.ContextFlags&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB9CC; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;&amp;#xACE0; &amp;#xAC00;&amp;#xC815;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// 2. CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xAC00; &amp;#xC788;&amp;#xC73C;&amp;#xBA74; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC;&amp;#xAC00; &amp;#xD56D;&amp;#xC0C1; &amp;#xC874;&amp;#xC7AC;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// 3. CONTEXT.ContextFlags&amp;#xB294; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xB294; &amp;#xCCAD;&amp;#xD06C;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//    &amp;#xC989; CONTEXT_XSTATE&amp;#xAC00; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; CONTEXT_EX.XState&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xD558;&amp;#xB2E4;.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;CONTEXT_EX&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC774; &amp;#xAC00;&amp;#xC7A5; &amp;#xC791;&amp;#xC740; &amp;#xCCAD;&amp;#xD06C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC2DC;&amp;#xC791;&amp;#xD558;&amp;#xB294; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xC758; &amp;#xCD1D; &amp;#xD06C;&amp;#xAE30;&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// N.B. &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC740; &amp;#xC74C;&amp;#xC218;&amp;#xC77C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
    CONTEXT_CHUNK All;

    &lt;span class=&#34;hljs-comment&#34;&gt;// &lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xAE30;&amp;#xC874;&amp;#xC758; CONTEXT &amp;#xAD6C;&amp;#xC870; wrapper&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// N.B. &amp;#xCCAD;&amp;#xD06C;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB294; sizeof(CONTEXT) &amp;#xBCF4;&amp;#xB2E4; &amp;#xC791;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// (CONTEXT_EXTENDED_REGISTERS&amp;#xAC00; x86&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xACBD;&amp;#xC6B0;).    &lt;/span&gt;
		&lt;span class=&#34;hljs-comment&#34;&gt;// CONTEXT_CHUNK Legacy;&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;

	  &lt;span class=&#34;hljs-comment&#34;&gt;// CONTEXT_XSTATE : &amp;#xD655;&amp;#xC7A5;&amp;#xB41C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xCCAD;&amp;#xD06C;. &amp;#xC0C1;&amp;#xD0DC; &amp;#xC800;&amp;#xC7A5;&amp;#xC740; &amp;#xB3D9;&amp;#xC77C;&amp;#xD55C; &amp;#xD615;&amp;#xC2DD; &lt;/span&gt;
	  &lt;span class=&#34;hljs-comment&#34;&gt;// XSAVE &amp;#xC791;&amp;#xC5C5;&amp;#xC740; &amp;#xCC98;&amp;#xC74C; 512 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xB97C; &amp;#xC81C;&amp;#xC678;&amp;#xD558;&amp;#xACE0; XSAVE_AREA_HEADER&amp;#xC5D0;&amp;#xC11C; &amp;#xC2DC;&amp;#xC791;&amp;#xD55C;&amp;#xB2E4;. &lt;/span&gt;
		&lt;span class=&#34;hljs-comment&#34;&gt;// FP &amp;#xBC0F; SSE &amp;#xC0C1;&amp;#xD0DC;&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;&amp;#xD558;&amp;#xB294; &amp;#xD558;&amp;#xC704; 2 &amp;#xBE44;&amp;#xD2B8;&amp;#xB294; 0&amp;#xC774;&amp;#xC5B4;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// CONTEXT_CHUNK XState;&lt;/span&gt;
} CONTEXT_EX, *PCONTEXT_EX;

&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-meta-keyword&#34;&gt;define&lt;/span&gt; CONTEXT_EX_LENGTH ALIGN_UP_BY(sizeof(CONTEXT_EX), STACK_ALIGN)&lt;/span&gt;

&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xC774; &amp;#xB9E4;&amp;#xD06C;&amp;#xB85C;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD574; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xCCAD;&amp;#xD06C;&amp;#xB97C; &amp;#xB354; &amp;#xC27D;&amp;#xAC8C; &amp;#xC870;&amp;#xC791; &amp;#xAC00;&amp;#xB2A5;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xC774; &amp;#xD5E4;&amp;#xB354;&amp;#xB85C; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xC744; &amp;#xC774;&amp;#xD574;&amp;#xD558;&amp;#xACE0; &amp;#xC2DC;&amp;#xAC01;&amp;#xD654;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC744; &amp;#xB54C;&amp;#xAE4C;&amp;#xC9C0; &amp;#xC5EC;&amp;#xB7EC; &amp;#xCC28;&amp;#xB840; &amp;#xC2DC;&amp;#xB3C4;&amp;#xB97C; &amp;#xD588;&amp;#xACE0; &amp;#xB2E4;&amp;#xC74C; &amp;#xB2E4;&amp;#xC774;&amp;#xC5B4;&amp;#xADF8;&amp;#xB7A8;&amp;#xC774; &amp;#xB3C4;&amp;#xC6C0;&amp;#xC774; &amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;&amp;#xACE0; &amp;#xB290;&amp;#xAF08;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/4.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xB2E4;&amp;#xC774;&amp;#xC5B4;&amp;#xADF8;&amp;#xB7A8;&amp;#xC5D0;&amp;#xC11C; CONTEXT&lt;em&gt;EX &amp;#xAD6C;&amp;#xC870;&amp;#xB294; &amp;#xD56D;&amp;#xC0C1; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xB05D;&amp;#xC5D0; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xBC0F; XState&amp;#xB77C;&amp;#xB294; &lt;code&gt;CONTEXT_CHUNK&lt;/code&gt; &amp;#xC720;&amp;#xD615;&amp;#xC758; 3&amp;#xAC1C; &amp;#xD544;&amp;#xB4DC;&amp;#xAC00; &amp;#xC788;&amp;#xB2E4;. &amp;#xC774;&amp;#xB4E4;&amp;#xC740; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xACFC; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD558;&amp;#xACE0; &amp;#xC801;&amp;#xC808;&amp;#xD55C; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; `RTL&lt;/em&gt;` &amp;#xB9E4;&amp;#xD06C;&amp;#xB85C;&amp;#xAC00; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;Legacy &amp;#xD544;&amp;#xB4DC;&amp;#xB294; &amp;#xAE30;&amp;#xC874; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xC2DC;&amp;#xC791;&amp;#xC744; &amp;#xCC38;&amp;#xC870;&amp;#xD55C;&amp;#xB2E4;. (&lt;code&gt;CONTEXT_EXTENDED_REGISTERS&lt;/code&gt;&amp;#xAC00; &amp;#xC81C;&amp;#xACF5;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA74; x86&amp;#xC5D0;&amp;#xC11C; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xB354; &amp;#xC791;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xC74C;) &lt;code&gt;All&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xB294; &amp;#xAE30;&amp;#xC874; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xC2DC;&amp;#xC791;&amp;#xC744; &amp;#xCC38;&amp;#xC870;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; Length&amp;#xB294; CONTEXT_EX&amp;#xC640; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xD328;&amp;#xB529;/&amp;#xC815;&amp;#xB82C; &amp;#xACF5;&amp;#xAC04;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC5EC; &amp;#xBAA8;&amp;#xB4E0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xB098;&amp;#xD0C0;&amp;#xB0B8;&amp;#xB2E4;. &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C; &lt;code&gt;XState&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xB294; &lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt; &amp;#xAD6C;&amp;#xC870; (&amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC788;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD568;)&amp;#xC640; &amp;#xC804;&amp;#xCCB4; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xCC38;&amp;#xC870;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xC73C;&amp;#xB85C; &amp;#xC778;&amp;#xD574; All &amp;#xBC0F; Legacy&amp;#xC5D0;&amp;#xB294; &amp;#xC74C;&amp;#xC218; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC774; &amp;#xC801;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;&amp;#xB294; &amp;#xC810;&amp;#xC5D0; &amp;#xC720;&amp;#xC758;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xB9E4;&amp;#xC6B0; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &lt;code&gt;Ntdll.dll&lt;/code&gt;&amp;#xC740; CONTEXT_EX&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; &amp;#xBE4C;&amp;#xB4DC;, &amp;#xC77D;&amp;#xAE30;, &amp;#xBCF5;&amp;#xC0AC; &amp;#xBC0F; &amp;#xC870;&amp;#xC791;&amp;#xC744; &amp;#xB2E8;&amp;#xC21C;&amp;#xD654;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; API&amp;#xB97C; export &amp;#xD55C;&amp;#xB2E4;. (&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; API &amp;#xC911; &amp;#xC77C;&amp;#xBD80;&amp;#xB294; &lt;code&gt;Ntoskrn.exe&lt;/code&gt; &amp;#xC5D0;&amp;#xC11C; &amp;#xB0B4;&amp;#xBD80;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0;&amp;#xB9CC; export &amp;#xB418;&amp;#xC9C0;&amp;#xB294; &amp;#xC54A;&amp;#xB294;&amp;#xB2E4;.) &amp;#xB610;&amp;#xD55C; &lt;code&gt;KernelBase.dll&lt;/code&gt;&amp;#xC740; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xB0B4;&amp;#xBD80;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB41C; Win32 &amp;#xD568;&amp;#xC218;&amp;#xB97C; export &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;CONTEXT-EX-&amp;#xCD08;&amp;#xAE30;&amp;#xD654;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX-&amp;#xCD08;&amp;#xAE30;&amp;#xD654;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX &amp;#xCD08;&amp;#xAE30;&amp;#xD654;&#34;&gt;&lt;/a&gt;CONTEXT_EX &amp;#xCD08;&amp;#xAE30;&amp;#xD654;&lt;/h2&gt;&lt;p&gt;&amp;#xBA3C;&amp;#xC800; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; CONTEXT_EX&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xD560;&amp;#xB2F9;&amp;#xD560; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xD30C;&amp;#xC545;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294;&amp;#xB370;, &amp;#xC774;&amp;#xB294; &amp;#xB2E4;&amp;#xC74C; API&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xC218;&amp;#xD589;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
ULONG
NTAPI
RtlGetExtendedContextLength (
    _In_ ULONG ContextFlags,
    _Out_ PULONG ContextLength
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xC800;&amp;#xC7A5;&amp;#xD560; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB97C; &amp;#xC9C0;&amp;#xC815;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC801;&amp;#xC808;&amp;#xD55C; &lt;code&gt;CONTEXT_XXX&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xB97C; &amp;#xC81C;&amp;#xACF5;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7F0; &amp;#xB2E4;&amp;#xC74C;&amp;#xC774; API&amp;#xB294; &lt;code&gt;SharedUserData.XState.EnabledFeatures&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;SharedUserData.XState.EnabledUserVisibleSupervisorFeatures&lt;/code&gt; &amp;#xB97C; &amp;#xC77D;&amp;#xACE0; &amp;#xBAA8;&amp;#xB4E0; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD1B5;&amp;#xD569;&amp;#xD574; &amp;#xC544;&amp;#xB798;&amp;#xC758; &amp;#xD655;&amp;#xC7A5; &amp;#xD568;&amp;#xC218;&amp;#xB85C; &amp;#xC804;&amp;#xB2EC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
ULONG
NTAPI
RtlGetExtendedContextLength2 (
    _In_ ULONG ContextFlags,
    _Out_ PULONG ContextLength,
    _In_ ULONG64 XStateCompactionMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774; &amp;#xCD5C;&amp;#xC2E0; API&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBA74; &amp;#xACF5;&amp;#xC720; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; XState &amp;#xAD6C;&amp;#xC131;&amp;#xC5D0;&amp;#xC11C; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xAC00;&amp;#xC838;&amp;#xC624;&amp;#xB294; &amp;#xB300;&amp;#xC2E0; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xD560; XState &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC218;&amp;#xB3D9;&amp;#xC73C;&amp;#xB85C; &amp;#xC9C0;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC774;&amp;#xB85C; &amp;#xC778;&amp;#xD574; CONTNENT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xC791;&amp;#xC544;&amp;#xC838; &amp;#xBAA8;&amp;#xB4E0; XState &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD560; &amp;#xACF5;&amp;#xAC04;&amp;#xC774; &amp;#xCDA9;&amp;#xBD84;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xAC8C; &amp;#xB418;&amp;#xBBC0;&amp;#xB85C; &amp;#xC774; CONTNT_EX&amp;#xB97C; &amp;#xB098;&amp;#xC911;&amp;#xC5D0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBA74; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C; &amp;#xC678;&amp;#xBD80;&amp;#xC5D0;&amp;#xC11C; XState Bits&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC544;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB2E4;&amp;#xC74C;&amp;#xC73C;&amp;#xB85C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; CONTEXT_EX&amp;#xC5D0; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xB97C; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0; (&amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; Windows&amp;#xB294; &amp;#xC608;&amp;#xC678; &amp;#xACBD;&amp;#xB85C;&amp;#xC5D0;&amp;#xC11C; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC; &amp;#xD560;&amp;#xB2F9; &amp;#xC2E4;&amp;#xD328;&amp;#xB97C; &amp;#xBC29;&amp;#xC9C0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;alloca&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;.) &amp;#xB2E4;&amp;#xC74C; &amp;#xB450; API &amp;#xC911; &amp;#xD558;&amp;#xB098;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
ULONG
NTAPI
RtlInitializeExtendedContext (
    _Out_ PVOID Context,
    _In_ ULONG ContextFlags,
    _Out_ PCONTEXT_EX* ContextEx
);

NTSYSAPI
ULONG
NTAPI
RtlInitializeExtendedContext2 (
    _Out_ PVOID Context,
    _In_ ULONG ContextFlags,
    _Out_ PCONTEXT_EX* ContextEx,
    _In_ ULONG64 XStateCompactionMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774;&amp;#xC804;&amp;#xACFC; &amp;#xB9C8;&amp;#xCC2C;&amp;#xAC00;&amp;#xC9C0;&amp;#xB85C; &amp;#xCD5C;&amp;#xC2E0; API&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xD560; XState &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC218;&amp;#xB3D9;&amp;#xC73C;&amp;#xB85C; &amp;#xC9C0;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC9C0;&amp;#xC815;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA74; &amp;#xC0AC;&amp;#xC6A9; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xBAA8;&amp;#xB4E0; &amp;#xAE30;&amp;#xB2A5; (&lt;code&gt;SharedUserData&lt;/code&gt; &amp;#xAE30;&amp;#xBC18;)&amp;#xC774; &amp;#xC788;&amp;#xB294; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xAC04;&amp;#xC8FC;&amp;#xB41C;&amp;#xB2E4;.  &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &lt;code&gt;RtlGetExtendedContextLength(2)&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD638;&amp;#xCD9C;&amp;#xACFC; &amp;#xB3D9;&amp;#xC77C;&amp;#xD55C; &lt;code&gt;ContextFlags&lt;/code&gt;&amp;#xB97C; &amp;#xC9C0;&amp;#xC815;&amp;#xD574; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xAD6C;&amp;#xC870;&amp;#xAC00; &amp;#xC62C;&amp;#xBC14;&amp;#xB978; &amp;#xD06C;&amp;#xAE30;&amp;#xB85C; &amp;#xD560;&amp;#xB2F9;&amp;#xB418;&amp;#xC5C8;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xD6C4; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xC785;&amp;#xB825; CONTEXT &amp;#xBC84;&amp;#xD37C;&amp;#xB97C; &amp;#xB530;&amp;#xB77C;&amp;#xAC08; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xC608;&amp;#xC0C1;&amp;#xB418;&amp;#xB294; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xBC1B;&amp;#xB294;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CONTEXT_EX&amp;#xAC00; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xBA74; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xBA3C;&amp;#xC800; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC62C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. (&amp;#xD06C;&amp;#xAE30;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xAC00;&amp;#xC815; &amp;#xC5C6;&amp;#xC774;). &amp;#xB2E4;&amp;#xC74C; API&amp;#xB85C; &amp;#xC218;&amp;#xD589;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
PCONTEXT
NTAPI
RtlLocateLegacyContext (
    _In_ PCONTEXT_EX ContextEx,
    _Out_opt_ PULONG Length,
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &amp;#xC5B8;&amp;#xAE09;&amp;#xD588;&amp;#xB4EF;&amp;#xC774; &amp;#xC774;&amp;#xB4E4;&amp;#xC740; Windows&amp;#xC758; NT &amp;#xACC4;&amp;#xCE35;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xB178;&amp;#xCD9C;&amp;#xB418;&amp;#xB294; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xB0B4;&amp;#xBD80; API&amp;#xB2E4;. &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC778; Win32 &amp;#xC751;&amp;#xC6A9; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C; &amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; XState &amp;#xD638;&amp;#xD658; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC744; &amp;#xB2E8;&amp;#xC21C;&amp;#xD654;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;WINBASEAPI
BOOL
WINAPI
InitializeContext (
    _Out_writes_bytes_opt_(*ContextLength) PVOID Context,
    _In_ DWORD ContextFlags,
    _Out_ PCONTEXT_EX Context,
    _Inout_ PDWORD ContextFlags
);

WINBASEAPI
BOOL
WINAPI
InitializeContext2 (
    _Out_writes_bytes_opt_(*ContextLength) PVOID Context,
    _In_ DWORD ContextFlags,
    _Out_ PCONTEXT_EX Context,
    _Inout_ PDWORD ContextFlags,
    _In_ ULONG64 XStateCompactionMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774; &amp;#xB450; API&amp;#xB294; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; API&amp;#xC640; &amp;#xBE44;&amp;#xC2B7;&amp;#xD558;&amp;#xAC8C; &amp;#xC791;&amp;#xB3D9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; Buffer &amp;#xBC0F; Context &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xB85C; &amp;#xCC98;&amp;#xC74C; NULL&amp;#xC744; &amp;#xC804;&amp;#xB2EC;&amp;#xD558;&amp;#xBA74; &amp;#xD568;&amp;#xC218;&amp;#xB294; &lt;code&gt;ContextLength&lt;/code&gt;&amp;#xC5D0; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xAE38;&amp;#xC774;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xBA70; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xC5D0; &amp;#xD560;&amp;#xB2F9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB450; &amp;#xBC88;&amp;#xC9F8; &amp;#xC2DC;&amp;#xB3C4;&amp;#xC5D0;&amp;#xC11C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xD560;&amp;#xB2F9;&amp;#xB41C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; Buffer&amp;#xC5D0; &amp;#xC804;&amp;#xB2EC;&amp;#xD558;&amp;#xACE0; &amp;#xAE30;&amp;#xBCF8; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC815;&amp;#xBCF4; &amp;#xC5C6;&amp;#xC774; Context&amp;#xC758; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xBC1B;&amp;#xB294;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;CONTEXT-EX&amp;#xC5D0;&amp;#xC11C;-XState-&amp;#xAE30;&amp;#xB2A5;-&amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;-&amp;#xC81C;&amp;#xC5B4;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX&amp;#xC5D0;&amp;#xC11C;-XState-&amp;#xAE30;&amp;#xB2A5;-&amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;-&amp;#xC81C;&amp;#xC5B4;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C; &amp;#xC81C;&amp;#xC5B4;&#34;&gt;&lt;/a&gt;CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C; &amp;#xC81C;&amp;#xC5B4;&lt;/h2&gt;&lt;p&gt;CONTEXT_EX&amp;#xC758; &lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt;&amp;#xC758; Mask &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C; &lt;code&gt;XSTATE_BV&lt;/code&gt; (&amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;)&amp;#xC5D0; &amp;#xC561;&amp;#xC138;&amp;#xC2A4; &amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC740;  XState &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; API&amp;#xC640; &amp;#xD568;&amp;#xAED8; CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; &amp;#xC5B4;&amp;#xB5A4; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xC27D;&amp;#xAC8C; &amp;#xD655;&amp;#xC778;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB3C4;&amp;#xB85D; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; API&amp;#xB97C; export &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xADF8;&amp;#xB7EC;&amp;#xB098; Windows&amp;#xB294; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; x87 FPU (0) &amp;#xBC0F; SSE (1) &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xACE0; &amp;#xB300;&amp;#xC2E0; &lt;code&gt;FXSAVE&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC989;, XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xC601;&amp;#xC5ED;&amp;#xC774; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xACE0; &amp;#xC989;&amp;#xC2DC; &lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt;&amp;#xB85C; &amp;#xC2DC;&amp;#xC791;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774;&amp;#xB85C; &amp;#xC778;&amp;#xD574; Get API&amp;#xB294; &amp;#xD56D;&amp;#xC0C1; &amp;#xD558;&amp;#xC704; 2 &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD0B9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; Set API&amp;#xB294; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; XState &amp;#xAD6C;&amp;#xC131;&amp;#xC758; &lt;code&gt;EnabledFeatures&lt;/code&gt;&amp;#xC5D0; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;InitializeContext2&lt;/code&gt;(&amp;#xB610;&amp;#xB294; &amp;#xB0B4;&amp;#xBD80; &amp;#xB124;&amp;#xC774;&amp;#xD2F0;&amp;#xBE0C; APIs)&amp;#xC5D0;&amp;#xC11C; &amp;#xD558;&amp;#xB4DC; &amp;#xCF54;&amp;#xB529;&amp;#xB41C; &amp;#xC555;&amp;#xCD95; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xAC00; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; Set API&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xAE30;&amp;#xC874; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC0DD;&amp;#xB7B5;&amp;#xD574;&amp;#xC11C;&amp;#xB294; &amp;#xC548;&amp;#xB41C;&amp;#xB2E4;. (&amp;#xC0C8; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xCD94;&amp;#xAC00;&amp;#xD558;&amp;#xBA74; CONTEXT_EX&amp;#xC5D0; &amp;#xCD08;&amp;#xAE30;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xCD94;&amp;#xAC00; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xBBC0;&amp;#xB85C; &amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xC5C6;&amp;#xC774; &amp;#xC774;&amp;#xBBF8; &amp;#xC0AC;&amp;#xC804; &amp;#xD560;&amp;#xB2F9;&amp;#xB418;&amp;#xC5C8;&amp;#xC744; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;.)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
ULONG64
NTAPI
RtlGetExtendedFeaturesMask (
    _In_ PCONTEXT_EX ContextEx
);

NTSYSAPI
ULONG64
NTAPI
RtlSetExtendedFeaturesMask (
    _In_ PCONTEXT_EX ContextEx,
    _In_ ULONG64 FeatureMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC704; API&amp;#xC758; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;WINBASEAPI
BOOL
WINAPI
GetXStateFeaturesMask (
    _In_ PCONTEXT Context
    _Out_ PDWORD64 FeatureMask
);

NTSYSAPI
ULONG64
NTAPI
SetXStateFeaturesMask (
    _In_ PCONTEXT Context,
    _In_ DWORD64 FeatureMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;CONTEXT-EX&amp;#xC5D0;&amp;#xC11C;-XState-&amp;#xAE30;&amp;#xB2A5;-&amp;#xCC3E;&amp;#xAE30;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX&amp;#xC5D0;&amp;#xC11C;-XState-&amp;#xAE30;&amp;#xB2A5;-&amp;#xCC3E;&amp;#xAE30;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xCC3E;&amp;#xAE30;&#34;&gt;&lt;/a&gt;CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xCC3E;&amp;#xAE30;&lt;/h2&gt;&lt;p&gt;CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xBCF5;&amp;#xC7A1;&amp;#xC131;&amp;#xACFC; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xAC70;&amp;#xB098; &amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xD615;&amp;#xD0DC;&amp;#xB85C; &amp;#xC874;&amp;#xC7AC;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xACE0; &amp;#xC874;&amp;#xC7AC; &amp;#xC5EC;&amp;#xBD80;&amp;#xB3C4; &amp;#xC55E;&amp;#xC11C; &amp;#xC124;&amp;#xBA85;&amp;#xD55C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xC5D0; &amp;#xC758;&amp;#xC874;&amp;#xD55C;&amp;#xB2E4;&amp;#xB294; &amp;#xC0AC;&amp;#xC2E4; (&amp;#xD2B9;&amp;#xD788; &amp;#xCD5C;&amp;#xC801;&amp;#xD654;&amp;#xB41C; XSAVE&amp;#xAC00; &amp;#xC9C0;&amp;#xC6D0;&amp;#xB418;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;)&amp;#xB85C; &amp;#xC778;&amp;#xD574;, &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; CONTEXT_EX &amp;#xB0B4;&amp;#xC758; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0;&amp;#xC11C; &amp;#xAD00;&amp;#xB828; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xC27D;&amp;#xACE0; &amp;#xBE60;&amp;#xB974;&amp;#xAC8C; &amp;#xC5BB;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xB77C;&amp;#xC774;&amp;#xBE0C;&amp;#xB7EC;&amp;#xB9AC; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xD604;&amp;#xC7AC; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xC740; &amp;#xB450; &amp;#xAC00;&amp;#xC9C0; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;. &lt;code&gt;RtlLocateExtendedFeature&lt;/code&gt;&amp;#xB294; &lt;code&gt;RtlLocateExtendedFeature2&lt;/code&gt;&amp;#xC758; wrapper&amp;#xC774;&amp;#xBA70; &amp;#xAD6C;&amp;#xC131; &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xB85C; &lt;code&gt;SharedUserData.XState&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xC81C;&amp;#xACF5;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB450; &amp;#xD568;&amp;#xC218; &amp;#xBAA8;&amp;#xB450; export &amp;#xD560; &amp;#xB54C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; &amp;#xC120;&amp;#xD0DD;&amp;#xD55C; &amp;#xACBD;&amp;#xC6B0; &amp;#xD6C4;&amp;#xC790;&amp;#xC758; API&amp;#xC5D0;&amp;#xC11C; &amp;#xC790;&amp;#xCCB4; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xC9C0;&amp;#xC815; XState &amp;#xAD6C;&amp;#xC131;&amp;#xC744; &amp;#xC218;&amp;#xB3D9;&amp;#xC73C;&amp;#xB85C; &amp;#xC9C0;&amp;#xC815;&amp;#xD560; &amp;#xC218;&amp;#xB3C4; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
PVOID
NTAPI
RtlLocateExtendedFeature (
    _In_ CONTEXT_EX ContextEx,
    _In_ ULONG FeatureId,
    _Out_opt_ PULONG Length
);

NTSYSAPI
PVOID
NTAPI
RtlLocateExtendedFeature2 (
    _In_ CONTEXT_EX ContextEx,
    _In_ ULONG FeatureId,
    _In_ PXSTATE_CONFIGURATION Configuration,
    _Out_opt_ PULONG Length
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xB450; &amp;#xD568;&amp;#xC218; &amp;#xBAA8;&amp;#xB450; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC640; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; ID&amp;#xB97C; &amp;#xC218;&amp;#xC2E0;&amp;#xD558;&amp;#xACE0; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xC704;&amp;#xCE58;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; XState &amp;#xAD6C;&amp;#xC131; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC2E4;&amp;#xC81C; &amp;#xAC12;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xAC70;&amp;#xB098; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA70; &amp;#xC774;&amp;#xB294; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xC5D0;&amp;#xAC8C; &amp;#xB2EC;&amp;#xB824; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xCC3E;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;RtlLocateExtendedFeature2&lt;/code&gt;&amp;#xB294; &amp;#xB2E4;&amp;#xC74C;&amp;#xC744; &amp;#xC218;&amp;#xD589;&amp;#xD55C;&amp;#xB2E4;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;#xAE30;&amp;#xB2A5; ID&amp;#xAC00; 2 &amp;#xC774;&amp;#xC0C1; (x87 FPU &amp;#xBC0F; SSE &amp;#xC0C1;&amp;#xD0DC;&amp;#xB294; Windows&amp;#xC758; XSAVE&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC800;&amp;#xC7A5;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C;) &amp;#xBC0F; 64 (&amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xAC00;&amp;#xC7A5; &amp;#xB192;&amp;#xC740; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xBE44;&amp;#xD2B8;) &amp;#xBBF8;&amp;#xB9CC;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;CONTEXT_EX + &lt;code&gt;CONTEXT_EX.XState.Offset&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt;&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC628;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Configuration&lt;/code&gt;-&amp;gt; &lt;code&gt;ControlFlags.CompactionEnabled&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC5D0;&amp;#xC11C; &amp;#xC555;&amp;#xCD95;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294;&amp;#xC9C0; &amp;#xC5EC;&amp;#xBD80;&amp;#xB97C; &amp;#xC54C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xD615;&amp;#xC2DD;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; :&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Configuration&lt;/code&gt;-&amp;gt; &lt;code&gt;Features[n].Offset&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;.Size&lt;/code&gt;&amp;#xB97C; &amp;#xC77D;&amp;#xACE0; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0;&amp;#xC11C; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC624;&amp;#xD504;&amp;#xC14B; &amp;#xBC0F; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; :&lt;ul&gt;
&lt;li&gt;&lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt; (&lt;code&gt;XCOMP_BV&lt;/code&gt;&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;)&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;CompactionMask&lt;/code&gt;&amp;#xB97C; &amp;#xC77D;&amp;#xACE0; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Configuration&lt;/code&gt;-&amp;gt; &lt;code&gt;AllFeatures&lt;/code&gt;&amp;#xB97C; &amp;#xC77D;&amp;#xACE0; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5; ID &amp;#xC55E;&amp;#xC5D0; &amp;#xC624;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xB354;&amp;#xD558;&amp;#xC5EC; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC758; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xACC4;&amp;#xC0B0;&amp;#xD55C; &amp;#xB4A4; &amp;#xAC01; &amp;#xC774;&amp;#xC804; &amp;#xC0C1;&amp;#xD0DC; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xC2DC;&amp;#xC791; &amp;#xBD80;&amp;#xBD84;&amp;#xC744; 64byte&amp;#xB85C; &amp;#xC815;&amp;#xB82C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD574;&amp;#xB2F9; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &lt;code&gt;Configuration&lt;/code&gt;-&amp;gt; &lt;code&gt;AlignedFeatures&lt;/code&gt;&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xACBD;&amp;#xC6B0; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5; ID&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xC2DC;&amp;#xC791;&amp;#xC744; &amp;#xC815;&amp;#xB82C;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Configuration.AllFeatures[n]&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xC77D;&amp;#xB294;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&amp;#xC704;&amp;#xC5D0;&amp;#xC11C; &amp;#xACC4;&amp;#xC0B0;&amp;#xB41C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0;&amp;#xC11C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xCC3E;&amp;#xACE0; &amp;#xC120;&amp;#xD0DD;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xCD9C;&amp;#xB825; &amp;#xAE38;&amp;#xC774; &amp;#xBCC0;&amp;#xC218;&amp;#xC758; &amp;#xD574;&amp;#xB2F9; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xD574;&amp;#xB2F9; &amp;#xD06C;&amp;#xAE30;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;#xC989;, &amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xD615;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xD2B9;&amp;#xC815; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xCC3E;&amp;#xC73C;&amp;#xB824;&amp;#xBA74; &lt;code&gt;SharedUserData&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xCDA9;&amp;#xBD84;&amp;#xD558;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &lt;code&gt;SharedUserData&lt;/code&gt;&amp;#xC758; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0; &amp;#xC758;&amp;#xC874;&amp;#xD560; &amp;#xC218; &amp;#xC5C6;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xC804; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xACC4;&amp;#xC0B0;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC778; Win32 &amp;#xC751;&amp;#xC6A9; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xB0B4;&amp;#xBD80;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC704;&amp;#xC758; &amp;#xAE30;&amp;#xBCF8; API&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC77C;&amp;#xBD80; &amp;#xC0AC;&amp;#xC804; &amp;#xCC98;&amp;#xB9AC;&amp;#xAC00; &amp;#xC788;&amp;#xB294; &amp;#xB2E4;&amp;#xB978; API&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xAE30;&amp;#xB3C4; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8; 0&amp;#xACFC; 1&amp;#xC740; CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; Win32 API&amp;#xB294; &amp;#xC801;&amp;#xC808;&amp;#xD55C; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT &amp;#xD544;&amp;#xB4DC; (&amp;#xC989;, &lt;code&gt;XSTATE_LEGACY_FLOATING_POINT&lt;/code&gt;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; FltSave, &lt;code&gt;XSTATE_LEGACY_SSE&lt;/code&gt;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; Xmm0)&amp;#xC5D0;&amp;#xC11C; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xB450; &amp;#xAE30;&amp;#xB2A5; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC640; &amp;#xCC98;&amp;#xB9AC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;WINBASEAPI
PVOID
WINAPI
LocateXStateFeature (
    _In_ CONTEXT_EX Context,
    _In_ DWORD FeatureId,
    _Out_opt_ PDWORD Length
);&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;&amp;#xC608;&amp;#xC81C;-&amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC;-&amp;#xCD9C;&amp;#xB825;&#34;&gt;&lt;a href=&#34;#&amp;#xC608;&amp;#xC81C;-&amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC;-&amp;#xCD9C;&amp;#xB825;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xC608;&amp;#xC81C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC; &amp;#xCD9C;&amp;#xB825;&#34;&gt;&lt;/a&gt;&amp;#xC608;&amp;#xC81C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC; &amp;#xCD9C;&amp;#xB825;&lt;/h2&gt;&lt;p&gt;CONTEXT_EX &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xC640; &amp;#xACB0;&amp;#xD569;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; XState &amp;#xB0B4;&amp;#xBD80;&amp;#xB97C; &amp;#xC774;&amp;#xD574;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xAC04;&amp;#xB2E8;&amp;#xD55C; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/tree/master/Xpolicy&#34;&gt;&amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8;&lt;/a&gt;&amp;#xC744; &amp;#xC791;&amp;#xC131;&amp;#xD588;&amp;#xB2E4;. &amp;#xC774; &amp;#xC720;&amp;#xD2F8;&amp;#xB9AC;&amp;#xD2F0;&amp;#xB294; &amp;#xC77C;&amp;#xBD80; API &amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC; &amp;#xAD00;&amp;#xB828;&amp;#xB41C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;, &amp;#xD06C;&amp;#xAE30; &amp;#xBC0F; &amp;#xB3D9;&amp;#xC791;&amp;#xC744; &amp;#xBCF4;&amp;#xC5EC;&amp;#xC900;&amp;#xB2E4;. &amp;#xB2E4;&amp;#xC74C;&amp;#xC740; AVX, MPX &amp;#xBC0F; Intel PT&amp;#xAC00; &amp;#xC788;&amp;#xB294; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xC11C; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8; (AVX &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xC0AC;&amp;#xC6A9;)&amp;#xC758; &amp;#xCD9C;&amp;#xB825;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/5.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xBB34;&amp;#xC5C7;&amp;#xBCF4;&amp;#xB2E4;&amp;#xB3C4; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT&amp;#xAC00; &amp;#xC74C;&amp;#xC218;&amp;#xC778; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xC608;&amp;#xC0C1;&amp;#xB300;&amp;#xB85C; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC774; x87 FPU &amp;#xC0C1;&amp;#xD0DC;(1) &amp;#xBC0F; GSE &amp;#xC0C1;&amp;#xD0DC;(2)&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB354;&amp;#xB77C;&amp;#xB3C4; &lt;code&gt;XSAVEBV&lt;/code&gt;&amp;#xC5D0;&amp;#xB294; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C;&amp;#xB2E4;. (&amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xAD00;&amp;#xB828; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; &amp;#xC74C;&amp;#xC218; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0; &amp;#xC720;&amp;#xC758;&amp;#xD574;&amp;#xC57C; &amp;#xD568;) &lt;code&gt;0x40&lt;/code&gt; &amp;#xBC14;&amp;#xC774;&amp;#xD2B8; &amp;#xD06C;&amp;#xAE30;&amp;#xC778; XSAVE &amp;#xD5E4;&amp;#xB354; (&amp;#xC624;&amp;#xD504;&amp;#xC14B; &lt;code&gt;0x30&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC2DC;&amp;#xC791;) &amp;#xB2E4;&amp;#xC74C;&amp;#xC5D0; AVX &amp;#xC0C1;&amp;#xD0DC;(2)&amp;#xB294; &amp;#xC624;&amp;#xD504;&amp;#xC14B; &lt;code&gt;0x70&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC2DC;&amp;#xC791;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;h1 id=&#34;CONTEXT-EX-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;/a&gt;CONTEXT_EX &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&lt;/h1&gt;&lt;p&gt;&amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; API&amp;#xB294; &amp;#xACB0;&amp;#xAD6D; &amp;#xCEE4;&amp;#xB110;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xCC98;&amp;#xB9AC;&amp;#xB418;&amp;#xACE0; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xAD8C;&amp;#xD55C; &amp;#xC788;&amp;#xB294; &amp;#xBD80;&amp;#xBD84; (&amp;#xC989;, CET &amp;#xC0C1;&amp;#xD0DC; &amp;#xB370;&amp;#xC774;&amp;#xD130;)&amp;#xC744; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xB294; CONTEXT_EX&amp;#xB97C; &amp;#xAD6C;&amp;#xC131;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; Windows&amp;#xB294; CONTEXT_EX&amp;#xB97C; &amp;#xD5C8;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; API&amp;#xB97C; &amp;#xD1B5;&amp;#xD55C; &amp;#xBC14;&amp;#xB78C;&amp;#xC9C1;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC218;&amp;#xC815;&amp;#xC744; &amp;#xBC29;&amp;#xC9C0;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4; :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;NtContinue&lt;/code&gt; : &amp;#xC608;&amp;#xC678; &amp;#xD6C4; &amp;#xC7AC;&amp;#xAC1C;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xBA70; longjmp CRT &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xACE0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xD574;&amp;#xC81C;&amp;#xB97C; &amp;#xC218;&amp;#xD589;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NtRaiseException&lt;/code&gt; : &amp;#xAE30;&amp;#xC874; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC608;&amp;#xC678;&amp;#xB97C; &amp;#xC0BD;&amp;#xC785;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NtQueueUserApc&lt;/code&gt; : &amp;#xAE30;&amp;#xC874; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xC2E4;&amp;#xD589; &amp;#xD750;&amp;#xB984;&amp;#xC744; &amp;#xAC00;&amp;#xB85C;&amp;#xCC44;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NtSetContextThread&lt;/code&gt; : &amp;#xAE30;&amp;#xC874; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; / &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C; &amp;#xD638;&amp;#xCD9C;&amp;#xB85C; &amp;#xC778;&amp;#xD574; &amp;#xCEE4;&amp;#xB110;&amp;#xC774; &lt;code&gt;IA32_PL3_SSP&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;IA32_CET_U&lt;/code&gt; MSR&amp;#xC744; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xACE0; RIP&amp;#xB97C; &amp;#xC870;&amp;#xC791;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; Windows&amp;#xB294; &amp;#xC804;&amp;#xB2EC;&amp;#xB41C; CONTEXT_EX&amp;#xAC00; CET &amp;#xBCF4;&amp;#xC99D;&amp;#xC744; &amp;#xC704;&amp;#xBC18;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;19H1&lt;/code&gt;&amp;#xC5D0; SSP&amp;#xB97C; &amp;#xAC80;&amp;#xC99D;&amp;#xD558;&amp;#xACE0; &lt;code&gt;20H1&lt;/code&gt;&amp;#xC5D0; RIP &amp;#xAC80;&amp;#xC99D;&amp;#xC744; &amp;#xCD94;&amp;#xAC00;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC744; &amp;#xACE7; &amp;#xB2E4;&amp;#xB8F0; &amp;#xC608;&amp;#xC815;&amp;#xC774;&amp;#xB2E4;. &amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xBA3C;&amp;#xC800; &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC758; &amp;#xC624;&amp;#xC6A9; &amp;#xAC00;&amp;#xB2A5;&amp;#xC131;&amp;#xC744; &amp;#xC904;&amp;#xC774;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC791;&amp;#xC740; &amp;#xB9AC;&amp;#xD329;&amp;#xD130;&amp;#xB9C1;&amp;#xC744; &amp;#xC218;&amp;#xD589;&amp;#xD574;&amp;#xC57C; &amp;#xD588;&amp;#xB2E4;. &amp;#xBC14;&amp;#xB85C; &lt;code&gt;NtContinueEx&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xC758; &amp;#xB3C4;&amp;#xC785;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;NtContinueEX-&amp;#xBC0F;-KCONTINUE-ARGUMENT&#34;&gt;&lt;a href=&#34;#NtContinueEX-&amp;#xBC0F;-KCONTINUE-ARGUMENT&#34; class=&#34;headerlink&#34; title=&#34;NtContinueEX &amp;#xBC0F; KCONTINUE_ARGUMENT&#34;&gt;&lt;/a&gt;NtContinueEX &amp;#xBC0F; KCONTINUE_ARGUMENT&lt;/h2&gt;&lt;p&gt;&amp;#xC704;&amp;#xC5D0;&amp;#xC11C; &amp;#xC124;&amp;#xBA85;&amp;#xD55C; &amp;#xB300;&amp;#xB85C; &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC758; &amp;#xAE30;&amp;#xB2A5;&amp;#xC740; &amp;#xC5EC;&amp;#xB7EC; &amp;#xC0C1;&amp;#xD669;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xBA70;, CET&amp;#xAC00; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC784;&amp;#xC758; &amp;#xBCC0;&amp;#xACBD;&amp;#xC744; &amp;#xD5C8;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; API&amp;#xC5D0;&amp;#xC11C; &amp;#xAE30;&amp;#xC874; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xBCF5;&amp;#xC6D0;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xB824;&amp;#xBA74; &amp;#xC778;&amp;#xD130;&amp;#xD398;&amp;#xC774;&amp;#xC2A4;&amp;#xC5D0; &amp;#xB354; &amp;#xC138;&amp;#xBC00;&amp;#xD55C; &amp;#xC81C;&amp;#xC5B4;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5B4;&amp;#xC57C; &amp;#xD588;&amp;#xB2E4;. &amp;#xC774; &amp;#xC791;&amp;#xC5C5;&amp;#xC740; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt;&amp;#xC774;&amp;#xB77C;&amp;#xB294; &amp;#xC0C8; enumeration&amp;#xC758; &amp;#xC0DD;&amp;#xC131;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC218;&amp;#xD589;&amp;#xB418;&amp;#xC5C8;&amp;#xC73C;&amp;#xBA70;, &lt;code&gt;KCONTINUE_ARGUMENT&lt;/code&gt; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xD604;&amp;#xC7AC; &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;NtContinueEx&lt;/code&gt;&amp;#xB85C; &amp;#xD5A5;&amp;#xC0C1;&amp;#xB41C; &amp;#xBC84;&amp;#xC804;&amp;#xC73C;&amp;#xB85C; &amp;#xC804;&amp;#xB2EC;&amp;#xB418;&amp;#xC5B4;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0;&amp;#xB294;  &lt;code&gt;ContinueFlags&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC774; &amp;#xD544;&amp;#xB4DC;&amp;#xB294;  &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC758; &amp;#xC6D0;&amp;#xB798; &lt;code&gt;TestAlert&lt;/code&gt; &amp;#xC778;&amp;#xC218;&amp;#xB97C; &lt;code&gt;CONTINUE_FLAG_RAISE_ALERT (0x1)&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xB85C; &amp;#xB300;&amp;#xCCB4;&amp;#xD558;&amp;#xB294; &amp;#xB3D9;&amp;#xC2DC;&amp;#xC5D0; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; TrapFrame&amp;#xC73C;&amp;#xB85C; APC&amp;#xB97C; &amp;#xC9C1;&amp;#xC811; &amp;#xC804;&amp;#xB2EC;&amp;#xD558;&amp;#xB294;&lt;code&gt;CONTINUE_FLAG_BYPASS_CONTEXT_COPY (0x2)&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xB3C4; &amp;#xB3C4;&amp;#xC785;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC774;&amp;#xAC83;&amp;#xC740; CONTEXT &amp;#xB808;&amp;#xCF54;&amp;#xB4DC; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC758; &amp;#xD2B9;&amp;#xC815; &amp;#xC704;&amp;#xCE58;&amp;#xC5D0; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xC5EC; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &amp;#xAD6C;&amp;#xD604;&amp;#xB41C; &amp;#xCD5C;&amp;#xC801;&amp;#xD654;&amp;#xB85C;, &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBAA8;&amp;#xB4DC; APC &amp;#xC804;&amp;#xB2EC;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xACE0; &amp;#xC788;&amp;#xB2E4;&amp;#xACE0; &amp;#xAC00;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.  &amp;#xC774; &amp;#xB3D9;&amp;#xC791;&amp;#xC744; &amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &lt;code&gt;ContinueFlags&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xB97C; &amp;#xBA85;&amp;#xC2DC;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xC804; &amp;#xC778;&amp;#xD130;&amp;#xD398;&amp;#xC774;&amp;#xC2A4;&amp;#xB294; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC;&amp;#xB85C; &amp;#xACC4;&amp;#xC18D; &amp;#xC9C0;&amp;#xC6D0;&amp;#xB418;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB0B4;&amp;#xBD80;&amp;#xC801;&amp;#xC73C;&amp;#xB85C;&amp;#xB294; &amp;#xC785;&amp;#xB825; &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xB97C; &lt;code&gt;KCONTINUE_ARGUMENT&lt;/code&gt;&amp;#xAC00; &amp;#xC544;&amp;#xB2CC; &lt;code&gt;BOOLEAN TestAlert&lt;/code&gt; &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xB85C; &amp;#xC778;&amp;#xC2DD;&amp;#xD558;&amp;#xB294; &lt;code&gt;NtContinueEx&lt;/code&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xACBD;&amp;#xC6B0;&amp;#xB294; &amp;#xC0C8; &amp;#xC778;&amp;#xD130;&amp;#xD398;&amp;#xC774;&amp;#xC2A4;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt;&amp;#xB85C; &amp;#xCC98;&amp;#xB9AC;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC704; &amp;#xB9AC;&amp;#xD329;&amp;#xD130;&amp;#xB9C1;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xB2E4;&amp;#xC74C; &amp;#xB124; &amp;#xAC00;&amp;#xC9C0; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xC720;&amp;#xD615;&amp;#xC774; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt; &amp;#x2013; &amp;#xC608;&amp;#xC678;&amp;#xC5D0;&amp;#xC11C; &amp;#xD574;&amp;#xC81C;&amp;#xD560; &amp;#xB54C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &lt;code&gt;RtlRestoreContext&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;LdrInitializeThunk&lt;/code&gt;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC758; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;KCONTINUE_RESUME&lt;/code&gt; &amp;#x2013; &lt;code&gt;NtContinueEx&lt;/code&gt;&amp;#xB97C; &amp;#xB2E4;&amp;#xC2DC; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xAE30; &amp;#xC804;&amp;#xC5D0; &lt;code&gt;KiUserApcDispatcher&lt;/code&gt;&amp;#xAC00; &amp;#xC2E4;&amp;#xD589;&amp;#xD560; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC5D0; &lt;code&gt;KCONTINUE_ARGUMENT&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xBE4C;&amp;#xB4DC;&amp;#xD560; &amp;#xB54C; &lt;code&gt;KiInitializeUserApc&lt;/code&gt;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;KCONTINUE_LONGJUMP&lt;/code&gt; &amp;#x2013; &amp;#xC608;&amp;#xC678; &amp;#xB808;&amp;#xCF54;&amp;#xB4DC;&amp;#xC758; &amp;#xC608;&amp;#xC678; &amp;#xCF54;&amp;#xB4DC;&amp;#xAC00; &lt;code&gt;STATUS_LONGJUMP&lt;/code&gt; &amp;#xC778; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;RtlRestoreContext&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xB294; &lt;code&gt;RtlContinueLongJump&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;KCONTINUE_SET&lt;/code&gt; &amp;#x2013; &lt;code&gt;NtContinueEx&lt;/code&gt;&amp;#xC5D0; &amp;#xC9C1;&amp;#xC811; &amp;#xC804;&amp;#xB2EC;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xACE0; &lt;code&gt;NtSetContextThread&lt;/code&gt; API&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC751;&amp;#xB2F5;&amp;#xC73C;&amp;#xB85C; &lt;code&gt;PspGetSetContextInternal&lt;/code&gt; &amp;#xB0B4;&amp;#xC5D0;&amp;#xC11C; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD560; &amp;#xB54C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;SSP-Shadow-Stack-Pointer-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;a href=&#34;#SSP-Shadow-Stack-Pointer-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34; class=&#34;headerlink&#34; title=&#34;SSP(Shadow Stack Pointer) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;/a&gt;SSP(Shadow Stack Pointer) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&lt;/h2&gt;&lt;p&gt;&amp;#xC55E;&amp;#xC11C; &amp;#xC5B8;&amp;#xAE09;&amp;#xD588;&amp;#xB4EF;&amp;#xC774; &amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C;, APC, longjmp &amp;#xB4F1;&amp;#xACFC; &amp;#xAC19;&amp;#xC774; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xCF54;&amp;#xB4DC;&amp;#xAC00; SSP&amp;#xB97C; &amp;#xBCC0;&amp;#xACBD;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xAC00; &amp;#xC788;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C;&amp;#xB294; CET &amp;#xC6B0;&amp;#xD68C; &amp;#xBC29;&amp;#xC9C0;&amp;#xB97C; &amp;#xC704;&amp;#xD574; SSP&amp;#xC5D0; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xC0C8; &amp;#xAC12;&amp;#xC744; &amp;#xAC80;&amp;#xC99D;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xB294; &lt;code&gt;19H1&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextXStateCetU.c&#34;&gt;KeVerifyContextXStateCetU&lt;/a&gt; &amp;#xD568;&amp;#xC218;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xAD6C;&amp;#xD604;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xAC00; &amp;#xC218;&amp;#xC815;&amp;#xB418;&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC640; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xC0C8; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xB97C; &amp;#xC218;&amp;#xC2E0;&amp;#xD558;&amp;#xACE0; &amp;#xB2E4;&amp;#xC74C;&amp;#xC744; &amp;#xC218;&amp;#xD589;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CONTEXT_EX&amp;#xC5D0; XState &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xC9C0; &amp;#xC54A;&amp;#xAC70;&amp;#xB098; XState &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC5D0; CET &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xACBD;&amp;#xC6B0; (&lt;code&gt;XSTATE_CET_U&lt;/code&gt; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB85C; &lt;code&gt;RtlLocateExtendedFeature2&lt;/code&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xD655;&amp;#xC778;) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xB300;&amp;#xC0C1; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; CET&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; :&lt;ul&gt;
&lt;li&gt;&amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; &lt;code&gt;XSAVEBV&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;XSTATE_MASK_CET_U&lt;/code&gt;&amp;#xB97C; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD0B9;&amp;#xD558;&amp;#xC5EC; &amp;#xC774; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; CET&amp;#xB97C; &amp;#xBE44;&amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD558;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xACBD;&amp;#xC6B0; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xB2E4;&amp;#xC2DC; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD558;&amp;#xACE0; &lt;code&gt;MSR_IA32_CET_SHSTK_EN&lt;/code&gt; (CET&amp;#xC758; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD558;&amp;#xB294; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;)&amp;#xC744; &lt;code&gt;Ia32CetUMsr&lt;/code&gt;&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xACE0; &amp;#xD604;&amp;#xC7AC; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC744; &lt;code&gt;Ia32Pl3SspMsr&lt;/code&gt;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xBC18;&amp;#xBA74;&amp;#xC5D0; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextXStateCetUEnabled.c&#34;&gt;KiVerifyContextXStateCetUEnabled&lt;/a&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xBA74; CET &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC774; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5C8;&amp;#xB294;&amp;#xC9C0;, (&lt;code&gt;MSR_IA32_CET_SHSTK_EN&lt;/code&gt; &amp;#xD65C;&amp;#xC131;&amp;#xD654; &amp;#xC5EC;&amp;#xBD80;) &amp;#xC0C8; SSP&amp;#xAC00; 8byte&amp;#xB85C; &amp;#xC815;&amp;#xB82C;&amp;#xB418;&amp;#xC5C8;&amp;#xB294;&amp;#xC9C0;, &amp;#xD604;&amp;#xC7AC; SSP &amp;#xAC12;&amp;#xACFC; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; VAD &amp;#xB05D; &amp;#xC0AC;&amp;#xC774;&amp;#xC5D0; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC2A4;&amp;#xD0DD;&amp;#xC774; &amp;#xAC70;&amp;#xAFB8;&amp;#xB85C; &amp;#xC131;&amp;#xC7A5;&amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#x201C;&amp;#xB05D;&amp;#x201D;&amp;#xC774; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC758; &amp;#xC2DC;&amp;#xC791; &amp;#xC8FC;&amp;#xC18C;&amp;#xC774;&amp;#xB2E4;. &amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC0C8; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xB97C; &amp;#xC124;&amp;#xC815;&amp;#xD560; &amp;#xB54C; &amp;#xBAA8;&amp;#xB4E0; SSP &amp;#xAC12;&amp;#xC740; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC9C0;&amp;#xAE08;&amp;#xAE4C;&amp;#xC9C0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xB0B4;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &amp;#xD55C; &amp;#xC720;&amp;#xD6A8;&amp;#xD558;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xAC00; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xB0B4;&amp;#xBD80;&amp;#xB85C; &amp;#xC774;&amp;#xB3D9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xBC94;&amp;#xC704;&amp;#xC5D0;&amp;#xB294; &amp;#xC81C;&amp;#xD55C;&amp;#xC774; &amp;#xC5C6;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;CET&amp;#xAC00; &amp;#xB300;&amp;#xC0C1; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xBE44;&amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xACE0; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; CONTEXT_EX&amp;#xC758; &lt;code&gt;XSAVEBV&lt;/code&gt;&amp;#xC5D0; &lt;code&gt;XSTATE_CET_U&lt;/code&gt; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC5EC; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB97C; &amp;#xC2DC;&amp;#xB3C4;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xB450; MSR &amp;#xAC12;&amp;#xC774; &amp;#xBAA8;&amp;#xB450; 0&amp;#xC73C;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xB3C4;&amp;#xB85D; &amp;#xD5C8;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;. (&amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; X, SSP X)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;#xC704; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xC5D0; &amp;#xC2E4;&amp;#xD328;&amp;#xD558;&amp;#xBA74; &lt;code&gt;STATUS_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xAC00; &amp;#xBC18;&amp;#xD658;&amp;#xB418;&amp;#xACE0; &amp;#xC131;&amp;#xACF5;&amp;#xD558;&amp;#xBA74; &lt;code&gt;STATUS_SUCCESS&lt;/code&gt;&amp;#xAC00; &amp;#xBC18;&amp;#xD658;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CET&amp;#xB97C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD558;&amp;#xBA74; &amp;#xAE30;&amp;#xC874; Windows 8.1&amp;#xC5D0;&amp;#xC11C; CFG&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xAD6C;&amp;#xD604;&amp;#xB41C; Check Stack Extents&amp;#xB3C4; &amp;#xC554;&amp;#xC2DC;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774;&amp;#xAC83;&amp;#xC740; KPROCESS&amp;#xC758; &lt;code&gt;ProcessFlags&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &lt;code&gt;CheckStackExtents&lt;/code&gt; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xD655;&amp;#xC778;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC989;, &amp;#xB300;&amp;#xC0C1; SSP&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD560; &amp;#xB54C;&amp;#xB9C8;&amp;#xB2E4; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextRecord.c&#34;&gt;KeVerifyContextRecord&lt;/a&gt; &amp;#xB610;&amp;#xD55C; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xACE0; &amp;#xB300;&amp;#xC0C1; RSP&amp;#xAC00; &amp;#xD604;&amp;#xC7AC; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; TEB &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xC2A4;&amp;#xD0DD; &amp;#xC81C;&amp;#xD55C; (&amp;#xB610;&amp;#xB294; &amp;#xC774;&amp;#xAC83;&amp;#xC774; WOW64 &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC778; &amp;#xACBD;&amp;#xC6B0; TEB32&amp;#xC758; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xC2A4;&amp;#xD0DD; &amp;#xC81C;&amp;#xD55C;)&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &lt;code&gt;RtlGuardIsValidStackPointer&lt;/code&gt; (&amp;#xBC0F; &lt;code&gt;RtlGuardIsValidWow64StackPointer&lt;/code&gt;)&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xAD6C;&amp;#xD604;&amp;#xB41C; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAC80;&amp;#xC0AC;&amp;#xB294; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &lt;a href=&#34;https://medium.com/tenable-techblog/api-series-setthreadcontext-d08c9f84458d&#34;&gt;Tenable&lt;/a&gt; &amp;#xBC0F; &lt;a href=&#34;https://blog.ensilo.com/atombombing-cfg-protected-processes&#34;&gt;enSilo&lt;/a&gt;&amp;#xC758; &amp;#xC5F0;&amp;#xAD6C;&amp;#xC6D0;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;RIP-Instruction-Pointer-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;a href=&#34;#RIP-Instruction-Pointer-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34; class=&#34;headerlink&#34; title=&#34;RIP(Instruction Pointer) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;/a&gt;RIP(Instruction Pointer) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;19030&lt;/code&gt; &amp;#xBE4C;&amp;#xB4DC; &amp;#xBC84;&amp;#xC804;&amp;#xC5D0; Intel CET&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xB610; &amp;#xB2E4;&amp;#xB978; &amp;#xAE30;&amp;#xB2A5;&amp;#xC778; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xB824;&amp;#xB294; &amp;#xC0C8; RIP&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xB294; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. SSP &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xC640; &amp;#xB9C8;&amp;#xCC2C;&amp;#xAC00;&amp;#xC9C0;&amp;#xB85C; &amp;#xC774;&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; CET&amp;#xC774; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB9CC; &amp;#xC801;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; RIP &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xB294; &amp;#xAE30;&amp;#xBCF8;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA70; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. (EPROCESS&amp;#xC758; &lt;code&gt;MitigationFlags2Values&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &lt;code&gt;UserCetSetContextIpValidation&lt;/code&gt; &amp;#xBE44;&amp;#xD2B8;&amp;#xB85C; &amp;#xD45C;&amp;#xC2DC;&amp;#xB428;).&lt;/p&gt;
&lt;p&gt;&amp;#xC989;, &amp;#xD604;&amp;#xC7AC; &amp;#xBE4C;&amp;#xB4DC;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;CreateProcess&lt;/code&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xACE0; &lt;code&gt;PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY&lt;/code&gt; &amp;#xC18D;&amp;#xC131;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xB54C; &lt;code&gt;PROCESS_CREATION_MITIGATION_POLICY2_CET_USER_SHADOW_STACKS_ALWAYS_ON&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xBA74; &amp;#xC635;&amp;#xC158;&amp;#xC774; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xB294; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xBCF4;&amp;#xC778;&amp;#xB2E4;. (CET&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xC0DD;&amp;#xC131; &amp;#xC2DC;&amp;#xC5D0;&amp;#xB9CC; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &lt;code&gt;ProcessUserShadowStackPolicy&lt;/code&gt; &amp;#xAC12;&amp;#xC73C;&amp;#xB85C; &lt;code&gt;SetProcessMitgationPolicy&lt;/code&gt; API&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC740; &amp;#xC720;&amp;#xD6A8;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB2E4;.)&lt;/p&gt;
&lt;p&gt;&amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xD765;&amp;#xBBF8;&amp;#xB86D;&amp;#xAC8C;&amp;#xB3C4; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; mitigation &amp;#xC635;&amp;#xC158;&amp;#xC778; &lt;code&gt;PS_MITIGATION_OPTION_USER_CET_SET_CONTEXT_IP_VALIDATION (32)&lt;/code&gt; &amp;#xC774; mitigation map&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC774; mitigation&amp;#xC744; &amp;#xD1A0;&amp;#xAE00; &amp;#xD558;&amp;#xBA74; &lt;code&gt;MitigationFlags2Values&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;AuditUserCetSetContextIpValidation&lt;/code&gt; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; &amp;#xC774;&amp;#xAC83;&amp;#xC740; &amp;#xC774;&amp;#xC81C; 32 &amp;#xBC88;&amp;#xC9F8; mitigation &amp;#xC635;&amp;#xC158; (&amp;#xAC01;&amp;#xAC01; DEFERRED / OFF / ON / RESERVED&amp;#xC5D0; &amp;#xB300;&amp;#xD574; 4 &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xCC28;&amp;#xC9C0;&amp;#xD568;)&amp;#xC774;&amp;#xBBC0;&amp;#xB85C; 132&amp;#xAC1C;&amp;#xC758; mitigation &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xBA70; &lt;code&gt;PS_MITIGATION_OPTIONS_MAP&lt;/code&gt;&amp;#xB294; Map &amp;#xD544;&amp;#xB4DC;&amp;#xC758; 3&amp;#xAC1C;&amp;#xC758; 64 &amp;#xBE44;&amp;#xD2B8; &amp;#xBC30;&amp;#xC5F4; &amp;#xC694;&amp;#xC18C;&amp;#xB85C; &amp;#xD655;&amp;#xC7A5;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;.  (&lt;code&gt;PS_SYSTEM_DLL_INIT_BLOCK&lt;/code&gt;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD6C4;&amp;#xC18D; &amp;#xD6A8;&amp;#xACFC;&amp;#xAC00; &amp;#xC788;&amp;#xC74C;)&lt;/p&gt;
&lt;p&gt;&amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xAC00; &amp;#xBCC0;&amp;#xACBD;&amp;#xB420; &amp;#xB54C;&amp;#xB9C8;&amp;#xB2E4; &amp;#xD638;&amp;#xCD9C;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; CET &amp;#xBC0F; RIP mitigation&amp;#xC774; &amp;#xBAA8;&amp;#xB450; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xACE0; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xC5D0; &lt;code&gt;CONTEXT_CONTROL&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC989;, &amp;#xC774; &amp;#xC0C8; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; RIP&amp;#xAC00; &amp;#xBCC0;&amp;#xACBD;&amp;#xB428;&amp;#xC744; &amp;#xC758;&amp;#xBBF8;&amp;#xD55C;&amp;#xB2E4;. &amp;#xBAA8;&amp;#xB4E0; &amp;#xAC80;&amp;#xC0AC;&amp;#xAC00; &amp;#xD1B5;&amp;#xACFC;&amp;#xB418;&amp;#xBA74; &amp;#xB0B4;&amp;#xBD80; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextIpForUserCet.c&#34;&gt;KiVerifyContextIpForUserCet&lt;/a&gt; &amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xC758; &amp;#xBAA9;&amp;#xC801;&amp;#xC740; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C; &amp;#xAC12;&amp;#xC774;&amp;#xACE0; &amp;#xC775;&amp;#xC2A4;&amp;#xD50C;&amp;#xB85C;&amp;#xC787;&amp;#xC774; &amp;#xC784;&amp;#xC758; &amp;#xCF54;&amp;#xB4DC;&amp;#xB97C; &amp;#xC2E4;&amp;#xD589;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xAC12;&amp;#xC774; &amp;#xC544;&amp;#xB2CC;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xBA3C;&amp;#xC800; &amp;#xB300;&amp;#xC0C1; RIP &amp;#xC8FC;&amp;#xC18C;&amp;#xAC00; &amp;#xCEE4;&amp;#xB110; &amp;#xC8FC;&amp;#xC18C;&amp;#xAC00; &amp;#xC544;&amp;#xB2C8;&amp;#xBA70; &amp;#xB9E4;&amp;#xD551;&amp;#xB418;&amp;#xC5B4;&amp;#xC11C;&amp;#xB294; &amp;#xC548; &amp;#xB418;&amp;#xB294; &amp;#xD558;&amp;#xC704; 0x10000 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xC758; &amp;#xC8FC;&amp;#xC18C;&amp;#xAC00; &amp;#xC544;&amp;#xB2CC;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7F0; &amp;#xB2E4;&amp;#xC74C; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC;&amp;#xC758; &amp;#xC774;&amp;#xC804; &amp;#xC8FC;&amp;#xC18C;&amp;#xC778; &amp;#xACBD;&amp;#xC6B0;&amp;#xB97C; &amp;#xD5C8;&amp;#xC6A9;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574;&amp;#xC11C; &amp;#xD574;&amp;#xB2F9; &amp;#xAE30;&amp;#xBCF8; &amp;#xD2B8;&amp;#xB7A9; &amp;#xD504;&amp;#xB808;&amp;#xC784;&amp;#xC744; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xACE0; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xD574;&amp;#xB2F9; &amp;#xD2B8;&amp;#xB7A9; &amp;#xD504;&amp;#xB808;&amp;#xC784;&amp;#xC758; RIP&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &lt;code&gt;NtSetThreadContext&lt;/code&gt;&amp;#xAC00; &amp;#xCC98;&amp;#xC74C; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xACE0; RIP&amp;#xAC00; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xCD08;&amp;#xAE30; &amp;#xC2DC;&amp;#xC791; &amp;#xC8FC;&amp;#xC18C;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB420; &amp;#xB54C; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC774;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xB2E4;&amp;#xB978; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB3C4; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xB294; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt;&amp;#xC744; &amp;#xC218;&amp;#xC2E0;&amp;#xD558;&amp;#xACE0; &amp;#xD574;&amp;#xB2F9; &amp;#xAC12;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xBC29;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC744; &amp;#xBC18;&amp;#xBCF5;&amp;#xD558;&amp;#xACE0; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xB294;&amp;#xB370;, &amp;#xCC3E;&amp;#xC9C0; &amp;#xBABB;&amp;#xD558;&amp;#xBA74; &amp;#xC608;&amp;#xC678;&amp;#xAC00; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD558;&amp;#xBA70; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xC5D0; &amp;#xB3C4;&amp;#xB2EC;&amp;#xD560; &amp;#xB54C;&amp;#xAE4C;&amp;#xC9C0; &amp;#xACC4;&amp;#xC18D; &amp;#xC2E4;&amp;#xD589;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xB294; &amp;#xC81C;&amp;#xACF5;&amp;#xB41C; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt;&amp;#xC774; &lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xACE0; &lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/RtlVerifyUserUnwindTarget.c&#34;&gt;RtlVerifyUserUnwindTarget&lt;/a&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C; &amp;#xC139;&amp;#xC158;&amp;#xC5D0;&amp;#xC11C; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xB294; &amp;#xB354; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD55C; &amp;#xAC80;&amp;#xC0AC;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; RIP&amp;#xB97C; &amp;#xB2E4;&amp;#xC2DC; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB2E4;&amp;#xB978; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB294; &lt;code&gt;STATUS_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xC5EC; EPROCESS&amp;#xC5D0; &lt;code&gt;AuditUserCetSetContextIpValidation&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; &amp;#xC2E4;&amp;#xD328; &amp;#xAC80;&amp;#xC0AC;&amp;#xB97C; &amp;#xC704;&amp;#xD574; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt;&amp;#xC774; &lt;code&gt;KiLogUserCetSetContextIpValidationAudit&lt;/code&gt;&amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAC80;&amp;#xC0AC;(auditing)&amp;#xB294; &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC778; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; mitigation ETW &amp;#xCC44;&amp;#xB110;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC218;&amp;#xD589;&amp;#xB418;&amp;#xB294; &amp;#xB300;&amp;#xC2E0; WER (Windows &amp;#xC624;&amp;#xB958;&amp;#xBCF4;&amp;#xACE0;) &amp;#xC11C;&amp;#xBE44;&amp;#xC2A4;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xBE60;&amp;#xB978; &amp;#xC2E4;&amp;#xD328; &amp;#xC608;&amp;#xC678;&amp;#xB97C; &amp;#xC9C1;&amp;#xC811; &amp;#xBC1C;&amp;#xC0DD;&amp;#xC2DC;&amp;#xD0A4;&amp;#xB294; &amp;#xBC29;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xC218;&amp;#xD589;&amp;#xB41C;&amp;#xB2E4;. (&lt;code&gt;FAST_FAIL_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xC815;&amp;#xBCF4;&amp;#xB85C; &lt;code&gt;0xC000409&lt;/code&gt; &amp;#xC608;&amp;#xC678;&amp;#xB97C; &amp;#xC804;&amp;#xC1A1;). WER &amp;#xC2A4;&amp;#xD338;&amp;#xC744; &amp;#xBC29;&amp;#xC9C0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;AuditUserCetSetContextIpValidationLogged&lt;/code&gt;&amp;#xB77C;&amp;#xB294; &amp;#xB610; &amp;#xB2E4;&amp;#xB978; EPROCESS &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xAC00; &amp;#xC885;&amp;#xB8CC;&amp;#xB418;&amp;#xACE0; &amp;#xD604;&amp;#xC7AC; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xC8FC;&amp;#xC18C;&amp;#xAC00; &amp;#xD398;&amp;#xC774;&amp;#xC9C0;&amp;#xB85C; &amp;#xC815;&amp;#xB82C;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC3E;&amp;#xAE30; &amp;#xC804;&amp;#xC5D0; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB8E8;&amp;#xD504;&amp;#xB97C; &amp;#xC911;&amp;#xC9C0;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xAC00; &amp;#xC788;&amp;#xB2E4;. &amp;#xC989;, &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xB97C; &amp;#xC885;&amp;#xB8CC;&amp;#xD560; &amp;#xB54C; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xCD5C;&amp;#xC6B0;&amp;#xC120;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC758; &amp;#xD604;&amp;#xC7AC; &amp;#xD398;&amp;#xC774;&amp;#xC9C0;&amp;#xC5D0;&amp;#xC11C;&amp;#xB9CC; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD574;&amp;#xB2F9; &amp;#xD398;&amp;#xC774;&amp;#xC9C0;&amp;#xC5D0;&amp;#xC11C; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC3E;&amp;#xC9C0; &amp;#xBABB;&amp;#xD558;&amp;#xBA74; &lt;code&gt;STATUS_THREAD_IS_TERMINATING&lt;/code&gt;&amp;#xC744; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xD568;&amp;#xC218;&amp;#xB294; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt; &amp;#xC774; &lt;code&gt;KCONTINUE_LONGJUMP&lt;/code&gt; &amp;#xC778; &amp;#xACBD;&amp;#xC6B0; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xAC80;&amp;#xC99D;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB300;&amp;#xC2E0; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/RtlVerifyUserUnwindTarget.c&#34;&gt;RtlVerifyUserUnwindTarget&lt;/a&gt;&amp;#xC774; &lt;code&gt;KCONTINUE_LONGJUMP&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xC5B4; PE Image Load Configuration Directory&amp;#xC758; &lt;code&gt;longjmp&lt;/code&gt; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC5D0;&amp;#xC11C; RIP&amp;#xB97C; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAE00;&amp;#xC758; &amp;#xB2E4;&amp;#xC74C; &amp;#xC139;&amp;#xC158;&amp;#xC5D0;&amp;#xC11C; &amp;#xC774; &amp;#xD45C;&amp;#xC640; &amp;#xAC80;&amp;#xC0AC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC124;&amp;#xBA85;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/6.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C; &amp;#xB450; &amp;#xD568;&amp;#xC218; &amp;#xC911; &amp;#xD558;&amp;#xB098;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xD638;&amp;#xCD9C;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;PspGetSetContextInternal&lt;/code&gt; &amp;#x2013; &lt;code&gt;NtSetContextThread API&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC751;&amp;#xB2F5;&amp;#xC73C;&amp;#xB85C; &amp;#xD638;&amp;#xCD9C;&amp;#xB41C;&amp;#xB2E4;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextRecord.c&#34;&gt;KiVerifyContextRecord&lt;/a&gt; &amp;#x2013; &lt;code&gt;NtContinueEx&lt;/code&gt;, &lt;code&gt;NtRaiseException&lt;/code&gt; &amp;#xBC0F; &amp;#xC77C;&amp;#xBD80; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;NtSetContextThread&lt;/code&gt; API&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC751;&amp;#xB2F5;&amp;#xC73C;&amp;#xB85C; &amp;#xD638;&amp;#xCD9C;&amp;#xB41C;&amp;#xB2E4;. &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xAE30; &amp;#xC804;&amp;#xC5D0; (&amp;#xC218;&amp;#xC2E0;&amp;#xB41C; &lt;code&gt;ContinueArgument&lt;/code&gt;&amp;#xAC00; NULL&amp;#xC774; &amp;#xC544;&amp;#xB2CC; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB9CC;)&amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; CS &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xB824;&amp;#xACE0; &amp;#xD558;&amp;#xB294;&amp;#xC9C0;, &amp;#xC0C8; &amp;#xAC12;&amp;#xC774; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C; &amp;#xAC12;&amp;#xC778;&amp;#xC9C0;&amp;#xB97C; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. WOW64&amp;#xAC00; &amp;#xC544;&amp;#xB2CC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xB294; &amp;#xD53C;&amp;#xCF54; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC774;&amp;#xBA70;, &amp;#xC774; &amp;#xACBD;&amp;#xC6B0; CS&amp;#xB97C; &lt;code&gt;KGDT64_R3_CODE&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;KGDT64_R3_CMCODE&lt;/code&gt;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xB2E4;&amp;#xB978; &amp;#xAC12;&amp;#xC740; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextRecord.c&#34;&gt;KiVerifyContextRecord&lt;/a&gt;&amp;#xAC00; &amp;#xC0C8; CS &amp;#xAC12;&amp;#xC744; &lt;code&gt;KGDT64_R3_CODE&lt;/code&gt;&amp;#xB85C; &amp;#xAC15;&amp;#xC81C;&amp;#xD55C;&amp;#xB2E4;. &lt;code&gt;KiVerifyContextRecord&lt;/code&gt;&amp;#xB294; &lt;code&gt;KiContinuePreviousModeUser&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;KeVerifyContextRecord&lt;/code&gt;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xBA70; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0;, &amp;#xD568;&amp;#xC218;&amp;#xB294; RSP&amp;#xAC00; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xC2A4;&amp;#xD0DD; (native &amp;#xB610;&amp;#xB294; wow64) &amp;#xC911; &amp;#xD558;&amp;#xB098;&amp;#xC5D0; &amp;#xC788;&amp;#xACE0; 64 &amp;#xBE44;&amp;#xD2B8; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xAC00; CS&amp;#xB97C; &lt;code&gt;KGDT64_R3_CODE&lt;/code&gt;&amp;#xB85C;&amp;#xB9CC; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;KeVerifyContextIpForUserCet&lt;/code&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD558;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xACBD;&amp;#xB85C;&amp;#xB294; &amp;#xBA3C;&amp;#xC800; &lt;code&gt;KeVerifyContextXStateCetU&lt;/code&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xB300;&amp;#xC0C1; SSP&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD558;&amp;#xACE0; SSP&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xD560; &amp;#xB54C;&amp;#xB9CC; RIP &amp;#xAC80;&amp;#xC0AC;&amp;#xB97C; &amp;#xC218;&amp;#xD589;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/7.png&#34; alt&gt;&lt;/p&gt;
&lt;h1 id=&#34;&amp;#xC608;&amp;#xC678;-&amp;#xD574;&amp;#xC81C;-&amp;#xBC0F;-longjmp-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;a href=&#34;#&amp;#xC608;&amp;#xC678;-&amp;#xD574;&amp;#xC81C;-&amp;#xBC0F;-longjmp-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xBC0F; longjmp &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;/a&gt;&amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xBC0F; longjmp &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&lt;/h1&gt;&lt;p&gt;&amp;#xC704;&amp;#xC5D0;&amp;#xC11C; &amp;#xC124;&amp;#xBA85;&amp;#xD55C; &amp;#xB300;&amp;#xB85C; &lt;code&gt;KCONTEXT_SET&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;KCONTEXT_RESUME&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xCC98;&amp;#xB9AC;&amp;#xB294; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xACFC; &amp;#xAD00;&amp;#xB828;&amp;#xC774; &amp;#xC788;&amp;#xC9C0;&amp;#xB9CC; &lt;code&gt;KCONTEXT_UNWIND&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;KCONTEXT_LONGJMP&lt;/code&gt; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB294; &lt;code&gt;RtlVerifyUserUnwindTarget&lt;/code&gt;&amp;#xC744; &amp;#xD1B5;&amp;#xD55C; &amp;#xD655;&amp;#xC7A5;&amp;#xB41C; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xB2E4;. &amp;#xC774; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xB97C; &amp;#xC704;&amp;#xD574;&amp;#xC11C;&amp;#xB294; PE &amp;#xD30C;&amp;#xC77C; &amp;#xD615;&amp;#xC2DD; (&amp;#xBC0F; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC; &amp;#xC9C0;&amp;#xC6D0;)&amp;#xC744; &amp;#xBCC0;&amp;#xACBD;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xBA70; JIT &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC; &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xC704;&amp;#xD574; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/NtSetInformationProcess.c&#34;&gt;NtSetInformationProcess&lt;/a&gt;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; OS &amp;#xC218;&amp;#xC900;&amp;#xC758; &amp;#xC815;&amp;#xBCF4; &amp;#xD074;&amp;#xB798;&amp;#xC2A4;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CFG (Control Flow Guard) &amp;#xC9C0;&amp;#xC6D0;&amp;#xC73C;&amp;#xB85C; &amp;#xC778;&amp;#xD574; &amp;#xC774;&amp;#xBBF8; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C; PE &amp;#xD30C;&amp;#xC77C; &amp;#xB0B4;&amp;#xBD80;&amp;#xC758; &lt;code&gt;Image Load Configuration Directory&lt;/code&gt;&amp;#xC5D0;&amp;#xB294; &amp;#xD604;&amp;#xC7AC; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &lt;code&gt;jmp/longjmp&lt;/code&gt; &amp;#xC30D;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &amp;#xBD84;&amp;#xAE30; &amp;#xC720;&amp;#xD6A8; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC815;&amp;#xBCF4;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xC73C;&amp;#xBA70;, &amp;#xC774; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC;&amp;#xAC00; &amp;#xC2DD;&amp;#xBCC4;&amp;#xD574; &amp;#xB9C1;&amp;#xCEE4;&amp;#xC5D0; &amp;#xC804;&amp;#xB2EC;&amp;#xD558;&amp;#xB3C4;&amp;#xB85D; &amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB2E4;. CET&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBA74; &amp;#xC774; &amp;#xAE30;&amp;#xC874; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC7AC;&amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC5F0;&amp;#xC18D; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC; &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xC704;&amp;#xD574; &amp;#xB610; &amp;#xB2E4;&amp;#xB978; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xACFC; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C;&amp;#xB2E4;. Visual Studio 2017&amp;#xC740; &lt;code&gt;longjmp&lt;/code&gt; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xC0DD;&amp;#xC131;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; Visual Studio 2019&amp;#xBD80;&amp;#xD130; &amp;#xC704;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xC815;&amp;#xBCF4;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xC0DD;&amp;#xC131;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xC139;&amp;#xC158;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; &amp;#xD615;&amp;#xC2DD;&amp;#xACFC; &amp;#xCEE4;&amp;#xB110;&amp;#xC774; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xB450; &amp;#xAC00;&amp;#xC9C0; &amp;#xC720;&amp;#xD615;&amp;#xC758; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984;&amp;#xC744; &amp;#xAC80;&amp;#xC99D;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC744; &amp;#xC0B4;&amp;#xD3B4;&amp;#xBCF4;&amp;#xACA0;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;PE-&amp;#xBA54;&amp;#xD0C0;-&amp;#xB370;&amp;#xC774;&amp;#xD130;-&amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34;&gt;&lt;a href=&#34;#PE-&amp;#xBA54;&amp;#xD0C0;-&amp;#xB370;&amp;#xC774;&amp;#xD130;-&amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34; class=&#34;headerlink&#34; title=&#34;PE &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34;&gt;&lt;/a&gt;PE &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&lt;/h2&gt;&lt;p&gt;Windows 10&amp;#xC740; Control Flow Guard &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &amp;#xD45C;&amp;#xC900; GFIDS &amp;#xD14C;&amp;#xC774;&amp;#xBE14; &amp;#xC678;&amp;#xC5D0;&amp;#xB3C4;  RVA&amp;#xAC00; &amp;#xC800;&amp;#xC7A5;&amp;#xB418;&amp;#xB294; &lt;code&gt;.gljmp&lt;/code&gt;&amp;#xB77C;&amp;#xB294; PE Image Load Configuration&amp;#xC758; &lt;code&gt;Guard Long Jump Target Table&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; PE &amp;#xC139;&amp;#xC158;&amp;#xC758; Long Jump Target Table&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC5EC; longjump &amp;#xB300;&amp;#xC0C1;&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xCD94;&amp;#xAC00;&amp;#xD588;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;setjmp&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD638;&amp;#xCD9C;&amp;#xC774; &amp;#xCF54;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC218;&amp;#xD589;&amp;#xB420; &amp;#xB54C;&amp;#xB9C8;&amp;#xB2E4; &amp;#xBC18;&amp;#xD658; &amp;#xC8FC;&amp;#xC18C; (longjmp&amp;#xAC00; &amp;#xBD84;&amp;#xAE30;&amp;#xB418;&amp;#xB294; &amp;#xC704;&amp;#xCE58;)&amp;#xC758; RVA&amp;#xAC00; &amp;#xC774; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; &amp;#xC874;&amp;#xC7AC; &amp;#xC5EC;&amp;#xBD80;&amp;#xB294; Image Load Configuration Directory&amp;#xC758; &lt;code&gt;GuardFlags&lt;/code&gt;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &lt;code&gt;IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xACB0;&amp;#xC815;&amp;#xB418;&amp;#xBA70; &lt;code&gt;GuardLongJumpTargetCount&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xB9CC;&amp;#xD07C;&amp;#xC758; &amp;#xD56D;&amp;#xBAA9;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xAC01; &amp;#xD56D;&amp;#xBAA9;&amp;#xC740; 4 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8; RVA&amp;#xC640; n &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xC758; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC774;&amp;#xB2E4;. &amp;#xC5EC;&amp;#xAE30;&amp;#xC11C; n&amp;#xC740; &lt;code&gt;(GuardFlags &amp;amp; IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK) &amp;gt;&amp;gt; IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_SHIFT&lt;/code&gt;&amp;#xC758; &amp;#xACB0;&amp;#xACFC;&amp;#xC5D0;&amp;#xC11C; &amp;#xAC00;&amp;#xC838;&amp;#xC628;&amp;#xB2E4;. &amp;#xC774; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC815;&amp;#xC758;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC558;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xB294; &amp;#xD56D;&amp;#xC0C1; 0&amp;#xC774; &amp;#xB420; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xC608;&amp;#xC0C1;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774; &amp;#xACC4;&amp;#xC0B0;&amp;#xC740; &lt;code&gt;GFIDS&lt;/code&gt; &amp;#xD14C;&amp;#xC774;&amp;#xBE14; (&lt;code&gt;export suppression&lt;/code&gt;&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; &amp;#xC7A0;&amp;#xC7AC;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC788;&amp;#xC74C;)&amp;#xC5D0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C; &amp;#xACC4;&amp;#xC0B0;&amp;#xACFC; &amp;#xB3D9;&amp;#xC77C;&amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xD558;&amp;#xB098; &amp;#xC774;&amp;#xC0C1;&amp;#xC758; CFG &amp;#xB300;&amp;#xC0C1;&amp;#xC744; &amp;#xC5B5;&amp;#xC81C;&amp;#xD558;&amp;#xBA74; 1 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xC758; &amp;#xBE48; &amp;#xBA54;&amp;#xD0C0;&amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; Long Jump Target Target Table&amp;#xC758; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD56D;&amp;#xBAA9;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4; &amp;#xB2E4;&amp;#xC74C;&amp;#xC740; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &lt;code&gt;longjmp&lt;/code&gt; &amp;#xB300;&amp;#xC0C1;&amp;#xC774; &amp;#xC788;&amp;#xB294; PE &amp;#xD30C;&amp;#xC77C;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/8.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0;&amp;#xB3C4; CFG &amp;#xB0B4;&amp;#xBCF4;&amp;#xB0B4;&amp;#xAE30; &amp;#xC5B5;&amp;#xC81C;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &lt;code&gt;GuardFlags&lt;/code&gt;&amp;#xC758; &amp;#xC0C1;&amp;#xC704; &amp;#xB2C8;&amp;#xBE14; (&lt;code&gt;IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK&lt;/code&gt;&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;)&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &amp;#xAC12; 1&amp;#xC5D0; &amp;#xC720;&amp;#xC758;&amp;#xD558;&amp;#xC790;. &amp;#xC774;&amp;#xB294; &amp;#xC544;&amp;#xB798;&amp;#xC5D0;&amp;#xC11C; &amp;#xBCFC; &amp;#xC218; &amp;#xC788;&amp;#xB294; Long Jump Target Table&amp;#xC5D0; 1 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xC758; &amp;#xCD94;&amp;#xAC00; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC788;&amp;#xC74C;&amp;#xC744; &amp;#xC54C;&amp;#xB824;&amp;#xC900;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/9.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Windows 10 20H1&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC720;&amp;#xD615;&amp;#xC758; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xAC00; &amp;#xBC14;&amp;#xC774;&amp;#xB108;&amp;#xB9AC;&amp;#xC758; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C;&amp;#xB2E4;. &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD544;&amp;#xB4DC; &lt;code&gt;GuardEHContinuationTable&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;GuardEHContinuationCount&lt;/code&gt;&amp;#xAC00; Image Load Configuration Directory &amp;#xB05D;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xACE0; &lt;code&gt;IMAGE_GUARD_EH_CONTINUATION_TABLE_PRESENT&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &lt;code&gt;GuardFlags&lt;/code&gt;&amp;#xC5D0; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xC740; &lt;code&gt;GuardFlags&lt;/code&gt;&amp;#xC758; &amp;#xC0C1;&amp;#xC704; &amp;#xB2C8;&amp;#xBE14;&amp;#xC744; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xD55C; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xBC14;&amp;#xC774;&amp;#xD2B8; &amp;#xCD94;&amp;#xAC00;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC5EC; Long Jump Target Table&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xAC83;&amp;#xACFC; &amp;#xB3D9;&amp;#xC77C;&amp;#xD558;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xD0C0;&amp;#xAE5D;&amp;#xAC8C;&amp;#xB3C4; Visual Studio 2019 &amp;#xBC84;&amp;#xC804;&amp;#xC5D0;&amp;#xC11C;&amp;#xB3C4; &amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xC0DD;&amp;#xC131;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xD604;&amp;#xC7AC; &amp;#xC608;&amp;#xC81C;&amp;#xB97C; &amp;#xBCF4;&amp;#xC5EC;&amp;#xC904; &amp;#xC218; &amp;#xC5C6;&amp;#xB2E4;. &amp;#xC774; &amp;#xBD84;&amp;#xC11D;&amp;#xC740; &amp;#xB098;&amp;#xC911;&amp;#xC5D0; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xB294; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC; &amp;#xCF54;&amp;#xB4DC;&amp;#xC640; 20H1 SDK&amp;#xC758; &lt;code&gt;Ntimage.h&lt;/code&gt; &amp;#xD5E4;&amp;#xB354; &amp;#xD30C;&amp;#xC77C;&amp;#xC744; &amp;#xB9AC;&amp;#xBC84;&amp;#xC2A4; &amp;#xC5D4;&amp;#xC9C0;&amp;#xB2C8;&amp;#xC5B4;&amp;#xB9C1; &amp;#xD55C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;&amp;#xC0AC;&amp;#xC6A9;&amp;#xC790;-&amp;#xBC18;&amp;#xC804;-&amp;#xAE30;&amp;#xB2A5;-&amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34;&gt;&lt;a href=&#34;#&amp;#xC0AC;&amp;#xC6A9;&amp;#xC790;-&amp;#xBC18;&amp;#xC804;-&amp;#xAE30;&amp;#xB2A5;-&amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBC18;&amp;#xC804; &amp;#xAE30;&amp;#xB2A5; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34;&gt;&lt;/a&gt;&amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBC18;&amp;#xC804; &amp;#xAE30;&amp;#xB2A5; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&lt;/h2&gt;&lt;p&gt;&amp;#xC774;&amp;#xC81C; longjmp &amp;#xB300;&amp;#xC0C1; &amp;#xB610;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xB85C; &amp;#xBD84;&amp;#xAE30;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xBCC0;&amp;#xACBD;&amp;#xC774; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC74C;&amp;#xC744; &amp;#xC54C;&amp;#xACE0; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; CONTEXT_EX&amp;#xC5D0; &amp;#xC788;&amp;#xB294; RIP &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xC774; &amp;#xB450; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xC5B4;&amp;#xB5BB;&amp;#xAC8C; &amp;#xC5BB;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xC744;&amp;#xAE4C;? NtContinueEx &amp;#xC804;&amp;#xD654;? &amp;#xC774;&amp;#xB7F0; &amp;#xC791;&amp;#xC5C5;&amp;#xC740; &amp;#xD2B9;&amp;#xC815; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8; &amp;#xC2E4;&amp;#xD589;&amp;#xC5D0;&amp;#xC11C; &amp;#xC790;&amp;#xC8FC; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xCEE4;&amp;#xB110;&amp;#xC740; &amp;#xC774; &amp;#xBB38;&amp;#xC81C;&amp;#xB97C; &amp;#xD574;&amp;#xACB0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xD6A8;&amp;#xC728;&amp;#xC801;&amp;#xC778; &amp;#xBC29;&amp;#xBC95;&amp;#xC774; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Inverted Function Table&lt;/code&gt;&amp;#xC758; &amp;#xAC1C;&amp;#xB150;&amp;#xC5D0; &amp;#xC774;&amp;#xBBF8; &amp;#xC775;&amp;#xC219;&amp;#xD560; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;. &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC740; &lt;code&gt;Ntdll.dll (LdrpInvertedFunctionTable)&lt;/code&gt; &amp;#xC5D0;&amp;#xC11C; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678; &amp;#xCC98;&amp;#xB9AC; &amp;#xC911; &amp;#xD574;&amp;#xC81C; opcode &amp;#xBC0F; &amp;#xC608;&amp;#xC678; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xCC3E;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;. (&lt;code&gt;.pdata&lt;/code&gt; &amp;#xC139;&amp;#xC158;&amp;#xC744; &amp;#xCC3E;&amp;#xC544;&amp;#xC11C;) &lt;code&gt;Ntoskrnl.exe (PsInvertedFunctionTable)&lt;/code&gt;&amp;#xC5D0; &amp;#xB610; &amp;#xB2E4;&amp;#xB978; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC774; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; &amp;#xCEE4;&amp;#xB110; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678; &amp;#xCC98;&amp;#xB9AC; &amp;#xBC0F; PatchGuard &amp;#xAC80;&amp;#xC0AC;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xC5D0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xAC04;&amp;#xB2E8;&amp;#xD788; &amp;#xB9D0;&amp;#xD574; &lt;code&gt;Inverted Function Table&lt;/code&gt;&amp;#xC740; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xBAA8;&amp;#xB4E0; &amp;#xC720;&amp;#xC800;/&amp;#xCEE4;&amp;#xB110; &amp;#xBAA8;&amp;#xB4C8; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xAC00;&amp;#xC0C1; &amp;#xC8FC;&amp;#xC18C;&amp;#xBCC4;&amp;#xB85C; &amp;#xC815;&amp;#xB82C;&amp;#xB41C; PE &amp;#xC608;&amp;#xC678; &amp;#xB514;&amp;#xB809;&amp;#xD130;&amp;#xB9AC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &amp;#xBC30;&amp;#xC5F4;&amp;#xC774;&amp;#xB2E4;. &amp;#xC774; &amp;#xBC30;&amp;#xC5F4;&amp;#xC744; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC774; PE &amp;#xD5E4;&amp;#xB354;&amp;#xB97C; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xD55C; &amp;#xB4A4; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xBAA8;&amp;#xB4C8; &amp;#xC5F0;&amp;#xACB0; &amp;#xBAA9;&amp;#xB85D;&amp;#xC744; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xBCF4;&amp;#xB2E4; &amp;#xD6E8;&amp;#xC52C; &amp;#xBE60;&amp;#xB974;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xC5ED;&amp;#xD568;&amp;#xC218; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; binary search&amp;#xB294; &amp;#xB85C;&amp;#xADF8;(n) &amp;#xC870;&amp;#xD68C;&amp;#xC5D0;&amp;#xC11C;&amp;#xB9CC; &amp;#xD574;&amp;#xB2F9; &amp;#xBAA8;&amp;#xB4C8;&amp;#xC758; &amp;#xAC00;&amp;#xC0C1; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xBE60;&amp;#xB974;&amp;#xAC8C; &amp;#xCC3E;&amp;#xB294;&amp;#xB2E4;. &amp;#xD604;&amp;#xC7AC; Microsoft&amp;#xC758; &amp;#xBA85;&amp;#xC131;&amp;#xC744; &amp;#xC5BB;&amp;#xACE0; &amp;#xC788;&amp;#xB294; Ken Johnson&amp;#xACFC; Matt Miller&amp;#xB294; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; Uninformed Magazine&amp;#xC5D0; &lt;a href=&#34;http://uninformed.org/index.cgi?v=8&amp;amp;a=2&amp;amp;p=20&#34;&gt;&amp;#xCEE4;&amp;#xB110; &amp;#xBAA8;&amp;#xB4DC; &amp;#xD6C4;&amp;#xD0B9; &amp;#xAE30;&amp;#xC220;&lt;/a&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xAE30;&amp;#xC0AC;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xAC1C;&amp;#xC694;&amp;#xB97C; &amp;#xAC8C;&amp;#xC2DC;&amp;#xD588;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC774;&amp;#xC804;&amp;#xC5D0;&amp;#xB294; &lt;code&gt;Ntdll.dll&lt;/code&gt;&amp;#xC740; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC5D0;&amp;#xC11C; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678;&amp;#xB9CC;, &lt;code&gt;Ntoskrnl.exe&lt;/code&gt;&amp;#xB294; &amp;#xCEE4;&amp;#xB110; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678;&amp;#xB9CC; &amp;#xAC80;&amp;#xC0AC;&amp;#xD588;&amp;#xB2E4;. &lt;code&gt;20H1&lt;/code&gt;&amp;#xC758; &amp;#xBCC0;&amp;#xACBD; &amp;#xC0AC;&amp;#xD56D;&amp;#xC740; &amp;#xCEE4;&amp;#xB110;&amp;#xB3C4; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;&amp;#xB294; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;. &lt;code&gt;longjmp&lt;/code&gt; &amp;#xBC0F; &amp;#xC608;&amp;#xC678; &amp;#xC5F0;&amp;#xC18D;&amp;#xC744; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xB85C;&amp;#xC9C1;&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;code&gt;RtlpLookupUserFunctionTableInverted&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5B4; &lt;code&gt;KeUserInvertedFunctionTable&lt;/code&gt; &amp;#xBCC0;&amp;#xC218;&amp;#xB97C; &amp;#xC2A4;&amp;#xCE94;&amp;#xD558;&amp;#xACE0; &lt;code&gt;Ntdll.dll&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD604;&amp;#xC7AC; &amp;#xB0B4;&amp;#xBCF4;&amp;#xB0B8; &lt;code&gt;LdrpInvertedFunctionTable&lt;/code&gt; &amp;#xC2EC;&amp;#xBCFC;&amp;#xC5D0; &amp;#xB9E4;&amp;#xD551;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xAC83;&amp;#xC740; &amp;#xD765;&amp;#xBBF8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD3EC;&amp;#xB80C;&amp;#xC2DD; &amp;#xAE30;&amp;#xB2A5;&amp;#xC73C;&amp;#xB85C;, &amp;#xCEE4;&amp;#xB110;&amp;#xC5D0;&amp;#xC11C; PEB&amp;#xC758; &amp;#xB85C;&amp;#xB354; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xD558;&amp;#xAC70;&amp;#xB098; VAD&amp;#xB97C; &amp;#xC5F4;&amp;#xAC70;&amp;#xD560; &amp;#xD544;&amp;#xC694; &amp;#xC5C6;&amp;#xC774; &amp;#xD604;&amp;#xC7AC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xB0B4;&amp;#xC5D0; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xBAA8;&amp;#xB4C8;&amp;#xC744; &amp;#xC27D;&amp;#xAC8C; &amp;#xCC3E;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4; &amp;#xB2E4;&amp;#xC74C;&amp;#xC740; &lt;code&gt;Csrss.exe&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD604;&amp;#xC7AC; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0;&amp;#xB97C; &amp;#xBCF4;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx @$cursession.Processes.Where(p =&amp;gt; p.Name == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;csrss.exe&amp;quot;&lt;/span&gt;).First().SwitchTo()
dx -r0 @$table = *(nt!_INVERTED_FUNCTION_TABLE**)&amp;amp;nt!KeUserInvertedFunctionTable
dx -g @$table-&amp;gt;TableEntry.Take(@$table-&amp;gt;CurrentSize)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC989;, &amp;#xC6D0;&amp;#xACA9;&amp;#xC5D0;&amp;#xC11C;&amp;#xB3C4; &amp;#xD2B9;&amp;#xD788; &lt;code&gt;unwind opcode&lt;/code&gt; &amp;#xAC00;&amp;#xC5C6;&amp;#xB294; x86 &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0;&amp;#xAC00; &amp;#xC608;&amp;#xC678; &amp;#xB514;&amp;#xB809;&amp;#xD130;&amp;#xB9AC;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC744; &amp;#xAC00;&amp;#xB2A5;&amp;#xC131;&amp;#xC774; &amp;#xC788;&amp;#xC73C;&amp;#xBA70;, &lt;code&gt;.pdata&lt;/code&gt;&amp;#xB294; &lt;code&gt;/SAFESEH&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xACE0; &amp;#xC801;&amp;#xC5B4;&amp;#xB3C4; &amp;#xD558;&amp;#xB098;&amp;#xC758; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xAC00; &amp;#xC788;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB9CC; &amp;#xC0DD;&amp;#xC131;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC0C1;&amp;#xD669;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &lt;code&gt;RtlpLookupUserFunctionTableInverted&lt;/code&gt;&amp;#xAC00; &amp;#xC2E4;&amp;#xD328;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; &amp;#xB300;&amp;#xC2E0; &lt;code&gt;MmGetImageBase&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xAC83;&amp;#xC740; &amp;#xC785;&amp;#xB825; RIP&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;&amp;#xD558;&amp;#xB294; &amp;#xC601;&amp;#xC5ED;&amp;#xC744; &amp;#xB9E4;&amp;#xD551;&amp;#xD558;&amp;#xB294; VAD&amp;#xB97C; &amp;#xC870;&amp;#xD68C;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0; VAD &amp;#xC778; &amp;#xACBD;&amp;#xC6B0; &amp;#xD574;&amp;#xB2F9; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xAE30;&amp;#xBCF8; &amp;#xC8FC;&amp;#xC18C;&amp;#xC640; &amp;#xD06C;&amp;#xAE30; (&amp;#xBAA8;&amp;#xB4C8;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xC77C;&amp;#xCE58;&amp;#xD574;&amp;#xC57C; &amp;#xD568;)&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/10.png&#34; alt&gt;&lt;/p&gt;
&lt;h2 id=&#34;&amp;#xC5F0;&amp;#xC18D;&amp;#xB41C;-&amp;#xB300;&amp;#xC0C1;&amp;#xC5D0;-&amp;#xB300;&amp;#xD55C;-&amp;#xB3D9;&amp;#xC801;-&amp;#xC608;&amp;#xC678;-&amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&#34;&gt;&lt;a href=&#34;#&amp;#xC5F0;&amp;#xC18D;&amp;#xB41C;-&amp;#xB300;&amp;#xC0C1;&amp;#xC5D0;-&amp;#xB300;&amp;#xD55C;-&amp;#xB3D9;&amp;#xC801;-&amp;#xC608;&amp;#xC678;-&amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xC5F0;&amp;#xC18D;&amp;#xB41C; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB3D9;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&#34;&gt;&lt;/a&gt;&amp;#xC5F0;&amp;#xC18D;&amp;#xB41C; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB3D9;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt; &amp;#xC694;&amp;#xCCAD;&amp;#xC744; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xB294;&amp;#xB370; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xC7A5;&amp;#xC560;&amp;#xBB3C;&amp;#xC774; &amp;#xD558;&amp;#xB098; &amp;#xC788;&amp;#xB2E4;. &amp;#xC815;&amp;#xADDC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0;&amp;#xB294; &amp;#xCF54;&amp;#xB4DC;&amp;#xC758; &lt;code&gt;__try /__except /__finally&lt;/code&gt; &amp;#xC808;&amp;#xC744; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xD558;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D;&amp;#xB41C; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC815;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xAC00; &amp;#xC788;&amp;#xC9C0;&amp;#xB9CC; Windows&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; JIT &amp;#xC5D4;&amp;#xC9C4;&amp;#xC774; &amp;#xC2E4;&amp;#xD589; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xCF54;&amp;#xB4DC;&amp;#xB97C; &amp;#xB3D9;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC989;&amp;#xC2DC; &amp;#xC0DD;&amp;#xC131;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC744; &amp;#xBFD0;&amp;#xB9CC; &amp;#xC544;&amp;#xB2C8;&amp;#xB77C; &lt;code&gt;RtlAddFunctionTable&lt;/code&gt; API &amp;#xB4F1;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xB7F0;&amp;#xD0C0;&amp;#xC784;&amp;#xC5D0; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xB97C; &amp;#xB4F1;&amp;#xB85D;&amp;#xD558;&amp;#xACE0; opcode&amp;#xB97C; &amp;#xD574;&amp;#xC81C;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xB294; &amp;#xC774;&amp;#xC804;&amp;#xC5D0;&amp;#xB294; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBAA8;&amp;#xB4DC; stack walking &amp;#xBC0F; &amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C;&amp;#xC5D0;&amp;#xB9CC; &amp;#xD544;&amp;#xC694;&amp;#xD588;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC774;&amp;#xC81C;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xAC00; &amp;#xCEE4;&amp;#xB110;&amp;#xC774; RIP&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC7A0;&amp;#xC7AC;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C; &amp;#xAC12;&amp;#xC73C;&amp;#xB85C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xB300;&amp;#xC0C1;&amp;#xC774; &amp;#xB41C;&amp;#xB2E4;. &lt;code&gt;RtlpFindDynamicEHContinuationTarget&lt;/code&gt;&amp;#xC774; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC774; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xAC00;&amp;#xB2A5;&amp;#xC131;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CET &amp;#xC9C0;&amp;#xC6D0; &amp;#xBC0F; &lt;code&gt;NtContinueEx&lt;/code&gt; &amp;#xB3C4;&amp;#xC785;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; EPROCESS &amp;#xAD6C;&amp;#xC870;&amp;#xB294; &lt;code&gt;DynamicEHContinuationTargetsLock&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;DynamicEHContinuationTargetsTree&lt;/code&gt;&amp;#xB77C;&amp;#xB294; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD544;&amp;#xB4DC;&amp;#xB85C; &amp;#xD5A5;&amp;#xC0C1;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xCCAB; &amp;#xBC88;&amp;#xC9F8;&amp;#xB294; &lt;code&gt;EX_PUSH_LOCK&lt;/code&gt;&amp;#xC774;&amp;#xACE0; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &lt;code&gt;RTL_RB_TREE&lt;/code&gt;&amp;#xC774;&amp;#xB2E4;. &amp;#xC774; &amp;#xD2B8;&amp;#xB9AC;&amp;#xB294; &lt;code&gt;PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION&lt;/code&gt; &amp;#xC720;&amp;#xD615;&amp;#xC758; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xC815;&amp;#xBCF4; &amp;#xD074;&amp;#xB798;&amp;#xC2A4; &amp;#xC778; &lt;code&gt;ProcessDynamicEHContinuationTargets&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &lt;code&gt;NtSetInformationProcess&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD638;&amp;#xCD9C;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xAD00;&amp;#xB9AC;&amp;#xB41C;&amp;#xB2E4;. &amp;#xB354; &amp;#xC27D;&amp;#xAC8C; &amp;#xC774;&amp;#xD574;&amp;#xD558;&amp;#xB824;&amp;#xBA74; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAD6C;&amp;#xC870; &amp;#xBC0F; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC544;&amp;#xB798; &amp;#xC815;&amp;#xC758;&amp;#xB97C; &amp;#xCC38;&amp;#xC870;&amp;#xD558;&amp;#xBA74; &amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-meta-keyword&#34;&gt;define&lt;/span&gt; DYNAMIC_EH_CONTINUATION_TARGET_ADD          0x01&lt;/span&gt;
&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-meta-keyword&#34;&gt;define&lt;/span&gt; DYNAMIC_EH_CONTINUATION_TARGET_PROCESSED    0x02&lt;/span&gt;

&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;PROCESS_DYNAMIC_EH_CONTINUATION_TARGET&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt; 
    ULONG_PTR TargetAddress;
    ULONGLONG Flags;
} PROCESS_DYNAMIC_EH_CONTINUATION_TARGET, *PPROCESS_DYNAMIC_EH_CONTINUATION_TARGET;

&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    USHORT NumberOfTargets;
    USHORT Reserved;
    ULONG Reserved2;
    PPROCESS_DYNAMIC_EH_CONTINUATION_TARGET* Targets;
} PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION, *PPROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;PspProcessDynamicEHContinuationTargets&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xBC18;&amp;#xBCF5;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xBA70;, &amp;#xC774; &amp;#xC2DC;&amp;#xC810;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;RtlAddDynamicEHContinuationTarget&lt;/code&gt;&amp;#xC740; &amp;#xB300;&amp;#xC0C1; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0; &lt;code&gt;ETL_RB_TREE_BPROCESS.NODE&lt;/code&gt;&amp;#xC5D0; &lt;code&gt;RTL_RB_NODE&lt;/code&gt; &amp;#xB9C1;&amp;#xD06C;&amp;#xB97C; &amp;#xC5F0;&amp;#xACB0;&amp;#xD558;&amp;#xB294; &lt;code&gt;DYNAMIC_EH_CONTINUATION_TARGET_ADD&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8; &amp;#xC138;&amp;#xD2B8;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &amp;#xD56D;&amp;#xBAA9;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xBA70; &amp;#xBC18;&amp;#xB300;&amp;#xB85C; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xC5C6;&amp;#xC73C;&amp;#xBA74; &amp;#xB300;&amp;#xC0C1;&amp;#xC744; &amp;#xC870;&amp;#xD68C;&amp;#xD558;&amp;#xACE0; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xC81C;&amp;#xAC70;&amp;#xB418;&amp;#xACE0; &amp;#xB178;&amp;#xB4DC;&amp;#xAC00; &amp;#xD574;&amp;#xC81C;&amp;#xB41C;&amp;#xB2E4;. &amp;#xAC01; &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; &amp;#xCC98;&amp;#xB9AC;&amp;#xB420; &amp;#xB54C; &lt;code&gt;DYNAMIC_EH_CONTINUATION_TARGET_PROCESSED&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xC6D0;&amp;#xB798; &amp;#xC785;&amp;#xB825; &amp;#xBC84;&amp;#xD37C;&amp;#xC5D0; OR &amp;#xCC98;&amp;#xB9AC;&amp;#xB418;&amp;#xBBC0;&amp;#xB85C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xC5B4;&amp;#xB5A4; &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; &amp;#xC791;&amp;#xB3D9;&amp;#xD558;&amp;#xACE0; &amp;#xC791;&amp;#xB3D9;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC558;&amp;#xB294;&amp;#xC9C0; &amp;#xC54C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xBAA8;&amp;#xB4E0; ROP &amp;#xAC00;&amp;#xC82F;&amp;#xC774; &amp;#xB2E8;&amp;#xC21C;&amp;#xD788; &amp;#x2018;&amp;#xB3D9;&amp;#xC801; &amp;#xC5F0;&amp;#xC18D; &amp;#xBAA9;&amp;#xD45C;&amp;#x2019;&amp;#xB85C; &amp;#xCD94;&amp;#xAC00;&amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C;&amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC874;&amp;#xC7AC;&amp;#xB294; CET/CFG&amp;#xC640; &amp;#xC720;&amp;#xC0AC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xBCF4;&amp;#xD3B8;&amp;#xC801;&amp;#xC778; &amp;#xC6B0;&amp;#xD68C;&amp;#xB85C; &amp;#xBCF4;&amp;#xC778;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; Microsoft&amp;#xB294; &amp;#xBE0C;&amp;#xB77C;&amp;#xC6B0;&amp;#xC800;&amp;#xC640; Flash&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &lt;code&gt;out-of-process JIT&lt;/code&gt; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB9CC; &amp;#xACF5;&amp;#xC2DD;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &amp;#xC774; API&amp;#xB294; &amp;#xC6D0;&amp;#xACA9; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0;&amp;#xC11C;&amp;#xB9CC; &amp;#xC791;&amp;#xB3D9;&amp;#xD55C;&amp;#xB2E4;&amp;#xB294; &amp;#xC810;&amp;#xC5D0; &amp;#xC720;&amp;#xC758;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xD604;&amp;#xC7AC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0;&amp;#xC11C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xBA74; &amp;#xD56D;&amp;#xC0C1; &lt;code&gt;STATUS_ACCESS_DENIED&lt;/code&gt;&amp;#xB85C; &amp;#xC2E4;&amp;#xD328;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;&amp;#xD0C0;&amp;#xAC9F;-&amp;#xAC80;&amp;#xC99D;&#34;&gt;&lt;a href=&#34;#&amp;#xD0C0;&amp;#xAC9F;-&amp;#xAC80;&amp;#xC99D;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xD0C0;&amp;#xAC9F; &amp;#xAC80;&amp;#xC99D;&#34;&gt;&lt;/a&gt;&amp;#xD0C0;&amp;#xAC9F; &amp;#xAC80;&amp;#xC99D;&lt;/h2&gt;&lt;p&gt;&amp;#xC774; &amp;#xBAA8;&amp;#xB4E0; &amp;#xC9C0;&amp;#xC2DD;&amp;#xC744; &amp;#xD1B5;&amp;#xD569;&amp;#xD558;&amp;#xBA74; &lt;code&gt;RtlVerifyUserUnwindTarget&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xAE30; &amp;#xC26C;&amp;#xC6CC;&amp;#xC9C4;&amp;#xB2E4;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0;&amp;#xC11C; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xC640; &amp;#xC5F0;&amp;#xAD00;&amp;#xB41C; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; PE &amp;#xBAA8;&amp;#xB4C8;&amp;#xC744; &amp;#xC870;&amp;#xD68C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xBA3C;&amp;#xC800; &lt;code&gt;RtlpLookupUserFunctionTableInverted&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xACE0; &amp;#xC2E4;&amp;#xD328;&amp;#xD558;&amp;#xBA74; &amp;#xB300;&amp;#xC2E0; &lt;code&gt;MmGetImageBase&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xBAA8;&amp;#xB4C8;&amp;#xC774; 4GB &amp;#xBBF8;&amp;#xB9CC;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xBAA8;&amp;#xB4C8;&amp;#xC774; &amp;#xBC1C;&amp;#xACAC;&amp;#xB418;&amp;#xBA74; &lt;code&gt;LdrImageDirectoryEntryToLoadConfig&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; Image Load Configuration Directory&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC628;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7F0; &amp;#xB2E4;&amp;#xC74C; Long Jump &amp;#xB610;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB3D9;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC744; &amp;#xB9CC;&amp;#xD07C; &amp;#xCDA9;&amp;#xBD84;&amp;#xD788; &amp;#xD070;&amp;#xC9C0;&amp;#xC640; &lt;code&gt;guardflags&lt;/code&gt;&amp;#xC5D0; &lt;code&gt;IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;IMAGE_GUARD_EH_CONTINUATION_TABLE_PRESENT&lt;/code&gt;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB514;&amp;#xB809;&amp;#xD130;&amp;#xB9AC;&amp;#xAC00; &amp;#xC5C6;&amp;#xAC70;&amp;#xB098; &amp;#xB108;&amp;#xBB34; &amp;#xC791;&amp;#xC740; &amp;#xACBD;&amp;#xC6B0; &amp;#xD639;&amp;#xC740; &amp;#xC77C;&amp;#xCE58;&amp;#xD558;&amp;#xB294; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC774; &amp;#xC5C6;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xD638;&amp;#xD658;&amp;#xC131;&amp;#xC744; &amp;#xC704;&amp;#xD574; &lt;code&gt;STATUS_SUCCESS&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;Image Load Configuration Directory&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;GuardLongJumpTargetTable&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;GuardEHContinuationTable&lt;/code&gt;&amp;#xC744; &amp;#xAC00;&amp;#xC838;&amp;#xC624;&amp;#xACE0; &lt;code&gt;GuardLongJumpTargetCount&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;GuardEHContinuationCount&lt;/code&gt;&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; 40&amp;#xC5B5; &amp;#xAC1C; &amp;#xC774;&amp;#xC0C1;&amp;#xC774;&amp;#xBA74; &lt;code&gt;STATUS_INTEGER_OVERFLOW&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;. 0 &amp;#xAC1C; &amp;#xC774;&amp;#xC0C1;&amp;#xC758; &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; &amp;#xC788;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; bsearch_s (&amp;#xB300;&amp;#xC870;&amp;#xC790;&amp;#xB85C; &lt;code&gt;RtlpTarget Compare&lt;/code&gt; &amp;#xB97C; &amp;#xC804;&amp;#xB2EC;)&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; binary search&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; RVA&amp;#xB85C; &amp;#xBCC0;&amp;#xD658;&amp;#xD55C; &amp;#xD6C4; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC3E;&amp;#xB294;&amp;#xB2E4;. &amp;#xBC1C;&amp;#xACAC;&amp;#xB418;&amp;#xBA74; &lt;code&gt;STATUS_SUCCESS&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD569;&amp;#xB2C8;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC3E;&amp;#xC744; &amp;#xC218; &amp;#xC5C6;&amp;#xAC70;&amp;#xB098; (&amp;#xB610;&amp;#xB294; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC5D0; &amp;#xC2DC;&amp;#xC791;&amp;#xD560; &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; 0&amp;#xC778; &amp;#xACBD;&amp;#xC6B0;) &amp;#xCC98;&amp;#xC74C;&amp;#xBD80;&amp;#xD130; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xC5D0;&amp;#xC11C; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xBAA8;&amp;#xB4C8;&amp;#xC774; &amp;#xBC1C;&amp;#xACAC;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;STATUS_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD574;  &lt;code&gt;longjmp&lt;/code&gt; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC99D;&amp;#xD55C;&amp;#xB2E4;.(&lt;code&gt;KCONTINUE_LONGJUMP&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC; (&lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt;)&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;RtlpFindDynamicEHContinuationTarget&lt;/code&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xB4F1;&amp;#xB85D;&amp;#xB41C; &amp;#xC5F0;&amp;#xC18D; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB3D9;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB9DE;&amp;#xC73C;&amp;#xBA74; &lt;code&gt;STATUS_SUCCESS&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xACE0;, &amp;#xADF8;&amp;#xB807;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA74; &lt;code&gt;STATUS_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;&amp;#xACB0;&amp;#xB860;&#34;&gt;&lt;a href=&#34;#&amp;#xACB0;&amp;#xB860;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xACB0;&amp;#xB860;&#34;&gt;&lt;/a&gt;&amp;#xACB0;&amp;#xB860;&lt;/h1&gt;&lt;p&gt;CET&amp;#xC758; &amp;#xAD6C;&amp;#xD604;&amp;#xACFC; &amp;#xAD00;&amp;#xB828; mitigation&amp;#xC740; ROP &amp;#xBC0F; &amp;#xAE30;&amp;#xD0C0; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xD558;&amp;#xC774;&amp;#xC7AC;&amp;#xD0B9; &amp;#xAE30;&amp;#xC220;&amp;#xC758; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC744; &amp;#xBC29;&amp;#xC9C0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xC8FC;&amp;#xC694; &amp;#xB2E8;&amp;#xACC4;&amp;#xC774;&amp;#xB2E4;. &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xBB34;&amp;#xACB0;&amp;#xC131;&amp;#xC740; &amp;#xBD84;&amp;#xBA85; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD55C; &amp;#xC8FC;&amp;#xC81C;&amp;#xC774;&amp;#xBA70;, &amp;#xD5A5;&amp;#xD6C4; &amp;#xCD94;&amp;#xAC00;&amp;#xC801;&amp;#xC778; mitigation&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB428;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xB354;&amp;#xC6B1; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD574;&amp;#xC9C8; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;. &amp;#xCD94;&amp;#xAC00;&amp;#xC801;&amp;#xC778; &amp;#xD638;&amp;#xD658;&amp;#xC131; &amp;#xBB38;&amp;#xC81C;&amp;#xC640; &amp;#xC77C;&amp;#xD68C;&amp;#xC131; &amp;#xC2DC;&amp;#xB098;&amp;#xB9AC;&amp;#xC624;&amp;#xB85C; &amp;#xC778;&amp;#xD574; &amp;#xD2B9;&amp;#xC815; &amp;#xCC98;&amp;#xB9AC;&amp;#xB97C; &amp;#xD544;&amp;#xC694;&amp;#xB85C; &amp;#xD558;&amp;#xB294; &amp;#xC0AC;&amp;#xB840;&amp;#xAC00; &amp;#xC810;&amp;#xC810; &amp;#xB354; &amp;#xB9CE;&amp;#xC774; &amp;#xBC1C;&amp;#xACAC;&amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC644;&amp;#xD654; &amp;#xAE30;&amp;#xC220;, &amp;#xD2B9;&amp;#xD788; &amp;#xB9CE;&amp;#xC740; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &amp;#xAE30;&amp;#xC220;&amp;#xC758; &amp;#xBC1C;&amp;#xC804;&amp;#xB2E8;&amp;#xACC4;&amp;#xC5D0;&amp;#xB294; &amp;#xBB38;&amp;#xC81C;&amp;#xAC00; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD558;&amp;#xAE30; &amp;#xB9C8;&amp;#xB828;&amp;#xC774;&amp;#xACE0;, &amp;#xC6B0;&amp;#xB9AC;&amp;#xB294; &amp;#xC774; &amp;#xBD84;&amp;#xC57C;&amp;#xC5D0;&amp;#xC11C; &amp;#xB354; &amp;#xB9CE;&amp;#xC740; &amp;#xC5F0;&amp;#xAD6C;&amp;#xAC00; &amp;#xC774;&amp;#xB8E8;&amp;#xC5B4;&amp;#xC9D0;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xBBF8;&amp;#xB798;&amp;#xC5D0; &amp;#xD765;&amp;#xBBF8;&amp;#xB85C;&amp;#xC6B4; &amp;#xAC83;&amp;#xB4E4;&amp;#xC774; &amp;#xBC1C;&amp;#xACAC;&amp;#xB420; &amp;#xAC83;&amp;#xC774;&amp;#xB77C;&amp;#xACE0; &amp;#xD655;&amp;#xC2E0;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
 - hack &amp; life">
  <meta name="author" content="j0dev, y2sman">
  <meta name="keywords" content>
  <meta name="google-site-verification" content="DXkyiaX95-ws53Tyt0m91_umRf4gfV2qJIQZ5zQDIO4">
  <meta name="naver-site-verification" content="0b4fea742ed293b82621684e466d9f26c3ccee06">


  <meta property="og:type" content="website"> 
  <meta property="og:title" content="[Translation] R.I.P ROP: CET Internals in Windows 20H1 - hackyboiz">
  <meta property="og:description" content="&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694; L0ch&amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;! &amp;#xC9C0;&amp;#xB09C;&amp;#xBC88; Windows Patch Diffing&amp;#xC5D0; &amp;#xC774;&amp;#xC5B4; &amp;#xC774;&amp;#xBC88;&amp;#xC5D4; &amp;#xBC88;&amp;#xC5ED;&amp;#xAE00;&amp;#xB85C; &amp;#xB3CC;&amp;#xC544;&amp;#xC654;&amp;#xC2B5;&amp;#xB2C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC624;&amp;#xB298; &amp;#xBC88;&amp;#xC5ED;&amp;#xAE00;&amp;#xC758; &amp;#xC8FC;&amp;#xC81C;&amp;#xB294; &amp;#xC778;&amp;#xD154;&amp;#xC774; &amp;#xB3C4;&amp;#xC785;&amp;#xD55C; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xBBF8;&amp;#xD2F0;&amp;#xAC8C;&amp;#xC774;&amp;#xC158;&amp;#xC778; CET&amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. CET&amp;#xB294; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &amp;#xC6B0;&amp;#xB9AC; &amp;#xB9C9;&amp;#xB0B4;&amp;#xC778; Fabu1ous&amp;#xC758; &lt;a href=&#34;https://hackyboiz.github.io/2020/12/06/fabu1ous/x64-stack-alignment/&#34;&gt;x64 stack alignment&lt;/a&gt; &amp;#xAE00;&amp;#xC758; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC5D0; &amp;#xC7A0;&amp;#xAE50; &amp;#xC5B8;&amp;#xAE09;&amp;#xB418;&amp;#xAE30;&amp;#xB3C4; &amp;#xD588;&amp;#xC5C8;&amp;#xC8E0;? &amp;#xC778;&amp;#xD154;&amp;#xC5D0;&amp;#xC120; &amp;#xC774;&amp;#xBBF8; &amp;#xCC28;&amp;#xC138;&amp;#xB300; &amp;#xBAA8;&amp;#xBC14;&amp;#xC77C; &amp;#xD50C;&amp;#xB7AB;&amp;#xD3FC;&amp;#xC778; Tiger Lake&amp;#xC5D0; &amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xB0B4;&amp;#xC7A5;&amp;#xD588;&amp;#xC73C;&amp;#xB2C8; &amp;#xACE7; &amp;#xC0C1;&amp;#xC6A9;&amp;#xD654;&amp;#xAC00; &amp;#xBA38;&amp;#xC9C0;&amp;#xC54A;&amp;#xC558;&amp;#xB124;&amp;#xC694;.&lt;/p&gt;
&lt;p&gt;&amp;#xCCAB; &amp;#xBC88;&amp;#xC5ED;&amp;#xAE00;&amp;#xC774;&amp;#xB77C; &amp;#xC624;&amp;#xC5ED;&amp;#xACFC; &amp;#xC624;&amp;#xD0C0;&amp;#xAC00; &amp;#xB09C;&amp;#xBB34;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC2B5;&amp;#xB2C8;&amp;#xB2E4;.. &amp;#x3160;&amp;#x3160; &amp;#xBC1C;&amp;#xACAC;&amp;#xD558;&amp;#xC2E0;&amp;#xB2E4;&amp;#xBA74; &amp;#xAC00;&amp;#xCC28; &amp;#xC5C6;&amp;#xC774; &amp;#xC9C0;&amp;#xC801;&amp;#xD574;&amp;#xC8FC;&amp;#xC2DC;&amp;#xBA74; &amp;#xAC10;&amp;#xC0AC;&amp;#xD558;&amp;#xACA0;&amp;#xC2B5;&amp;#xB2C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; &amp;#xC6D0;&amp;#xBB38; &amp;#xAE00; : &lt;a href=&#34;https://windows-internals.com/cet-on-windows/&#34;&gt;R.I.P ROP: CET Internals in Windows 20H1&lt;/a&gt; &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;&amp;#xB4E4;&amp;#xC5B4;&amp;#xAC00;&amp;#xBA70;&#34;&gt;&lt;a href=&#34;#&amp;#xB4E4;&amp;#xC5B4;&amp;#xAC00;&amp;#xBA70;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xB4E4;&amp;#xC5B4;&amp;#xAC00;&amp;#xBA70;&#34;&gt;&lt;/a&gt;&amp;#xB4E4;&amp;#xC5B4;&amp;#xAC00;&amp;#xBA70;&lt;/h2&gt;&lt;p&gt;&amp;#xCD5C;&amp;#xADFC; Windows 10&amp;#xC758; 19H1(Version 1903) &amp;#xB9B4;&amp;#xB9AC;&amp;#xC988; &amp;#xBC84;&amp;#xC804;&amp;#xC5D0; &amp;#xB9E4;&amp;#xC6B0; &amp;#xD765;&amp;#xBBF8;&amp;#xB85C;&amp;#xC6B4; &amp;#xC77C;&amp;#xC774; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD588;&amp;#xB2E4;. &amp;#xC778;&amp;#xD154; &lt;a href=&#34;https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf&#34;&gt;CET(Control-flow Enforcement Technology)&lt;/a&gt; &amp;#xAD6C;&amp;#xD604;&amp;#xC774; &amp;#xC218;&amp;#xB144;&amp;#xAC04;&amp;#xC758; &amp;#xB17C;&amp;#xC758; &amp;#xB05D;&amp;#xC5D0; &amp;#xC2DC;&amp;#xC791;&amp;#xB41C; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; CET &amp;#xC801;&amp;#xC6A9;&amp;#xC740; &amp;#xBAA8;&amp;#xB4E0; &amp;#xBC84;&amp;#xC804;&amp;#xC758; Windows &amp;#xB9B4;&amp;#xB9AC;&amp;#xC988;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xACE0; &amp;#xC788;&amp;#xC73C;&amp;#xBA70;, &amp;#xC791;&amp;#xB144;(2020) &amp;#xB9B4;&amp;#xB9AC;&amp;#xC2A4;&amp;#xC778; 20H1 (&amp;#xBC84;&amp;#xC804; 2004)&amp;#xC740; Intel Tiger Lake CPU&amp;#xC5D0;&amp;#xC11C; &amp;#xB9B4;&amp;#xB9AC;&amp;#xC988; &amp;#xB420; CET&amp;#xC758; user mode shadow stack &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xC644;&amp;#xB8CC;&amp;#xD588;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC778;&amp;#xD154; CET&amp;#xB294; &amp;#xC775;&amp;#xC2A4;&amp;#xD50C;&amp;#xB85C;&amp;#xC787;&amp;#xC5D0;&amp;#xC11C; &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &amp;#xB450; &amp;#xAC00;&amp;#xC9C0; &amp;#xC720;&amp;#xD615;&amp;#xC758; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xBB34;&amp;#xACB0;&amp;#xC131; &amp;#xC704;&amp;#xBC18;&amp;#xC778; forward-edge &amp;#xC704;&amp;#xBC18; (indirect CALL &amp;#xBC0F; JMP)&amp;#xACFC; backward-edge &amp;#xC704;&amp;#xBC18; (RET)&amp;#xC744; &amp;#xD574;&amp;#xACB0;&amp;#xD558;&amp;#xB294; &amp;#xD558;&amp;#xB4DC;&amp;#xC6E8;&amp;#xC5B4; &amp;#xAE30;&amp;#xBC18; mitigation&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;forward-edge &amp;#xAD6C;&amp;#xD604;&amp;#xC740; &amp;#xC0C8;&amp;#xB86D;&amp;#xC9C0; &amp;#xC54A;&amp;#xC9C0;&amp;#xB9CC; (&amp;#xAE30;&amp;#xBCF8;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; Microsoft&amp;#xC758; &lt;a href=&#34;https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard&#34;&gt;Control Flow Guard&lt;/a&gt;&amp;#xC640; &amp;#xC720;&amp;#xC0AC;&amp;#xD55C; &amp;#xD615;&amp;#xD0DC;&amp;#xC758; &lt;a href=&#34;https://clang.llvm.org/docs/ControlFlowIntegrity.html&#34;&gt;clang-cfi&lt;/a&gt;&amp;#xC774;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC774;&amp;#xB2E4;.) backward-edge &amp;#xAD6C;&amp;#xD604;&amp;#xC740; ISA&amp;#xC758; &amp;#xADFC;&amp;#xBCF8;&amp;#xC801;&amp;#xC778; &amp;#xBCC0;&amp;#xD654;&amp;#xC5D0; &amp;#xC758;&amp;#xC874;&amp;#xD55C;&amp;#xB2E4;. Shadow Stack &amp;#xC740; CALL &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC5D0; &amp;#xD478;&amp;#xC2DC;&amp;#xB41C; &amp;#xBC18;&amp;#xD658; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xBCF5;&amp;#xC81C;&amp;#xD558;&amp;#xBA70;, RET &amp;#xBA85;&amp;#xB839;&amp;#xC5B4; &amp;#xC2E4;&amp;#xD589; &amp;#xC2DC; &amp;#xC2A4;&amp;#xD0DD; &amp;#xBC0F; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xAC12;&amp;#xC744; &amp;#xBAA8;&amp;#xB450; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xACE0; &amp;#xBD88;&amp;#xC77C;&amp;#xCE58; &amp;#xC2DC; INT #21 (&amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xBCF4;&amp;#xD638; &amp;#xC624;&amp;#xB958;)&amp;#xB97C; &amp;#xC0DD;&amp;#xC131;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C; &amp;#xBC0F; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC;&amp;#xB294; CALL&amp;#xACFC; RET &amp;#xC774;&amp;#xC678;&amp;#xC758; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xC2DC;&amp;#xD000;&amp;#xC2A4;(&amp;#xC608; : &amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xBC0F; &lt;a href=&#34;https://en.cppreference.com/w/cpp/utility/program/longjmp&#34;&gt;longjmp&lt;/a&gt;)&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C; &amp;#xC218;&amp;#xC900;&amp;#xC5D0;&amp;#xC11C; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xB3D9;&amp;#xC791;&amp;#xACFC; &amp;#xC77C;&amp;#xCE58;&amp;#xD558;&amp;#xB3C4;&amp;#xB85D; &lt;code&gt;Shadow Stack Pointer(SSP)&lt;/code&gt; &amp;#xB97C; &amp;#xC870;&amp;#xC791;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xBA70;, &amp;#xC774; &amp;#xC870;&amp;#xC791; &amp;#xC790;&amp;#xCCB4;&amp;#xAC00; &amp;#xC7A0;&amp;#xC7AC;&amp;#xC801;&amp;#xC778; &amp;#xC6B0;&amp;#xD68C;&amp;#xAC00; &amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xB3C4;&amp;#xB85D; &amp;#xAC80;&amp;#xC99D;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAC8C;&amp;#xC2DC;&amp;#xBB3C;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; Windows&amp;#xAC00; &amp;#xC774;&amp;#xB97C; &amp;#xB2EC;&amp;#xC131;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC124;&amp;#xBA85;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;Windows&amp;#xAC00; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; shadow stack&amp;#xC744; &amp;#xC870;&amp;#xC791;&amp;#xD558;&amp;#xACE0; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC790;&amp;#xC138;&amp;#xD788; &amp;#xC54C;&amp;#xC544;&amp;#xBCF4;&amp;#xAE30; &amp;#xC804;&amp;#xC5D0; &amp;#xBA3C;&amp;#xC800; &amp;#xB450; &amp;#xAC00;&amp;#xC9C0;&amp;#xB97C; &amp;#xC774;&amp;#xD574;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xCCAB; &amp;#xBC88;&amp;#xC9F8;&amp;#xB294; SSP&amp;#xC758; &amp;#xC2E4;&amp;#xC81C; &amp;#xC704;&amp;#xCE58; &amp;#xBC0F; &amp;#xAD8C;&amp;#xD55C;&amp;#xC774;&amp;#xACE0; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8;&amp;#xB294; SSP&amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xAC04; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC804;&amp;#xD658; &amp;#xC2DC; &amp;#xC800;&amp;#xC7A5;/&amp;#xBCF5;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xACFC; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xACBD;&amp;#xC6B0; (&amp;#xC608; : &amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xC911;)  SSP &amp;#xC218;&amp;#xC815;&amp;#xC774; &amp;#xC218;&amp;#xD589;&amp;#xB418;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xC744; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xB824;&amp;#xBA74; &lt;a href=&#34;https://en.wikipedia.org/wiki/Advanced_Vector_Extensions&#34;&gt;AVX(Advanced Vector eXtensions)&lt;/a&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; Intel&amp;#xC5D0;&amp;#xC11C; &amp;#xB3C4;&amp;#xC785;&amp;#xD558;&amp;#xACE0; Windows 7&amp;#xBD80;&amp;#xD130; Microsoft&amp;#xAC00; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD55C; Intel CPU &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC54C;&amp;#xC544;&amp;#xBD10;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; &amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xAE30;&amp;#xC874; CONTEXT&amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; CONTEXT_EX&amp;#xAD6C;&amp;#xC870;&amp;#xB85C; &amp;#xC7AC;&amp;#xAD6C;&amp;#xC131;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xB97C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; native API&amp;#xB97C; &amp;#xCD94;&amp;#xAC00;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC5D0; &amp;#xB300;&amp;#xD574;&amp;#xC11C;&amp;#xB3C4; &amp;#xC774;&amp;#xC57C;&amp;#xAE30;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;!&lt;/p&gt;
&lt;p&gt;&amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C; Windows&amp;#xC758; CET &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xCD94;&amp;#xAC00;&amp;#xC801;&amp;#xC778; &amp;#xC694;&amp;#xAD6C;&amp;#xC0AC;&amp;#xD56D;&amp;#xC744; &amp;#xB2E4;&amp;#xB8E8;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC77C;&amp;#xBD80; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC; &amp;#xBC0F; PE &amp;#xD30C;&amp;#xC77C; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC758; &amp;#xB0B4;&amp;#xBD80;&amp;#xC640; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xC815;&amp;#xBCF4; &amp;#xD074;&amp;#xB798;&amp;#xC2A4;&amp;#xB97C; &amp;#xC0B4;&amp;#xD3B4;&amp;#xBD10;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAE00;&amp;#xC758; &amp;#xBAA9;&amp;#xCC28;&amp;#xAC00; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC804;&amp;#xCCB4;&amp;#xC801;&amp;#xC778; &amp;#xB0B4;&amp;#xC6A9;&amp;#xC744; &amp;#xD0D0;&amp;#xC0C9;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xB3C4;&amp;#xC6C0;&amp;#xC774;&amp;#xB418;&amp;#xAE30;&amp;#xB97C; &amp;#xBC14;&amp;#xB780;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; &lt;a href=&#34;https://github.com/yardenshafir/cet-research&#34;&gt;&amp;#xAD00;&amp;#xB828; GitHub &amp;#xC800;&amp;#xC7A5;&amp;#xC18C;&lt;/a&gt;&amp;#xB97C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xD568;&amp;#xC218; &amp;#xC774;&amp;#xB984;&amp;#xC744; &amp;#xD074;&amp;#xB9AD;&amp;#xD558;&amp;#xBA74; &amp;#xC0C8;&amp;#xB85C; &amp;#xB3C4;&amp;#xC785;&amp;#xB41C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xD568;&amp;#xC218;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC8FC;&amp;#xC11D;&amp;#xC774; &amp;#xB2EC;&amp;#xB9B0; &amp;#xC18C;&amp;#xC2A4; &amp;#xCF54;&amp;#xB4DC;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;h1 id=&#34;XState-&amp;#xB0B4;&amp;#xBD80;&#34;&gt;&lt;a href=&#34;#XState-&amp;#xB0B4;&amp;#xBD80;&#34; class=&#34;headerlink&#34; title=&#34;XState &amp;#xB0B4;&amp;#xBD80;&#34;&gt;&lt;/a&gt;XState &amp;#xB0B4;&amp;#xBD80;&lt;/h1&gt;&lt;p&gt;x86-x64 &amp;#xC544;&amp;#xD0A4;&amp;#xD14D;&amp;#xCC98; &amp;#xD074;&amp;#xB798;&amp;#xC2A4; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xB294; &amp;#xBC94;&amp;#xC6A9; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;(RAX, RCX), &amp;#xC81C;&amp;#xC5B4; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; (RIP, RSP&amp;#x2026;), &amp;#xBD80;&amp;#xB3D9; &amp;#xC18C;&amp;#xC218;&amp;#xC810; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; (XMM, YMM, ZMM)&amp;#xC640; &amp;#xC77C;&amp;#xBD80; &amp;#xC81C;&amp;#xC5B4;, &amp;#xB514;&amp;#xBC84;&amp;#xADF8; &amp;#xBC0F; &amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xB4F1; &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; &amp;#xBCF4;&amp;#xC548; &amp;#xC5F0;&amp;#xAD6C;&amp;#xC790;&amp;#xB4E4;&amp;#xC5D0;&amp;#xAC8C; &amp;#xC775;&amp;#xC219;&amp;#xD55C; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xC138;&amp;#xD2B8;&amp;#xB85C; &amp;#xAD6C;&amp;#xC131;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xB354; &amp;#xB9CE;&amp;#xC740; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB428;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xC0C8; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xBC0F; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xACFC; &amp;#xAD00;&amp;#xB828;&amp;#xB41C; &amp;#xD2B9;&amp;#xC815; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD574;&amp;#xC57C; &amp;#xD588;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB9AC;&amp;#xACE0; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5; &amp;#xC911; &amp;#xB9CE;&amp;#xC740; &amp;#xBD80;&amp;#xBD84;&amp;#xC774; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xB0B4;&amp;#xBD80;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC804;&amp;#xD658; &amp;#xC911;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xACE0; &amp;#xBCF5;&amp;#xC6D0;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD574;&amp;#xACB0;&amp;#xCC45;&amp;#xC73C;&amp;#xB85C; &amp;#xC778;&amp;#xD154;&amp;#xC740; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &lt;code&gt;&amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&lt;/code&gt;&amp;#xC758; &amp;#xBE44;&amp;#xD2B8;&amp;#xC640; &amp;#xC5F0;&amp;#xACB0;&amp;#xD558;&amp;#xACE0; &lt;code&gt;XSAVE&lt;/code&gt; &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0;&amp;#xC11C; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC77D;&amp;#xACE0; &amp;#xC4F0;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &lt;code&gt;XSAVE&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;XRSTOR&lt;/code&gt;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xB97C; &amp;#xB3C4;&amp;#xC785;&amp;#xD558;&amp;#xB294; &lt;code&gt;XState(eXtended State)&lt;/code&gt; &lt;a href=&#34;https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developers-manual.pdf&#34;&gt;&amp;#xD45C;&amp;#xC900;&lt;/a&gt;&amp;#xC744; &amp;#xC815;&amp;#xC758;&amp;#xD588;&amp;#xB2E4;. &amp;#xC774; &amp;#xC601;&amp;#xC5ED;&amp;#xC740; &amp;#xAC01; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; CET &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xC800;&amp;#xC7A5;&amp;#xC18C;&amp;#xC758; &amp;#xC911;&amp;#xC694;&amp;#xD55C; &amp;#xBD80;&amp;#xBD84;&amp;#xC774;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; &amp;#xC0AC;&amp;#xB78C;&amp;#xB4E4;&amp;#xC740; &amp;#xAE30;&amp;#xC874; &amp;#xBD80;&amp;#xB3D9; &amp;#xC18C;&amp;#xC218;&amp;#xC810;, AVX &amp;#xBC0F; &lt;a href=&#34;https://software.intel.com/en-us/articles/introduction-to-intel-memory-protection-extensions&#34;&gt;&amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC; &amp;#xBCF4;&amp;#xD638; &amp;#xD655;&amp;#xC7A5;(Memory Protection eXtensions, MPX)&lt;/a&gt; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xCD08;&amp;#xC810;&amp;#xC744; &amp;#xB450;&amp;#xC5C8;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; XSAVE &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xB300;&amp;#xBD80;&amp;#xBD84; &amp;#xBB34;&amp;#xC2DC;&amp;#xD558;&amp;#xACE0; &amp;#xC788;&amp;#xB2E4;. &amp;#xAE30;&amp;#xB2A5; &amp;#xBC0F; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xAC1C;&amp;#xC694;&amp;#xB294; &amp;#xB3C5;&amp;#xC790;&amp;#xC5D0;&amp;#xAC8C; &amp;#xB3C4;&amp;#xC6C0;&amp;#xC774; &amp;#xB420; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;XSAVE-&amp;#xC601;&amp;#xC5ED;&#34;&gt;&lt;a href=&#34;#XSAVE-&amp;#xC601;&amp;#xC5ED;&#34; class=&#34;headerlink&#34; title=&#34;XSAVE &amp;#xC601;&amp;#xC5ED;&#34;&gt;&lt;/a&gt;XSAVE &amp;#xC601;&amp;#xC5ED;&lt;/h2&gt;&lt;p&gt;&amp;#xC55E;&amp;#xC11C; &amp;#xC5B8;&amp;#xAE09;&amp;#xD588;&amp;#xB4EF;&amp;#xC774; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC740; &amp;#xC6D0;&amp;#xB798; Intel&amp;#xC5D0;&amp;#xC11C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00; &amp;#xD55C; AVX&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xBD80;&amp;#xB3D9; &amp;#xC18C;&amp;#xC218;&amp;#xC810; &amp;#xAE30;&amp;#xB2A5; &amp;#xC911; &amp;#xC77C;&amp;#xBD80;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &lt;code&gt;FXSTOR&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;FXRSTR&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC800;&amp;#xC7A5;&amp;#xB418;&amp;#xB294; &amp;#xAE30;&amp;#xC874; x86 FPU &amp;#xBC0F; SSE &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xD1B5;&amp;#xD569;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC774; &amp;#xCC98;&amp;#xC74C; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB294; &lt;code&gt;&amp;#xB808;&amp;#xAC70;&amp;#xC2DC; XSAVE &amp;#xC601;&amp;#xC5ED;&lt;/code&gt;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC815;&amp;#xC758;&amp;#xB418;&amp;#xC5C8;&amp;#xC73C;&amp;#xBA70; &amp;#xCD94;&amp;#xAC00; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; (&amp;#xC608; : AVX)&amp;#xB294; &lt;code&gt;&amp;#xD655;&amp;#xC7A5;&amp;#xB41C; XSAVE &amp;#xC601;&amp;#xC5ED;&lt;/code&gt;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xADF8; &amp;#xC0AC;&amp;#xC774;&amp;#xC5D0; &lt;code&gt;XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xD5E4;&amp;#xB354;&lt;/code&gt; &amp;#xB294; &lt;code&gt;XSTATE_BV&lt;/code&gt;&amp;#xB77C;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC5B4;&amp;#xB5A4; &amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB3D9;&amp;#xC2DC;&amp;#xC5D0; XSAVE &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC6B4;&amp;#xC601;&amp;#xCCB4;&amp;#xC81C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD558;&amp;#xB294; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;code&gt;XCR0(eXtended Control Register)&lt;/code&gt;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xC73C;&amp;#xBA70; XCR0&amp;#xC744; &amp;#xAD6C;&amp;#xC131;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;XGETBV&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;XSETBV&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. (&amp;#xC774;&amp;#xD6C4;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB420; &lt;code&gt;XCR&lt;/code&gt;&amp;#xB3C4; &amp;#xB9C8;&amp;#xCC2C;&amp;#xAC00;&amp;#xC9C0;&amp;#xC774;&amp;#xB2E4;.) &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4; &amp;#xC6B4;&amp;#xC601;&amp;#xCCB4;&amp;#xC81C;&amp;#xB294; x87 FPU &amp;#xBC0F; SSE&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB3C4;&amp;#xB85D;, &amp;#xC989; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &lt;code&gt;FXSTOR&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xC218;&amp;#xB3D9;&amp;#xC73C;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xACE0; &amp;#xD655;&amp;#xC7A5;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB9CC; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB3C4;&amp;#xB85D; XCR0&amp;#xC744; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB798;&amp;#xBC0D;&amp;#xD574; &amp;#xC120;&amp;#xD0DD;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PKRU(Protection Key Register User State)&lt;/code&gt;&amp;#xB97C; &amp;#xCD94;&amp;#xAC00;&amp;#xD55C;  &lt;a href=&#34;https://www.kernel.org/doc/html/latest/core-api/protection-keys.html&#34;&gt;MPK(Memory Protection Key)&lt;/a&gt;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xACE0;&amp;#xAE09; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xC138;&amp;#xD2B8; &amp;#xBC0F; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC218;&amp;#xAC00; &amp;#xC99D;&amp;#xAC00;&amp;#xD568;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xCD5C;&amp;#xC2E0; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xB294; &lt;code&gt;XSAVES&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;XRSRTORS&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; CPL0 &amp;#xCF54;&amp;#xB4DC;&amp;#xB85C;&amp;#xB9CC; &amp;#xC218;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xC288;&amp;#xD37C;&amp;#xBC14;&amp;#xC774;&amp;#xC800; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC640; &amp;#xC555;&amp;#xCD95; &amp;#xBC0F; &amp;#xCD5C;&amp;#xC801;&amp;#xD654; &amp;#xBC84;&amp;#xC804; (&lt;code&gt;XSAVEC&lt;/code&gt; / &lt;code&gt;XSAVEOPT&lt;/code&gt;)&amp;#xC73C;&amp;#xB85C; &amp;#xAD6C;&amp;#xBD84;&amp;#xD574; &amp;#xC778;&amp;#xD154;&amp;#xB9CC;&amp;#xC758; &amp;#xBC29;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD558;&amp;#xAC8C; &amp;#xB9CC;&amp;#xB4E4;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC288;&amp;#xD37C;&amp;#xBC14;&amp;#xC774;&amp;#xC800; &amp;#xC804;&amp;#xC6A9; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;IA32_XSS&lt;/code&gt;&amp;#xB77C;&amp;#xB294; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;code&gt;MSR(Model Specific Register)&lt;/code&gt;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/1.png&#34; alt&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;optimized XSAVE &amp;#xC601;&amp;#xC5ED; vs not optimized XSAVE &amp;#xC601;&amp;#xC5ED;&lt;br&gt;(VX &amp;#xBC0F; CET_U&amp;#xAC00; &amp;#xB178;&amp;#xD2B8; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xACE0; IPT &amp;#xBC0F; PKRU&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5C8;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC804;&amp;#xD658; &amp;#xC774;&amp;#xD6C4;&amp;#xC5D0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;Optimized XSAVE&lt;/code&gt; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xC740; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC2A4;&amp;#xC704;&amp;#xCE58; (&amp;#xC788;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;) &amp;#xC774;&amp;#xD6C4; &amp;#xB2E4;&amp;#xB978; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC218;&amp;#xC815;&amp;#xB41C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB9CC; XSAVE&amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xAE30;&amp;#xB85D;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xAC8C; &amp;#xD574; &amp;#xC8FC;&amp;#xBA70; &amp;#xB0B4;&amp;#xBD80; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB294; &lt;code&gt;XINUSE&lt;/code&gt;&amp;#xC774; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xCD94;&amp;#xC801;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xAC8C; &amp;#xD574; &amp;#xC900;&amp;#xB2E4;. &lt;code&gt;XSAVEOPT&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xB54C; &lt;code&gt;XSTATE_BV&lt;/code&gt; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB294; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xBAA8;&amp;#xB4E0; &amp;#xC0C1;&amp;#xD0DC;&amp;#xAC00; &amp;#xC544;&amp;#xB2C8;&amp;#xB77C; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;&amp;#xD558;&amp;#xB294; &amp;#xBE44;&amp;#xD2B8;&amp;#xB9CC; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xBC18;&amp;#xBA74; &lt;code&gt;Compacted XSAVE&lt;/code&gt; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xC740; &amp;#xAE30;&amp;#xC874; XState &amp;#xB514;&amp;#xC790;&amp;#xC778;&amp;#xC758; &amp;#xACB0;&amp;#xD568;&amp;#xC744; &amp;#xC218;&amp;#xC815;&amp;#xD588;&amp;#xB2E4;. &lt;code&gt;AVX512&lt;/code&gt; &amp;#xBC0F; &lt;a href=&#34;https://software.intel.com/content/www/us/en/develop/blogs/processor-tracing.html&#34;&gt;IPT(Intel Processor Trace)&lt;/a&gt;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xB354; &amp;#xB9CE;&amp;#xC740; &amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB428;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA74; &amp;#xD070; XSAVE&amp;#xC601;&amp;#xC5ED;&amp;#xC744; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0; 0&amp;#xC73C;&amp;#xB85C; &amp;#xAE30;&amp;#xB85D;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &lt;code&gt;Optimized XSAVE&lt;/code&gt;&amp;#xB294; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xB0AD;&amp;#xBE44;&amp;#xB97C; &amp;#xD53C;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC5EC;&amp;#xC804;&amp;#xD788; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xB294; &amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5;&amp;#xC740; &amp;#xAE30;&amp;#xBCF8; XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xBC84;&amp;#xD37C;&amp;#xB85C;&amp;#xBD80;&amp;#xD130; &amp;#xD070; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0; &amp;#xC788;&amp;#xC74C;&amp;#xC744; &amp;#xC758;&amp;#xBBF8;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;XSAVEC&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBA74; &amp;#xD604;&amp;#xC7AC; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xACF5;&amp;#xAC04;&amp;#xB9CC; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xACE0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xAC01; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC21C;&amp;#xCC28;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xC5D0; &amp;#xBC30;&amp;#xCE58;&amp;#xD568;&amp;#xC73C;&amp;#xB85C;&amp;#xC368; &amp;#xBB38;&amp;#xC81C;&amp;#xB97C; &amp;#xD574;&amp;#xACB0;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. (CPUID&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &lt;code&gt;&amp;#xC815;&amp;#xB82C; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&lt;/code&gt;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC81C;&amp;#xACF5;&amp;#xB418;&amp;#xB294; &amp;#xACE0;&amp;#xC815; 64-byte &amp;#xC815;&amp;#xB82C;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.)&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xC804;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xD5E4;&amp;#xB354;&amp;#xB294; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xC778; &lt;code&gt;XCOMP_BV&lt;/code&gt;&amp;#xB85C; &amp;#xD655;&amp;#xC7A5;&amp;#xB418;&amp;#xC5B4; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8; &amp;#xC911; &amp;#xC5B4;&amp;#xB290; &amp;#xAC83;&amp;#xC774; &amp;#xBE44;&amp;#xAD50; &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xC788;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xB098;&amp;#xD0C0;&amp;#xB0B8;&amp;#xB2E4;. &lt;code&gt;XSTATE_BV&lt;/code&gt;&amp;#xC640; &amp;#xB2EC;&amp;#xB9AC; &amp;#xC774; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB294; &lt;code&gt;XINUSE&lt;/code&gt;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xAC00; &amp;#xC544;&amp;#xB2CC; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC0DD;&amp;#xB7B5;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC544; &amp;#xC555;&amp;#xCD95;&amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &lt;code&gt;XSTATE_BV&lt;/code&gt;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC5B4;&amp;#xB5A4; &amp;#xC0C1;&amp;#xD0DC; &amp;#xC601;&amp;#xC5ED;&amp;#xC774; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C;, &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB420; &amp;#xB54C; &amp;#xBE44;&amp;#xD2B8; 63&amp;#xC740; &amp;#xD56D;&amp;#xC0C1; &lt;code&gt;XCOMP_BV&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC9C0;&amp;#xC2DC;&amp;#xC790;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC778;&amp;#xC9C0;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xB0B4;&amp;#xBD80; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xACFC; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xACB0;&amp;#xC815;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC740; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD574;&amp;#xC11C;&amp;#xB9CC; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xB97C; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0;, &amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC740; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xAC00; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xB97C; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xAE30;&amp;#xB2A5;&amp;#xB9CC; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC544;&amp;#xB798; &amp;#xB2E4;&amp;#xC774;&amp;#xC5B4;&amp;#xADF8;&amp;#xB7A8;&amp;#xC740; &amp;#xB3D9;&amp;#xC77C;&amp;#xD55C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC774; &amp;#xC5B4;&amp;#xB5BB;&amp;#xAC8C; &amp;#xBCF4;&amp;#xC774;&amp;#xB294;&amp;#xC9C0;, &amp;#xAC01;&amp;#xAC01;&amp;#xC758; &amp;#xD3EC;&amp;#xB9F7;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xB54C;&amp;#xC758; &amp;#xC608;&amp;#xB97C; &amp;#xBCF4;&amp;#xC5EC;&amp;#xC900;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/2.png&#34; alt&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Compacted XSAVE vs not Compacted XSAVE AVX &amp;#xBC0F; CET_U&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;, &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC2E4;&amp;#xD589;&amp;#xB428;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;#xC694;&amp;#xC57D;&amp;#xD558;&amp;#xC790;&amp;#xBA74;,  &lt;code&gt;XSAVE&lt;/code&gt;&amp;#xC640; &lt;code&gt;XRSTOR&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4; &amp;#xC9D1;&amp;#xD569;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xC740; &amp;#xC870;&amp;#xD569;&amp;#xACFC; &amp;#xD568;&amp;#xAED8; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;OS&amp;#xAC00; XCR0&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD560; &amp;#xB54C; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8; (&lt;code&gt;XSETBV&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xC124;&amp;#xC815;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XSAVE&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xB54C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; EDX : EAX&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8; (&amp;#xC778;&amp;#xD154;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xC774;&amp;#xB97C; &lt;code&gt;instruction mask&lt;/code&gt;&amp;#xB77C;&amp;#xACE0; &amp;#xD568;)&lt;/li&gt;
&lt;li&gt;&amp;#xAD8C;&amp;#xD55C;&amp;#xC774; &amp;#xC5C6;&amp;#xB294; &amp;#xBA85;&amp;#xB839;&amp;#xC5B4;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;IA32_XSS&lt;/code&gt;&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XINUSE&lt;/code&gt;&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xC778; &lt;code&gt;&amp;#xCD5C;&amp;#xC801;&amp;#xD654;&amp;#xB41C; XSAVE&lt;/code&gt;&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0;&amp;#xC11C; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xC804;&amp;#xD658; &amp;#xC774;&amp;#xD6C4; &amp;#xD604;&amp;#xC7AC; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C; &amp;#xC2E4;&amp;#xC81C; XState &amp;#xAD00;&amp;#xB828; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB97C; &amp;#xCD94;&amp;#xC801;&amp;#xD558;&amp;#xB294; &amp;#xB0B4;&amp;#xBD80; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xD568;&amp;#xAED8; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD0B9;&amp;#xB418;&amp;#xBA74; &lt;code&gt;XSAVE&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &lt;code&gt;XSTATE_BV&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC758; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xD5E4;&amp;#xB354;&amp;#xC5D0; &amp;#xCD5C;&amp;#xC885; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xAE30;&amp;#xB85D;&amp;#xB41C;&amp;#xB2E4;. &lt;code&gt;Compacted XSAVE&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;XINUSE&lt;/code&gt;&amp;#xB97C; &amp;#xC0DD;&amp;#xB7B5;&amp;#xD55C; &amp;#xACB0;&amp;#xACFC; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00;  &lt;code&gt;XCOMP_BV&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xD5E4;&amp;#xB354;&amp;#xC5D0; &amp;#xAE30;&amp;#xB85D;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC544;&amp;#xB798; &amp;#xB2E4;&amp;#xC774;&amp;#xC5B4;&amp;#xADF8;&amp;#xB7A8;&amp;#xC740; &amp;#xACB0;&amp;#xACFC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xBCF4;&amp;#xC5EC;&amp;#xC900;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/3.png&#34; alt&gt;&lt;/p&gt;
&lt;h2 id=&#34;XState-&amp;#xAD6C;&amp;#xC131;&#34;&gt;&lt;a href=&#34;#XState-&amp;#xAD6C;&amp;#xC131;&#34; class=&#34;headerlink&#34; title=&#34;XState &amp;#xAD6C;&amp;#xC131;&#34;&gt;&lt;/a&gt;XState &amp;#xAD6C;&amp;#xC131;&lt;/h2&gt;&lt;p&gt;&amp;#xAC01; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0;&amp;#xB294; &amp;#xC790;&amp;#xCCB4;&amp;#xC801;&amp;#xC778; XState &amp;#xD65C;&amp;#xC131;&amp;#xD654; &amp;#xAE30;&amp;#xB2A5;, &amp;#xC608;&amp;#xC0C1;&amp;#xB418;&amp;#xB294; &amp;#xD06C;&amp;#xAE30;, &amp;#xAE30;&amp;#xB2A5; &amp;#xBC0F; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998; &amp;#xC138;&amp;#xD2B8;&amp;#xB97C; &amp;#xAC00;&amp;#xC9C0;&amp;#xACE0; &amp;#xC788;&amp;#xC5B4; Intel&amp;#xC740; &amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C;&amp;#xAC00; XState&amp;#xB97C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD560; &amp;#xB54C; &amp;#xCFFC;&amp;#xB9AC; &amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; CPUID &amp;#xD074;&amp;#xB798;&amp;#xC2A4;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xB178;&amp;#xCD9C;&amp;#xD55C;&amp;#xB2E4;. Windows&amp;#xB294; &amp;#xBD80;&amp;#xD305; &amp;#xC2DC; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xCFFC;&amp;#xB9AC;&amp;#xB97C; &amp;#xC218;&amp;#xD589;&amp;#xD558;&amp;#xACE0; &lt;code&gt;XSTATE_CONFIGURATION&lt;/code&gt; &amp;#xC544;&amp;#xB798;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD55C;&amp;#xB2E4;. (Winnt.h&amp;#xC5D0; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB428;)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;XSTATE_CONFIGURATION&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    ULONG64 EnabledFeatures;
    ULONG64 EnabledVolatileFeatures;
    ULONG Size;
    &lt;span class=&#34;hljs-keyword&#34;&gt;union&lt;/span&gt;
    {
        ULONG ControlFlags;
        &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;        {&lt;/span&gt;
            ULONG OptimizedSave:&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;
            ULONG CompactionEnabled:&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;;
        };
    };
    XSTATE_FEATURE Features[MAXIMUM_XSTATE_FEATURES];
    ULONG64 EnabledSupervisorFeatures;
    ULONG64 AlignedFeatures;
    ULONG AllFeatureSize;
    ULONG AllFeatures[MAXIMUM_XSTATE_FEATURES];
    ULONG64 EnabledUserVisibleSupervisorFeatures;
} XSTATE_CONFIGURATION, *PXSTATE_CONFIGURATION;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB4E4;&amp;#xC744; &amp;#xBCF4;&amp;#xAD00;&amp;#xD55C; &amp;#xD6C4; &amp;#xCEE4;&amp;#xB110;&amp;#xC740; &lt;code&gt;KUSER_SHARED_DATA&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xB294; &lt;code&gt;SharedUserData&lt;/code&gt; &amp;#xBCC0;&amp;#xC218;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC561;&amp;#xC138;&amp;#xC2A4; &amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; &amp;#xBAA8;&amp;#xB4E0; Windows &amp;#xD50C;&amp;#xB7AB;&amp;#xD3FC;&amp;#xC758; &lt;code&gt;0x7FFE0000&lt;/code&gt; &amp;#xC8FC;&amp;#xC18C;&amp;#xC5D0; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;Optimized, Compacted XSAVE&amp;#xB97C; &amp;#xBAA8;&amp;#xB450; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xACE0; x87 FPU(0), SSE(1), AVX(2) &amp;#xBC0F; MPX(3, 4) &amp;#xAE30;&amp;#xB2A5; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &lt;code&gt;19H1&lt;/code&gt; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC758; &amp;#xCD9C;&amp;#xB825;&amp;#xC744; &amp;#xC608;&amp;#xB85C; &amp;#xB4E4; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx ((nt!_KUSER_SHARED_DATA*)&lt;span class=&#34;hljs-number&#34;&gt;0x7ffe0000&lt;/span&gt;)-&amp;gt;XState
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] EnabledFeatures  : &lt;span class=&#34;hljs-number&#34;&gt;0x1f&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] EnabledVolatileFeatures : &lt;span class=&#34;hljs-number&#34;&gt;0xf&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x010&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x3c0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x014&lt;/span&gt;] ControlFlags     : &lt;span class=&#34;hljs-number&#34;&gt;0x3&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x014&lt;/span&gt; ( &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;: &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;)] OptimizedSave    : &lt;span class=&#34;hljs-number&#34;&gt;0x1&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x014&lt;/span&gt; ( &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;: &lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;)] CompactionEnabled : &lt;span class=&#34;hljs-number&#34;&gt;0x1&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x018&lt;/span&gt;] Features         [Type: _XSTATE_FEATURE [&lt;span class=&#34;hljs-number&#34;&gt;64&lt;/span&gt;]]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x218&lt;/span&gt;] EnabledSupervisorFeatures : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x220&lt;/span&gt;] AlignedFeatures  : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x228&lt;/span&gt;] AllFeatureSize   : &lt;span class=&#34;hljs-number&#34;&gt;0x3c0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x22c&lt;/span&gt;] AllFeatures      [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt; [&lt;span class=&#34;hljs-number&#34;&gt;64&lt;/span&gt;]]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x330&lt;/span&gt;] EnabledUserVisibleSupervisorFeatures : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Features &amp;#xBC30;&amp;#xC5F4;&amp;#xC5D0;&amp;#xC11C; &amp;#xB2E4;&amp;#xC74C; 5&amp;#xAC00;&amp;#xC9C0; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx -r2 (((nt!_KUSER_SHARED_DATA*)&lt;span class=&#34;hljs-number&#34;&gt;0x7ffe0000&lt;/span&gt;)-&amp;gt;XState)-&amp;gt;Features.Take(&lt;span class=&#34;hljs-number&#34;&gt;5&lt;/span&gt;)
    [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0xa0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0xa0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x100&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0x240&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x100&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0x340&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x40&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [&lt;span class=&#34;hljs-number&#34;&gt;4&lt;/span&gt;]              [Type: _XSTATE_FEATURE]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Offset           : &lt;span class=&#34;hljs-number&#34;&gt;0x380&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size             : &lt;span class=&#34;hljs-number&#34;&gt;0x40&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xD569;&amp;#xD558;&amp;#xBA74; &amp;#xC704;&amp;#xC758; &lt;code&gt;FeatureSize&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xAC12;&amp;#xC778; &lt;code&gt;0x3C0&lt;/code&gt;&amp;#xC774; &amp;#xB41C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC774; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC740; &lt;code&gt;Compacted XSAVE&lt;/code&gt; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &amp;#xC5EC;&amp;#xAE30;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC740; &amp;#xAD00;&amp;#xB828;&amp;#xC774; &amp;#xC5C6;&amp;#xC73C;&amp;#xBA70; &amp;#xBAA8;&amp;#xB4E0; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC740; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB294; &amp;#xCEE4;&amp;#xB110;&amp;#xC5D0;&amp;#xB9CC; &amp;#xC720;&amp;#xC6A9;&amp;#xD558;&amp;#xAC8C; &amp;#xC0AC;&amp;#xC6A9; &amp;#xAC00;&amp;#xB2A5;&amp;#xD558;&amp;#xB2E4;.(&lt;code&gt;XCOMP_BV&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &amp;#xC555;&amp;#xCD95; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xACB0;&amp;#xC815;&amp;#xB418;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;)&lt;/p&gt;
&lt;h2 id=&#34;XState-&amp;#xC815;&amp;#xCC45;&#34;&gt;&lt;a href=&#34;#XState-&amp;#xC815;&amp;#xCC45;&#34; class=&#34;headerlink&#34; title=&#34;XState &amp;#xC815;&amp;#xCC45;&#34;&gt;&lt;/a&gt;XState &amp;#xC815;&amp;#xCC45;&lt;/h2&gt;&lt;p&gt;&amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xAC00; XState&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xD558;&amp;#xB4DC;&amp;#xC6E8;&amp;#xC5B4; &amp;#xC624;&amp;#xB958; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xD2B9;&amp;#xC815; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xAC00; &amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC81C;&amp;#xB300;&amp;#xB85C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xC9C0; &amp;#xBABB;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xAC00; &amp;#xC885;&amp;#xC885; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xBB38;&amp;#xC81C;&amp;#xB97C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; Windows&amp;#xB294; &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC73C;&amp;#xB85C;  &amp;#xB77C;&amp;#xACE0; &amp;#xD558;&amp;#xB294; &amp;#xD558;&amp;#xB4DC;&amp;#xC6E8;&amp;#xC5B4; &amp;#xC815;&amp;#xCC45; &amp;#xB4DC;&amp;#xB77C;&amp;#xC774;&amp;#xBC84;&amp;#xC778; &lt;code&gt;HwPolicy.sys&lt;/code&gt; &amp;#xC758; &amp;#xB9AC;&amp;#xC18C;&amp;#xC2A4; &amp;#xC139;&amp;#xC158;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; XState &amp;#xC815;&amp;#xCC45;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;Intel x86 &amp;#xC544;&amp;#xD0A4;&amp;#xD14D;&amp;#xCC98;&amp;#xB294; &amp;#xC5EC;&amp;#xB7EC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xBCA4;&amp;#xB354; &amp;#xC911; &amp;#xD558;&amp;#xB098;&amp;#xC774;&amp;#xBBC0;&amp;#xB85C; &amp;#xCEE4;&amp;#xB110;&amp;#xC740; XState &amp;#xC815;&amp;#xCC45;&amp;#xC744; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xD558;&amp;#xACE0; &amp;#xD604;&amp;#xC7AC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC758; &amp;#xBCA4;&amp;#xB354; &amp;#xBB38;&amp;#xC790;&amp;#xC5F4; &amp;#xBC0F; &amp;#xB9C8;&amp;#xC774;&amp;#xD06C;&amp;#xB85C;&amp;#xCF54;&amp;#xB4DC; &amp;#xBC84;&amp;#xC804;&amp;#xBFD0;&amp;#xB9CC; &amp;#xC544;&amp;#xB2C8;&amp;#xB77C; &amp;#xC2DC;&amp;#xADF8;&amp;#xB2C8;&amp;#xCC98;, &amp;#xAE30;&amp;#xB2A5; &amp;#xBC0F; &amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xBE44;&amp;#xAD50;&amp;#xD558;&amp;#xACE0; (&amp;#xC989;, CPUID 01h &amp;#xCFFC;&amp;#xB9AC;&amp;#xC758; RAX, RDX &amp;#xBC0F; RCX), &amp;#xC815;&amp;#xCC45;&amp;#xC5D0;&amp;#xC11C; &amp;#xC77C;&amp;#xCE58;&amp;#xD558;&amp;#xB294; &amp;#xD56D;&amp;#xBAA9;&amp;#xC744; &amp;#xCC3E;&amp;#xB294;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xC791;&amp;#xC5C5;&amp;#xC740; &amp;#xBD80;&amp;#xD305; &amp;#xC2DC;&amp;#xC5D0; &lt;code&gt;KiInitializeXSave&lt;/code&gt;&amp;#xAC00; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xB294; &lt;code&gt;KiIntersectFeaturesWithPolicy&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xC5D0;&amp;#xC11C; &amp;#xC218;&amp;#xD589;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xB294; &lt;code&gt;KiLoadPolicyFromImage&lt;/code&gt; &amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xC801;&amp;#xC808;&amp;#xD55C; XState &amp;#xC815;&amp;#xCC45;&amp;#xC744; &amp;#xB85C;&amp;#xB4DC;&amp;#xD558;&amp;#xACE0; &lt;code&gt;KiGetProcessorInformation&lt;/code&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; CPU&amp;#xC758; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC628; &amp;#xB2E4;&amp;#xC74C; XState &amp;#xAD6C;&amp;#xC131;&amp;#xC5D0;&amp;#xC11C; &amp;#xD604;&amp;#xC7AC; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xAC01; &amp;#xAE30;&amp;#xB2A5; &amp;#xBE44;&amp;#xD2B8;&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &lt;code&gt;KiIsXSaveFeatureAllowed&lt;/code&gt; &amp;#xD638;&amp;#xCD9C;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC740; &lt;code&gt;HwPolicy.sys&lt;/code&gt; &amp;#xB4DC;&amp;#xB77C;&amp;#xC774;&amp;#xBC84;&amp;#xC758; &amp;#xB9AC;&amp;#xC18C;&amp;#xC2A4; 101&amp;#xC5D0;&amp;#xC11C; &amp;#xC791;&amp;#xB3D9;&amp;#xD558;&amp;#xBA70; &amp;#xAD6C;&amp;#xC870;&amp;#xB294; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;XSAVE_POLICY&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    ULONG Version;
    ULONG Size;
    ULONG Flags;
    ULONG MaxSaveAreaLength;
    ULONGLONG FeatureBitmask;
    ULONG NumberOfFeatures;
    XSAVE_FEATURE Features[&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;];
} XSAVE_POLICY, *PXSAVE_POLICY;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4;,  &lt;code&gt;19H1&lt;/code&gt; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xC11C; &amp;#xB9AC;&amp;#xC18C;&amp;#xC2A4; &amp;#xD574;&amp;#xCEE4;&amp;#xB85C; &amp;#xCD94;&amp;#xCD9C;&amp;#xD55C; &amp;#xB0B4;&amp;#xC6A9;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx @$policy = (_XSAVE_POLICY*)&lt;span class=&#34;hljs-number&#34;&gt;0x253d0e90000&lt;/span&gt;
[+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Version       : &lt;span class=&#34;hljs-number&#34;&gt;0x3&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Size          : &lt;span class=&#34;hljs-number&#34;&gt;0x2fd8&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] Flags         : &lt;span class=&#34;hljs-number&#34;&gt;0x9&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x00c&lt;/span&gt;] MaxSaveAreaLength : &lt;span class=&#34;hljs-number&#34;&gt;0x2000&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x010&lt;/span&gt;] FeatureBitmask   : &lt;span class=&#34;hljs-number&#34;&gt;0x7fffffffffffffff&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x018&lt;/span&gt;] NumberOfFeatures : &lt;span class=&#34;hljs-number&#34;&gt;0x3f&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x020&lt;/span&gt;] Features      [Type: _XSAVE_FEATURE [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xAC01; &lt;code&gt;XSAVE_FEATURE&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xAC01;&amp;#xAC01; CPU &amp;#xACF5;&amp;#xAE09; &amp;#xC5C5;&amp;#xCCB4; &amp;#xBB38;&amp;#xC790;&amp;#xC5F4;&amp;#xC774; &amp;#xC788;&amp;#xB294; &lt;code&gt;XSAVE_VENDOR&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xBC30;&amp;#xC5F4;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &lt;code&gt;XSAVE_VENDORS&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xACFC; (&amp;#xC9C0;&amp;#xAE08;&amp;#xC740; &amp;#xAC01;&amp;#xAC01; &amp;#x201C;GenuineIntel&amp;#x201D;, &amp;#x201C;AuthenticAMD&amp;#x201D; &amp;#xB610;&amp;#xB294; &amp;#x201C;CentaurHauls&amp;#x201D;) &lt;code&gt;XSAVE_CPU_ERRATA&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4;, &lt;code&gt;19H1&lt;/code&gt; &amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xB294; &amp;#xAE30;&amp;#xB2A5; 0&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB2E4;&amp;#xC74C; &amp;#xC815;&amp;#xBCF4;&amp;#xAC00; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx -r4 @$vendor = (XSAVE_VENDORS*)((&lt;span class=&#34;hljs-keyword&#34;&gt;int&lt;/span&gt;)@$policy-&amp;gt;Features[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;].Vendors + &lt;span class=&#34;hljs-number&#34;&gt;0x253d0e90000&lt;/span&gt;)
[+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] NumberOfVendors  : &lt;span class=&#34;hljs-number&#34;&gt;0x3&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] Vendor        [Type: _XSAVE_VENDOR [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]]
    [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]           [Type: _XSAVE_VENDOR]
        [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] VendorId      [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt; [&lt;span class=&#34;hljs-number&#34;&gt;3&lt;/span&gt;]]
            [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]           : &lt;span class=&#34;hljs-number&#34;&gt;0x756e6547&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
            [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]           : &lt;span class=&#34;hljs-number&#34;&gt;0x49656e69&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
            [&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;]           : &lt;span class=&#34;hljs-number&#34;&gt;0x6c65746e&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x010&lt;/span&gt;] SupportedCpu  [Type: _XSAVE_SUPPORTED_CPU]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] CpuInfo       [Type: XSAVE_CPU_INFO]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x020&lt;/span&gt;] CpuErrata     : &lt;span class=&#34;hljs-number&#34;&gt;0x4c0&lt;/span&gt; [Type: XSAVE_CPU_ERRATA *]
[+&lt;span class=&#34;hljs-number&#34;&gt;0x020&lt;/span&gt;] Unused        : &lt;span class=&#34;hljs-number&#34;&gt;0x4c0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C;, &amp;#xAC01; &lt;code&gt;XSAVE_CPU_ERRATA&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xB294; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; XState &amp;#xC9C0;&amp;#xC6D0;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC624;&amp;#xB958; &amp;#xC815;&amp;#xBCF4;&amp;#xC640; &amp;#xC77C;&amp;#xCE58;&amp;#xD558;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC815;&amp;#xBCF4; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4;, &amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC704;&amp;#xC758; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0;&amp;#xC11C; &amp;#xCCAB; &amp;#xBC88;&amp;#xC9F8; &amp;#xC5D0;&amp;#xB77C;&amp;#xD0C0;&amp;#xB294; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx -r3 @$errata = (XSAVE_CPU_ERRATA*)((&lt;span class=&#34;hljs-keyword&#34;&gt;int&lt;/span&gt;)@$vendor-&amp;gt;Vendor[&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;].SupportedCpu.CpuErrata + &lt;span class=&#34;hljs-number&#34;&gt;0x253d0e90000&lt;/span&gt;)
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] NumberOfErrata   : &lt;span class=&#34;hljs-number&#34;&gt;0x1&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
    [+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] Errata           [Type: XSAVE_CPU_INFO [&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;]]
        [&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;]              [Type: XSAVE_CPU_INFO]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x000&lt;/span&gt;] Processor        : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x002&lt;/span&gt;] Family           : &lt;span class=&#34;hljs-number&#34;&gt;0x6&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;short&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x004&lt;/span&gt;] Model            : &lt;span class=&#34;hljs-number&#34;&gt;0xf&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;short&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x006&lt;/span&gt;] Stepping         : &lt;span class=&#34;hljs-number&#34;&gt;0xb&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;short&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x008&lt;/span&gt;] ExtendedModel    : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;short&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x00c&lt;/span&gt;] ExtendedFamily   : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x010&lt;/span&gt;] MicrocodeVersion : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; __int64]
            [+&lt;span class=&#34;hljs-number&#34;&gt;0x018&lt;/span&gt;] Reserved         : &lt;span class=&#34;hljs-number&#34;&gt;0x0&lt;/span&gt; [Type: &lt;span class=&#34;hljs-keyword&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;hljs-keyword&#34;&gt;long&lt;/span&gt;]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xBAA8;&amp;#xB4E0; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC758; &amp;#xD558;&amp;#xB4DC;&amp;#xC6E8;&amp;#xC5B4; &amp;#xC815;&amp;#xCC45; &amp;#xB364;&amp;#xD504; &amp;#xD234;&amp;#xC740; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/tree/master/Xpolicy&#34;&gt;&amp;#xC5EC;&amp;#xAE30;&lt;/a&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC9C0;&amp;#xAE08;&amp;#xC740; &amp;#xC804;&amp;#xCCB4; &amp;#xC815;&amp;#xCC45;(&amp;#xC704;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xAC83;)&amp;#xC5D0; &amp;#xD558;&amp;#xB098;&amp;#xC758; &amp;#xC5D0;&amp;#xB77C;&amp;#xD0C0;&amp;#xB9CC; &amp;#xB098;&amp;#xD0C0;&amp;#xB09C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C; &amp;#xB2E4;&amp;#xC74C; &amp;#xC635;&amp;#xC158; &amp;#xB85C;&amp;#xB354; &amp;#xBA85;&amp;#xB839;&amp;#xC904; &amp;#xC635;&amp;#xC158;(&amp;#xBC0F; &amp;#xAC01; BCD &amp;#xC124;&amp;#xC815;)&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xCD94;&amp;#xAC00;&amp;#xB85C; &amp;#xCEE4;&amp;#xC2A4;&amp;#xD130;&amp;#xB9C8;&amp;#xC774;&amp;#xC9D5;&amp;#xC774; &amp;#xAC00;&amp;#xB2A5;&amp;#xD558;&amp;#xB2E4;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;XSAVEPOLICY = n&lt;/code&gt; &amp;#xB85C;&amp;#xB4DC; &amp;#xC635;&amp;#xC158;&amp;#xC740; &lt;code&gt;xsavepolicy&lt;/code&gt; BCD &amp;#xC635;&amp;#xC158;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xBA70; &lt;code&gt;KeXSavePolicyId&lt;/code&gt;&amp;#xB97C; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xC5EC; &amp;#xB85C;&amp;#xB4DC;&amp;#xD560; XState &amp;#xC815;&amp;#xCC45;&amp;#xC744; &amp;#xB098;&amp;#xD0C0;&amp;#xB0B8;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XSAVEREMOVEFEATURE = n&lt;/code&gt;&amp;#xB85C;&amp;#xB4DC; &amp;#xC635;&amp;#xC158;&amp;#xC740; &lt;code&gt;xsaveremovefeature&lt;/code&gt; BCD&amp;#xC635;&amp;#xC158;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xBA70; &lt;code&gt;KeTestRemovedFeatureMask&lt;/code&gt; &amp;#xB97C; &amp;#xC124;&amp;#xC815;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xB294; &amp;#xB098;&amp;#xC911;&amp;#xC5D0; &lt;code&gt;KiInitializeXSave&lt;/code&gt;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xB418;&amp;#xACE0; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC81C;&amp;#xAC70;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC0C1;&amp;#xD0DC; 0 (x87 FPU) &amp;#xBC0F; &amp;#xC0C1;&amp;#xD0DC; 1 (SSE)&amp;#xC740; &amp;#xC774; &amp;#xBC29;&amp;#xBC95;&amp;#xC73C;&amp;#xB85C; &amp;#xC81C;&amp;#xAC70;&amp;#xD560; &amp;#xC218; &amp;#xC5C6;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XSAVEDISABLE&lt;/code&gt; &amp;#xB85C;&amp;#xB4DC; &amp;#xC635;&amp;#xC158;&amp;#xC740; &lt;code&gt;xsavedisable&lt;/code&gt; BCD &amp;#xC635;&amp;#xC158;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xC5B4; &lt;code&gt;KeTestDisableXsave&lt;/code&gt;&amp;#xB97C; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xACE0; &lt;code&gt;KiInitializeXSave&lt;/code&gt;&amp;#xAC00; &amp;#xBAA8;&amp;#xB4E0; XState &amp;#xAD6C;&amp;#xC131; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; 0&amp;#xC73C;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xC5EC; &amp;#xC804;&amp;#xCCB4; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xBE44;&amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;CET-XSAVE-&amp;#xC601;&amp;#xC5ED;-&amp;#xD3EC;&amp;#xB9F7;&#34;&gt;&lt;a href=&#34;#CET-XSAVE-&amp;#xC601;&amp;#xC5ED;-&amp;#xD3EC;&amp;#xB9F7;&#34; class=&#34;headerlink&#34; title=&#34;CET XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xD3EC;&amp;#xB9F7;&#34;&gt;&lt;/a&gt;CET XSAVE &amp;#xC601;&amp;#xC5ED; &amp;#xD3EC;&amp;#xB9F7;&lt;/h2&gt;&lt;p&gt;CET &amp;#xAD6C;&amp;#xD604;&amp;#xC758; &amp;#xC77C;&amp;#xD658;&amp;#xC73C;&amp;#xB85C; Intel&amp;#xC740; &lt;code&gt;XSTATE_CET_U(11)&lt;/code&gt;&amp;#xC640; &lt;code&gt;XSTATE_CET_S(12)&lt;/code&gt;&amp;#xB77C;&amp;#xACE0; &amp;#xD558;&amp;#xB294; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBC0F; &amp;#xC288;&amp;#xD37C;&amp;#xBC14;&amp;#xC774;&amp;#xC800; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC5D0; &amp;#xAC01;&amp;#xAC01; &amp;#xB300;&amp;#xC751;&amp;#xD558;&amp;#xB3C4;&amp;#xB85D; &amp;#xC815;&amp;#xC758;&amp;#xD588;&amp;#xB2E4;. &amp;#xCCAB; &amp;#xBC88;&amp;#xC9F8; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB294; &lt;code&gt;XSAVE_CET_U_FORMAT&lt;/code&gt;&amp;#xC73C;&amp;#xB85C; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB41C; 16&amp;#xBC14;&amp;#xC774;&amp;#xD2B8; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xB85C;, &lt;code&gt;IA32_U_CET&lt;/code&gt; MSR(&lt;code&gt;Shadow Stack Enable&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xAD6C;&amp;#xC131;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0;) &amp;#xBC0F; &lt;code&gt;IA32_PL3_SSPMSR&lt;/code&gt; (Privile 3 &amp;#xC218;&amp;#xC900;)&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC544;&amp;#xC9C1; MSDN &amp;#xC815;&amp;#xC758;&amp;#xAC00; &amp;#xC5C6;&amp;#xB294; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8; &amp;#xBC29;&amp;#xBC95;&amp;#xC740; &lt;code&gt;IA32_PL0/1/2_SSP&lt;/code&gt; MSR&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;XSAVE_CET_U_FORMAT&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    ULONG64 Ia32CetUMsr;
    ULONG64 Ia32Pl3SspMsr;
} XSAVE_CET_U_FORMAT, *PXSAVE_CET_U_FORMAT;

&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;XSAVE_CET_S_FORMAT&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    ULONG64 Ia32Pl0SspMsr;
    ULONG64 Ia32Pl1SspMsr;
    ULONG64 Ia32Pl2SspMsr;
} XSAVE_CET_S_FORMAT, *PXSAVE_CET_S_FORMAT;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xD544;&amp;#xB4DC; &amp;#xC774;&amp;#xB984;&amp;#xC5D0;&amp;#xC11C; &amp;#xC54C; &amp;#xC218; &amp;#xC788;&amp;#xB4EF;&amp;#xC774; CET &amp;#xAD00;&amp;#xB828; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB294; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xAC01; MSR&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xAC12;&amp;#xC774;&amp;#xBA70;, &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; Ring 0&amp;#xC758; RDMSR &amp;#xBC0F; WRMSR &amp;#xAD8C;&amp;#xD55C;&amp;#xC774; &amp;#xC788;&amp;#xB294; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xD1B5;&amp;#xD574;&amp;#xC11C;&amp;#xB9CC; &amp;#xC561;&amp;#xC138;&amp;#xC2A4; &amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC804;&amp;#xC5ED; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; MSR&amp;#xACFC; &amp;#xB2EC;&amp;#xB9AC; CET&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xB2E8;&amp;#xC704;&amp;#xB85C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; Shadow stack pointer&amp;#xB3C4; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xB2E8;&amp;#xC704;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC774;&amp;#xC720;&amp;#xB85C; CET &amp;#xAD00;&amp;#xB828; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB294; &amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C;&amp;#xAC00; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC; &amp;#xC2A4;&amp;#xC704;&amp;#xCE58;&amp;#xB97C; &amp;#xC62C;&amp;#xBC14;&amp;#xB974;&amp;#xAC8C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB3C4;&amp;#xB85D; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xAD6C;&amp;#xD604;&amp;#xB418;&amp;#xC5B4;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CET &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB294; &amp;#xAE30;&amp;#xBCF8;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xCEE4;&amp;#xB110; &amp;#xCF54;&amp;#xB4DC;&amp;#xB85C;&amp;#xB9CC; &amp;#xC218;&amp;#xC815; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; MSR&amp;#xC774;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &lt;code&gt;CPL3 XSAVE/XRSTOR&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC811;&amp;#xADFC;&amp;#xD560; &amp;#xC218; &amp;#xC5C6;&amp;#xC73C;&amp;#xBA70; &amp;#xAC01;&amp;#xAC01;&amp;#xC758; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB294; &lt;code&gt;IA32_XSS&lt;/code&gt; MSR&amp;#xC5D0;&amp;#xC11C; &amp;#xD56D;&amp;#xC0C1; 1&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB41C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC6B4;&amp;#xC601;&amp;#xCCB4;&amp;#xC81C;&amp;#xAC00; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC;&amp;#xC758; &amp;#xCF54;&amp;#xB4DC;&amp;#xAC00; SSP&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC744; &amp;#xC644;&amp;#xC804;&amp;#xD788; &amp;#xCC28;&amp;#xB2E8;&amp;#xD560; &amp;#xC218;&amp;#xB294; &amp;#xC5C6;&amp;#xB2E4;. &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC;&amp;#xC758; &amp;#xCF54;&amp;#xB4DC;&amp;#xB294; &amp;#xC608;&amp;#xC678; &amp;#xCC98;&amp;#xB9AC;, unwinding, jmp/longjmp &amp;#xB610;&amp;#xB294; Windows&amp;#xC758; &lt;code&gt;Fiber&lt;/code&gt; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xACFC; &amp;#xAC19;&amp;#xC740; &amp;#xD2B9;&amp;#xC815; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD574; SSP&amp;#xB97C; &amp;#xC5C5;&amp;#xB370;&amp;#xC774;&amp;#xD2B8;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB530;&amp;#xB77C;&amp;#xC11C; Windows&amp;#xAC00; CS &amp;#xBC0F; DR7&amp;#xACFC; &amp;#xAC19;&amp;#xC740; &amp;#xD2B9;&amp;#xC815; &amp;#xBCF4;&amp;#xD638;&amp;#xB41C; CPU &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB97C; &amp;#xC5C5;&amp;#xB370;&amp;#xC774;&amp;#xD2B8;&amp;#xD558;&amp;#xB294; &amp;#xBA54;&amp;#xCEE4;&amp;#xB2C8;&amp;#xC998;&amp;#xC73C;&amp;#xB85C; &lt;a href=&#34;https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadcontext&#34;&gt;SetThreadContext&lt;/a&gt;&amp;#xB97C; &amp;#xC81C;&amp;#xACF5;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xCC98;&amp;#xB7FC; &amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C;&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xAC00; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C; &amp;#xD638;&amp;#xCD9C;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; XSate&amp;#xC5D0;&amp;#xC11C; CET &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC744; &amp;#xC81C;&amp;#xACF5;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xB2E4;&amp;#xC74C; &amp;#xC139;&amp;#xC158;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; XState &amp;#xAD00;&amp;#xB828; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xD604;&amp;#xB300;&amp;#xC758; Windows &amp;#xBC84;&amp;#xC804;&amp;#xC5D0;&amp;#xC11C; &lt;a href=&#34;https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-wow64_context&#34;&gt;CONTEXT&lt;/a&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xAC00; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xB85C; &amp;#xC5B4;&amp;#xB5BB;&amp;#xAC8C; &amp;#xBC1C;&amp;#xC804;&amp;#xD588;&amp;#xB294;&amp;#xC9C0;, &amp;#xADF8;&amp;#xB9AC;&amp;#xACE0; &amp;#xC608;&amp;#xC678; &amp;#xAD00;&amp;#xB828; &amp;#xC2DC;&amp;#xB098;&amp;#xB9AC;&amp;#xC624;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; CET &amp;#xAD00;&amp;#xB828; &amp;#xCC98;&amp;#xB9AC;&amp;#xB97C; &amp;#xCD94;&amp;#xAC00;&amp;#xD558;&amp;#xB294; &amp;#xB3D9;&amp;#xC2DC;&amp;#xC5D0; &amp;#xC190;&amp;#xC0C1;&amp;#xB41C; CONTEXT&amp;#xB97C; &amp;#xD1B5;&amp;#xD55C; &amp;#xC545;&amp;#xC758;&amp;#xC801;&amp;#xC778; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xACF5;&amp;#xACA9;&amp;#xC744; &amp;#xBC29;&amp;#xC9C0;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC5D0; &amp;#xB300;&amp;#xD574;&amp;#xC11C; &amp;#xC54C;&amp;#xC544;&amp;#xBCF8;&amp;#xB2E4;.&lt;/p&gt;
&lt;h1 id=&#34;CONTEXT-EX-&amp;#xB0B4;&amp;#xBD80;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX-&amp;#xB0B4;&amp;#xBD80;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX &amp;#xB0B4;&amp;#xBD80;&#34;&gt;&lt;/a&gt;CONTEXT_EX &amp;#xB0B4;&amp;#xBD80;&lt;/h1&gt;&lt;p&gt;&amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC2A4;&amp;#xC704;&amp;#xCE58;&amp;#xB97C; &amp;#xD560; &amp;#xB54C; &amp;#xC800;&amp;#xC7A5;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xC758; &amp;#xC218;&amp;#xAC00; &amp;#xC810;&amp;#xC810; &amp;#xB298;&amp;#xC5B4;&amp;#xB098;&amp;#xACE0;, &amp;#xC774;&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xBC84;&amp;#xC804;&amp;#xC758; Windows&amp;#xB294; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT &amp;#xAD6C;&amp;#xC870; &amp;#xC678;&amp;#xC5D0;&amp;#xB3C4; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xB3C4;&amp;#xC785;&amp;#xD588;&amp;#xB2E4;. CONTEXT_EX&amp;#xB294; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT&amp;#xAC00; &amp;#xACE0;&amp;#xC815; &amp;#xD06C;&amp;#xAE30;&amp;#xC778; &amp;#xBC18;&amp;#xBA74; XSAVE&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;, &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xBC0F; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C; &amp;#xAD6C;&amp;#xC131; &amp;#xC815;&amp;#xCC45;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xB3D9;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xC870;&amp;#xC815;&amp;#xB418;&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xAD6C;&amp;#xC870;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xB3C4;&amp;#xC785;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;CONTEXT-EX-&amp;#xAD6C;&amp;#xC870;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX-&amp;#xAD6C;&amp;#xC870;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&#34;&gt;&lt;/a&gt;CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&lt;/h2&gt;&lt;p&gt;CONTEXT_EX&amp;#xB294; &amp;#xD604;&amp;#xC7AC; &amp;#xCEE4;&amp;#xB110; &amp;#xBC0F; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678; &amp;#xCC98;&amp;#xB9AC; &amp;#xAE30;&amp;#xB2A5; &amp;#xC804;&amp;#xCCB4;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0;&amp;#xB9CC; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC740; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC558;&amp;#xB2E4;. Windows 7 &amp;#xD5E4;&amp;#xB354; &amp;#xD30C;&amp;#xC77C; &amp;#xBC0F; &amp;#xC77C;&amp;#xBD80; intel&amp;#xC758; reference code&amp;#xC5D0; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xB294; &amp;#xC77C;&amp;#xBD80; &amp;#xC815;&amp;#xBCF4;&amp;#xAC00; &amp;#xC2E4;&amp;#xC218;&amp;#xB85C; &amp;#xACF5;&amp;#xAC1C;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xB3C4;&amp;#xB85D; &amp;#xD588;&amp;#xC74C;&amp;#xC744; &amp;#xC54C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xB2E4;&amp;#xC74C; &amp;#xCF54;&amp;#xB4DC;&amp;#xC758; &amp;#xC8FC;&amp;#xC11D;&amp;#xC744; &amp;#xBCF4;&amp;#xACE0; &amp;#xC774;&amp;#xD574;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xAC83;&amp;#xC774; &amp;#xC788;&amp;#xC73C;&amp;#xBA74; &amp;#xC54C;&amp;#xB824;&amp;#xC8FC;&amp;#xC5C8;&amp;#xC73C;&amp;#xBA74; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xC774; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xB294; CONTEXT_EX&amp;#xC758; &amp;#xB2E8;&amp;#xC77C; &amp;#xCCAD;&amp;#xD06C; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xC624;&amp;#xD504;&amp;#xC14B;(CONTEXT_EX &amp;#xAD6C;&amp;#xC870; &amp;#xC2DC;&amp;#xC791;&amp;#xBD80;&amp;#xD130;)&amp;#xC744; &amp;#xC9C0;&amp;#xC815;&amp;#xD55C;&amp;#xB2E4;.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// N.B. &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC740; &amp;#xC74C;&amp;#xC218;&amp;#xC77C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;CONTEXT_CHUNK&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    LONG Offset;
    DWORD Length;
} CONTEXT_CHUNK, *PCONTEXT_CHUNK;

&lt;span class=&#34;hljs-comment&#34;&gt;// CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xB294; &amp;#xB294; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xC758; &amp;#xD655;&amp;#xC7A5;&amp;#xC774;&amp;#xB2E4;. &lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xB808;&amp;#xCF54;&amp;#xB4DC;&amp;#xB97C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &amp;#xBD84;&amp;#xB9AC;&amp;#xB41C; &amp;#xAC00;&amp;#xBCC0;&amp;#xD06C;&amp;#xAE30; &amp;#xBC84;&amp;#xD37C;(&amp;#xCCAD;&amp;#xD06C;) &amp;#xC138;&amp;#xD2B8;&amp;#xB85C; &lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xC815;&amp;#xC758;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD604;&amp;#xC7AC; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xBC84;&amp;#xD37C;(&amp;#xCCAD;&amp;#xD06C;)&amp;#xB9CC; &amp;#xC815;&amp;#xC758;&amp;#xB41C;&amp;#xB2E4;:&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// - &amp;#xAE30;&amp;#xC874; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// - XSAVE &amp;#xC800;&amp;#xC7A5; &amp;#xC601;&amp;#xC5ED; &amp;#xBC84;&amp;#xD37C;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; XState&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// XSAVE_AREA_HEADER, i.e. without the first 512 bytes.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// PCONTEXT &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; PCONTEXT_EX &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB85C; &amp;#xBCC0;&amp;#xD658;&amp;#xD558;&amp;#xB294; &amp;#xBA87; &amp;#xAC00;&amp;#xC9C0; &amp;#xAC00;&amp;#xC815;&amp;#xC774; &amp;#xC788;&amp;#xB2E4;.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// 1. PCONTEXT &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xC791;&amp;#xB3D9;&amp;#xD558;&amp;#xB294; API&amp;#xB294; CONTEXT_EX&amp;#xAC00; CONTEXT &amp;#xAD6C;&amp;#xC870; &amp;#xBC14;&amp;#xB85C; &amp;#xB4A4;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C;&amp;#xB2E4;&amp;#xACE0; &amp;#xAC00;&amp;#xC815;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//    &amp;#xB610;&amp;#xD55C; CONTEXT_EX&amp;#xB294; &amp;#xD574;&amp;#xB2F9; CONTEXT_XXX &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; CONTEXT.ContextFlags&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB9CC; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;&amp;#xACE0; &amp;#xAC00;&amp;#xC815;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// 2. CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xAC00; &amp;#xC788;&amp;#xC73C;&amp;#xBA74; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC;&amp;#xAC00; &amp;#xD56D;&amp;#xC0C1; &amp;#xC874;&amp;#xC7AC;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// 3. CONTEXT.ContextFlags&amp;#xB294; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xB294; &amp;#xCCAD;&amp;#xD06C;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//    &amp;#xC989; CONTEXT_XSTATE&amp;#xAC00; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; CONTEXT_EX.XState&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xD558;&amp;#xB2E4;.&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;CONTEXT_EX&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC774; &amp;#xAC00;&amp;#xC7A5; &amp;#xC791;&amp;#xC740; &amp;#xCCAD;&amp;#xD06C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC2DC;&amp;#xC791;&amp;#xD558;&amp;#xB294; &amp;#xAD6C;&amp;#xC870;&amp;#xCCB4;&amp;#xC758; &amp;#xCD1D; &amp;#xD06C;&amp;#xAE30;&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// N.B. &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC740; &amp;#xC74C;&amp;#xC218;&amp;#xC77C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
    CONTEXT_CHUNK All;

    &lt;span class=&#34;hljs-comment&#34;&gt;// &lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xAE30;&amp;#xC874;&amp;#xC758; CONTEXT &amp;#xAD6C;&amp;#xC870; wrapper&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// N.B. &amp;#xCCAD;&amp;#xD06C;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB294; sizeof(CONTEXT) &amp;#xBCF4;&amp;#xB2E4; &amp;#xC791;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// (CONTEXT_EXTENDED_REGISTERS&amp;#xAC00; x86&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xACBD;&amp;#xC6B0;).    &lt;/span&gt;
		&lt;span class=&#34;hljs-comment&#34;&gt;// CONTEXT_CHUNK Legacy;&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;

	  &lt;span class=&#34;hljs-comment&#34;&gt;// CONTEXT_XSTATE : &amp;#xD655;&amp;#xC7A5;&amp;#xB41C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xCCAD;&amp;#xD06C;. &amp;#xC0C1;&amp;#xD0DC; &amp;#xC800;&amp;#xC7A5;&amp;#xC740; &amp;#xB3D9;&amp;#xC77C;&amp;#xD55C; &amp;#xD615;&amp;#xC2DD; &lt;/span&gt;
	  &lt;span class=&#34;hljs-comment&#34;&gt;// XSAVE &amp;#xC791;&amp;#xC5C5;&amp;#xC740; &amp;#xCC98;&amp;#xC74C; 512 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xB97C; &amp;#xC81C;&amp;#xC678;&amp;#xD558;&amp;#xACE0; XSAVE_AREA_HEADER&amp;#xC5D0;&amp;#xC11C; &amp;#xC2DC;&amp;#xC791;&amp;#xD55C;&amp;#xB2E4;. &lt;/span&gt;
		&lt;span class=&#34;hljs-comment&#34;&gt;// FP &amp;#xBC0F; SSE &amp;#xC0C1;&amp;#xD0DC;&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;&amp;#xD558;&amp;#xB294; &amp;#xD558;&amp;#xC704; 2 &amp;#xBE44;&amp;#xD2B8;&amp;#xB294; 0&amp;#xC774;&amp;#xC5B4;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/span&gt;
    &lt;span class=&#34;hljs-comment&#34;&gt;// CONTEXT_CHUNK XState;&lt;/span&gt;
} CONTEXT_EX, *PCONTEXT_EX;

&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-meta-keyword&#34;&gt;define&lt;/span&gt; CONTEXT_EX_LENGTH ALIGN_UP_BY(sizeof(CONTEXT_EX), STACK_ALIGN)&lt;/span&gt;

&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;// &amp;#xC774; &amp;#xB9E4;&amp;#xD06C;&amp;#xB85C;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD574; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xCCAD;&amp;#xD06C;&amp;#xB97C; &amp;#xB354; &amp;#xC27D;&amp;#xAC8C; &amp;#xC870;&amp;#xC791; &amp;#xAC00;&amp;#xB2A5;&lt;/span&gt;
&lt;span class=&#34;hljs-comment&#34;&gt;//&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xC774; &amp;#xD5E4;&amp;#xB354;&amp;#xB85C; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xC744; &amp;#xC774;&amp;#xD574;&amp;#xD558;&amp;#xACE0; &amp;#xC2DC;&amp;#xAC01;&amp;#xD654;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC744; &amp;#xB54C;&amp;#xAE4C;&amp;#xC9C0; &amp;#xC5EC;&amp;#xB7EC; &amp;#xCC28;&amp;#xB840; &amp;#xC2DC;&amp;#xB3C4;&amp;#xB97C; &amp;#xD588;&amp;#xACE0; &amp;#xB2E4;&amp;#xC74C; &amp;#xB2E4;&amp;#xC774;&amp;#xC5B4;&amp;#xADF8;&amp;#xB7A8;&amp;#xC774; &amp;#xB3C4;&amp;#xC6C0;&amp;#xC774; &amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;&amp;#xACE0; &amp;#xB290;&amp;#xAF08;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/4.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xB2E4;&amp;#xC774;&amp;#xC5B4;&amp;#xADF8;&amp;#xB7A8;&amp;#xC5D0;&amp;#xC11C; CONTEXT&lt;em&gt;EX &amp;#xAD6C;&amp;#xC870;&amp;#xB294; &amp;#xD56D;&amp;#xC0C1; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xB05D;&amp;#xC5D0; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xBC0F; XState&amp;#xB77C;&amp;#xB294; &lt;code&gt;CONTEXT_CHUNK&lt;/code&gt; &amp;#xC720;&amp;#xD615;&amp;#xC758; 3&amp;#xAC1C; &amp;#xD544;&amp;#xB4DC;&amp;#xAC00; &amp;#xC788;&amp;#xB2E4;. &amp;#xC774;&amp;#xB4E4;&amp;#xC740; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xACFC; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD558;&amp;#xACE0; &amp;#xC801;&amp;#xC808;&amp;#xD55C; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; `RTL&lt;/em&gt;` &amp;#xB9E4;&amp;#xD06C;&amp;#xB85C;&amp;#xAC00; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;Legacy &amp;#xD544;&amp;#xB4DC;&amp;#xB294; &amp;#xAE30;&amp;#xC874; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xC2DC;&amp;#xC791;&amp;#xC744; &amp;#xCC38;&amp;#xC870;&amp;#xD55C;&amp;#xB2E4;. (&lt;code&gt;CONTEXT_EXTENDED_REGISTERS&lt;/code&gt;&amp;#xAC00; &amp;#xC81C;&amp;#xACF5;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA74; x86&amp;#xC5D0;&amp;#xC11C; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xB354; &amp;#xC791;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xC74C;) &lt;code&gt;All&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xB294; &amp;#xAE30;&amp;#xC874; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xC2DC;&amp;#xC791;&amp;#xC744; &amp;#xCC38;&amp;#xC870;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; Length&amp;#xB294; CONTEXT_EX&amp;#xC640; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xD328;&amp;#xB529;/&amp;#xC815;&amp;#xB82C; &amp;#xACF5;&amp;#xAC04;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC5EC; &amp;#xBAA8;&amp;#xB4E0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xB098;&amp;#xD0C0;&amp;#xB0B8;&amp;#xB2E4;. &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C; &lt;code&gt;XState&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xB294; &lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt; &amp;#xAD6C;&amp;#xC870; (&amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC788;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xC815;&amp;#xC758;&amp;#xD568;)&amp;#xC640; &amp;#xC804;&amp;#xCCB4; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xCC38;&amp;#xC870;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xC73C;&amp;#xB85C; &amp;#xC778;&amp;#xD574; All &amp;#xBC0F; Legacy&amp;#xC5D0;&amp;#xB294; &amp;#xC74C;&amp;#xC218; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC774; &amp;#xC801;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;&amp;#xB294; &amp;#xC810;&amp;#xC5D0; &amp;#xC720;&amp;#xC758;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xB9E4;&amp;#xC6B0; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &lt;code&gt;Ntdll.dll&lt;/code&gt;&amp;#xC740; CONTEXT_EX&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; &amp;#xBE4C;&amp;#xB4DC;, &amp;#xC77D;&amp;#xAE30;, &amp;#xBCF5;&amp;#xC0AC; &amp;#xBC0F; &amp;#xC870;&amp;#xC791;&amp;#xC744; &amp;#xB2E8;&amp;#xC21C;&amp;#xD654;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; API&amp;#xB97C; export &amp;#xD55C;&amp;#xB2E4;. (&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; API &amp;#xC911; &amp;#xC77C;&amp;#xBD80;&amp;#xB294; &lt;code&gt;Ntoskrn.exe&lt;/code&gt; &amp;#xC5D0;&amp;#xC11C; &amp;#xB0B4;&amp;#xBD80;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0;&amp;#xB9CC; export &amp;#xB418;&amp;#xC9C0;&amp;#xB294; &amp;#xC54A;&amp;#xB294;&amp;#xB2E4;.) &amp;#xB610;&amp;#xD55C; &lt;code&gt;KernelBase.dll&lt;/code&gt;&amp;#xC740; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xB0B4;&amp;#xBD80;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB41C; Win32 &amp;#xD568;&amp;#xC218;&amp;#xB97C; export &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;CONTEXT-EX-&amp;#xCD08;&amp;#xAE30;&amp;#xD654;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX-&amp;#xCD08;&amp;#xAE30;&amp;#xD654;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX &amp;#xCD08;&amp;#xAE30;&amp;#xD654;&#34;&gt;&lt;/a&gt;CONTEXT_EX &amp;#xCD08;&amp;#xAE30;&amp;#xD654;&lt;/h2&gt;&lt;p&gt;&amp;#xBA3C;&amp;#xC800; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; CONTEXT_EX&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xD560;&amp;#xB2F9;&amp;#xD560; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xD30C;&amp;#xC545;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294;&amp;#xB370;, &amp;#xC774;&amp;#xB294; &amp;#xB2E4;&amp;#xC74C; API&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xC218;&amp;#xD589;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
ULONG
NTAPI
RtlGetExtendedContextLength (
    _In_ ULONG ContextFlags,
    _Out_ PULONG ContextLength
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xC800;&amp;#xC7A5;&amp;#xD560; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB97C; &amp;#xC9C0;&amp;#xC815;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC801;&amp;#xC808;&amp;#xD55C; &lt;code&gt;CONTEXT_XXX&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xB97C; &amp;#xC81C;&amp;#xACF5;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7F0; &amp;#xB2E4;&amp;#xC74C;&amp;#xC774; API&amp;#xB294; &lt;code&gt;SharedUserData.XState.EnabledFeatures&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;SharedUserData.XState.EnabledUserVisibleSupervisorFeatures&lt;/code&gt; &amp;#xB97C; &amp;#xC77D;&amp;#xACE0; &amp;#xBAA8;&amp;#xB4E0; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD1B5;&amp;#xD569;&amp;#xD574; &amp;#xC544;&amp;#xB798;&amp;#xC758; &amp;#xD655;&amp;#xC7A5; &amp;#xD568;&amp;#xC218;&amp;#xB85C; &amp;#xC804;&amp;#xB2EC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
ULONG
NTAPI
RtlGetExtendedContextLength2 (
    _In_ ULONG ContextFlags,
    _Out_ PULONG ContextLength,
    _In_ ULONG64 XStateCompactionMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774; &amp;#xCD5C;&amp;#xC2E0; API&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBA74; &amp;#xACF5;&amp;#xC720; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; XState &amp;#xAD6C;&amp;#xC131;&amp;#xC5D0;&amp;#xC11C; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xAC00;&amp;#xC838;&amp;#xC624;&amp;#xB294; &amp;#xB300;&amp;#xC2E0; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xD560; XState &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC218;&amp;#xB3D9;&amp;#xC73C;&amp;#xB85C; &amp;#xC9C0;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC774;&amp;#xB85C; &amp;#xC778;&amp;#xD574; CONTNENT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xC791;&amp;#xC544;&amp;#xC838; &amp;#xBAA8;&amp;#xB4E0; XState &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD560; &amp;#xACF5;&amp;#xAC04;&amp;#xC774; &amp;#xCDA9;&amp;#xBD84;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xAC8C; &amp;#xB418;&amp;#xBBC0;&amp;#xB85C; &amp;#xC774; CONTNT_EX&amp;#xB97C; &amp;#xB098;&amp;#xC911;&amp;#xC5D0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBA74; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C; &amp;#xC678;&amp;#xBD80;&amp;#xC5D0;&amp;#xC11C; XState Bits&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC544;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB2E4;&amp;#xC74C;&amp;#xC73C;&amp;#xB85C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; CONTEXT_EX&amp;#xC5D0; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xB97C; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0; (&amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; Windows&amp;#xB294; &amp;#xC608;&amp;#xC678; &amp;#xACBD;&amp;#xB85C;&amp;#xC5D0;&amp;#xC11C; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC; &amp;#xD560;&amp;#xB2F9; &amp;#xC2E4;&amp;#xD328;&amp;#xB97C; &amp;#xBC29;&amp;#xC9C0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;alloca&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;.) &amp;#xB2E4;&amp;#xC74C; &amp;#xB450; API &amp;#xC911; &amp;#xD558;&amp;#xB098;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
ULONG
NTAPI
RtlInitializeExtendedContext (
    _Out_ PVOID Context,
    _In_ ULONG ContextFlags,
    _Out_ PCONTEXT_EX* ContextEx
);

NTSYSAPI
ULONG
NTAPI
RtlInitializeExtendedContext2 (
    _Out_ PVOID Context,
    _In_ ULONG ContextFlags,
    _Out_ PCONTEXT_EX* ContextEx,
    _In_ ULONG64 XStateCompactionMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774;&amp;#xC804;&amp;#xACFC; &amp;#xB9C8;&amp;#xCC2C;&amp;#xAC00;&amp;#xC9C0;&amp;#xB85C; &amp;#xCD5C;&amp;#xC2E0; API&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xD560; XState &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC218;&amp;#xB3D9;&amp;#xC73C;&amp;#xB85C; &amp;#xC9C0;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC9C0;&amp;#xC815;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA74; &amp;#xC0AC;&amp;#xC6A9; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xBAA8;&amp;#xB4E0; &amp;#xAE30;&amp;#xB2A5; (&lt;code&gt;SharedUserData&lt;/code&gt; &amp;#xAE30;&amp;#xBC18;)&amp;#xC774; &amp;#xC788;&amp;#xB294; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xAC04;&amp;#xC8FC;&amp;#xB41C;&amp;#xB2E4;.  &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &lt;code&gt;RtlGetExtendedContextLength(2)&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD638;&amp;#xCD9C;&amp;#xACFC; &amp;#xB3D9;&amp;#xC77C;&amp;#xD55C; &lt;code&gt;ContextFlags&lt;/code&gt;&amp;#xB97C; &amp;#xC9C0;&amp;#xC815;&amp;#xD574; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xAD6C;&amp;#xC870;&amp;#xAC00; &amp;#xC62C;&amp;#xBC14;&amp;#xB978; &amp;#xD06C;&amp;#xAE30;&amp;#xB85C; &amp;#xD560;&amp;#xB2F9;&amp;#xB418;&amp;#xC5C8;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xD6C4; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xC785;&amp;#xB825; CONTEXT &amp;#xBC84;&amp;#xD37C;&amp;#xB97C; &amp;#xB530;&amp;#xB77C;&amp;#xAC08; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xC608;&amp;#xC0C1;&amp;#xB418;&amp;#xB294; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xBC1B;&amp;#xB294;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CONTEXT_EX&amp;#xAC00; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xBA74; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xBA3C;&amp;#xC800; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC62C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. (&amp;#xD06C;&amp;#xAE30;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xAC00;&amp;#xC815; &amp;#xC5C6;&amp;#xC774;). &amp;#xB2E4;&amp;#xC74C; API&amp;#xB85C; &amp;#xC218;&amp;#xD589;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
PCONTEXT
NTAPI
RtlLocateLegacyContext (
    _In_ PCONTEXT_EX ContextEx,
    _Out_opt_ PULONG Length,
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &amp;#xC5B8;&amp;#xAE09;&amp;#xD588;&amp;#xB4EF;&amp;#xC774; &amp;#xC774;&amp;#xB4E4;&amp;#xC740; Windows&amp;#xC758; NT &amp;#xACC4;&amp;#xCE35;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xB178;&amp;#xCD9C;&amp;#xB418;&amp;#xB294; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xB0B4;&amp;#xBD80; API&amp;#xB2E4;. &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC778; Win32 &amp;#xC751;&amp;#xC6A9; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C; &amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; XState &amp;#xD638;&amp;#xD658; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC744; &amp;#xB2E8;&amp;#xC21C;&amp;#xD654;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;WINBASEAPI
BOOL
WINAPI
InitializeContext (
    _Out_writes_bytes_opt_(*ContextLength) PVOID Context,
    _In_ DWORD ContextFlags,
    _Out_ PCONTEXT_EX Context,
    _Inout_ PDWORD ContextFlags
);

WINBASEAPI
BOOL
WINAPI
InitializeContext2 (
    _Out_writes_bytes_opt_(*ContextLength) PVOID Context,
    _In_ DWORD ContextFlags,
    _Out_ PCONTEXT_EX Context,
    _Inout_ PDWORD ContextFlags,
    _In_ ULONG64 XStateCompactionMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC774; &amp;#xB450; API&amp;#xB294; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; API&amp;#xC640; &amp;#xBE44;&amp;#xC2B7;&amp;#xD558;&amp;#xAC8C; &amp;#xC791;&amp;#xB3D9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; Buffer &amp;#xBC0F; Context &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xB85C; &amp;#xCC98;&amp;#xC74C; NULL&amp;#xC744; &amp;#xC804;&amp;#xB2EC;&amp;#xD558;&amp;#xBA74; &amp;#xD568;&amp;#xC218;&amp;#xB294; &lt;code&gt;ContextLength&lt;/code&gt;&amp;#xC5D0; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xAE38;&amp;#xC774;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xBA70; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xBA54;&amp;#xBAA8;&amp;#xB9AC;&amp;#xC5D0; &amp;#xD560;&amp;#xB2F9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB450; &amp;#xBC88;&amp;#xC9F8; &amp;#xC2DC;&amp;#xB3C4;&amp;#xC5D0;&amp;#xC11C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xD560;&amp;#xB2F9;&amp;#xB41C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; Buffer&amp;#xC5D0; &amp;#xC804;&amp;#xB2EC;&amp;#xD558;&amp;#xACE0; &amp;#xAE30;&amp;#xBCF8; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC815;&amp;#xBCF4; &amp;#xC5C6;&amp;#xC774; Context&amp;#xC758; CONTEXT &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xBC1B;&amp;#xB294;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;CONTEXT-EX&amp;#xC5D0;&amp;#xC11C;-XState-&amp;#xAE30;&amp;#xB2A5;-&amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;-&amp;#xC81C;&amp;#xC5B4;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX&amp;#xC5D0;&amp;#xC11C;-XState-&amp;#xAE30;&amp;#xB2A5;-&amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;-&amp;#xC81C;&amp;#xC5B4;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C; &amp;#xC81C;&amp;#xC5B4;&#34;&gt;&lt;/a&gt;CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C; &amp;#xC81C;&amp;#xC5B4;&lt;/h2&gt;&lt;p&gt;CONTEXT_EX&amp;#xC758; &lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt;&amp;#xC758; Mask &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C; &lt;code&gt;XSTATE_BV&lt;/code&gt; (&amp;#xD655;&amp;#xC7A5; &amp;#xAE30;&amp;#xB2A5; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;)&amp;#xC5D0; &amp;#xC561;&amp;#xC138;&amp;#xC2A4; &amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC740;  XState &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; API&amp;#xC640; &amp;#xD568;&amp;#xAED8; CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; &amp;#xC5B4;&amp;#xB5A4; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xC27D;&amp;#xAC8C; &amp;#xD655;&amp;#xC778;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB3C4;&amp;#xB85D; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; API&amp;#xB97C; export &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xADF8;&amp;#xB7EC;&amp;#xB098; Windows&amp;#xB294; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; x87 FPU (0) &amp;#xBC0F; SSE (1) &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xACE0; &amp;#xB300;&amp;#xC2E0; &lt;code&gt;FXSAVE&lt;/code&gt; &amp;#xBA85;&amp;#xB839;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC989;, XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xC601;&amp;#xC5ED;&amp;#xC774; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xACE0; &amp;#xC989;&amp;#xC2DC; &lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt;&amp;#xB85C; &amp;#xC2DC;&amp;#xC791;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774;&amp;#xB85C; &amp;#xC778;&amp;#xD574; Get API&amp;#xB294; &amp;#xD56D;&amp;#xC0C1; &amp;#xD558;&amp;#xC704; 2 &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD0B9;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; Set API&amp;#xB294; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; XState &amp;#xAD6C;&amp;#xC131;&amp;#xC758; &lt;code&gt;EnabledFeatures&lt;/code&gt;&amp;#xC5D0; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;InitializeContext2&lt;/code&gt;(&amp;#xB610;&amp;#xB294; &amp;#xB0B4;&amp;#xBD80; &amp;#xB124;&amp;#xC774;&amp;#xD2F0;&amp;#xBE0C; APIs)&amp;#xC5D0;&amp;#xC11C; &amp;#xD558;&amp;#xB4DC; &amp;#xCF54;&amp;#xB529;&amp;#xB41C; &amp;#xC555;&amp;#xCD95; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xAC00; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; Set API&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xAE30;&amp;#xC874; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xC0DD;&amp;#xB7B5;&amp;#xD574;&amp;#xC11C;&amp;#xB294; &amp;#xC548;&amp;#xB41C;&amp;#xB2E4;. (&amp;#xC0C8; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xCD94;&amp;#xAC00;&amp;#xD558;&amp;#xBA74; CONTEXT_EX&amp;#xC5D0; &amp;#xCD08;&amp;#xAE30;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xCD94;&amp;#xAC00; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xBBC0;&amp;#xB85C; &amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xC5C6;&amp;#xC774; &amp;#xC774;&amp;#xBBF8; &amp;#xC0AC;&amp;#xC804; &amp;#xD560;&amp;#xB2F9;&amp;#xB418;&amp;#xC5C8;&amp;#xC744; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;.)&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
ULONG64
NTAPI
RtlGetExtendedFeaturesMask (
    _In_ PCONTEXT_EX ContextEx
);

NTSYSAPI
ULONG64
NTAPI
RtlSetExtendedFeaturesMask (
    _In_ PCONTEXT_EX ContextEx,
    _In_ ULONG64 FeatureMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC704; API&amp;#xC758; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;WINBASEAPI
BOOL
WINAPI
GetXStateFeaturesMask (
    _In_ PCONTEXT Context
    _Out_ PDWORD64 FeatureMask
);

NTSYSAPI
ULONG64
NTAPI
SetXStateFeaturesMask (
    _In_ PCONTEXT Context,
    _In_ DWORD64 FeatureMask
);&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;CONTEXT-EX&amp;#xC5D0;&amp;#xC11C;-XState-&amp;#xAE30;&amp;#xB2A5;-&amp;#xCC3E;&amp;#xAE30;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX&amp;#xC5D0;&amp;#xC11C;-XState-&amp;#xAE30;&amp;#xB2A5;-&amp;#xCC3E;&amp;#xAE30;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xCC3E;&amp;#xAE30;&#34;&gt;&lt;/a&gt;CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xCC3E;&amp;#xAE30;&lt;/h2&gt;&lt;p&gt;CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC758; &amp;#xBCF5;&amp;#xC7A1;&amp;#xC131;&amp;#xACFC; XState &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xAC70;&amp;#xB098; &amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xD615;&amp;#xD0DC;&amp;#xB85C; &amp;#xC874;&amp;#xC7AC;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xACE0; &amp;#xC874;&amp;#xC7AC; &amp;#xC5EC;&amp;#xBD80;&amp;#xB3C4; &amp;#xC55E;&amp;#xC11C; &amp;#xC124;&amp;#xBA85;&amp;#xD55C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xC5D0; &amp;#xC758;&amp;#xC874;&amp;#xD55C;&amp;#xB2E4;&amp;#xB294; &amp;#xC0AC;&amp;#xC2E4; (&amp;#xD2B9;&amp;#xD788; &amp;#xCD5C;&amp;#xC801;&amp;#xD654;&amp;#xB41C; XSAVE&amp;#xAC00; &amp;#xC9C0;&amp;#xC6D0;&amp;#xB418;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;)&amp;#xB85C; &amp;#xC778;&amp;#xD574;, &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; CONTEXT_EX &amp;#xB0B4;&amp;#xC758; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0;&amp;#xC11C; &amp;#xAD00;&amp;#xB828; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xC27D;&amp;#xACE0; &amp;#xBE60;&amp;#xB974;&amp;#xAC8C; &amp;#xC5BB;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xB77C;&amp;#xC774;&amp;#xBE0C;&amp;#xB7EC;&amp;#xB9AC; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xD604;&amp;#xC7AC; &amp;#xB2E4;&amp;#xC74C;&amp;#xACFC; &amp;#xAC19;&amp;#xC740; &amp;#xB450; &amp;#xAC00;&amp;#xC9C0; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xC874;&amp;#xC7AC;&amp;#xD55C;&amp;#xB2E4;. &lt;code&gt;RtlLocateExtendedFeature&lt;/code&gt;&amp;#xB294; &lt;code&gt;RtlLocateExtendedFeature2&lt;/code&gt;&amp;#xC758; wrapper&amp;#xC774;&amp;#xBA70; &amp;#xAD6C;&amp;#xC131; &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xB85C; &lt;code&gt;SharedUserData.XState&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xC81C;&amp;#xACF5;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB450; &amp;#xD568;&amp;#xC218; &amp;#xBAA8;&amp;#xB450; export &amp;#xD560; &amp;#xB54C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; &amp;#xC120;&amp;#xD0DD;&amp;#xD55C; &amp;#xACBD;&amp;#xC6B0; &amp;#xD6C4;&amp;#xC790;&amp;#xC758; API&amp;#xC5D0;&amp;#xC11C; &amp;#xC790;&amp;#xCCB4; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xC9C0;&amp;#xC815; XState &amp;#xAD6C;&amp;#xC131;&amp;#xC744; &amp;#xC218;&amp;#xB3D9;&amp;#xC73C;&amp;#xB85C; &amp;#xC9C0;&amp;#xC815;&amp;#xD560; &amp;#xC218;&amp;#xB3C4; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;NTSYSAPI
PVOID
NTAPI
RtlLocateExtendedFeature (
    _In_ CONTEXT_EX ContextEx,
    _In_ ULONG FeatureId,
    _Out_opt_ PULONG Length
);

NTSYSAPI
PVOID
NTAPI
RtlLocateExtendedFeature2 (
    _In_ CONTEXT_EX ContextEx,
    _In_ ULONG FeatureId,
    _In_ PXSTATE_CONFIGURATION Configuration,
    _Out_opt_ PULONG Length
);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xB450; &amp;#xD568;&amp;#xC218; &amp;#xBAA8;&amp;#xB450; CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC640; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; ID&amp;#xB97C; &amp;#xC218;&amp;#xC2E0;&amp;#xD558;&amp;#xACE0; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; &amp;#xC704;&amp;#xCE58;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; XState &amp;#xAD6C;&amp;#xC131; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC2E4;&amp;#xC81C; &amp;#xAC12;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xAC70;&amp;#xB098; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA70; &amp;#xC774;&amp;#xB294; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xC5D0;&amp;#xAC8C; &amp;#xB2EC;&amp;#xB824; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xCC3E;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;RtlLocateExtendedFeature2&lt;/code&gt;&amp;#xB294; &amp;#xB2E4;&amp;#xC74C;&amp;#xC744; &amp;#xC218;&amp;#xD589;&amp;#xD55C;&amp;#xB2E4;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;#xAE30;&amp;#xB2A5; ID&amp;#xAC00; 2 &amp;#xC774;&amp;#xC0C1; (x87 FPU &amp;#xBC0F; SSE &amp;#xC0C1;&amp;#xD0DC;&amp;#xB294; Windows&amp;#xC758; XSAVE&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xC800;&amp;#xC7A5;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C;) &amp;#xBC0F; 64 (&amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xAC00;&amp;#xC7A5; &amp;#xB192;&amp;#xC740; XState &amp;#xAE30;&amp;#xB2A5; &amp;#xBE44;&amp;#xD2B8;) &amp;#xBBF8;&amp;#xB9CC;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;CONTEXT_EX + &lt;code&gt;CONTEXT_EX.XState.Offset&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt;&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC628;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Configuration&lt;/code&gt;-&amp;gt; &lt;code&gt;ControlFlags.CompactionEnabled&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC5D0;&amp;#xC11C; &amp;#xC555;&amp;#xCD95;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294;&amp;#xC9C0; &amp;#xC5EC;&amp;#xBD80;&amp;#xB97C; &amp;#xC54C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xD615;&amp;#xC2DD;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; :&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Configuration&lt;/code&gt;-&amp;gt; &lt;code&gt;Features[n].Offset&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;.Size&lt;/code&gt;&amp;#xB97C; &amp;#xC77D;&amp;#xACE0; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0;&amp;#xC11C; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC624;&amp;#xD504;&amp;#xC14B; &amp;#xBC0F; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; :&lt;ul&gt;
&lt;li&gt;&lt;code&gt;XSAVE_AREA_HEADER&lt;/code&gt; (&lt;code&gt;XCOMP_BV&lt;/code&gt;&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;)&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;CompactionMask&lt;/code&gt;&amp;#xB97C; &amp;#xC77D;&amp;#xACE0; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Configuration&lt;/code&gt;-&amp;gt; &lt;code&gt;AllFeatures&lt;/code&gt;&amp;#xB97C; &amp;#xC77D;&amp;#xACE0; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5; ID &amp;#xC55E;&amp;#xC5D0; &amp;#xC624;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xB354;&amp;#xD558;&amp;#xC5EC; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC758; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xACC4;&amp;#xC0B0;&amp;#xD55C; &amp;#xB4A4; &amp;#xAC01; &amp;#xC774;&amp;#xC804; &amp;#xC0C1;&amp;#xD0DC; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xC2DC;&amp;#xC791; &amp;#xBD80;&amp;#xBD84;&amp;#xC744; 64byte&amp;#xB85C; &amp;#xC815;&amp;#xB82C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD574;&amp;#xB2F9; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &lt;code&gt;Configuration&lt;/code&gt;-&amp;gt; &lt;code&gt;AlignedFeatures&lt;/code&gt;&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9;&amp;#xC73C;&amp;#xB85C; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xACBD;&amp;#xC6B0; &amp;#xC9C0;&amp;#xC815;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5; ID&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xC2DC;&amp;#xC791;&amp;#xC744; &amp;#xC815;&amp;#xB82C;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Configuration.AllFeatures[n]&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xC77D;&amp;#xB294;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&amp;#xC704;&amp;#xC5D0;&amp;#xC11C; &amp;#xACC4;&amp;#xC0B0;&amp;#xB41C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0;&amp;#xC11C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xCC3E;&amp;#xACE0; &amp;#xC120;&amp;#xD0DD;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xCD9C;&amp;#xB825; &amp;#xAE38;&amp;#xC774; &amp;#xBCC0;&amp;#xC218;&amp;#xC758; &amp;#xD574;&amp;#xB2F9; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xD574;&amp;#xB2F9; &amp;#xD06C;&amp;#xAE30;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;#xC989;, &amp;#xC555;&amp;#xCD95;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xD615;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xD2B9;&amp;#xC815; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xCC3E;&amp;#xC73C;&amp;#xB824;&amp;#xBA74; &lt;code&gt;SharedUserData&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C;&amp;#xC5D0;&amp;#xC11C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xCDA9;&amp;#xBD84;&amp;#xD558;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC555;&amp;#xCD95;&amp;#xB41C; &amp;#xD615;&amp;#xC2DD;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &lt;code&gt;SharedUserData&lt;/code&gt;&amp;#xC758; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0; &amp;#xC758;&amp;#xC874;&amp;#xD560; &amp;#xC218; &amp;#xC5C6;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xC804; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD06C;&amp;#xAE30;&amp;#xB97C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC744; &amp;#xACC4;&amp;#xC0B0;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC778; Win32 &amp;#xC751;&amp;#xC6A9; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xB0B4;&amp;#xBD80;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC704;&amp;#xC758; &amp;#xAE30;&amp;#xBCF8; API&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC77C;&amp;#xBD80; &amp;#xC0AC;&amp;#xC804; &amp;#xCC98;&amp;#xB9AC;&amp;#xAC00; &amp;#xC788;&amp;#xB294; &amp;#xB2E4;&amp;#xB978; API&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xAE30;&amp;#xB3C4; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8; 0&amp;#xACFC; 1&amp;#xC740; CONTEXT_EX&amp;#xC5D0;&amp;#xC11C; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC800;&amp;#xC7A5;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; Win32 API&amp;#xB294; &amp;#xC801;&amp;#xC808;&amp;#xD55C; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT &amp;#xD544;&amp;#xB4DC; (&amp;#xC989;, &lt;code&gt;XSTATE_LEGACY_FLOATING_POINT&lt;/code&gt;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; FltSave, &lt;code&gt;XSTATE_LEGACY_SSE&lt;/code&gt;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; Xmm0)&amp;#xC5D0;&amp;#xC11C; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xB450; &amp;#xAE30;&amp;#xB2A5; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC640; &amp;#xCC98;&amp;#xB9AC;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;WINBASEAPI
PVOID
WINAPI
LocateXStateFeature (
    _In_ CONTEXT_EX Context,
    _In_ DWORD FeatureId,
    _Out_opt_ PDWORD Length
);&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;&amp;#xC608;&amp;#xC81C;-&amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC;-&amp;#xCD9C;&amp;#xB825;&#34;&gt;&lt;a href=&#34;#&amp;#xC608;&amp;#xC81C;-&amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC;-&amp;#xCD9C;&amp;#xB825;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xC608;&amp;#xC81C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC; &amp;#xCD9C;&amp;#xB825;&#34;&gt;&lt;/a&gt;&amp;#xC608;&amp;#xC81C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC; &amp;#xCD9C;&amp;#xB825;&lt;/h2&gt;&lt;p&gt;CONTEXT_EX &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xC640; &amp;#xACB0;&amp;#xD569;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; XState &amp;#xB0B4;&amp;#xBD80;&amp;#xB97C; &amp;#xC774;&amp;#xD574;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xAC04;&amp;#xB2E8;&amp;#xD55C; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/tree/master/Xpolicy&#34;&gt;&amp;#xD14C;&amp;#xC2A4;&amp;#xD2B8; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8;&lt;/a&gt;&amp;#xC744; &amp;#xC791;&amp;#xC131;&amp;#xD588;&amp;#xB2E4;. &amp;#xC774; &amp;#xC720;&amp;#xD2F8;&amp;#xB9AC;&amp;#xD2F0;&amp;#xB294; &amp;#xC77C;&amp;#xBD80; API &amp;#xC0AC;&amp;#xC6A9;&amp;#xACFC; &amp;#xAD00;&amp;#xB828;&amp;#xB41C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xC624;&amp;#xD504;&amp;#xC14B;, &amp;#xD06C;&amp;#xAE30; &amp;#xBC0F; &amp;#xB3D9;&amp;#xC791;&amp;#xC744; &amp;#xBCF4;&amp;#xC5EC;&amp;#xC900;&amp;#xB2E4;. &amp;#xB2E4;&amp;#xC74C;&amp;#xC740; AVX, MPX &amp;#xBC0F; Intel PT&amp;#xAC00; &amp;#xC788;&amp;#xB294; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xC11C; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8; (AVX &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; &amp;#xC0AC;&amp;#xC6A9;)&amp;#xC758; &amp;#xCD9C;&amp;#xB825;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/5.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xBB34;&amp;#xC5C7;&amp;#xBCF4;&amp;#xB2E4;&amp;#xB3C4; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; CONTEXT&amp;#xAC00; &amp;#xC74C;&amp;#xC218;&amp;#xC778; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xC608;&amp;#xC0C1;&amp;#xB300;&amp;#xB85C; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC774; x87 FPU &amp;#xC0C1;&amp;#xD0DC;(1) &amp;#xBC0F; GSE &amp;#xC0C1;&amp;#xD0DC;(2)&amp;#xB97C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xB354;&amp;#xB77C;&amp;#xB3C4; &lt;code&gt;XSAVEBV&lt;/code&gt;&amp;#xC5D0;&amp;#xB294; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xC601;&amp;#xC5ED;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C;&amp;#xB2E4;. (&amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xAD00;&amp;#xB828; &amp;#xC0C1;&amp;#xD0DC; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC758; &amp;#xC74C;&amp;#xC218; &amp;#xC624;&amp;#xD504;&amp;#xC14B;&amp;#xC5D0; &amp;#xC720;&amp;#xC758;&amp;#xD574;&amp;#xC57C; &amp;#xD568;) &lt;code&gt;0x40&lt;/code&gt; &amp;#xBC14;&amp;#xC774;&amp;#xD2B8; &amp;#xD06C;&amp;#xAE30;&amp;#xC778; XSAVE &amp;#xD5E4;&amp;#xB354; (&amp;#xC624;&amp;#xD504;&amp;#xC14B; &lt;code&gt;0x30&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC2DC;&amp;#xC791;) &amp;#xB2E4;&amp;#xC74C;&amp;#xC5D0; AVX &amp;#xC0C1;&amp;#xD0DC;(2)&amp;#xB294; &amp;#xC624;&amp;#xD504;&amp;#xC14B; &lt;code&gt;0x70&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC2DC;&amp;#xC791;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;h1 id=&#34;CONTEXT-EX-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;a href=&#34;#CONTEXT-EX-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34; class=&#34;headerlink&#34; title=&#34;CONTEXT_EX &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;/a&gt;CONTEXT_EX &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&lt;/h1&gt;&lt;p&gt;&amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; API&amp;#xB294; &amp;#xACB0;&amp;#xAD6D; &amp;#xCEE4;&amp;#xB110;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xCC98;&amp;#xB9AC;&amp;#xB418;&amp;#xACE0; XSAVE &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xAD8C;&amp;#xD55C; &amp;#xC788;&amp;#xB294; &amp;#xBD80;&amp;#xBD84; (&amp;#xC989;, CET &amp;#xC0C1;&amp;#xD0DC; &amp;#xB370;&amp;#xC774;&amp;#xD130;)&amp;#xC744; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xB294; CONTEXT_EX&amp;#xB97C; &amp;#xAD6C;&amp;#xC131;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; Windows&amp;#xB294; CONTEXT_EX&amp;#xB97C; &amp;#xD5C8;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; API&amp;#xB97C; &amp;#xD1B5;&amp;#xD55C; &amp;#xBC14;&amp;#xB78C;&amp;#xC9C1;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC218;&amp;#xC815;&amp;#xC744; &amp;#xBC29;&amp;#xC9C0;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4; :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;NtContinue&lt;/code&gt; : &amp;#xC608;&amp;#xC678; &amp;#xD6C4; &amp;#xC7AC;&amp;#xAC1C;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xBA70; longjmp CRT &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xACE0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xD574;&amp;#xC81C;&amp;#xB97C; &amp;#xC218;&amp;#xD589;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NtRaiseException&lt;/code&gt; : &amp;#xAE30;&amp;#xC874; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC608;&amp;#xC678;&amp;#xB97C; &amp;#xC0BD;&amp;#xC785;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NtQueueUserApc&lt;/code&gt; : &amp;#xAE30;&amp;#xC874; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xC2E4;&amp;#xD589; &amp;#xD750;&amp;#xB984;&amp;#xC744; &amp;#xAC00;&amp;#xB85C;&amp;#xCC44;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NtSetContextThread&lt;/code&gt; : &amp;#xAE30;&amp;#xC874; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130; / &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C; &amp;#xD638;&amp;#xCD9C;&amp;#xB85C; &amp;#xC778;&amp;#xD574; &amp;#xCEE4;&amp;#xB110;&amp;#xC774; &lt;code&gt;IA32_PL3_SSP&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;IA32_CET_U&lt;/code&gt; MSR&amp;#xC744; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xACE0; RIP&amp;#xB97C; &amp;#xC870;&amp;#xC791;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; Windows&amp;#xB294; &amp;#xC804;&amp;#xB2EC;&amp;#xB41C; CONTEXT_EX&amp;#xAC00; CET &amp;#xBCF4;&amp;#xC99D;&amp;#xC744; &amp;#xC704;&amp;#xBC18;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;19H1&lt;/code&gt;&amp;#xC5D0; SSP&amp;#xB97C; &amp;#xAC80;&amp;#xC99D;&amp;#xD558;&amp;#xACE0; &lt;code&gt;20H1&lt;/code&gt;&amp;#xC5D0; RIP &amp;#xAC80;&amp;#xC99D;&amp;#xC744; &amp;#xCD94;&amp;#xAC00;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC744; &amp;#xACE7; &amp;#xB2E4;&amp;#xB8F0; &amp;#xC608;&amp;#xC815;&amp;#xC774;&amp;#xB2E4;. &amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xBA3C;&amp;#xC800; &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC758; &amp;#xC624;&amp;#xC6A9; &amp;#xAC00;&amp;#xB2A5;&amp;#xC131;&amp;#xC744; &amp;#xC904;&amp;#xC774;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC791;&amp;#xC740; &amp;#xB9AC;&amp;#xD329;&amp;#xD130;&amp;#xB9C1;&amp;#xC744; &amp;#xC218;&amp;#xD589;&amp;#xD574;&amp;#xC57C; &amp;#xD588;&amp;#xB2E4;. &amp;#xBC14;&amp;#xB85C; &lt;code&gt;NtContinueEx&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xC758; &amp;#xB3C4;&amp;#xC785;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;NtContinueEX-&amp;#xBC0F;-KCONTINUE-ARGUMENT&#34;&gt;&lt;a href=&#34;#NtContinueEX-&amp;#xBC0F;-KCONTINUE-ARGUMENT&#34; class=&#34;headerlink&#34; title=&#34;NtContinueEX &amp;#xBC0F; KCONTINUE_ARGUMENT&#34;&gt;&lt;/a&gt;NtContinueEX &amp;#xBC0F; KCONTINUE_ARGUMENT&lt;/h2&gt;&lt;p&gt;&amp;#xC704;&amp;#xC5D0;&amp;#xC11C; &amp;#xC124;&amp;#xBA85;&amp;#xD55C; &amp;#xB300;&amp;#xB85C; &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC758; &amp;#xAE30;&amp;#xB2A5;&amp;#xC740; &amp;#xC5EC;&amp;#xB7EC; &amp;#xC0C1;&amp;#xD669;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xBA70;, CET&amp;#xAC00; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC11C; &amp;#xC0C1;&amp;#xD0DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC784;&amp;#xC758; &amp;#xBCC0;&amp;#xACBD;&amp;#xC744; &amp;#xD5C8;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; API&amp;#xC5D0;&amp;#xC11C; &amp;#xAE30;&amp;#xC874; &amp;#xC0C1;&amp;#xD0DC;&amp;#xB97C; &amp;#xBCF5;&amp;#xC6D0;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xB824;&amp;#xBA74; &amp;#xC778;&amp;#xD130;&amp;#xD398;&amp;#xC774;&amp;#xC2A4;&amp;#xC5D0; &amp;#xB354; &amp;#xC138;&amp;#xBC00;&amp;#xD55C; &amp;#xC81C;&amp;#xC5B4;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5B4;&amp;#xC57C; &amp;#xD588;&amp;#xB2E4;. &amp;#xC774; &amp;#xC791;&amp;#xC5C5;&amp;#xC740; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt;&amp;#xC774;&amp;#xB77C;&amp;#xB294; &amp;#xC0C8; enumeration&amp;#xC758; &amp;#xC0DD;&amp;#xC131;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC218;&amp;#xD589;&amp;#xB418;&amp;#xC5C8;&amp;#xC73C;&amp;#xBA70;, &lt;code&gt;KCONTINUE_ARGUMENT&lt;/code&gt; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0; &amp;#xD604;&amp;#xC7AC; &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;NtContinueEx&lt;/code&gt;&amp;#xB85C; &amp;#xD5A5;&amp;#xC0C1;&amp;#xB41C; &amp;#xBC84;&amp;#xC804;&amp;#xC73C;&amp;#xB85C; &amp;#xC804;&amp;#xB2EC;&amp;#xB418;&amp;#xC5B4;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0;&amp;#xB294;  &lt;code&gt;ContinueFlags&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC774; &amp;#xD544;&amp;#xB4DC;&amp;#xB294;  &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC758; &amp;#xC6D0;&amp;#xB798; &lt;code&gt;TestAlert&lt;/code&gt; &amp;#xC778;&amp;#xC218;&amp;#xB97C; &lt;code&gt;CONTINUE_FLAG_RAISE_ALERT (0x1)&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xB85C; &amp;#xB300;&amp;#xCCB4;&amp;#xD558;&amp;#xB294; &amp;#xB3D9;&amp;#xC2DC;&amp;#xC5D0; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; TrapFrame&amp;#xC73C;&amp;#xB85C; APC&amp;#xB97C; &amp;#xC9C1;&amp;#xC811; &amp;#xC804;&amp;#xB2EC;&amp;#xD558;&amp;#xB294;&lt;code&gt;CONTINUE_FLAG_BYPASS_CONTEXT_COPY (0x2)&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xB3C4; &amp;#xB3C4;&amp;#xC785;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC774;&amp;#xAC83;&amp;#xC740; CONTEXT &amp;#xB808;&amp;#xCF54;&amp;#xB4DC; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC758; &amp;#xD2B9;&amp;#xC815; &amp;#xC704;&amp;#xCE58;&amp;#xC5D0; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xC5EC; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &amp;#xAD6C;&amp;#xD604;&amp;#xB41C; &amp;#xCD5C;&amp;#xC801;&amp;#xD654;&amp;#xB85C;, &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBAA8;&amp;#xB4DC; APC &amp;#xC804;&amp;#xB2EC;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xACE0; &amp;#xC788;&amp;#xB2E4;&amp;#xACE0; &amp;#xAC00;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.  &amp;#xC774; &amp;#xB3D9;&amp;#xC791;&amp;#xC744; &amp;#xC6D0;&amp;#xD558;&amp;#xB294; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &lt;code&gt;ContinueFlags&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xB97C; &amp;#xBA85;&amp;#xC2DC;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xC804; &amp;#xC778;&amp;#xD130;&amp;#xD398;&amp;#xC774;&amp;#xC2A4;&amp;#xB294; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC;&amp;#xB85C; &amp;#xACC4;&amp;#xC18D; &amp;#xC9C0;&amp;#xC6D0;&amp;#xB418;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB0B4;&amp;#xBD80;&amp;#xC801;&amp;#xC73C;&amp;#xB85C;&amp;#xB294; &amp;#xC785;&amp;#xB825; &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xB97C; &lt;code&gt;KCONTINUE_ARGUMENT&lt;/code&gt;&amp;#xAC00; &amp;#xC544;&amp;#xB2CC; &lt;code&gt;BOOLEAN TestAlert&lt;/code&gt; &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xB85C; &amp;#xC778;&amp;#xC2DD;&amp;#xD558;&amp;#xB294; &lt;code&gt;NtContinueEx&lt;/code&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xACBD;&amp;#xC6B0;&amp;#xB294; &amp;#xC0C8; &amp;#xC778;&amp;#xD130;&amp;#xD398;&amp;#xC774;&amp;#xC2A4;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt;&amp;#xB85C; &amp;#xCC98;&amp;#xB9AC;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC704; &amp;#xB9AC;&amp;#xD329;&amp;#xD130;&amp;#xB9C1;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xB2E4;&amp;#xC74C; &amp;#xB124; &amp;#xAC00;&amp;#xC9C0; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xC720;&amp;#xD615;&amp;#xC774; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt; &amp;#x2013; &amp;#xC608;&amp;#xC678;&amp;#xC5D0;&amp;#xC11C; &amp;#xD574;&amp;#xC81C;&amp;#xD560; &amp;#xB54C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &lt;code&gt;RtlRestoreContext&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;LdrInitializeThunk&lt;/code&gt;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &lt;code&gt;NtContinue&lt;/code&gt;&amp;#xC758; &amp;#xB808;&amp;#xAC70;&amp;#xC2DC; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;KCONTINUE_RESUME&lt;/code&gt; &amp;#x2013; &lt;code&gt;NtContinueEx&lt;/code&gt;&amp;#xB97C; &amp;#xB2E4;&amp;#xC2DC; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xAE30; &amp;#xC804;&amp;#xC5D0; &lt;code&gt;KiUserApcDispatcher&lt;/code&gt;&amp;#xAC00; &amp;#xC2E4;&amp;#xD589;&amp;#xD560; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC5D0; &lt;code&gt;KCONTINUE_ARGUMENT&lt;/code&gt; &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xBE4C;&amp;#xB4DC;&amp;#xD560; &amp;#xB54C; &lt;code&gt;KiInitializeUserApc&lt;/code&gt;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;KCONTINUE_LONGJUMP&lt;/code&gt; &amp;#x2013; &amp;#xC608;&amp;#xC678; &amp;#xB808;&amp;#xCF54;&amp;#xB4DC;&amp;#xC758; &amp;#xC608;&amp;#xC678; &amp;#xCF54;&amp;#xB4DC;&amp;#xAC00; &lt;code&gt;STATUS_LONGJUMP&lt;/code&gt; &amp;#xC778; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;RtlRestoreContext&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xB294; &lt;code&gt;RtlContinueLongJump&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;KCONTINUE_SET&lt;/code&gt; &amp;#x2013; &lt;code&gt;NtContinueEx&lt;/code&gt;&amp;#xC5D0; &amp;#xC9C1;&amp;#xC811; &amp;#xC804;&amp;#xB2EC;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xACE0; &lt;code&gt;NtSetContextThread&lt;/code&gt; API&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC751;&amp;#xB2F5;&amp;#xC73C;&amp;#xB85C; &lt;code&gt;PspGetSetContextInternal&lt;/code&gt; &amp;#xB0B4;&amp;#xC5D0;&amp;#xC11C; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD560; &amp;#xB54C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB428;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;SSP-Shadow-Stack-Pointer-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;a href=&#34;#SSP-Shadow-Stack-Pointer-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34; class=&#34;headerlink&#34; title=&#34;SSP(Shadow Stack Pointer) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;/a&gt;SSP(Shadow Stack Pointer) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&lt;/h2&gt;&lt;p&gt;&amp;#xC55E;&amp;#xC11C; &amp;#xC5B8;&amp;#xAE09;&amp;#xD588;&amp;#xB4EF;&amp;#xC774; &amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C;, APC, longjmp &amp;#xB4F1;&amp;#xACFC; &amp;#xAC19;&amp;#xC774; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xCF54;&amp;#xB4DC;&amp;#xAC00; SSP&amp;#xB97C; &amp;#xBCC0;&amp;#xACBD;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xAC00; &amp;#xC788;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC6B4;&amp;#xC601; &amp;#xCCB4;&amp;#xC81C;&amp;#xB294; CET &amp;#xC6B0;&amp;#xD68C; &amp;#xBC29;&amp;#xC9C0;&amp;#xB97C; &amp;#xC704;&amp;#xD574; SSP&amp;#xC5D0; &amp;#xC694;&amp;#xCCAD;&amp;#xB41C; &amp;#xC0C8; &amp;#xAC12;&amp;#xC744; &amp;#xAC80;&amp;#xC99D;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xB294; &lt;code&gt;19H1&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextXStateCetU.c&#34;&gt;KeVerifyContextXStateCetU&lt;/a&gt; &amp;#xD568;&amp;#xC218;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xAD6C;&amp;#xD604;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xAC00; &amp;#xC218;&amp;#xC815;&amp;#xB418;&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC640; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xC0C8; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xB97C; &amp;#xC218;&amp;#xC2E0;&amp;#xD558;&amp;#xACE0; &amp;#xB2E4;&amp;#xC74C;&amp;#xC744; &amp;#xC218;&amp;#xD589;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CONTEXT_EX&amp;#xC5D0; XState &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xC9C0; &amp;#xC54A;&amp;#xAC70;&amp;#xB098; XState &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC5D0; CET &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xACBD;&amp;#xC6B0; (&lt;code&gt;XSTATE_CET_U&lt;/code&gt; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB85C; &lt;code&gt;RtlLocateExtendedFeature2&lt;/code&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xD655;&amp;#xC778;) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xB300;&amp;#xC0C1; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; CET&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; :&lt;ul&gt;
&lt;li&gt;&amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; &lt;code&gt;XSAVEBV&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;XSTATE_MASK_CET_U&lt;/code&gt;&amp;#xB97C; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD0B9;&amp;#xD558;&amp;#xC5EC; &amp;#xC774; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; CET&amp;#xB97C; &amp;#xBE44;&amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD558;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xACBD;&amp;#xC6B0; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xC0C1;&amp;#xD0DC; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xB2E4;&amp;#xC2DC; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD558;&amp;#xACE0; &lt;code&gt;MSR_IA32_CET_SHSTK_EN&lt;/code&gt; (CET&amp;#xC758; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD558;&amp;#xB294; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;)&amp;#xC744; &lt;code&gt;Ia32CetUMsr&lt;/code&gt;&amp;#xC5D0; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xACE0; &amp;#xD604;&amp;#xC7AC; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC744; &lt;code&gt;Ia32Pl3SspMsr&lt;/code&gt;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xBC18;&amp;#xBA74;&amp;#xC5D0; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextXStateCetUEnabled.c&#34;&gt;KiVerifyContextXStateCetUEnabled&lt;/a&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xBA74; CET &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC774; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5C8;&amp;#xB294;&amp;#xC9C0;, (&lt;code&gt;MSR_IA32_CET_SHSTK_EN&lt;/code&gt; &amp;#xD65C;&amp;#xC131;&amp;#xD654; &amp;#xC5EC;&amp;#xBD80;) &amp;#xC0C8; SSP&amp;#xAC00; 8byte&amp;#xB85C; &amp;#xC815;&amp;#xB82C;&amp;#xB418;&amp;#xC5C8;&amp;#xB294;&amp;#xC9C0;, &amp;#xD604;&amp;#xC7AC; SSP &amp;#xAC12;&amp;#xACFC; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; VAD &amp;#xB05D; &amp;#xC0AC;&amp;#xC774;&amp;#xC5D0; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC2A4;&amp;#xD0DD;&amp;#xC774; &amp;#xAC70;&amp;#xAFB8;&amp;#xB85C; &amp;#xC131;&amp;#xC7A5;&amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#x201C;&amp;#xB05D;&amp;#x201D;&amp;#xC774; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC758; &amp;#xC2DC;&amp;#xC791; &amp;#xC8FC;&amp;#xC18C;&amp;#xC774;&amp;#xB2E4;. &amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC0C8; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xB97C; &amp;#xC124;&amp;#xC815;&amp;#xD560; &amp;#xB54C; &amp;#xBAA8;&amp;#xB4E0; SSP &amp;#xAC12;&amp;#xC740; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC9C0;&amp;#xAE08;&amp;#xAE4C;&amp;#xC9C0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xB0B4;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &amp;#xD55C; &amp;#xC720;&amp;#xD6A8;&amp;#xD558;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xAC00; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xB0B4;&amp;#xBD80;&amp;#xB85C; &amp;#xC774;&amp;#xB3D9;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB294; &amp;#xBC94;&amp;#xC704;&amp;#xC5D0;&amp;#xB294; &amp;#xC81C;&amp;#xD55C;&amp;#xC774; &amp;#xC5C6;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;CET&amp;#xAC00; &amp;#xB300;&amp;#xC0C1; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xBE44;&amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xACE0; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; CONTEXT_EX&amp;#xC758; &lt;code&gt;XSAVEBV&lt;/code&gt;&amp;#xC5D0; &lt;code&gt;XSTATE_CET_U&lt;/code&gt; &amp;#xB9C8;&amp;#xC2A4;&amp;#xD06C;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC5EC; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB97C; &amp;#xC2DC;&amp;#xB3C4;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xB450; MSR &amp;#xAC12;&amp;#xC774; &amp;#xBAA8;&amp;#xB450; 0&amp;#xC73C;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xB3C4;&amp;#xB85D; &amp;#xD5C8;&amp;#xC6A9;&amp;#xD55C;&amp;#xB2E4;. (&amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; X, SSP X)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;#xC704; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xC5D0; &amp;#xC2E4;&amp;#xD328;&amp;#xD558;&amp;#xBA74; &lt;code&gt;STATUS_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xAC00; &amp;#xBC18;&amp;#xD658;&amp;#xB418;&amp;#xACE0; &amp;#xC131;&amp;#xACF5;&amp;#xD558;&amp;#xBA74; &lt;code&gt;STATUS_SUCCESS&lt;/code&gt;&amp;#xAC00; &amp;#xBC18;&amp;#xD658;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CET&amp;#xB97C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD558;&amp;#xBA74; &amp;#xAE30;&amp;#xC874; Windows 8.1&amp;#xC5D0;&amp;#xC11C; CFG&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xAD6C;&amp;#xD604;&amp;#xB41C; Check Stack Extents&amp;#xB3C4; &amp;#xC554;&amp;#xC2DC;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774;&amp;#xAC83;&amp;#xC740; KPROCESS&amp;#xC758; &lt;code&gt;ProcessFlags&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &lt;code&gt;CheckStackExtents&lt;/code&gt; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xD655;&amp;#xC778;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC989;, &amp;#xB300;&amp;#xC0C1; SSP&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD560; &amp;#xB54C;&amp;#xB9C8;&amp;#xB2E4; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextRecord.c&#34;&gt;KeVerifyContextRecord&lt;/a&gt; &amp;#xB610;&amp;#xD55C; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xACE0; &amp;#xB300;&amp;#xC0C1; RSP&amp;#xAC00; &amp;#xD604;&amp;#xC7AC; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; TEB &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xC2A4;&amp;#xD0DD; &amp;#xC81C;&amp;#xD55C; (&amp;#xB610;&amp;#xB294; &amp;#xC774;&amp;#xAC83;&amp;#xC774; WOW64 &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC778; &amp;#xACBD;&amp;#xC6B0; TEB32&amp;#xC758; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xC2A4;&amp;#xD0DD; &amp;#xC81C;&amp;#xD55C;)&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &lt;code&gt;RtlGuardIsValidStackPointer&lt;/code&gt; (&amp;#xBC0F; &lt;code&gt;RtlGuardIsValidWow64StackPointer&lt;/code&gt;)&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xAD6C;&amp;#xD604;&amp;#xB41C; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAC80;&amp;#xC0AC;&amp;#xB294; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; &lt;a href=&#34;https://medium.com/tenable-techblog/api-series-setthreadcontext-d08c9f84458d&#34;&gt;Tenable&lt;/a&gt; &amp;#xBC0F; &lt;a href=&#34;https://blog.ensilo.com/atombombing-cfg-protected-processes&#34;&gt;enSilo&lt;/a&gt;&amp;#xC758; &amp;#xC5F0;&amp;#xAD6C;&amp;#xC6D0;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;RIP-Instruction-Pointer-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;a href=&#34;#RIP-Instruction-Pointer-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34; class=&#34;headerlink&#34; title=&#34;RIP(Instruction Pointer) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;/a&gt;RIP(Instruction Pointer) &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;19030&lt;/code&gt; &amp;#xBE4C;&amp;#xB4DC; &amp;#xBC84;&amp;#xC804;&amp;#xC5D0; Intel CET&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xB610; &amp;#xB2E4;&amp;#xB978; &amp;#xAE30;&amp;#xB2A5;&amp;#xC778; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xB824;&amp;#xB294; &amp;#xC0C8; RIP&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xB294; &amp;#xAE30;&amp;#xB2A5;&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. SSP &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xC640; &amp;#xB9C8;&amp;#xCC2C;&amp;#xAC00;&amp;#xC9C0;&amp;#xB85C; &amp;#xC774;&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; CET&amp;#xC774; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB9CC; &amp;#xC801;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; RIP &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xB294; &amp;#xAE30;&amp;#xBCF8;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA70; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. (EPROCESS&amp;#xC758; &lt;code&gt;MitigationFlags2Values&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &lt;code&gt;UserCetSetContextIpValidation&lt;/code&gt; &amp;#xBE44;&amp;#xD2B8;&amp;#xB85C; &amp;#xD45C;&amp;#xC2DC;&amp;#xB428;).&lt;/p&gt;
&lt;p&gt;&amp;#xC989;, &amp;#xD604;&amp;#xC7AC; &amp;#xBE4C;&amp;#xB4DC;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;CreateProcess&lt;/code&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xACE0; &lt;code&gt;PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY&lt;/code&gt; &amp;#xC18D;&amp;#xC131;&amp;#xC744; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD560; &amp;#xB54C; &lt;code&gt;PROCESS_CREATION_MITIGATION_POLICY2_CET_USER_SHADOW_STACKS_ALWAYS_ON&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xBA74; &amp;#xC635;&amp;#xC158;&amp;#xC774; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xB294; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xBCF4;&amp;#xC778;&amp;#xB2E4;. (CET&amp;#xB294; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xC0DD;&amp;#xC131; &amp;#xC2DC;&amp;#xC5D0;&amp;#xB9CC; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &lt;code&gt;ProcessUserShadowStackPolicy&lt;/code&gt; &amp;#xAC12;&amp;#xC73C;&amp;#xB85C; &lt;code&gt;SetProcessMitgationPolicy&lt;/code&gt; API&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC740; &amp;#xC720;&amp;#xD6A8;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xB2E4;.)&lt;/p&gt;
&lt;p&gt;&amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xD765;&amp;#xBBF8;&amp;#xB86D;&amp;#xAC8C;&amp;#xB3C4; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; mitigation &amp;#xC635;&amp;#xC158;&amp;#xC778; &lt;code&gt;PS_MITIGATION_OPTION_USER_CET_SET_CONTEXT_IP_VALIDATION (32)&lt;/code&gt; &amp;#xC774; mitigation map&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xBB38;&amp;#xC11C;&amp;#xD654;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xC774; mitigation&amp;#xC744; &amp;#xD1A0;&amp;#xAE00; &amp;#xD558;&amp;#xBA74; &lt;code&gt;MitigationFlags2Values&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;AuditUserCetSetContextIpValidation&lt;/code&gt; &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB610;&amp;#xD55C; &amp;#xC774;&amp;#xAC83;&amp;#xC740; &amp;#xC774;&amp;#xC81C; 32 &amp;#xBC88;&amp;#xC9F8; mitigation &amp;#xC635;&amp;#xC158; (&amp;#xAC01;&amp;#xAC01; DEFERRED / OFF / ON / RESERVED&amp;#xC5D0; &amp;#xB300;&amp;#xD574; 4 &amp;#xBE44;&amp;#xD2B8;&amp;#xB97C; &amp;#xCC28;&amp;#xC9C0;&amp;#xD568;)&amp;#xC774;&amp;#xBBC0;&amp;#xB85C; 132&amp;#xAC1C;&amp;#xC758; mitigation &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xBA70; &lt;code&gt;PS_MITIGATION_OPTIONS_MAP&lt;/code&gt;&amp;#xB294; Map &amp;#xD544;&amp;#xB4DC;&amp;#xC758; 3&amp;#xAC1C;&amp;#xC758; 64 &amp;#xBE44;&amp;#xD2B8; &amp;#xBC30;&amp;#xC5F4; &amp;#xC694;&amp;#xC18C;&amp;#xB85C; &amp;#xD655;&amp;#xC7A5;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;.  (&lt;code&gt;PS_SYSTEM_DLL_INIT_BLOCK&lt;/code&gt;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD6C4;&amp;#xC18D; &amp;#xD6A8;&amp;#xACFC;&amp;#xAC00; &amp;#xC788;&amp;#xC74C;)&lt;/p&gt;
&lt;p&gt;&amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xAC00; &amp;#xBCC0;&amp;#xACBD;&amp;#xB420; &amp;#xB54C;&amp;#xB9C8;&amp;#xB2E4; &amp;#xD638;&amp;#xCD9C;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; CET &amp;#xBC0F; RIP mitigation&amp;#xC774; &amp;#xBAA8;&amp;#xB450; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xACE0; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8; &amp;#xB9E4;&amp;#xAC1C; &amp;#xBCC0;&amp;#xC218;&amp;#xC5D0; &lt;code&gt;CONTEXT_CONTROL&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xC124;&amp;#xC815;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC989;, &amp;#xC774; &amp;#xC0C8; &amp;#xCF58;&amp;#xD14D;&amp;#xC2A4;&amp;#xD2B8;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; RIP&amp;#xAC00; &amp;#xBCC0;&amp;#xACBD;&amp;#xB428;&amp;#xC744; &amp;#xC758;&amp;#xBBF8;&amp;#xD55C;&amp;#xB2E4;. &amp;#xBAA8;&amp;#xB4E0; &amp;#xAC80;&amp;#xC0AC;&amp;#xAC00; &amp;#xD1B5;&amp;#xACFC;&amp;#xB418;&amp;#xBA74; &amp;#xB0B4;&amp;#xBD80; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextIpForUserCet.c&#34;&gt;KiVerifyContextIpForUserCet&lt;/a&gt; &amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xC758; &amp;#xBAA9;&amp;#xC801;&amp;#xC740; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C; &amp;#xAC12;&amp;#xC774;&amp;#xACE0; &amp;#xC775;&amp;#xC2A4;&amp;#xD50C;&amp;#xB85C;&amp;#xC787;&amp;#xC774; &amp;#xC784;&amp;#xC758; &amp;#xCF54;&amp;#xB4DC;&amp;#xB97C; &amp;#xC2E4;&amp;#xD589;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xB294; &amp;#xAC12;&amp;#xC774; &amp;#xC544;&amp;#xB2CC;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xBA3C;&amp;#xC800; &amp;#xB300;&amp;#xC0C1; RIP &amp;#xC8FC;&amp;#xC18C;&amp;#xAC00; &amp;#xCEE4;&amp;#xB110; &amp;#xC8FC;&amp;#xC18C;&amp;#xAC00; &amp;#xC544;&amp;#xB2C8;&amp;#xBA70; &amp;#xB9E4;&amp;#xD551;&amp;#xB418;&amp;#xC5B4;&amp;#xC11C;&amp;#xB294; &amp;#xC548; &amp;#xB418;&amp;#xB294; &amp;#xD558;&amp;#xC704; 0x10000 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xC758; &amp;#xC8FC;&amp;#xC18C;&amp;#xAC00; &amp;#xC544;&amp;#xB2CC;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7F0; &amp;#xB2E4;&amp;#xC74C; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC;&amp;#xC758; &amp;#xC774;&amp;#xC804; &amp;#xC8FC;&amp;#xC18C;&amp;#xC778; &amp;#xACBD;&amp;#xC6B0;&amp;#xB97C; &amp;#xD5C8;&amp;#xC6A9;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574;&amp;#xC11C; &amp;#xD574;&amp;#xB2F9; &amp;#xAE30;&amp;#xBCF8; &amp;#xD2B8;&amp;#xB7A9; &amp;#xD504;&amp;#xB808;&amp;#xC784;&amp;#xC744; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xACE0; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xD574;&amp;#xB2F9; &amp;#xD2B8;&amp;#xB7A9; &amp;#xD504;&amp;#xB808;&amp;#xC784;&amp;#xC758; RIP&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &lt;code&gt;NtSetThreadContext&lt;/code&gt;&amp;#xAC00; &amp;#xCC98;&amp;#xC74C; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xACE0; RIP&amp;#xAC00; &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xC758; &amp;#xCD08;&amp;#xAE30; &amp;#xC2DC;&amp;#xC791; &amp;#xC8FC;&amp;#xC18C;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB420; &amp;#xB54C; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC774;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xB2E4;&amp;#xB978; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB3C4; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xB294; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt;&amp;#xC744; &amp;#xC218;&amp;#xC2E0;&amp;#xD558;&amp;#xACE0; &amp;#xD574;&amp;#xB2F9; &amp;#xAC12;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xB2E4;&amp;#xC591;&amp;#xD55C; &amp;#xBC29;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB300;&amp;#xBD80;&amp;#xBD84;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC744; &amp;#xBC18;&amp;#xBCF5;&amp;#xD558;&amp;#xACE0; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xB294;&amp;#xB370;, &amp;#xCC3E;&amp;#xC9C0; &amp;#xBABB;&amp;#xD558;&amp;#xBA74; &amp;#xC608;&amp;#xC678;&amp;#xAC00; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD558;&amp;#xBA70; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xC5D0; &amp;#xB3C4;&amp;#xB2EC;&amp;#xD560; &amp;#xB54C;&amp;#xAE4C;&amp;#xC9C0; &amp;#xACC4;&amp;#xC18D; &amp;#xC2E4;&amp;#xD589;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xB294; &amp;#xC81C;&amp;#xACF5;&amp;#xB41C; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt;&amp;#xC774; &lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xACE0; &lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/RtlVerifyUserUnwindTarget.c&#34;&gt;RtlVerifyUserUnwindTarget&lt;/a&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C; &amp;#xC139;&amp;#xC158;&amp;#xC5D0;&amp;#xC11C; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xB294; &amp;#xB354; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD55C; &amp;#xAC80;&amp;#xC0AC;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; RIP&amp;#xB97C; &amp;#xB2E4;&amp;#xC2DC; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xB2E4;&amp;#xB978; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB294; &lt;code&gt;STATUS_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xC5EC; EPROCESS&amp;#xC5D0; &lt;code&gt;AuditUserCetSetContextIpValidation&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; &amp;#xC2E4;&amp;#xD328; &amp;#xAC80;&amp;#xC0AC;&amp;#xB97C; &amp;#xC704;&amp;#xD574; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt;&amp;#xC774; &lt;code&gt;KiLogUserCetSetContextIpValidationAudit&lt;/code&gt;&amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAC80;&amp;#xC0AC;(auditing)&amp;#xB294; &amp;#xC77C;&amp;#xBC18;&amp;#xC801;&amp;#xC778; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; mitigation ETW &amp;#xCC44;&amp;#xB110;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xC218;&amp;#xD589;&amp;#xB418;&amp;#xB294; &amp;#xB300;&amp;#xC2E0; WER (Windows &amp;#xC624;&amp;#xB958;&amp;#xBCF4;&amp;#xACE0;) &amp;#xC11C;&amp;#xBE44;&amp;#xC2A4;&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; &amp;#xBE60;&amp;#xB978; &amp;#xC2E4;&amp;#xD328; &amp;#xC608;&amp;#xC678;&amp;#xB97C; &amp;#xC9C1;&amp;#xC811; &amp;#xBC1C;&amp;#xC0DD;&amp;#xC2DC;&amp;#xD0A4;&amp;#xB294; &amp;#xBC29;&amp;#xC2DD;&amp;#xC73C;&amp;#xB85C; &amp;#xC218;&amp;#xD589;&amp;#xB41C;&amp;#xB2E4;. (&lt;code&gt;FAST_FAIL_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &amp;#xC815;&amp;#xBCF4;&amp;#xB85C; &lt;code&gt;0xC000409&lt;/code&gt; &amp;#xC608;&amp;#xC678;&amp;#xB97C; &amp;#xC804;&amp;#xC1A1;). WER &amp;#xC2A4;&amp;#xD338;&amp;#xC744; &amp;#xBC29;&amp;#xC9C0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &lt;code&gt;AuditUserCetSetContextIpValidationLogged&lt;/code&gt;&amp;#xB77C;&amp;#xB294; &amp;#xB610; &amp;#xB2E4;&amp;#xB978; EPROCESS &amp;#xBE44;&amp;#xD2B8;&amp;#xAC00; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xAC00; &amp;#xC885;&amp;#xB8CC;&amp;#xB418;&amp;#xACE0; &amp;#xD604;&amp;#xC7AC; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD; &amp;#xC8FC;&amp;#xC18C;&amp;#xAC00; &amp;#xD398;&amp;#xC774;&amp;#xC9C0;&amp;#xB85C; &amp;#xC815;&amp;#xB82C;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC3E;&amp;#xAE30; &amp;#xC804;&amp;#xC5D0; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB8E8;&amp;#xD504;&amp;#xB97C; &amp;#xC911;&amp;#xC9C0;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xAC00; &amp;#xC788;&amp;#xB2E4;. &amp;#xC989;, &amp;#xC2A4;&amp;#xB808;&amp;#xB4DC;&amp;#xB97C; &amp;#xC885;&amp;#xB8CC;&amp;#xD560; &amp;#xB54C; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xCD5C;&amp;#xC6B0;&amp;#xC120;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC758; &amp;#xD604;&amp;#xC7AC; &amp;#xD398;&amp;#xC774;&amp;#xC9C0;&amp;#xC5D0;&amp;#xC11C;&amp;#xB9CC; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD574;&amp;#xB2F9; &amp;#xD398;&amp;#xC774;&amp;#xC9C0;&amp;#xC5D0;&amp;#xC11C; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC3E;&amp;#xC9C0; &amp;#xBABB;&amp;#xD558;&amp;#xBA74; &lt;code&gt;STATUS_THREAD_IS_TERMINATING&lt;/code&gt;&amp;#xC744; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xD568;&amp;#xC218;&amp;#xB294; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt; &amp;#xC774; &lt;code&gt;KCONTINUE_LONGJUMP&lt;/code&gt; &amp;#xC778; &amp;#xACBD;&amp;#xC6B0; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xAC80;&amp;#xC99D;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC9C0;&amp;#xB9CC; &amp;#xB300;&amp;#xC2E0; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/RtlVerifyUserUnwindTarget.c&#34;&gt;RtlVerifyUserUnwindTarget&lt;/a&gt;&amp;#xC774; &lt;code&gt;KCONTINUE_LONGJUMP&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xC5B4; PE Image Load Configuration Directory&amp;#xC758; &lt;code&gt;longjmp&lt;/code&gt; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC5D0;&amp;#xC11C; RIP&amp;#xB97C; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xC774; &amp;#xAE00;&amp;#xC758; &amp;#xB2E4;&amp;#xC74C; &amp;#xC139;&amp;#xC158;&amp;#xC5D0;&amp;#xC11C; &amp;#xC774; &amp;#xD45C;&amp;#xC640; &amp;#xAC80;&amp;#xC0AC;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC124;&amp;#xBA85;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/6.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt;&amp;#xC740; &amp;#xB2E4;&amp;#xC74C; &amp;#xB450; &amp;#xD568;&amp;#xC218; &amp;#xC911; &amp;#xD558;&amp;#xB098;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xD638;&amp;#xCD9C;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;PspGetSetContextInternal&lt;/code&gt; &amp;#x2013; &lt;code&gt;NtSetContextThread API&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC751;&amp;#xB2F5;&amp;#xC73C;&amp;#xB85C; &amp;#xD638;&amp;#xCD9C;&amp;#xB41C;&amp;#xB2E4;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextRecord.c&#34;&gt;KiVerifyContextRecord&lt;/a&gt; &amp;#x2013; &lt;code&gt;NtContinueEx&lt;/code&gt;, &lt;code&gt;NtRaiseException&lt;/code&gt; &amp;#xBC0F; &amp;#xC77C;&amp;#xBD80; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;NtSetContextThread&lt;/code&gt; API&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC751;&amp;#xB2F5;&amp;#xC73C;&amp;#xB85C; &amp;#xD638;&amp;#xCD9C;&amp;#xB41C;&amp;#xB2E4;. &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c&#34;&gt;KeVerifyContextIpForUserCet&lt;/a&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xAE30; &amp;#xC804;&amp;#xC5D0; (&amp;#xC218;&amp;#xC2E0;&amp;#xB41C; &lt;code&gt;ContinueArgument&lt;/code&gt;&amp;#xAC00; NULL&amp;#xC774; &amp;#xC544;&amp;#xB2CC; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB9CC;)&amp;#xC774; &amp;#xD568;&amp;#xC218;&amp;#xB294; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xAC00; CS &amp;#xB808;&amp;#xC9C0;&amp;#xC2A4;&amp;#xD130;&amp;#xB97C; &amp;#xC218;&amp;#xC815;&amp;#xD558;&amp;#xB824;&amp;#xACE0; &amp;#xD558;&amp;#xB294;&amp;#xC9C0;, &amp;#xC0C8; &amp;#xAC12;&amp;#xC774; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C; &amp;#xAC12;&amp;#xC778;&amp;#xC9C0;&amp;#xB97C; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. WOW64&amp;#xAC00; &amp;#xC544;&amp;#xB2CC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xB294; &amp;#xD53C;&amp;#xCF54; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC774;&amp;#xBA70;, &amp;#xC774; &amp;#xACBD;&amp;#xC6B0; CS&amp;#xB97C; &lt;code&gt;KGDT64_R3_CODE&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;KGDT64_R3_CMCODE&lt;/code&gt;&amp;#xB85C; &amp;#xC124;&amp;#xC815;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xB2E4;&amp;#xB978; &amp;#xAC12;&amp;#xC740; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextRecord.c&#34;&gt;KiVerifyContextRecord&lt;/a&gt;&amp;#xAC00; &amp;#xC0C8; CS &amp;#xAC12;&amp;#xC744; &lt;code&gt;KGDT64_R3_CODE&lt;/code&gt;&amp;#xB85C; &amp;#xAC15;&amp;#xC81C;&amp;#xD55C;&amp;#xB2E4;. &lt;code&gt;KiVerifyContextRecord&lt;/code&gt;&amp;#xB294; &lt;code&gt;KiContinuePreviousModeUser&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;KeVerifyContextRecord&lt;/code&gt;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xBA70; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0;, &amp;#xD568;&amp;#xC218;&amp;#xB294; RSP&amp;#xAC00; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xC2A4;&amp;#xD0DD; (native &amp;#xB610;&amp;#xB294; wow64) &amp;#xC911; &amp;#xD558;&amp;#xB098;&amp;#xC5D0; &amp;#xC788;&amp;#xACE0; 64 &amp;#xBE44;&amp;#xD2B8; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xAC00; CS&amp;#xB97C; &lt;code&gt;KGDT64_R3_CODE&lt;/code&gt;&amp;#xB85C;&amp;#xB9CC; &amp;#xC124;&amp;#xC815;&amp;#xD558;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;KeVerifyContextIpForUserCet&lt;/code&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD558;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xACBD;&amp;#xB85C;&amp;#xB294; &amp;#xBA3C;&amp;#xC800; &lt;code&gt;KeVerifyContextXStateCetU&lt;/code&gt;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xB300;&amp;#xC0C1; SSP&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD558;&amp;#xACE0; SSP&amp;#xAC00; &amp;#xC720;&amp;#xD6A8;&amp;#xD560; &amp;#xB54C;&amp;#xB9CC; RIP &amp;#xAC80;&amp;#xC0AC;&amp;#xB97C; &amp;#xC218;&amp;#xD589;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/7.png&#34; alt&gt;&lt;/p&gt;
&lt;h1 id=&#34;&amp;#xC608;&amp;#xC678;-&amp;#xD574;&amp;#xC81C;-&amp;#xBC0F;-longjmp-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;a href=&#34;#&amp;#xC608;&amp;#xC678;-&amp;#xD574;&amp;#xC81C;-&amp;#xBC0F;-longjmp-&amp;#xC720;&amp;#xD6A8;&amp;#xC131;-&amp;#xAC80;&amp;#xC0AC;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xBC0F; longjmp &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&#34;&gt;&lt;/a&gt;&amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xBC0F; longjmp &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&lt;/h1&gt;&lt;p&gt;&amp;#xC704;&amp;#xC5D0;&amp;#xC11C; &amp;#xC124;&amp;#xBA85;&amp;#xD55C; &amp;#xB300;&amp;#xB85C; &lt;code&gt;KCONTEXT_SET&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;KCONTEXT_RESUME&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xCC98;&amp;#xB9AC;&amp;#xB294; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xAC00; &amp;#xC100;&amp;#xB3C4;&amp;#xC6B0; &amp;#xC2A4;&amp;#xD0DD;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xACFC; &amp;#xAD00;&amp;#xB828;&amp;#xC774; &amp;#xC788;&amp;#xC9C0;&amp;#xB9CC; &lt;code&gt;KCONTEXT_UNWIND&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;KCONTEXT_LONGJMP&lt;/code&gt; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB294; &lt;code&gt;RtlVerifyUserUnwindTarget&lt;/code&gt;&amp;#xC744; &amp;#xD1B5;&amp;#xD55C; &amp;#xD655;&amp;#xC7A5;&amp;#xB41C; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xAC00; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xB2E4;. &amp;#xC774; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xB97C; &amp;#xC704;&amp;#xD574;&amp;#xC11C;&amp;#xB294; PE &amp;#xD30C;&amp;#xC77C; &amp;#xD615;&amp;#xC2DD; (&amp;#xBC0F; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC; &amp;#xC9C0;&amp;#xC6D0;)&amp;#xC744; &amp;#xBCC0;&amp;#xACBD;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xBA70; JIT &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC; &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xC704;&amp;#xD574; &lt;a href=&#34;https://github.com/yardenshafir/cet-research/blob/master/src/NtSetInformationProcess.c&#34;&gt;NtSetInformationProcess&lt;/a&gt;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; OS &amp;#xC218;&amp;#xC900;&amp;#xC758; &amp;#xC815;&amp;#xBCF4; &amp;#xD074;&amp;#xB798;&amp;#xC2A4;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CFG (Control Flow Guard) &amp;#xC9C0;&amp;#xC6D0;&amp;#xC73C;&amp;#xB85C; &amp;#xC778;&amp;#xD574; &amp;#xC774;&amp;#xBBF8; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C; PE &amp;#xD30C;&amp;#xC77C; &amp;#xB0B4;&amp;#xBD80;&amp;#xC758; &lt;code&gt;Image Load Configuration Directory&lt;/code&gt;&amp;#xC5D0;&amp;#xB294; &amp;#xD604;&amp;#xC7AC; &amp;#xC124;&amp;#xC815;&amp;#xB41C; &lt;code&gt;jmp/longjmp&lt;/code&gt; &amp;#xC30D;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xB294; &amp;#xBD84;&amp;#xAE30; &amp;#xC720;&amp;#xD6A8; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC815;&amp;#xBCF4;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xC73C;&amp;#xBA70;, &amp;#xC774; &amp;#xC815;&amp;#xBCF4;&amp;#xB97C; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB7EC;&amp;#xAC00; &amp;#xC2DD;&amp;#xBCC4;&amp;#xD574; &amp;#xB9C1;&amp;#xCEE4;&amp;#xC5D0; &amp;#xC804;&amp;#xB2EC;&amp;#xD558;&amp;#xB3C4;&amp;#xB85D; &amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB2E4;. CET&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBA74; &amp;#xC774; &amp;#xAE30;&amp;#xC874; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC7AC;&amp;#xC0AC;&amp;#xC6A9;&amp;#xB418;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC5F0;&amp;#xC18D; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC; &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xC704;&amp;#xD574; &amp;#xB610; &amp;#xB2E4;&amp;#xB978; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xACFC; &amp;#xD06C;&amp;#xAE30;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C;&amp;#xB2E4;. Visual Studio 2017&amp;#xC740; &lt;code&gt;longjmp&lt;/code&gt; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xC0DD;&amp;#xC131;&amp;#xD558;&amp;#xC9C0;&amp;#xB9CC; Visual Studio 2019&amp;#xBD80;&amp;#xD130; &amp;#xC704;&amp;#xC640; &amp;#xAC19;&amp;#xC740; &amp;#xC815;&amp;#xBCF4;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xC0DD;&amp;#xC131;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xC139;&amp;#xC158;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; &amp;#xD615;&amp;#xC2DD;&amp;#xACFC; &amp;#xCEE4;&amp;#xB110;&amp;#xC774; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xB450; &amp;#xAC00;&amp;#xC9C0; &amp;#xC720;&amp;#xD615;&amp;#xC758; &lt;code&gt;KCONTINUE_TYPE&lt;/code&gt; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984;&amp;#xC744; &amp;#xAC80;&amp;#xC99D;&amp;#xD558;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC744; &amp;#xC0B4;&amp;#xD3B4;&amp;#xBCF4;&amp;#xACA0;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;PE-&amp;#xBA54;&amp;#xD0C0;-&amp;#xB370;&amp;#xC774;&amp;#xD130;-&amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34;&gt;&lt;a href=&#34;#PE-&amp;#xBA54;&amp;#xD0C0;-&amp;#xB370;&amp;#xC774;&amp;#xD130;-&amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34; class=&#34;headerlink&#34; title=&#34;PE &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34;&gt;&lt;/a&gt;PE &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&lt;/h2&gt;&lt;p&gt;Windows 10&amp;#xC740; Control Flow Guard &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &amp;#xD45C;&amp;#xC900; GFIDS &amp;#xD14C;&amp;#xC774;&amp;#xBE14; &amp;#xC678;&amp;#xC5D0;&amp;#xB3C4;  RVA&amp;#xAC00; &amp;#xC800;&amp;#xC7A5;&amp;#xB418;&amp;#xB294; &lt;code&gt;.gljmp&lt;/code&gt;&amp;#xB77C;&amp;#xB294; PE Image Load Configuration&amp;#xC758; &lt;code&gt;Guard Long Jump Target Table&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xC800;&amp;#xC7A5;&amp;#xB41C; PE &amp;#xC139;&amp;#xC158;&amp;#xC758; Long Jump Target Table&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC5EC; longjump &amp;#xB300;&amp;#xC0C1;&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xC744; &amp;#xCD94;&amp;#xAC00;&amp;#xD588;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;setjmp&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD638;&amp;#xCD9C;&amp;#xC774; &amp;#xCF54;&amp;#xB4DC;&amp;#xC5D0;&amp;#xC11C; &amp;#xC218;&amp;#xD589;&amp;#xB420; &amp;#xB54C;&amp;#xB9C8;&amp;#xB2E4; &amp;#xBC18;&amp;#xD658; &amp;#xC8FC;&amp;#xC18C; (longjmp&amp;#xAC00; &amp;#xBD84;&amp;#xAE30;&amp;#xB418;&amp;#xB294; &amp;#xC704;&amp;#xCE58;)&amp;#xC758; RVA&amp;#xAC00; &amp;#xC774; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; &amp;#xC874;&amp;#xC7AC; &amp;#xC5EC;&amp;#xBD80;&amp;#xB294; Image Load Configuration Directory&amp;#xC758; &lt;code&gt;GuardFlags&lt;/code&gt;&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &lt;code&gt;IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC5D0; &amp;#xC758;&amp;#xD574; &amp;#xACB0;&amp;#xC815;&amp;#xB418;&amp;#xBA70; &lt;code&gt;GuardLongJumpTargetCount&lt;/code&gt; &amp;#xD544;&amp;#xB4DC;&amp;#xC5D0; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xB9CC;&amp;#xD07C;&amp;#xC758; &amp;#xD56D;&amp;#xBAA9;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xAC01; &amp;#xD56D;&amp;#xBAA9;&amp;#xC740; 4 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8; RVA&amp;#xC640; n &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xC758; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xC774;&amp;#xB2E4;. &amp;#xC5EC;&amp;#xAE30;&amp;#xC11C; n&amp;#xC740; &lt;code&gt;(GuardFlags &amp;amp; IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK) &amp;gt;&amp;gt; IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_SHIFT&lt;/code&gt;&amp;#xC758; &amp;#xACB0;&amp;#xACFC;&amp;#xC5D0;&amp;#xC11C; &amp;#xAC00;&amp;#xC838;&amp;#xC628;&amp;#xB2E4;. &amp;#xC774; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC815;&amp;#xC758;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC558;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xB294; &amp;#xD56D;&amp;#xC0C1; 0&amp;#xC774; &amp;#xB420; &amp;#xAC83;&amp;#xC73C;&amp;#xB85C; &amp;#xC608;&amp;#xC0C1;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774; &amp;#xACC4;&amp;#xC0B0;&amp;#xC740; &lt;code&gt;GFIDS&lt;/code&gt; &amp;#xD14C;&amp;#xC774;&amp;#xBE14; (&lt;code&gt;export suppression&lt;/code&gt;&amp;#xAC00; &amp;#xD65C;&amp;#xC131;&amp;#xD654;&amp;#xB41C; &amp;#xACBD;&amp;#xC6B0; &amp;#xC7A0;&amp;#xC7AC;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC788;&amp;#xC74C;)&amp;#xC5D0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C; &amp;#xACC4;&amp;#xC0B0;&amp;#xACFC; &amp;#xB3D9;&amp;#xC77C;&amp;#xD558;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xD558;&amp;#xB098; &amp;#xC774;&amp;#xC0C1;&amp;#xC758; CFG &amp;#xB300;&amp;#xC0C1;&amp;#xC744; &amp;#xC5B5;&amp;#xC81C;&amp;#xD558;&amp;#xBA74; 1 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xC758; &amp;#xBE48; &amp;#xBA54;&amp;#xD0C0;&amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; Long Jump Target Target Table&amp;#xC758; &amp;#xBAA8;&amp;#xB4E0; &amp;#xD56D;&amp;#xBAA9;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4; &amp;#xB2E4;&amp;#xC74C;&amp;#xC740; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &lt;code&gt;longjmp&lt;/code&gt; &amp;#xB300;&amp;#xC0C1;&amp;#xC774; &amp;#xC788;&amp;#xB294; PE &amp;#xD30C;&amp;#xC77C;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/8.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC774; &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0;&amp;#xB3C4; CFG &amp;#xB0B4;&amp;#xBCF4;&amp;#xB0B4;&amp;#xAE30; &amp;#xC5B5;&amp;#xC81C;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &lt;code&gt;GuardFlags&lt;/code&gt;&amp;#xC758; &amp;#xC0C1;&amp;#xC704; &amp;#xB2C8;&amp;#xBE14; (&lt;code&gt;IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK&lt;/code&gt;&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;)&amp;#xC5D0; &amp;#xC788;&amp;#xB294; &amp;#xAC12; 1&amp;#xC5D0; &amp;#xC720;&amp;#xC758;&amp;#xD558;&amp;#xC790;. &amp;#xC774;&amp;#xB294; &amp;#xC544;&amp;#xB798;&amp;#xC5D0;&amp;#xC11C; &amp;#xBCFC; &amp;#xC218; &amp;#xC788;&amp;#xB294; Long Jump Target Table&amp;#xC5D0; 1 &amp;#xBC14;&amp;#xC774;&amp;#xD2B8;&amp;#xC758; &amp;#xCD94;&amp;#xAC00; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xAC00; &amp;#xC788;&amp;#xC74C;&amp;#xC744; &amp;#xC54C;&amp;#xB824;&amp;#xC900;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/9.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Windows 10 20H1&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC720;&amp;#xD615;&amp;#xC758; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xAC00; &amp;#xBC14;&amp;#xC774;&amp;#xB108;&amp;#xB9AC;&amp;#xC758; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C;&amp;#xB2E4;. &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD544;&amp;#xB4DC; &lt;code&gt;GuardEHContinuationTable&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;GuardEHContinuationCount&lt;/code&gt;&amp;#xAC00; Image Load Configuration Directory &amp;#xB05D;&amp;#xC5D0; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xACE0; &lt;code&gt;IMAGE_GUARD_EH_CONTINUATION_TABLE_PRESENT&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &lt;code&gt;GuardFlags&lt;/code&gt;&amp;#xC5D0; &amp;#xD3EC;&amp;#xD568;&amp;#xB41C;&amp;#xB2E4;. &amp;#xC774; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; &amp;#xB808;&amp;#xC774;&amp;#xC544;&amp;#xC6C3;&amp;#xC740; &lt;code&gt;GuardFlags&lt;/code&gt;&amp;#xC758; &amp;#xC0C1;&amp;#xC704; &amp;#xB2C8;&amp;#xBE14;&amp;#xC744; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xD55C; &amp;#xBA54;&amp;#xD0C0; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xBC14;&amp;#xC774;&amp;#xD2B8; &amp;#xCD94;&amp;#xAC00;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xC5EC; Long Jump Target Table&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xD45C;&amp;#xC2DC;&amp;#xB41C; &amp;#xAC83;&amp;#xACFC; &amp;#xB3D9;&amp;#xC77C;&amp;#xD558;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xD0C0;&amp;#xAE5D;&amp;#xAC8C;&amp;#xB3C4; Visual Studio 2019 &amp;#xBC84;&amp;#xC804;&amp;#xC5D0;&amp;#xC11C;&amp;#xB3C4; &amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xC0DD;&amp;#xC131;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xD604;&amp;#xC7AC; &amp;#xC608;&amp;#xC81C;&amp;#xB97C; &amp;#xBCF4;&amp;#xC5EC;&amp;#xC904; &amp;#xC218; &amp;#xC5C6;&amp;#xB2E4;. &amp;#xC774; &amp;#xBD84;&amp;#xC11D;&amp;#xC740; &amp;#xB098;&amp;#xC911;&amp;#xC5D0; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xB294; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC; &amp;#xCF54;&amp;#xB4DC;&amp;#xC640; 20H1 SDK&amp;#xC758; &lt;code&gt;Ntimage.h&lt;/code&gt; &amp;#xD5E4;&amp;#xB354; &amp;#xD30C;&amp;#xC77C;&amp;#xC744; &amp;#xB9AC;&amp;#xBC84;&amp;#xC2A4; &amp;#xC5D4;&amp;#xC9C0;&amp;#xB2C8;&amp;#xC5B4;&amp;#xB9C1; &amp;#xD55C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;&amp;#xC0AC;&amp;#xC6A9;&amp;#xC790;-&amp;#xBC18;&amp;#xC804;-&amp;#xAE30;&amp;#xB2A5;-&amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34;&gt;&lt;a href=&#34;#&amp;#xC0AC;&amp;#xC6A9;&amp;#xC790;-&amp;#xBC18;&amp;#xC804;-&amp;#xAE30;&amp;#xB2A5;-&amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBC18;&amp;#xC804; &amp;#xAE30;&amp;#xB2A5; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&#34;&gt;&lt;/a&gt;&amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBC18;&amp;#xC804; &amp;#xAE30;&amp;#xB2A5; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&lt;/h2&gt;&lt;p&gt;&amp;#xC774;&amp;#xC81C; longjmp &amp;#xB300;&amp;#xC0C1; &amp;#xB610;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xB85C; &amp;#xBD84;&amp;#xAE30;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xBCC0;&amp;#xACBD;&amp;#xC774; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC74C;&amp;#xC744; &amp;#xC54C;&amp;#xACE0; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; CONTEXT_EX&amp;#xC5D0; &amp;#xC788;&amp;#xB294; RIP &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xC774; &amp;#xB450; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xC5B4;&amp;#xB5BB;&amp;#xAC8C; &amp;#xC5BB;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xC744;&amp;#xAE4C;? NtContinueEx &amp;#xC804;&amp;#xD654;? &amp;#xC774;&amp;#xB7F0; &amp;#xC791;&amp;#xC5C5;&amp;#xC740; &amp;#xD2B9;&amp;#xC815; &amp;#xD504;&amp;#xB85C;&amp;#xADF8;&amp;#xB7A8; &amp;#xC2E4;&amp;#xD589;&amp;#xC5D0;&amp;#xC11C; &amp;#xC790;&amp;#xC8FC; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C; &amp;#xCEE4;&amp;#xB110;&amp;#xC740; &amp;#xC774; &amp;#xBB38;&amp;#xC81C;&amp;#xB97C; &amp;#xD574;&amp;#xACB0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xD6A8;&amp;#xC728;&amp;#xC801;&amp;#xC778; &amp;#xBC29;&amp;#xBC95;&amp;#xC774; &amp;#xD544;&amp;#xC694;&amp;#xD558;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Inverted Function Table&lt;/code&gt;&amp;#xC758; &amp;#xAC1C;&amp;#xB150;&amp;#xC5D0; &amp;#xC774;&amp;#xBBF8; &amp;#xC775;&amp;#xC219;&amp;#xD560; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;. &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC740; &lt;code&gt;Ntdll.dll (LdrpInvertedFunctionTable)&lt;/code&gt; &amp;#xC5D0;&amp;#xC11C; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678; &amp;#xCC98;&amp;#xB9AC; &amp;#xC911; &amp;#xD574;&amp;#xC81C; opcode &amp;#xBC0F; &amp;#xC608;&amp;#xC678; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xCC3E;&amp;#xB294; &amp;#xB370; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;. (&lt;code&gt;.pdata&lt;/code&gt; &amp;#xC139;&amp;#xC158;&amp;#xC744; &amp;#xCC3E;&amp;#xC544;&amp;#xC11C;) &lt;code&gt;Ntoskrnl.exe (PsInvertedFunctionTable)&lt;/code&gt;&amp;#xC5D0; &amp;#xB610; &amp;#xB2E4;&amp;#xB978; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC774; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; &amp;#xCEE4;&amp;#xB110; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678; &amp;#xCC98;&amp;#xB9AC; &amp;#xBC0F; PatchGuard &amp;#xAC80;&amp;#xC0AC;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xC5D0; &amp;#xC0AC;&amp;#xC6A9;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xAC04;&amp;#xB2E8;&amp;#xD788; &amp;#xB9D0;&amp;#xD574; &lt;code&gt;Inverted Function Table&lt;/code&gt;&amp;#xC740; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xBAA8;&amp;#xB4E0; &amp;#xC720;&amp;#xC800;/&amp;#xCEE4;&amp;#xB110; &amp;#xBAA8;&amp;#xB4C8; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xAC00;&amp;#xC0C1; &amp;#xC8FC;&amp;#xC18C;&amp;#xBCC4;&amp;#xB85C; &amp;#xC815;&amp;#xB82C;&amp;#xB41C; PE &amp;#xC608;&amp;#xC678; &amp;#xB514;&amp;#xB809;&amp;#xD130;&amp;#xB9AC;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD3EC;&amp;#xC778;&amp;#xD130;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &amp;#xBC30;&amp;#xC5F4;&amp;#xC774;&amp;#xB2E4;. &amp;#xC774; &amp;#xBC30;&amp;#xC5F4;&amp;#xC744; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC774; PE &amp;#xD5E4;&amp;#xB354;&amp;#xB97C; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xD55C; &amp;#xB4A4; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xBAA8;&amp;#xB4C8; &amp;#xC5F0;&amp;#xACB0; &amp;#xBAA9;&amp;#xB85D;&amp;#xC744; &amp;#xAC80;&amp;#xC0C9;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xBCF4;&amp;#xB2E4; &amp;#xD6E8;&amp;#xC52C; &amp;#xBE60;&amp;#xB974;&amp;#xAE30; &amp;#xB54C;&amp;#xBB38;&amp;#xC5D0; &amp;#xC5ED;&amp;#xD568;&amp;#xC218; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC758; binary search&amp;#xB294; &amp;#xB85C;&amp;#xADF8;(n) &amp;#xC870;&amp;#xD68C;&amp;#xC5D0;&amp;#xC11C;&amp;#xB9CC; &amp;#xD574;&amp;#xB2F9; &amp;#xBAA8;&amp;#xB4C8;&amp;#xC758; &amp;#xAC00;&amp;#xC0C1; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xBE60;&amp;#xB974;&amp;#xAC8C; &amp;#xCC3E;&amp;#xB294;&amp;#xB2E4;. &amp;#xD604;&amp;#xC7AC; Microsoft&amp;#xC758; &amp;#xBA85;&amp;#xC131;&amp;#xC744; &amp;#xC5BB;&amp;#xACE0; &amp;#xC788;&amp;#xB294; Ken Johnson&amp;#xACFC; Matt Miller&amp;#xB294; &amp;#xC774;&amp;#xC804;&amp;#xC5D0; Uninformed Magazine&amp;#xC5D0; &lt;a href=&#34;http://uninformed.org/index.cgi?v=8&amp;amp;a=2&amp;amp;p=20&#34;&gt;&amp;#xCEE4;&amp;#xB110; &amp;#xBAA8;&amp;#xB4DC; &amp;#xD6C4;&amp;#xD0B9; &amp;#xAE30;&amp;#xC220;&lt;/a&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xAE30;&amp;#xC0AC;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; &amp;#xAC1C;&amp;#xC694;&amp;#xB97C; &amp;#xAC8C;&amp;#xC2DC;&amp;#xD588;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC774;&amp;#xC804;&amp;#xC5D0;&amp;#xB294; &lt;code&gt;Ntdll.dll&lt;/code&gt;&amp;#xC740; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC5D0;&amp;#xC11C; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678;&amp;#xB9CC;, &lt;code&gt;Ntoskrnl.exe&lt;/code&gt;&amp;#xB294; &amp;#xCEE4;&amp;#xB110; &amp;#xBAA8;&amp;#xB4DC; &amp;#xC608;&amp;#xC678;&amp;#xB9CC; &amp;#xAC80;&amp;#xC0AC;&amp;#xD588;&amp;#xB2E4;. &lt;code&gt;20H1&lt;/code&gt;&amp;#xC758; &amp;#xBCC0;&amp;#xACBD; &amp;#xC0AC;&amp;#xD56D;&amp;#xC740; &amp;#xCEE4;&amp;#xB110;&amp;#xB3C4; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;&amp;#xB294; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;. &lt;code&gt;longjmp&lt;/code&gt; &amp;#xBC0F; &amp;#xC608;&amp;#xC678; &amp;#xC5F0;&amp;#xC18D;&amp;#xC744; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xB294; &amp;#xB370; &amp;#xD544;&amp;#xC694;&amp;#xD55C; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xB85C;&amp;#xC9C1;&amp;#xC744; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &lt;code&gt;RtlpLookupUserFunctionTableInverted&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xCD94;&amp;#xAC00;&amp;#xB418;&amp;#xC5B4; &lt;code&gt;KeUserInvertedFunctionTable&lt;/code&gt; &amp;#xBCC0;&amp;#xC218;&amp;#xB97C; &amp;#xC2A4;&amp;#xCE94;&amp;#xD558;&amp;#xACE0; &lt;code&gt;Ntdll.dll&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD604;&amp;#xC7AC; &amp;#xB0B4;&amp;#xBCF4;&amp;#xB0B8; &lt;code&gt;LdrpInvertedFunctionTable&lt;/code&gt; &amp;#xC2EC;&amp;#xBCFC;&amp;#xC5D0; &amp;#xB9E4;&amp;#xD551;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xAC83;&amp;#xC740; &amp;#xD765;&amp;#xBBF8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD3EC;&amp;#xB80C;&amp;#xC2DD; &amp;#xAE30;&amp;#xB2A5;&amp;#xC73C;&amp;#xB85C;, &amp;#xCEE4;&amp;#xB110;&amp;#xC5D0;&amp;#xC11C; PEB&amp;#xC758; &amp;#xB85C;&amp;#xB354; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xAD6C;&amp;#xBB38; &amp;#xBD84;&amp;#xC11D;&amp;#xD558;&amp;#xAC70;&amp;#xB098; VAD&amp;#xB97C; &amp;#xC5F4;&amp;#xAC70;&amp;#xD560; &amp;#xD544;&amp;#xC694; &amp;#xC5C6;&amp;#xC774; &amp;#xD604;&amp;#xC7AC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xB0B4;&amp;#xC5D0; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xC720;&amp;#xC800; &amp;#xBAA8;&amp;#xB4DC; &amp;#xBAA8;&amp;#xB4C8;&amp;#xC744; &amp;#xC27D;&amp;#xAC8C; &amp;#xCC3E;&amp;#xC744; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC608;&amp;#xB97C; &amp;#xB4E4;&amp;#xC5B4; &amp;#xB2E4;&amp;#xC74C;&amp;#xC740; &lt;code&gt;Csrss.exe&lt;/code&gt;&amp;#xC5D0;&amp;#xC11C; &amp;#xD604;&amp;#xC7AC; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0;&amp;#xB97C; &amp;#xBCF4;&amp;#xB294; &amp;#xBC29;&amp;#xBC95;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;dx @$cursession.Processes.Where(p =&amp;gt; p.Name == &lt;span class=&#34;hljs-string&#34;&gt;&amp;quot;csrss.exe&amp;quot;&lt;/span&gt;).First().SwitchTo()
dx -r0 @$table = *(nt!_INVERTED_FUNCTION_TABLE**)&amp;amp;nt!KeUserInvertedFunctionTable
dx -g @$table-&amp;gt;TableEntry.Take(@$table-&amp;gt;CurrentSize)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#xC989;, &amp;#xC6D0;&amp;#xACA9;&amp;#xC5D0;&amp;#xC11C;&amp;#xB3C4; &amp;#xD2B9;&amp;#xD788; &lt;code&gt;unwind opcode&lt;/code&gt; &amp;#xAC00;&amp;#xC5C6;&amp;#xB294; x86 &amp;#xC2DC;&amp;#xC2A4;&amp;#xD15C;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0;&amp;#xAC00; &amp;#xC608;&amp;#xC678; &amp;#xB514;&amp;#xB809;&amp;#xD130;&amp;#xB9AC;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC744; &amp;#xAC00;&amp;#xB2A5;&amp;#xC131;&amp;#xC774; &amp;#xC788;&amp;#xC73C;&amp;#xBA70;, &lt;code&gt;.pdata&lt;/code&gt;&amp;#xB294; &lt;code&gt;/SAFESEH&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xACE0; &amp;#xC801;&amp;#xC5B4;&amp;#xB3C4; &amp;#xD558;&amp;#xB098;&amp;#xC758; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xAC00; &amp;#xC788;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0;&amp;#xC5D0;&amp;#xB9CC; &amp;#xC0DD;&amp;#xC131;&amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC0C1;&amp;#xD669;&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; &lt;code&gt;RtlpLookupUserFunctionTableInverted&lt;/code&gt;&amp;#xAC00; &amp;#xC2E4;&amp;#xD328;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBA70; &amp;#xB300;&amp;#xC2E0; &lt;code&gt;MmGetImageBase&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xC774;&amp;#xAC83;&amp;#xC740; &amp;#xC785;&amp;#xB825; RIP&amp;#xC5D0; &amp;#xD574;&amp;#xB2F9;&amp;#xD558;&amp;#xB294; &amp;#xC601;&amp;#xC5ED;&amp;#xC744; &amp;#xB9E4;&amp;#xD551;&amp;#xD558;&amp;#xB294; VAD&amp;#xB97C; &amp;#xC870;&amp;#xD68C;&amp;#xD558;&amp;#xACE0; &amp;#xC774;&amp;#xBBF8;&amp;#xC9C0; VAD &amp;#xC778; &amp;#xACBD;&amp;#xC6B0; &amp;#xD574;&amp;#xB2F9; &amp;#xC601;&amp;#xC5ED;&amp;#xC758; &amp;#xAE30;&amp;#xBCF8; &amp;#xC8FC;&amp;#xC18C;&amp;#xC640; &amp;#xD06C;&amp;#xAE30; (&amp;#xBAA8;&amp;#xB4C8;&amp;#xC758; &amp;#xD06C;&amp;#xAE30;&amp;#xC640; &amp;#xC77C;&amp;#xCE58;&amp;#xD574;&amp;#xC57C; &amp;#xD568;)&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2021/01/17/l0ch/cet-on-windows/10.png&#34; alt&gt;&lt;/p&gt;
&lt;h2 id=&#34;&amp;#xC5F0;&amp;#xC18D;&amp;#xB41C;-&amp;#xB300;&amp;#xC0C1;&amp;#xC5D0;-&amp;#xB300;&amp;#xD55C;-&amp;#xB3D9;&amp;#xC801;-&amp;#xC608;&amp;#xC678;-&amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&#34;&gt;&lt;a href=&#34;#&amp;#xC5F0;&amp;#xC18D;&amp;#xB41C;-&amp;#xB300;&amp;#xC0C1;&amp;#xC5D0;-&amp;#xB300;&amp;#xD55C;-&amp;#xB3D9;&amp;#xC801;-&amp;#xC608;&amp;#xC678;-&amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xC5F0;&amp;#xC18D;&amp;#xB41C; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB3D9;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&#34;&gt;&lt;/a&gt;&amp;#xC5F0;&amp;#xC18D;&amp;#xB41C; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB3D9;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt; &amp;#xC694;&amp;#xCCAD;&amp;#xC744; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xB294;&amp;#xB370; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xC7A5;&amp;#xC560;&amp;#xBB3C;&amp;#xC774; &amp;#xD558;&amp;#xB098; &amp;#xC788;&amp;#xB2E4;. &amp;#xC815;&amp;#xADDC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0;&amp;#xB294; &amp;#xCF54;&amp;#xB4DC;&amp;#xC758; &lt;code&gt;__try /__except /__finally&lt;/code&gt; &amp;#xC808;&amp;#xC744; &amp;#xAE30;&amp;#xBC18;&amp;#xC73C;&amp;#xB85C; &amp;#xD558;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D;&amp;#xB41C; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC815;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xAC00; &amp;#xC788;&amp;#xC9C0;&amp;#xB9CC; Windows&amp;#xC5D0;&amp;#xC11C;&amp;#xB294; JIT &amp;#xC5D4;&amp;#xC9C4;&amp;#xC774; &amp;#xC2E4;&amp;#xD589; &amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xCF54;&amp;#xB4DC;&amp;#xB97C; &amp;#xB3D9;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC989;&amp;#xC2DC; &amp;#xC0DD;&amp;#xC131;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC744; &amp;#xBFD0;&amp;#xB9CC; &amp;#xC544;&amp;#xB2C8;&amp;#xB77C; &lt;code&gt;RtlAddFunctionTable&lt;/code&gt; API &amp;#xB4F1;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xB7F0;&amp;#xD0C0;&amp;#xC784;&amp;#xC5D0; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xB97C; &amp;#xB4F1;&amp;#xB85D;&amp;#xD558;&amp;#xACE0; opcode&amp;#xB97C; &amp;#xD574;&amp;#xC81C;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xB294; &amp;#xC774;&amp;#xC804;&amp;#xC5D0;&amp;#xB294; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC790; &amp;#xBAA8;&amp;#xB4DC; stack walking &amp;#xBC0F; &amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C;&amp;#xC5D0;&amp;#xB9CC; &amp;#xD544;&amp;#xC694;&amp;#xD588;&amp;#xC9C0;&amp;#xB9CC; &amp;#xC774;&amp;#xC81C;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xAC00; &amp;#xCEE4;&amp;#xB110;&amp;#xC774; RIP&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xC7A0;&amp;#xC7AC;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C; &amp;#xAC12;&amp;#xC73C;&amp;#xB85C; &amp;#xCC98;&amp;#xB9AC;&amp;#xD574;&amp;#xC57C; &amp;#xD558;&amp;#xB294; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xB300;&amp;#xC0C1;&amp;#xC774; &amp;#xB41C;&amp;#xB2E4;. &lt;code&gt;RtlpFindDynamicEHContinuationTarget&lt;/code&gt;&amp;#xC774; &amp;#xCC98;&amp;#xB9AC;&amp;#xD558;&amp;#xB294; &amp;#xAC83;&amp;#xC774; &amp;#xB9C8;&amp;#xC9C0;&amp;#xB9C9; &amp;#xAC00;&amp;#xB2A5;&amp;#xC131;&amp;#xC774;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;CET &amp;#xC9C0;&amp;#xC6D0; &amp;#xBC0F; &lt;code&gt;NtContinueEx&lt;/code&gt; &amp;#xB3C4;&amp;#xC785;&amp;#xC758; &amp;#xC77C;&amp;#xBD80;&amp;#xB85C; EPROCESS &amp;#xAD6C;&amp;#xC870;&amp;#xB294; &lt;code&gt;DynamicEHContinuationTargetsLock&lt;/code&gt; &amp;#xBC0F; &lt;code&gt;DynamicEHContinuationTargetsTree&lt;/code&gt;&amp;#xB77C;&amp;#xB294; &amp;#xB450; &amp;#xAC1C;&amp;#xC758; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD544;&amp;#xB4DC;&amp;#xB85C; &amp;#xD5A5;&amp;#xC0C1;&amp;#xB418;&amp;#xC5C8;&amp;#xB2E4;. &amp;#xCCAB; &amp;#xBC88;&amp;#xC9F8;&amp;#xB294; &lt;code&gt;EX_PUSH_LOCK&lt;/code&gt;&amp;#xC774;&amp;#xACE0; &amp;#xB450; &amp;#xBC88;&amp;#xC9F8;&amp;#xB294; &amp;#xBAA8;&amp;#xB4E0; &amp;#xC720;&amp;#xD6A8;&amp;#xD55C; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &lt;code&gt;RTL_RB_TREE&lt;/code&gt;&amp;#xC774;&amp;#xB2E4;. &amp;#xC774; &amp;#xD2B8;&amp;#xB9AC;&amp;#xB294; &lt;code&gt;PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION&lt;/code&gt; &amp;#xC720;&amp;#xD615;&amp;#xC758; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xC640; &amp;#xD568;&amp;#xAED8; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4; &amp;#xC815;&amp;#xBCF4; &amp;#xD074;&amp;#xB798;&amp;#xC2A4; &amp;#xC778; &lt;code&gt;ProcessDynamicEHContinuationTargets&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &lt;code&gt;NtSetInformationProcess&lt;/code&gt;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xD638;&amp;#xCD9C;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; &amp;#xAD00;&amp;#xB9AC;&amp;#xB41C;&amp;#xB2E4;. &amp;#xB354; &amp;#xC27D;&amp;#xAC8C; &amp;#xC774;&amp;#xD574;&amp;#xD558;&amp;#xB824;&amp;#xBA74; &amp;#xC774;&amp;#xB7EC;&amp;#xD55C; &amp;#xAD6C;&amp;#xC870; &amp;#xBC0F; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xC544;&amp;#xB798; &amp;#xC815;&amp;#xC758;&amp;#xB97C; &amp;#xCC38;&amp;#xC870;&amp;#xD558;&amp;#xBA74; &amp;#xB41C;&amp;#xB2E4;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs c&#34;&gt;&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-meta-keyword&#34;&gt;define&lt;/span&gt; DYNAMIC_EH_CONTINUATION_TARGET_ADD          0x01&lt;/span&gt;
&lt;span class=&#34;hljs-meta&#34;&gt;#&lt;span class=&#34;hljs-meta-keyword&#34;&gt;define&lt;/span&gt; DYNAMIC_EH_CONTINUATION_TARGET_PROCESSED    0x02&lt;/span&gt;

&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;PROCESS_DYNAMIC_EH_CONTINUATION_TARGET&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt; 
    ULONG_PTR TargetAddress;
    ULONGLONG Flags;
} PROCESS_DYNAMIC_EH_CONTINUATION_TARGET, *PPROCESS_DYNAMIC_EH_CONTINUATION_TARGET;

&lt;span class=&#34;hljs-keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;hljs-class&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; _&lt;span class=&#34;hljs-title&#34;&gt;PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION&lt;/span&gt;&lt;/span&gt;
&lt;span class=&#34;hljs-class&#34;&gt;{&lt;/span&gt;
    USHORT NumberOfTargets;
    USHORT Reserved;
    ULONG Reserved2;
    PPROCESS_DYNAMIC_EH_CONTINUATION_TARGET* Targets;
} PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION, *PPROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;PspProcessDynamicEHContinuationTargets&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xAC00; &amp;#xC774; &amp;#xB370;&amp;#xC774;&amp;#xD130;&amp;#xB97C; &amp;#xBC18;&amp;#xBCF5;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD574; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xBA70;, &amp;#xC774; &amp;#xC2DC;&amp;#xC810;&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;RtlAddDynamicEHContinuationTarget&lt;/code&gt;&amp;#xC740; &amp;#xB300;&amp;#xC0C1; &amp;#xC8FC;&amp;#xC18C;&amp;#xB97C; &amp;#xC800;&amp;#xC7A5;&amp;#xD558;&amp;#xB294; &amp;#xB370;&amp;#xC774;&amp;#xD130; &amp;#xAD6C;&amp;#xC870;&amp;#xB97C; &amp;#xD560;&amp;#xB2F9;&amp;#xD558;&amp;#xACE0; &lt;code&gt;ETL_RB_TREE_BPROCESS.NODE&lt;/code&gt;&amp;#xC5D0; &lt;code&gt;RTL_RB_NODE&lt;/code&gt; &amp;#xB9C1;&amp;#xD06C;&amp;#xB97C; &amp;#xC5F0;&amp;#xACB0;&amp;#xD558;&amp;#xB294; &lt;code&gt;DYNAMIC_EH_CONTINUATION_TARGET_ADD&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8; &amp;#xC138;&amp;#xD2B8;&amp;#xB97C; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &amp;#xD56D;&amp;#xBAA9;&amp;#xC5D0; &amp;#xB300;&amp;#xD574; &amp;#xD638;&amp;#xCD9C;&amp;#xB418;&amp;#xBA70; &amp;#xBC18;&amp;#xB300;&amp;#xB85C; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xC5C6;&amp;#xC73C;&amp;#xBA74; &amp;#xB300;&amp;#xC0C1;&amp;#xC744; &amp;#xC870;&amp;#xD68C;&amp;#xD558;&amp;#xACE0; &amp;#xC2E4;&amp;#xC81C;&amp;#xB85C; &amp;#xC874;&amp;#xC7AC;&amp;#xD558;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xC81C;&amp;#xAC70;&amp;#xB418;&amp;#xACE0; &amp;#xB178;&amp;#xB4DC;&amp;#xAC00; &amp;#xD574;&amp;#xC81C;&amp;#xB41C;&amp;#xB2E4;. &amp;#xAC01; &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; &amp;#xCC98;&amp;#xB9AC;&amp;#xB420; &amp;#xB54C; &lt;code&gt;DYNAMIC_EH_CONTINUATION_TARGET_PROCESSED&lt;/code&gt; &amp;#xD50C;&amp;#xB798;&amp;#xADF8;&amp;#xAC00; &amp;#xC6D0;&amp;#xB798; &amp;#xC785;&amp;#xB825; &amp;#xBC84;&amp;#xD37C;&amp;#xC5D0; OR &amp;#xCC98;&amp;#xB9AC;&amp;#xB418;&amp;#xBBC0;&amp;#xB85C; &amp;#xD638;&amp;#xCD9C;&amp;#xC790;&amp;#xB294; &amp;#xC5B4;&amp;#xB5A4; &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; &amp;#xC791;&amp;#xB3D9;&amp;#xD558;&amp;#xACE0; &amp;#xC791;&amp;#xB3D9;&amp;#xD558;&amp;#xC9C0; &amp;#xC54A;&amp;#xC558;&amp;#xB294;&amp;#xC9C0; &amp;#xC54C; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xAC00;&amp;#xB2A5;&amp;#xD55C; &amp;#xBAA8;&amp;#xB4E0; ROP &amp;#xAC00;&amp;#xC82F;&amp;#xC774; &amp;#xB2E8;&amp;#xC21C;&amp;#xD788; &amp;#x2018;&amp;#xB3D9;&amp;#xC801; &amp;#xC5F0;&amp;#xC18D; &amp;#xBAA9;&amp;#xD45C;&amp;#x2019;&amp;#xB85C; &amp;#xCD94;&amp;#xAC00;&amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xC73C;&amp;#xBBC0;&amp;#xB85C;&amp;#xC774; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xC874;&amp;#xC7AC;&amp;#xB294; CET/CFG&amp;#xC640; &amp;#xC720;&amp;#xC0AC;&amp;#xD55C; &amp;#xAE30;&amp;#xB2A5;&amp;#xC758; &amp;#xBCF4;&amp;#xD3B8;&amp;#xC801;&amp;#xC778; &amp;#xC6B0;&amp;#xD68C;&amp;#xB85C; &amp;#xBCF4;&amp;#xC778;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; Microsoft&amp;#xB294; &amp;#xBE0C;&amp;#xB77C;&amp;#xC6B0;&amp;#xC800;&amp;#xC640; Flash&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &lt;code&gt;out-of-process JIT&lt;/code&gt; &amp;#xCEF4;&amp;#xD30C;&amp;#xC77C;&amp;#xB9CC; &amp;#xACF5;&amp;#xC2DD;&amp;#xC801;&amp;#xC73C;&amp;#xB85C; &amp;#xC9C0;&amp;#xC6D0;&amp;#xD558;&amp;#xBBC0;&amp;#xB85C; &amp;#xC774; API&amp;#xB294; &amp;#xC6D0;&amp;#xACA9; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0;&amp;#xC11C;&amp;#xB9CC; &amp;#xC791;&amp;#xB3D9;&amp;#xD55C;&amp;#xB2E4;&amp;#xB294; &amp;#xC810;&amp;#xC5D0; &amp;#xC720;&amp;#xC758;&amp;#xD574;&amp;#xC57C; &amp;#xD55C;&amp;#xB2E4;. &amp;#xB530;&amp;#xB77C;&amp;#xC11C; &amp;#xD604;&amp;#xC7AC; &amp;#xD504;&amp;#xB85C;&amp;#xC138;&amp;#xC2A4;&amp;#xC5D0;&amp;#xC11C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xBA74; &amp;#xD56D;&amp;#xC0C1; &lt;code&gt;STATUS_ACCESS_DENIED&lt;/code&gt;&amp;#xB85C; &amp;#xC2E4;&amp;#xD328;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
&lt;h2 id=&#34;&amp;#xD0C0;&amp;#xAC9F;-&amp;#xAC80;&amp;#xC99D;&#34;&gt;&lt;a href=&#34;#&amp;#xD0C0;&amp;#xAC9F;-&amp;#xAC80;&amp;#xC99D;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xD0C0;&amp;#xAC9F; &amp;#xAC80;&amp;#xC99D;&#34;&gt;&lt;/a&gt;&amp;#xD0C0;&amp;#xAC9F; &amp;#xAC80;&amp;#xC99D;&lt;/h2&gt;&lt;p&gt;&amp;#xC774; &amp;#xBAA8;&amp;#xB4E0; &amp;#xC9C0;&amp;#xC2DD;&amp;#xC744; &amp;#xD1B5;&amp;#xD569;&amp;#xD558;&amp;#xBA74; &lt;code&gt;RtlVerifyUserUnwindTarget&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xC124;&amp;#xBA85;&amp;#xD558;&amp;#xAE30; &amp;#xC26C;&amp;#xC6CC;&amp;#xC9C4;&amp;#xB2E4;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;CONTEXT_EX &amp;#xAD6C;&amp;#xC870;&amp;#xC5D0;&amp;#xC11C; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xC640; &amp;#xC5F0;&amp;#xAD00;&amp;#xB41C; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; PE &amp;#xBAA8;&amp;#xB4C8;&amp;#xC744; &amp;#xC870;&amp;#xD68C;&amp;#xD55C;&amp;#xB2E4;. &amp;#xBA3C;&amp;#xC800; &lt;code&gt;RtlpLookupUserFunctionTableInverted&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xACE0; &amp;#xC2E4;&amp;#xD328;&amp;#xD558;&amp;#xBA74; &amp;#xB300;&amp;#xC2E0; &lt;code&gt;MmGetImageBase&lt;/code&gt;&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; &amp;#xBAA8;&amp;#xB4C8;&amp;#xC774; 4GB &amp;#xBBF8;&amp;#xB9CC;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xBAA8;&amp;#xB4C8;&amp;#xC774; &amp;#xBC1C;&amp;#xACAC;&amp;#xB418;&amp;#xBA74; &lt;code&gt;LdrImageDirectoryEntryToLoadConfig&lt;/code&gt; &amp;#xD568;&amp;#xC218;&amp;#xB97C; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; Image Load Configuration Directory&amp;#xB97C; &amp;#xAC00;&amp;#xC838;&amp;#xC628;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7F0; &amp;#xB2E4;&amp;#xC74C; Long Jump &amp;#xB610;&amp;#xB294; &amp;#xC5F0;&amp;#xC18D; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB3D9;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD560; &amp;#xC218; &amp;#xC788;&amp;#xC744; &amp;#xB9CC;&amp;#xD07C; &amp;#xCDA9;&amp;#xBD84;&amp;#xD788; &amp;#xD070;&amp;#xC9C0;&amp;#xC640; &lt;code&gt;guardflags&lt;/code&gt;&amp;#xC5D0; &lt;code&gt;IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;IMAGE_GUARD_EH_CONTINUATION_TABLE_PRESENT&lt;/code&gt;&amp;#xAC00; &amp;#xD3EC;&amp;#xD568;&amp;#xB418;&amp;#xC5B4; &amp;#xC788;&amp;#xB294;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB514;&amp;#xB809;&amp;#xD130;&amp;#xB9AC;&amp;#xAC00; &amp;#xC5C6;&amp;#xAC70;&amp;#xB098; &amp;#xB108;&amp;#xBB34; &amp;#xC791;&amp;#xC740; &amp;#xACBD;&amp;#xC6B0; &amp;#xD639;&amp;#xC740; &amp;#xC77C;&amp;#xCE58;&amp;#xD558;&amp;#xB294; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC774; &amp;#xC5C6;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xD638;&amp;#xD658;&amp;#xC131;&amp;#xC744; &amp;#xC704;&amp;#xD574; &lt;code&gt;STATUS_SUCCESS&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;Image Load Configuration Directory&amp;#xC5D0;&amp;#xC11C; &lt;code&gt;GuardLongJumpTargetTable&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;GuardEHContinuationTable&lt;/code&gt;&amp;#xC744; &amp;#xAC00;&amp;#xC838;&amp;#xC624;&amp;#xACE0; &lt;code&gt;GuardLongJumpTargetCount&lt;/code&gt; &amp;#xB610;&amp;#xB294; &lt;code&gt;GuardEHContinuationCount&lt;/code&gt;&amp;#xC758; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC0AC;&amp;#xD55C;&amp;#xB2E4;. &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; 40&amp;#xC5B5; &amp;#xAC1C; &amp;#xC774;&amp;#xC0C1;&amp;#xC774;&amp;#xBA74; &lt;code&gt;STATUS_INTEGER_OVERFLOW&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;. 0 &amp;#xAC1C; &amp;#xC774;&amp;#xC0C1;&amp;#xC758; &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; &amp;#xC788;&amp;#xB294; &amp;#xACBD;&amp;#xC6B0; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC744; &amp;#xD1B5;&amp;#xD574; bsearch_s (&amp;#xB300;&amp;#xC870;&amp;#xC790;&amp;#xB85C; &lt;code&gt;RtlpTarget Compare&lt;/code&gt; &amp;#xB97C; &amp;#xC804;&amp;#xB2EC;)&amp;#xB97C; &amp;#xC0AC;&amp;#xC6A9;&amp;#xD558;&amp;#xC5EC; binary search&amp;#xB97C; &amp;#xD1B5;&amp;#xD574; RVA&amp;#xB85C; &amp;#xBCC0;&amp;#xD658;&amp;#xD55C; &amp;#xD6C4; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC3E;&amp;#xB294;&amp;#xB2E4;. &amp;#xBC1C;&amp;#xACAC;&amp;#xB418;&amp;#xBA74; &lt;code&gt;STATUS_SUCCESS&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD569;&amp;#xB2C8;&amp;#xB2E4;.&lt;/li&gt;
&lt;li&gt;&amp;#xB300;&amp;#xC0C1; RIP&amp;#xB97C; &amp;#xCC3E;&amp;#xC744; &amp;#xC218; &amp;#xC5C6;&amp;#xAC70;&amp;#xB098; (&amp;#xB610;&amp;#xB294; &amp;#xD14C;&amp;#xC774;&amp;#xBE14;&amp;#xC5D0; &amp;#xC2DC;&amp;#xC791;&amp;#xD560; &amp;#xD56D;&amp;#xBAA9;&amp;#xC774; 0&amp;#xC778; &amp;#xACBD;&amp;#xC6B0;) &amp;#xCC98;&amp;#xC74C;&amp;#xBD80;&amp;#xD130; &amp;#xB300;&amp;#xC0C1; RIP&amp;#xC5D0;&amp;#xC11C; &amp;#xB85C;&amp;#xB4DC;&amp;#xB41C; &amp;#xBAA8;&amp;#xB4C8;&amp;#xC774; &amp;#xBC1C;&amp;#xACAC;&amp;#xB418;&amp;#xC9C0; &amp;#xC54A;&amp;#xC740; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;STATUS_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD574;  &lt;code&gt;longjmp&lt;/code&gt; &amp;#xC720;&amp;#xD6A8;&amp;#xC131;&amp;#xC744; &amp;#xAC80;&amp;#xC99D;&amp;#xD55C;&amp;#xB2E4;.(&lt;code&gt;KCONTINUE_LONGJUMP&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&amp;#xC608;&amp;#xC678; &amp;#xD574;&amp;#xC81C; &amp;#xC720;&amp;#xD6A8;&amp;#xC131; &amp;#xAC80;&amp;#xC0AC; (&lt;code&gt;KCONTINUE_UNWIND&lt;/code&gt;)&amp;#xC758; &amp;#xACBD;&amp;#xC6B0; &lt;code&gt;RtlpFindDynamicEHContinuationTarget&lt;/code&gt;&amp;#xC744; &amp;#xD638;&amp;#xCD9C;&amp;#xD558;&amp;#xC5EC; &amp;#xB4F1;&amp;#xB85D;&amp;#xB41C; &amp;#xC5F0;&amp;#xC18D; &amp;#xB300;&amp;#xC0C1;&amp;#xC5D0; &amp;#xB300;&amp;#xD55C; &amp;#xB3D9;&amp;#xC801; &amp;#xC608;&amp;#xC678; &amp;#xD578;&amp;#xB4E4;&amp;#xB7EC;&amp;#xC778;&amp;#xC9C0; &amp;#xD655;&amp;#xC778;&amp;#xD55C;&amp;#xB2E4;. &amp;#xB9DE;&amp;#xC73C;&amp;#xBA74; &lt;code&gt;STATUS_SUCCESS&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD558;&amp;#xACE0;, &amp;#xADF8;&amp;#xB807;&amp;#xC9C0; &amp;#xC54A;&amp;#xC73C;&amp;#xBA74; &lt;code&gt;STATUS_SET_CONTEXT_DENIED&lt;/code&gt;&amp;#xB97C; &amp;#xBC18;&amp;#xD658;&amp;#xD55C;&amp;#xB2E4;.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;&amp;#xACB0;&amp;#xB860;&#34;&gt;&lt;a href=&#34;#&amp;#xACB0;&amp;#xB860;&#34; class=&#34;headerlink&#34; title=&#34;&amp;#xACB0;&amp;#xB860;&#34;&gt;&lt;/a&gt;&amp;#xACB0;&amp;#xB860;&lt;/h1&gt;&lt;p&gt;CET&amp;#xC758; &amp;#xAD6C;&amp;#xD604;&amp;#xACFC; &amp;#xAD00;&amp;#xB828; mitigation&amp;#xC740; ROP &amp;#xBC0F; &amp;#xAE30;&amp;#xD0C0; &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xD558;&amp;#xC774;&amp;#xC7AC;&amp;#xD0B9; &amp;#xAE30;&amp;#xC220;&amp;#xC758; &amp;#xC0AC;&amp;#xC6A9;&amp;#xC744; &amp;#xBC29;&amp;#xC9C0;&amp;#xD558;&amp;#xAE30; &amp;#xC704;&amp;#xD55C; &amp;#xC8FC;&amp;#xC694; &amp;#xB2E8;&amp;#xACC4;&amp;#xC774;&amp;#xB2E4;. &amp;#xC81C;&amp;#xC5B4; &amp;#xD750;&amp;#xB984; &amp;#xBB34;&amp;#xACB0;&amp;#xC131;&amp;#xC740; &amp;#xBD84;&amp;#xBA85; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD55C; &amp;#xC8FC;&amp;#xC81C;&amp;#xC774;&amp;#xBA70;, &amp;#xD5A5;&amp;#xD6C4; &amp;#xCD94;&amp;#xAC00;&amp;#xC801;&amp;#xC778; mitigation&amp;#xC774; &amp;#xCD94;&amp;#xAC00;&amp;#xB428;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xB354;&amp;#xC6B1; &amp;#xBCF5;&amp;#xC7A1;&amp;#xD574;&amp;#xC9C8; &amp;#xAC83;&amp;#xC774;&amp;#xB2E4;. &amp;#xCD94;&amp;#xAC00;&amp;#xC801;&amp;#xC778; &amp;#xD638;&amp;#xD658;&amp;#xC131; &amp;#xBB38;&amp;#xC81C;&amp;#xC640; &amp;#xC77C;&amp;#xD68C;&amp;#xC131; &amp;#xC2DC;&amp;#xB098;&amp;#xB9AC;&amp;#xC624;&amp;#xB85C; &amp;#xC778;&amp;#xD574; &amp;#xD2B9;&amp;#xC815; &amp;#xCC98;&amp;#xB9AC;&amp;#xB97C; &amp;#xD544;&amp;#xC694;&amp;#xB85C; &amp;#xD558;&amp;#xB294; &amp;#xC0AC;&amp;#xB840;&amp;#xAC00; &amp;#xC810;&amp;#xC810; &amp;#xB354; &amp;#xB9CE;&amp;#xC774; &amp;#xBC1C;&amp;#xACAC;&amp;#xB420; &amp;#xC218; &amp;#xC788;&amp;#xB2E4;. &amp;#xADF8;&amp;#xB7EC;&amp;#xB098; &amp;#xC644;&amp;#xD654; &amp;#xAE30;&amp;#xC220;, &amp;#xD2B9;&amp;#xD788; &amp;#xB9CE;&amp;#xC740; &amp;#xC0C8;&amp;#xB85C;&amp;#xC6B4; &amp;#xAE30;&amp;#xB2A5;&amp;#xC744; &amp;#xD3EC;&amp;#xD568;&amp;#xD558;&amp;#xB294; &amp;#xAE30;&amp;#xC220;&amp;#xC758; &amp;#xBC1C;&amp;#xC804;&amp;#xB2E8;&amp;#xACC4;&amp;#xC5D0;&amp;#xB294; &amp;#xBB38;&amp;#xC81C;&amp;#xAC00; &amp;#xBC1C;&amp;#xC0DD;&amp;#xD558;&amp;#xAE30; &amp;#xB9C8;&amp;#xB828;&amp;#xC774;&amp;#xACE0;, &amp;#xC6B0;&amp;#xB9AC;&amp;#xB294; &amp;#xC774; &amp;#xBD84;&amp;#xC57C;&amp;#xC5D0;&amp;#xC11C; &amp;#xB354; &amp;#xB9CE;&amp;#xC740; &amp;#xC5F0;&amp;#xAD6C;&amp;#xAC00; &amp;#xC774;&amp;#xB8E8;&amp;#xC5B4;&amp;#xC9D0;&amp;#xC5D0; &amp;#xB530;&amp;#xB77C; &amp;#xBBF8;&amp;#xB798;&amp;#xC5D0; &amp;#xD765;&amp;#xBBF8;&amp;#xB85C;&amp;#xC6B4; &amp;#xAC83;&amp;#xB4E4;&amp;#xC774; &amp;#xBC1C;&amp;#xACAC;&amp;#xB420; &amp;#xAC83;&amp;#xC774;&amp;#xB77C;&amp;#xACE0; &amp;#xD655;&amp;#xC2E0;&amp;#xD55C;&amp;#xB2E4;.&lt;/p&gt;
 - hack &amp; life">
  <meta property="og:image" content="https://hackyboiz.github.io2021/01/17/l0ch/cet-on-windows/5.png">
  <meta property="og:url" content="https://hackyboiz.github.io/">

  <link rel="canonical" href="https://hackyboiz.github.io/2021/01/17/l0ch/cet-on-windows/">

  <title>[Translation] R.I.P ROP: CET Internals in Windows 20H1 - hackyboiz</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">


  <link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css">
  <link rel="stylesheet" href="/lib/hint/hint.min.css">

  
    
    <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css">
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_6peoq002giu.css">
<link rel="stylesheet" href="/.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">
<link rel="stylesheet" href="/.css">


<link rel="stylesheet" href="/css/main.css">

<!-- 自定义样式保持在最底部 -->


  <script src="/js/utils.js"></script>
  <script src="/js/color-schema.js"></script>

<meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/rss2.xml" title="hackyboiz" type="application/rss+xml">
</head>


<body>
  <header style="height: 40vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>Hackyboiz</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-addrcard"></i>
                About
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/author/">
                <i class="iconfont icon-user-fill"></i>
                Author
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax="true" style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2021-01-17 15:00" pubdate>
      2021년 1월 17일 오후
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      14.8k 자
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      295
       분
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2">
      <!--<script data-ad-client="ca-pub-3672652207808168" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>-->
    </div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">[Translation] R.I.P ROP: CET Internals in Windows 20H1</h1>
                       
            <div class="markdown-body" id="post-body">
              <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>-->
              <!-- hackyboiz_horizen_index -->
              <!--
              <ins class="adsbygoogle"
                   style="display:block"
                   data-ad-client="ca-pub-3672652207808168"
                   data-ad-slot="8887862313"
                   data-ad-format="auto"
                   data-full-width-responsive="true"></ins>
              <script>
                   (adsbygoogle = window.adsbygoogle || []).push({});
              </script>
              -->
              <p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; L0ch&#xC785;&#xB2C8;&#xB2E4;! &#xC9C0;&#xB09C;&#xBC88; Windows Patch Diffing&#xC5D0; &#xC774;&#xC5B4; &#xC774;&#xBC88;&#xC5D4; &#xBC88;&#xC5ED;&#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p>
<p>&#xC624;&#xB298; &#xBC88;&#xC5ED;&#xAE00;&#xC758; &#xC8FC;&#xC81C;&#xB294; &#xC778;&#xD154;&#xC774; &#xB3C4;&#xC785;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xBBF8;&#xD2F0;&#xAC8C;&#xC774;&#xC158;&#xC778; CET&#xC785;&#xB2C8;&#xB2E4;. CET&#xB294; &#xC774;&#xC804;&#xC5D0; &#xC6B0;&#xB9AC; &#xB9C9;&#xB0B4;&#xC778; Fabu1ous&#xC758; <a href="https://hackyboiz.github.io/2020/12/06/fabu1ous/x64-stack-alignment/">x64 stack alignment</a> &#xAE00;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; &#xC7A0;&#xAE50; &#xC5B8;&#xAE09;&#xB418;&#xAE30;&#xB3C4; &#xD588;&#xC5C8;&#xC8E0;? &#xC778;&#xD154;&#xC5D0;&#xC120; &#xC774;&#xBBF8; &#xCC28;&#xC138;&#xB300; &#xBAA8;&#xBC14;&#xC77C; &#xD50C;&#xB7AB;&#xD3FC;&#xC778; Tiger Lake&#xC5D0; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xB0B4;&#xC7A5;&#xD588;&#xC73C;&#xB2C8; &#xACE7; &#xC0C1;&#xC6A9;&#xD654;&#xAC00; &#xBA38;&#xC9C0;&#xC54A;&#xC558;&#xB124;&#xC694;.</p>
<p>&#xCCAB; &#xBC88;&#xC5ED;&#xAE00;&#xC774;&#xB77C; &#xC624;&#xC5ED;&#xACFC; &#xC624;&#xD0C0;&#xAC00; &#xB09C;&#xBB34;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.. &#x3160;&#x3160; &#xBC1C;&#xACAC;&#xD558;&#xC2E0;&#xB2E4;&#xBA74; &#xAC00;&#xCC28; &#xC5C6;&#xC774; &#xC9C0;&#xC801;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xAC10;&#xC0AC;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p>
<blockquote>
<p> &#xC6D0;&#xBB38; &#xAE00; : <a target="_blank" rel="external nofollow noopener noreferrer" href="https://windows-internals.com/cet-on-windows/">R.I.P ROP: CET Internals in Windows 20H1</a> </p>
</blockquote>
<h2 id="&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;"><a href="#&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;" class="headerlink" title="&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;"></a>&#xB4E4;&#xC5B4;&#xAC00;&#xBA70;</h2><p>&#xCD5C;&#xADFC; Windows 10&#xC758; 19H1(Version 1903) &#xB9B4;&#xB9AC;&#xC988; &#xBC84;&#xC804;&#xC5D0; &#xB9E4;&#xC6B0; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xC77C;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xB2E4;. &#xC778;&#xD154; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://software.intel.com/sites/default/files/managed/4d/2a/control-flow-enforcement-technology-preview.pdf">CET(Control-flow Enforcement Technology)</a> &#xAD6C;&#xD604;&#xC774; &#xC218;&#xB144;&#xAC04;&#xC758; &#xB17C;&#xC758; &#xB05D;&#xC5D0; &#xC2DC;&#xC791;&#xB41C; &#xAC83;&#xC774;&#xB2E4;.</p>
<p>&#xC774;&#xB7EC;&#xD55C; CET &#xC801;&#xC6A9;&#xC740; &#xBAA8;&#xB4E0; &#xBC84;&#xC804;&#xC758; Windows &#xB9B4;&#xB9AC;&#xC988;&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xC791;&#xB144;(2020) &#xB9B4;&#xB9AC;&#xC2A4;&#xC778; 20H1 (&#xBC84;&#xC804; 2004)&#xC740; Intel Tiger Lake CPU&#xC5D0;&#xC11C; &#xB9B4;&#xB9AC;&#xC988; &#xB420; CET&#xC758; user mode shadow stack &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC6D0;&#xC744; &#xC644;&#xB8CC;&#xD588;&#xB2E4;.</p>
<p>&#xC778;&#xD154; CET&#xB294; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0;&#xC11C; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xC720;&#xD615;&#xC758; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBB34;&#xACB0;&#xC131; &#xC704;&#xBC18;&#xC778; forward-edge &#xC704;&#xBC18; (indirect CALL &#xBC0F; JMP)&#xACFC; backward-edge &#xC704;&#xBC18; (RET)&#xC744; &#xD574;&#xACB0;&#xD558;&#xB294; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xAE30;&#xBC18; mitigation&#xC774;&#xB2E4;.</p>
<p>forward-edge &#xAD6C;&#xD604;&#xC740; &#xC0C8;&#xB86D;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; (&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; Microsoft&#xC758; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.microsoft.com/en-us/windows/win32/secbp/control-flow-guard">Control Flow Guard</a>&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xD615;&#xD0DC;&#xC758; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://clang.llvm.org/docs/ControlFlowIntegrity.html">clang-cfi</a>&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xB2E4;.) backward-edge &#xAD6C;&#xD604;&#xC740; ISA&#xC758; &#xADFC;&#xBCF8;&#xC801;&#xC778; &#xBCC0;&#xD654;&#xC5D0; &#xC758;&#xC874;&#xD55C;&#xB2E4;. Shadow Stack &#xC740; CALL &#xBA85;&#xB839;&#xC5B4;&#xC5D0; &#xC758;&#xD574; &#xC2A4;&#xD0DD;&#xC5D0; &#xD478;&#xC2DC;&#xB41C; &#xBC18;&#xD658; &#xC8FC;&#xC18C;&#xB97C; &#xBCF5;&#xC81C;&#xD558;&#xBA70;, RET &#xBA85;&#xB839;&#xC5B4; &#xC2E4;&#xD589; &#xC2DC; &#xC2A4;&#xD0DD; &#xBC0F; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xAC12;&#xC744; &#xBAA8;&#xB450; &#xD655;&#xC778;&#xD558;&#xACE0; &#xBD88;&#xC77C;&#xCE58; &#xC2DC; INT #21 (&#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBCF4;&#xD638; &#xC624;&#xB958;)&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;.</p>
<p>&#xC6B4;&#xC601; &#xCCB4;&#xC81C; &#xBC0F; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB294; CALL&#xACFC; RET &#xC774;&#xC678;&#xC758; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xC2DC;&#xD000;&#xC2A4;(&#xC608; : &#xC608;&#xC678; &#xD574;&#xC81C; &#xBC0F; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.cppreference.com/w/cpp/utility/program/longjmp">longjmp</a>)&#xB97C; &#xC9C0;&#xC6D0;&#xD574;&#xC57C; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2DC;&#xC2A4;&#xD15C; &#xC218;&#xC900;&#xC5D0;&#xC11C; &#xD544;&#xC694;&#xD55C; &#xB3D9;&#xC791;&#xACFC; &#xC77C;&#xCE58;&#xD558;&#xB3C4;&#xB85D; <code>Shadow Stack Pointer(SSP)</code> &#xB97C; &#xC870;&#xC791;&#xD574;&#xC57C; &#xD558;&#xBA70;, &#xC774; &#xC870;&#xC791; &#xC790;&#xCCB4;&#xAC00; &#xC7A0;&#xC7AC;&#xC801;&#xC778; &#xC6B0;&#xD68C;&#xAC00; &#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xAC80;&#xC99D;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0;&#xC11C;&#xB294; Windows&#xAC00; &#xC774;&#xB97C; &#xB2EC;&#xC131;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD55C;&#xB2E4;.</p>
<p>Windows&#xAC00; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; shadow stack&#xC744; &#xC870;&#xC791;&#xD558;&#xACE0; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC790;&#xC138;&#xD788; &#xC54C;&#xC544;&#xBCF4;&#xAE30; &#xC804;&#xC5D0; &#xBA3C;&#xC800; &#xB450; &#xAC00;&#xC9C0;&#xB97C; &#xC774;&#xD574;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8;&#xB294; SSP&#xC758; &#xC2E4;&#xC81C; &#xC704;&#xCE58; &#xBC0F; &#xAD8C;&#xD55C;&#xC774;&#xACE0; &#xB450; &#xBC88;&#xC9F8;&#xB294; SSP&#xC2A4;&#xB808;&#xB4DC; &#xAC04; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC804;&#xD658; &#xC2DC; &#xC800;&#xC7A5;/&#xBCF5;&#xC6D0;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xACFC; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xC6B0; (&#xC608; : &#xC608;&#xC678; &#xD574;&#xC81C; &#xC911;)  SSP &#xC218;&#xC815;&#xC774; &#xC218;&#xD589;&#xB418;&#xB294; &#xBC29;&#xBC95;&#xC774;&#xB2E4;.</p>
<p>&#xC774;&#xB7EC;&#xD55C; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC124;&#xBA85;&#xD558;&#xB824;&#xBA74; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Advanced_Vector_Extensions">AVX(Advanced Vector eXtensions)</a> &#xBA85;&#xB839;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD574; Intel&#xC5D0;&#xC11C; &#xB3C4;&#xC785;&#xD558;&#xACE0; Windows 7&#xBD80;&#xD130; Microsoft&#xAC00; &#xC9C0;&#xC6D0;&#xD55C; Intel CPU &#xAE30;&#xB2A5;&#xC744; &#xC54C;&#xC544;&#xBD10;&#xC57C; &#xD55C;&#xB2E4;. &#xB610;&#xD55C; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xAE30;&#xC874; CONTEXT&#xAD6C;&#xC870;&#xB97C; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; CONTEXT_EX&#xAD6C;&#xC870;&#xB85C; &#xC7AC;&#xAD6C;&#xC131;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD55C; native API&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xAC83;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB3C4; &#xC774;&#xC57C;&#xAE30;&#xD574;&#xC57C; &#xD55C;&#xB2E4;!</p>
<p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; Windows&#xC758; CET &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xB2E4;&#xB8E8;&#xAE30; &#xC704;&#xD574; &#xC77C;&#xBD80; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xBC0F; PE &#xD30C;&#xC77C; &#xD3EC;&#xB9F7;&#xC758; &#xB0B4;&#xBD80;&#xC640; &#xC0C8;&#xB85C;&#xC6B4; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC815;&#xBCF4; &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xC0B4;&#xD3B4;&#xBD10;&#xC57C; &#xD55C;&#xB2E4;. &#xC774; &#xAE00;&#xC758; &#xBAA9;&#xCC28;&#xAC00; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xB0B4;&#xC6A9;&#xC744; &#xD0D0;&#xC0C9;&#xD558;&#xB294; &#xB370; &#xB3C4;&#xC6C0;&#xC774;&#xB418;&#xAE30;&#xB97C; &#xBC14;&#xB780;&#xB2E4;. &#xB610;&#xD55C; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research">&#xAD00;&#xB828; GitHub &#xC800;&#xC7A5;&#xC18C;</a>&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD568;&#xC218; &#xC774;&#xB984;&#xC744; &#xD074;&#xB9AD;&#xD558;&#xBA74; &#xC0C8;&#xB85C; &#xB3C4;&#xC785;&#xB41C; &#xB2E4;&#xC591;&#xD55C; &#xD568;&#xC218;&#xC5D0; &#xB300;&#xD55C; &#xC8FC;&#xC11D;&#xC774; &#xB2EC;&#xB9B0; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p>
<h1 id="XState-&#xB0B4;&#xBD80;"><a href="#XState-&#xB0B4;&#xBD80;" class="headerlink" title="XState &#xB0B4;&#xBD80;"></a>XState &#xB0B4;&#xBD80;</h1><p>x86-x64 &#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xD074;&#xB798;&#xC2A4; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xB294; &#xBC94;&#xC6A9; &#xB808;&#xC9C0;&#xC2A4;&#xD130;(RAX, RCX), &#xC81C;&#xC5B4; &#xB808;&#xC9C0;&#xC2A4;&#xD130; (RIP, RSP&#x2026;), &#xBD80;&#xB3D9; &#xC18C;&#xC218;&#xC810; &#xB808;&#xC9C0;&#xC2A4;&#xD130; (XMM, YMM, ZMM)&#xC640; &#xC77C;&#xBD80; &#xC81C;&#xC5B4;, &#xB514;&#xBC84;&#xADF8; &#xBC0F; &#xD14C;&#xC2A4;&#xD2B8; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xB4F1; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xBCF4;&#xC548; &#xC5F0;&#xAD6C;&#xC790;&#xB4E4;&#xC5D0;&#xAC8C; &#xC775;&#xC219;&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC138;&#xD2B8;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xB354; &#xB9CE;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xAE30;&#xB2A5;&#xC774; &#xCD94;&#xAC00;&#xB428;&#xC5D0; &#xB530;&#xB77C; &#xC0C8; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xBC0F; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xD2B9;&#xC815; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xB97C; &#xC815;&#xC758;&#xD574;&#xC57C; &#xD588;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5; &#xC911; &#xB9CE;&#xC740; &#xBD80;&#xBD84;&#xC774; &#xC2A4;&#xB808;&#xB4DC; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC804;&#xD658; &#xC911;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xBCF5;&#xC6D0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p>
<p>&#xC774;&#xC5D0; &#xB300;&#xD55C; &#xD574;&#xACB0;&#xCC45;&#xC73C;&#xB85C; &#xC778;&#xD154;&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xB97C; <code>&#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;</code>&#xC758; &#xBE44;&#xD2B8;&#xC640; &#xC5F0;&#xACB0;&#xD558;&#xACE0; <code>XSAVE</code> &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xC694;&#xCCAD;&#xB41C; &#xC0C1;&#xD0DC;&#xB97C; &#xC77D;&#xACE0; &#xC4F0;&#xAE30; &#xC704;&#xD55C; <code>XSAVE</code> &#xBC0F; <code>XRSTOR</code>&#xC640; &#xAC19;&#xC740; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xB3C4;&#xC785;&#xD558;&#xB294; <code>XState(eXtended State)</code> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developers-manual.pdf">&#xD45C;&#xC900;</a>&#xC744; &#xC815;&#xC758;&#xD588;&#xB2E4;. &#xC774; &#xC601;&#xC5ED;&#xC740; &#xAC01; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; CET &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC800;&#xC7A5;&#xC18C;&#xC758; &#xC911;&#xC694;&#xD55C; &#xBD80;&#xBD84;&#xC774;&#xC9C0;&#xB9CC; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC0AC;&#xB78C;&#xB4E4;&#xC740; &#xAE30;&#xC874; &#xBD80;&#xB3D9; &#xC18C;&#xC218;&#xC810;, AVX &#xBC0F; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://software.intel.com/en-us/articles/introduction-to-intel-memory-protection-extensions">&#xBA54;&#xBAA8;&#xB9AC; &#xBCF4;&#xD638; &#xD655;&#xC7A5;(Memory Protection eXtensions, MPX)</a> &#xAE30;&#xB2A5;&#xC5D0; &#xCD08;&#xC810;&#xC744; &#xB450;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; XSAVE &#xC9C0;&#xC6D0;&#xC744; &#xB300;&#xBD80;&#xBD84; &#xBB34;&#xC2DC;&#xD558;&#xACE0; &#xC788;&#xB2E4;. &#xAE30;&#xB2A5; &#xBC0F; &#xBA54;&#xBAA8;&#xB9AC; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC5D0; &#xB300;&#xD55C; &#xAC1C;&#xC694;&#xB294; &#xB3C5;&#xC790;&#xC5D0;&#xAC8C; &#xB3C4;&#xC6C0;&#xC774; &#xB420; &#xAC83;&#xC774;&#xB2E4;.</p>
<h2 id="XSAVE-&#xC601;&#xC5ED;"><a href="#XSAVE-&#xC601;&#xC5ED;" class="headerlink" title="XSAVE &#xC601;&#xC5ED;"></a>XSAVE &#xC601;&#xC5ED;</h2><p>&#xC55E;&#xC11C; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774; XSAVE &#xC601;&#xC5ED;&#xC740; &#xC6D0;&#xB798; Intel&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0; &#xCD94;&#xAC00; &#xD55C; AVX&#xC640; &#xAC19;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; &#xBD80;&#xB3D9; &#xC18C;&#xC218;&#xC810; &#xAE30;&#xB2A5; &#xC911; &#xC77C;&#xBD80;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC774;&#xC804;&#xC5D0; <code>FXSTOR</code> &#xBC0F; <code>FXRSTR</code> &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xAE30;&#xC874; x86 FPU &#xBC0F; SSE &#xC0C1;&#xD0DC;&#xB97C; &#xD1B5;&#xD569;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xC5C8;&#xB2E4;. &#xC774; &#xCC98;&#xC74C; &#xB450; &#xAC1C;&#xC758; &#xB808;&#xAC70;&#xC2DC; &#xC0C1;&#xD0DC;&#xB294; <code>&#xB808;&#xAC70;&#xC2DC; XSAVE &#xC601;&#xC5ED;</code>&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC815;&#xC758;&#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xCD94;&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; (&#xC608; : AVX)&#xB294; <code>&#xD655;&#xC7A5;&#xB41C; XSAVE &#xC601;&#xC5ED;</code>&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. &#xADF8; &#xC0AC;&#xC774;&#xC5D0; <code>XSAVE &#xC601;&#xC5ED; &#xD5E4;&#xB354;</code> &#xB294; <code>XSTATE_BV</code>&#xB77C;&#xB294; &#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xD1B5;&#xD574; &#xC5B4;&#xB5A4; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xC124;&#xBA85;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p>
<p>&#xB3D9;&#xC2DC;&#xC5D0; XSAVE &#xAE30;&#xB2A5;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xC0C1;&#xD0DC;&#xB97C; &#xC815;&#xC758;&#xD558;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; <code>XCR0(eXtended Control Register)</code>&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC73C;&#xBA70; XCR0&#xC744; &#xAD6C;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD574; <code>XGETBV</code> &#xBC0F; <code>XSETBV</code> &#xBA85;&#xB839;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. (&#xC774;&#xD6C4;&#xC5D0; &#xCD94;&#xAC00;&#xB420; <code>XCR</code>&#xB3C4; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xC774;&#xB2E4;.) &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xB294; x87 FPU &#xBC0F; SSE&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xB2A5; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D;, &#xC989; &#xB808;&#xAC70;&#xC2DC; <code>FXSTOR</code> &#xBA85;&#xB839;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xD655;&#xC7A5;&#xB41C; &#xAE30;&#xB2A5;&#xC758; &#xC0C1;&#xD0DC;&#xB9CC; XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xB3C4;&#xB85D; XCR0&#xC744; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D;&#xD574; &#xC120;&#xD0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p>
<p><code>PKRU(Protection Key Register User State)</code>&#xB97C; &#xCD94;&#xAC00;&#xD55C;  <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.kernel.org/doc/html/latest/core-api/protection-keys.html">MPK(Memory Protection Key)</a>&#xC640; &#xAC19;&#xC740; &#xACE0;&#xAE09; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC138;&#xD2B8; &#xBC0F; &#xAE30;&#xB2A5;&#xC758; &#xC218;&#xAC00; &#xC99D;&#xAC00;&#xD568;&#xC5D0; &#xB530;&#xB77C; &#xCD5C;&#xC2E0; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xB294; <code>XSAVES</code> &#xBC0F; <code>XRSRTORS</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; CPL0 &#xCF54;&#xB4DC;&#xB85C;&#xB9CC; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xC288;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xC0C1;&#xD0DC;&#xC640; &#xC555;&#xCD95; &#xBC0F; &#xCD5C;&#xC801;&#xD654; &#xBC84;&#xC804; (<code>XSAVEC</code> / <code>XSAVEOPT</code>)&#xC73C;&#xB85C; &#xAD6C;&#xBD84;&#xD574; &#xC778;&#xD154;&#xB9CC;&#xC758; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5C8;&#xB2E4;. &#xC288;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xC804;&#xC6A9; &#xC0C1;&#xD0DC;&#xB97C; &#xC815;&#xC758;&#xD558;&#xAE30; &#xC704;&#xD574; <code>IA32_XSS</code>&#xB77C;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; <code>MSR(Model Specific Register)</code>&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/1.png" srcset="/img/loading.gif" alt></p>
<blockquote>
<p>optimized XSAVE &#xC601;&#xC5ED; vs not optimized XSAVE &#xC601;&#xC5ED;<br>(VX &#xBC0F; CET_U&#xAC00; &#xB178;&#xD2B8; &#xD65C;&#xC131;&#xD654;&#xB418;&#xACE0; IPT &#xBC0F; PKRU&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC; &#xB9C8;&#xC9C0;&#xB9C9; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC804;&#xD658; &#xC774;&#xD6C4;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC2A4;&#xB808;&#xB4DC;)</p>
</blockquote>
<p><code>Optimized XSAVE</code> &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC740; &#xB9C8;&#xC9C0;&#xB9C9; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC2A4;&#xC704;&#xCE58; (&#xC788;&#xB294; &#xACBD;&#xC6B0;) &#xC774;&#xD6C4; &#xB2E4;&#xB978; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xC758;&#xD574; &#xC2E4;&#xC81C;&#xB85C; &#xC218;&#xC815;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xB9CC; XSAVE&#xC601;&#xC5ED;&#xC5D0; &#xAE30;&#xB85D;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574; &#xC8FC;&#xBA70; &#xB0B4;&#xBD80; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB294; <code>XINUSE</code>&#xC774; &#xC815;&#xBCF4;&#xB97C; &#xCD94;&#xC801;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574; &#xC900;&#xB2E4;. <code>XSAVEOPT</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; <code>XSTATE_BV</code> &#xB9C8;&#xC2A4;&#xD06C;&#xB294; &#xC694;&#xCCAD;&#xB41C; &#xBAA8;&#xB4E0; &#xC0C1;&#xD0DC;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xC2E4;&#xC81C;&#xB85C; &#xC800;&#xC7A5;&#xB41C; &#xC0C1;&#xD0DC;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xBE44;&#xD2B8;&#xB9CC; &#xD3EC;&#xD568;&#xB41C;&#xB2E4;.</p>
<p>&#xBC18;&#xBA74; <code>Compacted XSAVE</code> &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC740; &#xAE30;&#xC874; XState &#xB514;&#xC790;&#xC778;&#xC758; &#xACB0;&#xD568;&#xC744; &#xC218;&#xC815;&#xD588;&#xB2E4;. <code>AVX512</code> &#xBC0F; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://software.intel.com/content/www/us/en/develop/blogs/processor-tracing.html">IPT(Intel Processor Trace)</a>&#xC640; &#xAC19;&#xC740; &#xB354; &#xB9CE;&#xC740; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC774; &#xCD94;&#xAC00;&#xB428;&#xC5D0; &#xB530;&#xB77C; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xD070; XSAVE&#xC601;&#xC5ED;&#xC744; &#xD560;&#xB2F9;&#xD558;&#xACE0; 0&#xC73C;&#xB85C; &#xAE30;&#xB85D;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. <code>Optimized XSAVE</code>&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xB0AD;&#xBE44;&#xB97C; &#xD53C;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xC5EC;&#xC804;&#xD788; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC740; &#xAE30;&#xBCF8; XSAVE &#xC601;&#xC5ED; &#xBC84;&#xD37C;&#xB85C;&#xBD80;&#xD130; &#xD070; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC788;&#xC74C;&#xC744; &#xC758;&#xBBF8;&#xD55C;&#xB2E4;.</p>
<p><code>XSAVEC</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xD604;&#xC7AC; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xC758;&#xD574; &#xC2E4;&#xC81C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB41C; XState &#xAE30;&#xB2A5;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xACF5;&#xAC04;&#xB9CC; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC800;&#xC7A5;&#xB41C; &#xAC01; &#xC0C1;&#xD0DC;&#xB97C; &#xC21C;&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xBC30;&#xCE58;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xB2E4;. (CPUID&#xB97C; &#xD1B5;&#xD574; <code>&#xC815;&#xB82C; &#xB9C8;&#xC2A4;&#xD06C;</code>&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC81C;&#xACF5;&#xB418;&#xB294; &#xACE0;&#xC815; 64-byte &#xC815;&#xB82C;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;.)</p>
<p>&#xC774;&#xC804;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; XSAVE &#xC601;&#xC5ED; &#xD5E4;&#xB354;&#xB294; &#xB450; &#xBC88;&#xC9F8; &#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;&#xC778; <code>XCOMP_BV</code>&#xB85C; &#xD655;&#xC7A5;&#xB418;&#xC5B4; &#xC694;&#xCCAD;&#xB41C; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8; &#xC911; &#xC5B4;&#xB290; &#xAC83;&#xC774; &#xBE44;&#xAD50; &#xC601;&#xC5ED;&#xC5D0; &#xC788;&#xC744; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xB098;&#xD0C0;&#xB0B8;&#xB2E4;. <code>XSTATE_BV</code>&#xC640; &#xB2EC;&#xB9AC; &#xC774; &#xB9C8;&#xC2A4;&#xD06C;&#xB294; <code>XINUSE</code>&#xC758; &#xC77C;&#xBD80;&#xAC00; &#xC544;&#xB2CC; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xC0DD;&#xB7B5;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xC555;&#xCD95;&#xB420; &#xC218; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xAC00;&#xB2A5;&#xD55C; &#xBE44;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xBBC0;&#xB85C; <code>XSTATE_BV</code>&#xB97C; &#xD1B5;&#xD574; &#xC2E4;&#xC81C;&#xB85C; &#xC5B4;&#xB5A4; &#xC0C1;&#xD0DC; &#xC601;&#xC5ED;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C;, &#xC555;&#xCD95;&#xB41C; &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xC0AC;&#xC6A9;&#xB420; &#xB54C; &#xBE44;&#xD2B8; 63&#xC740; &#xD56D;&#xC0C1; <code>XCOMP_BV</code>&#xC5D0;&#xC11C; XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC2DC;&#xC790;&#xB85C; &#xC124;&#xC815;&#xB41C;&#xB2E4;.</p>
<p>&#xB530;&#xB77C;&#xC11C; &#xC555;&#xCD95;&#xB41C; &#xD3EC;&#xB9F7;&#xC778;&#xC9C0;&#xC5D0; &#xB530;&#xB77C; XSAVE &#xC601;&#xC5ED;&#xC758; &#xB0B4;&#xBD80; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xACFC; &#xD06C;&#xAE30;&#xAC00; &#xACB0;&#xC815;&#xB41C;&#xB2E4;. &#xC555;&#xCD95;&#xB41C; &#xD3EC;&#xB9F7;&#xC740; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB9CC; XSAVE &#xC601;&#xC5ED;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0;, &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD3EC;&#xB9F7;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xAC00; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD574; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xB9CC; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xC544;&#xB798; &#xB2E4;&#xC774;&#xC5B4;&#xADF8;&#xB7A8;&#xC740; &#xB3D9;&#xC77C;&#xD55C; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD574; XSAVE &#xC601;&#xC5ED;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xBCF4;&#xC774;&#xB294;&#xC9C0;, &#xAC01;&#xAC01;&#xC758; &#xD3EC;&#xB9F7;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xB54C;&#xC758; &#xC608;&#xB97C; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/2.png" srcset="/img/loading.gif" alt></p>
<blockquote>
<p>Compacted XSAVE vs not Compacted XSAVE AVX &#xBC0F; CET_U&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC2A4;&#xB808;&#xB4DC;, &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB428;</p>
</blockquote>
<p>&#xC694;&#xC57D;&#xD558;&#xC790;&#xBA74;,  <code>XSAVE</code>&#xC640; <code>XRSTOR</code> &#xBA85;&#xB839;&#xC5B4; &#xC9D1;&#xD569;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC870;&#xD569;&#xACFC; &#xD568;&#xAED8; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p>
<ol>
<li>OS&#xAC00; XCR0&#xC744; &#xC9C0;&#xC6D0;&#xD560; &#xB54C; &#xC124;&#xC815;&#xB418;&#xB294; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8; (<code>XSETBV</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC124;&#xC815;)</li>
<li><code>XSAVE</code> &#xBA85;&#xB839;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xD638;&#xCD9C;&#xC790;&#xAC00; EDX : EAX&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8; (&#xC778;&#xD154;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB97C; <code>instruction mask</code>&#xB77C;&#xACE0; &#xD568;)</li>
<li>&#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0; <code>IA32_XSS</code>&#xC5D0; &#xC124;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;</li>
<li><code>XINUSE</code>&#xC5D0; &#xC124;&#xC815;&#xB41C; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xC778; <code>&#xCD5C;&#xC801;&#xD654;&#xB41C; XSAVE</code>&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C; &#xB9C8;&#xC9C0;&#xB9C9; &#xC804;&#xD658; &#xC774;&#xD6C4; &#xD604;&#xC7AC; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C; &#xC2E4;&#xC81C; XState &#xAD00;&#xB828; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xCD94;&#xC801;&#xD558;&#xB294; &#xB0B4;&#xBD80; &#xB808;&#xC9C0;&#xC2A4;&#xD130;</li>
</ol>
<p>&#xC774;&#xB7EC;&#xD55C; &#xBE44;&#xD2B8;&#xAC00; &#xD568;&#xAED8; &#xB9C8;&#xC2A4;&#xD0B9;&#xB418;&#xBA74; <code>XSAVE</code> &#xBA85;&#xB839;&#xC5D0; &#xC758;&#xD574; <code>XSTATE_BV</code> &#xD544;&#xB4DC;&#xC758; XSAVE &#xC601;&#xC5ED;&#xC758; &#xD5E4;&#xB354;&#xC5D0; &#xCD5C;&#xC885; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xAC00; &#xAE30;&#xB85D;&#xB41C;&#xB2E4;. <code>Compacted XSAVE</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0; <code>XINUSE</code>&#xB97C; &#xC0DD;&#xB7B5;&#xD55C; &#xACB0;&#xACFC; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xAC00;  <code>XCOMP_BV</code> &#xD544;&#xB4DC;&#xC5D0; XSAVE &#xC601;&#xC5ED;&#xC758; &#xD5E4;&#xB354;&#xC5D0; &#xAE30;&#xB85D;&#xB41C;&#xB2E4;. &#xC544;&#xB798; &#xB2E4;&#xC774;&#xC5B4;&#xADF8;&#xB7A8;&#xC740; &#xACB0;&#xACFC; &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/3.png" srcset="/img/loading.gif" alt></p>
<h2 id="XState-&#xAD6C;&#xC131;"><a href="#XState-&#xAD6C;&#xC131;" class="headerlink" title="XState &#xAD6C;&#xC131;"></a>XState &#xAD6C;&#xC131;</h2><p>&#xAC01; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xB294; &#xC790;&#xCCB4;&#xC801;&#xC778; XState &#xD65C;&#xC131;&#xD654; &#xAE30;&#xB2A5;, &#xC608;&#xC0C1;&#xB418;&#xB294; &#xD06C;&#xAE30;, &#xAE30;&#xB2A5; &#xBC0F; &#xBA54;&#xCEE4;&#xB2C8;&#xC998; &#xC138;&#xD2B8;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC5B4; Intel&#xC740; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xAC00; XState&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xCFFC;&#xB9AC; &#xD574;&#xC57C; &#xD558;&#xB294; &#xB2E4;&#xC591;&#xD55C; CPUID &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xC815;&#xBCF4;&#xB97C; &#xB178;&#xCD9C;&#xD55C;&#xB2E4;. Windows&#xB294; &#xBD80;&#xD305; &#xC2DC; &#xC774;&#xB7EC;&#xD55C; &#xCFFC;&#xB9AC;&#xB97C; &#xC218;&#xD589;&#xD558;&#xACE0; <code>XSTATE_CONFIGURATION</code> &#xC544;&#xB798;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xAD6C;&#xC870;&#xC5D0; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;. (Winnt.h&#xC5D0; &#xBB38;&#xC11C;&#xD654;&#xB428;)</p>
<pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">XSTATE_CONFIGURATION</span></span>
<span class="hljs-class">{</span>
    ULONG64 EnabledFeatures;
    ULONG64 EnabledVolatileFeatures;
    ULONG Size;
    <span class="hljs-keyword">union</span>
    {
        ULONG ControlFlags;
        <span class="hljs-class"><span class="hljs-keyword">struct</span></span>
<span class="hljs-class">        {</span>
            ULONG OptimizedSave:<span class="hljs-number">1</span>;
            ULONG CompactionEnabled:<span class="hljs-number">1</span>;
        };
    };
    XSTATE_FEATURE Features[MAXIMUM_XSTATE_FEATURES];
    ULONG64 EnabledSupervisorFeatures;
    ULONG64 AlignedFeatures;
    ULONG AllFeatureSize;
    ULONG AllFeatures[MAXIMUM_XSTATE_FEATURES];
    ULONG64 EnabledUserVisibleSupervisorFeatures;
} XSTATE_CONFIGURATION, *PXSTATE_CONFIGURATION;</code></pre>
<p>&#xC774; &#xB370;&#xC774;&#xD130;&#xB4E4;&#xC744; &#xBCF4;&#xAD00;&#xD55C; &#xD6C4; &#xCEE4;&#xB110;&#xC740; <code>KUSER_SHARED_DATA</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;. &#xC774; &#xAD6C;&#xC870;&#xCCB4;&#xB294; <code>SharedUserData</code> &#xBCC0;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC561;&#xC138;&#xC2A4; &#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xBAA8;&#xB4E0; Windows &#xD50C;&#xB7AB;&#xD3FC;&#xC758; <code>0x7FFE0000</code> &#xC8FC;&#xC18C;&#xC5D0; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;.</p>
<p>Optimized, Compacted XSAVE&#xB97C; &#xBAA8;&#xB450; &#xC9C0;&#xC6D0;&#xD558;&#xACE0; x87 FPU(0), SSE(1), AVX(2) &#xBC0F; MPX(3, 4) &#xAE30;&#xB2A5; &#xBE44;&#xD2B8;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD14C;&#xC2A4;&#xD2B8; <code>19H1</code> &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xCD9C;&#xB825;&#xC744; &#xC608;&#xB85C; &#xB4E4; &#xC218; &#xC788;&#xB2E4;.</p>
<pre><code class="hljs c">dx ((nt!_KUSER_SHARED_DATA*)<span class="hljs-number">0x7ffe0000</span>)-&gt;XState
    [+<span class="hljs-number">0x000</span>] EnabledFeatures  : <span class="hljs-number">0x1f</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]
    [+<span class="hljs-number">0x008</span>] EnabledVolatileFeatures : <span class="hljs-number">0xf</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]
    [+<span class="hljs-number">0x010</span>] Size             : <span class="hljs-number">0x3c0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [+<span class="hljs-number">0x014</span>] ControlFlags     : <span class="hljs-number">0x3</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [+<span class="hljs-number">0x014</span> ( <span class="hljs-number">0</span>: <span class="hljs-number">0</span>)] OptimizedSave    : <span class="hljs-number">0x1</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [+<span class="hljs-number">0x014</span> ( <span class="hljs-number">1</span>: <span class="hljs-number">1</span>)] CompactionEnabled : <span class="hljs-number">0x1</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [+<span class="hljs-number">0x018</span>] Features         [Type: _XSTATE_FEATURE [<span class="hljs-number">64</span>]]
    [+<span class="hljs-number">0x218</span>] EnabledSupervisorFeatures : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]
    [+<span class="hljs-number">0x220</span>] AlignedFeatures  : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]
    [+<span class="hljs-number">0x228</span>] AllFeatureSize   : <span class="hljs-number">0x3c0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [+<span class="hljs-number">0x22c</span>] AllFeatures      [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> [<span class="hljs-number">64</span>]]
    [+<span class="hljs-number">0x330</span>] EnabledUserVisibleSupervisorFeatures : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]</code></pre>
<p>Features &#xBC30;&#xC5F4;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C; 5&#xAC00;&#xC9C0; &#xAE30;&#xB2A5;&#xC758; &#xD06C;&#xAE30;&#xC640; &#xC624;&#xD504;&#xC14B;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p>
<pre><code class="hljs c">dx -r2 (((nt!_KUSER_SHARED_DATA*)<span class="hljs-number">0x7ffe0000</span>)-&gt;XState)-&gt;Features.Take(<span class="hljs-number">5</span>)
    [<span class="hljs-number">0</span>]              [Type: _XSTATE_FEATURE]
        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0xa0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [<span class="hljs-number">1</span>]              [Type: _XSTATE_FEATURE]
        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0xa0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0x100</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [<span class="hljs-number">2</span>]              [Type: _XSTATE_FEATURE]
        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0x240</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0x100</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [<span class="hljs-number">3</span>]              [Type: _XSTATE_FEATURE]
        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0x340</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0x40</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [<span class="hljs-number">4</span>]              [Type: _XSTATE_FEATURE]
        [+<span class="hljs-number">0x000</span>] Offset           : <span class="hljs-number">0x380</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
        [+<span class="hljs-number">0x004</span>] Size             : <span class="hljs-number">0x40</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]</code></pre>
<p>&#xC774; &#xD06C;&#xAE30;&#xB97C; &#xD569;&#xD558;&#xBA74; &#xC704;&#xC758; <code>FeatureSize</code> &#xD544;&#xB4DC;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xAC12;&#xC778; <code>0x3C0</code>&#xC774; &#xB41C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; <code>Compacted XSAVE</code> &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xBBC0;&#xB85C; &#xC5EC;&#xAE30;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xC624;&#xD504;&#xC14B;&#xC740; &#xAD00;&#xB828;&#xC774; &#xC5C6;&#xC73C;&#xBA70; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC9C0;&#xB9CC; &#xC624;&#xD504;&#xC14B;&#xC740; &#xD3EC;&#xD568;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xCEE4;&#xB110;&#xC5D0;&#xB9CC; &#xC720;&#xC6A9;&#xD558;&#xAC8C; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;.(<code>XCOMP_BV</code>&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC555;&#xCD95; &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xACB0;&#xC815;&#xB418;&#xAE30; &#xB54C;&#xBB38;)</p>
<h2 id="XState-&#xC815;&#xCC45;"><a href="#XState-&#xC815;&#xCC45;" class="headerlink" title="XState &#xC815;&#xCC45;"></a>XState &#xC815;&#xCC45;</h2><p>&#xD504;&#xB85C;&#xC138;&#xC11C;&#xAC00; XState&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0;&#xB9CC; &#xB2E4;&#xC591;&#xD55C; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC624;&#xB958; &#xB54C;&#xBB38;&#xC5D0; &#xD2B9;&#xC815; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xAC00; &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xB300;&#xB85C; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC885;&#xC885; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;. &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; Windows&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C;  &#xB77C;&#xACE0; &#xD558;&#xB294; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC815;&#xCC45; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC778; <code>HwPolicy.sys</code> &#xC758; &#xB9AC;&#xC18C;&#xC2A4; &#xC139;&#xC158;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; XState &#xC815;&#xCC45;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.</p>
<p>Intel x86 &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB294; &#xC5EC;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xBCA4;&#xB354; &#xC911; &#xD558;&#xB098;&#xC774;&#xBBC0;&#xB85C; &#xCEE4;&#xB110;&#xC740; XState &#xC815;&#xCC45;&#xC744; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC758; &#xBCA4;&#xB354; &#xBB38;&#xC790;&#xC5F4; &#xBC0F; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xCF54;&#xB4DC; &#xBC84;&#xC804;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;, &#xAE30;&#xB2A5; &#xBC0F; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xACE0; (&#xC989;, CPUID 01h &#xCFFC;&#xB9AC;&#xC758; RAX, RDX &#xBC0F; RCX), &#xC815;&#xCC45;&#xC5D0;&#xC11C; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xD56D;&#xBAA9;&#xC744; &#xCC3E;&#xB294;&#xB2E4;.</p>
<p>&#xC774; &#xC791;&#xC5C5;&#xC740; &#xBD80;&#xD305; &#xC2DC;&#xC5D0; <code>KiInitializeXSave</code>&#xAC00; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>KiIntersectFeaturesWithPolicy</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB41C;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; <code>KiLoadPolicyFromImage</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC801;&#xC808;&#xD55C; XState &#xC815;&#xCC45;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0; <code>KiGetProcessorInformation</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC5EC; CPU&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAC00;&#xC838;&#xC628; &#xB2E4;&#xC74C; XState &#xAD6C;&#xC131;&#xC5D0;&#xC11C; &#xD604;&#xC7AC; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xAC01; &#xAE30;&#xB2A5; &#xBE44;&#xD2B8;&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; <code>KiIsXSaveFeatureAllowed</code> &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</p>
<p>&#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC740; <code>HwPolicy.sys</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; &#xB9AC;&#xC18C;&#xC2A4; 101&#xC5D0;&#xC11C; &#xC791;&#xB3D9;&#xD558;&#xBA70; &#xAD6C;&#xC870;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p>
<pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">XSAVE_POLICY</span></span>
<span class="hljs-class">{</span>
    ULONG Version;
    ULONG Size;
    ULONG Flags;
    ULONG MaxSaveAreaLength;
    ULONGLONG FeatureBitmask;
    ULONG NumberOfFeatures;
    XSAVE_FEATURE Features[<span class="hljs-number">1</span>];
} XSAVE_POLICY, *PXSAVE_POLICY;</code></pre>
<p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;,  <code>19H1</code> &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xB9AC;&#xC18C;&#xC2A4; &#xD574;&#xCEE4;&#xB85C; &#xCD94;&#xCD9C;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p>
<pre><code class="hljs c">dx @$policy = (_XSAVE_POLICY*)<span class="hljs-number">0x253d0e90000</span>
[+<span class="hljs-number">0x000</span>] Version       : <span class="hljs-number">0x3</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
[+<span class="hljs-number">0x004</span>] Size          : <span class="hljs-number">0x2fd8</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
[+<span class="hljs-number">0x008</span>] Flags         : <span class="hljs-number">0x9</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
[+<span class="hljs-number">0x00c</span>] MaxSaveAreaLength : <span class="hljs-number">0x2000</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
[+<span class="hljs-number">0x010</span>] FeatureBitmask   : <span class="hljs-number">0x7fffffffffffffff</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]
[+<span class="hljs-number">0x018</span>] NumberOfFeatures : <span class="hljs-number">0x3f</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
[+<span class="hljs-number">0x020</span>] Features      [Type: _XSAVE_FEATURE [<span class="hljs-number">1</span>]]</code></pre>
<p>&#xAC01; <code>XSAVE_FEATURE</code>&#xC5D0; &#xB300;&#xD574; &#xAC01;&#xAC01; CPU &#xACF5;&#xAE09; &#xC5C5;&#xCCB4; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC788;&#xB294; <code>XSAVE_VENDOR</code> &#xAD6C;&#xC870;&#xC758; &#xBC30;&#xC5F4;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>XSAVE_VENDORS</code> &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xACFC; (&#xC9C0;&#xAE08;&#xC740; &#xAC01;&#xAC01; &#x201C;GenuineIntel&#x201D;, &#x201C;AuthenticAMD&#x201D; &#xB610;&#xB294; &#x201C;CentaurHauls&#x201D;) <code>XSAVE_CPU_ERRATA</code> &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, <code>19H1</code> &#xD14C;&#xC2A4;&#xD2B8; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xB294; &#xAE30;&#xB2A5; 0&#xC5D0; &#xB300;&#xD55C; &#xB2E4;&#xC74C; &#xC815;&#xBCF4;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;.</p>
<pre><code class="hljs c">dx -r4 @$vendor = (XSAVE_VENDORS*)((<span class="hljs-keyword">int</span>)@$policy-&gt;Features[<span class="hljs-number">0</span>].Vendors + <span class="hljs-number">0x253d0e90000</span>)
[+<span class="hljs-number">0x000</span>] NumberOfVendors  : <span class="hljs-number">0x3</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
[+<span class="hljs-number">0x008</span>] Vendor        [Type: _XSAVE_VENDOR [<span class="hljs-number">1</span>]]
    [<span class="hljs-number">0</span>]           [Type: _XSAVE_VENDOR]
        [+<span class="hljs-number">0x000</span>] VendorId      [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> [<span class="hljs-number">3</span>]]
            [<span class="hljs-number">0</span>]           : <span class="hljs-number">0x756e6547</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
            [<span class="hljs-number">1</span>]           : <span class="hljs-number">0x49656e69</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
            [<span class="hljs-number">2</span>]           : <span class="hljs-number">0x6c65746e</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
[+<span class="hljs-number">0x010</span>] SupportedCpu  [Type: _XSAVE_SUPPORTED_CPU]
[+<span class="hljs-number">0x000</span>] CpuInfo       [Type: XSAVE_CPU_INFO]
[+<span class="hljs-number">0x020</span>] CpuErrata     : <span class="hljs-number">0x4c0</span> [Type: XSAVE_CPU_ERRATA *]
[+<span class="hljs-number">0x020</span>] Unused        : <span class="hljs-number">0x4c0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]</code></pre>
<p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C;, &#xAC01; <code>XSAVE_CPU_ERRATA</code> &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xC9C0;&#xC815;&#xB41C; XState &#xC9C0;&#xC6D0;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xB958; &#xC815;&#xBCF4;&#xC640; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC815;&#xBCF4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xD14C;&#xC2A4;&#xD2B8; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xC704;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC5D0;&#xC11C; &#xCCAB; &#xBC88;&#xC9F8; &#xC5D0;&#xB77C;&#xD0C0;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p>
<pre><code class="hljs c">dx -r3 @$errata = (XSAVE_CPU_ERRATA*)((<span class="hljs-keyword">int</span>)@$vendor-&gt;Vendor[<span class="hljs-number">0</span>].SupportedCpu.CpuErrata + <span class="hljs-number">0x253d0e90000</span>)
    [+<span class="hljs-number">0x000</span>] NumberOfErrata   : <span class="hljs-number">0x1</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
    [+<span class="hljs-number">0x008</span>] Errata           [Type: XSAVE_CPU_INFO [<span class="hljs-number">1</span>]]
        [<span class="hljs-number">0</span>]              [Type: XSAVE_CPU_INFO]
            [+<span class="hljs-number">0x000</span>] Processor        : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span>]
            [+<span class="hljs-number">0x002</span>] Family           : <span class="hljs-number">0x6</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span>]
            [+<span class="hljs-number">0x004</span>] Model            : <span class="hljs-number">0xf</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span>]
            [+<span class="hljs-number">0x006</span>] Stepping         : <span class="hljs-number">0xb</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span>]
            [+<span class="hljs-number">0x008</span>] ExtendedModel    : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span>]
            [+<span class="hljs-number">0x00c</span>] ExtendedFamily   : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]
            [+<span class="hljs-number">0x010</span>] MicrocodeVersion : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> __int64]
            [+<span class="hljs-number">0x018</span>] Reserved         : <span class="hljs-number">0x0</span> [Type: <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>]</code></pre>
<p>&#xBAA8;&#xB4E0; XState &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC815;&#xCC45; &#xB364;&#xD504; &#xD234;&#xC740; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/tree/master/Xpolicy">&#xC5EC;&#xAE30;</a>&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC9C0;&#xAE08;&#xC740; &#xC804;&#xCCB4; &#xC815;&#xCC45;(&#xC704;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xAC83;)&#xC5D0; &#xD558;&#xB098;&#xC758; &#xC5D0;&#xB77C;&#xD0C0;&#xB9CC; &#xB098;&#xD0C0;&#xB09C;&#xB2E4;.</p>
<p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xB2E4;&#xC74C; &#xC635;&#xC158; &#xB85C;&#xB354; &#xBA85;&#xB839;&#xC904; &#xC635;&#xC158;(&#xBC0F; &#xAC01; BCD &#xC124;&#xC815;)&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; XState &#xAE30;&#xB2A5;&#xC744; &#xCD94;&#xAC00;&#xB85C; &#xCEE4;&#xC2A4;&#xD130;&#xB9C8;&#xC774;&#xC9D5;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;.</p>
<ol>
<li><code>XSAVEPOLICY = n</code> &#xB85C;&#xB4DC; &#xC635;&#xC158;&#xC740; <code>xsavepolicy</code> BCD &#xC635;&#xC158;&#xC744; &#xD1B5;&#xD574; &#xC124;&#xC815;&#xB418;&#xBA70; <code>KeXSavePolicyId</code>&#xB97C; &#xC124;&#xC815;&#xD558;&#xC5EC; &#xB85C;&#xB4DC;&#xD560; XState &#xC815;&#xCC45;&#xC744; &#xB098;&#xD0C0;&#xB0B8;&#xB2E4;.</li>
<li><code>XSAVEREMOVEFEATURE = n</code>&#xB85C;&#xB4DC; &#xC635;&#xC158;&#xC740; <code>xsaveremovefeature</code> BCD&#xC635;&#xC158;&#xC744; &#xD1B5;&#xD574; &#xC124;&#xC815;&#xB418;&#xBA70; <code>KeTestRemovedFeatureMask</code> &#xB97C; &#xC124;&#xC815;&#xD55C;&#xB2E4;. &#xC774;&#xB294; &#xB098;&#xC911;&#xC5D0; <code>KiInitializeXSave</code>&#xC5D0; &#xC758;&#xD574; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xB418;&#xACE0; &#xC9C0;&#xC815;&#xB41C; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xC81C;&#xAC70;&#xD55C;&#xB2E4;. &#xC0C1;&#xD0DC; 0 (x87 FPU) &#xBC0F; &#xC0C1;&#xD0DC; 1 (SSE)&#xC740; &#xC774; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC81C;&#xAC70;&#xD560; &#xC218; &#xC5C6;&#xB2E4;.</li>
<li><code>XSAVEDISABLE</code> &#xB85C;&#xB4DC; &#xC635;&#xC158;&#xC740; <code>xsavedisable</code> BCD &#xC635;&#xC158;&#xC744; &#xD1B5;&#xD574; &#xC124;&#xC815;&#xB418;&#xC5B4; <code>KeTestDisableXsave</code>&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; <code>KiInitializeXSave</code>&#xAC00; &#xBAA8;&#xB4E0; XState &#xAD6C;&#xC131; &#xB370;&#xC774;&#xD130;&#xB97C; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xC5EC; &#xC804;&#xCCB4; XState &#xAE30;&#xB2A5;&#xC744; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD55C;&#xB2E4;.</li>
</ol>
<h2 id="CET-XSAVE-&#xC601;&#xC5ED;-&#xD3EC;&#xB9F7;"><a href="#CET-XSAVE-&#xC601;&#xC5ED;-&#xD3EC;&#xB9F7;" class="headerlink" title="CET XSAVE &#xC601;&#xC5ED; &#xD3EC;&#xB9F7;"></a>CET XSAVE &#xC601;&#xC5ED; &#xD3EC;&#xB9F7;</h2><p>CET &#xAD6C;&#xD604;&#xC758; &#xC77C;&#xD658;&#xC73C;&#xB85C; Intel&#xC740; <code>XSTATE_CET_U(11)</code>&#xC640; <code>XSTATE_CET_S(12)</code>&#xB77C;&#xACE0; &#xD558;&#xB294; &#xB450; &#xAC1C;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xBE44;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xC790; &#xBC0F; &#xC288;&#xD37C;&#xBC14;&#xC774;&#xC800; &#xC0C1;&#xD0DC;&#xC5D0; &#xAC01;&#xAC01; &#xB300;&#xC751;&#xD558;&#xB3C4;&#xB85D; &#xC815;&#xC758;&#xD588;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xC0C1;&#xD0DC;&#xB294; <code>XSAVE_CET_U_FORMAT</code>&#xC73C;&#xB85C; &#xBB38;&#xC11C;&#xD654;&#xB41C; 16&#xBC14;&#xC774;&#xD2B8; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xB85C;, <code>IA32_U_CET</code> MSR(<code>Shadow Stack Enable</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xAD6C;&#xC131;&#xB41C; &#xACBD;&#xC6B0;) &#xBC0F; <code>IA32_PL3_SSPMSR</code> (Privile 3 &#xC218;&#xC900;)&#xC744; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;. &#xC544;&#xC9C1; MSDN &#xC815;&#xC758;&#xAC00; &#xC5C6;&#xB294; &#xB450; &#xBC88;&#xC9F8; &#xBC29;&#xBC95;&#xC740; <code>IA32_PL0/1/2_SSP</code> MSR&#xC744; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;.</p>
<pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">XSAVE_CET_U_FORMAT</span></span>
<span class="hljs-class">{</span>
    ULONG64 Ia32CetUMsr;
    ULONG64 Ia32Pl3SspMsr;
} XSAVE_CET_U_FORMAT, *PXSAVE_CET_U_FORMAT;

<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">XSAVE_CET_S_FORMAT</span></span>
<span class="hljs-class">{</span>
    ULONG64 Ia32Pl0SspMsr;
    ULONG64 Ia32Pl1SspMsr;
    ULONG64 Ia32Pl2SspMsr;
} XSAVE_CET_S_FORMAT, *PXSAVE_CET_S_FORMAT;</code></pre>
<p>&#xD544;&#xB4DC; &#xC774;&#xB984;&#xC5D0;&#xC11C; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774; CET &#xAD00;&#xB828; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB294; &#xC2E4;&#xC81C;&#xB85C; &#xAC01; MSR&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xAC12;&#xC774;&#xBA70;, &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; Ring 0&#xC758; RDMSR &#xBC0F; WRMSR &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574;&#xC11C;&#xB9CC; &#xC561;&#xC138;&#xC2A4; &#xD560; &#xC218; &#xC788;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC804;&#xC5ED; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB300;&#xBD80;&#xBD84;&#xC758; MSR&#xACFC; &#xB2EC;&#xB9AC; CET&#xB294; &#xC2A4;&#xB808;&#xB4DC; &#xB2E8;&#xC704;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; Shadow stack pointer&#xB3C4; &#xC2A4;&#xB808;&#xB4DC; &#xB2E8;&#xC704;&#xB85C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC774;&#xC720;&#xB85C; CET &#xAD00;&#xB828; &#xB370;&#xC774;&#xD130;&#xB294; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xAC00; &#xC2A4;&#xB808;&#xB4DC; &#xC2A4;&#xC704;&#xCE58;&#xB97C; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xCC98;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; XState &#xAE30;&#xB2A5;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</p>
<p>CET &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xCEE4;&#xB110; &#xCF54;&#xB4DC;&#xB85C;&#xB9CC; &#xC218;&#xC815; &#xAC00;&#xB2A5;&#xD55C; MSR&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>CPL3 XSAVE/XRSTOR</code> &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC73C;&#xBA70; &#xAC01;&#xAC01;&#xC758; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB294; <code>IA32_XSS</code> MSR&#xC5D0;&#xC11C; &#xD56D;&#xC0C1; 1&#xB85C; &#xC124;&#xC815;&#xB41C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xAC00; &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC758; &#xCF54;&#xB4DC;&#xAC00; SSP&#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC644;&#xC804;&#xD788; &#xCC28;&#xB2E8;&#xD560; &#xC218;&#xB294; &#xC5C6;&#xB2E4;. &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC758; &#xCF54;&#xB4DC;&#xB294; &#xC608;&#xC678; &#xCC98;&#xB9AC;, unwinding, jmp/longjmp &#xB610;&#xB294; Windows&#xC758; <code>Fiber</code> &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xACFC; &#xAC19;&#xC740; &#xD2B9;&#xC815; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD574; SSP&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p>
<p>&#xB530;&#xB77C;&#xC11C; Windows&#xAC00; CS &#xBC0F; DR7&#xACFC; &#xAC19;&#xC740; &#xD2B9;&#xC815; &#xBCF4;&#xD638;&#xB41C; CPU &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB294; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC73C;&#xB85C; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadcontext">SetThreadContext</a>&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xB294; &#xC2A4;&#xB808;&#xB4DC;&#xAC00; &#xC2DC;&#xC2A4;&#xD15C; &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; XSate&#xC5D0;&#xC11C; CET &#xC0C1;&#xD0DC;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC81C;&#xACF5;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C;&#xB294; XState &#xAD00;&#xB828; &#xC815;&#xBCF4;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD604;&#xB300;&#xC758; Windows &#xBC84;&#xC804;&#xC5D0;&#xC11C; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-wow64_context">CONTEXT</a> &#xAD6C;&#xC870;&#xAC00; CONTEXT_EX &#xAD6C;&#xC870;&#xB85C; &#xC5B4;&#xB5BB;&#xAC8C; &#xBC1C;&#xC804;&#xD588;&#xB294;&#xC9C0;, &#xADF8;&#xB9AC;&#xACE0; &#xC608;&#xC678; &#xAD00;&#xB828; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xC5D0; &#xB300;&#xD574; CET &#xAD00;&#xB828; &#xCC98;&#xB9AC;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xB3D9;&#xC2DC;&#xC5D0; &#xC190;&#xC0C1;&#xB41C; CONTEXT&#xB97C; &#xD1B5;&#xD55C; &#xC545;&#xC758;&#xC801;&#xC778; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xACF5;&#xACA9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF8;&#xB2E4;.</p>
<h1 id="CONTEXT-EX-&#xB0B4;&#xBD80;"><a href="#CONTEXT-EX-&#xB0B4;&#xBD80;" class="headerlink" title="CONTEXT_EX &#xB0B4;&#xBD80;"></a>CONTEXT_EX &#xB0B4;&#xBD80;</h1><p>&#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC2A4;&#xC704;&#xCE58;&#xB97C; &#xD560; &#xB54C; &#xC800;&#xC7A5;&#xD574;&#xC57C; &#xD558;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC758; &#xC218;&#xAC00; &#xC810;&#xC810; &#xB298;&#xC5B4;&#xB098;&#xACE0;, &#xC774;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xBC84;&#xC804;&#xC758; Windows&#xB294; &#xB808;&#xAC70;&#xC2DC; CONTEXT &#xAD6C;&#xC870; &#xC678;&#xC5D0;&#xB3C4; CONTEXT_EX &#xAD6C;&#xC870;&#xB97C; &#xB3C4;&#xC785;&#xD588;&#xB2E4;. CONTEXT_EX&#xB294; &#xB808;&#xAC70;&#xC2DC; CONTEXT&#xAC00; &#xACE0;&#xC815; &#xD06C;&#xAE30;&#xC778; &#xBC18;&#xBA74; XSAVE&#xB294; &#xC2A4;&#xB808;&#xB4DC;, &#xD504;&#xB85C;&#xC138;&#xC11C; &#xBC0F; &#xC2DC;&#xC2A4;&#xD15C; &#xAD6C;&#xC131; &#xC815;&#xCC45;&#xC5D0; &#xB530;&#xB77C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xD06C;&#xAE30;&#xAC00; &#xC870;&#xC815;&#xB418;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC; &#xAD6C;&#xC870;&#xAC00; &#xD544;&#xC694;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xB2E4;.</p>
<h2 id="CONTEXT-EX-&#xAD6C;&#xC870;"><a href="#CONTEXT-EX-&#xAD6C;&#xC870;" class="headerlink" title="CONTEXT_EX &#xAD6C;&#xC870;"></a>CONTEXT_EX &#xAD6C;&#xC870;</h2><p>CONTEXT_EX&#xB294; &#xD604;&#xC7AC; &#xCEE4;&#xB110; &#xBC0F; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC608;&#xC678; &#xCC98;&#xB9AC; &#xAE30;&#xB2A5; &#xC804;&#xCCB4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0;&#xB9CC; CONTEXT_EX &#xAD6C;&#xC870;&#xC758; &#xB300;&#xBD80;&#xBD84;&#xC740; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;. Windows 7 &#xD5E4;&#xB354; &#xD30C;&#xC77C; &#xBC0F; &#xC77C;&#xBD80; intel&#xC758; reference code&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC77C;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xC2E4;&#xC218;&#xB85C; &#xACF5;&#xAC1C;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xD588;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB2E4;. &#xB2E4;&#xC74C; &#xCF54;&#xB4DC;&#xC758; &#xC8FC;&#xC11D;&#xC744; &#xBCF4;&#xACE0; &#xC774;&#xD574;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xC54C;&#xB824;&#xC8FC;&#xC5C8;&#xC73C;&#xBA74; &#xD55C;&#xB2E4;.</p>
<pre><code class="hljs c"><span class="hljs-comment">//</span>
<span class="hljs-comment">// &#xC774; &#xAD6C;&#xC870;&#xCCB4;&#xB294; CONTEXT_EX&#xC758; &#xB2E8;&#xC77C; &#xCCAD;&#xD06C; &#xD06C;&#xAE30;&#xC640; &#xC624;&#xD504;&#xC14B;(CONTEXT_EX &#xAD6C;&#xC870; &#xC2DC;&#xC791;&#xBD80;&#xD130;)&#xC744; &#xC9C0;&#xC815;&#xD55C;&#xB2E4;.</span>
<span class="hljs-comment">// N.B. &#xC624;&#xD504;&#xC14B;&#xC740; &#xC74C;&#xC218;&#xC77C; &#xC218; &#xC788;&#xB2E4;.</span>
<span class="hljs-comment">//</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CONTEXT_CHUNK</span></span>
<span class="hljs-class">{</span>
    LONG Offset;
    DWORD Length;
} CONTEXT_CHUNK, *PCONTEXT_CHUNK;

<span class="hljs-comment">// CONTEXT_EX &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xB294; CONTEXT &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xD655;&#xC7A5;&#xC774;&#xB2E4;. </span>
<span class="hljs-comment">// &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xB808;&#xCF54;&#xB4DC;&#xB97C; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xC758; &#xC77C;&#xBD80;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xBD84;&#xB9AC;&#xB41C; &#xAC00;&#xBCC0;&#xD06C;&#xAE30; &#xBC84;&#xD37C;(&#xCCAD;&#xD06C;) &#xC138;&#xD2B8;&#xB85C; </span>
<span class="hljs-comment">// &#xC815;&#xC758;&#xD55C;&#xB2E4;. &#xD604;&#xC7AC; &#xB450; &#xAC1C;&#xC758; &#xBC84;&#xD37C;(&#xCCAD;&#xD06C;)&#xB9CC; &#xC815;&#xC758;&#xB41C;&#xB2E4;:</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// - &#xAE30;&#xC874; CONTEXT &#xAD6C;&#xC870;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB808;&#xAC70;&#xC2DC;</span>
<span class="hljs-comment">// - XSAVE &#xC800;&#xC7A5; &#xC601;&#xC5ED; &#xBC84;&#xD37C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; XState</span>
<span class="hljs-comment">// XSAVE_AREA_HEADER, i.e. without the first 512 bytes.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// PCONTEXT &#xD3EC;&#xC778;&#xD130;&#xB97C; PCONTEXT_EX &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xAC00;&#xC815;&#xC774; &#xC788;&#xB2E4;.</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// 1. PCONTEXT &#xD3EC;&#xC778;&#xD130;&#xC640; &#xD568;&#xAED8; &#xC791;&#xB3D9;&#xD558;&#xB294; API&#xB294; CONTEXT_EX&#xAC00; CONTEXT &#xAD6C;&#xC870; &#xBC14;&#xB85C; &#xB4A4;&#xC5D0; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;&#xACE0; &#xAC00;&#xC815;</span>
<span class="hljs-comment">//    &#xB610;&#xD55C; CONTEXT_EX&#xB294; &#xD574;&#xB2F9; CONTEXT_XXX &#xD50C;&#xB798;&#xADF8;&#xAC00; CONTEXT.ContextFlags&#xC5D0; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xACE0; &#xAC00;&#xC815;</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// 2. CONTEXT_EX &#xAD6C;&#xC870;&#xAC00; &#xC788;&#xC73C;&#xBA74; &#xB808;&#xAC70;&#xC2DC;&#xAC00; &#xD56D;&#xC0C1; &#xC874;&#xC7AC;</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// 3. CONTEXT.ContextFlags&#xB294; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xCCAD;&#xD06C;&#xB97C; &#xC815;&#xC758;</span>
<span class="hljs-comment">//    &#xC989; CONTEXT_XSTATE&#xAC00; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xC6B0; CONTEXT_EX.XState&#xAC00; &#xC720;&#xD6A8;&#xD558;&#xB2E4;.</span>
<span class="hljs-comment">//</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CONTEXT_EX</span></span>
<span class="hljs-class">{</span>
    <span class="hljs-comment">//</span>
    <span class="hljs-comment">// &#xC624;&#xD504;&#xC14B;&#xC774; &#xAC00;&#xC7A5; &#xC791;&#xC740; &#xCCAD;&#xD06C;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xCD1D; &#xD06C;&#xAE30;</span>
    <span class="hljs-comment">// N.B. &#xC624;&#xD504;&#xC14B;&#xC740; &#xC74C;&#xC218;&#xC77C; &#xC218; &#xC788;&#xB2E4;.</span>
    <span class="hljs-comment">//</span>
    CONTEXT_CHUNK All;

    <span class="hljs-comment">// </span>
    <span class="hljs-comment">// &#xAE30;&#xC874;&#xC758; CONTEXT &#xAD6C;&#xC870; wrapper</span>
    <span class="hljs-comment">// N.B. &#xCCAD;&#xD06C;&#xC758; &#xD06C;&#xAE30;&#xB294; sizeof(CONTEXT) &#xBCF4;&#xB2E4; &#xC791;&#xC744; &#xC218; &#xC788;&#xB2E4;.</span>
    <span class="hljs-comment">// (CONTEXT_EXTENDED_REGISTERS&#xAC00; x86&#xC5D0; &#xC124;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0;).    </span>
		<span class="hljs-comment">// CONTEXT_CHUNK Legacy;</span>
    <span class="hljs-comment">//</span>

	  <span class="hljs-comment">// CONTEXT_XSTATE : &#xD655;&#xC7A5;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC; &#xCCAD;&#xD06C;. &#xC0C1;&#xD0DC; &#xC800;&#xC7A5;&#xC740; &#xB3D9;&#xC77C;&#xD55C; &#xD615;&#xC2DD; </span>
	  <span class="hljs-comment">// XSAVE &#xC791;&#xC5C5;&#xC740; &#xCC98;&#xC74C; 512 &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xC81C;&#xC678;&#xD558;&#xACE0; XSAVE_AREA_HEADER&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD55C;&#xB2E4;. </span>
		<span class="hljs-comment">// FP &#xBC0F; SSE &#xC0C1;&#xD0DC;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xD558;&#xC704; 2 &#xBE44;&#xD2B8;&#xB294; 0&#xC774;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</span>
    <span class="hljs-comment">// CONTEXT_CHUNK XState;</span>
} CONTEXT_EX, *PCONTEXT_EX;

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CONTEXT_EX_LENGTH ALIGN_UP_BY(sizeof(CONTEXT_EX), STACK_ALIGN)</span>

<span class="hljs-comment">//</span>
<span class="hljs-comment">// &#xC774; &#xB9E4;&#xD06C;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xCCAD;&#xD06C;&#xB97C; &#xB354; &#xC27D;&#xAC8C; &#xC870;&#xC791; &#xAC00;&#xB2A5;</span>
<span class="hljs-comment">//</span></code></pre>
<p>&#xB530;&#xB77C;&#xC11C; &#xC774; &#xD5E4;&#xB354;&#xB85C; CONTEXT_EX &#xAD6C;&#xC870;&#xC758; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC744; &#xC774;&#xD574;&#xD558;&#xACE0; &#xC2DC;&#xAC01;&#xD654;&#xD560; &#xC218; &#xC788;&#xC744; &#xB54C;&#xAE4C;&#xC9C0; &#xC5EC;&#xB7EC; &#xCC28;&#xB840; &#xC2DC;&#xB3C4;&#xB97C; &#xD588;&#xACE0; &#xB2E4;&#xC74C; &#xB2E4;&#xC774;&#xC5B4;&#xADF8;&#xB7A8;&#xC774; &#xB3C4;&#xC6C0;&#xC774; &#xB420; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xB290;&#xAF08;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/4.png" srcset="/img/loading.gif" alt></p>
<p>&#xB2E4;&#xC774;&#xC5B4;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; CONTEXT<em>EX &#xAD6C;&#xC870;&#xB294; &#xD56D;&#xC0C1; CONTEXT &#xAD6C;&#xC870;&#xC758; &#xB05D;&#xC5D0; &#xC788;&#xC73C;&#xBA70; &#xB808;&#xAC70;&#xC2DC; &#xBC0F; XState&#xB77C;&#xB294; <code>CONTEXT_CHUNK</code> &#xC720;&#xD615;&#xC758; 3&#xAC1C; &#xD544;&#xB4DC;&#xAC00; &#xC788;&#xB2E4;. &#xC774;&#xB4E4;&#xC740; &#xC624;&#xD504;&#xC14B;&#xACFC; &#xB370;&#xC774;&#xD130;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC815;&#xC758;&#xD558;&#xACE0; &#xC801;&#xC808;&#xD55C; &#xB370;&#xC774;&#xD130; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xB2E4;&#xC591;&#xD55C; `RTL</em>` &#xB9E4;&#xD06C;&#xB85C;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;.</p>
<p>Legacy &#xD544;&#xB4DC;&#xB294; &#xAE30;&#xC874; CONTEXT &#xAD6C;&#xC870;&#xC758; &#xC2DC;&#xC791;&#xC744; &#xCC38;&#xC870;&#xD55C;&#xB2E4;. (<code>CONTEXT_EXTENDED_REGISTERS</code>&#xAC00; &#xC81C;&#xACF5;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; x86&#xC5D0;&#xC11C; &#xD06C;&#xAE30;&#xAC00; &#xB354; &#xC791;&#xC744; &#xC218; &#xC788;&#xC74C;) <code>All</code> &#xD544;&#xB4DC;&#xB294; &#xAE30;&#xC874; CONTEXT &#xAD6C;&#xC870;&#xC758; &#xC2DC;&#xC791;&#xC744; &#xCC38;&#xC870;&#xD558;&#xC9C0;&#xB9CC; Length&#xB294; CONTEXT_EX&#xC640; XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xD328;&#xB529;/&#xC815;&#xB82C; &#xACF5;&#xAC04;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xC5EC; &#xBAA8;&#xB4E0; &#xB370;&#xC774;&#xD130;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xB098;&#xD0C0;&#xB0B8;&#xB2E4;. &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; <code>XState</code> &#xD544;&#xB4DC;&#xB294; <code>XSAVE_AREA_HEADER</code> &#xAD6C;&#xC870; (&#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xB294; &#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xC815;&#xC758;&#xD568;)&#xC640; &#xC804;&#xCCB4; XSAVE &#xC601;&#xC5ED;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xCC38;&#xC870;&#xD55C;&#xB2E4;. &#xC774; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC73C;&#xB85C; &#xC778;&#xD574; All &#xBC0F; Legacy&#xC5D0;&#xB294; &#xC74C;&#xC218; &#xC624;&#xD504;&#xC14B;&#xC774; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;&#xB294; &#xC810;&#xC5D0; &#xC720;&#xC758;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p>
<p>&#xAE30;&#xB2A5;&#xC774; &#xB9E4;&#xC6B0; &#xBCF5;&#xC7A1;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>Ntdll.dll</code>&#xC740; CONTEXT_EX&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xB2E4;&#xC591;&#xD55C; &#xB370;&#xC774;&#xD130;&#xC758; &#xBE4C;&#xB4DC;, &#xC77D;&#xAE30;, &#xBCF5;&#xC0AC; &#xBC0F; &#xC870;&#xC791;&#xC744; &#xB2E8;&#xC21C;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB2E4;&#xC591;&#xD55C; API&#xB97C; export &#xD55C;&#xB2E4;. (&#xC774;&#xB7EC;&#xD55C; API &#xC911; &#xC77C;&#xBD80;&#xB294; <code>Ntoskrn.exe</code> &#xC5D0;&#xC11C; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0;&#xB9CC; export &#xB418;&#xC9C0;&#xB294; &#xC54A;&#xB294;&#xB2E4;.) &#xB610;&#xD55C; <code>KernelBase.dll</code>&#xC740; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBB38;&#xC11C;&#xD654;&#xB41C; Win32 &#xD568;&#xC218;&#xB97C; export &#xD55C;&#xB2E4;.</p>
<h2 id="CONTEXT-EX-&#xCD08;&#xAE30;&#xD654;"><a href="#CONTEXT-EX-&#xCD08;&#xAE30;&#xD654;" class="headerlink" title="CONTEXT_EX &#xCD08;&#xAE30;&#xD654;"></a>CONTEXT_EX &#xCD08;&#xAE30;&#xD654;</h2><p>&#xBA3C;&#xC800; &#xD638;&#xCD9C;&#xC790;&#xB294; CONTEXT_EX&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD560;&#xB2F9;&#xD560; &#xBA54;&#xBAA8;&#xB9AC; &#xD06C;&#xAE30;&#xB97C; &#xD30C;&#xC545;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;, &#xC774;&#xB294; &#xB2E4;&#xC74C; API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p>
<pre><code class="hljs c">NTSYSAPI
ULONG
NTAPI
RtlGetExtendedContextLength (
    _In_ ULONG ContextFlags,
    _Out_ PULONG ContextLength
);</code></pre>
<p>&#xD638;&#xCD9C;&#xC790;&#xB294; &#xC800;&#xC7A5;&#xD560; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC801;&#xC808;&#xD55C; <code>CONTEXT_XXX</code> &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC81C;&#xACF5;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C;&#xC774; API&#xB294; <code>SharedUserData.XState.EnabledFeatures</code> &#xBC0F; <code>SharedUserData.XState.EnabledUserVisibleSupervisorFeatures</code> &#xB97C; &#xC77D;&#xACE0; &#xBAA8;&#xB4E0; &#xBE44;&#xD2B8;&#xB97C; &#xD1B5;&#xD569;&#xD574; &#xC544;&#xB798;&#xC758; &#xD655;&#xC7A5; &#xD568;&#xC218;&#xB85C; &#xC804;&#xB2EC;&#xD55C;&#xB2E4;.</p>
<pre><code class="hljs c">NTSYSAPI
ULONG
NTAPI
RtlGetExtendedContextLength2 (
    _In_ ULONG ContextFlags,
    _Out_ PULONG ContextLength,
    _In_ ULONG64 XStateCompactionMask
);</code></pre>
<p>&#xC774; &#xCD5C;&#xC2E0; API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xACF5;&#xC720; &#xC0AC;&#xC6A9;&#xC790; &#xB370;&#xC774;&#xD130;&#xC758; XState &#xAD6C;&#xC131;&#xC5D0;&#xC11C; &#xBAA8;&#xB4E0; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xAE30;&#xB2A5;&#xC744; &#xAC00;&#xC838;&#xC624;&#xB294; &#xB300;&#xC2E0; &#xC2E4;&#xC81C;&#xB85C; &#xC800;&#xC7A5;&#xD560; XState &#xC0C1;&#xD0DC;&#xB97C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; CONTNENT_EX &#xAD6C;&#xC870;&#xC758; &#xD06C;&#xAE30;&#xAC00; &#xC791;&#xC544;&#xC838; &#xBAA8;&#xB4E0; XState &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD560; &#xACF5;&#xAC04;&#xC774; &#xCDA9;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xAC8C; &#xB418;&#xBBC0;&#xB85C; &#xC774; CONTNT_EX&#xB97C; &#xB098;&#xC911;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC9C0;&#xC815;&#xB41C; &#xB9C8;&#xC2A4;&#xD06C; &#xC678;&#xBD80;&#xC5D0;&#xC11C; XState Bits&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xC57C; &#xD55C;&#xB2E4;.</p>
<p>&#xB2E4;&#xC74C;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xC790;&#xB294; CONTEXT_EX&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; (&#xB300;&#xBD80;&#xBD84;&#xC758; &#xACBD;&#xC6B0; Windows&#xB294; &#xC608;&#xC678; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xC2E4;&#xD328;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; <code>alloca</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.) &#xB2E4;&#xC74C; &#xB450; API &#xC911; &#xD558;&#xB098;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;.</p>
<pre><code class="hljs c">NTSYSAPI
ULONG
NTAPI
RtlInitializeExtendedContext (
    _Out_ PVOID Context,
    _In_ ULONG ContextFlags,
    _Out_ PCONTEXT_EX* ContextEx
);

NTSYSAPI
ULONG
NTAPI
RtlInitializeExtendedContext2 (
    _Out_ PVOID Context,
    _In_ ULONG ContextFlags,
    _Out_ PCONTEXT_EX* ContextEx,
    _In_ ULONG64 XStateCompactionMask
);</code></pre>
<p>&#xC774;&#xC804;&#xACFC; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xCD5C;&#xC2E0; API&#xC5D0;&#xC11C;&#xB294; &#xC555;&#xCD95;&#xB41C; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xD560; XState &#xC0C1;&#xD0DC;&#xB97C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC9C0;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5; (<code>SharedUserData</code> &#xAE30;&#xBC18;)&#xC774; &#xC788;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xB41C;&#xB2E4;.  &#xD638;&#xCD9C;&#xC790;&#xB294; <code>RtlGetExtendedContextLength(2)</code>&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xACFC; &#xB3D9;&#xC77C;&#xD55C; <code>ContextFlags</code>&#xB97C; &#xC9C0;&#xC815;&#xD574; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xAD6C;&#xC870;&#xAC00; &#xC62C;&#xBC14;&#xB978; &#xD06C;&#xAE30;&#xB85C; &#xD560;&#xB2F9;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xD6C4; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xC785;&#xB825; CONTEXT &#xBC84;&#xD37C;&#xB97C; &#xB530;&#xB77C;&#xAC08; &#xAC83;&#xC73C;&#xB85C; &#xC608;&#xC0C1;&#xB418;&#xB294; CONTEXT_EX &#xAD6C;&#xC870;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC1B;&#xB294;&#xB2E4;.</p>
<p>CONTEXT_EX&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xBA74; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xBA3C;&#xC800; &#xB808;&#xAC70;&#xC2DC; CONTEXT &#xAD6C;&#xC870;&#xB97C; &#xAC00;&#xC838;&#xC62C; &#xC218; &#xC788;&#xB2E4;. (&#xD06C;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xAC00;&#xC815; &#xC5C6;&#xC774;). &#xB2E4;&#xC74C; API&#xB85C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p>
<pre><code class="hljs c">NTSYSAPI
PCONTEXT
NTAPI
RtlLocateLegacyContext (
    _In_ PCONTEXT_EX ContextEx,
    _Out_opt_ PULONG Length,
);</code></pre>
<p>&#xADF8;&#xB7EC;&#xB098; &#xC774;&#xC804;&#xC5D0; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774; &#xC774;&#xB4E4;&#xC740; Windows&#xC758; NT &#xACC4;&#xCE35;&#xC5D0; &#xC758;&#xD574; &#xB178;&#xCD9C;&#xB418;&#xB294; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xB0B4;&#xBD80; API&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC778; Win32 &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xB2E4;&#xC74C; &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; XState &#xD638;&#xD658; CONTEXT &#xAD6C;&#xC870;&#xC758; &#xC0AC;&#xC6A9;&#xC744; &#xB2E8;&#xC21C;&#xD654;&#xD55C;&#xB2E4;.</p>
<pre><code class="hljs c">WINBASEAPI
BOOL
WINAPI
InitializeContext (
    _Out_writes_bytes_opt_(*ContextLength) PVOID Context,
    _In_ DWORD ContextFlags,
    _Out_ PCONTEXT_EX Context,
    _Inout_ PDWORD ContextFlags
);

WINBASEAPI
BOOL
WINAPI
InitializeContext2 (
    _Out_writes_bytes_opt_(*ContextLength) PVOID Context,
    _In_ DWORD ContextFlags,
    _Out_ PCONTEXT_EX Context,
    _Inout_ PDWORD ContextFlags,
    _In_ ULONG64 XStateCompactionMask
);</code></pre>
<p>&#xC774; &#xB450; API&#xB294; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; API&#xC640; &#xBE44;&#xC2B7;&#xD558;&#xAC8C; &#xC791;&#xB3D9;&#xD55C;&#xB2E4;. &#xD638;&#xCD9C;&#xC790;&#xAC00; Buffer &#xBC0F; Context &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB85C; &#xCC98;&#xC74C; NULL&#xC744; &#xC804;&#xB2EC;&#xD558;&#xBA74; &#xD568;&#xC218;&#xB294; <code>ContextLength</code>&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xAE38;&#xC774;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA70; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xD560;&#xB2F9;&#xD55C;&#xB2E4;. &#xB450; &#xBC88;&#xC9F8; &#xC2DC;&#xB3C4;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xD560;&#xB2F9;&#xB41C; &#xD3EC;&#xC778;&#xD130;&#xB97C; Buffer&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xACE0; &#xAE30;&#xBCF8; CONTEXT_EX &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4; &#xC5C6;&#xC774; Context&#xC758; CONTEXT &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC1B;&#xB294;&#xB2E4;.</p>
<h2 id="CONTEXT-EX&#xC5D0;&#xC11C;-XState-&#xAE30;&#xB2A5;-&#xB9C8;&#xC2A4;&#xD06C;-&#xC81C;&#xC5B4;"><a href="#CONTEXT-EX&#xC5D0;&#xC11C;-XState-&#xAE30;&#xB2A5;-&#xB9C8;&#xC2A4;&#xD06C;-&#xC81C;&#xC5B4;" class="headerlink" title="CONTEXT_EX&#xC5D0;&#xC11C; XState &#xAE30;&#xB2A5; &#xB9C8;&#xC2A4;&#xD06C; &#xC81C;&#xC5B4;"></a>CONTEXT_EX&#xC5D0;&#xC11C; XState &#xAE30;&#xB2A5; &#xB9C8;&#xC2A4;&#xD06C; &#xC81C;&#xC5B4;</h2><p>CONTEXT_EX&#xC758; <code>XSAVE_AREA_HEADER</code>&#xC758; Mask &#xD544;&#xB4DC;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; <code>XSTATE_BV</code> (&#xD655;&#xC7A5; &#xAE30;&#xB2A5; &#xB9C8;&#xC2A4;&#xD06C;)&#xC5D0; &#xC561;&#xC138;&#xC2A4; &#xD558;&#xAE30; &#xC704;&#xD574; &#xC2DC;&#xC2A4;&#xD15C;&#xC740;  XState &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xC218;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD55C; API&#xC640; &#xD568;&#xAED8; CONTEXT_EX&#xC5D0;&#xC11C; &#xC5B4;&#xB5A4; XState &#xAE30;&#xB2A5;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xC27D;&#xAC8C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xB450; &#xAC1C;&#xC758; API&#xB97C; export &#xD55C;&#xB2E4;.</p>
<p>&#xADF8;&#xB7EC;&#xB098; Windows&#xB294; XSAVE &#xC601;&#xC5ED;&#xC5D0; x87 FPU (0) &#xBC0F; SSE (1) &#xC0C1;&#xD0DC;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xB300;&#xC2E0; <code>FXSAVE</code> &#xBA85;&#xB839;&#xC744; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;. &#xC989;, XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xB808;&#xAC70;&#xC2DC; &#xC601;&#xC5ED;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xC989;&#xC2DC; <code>XSAVE_AREA_HEADER</code>&#xB85C; &#xC2DC;&#xC791;&#xB41C;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; Get API&#xB294; &#xD56D;&#xC0C1; &#xD558;&#xC704; 2 &#xBE44;&#xD2B8;&#xB97C; &#xB9C8;&#xC2A4;&#xD0B9;&#xD55C;&#xB2E4;. &#xB610;&#xD55C; Set API&#xB294; &#xC9C0;&#xC815;&#xB41C; &#xAE30;&#xB2A5;&#xC774; XState &#xAD6C;&#xC131;&#xC758; <code>EnabledFeatures</code>&#xC5D0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</p>
<p><code>InitializeContext2</code>(&#xB610;&#xB294; &#xB0B4;&#xBD80; &#xB124;&#xC774;&#xD2F0;&#xBE0C; APIs)&#xC5D0;&#xC11C; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xC555;&#xCD95; &#xB9C8;&#xC2A4;&#xD06C;&#xAC00; &#xC9C0;&#xC815;&#xB41C; &#xACBD;&#xC6B0; Set API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAE30;&#xC874; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xC0DD;&#xB7B5;&#xD574;&#xC11C;&#xB294; &#xC548;&#xB41C;&#xB2E4;. (&#xC0C8; &#xBE44;&#xD2B8;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xBA74; CONTEXT_EX&#xC5D0; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCD94;&#xAC00; &#xC0C1;&#xD0DC; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xBBC0;&#xB85C; &#xC774; &#xB370;&#xC774;&#xD130; &#xC5C6;&#xC774; &#xC774;&#xBBF8; &#xC0AC;&#xC804; &#xD560;&#xB2F9;&#xB418;&#xC5C8;&#xC744; &#xAC83;&#xC774;&#xB2E4;.)</p>
<pre><code class="hljs c">NTSYSAPI
ULONG64
NTAPI
RtlGetExtendedFeaturesMask (
    _In_ PCONTEXT_EX ContextEx
);

NTSYSAPI
ULONG64
NTAPI
RtlSetExtendedFeaturesMask (
    _In_ PCONTEXT_EX ContextEx,
    _In_ ULONG64 FeatureMask
);</code></pre>
<p>&#xC704; API&#xC758; &#xBB38;&#xC11C;&#xD654;&#xB41C; &#xD615;&#xC2DD;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xB2E4;.</p>
<pre><code class="hljs c">WINBASEAPI
BOOL
WINAPI
GetXStateFeaturesMask (
    _In_ PCONTEXT Context
    _Out_ PDWORD64 FeatureMask
);

NTSYSAPI
ULONG64
NTAPI
SetXStateFeaturesMask (
    _In_ PCONTEXT Context,
    _In_ DWORD64 FeatureMask
);</code></pre>
<h2 id="CONTEXT-EX&#xC5D0;&#xC11C;-XState-&#xAE30;&#xB2A5;-&#xCC3E;&#xAE30;"><a href="#CONTEXT-EX&#xC5D0;&#xC11C;-XState-&#xAE30;&#xB2A5;-&#xCC3E;&#xAE30;" class="headerlink" title="CONTEXT_EX&#xC5D0;&#xC11C; XState &#xAE30;&#xB2A5; &#xCC3E;&#xAE30;"></a>CONTEXT_EX&#xC5D0;&#xC11C; XState &#xAE30;&#xB2A5; &#xCC3E;&#xAE30;</h2><p>CONTEXT_EX &#xAD6C;&#xC870;&#xC758; &#xBCF5;&#xC7A1;&#xC131;&#xACFC; XState &#xAE30;&#xB2A5;&#xC774; &#xC555;&#xCD95;&#xB418;&#xAC70;&#xB098; &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD615;&#xD0DC;&#xB85C; &#xC874;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC874;&#xC7AC; &#xC5EC;&#xBD80;&#xB3C4; &#xC55E;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB2E4;&#xC591;&#xD55C; &#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;&#xC5D0; &#xC758;&#xC874;&#xD55C;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4; (&#xD2B9;&#xD788; &#xCD5C;&#xC801;&#xD654;&#xB41C; XSAVE&#xAC00; &#xC9C0;&#xC6D0;&#xB418;&#xB294; &#xACBD;&#xC6B0;)&#xB85C; &#xC778;&#xD574;, &#xD638;&#xCD9C;&#xC790;&#xB294; CONTEXT_EX &#xB0B4;&#xC758; XSAVE &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xAD00;&#xB828; &#xC0C1;&#xD0DC; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC27D;&#xACE0; &#xBE60;&#xB974;&#xAC8C; &#xC5BB;&#xAE30; &#xC704;&#xD55C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xD568;&#xC218;&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;.</p>
<p>&#xD604;&#xC7AC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xB450; &#xAC00;&#xC9C0; &#xD568;&#xC218;&#xAC00; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;. <code>RtlLocateExtendedFeature</code>&#xB294; <code>RtlLocateExtendedFeature2</code>&#xC758; wrapper&#xC774;&#xBA70; &#xAD6C;&#xC131; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB85C; <code>SharedUserData.XState</code>&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC81C;&#xACF5;&#xD55C;&#xB2E4;. &#xB450; &#xD568;&#xC218; &#xBAA8;&#xB450; export &#xD560; &#xB54C; &#xD638;&#xCD9C;&#xC790;&#xAC00; &#xC120;&#xD0DD;&#xD55C; &#xACBD;&#xC6B0; &#xD6C4;&#xC790;&#xC758; API&#xC5D0;&#xC11C; &#xC790;&#xCCB4; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; XState &#xAD6C;&#xC131;&#xC744; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC9C0;&#xC815;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xB2E4;.</p>
<pre><code class="hljs c">NTSYSAPI
PVOID
NTAPI
RtlLocateExtendedFeature (
    _In_ CONTEXT_EX ContextEx,
    _In_ ULONG FeatureId,
    _Out_opt_ PULONG Length
);

NTSYSAPI
PVOID
NTAPI
RtlLocateExtendedFeature2 (
    _In_ CONTEXT_EX ContextEx,
    _In_ ULONG FeatureId,
    _In_ PXSTATE_CONFIGURATION Configuration,
    _Out_opt_ PULONG Length
);</code></pre>
<p>&#xB450; &#xD568;&#xC218; &#xBAA8;&#xB450; CONTEXT_EX &#xAD6C;&#xC870;&#xC640; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5;&#xC758; ID&#xB97C; &#xC218;&#xC2E0;&#xD558;&#xACE0; &#xAE30;&#xB2A5;&#xC774; XSAVE &#xC601;&#xC5ED;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC704;&#xCE58;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xAE30; &#xC704;&#xD574; XState &#xAD6C;&#xC131; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD55C;&#xB2E4;. &#xC9C0;&#xC815;&#xB41C; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD55C; &#xC2E4;&#xC81C; &#xAC12;&#xC744; &#xD655;&#xC778;&#xD558;&#xAC70;&#xB098; &#xBC18;&#xD658;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; &#xC774;&#xB294; &#xD638;&#xCD9C;&#xC790;&#xC5D0;&#xAC8C; &#xB2EC;&#xB824; &#xC788;&#xB2E4;.</p>
<p>&#xD3EC;&#xC778;&#xD130;&#xB97C; &#xCC3E;&#xAE30; &#xC704;&#xD574; <code>RtlLocateExtendedFeature2</code>&#xB294; &#xB2E4;&#xC74C;&#xC744; &#xC218;&#xD589;&#xD55C;&#xB2E4;:</p>
<ul>
<li>&#xAE30;&#xB2A5; ID&#xAC00; 2 &#xC774;&#xC0C1; (x87 FPU &#xBC0F; SSE &#xC0C1;&#xD0DC;&#xB294; Windows&#xC758; XSAVE&#xB97C; &#xD1B5;&#xD574; &#xC800;&#xC7A5;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C;) &#xBC0F; 64 (&#xAC00;&#xB2A5;&#xD55C; &#xAC00;&#xC7A5; &#xB192;&#xC740; XState &#xAE30;&#xB2A5; &#xBE44;&#xD2B8;) &#xBBF8;&#xB9CC;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</li>
<li>CONTEXT_EX + <code>CONTEXT_EX.XState.Offset</code>&#xC5D0;&#xC11C; <code>XSAVE_AREA_HEADER</code>&#xB97C; &#xAC00;&#xC838;&#xC628;&#xB2E4;.</li>
<li><code>Configuration</code>-&gt; <code>ControlFlags.CompactionEnabled</code> &#xD50C;&#xB798;&#xADF8;&#xC5D0;&#xC11C; &#xC555;&#xCD95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xB2E4;.</li>
<li>&#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD615;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0; :<ul>
<li><code>Configuration</code>-&gt; <code>Features[n].Offset</code> &#xBC0F; <code>.Size</code>&#xB97C; &#xC77D;&#xACE0; XSAVE &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5;&#xC758; &#xC624;&#xD504;&#xC14B; &#xBC0F; &#xD06C;&#xAE30;&#xB97C; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;.</li>
</ul>
</li>
<li>&#xC555;&#xCD95;&#xB41C; &#xD615;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0; :<ul>
<li><code>XSAVE_AREA_HEADER</code> (<code>XCOMP_BV</code>&#xC5D0; &#xD574;&#xB2F9;)&#xC5D0;&#xC11C; <code>CompactionMask</code>&#xB97C; &#xC77D;&#xACE0; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</li>
<li><code>Configuration</code>-&gt; <code>AllFeatures</code>&#xB97C; &#xC77D;&#xACE0; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xAC00; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5; ID &#xC55E;&#xC5D0; &#xC624;&#xB294; &#xBAA8;&#xB4E0; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC774;&#xB7EC;&#xD55C; &#xD06C;&#xAE30;&#xB97C; &#xB354;&#xD558;&#xC5EC; &#xC694;&#xCCAD;&#xB41C; &#xD615;&#xC2DD;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC744; &#xACC4;&#xC0B0;&#xD55C; &#xB4A4; &#xAC01; &#xC774;&#xC804; &#xC0C1;&#xD0DC; &#xC601;&#xC5ED;&#xC758; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC744; 64byte&#xB85C; &#xC815;&#xB82C;&#xD55C;&#xB2E4;. &#xD574;&#xB2F9; &#xBE44;&#xD2B8;&#xAC00; <code>Configuration</code>-&gt; <code>AlignedFeatures</code>&#xC5D0; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xC6B0; &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xC6B0; &#xC9C0;&#xC815;&#xB41C; &#xAE30;&#xB2A5; ID&#xC5D0; &#xB300;&#xD55C; &#xC601;&#xC5ED;&#xC758; &#xC2DC;&#xC791;&#xC744; &#xC815;&#xB82C;&#xD55C;&#xB2E4;.</li>
<li><code>Configuration.AllFeatures[n]</code>&#xC5D0;&#xC11C; &#xC694;&#xCCAD;&#xB41C; &#xAE30;&#xB2A5;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC77D;&#xB294;&#xB2E4;.</li>
</ul>
</li>
<li>&#xC704;&#xC5D0;&#xC11C; &#xACC4;&#xC0B0;&#xB41C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; XSAVE &#xC601;&#xC5ED;&#xC5D0;&#xC11C; &#xAE30;&#xB2A5;&#xC744; &#xCC3E;&#xACE0; &#xC120;&#xD0DD;&#xC801;&#xC73C;&#xB85C; &#xCD9C;&#xB825; &#xAE38;&#xC774; &#xBCC0;&#xC218;&#xC758; &#xD574;&#xB2F9; &#xD06C;&#xAE30;&#xC640; &#xD568;&#xAED8; &#xD574;&#xB2F9; &#xD06C;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</li>
</ul>
<p>&#xC989;, &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xD2B9;&#xC815; &#xAE30;&#xB2A5;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xCC3E;&#xC73C;&#xB824;&#xBA74; <code>SharedUserData</code>&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCDA9;&#xBD84;&#xD558;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC555;&#xCD95;&#xB41C; &#xD615;&#xC2DD;&#xC5D0;&#xC11C;&#xB294; <code>SharedUserData</code>&#xC758; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC758;&#xC874;&#xD560; &#xC218; &#xC5C6;&#xC73C;&#xBBC0;&#xB85C; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xAE30;&#xB2A5;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC774;&#xC804; &#xAE30;&#xB2A5;&#xC758; &#xBAA8;&#xB4E0; &#xD06C;&#xAE30;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xACC4;&#xC0B0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p>
<p>&#xC77C;&#xBC18;&#xC801;&#xC778; Win32 &#xC751;&#xC6A9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C;&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC704;&#xC758; &#xAE30;&#xBCF8; API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC9C0;&#xB9CC; &#xC77C;&#xBD80; &#xC0AC;&#xC804; &#xCC98;&#xB9AC;&#xAC00; &#xC788;&#xB294; &#xB2E4;&#xB978; API&#xAC00; &#xC0AC;&#xC6A9;&#xB418;&#xAE30;&#xB3C4; &#xD55C;&#xB2E4;. &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8; 0&#xACFC; 1&#xC740; CONTEXT_EX&#xC5D0;&#xC11C; XSAVE &#xC601;&#xC5ED;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; Win32 API&#xB294; &#xC801;&#xC808;&#xD55C; &#xB808;&#xAC70;&#xC2DC; CONTEXT &#xD544;&#xB4DC; (&#xC989;, <code>XSTATE_LEGACY_FLOATING_POINT</code>&#xC758; &#xACBD;&#xC6B0; FltSave, <code>XSTATE_LEGACY_SSE</code>&#xC758; &#xACBD;&#xC6B0; Xmm0)&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xB450; &#xAE30;&#xB2A5; &#xBE44;&#xD2B8;&#xB97C; &#xAC00;&#xC838;&#xC640; &#xCC98;&#xB9AC;&#xD55C;&#xB2E4;.</p>
<pre><code class="hljs c">WINBASEAPI
PVOID
WINAPI
LocateXStateFeature (
    _In_ CONTEXT_EX Context,
    _In_ DWORD FeatureId,
    _Out_opt_ PDWORD Length
);</code></pre>
<h2 id="&#xC608;&#xC81C;-&#xC0AC;&#xC6A9;&#xACFC;-&#xCD9C;&#xB825;"><a href="#&#xC608;&#xC81C;-&#xC0AC;&#xC6A9;&#xACFC;-&#xCD9C;&#xB825;" class="headerlink" title="&#xC608;&#xC81C; &#xC0AC;&#xC6A9;&#xACFC; &#xCD9C;&#xB825;"></a>&#xC608;&#xC81C; &#xC0AC;&#xC6A9;&#xACFC; &#xCD9C;&#xB825;</h2><p>CONTEXT_EX &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC640; &#xACB0;&#xD569;&#xB41C; &#xACBD;&#xC6B0; XState &#xB0B4;&#xBD80;&#xB97C; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD574; &#xAC04;&#xB2E8;&#xD55C; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/tree/master/Xpolicy">&#xD14C;&#xC2A4;&#xD2B8; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</a>&#xC744; &#xC791;&#xC131;&#xD588;&#xB2E4;. &#xC774; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xB294; &#xC77C;&#xBD80; API &#xC0AC;&#xC6A9;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xB2E4;&#xC591;&#xD55C; &#xC624;&#xD504;&#xC14B;, &#xD06C;&#xAE30; &#xBC0F; &#xB3D9;&#xC791;&#xC744; &#xBCF4;&#xC5EC;&#xC900;&#xB2E4;. &#xB2E4;&#xC74C;&#xC740; AVX, MPX &#xBC0F; Intel PT&#xAC00; &#xC788;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8; (AVX &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC0AC;&#xC6A9;)&#xC758; &#xCD9C;&#xB825;&#xC774;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/5.png" srcset="/img/loading.gif" alt></p>
<p>&#xBB34;&#xC5C7;&#xBCF4;&#xB2E4;&#xB3C4; &#xB808;&#xAC70;&#xC2DC; CONTEXT&#xAC00; &#xC74C;&#xC218;&#xC778; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC788;&#xB294; &#xACBD;&#xC6B0; &#xC608;&#xC0C1;&#xB300;&#xB85C; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; x87 FPU &#xC0C1;&#xD0DC;(1) &#xBC0F; GSE &#xC0C1;&#xD0DC;(2)&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB354;&#xB77C;&#xB3C4; <code>XSAVEBV</code>&#xC5D0;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xBE44;&#xD2B8;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xB808;&#xAC70;&#xC2DC; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xC601;&#xC5ED;&#xC5D0; &#xC800;&#xC7A5;&#xB41C;&#xB2E4;. (&#xB530;&#xB77C;&#xC11C; &#xAD00;&#xB828; &#xC0C1;&#xD0DC; &#xB370;&#xC774;&#xD130;&#xC758; &#xC74C;&#xC218; &#xC624;&#xD504;&#xC14B;&#xC5D0; &#xC720;&#xC758;&#xD574;&#xC57C; &#xD568;) <code>0x40</code> &#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xC778; XSAVE &#xD5E4;&#xB354; (&#xC624;&#xD504;&#xC14B; <code>0x30</code>&#xC5D0;&#xC11C; &#xC2DC;&#xC791;) &#xB2E4;&#xC74C;&#xC5D0; AVX &#xC0C1;&#xD0DC;(2)&#xB294; &#xC624;&#xD504;&#xC14B; <code>0x70</code>&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD55C;&#xB2E4;.</p>
<h1 id="CONTEXT-EX-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;"><a href="#CONTEXT-EX-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;" class="headerlink" title="CONTEXT_EX &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;"></a>CONTEXT_EX &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;</h1><p>&#xC720;&#xC800; &#xBAA8;&#xB4DC; API&#xB294; &#xACB0;&#xAD6D; &#xCEE4;&#xB110;&#xC5D0; &#xC758;&#xD574; &#xCC98;&#xB9AC;&#xB418;&#xACE0; XSAVE &#xC601;&#xC5ED;&#xC758; &#xAD8C;&#xD55C; &#xC788;&#xB294; &#xBD80;&#xBD84; (&#xC989;, CET &#xC0C1;&#xD0DC; &#xB370;&#xC774;&#xD130;)&#xC744; &#xC218;&#xC815;&#xD558;&#xB294; CONTEXT_EX&#xB97C; &#xAD6C;&#xC131;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; Windows&#xB294; CONTEXT_EX&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xB294; API&#xB97C; &#xD1B5;&#xD55C; &#xBC14;&#xB78C;&#xC9C1;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC218;&#xC815;&#xC744; &#xBC29;&#xC9C0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; :</p>
<ul>
<li><code>NtContinue</code> : &#xC608;&#xC678; &#xD6C4; &#xC7AC;&#xAC1C;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xBA70; longjmp CRT &#xAE30;&#xB2A5;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xACE0; &#xC2A4;&#xD0DD; &#xD574;&#xC81C;&#xB97C; &#xC218;&#xD589;&#xD55C;&#xB2E4;.</li>
<li><code>NtRaiseException</code> : &#xAE30;&#xC874; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xC608;&#xC678;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB428;</li>
<li><code>NtQueueUserApc</code> : &#xAE30;&#xC874; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xC2E4;&#xD589; &#xD750;&#xB984;&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB428;</li>
<li><code>NtSetContextThread</code> : &#xAE30;&#xC874; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; / &#xC0C1;&#xD0DC;&#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB428;</li>
</ul>
<p>&#xC774;&#xB7EC;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xD638;&#xCD9C;&#xB85C; &#xC778;&#xD574; &#xCEE4;&#xB110;&#xC774; <code>IA32_PL3_SSP</code> &#xB610;&#xB294; <code>IA32_CET_U</code> MSR&#xC744; &#xC218;&#xC815;&#xD558;&#xACE0; RIP&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; Windows&#xB294; &#xC804;&#xB2EC;&#xB41C; CONTEXT_EX&#xAC00; CET &#xBCF4;&#xC99D;&#xC744; &#xC704;&#xBC18;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p>
<p><code>19H1</code>&#xC5D0; SSP&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xACE0; <code>20H1</code>&#xC5D0; RIP &#xAC80;&#xC99D;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xACE7; &#xB2E4;&#xB8F0; &#xC608;&#xC815;&#xC774;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xBA3C;&#xC800; <code>NtContinue</code>&#xC758; &#xC624;&#xC6A9; &#xAC00;&#xB2A5;&#xC131;&#xC744; &#xC904;&#xC774;&#xAE30; &#xC704;&#xD574; &#xC791;&#xC740; &#xB9AC;&#xD329;&#xD130;&#xB9C1;&#xC744; &#xC218;&#xD589;&#xD574;&#xC57C; &#xD588;&#xB2E4;. &#xBC14;&#xB85C; <code>NtContinueEx</code> &#xD568;&#xC218;&#xC758; &#xB3C4;&#xC785;&#xC774;&#xB2E4;.</p>
<h2 id="NtContinueEX-&#xBC0F;-KCONTINUE-ARGUMENT"><a href="#NtContinueEX-&#xBC0F;-KCONTINUE-ARGUMENT" class="headerlink" title="NtContinueEX &#xBC0F; KCONTINUE_ARGUMENT"></a>NtContinueEX &#xBC0F; KCONTINUE_ARGUMENT</h2><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB300;&#xB85C; <code>NtContinue</code>&#xC758; &#xAE30;&#xB2A5;&#xC740; &#xC5EC;&#xB7EC; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xBA70;, CET&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC0C1;&#xD0DC;&#xC5D0; &#xB300;&#xD55C; &#xC784;&#xC758; &#xBCC0;&#xACBD;&#xC744; &#xD5C8;&#xC6A9;&#xD558;&#xB294; API&#xC5D0;&#xC11C; &#xAE30;&#xC874; &#xC0C1;&#xD0DC;&#xB97C; &#xBCF5;&#xC6D0;&#xD560; &#xC218; &#xC788;&#xC73C;&#xB824;&#xBA74; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0; &#xB354; &#xC138;&#xBC00;&#xD55C; &#xC81C;&#xC5B4;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5B4;&#xC57C; &#xD588;&#xB2E4;. &#xC774; &#xC791;&#xC5C5;&#xC740; <code>KCONTINUE_TYPE</code>&#xC774;&#xB77C;&#xB294; &#xC0C8; enumeration&#xC758; &#xC0DD;&#xC131;&#xC744; &#xD1B5;&#xD574; &#xC218;&#xD589;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, <code>KCONTINUE_ARGUMENT</code> &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC5D0; &#xD604;&#xC7AC; <code>NtContinue</code>&#xC5D0;&#xC11C; <code>NtContinueEx</code>&#xB85C; &#xD5A5;&#xC0C1;&#xB41C; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</p>
<p>&#xC774; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC5D0;&#xB294;  <code>ContinueFlags</code> &#xD544;&#xB4DC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. &#xC774; &#xD544;&#xB4DC;&#xB294;  <code>NtContinue</code>&#xC758; &#xC6D0;&#xB798; <code>TestAlert</code> &#xC778;&#xC218;&#xB97C; <code>CONTINUE_FLAG_RAISE_ALERT (0x1)</code> &#xD50C;&#xB798;&#xADF8;&#xB85C; &#xB300;&#xCCB4;&#xD558;&#xB294; &#xB3D9;&#xC2DC;&#xC5D0; &#xC0C8;&#xB85C;&#xC6B4; TrapFrame&#xC73C;&#xB85C; APC&#xB97C; &#xC9C1;&#xC811; &#xC804;&#xB2EC;&#xD558;&#xB294;<code>CONTINUE_FLAG_BYPASS_CONTEXT_COPY (0x2)</code> &#xD50C;&#xB798;&#xADF8;&#xB3C4; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xB2E4;. &#xC774;&#xAC83;&#xC740; CONTEXT &#xB808;&#xCF54;&#xB4DC; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC0AC;&#xC6A9;&#xC790; &#xC2A4;&#xD0DD;&#xC758; &#xD2B9;&#xC815; &#xC704;&#xCE58;&#xC5D0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xC774;&#xC804;&#xC5D0; &#xAD6C;&#xD604;&#xB41C; &#xCD5C;&#xC801;&#xD654;&#xB85C;, &#xD568;&#xC218;&#xAC00; &#xC0AC;&#xC6A9;&#xC790; &#xBAA8;&#xB4DC; APC &#xC804;&#xB2EC;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;.  &#xC774; &#xB3D9;&#xC791;&#xC744; &#xC6D0;&#xD558;&#xB294; &#xD638;&#xCD9C;&#xC790;&#xB294; <code>ContinueFlags</code>&#xC5D0;&#xC11C; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</p>
<p>&#xC774;&#xC804; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB294; &#xB808;&#xAC70;&#xC2DC;&#xB85C; &#xACC4;&#xC18D; &#xC9C0;&#xC6D0;&#xB418;&#xC9C0;&#xB9CC; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xC785;&#xB825; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB97C; <code>KCONTINUE_ARGUMENT</code>&#xAC00; &#xC544;&#xB2CC; <code>BOOLEAN TestAlert</code> &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xB85C; &#xC778;&#xC2DD;&#xD558;&#xB294; <code>NtContinueEx</code>&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xACBD;&#xC6B0;&#xB294; &#xC0C8; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; <code>KCONTINUE_UNWIND</code>&#xB85C; &#xCC98;&#xB9AC;&#xB41C;&#xB2E4;.</p>
<p>&#xC704; &#xB9AC;&#xD329;&#xD130;&#xB9C1;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xB2E4;&#xC74C; &#xB124; &#xAC00;&#xC9C0; &#xAC00;&#xB2A5;&#xD55C; &#xC720;&#xD615;&#xC774; &#xC788;&#xB2E4;.</p>
<ul>
<li><code>KCONTINUE_UNWIND</code> &#x2013; &#xC608;&#xC678;&#xC5D0;&#xC11C; &#xD574;&#xC81C;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>RtlRestoreContext</code> &#xBC0F; <code>LdrInitializeThunk</code>&#xC640; &#xAC19;&#xC740; <code>NtContinue</code>&#xC758; &#xB808;&#xAC70;&#xC2DC; &#xD638;&#xCD9C;&#xC790;&#xAC00; &#xC0AC;&#xC6A9;</li>
<li><code>KCONTINUE_RESUME</code> &#x2013; <code>NtContinueEx</code>&#xB97C; &#xB2E4;&#xC2DC; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804;&#xC5D0; <code>KiUserApcDispatcher</code>&#xAC00; &#xC2E4;&#xD589;&#xD560; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC2A4;&#xD0DD;&#xC5D0; <code>KCONTINUE_ARGUMENT</code> &#xAD6C;&#xC870;&#xB97C; &#xBE4C;&#xB4DC;&#xD560; &#xB54C; <code>KiInitializeUserApc</code>&#xAC00; &#xC0AC;&#xC6A9;</li>
<li><code>KCONTINUE_LONGJUMP</code> &#x2013; &#xC608;&#xC678; &#xB808;&#xCF54;&#xB4DC;&#xC758; &#xC608;&#xC678; &#xCF54;&#xB4DC;&#xAC00; <code>STATUS_LONGJUMP</code> &#xC778; &#xACBD;&#xC6B0; <code>RtlRestoreContext</code>&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>RtlContinueLongJump</code>&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB428;</li>
<li><code>KCONTINUE_SET</code> &#x2013; <code>NtContinueEx</code>&#xC5D0; &#xC9C1;&#xC811; &#xC804;&#xB2EC;&#xB418;&#xC9C0; &#xC54A;&#xACE0; <code>NtSetContextThread</code> API&#xC5D0; &#xB300;&#xD55C; &#xC751;&#xB2F5;&#xC73C;&#xB85C; <code>PspGetSetContextInternal</code> &#xB0B4;&#xC5D0;&#xC11C; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a>&#xC744; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB428;</li>
</ul>
<h2 id="SSP-Shadow-Stack-Pointer-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;"><a href="#SSP-Shadow-Stack-Pointer-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;" class="headerlink" title="SSP(Shadow Stack Pointer) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;"></a>SSP(Shadow Stack Pointer) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;</h2><p>&#xC55E;&#xC11C; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774; &#xC608;&#xC678; &#xD574;&#xC81C;, APC, longjmp &#xB4F1;&#xACFC; &#xAC19;&#xC774; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xCF54;&#xB4DC;&#xAC00; SSP&#xB97C; &#xBCC0;&#xACBD;&#xD574;&#xC57C; &#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xB294; CET &#xC6B0;&#xD68C; &#xBC29;&#xC9C0;&#xB97C; &#xC704;&#xD574; SSP&#xC5D0; &#xC694;&#xCCAD;&#xB41C; &#xC0C8; &#xAC12;&#xC744; &#xAC80;&#xC99D;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xB294; <code>19H1</code>&#xC5D0;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextXStateCetU.c">KeVerifyContextXStateCetU</a> &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xAC00; &#xC218;&#xC815;&#xB418;&#xB294; &#xC2A4;&#xB808;&#xB4DC;&#xC640; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xC0C8; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xB97C; &#xC218;&#xC2E0;&#xD558;&#xACE0; &#xB2E4;&#xC74C;&#xC744; &#xC218;&#xD589;&#xD55C;&#xB2E4;.</p>
<ul>
<li>CONTEXT_EX&#xC5D0; XState &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xAC70;&#xB098; XState &#xB370;&#xC774;&#xD130;&#xC5D0; CET &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; (<code>XSTATE_CET_U</code> &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB85C; <code>RtlLocateExtendedFeature2</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xD655;&#xC778;) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xAC00; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;.</li>
<li>&#xB300;&#xC0C1; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; CET&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0; :<ul>
<li>&#xD638;&#xCD9C;&#xC790;&#xAC00; <code>XSAVEBV</code>&#xC5D0;&#xC11C; <code>XSTATE_MASK_CET_U</code>&#xB97C; &#xB9C8;&#xC2A4;&#xD0B9;&#xD558;&#xC5EC; &#xC774; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; CET&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0; &#xD568;&#xC218;&#xB294; &#xC0C1;&#xD0DC; &#xBE44;&#xD2B8;&#xB97C; &#xB2E4;&#xC2DC; &#xD65C;&#xC131;&#xD654;&#xD558;&#xACE0; <code>MSR_IA32_CET_SHSTK_EN</code> (CET&#xC758; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xAE30;&#xB2A5;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD558;&#xB294; &#xD50C;&#xB798;&#xADF8;)&#xC744; <code>Ia32CetUMsr</code>&#xC5D0; &#xC124;&#xC815;&#xD558;&#xACE0; &#xD604;&#xC7AC; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC744; <code>Ia32Pl3SspMsr</code>&#xB85C; &#xC124;&#xC815;&#xD55C;&#xB2E4;.</li>
<li>&#xBC18;&#xBA74;&#xC5D0; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextXStateCetUEnabled.c">KiVerifyContextXStateCetUEnabled</a>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; CET &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5C8;&#xB294;&#xC9C0;, (<code>MSR_IA32_CET_SHSTK_EN</code> &#xD65C;&#xC131;&#xD654; &#xC5EC;&#xBD80;) &#xC0C8; SSP&#xAC00; 8byte&#xB85C; &#xC815;&#xB82C;&#xB418;&#xC5C8;&#xB294;&#xC9C0;, &#xD604;&#xC7AC; SSP &#xAC12;&#xACFC; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xC601;&#xC5ED;&#xC758; VAD &#xB05D; &#xC0AC;&#xC774;&#xC5D0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC2A4;&#xD0DD;&#xC774; &#xAC70;&#xAFB8;&#xB85C; &#xC131;&#xC7A5;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC601;&#xC5ED;&#xC758; &#x201C;&#xB05D;&#x201D;&#xC774; &#xC2E4;&#xC81C;&#xB85C; &#xC2A4;&#xD0DD;&#xC758; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xC774;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; &#xC0C8; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xB97C; &#xC124;&#xC815;&#xD560; &#xB54C; &#xBAA8;&#xB4E0; SSP &#xAC12;&#xC740; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xC0AC;&#xC6A9;&#xB41C; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xB0B4;&#xC5D0; &#xC788;&#xB294; &#xD55C; &#xC720;&#xD6A8;&#xD558;&#xB2E4;. &#xB610;&#xD55C; &#xC2A4;&#xB808;&#xB4DC;&#xAC00; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xB0B4;&#xBD80;&#xB85C; &#xC774;&#xB3D9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC94;&#xC704;&#xC5D0;&#xB294; &#xC81C;&#xD55C;&#xC774; &#xC5C6;&#xB2E4;.</li>
</ul>
</li>
<li>CET&#xAC00; &#xB300;&#xC0C1; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xACE0; &#xD638;&#xCD9C;&#xC790;&#xAC00; CONTEXT_EX&#xC758; <code>XSAVEBV</code>&#xC5D0; <code>XSTATE_CET_U</code> &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC5EC; &#xD65C;&#xC131;&#xD654;&#xB97C; &#xC2DC;&#xB3C4;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xB450; MSR &#xAC12;&#xC774; &#xBAA8;&#xB450; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xB3C4;&#xB85D; &#xD5C8;&#xC6A9;&#xD55C;&#xB2E4;. (&#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; X, SSP X)</li>
</ul>
<p>&#xC704; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xC5D0; &#xC2E4;&#xD328;&#xD558;&#xBA74; <code>STATUS_SET_CONTEXT_DENIED</code>&#xAC00; &#xBC18;&#xD658;&#xB418;&#xACE0; &#xC131;&#xACF5;&#xD558;&#xBA74; <code>STATUS_SUCCESS</code>&#xAC00; &#xBC18;&#xD658;&#xB41C;&#xB2E4;.</p>
<p>CET&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD558;&#xBA74; &#xAE30;&#xC874; Windows 8.1&#xC5D0;&#xC11C; CFG&#xC640; &#xD568;&#xAED8; &#xAD6C;&#xD604;&#xB41C; Check Stack Extents&#xB3C4; &#xC554;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB41C;&#xB2E4;. &#xC774;&#xAC83;&#xC740; KPROCESS&#xC758; <code>ProcessFlags</code> &#xD544;&#xB4DC;&#xC5D0; &#xC788;&#xB294; <code>CheckStackExtents</code> &#xBE44;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC989;, &#xB300;&#xC0C1; SSP&#xAC00; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextRecord.c">KeVerifyContextRecord</a> &#xB610;&#xD55C; &#xD638;&#xCD9C;&#xB418;&#xACE0; &#xB300;&#xC0C1; RSP&#xAC00; &#xD604;&#xC7AC; &#xC2A4;&#xB808;&#xB4DC;&#xC758; TEB &#xC0AC;&#xC6A9;&#xC790; &#xC2A4;&#xD0DD; &#xC81C;&#xD55C; (&#xB610;&#xB294; &#xC774;&#xAC83;&#xC774; WOW64 &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC778; &#xACBD;&#xC6B0; TEB32&#xC758; &#xC0AC;&#xC6A9;&#xC790; &#xC2A4;&#xD0DD; &#xC81C;&#xD55C;)&#xC758; &#xC77C;&#xBD80;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. <code>RtlGuardIsValidStackPointer</code> (&#xBC0F; <code>RtlGuardIsValidWow64StackPointer</code>)&#xC5D0; &#xC758;&#xD574; &#xAD6C;&#xD604;&#xB41C; &#xC774;&#xB7EC;&#xD55C; &#xAC80;&#xC0AC;&#xB294; &#xC774;&#xC804;&#xC5D0; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://medium.com/tenable-techblog/api-series-setthreadcontext-d08c9f84458d">Tenable</a> &#xBC0F; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.ensilo.com/atombombing-cfg-protected-processes">enSilo</a>&#xC758; &#xC5F0;&#xAD6C;&#xC6D0;&#xC5D0; &#xC758;&#xD574; &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC5C8;&#xB2E4;.</p>
<h2 id="RIP-Instruction-Pointer-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;"><a href="#RIP-Instruction-Pointer-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;" class="headerlink" title="RIP(Instruction Pointer) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;"></a>RIP(Instruction Pointer) &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;</h2><p><code>19030</code> &#xBE4C;&#xB4DC; &#xBC84;&#xC804;&#xC5D0; Intel CET&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xB610; &#xB2E4;&#xB978; &#xAE30;&#xB2A5;&#xC778; &#xD638;&#xCD9C;&#xC790;&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xC815;&#xD558;&#xB824;&#xB294; &#xC0C8; RIP&#xAC00; &#xC720;&#xD6A8;&#xD55C;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. SSP &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xC640; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xC774;&#xB294; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD574; CET&#xC774; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; RIP &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xB300;&#xD574; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;. (EPROCESS&#xC758; <code>MitigationFlags2Values</code> &#xD544;&#xB4DC;&#xC5D0; &#xC788;&#xB294; <code>UserCetSetContextIpValidation</code> &#xBE44;&#xD2B8;&#xB85C; &#xD45C;&#xC2DC;&#xB428;).</p>
<p>&#xC989;, &#xD604;&#xC7AC; &#xBE4C;&#xB4DC;&#xC758; &#xACBD;&#xC6B0; <code>CreateProcess</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0; <code>PROC_THREAD_ATTRIBUTE_MITIGATION_POLICY</code> &#xC18D;&#xC131;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; <code>PROCESS_CREATION_MITIGATION_POLICY2_CET_USER_SHADOW_STACKS_ALWAYS_ON</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xBA74; &#xC635;&#xC158;&#xC774; &#xC124;&#xC815;&#xB418;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;. (CET&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC0DD;&#xC131; &#xC2DC;&#xC5D0;&#xB9CC; &#xD65C;&#xC131;&#xD654;&#xB420; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; <code>ProcessUserShadowStackPolicy</code> &#xAC12;&#xC73C;&#xB85C; <code>SetProcessMitgationPolicy</code> API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;.)</p>
<p>&#xADF8;&#xB7EC;&#xB098; &#xD765;&#xBBF8;&#xB86D;&#xAC8C;&#xB3C4; &#xC0C8;&#xB85C;&#xC6B4; mitigation &#xC635;&#xC158;&#xC778; <code>PS_MITIGATION_OPTION_USER_CET_SET_CONTEXT_IP_VALIDATION (32)</code> &#xC774; mitigation map&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB2E4;. &#xBB38;&#xC11C;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC774; mitigation&#xC744; &#xD1A0;&#xAE00; &#xD558;&#xBA74; <code>MitigationFlags2Values</code> &#xD544;&#xB4DC;&#xC5D0;&#xC11C; <code>AuditUserCetSetContextIpValidation</code> &#xBE44;&#xD2B8;&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD55C;&#xB2E4;. &#xB610;&#xD55C; &#xC774;&#xAC83;&#xC740; &#xC774;&#xC81C; 32 &#xBC88;&#xC9F8; mitigation &#xC635;&#xC158; (&#xAC01;&#xAC01; DEFERRED / OFF / ON / RESERVED&#xC5D0; &#xB300;&#xD574; 4 &#xBE44;&#xD2B8;&#xB97C; &#xCC28;&#xC9C0;&#xD568;)&#xC774;&#xBBC0;&#xB85C; 132&#xAC1C;&#xC758; mitigation &#xBE44;&#xD2B8;&#xAC00; &#xD544;&#xC694;&#xD558;&#xBA70; <code>PS_MITIGATION_OPTIONS_MAP</code>&#xB294; Map &#xD544;&#xB4DC;&#xC758; 3&#xAC1C;&#xC758; 64 &#xBE44;&#xD2B8; &#xBC30;&#xC5F4; &#xC694;&#xC18C;&#xB85C; &#xD655;&#xC7A5;&#xB418;&#xC5C8;&#xB2E4;.  (<code>PS_SYSTEM_DLL_INIT_BLOCK</code>&#xC758; &#xD06C;&#xAE30;&#xC5D0; &#xB300;&#xD55C; &#xD6C4;&#xC18D; &#xD6A8;&#xACFC;&#xAC00; &#xC788;&#xC74C;)</p>
<p>&#xC0C8;&#xB85C;&#xC6B4; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a> &#xD568;&#xC218;&#xB294; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xAC00; &#xBCC0;&#xACBD;&#xB420; &#xB54C;&#xB9C8;&#xB2E4; &#xD638;&#xCD9C;&#xB41C;&#xB2E4;. &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD574; CET &#xBC0F; RIP mitigation&#xC774; &#xBAA8;&#xB450; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8; &#xB9E4;&#xAC1C; &#xBCC0;&#xC218;&#xC5D0; <code>CONTEXT_CONTROL</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC989;, &#xC774; &#xC0C8; &#xCF58;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0; &#xC758;&#xD574; RIP&#xAC00; &#xBCC0;&#xACBD;&#xB428;&#xC744; &#xC758;&#xBBF8;&#xD55C;&#xB2E4;. &#xBAA8;&#xB4E0; &#xAC80;&#xC0AC;&#xAC00; &#xD1B5;&#xACFC;&#xB418;&#xBA74; &#xB0B4;&#xBD80; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextIpForUserCet.c">KiVerifyContextIpForUserCet</a> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xC758; &#xBAA9;&#xC801;&#xC740; &#xB300;&#xC0C1; RIP&#xAC00; &#xC720;&#xD6A8;&#xD55C; &#xAC12;&#xC774;&#xACE0; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC774; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC12;&#xC774; &#xC544;&#xB2CC;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4;.</p>
<p>&#xBA3C;&#xC800; &#xB300;&#xC0C1; RIP &#xC8FC;&#xC18C;&#xAC00; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xAC00; &#xC544;&#xB2C8;&#xBA70; &#xB9E4;&#xD551;&#xB418;&#xC5B4;&#xC11C;&#xB294; &#xC548; &#xB418;&#xB294; &#xD558;&#xC704; 0x10000 &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xC8FC;&#xC18C;&#xAC00; &#xC544;&#xB2CC;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; &#xB300;&#xC0C1; RIP&#xAC00; &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC758; &#xC774;&#xC804; &#xC8FC;&#xC18C;&#xC778; &#xACBD;&#xC6B0;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xD574;&#xB2F9; &#xAE30;&#xBCF8; &#xD2B8;&#xB7A9; &#xD504;&#xB808;&#xC784;&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xACE0; &#xB300;&#xC0C1; RIP&#xAC00; &#xD574;&#xB2F9; &#xD2B8;&#xB7A9; &#xD504;&#xB808;&#xC784;&#xC758; RIP&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD574; <code>NtSetThreadContext</code>&#xAC00; &#xCC98;&#xC74C; &#xD638;&#xCD9C;&#xB418;&#xACE0; RIP&#xAC00; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xCD08;&#xAE30; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB85C; &#xC124;&#xC815;&#xB420; &#xB54C; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0;&#xB9CC; &#xC77C;&#xBC18;&#xC801;&#xC774;&#xC9C0; &#xC54A;&#xC740; &#xB2E4;&#xB978; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;.</p>
<p>&#xC774; &#xD568;&#xC218;&#xB294; <code>KCONTINUE_TYPE</code>&#xC744; &#xC218;&#xC2E0;&#xD558;&#xACE0; &#xD574;&#xB2F9; &#xAC12;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xC591;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB300;&#xC0C1; RIP&#xB97C; &#xCC98;&#xB9AC;&#xD55C;&#xB2E4;. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xACBD;&#xC6B0; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC744; &#xBC18;&#xBCF5;&#xD558;&#xACE0; &#xB300;&#xC0C1; RIP&#xB97C; &#xAC80;&#xC0C9;&#xD558;&#xB294;&#xB370;, &#xCC3E;&#xC9C0; &#xBABB;&#xD558;&#xBA74; &#xC608;&#xC678;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA70; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xC5D0; &#xB3C4;&#xB2EC;&#xD560; &#xB54C;&#xAE4C;&#xC9C0; &#xACC4;&#xC18D; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;. &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xB294; &#xC81C;&#xACF5;&#xB41C; <code>KCONTINUE_TYPE</code>&#xC774; <code>KCONTINUE_UNWIND</code>&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0; <code>KCONTINUE_UNWIND</code> &#xD50C;&#xB798;&#xADF8;&#xC640; &#xD568;&#xAED8; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/RtlVerifyUserUnwindTarget.c">RtlVerifyUserUnwindTarget</a>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC774; &#xAE30;&#xB2A5;&#xC740; &#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xB294; &#xB354; &#xBCF5;&#xC7A1;&#xD55C; &#xAC80;&#xC0AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; RIP&#xB97C; &#xB2E4;&#xC2DC; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</p>
<p>&#xB2E4;&#xB978; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; <code>STATUS_SET_CONTEXT_DENIED</code>&#xB97C; &#xBC18;&#xD658;&#xD558;&#xC5EC; EPROCESS&#xC5D0; <code>AuditUserCetSetContextIpValidation</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xC6B0; &#xC2E4;&#xD328; &#xAC80;&#xC0AC;&#xB97C; &#xC704;&#xD574; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a>&#xC774; <code>KiLogUserCetSetContextIpValidationAudit</code>&#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD55C;&#xB2E4;. &#xC774; &#xAC80;&#xC0AC;(auditing)&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4; mitigation ETW &#xCC44;&#xB110;&#xC744; &#xD1B5;&#xD574; &#xC218;&#xD589;&#xB418;&#xB294; &#xB300;&#xC2E0; WER (Windows &#xC624;&#xB958;&#xBCF4;&#xACE0;) &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xBE60;&#xB978; &#xC2E4;&#xD328; &#xC608;&#xC678;&#xB97C; &#xC9C1;&#xC811; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xB41C;&#xB2E4;. (<code>FAST_FAIL_SET_CONTEXT_DENIED</code>&#xB85C; &#xC124;&#xC815;&#xB41C; &#xC815;&#xBCF4;&#xB85C; <code>0xC000409</code> &#xC608;&#xC678;&#xB97C; &#xC804;&#xC1A1;). WER &#xC2A4;&#xD338;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; <code>AuditUserCetSetContextIpValidationLogged</code>&#xB77C;&#xB294; &#xB610; &#xB2E4;&#xB978; EPROCESS &#xBE44;&#xD2B8;&#xAC00; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p>
<p>&#xC2A4;&#xB808;&#xB4DC;&#xAC00; &#xC885;&#xB8CC;&#xB418;&#xACE0; &#xD604;&#xC7AC; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD; &#xC8FC;&#xC18C;&#xAC00; &#xD398;&#xC774;&#xC9C0;&#xB85C; &#xC815;&#xB82C;&#xB41C; &#xACBD;&#xC6B0; &#xD568;&#xC218;&#xAC00; &#xB300;&#xC0C1; RIP&#xB97C; &#xCC3E;&#xAE30; &#xC804;&#xC5D0; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC5D0; &#xB300;&#xD55C; &#xB8E8;&#xD504;&#xB97C; &#xC911;&#xC9C0;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xB2E4;. &#xC989;, &#xC2A4;&#xB808;&#xB4DC;&#xB97C; &#xC885;&#xB8CC;&#xD560; &#xB54C; &#xD568;&#xC218;&#xB294; &#xCD5C;&#xC6B0;&#xC120;&#xC801;&#xC73C;&#xB85C; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC758; &#xD604;&#xC7AC; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C;&#xB9CC; &#xB300;&#xC0C1; RIP&#xB97C; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xD574;&#xB2F9; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xB300;&#xC0C1; RIP&#xB97C; &#xCC3E;&#xC9C0; &#xBABB;&#xD558;&#xBA74; <code>STATUS_THREAD_IS_TERMINATING</code>&#xC744; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</p>
<p>&#xD568;&#xC218;&#xB294; <code>KCONTINUE_TYPE</code> &#xC774; <code>KCONTINUE_LONGJUMP</code> &#xC778; &#xACBD;&#xC6B0; &#xB300;&#xC0C1; RIP&#xAC00; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC5D0; &#xB300;&#xD574; &#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xB300;&#xC2E0; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/RtlVerifyUserUnwindTarget.c">RtlVerifyUserUnwindTarget</a>&#xC774; <code>KCONTINUE_LONGJUMP</code> &#xD50C;&#xB798;&#xADF8;&#xC640; &#xD568;&#xAED8; &#xD638;&#xCD9C;&#xB418;&#xC5B4; PE Image Load Configuration Directory&#xC758; <code>longjmp</code> &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; RIP&#xB97C; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xC774; &#xAE00;&#xC758; &#xB2E4;&#xC74C; &#xC139;&#xC158;&#xC5D0;&#xC11C; &#xC774; &#xD45C;&#xC640; &#xAC80;&#xC0AC;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD55C;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/6.png" srcset="/img/loading.gif" alt></p>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a>&#xC740; &#xB2E4;&#xC74C; &#xB450; &#xD568;&#xC218; &#xC911; &#xD558;&#xB098;&#xC5D0; &#xC758;&#xD574; &#xD638;&#xCD9C;&#xB41C;&#xB2E4;.</p>
<ul>
<li><code>PspGetSetContextInternal</code> &#x2013; <code>NtSetContextThread API</code>&#xC5D0; &#xB300;&#xD55C; &#xC751;&#xB2F5;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB41C;&#xB2E4;</li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextRecord.c">KiVerifyContextRecord</a> &#x2013; <code>NtContinueEx</code>, <code>NtRaiseException</code> &#xBC0F; &#xC77C;&#xBD80; &#xACBD;&#xC6B0; <code>NtSetContextThread</code> API&#xC5D0; &#xB300;&#xD55C; &#xC751;&#xB2F5;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB41C;&#xB2E4;. <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KeVerifyContextIpForUserCet.c">KeVerifyContextIpForUserCet</a>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804;&#xC5D0; (&#xC218;&#xC2E0;&#xB41C; <code>ContinueArgument</code>&#xAC00; NULL&#xC774; &#xC544;&#xB2CC; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC;)&#xC774; &#xD568;&#xC218;&#xB294; &#xD638;&#xCD9C;&#xC790;&#xAC00; CS &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC218;&#xC815;&#xD558;&#xB824;&#xACE0; &#xD558;&#xB294;&#xC9C0;, &#xC0C8; &#xAC12;&#xC774; &#xC720;&#xD6A8;&#xD55C; &#xAC12;&#xC778;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD55C;&#xB2E4;. WOW64&#xAC00; &#xC544;&#xB2CC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xD53C;&#xCF54; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC774;&#xBA70;, &#xC774; &#xACBD;&#xC6B0; CS&#xB97C; <code>KGDT64_R3_CODE</code> &#xB610;&#xB294; <code>KGDT64_R3_CMCODE</code>&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xB2E4;&#xB978; &#xAC12;&#xC740; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/KiVerifyContextRecord.c">KiVerifyContextRecord</a>&#xAC00; &#xC0C8; CS &#xAC12;&#xC744; <code>KGDT64_R3_CODE</code>&#xB85C; &#xAC15;&#xC81C;&#xD55C;&#xB2E4;. <code>KiVerifyContextRecord</code>&#xB294; <code>KiContinuePreviousModeUser</code> &#xB610;&#xB294; <code>KeVerifyContextRecord</code>&#xC5D0; &#xC758;&#xD574; &#xD638;&#xCD9C;&#xB418;&#xBA70; &#xB450; &#xBC88;&#xC9F8;&#xC758; &#xACBD;&#xC6B0;, &#xD568;&#xC218;&#xB294; RSP&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC2A4;&#xD0DD; (native &#xB610;&#xB294; wow64) &#xC911; &#xD558;&#xB098;&#xC5D0; &#xC788;&#xACE0; 64 &#xBE44;&#xD2B8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; CS&#xB97C; <code>KGDT64_R3_CODE</code>&#xB85C;&#xB9CC; &#xC124;&#xC815;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</li>
</ul>
<p><code>KeVerifyContextIpForUserCet</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB300;&#xC0C1; RIP&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xACBD;&#xB85C;&#xB294; &#xBA3C;&#xC800; <code>KeVerifyContextXStateCetU</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB300;&#xC0C1; SSP&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xACE0; SSP&#xAC00; &#xC720;&#xD6A8;&#xD560; &#xB54C;&#xB9CC; RIP &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD55C;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/7.png" srcset="/img/loading.gif" alt></p>
<h1 id="&#xC608;&#xC678;-&#xD574;&#xC81C;-&#xBC0F;-longjmp-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;"><a href="#&#xC608;&#xC678;-&#xD574;&#xC81C;-&#xBC0F;-longjmp-&#xC720;&#xD6A8;&#xC131;-&#xAC80;&#xC0AC;" class="headerlink" title="&#xC608;&#xC678; &#xD574;&#xC81C; &#xBC0F; longjmp &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;"></a>&#xC608;&#xC678; &#xD574;&#xC81C; &#xBC0F; longjmp &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;</h1><p>&#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xB300;&#xB85C; <code>KCONTEXT_SET</code> &#xBC0F; <code>KCONTEXT_RESUME</code>&#xC5D0; &#xB300;&#xD55C; &#xCC98;&#xB9AC;&#xB294; &#xB300;&#xC0C1; RIP&#xAC00; &#xC100;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0DD;&#xC758; &#xC77C;&#xBD80;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xACFC; &#xAD00;&#xB828;&#xC774; &#xC788;&#xC9C0;&#xB9CC; <code>KCONTEXT_UNWIND</code> &#xBC0F; <code>KCONTEXT_LONGJMP</code> &#xACBD;&#xC6B0;&#xC5D0;&#xB294; <code>RtlVerifyUserUnwindTarget</code>&#xC744; &#xD1B5;&#xD55C; &#xD655;&#xC7A5;&#xB41C; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;. &#xC774; &#xB450; &#xBC88;&#xC9F8; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xB97C; &#xC704;&#xD574;&#xC11C;&#xB294; PE &#xD30C;&#xC77C; &#xD615;&#xC2DD; (&#xBC0F; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xC9C0;&#xC6D0;)&#xC744; &#xBCC0;&#xACBD;&#xD574;&#xC57C; &#xD558;&#xBA70; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xC9C0;&#xC6D0;&#xC744; &#xC704;&#xD574; <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/yardenshafir/cet-research/blob/master/src/NtSetInformationProcess.c">NtSetInformationProcess</a>&#xC5D0; &#xCD94;&#xAC00;&#xB41C; &#xC0C8;&#xB85C;&#xC6B4; OS &#xC218;&#xC900;&#xC758; &#xC815;&#xBCF4; &#xD074;&#xB798;&#xC2A4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB2E4;.</p>
<p>CFG (Control Flow Guard) &#xC9C0;&#xC6D0;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC774;&#xBBF8; &#xCD94;&#xAC00;&#xB41C; PE &#xD30C;&#xC77C; &#xB0B4;&#xBD80;&#xC758; <code>Image Load Configuration Directory</code>&#xC5D0;&#xB294; &#xD604;&#xC7AC; &#xC124;&#xC815;&#xB41C; <code>jmp/longjmp</code> &#xC30D;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBD84;&#xAE30; &#xC720;&#xD6A8; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70;, &#xC774; &#xC815;&#xBCF4;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xC2DD;&#xBCC4;&#xD574; &#xB9C1;&#xCEE4;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xB3C4;&#xB85D; &#xB418;&#xC5B4; &#xC788;&#xB2E4;. CET&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC774; &#xAE30;&#xC874; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC7AC;&#xC0AC;&#xC6A9;&#xB418;&#xC9C0;&#xB9CC; &#xC5F0;&#xC18D; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC; &#xC9C0;&#xC6D0;&#xC744; &#xC704;&#xD574; &#xB610; &#xB2E4;&#xB978; &#xD14C;&#xC774;&#xBE14;&#xACFC; &#xD06C;&#xAE30;&#xAC00; &#xCD94;&#xAC00;&#xB41C;&#xB2E4;. Visual Studio 2017&#xC740; <code>longjmp</code> &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC9C0;&#xB9CC; Visual Studio 2019&#xBD80;&#xD130; &#xC704;&#xC640; &#xAC19;&#xC740; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;.</p>
<p>&#xC774; &#xB9C8;&#xC9C0;&#xB9C9; &#xC139;&#xC158;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xD615;&#xC2DD;&#xACFC; &#xCEE4;&#xB110;&#xC774; &#xB9C8;&#xC9C0;&#xB9C9; &#xB450; &#xAC00;&#xC9C0; &#xC720;&#xD615;&#xC758; <code>KCONTINUE_TYPE</code> &#xC81C;&#xC5B4; &#xD750;&#xB984;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xB2E4;.</p>
<h2 id="PE-&#xBA54;&#xD0C0;-&#xB370;&#xC774;&#xD130;-&#xD14C;&#xC774;&#xBE14;"><a href="#PE-&#xBA54;&#xD0C0;-&#xB370;&#xC774;&#xD130;-&#xD14C;&#xC774;&#xBE14;" class="headerlink" title="PE &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130; &#xD14C;&#xC774;&#xBE14;"></a>PE &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130; &#xD14C;&#xC774;&#xBE14;</h2><p>Windows 10&#xC740; Control Flow Guard &#xC774;&#xBBF8;&#xC9C0;&#xC5D0; &#xC788;&#xB294; &#xD45C;&#xC900; GFIDS &#xD14C;&#xC774;&#xBE14; &#xC678;&#xC5D0;&#xB3C4;  RVA&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xB294; <code>.gljmp</code>&#xB77C;&#xB294; PE Image Load Configuration&#xC758; <code>Guard Long Jump Target Table</code> &#xD544;&#xB4DC;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; PE &#xC139;&#xC158;&#xC758; Long Jump Target Table&#xC744; &#xD3EC;&#xD568;&#xD558;&#xC5EC; longjump &#xB300;&#xC0C1;&#xC758; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xC5D0; &#xB300;&#xD55C; &#xC9C0;&#xC6D0;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xB2E4;.</p>
<p><code>setjmp</code>&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xC774; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB420; &#xB54C;&#xB9C8;&#xB2E4; &#xBC18;&#xD658; &#xC8FC;&#xC18C; (longjmp&#xAC00; &#xBD84;&#xAE30;&#xB418;&#xB294; &#xC704;&#xCE58;)&#xC758; RVA&#xAC00; &#xC774; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xCD94;&#xAC00;&#xB41C;&#xB2E4;. &#xC774; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xC874;&#xC7AC; &#xC5EC;&#xBD80;&#xB294; Image Load Configuration Directory&#xC758; <code>GuardFlags</code>&#xC5D0; &#xC788;&#xB294; <code>IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT</code> &#xD50C;&#xB798;&#xADF8;&#xC5D0; &#xC758;&#xD574; &#xACB0;&#xC815;&#xB418;&#xBA70; <code>GuardLongJumpTargetCount</code> &#xD544;&#xB4DC;&#xC5D0; &#xD45C;&#xC2DC;&#xB41C; &#xB9CC;&#xD07C;&#xC758; &#xD56D;&#xBAA9;&#xC744; &#xD3EC;&#xD568;&#xD55C;&#xB2E4;.</p>
<p>&#xAC01; &#xD56D;&#xBAA9;&#xC740; 4 &#xBC14;&#xC774;&#xD2B8; RVA&#xC640; n &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xC774;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; n&#xC740; <code>(GuardFlags &amp; IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK) &gt;&gt; IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_SHIFT</code>&#xC758; &#xACB0;&#xACFC;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628;&#xB2E4;. &#xC774; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xACBD;&#xC6B0; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC815;&#xC758;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBBC0;&#xB85C; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130; &#xBC14;&#xC774;&#xD2B8;&#xB294; &#xD56D;&#xC0C1; 0&#xC774; &#xB420; &#xAC83;&#xC73C;&#xB85C; &#xC608;&#xC0C1;&#xB41C;&#xB2E4;. &#xC774; &#xACC4;&#xC0B0;&#xC740; <code>GFIDS</code> &#xD14C;&#xC774;&#xBE14; (<code>export suppression</code>&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xC74C;)&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C; &#xACC4;&#xC0B0;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD558;&#xB098; &#xC774;&#xC0C1;&#xC758; CFG &#xB300;&#xC0C1;&#xC744; &#xC5B5;&#xC81C;&#xD558;&#xBA74; 1 &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xBE48; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;&#xAC00; Long Jump Target Target Table&#xC758; &#xBAA8;&#xB4E0; &#xD56D;&#xBAA9;&#xC5D0; &#xCD94;&#xAC00;&#xB41C;&#xB2E4;.</p>
<p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xB2E4;&#xC74C;&#xC740; &#xB450; &#xAC1C;&#xC758; <code>longjmp</code> &#xB300;&#xC0C1;&#xC774; &#xC788;&#xB294; PE &#xD30C;&#xC77C;&#xC774;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/8.png" srcset="/img/loading.gif" alt></p>
<p>&#xC774; &#xC774;&#xBBF8;&#xC9C0;&#xB3C4; CFG &#xB0B4;&#xBCF4;&#xB0B4;&#xAE30; &#xC5B5;&#xC81C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; <code>GuardFlags</code>&#xC758; &#xC0C1;&#xC704; &#xB2C8;&#xBE14; (<code>IMAGE_GUARD_CF_FUNCTION_TABLE_SIZE_MASK</code>&#xC5D0; &#xD574;&#xB2F9;)&#xC5D0; &#xC788;&#xB294; &#xAC12; 1&#xC5D0; &#xC720;&#xC758;&#xD558;&#xC790;. &#xC774;&#xB294; &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB294; Long Jump Target Table&#xC5D0; 1 &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xCD94;&#xAC00; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xC74C;&#xC744; &#xC54C;&#xB824;&#xC900;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/9.png" srcset="/img/loading.gif" alt></p>
<p><code>Windows 10 20H1</code>&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xC720;&#xD615;&#xC758; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130;&#xB294; &#xC5F0;&#xC18D; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xAC00; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; &#xC81C;&#xC5B4; &#xD750;&#xB984;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xC5D0; &#xD3EC;&#xD568;&#xB41C;&#xB2E4;. &#xB450; &#xAC1C;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xD544;&#xB4DC; <code>GuardEHContinuationTable</code> &#xBC0F; <code>GuardEHContinuationCount</code>&#xAC00; Image Load Configuration Directory &#xB05D;&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xACE0; <code>IMAGE_GUARD_EH_CONTINUATION_TABLE_PRESENT</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; <code>GuardFlags</code>&#xC5D0; &#xD3EC;&#xD568;&#xB41C;&#xB2E4;. &#xC774; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xB808;&#xC774;&#xC544;&#xC6C3;&#xC740; <code>GuardFlags</code>&#xC758; &#xC0C1;&#xC704; &#xB2C8;&#xBE14;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130; &#xBC14;&#xC774;&#xD2B8; &#xCD94;&#xAC00;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC5EC; Long Jump Target Table&#xC5D0; &#xB300;&#xD574; &#xD45C;&#xC2DC;&#xB41C; &#xAC83;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xB2E4;.</p>
<p>&#xC548;&#xD0C0;&#xAE5D;&#xAC8C;&#xB3C4; Visual Studio 2019 &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB3C4; &#xC774; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C; &#xD604;&#xC7AC; &#xC608;&#xC81C;&#xB97C; &#xBCF4;&#xC5EC;&#xC904; &#xC218; &#xC5C6;&#xB2E4;. &#xC774; &#xBD84;&#xC11D;&#xC740; &#xB098;&#xC911;&#xC5D0; &#xC124;&#xBA85;&#xD558;&#xB294; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; &#xCF54;&#xB4DC;&#xC640; 20H1 SDK&#xC758; <code>Ntimage.h</code> &#xD5E4;&#xB354; &#xD30C;&#xC77C;&#xC744; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1; &#xD55C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C;&#xB2E4;.</p>
<h2 id="&#xC0AC;&#xC6A9;&#xC790;-&#xBC18;&#xC804;-&#xAE30;&#xB2A5;-&#xD14C;&#xC774;&#xBE14;"><a href="#&#xC0AC;&#xC6A9;&#xC790;-&#xBC18;&#xC804;-&#xAE30;&#xB2A5;-&#xD14C;&#xC774;&#xBE14;" class="headerlink" title="&#xC0AC;&#xC6A9;&#xC790; &#xBC18;&#xC804; &#xAE30;&#xB2A5; &#xD14C;&#xC774;&#xBE14;"></a>&#xC0AC;&#xC6A9;&#xC790; &#xBC18;&#xC804; &#xAE30;&#xB2A5; &#xD14C;&#xC774;&#xBE14;</h2><p>&#xC774;&#xC81C; longjmp &#xB300;&#xC0C1; &#xB610;&#xB294; &#xC5F0;&#xC18D; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xB85C; &#xBD84;&#xAE30;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBCC0;&#xACBD;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC74C;&#xC744; &#xC54C;&#xACE0; &#xC788;&#xC73C;&#xBBC0;&#xB85C; CONTEXT_EX&#xC5D0; &#xC788;&#xB294; RIP &#xC8FC;&#xC18C;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC774; &#xB450; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC744;&#xAE4C;? NtContinueEx &#xC804;&#xD654;? &#xC774;&#xB7F0; &#xC791;&#xC5C5;&#xC740; &#xD2B9;&#xC815; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589;&#xC5D0;&#xC11C; &#xC790;&#xC8FC; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xCEE4;&#xB110;&#xC740; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD6A8;&#xC728;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC774; &#xD544;&#xC694;&#xD558;&#xB2E4;.</p>
<p><code>Inverted Function Table</code>&#xC758; &#xAC1C;&#xB150;&#xC5D0; &#xC774;&#xBBF8; &#xC775;&#xC219;&#xD560; &#xAC83;&#xC774;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xD14C;&#xC774;&#xBE14;&#xC740; <code>Ntdll.dll (LdrpInvertedFunctionTable)</code> &#xC5D0;&#xC11C; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC608;&#xC678; &#xCC98;&#xB9AC; &#xC911; &#xD574;&#xC81C; opcode &#xBC0F; &#xC608;&#xC678; &#xB370;&#xC774;&#xD130;&#xB97C; &#xCC3E;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;. (<code>.pdata</code> &#xC139;&#xC158;&#xC744; &#xCC3E;&#xC544;&#xC11C;) <code>Ntoskrnl.exe (PsInvertedFunctionTable)</code>&#xC5D0; &#xB610; &#xB2E4;&#xB978; &#xD14C;&#xC774;&#xBE14;&#xC774; &#xC788;&#xC73C;&#xBA70; &#xCEE4;&#xB110; &#xBAA8;&#xB4DC; &#xC608;&#xC678; &#xCC98;&#xB9AC; &#xBC0F; PatchGuard &#xAC80;&#xC0AC;&#xC758; &#xC77C;&#xBD80;&#xC5D0; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.</p>
<p>&#xAC04;&#xB2E8;&#xD788; &#xB9D0;&#xD574; <code>Inverted Function Table</code>&#xC740; &#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4E0; &#xC720;&#xC800;/&#xCEE4;&#xB110; &#xBAA8;&#xB4C8; &#xD06C;&#xAE30;&#xC640; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xBCC4;&#xB85C; &#xC815;&#xB82C;&#xB41C; PE &#xC608;&#xC678; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xBC30;&#xC5F4;&#xC774;&#xB2E4;. &#xC774; &#xBC30;&#xC5F4;&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xAC83;&#xC774; PE &#xD5E4;&#xB354;&#xB97C; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD55C; &#xB4A4; &#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4C8; &#xC5F0;&#xACB0; &#xBAA9;&#xB85D;&#xC744; &#xAC80;&#xC0C9;&#xD558;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; &#xD6E8;&#xC52C; &#xBE60;&#xB974;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC5ED;&#xD568;&#xC218; &#xD14C;&#xC774;&#xBE14;&#xC758; binary search&#xB294; &#xB85C;&#xADF8;(n) &#xC870;&#xD68C;&#xC5D0;&#xC11C;&#xB9CC; &#xD574;&#xB2F9; &#xBAA8;&#xB4C8;&#xC758; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xCC3E;&#xB294;&#xB2E4;. &#xD604;&#xC7AC; Microsoft&#xC758; &#xBA85;&#xC131;&#xC744; &#xC5BB;&#xACE0; &#xC788;&#xB294; Ken Johnson&#xACFC; Matt Miller&#xB294; &#xC774;&#xC804;&#xC5D0; Uninformed Magazine&#xC5D0; <a target="_blank" rel="external nofollow noopener noreferrer" href="http://uninformed.org/index.cgi?v=8&amp;a=2&amp;p=20">&#xCEE4;&#xB110; &#xBAA8;&#xB4DC; &#xD6C4;&#xD0B9; &#xAE30;&#xC220;</a>&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xC0AC;&#xC758; &#xC77C;&#xBD80;&#xB85C; &#xAC1C;&#xC694;&#xB97C; &#xAC8C;&#xC2DC;&#xD588;&#xB2E4;.</p>
<p>&#xADF8;&#xB7EC;&#xB098; &#xC774;&#xC804;&#xC5D0;&#xB294; <code>Ntdll.dll</code>&#xC740; &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xC608;&#xC678;&#xB9CC;, <code>Ntoskrnl.exe</code>&#xB294; &#xCEE4;&#xB110; &#xBAA8;&#xB4DC; &#xC608;&#xC678;&#xB9CC; &#xAC80;&#xC0AC;&#xD588;&#xB2E4;. <code>20H1</code>&#xC758; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC740; &#xCEE4;&#xB110;&#xB3C4; &#xC0AC;&#xC6A9;&#xC790; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xAC80;&#xC0AC;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC774;&#xB2E4;. <code>longjmp</code> &#xBC0F; &#xC608;&#xC678; &#xC5F0;&#xC18D;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB370; &#xD544;&#xC694;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xB85C;&#xC9C1;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; <code>RtlpLookupUserFunctionTableInverted</code> &#xD568;&#xC218;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5B4; <code>KeUserInvertedFunctionTable</code> &#xBCC0;&#xC218;&#xB97C; &#xC2A4;&#xCE94;&#xD558;&#xACE0; <code>Ntdll.dll</code>&#xC5D0;&#xC11C; &#xD604;&#xC7AC; &#xB0B4;&#xBCF4;&#xB0B8; <code>LdrpInvertedFunctionTable</code> &#xC2EC;&#xBCFC;&#xC5D0; &#xB9E4;&#xD551;&#xB41C;&#xB2E4;.</p>
<p>&#xC774;&#xAC83;&#xC740; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xD3EC;&#xB80C;&#xC2DD; &#xAE30;&#xB2A5;&#xC73C;&#xB85C;, &#xCEE4;&#xB110;&#xC5D0;&#xC11C; PEB&#xC758; &#xB85C;&#xB354; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAD6C;&#xBB38; &#xBD84;&#xC11D;&#xD558;&#xAC70;&#xB098; VAD&#xB97C; &#xC5F4;&#xAC70;&#xD560; &#xD544;&#xC694; &#xC5C6;&#xC774; &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB0B4;&#xC5D0; &#xB85C;&#xB4DC;&#xB41C; &#xC720;&#xC800; &#xBAA8;&#xB4DC; &#xBAA8;&#xB4C8;&#xC744; &#xC27D;&#xAC8C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xB2E4;&#xC74C;&#xC740; <code>Csrss.exe</code>&#xC5D0;&#xC11C; &#xD604;&#xC7AC; &#xB85C;&#xB4DC;&#xB41C; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xBCF4;&#xB294; &#xBC29;&#xBC95;&#xC774;&#xB2E4;.</p>
<pre><code class="hljs c">dx @$cursession.Processes.Where(p =&gt; p.Name == <span class="hljs-string">&quot;csrss.exe&quot;</span>).First().SwitchTo()
dx -r0 @$table = *(nt!_INVERTED_FUNCTION_TABLE**)&amp;nt!KeUserInvertedFunctionTable
dx -g @$table-&gt;TableEntry.Take(@$table-&gt;CurrentSize)</code></pre>
<p>&#xC989;, &#xC6D0;&#xACA9;&#xC5D0;&#xC11C;&#xB3C4; &#xD2B9;&#xD788; <code>unwind opcode</code> &#xAC00;&#xC5C6;&#xB294; x86 &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xBBF8;&#xC9C0;&#xAC00; &#xC608;&#xC678; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xD3EC;&#xD568;&#xB418;&#xC9C0; &#xC54A;&#xC744; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC73C;&#xBA70;, <code>.pdata</code>&#xB294; <code>/SAFESEH</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC801;&#xC5B4;&#xB3C4; &#xD558;&#xB098;&#xC758; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xAC00; &#xC788;&#xB294; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xC0DD;&#xC131;&#xB41C;&#xB2E4;.</p>
<p>&#xC774;&#xB7EC;&#xD55C; &#xC0C1;&#xD669;&#xC5D0;&#xC11C;&#xB294; <code>RtlpLookupUserFunctionTableInverted</code>&#xAC00; &#xC2E4;&#xD328;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xB300;&#xC2E0; <code>MmGetImageBase</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xAC83;&#xC740; &#xC785;&#xB825; RIP&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC601;&#xC5ED;&#xC744; &#xB9E4;&#xD551;&#xD558;&#xB294; VAD&#xB97C; &#xC870;&#xD68C;&#xD558;&#xACE0; &#xC774;&#xBBF8;&#xC9C0; VAD &#xC778; &#xACBD;&#xC6B0; &#xD574;&#xB2F9; &#xC601;&#xC5ED;&#xC758; &#xAE30;&#xBCF8; &#xC8FC;&#xC18C;&#xC640; &#xD06C;&#xAE30; (&#xBAA8;&#xB4C8;&#xC758; &#xD06C;&#xAE30;&#xC640; &#xC77C;&#xCE58;&#xD574;&#xC57C; &#xD568;)&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</p>
<p><img src="/2021/01/17/l0ch/cet-on-windows/10.png" srcset="/img/loading.gif" alt></p>
<h2 id="&#xC5F0;&#xC18D;&#xB41C;-&#xB300;&#xC0C1;&#xC5D0;-&#xB300;&#xD55C;-&#xB3D9;&#xC801;-&#xC608;&#xC678;-&#xD578;&#xB4E4;&#xB7EC;"><a href="#&#xC5F0;&#xC18D;&#xB41C;-&#xB300;&#xC0C1;&#xC5D0;-&#xB300;&#xD55C;-&#xB3D9;&#xC801;-&#xC608;&#xC678;-&#xD578;&#xB4E4;&#xB7EC;" class="headerlink" title="&#xC5F0;&#xC18D;&#xB41C; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xB3D9;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;"></a>&#xC5F0;&#xC18D;&#xB41C; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xB3D9;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;</h2><p><code>KCONTINUE_UNWIND</code> &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294;&#xB370; &#xB9C8;&#xC9C0;&#xB9C9; &#xC7A5;&#xC560;&#xBB3C;&#xC774; &#xD558;&#xB098; &#xC788;&#xB2E4;. &#xC815;&#xADDC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xB294; &#xCF54;&#xB4DC;&#xC758; <code>__try /__except /__finally</code> &#xC808;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xC5F0;&#xC18D;&#xB41C; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xAC00; &#xC788;&#xC9C0;&#xB9CC; Windows&#xC5D0;&#xC11C;&#xB294; JIT &#xC5D4;&#xC9C4;&#xC774; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD55C; &#xCF54;&#xB4DC;&#xB97C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xC989;&#xC2DC; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC744; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; <code>RtlAddFunctionTable</code> API &#xB4F1;&#xC744; &#xD1B5;&#xD574; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xB97C; &#xB4F1;&#xB85D;&#xD558;&#xACE0; opcode&#xB97C; &#xD574;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xB294; &#xC774;&#xC804;&#xC5D0;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xBAA8;&#xB4DC; stack walking &#xBC0F; &#xC608;&#xC678; &#xD574;&#xC81C;&#xC5D0;&#xB9CC; &#xD544;&#xC694;&#xD588;&#xC9C0;&#xB9CC; &#xC774;&#xC81C;&#xB294; &#xC5F0;&#xC18D; &#xD578;&#xB4E4;&#xB7EC;&#xAC00; &#xCEE4;&#xB110;&#xC774; RIP&#xC5D0; &#xB300;&#xD574; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xC720;&#xD6A8;&#xD55C; &#xAC12;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD574;&#xC57C; &#xD558;&#xB294; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xB300;&#xC0C1;&#xC774; &#xB41C;&#xB2E4;. <code>RtlpFindDynamicEHContinuationTarget</code>&#xC774; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xAC83;&#xC774; &#xB9C8;&#xC9C0;&#xB9C9; &#xAC00;&#xB2A5;&#xC131;&#xC774;&#xB2E4;.</p>
<p>CET &#xC9C0;&#xC6D0; &#xBC0F; <code>NtContinueEx</code> &#xB3C4;&#xC785;&#xC758; &#xC77C;&#xBD80;&#xB85C; EPROCESS &#xAD6C;&#xC870;&#xB294; <code>DynamicEHContinuationTargetsLock</code> &#xBC0F; <code>DynamicEHContinuationTargetsTree</code>&#xB77C;&#xB294; &#xB450; &#xAC1C;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xD544;&#xB4DC;&#xB85C; &#xD5A5;&#xC0C1;&#xB418;&#xC5C8;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8;&#xB294; <code>EX_PUSH_LOCK</code>&#xC774;&#xACE0; &#xB450; &#xBC88;&#xC9F8;&#xB294; &#xBAA8;&#xB4E0; &#xC720;&#xD6A8;&#xD55C; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC; &#xC8FC;&#xC18C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>RTL_RB_TREE</code>&#xC774;&#xB2E4;. &#xC774; &#xD2B8;&#xB9AC;&#xB294; <code>PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION</code> &#xC720;&#xD615;&#xC758; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC640; &#xD568;&#xAED8; &#xC0C8;&#xB85C;&#xC6B4; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC815;&#xBCF4; &#xD074;&#xB798;&#xC2A4; &#xC778; <code>ProcessDynamicEHContinuationTargets</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>NtSetInformationProcess</code>&#xC5D0; &#xB300;&#xD55C; &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; &#xAD00;&#xB9AC;&#xB41C;&#xB2E4;. &#xB354; &#xC27D;&#xAC8C; &#xC774;&#xD574;&#xD558;&#xB824;&#xBA74; &#xC774;&#xB7EC;&#xD55C; &#xAD6C;&#xC870; &#xBC0F; &#xD50C;&#xB798;&#xADF8;&#xC5D0; &#xB300;&#xD55C; &#xC544;&#xB798; &#xC815;&#xC758;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xBA74; &#xB41C;&#xB2E4;.</p>
<pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DYNAMIC_EH_CONTINUATION_TARGET_ADD          0x01</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DYNAMIC_EH_CONTINUATION_TARGET_PROCESSED    0x02</span>

<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">PROCESS_DYNAMIC_EH_CONTINUATION_TARGET</span></span>
<span class="hljs-class">{</span> 
    ULONG_PTR TargetAddress;
    ULONGLONG Flags;
} PROCESS_DYNAMIC_EH_CONTINUATION_TARGET, *PPROCESS_DYNAMIC_EH_CONTINUATION_TARGET;

<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION</span></span>
<span class="hljs-class">{</span>
    USHORT NumberOfTargets;
    USHORT Reserved;
    ULONG Reserved2;
    PPROCESS_DYNAMIC_EH_CONTINUATION_TARGET* Targets;
} PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION, *PPROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION;</code></pre>
<p><code>PspProcessDynamicEHContinuationTargets</code> &#xD568;&#xC218;&#xAC00; &#xC774; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBC18;&#xBCF5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD638;&#xCD9C;&#xB418;&#xBA70;, &#xC774; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; <code>RtlAddDynamicEHContinuationTarget</code>&#xC740; &#xB300;&#xC0C1; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; <code>ETL_RB_TREE_BPROCESS.NODE</code>&#xC5D0; <code>RTL_RB_NODE</code> &#xB9C1;&#xD06C;&#xB97C; &#xC5F0;&#xACB0;&#xD558;&#xB294; <code>DYNAMIC_EH_CONTINUATION_TARGET_ADD</code> &#xD50C;&#xB798;&#xADF8; &#xC138;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xD56D;&#xBAA9;&#xC5D0; &#xB300;&#xD574; &#xD638;&#xCD9C;&#xB418;&#xBA70; &#xBC18;&#xB300;&#xB85C; &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC5C6;&#xC73C;&#xBA74; &#xB300;&#xC0C1;&#xC744; &#xC870;&#xD68C;&#xD558;&#xACE0; &#xC2E4;&#xC81C;&#xB85C; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xC81C;&#xAC70;&#xB418;&#xACE0; &#xB178;&#xB4DC;&#xAC00; &#xD574;&#xC81C;&#xB41C;&#xB2E4;. &#xAC01; &#xD56D;&#xBAA9;&#xC774; &#xCC98;&#xB9AC;&#xB420; &#xB54C; <code>DYNAMIC_EH_CONTINUATION_TARGET_PROCESSED</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC6D0;&#xB798; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xC5D0; OR &#xCC98;&#xB9AC;&#xB418;&#xBBC0;&#xB85C; &#xD638;&#xCD9C;&#xC790;&#xB294; &#xC5B4;&#xB5A4; &#xD56D;&#xBAA9;&#xC774; &#xC791;&#xB3D9;&#xD558;&#xACE0; &#xC791;&#xB3D9;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xB2E4;.</p>
<p>&#xAC00;&#xB2A5;&#xD55C; &#xBAA8;&#xB4E0; ROP &#xAC00;&#xC82F;&#xC774; &#xB2E8;&#xC21C;&#xD788; &#x2018;&#xB3D9;&#xC801; &#xC5F0;&#xC18D; &#xBAA9;&#xD45C;&#x2019;&#xB85C; &#xCD94;&#xAC00;&#xB420; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C;&#xC774; &#xAE30;&#xB2A5;&#xC758; &#xC874;&#xC7AC;&#xB294; CET/CFG&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xAE30;&#xB2A5;&#xC758; &#xBCF4;&#xD3B8;&#xC801;&#xC778; &#xC6B0;&#xD68C;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; Microsoft&#xB294; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC640; Flash&#xC5D0; &#xB300;&#xD55C; <code>out-of-process JIT</code> &#xCEF4;&#xD30C;&#xC77C;&#xB9CC; &#xACF5;&#xC2DD;&#xC801;&#xC73C;&#xB85C; &#xC9C0;&#xC6D0;&#xD558;&#xBBC0;&#xB85C; &#xC774; API&#xB294; &#xC6D0;&#xACA9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C;&#xB9CC; &#xC791;&#xB3D9;&#xD55C;&#xB2E4;&#xB294; &#xC810;&#xC5D0; &#xC720;&#xC758;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xD56D;&#xC0C1; <code>STATUS_ACCESS_DENIED</code>&#xB85C; &#xC2E4;&#xD328;&#xD55C;&#xB2E4;.</p>
<h2 id="&#xD0C0;&#xAC9F;-&#xAC80;&#xC99D;"><a href="#&#xD0C0;&#xAC9F;-&#xAC80;&#xC99D;" class="headerlink" title="&#xD0C0;&#xAC9F; &#xAC80;&#xC99D;"></a>&#xD0C0;&#xAC9F; &#xAC80;&#xC99D;</h2><p>&#xC774; &#xBAA8;&#xB4E0; &#xC9C0;&#xC2DD;&#xC744; &#xD1B5;&#xD569;&#xD558;&#xBA74; <code>RtlVerifyUserUnwindTarget</code> &#xD568;&#xC218;&#xB97C; &#xC124;&#xBA85;&#xD558;&#xAE30; &#xC26C;&#xC6CC;&#xC9C4;&#xB2E4;.</p>
<ol>
<li>CONTEXT_EX &#xAD6C;&#xC870;&#xC5D0;&#xC11C; &#xB300;&#xC0C1; RIP&#xC640; &#xC5F0;&#xAD00;&#xB41C; &#xB85C;&#xB4DC;&#xB41C; PE &#xBAA8;&#xB4C8;&#xC744; &#xC870;&#xD68C;&#xD55C;&#xB2E4;. &#xBA3C;&#xC800; <code>RtlpLookupUserFunctionTableInverted</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC2E4;&#xD328;&#xD558;&#xBA74; &#xB300;&#xC2E0; <code>MmGetImageBase</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBAA8;&#xB4C8;&#xC774; 4GB &#xBBF8;&#xB9CC;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;.</li>
<li>&#xBAA8;&#xB4C8;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xBA74; <code>LdrImageDirectoryEntryToLoadConfig</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; Image Load Configuration Directory&#xB97C; &#xAC00;&#xC838;&#xC628;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; Long Jump &#xB610;&#xB294; &#xC5F0;&#xC18D; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xB3D9;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xD3EC;&#xD568;&#xD560; &#xC218; &#xC788;&#xC744; &#xB9CC;&#xD07C; &#xCDA9;&#xBD84;&#xD788; &#xD070;&#xC9C0;&#xC640; <code>guardflags</code>&#xC5D0; <code>IMAGE_GUARD_CF_LONGJUMP_TABLE_PRESENT</code> &#xB610;&#xB294; <code>IMAGE_GUARD_EH_CONTINUATION_TABLE_PRESENT</code>&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC5C6;&#xAC70;&#xB098; &#xB108;&#xBB34; &#xC791;&#xC740; &#xACBD;&#xC6B0; &#xD639;&#xC740; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xD14C;&#xC774;&#xBE14;&#xC774; &#xC5C6;&#xB294; &#xACBD;&#xC6B0; &#xD638;&#xD658;&#xC131;&#xC744; &#xC704;&#xD574; <code>STATUS_SUCCESS</code>&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</li>
<li>Image Load Configuration Directory&#xC5D0;&#xC11C; <code>GuardLongJumpTargetTable</code> &#xB610;&#xB294; <code>GuardEHContinuationTable</code>&#xC744; &#xAC00;&#xC838;&#xC624;&#xACE0; <code>GuardLongJumpTargetCount</code> &#xB610;&#xB294; <code>GuardEHContinuationCount</code>&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC0AC;&#xD55C;&#xB2E4;. &#xD56D;&#xBAA9;&#xC774; 40&#xC5B5; &#xAC1C; &#xC774;&#xC0C1;&#xC774;&#xBA74; <code>STATUS_INTEGER_OVERFLOW</code>&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;. 0 &#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xD56D;&#xBAA9;&#xC774; &#xC788;&#xB294; &#xACBD;&#xC6B0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xD1B5;&#xD574; bsearch_s (&#xB300;&#xC870;&#xC790;&#xB85C; <code>RtlpTarget Compare</code> &#xB97C; &#xC804;&#xB2EC;)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; binary search&#xB97C; &#xD1B5;&#xD574; RVA&#xB85C; &#xBCC0;&#xD658;&#xD55C; &#xD6C4; &#xB300;&#xC0C1; RIP&#xB97C; &#xCC3E;&#xB294;&#xB2E4;. &#xBC1C;&#xACAC;&#xB418;&#xBA74; <code>STATUS_SUCCESS</code>&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li>
<li>&#xB300;&#xC0C1; RIP&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xAC70;&#xB098; (&#xB610;&#xB294; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xC2DC;&#xC791;&#xD560; &#xD56D;&#xBAA9;&#xC774; 0&#xC778; &#xACBD;&#xC6B0;) &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xB300;&#xC0C1; RIP&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB41C; &#xBAA8;&#xB4C8;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; <code>STATUS_SET_CONTEXT_DENIED</code>&#xB97C; &#xBC18;&#xD658;&#xD574;  <code>longjmp</code> &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC99D;&#xD55C;&#xB2E4;.(<code>KCONTINUE_LONGJUMP</code>)</li>
<li>&#xC608;&#xC678; &#xD574;&#xC81C; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; (<code>KCONTINUE_UNWIND</code>)&#xC758; &#xACBD;&#xC6B0; <code>RtlpFindDynamicEHContinuationTarget</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB4F1;&#xB85D;&#xB41C; &#xC5F0;&#xC18D; &#xB300;&#xC0C1;&#xC5D0; &#xB300;&#xD55C; &#xB3D9;&#xC801; &#xC608;&#xC678; &#xD578;&#xB4E4;&#xB7EC;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD55C;&#xB2E4;. &#xB9DE;&#xC73C;&#xBA74; <code>STATUS_SUCCESS</code>&#xB97C; &#xBC18;&#xD658;&#xD558;&#xACE0;, &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; <code>STATUS_SET_CONTEXT_DENIED</code>&#xB97C; &#xBC18;&#xD658;&#xD55C;&#xB2E4;.</li>
</ol>
<h1 id="&#xACB0;&#xB860;"><a href="#&#xACB0;&#xB860;" class="headerlink" title="&#xACB0;&#xB860;"></a>&#xACB0;&#xB860;</h1><p>CET&#xC758; &#xAD6C;&#xD604;&#xACFC; &#xAD00;&#xB828; mitigation&#xC740; ROP &#xBC0F; &#xAE30;&#xD0C0; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xD558;&#xC774;&#xC7AC;&#xD0B9; &#xAE30;&#xC220;&#xC758; &#xC0AC;&#xC6A9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC8FC;&#xC694; &#xB2E8;&#xACC4;&#xC774;&#xB2E4;. &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBB34;&#xACB0;&#xC131;&#xC740; &#xBD84;&#xBA85; &#xBCF5;&#xC7A1;&#xD55C; &#xC8FC;&#xC81C;&#xC774;&#xBA70;, &#xD5A5;&#xD6C4; &#xCD94;&#xAC00;&#xC801;&#xC778; mitigation&#xC774; &#xCD94;&#xAC00;&#xB428;&#xC5D0; &#xB530;&#xB77C; &#xB354;&#xC6B1; &#xBCF5;&#xC7A1;&#xD574;&#xC9C8; &#xAC83;&#xC774;&#xB2E4;. &#xCD94;&#xAC00;&#xC801;&#xC778; &#xD638;&#xD658;&#xC131; &#xBB38;&#xC81C;&#xC640; &#xC77C;&#xD68C;&#xC131; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB85C; &#xC778;&#xD574; &#xD2B9;&#xC815; &#xCC98;&#xB9AC;&#xB97C; &#xD544;&#xC694;&#xB85C; &#xD558;&#xB294; &#xC0AC;&#xB840;&#xAC00; &#xC810;&#xC810; &#xB354; &#xB9CE;&#xC774; &#xBC1C;&#xACAC;&#xB420; &#xC218; &#xC788;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC644;&#xD654; &#xAE30;&#xC220;, &#xD2B9;&#xD788; &#xB9CE;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; &#xAE30;&#xB2A5;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xAE30;&#xC220;&#xC758; &#xBC1C;&#xC804;&#xB2E8;&#xACC4;&#xC5D0;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAE30; &#xB9C8;&#xB828;&#xC774;&#xACE0;, &#xC6B0;&#xB9AC;&#xB294; &#xC774; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xB354; &#xB9CE;&#xC740; &#xC5F0;&#xAD6C;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9D0;&#xC5D0; &#xB530;&#xB77C; &#xBBF8;&#xB798;&#xC5D0; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xAC83;&#xB4E4;&#xC774; &#xBC1C;&#xACAC;&#xB420; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xD655;&#xC2E0;&#xD55C;&#xB2E4;.</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                <div class="post-meta mr-3">
                  <i class="iconfont icon-category"></i>
                  
                  <a class="hover-with-bg" href="/categories/Translation/">Translation</a>
                  
                </div>
                
                
                <div class="post-meta">
                  <i class="iconfont icon-tags"></i>
                  
                  <a class="hover-with-bg" href="/tags/windows/">windows</a>
                  
                  <a class="hover-with-bg" href="/tags/rop/">rop</a>
                  
                  <a class="hover-with-bg" href="/tags/L0ch/">L0ch</a>
                  
                  <a class="hover-with-bg" href="/tags/cet/">cet</a>
                  
                  <a class="hover-with-bg" href="/tags/mitigation/">mitigation</a>
                  
                  <a class="hover-with-bg" href="/tags/translation/">translation</a>
                  
                </div>
                
              </div>

              <div class="post-metas mb-3">
                <a class="hover-with-bg" style="display: flex;" href="/author">
                  <div class="link-avatar-page">
                    <img src="/img/profile_L0ch.jpg" srcset="/img/loading.gif" alt="L0ch">
                  </div>

                  <div class="link-text">
                    <div class="link-title">L0ch</div>
                  </div>
                </a>
                <div class="link-text">
                  <div class="link-more">
                    <a href="/tags/L0ch">
                      Read more
                      <i class="iconfont icon-arrowdown"></i>
                    </a>
                  </div>
                </div>
              </div>

              <hr>
              <!--<script data-ad-client="ca-pub-3672652207808168" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>-->
              
              
              <div class="post-prevnext row">
                <article class="post-prev col-6">
                  
                  
                  <a href="/2021/01/18/idioth/2021-01-18/">
                    <i class="iconfont icon-arrowleft"></i>
                    <span class="hidden-mobile">[하루한줄] CVE-2020-1394 : Windows LockScreen Escalation of Privilege</span>
                    <span class="visible-mobile">Previous</span>
                  </a>
                  
                </article>
                <article class="post-next col-6">
                  
                  
                  <a href="/2021/01/16/fabu1ous/2021-01-16/">
                    <span class="hidden-mobile">[하루한줄] CVE-2020-26233: Git CLI RCE</span>
                    <span class="visible-mobile">Next</span>
                    <i class="iconfont icon-arrowright"></i>
                  </a>
                  
                </article>
              </div>
              
            </div>
            
            <!-- Embed Section -->
            <div style="width: 100%; height: 210px; margin-bottom: 50px; overflow: hidden;">
              <iframe src="https://maily.so/hackyboiz/embed?src=embed" style="width: 100%; height: 100%; border: none;" frameborder="0"></iframe>
            </div>            

            
            <!-- Comments -->
            <article class="comments" id="comments">
              
              
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'https://hackyboiz.github.io/2021/01/17/l0ch/cet-on-windows/';
        this.page.identifier = '/2021/01/17/l0ch/cet-on-windows/';
      };
      function loadDisqus() {
        (function () {
          var d = document,
            s = d.createElement('script');
          s.src = '//' + 'hackyboiz' + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', new Date());
          (d.head || d.body).appendChild(s);
        })();
      }
      waitElementVisible('disqus_thread', loadDisqus);
    </script>
    <noscript>Please enable JavaScript to view the
      <a target="_blank" href="https://disqus.com/?ref_noscript" rel="external nofollow noopener noreferrer">comments powered by Disqus.</a>
    </noscript>
  </div>


            </article>
            
          </article>
        </div>
      </div>
    </div>
    
    <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
      <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

    </div>
    
  </div>
</div>

<!-- Custom -->

    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="external nofollow noopener noreferrer">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script src="/js/debouncer.js"></script>
<script src="/js/main.js"></script>

<!-- Plugins -->


  
    <script src="/js/lazyload.js"></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script>
  <script src="/js/clipboard-use.js"></script>







  <script src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js"></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "[Translation] R.I.P ROP: CET Internals in Windows 20H1&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js"></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css">

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.staticfile.org/mathjax/3.0.5/es5/tex-svg.js"></script>

  













  

  
    <!-- Google Analytics -->
    <script defer>
      window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) };
      ga.l = +new Date;
      ga('create', 'UA-177243668-2', 'auto');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
  

  
    <!-- Google gtag.js -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-177243668-2"></script>
    <script defer>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-177243668-2');
    </script>
  

  

  

  





</body>
</html>
