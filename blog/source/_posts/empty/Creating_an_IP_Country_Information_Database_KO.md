---
title: "[Research] IP êµ­ê°€ ì •ë³´ ë°ì´í„°ë² ì´ìŠ¤ ë§Œë“¤ê¸° (ko)"
author: empty 
tags: [empty, research, Network, RIR, IP, ipwhois]
categories: [Research]
date: 2025-03-02 11:47:00
cc: false
index_img: /2025/03/02/empty/Creating_an_IP_Country_Information_Database_KO/thumb_kr.jpg
---

![image.png](Creating_an_IP_Country_Information_Database_KO/1.png)

ì•ˆë…•í•˜ì„¸ìš”. emptyì…ë‹ˆë‹¤ğŸ‘‹.  ë³´ì•ˆ ì—…ë¬´ë¥¼ í•˜ë‹¤ ë³´ë©´ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ IPë¥¼ ë¶„ì„í•˜ëŠ” ì¼ì´ ì¦ì€ë°ìš”. ì—¬ëŸ¬ IP ì¡°íšŒ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•´ ë³´ë©´ ì•…ì„± ì—¬ë¶€ì˜ ê²°ê³¼ëŠ” ì„œë¡œ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë‚˜ â€œêµ­ê°€ ì •ë³´, ASN ì •ë³´, ISP ì •ë³´â€ëŠ” ëª¨ë‘ ë™ì¼í•˜ê²Œ ì œê³µë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°ì´í„°ëŠ” ì–´ë””ì„œ ì–´ë–»ê²Œ êµ¬í•´ì„œ ì œê³µí•´ ì£¼ëŠ”ì§€ ê¶ê¸ˆì¦ì´ ìƒê²¨ ì§ì ‘ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤.

# ğŸ”Â IP ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•ë“¤

IP ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ì‹ì€ í¬ê²Œ IP ì •ë³´ ì¡°íšŒ ì„œë¹„ìŠ¤, ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ, Whois í”„ë¡œí† ì½œ ì„¸ ê°€ì§€ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°ê°ì˜ ë°©ë²•ì€ ì†ë„, ì •í™•ì„±, ìµœì‹ ì„±ì´ ë‹¤ë¥´ë¯€ë¡œ ìƒí™©ì— ë§ì¶° ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.

## ğŸŒÂ IP ì •ë³´ ì¡°íšŒ ì„œë¹„ìŠ¤

IP ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ì„œë¹„ìŠ¤ë“¤ì€ ì•…ì„± ì—¬ë¶€ë‚˜ ì‚¬ê¸° ê´€ë ¨ í‰íŒ ì •ë³´ë¥¼, ì¼ë¶€ëŠ” í¬íŠ¸ ìŠ¤ìº” ê²°ê³¼ë¥¼, ë˜ ì¼ë¶€ëŠ” ì§€ë¦¬ì  ìœ„ì¹˜ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ë“±ì˜ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ê³µí†µì ìœ¼ë¡œ êµ­ê°€, ASN, ISP ëª… ë“±ì˜ ê¸°ë³¸ ì •ë³´ëŠ” ë™ì¼í•˜ê²Œ ì œê³µë©ë‹ˆë‹¤.

| **ì„œë¹„ìŠ¤ ì¢…ë¥˜** | **ì£¼ìš” ì„œë¹„ìŠ¤ ëª…** |
| --- | --- |
| í‰íŒ ì¡°íšŒ | Virustotal, AbuseIPDB |
| í¬íŠ¸ ìŠ¤ìºë„ˆ | Censys, Shodan, Criminal IP |
| IP ì§€ë¦¬ì •ë³´ | MaxMind, ipinfo, IP2Location, IPQualityScore |

ì„œë¹„ìŠ¤ ì¢…ë¥˜ì— ë”°ë¼ ì œê³µë˜ëŠ” ë°ì´í„° ë²”ìœ„ì™€ ë‚´ìš©ì—ëŠ” ë¯¸ë¬˜í•œ ì°¨ì´ê°€ ìˆìœ¼ë‚˜, ê±°ì˜ ëª¨ë“  IP ì¡°íšŒ ì„œë¹„ìŠ¤ëŠ” ê³µí†µì ìœ¼ë¡œ êµ­ê°€, ASN, ISP ëª… ì •ë„ëŠ” ì œê³µí•©ë‹ˆë‹¤. ê°œì¸ì ìœ¼ë¡œëŠ” í„°ë¯¸ë„ì—ì„œ curl ëª…ë ¹ì–´ë¡œ ê°„ë‹¨íˆ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” ipinfo ì„œë¹„ìŠ¤ë¥¼ ìì£¼ í™œìš©í•©ë‹ˆë‹¤.

![image.png](Creating_an_IP_Country_Information_Database_KO/2.png)

í¥ë¯¸ë¡œìš´ ì ì€ ì„œë¹„ìŠ¤ë³„ë¡œ IP êµ­ê°€ ì •ë³´ë‚˜ ìœ„ì¹˜ ì •ë³´ê°€ ì„œë¡œ ë‹¤ë¥´ê²Œ í‘œì‹œë  ë•Œê°€ ì¢…ì¢… ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í™ì½©ì˜ í´ë¼ìš°ë“œ ì—…ì²´ SonderCloud Limited IP ì£¼ì†Œë¥¼ VirusTotalì— ì¡°íšŒí•  ê²½ìš° ë¯¸êµ­ìœ¼ë¡œ í‘œì‹œë˜ê³ , ipinfoì—ì„œëŠ” í™ì½©ìœ¼ë¡œ í‘œì‹œë˜ê³  ìˆìŠµë‹ˆë‹¤.

![image.png](Creating_an_IP_Country_Information_Database_KO/3.png)

ì´ëŸ¬í•œ ì°¨ì´ê°€ ë‚˜íƒ€ë‚˜ëŠ” ì´ìœ ëŠ” ë³µí•©ì ì…ë‹ˆë‹¤. ë²•ì¸ì´ í™ì½©ì— ìˆë”ë¼ë„ ë¬¼ë¦¬ì  ì„œë²„ ìœ„ì¹˜ê°€ ë¯¸êµ­ì¼ ìˆ˜ë„ ìˆê³ , ê·¸ ë°˜ëŒ€ì¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë˜í•œ, ì„œë¹„ìŠ¤ ì œê³µìê°€ IP êµ­ê°€ ì •ë³´ë¥¼ í‘œì‹œí•  ë•Œ ë¬¼ë¦¬ì  ìœ„ì¹˜ê°€ ì•„ë‹ˆë¼ ì‚¬ì—…ì ë“±ë¡ êµ­ê°€ ë˜ëŠ” RIRì— í• ë‹¹ëœ IP ë¸”ë¡ ê¸°ì¤€ìœ¼ë¡œ í‘œê¸°í•˜ëŠ” ê²½ìš°ë„ ìˆìŠµë‹ˆë‹¤.

ê±°ê¸°ì— ë”í•´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì£¼ê¸°ë‚˜ ì •ë³´ ìˆ˜ì§‘ ë°©ì‹ì´ ì„œë¹„ìŠ¤ë§ˆë‹¤ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—, ê°™ì€ IPë¼ë„ ì„œë¡œ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

## ğŸ’¾Â ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ

ë°ì´í„°ë² ì´ìŠ¤ë¼ í•¨ì€ MySQL, PostgreSQL ê°™ì€ DB ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì•„ë‹ˆë¼, **IP-êµ­ê°€-ASN** ë“±ê³¼ ê°™ì€ IPì˜ ì •ë³´ë¥¼ êµ¬ì¡°í™” ì‹œì¼œ ë¯¸ë¦¬ ì •ë¦¬í•œ â€œIP ì •ë³´ ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼â€ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. í¸ì˜ì— ë”°ë¼ json, csv, mmdb ë“± ììœ ë¡­ê²Œ êµ¬í˜„í•˜ì—¬ ì‚¬ìš©ë˜ê³  ìˆìœ¼ë©°, ì£¼ë¡œ mmdb íŒŒì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

![image.png](Creating_an_IP_Country_Information_Database_KO/4.png)

MMDBëŠ” MaxMind ì‚¬ì—ì„œ ê°œë°œí•˜ì—¬ ê³µê°œí•œ íŒŒì¼ í¬ë§·ì…ë‹ˆë‹¤. ê³µê°œëœ íŒŒì¼ í¬ë§·ì´ë‹¤ ë³´ë‹ˆ, MaxMindë¥¼ í¬í•¨í•œ ì—¬ëŸ¬ IP ì •ë³´ ì¡°íšŒ ì„œë¹„ìŠ¤ ì—…ì²´ë“¤ì´ MMDB íŒŒì¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ì„ ì œê³µí•´ ì£¼ê³  ìˆìŠµë‹ˆë‹¤. mmdb íŒŒì¼ì„ ë©”ëª¨ë¦¬ì— ì˜¬ë¦° ë’¤, ì¡°íšŒë¥¼ í•˜ê¸° ë•Œë¬¸ì— IP í•˜ë‚˜ë¥¼ ì¡°íšŒí•˜ëŠ” ë° ì†Œìš”ë˜ëŠ” ì‹œê°„ì´ 0.00nì´ˆ ë¯¸ë§Œì´ê¸° ë•Œë¬¸ì— ë§ì€ ì‹¤ì‹œê°„ ì„±ì´ ì¤‘ìš”í•œ ë³´ì•ˆì¥ë¹„ë“¤ì€ mmdbë¥¼ í™œìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.

- ì¡°íšŒ ì½”ë“œ ì˜ˆì‹œ

```python
import maxminddb

ip = "8.8.8.8"

with maxminddb.open_database("country_asn.mmdb") as reader:
    result = reader.get(ip)
    print(result)
```

- ì¶œë ¥

```jsx
{
  "as_domain": "google.com",
  "as_name": "Google LLC",
  "asn": "AS15169",
  "continent": "NA",
  "continent_name": "North America",
  "country": "US",
  "country_name": "United States"
}
```

ë‹¤ë§Œ, IPì˜ ì •ë³´(ASN ë“±)ëŠ” ê²½ìš° ë§¤ì¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°±ì‹ ë˜ê³  ë³€ê²½ì‚¬í•­ì´ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì€ íŒŒì¼ì„ ì£¼ê¸°ì ìœ¼ë¡œ ê°±ì‹ í•´ ì¤˜ì•¼ í•œë‹¤ëŠ” ìˆ˜ê³ ë¡œì›€ì´ ì¡´ì¬í•©ë‹ˆë‹¤. 

## ğŸ›°ï¸Â Whois í”„ë¡œí† ì½œ(TCP,43)ì„ í†µí•œ ì¡°íšŒ

ë§ˆì§€ë§‰ìœ¼ë¡œ Whois í”„ë¡œí† ì½œ í™œìš©ì…ë‹ˆë‹¤. Whois í”„ë¡œí† ì½œì— IP ì£¼ì†Œë¥¼ ë„£ì–´ ì§ˆì˜í•  ê²½ìš° ì§€ì—­ ë ˆì§€ìŠ¤íŠ¸ë¦¬(RIR)ì˜ Whois ì„œë²„ì— IPì˜ ìƒì„¸ ì •ë³´ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. RIRì—ì„œ ê´€ë¦¬ë¥¼ í•˜ë‹¤ ë³´ë‹ˆ, ì •í™•ë„ê°€ ë†’ì€ ì •ë³´ë¼ê³  ë³¼ ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤. 

![image.png](Creating_an_IP_Country_Information_Database_KO/5.png)

ìœˆë„ìš°ì—ëŠ” Whois ì»¤ë§¨ë“œê°€ ë‚´ì¥ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— Nirsoft ì‚¬ì—ì„œ ê°œë°œí•œ IPNetInfoë¼ëŠ” ë„êµ¬ë¥¼ ì¢…ì¢… ì‚¬ìš©í•˜ê³¤ í•©ë‹ˆë‹¤. íŠ¹íˆ, ì¼ê´„ì ì¸ ì¡°íšŒë¥¼ í•  ë•Œ êµ‰ì¥íˆ ìœ ìš©í•©ë‹ˆë‹¤.

![image.png](Creating_an_IP_Country_Information_Database_KO/6.png)

Whois í”„ë¡œí† ì½œì€ ê²°êµ­ ì„œë²„ì— ì§ˆì˜ë¥¼ í•˜ëŠ” ë°©ì‹ì´ê¸° ë•Œë¬¸ì— í•„ì—°ì ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ì§€ì—°ì´ ë°œìƒí•˜ê³ , ì„œë²„ì˜ ìƒíƒœê°€ ì¢‹ì§€ ì•Šê±°ë‚˜ ê³¼ë„í•œ ìš”ì²­ì„ ë³´ë‚¼ ê²½ìš° ìš”ì²­ì´ ì°¨ë‹¨ë˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•  ìˆ˜ë„ ìˆì–´, IPNetInfo ì†Œê°œ í˜ì´ì§€ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì„¤ëª…ì´ ê¸°ì¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

> *ë•Œë•Œë¡œ ARINì˜ WHOIS ì„œë²„ê°€ ë‹¤ìš´ë˜ì–´ IPNetInfoì˜ WHOIS ìš”ì²­ì— ì‘ë‹µí•˜ì§€ ì•Šì•„ IPNetinfoê°€ IP ì£¼ì†Œë¥¼ ê²€ìƒ‰í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ´ ê²½ìš° ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•˜ë©´ ë©ë‹ˆë‹¤.*
> 

ê° ì¡°íšŒ ë°©ë²•ë³„ íŠ¹ì§•ì„ ìš”ì•½í•˜ìë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

| **ë°©ì‹** | **ìµœì‹ ì„±** | **ì •í™•ì„±** | **ì†ë„** | **ì„¤ëª…** |
| --- | --- | --- | --- | --- |
| **1) ì™¸ë¶€ ì„œë¹„ìŠ¤ ì¡°íšŒ** | ğŸ‘ (ìˆ˜ì‹œ ê°±ì‹ ) | ğŸ‘ (ë‹¤ì–‘í•œ ì†ŒìŠ¤) | ğŸ‘ (ë„¤íŠ¸ì›Œí¬ ëŒ€ê¸°) | - ì—¬ëŸ¬ ì„œë¹„ìŠ¤ê°€ ì‹¤ì‹œê°„ ë˜ëŠ” ìì£¼ ê°±ì‹ ë˜ëŠ” DBë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ì—¬ ìµœì‹  ì •ë³´ í™•ë³´ ê°€ëŠ¥ íŠ¸ë˜í”½/ì„œë²„ ìƒíƒœì— ë”°ë¼ ì¡°íšŒ ì§€ì—° ë°œìƒ ê°€ëŠ¥ ê³¼ë„í•œ ì¡°íšŒë‚˜ ì„œë²„ ìƒíƒœì— ë”°ë¼ ì‘ë‹µ ì§€ì—°Â·ì°¨ë‹¨ ë°œìƒ ê°€ëŠ¥ |
| **2) DB ì§ì ‘ êµ¬ì¶•** | ğŸ‘ (ì£¼ê¸° ê°±ì‹  í•„ìš”) | ğŸ¤” (ë°ì´í„° ì·¨í•©) | ğŸ‘ (ë¡œì»¬ ì¡°íšŒ) | - ë¡œì»¬ í™˜ê²½ì—ì„œ ì¡°íšŒí•˜ë¯€ë¡œ ì†ë„ê°€ ë§¤ìš° ë¹ ë¦„ ë°ì´í„° ì—…ë°ì´íŠ¸ ì£¼ê¸°ê°€ ê¸¸ë©´ ìµœì‹ ì„±Â·ì •í™•ì„± ì €í•˜ ê°€ëŠ¥ |
| **3) Whois ì„œë²„ ì¡°íšŒ** | ğŸ‘ (RIR ë°ì´í„°) | ğŸ‘ (ê³µì‹ í• ë‹¹ì •ë³´) | ğŸ‘ (ë„¤íŠ¸ì›Œí¬ ëŒ€ê¸°) | - RIR ê³µì‹ ì •ë³´ë¥¼ ì§ì ‘ ë°›ì•„ ì •í™•ë„ê°€ ë†’ì€ í¸ ê³¼ë„í•œ ì¡°íšŒë‚˜ ì„œë²„ ìƒíƒœì— ë”°ë¼ ì‘ë‹µ ì§€ì—°Â·ì°¨ë‹¨ ë°œìƒ ê°€ëŠ¥ |

ë”°ë¼ì„œ, IP ì¡°íšŒê°€ ë¹ˆë²ˆí•˜ê²Œ ì´ë£¨ì–´ì§€ê³  ë¹ ë¥¸ ì‘ë‹µ ì†ë„ê°€ ìš”êµ¬ë˜ë©°, ì™¸ë¶€ ì¸í„°ë„· í†µì‹ ì´ ë¶ˆê°€ëŠ¥í•œ í™˜ê²½ì´ë¼ë©´ ìì²´ì ìœ¼ë¡œ êµ­ê°€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì¢‹ì€ ë°©ë²•ì…ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ RIRì—ì„œ ì›ì²œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³ , ë¡œì»¬ í™˜ê²½ì—ì„œ IPì˜ êµ­ê°€ ì •ë³´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë§Œë“œëŠ” ë°©ë²•ì„ ì†Œê°œí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

# ğŸŒÂ IP ì£¼ì†Œ ê´€ë¦¬ ì²´ê³„ ì´í•´í•˜ê¸°

ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ëŠ” í¼ë¸”ë¦­ IP ì£¼ì†Œ ìì›ì€ ì•½ 37ì–µ ê°œë¡œ ì œí•œëœ ê³µê³µìì›ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìì›ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ë ¤ë©´ ì¤‘ì•™ì—ì„œ ì¡°ìœ¨í•  ìˆ˜ ìˆëŠ” ê¸°êµ¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. ê·¸ ì—­í• ì„ í•˜ëŠ” ê³³ì´ ë¯¸êµ­ì˜ **ì¸í„°ë„· ì£¼ì†Œê´€ë¦¬ ê¸°êµ¬(ICANN, Internet Corporation for Assigned Names and Numbers)**ì…ë‹ˆë‹¤.

![image.png](Creating_an_IP_Country_Information_Database_KO/7.jpg)

ICANNì€ IP ì£¼ì†Œ, DNS, í”„ë¡œí† ì½œ ë²ˆí˜¸ ë“±ì˜ ì¸í„°ë„· ë¦¬ì†ŒìŠ¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ìµœìƒìœ„ ê¸°êµ¬ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ ëª¨ë“  IPë¥¼ ê´€ë¦¬í•  ìˆ˜ ì—†ìœ¼ë‹ˆ ICANN ì‚°í•˜ì˜ **ì¸í„°ë„· ë²ˆí˜¸ í• ë‹¹ ê¸°ê´€(IANA, Internet Assigned Numbers Authority)**ì´ ì „ ì„¸ê³„ë¥¼ ì§€ì—­ë³„ë¡œ ë‚˜ëˆ„ì–´ ê° **ì§€ì—­ ì¸í„°ë„· ë“±ë¡ ê¸°ê´€(RIR, Regional Internet Registries)**ì— IP ì£¼ì†Œ ëŒ€ì—­ì„ í• ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤.

í˜„ì¬ RIRì€ **ARIN(ë¶ë¯¸)**, **RIPENCC(ìœ ëŸ½)**, **LACNIC(ë‚¨ë¯¸)**, **AFRINIC(ì•„í”„ë¦¬ì¹´),** **APNIC(ì•„ì‹œì•„)** ê° 5ê°œì˜ ê¸°ê´€ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ì¤‘ì—ì„œ LACNIC, APNICì€ êµ­ê°€ ì¸í„°ë„· ë ˆì§€ìŠ¤íŠ¸ë¦¬(NIR, National Internet Registries)ë¼ëŠ” ê¸°ê´€ì„ ë‘ê³  ë‹¤ì‹œ ì„¸ë¶€ì ìœ¼ë¡œ ë¶„ë¥˜í•˜ì—¬ ê´€ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.

- APNIC: KRNIC(ìš°ë¦¬ë‚˜ë¼), CNNIC(ì¤‘êµ­), JPNIC(ì¼ë³¸), TWNIC(ëŒ€ë§Œ), VNNIC(ë² íŠ¸ë‚¨) ë“±
- LACNIC: NIC Brazil(ë¸Œë¼ì§ˆ, Nic Chile(ì¹ ë ˆ), NIC Mexico(ë©•ì‹œì½”)

ì¦‰, ICANN â†’ IANA â†’ RIR â†’ NIR â†’ ISP ìˆœìœ¼ë¡œ IP ì£¼ì†Œê°€ ê´€ë¦¬ë˜ê³  ìˆë‹¤ê³  ì´í•´í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

![image.png](Creating_an_IP_Country_Information_Database_KO/8.png)

ìš°ë¦¬ë‚˜ë¼ì˜ ê²½ìš° RIRì—ê²Œ í• ë‹¹ë°›ì€ IPë¥¼ KRNIC(í•œêµ­ì¸í„°ë„·ì§„í¥ì›)ì—ì„œ ê´€ë¦¬í•˜ê³  ìˆìœ¼ë©°, í•´ë‹¹ IPë“¤ì„ ê´€ë¦¬ ëŒ€í–‰ì(ISP)ì—ê²Œ ì¬ í• ë‹¹í•˜ê³  ìˆìŠµë‹ˆë‹¤. KRNIC ì‚¬ì´íŠ¸ì—ì„œ ë³´ë‹¤ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë‹ˆ, ê¶ê¸ˆí•˜ì‹  ë¶„ì´ ìˆìœ¼ë©´ ì ‘ì†í•´ì„œ í™•ì¸í•´ ë³´ì…”ë„ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.

> https://krnic.kisa.or.kr/jsp/business/management/ispInfo.jsp
> 

# ğŸ—ï¸Â IP ì£¼ì†Œ êµ­ê°€ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•í•˜ê¸°

ì•ì„œ ì–¸ê¸‰í•œ RIR(ì€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë³„ FTP ì„œë²„ì— í†µê³„ ì •ë³´ë¥¼ íŠ¹ì • ê²½ë¡œ(stats)ì— íŠ¹ì • ì‹œì (23:59:59 UTF+0)ì— íŠ¹ì •í•œ ì´ë¦„ìœ¼ë¡œ í¬ë§·ìœ¼ë¡œ ì—…ë¡œë“œí•˜ê¸°ë¡œ ì•½ì†ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

![image.png](Creating_an_IP_Country_Information_Database_KO/9.png)

í¬ë§·ê³¼ ê´€ë ¨ëœ ìì„¸í•œ ë‚´ìš©ì€ APNICì˜ [RIR statistics exchange format](https://www.apnic.net/about-apnic/corporate-documents/documents/resource-guidelines/rir-statistics-exchange-format/)ì—ì„œ ìì„¸íˆ ì‚´í´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

# ğŸ’»Â IP â†” êµ­ê°€ ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ í”„ë¡œê·¸ë¨ ë§Œë“¤ê¸°

ì´ì œ ì›ì²œ ë°ì´í„° ìˆ˜ì§‘ì²˜ì™€ ë°ì´í„° í¬ë§·ì„ í™•ì¸í–ˆìœ¼ë‹ˆ êµ¬í˜„ì„ í•  ì°¨ë¡€ì…ë‹ˆë‹¤. 

ë‹¤ìŒê³¼ ê°™ì€ 

1. ë§¤ì¼ 09:00(UTC+9)ì— RIRë“¤ì˜ FTP ì„œë²„ì—ì„œ delegated-{REGISTRY}-latest íŒŒì¼ ë‹¤ìš´ë¡œë“œ
2. ë‹¤ìš´ë¡œë“œ ëœ íŒŒì¼ì—ì„œ êµ­ê°€ / IPv4 / IP ëŒ€ì—­ ì¶”ì¶œ
3. IP ëŒ€ì—­(ì‹œì‘ ~ ë)ì„ 10ì§„ìˆ˜í™” ì‹œì¼œ ì •ë ¬ í›„ íŒŒì¼ë¡œ ì €ì¥
4. êµ­ê°€, IP ëŒ€ì—­ ìŒì„ ë©”ëª¨ë¦¬ì— ë¡œë“œí•œ ë’¤
5. ì´ì§„íƒìƒ‰

ì´ë¥¼ ì½”ë“œë¡œ êµ¬í˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

```python
# builtin modules
import os
import ipaddress
import asyncio
from datetime import datetime

# install modules
import aiohttp

intervals = []

today = datetime.now().strftime("%Y%m%d")

RIR_URLS = [
    "https://ftp.apnic.net/stats/apnic/delegated-apnic-extended-latest",
    "https://ftp.arin.net/pub/stats/arin/delegated-arin-extended-latest",
    "https://ftp.lacnic.net/pub/stats/lacnic/delegated-lacnic-extended-latest",
    "https://ftp.ripe.net/pub/stats/ripencc/delegated-ripencc-extended-latest",
    "https://ftp.afrinic.net/stats/afrinic/delegated-afrinic-extended-latest",
]

MAPPING_DATABASE = f"./rsc/{today}_mapping.db"

# ë‹¤ìš´ë¡œë“œ
async def fetch(session, url):
    async with session.get(url) as response:
        print(f"[{response.status}] - {url}")
        content = await response.read()
        filename = url.split("/")[-1]
        filepath = f"./rsc/{today}_{filename}"
        with open(filepath, "wb") as f:
            f.write(content)
    return

# ë‹¤ìš´ë¡œë“œ ì½”ë£¨í‹´
async def download():
    async with aiohttp.ClientSession() as session:
        await asyncio.gather(*(fetch(session, url) for url in RIR_URLS))
    print("Download Complete")
    return

# ë°ì´í„°ë² ì´ìŠ¤ ë¡œë“œ
def init_database():
    if not os.path.exists("./rsc"):
        os.mkdir("./rsc")

    # IP ë°ì´í„°ë² ì´ìŠ¤ ì…‹ì´ ì¡´ì¬í•  ê²½ìš° ë©”ëª¨ë¦¬ ë¡œë“œ
    if os.path.exists(MAPPING_DATABASE):
        print("Databse load")
        with open(MAPPING_DATABASE, "r") as f:
            for line in f:
                start_ip, end_ip, country = line.strip().split(",")
                intervals.append((int(start_ip), int(end_ip), country))
        return

    # IP ë°ì´í„°ë² ì´ìŠ¤ ì…‹ì´ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° ë‹¤ìš´ë¡œë“œ í›„ ì €ì¥ ë° ê°€ê³µ
    asyncio.run(download())
    for rir_url in RIR_URLS:
        filename = rir_url.split("/")[-1]
        filepath = f"./rsc/{today}_{filename}"
        with open(filepath, "r") as f:
            for line in f:
                line = line.strip().split("|")
                if len(line) != 8 or line[2] != "ipv4":
                    continue
                country = line[1]
                ip = line[3]
                ip_range = line[4]
                start_ip = int(ipaddress.IPv4Address(ip))
                end_ip = (int(ipaddress.IPv4Address(ip)) + int(ip_range)) - 1
                result = (start_ip, end_ip, country)
                intervals.append(result)

    # ë°ì´í„°ë² ì´ìŠ¤ì…‹ ì €ì¥
    intervals.sort(key=lambda x: x[0])
    with open(MAPPING_DATABASE, "w") as f:
        for interval in intervals:
            line = f"{interval[0]},{interval[1]},{interval[2]}"
            f.write(line + "\n")
    print("Databse load")
    return

# íƒìƒ‰
def search(search_ip):
    result = None
    try:
        search_ip = int(ipaddress.IPv4Address(search_ip))
    except:
        return None
    left, right = 0, len(intervals) - 1
    while left <= right:
        mid = (left + right) // 2
        start_ip, end_ip, country = intervals[mid]
        if start_ip <= search_ip <= end_ip:
            result = country
            break
        elif start_ip > search_ip:
            right = mid - 1
        else:
            left = mid + 1
    return result

def main():
    init_database()
    while True:
        ipv4 = input("Insert IPv4: ")
        r = search(ipv4)
        print(r)

if __name__ == "__main__":
    main()

```

![image.png](Creating_an_IP_Country_Information_Database_KO/10.png)

RIRì—ì„œ ë‹¤ìš´ë¡œë“œ ë°›ì€ ë°ì´í„°ë¥¼ í™•ì¸í•  ê²½ìš° 253,714ê°œì˜ IP ëŒ€ì—­(ì•½ 37ì–µê°œ)ì´ í™•ì¸ë©ë‹ˆë‹¤. ê³µê°œëœ í¼ë¸”ë¦­ IPì˜ êµ­ê°€ ì •ë³´ëŠ” í™•ì¸ ê°€ëŠ¥í•œ ê²ƒê³¼ ë‹¤ë¦„ì—†ëŠ” ì…ˆì…ë‹ˆë‹¤. ë˜í•œ, ê³µêµë¡­ê²Œë„ ì œê°€ ì‘ì„±í•œ í”„ë¡œê·¸ë¨ì´ MMDBë¡œ ì¡°íšŒí•˜ëŠ” ê²ƒë³´ë‹¤ 30 ~ 250ë°° ê°€ëŸ‰ ë¹ ë¥¸ ì†ë„ë¡œ ì¡°íšŒê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

ì¶”ì¸¡í•˜ê¸°ì—” MMDBì—ëŠ” IP ëŒ€ì—­ì´ ì¡°ê¸ˆ ë” ì„¸ë¶€ì ìœ¼ë¡œ ë‚˜ëˆ ì ¸ ìˆê³ , ë‹¤ë¥¸ ì •ë³´(ASN)ë“¤ë„ í•¨ê»˜ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤ ë³´ë‹ˆ ì´ëŸ° ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•Šì•˜ì„ê¹Œ ì¡°ì‹¬ìŠ¤ë ˆ ìƒê°í•´ ë´…ë‹ˆë‹¤.

# âœ¨Â ê²°ë¡ 

RIR ë°ì´í„°ì—ëŠ” IPì™€ ASNì„ í• ë‹¹í–ˆë‹¤ ë¼ëŠ” ë‚´ìš©ë§Œ í¬í•¨ë˜ì–´ ìˆì–´, íŠ¹ì • IPê°€ ì–´ë–¤ ASNì— ì†í•´ìˆëŠ”ì§€ëŠ” ì•Œ ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤. ì´ ì •ë³´ë¥¼ í™•ì¸í•˜ë ¤ë©´ BGP(Border Gateway Protocol)í…Œì´ë¸”ì—ì„œ ìˆ˜ì§‘ì´ í•„ìš”í•œë°ìš”. ë‚´ìš©ì´ ë„ˆë¬´ ê¸¸ì–´ì§€ë‹¤ ë³´ë‹ˆ, ë‹¤ìŒ ì—°êµ¬ê¸€ì—ì„œ ì´ì–´ê°€ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

ì •ì‹ ê±´ê°•ì„ ìœ„í•´ì„œ ê°€ê¸‰ì ì´ë©´ ipinfoì—ì„œ mmdb íŒŒì¼ì„ ì£¼ê¸°ì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œ ë°›ëŠ” ê±¸ ê¶Œì¥í•©ë‹ˆë‹¤.
