

<!DOCTYPE html>
<html lang="ko-KR" data-default-color-scheme="&#34;auto&#34;">



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico">
  <link rel="icon" type="image/png" href="/img/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="&lt;h2 id=&#34;Prologue&#34;&gt;&lt;a href=&#34;#Prologue&#34; class=&#34;headerlink&#34; title=&#34;Prologue&#34;&gt;&lt;/a&gt;Prologue&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/thumbnail.jpg&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;Hello, I&amp;#x2019;m ji9umi, writing about the CVE-2024-54489 vulnerability discovered in macOS Disk Utility!&lt;br&gt;This vulnerability has been patched in macOS Ventura 13.7.2, Sonoma 14.7.2, and Sequoia 15.2. As of the time of writing (2025-08-25), no additional information beyond the &lt;strong&gt;Apple Security Update&lt;/strong&gt; has been publicly disclosed.&lt;br&gt;This article will cover related topics based on the publicly available patch information, ranging from analyzing the vulnerability&amp;#x2019;s root cause to developing an exploit.&lt;/p&gt;
&lt;h2 id=&#34;1-Background&#34;&gt;&lt;a href=&#34;#1-Background&#34; class=&#34;headerlink&#34; title=&#34;1. Background&#34;&gt;&lt;/a&gt;1. Background&lt;/h2&gt;&lt;h3 id=&#34;1-1-About-Disk-Utility&#34;&gt;&lt;a href=&#34;#1-1-About-Disk-Utility&#34; class=&#34;headerlink&#34; title=&#34;1.1. About Disk Utility&#34;&gt;&lt;/a&gt;1.1. About Disk Utility&lt;/h3&gt;&lt;p&gt;Before delving into the vulnerabilities, we briefly reviewed &lt;strong&gt;what Disk Utility is&lt;/strong&gt;. Disk Utility is a system utility provided by macOS that performs tasks such as disk partition management, checking, and mounting/unmounting, similar to Windows Disk Management.&lt;/p&gt;
&lt;p&gt;One feature that distinguishes macOS from Windows is the inclusion of additional functionality for handling &lt;code&gt;.dmg&lt;/code&gt; files.&lt;/p&gt;
&lt;h3 id=&#34;1-2-Patch-Analysis&#34;&gt;&lt;a href=&#34;#1-2-Patch-Analysis&#34; class=&#34;headerlink&#34; title=&#34;1.2. Patch Analysis&#34;&gt;&lt;/a&gt;1.2. Patch Analysis&lt;/h3&gt;&lt;p&gt;Reviewing the security updates released by Apple allows you to gather general information about the vulnerability through its impact and description. For this vulnerability, the details are as follows:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Impact: Running a mount command may unexpectedly execute arbitrary code&lt;br&gt;Description: A path handling issue was addressed with improved validation.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;By combining the disclosed information, it appears there was an inadequacy in the logic handling paths during the user&amp;#x2019;s disk mounting process. Exploiting this could potentially lead to arbitrary code execution. Therefore, triggering the vulnerability is expected to be possible either when the user manually performs the mount or when macOS detects a new storage device.&lt;/p&gt;
&lt;p&gt;When briefly reviewing Disk Utility information, we touched on &lt;code&gt;.dmg&lt;/code&gt; files. These are often encountered when receiving third-party applications distributed externally, outside the App Store.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs cpp&#34;&gt;% file Notion&lt;span class=&#34;hljs-number&#34;&gt;-4.18&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.0&lt;/span&gt;-arm64.dmg
Notion&lt;span class=&#34;hljs-number&#34;&gt;-4.18&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.0&lt;/span&gt;-arm64.dmg: lzfse encoded, lzvn compressed&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;After downloading the file and executing it, it automatically mounts to the volume and proceeds with the application installation in an appropriate manner based on the internal implementation. If a vulnerability occurs at this point, an attacker could distribute malicious installation files, potentially enabling remote code execution.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/1.png&#34; alt&gt;&lt;/p&gt;
&lt;h2 id=&#34;2-Root-Cause-Analysis&#34;&gt;&lt;a href=&#34;#2-Root-Cause-Analysis&#34; class=&#34;headerlink&#34; title=&#34;2. Root Cause Analysis&#34;&gt;&lt;/a&gt;2. Root Cause Analysis&lt;/h2&gt;&lt;p&gt;While the general cause of the vulnerability can be identified, the actual events triggering the mount operation can occur in multiple scenarios. As mentioned earlier, this includes not only when external storage devices are connected or when disk images are handled for application installation, but also situations where new disk images are created and automatically mounted upon completion, among other related actions that may invoke the operation.&lt;/p&gt;
&lt;p&gt;Since analyzing all components would be time-consuming, we conducted a &lt;strong&gt;patch comparison analysis&lt;/strong&gt; as a method to narrow the scope of analysis.&lt;/p&gt;
&lt;h3 id=&#34;2-1-Patch-Diffing&#34;&gt;&lt;a href=&#34;#2-1-Patch-Diffing&#34; class=&#34;headerlink&#34; title=&#34;2.1. Patch Diffing&#34;&gt;&lt;/a&gt;2.1. Patch Diffing&lt;/h3&gt;&lt;p&gt;While various combinations exist for analysis, this article utilized the Binary Ninja + BinExport + BinDiff combination.&lt;/p&gt;
&lt;p&gt;Since the vulnerability location identified through the patch is Disk Utility, analysis of that application was prioritized. The executable file can be obtained from the path &lt;code&gt;/System/Applications/Utilities/Disk\\ Utility.app/Contents/MacOS/Disk\\ Utility&lt;/code&gt;. For comparative analysis, the same file was extracted from both the pre-patch version 13.7.1 and the post-patch version 13.7.2.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;% file /System/Applications/Utilities/Disk\ Utility.app/Contents/MacOS/Disk\ Utility
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64e]
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; architecture x86_64):	Mach-O 64-bit executable x86_64
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; architecture arm64e):	Mach-O 64-bit executable arm64e&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;After loading the target executable file into Binary Ninja, each file extracted via BinExport was compared using BinDiff.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/2.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;The image above shows the BinDiff execution results, confirming that all functions have a similarity score of 1.0, classified as &lt;strong&gt;Matched Functions&lt;/strong&gt;. This indicates that no changes within the executable file can be identified. Even in the case of &lt;a href=&#34;https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/&#34;&gt;CVE-2025-31200&lt;/a&gt; also shows that while the patch history lists &lt;strong&gt;CoreAudio&lt;/strong&gt;, the actual mitigation was implemented in &lt;strong&gt;AudioToolBox&lt;/strong&gt;, a subset of CoreAudio.&lt;/p&gt;
&lt;p&gt;Therefore, for this vulnerability, we conducted additional analysis considering the possibility that the vulnerability could originate from components related to Disk Utility. Revisiting the analysis process for &lt;a href=&#34;https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/&#34;&gt;CVE-2025-31200&lt;/a&gt;, we utilized the results of the &lt;code&gt;ipsw diff&lt;/code&gt; command to compare patch histories. However, the current test environments built on 13.7.1 and 13.7.2 are not distributed in IPSW format.&lt;/p&gt;
&lt;p&gt;IPSW is a format long used for iPhone, iPad, etc., but MacBooks using Intel CPUs did not support it; support began only after the Apple Silicon chipset. The reason IPSW files for versions 13.7.1 and 13.7.2 could not be found is confirmed to be because these versions are not supported on Apple Silicon.&lt;/p&gt;
&lt;p&gt;Another notable feature is that applications installed by default on macOS are configured as &lt;em&gt;Mach-O universal binaries&lt;/em&gt; to support both &lt;strong&gt;x86_64 and arm64e&lt;/strong&gt; architectures.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;% file /System/Applications/Utilities/Disk\ Utility.app/Contents/MacOS/Disk\ Utility
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64e]
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; architecture x86_64):	Mach-O 64-bit executable x86_64
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; architecture arm64e):	Mach-O 64-bit executable arm64e&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Considering the above information collectively, we can conclude that the firmware supported by &lt;code&gt;ipsw diff&lt;/code&gt; for Apple Silicon can be utilized, as the changes resulting from vulnerability patches will not impact the architecture.&lt;/p&gt;
&lt;h3 id=&#34;2-2-ipsw-Diffing&#34;&gt;&lt;a href=&#34;#2-2-ipsw-Diffing&#34; class=&#34;headerlink&#34; title=&#34;2.2. ipsw Diffing&#34;&gt;&lt;/a&gt;2.2. ipsw Diffing&lt;/h3&gt;&lt;p&gt;Comparative analysis using &lt;code&gt;ipsw diff&lt;/code&gt; is performed as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Download the firmware files to be compared.&lt;/li&gt;
&lt;li&gt;Install the tool for IPSW analysis. Refer to &lt;a href=&#34;https://github.com/blacktop/ipsw&#34;&gt;Github&lt;/a&gt; for installation instructions.&lt;/li&gt;
&lt;li&gt;Run &lt;code&gt;ipsw diff &amp;lt;source_firmware_1&amp;gt; &amp;lt;source_firmware_2&amp;gt; --output &amp;lt;path&amp;gt; --markdown&lt;/code&gt;&lt;ol&gt;
&lt;li&gt;If the &lt;code&gt;-output&lt;/code&gt; option is not specified, the comparison results are output to the terminal by default.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Below are the results generated from performing the comparison analysis.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;% ls -l 15_1_1VS15_2/15_1_1_24B91__vs_15_2_24C101/
total 640
drwxr-x---  1382 root  staff   44224 Aug 23 20:33 DYLIBS
drwxr-x---    89 root  staff    2848 Aug 23 20:33 KEXTS
drwxr-x---  1064 root  staff   34048 Aug 23 20:33 MACHOS
-rw-r--r--     1 root  staff  324941 Aug 23 20:33 README.md&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Three subfolders&amp;#x2014;DYLIBS, KEXTS, and MACHOS&amp;#x2014;are created, along with a README.md file summarizing the overall results. The README file categorizes changes as &lt;em&gt;NEW, UPDATED, or REMOVED&lt;/em&gt; based on the modifications. Referencing the linked files provides more detailed change information.&lt;/p&gt;
&lt;p&gt;However, given the sheer volume of changes and the difficulty in arbitrarily classifying their relationships, we conducted an application analysis to understand how it actually behaves during the mounting process.&lt;/p&gt;
&lt;h3 id=&#34;2-3-Attack-Vector&#34;&gt;&lt;a href=&#34;#2-3-Attack-Vector&#34; class=&#34;headerlink&#34; title=&#34;2.3. Attack Vector&#34;&gt;&lt;/a&gt;2.3. Attack Vector&lt;/h3&gt;&lt;p&gt;In addition to mounting directly from an application, you can also mount a new disk device when it is connected by running the &lt;code&gt;hdiutil attach&lt;/code&gt; command in Terminal. Initially, we focused on analyzing the process of mounting through an application.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/3.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;On macOS, a &lt;strong&gt;toolbar&lt;/strong&gt; related to the currently selected application is supported by default in the upper-right corner of the screen. For Disk Utility, this toolbar helps you utilize functions such as creating or loading new disk image files. Some functions may be implemented in both the application and the toolbar.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/4.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;Referring to the image above, you can see that the mount/unmount function is available both in the toolbar and within the application UI.&lt;/p&gt;
&lt;h3 id=&#34;2-4-Static-Analysis&#34;&gt;&lt;a href=&#34;#2-4-Static-Analysis&#34; class=&#34;headerlink&#34; title=&#34;2.4. Static Analysis&#34;&gt;&lt;/a&gt;2.4. Static Analysis&lt;/h3&gt;&lt;p&gt;Within the executable file, functionality related to the toolbar was implemented through the &lt;code&gt;SUToolbarController&lt;/code&gt; class.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;ef6    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; -[SUToolbarController toolbarItemWithName:label:image:action:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUToolbarController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; toolbarItemWithName, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; label, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; image, SEL action)
							&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;1000356&lt;/span&gt;dd                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (![obj_3 isEqualToString:strRef_Sidebar_Toolbar_Button])
&lt;span class=&#34;hljs-number&#34;&gt;1000356&lt;/span&gt;dd                {
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc3                    obj_93 = obj_104;
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_2;
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_95;
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (![obj_3 isEqualToString:strRef_Image_Toolbar_Button])
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    {
&lt;span class=&#34;hljs-number&#34;&gt;100036453&lt;/span&gt;                        
&lt;span class=&#34;hljs-number&#34;&gt;100036453&lt;/span&gt;                        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; ([obj_3 isEqualToString:strRef_Mount_Toolbar_Button])
&lt;span class=&#34;hljs-number&#34;&gt;10003645&lt;/span&gt;b                        {
&lt;span class=&#34;hljs-number&#34;&gt;10003647&lt;/span&gt;f                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_107 = [[clsRef_NSBundle mainBundle] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100036484&lt;/span&gt;                            obj_2 = obj_107;
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;af                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_108 = [[obj_107 localizedStringForKey:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;Mount&amp;quot;&lt;/span&gt; value: &lt;span class=&#34;hljs-comment&#34;&gt;// If disk can be mounted&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;af                                &amp;amp;cfstr_ table:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;bf                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_109 = obj_108;
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;d3                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_90 = [[clsRef_NSBundle mainBundle] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;f4                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_91 = [[obj_90 localizedStringForKey:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;Unmount&amp;quot;&lt;/span&gt; value: &lt;span class=&#34;hljs-comment&#34;&gt;// if disk can be unmounted&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;f4                                &amp;amp;cfstr_ table:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;fc                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_99 = obj_91;
&lt;span class=&#34;hljs-number&#34;&gt;10003651&lt;/span&gt;d                            int64_t obj_92 = [[clsRef_NSArray arrayWithObjects:
&lt;span class=&#34;hljs-number&#34;&gt;10003651&lt;/span&gt;d                                &amp;amp;obj_109 count:&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100036533&lt;/span&gt;                            [var_78 _setAllPossibleLabelsToFit:obj_92];
&lt;span class=&#34;hljs-number&#34;&gt;100036540&lt;/span&gt;                            obj_93 = obj_104;
&lt;span class=&#34;hljs-number&#34;&gt;100036544&lt;/span&gt;                            [obj_92 release];
&lt;span class=&#34;hljs-number&#34;&gt;10003654&lt;/span&gt;a                            [obj_91 release];
&lt;span class=&#34;hljs-number&#34;&gt;100036550&lt;/span&gt;                            [obj_90 release];
&lt;span class=&#34;hljs-number&#34;&gt;100036553&lt;/span&gt;                            obj_95 = obj_108;
&lt;span class=&#34;hljs-number&#34;&gt;10003655&lt;/span&gt;a                            self_1 = &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;;
&lt;span class=&#34;hljs-number&#34;&gt;10003655&lt;/span&gt;a                            &lt;span class=&#34;hljs-keyword&#34;&gt;goto&lt;/span&gt; label_10003655e;
&lt;span class=&#34;hljs-number&#34;&gt;10003645&lt;/span&gt;b                        }
&lt;span class=&#34;hljs-number&#34;&gt;10003645&lt;/span&gt;b                        
&lt;span class=&#34;hljs-number&#34;&gt;10003656&lt;/span&gt;a                        self_1 = &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;;
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    }
								&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Analyzing the &lt;code&gt;-[SUToolbarController toolbarItemWithName:label:image:action:]&lt;/code&gt; method reveals that code is implemented to change the displayed string based on the current state of the selected disk.&lt;/p&gt;
&lt;p&gt;The caller of this method is the &lt;code&gt;-[SUToolbarController toolbar:itemForItemIdentifier:willBeInsertedIntoToolbar:]&lt;/code&gt; method, which subsequently passes the value of the action parameter to the called method as &lt;code&gt;@selector(mountOrUnmountClicked:)&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;100034584&lt;/span&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; -[SUToolbarController toolbar:itemForItemIdentifier:willBeInsertedIntoToolbar:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUToolbarController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; toolbar, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; itemForItemIdentifier, &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; willBeInsertedIntoToolbar)
							&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d4f                &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d4f                {
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d55                    int64_t strRef_Mount_Toolbar_Button_1 = strRef_Mount_Toolbar_Button;
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d76                    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_10 = [[clsRef_NSBundle mainBundle] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d9e                    int64_t obj_11 = [[obj_10 localizedStringForKey:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;Mount&amp;quot;&lt;/span&gt; value:
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d9e                        &amp;amp;cfstr_ table:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;dc0                    int64_t obj_12 =
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;dc0                        [[clsRef_NSImage _imageWithSystemSymbolName:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;mount&amp;quot;&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;ded                    r14 = [[&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt; toolbarItemWithName:strRef_Mount_Toolbar_Button_1 label:
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;ded                        obj_11 image:obj_12 action:&lt;span class=&#34;hljs-keyword&#34;&gt;@selector&lt;/span&gt;(mountOrUnmountClicked:)] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];  &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Set action selector&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;dfa                    [obj_12 release];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;dff                    [obj_11 release];
&lt;span class=&#34;hljs-number&#34;&gt;100034e04&lt;/span&gt;                    [obj_10 release];
&lt;span class=&#34;hljs-number&#34;&gt;100034e20&lt;/span&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_13 = [[clsRef_NSBundle mainBundle] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034e4&lt;/span&gt;f                    int64_t obj_14 = [[obj_13 localizedStringForKey:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;Mount/Unmount&amp;quot;&lt;/span&gt; value:
&lt;span class=&#34;hljs-number&#34;&gt;100034e4&lt;/span&gt;f                        &amp;amp;cfstr_ table:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034e64&lt;/span&gt;                    [r14 setPaletteLabel:obj_14];
&lt;span class=&#34;hljs-number&#34;&gt;100034737&lt;/span&gt;                    [obj_14 release];
&lt;span class=&#34;hljs-number&#34;&gt;10003473&lt;/span&gt;c                    [obj_13 release];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d4f                }
								&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In Objective-C, a selector is an identifier used to identify a specific method, making it searchable within decompiled method names. Searching the method list revealed the methods &lt;code&gt;-[SUISidebarController mountOrUnmountClicked:]&lt;/code&gt; and &lt;code&gt;-[SUSharedActionController mountOrUnmountClicked:]&lt;/code&gt;. However, since the current target under analysis pertains to toolbar functionality rather than sidebar functionality, we proceeded based on &lt;code&gt;-[SUSharedActionController mountOrUnmountClicked:]&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d2f6    &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; -[SUSharedActionController mountOrUnmountClicked:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; mountOrUnmountClicked)

&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d2f6    {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d2f6        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; rax_1 = [[&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt; representedDisk] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d32c        [&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt; performMountOrUnmount:rax_1];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d33c        &lt;span class=&#34;hljs-comment&#34;&gt;/* tailcall */&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d33c        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; [rax_1 release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d2f6    }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This method receives the selected disk information and passes it as an argument to &lt;code&gt;-[SUSharedActionController performMountOrUnmount]&lt;/code&gt;. At this point, it is not yet determined whether the mount or unmount action will be performed; this decision is made in the method called subsequently.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d22c    &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; -[SUSharedActionController performMountOrUnmount:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; performMountOrUnmount)

&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d22c    {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d22c        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; rax = [performMountOrUnmount &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d269        uint8_t** &lt;span class=&#34;hljs-keyword&#34;&gt;const&lt;/span&gt; rcx = &amp;amp;selRef_performUnmount:;  &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Set selector as Unmount&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d269        
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d270        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (![&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt; _diskCanBeUnmounted:rax])
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d270            rcx = &amp;amp;selRef_performMountOrUnlock:;        &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Set selector as Mount or Unlock&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d270        
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d27d        _objc_msgSend(&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, *(uint64_t*)rcx);
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d28b        &lt;span class=&#34;hljs-comment&#34;&gt;/* tailcall */&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d28b        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; [rax release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d22c    }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;When examining the &lt;code&gt;-[SUSharedActionController performMountOrUnmount:]&lt;/code&gt; method, if the disk passed as an argument is not in a state where it can be unmounted&amp;#x2014;that is, if it is not yet mounted&amp;#x2014;the action to perform next is specified as &lt;code&gt;performMountOrUnlock:&lt;/code&gt;. Conversely, if the disk is already mounted, the action is specified as &lt;code&gt;performUnmount:&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;cff4    &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; -[SUSharedActionController performMountOrUnlock:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; performMountOrUnlock)

&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;cff4    {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;cff4        int64_t rax = *(uint64_t*)___stack_chk_guard;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d020        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj = [performMountOrUnlock &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d040        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_1 = [[obj type] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d05c        &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; rax_2 = [obj_1 isEqualToString:*(uint64_t*)_kSKDiskTypeAPFSContainer];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d065        [obj_1 release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d065        
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d06e        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!rax_2)
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d06e        {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1d2            &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt;* cmd_1;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1d2            
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1da            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (![obj isLocked])
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1e5                cmd_1 = &lt;span class=&#34;hljs-keyword&#34;&gt;@selector&lt;/span&gt;(performMount:);    &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Do Mount&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1da            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1dc                cmd_1 = &lt;span class=&#34;hljs-keyword&#34;&gt;@selector&lt;/span&gt;(performUnlock:);   &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Do Unlock&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1dc            
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1f6            _objc_msgSend(&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, cmd_1);
								&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ultimately, it branches to &lt;code&gt;performMount:&lt;/code&gt; and &lt;code&gt;performUnlock:&lt;/code&gt; to execute each action. For the &lt;code&gt;-[SUSharedActionController performMount:]&lt;/code&gt; method, it creates an &lt;em&gt;NSConcreteStackBlock&lt;/em&gt; as shown below and calls the &lt;code&gt;mountWithCompletionBlock:&lt;/code&gt; method, passing this block as the completion block argument.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d38e    &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; -[SUSharedActionController performMount:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; performMount)

&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d38e    {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d38e        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj = [performMount &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3b3        &lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; Block_literal_10004d3b3 stack_block_var_48;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3b3        stack_block_var_48.isa = __NSConcreteStackBlock;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3bb        stack_block_var_48.flags = &lt;span class=&#34;hljs-number&#34;&gt;0xc2000000&lt;/span&gt;;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3bb        stack_block_var_48.reserved = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3c6        stack_block_var_48.invoke = sub_10004d415_block_invoke;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3d1        stack_block_var_48.descriptor = &amp;amp;block_descriptor_1000f5670;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3d5        stack_block_var_48.strong_ptr_20 = obj;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3e3        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_1 = [obj &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3f2        [obj_1 mountWithCompletionBlock:&amp;amp;stack_block_var_48];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d403        [stack_block_var_48.strong_ptr_20 release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d408        [obj_1 release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d38e    }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Unlike the code seen so far, the instance referenced during method calls is &lt;code&gt;obj_1&lt;/code&gt;. The first location where this argument is passed is the &lt;code&gt;-[SUSharedActionController mountButtonClicked:]&lt;/code&gt; method, which retrieves the &lt;code&gt;representedDisk&lt;/code&gt; member of the &lt;code&gt;SUSharedActionController&lt;/code&gt; structure via a getter.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController
{
    &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; _volumeGroupRepresented;
    &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; _lockControls;
    &lt;span class=&#34;hljs-built_in&#34;&gt;SKDisk&lt;/span&gt;* _representedDisk;
&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is a pointer value to the SKDisk structure, and its actual implementation can be found in &lt;strong&gt;StorageKit.framework&lt;/strong&gt;. Therefore, the &lt;code&gt;[obj_1 mountWithCompletionBlock:]&lt;/code&gt; method can perform additional analysis within StorageKit.&lt;/p&gt;
&lt;p&gt;Alternatively, you can mount it via the toolbar&amp;#x2019;s &amp;#x201C;File &amp;#x2192; Open Disk Image&amp;#x201D; menu in the toolbar. In this case, the sequence proceeds as follows: &lt;code&gt;-[SUSharedActionController openDmg:]&lt;/code&gt; &amp;#x2192; &lt;code&gt;sub_10004ca6b_block_invoke()&lt;/code&gt; &amp;#x2192; &lt;code&gt;sub_10004cb4e_block_invoke()&lt;/code&gt; &amp;#x2192; &lt;code&gt;+[SUUtilities mountDiskImageAtPath:visible:readOnly:]&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1000645&lt;/span&gt;df    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; +[SUUtilities mountDiskImageAtPath:visible:readOnly:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUUtilities* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; mountDiskImageAtPath, &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; visible, &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; only)

&lt;span class=&#34;hljs-number&#34;&gt;1000645&lt;/span&gt;df    {
&lt;span class=&#34;hljs-number&#34;&gt;1000645&lt;/span&gt;df        &lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; objc_class_t* clsRef_NSDictionary_1 = clsRef_NSDictionary;
&lt;span class=&#34;hljs-number&#34;&gt;10006461&lt;/span&gt;c        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj = [[clsRef_NSURL fileURLWithPath:mountDiskImageAtPath] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100064641&lt;/span&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_1 = [[clsRef_NSNumber numberWithBool:&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10006465&lt;/span&gt;f        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_2 = [[clsRef_NSNumber numberWithBool:&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10006467&lt;/span&gt;a        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_3 = [[clsRef_NSNumber numberWithBool:(uint64_t)only] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100064698&lt;/span&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_4 = [[clsRef_NSNumber numberWithBool:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;1000647&lt;/span&gt;de        &lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;1000647&lt;/span&gt;de        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!_DIHLDiskImageAttach(obj_14, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &amp;amp;var_60))    &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Attach here!&lt;/span&gt;
								 &lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Upon examining the code, it retrieves the location of the file to be mounted and ultimately calls the &lt;code&gt;_DIHLDiskImageAttach()&lt;/code&gt; method. Since the implementation of this method also resides within &lt;strong&gt;DiskImages.framework&lt;/strong&gt;, analysis requires examining the dyld_shared_cache.&lt;/p&gt;
&lt;h2 id=&#34;Next-up&#34;&gt;&lt;a href=&#34;#Next-up&#34; class=&#34;headerlink&#34; title=&#34;Next up&#34;&gt;&lt;/a&gt;Next up&lt;/h2&gt;&lt;p&gt;The following article will focus on analyzing dyld_shared_cache and identifying the actual root cause. Given the nature of Apple&amp;#x2019;s publicly released patch notes, similar cases are likely to be numerous. Therefore, if the opportunity arises, I also plan to include details about the trial-and-error process involved.&lt;/p&gt;
&lt;h2 id=&#34;Reference&#34;&gt;&lt;a href=&#34;#Reference&#34; class=&#34;headerlink&#34; title=&#34;Reference&#34;&gt;&lt;/a&gt;Reference&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Prologue&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://support.apple.com/en-us/121842&#34;&gt;https://support.apple.com/en-us/121842&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://support.apple.com/en-us/121840&#34;&gt;https://support.apple.com/en-us/121840&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://support.apple.com/en-us/121839&#34;&gt;https://support.apple.com/en-us/121839&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Background&lt;ul&gt;
&lt;li&gt;patch analysis&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Apple_Disk_Image&#34;&gt;https://en.wikipedia.org/wiki/Apple_Disk_Image&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Root Cause Analysis&lt;ul&gt;
&lt;li&gt;patch diffing&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.binary.ninja/guide/binexport.html&#34;&gt;https://docs.binary.ninja/guide/binexport.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/&#34;&gt;https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ipsw diffing&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://ipsw.me/Mac15,6&#34;&gt;https://ipsw.me/Mac15,6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/blacktop/ipsw&#34;&gt;https://github.com/blacktop/ipsw&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
 - hack &amp; life">
  <meta name="author" content="j0dev, y2sman">
  <meta name="keywords" content>
  <meta name="google-site-verification" content="DXkyiaX95-ws53Tyt0m91_umRf4gfV2qJIQZ5zQDIO4">
  <meta name="naver-site-verification" content="0b4fea742ed293b82621684e466d9f26c3ccee06">


  <meta property="og:type" content="website"> 
  <meta property="og:title" content="[Research] CVE-2024-54489 Analysis from Security Updates(EN) - hackyboiz">
  <meta property="og:description" content="&lt;h2 id=&#34;Prologue&#34;&gt;&lt;a href=&#34;#Prologue&#34; class=&#34;headerlink&#34; title=&#34;Prologue&#34;&gt;&lt;/a&gt;Prologue&lt;/h2&gt;&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/thumbnail.jpg&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;Hello, I&amp;#x2019;m ji9umi, writing about the CVE-2024-54489 vulnerability discovered in macOS Disk Utility!&lt;br&gt;This vulnerability has been patched in macOS Ventura 13.7.2, Sonoma 14.7.2, and Sequoia 15.2. As of the time of writing (2025-08-25), no additional information beyond the &lt;strong&gt;Apple Security Update&lt;/strong&gt; has been publicly disclosed.&lt;br&gt;This article will cover related topics based on the publicly available patch information, ranging from analyzing the vulnerability&amp;#x2019;s root cause to developing an exploit.&lt;/p&gt;
&lt;h2 id=&#34;1-Background&#34;&gt;&lt;a href=&#34;#1-Background&#34; class=&#34;headerlink&#34; title=&#34;1. Background&#34;&gt;&lt;/a&gt;1. Background&lt;/h2&gt;&lt;h3 id=&#34;1-1-About-Disk-Utility&#34;&gt;&lt;a href=&#34;#1-1-About-Disk-Utility&#34; class=&#34;headerlink&#34; title=&#34;1.1. About Disk Utility&#34;&gt;&lt;/a&gt;1.1. About Disk Utility&lt;/h3&gt;&lt;p&gt;Before delving into the vulnerabilities, we briefly reviewed &lt;strong&gt;what Disk Utility is&lt;/strong&gt;. Disk Utility is a system utility provided by macOS that performs tasks such as disk partition management, checking, and mounting/unmounting, similar to Windows Disk Management.&lt;/p&gt;
&lt;p&gt;One feature that distinguishes macOS from Windows is the inclusion of additional functionality for handling &lt;code&gt;.dmg&lt;/code&gt; files.&lt;/p&gt;
&lt;h3 id=&#34;1-2-Patch-Analysis&#34;&gt;&lt;a href=&#34;#1-2-Patch-Analysis&#34; class=&#34;headerlink&#34; title=&#34;1.2. Patch Analysis&#34;&gt;&lt;/a&gt;1.2. Patch Analysis&lt;/h3&gt;&lt;p&gt;Reviewing the security updates released by Apple allows you to gather general information about the vulnerability through its impact and description. For this vulnerability, the details are as follows:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Impact: Running a mount command may unexpectedly execute arbitrary code&lt;br&gt;Description: A path handling issue was addressed with improved validation.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;By combining the disclosed information, it appears there was an inadequacy in the logic handling paths during the user&amp;#x2019;s disk mounting process. Exploiting this could potentially lead to arbitrary code execution. Therefore, triggering the vulnerability is expected to be possible either when the user manually performs the mount or when macOS detects a new storage device.&lt;/p&gt;
&lt;p&gt;When briefly reviewing Disk Utility information, we touched on &lt;code&gt;.dmg&lt;/code&gt; files. These are often encountered when receiving third-party applications distributed externally, outside the App Store.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs cpp&#34;&gt;% file Notion&lt;span class=&#34;hljs-number&#34;&gt;-4.18&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.0&lt;/span&gt;-arm64.dmg
Notion&lt;span class=&#34;hljs-number&#34;&gt;-4.18&lt;/span&gt;&lt;span class=&#34;hljs-number&#34;&gt;.0&lt;/span&gt;-arm64.dmg: lzfse encoded, lzvn compressed&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;After downloading the file and executing it, it automatically mounts to the volume and proceeds with the application installation in an appropriate manner based on the internal implementation. If a vulnerability occurs at this point, an attacker could distribute malicious installation files, potentially enabling remote code execution.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/1.png&#34; alt&gt;&lt;/p&gt;
&lt;h2 id=&#34;2-Root-Cause-Analysis&#34;&gt;&lt;a href=&#34;#2-Root-Cause-Analysis&#34; class=&#34;headerlink&#34; title=&#34;2. Root Cause Analysis&#34;&gt;&lt;/a&gt;2. Root Cause Analysis&lt;/h2&gt;&lt;p&gt;While the general cause of the vulnerability can be identified, the actual events triggering the mount operation can occur in multiple scenarios. As mentioned earlier, this includes not only when external storage devices are connected or when disk images are handled for application installation, but also situations where new disk images are created and automatically mounted upon completion, among other related actions that may invoke the operation.&lt;/p&gt;
&lt;p&gt;Since analyzing all components would be time-consuming, we conducted a &lt;strong&gt;patch comparison analysis&lt;/strong&gt; as a method to narrow the scope of analysis.&lt;/p&gt;
&lt;h3 id=&#34;2-1-Patch-Diffing&#34;&gt;&lt;a href=&#34;#2-1-Patch-Diffing&#34; class=&#34;headerlink&#34; title=&#34;2.1. Patch Diffing&#34;&gt;&lt;/a&gt;2.1. Patch Diffing&lt;/h3&gt;&lt;p&gt;While various combinations exist for analysis, this article utilized the Binary Ninja + BinExport + BinDiff combination.&lt;/p&gt;
&lt;p&gt;Since the vulnerability location identified through the patch is Disk Utility, analysis of that application was prioritized. The executable file can be obtained from the path &lt;code&gt;/System/Applications/Utilities/Disk\\ Utility.app/Contents/MacOS/Disk\\ Utility&lt;/code&gt;. For comparative analysis, the same file was extracted from both the pre-patch version 13.7.1 and the post-patch version 13.7.2.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;% file /System/Applications/Utilities/Disk\ Utility.app/Contents/MacOS/Disk\ Utility
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64e]
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; architecture x86_64):	Mach-O 64-bit executable x86_64
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; architecture arm64e):	Mach-O 64-bit executable arm64e&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;After loading the target executable file into Binary Ninja, each file extracted via BinExport was compared using BinDiff.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/2.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;The image above shows the BinDiff execution results, confirming that all functions have a similarity score of 1.0, classified as &lt;strong&gt;Matched Functions&lt;/strong&gt;. This indicates that no changes within the executable file can be identified. Even in the case of &lt;a href=&#34;https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/&#34;&gt;CVE-2025-31200&lt;/a&gt; also shows that while the patch history lists &lt;strong&gt;CoreAudio&lt;/strong&gt;, the actual mitigation was implemented in &lt;strong&gt;AudioToolBox&lt;/strong&gt;, a subset of CoreAudio.&lt;/p&gt;
&lt;p&gt;Therefore, for this vulnerability, we conducted additional analysis considering the possibility that the vulnerability could originate from components related to Disk Utility. Revisiting the analysis process for &lt;a href=&#34;https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/&#34;&gt;CVE-2025-31200&lt;/a&gt;, we utilized the results of the &lt;code&gt;ipsw diff&lt;/code&gt; command to compare patch histories. However, the current test environments built on 13.7.1 and 13.7.2 are not distributed in IPSW format.&lt;/p&gt;
&lt;p&gt;IPSW is a format long used for iPhone, iPad, etc., but MacBooks using Intel CPUs did not support it; support began only after the Apple Silicon chipset. The reason IPSW files for versions 13.7.1 and 13.7.2 could not be found is confirmed to be because these versions are not supported on Apple Silicon.&lt;/p&gt;
&lt;p&gt;Another notable feature is that applications installed by default on macOS are configured as &lt;em&gt;Mach-O universal binaries&lt;/em&gt; to support both &lt;strong&gt;x86_64 and arm64e&lt;/strong&gt; architectures.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;% file /System/Applications/Utilities/Disk\ Utility.app/Contents/MacOS/Disk\ Utility
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64e]
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; architecture x86_64):	Mach-O 64-bit executable x86_64
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (&lt;span class=&#34;hljs-keyword&#34;&gt;for&lt;/span&gt; architecture arm64e):	Mach-O 64-bit executable arm64e&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Considering the above information collectively, we can conclude that the firmware supported by &lt;code&gt;ipsw diff&lt;/code&gt; for Apple Silicon can be utilized, as the changes resulting from vulnerability patches will not impact the architecture.&lt;/p&gt;
&lt;h3 id=&#34;2-2-ipsw-Diffing&#34;&gt;&lt;a href=&#34;#2-2-ipsw-Diffing&#34; class=&#34;headerlink&#34; title=&#34;2.2. ipsw Diffing&#34;&gt;&lt;/a&gt;2.2. ipsw Diffing&lt;/h3&gt;&lt;p&gt;Comparative analysis using &lt;code&gt;ipsw diff&lt;/code&gt; is performed as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Download the firmware files to be compared.&lt;/li&gt;
&lt;li&gt;Install the tool for IPSW analysis. Refer to &lt;a href=&#34;https://github.com/blacktop/ipsw&#34;&gt;Github&lt;/a&gt; for installation instructions.&lt;/li&gt;
&lt;li&gt;Run &lt;code&gt;ipsw diff &amp;lt;source_firmware_1&amp;gt; &amp;lt;source_firmware_2&amp;gt; --output &amp;lt;path&amp;gt; --markdown&lt;/code&gt;&lt;ol&gt;
&lt;li&gt;If the &lt;code&gt;-output&lt;/code&gt; option is not specified, the comparison results are output to the terminal by default.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Below are the results generated from performing the comparison analysis.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs bash&#34;&gt;% ls -l 15_1_1VS15_2/15_1_1_24B91__vs_15_2_24C101/
total 640
drwxr-x---  1382 root  staff   44224 Aug 23 20:33 DYLIBS
drwxr-x---    89 root  staff    2848 Aug 23 20:33 KEXTS
drwxr-x---  1064 root  staff   34048 Aug 23 20:33 MACHOS
-rw-r--r--     1 root  staff  324941 Aug 23 20:33 README.md&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Three subfolders&amp;#x2014;DYLIBS, KEXTS, and MACHOS&amp;#x2014;are created, along with a README.md file summarizing the overall results. The README file categorizes changes as &lt;em&gt;NEW, UPDATED, or REMOVED&lt;/em&gt; based on the modifications. Referencing the linked files provides more detailed change information.&lt;/p&gt;
&lt;p&gt;However, given the sheer volume of changes and the difficulty in arbitrarily classifying their relationships, we conducted an application analysis to understand how it actually behaves during the mounting process.&lt;/p&gt;
&lt;h3 id=&#34;2-3-Attack-Vector&#34;&gt;&lt;a href=&#34;#2-3-Attack-Vector&#34; class=&#34;headerlink&#34; title=&#34;2.3. Attack Vector&#34;&gt;&lt;/a&gt;2.3. Attack Vector&lt;/h3&gt;&lt;p&gt;In addition to mounting directly from an application, you can also mount a new disk device when it is connected by running the &lt;code&gt;hdiutil attach&lt;/code&gt; command in Terminal. Initially, we focused on analyzing the process of mounting through an application.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/3.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;On macOS, a &lt;strong&gt;toolbar&lt;/strong&gt; related to the currently selected application is supported by default in the upper-right corner of the screen. For Disk Utility, this toolbar helps you utilize functions such as creating or loading new disk image files. Some functions may be implemented in both the application and the toolbar.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/4.png&#34; alt&gt;&lt;/p&gt;
&lt;p&gt;Referring to the image above, you can see that the mount/unmount function is available both in the toolbar and within the application UI.&lt;/p&gt;
&lt;h3 id=&#34;2-4-Static-Analysis&#34;&gt;&lt;a href=&#34;#2-4-Static-Analysis&#34; class=&#34;headerlink&#34; title=&#34;2.4. Static Analysis&#34;&gt;&lt;/a&gt;2.4. Static Analysis&lt;/h3&gt;&lt;p&gt;Within the executable file, functionality related to the toolbar was implemented through the &lt;code&gt;SUToolbarController&lt;/code&gt; class.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;ef6    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; -[SUToolbarController toolbarItemWithName:label:image:action:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUToolbarController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; toolbarItemWithName, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; label, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; image, SEL action)
							&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;1000356&lt;/span&gt;dd                &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (![obj_3 isEqualToString:strRef_Sidebar_Toolbar_Button])
&lt;span class=&#34;hljs-number&#34;&gt;1000356&lt;/span&gt;dd                {
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc3                    obj_93 = obj_104;
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_2;
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_95;
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (![obj_3 isEqualToString:strRef_Image_Toolbar_Button])
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    {
&lt;span class=&#34;hljs-number&#34;&gt;100036453&lt;/span&gt;                        
&lt;span class=&#34;hljs-number&#34;&gt;100036453&lt;/span&gt;                        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; ([obj_3 isEqualToString:strRef_Mount_Toolbar_Button])
&lt;span class=&#34;hljs-number&#34;&gt;10003645&lt;/span&gt;b                        {
&lt;span class=&#34;hljs-number&#34;&gt;10003647&lt;/span&gt;f                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_107 = [[clsRef_NSBundle mainBundle] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100036484&lt;/span&gt;                            obj_2 = obj_107;
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;af                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_108 = [[obj_107 localizedStringForKey:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;Mount&amp;quot;&lt;/span&gt; value: &lt;span class=&#34;hljs-comment&#34;&gt;// If disk can be mounted&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;af                                &amp;amp;cfstr_ table:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;bf                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_109 = obj_108;
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;d3                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_90 = [[clsRef_NSBundle mainBundle] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;f4                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_91 = [[obj_90 localizedStringForKey:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;Unmount&amp;quot;&lt;/span&gt; value: &lt;span class=&#34;hljs-comment&#34;&gt;// if disk can be unmounted&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;f4                                &amp;amp;cfstr_ table:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;1000364&lt;/span&gt;fc                            &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_99 = obj_91;
&lt;span class=&#34;hljs-number&#34;&gt;10003651&lt;/span&gt;d                            int64_t obj_92 = [[clsRef_NSArray arrayWithObjects:
&lt;span class=&#34;hljs-number&#34;&gt;10003651&lt;/span&gt;d                                &amp;amp;obj_109 count:&lt;span class=&#34;hljs-number&#34;&gt;2&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100036533&lt;/span&gt;                            [var_78 _setAllPossibleLabelsToFit:obj_92];
&lt;span class=&#34;hljs-number&#34;&gt;100036540&lt;/span&gt;                            obj_93 = obj_104;
&lt;span class=&#34;hljs-number&#34;&gt;100036544&lt;/span&gt;                            [obj_92 release];
&lt;span class=&#34;hljs-number&#34;&gt;10003654&lt;/span&gt;a                            [obj_91 release];
&lt;span class=&#34;hljs-number&#34;&gt;100036550&lt;/span&gt;                            [obj_90 release];
&lt;span class=&#34;hljs-number&#34;&gt;100036553&lt;/span&gt;                            obj_95 = obj_108;
&lt;span class=&#34;hljs-number&#34;&gt;10003655&lt;/span&gt;a                            self_1 = &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;;
&lt;span class=&#34;hljs-number&#34;&gt;10003655&lt;/span&gt;a                            &lt;span class=&#34;hljs-keyword&#34;&gt;goto&lt;/span&gt; label_10003655e;
&lt;span class=&#34;hljs-number&#34;&gt;10003645&lt;/span&gt;b                        }
&lt;span class=&#34;hljs-number&#34;&gt;10003645&lt;/span&gt;b                        
&lt;span class=&#34;hljs-number&#34;&gt;10003656&lt;/span&gt;a                        self_1 = &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;;
&lt;span class=&#34;hljs-number&#34;&gt;100035&lt;/span&gt;bc9                    }
								&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Analyzing the &lt;code&gt;-[SUToolbarController toolbarItemWithName:label:image:action:]&lt;/code&gt; method reveals that code is implemented to change the displayed string based on the current state of the selected disk.&lt;/p&gt;
&lt;p&gt;The caller of this method is the &lt;code&gt;-[SUToolbarController toolbar:itemForItemIdentifier:willBeInsertedIntoToolbar:]&lt;/code&gt; method, which subsequently passes the value of the action parameter to the called method as &lt;code&gt;@selector(mountOrUnmountClicked:)&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;100034584&lt;/span&gt;    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; -[SUToolbarController toolbar:itemForItemIdentifier:willBeInsertedIntoToolbar:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUToolbarController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; toolbar, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; itemForItemIdentifier, &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; willBeInsertedIntoToolbar)
							&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d4f                &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d4f                {
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d55                    int64_t strRef_Mount_Toolbar_Button_1 = strRef_Mount_Toolbar_Button;
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d76                    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_10 = [[clsRef_NSBundle mainBundle] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d9e                    int64_t obj_11 = [[obj_10 localizedStringForKey:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;Mount&amp;quot;&lt;/span&gt; value:
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d9e                        &amp;amp;cfstr_ table:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;dc0                    int64_t obj_12 =
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;dc0                        [[clsRef_NSImage _imageWithSystemSymbolName:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;mount&amp;quot;&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;ded                    r14 = [[&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt; toolbarItemWithName:strRef_Mount_Toolbar_Button_1 label:
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;ded                        obj_11 image:obj_12 action:&lt;span class=&#34;hljs-keyword&#34;&gt;@selector&lt;/span&gt;(mountOrUnmountClicked:)] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];  &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Set action selector&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;dfa                    [obj_12 release];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;dff                    [obj_11 release];
&lt;span class=&#34;hljs-number&#34;&gt;100034e04&lt;/span&gt;                    [obj_10 release];
&lt;span class=&#34;hljs-number&#34;&gt;100034e20&lt;/span&gt;                    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_13 = [[clsRef_NSBundle mainBundle] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034e4&lt;/span&gt;f                    int64_t obj_14 = [[obj_13 localizedStringForKey:&lt;span class=&#34;hljs-string&#34;&gt;@&amp;quot;Mount/Unmount&amp;quot;&lt;/span&gt; value:
&lt;span class=&#34;hljs-number&#34;&gt;100034e4&lt;/span&gt;f                        &amp;amp;cfstr_ table:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100034e64&lt;/span&gt;                    [r14 setPaletteLabel:obj_14];
&lt;span class=&#34;hljs-number&#34;&gt;100034737&lt;/span&gt;                    [obj_14 release];
&lt;span class=&#34;hljs-number&#34;&gt;10003473&lt;/span&gt;c                    [obj_13 release];
&lt;span class=&#34;hljs-number&#34;&gt;100034&lt;/span&gt;d4f                }
								&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In Objective-C, a selector is an identifier used to identify a specific method, making it searchable within decompiled method names. Searching the method list revealed the methods &lt;code&gt;-[SUISidebarController mountOrUnmountClicked:]&lt;/code&gt; and &lt;code&gt;-[SUSharedActionController mountOrUnmountClicked:]&lt;/code&gt;. However, since the current target under analysis pertains to toolbar functionality rather than sidebar functionality, we proceeded based on &lt;code&gt;-[SUSharedActionController mountOrUnmountClicked:]&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d2f6    &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; -[SUSharedActionController mountOrUnmountClicked:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; mountOrUnmountClicked)

&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d2f6    {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d2f6        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; rax_1 = [[&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt; representedDisk] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d32c        [&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt; performMountOrUnmount:rax_1];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d33c        &lt;span class=&#34;hljs-comment&#34;&gt;/* tailcall */&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d33c        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; [rax_1 release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d2f6    }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This method receives the selected disk information and passes it as an argument to &lt;code&gt;-[SUSharedActionController performMountOrUnmount]&lt;/code&gt;. At this point, it is not yet determined whether the mount or unmount action will be performed; this decision is made in the method called subsequently.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d22c    &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; -[SUSharedActionController performMountOrUnmount:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; performMountOrUnmount)

&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d22c    {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d22c        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; rax = [performMountOrUnmount &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d269        uint8_t** &lt;span class=&#34;hljs-keyword&#34;&gt;const&lt;/span&gt; rcx = &amp;amp;selRef_performUnmount:;  &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Set selector as Unmount&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d269        
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d270        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (![&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt; _diskCanBeUnmounted:rax])
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d270            rcx = &amp;amp;selRef_performMountOrUnlock:;        &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Set selector as Mount or Unlock&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d270        
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d27d        _objc_msgSend(&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, *(uint64_t*)rcx);
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d28b        &lt;span class=&#34;hljs-comment&#34;&gt;/* tailcall */&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d28b        &lt;span class=&#34;hljs-keyword&#34;&gt;return&lt;/span&gt; [rax release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d22c    }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;When examining the &lt;code&gt;-[SUSharedActionController performMountOrUnmount:]&lt;/code&gt; method, if the disk passed as an argument is not in a state where it can be unmounted&amp;#x2014;that is, if it is not yet mounted&amp;#x2014;the action to perform next is specified as &lt;code&gt;performMountOrUnlock:&lt;/code&gt;. Conversely, if the disk is already mounted, the action is specified as &lt;code&gt;performUnmount:&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;cff4    &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; -[SUSharedActionController performMountOrUnlock:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; performMountOrUnlock)

&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;cff4    {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;cff4        int64_t rax = *(uint64_t*)___stack_chk_guard;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d020        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj = [performMountOrUnlock &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d040        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_1 = [[obj type] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d05c        &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; rax_2 = [obj_1 isEqualToString:*(uint64_t*)_kSKDiskTypeAPFSContainer];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d065        [obj_1 release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d065        
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d06e        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!rax_2)
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d06e        {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1d2            &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt;* cmd_1;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1d2            
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1da            &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (![obj isLocked])
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1e5                cmd_1 = &lt;span class=&#34;hljs-keyword&#34;&gt;@selector&lt;/span&gt;(performMount:);    &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Do Mount&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1da            &lt;span class=&#34;hljs-keyword&#34;&gt;else&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1dc                cmd_1 = &lt;span class=&#34;hljs-keyword&#34;&gt;@selector&lt;/span&gt;(performUnlock:);   &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Do Unlock&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1dc            
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d1f6            _objc_msgSend(&lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, cmd_1);
								&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ultimately, it branches to &lt;code&gt;performMount:&lt;/code&gt; and &lt;code&gt;performUnlock:&lt;/code&gt; to execute each action. For the &lt;code&gt;-[SUSharedActionController performMount:]&lt;/code&gt; method, it creates an &lt;em&gt;NSConcreteStackBlock&lt;/em&gt; as shown below and calls the &lt;code&gt;mountWithCompletionBlock:&lt;/code&gt; method, passing this block as the completion block argument.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d38e    &lt;span class=&#34;hljs-keyword&#34;&gt;void&lt;/span&gt; -[SUSharedActionController performMount:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; performMount)

&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d38e    {
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d38e        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj = [performMount &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3b3        &lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; Block_literal_10004d3b3 stack_block_var_48;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3b3        stack_block_var_48.isa = __NSConcreteStackBlock;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3bb        stack_block_var_48.flags = &lt;span class=&#34;hljs-number&#34;&gt;0xc2000000&lt;/span&gt;;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3bb        stack_block_var_48.reserved = &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3c6        stack_block_var_48.invoke = sub_10004d415_block_invoke;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3d1        stack_block_var_48.descriptor = &amp;amp;block_descriptor_1000f5670;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3d5        stack_block_var_48.strong_ptr_20 = obj;
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3e3        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_1 = [obj &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d3f2        [obj_1 mountWithCompletionBlock:&amp;amp;stack_block_var_48];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d403        [stack_block_var_48.strong_ptr_20 release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d408        [obj_1 release];
&lt;span class=&#34;hljs-number&#34;&gt;10004&lt;/span&gt;d38e    }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Unlike the code seen so far, the instance referenced during method calls is &lt;code&gt;obj_1&lt;/code&gt;. The first location where this argument is passed is the &lt;code&gt;-[SUSharedActionController mountButtonClicked:]&lt;/code&gt; method, which retrieves the &lt;code&gt;representedDisk&lt;/code&gt; member of the &lt;code&gt;SUSharedActionController&lt;/code&gt; structure via a getter.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUSharedActionController
{
    &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; _volumeGroupRepresented;
    &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; _lockControls;
    &lt;span class=&#34;hljs-built_in&#34;&gt;SKDisk&lt;/span&gt;* _representedDisk;
&lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is a pointer value to the SKDisk structure, and its actual implementation can be found in &lt;strong&gt;StorageKit.framework&lt;/strong&gt;. Therefore, the &lt;code&gt;[obj_1 mountWithCompletionBlock:]&lt;/code&gt; method can perform additional analysis within StorageKit.&lt;/p&gt;
&lt;p&gt;Alternatively, you can mount it via the toolbar&amp;#x2019;s &amp;#x201C;File &amp;#x2192; Open Disk Image&amp;#x201D; menu in the toolbar. In this case, the sequence proceeds as follows: &lt;code&gt;-[SUSharedActionController openDmg:]&lt;/code&gt; &amp;#x2192; &lt;code&gt;sub_10004ca6b_block_invoke()&lt;/code&gt; &amp;#x2192; &lt;code&gt;sub_10004cb4e_block_invoke()&lt;/code&gt; &amp;#x2192; &lt;code&gt;+[SUUtilities mountDiskImageAtPath:visible:readOnly:]&lt;/code&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;hljs objectivec&#34;&gt;&lt;span class=&#34;hljs-number&#34;&gt;1000645&lt;/span&gt;df    &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; +[SUUtilities mountDiskImageAtPath:visible:readOnly:](&lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; SUUtilities* &lt;span class=&#34;hljs-keyword&#34;&gt;self&lt;/span&gt;, SEL sel, &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; mountDiskImageAtPath, &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; visible, &lt;span class=&#34;hljs-keyword&#34;&gt;char&lt;/span&gt; only)

&lt;span class=&#34;hljs-number&#34;&gt;1000645&lt;/span&gt;df    {
&lt;span class=&#34;hljs-number&#34;&gt;1000645&lt;/span&gt;df        &lt;span class=&#34;hljs-keyword&#34;&gt;struct&lt;/span&gt; objc_class_t* clsRef_NSDictionary_1 = clsRef_NSDictionary;
&lt;span class=&#34;hljs-number&#34;&gt;10006461&lt;/span&gt;c        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj = [[clsRef_NSURL fileURLWithPath:mountDiskImageAtPath] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100064641&lt;/span&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_1 = [[clsRef_NSNumber numberWithBool:&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10006465&lt;/span&gt;f        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_2 = [[clsRef_NSNumber numberWithBool:&lt;span class=&#34;hljs-number&#34;&gt;1&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;10006467&lt;/span&gt;a        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_3 = [[clsRef_NSNumber numberWithBool:(uint64_t)only] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;100064698&lt;/span&gt;        &lt;span class=&#34;hljs-keyword&#34;&gt;id&lt;/span&gt; obj_4 = [[clsRef_NSNumber numberWithBool:&lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;hljs-keyword&#34;&gt;retain&lt;/span&gt;];
&lt;span class=&#34;hljs-number&#34;&gt;1000647&lt;/span&gt;de        &lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;
&lt;span class=&#34;hljs-number&#34;&gt;1000647&lt;/span&gt;de        &lt;span class=&#34;hljs-keyword&#34;&gt;if&lt;/span&gt; (!_DIHLDiskImageAttach(obj_14, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;hljs-number&#34;&gt;0&lt;/span&gt;, &amp;amp;var_60))    &lt;span class=&#34;hljs-comment&#34;&gt;// &amp;lt;-- Attach here!&lt;/span&gt;
								 &lt;span class=&#34;hljs-comment&#34;&gt;// ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Upon examining the code, it retrieves the location of the file to be mounted and ultimately calls the &lt;code&gt;_DIHLDiskImageAttach()&lt;/code&gt; method. Since the implementation of this method also resides within &lt;strong&gt;DiskImages.framework&lt;/strong&gt;, analysis requires examining the dyld_shared_cache.&lt;/p&gt;
&lt;h2 id=&#34;Next-up&#34;&gt;&lt;a href=&#34;#Next-up&#34; class=&#34;headerlink&#34; title=&#34;Next up&#34;&gt;&lt;/a&gt;Next up&lt;/h2&gt;&lt;p&gt;The following article will focus on analyzing dyld_shared_cache and identifying the actual root cause. Given the nature of Apple&amp;#x2019;s publicly released patch notes, similar cases are likely to be numerous. Therefore, if the opportunity arises, I also plan to include details about the trial-and-error process involved.&lt;/p&gt;
&lt;h2 id=&#34;Reference&#34;&gt;&lt;a href=&#34;#Reference&#34; class=&#34;headerlink&#34; title=&#34;Reference&#34;&gt;&lt;/a&gt;Reference&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Prologue&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://support.apple.com/en-us/121842&#34;&gt;https://support.apple.com/en-us/121842&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://support.apple.com/en-us/121840&#34;&gt;https://support.apple.com/en-us/121840&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://support.apple.com/en-us/121839&#34;&gt;https://support.apple.com/en-us/121839&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Background&lt;ul&gt;
&lt;li&gt;patch analysis&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Apple_Disk_Image&#34;&gt;https://en.wikipedia.org/wiki/Apple_Disk_Image&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Root Cause Analysis&lt;ul&gt;
&lt;li&gt;patch diffing&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.binary.ninja/guide/binexport.html&#34;&gt;https://docs.binary.ninja/guide/binexport.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/&#34;&gt;https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ipsw diffing&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://ipsw.me/Mac15,6&#34;&gt;https://ipsw.me/Mac15,6&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/blacktop/ipsw&#34;&gt;https://github.com/blacktop/ipsw&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
 - hack &amp; life">
  <meta property="og:image" content="https://hackyboiz.github.io/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/thumbnail.jpg">
  <meta property="og:url" content="https://hackyboiz.github.io/">

  <link rel="canonical" href="https://hackyboiz.github.io/2025/09/13/ji9umi/[research]cve-2024-54489/en/">

  <title>[Research] CVE-2024-54489 Analysis from Security Updates(EN) - hackyboiz</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">


  <link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css">
  <link rel="stylesheet" href="/lib/hint/hint.min.css">

  
    
    <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css">
  

  


<!--  -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_6peoq002giu.css">
<link rel="stylesheet" href="/.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">
<link rel="stylesheet" href="/.css">


<link rel="stylesheet" href="/css/main.css">

<!--  -->


  <script src="/js/utils.js"></script>
  <script src="/js/color-schema.js"></script>

<meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/rss2.xml" title="hackyboiz" type="application/rss+xml">
</head>


<body>
  <header style="height: 40vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>Hackyboiz</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-addrcard"></i>
                About
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/author/">
                <i class="iconfont icon-user-fill"></i>
                Author
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax="true" style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2025-09-13 19:00" pubdate>
      2025 9 13 
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      2.3k 
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      46
       
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2">
      <!--<script data-ad-client="ca-pub-3672652207808168" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>-->
    </div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">[Research] CVE-2024-54489 Analysis from Security Updates(EN)</h1>
                       
            <div class="markdown-body" id="post-body">
              <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>-->
              <!-- hackyboiz_horizen_index -->
              <!--
              <ins class="adsbygoogle"
                   style="display:block"
                   data-ad-client="ca-pub-3672652207808168"
                   data-ad-slot="8887862313"
                   data-ad-format="auto"
                   data-full-width-responsive="true"></ins>
              <script>
                   (adsbygoogle = window.adsbygoogle || []).push({});
              </script>
              -->
              <h2 id="Prologue"><a href="#Prologue" class="headerlink" title="Prologue"></a>Prologue</h2><p><img src="/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/thumbnail.jpg" srcset="/img/loading.gif" alt></p>
<p>Hello, I&#x2019;m ji9umi, writing about the CVE-2024-54489 vulnerability discovered in macOS Disk Utility!<br>This vulnerability has been patched in macOS Ventura 13.7.2, Sonoma 14.7.2, and Sequoia 15.2. As of the time of writing (2025-08-25), no additional information beyond the <strong>Apple Security Update</strong> has been publicly disclosed.<br>This article will cover related topics based on the publicly available patch information, ranging from analyzing the vulnerability&#x2019;s root cause to developing an exploit.</p>
<h2 id="1-Background"><a href="#1-Background" class="headerlink" title="1. Background"></a>1. Background</h2><h3 id="1-1-About-Disk-Utility"><a href="#1-1-About-Disk-Utility" class="headerlink" title="1.1. About Disk Utility"></a>1.1. About Disk Utility</h3><p>Before delving into the vulnerabilities, we briefly reviewed <strong>what Disk Utility is</strong>. Disk Utility is a system utility provided by macOS that performs tasks such as disk partition management, checking, and mounting/unmounting, similar to Windows Disk Management.</p>
<p>One feature that distinguishes macOS from Windows is the inclusion of additional functionality for handling <code>.dmg</code> files.</p>
<h3 id="1-2-Patch-Analysis"><a href="#1-2-Patch-Analysis" class="headerlink" title="1.2. Patch Analysis"></a>1.2. Patch Analysis</h3><p>Reviewing the security updates released by Apple allows you to gather general information about the vulnerability through its impact and description. For this vulnerability, the details are as follows:</p>
<blockquote>
<p><em>Impact: Running a mount command may unexpectedly execute arbitrary code<br>Description: A path handling issue was addressed with improved validation.</em></p>
</blockquote>
<p>By combining the disclosed information, it appears there was an inadequacy in the logic handling paths during the user&#x2019;s disk mounting process. Exploiting this could potentially lead to arbitrary code execution. Therefore, triggering the vulnerability is expected to be possible either when the user manually performs the mount or when macOS detects a new storage device.</p>
<p>When briefly reviewing Disk Utility information, we touched on <code>.dmg</code> files. These are often encountered when receiving third-party applications distributed externally, outside the App Store.</p>
<pre><code class="hljs cpp">% file Notion<span class="hljs-number">-4.18</span><span class="hljs-number">.0</span>-arm64.dmg
Notion<span class="hljs-number">-4.18</span><span class="hljs-number">.0</span>-arm64.dmg: lzfse encoded, lzvn compressed</code></pre>
<p>After downloading the file and executing it, it automatically mounts to the volume and proceeds with the application installation in an appropriate manner based on the internal implementation. If a vulnerability occurs at this point, an attacker could distribute malicious installation files, potentially enabling remote code execution.</p>
<p><img src="/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/1.png" srcset="/img/loading.gif" alt></p>
<h2 id="2-Root-Cause-Analysis"><a href="#2-Root-Cause-Analysis" class="headerlink" title="2. Root Cause Analysis"></a>2. Root Cause Analysis</h2><p>While the general cause of the vulnerability can be identified, the actual events triggering the mount operation can occur in multiple scenarios. As mentioned earlier, this includes not only when external storage devices are connected or when disk images are handled for application installation, but also situations where new disk images are created and automatically mounted upon completion, among other related actions that may invoke the operation.</p>
<p>Since analyzing all components would be time-consuming, we conducted a <strong>patch comparison analysis</strong> as a method to narrow the scope of analysis.</p>
<h3 id="2-1-Patch-Diffing"><a href="#2-1-Patch-Diffing" class="headerlink" title="2.1. Patch Diffing"></a>2.1. Patch Diffing</h3><p>While various combinations exist for analysis, this article utilized the Binary Ninja + BinExport + BinDiff combination.</p>
<p>Since the vulnerability location identified through the patch is Disk Utility, analysis of that application was prioritized. The executable file can be obtained from the path <code>/System/Applications/Utilities/Disk\\ Utility.app/Contents/MacOS/Disk\\ Utility</code>. For comparative analysis, the same file was extracted from both the pre-patch version 13.7.1 and the post-patch version 13.7.2.</p>
<pre><code class="hljs bash">% file /System/Applications/Utilities/Disk\ Utility.app/Contents/MacOS/Disk\ Utility
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64e]
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (<span class="hljs-keyword">for</span> architecture x86_64):	Mach-O 64-bit executable x86_64
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (<span class="hljs-keyword">for</span> architecture arm64e):	Mach-O 64-bit executable arm64e</code></pre>
<p>After loading the target executable file into Binary Ninja, each file extracted via BinExport was compared using BinDiff.</p>
<p><img src="/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/2.png" srcset="/img/loading.gif" alt></p>
<p>The image above shows the BinDiff execution results, confirming that all functions have a similarity score of 1.0, classified as <strong>Matched Functions</strong>. This indicates that no changes within the executable file can be identified. Even in the case of <a href="https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/">CVE-2025-31200</a> also shows that while the patch history lists <strong>CoreAudio</strong>, the actual mitigation was implemented in <strong>AudioToolBox</strong>, a subset of CoreAudio.</p>
<p>Therefore, for this vulnerability, we conducted additional analysis considering the possibility that the vulnerability could originate from components related to Disk Utility. Revisiting the analysis process for <a href="https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/">CVE-2025-31200</a>, we utilized the results of the <code>ipsw diff</code> command to compare patch histories. However, the current test environments built on 13.7.1 and 13.7.2 are not distributed in IPSW format.</p>
<p>IPSW is a format long used for iPhone, iPad, etc., but MacBooks using Intel CPUs did not support it; support began only after the Apple Silicon chipset. The reason IPSW files for versions 13.7.1 and 13.7.2 could not be found is confirmed to be because these versions are not supported on Apple Silicon.</p>
<p>Another notable feature is that applications installed by default on macOS are configured as <em>Mach-O universal binaries</em> to support both <strong>x86_64 and arm64e</strong> architectures.</p>
<pre><code class="hljs bash">% file /System/Applications/Utilities/Disk\ Utility.app/Contents/MacOS/Disk\ Utility
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64e]
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (<span class="hljs-keyword">for</span> architecture x86_64):	Mach-O 64-bit executable x86_64
/System/Applications/Utilities/Disk Utility.app/Contents/MacOS/Disk Utility (<span class="hljs-keyword">for</span> architecture arm64e):	Mach-O 64-bit executable arm64e</code></pre>
<p>Considering the above information collectively, we can conclude that the firmware supported by <code>ipsw diff</code> for Apple Silicon can be utilized, as the changes resulting from vulnerability patches will not impact the architecture.</p>
<h3 id="2-2-ipsw-Diffing"><a href="#2-2-ipsw-Diffing" class="headerlink" title="2.2. ipsw Diffing"></a>2.2. ipsw Diffing</h3><p>Comparative analysis using <code>ipsw diff</code> is performed as follows:</p>
<ol>
<li>Download the firmware files to be compared.</li>
<li>Install the tool for IPSW analysis. Refer to <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/blacktop/ipsw">Github</a> for installation instructions.</li>
<li>Run <code>ipsw diff &lt;source_firmware_1&gt; &lt;source_firmware_2&gt; --output &lt;path&gt; --markdown</code><ol>
<li>If the <code>-output</code> option is not specified, the comparison results are output to the terminal by default.</li>
</ol>
</li>
</ol>
<p>Below are the results generated from performing the comparison analysis.</p>
<pre><code class="hljs bash">% ls -l 15_1_1VS15_2/15_1_1_24B91__vs_15_2_24C101/
total 640
drwxr-x---  1382 root  staff   44224 Aug 23 20:33 DYLIBS
drwxr-x---    89 root  staff    2848 Aug 23 20:33 KEXTS
drwxr-x---  1064 root  staff   34048 Aug 23 20:33 MACHOS
-rw-r--r--     1 root  staff  324941 Aug 23 20:33 README.md</code></pre>
<p>Three subfolders&#x2014;DYLIBS, KEXTS, and MACHOS&#x2014;are created, along with a README.md file summarizing the overall results. The README file categorizes changes as <em>NEW, UPDATED, or REMOVED</em> based on the modifications. Referencing the linked files provides more detailed change information.</p>
<p>However, given the sheer volume of changes and the difficulty in arbitrarily classifying their relationships, we conducted an application analysis to understand how it actually behaves during the mounting process.</p>
<h3 id="2-3-Attack-Vector"><a href="#2-3-Attack-Vector" class="headerlink" title="2.3. Attack Vector"></a>2.3. Attack Vector</h3><p>In addition to mounting directly from an application, you can also mount a new disk device when it is connected by running the <code>hdiutil attach</code> command in Terminal. Initially, we focused on analyzing the process of mounting through an application.</p>
<p><img src="/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/3.png" srcset="/img/loading.gif" alt></p>
<p>On macOS, a <strong>toolbar</strong> related to the currently selected application is supported by default in the upper-right corner of the screen. For Disk Utility, this toolbar helps you utilize functions such as creating or loading new disk image files. Some functions may be implemented in both the application and the toolbar.</p>
<p><img src="/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/4.png" srcset="/img/loading.gif" alt></p>
<p>Referring to the image above, you can see that the mount/unmount function is available both in the toolbar and within the application UI.</p>
<h3 id="2-4-Static-Analysis"><a href="#2-4-Static-Analysis" class="headerlink" title="2.4. Static Analysis"></a>2.4. Static Analysis</h3><p>Within the executable file, functionality related to the toolbar was implemented through the <code>SUToolbarController</code> class.</p>
<pre><code class="hljs objectivec"><span class="hljs-number">100034</span>ef6    <span class="hljs-keyword">id</span> -[SUToolbarController toolbarItemWithName:label:image:action:](<span class="hljs-keyword">struct</span> SUToolbarController* <span class="hljs-keyword">self</span>, SEL sel, <span class="hljs-keyword">id</span> toolbarItemWithName, <span class="hljs-keyword">id</span> label, <span class="hljs-keyword">id</span> image, SEL action)
							<span class="hljs-comment">// ...</span>
<span class="hljs-number">1000356</span>dd                <span class="hljs-keyword">if</span> (![obj_3 isEqualToString:strRef_Sidebar_Toolbar_Button])
<span class="hljs-number">1000356</span>dd                {
<span class="hljs-number">100035</span>bc3                    obj_93 = obj_104;
<span class="hljs-number">100035</span>bc9                    <span class="hljs-keyword">id</span> obj_2;
<span class="hljs-number">100035</span>bc9                    <span class="hljs-keyword">id</span> obj_95;
<span class="hljs-number">100035</span>bc9                    
<span class="hljs-number">100035</span>bc9                    <span class="hljs-keyword">if</span> (![obj_3 isEqualToString:strRef_Image_Toolbar_Button])
<span class="hljs-number">100035</span>bc9                    {
<span class="hljs-number">100036453</span>                        
<span class="hljs-number">100036453</span>                        <span class="hljs-keyword">if</span> ([obj_3 isEqualToString:strRef_Mount_Toolbar_Button])
<span class="hljs-number">10003645</span>b                        {
<span class="hljs-number">10003647</span>f                            <span class="hljs-keyword">id</span> obj_107 = [[clsRef_NSBundle mainBundle] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">100036484</span>                            obj_2 = obj_107;
<span class="hljs-number">1000364</span>af                            <span class="hljs-keyword">id</span> obj_108 = [[obj_107 localizedStringForKey:<span class="hljs-string">@&quot;Mount&quot;</span> value: <span class="hljs-comment">// If disk can be mounted</span>
<span class="hljs-number">1000364</span>af                                &amp;cfstr_ table:<span class="hljs-number">0</span>] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">1000364</span>bf                            <span class="hljs-keyword">id</span> obj_109 = obj_108;
<span class="hljs-number">1000364</span>d3                            <span class="hljs-keyword">id</span> obj_90 = [[clsRef_NSBundle mainBundle] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">1000364</span>f4                            <span class="hljs-keyword">id</span> obj_91 = [[obj_90 localizedStringForKey:<span class="hljs-string">@&quot;Unmount&quot;</span> value: <span class="hljs-comment">// if disk can be unmounted</span>
<span class="hljs-number">1000364</span>f4                                &amp;cfstr_ table:<span class="hljs-number">0</span>] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">1000364</span>fc                            <span class="hljs-keyword">id</span> obj_99 = obj_91;
<span class="hljs-number">10003651</span>d                            int64_t obj_92 = [[clsRef_NSArray arrayWithObjects:
<span class="hljs-number">10003651</span>d                                &amp;obj_109 count:<span class="hljs-number">2</span>] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">100036533</span>                            [var_78 _setAllPossibleLabelsToFit:obj_92];
<span class="hljs-number">100036540</span>                            obj_93 = obj_104;
<span class="hljs-number">100036544</span>                            [obj_92 release];
<span class="hljs-number">10003654</span>a                            [obj_91 release];
<span class="hljs-number">100036550</span>                            [obj_90 release];
<span class="hljs-number">100036553</span>                            obj_95 = obj_108;
<span class="hljs-number">10003655</span>a                            self_1 = <span class="hljs-keyword">self</span>;
<span class="hljs-number">10003655</span>a                            <span class="hljs-keyword">goto</span> label_10003655e;
<span class="hljs-number">10003645</span>b                        }
<span class="hljs-number">10003645</span>b                        
<span class="hljs-number">10003656</span>a                        self_1 = <span class="hljs-keyword">self</span>;
<span class="hljs-number">100035</span>bc9                    }
								<span class="hljs-comment">// ...</span></code></pre>
<p>Analyzing the <code>-[SUToolbarController toolbarItemWithName:label:image:action:]</code> method reveals that code is implemented to change the displayed string based on the current state of the selected disk.</p>
<p>The caller of this method is the <code>-[SUToolbarController toolbar:itemForItemIdentifier:willBeInsertedIntoToolbar:]</code> method, which subsequently passes the value of the action parameter to the called method as <code>@selector(mountOrUnmountClicked:)</code>.</p>
<pre><code class="hljs objectivec"><span class="hljs-number">100034584</span>    <span class="hljs-keyword">id</span> -[SUToolbarController toolbar:itemForItemIdentifier:willBeInsertedIntoToolbar:](<span class="hljs-keyword">struct</span> SUToolbarController* <span class="hljs-keyword">self</span>, SEL sel, <span class="hljs-keyword">id</span> toolbar, <span class="hljs-keyword">id</span> itemForItemIdentifier, <span class="hljs-keyword">char</span> willBeInsertedIntoToolbar)
							<span class="hljs-comment">// ...</span>
<span class="hljs-number">100034</span>d4f                <span class="hljs-keyword">else</span>
<span class="hljs-number">100034</span>d4f                {
<span class="hljs-number">100034</span>d55                    int64_t strRef_Mount_Toolbar_Button_1 = strRef_Mount_Toolbar_Button;
<span class="hljs-number">100034</span>d76                    <span class="hljs-keyword">id</span> obj_10 = [[clsRef_NSBundle mainBundle] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">100034</span>d9e                    int64_t obj_11 = [[obj_10 localizedStringForKey:<span class="hljs-string">@&quot;Mount&quot;</span> value:
<span class="hljs-number">100034</span>d9e                        &amp;cfstr_ table:<span class="hljs-number">0</span>] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">100034</span>dc0                    int64_t obj_12 =
<span class="hljs-number">100034</span>dc0                        [[clsRef_NSImage _imageWithSystemSymbolName:<span class="hljs-string">@&quot;mount&quot;</span>] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">100034</span>ded                    r14 = [[<span class="hljs-keyword">self</span> toolbarItemWithName:strRef_Mount_Toolbar_Button_1 label:
<span class="hljs-number">100034</span>ded                        obj_11 image:obj_12 action:<span class="hljs-keyword">@selector</span>(mountOrUnmountClicked:)] <span class="hljs-keyword">retain</span>];  <span class="hljs-comment">// &lt;-- Set action selector</span>
<span class="hljs-number">100034</span>dfa                    [obj_12 release];
<span class="hljs-number">100034</span>dff                    [obj_11 release];
<span class="hljs-number">100034e04</span>                    [obj_10 release];
<span class="hljs-number">100034e20</span>                    <span class="hljs-keyword">id</span> obj_13 = [[clsRef_NSBundle mainBundle] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">100034e4</span>f                    int64_t obj_14 = [[obj_13 localizedStringForKey:<span class="hljs-string">@&quot;Mount/Unmount&quot;</span> value:
<span class="hljs-number">100034e4</span>f                        &amp;cfstr_ table:<span class="hljs-number">0</span>] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">100034e64</span>                    [r14 setPaletteLabel:obj_14];
<span class="hljs-number">100034737</span>                    [obj_14 release];
<span class="hljs-number">10003473</span>c                    [obj_13 release];
<span class="hljs-number">100034</span>d4f                }
								<span class="hljs-comment">// ...</span></code></pre>
<p>In Objective-C, a selector is an identifier used to identify a specific method, making it searchable within decompiled method names. Searching the method list revealed the methods <code>-[SUISidebarController mountOrUnmountClicked:]</code> and <code>-[SUSharedActionController mountOrUnmountClicked:]</code>. However, since the current target under analysis pertains to toolbar functionality rather than sidebar functionality, we proceeded based on <code>-[SUSharedActionController mountOrUnmountClicked:]</code>.</p>
<pre><code class="hljs objectivec"><span class="hljs-number">10004</span>d2f6    <span class="hljs-keyword">void</span> -[SUSharedActionController mountOrUnmountClicked:](<span class="hljs-keyword">struct</span> SUSharedActionController* <span class="hljs-keyword">self</span>, SEL sel, <span class="hljs-keyword">id</span> mountOrUnmountClicked)

<span class="hljs-number">10004</span>d2f6    {
<span class="hljs-number">10004</span>d2f6        <span class="hljs-keyword">id</span> rax_1 = [[<span class="hljs-keyword">self</span> representedDisk] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">10004</span>d32c        [<span class="hljs-keyword">self</span> performMountOrUnmount:rax_1];
<span class="hljs-number">10004</span>d33c        <span class="hljs-comment">/* tailcall */</span>
<span class="hljs-number">10004</span>d33c        <span class="hljs-keyword">return</span> [rax_1 release];
<span class="hljs-number">10004</span>d2f6    }</code></pre>
<p>This method receives the selected disk information and passes it as an argument to <code>-[SUSharedActionController performMountOrUnmount]</code>. At this point, it is not yet determined whether the mount or unmount action will be performed; this decision is made in the method called subsequently.</p>
<pre><code class="hljs objectivec"><span class="hljs-number">10004</span>d22c    <span class="hljs-keyword">void</span> -[SUSharedActionController performMountOrUnmount:](<span class="hljs-keyword">struct</span> SUSharedActionController* <span class="hljs-keyword">self</span>, SEL sel, <span class="hljs-keyword">id</span> performMountOrUnmount)

<span class="hljs-number">10004</span>d22c    {
<span class="hljs-number">10004</span>d22c        <span class="hljs-keyword">id</span> rax = [performMountOrUnmount <span class="hljs-keyword">retain</span>];
<span class="hljs-number">10004</span>d269        uint8_t** <span class="hljs-keyword">const</span> rcx = &amp;selRef_performUnmount:;  <span class="hljs-comment">// &lt;-- Set selector as Unmount</span>
<span class="hljs-number">10004</span>d269        
<span class="hljs-number">10004</span>d270        <span class="hljs-keyword">if</span> (![<span class="hljs-keyword">self</span> _diskCanBeUnmounted:rax])
<span class="hljs-number">10004</span>d270            rcx = &amp;selRef_performMountOrUnlock:;        <span class="hljs-comment">// &lt;-- Set selector as Mount or Unlock</span>
<span class="hljs-number">10004</span>d270        
<span class="hljs-number">10004</span>d27d        _objc_msgSend(<span class="hljs-keyword">self</span>, *(uint64_t*)rcx);
<span class="hljs-number">10004</span>d28b        <span class="hljs-comment">/* tailcall */</span>
<span class="hljs-number">10004</span>d28b        <span class="hljs-keyword">return</span> [rax release];
<span class="hljs-number">10004</span>d22c    }</code></pre>
<p>When examining the <code>-[SUSharedActionController performMountOrUnmount:]</code> method, if the disk passed as an argument is not in a state where it can be unmounted&#x2014;that is, if it is not yet mounted&#x2014;the action to perform next is specified as <code>performMountOrUnlock:</code>. Conversely, if the disk is already mounted, the action is specified as <code>performUnmount:</code>.</p>
<pre><code class="hljs objectivec"><span class="hljs-number">10004</span>cff4    <span class="hljs-keyword">void</span> -[SUSharedActionController performMountOrUnlock:](<span class="hljs-keyword">struct</span> SUSharedActionController* <span class="hljs-keyword">self</span>, SEL sel, <span class="hljs-keyword">id</span> performMountOrUnlock)

<span class="hljs-number">10004</span>cff4    {
<span class="hljs-number">10004</span>cff4        int64_t rax = *(uint64_t*)___stack_chk_guard;
<span class="hljs-number">10004</span>d020        <span class="hljs-keyword">id</span> obj = [performMountOrUnlock <span class="hljs-keyword">retain</span>];
<span class="hljs-number">10004</span>d040        <span class="hljs-keyword">id</span> obj_1 = [[obj type] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">10004</span>d05c        <span class="hljs-keyword">char</span> rax_2 = [obj_1 isEqualToString:*(uint64_t*)_kSKDiskTypeAPFSContainer];
<span class="hljs-number">10004</span>d065        [obj_1 release];
<span class="hljs-number">10004</span>d065        
<span class="hljs-number">10004</span>d06e        <span class="hljs-keyword">if</span> (!rax_2)
<span class="hljs-number">10004</span>d06e        {
<span class="hljs-number">10004</span>d1d2            <span class="hljs-keyword">char</span>* cmd_1;
<span class="hljs-number">10004</span>d1d2            
<span class="hljs-number">10004</span>d1da            <span class="hljs-keyword">if</span> (![obj isLocked])
<span class="hljs-number">10004</span>d1e5                cmd_1 = <span class="hljs-keyword">@selector</span>(performMount:);    <span class="hljs-comment">// &lt;-- Do Mount</span>
<span class="hljs-number">10004</span>d1da            <span class="hljs-keyword">else</span>
<span class="hljs-number">10004</span>d1dc                cmd_1 = <span class="hljs-keyword">@selector</span>(performUnlock:);   <span class="hljs-comment">// &lt;-- Do Unlock</span>
<span class="hljs-number">10004</span>d1dc            
<span class="hljs-number">10004</span>d1f6            _objc_msgSend(<span class="hljs-keyword">self</span>, cmd_1);
								<span class="hljs-comment">// ...</span></code></pre>
<p>Ultimately, it branches to <code>performMount:</code> and <code>performUnlock:</code> to execute each action. For the <code>-[SUSharedActionController performMount:]</code> method, it creates an <em>NSConcreteStackBlock</em> as shown below and calls the <code>mountWithCompletionBlock:</code> method, passing this block as the completion block argument.</p>
<pre><code class="hljs objectivec"><span class="hljs-number">10004</span>d38e    <span class="hljs-keyword">void</span> -[SUSharedActionController performMount:](<span class="hljs-keyword">struct</span> SUSharedActionController* <span class="hljs-keyword">self</span>, SEL sel, <span class="hljs-keyword">id</span> performMount)

<span class="hljs-number">10004</span>d38e    {
<span class="hljs-number">10004</span>d38e        <span class="hljs-keyword">id</span> obj = [performMount <span class="hljs-keyword">retain</span>];
<span class="hljs-number">10004</span>d3b3        <span class="hljs-keyword">struct</span> Block_literal_10004d3b3 stack_block_var_48;
<span class="hljs-number">10004</span>d3b3        stack_block_var_48.isa = __NSConcreteStackBlock;
<span class="hljs-number">10004</span>d3bb        stack_block_var_48.flags = <span class="hljs-number">0xc2000000</span>;
<span class="hljs-number">10004</span>d3bb        stack_block_var_48.reserved = <span class="hljs-number">0</span>;
<span class="hljs-number">10004</span>d3c6        stack_block_var_48.invoke = sub_10004d415_block_invoke;
<span class="hljs-number">10004</span>d3d1        stack_block_var_48.descriptor = &amp;block_descriptor_1000f5670;
<span class="hljs-number">10004</span>d3d5        stack_block_var_48.strong_ptr_20 = obj;
<span class="hljs-number">10004</span>d3e3        <span class="hljs-keyword">id</span> obj_1 = [obj <span class="hljs-keyword">retain</span>];
<span class="hljs-number">10004</span>d3f2        [obj_1 mountWithCompletionBlock:&amp;stack_block_var_48];
<span class="hljs-number">10004</span>d403        [stack_block_var_48.strong_ptr_20 release];
<span class="hljs-number">10004</span>d408        [obj_1 release];
<span class="hljs-number">10004</span>d38e    }</code></pre>
<p>Unlike the code seen so far, the instance referenced during method calls is <code>obj_1</code>. The first location where this argument is passed is the <code>-[SUSharedActionController mountButtonClicked:]</code> method, which retrieves the <code>representedDisk</code> member of the <code>SUSharedActionController</code> structure via a getter.</p>
<pre><code class="hljs objectivec"><span class="hljs-keyword">struct</span> SUSharedActionController
{
    <span class="hljs-keyword">char</span> _volumeGroupRepresented;
    <span class="hljs-keyword">char</span> _lockControls;
    <span class="hljs-built_in">SKDisk</span>* _representedDisk;
<span class="hljs-comment">// ...</span>
}</code></pre>
<p>This is a pointer value to the SKDisk structure, and its actual implementation can be found in <strong>StorageKit.framework</strong>. Therefore, the <code>[obj_1 mountWithCompletionBlock:]</code> method can perform additional analysis within StorageKit.</p>
<p>Alternatively, you can mount it via the toolbar&#x2019;s &#x201C;File &#x2192; Open Disk Image&#x201D; menu in the toolbar. In this case, the sequence proceeds as follows: <code>-[SUSharedActionController openDmg:]</code> &#x2192; <code>sub_10004ca6b_block_invoke()</code> &#x2192; <code>sub_10004cb4e_block_invoke()</code> &#x2192; <code>+[SUUtilities mountDiskImageAtPath:visible:readOnly:]</code>.</p>
<pre><code class="hljs objectivec"><span class="hljs-number">1000645</span>df    <span class="hljs-keyword">id</span> +[SUUtilities mountDiskImageAtPath:visible:readOnly:](<span class="hljs-keyword">struct</span> SUUtilities* <span class="hljs-keyword">self</span>, SEL sel, <span class="hljs-keyword">id</span> mountDiskImageAtPath, <span class="hljs-keyword">char</span> visible, <span class="hljs-keyword">char</span> only)

<span class="hljs-number">1000645</span>df    {
<span class="hljs-number">1000645</span>df        <span class="hljs-keyword">struct</span> objc_class_t* clsRef_NSDictionary_1 = clsRef_NSDictionary;
<span class="hljs-number">10006461</span>c        <span class="hljs-keyword">id</span> obj = [[clsRef_NSURL fileURLWithPath:mountDiskImageAtPath] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">100064641</span>        <span class="hljs-keyword">id</span> obj_1 = [[clsRef_NSNumber numberWithBool:<span class="hljs-number">1</span>] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">10006465</span>f        <span class="hljs-keyword">id</span> obj_2 = [[clsRef_NSNumber numberWithBool:<span class="hljs-number">1</span>] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">10006467</span>a        <span class="hljs-keyword">id</span> obj_3 = [[clsRef_NSNumber numberWithBool:(uint64_t)only] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">100064698</span>        <span class="hljs-keyword">id</span> obj_4 = [[clsRef_NSNumber numberWithBool:<span class="hljs-number">0</span>] <span class="hljs-keyword">retain</span>];
<span class="hljs-number">1000647</span>de        <span class="hljs-comment">// ...</span>
<span class="hljs-number">1000647</span>de        <span class="hljs-keyword">if</span> (!_DIHLDiskImageAttach(obj_14, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, &amp;var_60))    <span class="hljs-comment">// &lt;-- Attach here!</span>
								 <span class="hljs-comment">// ...</span></code></pre>
<p>Upon examining the code, it retrieves the location of the file to be mounted and ultimately calls the <code>_DIHLDiskImageAttach()</code> method. Since the implementation of this method also resides within <strong>DiskImages.framework</strong>, analysis requires examining the dyld_shared_cache.</p>
<h2 id="Next-up"><a href="#Next-up" class="headerlink" title="Next up"></a>Next up</h2><p>The following article will focus on analyzing dyld_shared_cache and identifying the actual root cause. Given the nature of Apple&#x2019;s publicly released patch notes, similar cases are likely to be numerous. Therefore, if the opportunity arises, I also plan to include details about the trial-and-error process involved.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li>Prologue<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://support.apple.com/en-us/121842">https://support.apple.com/en-us/121842</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://support.apple.com/en-us/121840">https://support.apple.com/en-us/121840</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://support.apple.com/en-us/121839">https://support.apple.com/en-us/121839</a></li>
</ul>
</li>
<li>Background<ul>
<li>patch analysis<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://en.wikipedia.org/wiki/Apple_Disk_Image">https://en.wikipedia.org/wiki/Apple_Disk_Image</a></li>
</ul>
</li>
</ul>
</li>
<li>Root Cause Analysis<ul>
<li>patch diffing<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://docs.binary.ninja/guide/binexport.html">https://docs.binary.ninja/guide/binexport.html</a></li>
<li><a href="https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/">https://hackyboiz.github.io/2025/08/26/ji9umi/2025-08-26/</a></li>
</ul>
</li>
<li>ipsw diffing<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://ipsw.me/Mac15,6">https://ipsw.me/Mac15,6</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/blacktop/ipsw">https://github.com/blacktop/ipsw</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                <div class="post-meta mr-3">
                  <i class="iconfont icon-category"></i>
                  
                  <a class="hover-with-bg" href="/categories/Research/">Research</a>
                  
                </div>
                
                
                <div class="post-meta">
                  <i class="iconfont icon-tags"></i>
                  
                  <a class="hover-with-bg" href="/tags/Apple/">Apple</a>
                  
                  <a class="hover-with-bg" href="/tags/ji9umi/">ji9umi</a>
                  
                  <a class="hover-with-bg" href="/tags/diffing/">diffing</a>
                  
                  <a class="hover-with-bg" href="/tags/CVE-2024-54489/">CVE-2024-54489</a>
                  
                </div>
                
              </div>

              <div class="post-metas mb-3">
                <a class="hover-with-bg" style="display: flex;" href="/author">
                  <div class="link-avatar-page">
                    <img src="/img/profile_ji9umi.jpg" srcset="/img/loading.gif" alt="ji9umi">
                  </div>

                  <div class="link-text">
                    <div class="link-title">ji9umi</div>
                  </div>
                </a>
                <div class="link-text">
                  <div class="link-more">
                    <a href="/tags/ji9umi">
                      Read more
                      <i class="iconfont icon-arrowdown"></i>
                    </a>
                  </div>
                </div>
              </div>

              <hr>
              <!--<script data-ad-client="ca-pub-3672652207808168" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>-->
              
              <!--  -->
              <p class="note note-warning">  <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.ko" rel="external nofollow noopener noreferrer">CC BY-SA 4.0</a>  .        .</p>
              
              
              
              <div class="post-prevnext row">
                <article class="post-prev col-6">
                  
                  
                  <a href="/2025/09/13/ji9umi/%5BResearch%5DCVE-2024-54489/KR/">
                    <i class="iconfont icon-arrowleft"></i>
                    <span class="hidden-mobile">[Research] CVE-2024-54489 Analysis from Security Updates(KR)</span>
                    <span class="visible-mobile">Previous</span>
                  </a>
                  
                </article>
                <article class="post-next col-6">
                  
                  
                  <a href="/2025/09/11/banda/LLVM_based_VMP/en/">
                    <span class="hidden-mobile">[Research] LLVM based VMProtect Devirtualization: Part 1 (EN)</span>
                    <span class="visible-mobile">Next</span>
                    <i class="iconfont icon-arrowright"></i>
                  </a>
                  
                </article>
              </div>
              
            </div>
            
            <!-- Embed Section -->
            <div style="width: 100%; height: 210px; margin-bottom: 50px; overflow: hidden;">
              <iframe src="https://maily.so/hackyboiz/embed?src=embed" style="width: 100%; height: 100%; border: none;" frameborder="0"></iframe>
            </div>            

            
            <!-- Comments -->
            <article class="comments" id="comments">
              
              
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'https://hackyboiz.github.io/2025/09/13/ji9umi/[Research]CVE-2024-54489/EN/';
        this.page.identifier = '/2025/09/13/ji9umi/%5BResearch%5DCVE-2024-54489/EN/';
      };
      function loadDisqus() {
        (function () {
          var d = document,
            s = d.createElement('script');
          s.src = '//' + 'hackyboiz' + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', new Date());
          (d.head || d.body).appendChild(s);
        })();
      }
      waitElementVisible('disqus_thread', loadDisqus);
    </script>
    <noscript>Please enable JavaScript to view the
      <a target="_blank" href="https://disqus.com/?ref_noscript" rel="external nofollow noopener noreferrer">comments powered by Disqus.</a>
    </noscript>
  </div>


            </article>
            
          </article>
        </div>
      </div>
    </div>
    
    <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
      <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

    </div>
    
  </div>
</div>

<!-- Custom -->

    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="external nofollow noopener noreferrer">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script src="/js/debouncer.js"></script>
<script src="/js/main.js"></script>

<!-- Plugins -->


  
    <script src="/js/lazyload.js"></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script>
  <script src="/js/clipboard-use.js"></script>







  <script src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js"></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "[Research] CVE-2024-54489 Analysis from Security Updates(EN)&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js"></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css">

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.staticfile.org/mathjax/3.0.5/es5/tex-svg.js"></script>

  













  

  
    <!-- Google Analytics -->
    <script defer>
      window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) };
      ga.l = +new Date;
      ga('create', 'UA-177243668-2', 'auto');
      ga('send', 'pageview');
    </script>
    <script async src="https://www.google-analytics.com/analytics.js"></script>
  

  
    <!-- Google gtag.js -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-177243668-2"></script>
    <script defer>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-177243668-2');
    </script>
  

  

  

  





</body>
</html>
